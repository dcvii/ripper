

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_VOD__C_test AS
SELECT EXT_VV_CALL2_VOD__C_src.ID, EXT_VV_CALL2_VOD__C_src.OWNERID, EXT_VV_CALL2_VOD__C_src.ISDELETED, EXT_VV_CALL2_VOD__C_src.NAME, EXT_VV_CALL2_VOD__C_src.RECORDTYPEID, EXT_VV_CALL2_VOD__C_src.CREATEDDATE, EXT_VV_CALL2_VOD__C_src.CREATEDBYID, EXT_VV_CALL2_VOD__C_src.LASTMODIFIEDDATE, EXT_VV_CALL2_VOD__C_src.LASTMODIFIEDBYID, EXT_VV_CALL2_VOD__C_src.SYSTEMMODSTAMP, EXT_VV_CALL2_VOD__C_src.LASTACTIVITYDATE, EXT_VV_CALL2_VOD__C_src.MAYEDIT, EXT_VV_CALL2_VOD__C_src.ISLOCKED, EXT_VV_CALL2_VOD__C_src.LASTVIEWEDDATE, EXT_VV_CALL2_VOD__C_src.LASTREFERENCEDDATE, EXT_VV_CALL2_VOD__C_src.SAMPLE_CARD_VOD__C, EXT_VV_CALL2_VOD__C_src.ADD_DETAIL_VOD__C, (EXT_VV_CALL2_VOD__C_src.PROPERTY_VOD__C)::numeric(8,0) AS PROPERTY_VOD__C, EXT_VV_CALL2_VOD__C_src.ACCOUNT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_PRODUCT_DISCUSSION_VOD__C, EXT_VV_CALL2_VOD__C_src.STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.PARENT_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.ACCOUNT_PLAN_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAVENEW_VOD__C, EXT_VV_CALL2_VOD__C_src.NEXT_CALL_NOTES_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_ID_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_CREDENTIALS_VOD_C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_PREFERRED_NAME_VO, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_SAMPLE_STATUS_VOD, EXT_VV_CALL2_VOD__C_src.ZVOD_ATTENDEES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_KEY_MESSAGES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_DETAILING_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_EXPENSES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_FOLLOWUP_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAMPLES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAVE_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SUBMIT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_DELETE_VOD__C, EXT_VV_CALL2_VOD__C_src.ACTIVITY_TYPE__C, EXT_VV_CALL2_VOD__C_src.SIGNIFICANT_EVENT__C, EXT_VV_CALL2_VOD__C_src.LOCATION_VOD__C, EXT_VV_CALL2_VOD__C_src.SUBJECT_VOD__C, EXT_VV_CALL2_VOD__C_src.UNLOCK_VOD__C, (EXT_VV_CALL2_VOD__C_src.CALL_DATETIME_VOD__C)::timestamptz AS CALL_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.DISBURSED_TO_VOD__C, EXT_VV_CALL2_VOD__C_src.REQUEST_RECEIPT_VOD__C, EXT_VV_CALL2_VOD__C_src.SIGNATURE_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.TERRITORY_VOD__C, EXT_VV_CALL2_VOD__C_src.SUBMITTED_BY_MOBILE_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_TYPE_VOD__C, EXT_VV_CALL2_VOD__C_src.ADD_KEY_MESSAGE_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_VOD__C, (EXT_VV_CALL2_VOD__C_src.ATTENDEES_VOD__C)::numeric(3,0) AS ATTENDEES_VOD__C, EXT_VV_CALL2_VOD__C_src.ATTENDEE_TYPE_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DETAILED_PRODUCTS_VOD__C, EXT_VV_CALL2_VOD__C_src.NO_DISBURSEMENT_VOD__C, EXT_VV_CALL2_VOD__C_src.PARENT_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.USER_VOD__C, EXT_VV_CALL2_VOD__C_src.CONTACT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ENTITY_VOD__C, EXT_VV_CALL2_VOD__C_src.MEDICAL_EVENT_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_CREATED_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_LAST_MODIFIED_DATETIME, EXT_VV_CALL2_VOD__C_src.LICENSE_VOD__C, (EXT_VV_CALL2_VOD__C_src.IS_PARENT_CALL_VOD__C)::numeric(18,0) AS IS_PARENT_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.ENTITY_DISPLAY_NAME_VOD__C, EXT_VV_CALL2_VOD__C_src.OVERRIDE_LOCK_VOD__C, EXT_VV_CALL2_VOD__C_src.LAST_DEVICE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_COUNTRY_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_EXPIRATION_DATE, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_TO_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_TO_ADDRESS_TEXT_VOD__C, EXT_VV_CALL2_VOD__C_src.CLM_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CLMDETAILS_VOD__C, EXT_VV_CALL2_VOD__C_src.IS_SAMPLED_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SURVEYS_VOD__C, EXT_VV_CALL2_VOD__C_src.PRESENTATIONS_VOD__C, EXT_VV_CALL2_VOD__C_src.ENTITY_REFERENCE_ID_VOD__C, EXT_VV_CALL2_VOD__C_src.ERROR_REFERENCE_CALL_VOD__C, (EXT_VV_CALL2_VOD__C_src.DURATION_VOD__C)::numeric(18,0) AS DURATION_VOD__C, EXT_VV_CALL2_VOD__C_src.COLOR_VOD__C, EXT_VV_CALL2_VOD__C_src.ALLOWED_PRODUCTS_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ATTACHMENTS_VOD__C, EXT_VV_CALL2_VOD__C_src.SAMPLE_CARD_REASON_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSMCA_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_EXPIRATION_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.SAMPLE_SEND_CARD_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ADDRESS_VOD_C_DEA_STATUS_, EXT_VV_CALL2_VOD__C_src.SIGNATURE_PAGE_IMAGE_VOD__C, EXT_VV_CALL2_VOD__C_src.CREDENTIALS_VOD__C, EXT_VV_CALL2_VOD__C_src.SALUTATION_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_CALL_REMINDER_VOD, EXT_VV_CALL2_VOD__C_src.SALES_ORG_TVA__C, EXT_VV_CALL2_VOD__C_src.ZVOD_BUSINESS_ACCOUNT_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_1_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_2_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_3_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_4_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_5_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_MORE_ACTIONS_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CALL_CONFLICT_STATUS, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_TIMESTAMP_VOD__C)::numeric(15,0) AS SIGNATURE_TIMESTAMP_VOD__C, (EXT_VV_CALL2_VOD__C_src.EXPENSE_AMOUNT_VOD__C)::numeric(18,0) AS EXPENSE_AMOUNT_VOD__C, (EXT_VV_CALL2_VOD__C_src.TOTAL_EXPENSE_ATTENDEES_COUNT)::numeric(5,0) AS TOTAL_EXPENSE_ATTENDEES_COUNT, EXT_VV_CALL2_VOD__C_src.ATTENDEE_LIST_VOD__C, EXT_VV_CALL2_VOD__C_src.EXPENSE_POST_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.ATTENDEE_POST_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.EXPENSE_SYSTEM_EXTERNAL_ID, EXT_VV_CALL2_VOD__C_src.INCURRED_EXPENSE_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSIGNER_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSIGNMENT_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CALL_OBJECTIVE_VOD__C, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_LOCATION_LONGITUDE)::numeric(15,6) AS SIGNATURE_LOCATION_LONGITUDE, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_LOCATION_LATITUDE)::numeric(15,6) AS SIGNATURE_LOCATION_LATITUDE, EXT_VV_CALL2_VOD__C_src.LOCATION_SERVICES_STATUS, EXT_VV_CALL2_VOD__C_src.CREATED_BY_TIMEZONE_TVA__C, EXT_VV_CALL2_VOD__C_src.LICENSE_EXPIRATION_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.LICENSE_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ASSMCA_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_DEA_EXPIRATION_DATE, EXT_VV_CALL2_VOD__C_src.SHIP_DEA_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_METHOD_TVA__C, EXT_VV_CALL2_VOD__C_src.batch_id, EXT_VV_CALL2_VOD__C_src.row_id, EXT_VV_CALL2_VOD__C_src.update_ts FROM teva_ingestion.EXT_VV_CALL2_VOD__C_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_samples_prof AS
SELECT ap.ROW_ID AS sample_id, ea.ROW_ID AS call_id, c.ROW_ID AS siebel_contact_row_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, rep_p.X_SALES_FORCE AS sales_force_id, rep_p.NAME AS territory_num, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, CASE WHEN (ap.RELATION_TYPE_CD = 'Direct Send'::varchar(11)) THEN 'REQUEST'::varchar(7) WHEN (ap.RELATION_TYPE_CD = 'Sample'::varchar(6)) THEN 'DROP'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS sample_type, CASE WHEN (p.DESC_TEXT ~~ 'Adipex%'::varchar(7)) THEN 'ADIPEX-P'::varchar(8) WHEN (p.DESC_TEXT ~~ 'Amrix%'::varchar(6)) THEN 'AMRIX'::varchar(5) WHEN (p.DESC_TEXT ~~ 'Azilect%'::varchar(8)) THEN 'AZILECT'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Budesonide%'::varchar(11)) THEN 'BUDESONIDE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'COPAXONE%'::varchar(9)) THEN 'COPAXONE'::varchar(8) WHEN (p.DESC_TEXT ~~ 'ENJUVIA%'::varchar(8)) THEN 'ENJUVIA'::varchar(7) WHEN (p.DESC_TEXT ~~ 'LoSeasonique%'::varchar(13)) THEN 'LOSEASONIQUE'::varchar(12) WHEN (p.DESC_TEXT ~~ 'NIASPAN%'::varchar(8)) THEN 'NIASPAN'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Nuvigil%'::varchar(8)) THEN 'NUVIGIL'::varchar(7) WHEN (p.DESC_TEXT ~~ 'ProAir%'::varchar(7)) THEN 'PROAIR'::varchar(6) WHEN (p.DESC_TEXT ~~ 'Qnasl%'::varchar(6)) THEN 'QNASL'::varchar(5) WHEN (p.DESC_TEXT ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (p.DESC_TEXT ~~ 'Seasonique%'::varchar(11)) THEN 'SEASONIQUE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'Tev-Tropin%'::varchar(11)) THEN 'TEV-TROPIN'::varchar(10) ELSE 'UNKNOWN'::varchar(7) END AS product_name, p.DESC_TEXT AS sample_name, p.PART_NUM AS sample_ndc, ap.QTY AS qty, ea.NAME AS name_on_call, ea.COMMENTS AS address_line_on_call, ea.ZIPCODE AS zip_on_call, d.ims_id, eax.ATTRIB_03 AS dea_num, ea.OWNER_PER_ID AS ownerid, emp.CSN AS employeenumber, ea.CREATED_BY AS created_by, ea.CREATED AS created_date FROM (((((((WSMP_ADMIN.S_EVT_ACT ea JOIN WSMP_ADMIN.S_CONTACT c ON ((ea.TARGET_PER_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN rep_p ON ((ea.OWNER_POSTN_ID = rep_p.ROW_ID))) JOIN WSMP_ADMIN.S_ACT_PRDINT ap ON ((ea.ROW_ID = ap.ACTIVITY_ID))) JOIN WSMP_ADMIN.S_PROD_INT p ON ((ap.PRDINT_ID = p.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_EVT_ACT_X eax ON ((ea.ROW_ID = eax.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT dim_sfa_csf_demo.IMS_ID AS ims_id, dim_sfa_csf_demo.CM_ID AS cm_id, dim_sfa_csf_demo.ME_NUM AS me_num, dim_sfa_csf_demo.SIEBEL_CONTACT_ROW_ID AS siebel_contact_row_id, row_number() OVER (PARTITION BY dim_sfa_csf_demo.SIEBEL_CONTACT_ROW_ID ORDER BY dim_sfa_csf_demo.VEEVA_ACCOUNT_ID, dim_sfa_csf_demo.SALES_FORCE_ID) AS rnk FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) WHERE ((rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ap.RELATION_TYPE_CD = ANY (ARRAY['Direct Send'::varchar(11), 'Sample'::varchar(6)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_samples_account_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_PER_ID AS csf_demo_id, 'ACCT'::varchar(4) AS call_type, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.INTEGRATION_ID AS integration_id, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_PER_ID AS siebel_target_per_id, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.product_name, details.lot_num, details.qty, details.relation_type_cd, o.OU_TYPE_CD AS ou_type_cd, CASE WHEN (length(emp.INTEGRATION_ID) = 18) THEN emp.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM ((((WSMP_ADMIN.S_EVT_ACT ea LEFT JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_ORG_EXT o ON ((o.ROW_ID = rep_p.BU_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.TARGET_PER_ID))) JOIN (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, appl.LOT_NUM AS lot_num, appl.QTY AS qty, appl.RELATION_TYPE_CD AS relation_type_cd FROM (WSMP_ADMIN.S_ACT_PRDINT appl JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE ((appl.CONFLICT_ID = '0'::varchar(1)) AND (appl.RELATION_TYPE_CD = ANY (ARRAY['DirectSend'::varchar(10), 'Sample'::varchar(6)])))) details ON ((details.activity_id = ea.ROW_ID))) WHERE ((rep_p.NAME <> ALL (ARRAY['Siebel Administrator'::varchar(20), 'TWH Siebel Administrator'::varchar(24)])) AND (o.NAME <> ALL (ARRAY['Siebel Administration'::varchar(21), 'ERM AnonUser'::varchar(12), 'Default Organization'::varchar(20)])) AND (coalesce(o.OU_TYPE_CD, 'XXX'::varchar(3)) <> 'Manufacturer'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_account_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_OU_ID AS csf_demo_id, 'ACCT'::varchar(4) AS call_type, o.OU_TYPE_CD AS ou_type_cd, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_OU_ID AS siebel_target_ou_id, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.first_detailed_product, details.second_detailed_product, details.third_detailed_product, details.fourth_detailed_product, details.fifth_detailed_product, details.sixth_detailed_product, CASE WHEN (length(o.INTEGRATION_ID) = 18) THEN o.INTEGRATION_ID ELSE NULL END AS veeva_account_id, ea.INTEGRATION_ID AS integration_id FROM ((((WSMP_ADMIN.S_EVT_ACT ea LEFT JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_ORG_EXT o ON ((o.ROW_ID = ea.TARGET_OU_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.activity_id, max(CASE WHEN (iq.priority = 1) THEN iq.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (iq.priority = 2) THEN iq.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (iq.priority = 3) THEN iq.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (iq.priority = 4) THEN iq.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (iq.priority = 5) THEN iq.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (iq.priority = 6) THEN iq.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority FROM (WSMP_ADMIN.S_ACT_PROD_APPL appl LEFT JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE (appl.CONFLICT_ID = '0'::varchar(1))) iq GROUP BY iq.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID))) WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2011-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = 'Account Call'::varchar(12)) AND (ea.TODO_CD = 'Account Call'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_demo_accounts AS
SELECT oe.ROW_ID AS csf_demo_id, p.X_SALES_FORCE AS sales_force_id, 'ACCT'::varchar(4) AS demo_type, oe.OU_TYPE_CD AS account_type, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, x.ATTRIB_07 AS hms_id, x.X_ATTRIB_109 AS bp_code, p.NAME AS territory_num, btrim(oe.NAME) AS org_name, substr(btrim(ap.ADDR), 1, 75) AS address1, substr(btrim(ap.ADDR_LINE_2), 1, 75) AS address2, substr(btrim(ap.ADDR_LINE_3), 1, 75) AS address3, ap.CITY AS city, ap.STATE AS state, ap.ZIPCODE AS zip, s_accnt_postn.LAST_CALL_DT AS last_call_date, ap.ROW_ID AS siebel_addr_per_row_id, 'Y'::varchar(1) AS ora_viewable_flag, oe.CREATED AS sfa_create_date, (statement_timestamp())::timestamp AS last_build_date, CASE WHEN (length(oe.INTEGRATION_ID) = 18) THEN oe.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM ((((WSMP_ADMIN.S_ORG_EXT oe LEFT JOIN WSMP_ADMIN.S_ORG_EXT_X x ON ((oe.ROW_ID = x.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ADDR_PER ap ON ((oe.PR_ADDR_ID = ap.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ACCNT_POSTN ON ((oe.ROW_ID = s_accnt_postn.OU_EXT_ID))) LEFT JOIN WSMP_ADMIN.S_POSTN p ON ((s_accnt_postn.POSITION_ID = p.ROW_ID))) WHERE ((oe.NAME <> ALL (ARRAY['Siebel Administration'::varchar(21), 'ERM AnonUser'::varchar(12), 'Default Organization'::varchar(20)])) AND (p.NAME <> ALL (ARRAY['Siebel Administrator'::varchar(20), 'TWH Siebel Administrator'::varchar(24)])) AND (oe.OU_TYPE_CD <> 'Manufacturer'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_4th_sales_roster AS
SELECT fourth_sale_force_roster.EMPLOYEE_ID AS employee_id, fourth_sale_force_roster.USERNAME AS username, CASE fourth_sale_force_roster.LAST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE fourth_sale_force_roster.LAST_NAME END AS last_name, CASE fourth_sale_force_roster.FIRST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE fourth_sale_force_roster.FIRST_NAME END AS first_name, fourth_sale_force_roster.MIDDLE_NAME AS middle_name, fourth_sale_force_roster.SALUTATION AS salutation, fourth_sale_force_roster.SUFFIX AS suffix, fourth_sale_force_roster.TITLE AS title, fourth_sale_force_roster.TERRITORY AS territory, fourth_sale_force_roster.TERRITORY_NAME AS territory_name, CASE WHEN (substr(fourth_sale_force_roster.MANAGER_TERRITORY, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (fourth_sale_force_roster.MANAGER_TERRITORY = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (fourth_sale_force_roster.MANAGER_TERRITORY = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE fourth_sale_force_roster.MANAGER_TERRITORY END AS manager_territory, fourth_sale_force_roster.TEAM AS team, fourth_sale_force_roster.BUSINESS_LINE_1_ADDR AS business_line_1_addr, fourth_sale_force_roster.BUSINESS_LINE_2_ADDR AS business_line_2_addr, fourth_sale_force_roster.BUSINESS_LINE_3_ADDR AS business_line_3_addr, fourth_sale_force_roster.BUSINESS_CITY AS business_city, fourth_sale_force_roster.BUSINESS_STATE AS business_state, fourth_sale_force_roster.BUSINESS_POSTAL_CODE AS business_postal_code, fourth_sale_force_roster.BUSINESS_COUNTRY_CODE AS business_country_code, fourth_sale_force_roster.HOME_LINE_1_ADDR AS home_line_1_addr, fourth_sale_force_roster.HOME_LINE_2_ADDR AS home_line_2_addr, fourth_sale_force_roster.HOME_LINE_3_ADDR AS home_line_3_addr, fourth_sale_force_roster.HOME_CITY AS home_city, fourth_sale_force_roster.HOME_STATE AS home_state, fourth_sale_force_roster.HOME_POSTAL_CODE AS home_postal_code, fourth_sale_force_roster.HOME_COUNTRY_CODE AS home_country_code, fourth_sale_force_roster.CORRESPONDENCE_ADDRESS AS correspondence_address, fourth_sale_force_roster.BUSINESS_PHONE AS business_phone, fourth_sale_force_roster.BUSINESS_PHONE_EXTENSION AS business_phone_extension, fourth_sale_force_roster.BUSINESS_FAX AS business_fax, fourth_sale_force_roster.VOICE_MAIL AS voice_mail, fourth_sale_force_roster.MOBILE_PHONE AS mobile_phone, fourth_sale_force_roster.HOME_PHONE AS home_phone, fourth_sale_force_roster.HOME_FAX AS home_fax, fourth_sale_force_roster.CORRESPONDENCE_PHONE AS correspondence_phone, fourth_sale_force_roster.BUSINESS_EMAIL AS business_email, fourth_sale_force_roster.HOME_EMAIL AS home_email, fourth_sale_force_roster.CORRESPONDENCE_EMAIL AS correspondence_email, fourth_sale_force_roster.COST_CENTER AS cost_center FROM WSMP_ADMIN.FOURTH_SALE_FORCE_ROSTER WHERE ((fourth_sale_force_roster.TERRITORY !~~ '%ZZZZ%'::varchar(6)) AND ((trunc(fourth_sale_force_roster.HIRE_DT, 'DD'::varchar(2)) <= (statement_timestamp())::timestamp) OR (fourth_sale_force_roster.HIRE_DT IS NULL)) AND (fourth_sale_force_roster.TERRITORY <> '111111'::varchar(6)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_SP_Attendees AS
SELECT a.EVENT_NUMBER AS event_number, e.EVENT_NAME AS event_name, e.EVENT_START_DATE AS event_start_date, a.ME_NUMBER AS me_number, a.DEA_NUMBER AS dea_number, cm.CEPH_ID AS ceph_id, a.CUSTOMER_ID AS customer_id, (cm.CUSTOMER_MASTER_ID)::varchar AS cm_id, a.ATTENDEE_FIRST_NAME AS attendee_first_name, a.ATTENDEE_LAST_NAME AS attendee_last_name, a.ATTENDEE_ADDRESS_LINE_1 AS attendee_address_line_1, a.ATTENDEE_ADDRESS_LINE_2 AS attendee_address_line_2, a.ATTENDEE_ADDRESS_LINE_3 AS attendee_address_line_3, a.ATTENDEE_CITY AS attendee_city, a.ATTENDEE_STATE_PROVINCE AS attendee_state_province, a.ATTENDEE_POSTAL_CODE AS attendee_postal_code, a.ATTENDEE_SPECIALTY AS attendee_specialty, a.ATTENDEE_DEGREE AS attendee_degree FROM ((WSMP_ADMIN.STG_AHM_EVENT_ATTENDEE a JOIN WSMP_ADMIN.STG_AHM_EVENT e ON ((e.EVENT_NUMBER = a.EVENT_NUMBER))) LEFT JOIN WSMP_ADMIN.STG_CUSTOMER_MASTER cm ON ((cm.SOURCE_ID = a.IMS_NUMBER))) WHERE ((e.EVENT_START_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (e.EVENT_START_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1))))) GROUP BY a.EVENT_NUMBER, e.EVENT_NAME, e.EVENT_START_DATE, a.ME_NUMBER, a.DEA_NUMBER, cm.CEPH_ID, a.CUSTOMER_ID, (cm.CUSTOMER_MASTER_ID)::varchar, a.ATTENDEE_FIRST_NAME, a.ATTENDEE_LAST_NAME, a.ATTENDEE_ADDRESS_LINE_1, a.ATTENDEE_ADDRESS_LINE_2, a.ATTENDEE_ADDRESS_LINE_3, a.ATTENDEE_CITY, a.ATTENDEE_STATE_PROVINCE, a.ATTENDEE_POSTAL_CODE, a.ATTENDEE_SPECIALTY, a.ATTENDEE_DEGREE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_AHM_PostalCodeTerritory AS
SELECT ahm_postal_code_territory_xref.COUNTRY_CODE, ahm_postal_code_territory_xref.POSTAL_CODE, ahm_postal_code_territory_xref.TERRITORY FROM WSMP_ADMIN.AHM_POSTAL_CODE_TERRITORY_XREF WHERE (ahm_postal_code_territory_xref.TERRITORY !~~ '%ZZZZ%'::varchar(6));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Amrix_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Azilect_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_rx_backup AS
SELECT rx.STATION_NUMBER, rx.VA_PRODUCT, 0 AS PRODUCT_ID, rx.PRODUCT_CODE, to_char(rx.MONTH, 'YYYY-MM-DD'::varchar(10)) AS MONTH, rx.TRX_CNT, rx.CMOP_CNT, rx.TRX_QTY, rx.CMOP_QTY, rx.CNT_30_DAY_RX, rx.ID FROM (WSMP_ADMIN.DW_CMOP_RX_TEVA rx JOIN CUSTOMER.DIM_VA_PRODUCT_XREF p ON ((rx.PRODUCT_CODE = p.WK_PROD_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_station AS
SELECT dim_va_station.VISN, dim_va_station.STATION_NUMBER, dim_va_station.STATION, dim_va_station.STATION_TYPE, dim_va_station.ADDRESS, dim_va_station.CITY, dim_va_station.STATE, dim_va_station.ZIP, dim_va_station.CMOP, dim_va_station.CMOP_DATE, to_char(dim_va_station.CREATE_DATE, 'YYYY-MM-DD'::varchar(10)) AS CREATE_DATE, to_char(dim_va_station.LAST_UPD_DATE, 'YYYY-MM-DD'::varchar(10)) AS LAST_UPD_DATE, dim_va_station.STANDARD_ZIP FROM WSMP_ADMIN.DIM_VA_STATION;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales_backup AS
SELECT STG_ANDA_SALES.TRANSACTION_ID, to_char(STG_ANDA_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_ANDA_SALES.PRODUCT_BRAND, STG_ANDA_SALES.PRODUCT_NDC, STG_ANDA_SALES.PRODUCT_DESC, STG_ANDA_SALES.INVOICE_QTY, STG_ANDA_SALES.INVOICE_UNITS, STG_ANDA_SALES.INVOICE_COST, STG_ANDA_SALES.INVOICE_PACK_COST, STG_ANDA_SALES.INVOICE_UNIT_COST, STG_ANDA_SALES.CONTRACT_PACK_COST, STG_ANDA_SALES.CONTRACT_PURCHASES, STG_ANDA_SALES.CONTRACT_NUMBER, STG_ANDA_SALES.DISPENSING_LOCATION, STG_ANDA_SALES.DL_ADDRESS_1, STG_ANDA_SALES.DL_ADDRESS_2, STG_ANDA_SALES.DL_CITY, STG_ANDA_SALES.DL_STATE, STG_ANDA_SALES.DL_ZIP, STG_ANDA_SALES.DL_DEA_NUM, STG_ANDA_SALES.DEPOT_LOCATION, STG_ANDA_SALES.DEP_ADDRESS_1, STG_ANDA_SALES.DEP_ADDRESS_2, STG_ANDA_SALES.DEP_CITY, STG_ANDA_SALES.DEP_STATE, STG_ANDA_SALES.DEP_ZIP, STG_ANDA_SALES.DEP_DEA_NUM, STG_ANDA_SALES.UNIT_AP, STG_ANDA_SALES.AP FROM WSMP_ADMIN.STG_ANDA_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_cns_deciles AS
SELECT d.ims_id AS hcp_id, CASE d.decile_name WHEN NULLSEQUAL 'Modafinil'::varchar(9) THEN 'Wake'::varchar(4) ELSE d.decile_name END AS decile_name, d.trx_cnt_01_06 AS decile_value FROM WSMP_ADMIN.tfc_ims_decile d WHERE ((d.decile_name = ANY (ARRAY['Fentora'::varchar(7), 'Actiq'::varchar(5), 'Nuvigil'::varchar(7), 'Amrix'::varchar(5), 'Azilect'::varchar(7), 'Copaxone'::varchar(8)])) AND (NOT EXISTS (SELECT NULL FROM WSMP_ADMIN.tfc_ims_presc_demo_w pd WHERE ((pd.ims_id = d.ims_id) AND (pd.pdrp_flag = 'Y'::char(1)))))) UNION ALL SELECT d.ims_id AS hcp_id, CASE d.decile_name WHEN NULLSEQUAL 'Modafinil'::varchar(9) THEN 'Wake'::varchar(4) ELSE d.decile_name END AS decile_name, d.trx_cnt_01_06 AS decile_value FROM WSMP_ADMIN.tfc_ims_decile d WHERE (d.decile_name = ANY (ARRAY['TIRF Total'::varchar(10), 'Total Combo SAO'::varchar(15), 'Total Opioid Market'::varchar(19), 'Total LAO'::varchar(9), 'Total Pure SAO'::varchar(14), 'Branded Sleep / Sedative'::varchar(24), 'Modafinil'::varchar(9), 'Muscle Relaxant Market'::varchar(22)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_program_backup AS
SELECT DIM_ASI_PROGRAM.REDEMPTION_TYPE, DIM_ASI_PROGRAM.ASI_PROGRAM_NUM, DIM_ASI_PROGRAM.PROGRAM_DESC, DIM_ASI_PROGRAM.SALES_FORCE_ID, DIM_ASI_PROGRAM.PROGRAM_TYPE, DIM_ASI_PROGRAM.PRODUCT_NAME, to_char(DIM_ASI_PROGRAM.PROGRAM_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_START_DATE, to_char(DIM_ASI_PROGRAM.PROGRAM_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_END_DATE, DIM_ASI_PROGRAM.NUMBER_OF_TABLETS FROM WSMP_ADMIN.DIM_ASI_PROGRAM;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_redemption_backup AS
SELECT coalesce(tfc_asi_copay_detail_wkly.VEEVA_ACCOUNT_ID, tfc_asi_copay_detail_wkly.IMS_ID) AS veeva_account_id, tfc_asi_copay_detail_wkly.IMS_ID AS ims_id, tfc_asi_copay_detail_wkly.REDEMPTION_TYPE AS redemption_type, to_char(tfc_asi_copay_detail_wkly.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(tfc_asi_copay_detail_wkly.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, tfc_asi_copay_detail_wkly.DAYS_SUPPLY AS days_supply, tfc_asi_copay_detail_wkly.NDC_CODE AS ndc_code, tfc_asi_copay_detail_wkly.BRAND_NAME AS brand_name, tfc_asi_copay_detail_wkly.QTY AS qty, tfc_asi_copay_detail_wkly.REFILLS AS refills, tfc_asi_copay_detail_wkly.PROGRAM_NUM AS program_num, tfc_asi_copay_detail_wkly.COPAY_CARD_NUM AS copay_voucher_num, tfc_asi_copay_detail_wkly.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, tfc_asi_copay_detail_wkly.PHARMACY_CHAIN AS pharmacy_chain, tfc_asi_copay_detail_wkly.PHARMACY_NAME AS pharmacy_name, tfc_asi_copay_detail_wkly.PHARMACY_ADDRESS AS pharmacy_address, tfc_asi_copay_detail_wkly.PHARMACY_ADDRESS2 AS pharmacy_address2, tfc_asi_copay_detail_wkly.PHARMACY_CITY AS pharmacy_city, tfc_asi_copay_detail_wkly.PHARMACY_STATE AS pharmacy_state, tfc_asi_copay_detail_wkly.PHARMACY_ZIP AS pharmacy_zip, tfc_asi_copay_detail_wkly.PHARMACY_NPI_NUM AS pharmacy_npi_num, NULL AS ceph_id, tfc_asi_copay_detail_wkly.ME_NUM AS me_num, tfc_asi_copay_detail_wkly.PRINCIPLE_PHYS_DEA_NUM AS principle_phys_dea_num, tfc_asi_copay_detail_wkly.PRINCIPLE_PHYS_NPI_NUM AS principle_phys_npi_num, tfc_asi_copay_detail_wkly.PHYSICIAN_NAME AS physician_name, tfc_asi_copay_detail_wkly.ASI_PHYS_ADDRESS1 AS physician_address1, tfc_asi_copay_detail_wkly.ASI_PHYS_ADDRESS2 AS physician_address2, tfc_asi_copay_detail_wkly.ASI_PHYS_CITY AS physician_city, tfc_asi_copay_detail_wkly.ASI_PHYS_STATE AS physician_state, tfc_asi_copay_detail_wkly.ASI_PHYS_ZIP AS physician_zip, tfc_asi_copay_detail_wkly.REBATE_AMOUNT AS rebate_amount, tfc_asi_copay_detail_wkly.MEMBER_CASH_EXPENSE AS member_cash_expense, tfc_asi_copay_detail_wkly.SUBMITTED_COST AS submitted_cost, tfc_asi_copay_detail_wkly.PHARMACY_FEE AS pharmacy_fee, tfc_asi_copay_detail_wkly.TOTAL_AMOUNT_DUE AS total_amount_due, tfc_asi_copay_detail_wkly.CALC_AWP AS calc_awp, tfc_asi_copay_detail_wkly.OCC_PAYMENT_TYPE AS occ_payment_type, tfc_asi_copay_detail_wkly.NEW_REFILL AS new_refill FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY WHERE ((tfc_asi_copay_detail_wkly.BRAND_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (tfc_asi_copay_detail_wkly.FILL_DATE < (statement_timestamp())::timestamp) AND (tfc_asi_copay_detail_wkly.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, tfc_asi_copay_detail_wkly.FILL_DATE) <= 25::float)) UNION ALL SELECT coalesce(tfc_asi_redemption_detail_wkly.VEEVA_ACCOUNT_ID, tfc_asi_redemption_detail_wkly.IMS_ID) AS veeva_account_id, tfc_asi_redemption_detail_wkly.IMS_ID AS ims_id, tfc_asi_redemption_detail_wkly.REDEMPTION_TYPE AS redemption_type, to_char(tfc_asi_redemption_detail_wkly.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(tfc_asi_redemption_detail_wkly.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, tfc_asi_redemption_detail_wkly.DAYS_SUPPLY AS days_supply, tfc_asi_redemption_detail_wkly.NDC_CODE AS ndc_code, tfc_asi_redemption_detail_wkly.PRODUCT_NAME AS brand_name, tfc_asi_redemption_detail_wkly.QTY AS qty, tfc_asi_redemption_detail_wkly.REFILLS AS refills, tfc_asi_redemption_detail_wkly.PROGRAM_NUM AS program_num, tfc_asi_redemption_detail_wkly.VOUCHER_NUM AS copay_voucher_num, tfc_asi_redemption_detail_wkly.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, tfc_asi_redemption_detail_wkly.PHARMACY_CHAIN AS pharmacy_chain, tfc_asi_redemption_detail_wkly.PHARMACY_NAME AS pharmacy_name, tfc_asi_redemption_detail_wkly.PHARMACY_ADDRESS AS pharmacy_address, NULL AS pharmacy_address2, tfc_asi_redemption_detail_wkly.PHARMACY_CITY AS pharmacy_city, tfc_asi_redemption_detail_wkly.PHARMACY_STATE AS pharmacy_state, tfc_asi_redemption_detail_wkly.PHARMACY_ZIP AS pharmacy_zip, tfc_asi_redemption_detail_wkly.PHARMACY_NPI_NUM AS pharmacy_npi_num, NULL AS ceph_id, tfc_asi_redemption_detail_wkly.ME_NUM AS me_num, tfc_asi_redemption_detail_wkly.DEA_NUM AS dea_num, tfc_asi_redemption_detail_wkly.NPI AS npi, tfc_asi_redemption_detail_wkly.PROVIDER_NAME AS provider_name, tfc_asi_redemption_detail_wkly.PROVIDER_ADDRESS AS provider_address, NULL AS physician_address2, tfc_asi_redemption_detail_wkly.PROVIDER_CITY AS provider_city, tfc_asi_redemption_detail_wkly.PROVIDER_STATE AS provider_state, tfc_asi_redemption_detail_wkly.PROVIDER_ZIP AS provider_zip, tfc_asi_redemption_detail_wkly.REBATE_AMOUNT AS rebate_amount, tfc_asi_redemption_detail_wkly.MEMBER_CASH_EXPENSE AS member_cash_expense, tfc_asi_redemption_detail_wkly.SUBMITTED_COST AS submitted_cost, tfc_asi_redemption_detail_wkly.PHARMACY_FEE AS pharmacy_fee, tfc_asi_redemption_detail_wkly.TOTAL_AMOUNT_DUE AS total_amount_due, tfc_asi_redemption_detail_wkly.CALC_AWP AS calc_awp, NULL AS occ_payment_type, tfc_asi_redemption_detail_wkly.NEW_REFILL AS new_refill FROM WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY WHERE ((tfc_asi_redemption_detail_wkly.PRODUCT_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (tfc_asi_redemption_detail_wkly.FILL_DATE < (statement_timestamp())::timestamp) AND (tfc_asi_redemption_detail_wkly.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, tfc_asi_redemption_detail_wkly.FILL_DATE) <= 25::float));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_omnicare_sale_backup AS
SELECT STG_OMNICARE_SALES.TRANSACTION_ID, to_char(STG_OMNICARE_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_OMNICARE_SALES.PRODUCT_BRAND, STG_OMNICARE_SALES.PRODUCT_NDC, STG_OMNICARE_SALES.PRODUCT_DESC, STG_OMNICARE_SALES.INVOICE_QTY, STG_OMNICARE_SALES.INVOICE_UNITS, STG_OMNICARE_SALES.INVOICE_COST, STG_OMNICARE_SALES.INVOICE_PACK_COST, STG_OMNICARE_SALES.INVOICE_UNIT_COST, STG_OMNICARE_SALES.CONTRACT_PACK_COST, STG_OMNICARE_SALES.CONTRACT_PURCHASES, STG_OMNICARE_SALES.CONTRACT_NUMBER, STG_OMNICARE_SALES.DISPENSING_LOCATION, STG_OMNICARE_SALES.DL_ADDRESS_1, STG_OMNICARE_SALES.DL_ADDRESS_2, STG_OMNICARE_SALES.DL_CITY, STG_OMNICARE_SALES.DL_STATE, STG_OMNICARE_SALES.DL_ZIP, STG_OMNICARE_SALES.DL_DEA_NUM, STG_OMNICARE_SALES.DEPOT_LOCATION, STG_OMNICARE_SALES.DEP_ADDRESS_1, STG_OMNICARE_SALES.DEP_ADDRESS_2, STG_OMNICARE_SALES.DEP_CITY, STG_OMNICARE_SALES.DEP_STATE, STG_OMNICARE_SALES.DEP_ZIP, STG_OMNICARE_SALES.DEP_DEA_NUM, STG_OMNICARE_SALES.UNIT_AP, STG_OMNICARE_SALES.AP FROM WSMP_ADMIN.STG_OMNICARE_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_paragard_anda_sales_backup AS
SELECT ('A'::varchar(1) || lpad((STG_TW_ANDA_SALES.CUSTOMER_NO)::varchar, 9, '0'::varchar(1))) AS BP_CODE, NULL AS ORTHO_E, STG_TW_ANDA_SALES.CUSTOMER AS BP_NAME, coalesce(STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE2, STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE1) AS SHIP_TO_ADDRESS, STG_TW_ANDA_SALES.CITY AS SHIP_TO_CITY, STG_TW_ANDA_SALES.STATE AS SHIP_TO_STATE, STG_TW_ANDA_SALES.ZIP AS SHIP_TO_ZIP_CODE, NULL AS SHIP_TO_COUNTRY, NULL AS SHIP_TO_PHONE, NULL AS SHIP_TO_FAX, NULL AS SHIP_TO_EMAIL, coalesce(STG_TW_ANDA_SALES.BILL_ADDRESS_LINE2, STG_TW_ANDA_SALES.BILL_ADDRESS_LINE1) AS BILL_TO_ADDRESS, STG_TW_ANDA_SALES.BILL_CITY AS BILL_TO_CITY, STG_TW_ANDA_SALES.BILL_STATE AS BILL_TO_STATE, STG_TW_ANDA_SALES.BILL_ZIP AS BILL_TO_ZIP_CODE, NULL AS BILL_TO_COUNTRY, NULL AS BILL_TO_PHONE, NULL AS BILL_TO_FAX, NULL AS BILL_TO_EMAIL, STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD AS CLASS_OF_TRADE, STG_TW_ANDA_SALES.ORDER_NO AS INVOICE_NUM, STG_TW_ANDA_SALES.NET_COST AS DEL_AMT, to_char(to_date(STG_TW_ANDA_SALES.SALES_DATE, 'MM/DD/YY'::varchar(8)), 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_TW_ANDA_SALES.UNITS_NET AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", STG_TW_ANDA_SALES.PACKAGE_SIZE AS PACKS, NULL AS UNIT_PRICE, NULL AS TERRITORY, NULL AS ORDER_TYPE_CODE, NULL AS ORDER_TYPE_DESC, NULL AS LOB_CODE_DESC, NULL AS PRICE_MATRIX_DEF, ('A'::varchar(1) || lpad((STG_TW_ANDA_SALES.BILL_CUSTOMER_NO)::varchar, 9, '0'::varchar(1))) AS PARENT_BP_CODE, NULL AS PARENT_BP_DESC, NULL AS GRAND_PARENT_BP_DESC, NULL AS PO_NUMBER, NULL AS UPS_NUMBER, STG_TW_ANDA_SALES.ORDER_NO AS ORDER_NUMBER, NULL AS ORDER_LINE_NUMBER, NULL AS DISC_AMT, NULL AS WHSE_CD FROM WSMP_ADMIN.STG_TW_ANDA_SALES WHERE (STG_TW_ANDA_SALES.BRAND ~~ '%PARAGARD%'::varchar(10));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_product_lookup AS
(( SELECT '100100'::varchar(6) AS product_id,
        'Provigil'::varchar(8) AS product_desc,
        'Wake'::varchar(4) AS market_desc
 FROM v_catalog.dual UNION ALL  SELECT '100700'::varchar(6),
        'Nuvigil'::varchar(7),
        'Wake'::varchar(4)
 FROM v_catalog.dual) UNION ALL  SELECT '300500'::varchar(6),
        'Fentora'::varchar(7),
        'Pain'::varchar(4)
 FROM v_catalog.dual) UNION ALL  SELECT '700100'::varchar(6),
        'Azilect'::varchar(7),
        'Wake'::varchar(4)
 FROM v_catalog.dual;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_accountsummary AS
SELECT STG_TB_CB_ACCOUNTS.ACCOUNT_ID, STG_TB_CB_ACCOUNTS.LOCATION_ID, STG_TB_CB_ACCOUNTS.DEA_NUMBER, STG_TB_CB_ACCOUNTS.END_CUSTOMER, STG_TB_CB_ACCOUNTS.ADDRESS_1, STG_TB_CB_ACCOUNTS.ADDRESS_2, STG_TB_CB_ACCOUNTS.CITY, STG_TB_CB_ACCOUNTS.STATE, STG_TB_CB_ACCOUNTS.ZIP, STG_TB_CB_ACCOUNTS.CONTRACT_TITLE, STG_TB_CB_ACCOUNTS.CONTRACT_ID, STG_TB_CB_ACCOUNTS.WHOLESALER_NAME, STG_TB_CB_ACCOUNTS.HIN, STG_TB_CB_ACCOUNTS.CONTRACT_ALIAS, STG_TB_CB_ACCOUNTS.WHOLESALER_DEA, STG_TB_CB_ACCOUNTS.COT_SOURCE, STG_TB_CB_ACCOUNTS.CLASS_OF_TRADE FROM WSMP_ADMIN.STG_TB_CB_ACCOUNTS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_transactions_backup AS
SELECT STG_TB_CB_TRANSACTIONS.ACCOUNT_ID, STG_TB_CB_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_CB_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_CB_TRANSACTIONS.NDC_CODE, STG_TB_CB_TRANSACTIONS.PRODUCT_NAME, STG_TB_CB_TRANSACTIONS.CONTRACT_ID, STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS, STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS, to_char(STG_TB_CB_TRANSACTIONS.RECEIPT_DATE, 'YYYY-MM-DD'::varchar(10)) AS RECEIPT_DATE, STG_TB_CB_TRANSACTIONS.UNIT_AP, STG_TB_CB_TRANSACTIONS.AP, STG_TB_CB_TRANSACTIONS.DEBIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS CREDIT_MEMO_DATE, STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.SETTLEMENT_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS SETTLEMENT_DATE, STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE, STG_TB_CB_TRANSACTIONS.CONTRACT_ALIAS FROM WSMP_ADMIN.STG_TB_CB_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_transactions_backup AS
SELECT STG_TB_DS_TRANSACTIONS.ACCOUNT_ID, STG_TB_DS_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_DS_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_DS_TRANSACTIONS.NDC_CODE, STG_TB_DS_TRANSACTIONS.PRODUCT_NAME, STG_TB_DS_TRANSACTIONS.TRANSACTION_TYPE, STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS, STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS, STG_TB_DS_TRANSACTIONS.UNIT_AP, STG_TB_DS_TRANSACTIONS.AP FROM WSMP_ADMIN.STG_TB_DS_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ddd_subcategory AS
SELECT DIM_DDD_SUBCATEGORY.SUBCATEGORY_CODE, DIM_DDD_SUBCATEGORY.CATEGORY_CODE, DIM_DDD_SUBCATEGORY.COT_CODE, DIM_DDD_SUBCATEGORY.MAILORDER_FLAG, DIM_DDD_SUBCATEGORY.NONRETAIL_FLAG, DIM_DDD_SUBCATEGORY.OUTLET_EXAMPLE, DIM_DDD_SUBCATEGORY.OUTLET_DESC, DIM_DDD_SUBCATEGORY.OUTLET_DEFN, DIM_DDD_SUBCATEGORY.MDM_FLAG, DIM_DDD_SUBCATEGORY.ADM_FLAG, DIM_DDD_SUBCATEGORY.ONC_SUBCAT_GROUP FROM WSMP_ADMIN.DIM_DDD_SUBCATEGORY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_dnc AS
SELECT dnc.IMS_ID AS ims_id, dea.DEA_NUM AS dea_num, dnc.LAST_NAME AS last_name, dnc.FIRST_NAME AS first_name, dnc.MIDDLE_NAME AS mid_name, dnc.ADDRESS AS address, dnc.CITY AS city, dnc.STATE AS state, dnc.ZIP AS zip, npi.NPI AS npi FROM ((WSMP_ADMIN.DIM_DNC dnc LEFT JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((dnc.IMS_ID = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.STG_IMS_NPI npi ON ((dnc.IMS_ID = npi.IMS_ID))) WHERE ((dnc.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (dnc.SALES_FORCE_ID = 'TC'::varchar(2)) AND ((dea.DEA_NUM IS NULL) OR (regexp_replace(dea.DEA_NUM, '[0-9]'::varchar(5), ''::varchar, 1, 0, ''::varchar) IS NOT NULL)) AND ((dea.DEA_NUM IS NOT NULL) OR (npi.NPI IS NOT NULL)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_IMSZip_List AS
SELECT CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END AS ims_id, stg_ims_presc_demo_w.ims_zip AS zip FROM WSMP_ADMIN.STG_IMS_PRESC_DEMO_W WHERE ((stg_ims_presc_demo_w.sales_force_id = 'TR'::varchar(2)) AND ((stg_ims_presc_demo_w.last_name <> 'l32123'::varchar(6)) OR (stg_ims_presc_demo_w.last_name IS NULL) OR (length(stg_ims_presc_demo_w.ims_id) = 8))) GROUP BY CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END, stg_ims_presc_demo_w.ims_zip ORDER BY CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pcs_ddd_nonretail AS
SELECT TFC_PCS_DDD_NONRETAIL.TERRITORY_NUM, TFC_PCS_DDD_NONRETAIL.OUTLET_CODE, TFC_PCS_DDD_NONRETAIL.SUBCATEGORY_CODE, TFC_PCS_DDD_NONRETAIL.CATEGORY_CODE, TFC_PCS_DDD_NONRETAIL.IMS_PRODUCT_CODE, TFC_PCS_DDD_NONRETAIL.PRODUCT_CODE, TFC_PCS_DDD_NONRETAIL.MTH_YYYYMM, TFC_PCS_DDD_NONRETAIL.QTY_MTH01, TFC_PCS_DDD_NONRETAIL.QTY_MTH02, TFC_PCS_DDD_NONRETAIL.QTY_MTH03, TFC_PCS_DDD_NONRETAIL.QTY_MTH04, TFC_PCS_DDD_NONRETAIL.QTY_MTH05, TFC_PCS_DDD_NONRETAIL.QTY_MTH06, TFC_PCS_DDD_NONRETAIL.QTY_MTH07, TFC_PCS_DDD_NONRETAIL.QTY_MTH08, TFC_PCS_DDD_NONRETAIL.QTY_MTH09, TFC_PCS_DDD_NONRETAIL.QTY_MTH10, TFC_PCS_DDD_NONRETAIL.QTY_MTH11, TFC_PCS_DDD_NONRETAIL.QTY_MTH12, TFC_PCS_DDD_NONRETAIL.QTY_MTH13, TFC_PCS_DDD_NONRETAIL.QTY_MTH14, TFC_PCS_DDD_NONRETAIL.QTY_MTH15, TFC_PCS_DDD_NONRETAIL.QTY_MTH16, TFC_PCS_DDD_NONRETAIL.QTY_MTH17, TFC_PCS_DDD_NONRETAIL.QTY_MTH18, TFC_PCS_DDD_NONRETAIL.QTY_MTH19, TFC_PCS_DDD_NONRETAIL.QTY_MTH20, TFC_PCS_DDD_NONRETAIL.QTY_MTH21, TFC_PCS_DDD_NONRETAIL.QTY_MTH22, TFC_PCS_DDD_NONRETAIL.QTY_MTH23, TFC_PCS_DDD_NONRETAIL.QTY_MTH24, TFC_PCS_DDD_NONRETAIL.OUTLET_NAME, TFC_PCS_DDD_NONRETAIL.OUTLET_ADDRESS, TFC_PCS_DDD_NONRETAIL.OUTLET_CITY, TFC_PCS_DDD_NONRETAIL.OUTLET_STATE, TFC_PCS_DDD_NONRETAIL.OUTLET_ZIP FROM WSMP_ADMIN.TFC_PCS_DDD_NONRETAIL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pdrp AS
SELECT d.IMS_ID AS ims_id, d.DEA_NUM AS dea_num, d.LAST_NAME AS last_name, d.FIRST_NAME AS first_name, d.MID_NAME AS mid_name, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ADDRESS ELSE d.PTR_ADDRESS END) AS address, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_CITY ELSE d.PTR_CITY END) AS city, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_STATE ELSE d.PTR_STATE END) AS state, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ZIP ELSE d.PTR_ZIP END) AS zip, npi.NPI AS npi FROM (WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d LEFT JOIN WSMP_ADMIN.STG_IMS_NPI npi ON ((d.IMS_ID = npi.IMS_ID))) WHERE ((d.PDRP_FLAG = 'Y'::char(1)) AND ((d.DEA_NUM IS NULL) OR (regexp_replace(d.DEA_NUM, '[0-9]'::varchar(5), ''::varchar, 1, 0, ''::varchar) IS NOT NULL)) AND ((d.DEA_NUM IS NOT NULL) OR (npi.NPI IS NOT NULL))) GROUP BY d.IMS_ID, d.DEA_NUM, d.LAST_NAME, d.FIRST_NAME, d.MID_NAME, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ADDRESS ELSE d.PTR_ADDRESS END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_CITY ELSE d.PTR_CITY END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_STATE ELSE d.PTR_STATE END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ZIP ELSE d.PTR_ZIP END), npi.NPI;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_extract_backup AS
SELECT coalesce(r.VEEVA_ACCOUNT_ID, r.IMS_ID) AS account_id, r.ENROLLMENT_ID AS enrollment_id, r.NPI AS npi, r.DEA_NUM AS dea_num, r.PROGRAM_ID AS program_id, substr(r.PROGRAM_NAME, 1, 4) AS REMS_PROGRAM, r.STATUS AS enrollment_status, r.IN_PROGRESS_STEP AS current_enrollment_step, to_char(r.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(r.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT coalesce(STG_REMS_FACILITY.VEEVA_ACCOUNT_ID, STG_REMS_FACILITY.ASI_ACCOUNT_ID) AS account_id, STG_REMS_FACILITY.ENROLLMENT_ID AS enrollment_id, STG_REMS_FACILITY.NPI AS npi, STG_REMS_FACILITY.DEA AS dea, STG_REMS_FACILITY.PROGRAM_ID AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS REMS_program, STG_REMS_FACILITY.STATUS_DESCRIPTION AS enrollment_status, STG_REMS_FACILITY.IN_PROGRESS_STEP AS current_enrollment_step, to_char(STG_REMS_FACILITY.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(STG_REMS_FACILITY.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_program_lookup_backup AS
SELECT r.PROGRAM_ID AS program_id, r.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT stg_rems_facility.PROGRAM_ID AS program_id, stg_rems_facility.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_TC_Physician_Univ AS
SELECT npi.NPI AS npi, dc.dea_num, upper(dc.last_name) AS last_name, upper(dc.first_name) AS first_name, upper(dc.mid_name) AS middle_name, upper(dc.address) AS address, upper(dc.city) AS city, dc.state, dc.zip FROM WSMP_ADMIN.demo_combined dc, WSMP_ADMIN.STG_IMS_NPI npi WHERE (((dc.ims_id IS NOT NULL) OR (dc.dea_num IS NOT NULL)) AND (dc.ims_id = npi.IMS_ID) AND (dc.sales_force_id = 'TC'::varchar(2)) AND ((npi.NPI, dc.territory_num) IN (SELECT n.NPI AS npi, min(d.territory_num) AS min FROM WSMP_ADMIN.STG_IMS_NPI n, WSMP_ADMIN.demo_combined d WHERE ((d.sales_force_id = 'TC'::varchar(2)) AND (n.IMS_ID = d.ims_id)) GROUP BY n.NPI)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_TP_Physician_Univ AS
SELECT npi.NPI AS npi, dc.dea_num, upper(dc.last_name) AS last_name, upper(dc.first_name) AS first_name, upper(dc.mid_name) AS middle_name, upper(dc.address) AS address, upper(dc.city) AS city, dc.state, dc.zip FROM WSMP_ADMIN.demo_combined dc, WSMP_ADMIN.STG_IMS_NPI npi WHERE (((dc.ims_id IS NOT NULL) OR (dc.dea_num IS NOT NULL)) AND (dc.ims_id = npi.IMS_ID) AND (dc.sales_force_id = 'TP'::varchar(2)) AND ((npi.NPI, dc.territory_num) IN (SELECT n.NPI AS npi, min(d.territory_num) AS min FROM WSMP_ADMIN.STG_IMS_NPI n, WSMP_ADMIN.demo_combined d WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (n.IMS_ID = d.ims_id)) GROUP BY n.NPI)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_zs_tr_calls_obw AS
SELECT c.SALES_FORCE_ID AS sales_force_id, c.TERRITORY_NUM AS territory_num, c.VEEVA_ACCOUNT_ID AS veeva_account_id, c.IMS_ID AS ims_id, c.CALL_DATE AS call_date, cd1.PRODUCT AS first_product_detailed, cd2.PRODUCT AS second_product_detailed, cd3.PRODUCT AS third_product_detailed, cd4.PRODUCT AS fourth_product_detailed FROM ((((WSMP_ADMIN.DW_CALL c LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd1 ON (((c.DW_CALL_KEY = cd1.DW_CALL_KEY) AND (cd1.DETAIL_POSITION = 1::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd2 ON (((c.DW_CALL_KEY = cd2.DW_CALL_KEY) AND (cd2.DETAIL_POSITION = 2::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd3 ON (((c.DW_CALL_KEY = cd3.DW_CALL_KEY) AND (cd3.DETAIL_POSITION = 3::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd4 ON (((c.DW_CALL_KEY = cd4.DW_CALL_KEY) AND (cd4.DETAIL_POSITION = 4::numeric(18,0))))) WHERE ((c.SALES_FORCE_ID = 'TR'::varchar(2)) AND (c.CALL_DATE > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)) AND (c.CALL_DATE <= (trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float)) AND (c.VEEVA_ACCOUNT_ID IN (SELECT vv_account.ID AS id FROM WSMP_ADMIN.VV_ACCOUNT WHERE (vv_account.ISPERSONACCOUNT = 'true'::varchar(4)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_debarred_with_veevaid AS
SELECT dnc.SALES_FORCE_ID AS sales_force_id, sln.veeva_id, sln.state_license_number, coalesce(dea.DEA_NUM, x.ID_NUM) AS dea_num FROM (((WSMP_ADMIN.DIM_DNC dnc LEFT JOIN (SELECT acc.ID AS veeva_id, acc.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM (((((WSMP_ADMIN.VV_ACCOUNT acc JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acc.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acc.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_TSF_VOD__C tsf ON (((tsf.ACCOUNT_VOD__C = acc.ID) AND (tsf.TERRITORY_VOD__C = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acc.ID) AND (tsf.ADDRESS_VOD__C = addr.ID)))) WHERE ((g.DEVELOPERNAME ~~ 'TC%'::varchar(3)) AND (addr.LICENSE_VOD__C IS NOT NULL))) sln ON ((dnc.IMS_ID = sln.ims_id))) LEFT JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((dnc.IMS_ID = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF x ON (((dnc.CM_ID = x.CM_ID) AND (x.ID_TYPE = 'DEA_NUM'::varchar(7))))) WHERE ((dnc.DEBARRED = 'Y'::varchar(1)) AND (dnc.SALES_FORCE_ID = 'TC'::varchar(2)) AND ((dea.DEA_NUM IS NOT NULL) OR (sln.state_license_number IS NOT NULL))) GROUP BY dnc.SALES_FORCE_ID, sln.veeva_id, sln.state_license_number, coalesce(dea.DEA_NUM, x.ID_NUM);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_do_not_promote_with_veevaid_backup AS
(SELECT d.SALES_FORCE_ID AS sales_force_id, acct.ID AS veeva_id, sln.state_license_number, dea.DEA_NUM AS dea_num, d.PRODUCT_NAME AS product_name, d.SPECIALTY_GROUP AS specialty_group, 'N'::varchar(1) AS app FROM (((WSMP_ADMIN.DIM_DNC d JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((d.IMS_ID = dea.IMS_ID))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (d.SALES_FORCE_ID = sln.sales_force_id)))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) UNION SELECT 'TC'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.DEA_NUM AS dea_num, 'NUVIGIL'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((acct.ID_VOD__C = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.NUVIGIL_APP_TVA__C = 'true'::varchar(4))) UNION SELECT 'TP'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.DEA_NUM AS dea_num, 'FENTORA'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((acct.ID_VOD__C = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.FENTORA_APP_TVA__C = 'true'::varchar(4));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_rx AS
SELECT rx.STATION_NUMBER, rx.VA_PRODUCT, 0 AS PRODUCT_ID, rx.PRODUCT_CODE, to_char(rx.MONTH, 'YYYY-MM-DD'::varchar(10)) AS MONTH, CASE mod(rx.TRX_CNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.TRX_CNT)::int)::varchar ELSE rtrim((rx.TRX_CNT)::varchar, '0'::varchar(1)) END AS TRX_CNT, CASE mod(rx.CMOP_CNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CMOP_CNT)::int)::varchar ELSE rtrim((rx.CMOP_CNT)::varchar, '0'::varchar(1)) END AS CMOP_CNT, CASE mod(rx.TRX_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.TRX_QTY)::int)::varchar ELSE rtrim((rx.TRX_QTY)::varchar, '0'::varchar(1)) END AS TRX_QTY, CASE mod(rx.CMOP_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CMOP_QTY)::int)::varchar ELSE rtrim((rx.CMOP_QTY)::varchar, '0'::varchar(1)) END AS CMOP_QTY, CASE mod(rx.CNT_30_DAY_RX, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CNT_30_DAY_RX)::int)::varchar ELSE rtrim((rx.CNT_30_DAY_RX)::varchar, '0'::varchar(1)) END AS CNT_30_DAY_RX, rx.ID FROM (WSMP_ADMIN.DW_CMOP_RX_TEVA rx JOIN (SELECT dim_va_product_xref.WK_PROD_CODE AS wk_prod_code FROM CUSTOMER.DIM_VA_PRODUCT_XREF GROUP BY dim_va_product_xref.WK_PROD_CODE) p ON ((rx.PRODUCT_CODE = p.wk_prod_code)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_program AS
SELECT DIM_ASI_PROGRAM.REDEMPTION_TYPE, DIM_ASI_PROGRAM.ASI_PROGRAM_NUM, DIM_ASI_PROGRAM.PROGRAM_DESC, DIM_ASI_PROGRAM.SALES_FORCE_ID, DIM_ASI_PROGRAM.PROGRAM_TYPE, DIM_ASI_PROGRAM.PRODUCT_NAME, to_char(DIM_ASI_PROGRAM.PROGRAM_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_START_DATE, to_char(DIM_ASI_PROGRAM.PROGRAM_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_END_DATE, (DIM_ASI_PROGRAM.NUMBER_OF_TABLETS)::int AS NUMBER_OF_TABLETS FROM WSMP_ADMIN.DIM_ASI_PROGRAM;

CREATE  VIEW teva_ingestion.EXT_WHOLESALE_867 AS
 SELECT btrim(EXT_WHOLESALE_867_src.TRADING_PARTNER) AS TRADING_PARTNER,
        btrim(EXT_WHOLESALE_867_src.PARTNER_DUNS) AS PARTNER_DUNS,
        btrim(EXT_WHOLESALE_867_src.PARTNER_DUNS_4) AS PARTNER_DUNS_4,
        btrim(EXT_WHOLESALE_867_src.PARTNER_DEA) AS PARTNER_DEA,
        btrim(EXT_WHOLESALE_867_src.PARTNER_HIN) AS PARTNER_HIN,
        btrim(EXT_WHOLESALE_867_src.PARTNER_SELLER_ASSIGNED_ID) AS PARTNER_SELLER_ASSIGNED_ID,
        btrim(EXT_WHOLESALE_867_src.PARTNER_BUYER_ASSIGNED_ID) AS PARTNER_BUYER_ASSIGNED_ID,
        btrim(EXT_WHOLESALE_867_src.CLIENT_NAME) AS CLIENT_NAME,
        btrim(EXT_WHOLESALE_867_src.ADDRESS1) AS ADDRESS1,
        btrim(EXT_WHOLESALE_867_src.ADDRESS2) AS ADDRESS2,
        btrim(EXT_WHOLESALE_867_src.CITY) AS CITY,
        btrim(EXT_WHOLESALE_867_src.STATE) AS STATE,
        btrim(EXT_WHOLESALE_867_src.ZIP) AS ZIP,
        btrim(EXT_WHOLESALE_867_src.CLIENT_DUNS) AS CLIENT_DUNS,
        btrim(EXT_WHOLESALE_867_src.CLIENT_DEA) AS CLIENT_DEA,
        btrim(EXT_WHOLESALE_867_src.CLIENT_HIN) AS CLIENT_HIN,
        btrim(EXT_WHOLESALE_867_src.CLIENT_SELLER_ASSIGNED_ID) AS CLIENT_SELLER_ASSIGNED_ID,
        btrim(EXT_WHOLESALE_867_src.CLIENT_BUYER_ASSIGNED_ID) AS CLIENT_BUYER_ASSIGNED_ID,
        btrim(EXT_WHOLESALE_867_src.NCPDP) AS NCPDP,
        btrim(EXT_WHOLESALE_867_src.NDC) AS NDC,
        btrim(EXT_WHOLESALE_867_src.ITEM) AS ITEM,
        btrim(EXT_WHOLESALE_867_src.SHIP_DATE) AS SHIP_DATE,
        btrim(EXT_WHOLESALE_867_src.QUANTITY_PURCHASED) AS QUANTITY_PURCHASED,
        btrim(EXT_WHOLESALE_867_src.QUANTITY_RETURNED) AS QUANTITY_RETURNED,
        btrim(EXT_WHOLESALE_867_src.UNIT_PRICE) AS UNIT_PRICE,
        btrim(EXT_WHOLESALE_867_src.GROSS_AMOUNT) AS GROSS_AMOUNT,
        btrim(EXT_WHOLESALE_867_src.DROP_SHIPMENTS) AS DROP_SHIPMENTS,
        EXT_WHOLESALE_867_src.batch_id,
        EXT_WHOLESALE_867_src.row_id,
        EXT_WHOLESALE_867_src.update_ts
 FROM teva_ingestion.EXT_WHOLESALE_867_src
 WHERE (EXT_WHOLESALE_867_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_WHOLESALE_867'::varchar(17))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_redemption AS
SELECT coalesce(TFC_ASI_COPAY_DETAIL_WKLY.VEEVA_ACCOUNT_ID, TFC_ASI_COPAY_DETAIL_WKLY.IMS_ID) AS veeva_account_id, TFC_ASI_COPAY_DETAIL_WKLY.IMS_ID AS ims_id, TFC_ASI_COPAY_DETAIL_WKLY.REDEMPTION_TYPE AS redemption_type, to_char(TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(TFC_ASI_COPAY_DETAIL_WKLY.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY)::varchar, '0'::varchar(1)) END AS days_supply, TFC_ASI_COPAY_DETAIL_WKLY.NDC_CODE AS ndc_code, TFC_ASI_COPAY_DETAIL_WKLY.BRAND_NAME AS brand_name, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.QTY)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.QTY)::varchar, '0'::varchar(1)) END AS qty, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.REFILLS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.REFILLS)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.REFILLS)::varchar, '0'::varchar(1)) END AS refills, TFC_ASI_COPAY_DETAIL_WKLY.PROGRAM_NUM AS program_num, TFC_ASI_COPAY_DETAIL_WKLY.COPAY_CARD_NUM AS copay_voucher_num, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN AS pharmacy_chain, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NAME AS pharmacy_name, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS AS pharmacy_address, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS2 AS pharmacy_address2, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CITY AS pharmacy_city, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_STATE AS pharmacy_state, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ZIP AS pharmacy_zip, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM)::varchar, '0'::varchar(1)) END AS pharmacy_npi_num, NULL AS ceph_id, TFC_ASI_COPAY_DETAIL_WKLY.ME_NUM AS me_num, TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_DEA_NUM AS principle_phys_dea_num, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM)::varchar, '0'::varchar(1)) END AS principle_phys_npi_num, TFC_ASI_COPAY_DETAIL_WKLY.PHYSICIAN_NAME AS physician_name, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS1 AS physician_address1, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS2 AS physician_address2, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_CITY AS physician_city, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_STATE AS physician_state, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ZIP AS physician_zip, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT)::varchar, '0'::varchar(1)) END AS rebate_amount, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::varchar, '0'::varchar(1)) END AS member_cash_expense, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST)::varchar, '0'::varchar(1)) END AS submitted_cost, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE)::varchar, '0'::varchar(1)) END AS pharmacy_fee, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::varchar, '0'::varchar(1)) END AS total_amount_due, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP)::varchar, '0'::varchar(1)) END AS calc_awp, TFC_ASI_COPAY_DETAIL_WKLY.OCC_PAYMENT_TYPE AS occ_payment_type, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL)::varchar, '0'::varchar(1)) END AS new_refill FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY WHERE ((TFC_ASI_COPAY_DETAIL_WKLY.BRAND_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE < (statement_timestamp())::timestamp) AND (TFC_ASI_COPAY_DETAIL_WKLY.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE) <= 25::float)) UNION ALL SELECT coalesce(TFC_ASI_REDEMPTION_DETAIL_WKLY.VEEVA_ACCOUNT_ID, TFC_ASI_REDEMPTION_DETAIL_WKLY.IMS_ID) AS veeva_account_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.IMS_ID AS ims_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.REDEMPTION_TYPE AS redemption_type, to_char(TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(TFC_ASI_REDEMPTION_DETAIL_WKLY.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY)::varchar, '0'::varchar(1)) END AS days_supply, TFC_ASI_REDEMPTION_DETAIL_WKLY.NDC_CODE AS ndc_code, TFC_ASI_REDEMPTION_DETAIL_WKLY.PRODUCT_NAME AS brand_name, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY)::varchar, '0'::varchar(1)) END AS qty, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS)::varchar, '0'::varchar(1)) END AS refills, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROGRAM_NUM AS program_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.VOUCHER_NUM AS copay_voucher_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CHAIN AS pharmacy_chain, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NAME AS pharmacy_name, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_ADDRESS AS pharmacy_address, NULL AS pharmacy_address2, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CITY AS pharmacy_city, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_STATE AS pharmacy_state, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_ZIP AS pharmacy_zip, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM)::varchar, '0'::varchar(1)) END AS pharmacy_npi_num, NULL AS ceph_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.ME_NUM AS me_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.DEA_NUM AS dea_num, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI)::varchar, '0'::varchar(1)) END AS npi, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_NAME AS provider_name, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_ADDRESS AS provider_address, NULL AS physician_address2, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_CITY AS provider_city, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_STATE AS provider_state, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_ZIP AS provider_zip, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT)::varchar, '0'::varchar(1)) END AS rebate_amount, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::varchar, '0'::varchar(1)) END AS member_cash_expense, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST)::varchar, '0'::varchar(1)) END AS submitted_cost, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE)::varchar, '0'::varchar(1)) END AS pharmacy_fee, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::varchar, '0'::varchar(1)) END AS total_amount_due, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP)::varchar, '0'::varchar(1)) END AS calc_awp, NULL AS occ_payment_type, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL)::varchar, '0'::varchar(1)) END AS new_refill FROM WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY WHERE ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PRODUCT_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE < (statement_timestamp())::timestamp) AND (TFC_ASI_REDEMPTION_DETAIL_WKLY.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE) <= 25::float));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rxnormalizationControl2014 AS
SELECT p.IMS_CLIENT_NUM_W AS ClientNo, p.IMS_REPORT_NUM_W_CNT AS RxReportNo, lpad(p.IMS_PRODUCT_GROUP_NUM, 9, '0'::varchar(1)) AS ProductGroupNo, p.IMS_REPORT_NUM_W_QTY AS CorrespondingUnitsReportNo, p.PRODUCT_NAME AS ProductGroupName, CASE mod(nf.DIVISOR, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((nf.DIVISOR)::int)::varchar ELSE rtrim((nf.DIVISOR)::varchar, '0'::varchar(1)) END AS Divisor, CASE mod(nf.MULTIPLIER, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((nf.MULTIPLIER)::int)::varchar ELSE rtrim((nf.MULTIPLIER)::varchar, '0'::varchar(1)) END AS Multiplier FROM (WSMP_ADMIN.DRM45_PRODUCT_2014 p JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_SP_Programs AS
SELECT p.EVENT_NUMBER, p.PARENT_EVENT_NUMBER, p.EVENT_NAME, p.EVENT_STATUS_CODE, p.EVENT_STATUS_DESCRIPTION, to_char(p.EVENT_STATUS_CHANGE_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_STATUS_CHANGE_DATE, to_char(p.EVENT_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_START_DATE, to_char(p.EVENT_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_END_DATE, p.EVENT_TIME_ZONE, p.FUNDING_SOURCE, p.EVENT_TYPE, p.EVENT_TYPE_DESCRIPTION, p.EVENT_FORMAT, p.EVENT_LOCATION, to_char(p.PENDING_MGMNT_APPROVAL_DATE, 'YYYY-MM-DD'::varchar(10)) AS PENDING_MGMNT_APPROVAL_DATE, to_char(p.EVENT_APPROVAL_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_APPROVAL_DATE, p.EVENT_APPROVER_ID, to_char(p.EVENT_SCHEDULE_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_SCHEDULE_DATE, to_char(p.ATTENDEE_CLOSEOUT_DATE, 'YYYY-MM-DD'::varchar(10)) AS ATTENDEE_CLOSEOUT_DATE, to_char(p.FINANCIAL_CLOSEOUT_DATE, 'YYYY-MM-DD'::varchar(10)) AS FINANCIAL_CLOSEOUT_DATE, to_char(p.CANCELLATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS CANCELLATION_DATE, p.CANCELLATION_REASON, p.CANCELLATION_SOURCE, p.EVENT_VENUE_MIN_CNT_REQ_IND, p.EVENT_VENUE_MIN_COUNT, p.ESTIMATED_ATTENDANCE, p.VENUE_ID, p.VENUE_FULL_NAME, p.VENUE_ADDRESS_LINE_1, p.VENUE_ADDRESS_LINE_2, p.VENUE_ADDRESS_LINE_3, p.VENUE_ADDRESS_LINE_4, p.VENUE_CITY, p.VENUE_STATE_PROVINCE, p.VENUE_POSTAL_CODE, p.VENUE_POSTAL_EXTENDED_CODE, p.VENUE_COUNTRY_CODE, p.VENUE_CONTACT, p.VENUE_PHONE, p.VENUE_FAX, p.VENUE_EMAIL, p.TRADE_SECRET_INDICATOR, p.TRADE_SECRET_REASON, p.CUSTOM_FIELD_1, p.CUSTOM_FIELD_2, p.CUSTOM_FIELD_3, p.CUSTOM_FIELD_4, p.CUSTOM_FIELD_5, p.REC_STAT_CD, e.PAYMENT_ID AS payment_id, e.EXPENSE_CATEGORY AS expense_category, CASE mod(e.AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((e.AMOUNT)::int)::varchar ELSE rtrim((e.AMOUNT)::varchar, '0'::varchar(1)) END AS amount FROM (WSMP_ADMIN.STG_AHM_EVENT p LEFT JOIN WSMP_ADMIN.STG_AHM_EVENT_EXPENSE e ON ((e.EVENT_NUMBER = p.EVENT_NUMBER)));

CREATE  VIEW teva_ingestion.EXT_VV_KEY_MESSAGE_VOD__C AS
 SELECT btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.id) AS id,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.ownerid) AS ownerid,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.name) AS name,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.createddate) AS createddate,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.lastvieweddate) AS lastvieweddate,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.lastreferenceddate) AS lastreferenceddate,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.description_vod__c) AS description_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.product_vod__c) AS product_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.product_strategy_vod__c) AS product_strategy_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.display_order_vod__c) AS display_order_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.active_vod__c) AS active_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.category_vod__c) AS category_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.vehicle_vod__c) AS vehicle_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.clm_id_vod__c) AS clm_id_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.custom_reaction_vod__c) AS custom_reaction_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.slide_version_vod__c) AS slide_version_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.language_vod__c) AS language_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.media_file_crc_vod__c) AS media_file_crc_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.media_file_name_vod__c) AS media_file_name_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.media_file_size_vod__c) AS media_file_size_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.segment_vod__c) AS segment_vod__c,
        btrim(EXT_VV_KEY_MESSAGE_VOD__C_src.group_to_share_to__c) AS group_to_share_to__c,
        EXT_VV_KEY_MESSAGE_VOD__C_src.batch_id,
        EXT_VV_KEY_MESSAGE_VOD__C_src.row_id,
        EXT_VV_KEY_MESSAGE_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_KEY_MESSAGE_VOD__C_src
 WHERE (EXT_VV_KEY_MESSAGE_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_KEY_MESSAGE_VOD__C'::varchar(25))));

CREATE  VIEW teva_ingestion.MS_MTHLY_RX_QTY AS
SELECT CASE WHEN (MS_MTHLY_RX_QTY_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_MTHLY_RX_QTY_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_report_num))::int END AS ims_report_num, btrim(MS_MTHLY_RX_QTY_src.zip_other) AS zip_other, btrim(MS_MTHLY_RX_QTY_src.ims_id) AS ims_id, btrim(MS_MTHLY_RX_QTY_src.ndc) AS ndc, btrim(MS_MTHLY_RX_QTY_src.plan_id) AS plan_id, CASE WHEN (MS_MTHLY_RX_QTY_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.sales_category))::int END AS sales_category, btrim(MS_MTHLY_RX_QTY_src.rx_type) AS rx_type, CASE WHEN (MS_MTHLY_RX_QTY_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_MTHLY_RX_QTY_src.filler_01) AS filler_01, btrim(MS_MTHLY_RX_QTY_src.me_num) AS me_num, btrim(MS_MTHLY_RX_QTY_src.last_name) AS last_name, btrim(MS_MTHLY_RX_QTY_src.first_name) AS first_name, btrim(MS_MTHLY_RX_QTY_src.middle_name) AS middle_name, btrim(MS_MTHLY_RX_QTY_src.address) AS address, btrim(MS_MTHLY_RX_QTY_src.city) AS city, btrim(MS_MTHLY_RX_QTY_src.state) AS state, btrim(MS_MTHLY_RX_QTY_src.zip) AS zip, btrim(MS_MTHLY_RX_QTY_src.specialty) AS specialty, btrim(MS_MTHLY_RX_QTY_src.plan_name) AS plan_name, btrim(MS_MTHLY_RX_QTY_src.ndc_description) AS ndc_description, btrim(MS_MTHLY_RX_QTY_src.data_date) AS data_date, CASE WHEN (MS_MTHLY_RX_QTY_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_024))::numeric(9,3) END AS trx_024, MS_MTHLY_RX_QTY_src.batch_id, MS_MTHLY_RX_QTY_src.row_id, MS_MTHLY_RX_QTY_src.update_ts FROM teva_ingestion.MS_MTHLY_RX_QTY_src;

CREATE  VIEW teva_ingestion.MS_WKLY_RX_QTY AS
SELECT CASE WHEN (MS_WKLY_RX_QTY_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_WKLY_RX_QTY_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_report_num))::int END AS ims_report_num, btrim(MS_WKLY_RX_QTY_src.zip_other) AS zip_other, btrim(MS_WKLY_RX_QTY_src.ims_id) AS ims_id, btrim(MS_WKLY_RX_QTY_src.ndc) AS ndc, btrim(MS_WKLY_RX_QTY_src.plan_id) AS plan_id, CASE WHEN (MS_WKLY_RX_QTY_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.sales_category))::int END AS sales_category, btrim(MS_WKLY_RX_QTY_src.rx_type) AS rx_type, CASE WHEN (MS_WKLY_RX_QTY_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_WKLY_RX_QTY_src.filler_01) AS filler_01, btrim(MS_WKLY_RX_QTY_src.me_num) AS me_num, btrim(MS_WKLY_RX_QTY_src.last_name) AS last_name, btrim(MS_WKLY_RX_QTY_src.first_name) AS first_name, btrim(MS_WKLY_RX_QTY_src.middle_name) AS middle_name, btrim(MS_WKLY_RX_QTY_src.address) AS address, btrim(MS_WKLY_RX_QTY_src.city) AS city, btrim(MS_WKLY_RX_QTY_src.state) AS state, btrim(MS_WKLY_RX_QTY_src.zip) AS zip, btrim(MS_WKLY_RX_QTY_src.specialty) AS specialty, btrim(MS_WKLY_RX_QTY_src.plan_name) AS plan_name, btrim(MS_WKLY_RX_QTY_src.ndc_description) AS ndc_description, btrim(MS_WKLY_RX_QTY_src.data_date) AS data_date, CASE WHEN (MS_WKLY_RX_QTY_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (MS_WKLY_RX_QTY_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_WKLY_RX_QTY_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_WKLY_RX_QTY_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_WKLY_RX_QTY_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_WKLY_RX_QTY_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_WKLY_RX_QTY_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_WKLY_RX_QTY_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_WKLY_RX_QTY_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_WKLY_RX_QTY_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_WKLY_RX_QTY_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_WKLY_RX_QTY_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_WKLY_RX_QTY_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_WKLY_RX_QTY_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_WKLY_RX_QTY_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_WKLY_RX_QTY_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_WKLY_RX_QTY_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_WKLY_RX_QTY_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_WKLY_RX_QTY_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_WKLY_RX_QTY_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_WKLY_RX_QTY_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_WKLY_RX_QTY_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_WKLY_RX_QTY_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_WKLY_RX_QTY_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_WKLY_RX_QTY_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (MS_WKLY_RX_QTY_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (MS_WKLY_RX_QTY_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (MS_WKLY_RX_QTY_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (MS_WKLY_RX_QTY_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (MS_WKLY_RX_QTY_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (MS_WKLY_RX_QTY_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (MS_WKLY_RX_QTY_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (MS_WKLY_RX_QTY_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (MS_WKLY_RX_QTY_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (MS_WKLY_RX_QTY_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (MS_WKLY_RX_QTY_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (MS_WKLY_RX_QTY_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (MS_WKLY_RX_QTY_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (MS_WKLY_RX_QTY_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (MS_WKLY_RX_QTY_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (MS_WKLY_RX_QTY_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (MS_WKLY_RX_QTY_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (MS_WKLY_RX_QTY_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (MS_WKLY_RX_QTY_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (MS_WKLY_RX_QTY_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (MS_WKLY_RX_QTY_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (MS_WKLY_RX_QTY_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (MS_WKLY_RX_QTY_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (MS_WKLY_RX_QTY_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (MS_WKLY_RX_QTY_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (MS_WKLY_RX_QTY_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (MS_WKLY_RX_QTY_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (MS_WKLY_RX_QTY_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (MS_WKLY_RX_QTY_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (MS_WKLY_RX_QTY_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (MS_WKLY_RX_QTY_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (MS_WKLY_RX_QTY_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (MS_WKLY_RX_QTY_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (MS_WKLY_RX_QTY_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (MS_WKLY_RX_QTY_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (MS_WKLY_RX_QTY_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (MS_WKLY_RX_QTY_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (MS_WKLY_RX_QTY_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (MS_WKLY_RX_QTY_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (MS_WKLY_RX_QTY_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (MS_WKLY_RX_QTY_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (MS_WKLY_RX_QTY_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (MS_WKLY_RX_QTY_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (MS_WKLY_RX_QTY_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (MS_WKLY_RX_QTY_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (MS_WKLY_RX_QTY_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (MS_WKLY_RX_QTY_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (MS_WKLY_RX_QTY_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (MS_WKLY_RX_QTY_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (MS_WKLY_RX_QTY_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (MS_WKLY_RX_QTY_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (MS_WKLY_RX_QTY_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (MS_WKLY_RX_QTY_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (MS_WKLY_RX_QTY_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (MS_WKLY_RX_QTY_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (MS_WKLY_RX_QTY_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (MS_WKLY_RX_QTY_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (MS_WKLY_RX_QTY_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (MS_WKLY_RX_QTY_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (MS_WKLY_RX_QTY_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (MS_WKLY_RX_QTY_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (MS_WKLY_RX_QTY_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (MS_WKLY_RX_QTY_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (MS_WKLY_RX_QTY_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (MS_WKLY_RX_QTY_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (MS_WKLY_RX_QTY_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (MS_WKLY_RX_QTY_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (MS_WKLY_RX_QTY_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (MS_WKLY_RX_QTY_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (MS_WKLY_RX_QTY_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (MS_WKLY_RX_QTY_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (MS_WKLY_RX_QTY_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (MS_WKLY_RX_QTY_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (MS_WKLY_RX_QTY_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (MS_WKLY_RX_QTY_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (MS_WKLY_RX_QTY_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (MS_WKLY_RX_QTY_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (MS_WKLY_RX_QTY_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (MS_WKLY_RX_QTY_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (MS_WKLY_RX_QTY_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (MS_WKLY_RX_QTY_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (MS_WKLY_RX_QTY_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (MS_WKLY_RX_QTY_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (MS_WKLY_RX_QTY_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (MS_WKLY_RX_QTY_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (MS_WKLY_RX_QTY_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (MS_WKLY_RX_QTY_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (MS_WKLY_RX_QTY_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (MS_WKLY_RX_QTY_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (MS_WKLY_RX_QTY_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (MS_WKLY_RX_QTY_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (MS_WKLY_RX_QTY_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (MS_WKLY_RX_QTY_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (MS_WKLY_RX_QTY_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (MS_WKLY_RX_QTY_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (MS_WKLY_RX_QTY_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (MS_WKLY_RX_QTY_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (MS_WKLY_RX_QTY_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (MS_WKLY_RX_QTY_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (MS_WKLY_RX_QTY_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (MS_WKLY_RX_QTY_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (MS_WKLY_RX_QTY_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (MS_WKLY_RX_QTY_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (MS_WKLY_RX_QTY_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (MS_WKLY_RX_QTY_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (MS_WKLY_RX_QTY_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (MS_WKLY_RX_QTY_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (MS_WKLY_RX_QTY_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_132))::numeric(9,3) END AS trx_132, MS_WKLY_RX_QTY_src.batch_id, MS_WKLY_RX_QTY_src.row_id, MS_WKLY_RX_QTY_src.update_ts FROM teva_ingestion.MS_WKLY_RX_QTY_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_caremark_external_match AS
SELECT foo2.caremark_md_id AS source_key, 'CAREMARK'::varchar(8) AS source_name, 'CAREMARK'::varchar(8) AS file_name, btrim(((foo2.first_name || ' '::varchar(1)) || foo2.last_name)) AS person_name, NULL AS organization_name, 99 AS ex_sub_type, 1 AS ex_hce_type, NULL AS ex_communication_type, NULL AS ex_alt_id_value, NULL AS ex_alt_id, NULL AS ex_communication_value, foo2.state AS ex_state, foo2.zip AS ex_zip, NULL AS ex_alt_id_state, foo2.city AS ex_city, NULL AS ex_suffix, btrim(((coalesce(foo2.first_name, ''::varchar) || ' '::varchar(1)) || coalesce(foo2.last_name, ''::varchar))) AS ex_person_name, NULL AS ex_organization_name, foo2.address1 AS address_part1, foo2.address1 AS ex_address_line1, foo2.address2 AS ex_address_line2, btrim(((coalesce(foo2.address1, ''::varchar) || ' '::varchar(1)) || coalesce(foo2.address2, ''::varchar))) AS ex_address FROM (SELECT foo1.CAREMARK_MD_ID AS caremark_md_id, foo1.LAST_NAME AS last_name, foo1.FIRST_NAME AS first_name, foo1.NPI AS npi, CASE WHEN ((foo1.ADDRESS1 IS NULL) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS2 WHEN ((foo1.ADDRESS1 ~~ 'STE %'::varchar(5)) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS2 ELSE foo1.ADDRESS1 END AS address1, CASE WHEN ((foo1.ADDRESS1 IS NULL) AND (foo1.ADDRESS2 IS NOT NULL)) THEN NULL WHEN ((foo1.ADDRESS1 ~~ 'STE %'::varchar(5)) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS1 ELSE foo1.ADDRESS2 END AS address2, foo1.CITY AS city, foo1.STATE AS state, foo1.ZIP AS zip, foo1.oldest_ship_date, foo1.SHIP_DATE AS current_ship_date, foo1.how_many_rows FROM (SELECT c.CAREMARK_MD_ID, c.LAST_NAME, c.FIRST_NAME, c.NPI, c.ADDRESS1, c.ADDRESS2, c.CITY, c.STATE, c.ZIP, c.PRODUCT_NDC, c.SHIP_DATE, c.QTY, c.IMS_ID, c.IMS_ID_VIA, c.LAST_BUILD_DATE, c.PRODUCT_CODE, c.TRX_CNT, c.IMS_PRODUCT_GROUP_NUM, row_number() OVER (PARTITION BY c.CAREMARK_MD_ID ORDER BY c.SHIP_DATE DESC) AS rnk, count(1) OVER (PARTITION BY c.CAREMARK_MD_ID) AS how_many_rows, min(c.SHIP_DATE) OVER (PARTITION BY c.CAREMARK_MD_ID) AS oldest_ship_date FROM WSMP_ADMIN.STG_CAREMARK_RX c WHERE ((c.IMS_ID IS NULL) AND (c.LAST_NAME <> 'UNAVAILABLE'::varchar(11)) AND ((c.ADDRESS1 IS NOT NULL) OR (c.ADDRESS2 IS NOT NULL)))) foo1 WHERE (foo1.rnk = 1)) foo2 ORDER BY foo2.caremark_md_id;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ftf_ims_monthly_market_obm AS
SELECT substr(rx.payer_plan_num, 1, 6) AS "PLAN ID", rx.plan_name AS "PLAN NAME", substr(rx.payer_plan_num, ((length(rx.payer_plan_num) - 4) + 1), 4) AS "PAYER ID", rx.payer_name AS "PAYER NAME", rx.market_name AS "MARKET NAME", rx.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx WHERE (rx.market_name = ANY (ARRAY['ANTI-PARKINSON'::varchar(14), 'BDP NASAL'::varchar(9), 'ICS'::varchar(3), 'MULTIPLE SCLEROSIS'::varchar(18), 'SABA'::varchar(4), 'WAKE'::varchar(4)])) GROUP BY rx.payer_plan_num, rx.plan_name, rx.payer_name, rx.market_name, rx.product_name, rx.zip, rx.month_ending;

CREATE  VIEW raw.addresses AS
 SELECT src.ADDR_ID,
        src.LINE_1,
        src.LINE_2,
        src.LINE_3,
        src.CITY,
        src.ST_ABBR,
        src.POSTAL_CD,
        src.CNTRY_ISO_ABBR,
        src.CRT_USER,
        src.CRT_DT,
        src.UPD_USER,
        src.UPD_DT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.addresses_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ADDRESSES'::varchar(9)))));

CREATE  VIEW raw.associates AS
 SELECT src.TEVA_ID,
        src.HR_ID,
        src.CRT_USER,
        src.CRT_DT,
        src.UPD_USER,
        src.UPD_DT,
        src.HIRE_DT,
        src.LOGON_ID,
        src.REPORTS_TO,
        src.STAT_CD,
        src.TYPE_CD,
        src.FULL_TIME,
        src.EEO_CAT,
        src.EXEMPT,
        src.EXPENSE_COST_CTR,
        src.HRS_PER_WK,
        src.MARITAL_STAT,
        src.RACE,
        src.SSN,
        src.EMAIL,
        src.BIRTH_DT,
        src.COUNTRY_ID,
        src.DFLT_CURR_ID,
        src.TERR_ID,
        src.OFFICE,
        src.PRSN_SYS_ID,
        src.LANGUAGE,
        src."POSITION",
        src.TERM_DT,
        src.LAST_WRK_DT,
        src.AUTH_LIMIT,
        src.VEHICLE,
        src.VACATION_DAYS,
        src.CHK_REQ_LIMIT,
        src.EXPENSE_REPORT_APPROVER,
        src.LOC_CD,
        src.PAY_CD,
        src.ED_CD,
        src.ED_CD_DT,
        src.JOB_CD,
        src.CNTRY_CITIZENSHIP,
        src.DISABLED,
        src.VIETNAM_VET,
        src.EMERGENCY_CONTACT_NAME,
        src.EMERGENCY_CONTACT_RELATIONSHIP,
        src.EMERGENCY_CONTACT_PHONE,
        src.ADP_DEPT_NUM,
        src.VACATION_YR,
        src.FIN_AUTH_COMMENTS,
        src.EEO_CAT_HR_UPDT,
        src.EXPENSE_REPORTING,
        src.COMPANY_ID,
        src.CHECK_REQUEST_APPROVER,
        src.INVOICE_APPROVER,
        src.PHANTOM_IND,
        src.PAYROLL_COST_CTR,
        src.SAMPLE_AUTH,
        src.ORACLE_STRING,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.associates_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ASSOCIATES'::varchar(10)))));

CREATE  VIEW raw.aud_associates AS
 SELECT src.TEVA_ID,
        src.HR_ID,
        src.CRT_USER,
        src.CRT_DT,
        src.UPD_USER,
        src.UPD_DT,
        src.HIRE_DT,
        src.LOGON_ID,
        src.REPORTS_TO,
        src.STAT_CD,
        src.TYPE_CD,
        src.FULL_TIME,
        src.EEO_CAT,
        src.EXEMPT,
        src.EXPENSE_COST_CTR,
        src.HRS_PER_WK,
        src.MARITAL_STAT,
        src.RACE,
        src.SSN,
        src.EMAIL,
        src.BIRTH_DT,
        src.COUNTRY_ID,
        src.DFLT_CURR_ID,
        src.TERR_ID,
        src.OFFICE,
        src.PRSN_SYS_ID,
        src.LANGUAGE,
        src."POSITION",
        src.TERM_DT,
        src.LAST_WRK_DT,
        src.AUTH_LIMIT,
        src.VEHICLE,
        src.VACATION_DAYS,
        src."TIMESTAMP",
        src.ACTION,
        src.CHK_REQ_LIMIT,
        src.EXPENSE_REPORT_APPROVER,
        src.LOC_CD,
        src.PAY_CD,
        src.ED_CD,
        src.ED_CD_DT,
        src.JOB_CD,
        src.CNTRY_CITIZENSHIP,
        src.DISABLED,
        src.VIETNAM_VET,
        src.EMERGENCY_CONTACT_NAME,
        src.EMERGENCY_CONTACT_RELATIONSHIP,
        src.EMERGENCY_CONTACT_PHONE,
        src.ADP_DEPT_NUM,
        src.EEO_CAT_HR_UPDT,
        src.COMPANY_ID,
        src.EXPENSE_REPORTING,
        src.PHANTOM_IND,
        src.CHECK_REQUEST_APPROVER,
        src.INVOICE_APPROVER,
        src.VACATION_YR,
        src.FIN_AUTH_COMMENTS,
        src.PAYROLL_COST_CTR,
        src.SAMPLE_AUTH,
        src.ORACLE_STRING,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.aud_associates_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'AUD_ASSOCIATES'::varchar(14)))));

CREATE  VIEW raw.c_bo_hce_alt_identifier AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.TVCMID,
        src.ALTERNATE_ID_VALUE,
        src.ALTERNATE_ID_TYPE,
        src.SOURCE_DEACT_REASON_CODE,
        src.SOURCE_DEACT_REASON_DESC,
        src.IDENTIFIER_CAT,
        src.STATUS,
        src.STATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.c_bo_hce_alt_identifier_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_HCE_ALT_IDENTIFIER'::varchar(23)))));

CREATE  VIEW raw.c_bo_hce_raw_dea AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.TVCMID,
        src.IMS_ID,
        src.DEA_NUMBER,
        src.NAME,
        src.ADDITIONAL_COMPANY_INFO,
        src.ADDRESS_LINE1,
        src.ADDRESS_LINE2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.BUSINESS_ACTIVITY_CODE,
        src.DRUG_SCHEDULES,
        src.EXPIRATION_DATE,
        src.BUSINESS_ACTIVITY_SUB_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.C_BO_HCE_RAW_DEA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_HCE_RAW_DEA'::varchar(16)))));

CREATE  VIEW raw.c_bo_hcp_detail AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.TVCMID,
        src.IMS_PRESCRIBER_ID,
        src.PREFIX,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.MIDDLE_NAME,
        src.SUFFIX,
        src.HEALTHCARE_PROF_STATUS_CD,
        src.YEAR_OF_BIRTH,
        src.DATE_OF_DEATH,
        src.GENDER_CODE,
        src.TEVA_SPECIALTY_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.C_BO_HCP_DETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_HCP_DETAIL'::varchar(15)))));

CREATE  VIEW raw.c_bo_ims_flag AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.FLAG_TYPE,
        src.FLAG_VALUE,
        src.EFFECTIVE_DATE,
        src.HCP_DETAIL_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.C_BO_IMS_FLAG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_IMS_FLAG'::varchar(13)))));

CREATE  VIEW raw.c_bo_teva_flag AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.FLAG_TYPE,
        src.FLAG_VALUE,
        src.EFFECTIVE_DATE,
        src.HCP_DETAIL_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.C_BO_TEVA_FLAG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_TEVA_FLAG'::varchar(14)))));

CREATE  VIEW raw.c_bo_teva_sample_elig AS
 SELECT src.ROWID_OBJECT,
        src.CREATOR,
        src.CREATE_DATE,
        src.UPDATED_BY,
        src.LAST_UPDATE_DATE,
        src.CONSOLIDATION_IND,
        src.DELETED_IND,
        src.DELETED_BY,
        src.DELETED_DATE,
        src.LAST_ROWID_SYSTEM,
        src.DIRTY_IND,
        src.INTERACTION_ID,
        src.HUB_STATE_IND,
        src.CM_DIRTY_IND,
        src.TVCMID,
        src.CERTIFICATION_DESC,
        src.SLN,
        src.SLN_STATE,
        src.SLN_EXPIRATION_DATE,
        src.SLN_STATUS_CODE,
        src.SLN_STATUS_DESC,
        src.TEVA_SAMPLE_ELIG_FLAG,
        src.TEVA_SCHED_IV_ELIG_FLAG,
        src.TEVA_SCHED_V_ELIG_FLAG,
        src.PROFESSION_SHORT_DESC,
        src.TEVA_SPECIALTY_CODE,
        src.CERTIFICATION_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.c_bo_teva_sample_elig_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'C_BO_TEVA_SAMPLE_ELIG'::varchar(21)))));

CREATE  VIEW raw.ext_ahm_event_expense AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.PAYMENT_ID,
        src.EXPENSE_CATEGORY,
        src.AMOUNT,
        src.REMIT_TO_ID,
        src.RECIPIENT_ID,
        src.CHECK_NUMBER,
        src.CHECK_DATE,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_EXPENSE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_EXPENSE'::varchar(21)))));

CREATE  VIEW raw.ext_ahm_event_host AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.EMPLOYEE_ID,
        src.TERRITORY,
        src.ORDINAL,
        src.BUDGET_PERCENT,
        src.BUDGET_POOL,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_HOST_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_HOST'::varchar(18)))));

CREATE  VIEW raw.ext_ahm_event_product AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.PRODUCT_ID,
        src.PRODUCT_NAME,
        src.TOPIC_ID,
        src.TOPIC_NAME,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_PRODUCT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_PRODUCT'::varchar(21)))));

CREATE  VIEW raw.ext_ahm_event_speaker AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.EVENT_SPEAKER_STATUS,
        src.SPEAKER_ID,
        src.PRODUCT_ID,
        src.TOPIC_ID,
        src.CANCELLATION_REASON,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_SPEAKER_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_SPEAKER'::varchar(21)))));

CREATE  VIEW raw.ext_ahm_organization AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.AHM_ORG_ID,
        src.NAME,
        src.ADDRESS_LINE_1,
        src.ADDRESS_LINE_2,
        src.ADDRESS_LINE_3,
        src.ADDRESS_LINE_4,
        src.CITY,
        src.STATE_PROVINCE,
        src.POSTAL_CODE,
        src.POSTAL_EXTENDED_CODE,
        src.COUNTRY_CODE,
        src.PHONE,
        src.FAX,
        src.EMAIL,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_ORGANIZATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_ORGANIZATION'::varchar(20)))));

CREATE  VIEW raw.ext_ahm_speaker_contract AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.SPEAKER_ID,
        src.CONTRACT_TYPE_CODE,
        src.CONTRACT_TYPE_NAME,
        src.CONTRACT_EFFECTIVE_DATE,
        src.CONTRACT_EXPIRATION_DATE,
        src.CONTRACT_SIGNED_DATE,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_SPEAKER_CONTRACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_SPEAKER_CONTRACT'::varchar(24)))));

CREATE  VIEW raw.ext_ahm_speaker_license AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.SPEAKER_ID,
        src.STATE_CODE,
        src.STATE_LICENSE_NUMBER,
        src.STATE_LICENSE_EFFECTIVE_DATE,
        src.STATE_LICENSE_EXPIRATION_DATE,
        src.DEBARMENT_INDICATOR,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_SPEAKER_LICENSE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_SPEAKER_LICENSE'::varchar(23)))));

CREATE  VIEW raw.ext_ahm_speaker_profile AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.SPEAKER_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.MIDDLE_NAME,
        src.TITLE,
        src.ADDRESS_LINE_1,
        src.ADDRESS_LINE_2,
        src.ADDRESS_LINE_3,
        src.ADDRESS_LINE_4,
        src.CITY,
        src.STATE_PROVINCE,
        src.POSTAL_CODE,
        src.POSTAL_EXTENDED_CODE,
        src.COUNTRY_CODE,
        src.BUSINESS_PHONE,
        src.BUSINESS_PHONE_EXTENSION,
        src.HOME_PHONE,
        src.MOBILE_PHONE,
        src.BUSINESS_FAX,
        src.HOME_FAX,
        src.EMAIL,
        src.SPECIALTY,
        src.PERSONAL_SUFFIX,
        src.DEGREE,
        src.ME_NUMBER,
        src.IMS_NUMBER,
        src.DEA_NUMBER,
        src.NPI_NUMBER,
        src.CLINICAL_AFFILIATION,
        src.CLINICAL_TITLE,
        src.ACADEMIC_AFFILIATION,
        src.OTHER_AFFILIATION,
        src.FEDERAL_EMPLOYEE_INDICATOR,
        src.STATE_EMPLOYEE_INDICATOR,
        src.LOCAL_EMPLOYEE_INDICATOR,
        src.FDA_DEBARMENT_INDICATOR,
        src.OFAC_DEBARMENT_INDICATOR,
        src.OIG_EXCLUSION_INDICATOR,
        src.SPEAKER_BIOGRAPHY,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_SPEAKER_PROFILE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_SPEAKER_PROFILE'::varchar(23)))));

CREATE  VIEW raw.ext_ahm_speaker_training AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.SPEAKER_ID,
        src.TOPIC_ID,
        src.EFFECTIVE_DATE,
        src.EXPIRATION_DATE,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_SPEAKER_TRAINING_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_SPEAKER_TRAINING'::varchar(24)))));

CREATE  VIEW raw.ext_ahm_topic_product AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.TOPIC_ID,
        src.TOPIC_NAME,
        src.PRODUCT_ID,
        src.PRODUCT_NAME,
        src.EFFECTIVE_DATE,
        src.EXPIRATION_DATE,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_TOPIC_PRODUCT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_TOPIC_PRODUCT'::varchar(21)))));

CREATE  VIEW raw.ext_anda_sales AS
 SELECT src.TRANSACTION_ID,
        src.INVOICE_DATE,
        src.PRODUCT_BRAND,
        src.PRODUCT_NDC,
        src.PRODUCT_DESC,
        src.INVOICE_QTY,
        src.INVOICE_UNITS,
        src.INVOICE_COST,
        src.INVOICE_PACK_COST,
        src.INVOICE_UNIT_COST,
        src.CONTRACT_PACK_COST,
        src.CONTRACT_PURCHASES,
        src.CONTRACT_NUMBER,
        src.DISPENSING_LOCATION,
        src.DL_ADDRESS_1,
        src.DL_ADDRESS_2,
        src.DL_CITY,
        src.DL_STATE,
        src.DL_ZIP,
        src.DL_DEA_NUM,
        src.DEPOT_LOCATION,
        src.DEP_ADDRESS_1,
        src.DEP_ADDRESS_2,
        src.DEP_CITY,
        src.DEP_STATE,
        src.DEP_ZIP,
        src.DEP_DEA_NUM,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ANDA_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ANDA_SALES'::varchar(14)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.RX_DATE,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.NDC_CODE,
        src.DAW,
        src.DRUG_NAME,
        src.DRUG_DESC,
        src.NEW_REFILL,
        src.QUANTITY,
        src.REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.COUPON_NUM,
        src.SEX,
        src.AGE_AT_REDEMPTION,
        src.PHARMACY_PROCESS_DATE,
        src.PHARMACY_CHAIN_NUM,
        src.NABP,
        src.PHARMACY_CHAIN,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_NPI_NUM,
        src.PRINCIPLE_PHYS_DEA_NUM,
        src.PHYS_NPI,
        src.PHYSICIAN_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.SUBMITTED_COST,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.CALC_AWP,
        src.CREATE_DATE,
        src.OCC_PAYMENT_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly_cgd AS
 SELECT src.TRANSACTION_TYPE,
        src.DATE_FILLED,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.PRODUCT_SERVICE_CODE,
        src.DRUG_DESCRIPTION,
        src.NEW_REFILL_INDICATOR,
        src.QUANTITY_DISPENSED,
        src.REFILLS_AUTHORIZED,
        src.PATIENT_PAID_AMOUNT,
        src.PATIENT_PAID_AMOUNT_QUALIFIER,
        src.STATUS,
        src.OTHER_COVERAGE,
        src.GROUP_NUMBER,
        src.MEMBER_NUMBER,
        src.TIME_STAMP,
        src.PHARMACY_NABP,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS_LINE_1,
        src.PHARMACY_ADDRESS_LINE_2,
        src.PHARMACY_ADDRESS_LINE_3,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.DOCTOR_DEA,
        src.TOTAL_AMOUNT_AUTHORIZED,
        src.FEE,
        src.PROVIDER_REIMB,
        src.COPAY,
        src.COUPON_AMOUNT,
        src.DOCTOR_CITY,
        src.DOCTOR_STATE,
        src.DOCTOR_ZIP,
        src.CUSTOMER_PHYSICIAN_ID,
        src.DOCTOR_LAST_NAME,
        src.DOCTOR_FIRST_NAME,
        src.DOCTOR_MIDDLE_NAME,
        src.DOCTOR_TITLE_CODE,
        src.DOCTOR_ADDRESS_LINE_1,
        src.DOCTOR_ADDRESS_LINE_2,
        src.DOCTOR_ADDRESS_LINE_3,
        src.DOCTOR_STATE_LICENSE_NUMBER,
        src.SLN_STATE,
        src.SPECIALTY,
        src.PROGRAM_NAME,
        src.BRAND,
        src.PHARMACY_COMPANY,
        src.DOCTOR_NPI,
        src.LINKED_CARDS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_CGD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_CGD'::varchar(29)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly_combo_2 AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.RX_DATE,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.NDC_CODE,
        src.DAW,
        src.DRUG_NAME,
        src.DRUG_DESC,
        src.NEW_REFILL,
        src.QUANTITY,
        src.REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.COUPON_NUM,
        src.SEX,
        src.AGE_AT_REDEMPTION,
        src.PHARMACY_PROCESS_DATE,
        src.PHARMACY_CHAIN_NUM,
        src.NABP,
        src.PHARMACY_CHAIN,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_NPI_NUM,
        src.PRINCIPLE_PHYS_DEA_NUM,
        src.PHYS_NPI,
        src.PHYSICIAN_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.SUBMITTED_COST,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.CALC_AWP,
        src.CREATE_DATE,
        src.OCC_PAYMENT_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2'::varchar(33)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly_combo_3 AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.RX_DATE,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.NDC_CODE,
        src.DAW,
        src.DRUG_NAME,
        src.DRUG_DESC,
        src.NEW_REFILL,
        src.QUANTITY,
        src.REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.COUPON_NUM,
        src.SEX,
        src.AGE_AT_REDEMPTION,
        src.PHARMACY_PROCESS_DATE,
        src.PHARMACY_CHAIN_NUM,
        src.NABP,
        src.PHARMACY_CHAIN,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_NPI_NUM,
        src.PRINCIPLE_PHYS_DEA_NUM,
        src.PHYS_NPI,
        src.PHYSICIAN_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.SUBMITTED_COST,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.CALC_AWP,
        src.CREATE_DATE,
        src.OCC_PAYMENT_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3'::varchar(33)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly_pskw AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.DATE_OF_FILL,
        src.DATE_WRITTEN,
        src.DAY_SUPPLY,
        src.DAW,
        src.NDC,
        src.DRUG_DESC,
        src.NEW_REFILL_CODE,
        src.NUMBER_OF_REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.MEMBER_ID,
        src.PATIENT_GENDER,
        src.PATIENT_AGE,
        src.DATE_PROCESSED,
        src.NABP,
        src.PHM_NAME,
        src.PHM_ADD1,
        src.PHM_ADD2,
        src.PHM_CITY,
        src.PHM_STATE,
        src.PHM_ZIP,
        src.PHARMACY_NPI,
        src.NPI,
        src.DEA,
        src.PHY_NAME,
        src.PHY_FN,
        src.PHY_MI,
        src.PHY_LN,
        src.PHY_SUFFIX,
        src.PHY_PROF_DESG,
        src.SPEC1,
        src.SPEC2,
        src.PHY_ADD1,
        src.PHY_ADD2,
        src.PHY_CITY,
        src.PHY_STATE,
        src.PHY_ZIP,
        src.SUBMISSION_METHOD,
        src.QUANTITY,
        src.PATIENT_BENEFIT,
        src.PATIENT_COPAY,
        src.PATIENT_OOP,
        src.PHARMACY_TRANSACTION_FEE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_PSKW'::varchar(30)))));

CREATE  VIEW raw.ext_asi_copay_redemptions AS
 SELECT src.ASI_TXN_ID,
        src.TERRITORY_NUM,
        src.PROGRAM_NUM,
        src.CLAIM_CERT_NUM,
        src.RX_DATE,
        src.NDC_CODE,
        src.QUANTITY,
        src.SUBMITTED_COST,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.DOB,
        src.SEX,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PRINCIPAL_PHYS_LAST_NAME,
        src.PRINCIPAL_PHYS_FIRST_NAME,
        src.PRINCIPAL_PHYS_DEA_NUM,
        src.COMPANY_PHYS_LAST_NAME,
        src.COMPANY_PHYS_FIRST_NAME,
        src.COMPANY_PHYS_ADDRESS1,
        src.COMPANY_PHYS_ADDRESS2,
        src.COMPANY_PHYS_CITY,
        src.COMPANY_PHYS_STATE,
        src.COMPANY_PHYS_ZIP,
        src.ASI_PHYS_LAST_NAME,
        src.ASI_PHYS_FIRST_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.NPI,
        src.OTHER_COVERAGE_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_REDEMPTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_REDEMPTIONS'::varchar(25)))));

CREATE  VIEW raw.ext_asi_redemptions AS
 SELECT src.ASI_TXN_ID,
        src.TERRITORY_NUM,
        src.PROGRAM_NUM,
        src.CLAIM_CERT_NUM,
        src.RX_DATE,
        src.NDC_CODE,
        src.QUANTITY,
        src.DOB,
        src.SEX,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PRINCIPAL_PHYS_LAST_NAME,
        src.PRINCIPAL_PHYS_FIRST_NAME,
        src.PRINCIPAL_PHYS_DEA_NUM,
        src.COMPANY_PHYS_LAST_NAME,
        src.COMPANY_PHYS_FIRST_NAME,
        src.COMPANY_PHYS_ADDRESS1,
        src.COMPANY_PHYS_ADDRESS2,
        src.COMPANY_PHYS_CITY,
        src.COMPANY_PHYS_STATE,
        src.COMPANY_PHYS_ZIP,
        src.ASI_PHYS_LAST_NAME,
        src.ASI_PHYS_FIRST_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.NPI,
        src.OTHER_COVERAGE_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_REDEMPTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_REDEMPTIONS'::varchar(19)))));

CREATE  VIEW raw.ext_asi_voucher_detail_wkly_combo_1 AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.RX_DATE,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.NDC_CODE,
        src.DAW,
        src.DRUG_NAME,
        src.DRUG_DESC,
        src.NEW_REFILL,
        src.QUANTITY,
        src.REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.COUPON_NUM,
        src.SEX,
        src.AGE_AT_REDEMPTION,
        src.PHARMACY_PROCESS_DATE,
        src.PHARMACY_CHAIN_NUM,
        src.NABP,
        src.PHARMACY_CHAIN,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_NPI_NUM,
        src.PRINCIPLE_PHYS_DEA_NUM,
        src.PHYS_NPI,
        src.PHYSICIAN_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.SUBMITTED_COST,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.CALC_AWP,
        src.CREATE_DATE,
        src.OCC_PAYMENT_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1'::varchar(35)))));

CREATE  VIEW raw.ext_asi_voucher_detail_wkly_voucher AS
 SELECT src.TRANS_TYPE,
        src.ASI_TXN_ID,
        src.ORIG_ASI_TXN_ID,
        src.RX_NUM,
        src.RX_DATE,
        src.DATE_WRITTEN,
        src.DAYS_SUPPLY,
        src.NDC_CODE,
        src.DAW,
        src.DRUG_NAME,
        src.DRUG_DESC,
        src.NEW_REFILL,
        src.QUANTITY,
        src.REFILLS,
        src.OTHER_COVERAGE_CODE,
        src.GROUP_NUM,
        src.COUPON_NUM,
        src.SEX,
        src.AGE_AT_REDEMPTION,
        src.PHARMACY_PROCESS_DATE,
        src.PHARMACY_CHAIN_NUM,
        src.NABP,
        src.PHARMACY_CHAIN,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_NPI_NUM,
        src.PRINCIPLE_PHYS_DEA_NUM,
        src.PHYS_NPI,
        src.PHYSICIAN_NAME,
        src.ASI_PHYS_ADDRESS1,
        src.ASI_PHYS_ADDRESS2,
        src.ASI_PHYS_CITY,
        src.ASI_PHYS_STATE,
        src.ASI_PHYS_ZIP,
        src.REBATE_AMOUNT,
        src.MEMBER_CASH_EXPENSE,
        src.SUBMITTED_COST,
        src.PHARMACY_FEE,
        src.TOTAL_AMOUNT_DUE,
        src.CALC_AWP,
        src.CREATE_DATE,
        src.OCC_PAYMENT_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER'::varchar(35)))));

CREATE  VIEW raw.ext_call_goals_kc AS
 SELECT src.ID,
        src.SFA_ID,
        src.IMS_ID,
        src.TERRITORY_NUM,
        src.PRIORITY,
        src.PRODUCT,
        src.GOAL,
        src.ACTUAL,
        src.MARKETING_SEGMENT,
        src.EFFECTIVE_DATE,
        src.SALES_FORCE_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_call_goals_kc_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CALL_GOALS_KC'::varchar(17)))));

CREATE  VIEW raw.ext_caremark_rx2_aob AS
 SELECT src.MD_ID,
        src.MD_LAST_NAME,
        src.MD_FIRST_NAME,
        src.PRESCRIBER_NPI,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.NDC_NUMBER,
        src.SHIP_DATE,
        src.QTY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CAREMARK_RX2_AOB_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CAREMARK_RX2_AOB'::varchar(20)))));

CREATE  VIEW raw.ext_caremark_rx2_medicare AS
 SELECT src.MD_ID,
        src.MD_LAST_NAME,
        src.MD_FIRST_NAME,
        src.PRESCRIBER_NPI,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.NDC_NUMBER,
        src.SHIP_DATE,
        src.QTY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CAREMARK_RX2_MEDICARE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CAREMARK_RX2_MEDICARE'::varchar(25)))));

CREATE  VIEW raw.ext_clm_presentation_slide_vc AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.CLM_PRESENTATION_VOD__C,
        src.KEY_MESSAGE_VOD__C,
        src.DISPLAY_ORDER_VOD__C,
        src.SUB_PRESENTATION_VOD__C,
        src.MOBILE_ID_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CLM_PRESENTATION_SLIDE_VC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CLM_PRESENTATION_SLIDE_VC'::varchar(29)))));

CREATE  VIEW raw.ext_clm_presentation_vod__c AS
 SELECT src.APPROVED_VOD__C,
        src.COPIED_FROM_VOD__C,
        src.COPY_DATE_VOD__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.DEFAULT_PRESENTATION_VOD__C,
        src.GROUP_TO_SHARE_TO__C,
        src.HIDDEN_VOD__C,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.ORIGINAL_RECORD_ID_VOD__C,
        src.OWNERID,
        src.PARENTID_VOD__C,
        src.PRESENTATION_ID_VOD__C,
        src.PRODUCT_VOD__C,
        src.SYSTEMMODSTAMP,
        src.TRAINING_VOD__C,
        src.TYPE_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CLM_PRESENTATION_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CLM_PRESENTATION_VOD__C'::varchar(27)))));

CREATE  VIEW raw.ext_clozapine_unit_ap AS
 SELECT src.NDC_CODE,
        src.DESCRIPTION,
        src.UNIT_AP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CLOZAPINE_UNIT_AP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CLOZAPINE_UNIT_AP'::varchar(21)))));

CREATE  VIEW raw.ext_ddd_dod_qty AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.filler_01,
        src.OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.MTH_YYYYMM,
        src.QTY_MTH01,
        src.QTY_MTH02,
        src.QTY_MTH03,
        src.QTY_MTH04,
        src.QTY_MTH05,
        src.QTY_MTH06,
        src.QTY_MTH07,
        src.QTY_MTH08,
        src.QTY_MTH09,
        src.QTY_MTH10,
        src.QTY_MTH11,
        src.QTY_MTH12,
        src.QTY_MTH13,
        src.QTY_MTH14,
        src.QTY_MTH15,
        src.QTY_MTH16,
        src.QTY_MTH17,
        src.QTY_MTH18,
        src.QTY_MTH19,
        src.QTY_MTH20,
        src.QTY_MTH21,
        src.QTY_MTH22,
        src.QTY_MTH23,
        src.QTY_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_DOD_QTY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_DOD_QTY'::varchar(15)))));

CREATE  VIEW raw.ext_ddd_dod_sales_ms AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.filler_01,
        src.OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.MTH_YYYYMM,
        src.DOL_MTH01,
        src.DOL_MTH02,
        src.DOL_MTH03,
        src.DOL_MTH04,
        src.DOL_MTH05,
        src.DOL_MTH06,
        src.DOL_MTH07,
        src.DOL_MTH08,
        src.DOL_MTH09,
        src.DOL_MTH10,
        src.DOL_MTH11,
        src.DOL_MTH12,
        src.DOL_MTH13,
        src.DOL_MTH14,
        src.DOL_MTH15,
        src.DOL_MTH16,
        src.DOL_MTH17,
        src.DOL_MTH18,
        src.DOL_MTH19,
        src.DOL_MTH20,
        src.DOL_MTH21,
        src.DOL_MTH22,
        src.DOL_MTH23,
        src.DOL_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_DOD_SALES_MS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_DOD_SALES_MS'::varchar(20)))));

CREATE  VIEW raw.ext_ddd_dod_sales_pd AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.filler_01,
        src.OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.MTH_YYYYMM,
        src.DOL_MTH01,
        src.DOL_MTH02,
        src.DOL_MTH03,
        src.DOL_MTH04,
        src.DOL_MTH05,
        src.DOL_MTH06,
        src.DOL_MTH07,
        src.DOL_MTH08,
        src.DOL_MTH09,
        src.DOL_MTH10,
        src.DOL_MTH11,
        src.DOL_MTH12,
        src.DOL_MTH13,
        src.DOL_MTH14,
        src.DOL_MTH15,
        src.DOL_MTH16,
        src.DOL_MTH17,
        src.DOL_MTH18,
        src.DOL_MTH19,
        src.DOL_MTH20,
        src.DOL_MTH21,
        src.DOL_MTH22,
        src.DOL_MTH23,
        src.DOL_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_DOD_SALES_PD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_DOD_SALES_PD'::varchar(20)))));

CREATE  VIEW raw.ext_diplomat_enrollment AS
 SELECT src.PATIENT_ID,
        src.RX_RECEIVED_DATE,
        src.INSURANCE_INFORMATION,
        src.MOST_RECENT_CML_TREATMENT,
        src.DATE_OF_DISCONTINUATION,
        src.REASON_FOR_DISCONTINUATION,
        src.PHYSICIAN_LAST_NAME,
        src.PHYSICIAN_FIRST_NAME,
        src.PHYSICIAN_ADDRESS,
        src.PHYSICIAN_CITY,
        src.PHYSICIAN_STATE,
        src.PHYSICIAN_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_diplomat_enrollment_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DIPLOMAT_ENROLLMENT'::varchar(23)))));

CREATE  VIEW raw.ext_factory_sales_852 AS
 SELECT src.TRADING_PARTNER,
        src.DISTRIB_CENTER,
        src.DISTRIB_CENTER_DEA_NUM,
        src.REPORTING_DATE,
        src.PRODUCT_NAME,
        src.DESCRIPTION,
        src.NDC,
        src.QTY_RECEIVED,
        src.QTY_RECEIVED_DOLLARS,
        src.QTY_SOLD,
        src.QTY_SOLD_DOLLARS,
        src.QTY_OMIT,
        src.QTY_OMIT_DOLLARS,
        src.MTH_END_QTY_ON_HAND,
        src.MTH_END_QTY_ON_HAND_DOLLARS,
        src.MTH_END_COMMITTED,
        src.MTH_END_COMMITTED_DOLLARS,
        src.MTH_END_RESERVED,
        src.MTH_END_RESERVED_DOLLARS,
        src.QTY_RETURN,
        src.QTY_RETURN_DOLLARS,
        src.QTY_CUSTOMER_RETURN,
        src.QTY_CUSTOMER_RETURN_DOLLARS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FACTORY_SALES_852_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FACTORY_SALES_852'::varchar(21)))));

CREATE  VIEW raw.ext_hcos_aco_detail AS
 SELECT src.ACO_DETAIL_ID,
        src.ACO_DETAIL_CODE,
        src.ACO_DETAIL_DESC,
        src.ACO_DETAIL_GROUP_CODE,
        src.ACO_DETAIL_GROUP_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_ACO_DETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_ACO_DETAIL'::varchar(19)))));

CREATE  VIEW raw.ext_hcos_aco_detail_fact AS
 SELECT src.IMS_ORG_ID,
        src.ACO_TYPE_ID,
        src.ACO_DETAIL_ID,
        src.ACO_VAL,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_ACO_DETAIL_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_ACO_DETAIL_FACT'::varchar(24)))));

CREATE  VIEW raw.ext_hcos_aco_org_fact AS
 SELECT src.IMS_ORG_ID,
        src.ACO_TYPE_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_ACO_ORG_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_ACO_ORG_FACT'::varchar(21)))));

CREATE  VIEW raw.ext_hcos_aco_professional_rstr AS
 SELECT src.IMS_ORG_ID,
        src.ACO_TYPE_ID,
        src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_ACO_PROFESSIONAL_RSTR_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_ACO_PROFESSIONAL_RSTR'::varchar(30)))));

CREATE  VIEW raw.ext_hcos_aco_type AS
 SELECT src.ACO_TYPE_ID,
        src.ACO_TYPE_DESC,
        src.ACO_TYPE_CATG,
        src.ACO_MODEL,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_ACO_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_ACO_TYPE'::varchar(17)))));

CREATE  VIEW raw.ext_hcos_affiliation_type AS
 SELECT src.AFFIL_TYPE_ID,
        src.AFFIL_TYPE_CODE,
        src.AFFIL_TYPE_DESC,
        src.AFFIL_GROUP_CODE,
        src.AFFIL_GROUP_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_AFFILIATION_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_AFFILIATION_TYPE'::varchar(25)))));

CREATE  VIEW raw.ext_hcos_bed_cluster_type AS
 SELECT src.BED_CLUSTER_ID,
        src.BED_CLUSTER_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BED_CLUSTER_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BED_CLUSTER_TYPE'::varchar(25)))));

CREATE  VIEW raw.ext_hcos_bed_fact AS
 SELECT src.IMS_ORG_ID,
        src.BED_ID,
        src.LICENSE_BEDS,
        src.CENSUS_BEDS,
        src.STAFFED_BEDS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BED_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BED_FACT'::varchar(17)))));

CREATE  VIEW raw.ext_hcos_bed_type AS
 SELECT src.BED_ID,
        src.BED_CODE,
        src.BED_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BED_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BED_TYPE'::varchar(17)))));

CREATE  VIEW raw.ext_hcos_business AS
 SELECT src.IMS_ORG_ID,
        src.BUSINESS_NAME,
        src.DBA_NAME,
        src.CARE_OF_LOCATION,
        src.ADDRESS_ID,
        src.STF_ID,
        src.PHYSICAL_ADDR_1,
        src.PHYSICAL_ADDR_2,
        src.PHYSICAL_CITY,
        src.PHYSICAL_STATE,
        src.PHYSICAL_ZIP,
        src.POSTAL_ADDR_1,
        src.POSTAL_ADDR_2,
        src.POSTAL_CITY,
        src.POSTAL_STATE,
        src.POSTAL_ZIP,
        src.PHONE,
        src.FAX,
        src.WEBSITE,
        src.LATITUDE,
        src.LONGITUDE,
        src.OWNER_STATUS,
        src.PROFIT_STATUS,
        src.CMI,
        src.PRIMARY_COT_ID,
        src.COT_CLASSIFICATION_ID,
        src.COT_CLASSIFICATION,
        src.COT_FACILITY_TYPE_ID,
        src.COT_FACILITY_TYPE,
        src.COT_SPECIALTY_ID,
        src.COT_SPECIALTY,
        src.RECORD_TYPE,
        src.BED_CLUSTER_ID,
        src.TTL_LICENSE_BEDS,
        src.TTL_CENSUS_BEDS,
        src.TTL_STAFFED_BEDS,
        src.TEACHING_HOSP,
        src.COMMHOSP,
        src.ALL_DDD,
        src.ALL_NPI,
        src.HIN,
        src.DEA,
        src.MPN,
        src.MPN_ORDER,
        src.MSA,
        src.FIPS_STATE,
        src.FIPS_COUNTY,
        src.NUM_OF_PROVIDERS,
        src.CORP_PARENT_IMS_ORG_ID,
        src.CORP_PARENT_NAME,
        src.OWNER_SUB_IMS_ORG_ID,
        src.OWNER_SUB_NAME,
        src.GPO_PHARMA_IMS_ORG_ID,
        src.GPO_PHARMA_NAME,
        src.GPO_MEDSURG_IMS_ORG_ID,
        src.GPO_MEDSURG_NAME,
        src.PHARMA_PROV_IMS_ORG_ID,
        src.PHARMA_PROV_NAME,
        src.FORMULARY,
        src.ELECTRONIC_MED_REC,
        src.EPRESCRIBE,
        src.PAYPERFORM,
        src.GENFIRST,
        src.SREP_ACCESS,
        src.DEACTIVATION_REASON,
        src.REFERBACK_IMS_ORG_ID,
        src.STATUS_INDICATOR,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BUSINESS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BUSINESS'::varchar(17)))));

CREATE  VIEW raw.ext_hcos_business_detail AS
 SELECT src.DETAIL_ID,
        src.DETAIL_CODE,
        src.DETAIL_DESC,
        src.DETAIL_GROUP_CODE,
        src.DETAIL_GROUP_CODE_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BUSINESS_DETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BUSINESS_DETAIL'::varchar(24)))));

CREATE  VIEW raw.ext_hcos_business_detail_fact AS
 SELECT src.IMS_ORG_ID,
        src.DETAIL_ID,
        src.DETAIL_VALUE,
        src.DETAIL_COUNT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_BUSINESS_DETAIL_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_BUSINESS_DETAIL_FACT'::varchar(29)))));

CREATE  VIEW raw.ext_hcos_class_of_trade AS
 SELECT src.COT_ID,
        src.CLASSIFICATION_ID,
        src.CLASSIFICATION,
        src.FACILITY_TYPE_ID,
        src.FACILITY_TYPE,
        src.SPECIALTY_ID,
        src.SPECIALTY,
        src.RECORD_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_CLASS_OF_TRADE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CLASS_OF_TRADE'::varchar(23)))));

CREATE  VIEW raw.ext_hcos_clinical_code AS
 SELECT src.CODE_ID,
        src.CLIN_CODE,
        src.CLIN_CODE_DESC,
        src.CCS_CODE,
        src.CCS_DESC,
        src.MDC_CODE,
        src.MDC_DESC,
        src.CODE_CATEGORY,
        src.SURGICAL_CODE,
        src.OR_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_CLINICAL_CODE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CLINICAL_CODE'::varchar(22)))));

CREATE  VIEW raw.ext_hcos_clinical_fact AS
 SELECT src.IMS_ORG_ID,
        src.CODE_ID,
        src.DATA_YEAR,
        src.INPAT_VOL,
        src.OUTPAT_VOL,
        src.TTL_VOL,
        src.DECILE,
        src.AVG_LOS,
        src.AVG_COS,
        src.CODE_ORDER,
        src.GPO_VIEW,
        src.USE_FOR_AGG,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_CLINICAL_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CLINICAL_FACT'::varchar(22)))));

CREATE  VIEW raw.ext_hcos_clinical_fact_national AS
 SELECT src.CODE_ID,
        src.DATA_YEAR,
        src.INPAT_VOL,
        src.OUTPAT_VOL,
        src.TTL_VOL,
        src.AVG_LOS,
        src.AVG_COS,
        src.TREND,
        src.CODE_ORDER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_clinical_fact_national_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CLINICAL_FACT_NATIONAL'::varchar(31)))));

CREATE  VIEW raw.ext_hcos_clinical_fact_state AS
 SELECT src.CODE_ID,
        src.DATA_YEAR,
        src.STATE,
        src.INPAT_VOL,
        src.OUTPAT_VOL,
        src.TTL_VOL,
        src.AVG_LOS,
        src.AVG_COS,
        src.CODE_ORDER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_CLINICAL_FACT_STATE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CLINICAL_FACT_STATE'::varchar(28)))));

CREATE  VIEW raw.ext_hcos_contact_affiltn_fact AS
 SELECT src.IMS_ORG_ID,
        src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.TITLE_GROUP_CODE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_CONTACT_AFFILTN_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_CONTACT_AFFILTN_FACT'::varchar(29)))));

CREATE  VIEW raw.ext_hcos_cot_fact AS
 SELECT src.IMS_ORG_ID,
        src.COT_ID,
        src.COT_ORDER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_COT_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_COT_FACT'::varchar(17)))));

CREATE  VIEW raw.ext_hcos_financial_fact AS
 SELECT src.IMS_ORG_ID,
        src.DATA_YEAR,
        src.INPAT_REV,
        src.OUTPAT_REV,
        src.TTL_PAT_REV,
        src.NET_PAT_REV,
        src.OP_EXP,
        src.OTH_EXP,
        src.TTL_EXP,
        src.SUPPLY_COST,
        src.DRUG_COST,
        src.TTL_SALARIES,
        src.NET_INC_PAT,
        src.NET_INC,
        src.COST_PER_BED,
        src.TTL_ASSETS,
        src.FTE_EMP,
        src.CURR_ASSETS,
        src.CURR_LIAB,
        src.FIX_ASSETS,
        src.FRINGE_BENEFITS,
        src.FUND_BAL,
        src.GOV_APPR,
        src.H_IN_REV,
        src.L_T_LIAB,
        src.NON_PAT_REV,
        src.OTH_ASSETS,
        src.OTH_INCOME,
        src.H_OUT_REV,
        src.TOT_LIAB,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_FINANCIAL_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_FINANCIAL_FACT'::varchar(23)))));

CREATE  VIEW raw.ext_hcos_identifier_fact AS
 SELECT src.IMS_ORG_ID,
        src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.IDENTIFIER_ID,
        src.IDENTIFIER,
        src.IDENTIFIER_ORDER,
        src.IDENTIFIER_CATEGORY,
        src.IDENTIFIER_STATE,
        src.SRC_STRT_DT,
        src.SRC_TRMTN_DT,
        src.SRC_TRMTN_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_IDENTIFIER_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_IDENTIFIER_FACT'::varchar(24)))));

CREATE  VIEW raw.ext_hcos_identifier_type AS
 SELECT src.IDENTIFIER_ID,
        src.IDENTIFIER_CODE,
        src.IDENTIFIER_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_IDENTIFIER_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_IDENTIFIER_TYPE'::varchar(24)))));

CREATE  VIEW raw.ext_hcos_indentifier_cat_type AS
 SELECT src.IDENTIFIER_ID,
        src.IDENTIFIER_CATEGORY,
        src.IDENTIFIER_CATEGORY_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_INDENTIFIER_CAT_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_INDENTIFIER_CAT_TYPE'::varchar(29)))));

CREATE  VIEW raw.ext_hcos_indentifier_term_type AS
 SELECT src.IDENTIFIER_ID,
        src.SRC_TRMTN_CD,
        src.SRC_TRMTN_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_INDENTIFIER_TERM_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_INDENTIFIER_TERM_TYPE'::varchar(30)))));

CREATE  VIEW raw.ext_hcos_professional AS
 SELECT src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.LAST_NAME,
        src.GEN_SUFFIX,
        src.DESIGNATION,
        src.GENDER,
        src.ROLE,
        src.PRIMARY_SPEC,
        src.SECONDARY_SPEC,
        src.TERTIARY_SPEC,
        src.PRIMARY_PROF_CODE,
        src.PRIMARY_PROF_DESC,
        src.IMS_ID,
        src.UPIN,
        src.ME,
        src.ALL_DEA,
        src.NPI,
        src.STATUS_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_PROFESSIONAL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL'::varchar(21)))));

CREATE  VIEW raw.ext_hcos_professional_detail AS
 SELECT src.DETAIL_ID,
        src.DETAIL_CODE,
        src.DETAIL_DESC,
        src.DETAIL_GROUP_CODE,
        src.DETAIL_GROUP_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_PROFESSIONAL_DETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL_DETAIL'::varchar(28)))));

CREATE  VIEW raw.ext_hcos_professional_detail_fact AS
 SELECT src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.DETAIL_ID,
        src.DETAIL_VALUE,
        src.DETAIL_COUNT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_professional_detail_fact_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL_DETAIL_FACT'::varchar(33)))));

CREATE  VIEW raw.ext_hcos_professional_specialty AS
 SELECT src.SPEC_CODE,
        src.SPEC_DESC,
        src.SPEC_SUB_GROUP_CODE,
        src.SPEC_SUB_GROUP_DESC,
        src.SPEC_GROUP_CODE,
        src.SPEC_GROUP_DESC,
        src.ALTERNATE_SUB_GROUP_CODE,
        src.ALTERNATE_SUB_GROUP_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_professional_specialty_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL_SPECIALTY'::varchar(31)))));

CREATE  VIEW raw.ext_hcos_professional_spec_fact AS
 SELECT src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.SPEC_CODE,
        src.SPEC_RANKING,
        src.SPEC_RANK_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_professional_spec_fact_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL_SPEC_FACT'::varchar(31)))));

CREATE  VIEW raw.ext_hcos_professional_title AS
 SELECT src.TITLE_GROUP_CODE,
        src.TITLE_GROUP_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_PROFESSIONAL_TITLE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROFESSIONAL_TITLE'::varchar(27)))));

CREATE  VIEW raw.ext_hcos_provider_affiliation_fact AS
 SELECT src.IMS_ORG_ID,
        src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.AFFIL_TYPE_ID,
        src.DEA,
        src.AFFIL_IND,
        src.AFFIL_RANK,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_provider_affiliation_fact_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_PROVIDER_AFFILIATION_FACT'::varchar(34)))));

CREATE  VIEW raw.ext_hcos_relationship_fact AS
 SELECT src.IMS_ORG_ID_PARENT,
        src.IMS_ORG_ID_CHILD,
        src.REL_ID,
        src.REL_ORDER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_RELATIONSHIP_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_RELATIONSHIP_FACT'::varchar(26)))));

CREATE  VIEW raw.ext_hcos_relationship_type AS
 SELECT src.REL_ID,
        src.REL_CODE,
        src.REL_DESC,
        src.REL_GROUP_CODE,
        src.REL_GROUP_DESC,
        src.REL_CATEGORY_CODE,
        src.REL_CATEGORY_DESC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_HCOS_RELATIONSHIP_TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_RELATIONSHIP_TYPE'::varchar(26)))));

CREATE  VIEW raw.ext_i3_rx AS
 SELECT src.FULL_NAME,
        src.SPECIALTY,
        src.RANK,
        src.TOTAL,
        src.AUBAGIO,
        src.AVONEX,
        src.BETASERON,
        src.COPAXONE,
        src.EXTAVIA,
        src.GILENYA,
        src.REBIF,
        src.TECFIDERA,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.PRESCRIBER_NPI,
        src.DNC_FLAG,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_I3_RX_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_I3_RX'::varchar(9)))));

CREATE  VIEW raw.ext_i3_tysabri_rx AS
 SELECT src.FULL_NAME,
        src.SPECIALTY,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.PRESCRIBER_NPI,
        src.DNC_FLAG,
        src.RX_12,
        src.RX_11,
        src.RX_10,
        src.RX_09,
        src.RX_08,
        src.RX_07,
        src.RX_06,
        src.RX_05,
        src.RX_04,
        src.RX_03,
        src.RX_02,
        src.RX_01,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_I3_TYSABRI_RX_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_I3_TYSABRI_RX'::varchar(17)))));

CREATE  VIEW raw.ext_ids_call2_detail_vod__c AS
 SELECT src.ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IDS_CALL2_DETAIL_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IDS_CALL2_DETAIL_VOD__C'::varchar(27)))));

CREATE  VIEW raw.ext_ids_call2_vod__c AS
 SELECT src.ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IDS_CALL2_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IDS_CALL2_VOD__C'::varchar(20)))));

CREATE  VIEW raw.ext_ims_drm45_m AS
 SELECT src.FILE_CODE,
        src.PRODUCT_GROUP,
        src.PRODUCT_NAME,
        src.MFG_NUM,
        src.STATUS,
        src.CMF,
        src.PRODUCT_DESCRIPTION,
        src.MFG_NAME,
        src.USC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_DRM45_M_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_DRM45_M'::varchar(15)))));

CREATE  VIEW raw.ext_ims_drm45_w AS
 SELECT src.FILE_CODE,
        src.PRODUCT_GROUP,
        src.PRODUCT_NAME,
        src.MFG_NUM,
        src.STATUS,
        src.CMF,
        src.PRODUCT_DESCRIPTION,
        src.MFG_NAME,
        src.USC,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_DRM45_W_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_DRM45_W'::varchar(15)))));

CREATE  VIEW raw.ext_ims_mhj_cnt_m AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CNT_M_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CNT_M'::varchar(17)))));

CREATE  VIEW raw.ext_ims_mhj_cnt_w AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.nrx_025,
        src.nrx_026,
        src.nrx_027,
        src.nrx_028,
        src.nrx_029,
        src.nrx_030,
        src.nrx_031,
        src.nrx_032,
        src.nrx_033,
        src.nrx_034,
        src.nrx_035,
        src.nrx_036,
        src.nrx_037,
        src.nrx_038,
        src.nrx_039,
        src.nrx_040,
        src.nrx_041,
        src.nrx_042,
        src.nrx_043,
        src.nrx_044,
        src.nrx_045,
        src.nrx_046,
        src.nrx_047,
        src.nrx_048,
        src.nrx_049,
        src.nrx_050,
        src.nrx_051,
        src.nrx_052,
        src.nrx_053,
        src.nrx_054,
        src.nrx_055,
        src.nrx_056,
        src.nrx_057,
        src.nrx_058,
        src.nrx_059,
        src.nrx_060,
        src.nrx_061,
        src.nrx_062,
        src.nrx_063,
        src.nrx_064,
        src.nrx_065,
        src.nrx_066,
        src.nrx_067,
        src.nrx_068,
        src.nrx_069,
        src.nrx_070,
        src.nrx_071,
        src.nrx_072,
        src.nrx_073,
        src.nrx_074,
        src.nrx_075,
        src.nrx_076,
        src.nrx_077,
        src.nrx_078,
        src.nrx_079,
        src.nrx_080,
        src.nrx_081,
        src.nrx_082,
        src.nrx_083,
        src.nrx_084,
        src.nrx_085,
        src.nrx_086,
        src.nrx_087,
        src.nrx_088,
        src.nrx_089,
        src.nrx_090,
        src.nrx_091,
        src.nrx_092,
        src.nrx_093,
        src.nrx_094,
        src.nrx_095,
        src.nrx_096,
        src.nrx_097,
        src.nrx_098,
        src.nrx_099,
        src.nrx_100,
        src.nrx_101,
        src.nrx_102,
        src.nrx_103,
        src.nrx_104,
        src.nrx_105,
        src.nrx_106,
        src.nrx_107,
        src.nrx_108,
        src.nrx_109,
        src.nrx_110,
        src.nrx_111,
        src.nrx_112,
        src.nrx_113,
        src.nrx_114,
        src.nrx_115,
        src.nrx_116,
        src.nrx_117,
        src.nrx_118,
        src.nrx_119,
        src.nrx_120,
        src.nrx_121,
        src.nrx_122,
        src.nrx_123,
        src.nrx_124,
        src.nrx_125,
        src.nrx_126,
        src.nrx_127,
        src.nrx_128,
        src.nrx_129,
        src.nrx_130,
        src.nrx_131,
        src.nrx_132,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.trx_025,
        src.trx_026,
        src.trx_027,
        src.trx_028,
        src.trx_029,
        src.trx_030,
        src.trx_031,
        src.trx_032,
        src.trx_033,
        src.trx_034,
        src.trx_035,
        src.trx_036,
        src.trx_037,
        src.trx_038,
        src.trx_039,
        src.trx_040,
        src.trx_041,
        src.trx_042,
        src.trx_043,
        src.trx_044,
        src.trx_045,
        src.trx_046,
        src.trx_047,
        src.trx_048,
        src.trx_049,
        src.trx_050,
        src.trx_051,
        src.trx_052,
        src.trx_053,
        src.trx_054,
        src.trx_055,
        src.trx_056,
        src.trx_057,
        src.trx_058,
        src.trx_059,
        src.trx_060,
        src.trx_061,
        src.trx_062,
        src.trx_063,
        src.trx_064,
        src.trx_065,
        src.trx_066,
        src.trx_067,
        src.trx_068,
        src.trx_069,
        src.trx_070,
        src.trx_071,
        src.trx_072,
        src.trx_073,
        src.trx_074,
        src.trx_075,
        src.trx_076,
        src.trx_077,
        src.trx_078,
        src.trx_079,
        src.trx_080,
        src.trx_081,
        src.trx_082,
        src.trx_083,
        src.trx_084,
        src.trx_085,
        src.trx_086,
        src.trx_087,
        src.trx_088,
        src.trx_089,
        src.trx_090,
        src.trx_091,
        src.trx_092,
        src.trx_093,
        src.trx_094,
        src.trx_095,
        src.trx_096,
        src.trx_097,
        src.trx_098,
        src.trx_099,
        src.trx_100,
        src.trx_101,
        src.trx_102,
        src.trx_103,
        src.trx_104,
        src.trx_105,
        src.trx_106,
        src.trx_107,
        src.trx_108,
        src.trx_109,
        src.trx_110,
        src.trx_111,
        src.trx_112,
        src.trx_113,
        src.trx_114,
        src.trx_115,
        src.trx_116,
        src.trx_117,
        src.trx_118,
        src.trx_119,
        src.trx_120,
        src.trx_121,
        src.trx_122,
        src.trx_123,
        src.trx_124,
        src.trx_125,
        src.trx_126,
        src.trx_127,
        src.trx_128,
        src.trx_129,
        src.trx_130,
        src.trx_131,
        src.trx_132,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CNT_W_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CNT_W'::varchar(17)))));

CREATE  VIEW raw.ext_ims_mhj_control_m AS
 SELECT src.IMS_CLIENT_NUM,
        src.IMS_REPORT_NUM,
        src.SRA,
        src.SALES_CATEGORY,
        src.IMS_PRODUCT_GROUP_NUM,
        src.NRX001,
        src.NRX002,
        src.NRX003,
        src.NRX004,
        src.NRX005,
        src.NRX006,
        src.NRX007,
        src.NRX008,
        src.NRX009,
        src.NRX010,
        src.NRX011,
        src.NRX012,
        src.NRX013,
        src.NRX014,
        src.NRX015,
        src.NRX016,
        src.NRX017,
        src.NRX018,
        src.NRX019,
        src.NRX020,
        src.NRX021,
        src.NRX022,
        src.NRX023,
        src.NRX024,
        src.TRX001,
        src.TRX002,
        src.TRX003,
        src.TRX004,
        src.TRX005,
        src.TRX006,
        src.TRX007,
        src.TRX008,
        src.TRX009,
        src.TRX010,
        src.TRX011,
        src.TRX012,
        src.TRX013,
        src.TRX014,
        src.TRX015,
        src.TRX016,
        src.TRX017,
        src.TRX018,
        src.TRX019,
        src.TRX020,
        src.TRX021,
        src.TRX022,
        src.TRX023,
        src.TRX024,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CONTROL_M_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CONTROL_M'::varchar(21)))));

CREATE  VIEW raw.ext_ims_mhj_control_w AS
 SELECT src.IMS_CLIENT_NUM,
        src.IMS_REPORT_NUM,
        src.SRA,
        src.SALES_CATEGORY,
        src.IMS_PRODUCT_GROUP_NUM,
        src.NRX001,
        src.NRX002,
        src.NRX003,
        src.NRX004,
        src.NRX005,
        src.NRX006,
        src.NRX007,
        src.NRX008,
        src.NRX009,
        src.NRX010,
        src.NRX011,
        src.NRX012,
        src.NRX013,
        src.NRX014,
        src.NRX015,
        src.NRX016,
        src.NRX017,
        src.NRX018,
        src.NRX019,
        src.NRX020,
        src.NRX021,
        src.NRX022,
        src.NRX023,
        src.NRX024,
        src.NRX025,
        src.NRX026,
        src.NRX027,
        src.NRX028,
        src.NRX029,
        src.NRX030,
        src.NRX031,
        src.NRX032,
        src.NRX033,
        src.NRX034,
        src.NRX035,
        src.NRX036,
        src.NRX037,
        src.NRX038,
        src.NRX039,
        src.NRX040,
        src.NRX041,
        src.NRX042,
        src.NRX043,
        src.NRX044,
        src.NRX045,
        src.NRX046,
        src.NRX047,
        src.NRX048,
        src.NRX049,
        src.NRX050,
        src.NRX051,
        src.NRX052,
        src.NRX053,
        src.NRX054,
        src.NRX055,
        src.NRX056,
        src.NRX057,
        src.NRX058,
        src.NRX059,
        src.NRX060,
        src.NRX061,
        src.NRX062,
        src.NRX063,
        src.NRX064,
        src.NRX065,
        src.NRX066,
        src.NRX067,
        src.NRX068,
        src.NRX069,
        src.NRX070,
        src.NRX071,
        src.NRX072,
        src.NRX073,
        src.NRX074,
        src.NRX075,
        src.NRX076,
        src.NRX077,
        src.NRX078,
        src.NRX079,
        src.NRX080,
        src.NRX081,
        src.NRX082,
        src.NRX083,
        src.NRX084,
        src.NRX085,
        src.NRX086,
        src.NRX087,
        src.NRX088,
        src.NRX089,
        src.NRX090,
        src.NRX091,
        src.NRX092,
        src.NRX093,
        src.NRX094,
        src.NRX095,
        src.NRX096,
        src.NRX097,
        src.NRX098,
        src.NRX099,
        src.NRX100,
        src.NRX101,
        src.NRX102,
        src.NRX103,
        src.NRX104,
        src.NRX105,
        src.NRX106,
        src.NRX107,
        src.NRX108,
        src.NRX109,
        src.NRX110,
        src.NRX111,
        src.NRX112,
        src.NRX113,
        src.NRX114,
        src.NRX115,
        src.NRX116,
        src.NRX117,
        src.NRX118,
        src.NRX119,
        src.NRX120,
        src.NRX121,
        src.NRX122,
        src.NRX123,
        src.NRX124,
        src.NRX125,
        src.NRX126,
        src.NRX127,
        src.NRX128,
        src.NRX129,
        src.NRX130,
        src.NRX131,
        src.NRX132,
        src.TRX001,
        src.TRX002,
        src.TRX003,
        src.TRX004,
        src.TRX005,
        src.TRX006,
        src.TRX007,
        src.TRX008,
        src.TRX009,
        src.TRX010,
        src.TRX011,
        src.TRX012,
        src.TRX013,
        src.TRX014,
        src.TRX015,
        src.TRX016,
        src.TRX017,
        src.TRX018,
        src.TRX019,
        src.TRX020,
        src.TRX021,
        src.TRX022,
        src.TRX023,
        src.TRX024,
        src.TRX025,
        src.TRX026,
        src.TRX027,
        src.TRX028,
        src.TRX029,
        src.TRX030,
        src.TRX031,
        src.TRX032,
        src.TRX033,
        src.TRX034,
        src.TRX035,
        src.TRX036,
        src.TRX037,
        src.TRX038,
        src.TRX039,
        src.TRX040,
        src.TRX041,
        src.TRX042,
        src.TRX043,
        src.TRX044,
        src.TRX045,
        src.TRX046,
        src.TRX047,
        src.TRX048,
        src.TRX049,
        src.TRX050,
        src.TRX051,
        src.TRX052,
        src.TRX053,
        src.TRX054,
        src.TRX055,
        src.TRX056,
        src.TRX057,
        src.TRX058,
        src.TRX059,
        src.TRX060,
        src.TRX061,
        src.TRX062,
        src.TRX063,
        src.TRX064,
        src.TRX065,
        src.TRX066,
        src.TRX067,
        src.TRX068,
        src.TRX069,
        src.TRX070,
        src.TRX071,
        src.TRX072,
        src.TRX073,
        src.TRX074,
        src.TRX075,
        src.TRX076,
        src.TRX077,
        src.TRX078,
        src.TRX079,
        src.TRX080,
        src.TRX081,
        src.TRX082,
        src.TRX083,
        src.TRX084,
        src.TRX085,
        src.TRX086,
        src.TRX087,
        src.TRX088,
        src.TRX089,
        src.TRX090,
        src.TRX091,
        src.TRX092,
        src.TRX093,
        src.TRX094,
        src.TRX095,
        src.TRX096,
        src.TRX097,
        src.TRX098,
        src.TRX099,
        src.TRX100,
        src.TRX101,
        src.TRX102,
        src.TRX103,
        src.TRX104,
        src.TRX105,
        src.TRX106,
        src.TRX107,
        src.TRX108,
        src.TRX109,
        src.TRX110,
        src.TRX111,
        src.TRX112,
        src.TRX113,
        src.TRX114,
        src.TRX115,
        src.TRX116,
        src.TRX117,
        src.TRX118,
        src.TRX119,
        src.TRX120,
        src.TRX121,
        src.TRX122,
        src.TRX123,
        src.TRX124,
        src.TRX125,
        src.TRX126,
        src.TRX127,
        src.TRX128,
        src.TRX129,
        src.TRX130,
        src.TRX131,
        src.TRX132,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CONTROL_W_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CONTROL_W'::varchar(21)))));

CREATE  VIEW raw.ext_ims_mhj_qty_m AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_QTY_M_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_QTY_M'::varchar(17)))));

CREATE  VIEW raw.ext_ims_mhj_qty_w AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.nrx_025,
        src.nrx_026,
        src.nrx_027,
        src.nrx_028,
        src.nrx_029,
        src.nrx_030,
        src.nrx_031,
        src.nrx_032,
        src.nrx_033,
        src.nrx_034,
        src.nrx_035,
        src.nrx_036,
        src.nrx_037,
        src.nrx_038,
        src.nrx_039,
        src.nrx_040,
        src.nrx_041,
        src.nrx_042,
        src.nrx_043,
        src.nrx_044,
        src.nrx_045,
        src.nrx_046,
        src.nrx_047,
        src.nrx_048,
        src.nrx_049,
        src.nrx_050,
        src.nrx_051,
        src.nrx_052,
        src.nrx_053,
        src.nrx_054,
        src.nrx_055,
        src.nrx_056,
        src.nrx_057,
        src.nrx_058,
        src.nrx_059,
        src.nrx_060,
        src.nrx_061,
        src.nrx_062,
        src.nrx_063,
        src.nrx_064,
        src.nrx_065,
        src.nrx_066,
        src.nrx_067,
        src.nrx_068,
        src.nrx_069,
        src.nrx_070,
        src.nrx_071,
        src.nrx_072,
        src.nrx_073,
        src.nrx_074,
        src.nrx_075,
        src.nrx_076,
        src.nrx_077,
        src.nrx_078,
        src.nrx_079,
        src.nrx_080,
        src.nrx_081,
        src.nrx_082,
        src.nrx_083,
        src.nrx_084,
        src.nrx_085,
        src.nrx_086,
        src.nrx_087,
        src.nrx_088,
        src.nrx_089,
        src.nrx_090,
        src.nrx_091,
        src.nrx_092,
        src.nrx_093,
        src.nrx_094,
        src.nrx_095,
        src.nrx_096,
        src.nrx_097,
        src.nrx_098,
        src.nrx_099,
        src.nrx_100,
        src.nrx_101,
        src.nrx_102,
        src.nrx_103,
        src.nrx_104,
        src.nrx_105,
        src.nrx_106,
        src.nrx_107,
        src.nrx_108,
        src.nrx_109,
        src.nrx_110,
        src.nrx_111,
        src.nrx_112,
        src.nrx_113,
        src.nrx_114,
        src.nrx_115,
        src.nrx_116,
        src.nrx_117,
        src.nrx_118,
        src.nrx_119,
        src.nrx_120,
        src.nrx_121,
        src.nrx_122,
        src.nrx_123,
        src.nrx_124,
        src.nrx_125,
        src.nrx_126,
        src.nrx_127,
        src.nrx_128,
        src.nrx_129,
        src.nrx_130,
        src.nrx_131,
        src.nrx_132,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.trx_025,
        src.trx_026,
        src.trx_027,
        src.trx_028,
        src.trx_029,
        src.trx_030,
        src.trx_031,
        src.trx_032,
        src.trx_033,
        src.trx_034,
        src.trx_035,
        src.trx_036,
        src.trx_037,
        src.trx_038,
        src.trx_039,
        src.trx_040,
        src.trx_041,
        src.trx_042,
        src.trx_043,
        src.trx_044,
        src.trx_045,
        src.trx_046,
        src.trx_047,
        src.trx_048,
        src.trx_049,
        src.trx_050,
        src.trx_051,
        src.trx_052,
        src.trx_053,
        src.trx_054,
        src.trx_055,
        src.trx_056,
        src.trx_057,
        src.trx_058,
        src.trx_059,
        src.trx_060,
        src.trx_061,
        src.trx_062,
        src.trx_063,
        src.trx_064,
        src.trx_065,
        src.trx_066,
        src.trx_067,
        src.trx_068,
        src.trx_069,
        src.trx_070,
        src.trx_071,
        src.trx_072,
        src.trx_073,
        src.trx_074,
        src.trx_075,
        src.trx_076,
        src.trx_077,
        src.trx_078,
        src.trx_079,
        src.trx_080,
        src.trx_081,
        src.trx_082,
        src.trx_083,
        src.trx_084,
        src.trx_085,
        src.trx_086,
        src.trx_087,
        src.trx_088,
        src.trx_089,
        src.trx_090,
        src.trx_091,
        src.trx_092,
        src.trx_093,
        src.trx_094,
        src.trx_095,
        src.trx_096,
        src.trx_097,
        src.trx_098,
        src.trx_099,
        src.trx_100,
        src.trx_101,
        src.trx_102,
        src.trx_103,
        src.trx_104,
        src.trx_105,
        src.trx_106,
        src.trx_107,
        src.trx_108,
        src.trx_109,
        src.trx_110,
        src.trx_111,
        src.trx_112,
        src.trx_113,
        src.trx_114,
        src.trx_115,
        src.trx_116,
        src.trx_117,
        src.trx_118,
        src.trx_119,
        src.trx_120,
        src.trx_121,
        src.trx_122,
        src.trx_123,
        src.trx_124,
        src.trx_125,
        src.trx_126,
        src.trx_127,
        src.trx_128,
        src.trx_129,
        src.trx_130,
        src.trx_131,
        src.trx_132,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_QTY_W_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_QTY_W'::varchar(17)))));

CREATE  VIEW raw.ext_ims_pbm_xref AS
 SELECT src.PBM_NAME,
        src.PAYER_PLAN_NUM,
        src.XREF_TO_PAYER_PLAN_NUM,
        src.IPD_ID,
        src.IPD_TYPE,
        src.PLAN_NAME,
        src.PBM_NUM,
        src.IMS_PROCESSOR_NUM,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_PBM_XREF_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_PBM_XREF'::varchar(16)))));

CREATE  VIEW raw.ext_ims_plan_xref AS
 SELECT src.PAYER_NUM,
        src.PAYER_NAME,
        src.PLAN_NUM,
        src.PAYER_PLAN_NUM,
        src.PLAN_NAME,
        src.MODEL,
        src.CITY,
        src.HQ_STATE,
        src.OPERATING_STATE,
        src.MONTHS_WITH_DATA,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_PLAN_XREF_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_PLAN_XREF'::varchar(17)))));

CREATE  VIEW raw.ext_ims_plan_xref_accelerated AS
 SELECT src.PAYER_NUM,
        src.PAYER_NAME,
        src.PLAN_NUM,
        src.PAYER_PLAN_NUM,
        src.PLAN_NAME,
        src.MODEL,
        src.CITY,
        src.HQ_STATE,
        src.OPERATING_STATE,
        src.MONTHS_WITH_DATA,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_PLAN_XREF_ACCELERATED_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_PLAN_XREF_ACCELERATED'::varchar(29)))));

CREATE  VIEW raw.ext_kc_zip_to_territory AS
 SELECT src.ZIP,
        src.CITY,
        src.STATE,
        src.TERRITORY_NUM,
        src.TERRITORY_NAME,
        src.AREA_NAME,
        src.REGION_NAME,
        src.SALES_FORCE_ID,
        src.ORGANIZATION_CODE,
        src.INACTIVE_FLAG,
        src.COMMENTS,
        src.MIRROR_FLAG,
        src.MIRROR_TERRITORY_NUM,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_kc_zip_to_territory_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_KC_ZIP_TO_TERRITORY'::varchar(23)))));

CREATE  VIEW raw.ext_knipper_samples_shipped AS
 SELECT src.CLIENT_PRAC_ID,
        src.TERR_CODE,
        src.SAMPLE_PROD_CODE,
        src.SAMPLE_DATE,
        src.SAMPLE_QTY,
        src.REQUEST_DATE,
        src.REQUEST_QTY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_knipper_samples_shipped_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_KNIPPER_SAMPLES_SHIPPED'::varchar(27)))));

CREATE  VIEW raw.ext_mm_ram_to_state AS
 SELECT src.MM_RAM,
        src.STATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_MM_RAM_TO_STATE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_MM_RAM_TO_STATE'::varchar(19)))));

CREATE  VIEW raw.ext_omnicare_sales AS
 SELECT src.TRANSACTION_ID,
        src.INVOICE_DATE,
        src.PRODUCT_BRAND,
        src.PRODUCT_NDC,
        src.PRODUCT_DESC,
        src.INVOICE_QTY,
        src.INVOICE_UNITS,
        src.INVOICE_COST,
        src.INVOICE_PACK_COST,
        src.INVOICE_UNIT_COST,
        src.CONTRACT_PACK_COST,
        src.CONTRACT_PURCHASES,
        src.CONTRACT_NUMBER,
        src.DISPENSING_LOCATION,
        src.DL_ADDRESS_1,
        src.DL_ADDRESS_2,
        src.DL_CITY,
        src.DL_STATE,
        src.DL_ZIP,
        src.DL_DEA_NUM,
        src.DEPOT_LOCATION,
        src.DEP_ADDRESS_1,
        src.DEP_ADDRESS_2,
        src.DEP_CITY,
        src.DEP_STATE,
        src.DEP_ZIP,
        src.DEP_DEA_NUM,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_OMNICARE_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_OMNICARE_SALES'::varchar(18)))));

CREATE  VIEW raw.ext_onc_ddd_monthly_retail AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.sra_1,
        src.ZIP,
        src.sra_3,
        src.sra_4,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.DATA_DATE,
        src.QTY_MTH01,
        src.QTY_MTH02,
        src.QTY_MTH03,
        src.QTY_MTH04,
        src.QTY_MTH05,
        src.QTY_MTH06,
        src.QTY_MTH07,
        src.QTY_MTH08,
        src.QTY_MTH09,
        src.QTY_MTH10,
        src.QTY_MTH11,
        src.QTY_MTH12,
        src.QTY_MTH13,
        src.QTY_MTH14,
        src.QTY_MTH15,
        src.QTY_MTH16,
        src.QTY_MTH17,
        src.QTY_MTH18,
        src.QTY_MTH19,
        src.QTY_MTH20,
        src.QTY_MTH21,
        src.QTY_MTH22,
        src.QTY_MTH23,
        src.QTY_MTH24,
        src.CITY,
        src.STATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DDD_MONTHLY_RETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DDD_MONTHLY_RETAIL'::varchar(26)))));

CREATE  VIEW raw.ext_onc_ddd_weekly_retail AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.ZIP,
        src.sra_2,
        src.sra_3,
        src.sra_4,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.DATA_DATE,
        src.QTY_WK01,
        src.QTY_WK02,
        src.QTY_WK03,
        src.QTY_WK04,
        src.QTY_WK05,
        src.QTY_WK06,
        src.QTY_WK07,
        src.QTY_WK08,
        src.QTY_WK09,
        src.QTY_WK10,
        src.QTY_WK11,
        src.QTY_WK12,
        src.QTY_WK13,
        src.QTY_WK14,
        src.QTY_WK15,
        src.QTY_WK16,
        src.QTY_WK17,
        src.QTY_WK18,
        src.QTY_WK19,
        src.QTY_WK20,
        src.QTY_WK21,
        src.QTY_WK22,
        src.QTY_WK23,
        src.QTY_WK24,
        src.QTY_WK25,
        src.QTY_WK26,
        src.QTY_WK27,
        src.QTY_WK28,
        src.QTY_WK29,
        src.QTY_WK30,
        src.QTY_WK31,
        src.QTY_WK32,
        src.QTY_WK33,
        src.QTY_WK34,
        src.QTY_WK35,
        src.QTY_WK36,
        src.QTY_WK37,
        src.QTY_WK38,
        src.QTY_WK39,
        src.QTY_WK40,
        src.QTY_WK41,
        src.QTY_WK42,
        src.QTY_WK43,
        src.QTY_WK44,
        src.QTY_WK45,
        src.QTY_WK46,
        src.QTY_WK47,
        src.QTY_WK48,
        src.QTY_WK49,
        src.QTY_WK50,
        src.QTY_WK51,
        src.QTY_WK52,
        src.QTY_WK53,
        src.QTY_WK54,
        src.QTY_WK55,
        src.QTY_WK56,
        src.QTY_WK57,
        src.QTY_WK58,
        src.QTY_WK59,
        src.QTY_WK60,
        src.QTY_WK61,
        src.QTY_WK62,
        src.QTY_WK63,
        src.QTY_WK64,
        src.QTY_WK65,
        src.QTY_WK66,
        src.QTY_WK67,
        src.QTY_WK68,
        src.QTY_WK69,
        src.QTY_WK70,
        src.QTY_WK71,
        src.QTY_WK72,
        src.QTY_WK73,
        src.QTY_WK74,
        src.QTY_WK75,
        src.QTY_WK76,
        src.QTY_WK77,
        src.QTY_WK78,
        src.QTY_WK79,
        src.QTY_WK80,
        src.QTY_WK81,
        src.QTY_WK82,
        src.QTY_WK83,
        src.QTY_WK84,
        src.QTY_WK85,
        src.QTY_WK86,
        src.QTY_WK87,
        src.QTY_WK88,
        src.QTY_WK89,
        src.QTY_WK90,
        src.QTY_WK91,
        src.QTY_WK92,
        src.QTY_WK93,
        src.QTY_WK94,
        src.QTY_WK95,
        src.QTY_WK96,
        src.QTY_WK97,
        src.QTY_WK98,
        src.QTY_WK99,
        src.QTY_WK100,
        src.QTY_WK101,
        src.QTY_WK102,
        src.QTY_WK103,
        src.QTY_WK104,
        src.QTY_WK105,
        src.QTY_WK106,
        src.CITY,
        src.STATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DDD_WEEKLY_RETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DDD_WEEKLY_RETAIL'::varchar(25)))));

CREATE  VIEW raw.ext_onc_dmd_monthly_demo_dol AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.IMS_OUTLET_CODE,
        src.IMS_FACILITY_NUMBER,
        src.IMS_PRESCRIBER_NUMBER,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.FACILITY_PRESCRIBER_NAME,
        src.FACILITY_PRESCRIBER_ADDRESS1,
        src.FACILITY_PRESCRIBER_ADDRESS2,
        src.FACILITY_PRESCRIBER_ADDRESS3,
        src.FACILITY_PRESCRIBER_ADDRESS4,
        src.FACILITY_PRESCRIBER_CITY,
        src.FACILITY_PRESCRIBER_STATE,
        src.FACILITY_PRESCRIBER_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_DOL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_MONTHLY_DEMO_DOL'::varchar(28)))));

CREATE  VIEW raw.ext_onc_dmd_monthly_demo_qty AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.IMS_OUTLET_CODE,
        src.IMS_FACILITY_NUMBER,
        src.IMS_PRESCRIBER_NUMBER,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.FACILITY_PRESCRIBER_NAME,
        src.FACILITY_PRESCRIBER_ADDRESS1,
        src.FACILITY_PRESCRIBER_ADDRESS2,
        src.FACILITY_PRESCRIBER_ADDRESS3,
        src.FACILITY_PRESCRIBER_ADDRESS4,
        src.FACILITY_PRESCRIBER_CITY,
        src.FACILITY_PRESCRIBER_STATE,
        src.FACILITY_PRESCRIBER_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_QTY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_MONTHLY_DEMO_QTY'::varchar(28)))));

CREATE  VIEW raw.ext_onc_dmd_monthly_dollars AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.TERRITORY_NUM,
        src.IMS_OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.ALT_SEQ_NUM,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.DATA_DATE,
        src.DOL_MTH01,
        src.DOL_MTH02,
        src.DOL_MTH03,
        src.DOL_MTH04,
        src.DOL_MTH05,
        src.DOL_MTH06,
        src.DOL_MTH07,
        src.DOL_MTH08,
        src.DOL_MTH09,
        src.DOL_MTH10,
        src.DOL_MTH11,
        src.DOL_MTH12,
        src.DOL_MTH13,
        src.DOL_MTH14,
        src.DOL_MTH15,
        src.DOL_MTH16,
        src.DOL_MTH17,
        src.DOL_MTH18,
        src.DOL_MTH19,
        src.DOL_MTH20,
        src.DOL_MTH21,
        src.DOL_MTH22,
        src.DOL_MTH23,
        src.DOL_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_MONTHLY_DOLLARS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_MONTHLY_DOLLARS'::varchar(27)))));

CREATE  VIEW raw.ext_onc_dmd_monthly_quantity AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.FILLER_01,
        src.IMS_OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.ALT_SEQ_NUM,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.DATA_DATE,
        src.QTY_MTH01,
        src.QTY_MTH02,
        src.QTY_MTH03,
        src.QTY_MTH04,
        src.QTY_MTH05,
        src.QTY_MTH06,
        src.QTY_MTH07,
        src.QTY_MTH08,
        src.QTY_MTH09,
        src.QTY_MTH10,
        src.QTY_MTH11,
        src.QTY_MTH12,
        src.QTY_MTH13,
        src.QTY_MTH14,
        src.QTY_MTH15,
        src.QTY_MTH16,
        src.QTY_MTH17,
        src.QTY_MTH18,
        src.QTY_MTH19,
        src.QTY_MTH20,
        src.QTY_MTH21,
        src.QTY_MTH22,
        src.QTY_MTH23,
        src.QTY_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_MONTHLY_QUANTITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_MONTHLY_QUANTITY'::varchar(28)))));

CREATE  VIEW raw.ext_onc_dmd_weekly_demo AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.IMS_OUTLET_CODE,
        src.IMS_FACILITY_NUMBER,
        src.IMS_PRESCRIBER_NUMBER,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.FACILITY_PRESCRIBER_NAME,
        src.FACILITY_PRESCRIBER_ADDRESS1,
        src.FACILITY_PRESCRIBER_ADDRESS2,
        src.FACILITY_PRESCRIBER_ADDRESS3,
        src.FACILITY_PRESCRIBER_ADDRESS4,
        src.FACILITY_PRESCRIBER_CITY,
        src.FACILITY_PRESCRIBER_STATE,
        src.FACILITY_PRESCRIBER_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_WEEKLY_DEMO_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_WEEKLY_DEMO'::varchar(23)))));

CREATE  VIEW raw.ext_onc_dmd_weekly_sales AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.IMS_OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.ALT_SEQ_NUM,
        src.FILLER_01,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.DATA_DATE,
        src.QTY_WK01,
        src.QTY_WK02,
        src.QTY_WK03,
        src.QTY_WK04,
        src.QTY_WK05,
        src.QTY_WK06,
        src.QTY_WK07,
        src.QTY_WK08,
        src.QTY_WK09,
        src.QTY_WK10,
        src.QTY_WK11,
        src.QTY_WK12,
        src.QTY_WK13,
        src.QTY_WK14,
        src.QTY_WK15,
        src.QTY_WK16,
        src.QTY_WK17,
        src.QTY_WK18,
        src.QTY_WK19,
        src.QTY_WK20,
        src.QTY_WK21,
        src.QTY_WK22,
        src.QTY_WK23,
        src.QTY_WK24,
        src.QTY_WK25,
        src.QTY_WK26,
        src.QTY_WK27,
        src.QTY_WK28,
        src.QTY_WK29,
        src.QTY_WK30,
        src.QTY_WK31,
        src.QTY_WK32,
        src.QTY_WK33,
        src.QTY_WK34,
        src.QTY_WK35,
        src.QTY_WK36,
        src.QTY_WK37,
        src.QTY_WK38,
        src.QTY_WK39,
        src.QTY_WK40,
        src.QTY_WK41,
        src.QTY_WK42,
        src.QTY_WK43,
        src.QTY_WK44,
        src.QTY_WK45,
        src.QTY_WK46,
        src.QTY_WK47,
        src.QTY_WK48,
        src.QTY_WK49,
        src.QTY_WK50,
        src.QTY_WK51,
        src.QTY_WK52,
        src.QTY_WK53,
        src.QTY_WK54,
        src.QTY_WK55,
        src.QTY_WK56,
        src.QTY_WK57,
        src.QTY_WK58,
        src.QTY_WK59,
        src.QTY_WK60,
        src.QTY_WK61,
        src.QTY_WK62,
        src.QTY_WK63,
        src.QTY_WK64,
        src.QTY_WK65,
        src.QTY_WK66,
        src.QTY_WK67,
        src.QTY_WK68,
        src.QTY_WK69,
        src.QTY_WK70,
        src.QTY_WK71,
        src.QTY_WK72,
        src.QTY_WK73,
        src.QTY_WK74,
        src.QTY_WK75,
        src.QTY_WK76,
        src.QTY_WK77,
        src.QTY_WK78,
        src.QTY_WK79,
        src.QTY_WK80,
        src.QTY_WK81,
        src.QTY_WK82,
        src.QTY_WK83,
        src.QTY_WK84,
        src.QTY_WK85,
        src.QTY_WK86,
        src.QTY_WK87,
        src.QTY_WK88,
        src.QTY_WK89,
        src.QTY_WK90,
        src.QTY_WK91,
        src.QTY_WK92,
        src.QTY_WK93,
        src.QTY_WK94,
        src.QTY_WK95,
        src.QTY_WK96,
        src.QTY_WK97,
        src.QTY_WK98,
        src.QTY_WK99,
        src.QTY_WK100,
        src.QTY_WK101,
        src.QTY_WK102,
        src.QTY_WK103,
        src.QTY_WK104,
        src.QTY_WK105,
        src.QTY_WK106,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_DMD_WEEKLY_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_DMD_WEEKLY_SALES'::varchar(24)))));

CREATE  VIEW raw.ext_pcs_ddd_nonretail AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.TERRITORY_NUM,
        src.OUTLET_CODE,
        src.SUBCATEGORY_CODE,
        src.CATEGORY_CODE,
        src.IMS_PRODUCT_CODE,
        src.MTH_YYYYMM,
        src.QTY_MTH01,
        src.QTY_MTH02,
        src.QTY_MTH03,
        src.QTY_MTH04,
        src.QTY_MTH05,
        src.QTY_MTH06,
        src.QTY_MTH07,
        src.QTY_MTH08,
        src.QTY_MTH09,
        src.QTY_MTH10,
        src.QTY_MTH11,
        src.QTY_MTH12,
        src.QTY_MTH13,
        src.QTY_MTH14,
        src.QTY_MTH15,
        src.QTY_MTH16,
        src.QTY_MTH17,
        src.QTY_MTH18,
        src.QTY_MTH19,
        src.QTY_MTH20,
        src.QTY_MTH21,
        src.QTY_MTH22,
        src.QTY_MTH23,
        src.QTY_MTH24,
        src.OUTLET_NAME,
        src.OUTLET_ADDRESS,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.OUTLET_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PCS_DDD_NONRETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PCS_DDD_NONRETAIL'::varchar(21)))));

CREATE  VIEW raw.ext_pcs_ddd_retail AS
 SELECT src.CLIENT_NUM,
        src.REPORT_NUM,
        src.TERRITORY_NUM,
        src.OUTLET_ZIP,
        src.SRA3,
        src.SRA4,
        src.CATEGORY_CODE,
        src.PRODUCT_GROUP,
        src.MTH_YYYYMM,
        src.QTY_MTH01,
        src.QTY_MTH02,
        src.QTY_MTH03,
        src.QTY_MTH04,
        src.QTY_MTH05,
        src.QTY_MTH06,
        src.QTY_MTH07,
        src.QTY_MTH08,
        src.QTY_MTH09,
        src.QTY_MTH10,
        src.QTY_MTH11,
        src.QTY_MTH12,
        src.QTY_MTH13,
        src.QTY_MTH14,
        src.QTY_MTH15,
        src.QTY_MTH16,
        src.QTY_MTH17,
        src.QTY_MTH18,
        src.QTY_MTH19,
        src.QTY_MTH20,
        src.QTY_MTH21,
        src.QTY_MTH22,
        src.QTY_MTH23,
        src.QTY_MTH24,
        src.OUTLET_CITY,
        src.OUTLET_STATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PCS_DDD_RETAIL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PCS_DDD_RETAIL'::varchar(18)))));

CREATE  VIEW raw.ext_prime_rx AS
 SELECT src.PHARMACY_NAME,
        src.MD_LAST_NAME,
        src.MD_FIRST_NAME,
        src.PRESCRIBER_NPI,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.MD_PHONE,
        src.SHIP_DATE,
        src.NDC_NUMBER,
        src.PRODUCT_NAME,
        src.FILL_NUMBER,
        src.QTY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PRIME_RX_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PRIME_RX'::varchar(12)))));

CREATE  VIEW raw.ext_rems_facility AS
 SELECT src.PROGRAM_ID,
        src.PROGRAM_NAME,
        src.CHANNEL_INITIATED,
        src.ENROLLMENT_ID,
        src.HEALTHCARE_FACILITY_TYPE,
        src.SITE_NAME,
        src.ADDRESS_1,
        src.ADDRESS_2,
        src.CITY,
        src.STATE,
        src.ZIP_CODE,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.LAST_NAME,
        src.STATUS_DESCRIPTION,
        src.IN_PROGRESS_STEP,
        src.PHONE_NUMBER,
        src.EFFECTIVE_DATE,
        src.EXPIRATION_DATE,
        src.NCPDP,
        src.NPI,
        src.DEA,
        src.OBSOLESCENCE_DATE,
        src.OBSOLESCENCE_REASON,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REMS_FACILITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REMS_FACILITY'::varchar(17)))));

CREATE  VIEW raw.ext_rems_pharmacy AS
 SELECT src.PROGRAM_ID,
        src.PROGRAM_NAME,
        src.CHANNEL,
        src.ENROLLMENT_ID,
        src.PHARMACY_TYPE,
        src.PHARMACY_NAME,
        src.ADDRESS1,
        src.ADDRESS2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.LAST_NAME,
        src.STATUS,
        src.IN_PROGRESS_STEP,
        src.PHONE,
        src.EFFECTIVE_DATE,
        src.EXPIRATION_DATE,
        src.NCPDP,
        src.NPI,
        src.DEA_NUM,
        src.LICENSE_NUMBER,
        src.OBSOLESCENCE_DATE,
        src.OBSOLESCENCE_REASON,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REMS_PHARMACY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REMS_PHARMACY'::varchar(17)))));

CREATE  VIEW raw.ext_rems_prescriber AS
 SELECT src.PROGRAM_ID,
        src.PROGRAM_NAME,
        src.CHANNEL,
        src.ENROLLMENT_ID,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.LAST_NAME,
        src.CREDENTIAL,
        src.SPECIALTY,
        src.SITE_NAME,
        src.ADDRESS1,
        src.ADDRESS2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.STATUS,
        src.IN_PROGRESS_STEP,
        src.PHONE,
        src.EFFECTIVE_DATE,
        src.EXPIRATION_DATE,
        src.NPI,
        src.DEA_NUM,
        src.OBSOLESCENCE_DATE,
        src.OBSOLESCENCE_REASON,
        src.PPAF_COUNT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REMS_PRESCRIBER_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REMS_PRESCRIBER'::varchar(19)))));

CREATE  VIEW raw.ext_specialty_pharmacy_cm_lkup AS
 SELECT src.SOURCE_KEY,
        src.SOURCE_NAME,
        src.FILE_NAME,
        src.ROWID_OBJECT_MATCHED,
        src.RULE_NO,
        src.ROWID_MATCH_RULE,
        src.AUTOMERGE_IND,
        src.CREATOR,
        src.CREATE_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_SPECIALTY_PHARMACY_CM_LKUP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_SPECIALTY_PHARMACY_CM_LKUP'::varchar(30)))));

CREATE  VIEW raw.ext_tb_cb_transactions AS
 SELECT src.ACCOUNT_ID,
        src.LOCATION_ID,
        src.SHIPMENT_DATE,
        src.NDC_CODE,
        src.PRODUCT_NAME,
        src.CONTRACT_ID,
        src.CHARGEBACK_UNITS,
        src.CHARGEBACK_DOLLARS,
        src.RECEIPT_DATE,
        src.DEBIT_MEMO_NUM,
        src.CREDIT_MEMO_DATE,
        src.CREDIT_MEMO_NUM,
        src.SETTLEMENT_DATE,
        src.CONTRACT_PRICE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TB_CB_TRANSACTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TB_CB_TRANSACTIONS'::varchar(22)))));

CREATE  VIEW raw.ext_tb_ds_accounts AS
 SELECT src.ACCOUNT_ID,
        src.LOCATION_ID,
        src.ACCOUNT_NAME,
        src.ACCOUNT_CLASS,
        src.ADDRESS_1,
        src.ADDRESS_2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TB_DS_ACCOUNTS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TB_DS_ACCOUNTS'::varchar(18)))));

CREATE  VIEW raw.ext_tb_ds_transactions AS
 SELECT src.ACCOUNT_ID,
        src.LOCATION_ID,
        src.SHIPMENT_DATE,
        src.NDC_CODE,
        src.PRODUCT_NAME,
        src.TRANSACTION_TYPE,
        src.DIRECT_SALES_UNITS,
        src.DIRECT_SALES_DOLLARS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TB_DS_TRANSACTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TB_DS_TRANSACTIONS'::varchar(22)))));

CREATE  VIEW raw.ext_time_off_territory_kc_veev AS
 SELECT src.ID,
        src.EVENT_ROW_ID,
        src.REP_ROW_ID,
        src.TERRITORY_NUM,
        src.TIME_OFF_DATE,
        src.TIME_ON_DATE,
        src.DESCRIPTION,
        src.COMMENTS,
        src.DURATION_IN_MINUTES,
        src.DURATION_IN_HOURS,
        src.DURATION_IN_DAYS,
        src.COMPANY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_time_off_territory_kc_veev_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TIME_OFF_TERRITORY_KC_VEEV'::varchar(30)))));

CREATE  VIEW raw.ext_time_off_territory_vod__c AS
 SELECT src.CREATEDBYID,
        src.CREATEDDATE,
        src.DATE_VOD__C,
        src.HOURS_OFF_VOD__C,
        src.HOURS_VOD__C,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTACTIVITYDATE,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.OWNERID,
        src.REASON_VOD__C,
        src.START_TIME_VOD__C,
        src.STATUS_VOD__C,
        src.SYSTEMMODSTAMP,
        src.TERRITORY_VOD__C,
        src.TIME_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TIME_OFF_TERRITORY_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TIME_OFF_TERRITORY_VOD__C'::varchar(29)))));

CREATE  VIEW raw.ext_touchpoint_call AS
 SELECT src.CALL_ID,
        src.CALL_ATTEMPT_ID,
        src.TOUCHPOINT_ID,
        src.CLIENT_ID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.CALL_TYPE,
        src.CALL_DATE,
        src.STATUS_CODE,
        src.STATUS_DESCRIPTION,
        src.REP_ID,
        src.REP_FIRST_NAME,
        src.REP_LAST_NAME,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TOUCHPOINT_CALL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TOUCHPOINT_CALL'::varchar(19)))));

CREATE  VIEW raw.ext_touchpoint_presentation AS
 SELECT src.CALL_ID,
        src.CALL_ATTEMPT_ID,
        src.PRESENTATION_ID,
        src.PRODUCT,
        src."POSITION",
        src.ITEM_TYPE,
        src.ITEM_DESCRIPTION,
        src.QUANTITY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TOUCHPOINT_PRESENTATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TOUCHPOINT_PRESENTATION'::varchar(27)))));

CREATE  VIEW raw.ext_tw_hd_smith_sales AS
 SELECT src.MONTH,
        src.ORDER_DATE,
        src.SHIP_DATE,
        src.ORDER_NUM,
        src.INVOICE_NUM,
        src.ORDER_TYPE,
        src.ORDER_CATEGORY,
        src.RETURN_FLAG,
        src.SHIP_TO_CUSTOMER_NUM,
        src.SHIP_TO_CUSTOMER_NAME,
        src.SHIP_TO_ADDRESS_1,
        src.SHIP_TO_ADDRESS_2,
        src.SHIP_TO_CITY,
        src.SHIP_TO_STATE,
        src.SHIP_TO_ZIP,
        src.BILL_TO_CUSTOMER_NUM,
        src.BILL_TO_CUSTOMER_NAME,
        src.BILL_TO_ADDRESS_1,
        src.BILL_TO_ADDRESS_2,
        src.BILL_TO_CITY,
        src.BILL_TO_STATE,
        src.BILL_TO_ZIP,
        src.CLASS_OF_TRADE,
        src.CUSTOMER_DEA_NUM,
        src.CUSTOMER_340B_NUM,
        src.HEALTH_INDUSTRY_NUM,
        src.STATE_LICENSE_NUM,
        src.PLANT,
        src.VENDOR,
        src.MATERIAL_NUM,
        src.MATERIAL_DESC,
        src.PACK_SIZE,
        src.NDC,
        src.CONTRACT_NUM,
        src.QUANTITY,
        src.VALUE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TW_HD_SMITH_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_HD_SMITH_SALES'::varchar(21)))));

CREATE  VIEW raw.ext_vv_accountshare AS
 SELECT src.ACCOUNTACCESSLEVEL,
        src.ACCOUNTID,
        src.CASEACCESSLEVEL,
        src.CONTACTACCESSLEVEL,
        src.ID,
        src.ISDELETED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.OPPORTUNITYACCESSLEVEL,
        src.ROWCAUSE,
        src.USERORGROUPID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_ACCOUNTSHARE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_ACCOUNTSHARE'::varchar(19)))));

CREATE  VIEW raw.ext_vv_acct_merge_history_vod AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.ACCOUNT_VOD__C,
        src.PERSONCONTACTID_VOD__C,
        src.ACCOUNT_PERSONCONTACTID_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_ACCT_MERGE_HISTORY_VOD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_ACCT_MERGE_HISTORY_VOD'::varchar(29)))));

CREATE  VIEW raw.ext_vv_address_vod__c AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.RECORDTYPEID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.ACCOUNT_VOD__C,
        src.ADDRESS_LINE_2_VOD__C,
        src.CITY_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.DEA_VOD__C,
        src.DEA_EXPIRATION_DATE_VOD__C,
        src.DEA_LICENSE_ADDRESS_VOD__C,
        src.PHONE_VOD__C,
        src.FAX_VOD__C,
        src.MAP_VOD__C,
        src.SHIPPING_VOD__C,
        src.PRIMARY_VOD__C,
        src.LICENSE_VOD__C,
        src.LICENSE_EXPIRATION_DATE_VOD__C,
        src.STAFF_NOTES_VOD__C,
        src.APPT_REQUIRED_VOD__C,
        src.OFFICE_NOTES_VOD__C,
        src.LICENSE_STATUS_VOD__C,
        src.ZIP_4_VOD__C,
        src.PHONE_2_VOD__C,
        src.FAX_2_VOD__C,
        src.LICENSE_VALID_TO_SAMPLE_VOD__C,
        src.SAMPLE_STATUS_VOD__C,
        src.INCLUDE_TERRITORY_ASSIGNMENT,
        src.MOBILE_ID_VOD__C,
        src.INACTIVE_VOD__C,
        src.LOCK_VOD__C,
        src.COUNTRY_VOD__C,
        src.LATITUDE_VOD__C,
        src.ZIP_VOD__C,
        src.BEST_TIMES_VOD__C,
        src.SOURCE_VOD__C,
        src.BRICK_VOD__C,
        src.ASSMCA_VOD__C,
        src.DEA_ADDRESS_VOD__C,
        src.DEA_SCHEDULE_VOD__C,
        src.BUSINESS_VOD__C,
        src.BILLING_VOD__C,
        src.HOME_VOD__C,
        src.MAILING_VOD__C,
        src.STATE_VOD__C,
        src.LONGITUDE_VOD__C,
        src.DEA_STATUS_VOD__C,
        src.ENTITY_REFERENCE_ID_VOD__C,
        src.CONTROLLING_ADDRESS_VOD__C,
        src.CONTROLLED_ADDRESS_VOD__C,
        src.NO_ADDRESS_COPY_VOD__C,
        src.ADDRESS_LINE_3_TVA__C,
        src.COUNTY_TVA__C,
        src.EXTERNAL_SLN_TVA__C,
        src.LICENSE_EXPIRATION_DATE_TVA__C,
        src.REP_ENTERED_SLN_TVA__C,
        src.DEA_CONTACT_TVA__C,
        src.MARK_FOR_DELETION_TVA__C,
        src.LICENSE_VALID_DATE_TVA__C,
        src.LICENSE_VALID_NUM_TVA__C,
        src.CM_ID_TVA__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_ADDRESS_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_ADDRESS_VOD__C'::varchar(21)))));

CREATE  VIEW raw.ext_vv_affiliation_vod__c AS
 SELECT src.CHILD_AFFILIATION_VOD__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.DESTROY_VOD__C,
        src.DISABLE_TRIGGER_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.FROM_ACCOUNT_VOD__C,
        src.FROM_CONTACT_VOD__C,
        src.ID,
        src.INFLUENCE_VOD__C,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.OWNERID,
        src.PARENT_VOD__C,
        src.ROLE_VOD__C,
        src.SYSTEMMODSTAMP,
        src.TO_ACCOUNT_VOD__C,
        src.TO_CONTACT_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_AFFILIATION_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_AFFILIATION_VOD__C'::varchar(25)))));

CREATE  VIEW raw.ext_vv_assessment__c AS
 SELECT src.ACCOUNT__C,
        src.ASSESSMENT_DATE_TVA__C,
        src.CC_PATIENT_PROFILES__C,
        src.CC_STUDY_LEVERAGE__C,
        src.CML_Q1_TVA__C,
        src.CML_Q2_TVA__C,
        src.CML_Q3_TVA__C,
        src.CML_Q4_TVA__C,
        src.CML_Q5_1_TVA__C,
        src.CML_Q5_TVA__C,
        src.CML_Q6_TVA__C,
        src.CML_Q7_1_TVA__C,
        src.CML_Q7_TVA__C,
        src.COMMUNITY_ACTIVITY__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.HISTORICAL_ASSESSMENT_TVA__C,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.LN_PATIENT_PROFILES__C,
        src.LN_STUDY_LEVERAGE__C,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.ONCOLOGY_BOARD__C,
        src.PREFERRED_PATHOLOGIST__C,
        src.RECORDTYPEID,
        src.RESEARCH_FOCUS__C,
        src.RL_PATIENT_PROFILES__C,
        src.RL_STUDY_LEVERAGE__C,
        src.SYSTEMMODSTAMP,
        src.TREATMENT_PREFERENCES__C,
        src.TREATMENT_VOLUME__C,
        src.TUMOR_TYPES__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_ASSESSMENT__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_ASSESSMENT__C'::varchar(20)))));

CREATE  VIEW raw.ext_vv_call2_detail_vod__c AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.is_parent_call_vod__c,
        src.call2_vod__c,
        src.product_vod__c,
        src.detail_priority_vod__c,
        src.mobile_id_vod__c,
        src.type_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_DETAIL_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_DETAIL_VOD__C'::varchar(26)))));

CREATE  VIEW raw.ext_vv_call2_key_message_vod AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.account_vod__c,
        src.call2_vod__c,
        src.reaction_vod__c,
        src.product_vod__c,
        src.key_message_vod__c,
        src.mobile_id_vod__c,
        src.contact_vod__c,
        src.call_date_vod__c,
        src.user_vod__c,
        src.category_vod__c,
        src.vehicle_vod__c,
        src.is_parent_call_vod__c,
        src.clm_id_vod__c,
        src.slide_version_vod__c,
        src.duration_vod__c,
        src.presentation_id_vod__c,
        src.start_time_vod__c,
        src.attendee_type_vod__c,
        src.entity_reference_id_vod__c,
        src.segment_vod__c,
        src.display_order_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_KEY_MESSAGE_VOD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_KEY_MESSAGE_VOD'::varchar(28)))));

CREATE  VIEW raw.ext_vv_call2_vod__history AS
 SELECT src.ID,
        src.ISDELETED,
        src.PARENTID,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.FIELD,
        src.OLDVALUE,
        src.NEWVALUE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_VOD__HISTORY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_VOD__HISTORY'::varchar(25)))));

CREATE  VIEW raw.ext_vv_call_goal_tva__c AS
 SELECT src.ACCOUNT_TVA__C,
        src.ACTIVE_TVA__C,
        src.ACTUAL_REMAINING_TVA__C,
        src.ACTUAL_TVA__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.END_DATE_TVA__C,
        src.EXTERNAL_ID_TVA__C,
        src.GOAL_TVA__C,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTACTIVITYDATE,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYEDIT,
        src.NAME,
        src.OWNERID,
        src.PRIORITY_TVA__C,
        src.PRODUCT_CATALOG_TVA__C,
        src.REMAINING_TVA__C,
        src.SORT_ORDER_TVA__C,
        src.START_DATE_TVA__C,
        src.SYSTEMMODSTAMP,
        src.TERRITORY_TVA__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL_GOAL_TVA__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL_GOAL_TVA__C'::varchar(23)))));

CREATE  VIEW raw.ext_vv_deciles_tva__c AS
 SELECT src.ACCOUNT_VOD__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTACTIVITYDATE,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MARKET_TVA__C,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.SYSTEMMODSTAMP,
        src.VALUE_TVA__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_DECILES_TVA__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_DECILES_TVA__C'::varchar(21)))));

CREATE  VIEW raw.ext_vv_group AS
 SELECT src.CREATEDBYID,
        src.CREATEDDATE,
        src.DEVELOPERNAME,
        src.DOESINCLUDEBOSSES,
        src.DOESSENDEMAILTOMEMBERS,
        src.EMAIL,
        src.ID,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.NAME,
        src.OWNERID,
        src.RELATEDID,
        src.SYSTEMMODSTAMP,
        src.TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_GROUP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_GROUP'::varchar(12)))));

CREATE  VIEW raw.ext_vv_key_message_vod__c AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.description_vod__c,
        src.product_vod__c,
        src.product_strategy_vod__c,
        src.display_order_vod__c,
        src.active_vod__c,
        src.category_vod__c,
        src.vehicle_vod__c,
        src.clm_id_vod__c,
        src.custom_reaction_vod__c,
        src.slide_version_vod__c,
        src.language_vod__c,
        src.media_file_crc_vod__c,
        src.media_file_name_vod__c,
        src.media_file_size_vod__c,
        src.segment_vod__c,
        src.group_to_share_to__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_KEY_MESSAGE_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_KEY_MESSAGE_VOD__C'::varchar(25)))));

CREATE  VIEW raw.ext_vv_medical_inquiry_vod__c AS
 SELECT src.ACCOUNT_VOD__C,
        src.ADDRESS_LINE_1_VOD__C,
        src.ADDRESS_LINE_2_VOD__C,
        src.CALL2_VOD__C,
        src.CITY_VOD__C,
        src.COUNTRY_VOD__C,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.DELIVERY_METHOD_VOD__C,
        src.DISCLAIMER_VOD__C,
        src.EMAIL_VOD__C,
        src.ENTITY_REFERENCE_ID_VOD__C,
        src.FAX_NUMBER_VOD__C,
        src.ID,
        src.INQUIRY_TEXT__C,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.LOCK_VOD__C,
        src.MAYEDIT,
        src.MOBILE_ID_VOD__C,
        src.MSL_CONSULT__C,
        src.NAME,
        src.NEW_EMAIL_TVA__C,
        src.NEW_FAX_TVA__C,
        src.PHONE_NUMBER_VOD__C,
        src.PRODUCT__C,
        src.RECORDTYPEID,
        src.RUSH_DELIVERY__C,
        src.SIGNATURE_DATE_VOD__C,
        src.SIGNATURE_VOD__C,
        src.SOURCE__C,
        src.STATE_VOD__C,
        src.STATUS_VOD__C,
        src.SUBMITTED_BY_MOBILE_VOD__C,
        src.SYSTEMMODSTAMP,
        src.ZIP_VOD__C,
        src.ZVOD_DELIVERY_METHOD_VOD__C,
        src.ZVOD_DISCLAIMER_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_MEDICAL_INQUIRY_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_MEDICAL_INQUIRY_VOD__C'::varchar(29)))));

CREATE  VIEW raw.ext_vv_product_metrics_vod__c AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.ACCOUNT_VOD__C,
        src.AWARENESS__C,
        src.SELLING_STAGE__C,
        src.FORMULARY_STATUS__C,
        src.MOVEMENT__C,
        src.PRODUCTS_VOD__C,
        src.SEGMENT__C,
        src.X12_MO_TRX_CHG__C,
        src.SPEAKER_SKILLS__C,
        src.INVESTIGATOR_READINESS__C,
        src.ENGAGEMENTS__C,
        src.MOBILE_ID_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.DECILE_VALUE_TVA__C,
        src.CURRENT_TVA__C,
        src.EXTERNAL_ID_TVA__C,
        src.MARKETING_TARGET_TVA__C,
        src.PRIOR_TVA__C,
        src.REP_TARGET_TVA__C,
        src.SBO_TARGET_TVA__C,
        src.TRX_3_MONTH_TVA__C,
        src.TRX_6_MONTH_TVA__C,
        src.TRX_YTD_TVA__C,
        src.CP_DECILE_TVA__C,
        src.BUSINESS_SEGMENT_TVA__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_PRODUCT_METRICS_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_PRODUCT_METRICS_VOD__C'::varchar(29)))));

CREATE  VIEW raw.ext_vv_question_response_vod AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.RECORDTYPEID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.SURVEY_TARGET_VOD__C,
        src.ANSWER_CHOICE_VOD__C,
        src.DATE_VOD__C,
        src.DATETIME_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.MOBILE_ID_VOD__C,
        src.NUMBER_VOD__C,
        src.ORDER_VOD__C,
        src.QUESTION_TEXT_VOD__C,
        src.REQUIRED_VOD__C,
        src.RESPONSE_HASH_VOD__C,
        src.RESPONSE_VOD__C,
        src.SCORE_VOD__C,
        src.SURVEY_QUESTION_VOD__C,
        src.TEXT_VOD__C,
        src.TYPE_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_QUESTION_RESPONSE_VOD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_QUESTION_RESPONSE_VOD'::varchar(28)))));

CREATE  VIEW raw.ext_vv_recordtype AS
 SELECT src.BUSINESSPROCESSID,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.DESCRIPTION,
        src.DEVELOPERNAME,
        src.ID,
        src.ISACTIVE,
        src.ISPERSONTYPE,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.NAME,
        src.NAMESPACEPREFIX,
        src.SOBJECTTYPE,
        src.SYSTEMMODSTAMP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_RECORDTYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_RECORDTYPE'::varchar(17)))));

CREATE  VIEW raw.ext_vv_survey_question_vod__c AS
 SELECT src.ID,
        src.ISDELETED,
        src.NAME,
        src.RECORDTYPEID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.SURVEY_VOD__C,
        src.ANSWER_CHOICE_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.MAX_SCORE_VOD__C,
        src.MIN_SCORE_VOD__C,
        src.ORDER_VOD__C,
        src.QUESTION_VOD__C,
        src.REQUIRED_VOD__C,
        src.TEXT_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SURVEY_QUESTION_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SURVEY_QUESTION_VOD__C'::varchar(29)))));

CREATE  VIEW raw.ext_vv_survey_vod__c AS
 SELECT src.ID,
        src.OWNERID,
        src.ISDELETED,
        src.NAME,
        src.RECORDTYPEID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.LASTVIEWEDDATE,
        src.LASTREFERENCEDDATE,
        src.ASSIGNMENT_TYPE_VOD__C,
        src.CHANNELS_VOD__C,
        src.END_DATE_VOD__C,
        src.EXPIRED_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.LANGUAGE_VOD__C,
        src.LOCK_VOD__C,
        src.OPEN_VOD__C,
        src.PRODUCT_VOD__C,
        src.REGION_VOD__C,
        src.SEGMENT_VOD__C,
        src.START_DATE_VOD__C,
        src.STATUS_VOD__C,
        src.TERRITORY_VOD__C,
        src.ZVOD_QUESTIONS_VOD__C,
        src.ZVOD_SEGMENTS_VOD__C,
        src.ZVOD_TARGETS_VOD__C,
        src.MAX_SCORE_VOD__C,
        src.MIN_SCORE_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SURVEY_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SURVEY_VOD__C'::varchar(20)))));

CREATE  VIEW raw.ext_vv_sync_tracking_vod__c AS
 SELECT src.CREATEDBYID,
        src.CREATEDDATE,
        src.DOWNLOAD_PROCESSED_VOD__C,
        src.ID,
        src.ISDELETED,
        src.ISLOCKED,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYEDIT,
        src.MEDIA_PROCESSED_VOD__C,
        src.MOBILE_ID_VOD__C,
        src.NAME,
        src.OWNERID,
        src.SUCCESSFUL_SYNC_VOD__C,
        src.SYNC_COMPLETED_DATETIME_VOD__C,
        src.SYNC_DURATION_VOD__C,
        src.SYNC_START_DATETIME_VOD__C,
        src.SYNC_TYPE_VOD__C,
        src.SYSTEMMODSTAMP,
        src.UPLOAD_PROCESSED_VOD__C,
        src.VERSION_VOD__C,
        src.VINSIGHTS_PROCESSED_VOD__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SYNC_TRACKING_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SYNC_TRACKING_VOD__C'::varchar(27)))));

CREATE  VIEW raw.ext_vv_territory AS
 SELECT src.ACCOUNTACCESSLEVEL,
        src.CASEACCESSLEVEL,
        src.CONTACTACCESSLEVEL,
        src.DESCRIPTION,
        src.DEVELOPERNAME,
        src.FORECASTUSERID,
        src.ID,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYFORECASTMANAGERSHARE,
        src.NAME,
        src.OPPORTUNITYACCESSLEVEL,
        src.PARENTTERRITORYID,
        src.RESTRICTOPPORTUNITYTRANSFER,
        src.SYSTEMMODSTAMP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TERRITORY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TERRITORY'::varchar(16)))));

CREATE  VIEW raw.ext_vv_userrole AS
 SELECT src.CASEACCESSFORACCOUNTOWNER,
        src.CONTACTACCESSFORACCOUNTOWNER,
        src.DEVELOPERNAME,
        src.FORECASTUSERID,
        src.ID,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.MAYFORECASTMANAGERSHARE,
        src.NAME,
        src.OPPORTUNITYACCESSACCOUNTOWNER,
        src.PARENTROLEID,
        src.PORTALACCOUNTID,
        src.PORTALACCOUNTOWNERID,
        src.PORTALTYPE,
        src.ROLLUPDESCRIPTION,
        src.SYSTEMMODSTAMP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_USERROLE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_USERROLE'::varchar(15)))));

CREATE  VIEW raw.ext_vv_userterritory AS
 SELECT src.ID,
        src.ISACTIVE,
        src.LASTMODIFIEDBYID,
        src.LASTMODIFIEDDATE,
        src.SYSTEMMODSTAMP,
        src.TERRITORYID,
        src.USERID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_USERTERRITORY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_USERTERRITORY'::varchar(20)))));

CREATE  VIEW raw.ext_wholesale_867 AS
 SELECT src.TRADING_PARTNER,
        src.PARTNER_DUNS,
        src.PARTNER_DUNS_4,
        src.PARTNER_DEA,
        src.PARTNER_HIN,
        src.PARTNER_SELLER_ASSIGNED_ID,
        src.PARTNER_BUYER_ASSIGNED_ID,
        src.CLIENT_NAME,
        src.ADDRESS1,
        src.ADDRESS2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.CLIENT_DUNS,
        src.CLIENT_DEA,
        src.CLIENT_HIN,
        src.CLIENT_SELLER_ASSIGNED_ID,
        src.CLIENT_BUYER_ASSIGNED_ID,
        src.NCPDP,
        src.NDC,
        src.ITEM,
        src.SHIP_DATE,
        src.QUANTITY_PURCHASED,
        src.QUANTITY_RETURNED,
        src.UNIT_PRICE,
        src.GROSS_AMOUNT,
        src.DROP_SHIPMENTS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_WHOLESALE_867_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_WHOLESALE_867'::varchar(17)))));

CREATE  VIEW raw.job_title_defs AS
 SELECT src.JOB_CD,
        src.CD_DESC,
        src.ADP_JOB_CD,
        src.CRT_DT,
        src.CRT_USER,
        src.UPD_DT,
        src.UPD_USER,
        src.DISPLAY_SEQ,
        src.COMPANY_ID,
        src.EFF_DT,
        src.EXP_DT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.job_title_defs_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'JOB_TITLE_DEFS'::varchar(14)))));

CREATE  VIEW raw.people AS
 SELECT src.SYS_ID,
        src.CRT_DT,
        src.CRT_USER,
        src.UPD_DT,
        src.UPD_USER,
        src.LAST_NAME,
        src.FIRST_NAME,
        src.STAT_CD,
        src.GENDER,
        src.MID_NAME,
        src.NAME_SUFFIX,
        src.PRSN_TITLE,
        src.PROF_TITLE,
        src.EMAIL,
        src.PREF_NAME,
        src.PREV_LAST_NAME,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.people_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PEOPLE'::varchar(6)))));

CREATE  VIEW raw.people_addresses AS
 SELECT src.PRSN_SYS_ID,
        src.ADDR_ID,
        src.ATD_CD,
        src.PRIORITY,
        src.MAIL_STOP,
        src.EFF_DT,
        src.END_DT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.people_addresses_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PEOPLE_ADDRESSES'::varchar(16)))));

CREATE  VIEW raw.people_phones AS
 SELECT src.PRSN_SYS_ID,
        src.PHN_ID,
        src.PTD_CD,
        src.PRIORITY,
        src.EXT,
        src.VMAIL,
        src.ADDR_ID,
        src.PRVDR_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.people_phones_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PEOPLE_PHONES'::varchar(13)))));

CREATE  VIEW raw.phones AS
 SELECT src.PHN_ID,
        src.CNTRY_DIAL_CD,
        src.AREA_CD,
        src.PHN_NUMBER,
        src.CRT_USER,
        src.CRT_DT,
        src.UPD_USER,
        src.UPD_DT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.phones_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PHONES'::varchar(6)))));

CREATE  VIEW raw.territories AS
 SELECT src.TERR_ID,
        src.NAME,
        src.DESC_TEXT,
        src.COMPANY_CD,
        src.TERR_TYPE,
        src.TEAM,
        src.SAMPLE_DIST,
        src.COMMENTS,
        src.FLEET_ELIG,
        src.REP_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.territories_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'TERRITORIES'::varchar(11)))));

CREATE  VIEW raw.tvcmid_hco_demo AS
 SELECT src.TVCMID,
        src.IMS_ORG_ID,
        src.NPI,
        src.HIN,
        src.IMS_OUTLET_CODE,
        src.BUSINESS_NAME,
        src.ADDRESS_LINE1,
        src.ADDRESS_LINE2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.C_BO_HCE_ADDRESS__ADDRESS_ID,
        src.COT_CLASSIFICATION,
        src.COT_FACILITY_TYPE,
        src.COT_SPECIALTY,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.tvcmid_hco_demo_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'TVCMID_HCO_DEMO'::varchar(15)))));

CREATE  VIEW raw.tvcmid_merges AS
 SELECT src.PREVIOUS_TVCMID,
        src.CURRENT_TVCMID,
        src.MERGE_CYCLE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.tvcmid_merges_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'TVCMID_MERGES'::varchar(13)))));

CREATE  VIEW raw.tvcmid_xref AS
 SELECT src.TVCMID,
        src.ID_NUM,
        src.ID_TYPE,
        src.STATE,
        src.EXPIRATION_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.tvcmid_xref_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'TVCMID_XREF'::varchar(11)))));

CREATE  VIEW raw.xx_sales_loa_mv AS
 SELECT src.FILE_NBR,
        src.NAME,
        src.JOB_TITLE,
        src.COST_CENTER_NAME,
        src.DEPARTMENT,
        src.EE_STATUS,
        src.LEAVE_DT,
        src.RETURN_DT,
        src.LEAVE_DAYS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XX_SALES_LOA_MV_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XX_SALES_LOA_MV'::varchar(15)))));

CREATE  VIEW raw.xx_sales_mv AS
 SELECT src.FILE_NBR,
        src.NAME,
        src.JOB_TITLE,
        src.COST_CENTER_NAME,
        src.DEPARTMENT,
        src.JOB_ENTRY_DT,
        src.MANAGER_LEVEL,
        src.EE_STATUS,
        src.WORK_LOCATION,
        src.WORK_LOCATION_NAME,
        src.ORIG_HIRE_DT,
        src.SERVICE_DT,
        src.REHIRE_DT,
        src.TERMINATION_DT,
        src.DIRECT_MANAGER,
        src.HOME_ADDRESS_LINE1,
        src.HOME_ADDRESS_LINE2,
        src.HOME_CITY,
        src.HOME_STATE,
        src.HOME_POSTAL_CODE,
        src.HOME_PHONE,
        src.CELL_PHONE,
        src.EMAIL_ADDRESS,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XX_SALES_MV_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XX_SALES_MV'::varchar(11)))));

CREATE  VIEW raw.xx_terr_id_change_v AS
 SELECT src.EE_NBR,
        src.EE_NAME,
        src.TERR_ID_FROM,
        src.TERR_ID_TO,
        src.TERR_MOVE_DT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XX_TERR_ID_CHANGE_V_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XX_TERR_ID_CHANGE_V'::varchar(19)))));

CREATE  VIEW raw.ext_ahm_event_attendee AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.EMPLOYEE_ID,
        src.CUSTOMER_ID,
        src.ATTENDEE_ID,
        src.ATTENDEE_LAST_NAME,
        src.ATTENDEE_FIRST_NAME,
        src.ATTENDEE_MIDDLE_NAME,
        src.ATTENDEE_TITLE,
        src.ATTENDEE_SPECIALTY,
        src.ATTENDEE_DEGREE,
        src.ATTENDEE_ADDRESS_LINE_1,
        src.ATTENDEE_ADDRESS_LINE_2,
        src.ATTENDEE_ADDRESS_LINE_3,
        src.ATTENDEE_ADDRESS_LINE_4,
        src.ATTENDEE_CITY,
        src.ATTENDEE_STATE_PROVINCE,
        src.ATTENDEE_POSTAL_CODE,
        src.ATTENDEE_POSTAL_EXTENDED_CODE,
        src.ATTENDEE_COUNTRY_CODE,
        src.ATTENDEE_PHONE,
        src.ATTENDEE_FAX,
        src.ATTENDEE_EMAIL,
        src.DEA_NUMBER,
        src.IMS_NUMBER,
        src.ME_NUMBER,
        src.NPI_NUMBER,
        src.ATTENDEE_CATEGORY_CODE,
        src.ATTENDED,
        src.MEAL,
        src.NON_HCP_COUNT,
        src.OTHER_HCP_COUNT,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_ATTENDEE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22)))));

CREATE  VIEW raw.ext_f60q AS
 SELECT src."CLI#" AS CLI,
        src.SUFFIX,
        src."TERR#" AS TERR,
        src.BLANK1,
        src."OUTLET#" AS OUTLET,
        src.NAME,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.RPT_TYPE,
        src.BLANK2,
        src.STATUS,
        src.BLANK3,
        src.SUBCAT,
        src.STATE_CODE,
        src.COUNTY_CODE,
        src.REC_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_F60Q_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_F60Q'::varchar(8)))));

CREATE  VIEW raw.ext_specialty_pharmacy_lookups AS
 SELECT src.SOURCE_ID,
        src.LAST_NAME,
        src.FIRST_NAME,
        src.NPI,
        src.ADDRESS1,
        src.ADDRESS2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.IMS_ID,
        src."MATCH" AS MATCH_ID,
        src.HCE_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_SPECIALTY_PHARMACY_LOOKUPS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_SPECIALTY_PHARMACY_LOOKUPS'::varchar(30)))));

CREATE  VIEW teva_ingestion.EXT_FTF_PREDOMINANT AS
 SELECT btrim(EXT_FTF_PREDOMINANT_src.IMS_PLAN_ID) AS IMS_PLAN_ID,
        btrim(EXT_FTF_PREDOMINANT_src.IMS_PLAN_NAME) AS IMS_PLAN_NAME,
        btrim(EXT_FTF_PREDOMINANT_src.FF_PLAN_ID) AS FF_PLAN_ID,
        btrim(EXT_FTF_PREDOMINANT_src.FF_PLAN_NAME) AS FF_PLAN_NAME,
        EXT_FTF_PREDOMINANT_src.batch_id,
        EXT_FTF_PREDOMINANT_src.row_id,
        EXT_FTF_PREDOMINANT_src.update_ts
 FROM teva_ingestion.EXT_FTF_PREDOMINANT_src
 WHERE (EXT_FTF_PREDOMINANT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_PREDOMINANT'::varchar(19))));

CREATE  VIEW raw.ext_ftf_predominant AS
 SELECT src.IMS_PLAN_ID,
        src.IMS_PLAN_NAME,
        src.FF_PLAN_ID,
        src.FF_PLAN_NAME,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_PREDOMINANT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_PREDOMINANT'::varchar(19)))));

CREATE  VIEW teva_ingestion.EXT_ONC_MANUAL_FCRS AS
 SELECT btrim(EXT_ONC_MANUAL_FCRS_src.TIME_PERIOD) AS TIME_PERIOD,
        btrim(EXT_ONC_MANUAL_FCRS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ONC_MANUAL_FCRS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ONC_MANUAL_FCRS_src.REP_ID) AS REP_ID,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.CONTACT_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.CONTACT_DATE))::date END AS CONTACT_DATE,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.DURATION_DAYS = ''::varchar) THEN NULL::numeric(1,0) ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.DURATION_DAYS))::numeric(3,2) END AS DURATION_DAYS,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_OPENING = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_OPENING))::int END AS SS_OPENING,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_PROBING = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_PROBING))::int END AS SS_PROBING,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_RESOURCES = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_RESOURCES))::int END AS SS_RESOURCES,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_COMMITMENT = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_COMMITMENT))::int END AS SS_COMMITMENT,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_TRANSITIONING = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_TRANSITIONING))::int END AS SS_TRANSITIONING,
        CASE WHEN (EXT_ONC_MANUAL_FCRS_src.SS_ACUMEN = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_MANUAL_FCRS_src.SS_ACUMEN))::int END AS SS_ACUMEN,
        btrim(EXT_ONC_MANUAL_FCRS_src.ARCHIVE_FLAG) AS ARCHIVE_FLAG,
        EXT_ONC_MANUAL_FCRS_src.batch_id,
        EXT_ONC_MANUAL_FCRS_src.row_id,
        EXT_ONC_MANUAL_FCRS_src.update_ts
 FROM teva_ingestion.EXT_ONC_MANUAL_FCRS_src
 WHERE (EXT_ONC_MANUAL_FCRS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_MANUAL_FCRS'::varchar(19))));

CREATE  VIEW metadata.integration_table_counts_by_file_id AS
 SELECT A.integration_table,
        A.file_id,
        A.counts
 FROM (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((( SELECT 'integration.call_plan'::varchar(21) AS integration_table,
        call_plan.file_id,
        count(*) AS counts
 FROM integration.call_plan
 GROUP BY 'integration.call_plan'::varchar(21),
          call_plan.file_id UNION ALL  SELECT 'integration.chargebacks'::varchar(23) AS integration_table,
        chargebacks.file_id,
        count(*) AS counts
 FROM integration.chargebacks
 GROUP BY 'integration.chargebacks'::varchar(23),
          chargebacks.file_id) UNION ALL  SELECT 'integration.clozapine_sales'::varchar(27) AS integration_table,
        clozapine_sales.file_id,
        count(*) AS counts
 FROM integration.clozapine_sales
 GROUP BY 'integration.clozapine_sales'::varchar(27),
          clozapine_sales.file_id) UNION ALL  SELECT 'integration.cmop_rx'::varchar(19) AS integration_table,
        cmop_rx.file_id,
        count(*) AS counts
 FROM integration.cmop_rx
 GROUP BY 'integration.cmop_rx'::varchar(19),
          cmop_rx.file_id) UNION ALL  SELECT 'integration.copay_detail_weekly'::varchar(31) AS integration_table,
        copay_detail_weekly.file_id,
        count(*) AS counts
 FROM integration.copay_detail_weekly
 GROUP BY 'integration.copay_detail_weekly'::varchar(31),
          copay_detail_weekly.file_id) UNION ALL  SELECT 'integration.copay_redemptions'::varchar(29) AS integration_table,
        copay_redemptions.file_id,
        count(*) AS counts
 FROM integration.copay_redemptions
 GROUP BY 'integration.copay_redemptions'::varchar(29),
          copay_redemptions.file_id) UNION ALL  SELECT 'integration.copay_weekly'::varchar(24) AS integration_table,
        copay_weekly.file_id,
        count(*) AS counts
 FROM integration.copay_weekly
 GROUP BY 'integration.copay_weekly'::varchar(24),
          copay_weekly.file_id) UNION ALL  SELECT 'integration.ddd'::varchar(15) AS integration_table,
        ddd.file_id,
        count(*) AS counts
 FROM integration.ddd
 GROUP BY 'integration.ddd'::varchar(15),
          ddd.file_id) UNION ALL  SELECT 'integration.ddd_md'::varchar(18) AS integration_table,
        ddd_md.file_id,
        count(*) AS counts
 FROM integration.ddd_md
 GROUP BY 'integration.ddd_md'::varchar(18),
          ddd_md.file_id) UNION ALL  SELECT 'integration.ddd_md_demographics'::varchar(31) AS integration_table,
        ddd_md_demographics.file_id,
        count(*) AS counts
 FROM integration.ddd_md_demographics
 GROUP BY 'integration.ddd_md_demographics'::varchar(31),
          ddd_md_demographics.file_id) UNION ALL  SELECT 'integration.direct_sales'::varchar(24) AS integration_table,
        direct_sales.file_id,
        count(*) AS counts
 FROM integration.direct_sales
 GROUP BY 'integration.direct_sales'::varchar(24),
          direct_sales.file_id) UNION ALL  SELECT 'integration.event'::varchar(17) AS integration_table,
        event.file_id,
        count(*) AS counts
 FROM integration.event
 GROUP BY 'integration.event'::varchar(17),
          event.file_id) UNION ALL  SELECT 'integration.event_attendee'::varchar(26) AS integration_table,
        event_attendee.file_id,
        count(*) AS counts
 FROM integration.event_attendee
 GROUP BY 'integration.event_attendee'::varchar(26),
          event_attendee.file_id) UNION ALL  SELECT 'integration.event_count'::varchar(23) AS integration_table,
        event_count.file_id,
        count(*) AS counts
 FROM integration.event_count
 GROUP BY 'integration.event_count'::varchar(23),
          event_count.file_id) UNION ALL  SELECT 'integration.event_expense'::varchar(25) AS integration_table,
        event_expense.file_id,
        count(*) AS counts
 FROM integration.event_expense
 GROUP BY 'integration.event_expense'::varchar(25),
          event_expense.file_id) UNION ALL  SELECT 'integration.event_host'::varchar(22) AS integration_table,
        event_host.file_id,
        count(*) AS counts
 FROM integration.event_host
 GROUP BY 'integration.event_host'::varchar(22),
          event_host.file_id) UNION ALL  SELECT 'integration.event_product'::varchar(25) AS integration_table,
        event_product.file_id,
        count(*) AS counts
 FROM integration.event_product
 GROUP BY 'integration.event_product'::varchar(25),
          event_product.file_id) UNION ALL  SELECT 'integration.event_speaker'::varchar(25) AS integration_table,
        event_speaker.file_id,
        count(*) AS counts
 FROM integration.event_speaker
 GROUP BY 'integration.event_speaker'::varchar(25),
          event_speaker.file_id) UNION ALL  SELECT 'integration.ims_outlet_master'::varchar(29) AS integration_table,
        ims_outlet_master.file_id,
        count(*) AS counts
 FROM integration.ims_outlet_master
 GROUP BY 'integration.ims_outlet_master'::varchar(29),
          ims_outlet_master.file_id) UNION ALL  SELECT 'integration.ims_product_list'::varchar(28) AS integration_table,
        ims_product_list.file_id,
        count(*) AS counts
 FROM integration.ims_product_list
 GROUP BY 'integration.ims_product_list'::varchar(28),
          ims_product_list.file_id) UNION ALL  SELECT 'integration.mm_accounts'::varchar(23) AS integration_table,
        mm_accounts.file_id,
        count(*) AS counts
 FROM integration.mm_accounts
 GROUP BY 'integration.mm_accounts'::varchar(23),
          mm_accounts.file_id) UNION ALL  SELECT 'integration.mm_control'::varchar(22) AS integration_table,
        mm_control.file_id,
        count(*) AS counts
 FROM integration.mm_control
 GROUP BY 'integration.mm_control'::varchar(22),
          mm_control.file_id) UNION ALL  SELECT 'integration.mm_copays'::varchar(21) AS integration_table,
        mm_copays.file_id,
        count(*) AS counts
 FROM integration.mm_copays
 GROUP BY 'integration.mm_copays'::varchar(21),
          mm_copays.file_id) UNION ALL  SELECT 'integration.mm_drug_class_therapeutic_area'::varchar(42) AS integration_table,
        mm_drug_class_therapeutic_area.file_id,
        count(*) AS counts
 FROM integration.mm_drug_class_therapeutic_area
 GROUP BY 'integration.mm_drug_class_therapeutic_area'::varchar(42),
          mm_drug_class_therapeutic_area.file_id) UNION ALL  SELECT 'integration.mm_drugs'::varchar(20) AS integration_table,
        mm_drugs.file_id,
        count(*) AS counts
 FROM integration.mm_drugs
 GROUP BY 'integration.mm_drugs'::varchar(20),
          mm_drugs.file_id) UNION ALL  SELECT 'integration.mm_formularies'::varchar(26) AS integration_table,
        mm_formularies.file_id,
        count(*) AS counts
 FROM integration.mm_formularies
 GROUP BY 'integration.mm_formularies'::varchar(26),
          mm_formularies.file_id) UNION ALL  SELECT 'integration.mm_health_plan_geography'::varchar(36) AS integration_table,
        mm_health_plan_geography.file_id,
        count(*) AS counts
 FROM integration.mm_health_plan_geography
 GROUP BY 'integration.mm_health_plan_geography'::varchar(36),
          mm_health_plan_geography.file_id) UNION ALL  SELECT 'integration.mm_health_plans'::varchar(27) AS integration_table,
        mm_health_plans.file_id,
        count(*) AS counts
 FROM integration.mm_health_plans
 GROUP BY 'integration.mm_health_plans'::varchar(27),
          mm_health_plans.file_id) UNION ALL  SELECT 'integration.mm_ims_bridge'::varchar(25) AS integration_table,
        mm_ims_bridge.file_id,
        count(*) AS counts
 FROM integration.mm_ims_bridge
 GROUP BY 'integration.mm_ims_bridge'::varchar(25),
          mm_ims_bridge.file_id) UNION ALL  SELECT 'integration.mm_pbms'::varchar(19) AS integration_table,
        mm_pbms.file_id,
        count(*) AS counts
 FROM integration.mm_pbms
 GROUP BY 'integration.mm_pbms'::varchar(19),
          mm_pbms.file_id) UNION ALL  SELECT 'integration.mm_restrictions'::varchar(27) AS integration_table,
        mm_restrictions.file_id,
        count(*) AS counts
 FROM integration.mm_restrictions
 GROUP BY 'integration.mm_restrictions'::varchar(27),
          mm_restrictions.file_id) UNION ALL  SELECT 'integration.mm_tiers'::varchar(20) AS integration_table,
        mm_tiers.file_id,
        count(*) AS counts
 FROM integration.mm_tiers
 GROUP BY 'integration.mm_tiers'::varchar(20),
          mm_tiers.file_id) UNION ALL  SELECT 'integration.mm_wk_bridge'::varchar(24) AS integration_table,
        mm_wk_bridge.file_id,
        count(*) AS counts
 FROM integration.mm_wk_bridge
 GROUP BY 'integration.mm_wk_bridge'::varchar(24),
          mm_wk_bridge.file_id) UNION ALL  SELECT 'integration.pbm_xref'::varchar(20) AS integration_table,
        pbm_xref.file_id,
        count(*) AS counts
 FROM integration.pbm_xref
 GROUP BY 'integration.pbm_xref'::varchar(20),
          pbm_xref.file_id) UNION ALL  SELECT 'integration.plan_xref'::varchar(21) AS integration_table,
        plan_xref.file_id,
        count(*) AS counts
 FROM integration.plan_xref
 GROUP BY 'integration.plan_xref'::varchar(21),
          plan_xref.file_id) UNION ALL  SELECT 'integration.prescriber_rx'::varchar(25) AS integration_table,
        prescriber_rx.file_id,
        count(*) AS counts
 FROM integration.prescriber_rx
 GROUP BY 'integration.prescriber_rx'::varchar(25),
          prescriber_rx.file_id) UNION ALL  SELECT 'integration.product_unit_ap'::varchar(27) AS integration_table,
        product_unit_ap.file_id,
        count(*) AS counts
 FROM integration.product_unit_ap
 GROUP BY 'integration.product_unit_ap'::varchar(27),
          product_unit_ap.file_id) UNION ALL  SELECT 'integration.rems_pharmacy'::varchar(25) AS integration_table,
        rems_pharmacy.file_id,
        count(*) AS counts
 FROM integration.rems_pharmacy
 GROUP BY 'integration.rems_pharmacy'::varchar(25),
          rems_pharmacy.file_id) UNION ALL  SELECT 'integration.rems_prescriber'::varchar(27) AS integration_table,
        rems_prescriber.file_id,
        count(*) AS counts
 FROM integration.rems_prescriber
 GROUP BY 'integration.rems_prescriber'::varchar(27),
          rems_prescriber.file_id) UNION ALL  SELECT 'integration.roster_address'::varchar(26) AS integration_table,
        roster_address.file_id,
        count(*) AS counts
 FROM integration.roster_address
 GROUP BY 'integration.roster_address'::varchar(26),
          roster_address.file_id) UNION ALL  SELECT 'integration.roster_associate'::varchar(28) AS integration_table,
        roster_associate.file_id,
        count(*) AS counts
 FROM integration.roster_associate
 GROUP BY 'integration.roster_associate'::varchar(28),
          roster_associate.file_id) UNION ALL  SELECT 'integration.roster_associate_audit'::varchar(34) AS integration_table,
        roster_associate_audit.file_id,
        count(*) AS counts
 FROM integration.roster_associate_audit
 GROUP BY 'integration.roster_associate_audit'::varchar(34),
          roster_associate_audit.file_id) UNION ALL  SELECT 'integration.roster_job_title'::varchar(28) AS integration_table,
        roster_job_title.file_id,
        count(*) AS counts
 FROM integration.roster_job_title
 GROUP BY 'integration.roster_job_title'::varchar(28),
          roster_job_title.file_id) UNION ALL  SELECT 'integration.roster_leave_of_absence'::varchar(35) AS integration_table,
        roster_leave_of_absence.file_id,
        count(*) AS counts
 FROM integration.roster_leave_of_absence
 GROUP BY 'integration.roster_leave_of_absence'::varchar(35),
          roster_leave_of_absence.file_id) UNION ALL  SELECT 'integration.roster_people'::varchar(25) AS integration_table,
        roster_people.file_id,
        count(*) AS counts
 FROM integration.roster_people
 GROUP BY 'integration.roster_people'::varchar(25),
          roster_people.file_id) UNION ALL  SELECT 'integration.roster_people_address'::varchar(33) AS integration_table,
        roster_people_address.file_id,
        count(*) AS counts
 FROM integration.roster_people_address
 GROUP BY 'integration.roster_people_address'::varchar(33),
          roster_people_address.file_id) UNION ALL  SELECT 'integration.roster_people_phone'::varchar(31) AS integration_table,
        roster_people_phone.file_id,
        count(*) AS counts
 FROM integration.roster_people_phone
 GROUP BY 'integration.roster_people_phone'::varchar(31),
          roster_people_phone.file_id) UNION ALL  SELECT 'integration.roster_phone'::varchar(24) AS integration_table,
        roster_phone.file_id,
        count(*) AS counts
 FROM integration.roster_phone
 GROUP BY 'integration.roster_phone'::varchar(24),
          roster_phone.file_id) UNION ALL  SELECT 'integration.roster_salesperson'::varchar(30) AS integration_table,
        roster_salesperson.file_id,
        count(*) AS counts
 FROM integration.roster_salesperson
 GROUP BY 'integration.roster_salesperson'::varchar(30),
          roster_salesperson.file_id) UNION ALL  SELECT 'integration.roster_territory'::varchar(28) AS integration_table,
        roster_territory.file_id,
        count(*) AS counts
 FROM integration.roster_territory
 GROUP BY 'integration.roster_territory'::varchar(28),
          roster_territory.file_id) UNION ALL  SELECT 'integration.roster_territory_change'::varchar(35) AS integration_table,
        roster_territory_change.file_id,
        count(*) AS counts
 FROM integration.roster_territory_change
 GROUP BY 'integration.roster_territory_change'::varchar(35),
          roster_territory_change.file_id) UNION ALL  SELECT 'integration.sales_852'::varchar(21) AS integration_table,
        sales_852.file_id,
        count(*) AS counts
 FROM integration.sales_852
 GROUP BY 'integration.sales_852'::varchar(21),
          sales_852.file_id) UNION ALL  SELECT 'integration.sales_867'::varchar(21) AS integration_table,
        sales_867.file_id,
        count(*) AS counts
 FROM integration.sales_867
 GROUP BY 'integration.sales_867'::varchar(21),
          sales_867.file_id) UNION ALL  SELECT 'integration.sample_shipment'::varchar(27) AS integration_table,
        sample_shipment.file_id,
        count(*) AS counts
 FROM integration.sample_shipment
 GROUP BY 'integration.sample_shipment'::varchar(27),
          sample_shipment.file_id) UNION ALL  SELECT 'integration.speaker_contract'::varchar(28) AS integration_table,
        speaker_contract.file_id,
        count(*) AS counts
 FROM integration.speaker_contract
 GROUP BY 'integration.speaker_contract'::varchar(28),
          speaker_contract.file_id) UNION ALL  SELECT 'integration.speaker_license'::varchar(27) AS integration_table,
        speaker_license.file_id,
        count(*) AS counts
 FROM integration.speaker_license
 GROUP BY 'integration.speaker_license'::varchar(27),
          speaker_license.file_id) UNION ALL  SELECT 'integration.speaker_profile'::varchar(27) AS integration_table,
        speaker_profile.file_id,
        count(*) AS counts
 FROM integration.speaker_profile
 GROUP BY 'integration.speaker_profile'::varchar(27),
          speaker_profile.file_id) UNION ALL  SELECT 'integration.speaker_training'::varchar(28) AS integration_table,
        speaker_training.file_id,
        count(*) AS counts
 FROM integration.speaker_training
 GROUP BY 'integration.speaker_training'::varchar(28),
          speaker_training.file_id) UNION ALL  SELECT 'integration.specialty_pharmacy_enrollment'::varchar(41) AS integration_table,
        specialty_pharmacy_enrollment.file_id,
        count(*) AS counts
 FROM integration.specialty_pharmacy_enrollment
 GROUP BY 'integration.specialty_pharmacy_enrollment'::varchar(41),
          specialty_pharmacy_enrollment.file_id) UNION ALL  SELECT 'integration.specialty_pharmacy_rx'::varchar(33) AS integration_table,
        specialty_pharmacy_rx.file_id,
        count(*) AS counts
 FROM integration.specialty_pharmacy_rx
 GROUP BY 'integration.specialty_pharmacy_rx'::varchar(33),
          specialty_pharmacy_rx.file_id) UNION ALL  SELECT 'integration.specialty_pharmacy_shipment'::varchar(39) AS integration_table,
        specialty_pharmacy_shipment.file_id,
        count(*) AS counts
 FROM integration.specialty_pharmacy_shipment
 GROUP BY 'integration.specialty_pharmacy_shipment'::varchar(39),
          specialty_pharmacy_shipment.file_id) UNION ALL  SELECT 'integration.specialty_pharmacy_shipment_summary'::varchar(47) AS integration_table,
        specialty_pharmacy_shipment_summary.file_id,
        count(*) AS counts
 FROM integration.specialty_pharmacy_shipment_summary
 GROUP BY 'integration.specialty_pharmacy_shipment_summary'::varchar(47),
          specialty_pharmacy_shipment_summary.file_id) UNION ALL  SELECT 'integration.territory_ram_to_state'::varchar(34) AS integration_table,
        territory_ram_to_state.file_id,
        count(*) AS counts
 FROM integration.territory_ram_to_state
 GROUP BY 'integration.territory_ram_to_state'::varchar(34),
          territory_ram_to_state.file_id) UNION ALL  SELECT 'integration.territory_zip'::varchar(25) AS integration_table,
        territory_zip.file_id,
        count(*) AS counts
 FROM integration.territory_zip
 GROUP BY 'integration.territory_zip'::varchar(25),
          territory_zip.file_id) UNION ALL  SELECT 'integration.topic_product'::varchar(25) AS integration_table,
        topic_product.file_id,
        count(*) AS counts
 FROM integration.topic_product
 GROUP BY 'integration.topic_product'::varchar(25),
          topic_product.file_id) UNION ALL  SELECT 'integration.touchpoint_call'::varchar(27) AS integration_table,
        touchpoint_call.file_id,
        count(*) AS counts
 FROM integration.touchpoint_call
 GROUP BY 'integration.touchpoint_call'::varchar(27),
          touchpoint_call.file_id) UNION ALL  SELECT 'integration.touchpoint_presentations'::varchar(36) AS integration_table,
        touchpoint_presentations.file_id,
        count(*) AS counts
 FROM integration.touchpoint_presentations
 GROUP BY 'integration.touchpoint_presentations'::varchar(36),
          touchpoint_presentations.file_id) A;

CREATE  VIEW metadata.outbound_table_counts AS
SELECT A.outbound_table, A.counts FROM ((((((((((((((((((((((((SELECT 'datamart.v_ob_asi_market_access'::varchar(31) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_market_access GROUP BY 'datamart.v_ob_asi_market_access'::varchar(31) UNION ALL SELECT 'datamart.v_ob_asi_rems_extract'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rems_extract GROUP BY 'datamart.v_ob_asi_rems_extract'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_asi_rems_programs'::varchar(31) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rems_programs GROUP BY 'datamart.v_ob_asi_rems_programs'::varchar(31)) UNION ALL SELECT 'datamart.v_ob_asi_rx_by_market'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rx_by_market GROUP BY 'datamart.v_ob_asi_rx_by_market'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_asi_survey_data'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_survey_data GROUP BY 'datamart.v_ob_asi_survey_data'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_axiom_market'::varchar(26) AS outbound_table, count(*) AS counts FROM datamart.v_ob_axiom_market GROUP BY 'datamart.v_ob_axiom_market'::varchar(26)) UNION ALL SELECT 'datamart.v_ob_axiom_product_totals'::varchar(34) AS outbound_table, count(*) AS counts FROM datamart.v_ob_axiom_product_totals GROUP BY 'datamart.v_ob_axiom_product_totals'::varchar(34)) UNION ALL SELECT 'datamart.v_ob_kc_copay_voucher_program'::varchar(38) AS outbound_table, count(*) AS counts FROM datamart.v_ob_kc_copay_voucher_program GROUP BY 'datamart.v_ob_kc_copay_voucher_program'::varchar(38)) UNION ALL SELECT 'datamart.v_ob_kc_copay_voucher_redemption'::varchar(41) AS outbound_table, count(*) AS counts FROM datamart.v_ob_kc_copay_voucher_redemption GROUP BY 'datamart.v_ob_kc_copay_voucher_redemption'::varchar(41)) UNION ALL SELECT 'datamart.v_ob_touchpoint_call'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_touchpoint_call GROUP BY 'datamart.v_ob_touchpoint_call'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_zs_agile_copay_redemptions'::varchar(40) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_copay_redemptions GROUP BY 'datamart.v_ob_zs_agile_copay_redemptions'::varchar(40)) UNION ALL SELECT 'datamart.v_ob_zs_agile_copay_voucher_drops'::varchar(42) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_copay_voucher_drops GROUP BY 'datamart.v_ob_zs_agile_copay_voucher_drops'::varchar(42)) UNION ALL SELECT 'datamart.v_ob_zs_agile_demographics'::varchar(35) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_demographics GROUP BY 'datamart.v_ob_zs_agile_demographics'::varchar(35)) UNION ALL SELECT 'datamart.v_ob_zs_agile_details'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_details GROUP BY 'datamart.v_ob_zs_agile_details'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_zs_agile_rx'::varchar(25) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_rx GROUP BY 'datamart.v_ob_zs_agile_rx'::varchar(25)) UNION ALL SELECT 'datamart.v_ob_zs_agile_samples'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_samples GROUP BY 'datamart.v_ob_zs_agile_samples'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_zs_agile_sp_attendees'::varchar(35) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_sp_attendees GROUP BY 'datamart.v_ob_zs_agile_sp_attendees'::varchar(35)) UNION ALL SELECT 'datamart.v_ob_zs_agile_sp_programs'::varchar(34) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_sp_programs GROUP BY 'datamart.v_ob_zs_agile_sp_programs'::varchar(34)) UNION ALL SELECT 'datamart.v_ob_zs_agile_voucher_redemptions'::varchar(42) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_voucher_redemptions GROUP BY 'datamart.v_ob_zs_agile_voucher_redemptions'::varchar(42)) UNION ALL SELECT 'datamart.v_ob_zs_ic_ims_zip_list'::varchar(32) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_ims_zip_list GROUP BY 'datamart.v_ob_zs_ic_ims_zip_list'::varchar(32)) UNION ALL SELECT 'datamart.v_ob_zs_ic_medicaid_plan_groups'::varchar(40) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_medicaid_plan_groups GROUP BY 'datamart.v_ob_zs_ic_medicaid_plan_groups'::varchar(40)) UNION ALL SELECT 'datamart.v_ob_zs_ic_mop'::varchar(23) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_mop GROUP BY 'datamart.v_ob_zs_ic_mop'::varchar(23)) UNION ALL SELECT 'datamart.v_ob_zs_tr_calls_obw'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_calls_obw GROUP BY 'datamart.v_ob_zs_tr_calls_obw'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_zs_tr_demographics'::varchar(32) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_demographics GROUP BY 'datamart.v_ob_zs_tr_demographics'::varchar(32)) UNION ALL SELECT 'datamart.v_ob_zs_tr_launch_analytics'::varchar(36) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_launch_analytics GROUP BY 'datamart.v_ob_zs_tr_launch_analytics'::varchar(36)) A;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales AS
SELECT clozapine_sales.transaction_id AS TRANSACTION_ID, to_char(clozapine_sales.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, clozapine_sales.product_brand AS PRODUCT_BRAND, clozapine_sales.product_ndc AS PRODUCT_NDC, clozapine_sales.product_desc AS PRODUCT_DESC, clozapine_sales.invoice_qty AS INVOICE_QTY, clozapine_sales.invoice_units AS INVOICE_UNITS, clozapine_sales.invoice_cost AS INVOICE_COST, clozapine_sales.invoice_pack_cost AS INVOICE_PACK_COST, clozapine_sales.invoice_unit_cost AS INVOICE_UNIT_COST, clozapine_sales.contract_pack_cost AS CONTRACT_PACK_COST, clozapine_sales.contract_purchases AS CONTRACT_PURCHASES, clozapine_sales.contract_number AS CONTRACT_NUMBER, clozapine_sales.dispensing_location AS DISPENSING_LOCATION, clozapine_sales.dl_address_1 AS DL_ADDRESS_1, clozapine_sales.dl_address_2 AS DL_ADDRESS_2, clozapine_sales.dl_city AS DL_CITY, clozapine_sales.dl_state AS DL_STATE, clozapine_sales.dl_zip AS DL_ZIP, clozapine_sales.dl_dea_number AS DL_DEA_NUMBER, clozapine_sales.depot_location AS DEPOT_LOCATION, clozapine_sales.dep_address_1 AS DEP_ADDRESS_1, clozapine_sales.dep_address_2 AS DEP_ADDRESS_2, clozapine_sales.dep_city AS DEP_CITY, clozapine_sales.dep_state AS DEP_STATE, clozapine_sales.dep_zip AS DEP_ZIP, clozapine_sales.dep_dea_number AS DEP_DEA_NUMBER, clozapine_sales.unit_ap AS UNIT_AP, clozapine_sales.ap AS AP FROM datamart.clozapine_sales WHERE (clozapine_sales.data_source = 'Anda'::varchar(4));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_AHM_Sales_Roster AS
SELECT AHM_SALE_FORCE_ROSTER.EMPLOYEE_ID AS employee_id, AHM_SALE_FORCE_ROSTER.USERNAME AS username, CASE AHM_SALE_FORCE_ROSTER.LAST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.LAST_NAME END AS last_name, CASE AHM_SALE_FORCE_ROSTER.FIRST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.FIRST_NAME END AS first_name, AHM_SALE_FORCE_ROSTER.MIDDLE_NAME AS middle_name, AHM_SALE_FORCE_ROSTER.SALUTATION AS salutation, AHM_SALE_FORCE_ROSTER.SUFFIX AS suffix, AHM_SALE_FORCE_ROSTER.TITLE AS title, AHM_SALE_FORCE_ROSTER.TERRITORY AS territory, AHM_SALE_FORCE_ROSTER.TERRITORY_NAME AS territory_name, CASE WHEN (substr(AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY END AS manager_territory, AHM_SALE_FORCE_ROSTER.TEAM AS team, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_1_ADDR AS business_line_1_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_2_ADDR AS business_line_2_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_3_ADDR AS business_line_3_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_CITY AS business_city, AHM_SALE_FORCE_ROSTER.BUSINESS_STATE AS business_state, AHM_SALE_FORCE_ROSTER.BUSINESS_POSTAL_CODE AS business_postal_code, AHM_SALE_FORCE_ROSTER.BUSINESS_COUNTRY_CODE AS business_country_code, AHM_SALE_FORCE_ROSTER.HOME_LINE_1_ADDR AS home_line_1_addr, AHM_SALE_FORCE_ROSTER.HOME_LINE_2_ADDR AS home_line_2_addr, AHM_SALE_FORCE_ROSTER.HOME_LINE_3_ADDR AS home_line_3_addr, AHM_SALE_FORCE_ROSTER.HOME_CITY AS home_city, AHM_SALE_FORCE_ROSTER.HOME_STATE AS home_state, AHM_SALE_FORCE_ROSTER.HOME_POSTAL_CODE AS home_postal_code, AHM_SALE_FORCE_ROSTER.HOME_COUNTRY_CODE AS home_country_code, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_ADDRESS AS correspondence_address, AHM_SALE_FORCE_ROSTER.BUSINESS_PHONE AS business_phone, AHM_SALE_FORCE_ROSTER.BUSINESS_PHONE_EXTENSION AS business_phone_extension, AHM_SALE_FORCE_ROSTER.BUSINESS_FAX AS business_fax, AHM_SALE_FORCE_ROSTER.VOICE_MAIL AS voice_mail, AHM_SALE_FORCE_ROSTER.MOBILE_PHONE AS mobile_phone, AHM_SALE_FORCE_ROSTER.HOME_PHONE AS home_phone, AHM_SALE_FORCE_ROSTER.HOME_FAX AS home_fax, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_PHONE AS correspondence_phone, AHM_SALE_FORCE_ROSTER.BUSINESS_EMAIL AS business_email, AHM_SALE_FORCE_ROSTER.HOME_EMAIL AS home_email, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_EMAIL AS correspondence_email, AHM_SALE_FORCE_ROSTER.COST_CENTER AS cost_center FROM WSMP_ADMIN.AHM_SALE_FORCE_ROSTER WHERE ((AHM_SALE_FORCE_ROSTER.TERRITORY !~~ '%ZZZZ%'::varchar(6)) AND (AHM_SALE_FORCE_ROSTER.TEAM <> ALL (ARRAY['Teva Clin Nurse Educ'::varchar(20), 'Field Medical Affairs'::varchar(21), 'Clinical Nurse Educator'::varchar(23)])));

CREATE  VIEW raw.ext_onc_sales_quotas AS
 SELECT src.TIME_PERIOD,
        src.SALES_FORCE_ID,
        src.TERRITORY_NUM,
        src.PRODUCT_NAME,
        src.QUOTA_QTY,
        src.QUOTA_DOL,
        src.QUOTA_STRENGTH_UNIT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_SALES_QUOTAS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_SALES_QUOTAS'::varchar(20)))));

CREATE  VIEW sfa_history.v_siebel_account_calls AS
 SELECT rep_p.X_SALES_FORCE AS sales_force_id,
        ea.PAR_EVT_ID AS par_evt_id,
        ea.ROW_ID AS csf_call_id,
        ea.TARGET_OU_ID AS csf_demo_id,
        'ACCT'::varchar(4) AS call_type,
        o.OU_TYPE_CD AS ou_type_cd,
        ea.NAME AS name_on_call,
        ea.ZIPCODE AS zip_on_call,
        ea.SUBTYPE_CD AS subtype_cd,
        ea.TODO_CD AS todo_cd,
        ea.ROW_ID AS siebel_evt_act_row_id,
        ea.TARGET_OU_ID AS siebel_target_ou_id,
        emp.CSN AS rep_id,
        rep_p.NAME AS territory_num,
        trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date,
        details.first_detailed_product_id,
        details.first_detailed_product,
        details.second_detailed_product_id,
        details.second_detailed_product,
        details.third_detailed_product_id,
        details.third_detailed_product,
        details.fourth_detailed_product_id,
        details.fourth_detailed_product,
        details.fifth_detailed_product_id,
        details.fifth_detailed_product,
        details.sixth_detailed_product_id,
        details.sixth_detailed_product,
        CASE WHEN (length(o.INTEGRATION_ID) = 18) THEN o.INTEGRATION_ID ELSE NULL END AS veeva_account_id,
        ea.INTEGRATION_ID AS integration_id
 FROM ((((sfa_history.s_evt_act ea LEFT  JOIN sfa_history.s_postn rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT  JOIN sfa_history.s_org_ext o ON ((o.ROW_ID = ea.TARGET_OU_ID))) LEFT  JOIN sfa_history.s_contact emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT  JOIN ( SELECT iq.activity_id,
        max(CASE WHEN (iq.priority = 1) THEN iq.product_id ELSE NULL END) AS first_detailed_product_id,
        max(CASE WHEN (iq.priority = 1) THEN iq.product_name ELSE NULL END) AS first_detailed_product,
        max(CASE WHEN (iq.priority = 2) THEN iq.product_id ELSE NULL END) AS second_detailed_product_id,
        max(CASE WHEN (iq.priority = 2) THEN iq.product_name ELSE NULL END) AS second_detailed_product,
        max(CASE WHEN (iq.priority = 3) THEN iq.product_id ELSE NULL END) AS third_detailed_product_id,
        max(CASE WHEN (iq.priority = 3) THEN iq.product_name ELSE NULL END) AS third_detailed_product,
        max(CASE WHEN (iq.priority = 4) THEN iq.product_id ELSE NULL END) AS fourth_detailed_product_id,
        max(CASE WHEN (iq.priority = 4) THEN iq.product_name ELSE NULL END) AS fourth_detailed_product,
        max(CASE WHEN (iq.priority = 5) THEN iq.product_id ELSE NULL END) AS fifth_detailed_product_id,
        max(CASE WHEN (iq.priority = 5) THEN iq.product_name ELSE NULL END) AS fifth_detailed_product,
        max(CASE WHEN (iq.priority = 6) THEN iq.product_id ELSE NULL END) AS sixth_detailed_product_id,
        max(CASE WHEN (iq.priority = 6) THEN iq.product_name ELSE NULL END) AS sixth_detailed_product
 FROM ( SELECT appl.ACTIVITY_ID AS activity_id,
        spi.PRODUCT_ID AS product_id,
        upper(spi.NAME) AS product_name,
        row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority
 FROM (sfa_history.s_act_prod_appl appl LEFT  JOIN sfa_history.s_prod_int spi ON ((appl.PRDINT_ID = spi.ROW_ID)))
 WHERE (appl.CONFLICT_ID = '0'::varchar(1))) iq
 GROUP BY iq.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID)))
 WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2011-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = 'Account Call'::varchar(12)) AND (ea.TODO_CD = 'Account Call'::varchar(12)));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_COUNT AS
 SELECT btrim(EXT_AHM_EVENT_COUNT_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_COUNT_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_COUNT_src.ATTENDEE_CATEGORY_CODE) AS ATTENDEE_CATEGORY_CODE,
        btrim(EXT_AHM_EVENT_COUNT_src.ATTENDEE_CATEGORY) AS ATTENDEE_CATEGORY,
        btrim(EXT_AHM_EVENT_COUNT_src.CNT) AS CNT,
        btrim(EXT_AHM_EVENT_COUNT_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_COUNT_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_COUNT_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_COUNT_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_COUNT_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_COUNT_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_COUNT_src.batch_id,
        EXT_AHM_EVENT_COUNT_src.row_id,
        EXT_AHM_EVENT_COUNT_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_COUNT_src;

CREATE  VIEW raw.ext_ahm_event_count AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.ATTENDEE_CATEGORY_CODE,
        src.ATTENDEE_CATEGORY,
        src.CNT,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_COUNT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT_COUNT'::varchar(19)))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT AS
 SELECT btrim(EXT_AHM_EVENT_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_src.PARENT_EVENT_NUMBER) AS PARENT_EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_src.EVENT_NAME) AS EVENT_NAME,
        btrim(EXT_AHM_EVENT_src.EVENT_STATUS_CODE) AS EVENT_STATUS_CODE,
        btrim(EXT_AHM_EVENT_src.EVENT_STATUS_DESCRIPTION) AS EVENT_STATUS_DESCRIPTION,
        btrim(EXT_AHM_EVENT_src.EVENT_STATUS_CHANGE_DATE) AS EVENT_STATUS_CHANGE_DATE,
        btrim(EXT_AHM_EVENT_src.EVENT_START_DATE) AS EVENT_START_DATE,
        btrim(EXT_AHM_EVENT_src.EVENT_END_DATE) AS EVENT_END_DATE,
        btrim(EXT_AHM_EVENT_src.EVENT_TIME_ZONE) AS EVENT_TIME_ZONE,
        btrim(EXT_AHM_EVENT_src.FUNDING_SOURCE) AS FUNDING_SOURCE,
        btrim(EXT_AHM_EVENT_src.EVENT_TYPE) AS EVENT_TYPE,
        btrim(EXT_AHM_EVENT_src.EVENT_TYPE_DESCRIPTION) AS EVENT_TYPE_DESCRIPTION,
        btrim(EXT_AHM_EVENT_src.EVENT_FORMAT) AS EVENT_FORMAT,
        btrim(EXT_AHM_EVENT_src.EVENT_LOCATION) AS EVENT_LOCATION,
        btrim(EXT_AHM_EVENT_src.PENDING_MGMNT_APPROVAL_DATE) AS PENDING_MGMNT_APPROVAL_DATE,
        btrim(EXT_AHM_EVENT_src.EVENT_APPROVAL_DATE) AS EVENT_APPROVAL_DATE,
        btrim(EXT_AHM_EVENT_src.EVENT_APPROVER_ID) AS EVENT_APPROVER_ID,
        btrim(EXT_AHM_EVENT_src.EVENT_SCHEDULE_DATE) AS EVENT_SCHEDULE_DATE,
        btrim(EXT_AHM_EVENT_src.ATTENDEE_CLOSEOUT_DATE) AS ATTENDEE_CLOSEOUT_DATE,
        btrim(EXT_AHM_EVENT_src.FINANCIAL_CLOSEOUT_DATE) AS FINANCIAL_CLOSEOUT_DATE,
        btrim(EXT_AHM_EVENT_src.CANCELLATION_DATE) AS CANCELLATION_DATE,
        btrim(EXT_AHM_EVENT_src.CANCELLATION_REASON) AS CANCELLATION_REASON,
        btrim(EXT_AHM_EVENT_src.CANCELLATION_SOURCE) AS CANCELLATION_SOURCE,
        btrim(EXT_AHM_EVENT_src.EVENT_VENUE_MIN_CNT_REQ_IND) AS EVENT_VENUE_MIN_CNT_REQ_IND,
        btrim(EXT_AHM_EVENT_src.EVENT_VENUE_MIN_COUNT) AS EVENT_VENUE_MIN_COUNT,
        btrim(EXT_AHM_EVENT_src.ESTIMATED_ATTENDANCE) AS ESTIMATED_ATTENDANCE,
        btrim(EXT_AHM_EVENT_src.VENUE_ID) AS VENUE_ID,
        btrim(EXT_AHM_EVENT_src.VENUE_FULL_NAME) AS VENUE_FULL_NAME,
        btrim(EXT_AHM_EVENT_src.VENUE_ADDRESS_LINE_1) AS VENUE_ADDRESS_LINE_1,
        btrim(EXT_AHM_EVENT_src.VENUE_ADDRESS_LINE_2) AS VENUE_ADDRESS_LINE_2,
        btrim(EXT_AHM_EVENT_src.VENUE_ADDRESS_LINE_3) AS VENUE_ADDRESS_LINE_3,
        btrim(EXT_AHM_EVENT_src.VENUE_ADDRESS_LINE_4) AS VENUE_ADDRESS_LINE_4,
        btrim(EXT_AHM_EVENT_src.VENUE_CITY) AS VENUE_CITY,
        btrim(EXT_AHM_EVENT_src.VENUE_STATE_PROVINCE) AS VENUE_STATE_PROVINCE,
        btrim(EXT_AHM_EVENT_src.VENUE_POSTAL_CODE) AS VENUE_POSTAL_CODE,
        btrim(EXT_AHM_EVENT_src.VENUE_POSTAL_EXTENDED_CODE) AS VENUE_POSTAL_EXTENDED_CODE,
        btrim(EXT_AHM_EVENT_src.VENUE_COUNTRY_CODE) AS VENUE_COUNTRY_CODE,
        btrim(EXT_AHM_EVENT_src.VENUE_CONTACT) AS VENUE_CONTACT,
        btrim(EXT_AHM_EVENT_src.VENUE_PHONE) AS VENUE_PHONE,
        btrim(EXT_AHM_EVENT_src.VENUE_FAX) AS VENUE_FAX,
        btrim(EXT_AHM_EVENT_src.VENUE_EMAIL) AS VENUE_EMAIL,
        btrim(EXT_AHM_EVENT_src.TRADE_SECRET_INDICATOR) AS TRADE_SECRET_INDICATOR,
        btrim(EXT_AHM_EVENT_src.TRADE_SECRET_REASON) AS TRADE_SECRET_REASON,
        btrim(EXT_AHM_EVENT_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_src.batch_id,
        EXT_AHM_EVENT_src.row_id,
        EXT_AHM_EVENT_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_src;

CREATE  VIEW raw.ext_ahm_event AS
 SELECT src.SOURCE_SYSTEM_NAME,
        src.EVENT_NUMBER,
        src.PARENT_EVENT_NUMBER,
        src.EVENT_NAME,
        src.EVENT_STATUS_CODE,
        src.EVENT_STATUS_DESCRIPTION,
        src.EVENT_STATUS_CHANGE_DATE,
        src.EVENT_START_DATE,
        src.EVENT_END_DATE,
        src.EVENT_TIME_ZONE,
        src.FUNDING_SOURCE,
        src.EVENT_TYPE,
        src.EVENT_TYPE_DESCRIPTION,
        src.EVENT_FORMAT,
        src.EVENT_LOCATION,
        src.PENDING_MGMNT_APPROVAL_DATE,
        src.EVENT_APPROVAL_DATE,
        src.EVENT_APPROVER_ID,
        src.EVENT_SCHEDULE_DATE,
        src.ATTENDEE_CLOSEOUT_DATE,
        src.FINANCIAL_CLOSEOUT_DATE,
        src.CANCELLATION_DATE,
        src.CANCELLATION_REASON,
        src.CANCELLATION_SOURCE,
        src.EVENT_VENUE_MIN_CNT_REQ_IND,
        src.EVENT_VENUE_MIN_COUNT,
        src.ESTIMATED_ATTENDANCE,
        src.VENUE_ID,
        src.VENUE_FULL_NAME,
        src.VENUE_ADDRESS_LINE_1,
        src.VENUE_ADDRESS_LINE_2,
        src.VENUE_ADDRESS_LINE_3,
        src.VENUE_ADDRESS_LINE_4,
        src.VENUE_CITY,
        src.VENUE_STATE_PROVINCE,
        src.VENUE_POSTAL_CODE,
        src.VENUE_POSTAL_EXTENDED_CODE,
        src.VENUE_COUNTRY_CODE,
        src.VENUE_CONTACT,
        src.VENUE_PHONE,
        src.VENUE_FAX,
        src.VENUE_EMAIL,
        src.TRADE_SECRET_INDICATOR,
        src.TRADE_SECRET_REASON,
        src.CUSTOM_FIELD_1,
        src.CUSTOM_FIELD_2,
        src.CUSTOM_FIELD_3,
        src.CUSTOM_FIELD_4,
        src.CUSTOM_FIELD_5,
        src.REC_STAT_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AHM_EVENT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AHM_EVENT'::varchar(13)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_survey AS
(((( SELECT y1.account_id,
        y1.bu,
        y1.survey_update_date,
        y1.survey,
        y1.question,
        y1.answer,
        y1.response_update_date,
        y1.response_create_date
 FROM ( SELECT w.account_id,
        w.bu,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date,
        'e-Rx Survey B'::varchar(13) AS survey,
        w.question,
        w.answer,
        w.response_update_date,
        w.response_create_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = 'e-Rx Survey'::varchar(11)) AND (w.order_vod__c = 2::float))) y1 UNION ALL  SELECT repclick.account_id,
        repclick.bu,
        repclick.survey_update_date,
        repclick.survey,
        repclick.question,
        repclick.answer,
        repclick.response_update_date,
        repclick.response_create_date
 FROM ( SELECT w.account_id,
        w.bu,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date,
        w.survey,
        ((w.order_vod__c || '. '::varchar(2)) || w.question) AS question,
        w.answer,
        w.response_update_date,
        w.response_create_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = 'Respiratory - RespiClick Readiness'::varchar(34)))) repclick) UNION ALL  SELECT a.account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT yr.account_id,
        yr.bu,
        yr.survey_update_date,
        yr.survey,
        '*Future Scheduled Adasuve Formulary Review Date'::varchar(47) AS question,
        ((((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) || '-'::varchar(1)) || coalesce(lpad(dy.answer, 2, '0'::varchar(1)), '  '::varchar(2))) AS answer,
        yr.response_update_date,
        yr.response_create_date
 FROM ((( SELECT x.account_id,
        x.bu,
        x.survey,
        x.question,
        x.answer,
        x.response_create_date,
        x.response_update_date,
        x.answer_type,
        x.survey_target_vod__c,
        x.rnk,
        x.nm,
        x.order_vod__c,
        x.survey_update_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Year'::varchar(47))) yr JOIN ( SELECT x.account_id,
        x.bu,
        x.survey,
        x.question,
        x.answer,
        x.response_create_date,
        x.response_update_date,
        x.answer_type,
        x.survey_target_vod__c,
        x.rnk,
        x.nm,
        x.order_vod__c,
        x.survey_update_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question ~~ '*Future Scheduled Adasuve % Review Month'::varchar(40))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c))) JOIN ( SELECT x.account_id,
        x.bu,
        x.survey,
        x.question,
        x.answer,
        x.response_create_date,
        x.response_update_date,
        x.answer_type,
        x.survey_target_vod__c,
        x.rnk,
        x.nm,
        x.order_vod__c,
        x.survey_update_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Date'::varchar(47))) dy ON ((yr.survey_target_vod__c = dy.survey_target_vod__c)))) a) UNION ALL  SELECT b.account_id,
        b.bu,
        b.survey_update_date,
        b.survey,
        b.question,
        b.answer,
        b.response_update_date,
        b.response_create_date
 FROM ( SELECT yr.account_id,
        yr.bu,
        yr.survey_update_date,
        yr.survey,
        '*Prior Adasuve Formulary Review Date'::varchar(36) AS question,
        ((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) AS answer,
        yr.response_update_date,
        yr.response_create_date
 FROM (( SELECT x.account_id,
        x.bu,
        x.survey,
        x.question,
        x.answer,
        x.response_create_date,
        x.response_update_date,
        x.answer_type,
        x.survey_target_vod__c,
        x.rnk,
        x.nm,
        x.order_vod__c,
        x.survey_update_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question = '*Prior Adasuve Formulary Review Year'::varchar(36))) yr JOIN ( SELECT x.account_id,
        x.bu,
        x.survey,
        x.question,
        x.answer,
        x.response_create_date,
        x.response_update_date,
        x.answer_type,
        x.survey_target_vod__c,
        x.rnk,
        x.nm,
        x.order_vod__c,
        x.survey_update_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question ~~ '*Prior Adasuve % Review Month'::varchar(29))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c)))) b) UNION ALL  SELECT c.account_id,
        c.bu,
        c.survey_update_date,
        c.survey,
        c.question,
        c.answer,
        c.response_update_date,
        c.response_create_date
 FROM ( SELECT x.account_id,
        x.bu,
        x.survey_update_date,
        x.survey,
        x.question,
        x.answer,
        x.response_update_date,
        x.response_create_date
 FROM ( SELECT w.account_id,
        w.bu,
        w.survey,
        w.question,
        w.answer,
        w.response_create_date,
        w.response_update_date,
        w.answer_type,
        w.survey_target_vod__c,
        w.rnk,
        w.nm,
        w.order_vod__c,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x
 WHERE (x.question !~~ '%Adasuve%Review%'::varchar(16))) c) UNION ALL  SELECT y.account_id,
        y.bu,
        y.survey_update_date,
        y.survey,
        y.question,
        y.answer,
        y.response_update_date,
        y.response_create_date
 FROM ( SELECT w.account_id,
        w.bu,
        max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date,
        w.survey,
        w.question,
        w.answer,
        w.response_update_date,
        w.response_create_date
 FROM ( SELECT st.ACCOUNT_VOD__C AS account_id,
        substr(s.TERRITORY_VOD__C, 1, 2) AS bu,
        coalesce(b.SURVEY_NAME, s.NAME) AS survey,
        coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question,
        CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer,
        to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        ty.NAME AS answer_type,
        st.ID AS survey_target_vod__c,
        row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk,
        s.NAME AS nm,
        CASE sq.ORDER_VOD__C WHEN NULLSEQUAL 0::numeric(1,0) THEN '1'::varchar(1) WHEN NULLSEQUAL 1::numeric(1,0) THEN '2'::varchar(1) WHEN NULLSEQUAL 2::numeric(1,0) THEN '3'::varchar(1) ELSE NULL END AS order_vod__c
 FROM ((((((WSMP_ADMIN_ORA.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN_ORA.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN_ORA.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN_ORA.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT  JOIN WSMP_ADMIN_ORA.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w
 WHERE ((w.rnk = 1) AND (w.nm = 'e-Rx Survey'::varchar(11)))) y;

CREATE  VIEW teva_ingestion.EXT_IDS_CALL2_SAMPLE_VOD__C AS
 SELECT btrim(EXT_IDS_CALL2_SAMPLE_VOD__C_src.ID) AS ID,
        EXT_IDS_CALL2_SAMPLE_VOD__C_src.batch_id,
        EXT_IDS_CALL2_SAMPLE_VOD__C_src.row_id,
        EXT_IDS_CALL2_SAMPLE_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_IDS_CALL2_SAMPLE_VOD__C_src;

CREATE  VIEW raw.ext_ids_call2_sample_vod__c AS
 SELECT src.ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IDS_CALL2_SAMPLE_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IDS_CALL2_SAMPLE_VOD__C'::varchar(27)))));

CREATE  VIEW teva_ingestion.EXT_IDS_CALL2_KEY_MESSAGE_VOD__C AS
 SELECT btrim(EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src.ID) AS ID,
        EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src.batch_id,
        EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src.row_id,
        EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src;

CREATE  VIEW raw.ext_ids_call2_key_message_vod__c AS
 SELECT src.ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IDS_CALL2_KEY_MESSAGE_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IDS_CALL2_KEY_MESSAGE_VOD__C'::varchar(32)))));

CREATE  VIEW teva_ingestion.EXT_TB_CB_ACCOUNTS AS
 SELECT btrim(EXT_TB_CB_ACCOUNTS_src.ACCOUNT_ID) AS ACCOUNT_ID,
        btrim(EXT_TB_CB_ACCOUNTS_src.LOCATION_ID) AS LOCATION_ID,
        btrim(EXT_TB_CB_ACCOUNTS_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(EXT_TB_CB_ACCOUNTS_src.END_CUSTOMER) AS END_CUSTOMER,
        btrim(EXT_TB_CB_ACCOUNTS_src.ADDRESS_1) AS ADDRESS_1,
        btrim(EXT_TB_CB_ACCOUNTS_src.ADDRESS_2) AS ADDRESS_2,
        btrim(EXT_TB_CB_ACCOUNTS_src.CITY) AS CITY,
        btrim(EXT_TB_CB_ACCOUNTS_src.STATE) AS STATE,
        btrim(EXT_TB_CB_ACCOUNTS_src.ZIP) AS ZIP,
        btrim(EXT_TB_CB_ACCOUNTS_src.CONTRACT_TITLE) AS CONTRACT_TITLE,
        btrim(EXT_TB_CB_ACCOUNTS_src.CONTRACT_ID) AS CONTRACT_ID,
        btrim(EXT_TB_CB_ACCOUNTS_src.WHOLESALER_NAME) AS WHOLESALER_NAME,
        btrim(EXT_TB_CB_ACCOUNTS_src.HIN) AS HIN,
        btrim(EXT_TB_CB_ACCOUNTS_src.CONTRACT_ALIAS) AS CONTRACT_ALIAS,
        btrim(EXT_TB_CB_ACCOUNTS_src.WHOLESALER_DEA) AS WHOLESALER_DEA,
        btrim(EXT_TB_CB_ACCOUNTS_src.CLASS_OF_TRADE) AS CLASS_OF_TRADE,
        btrim(EXT_TB_CB_ACCOUNTS_src.COT_SOURCE) AS COT_SOURCE,
        EXT_TB_CB_ACCOUNTS_src.batch_id,
        EXT_TB_CB_ACCOUNTS_src.row_id,
        EXT_TB_CB_ACCOUNTS_src.update_ts
 FROM teva_ingestion.EXT_TB_CB_ACCOUNTS_src;

CREATE  VIEW raw.ext_tb_cb_accounts AS
 SELECT src.ACCOUNT_ID,
        src.LOCATION_ID,
        src.DEA_NUMBER,
        src.END_CUSTOMER,
        src.ADDRESS_1,
        src.ADDRESS_2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.CONTRACT_TITLE,
        src.CONTRACT_ID,
        src.WHOLESALER_NAME,
        src.HIN,
        src.CONTRACT_ALIAS,
        src.WHOLESALER_DEA,
        src.CLASS_OF_TRADE,
        src.COT_SOURCE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TB_CB_ACCOUNTS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TB_CB_ACCOUNTS'::varchar(18)))));

CREATE  VIEW teva_ingestion.EXT_ZIP_TO_TERR AS
 SELECT btrim(EXT_ZIP_TO_TERR_src.zip) AS zip,
        btrim(EXT_ZIP_TO_TERR_src.state) AS state,
        btrim(EXT_ZIP_TO_TERR_src.territory_1_id) AS territory_1_id,
        btrim(EXT_ZIP_TO_TERR_src.territory_name) AS territory_name,
        btrim(EXT_ZIP_TO_TERR_src.area_name) AS area_name,
        btrim(EXT_ZIP_TO_TERR_src.region_name) AS region_name,
        btrim(EXT_ZIP_TO_TERR_src.mirror_flag) AS mirror_flag,
        btrim(EXT_ZIP_TO_TERR_src.territory_2_id) AS territory_2_id,
        EXT_ZIP_TO_TERR_src.batch_id,
        EXT_ZIP_TO_TERR_src.row_id,
        EXT_ZIP_TO_TERR_src.update_ts
 FROM teva_ingestion.EXT_ZIP_TO_TERR_src;

CREATE  VIEW raw.ext_zip_to_terr AS
 SELECT src.zip,
        src.state,
        src.territory_1_id,
        src.territory_name,
        src.area_name,
        src.region_name,
        src.mirror_flag,
        src.territory_2_id,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZIP_TO_TERR_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZIP_TO_TERR'::varchar(15)))));

CREATE  VIEW outbound.ims_plan_workbook AS
 SELECT plantrak_workbook.payer_plan_number AS PAYER_PLAN_NUM,
        plantrak_workbook.plan_name AS PLAN_NAME,
        plantrak_workbook.payer_name AS PAYER_NAME,
        plantrak_workbook.method_of_payment AS PAYMENT_METHOD,
        plantrak_workbook.model AS MODEL,
        coalesce(plantrak_workbook.pbm_number, '999999'::varchar(6)) AS PBM_NUMBER,
        coalesce(plantrak_workbook.pbm_name, 'N/A'::varchar(3)) AS PBM_NAME
 FROM datamart.plantrak_workbook;

CREATE  VIEW outbound.zzz_activity_voucher_coupon_redemption_alphascrip AS
 SELECT cmid.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(cw.rx_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((cw.file_id)::varchar, '-'::varchar(1)), (cw.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        coalesce((sp.entity_id)::varchar(20), cw.ndc_code) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((('Voucher/Coupon Redemption,'::varchar(26) || b.name) || ','::varchar(1)) || cw.occ_payment_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((integration.copay_detail_weekly cw JOIN datamart.tvcmid_xref cmid ON (((cw.tvcmid_physician = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dm ON ((cw.file_id = dm.file_id))) LEFT  JOIN product.source_product sp ON (((cw.ndc_code = sp.source_product_code) AND (dm.feed_id = sp.feed_id) AND (dm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE ((cw.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'ALPHASCRIP_COPAY_DETAIL_WKLY'::varchar(28)))), 0)) AND (cw.rx_date >= add_months((now())::date, (-6)))) EXCEPT  SELECT cmid.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(cw.rx_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((cw.file_id)::varchar, '-'::varchar(1)), (cw.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        coalesce((sp.entity_id)::varchar(20), cw.ndc_code) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((('Voucher/Coupon Redemption,'::varchar(26) || b.name) || ','::varchar(1)) || cw.occ_payment_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((integration.copay_detail_weekly cw JOIN datamart.tvcmid_xref cmid ON (((cw.tvcmid_physician = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dm ON ((cw.file_id = dm.file_id))) LEFT  JOIN product.source_product sp ON (((cw.ndc_code = sp.source_product_code) AND (dm.feed_id = sp.feed_id) AND (dm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE ((cw.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'ALPHASCRIP_COPAY_DETAIL_WKLY'::varchar(28)))), 0)) AND (cw.rx_date >= add_months((now())::date, (-6))));

CREATE  VIEW outbound.zzz_kc_copay_voucher_redemption AS
 SELECT coalesce(c.physician_veeva_id, c.physician_ims_id) AS VEEVA_ACCOUNT_ID,
        c.physician_ims_id AS IMS_ID,
        c.redemption_type AS REDEMPTION_TYPE,
        to_char(c.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        to_char(c.date_written, 'YYYY-MM-DD'::varchar(10)) AS HCP_DATE_WRITTEN,
        CASE mod(c.days_supply, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.days_supply)::varchar ELSE rtrim((c.days_supply)::varchar, '0'::varchar(1)) END AS DAYS_SUPPLY,
        c.ndc_code AS NDC_CODE,
        c.basket_name AS BRAND_NAME,
        CASE mod(c.quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.quantity)::int)::varchar ELSE rtrim((c.quantity)::varchar, '0'::varchar(1)) END AS QTY,
        CASE mod(c.refills, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.refills)::varchar ELSE rtrim((c.refills)::varchar, '0'::varchar(1)) END AS REFILLS,
        c.program_number AS PROGRAM_NUM,
        c.copay_card_number AS COPAY_VOUCHER_NUM,
        c.pharmacy_chain_number AS PHARMACY_CHAIN_NUM,
        c.pharmacy_chain AS PHARMACY_CHAIN,
        c.pharmacy_name AS PHARMACY_NAME,
        c.pharmacy_address AS PHARMACY_ADDRESS,
        c.pharmacy_address2 AS PHARMACY_ADDRESS2,
        c.pharmacy_city AS PHARMACY_CITY,
        c.pharmacy_state AS PHARMACY_STATE,
        c.pharmacy_zip AS PHARMACY_ZIP,
        CASE mod(c.pharmacy_npi_num, 1::float) WHEN NULLSEQUAL 0::float THEN c.pharmacy_npi_num ELSE rtrim(c.pharmacy_npi_num, '0'::varchar(1)) END AS PHARMACY_NPI_NUM,
        NULL AS CEPH_ID,
        NULL AS ME_NUM,
        c.principle_physician_dea AS PRINCIPLE_PHYS_DEA_NUM,
        CASE mod(c.physician_npi, 1::float) WHEN NULLSEQUAL 0::float THEN c.physician_npi ELSE rtrim(c.physician_npi, '0'::varchar(1)) END AS PRINCIPLE_PHYS_NPI_NUM,
        c.physician_name AS PHYSICIAN_NAME,
        c.physician_address1 AS PHYSICIAN_ADDRESS1,
        c.physician_address2 AS PHYSICIAN_ADDRESS2,
        c.physician_city AS PHYSICIAN_CITY,
        c.physician_state AS PHYSICIAN_STATE,
        c.physician_zip AS PHYSICIAN_ZIP,
        CASE mod(c.rebate_amount, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.rebate_amount)::int)::varchar ELSE rtrim((c.rebate_amount)::varchar, '0'::varchar(1)) END AS REBATE_AMOUNT,
        CASE mod(c.member_cash_expense, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.member_cash_expense)::int)::varchar ELSE rtrim((c.member_cash_expense)::varchar, '0'::varchar(1)) END AS MEMBER_CASH_EXPENSE,
        CASE mod(c.submitted_cost, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.submitted_cost)::int)::varchar ELSE rtrim((c.submitted_cost)::varchar, '0'::varchar(1)) END AS SUBMITTED_COST,
        CASE mod(c.pharmacy_fee, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.pharmacy_fee)::int)::varchar ELSE rtrim((c.pharmacy_fee)::varchar, '0'::varchar(1)) END AS PHARMACY_FEE,
        CASE mod(c.total_amount_due, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.total_amount_due)::int)::varchar ELSE rtrim((c.total_amount_due)::varchar, '0'::varchar(1)) END AS TOTAL_AMOUNT_DUE,
        CASE mod(c.calc_awp, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.calc_awp)::int)::varchar ELSE rtrim((c.calc_awp)::varchar, '0'::varchar(1)) END AS CALC_AWP,
        c.occ_payment_type AS OCC_PAYMENT_TYPE,
        CASE mod(c.new_refill, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.new_refill)::varchar ELSE rtrim((c.new_refill)::varchar, '0'::varchar(1)) END AS NEW_REFILL
 FROM datamart.copay c
 WHERE ((c.basket_name = ANY (ARRAY['PROAIR RESPICLICK'::varchar(17), 'QNASL'::varchar(5), 'QNASL CHILDREN'::varchar(14), 'ZECUITY'::varchar(7), 'AMRIX'::varchar(5), 'APIDPEX-P'::varchar(9), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'NUVIGIL'::varchar(7), 'QUARTETTE'::varchar(9), 'ADIPEX'::varchar(6)])) AND (c.fill_date < (statement_timestamp())::date) AND (coalesce(c.date_written, c.fill_date) < (statement_timestamp())::date) AND (months_between((statement_timestamp())::date, c.fill_date) <= 25::float)) UNION  SELECT coalesce(c.physician_veeva_id, c.physician_ims_id) AS VEEVA_ACCOUNT_ID,
        c.physician_ims_id AS IMS_ID,
        c.redemption_type AS REDEMPTION_TYPE,
        to_char(c.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        to_char(c.date_written, 'YYYY-MM-DD'::varchar(10)) AS HCP_DATE_WRITTEN,
        CASE mod(c.days_supply, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.days_supply)::varchar ELSE rtrim((c.days_supply)::varchar, '0'::varchar(1)) END AS DAYS_SUPPLY,
        c.ndc_code AS NDC_CODE,
        b.name AS BRAND_NAME,
        CASE mod(c.quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.quantity)::int)::varchar ELSE rtrim((c.quantity)::varchar, '0'::varchar(1)) END AS QTY,
        CASE mod(c.refills, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.refills)::varchar ELSE rtrim((c.refills)::varchar, '0'::varchar(1)) END AS REFILLS,
        c.program_number AS PROGRAM_NUM,
        c.copay_card_number AS COPAY_VOUCHER_NUM,
        c.pharmacy_chain_number AS PHARMACY_CHAIN_NUM,
        c.pharmacy_chain AS PHARMACY_CHAIN,
        c.pharmacy_name AS PHARMACY_NAME,
        c.pharmacy_address AS PHARMACY_ADDRESS,
        c.pharmacy_address2 AS PHARMACY_ADDRESS2,
        c.pharmacy_city AS PHARMACY_CITY,
        c.pharmacy_state AS PHARMACY_STATE,
        c.pharmacy_zip AS PHARMACY_ZIP,
        CASE mod(c.pharmacy_npi_num, 1::float) WHEN NULLSEQUAL 0::float THEN c.pharmacy_npi_num ELSE rtrim(c.pharmacy_npi_num, '0'::varchar(1)) END AS PHARMACY_NPI_NUM,
        NULL AS CEPH_ID,
        NULL AS ME_NUM,
        c.principle_physician_dea AS PRINCIPLE_PHYS_DEA_NUM,
        CASE mod(c.physician_npi, 1::float) WHEN NULLSEQUAL 0::float THEN c.physician_npi ELSE rtrim(c.physician_npi, '0'::varchar(1)) END AS PRINCIPLE_PHYS_NPI_NUM,
        c.physician_name AS PHYSICIAN_NAME,
        c.physician_address1 AS PHYSICIAN_ADDRESS1,
        c.physician_address2 AS PHYSICIAN_ADDRESS2,
        c.physician_city AS PHYSICIAN_CITY,
        c.physician_state AS PHYSICIAN_STATE,
        c.physician_zip AS PHYSICIAN_ZIP,
        CASE mod(c.rebate_amount, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.rebate_amount)::int)::varchar ELSE rtrim((c.rebate_amount)::varchar, '0'::varchar(1)) END AS REBATE_AMOUNT,
        CASE mod(c.member_cash_expense, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.member_cash_expense)::int)::varchar ELSE rtrim((c.member_cash_expense)::varchar, '0'::varchar(1)) END AS MEMBER_CASH_EXPENSE,
        CASE mod(c.submitted_cost, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.submitted_cost)::int)::varchar ELSE rtrim((c.submitted_cost)::varchar, '0'::varchar(1)) END AS SUBMITTED_COST,
        CASE mod(c.pharmacy_fee, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.pharmacy_fee)::int)::varchar ELSE rtrim((c.pharmacy_fee)::varchar, '0'::varchar(1)) END AS PHARMACY_FEE,
        CASE mod(c.total_amount_due, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.total_amount_due)::int)::varchar ELSE rtrim((c.total_amount_due)::varchar, '0'::varchar(1)) END AS TOTAL_AMOUNT_DUE,
        CASE mod(c.calc_awp, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.calc_awp)::int)::varchar ELSE rtrim((c.calc_awp)::varchar, '0'::varchar(1)) END AS CALC_AWP,
        c.occ_payment_type AS OCC_PAYMENT_TYPE,
        CASE mod(c.new_refill, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.new_refill)::varchar ELSE rtrim((c.new_refill)::varchar, '0'::varchar(1)) END AS NEW_REFILL
 FROM ((datamart.copay c LEFT  JOIN product.basket_item bi ON ((c.basket_id = bi.entity_id))) LEFT  JOIN product.basket b ON ((bi.basket_id = b.basket_id)))
 WHERE ((b.name = ANY (ARRAY['PROAIR RESPICLICK'::varchar(17), 'QNASL'::varchar(5), 'QNASL CHILDREN'::varchar(14), 'ZECUITY'::varchar(7), 'AMRIX'::varchar(5), 'APIDPEX-P'::varchar(9), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'NUVIGIL'::varchar(7), 'QUARTETTE'::varchar(9), 'ADIPEX'::varchar(6)])) AND (c.fill_date < (statement_timestamp())::date) AND (coalesce(c.date_written, c.fill_date) < (statement_timestamp())::date) AND (months_between((statement_timestamp())::date, c.fill_date) <= 25::float));

CREATE  VIEW outbound.zzz_zs_agile_sp_attendees AS
 SELECT a.event_number AS EVENT_NUMBER,
        e.event_name AS EVENT_NAME,
        (e.event_start_date)::date AS EVENT_START_DATE,
        a.me_number AS ME_NUMBER,
        a.dea_number AS DEA_NUMBER,
        c.ceph_id AS CEPH_ID,
        a.tvcmid AS CUSTOMER_ID,
        a.attendee_id AS CM_ID,
        a.attendee_first_name AS ATTENDEE_FIRST_NAME,
        a.attendee_last_name AS ATTENDEE_LAST_NAME,
        a.attendee_address AS ATTENDEE_ADDRESS_LINE_1,
        NULL AS ATTENDEE_ADDRESS_LINE_2,
        NULL AS ATTENDEE_ADDRESS_LINE_3,
        a.attendee_city AS ATTENDEE_CITY,
        a.attendee_state AS ATTENDEE_STATE_PROVINCE,
        a.attendee_zip AS ATTENDEE_POSTAL_CODE,
        d.specialty AS ATTENDEE_SPECIALTY,
        d.degree AS ATTENDEE_DEGREE,
        d.ims_id AS IMS_NUM
 FROM (((datamart.event_attendee a JOIN datamart.event e ON ((e.event_number = a.event_number))) LEFT  JOIN ( SELECT a.tvcmid,
        a.specialty,
        a.degree,
        a.ims_id
 FROM ( SELECT DISTINCT prescriber_combined_demographics.tvcmid,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.degree,
        prescriber_combined_demographics.ims_id,
        row_number() OVER (PARTITION BY prescriber_combined_demographics.tvcmid ORDER BY prescriber_combined_demographics.degree) AS rnk
 FROM datamart.prescriber_combined_demographics
 ORDER BY prescriber_combined_demographics.tvcmid,
          prescriber_combined_demographics.specialty,
          prescriber_combined_demographics.degree,
          prescriber_combined_demographics.ims_id,
          row_number() OVER (PARTITION BY prescriber_combined_demographics.tvcmid ORDER BY prescriber_combined_demographics.degree)) a
 WHERE (a.rnk = 1)) d ON ((d.tvcmid = a.tvcmid))) LEFT  JOIN ( SELECT sfa_call.tvcmid,
        sfa_call.ceph_id
 FROM datamart.sfa_call
 GROUP BY sfa_call.tvcmid,
          sfa_call.ceph_id) c ON ((a.tvcmid = c.tvcmid)))
 WHERE ((e.event_start_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (trunc(e.event_start_date, 'DD'::varchar(2)) <= trunc((last_day(add_months((statement_timestamp())::timestamp, (-1))))::timestamp, 'DD'::varchar(2))))
 GROUP BY a.event_number,
          e.event_name,
          e.event_start_date,
          a.me_number,
          a.dea_number,
          c.ceph_id,
          a.attendee_id,
          a.tvcmid,
          a.attendee_first_name,
          a.attendee_last_name,
          a.attendee_address,
          NULL,
          a.attendee_city,
          a.attendee_state,
          a.attendee_zip,
          d.specialty,
          d.degree,
          d.ims_id;

CREATE  VIEW outbound.zzz_axiom_market AS
 SELECT prescriber_rx.market_name,
        prescriber_rx.payer_plan_number AS plan_num,
        b.teva_product_code AS product_code,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt24,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt24
 FROM ((datamart.prescriber_rx prescriber_rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON ((prescriber_rx.rollup_month = mth.month_ending))) LEFT  JOIN product.basket b ON ((prescriber_rx.basket_id = b.basket_id)))
 WHERE ((prescriber_rx.nrx_count IS NOT NULL) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY prescriber_rx.market_name,
          prescriber_rx.payer_plan_number,
          b.teva_product_code
 ORDER BY prescriber_rx.payer_plan_number,
          b.teva_product_code,
          sum(CASE WHEN (prescriber_rx.date = add_months(last_day(prescriber_rx.data_date), (-1))) THEN prescriber_rx.nrx_count ELSE NULL::float END);

CREATE  VIEW outbound.zzz_axiom_product_totals AS
 SELECT prescriber_rx.market_name,
        b.teva_product_code AS product_code,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt24,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt24
 FROM ((datamart.prescriber_rx prescriber_rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON ((prescriber_rx.rollup_month = mth.month_ending))) LEFT  JOIN product.basket b ON ((prescriber_rx.basket_id = b.basket_id)))
 WHERE ((prescriber_rx.nrx_count IS NOT NULL) AND (mth.month_bucket <= 24) AND (mth.month_bucket >= 1) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY prescriber_rx.market_name,
          b.teva_product_code
 ORDER BY prescriber_rx.market_name,
          b.teva_product_code;

CREATE  VIEW outbound.dnc AS
 SELECT ims.id_num AS IMS_ID,
        tx.id_num AS DEA_NUM,
        hcp.last_name AS LAST_NAME,
        hcp.first_name AS FIRST_NAME,
        hcp.middle_name AS MID_NAME,
        hcp.address_line1 AS ADDRESS,
        hcp.city AS CITY,
        hcp.state_code AS STATE,
        hcp.zip AS ZIP,
        hcp.npi AS NPI
 FROM (((datamart.customer_level_flags clf JOIN datamart.customer_hcp_demographics hcp ON ((hcp.tvcmid = clf.tvcmid))) JOIN datamart.tvcmid_xref ims ON (((ims.tvcmid = hcp.tvcmid) AND (ims.id_type = 'IMS_ID'::varchar(6))))) LEFT  JOIN datamart.tvcmid_xref tx ON (((tx.tvcmid = hcp.tvcmid) AND (tx.id_type = 'DEA_NUM'::varchar(7)))))
 WHERE ((clf.flag_type = 'DNC'::varchar(3)) AND (clf.basket_name = 'NUVIGIL'::varchar(7)) AND (coalesce(clf.flag_effective_end_date, (statement_timestamp())::timestamp) >= (statement_timestamp())::timestamp) AND ((tx.id_num IS NOT NULL) OR (hcp.npi IS NOT NULL)) AND (hcp.ims_id IS NOT NULL))
 GROUP BY ims.id_num,
          tx.id_num,
          hcp.last_name,
          hcp.first_name,
          hcp.middle_name,
          hcp.address_line1,
          hcp.city,
          hcp.state_code,
          hcp.zip,
          hcp.npi;

CREATE  VIEW outbound.zzz_create_anda_sales AS
 SELECT sbs.transaction_id AS TRANSACTION_ID,
        to_char(sbs.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE,
        sbs.product_brand AS PRODUCT_BRAND,
        sbs.product_ndc AS PRODUCT_NDC,
        sbs.product_desc AS PRODUCT_DESC,
        (sbs.invoice_qty)::int AS INVOICE_QTY,
        (sbs.invoice_units)::int AS INVOICE_UNITS,
        sbs.invoice_cost AS INVOICE_COST,
        sbs.invoice_pack_cost AS INVOICE_PACK_COST,
        sbs.invoice_unit_cost AS INVOICE_UNIT_COST,
        sbs.contract_pack_cost AS CONTRACT_PACK_COST,
        sbs.contract_purchases AS CONTRACT_PURCHASES,
        sbs.contract_number AS CONTRACT_NUMBER,
        sbs.dispensing_location AS DISPENSING_LOCATION,
        sbs.dl_address_1 AS DL_ADDRESS_1,
        sbs.dl_address_2 AS DL_ADDRESS_2,
        sbs.dl_city AS DL_CITY,
        sbs.dl_state AS DL_STATE,
        sbs.dl_zip AS DL_ZIP,
        sbs.dl_dea_number AS DL_DEA_NUMBER,
        sbs.depot_location AS DEPOT_LOCATION,
        sbs.dep_address_1 AS DEP_ADDRESS_1,
        sbs.dep_address_2 AS DEP_ADDRESS_2,
        sbs.dep_city AS DEP_CITY,
        sbs.dep_state AS DEP_STATE,
        sbs.dep_zip AS DEP_ZIP,
        sbs.dep_dea_number AS DEP_DEA_NUMBER,
        (sbs.unit_ap)::numeric(15,2) AS UNIT_AP,
        (sbs.ap)::numeric(15,2) AS AP
 FROM datamart.select_brand_sales sbs
 WHERE (sbs.data_source = 'Anda'::varchar(4));

CREATE  VIEW outbound.activity_speaker_event AS
 SELECT cmid.id_num AS federation_id,
        e.event_location AS contact,
        ea.source_system_name AS source,
        to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (b.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Speaker_Program'::varchar(15) AS type,
        'Speaker_Program'::varchar(15) AS native_type,
        ((((('Speaker Program -, '::varchar(19) || e.funding_source) || ', '::varchar(2)) || e.estimated_attendance) || ' Attendees, '::varchar(12)) || CASE WHEN (ea.attended = 1) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT event_attendee.source_system_name,
        event_attendee.event_number,
        event_attendee.attended,
        event_attendee.customer_id,
        event_attendee.file_id
 FROM integration.event_attendee
 GROUP BY event_attendee.source_system_name,
          event_attendee.event_number,
          event_attendee.attended,
          event_attendee.customer_id,
          event_attendee.file_id) ea JOIN ( SELECT event.event_number,
        event.event_name,
        event.event_start_date,
        event.funding_source,
        event.estimated_attendance,
        event.event_location
 FROM integration.event
 WHERE (event.event_start_date >= add_months((now())::date, (-6)))
 GROUP BY event.event_number,
          event.event_name,
          event.event_start_date,
          event.funding_source,
          event.estimated_attendance,
          event.event_location) e ON ((ea.event_number = e.event_number))) JOIN datamart.tvcmid_xref cmid ON (((ea.customer_id = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN ( SELECT event_product.event_number,
        event_product.product_id
 FROM integration.event_product
 GROUP BY event_product.event_number,
          event_product.product_id) ep ON ((ea.event_number = ep.event_number))) LEFT  JOIN product.basket b ON (((upper(ep.product_id) = upper(b.name)) AND (b.basket_type = 'brand'::varchar(5)))))
 WHERE (ea.file_id > ( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22)))))
 GROUP BY cmid.id_num,
          e.event_location,
          ea.source_system_name,
          to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar),
          NULL,
          (b.basket_id)::varchar(20),
          'HCP'::varchar(3),
          'Speaker_Program'::varchar(15),
          ((((('Speaker Program -, '::varchar(19) || e.funding_source) || ', '::varchar(2)) || e.estimated_attendance) || ' Attendees, '::varchar(12)) || CASE WHEN (ea.attended = 1) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) EXCEPT  SELECT cmid.id_num AS federation_id,
        e.event_location AS contact,
        ea.source_system_name AS source,
        to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (b.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Speaker_Program'::varchar(15) AS type,
        'Speaker_Program'::varchar(15) AS native_type,
        ((((('Speaker Program -, '::varchar(19) || e.funding_source) || ', '::varchar(2)) || e.estimated_attendance) || ' Attendees, '::varchar(12)) || CASE WHEN (ea.attended = 1) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT event_attendee.source_system_name,
        event_attendee.event_number,
        event_attendee.attended,
        event_attendee.customer_id,
        event_attendee.file_id
 FROM integration.event_attendee
 GROUP BY event_attendee.source_system_name,
          event_attendee.event_number,
          event_attendee.attended,
          event_attendee.customer_id,
          event_attendee.file_id) ea JOIN ( SELECT event.event_number,
        event.event_name,
        event.event_start_date,
        event.funding_source,
        event.estimated_attendance,
        event.event_location
 FROM integration.event
 WHERE (event.event_start_date >= add_months((now())::date, (-6)))
 GROUP BY event.event_number,
          event.event_name,
          event.event_start_date,
          event.funding_source,
          event.estimated_attendance,
          event.event_location) e ON ((ea.event_number = e.event_number))) JOIN datamart.tvcmid_xref cmid ON (((ea.customer_id = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN ( SELECT event_product.event_number,
        event_product.product_id
 FROM integration.event_product
 GROUP BY event_product.event_number,
          event_product.product_id) ep ON ((ea.event_number = ep.event_number))) LEFT  JOIN product.basket b ON (((upper(ep.product_id) = upper(b.name)) AND (b.basket_type = 'brand'::varchar(5)))))
 WHERE (ea.file_id <= ( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22)))))
 GROUP BY cmid.id_num,
          e.event_location,
          ea.source_system_name,
          to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar),
          NULL,
          (b.basket_id)::varchar(20),
          'HCP'::varchar(3),
          'Speaker_Program'::varchar(15),
          ((((('Speaker Program -, '::varchar(19) || e.funding_source) || ', '::varchar(2)) || e.estimated_attendance) || ' Attendees, '::varchar(12)) || CASE WHEN (ea.attended = 1) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23));

CREATE  VIEW outbound.activity_npp_sample_orders AS
 SELECT cmid.id_num AS federation_id,
        ss.hcp_zip AS contact,
        'Knipper'::varchar(7) AS source,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ss.order_source_order_id AS trackback_id,
        NULL AS previous_activity,
        (bb.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Alternate_Sample_Programs'::varchar(25) AS type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ','::varchar(1)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((((integration.sample_shipment ss JOIN datamart.tvcmid_xref cmid ON (((ss.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dfm ON ((dfm.file_id = ss.file_id))) LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (dfm.feed_id = sp.feed_id) AND (dfm.feed_version = sp.feed_version)))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id))) LEFT  JOIN product.basket bp ON ((sp.entity_id = bp.basket_id))) LEFT  JOIN product.source s ON ((sp.source_id = s.source_id)))
 WHERE ((substr(ss.order_source_order_id, 1, 1) <> 'C'::varchar(1)) AND (ss.ship_date >= add_months((now())::date, (-6))) AND (ss.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_KNIPPER_SAMPLES'::varchar(19)))), 0))) EXCEPT  SELECT cmid.id_num AS federation_id,
        ss.hcp_zip AS contact,
        'Knipper'::varchar(7) AS source,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ss.order_source_order_id AS trackback_id,
        NULL AS previous_activity,
        (bb.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Alternate_Sample_Programs'::varchar(25) AS type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ','::varchar(1)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((((integration.sample_shipment ss JOIN datamart.tvcmid_xref cmid ON (((ss.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dfm ON ((dfm.file_id = ss.file_id))) LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (dfm.feed_id = sp.feed_id) AND (dfm.feed_version = sp.feed_version)))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id))) LEFT  JOIN product.basket bp ON ((sp.entity_id = bp.basket_id))) LEFT  JOIN product.source s ON ((sp.source_id = s.source_id)))
 WHERE ((substr(ss.order_source_order_id, 1, 1) <> 'C'::varchar(1)) AND (ss.ship_date >= add_months((now())::date, (-6))) AND (ss.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_KNIPPER_SAMPLES'::varchar(19)))), 0)));

CREATE  VIEW outbound.activity_line_item_speaker_event AS
 SELECT concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS activity,
        to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        (ep.topic_id)::varchar(20) AS level_master_id,
        'Topics'::varchar(6) AS type,
        'Topics'::varchar(6) AS native_type,
        ep.topic_name AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT event.event_number,
        event.event_name,
        event.event_start_date,
        max(event.file_id) AS file_id
 FROM integration.event
 WHERE (event.event_start_date >= add_months((now())::date, (-6)))
 GROUP BY event.event_number,
          event.event_name,
          event.event_start_date) e LEFT  JOIN ( SELECT event_product.source_system_name,
        event_product.event_number,
        event_product.product_id,
        event_product.product_name,
        event_product.topic_id,
        event_product.topic_name
 FROM integration.event_product
 GROUP BY event_product.source_system_name,
          event_product.event_number,
          event_product.product_id,
          event_product.product_name,
          event_product.topic_id,
          event_product.topic_name) ep ON ((e.event_number = ep.event_number))) LEFT  JOIN product.basket b ON (((upper(ep.product_name) = b.name) AND (b.basket_type = 'brand'::varchar(5))))) LEFT  JOIN ( SELECT event_attendee.source_system_name,
        event_attendee.event_number,
        event_attendee.attended,
        event_attendee.customer_id,
        event_attendee.file_id
 FROM integration.event_attendee
 GROUP BY event_attendee.source_system_name,
          event_attendee.event_number,
          event_attendee.attended,
          event_attendee.customer_id,
          event_attendee.file_id) ea ON ((ea.event_number = e.event_number))) JOIN datamart.tvcmid_xref cmid ON (((ea.customer_id = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6)))))
 WHERE (ea.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22)))), 0)) EXCEPT  SELECT concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS activity,
        to_char(e.event_start_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(concat((concat((e.event_name || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)), (ea.attended)::varchar), (e.event_start_date)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        (ep.topic_id)::varchar(20) AS level_master_id,
        'Topics'::varchar(6) AS type,
        'Topics'::varchar(6) AS native_type,
        ep.topic_name AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT event.event_number,
        event.event_name,
        event.event_start_date,
        max(event.file_id) AS file_id
 FROM integration.event
 WHERE (event.event_start_date >= add_months((now())::date, (-6)))
 GROUP BY event.event_number,
          event.event_name,
          event.event_start_date) e LEFT  JOIN ( SELECT event_product.source_system_name,
        event_product.event_number,
        event_product.product_id,
        event_product.product_name,
        event_product.topic_id,
        event_product.topic_name
 FROM integration.event_product
 GROUP BY event_product.source_system_name,
          event_product.event_number,
          event_product.product_id,
          event_product.product_name,
          event_product.topic_id,
          event_product.topic_name) ep ON ((e.event_number = ep.event_number))) LEFT  JOIN product.basket b ON (((upper(ep.product_name) = b.name) AND (b.basket_type = 'brand'::varchar(5))))) LEFT  JOIN ( SELECT event_attendee.source_system_name,
        event_attendee.event_number,
        event_attendee.attended,
        event_attendee.customer_id,
        event_attendee.file_id
 FROM integration.event_attendee
 GROUP BY event_attendee.source_system_name,
          event_attendee.event_number,
          event_attendee.attended,
          event_attendee.customer_id,
          event_attendee.file_id) ea ON ((ea.event_number = e.event_number))) JOIN datamart.tvcmid_xref cmid ON (((ea.customer_id = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6)))))
 WHERE (ea.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22)))), 0));

CREATE  VIEW outbound.activity_line_item_non_npp_sample_orders AS
 SELECT ss.order_source_order_id AS activity,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(bp.name, ''::varchar)) AS trackback_id,
        NULL AS previous_line_item,
        (bp.basket_id)::varchar(20) AS level_master_id,
        'Alternate_Sample_Programs'::varchar(25) AS type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((( SELECT sample_shipment.order_source_order_id,
        sample_shipment.ship_date,
        sample_shipment.ndc,
        sample_shipment.quantity,
        sample_shipment.file_id,
        sample_shipment.record_id
 FROM integration.sample_shipment
 WHERE ((substr(sample_shipment.order_source_order_id, 1, 1) = 'C'::varchar(1)) AND (sample_shipment.ship_date >= add_months((now())::date, (-6))))) ss LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (sp.feed_id = 435) AND (sp.feed_version = 1)))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id))) LEFT  JOIN product.basket bp ON ((sp.entity_id = bp.basket_id)))
 WHERE (ss.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_VV_CALL2_SAMPLE_VOD__C'::varchar(26)))), 0))
 GROUP BY ss.order_source_order_id,
          to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(bp.name, ''::varchar)),
          NULL,
          (bp.basket_id)::varchar(20),
          'Alternate_Sample_Programs'::varchar(25),
          concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) EXCEPT  SELECT ss.order_source_order_id AS activity,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(bp.name, ''::varchar)) AS trackback_id,
        NULL AS previous_line_item,
        (bp.basket_id)::varchar(20) AS level_master_id,
        'Alternate_Sample_Programs'::varchar(25) AS type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((( SELECT sample_shipment.order_source_order_id,
        sample_shipment.ship_date,
        sample_shipment.ndc,
        sample_shipment.quantity,
        sample_shipment.file_id,
        sample_shipment.record_id
 FROM integration.sample_shipment
 WHERE ((substr(sample_shipment.order_source_order_id, 1, 1) = 'C'::varchar(1)) AND (sample_shipment.ship_date >= add_months((now())::date, (-6))))) ss LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (sp.feed_id = 435) AND (sp.feed_version = 1)))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id))) LEFT  JOIN product.basket bp ON ((sp.entity_id = bp.basket_id)))
 WHERE (ss.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_VV_CALL2_SAMPLE_VOD__C'::varchar(26)))), 0))
 GROUP BY ss.order_source_order_id,
          to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(bp.name, ''::varchar)),
          NULL,
          (bp.basket_id)::varchar(20),
          'Alternate_Sample_Programs'::varchar(25),
          concat((('Alternate Sample Programs-'::varchar(26) || coalesce(bp.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23));

CREATE  VIEW outbound.zzz_activity_line_item_npp_sample_orders AS
 SELECT ss.order_source_order_id AS activity,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(b.name, ''::varchar)) AS trackback_id,
        NULL AS previous_line_item,
        (b.basket_id)::varchar(20) AS level_master_id,
        'Alternate_Sample_Programs'::varchar(25) AS activity_type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(b.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((((integration.sample_shipment ss JOIN datamart.tvcmid_xref fed ON (((ss.tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dfm ON ((dfm.file_id = ss.file_id))) LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (dfm.feed_id = sp.feed_id) AND (dfm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON (((bip.entity_id = bp.basket_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id)))
 WHERE ((substr(ss.order_source_order_id, 1, 1) <> 'C'::varchar(1)) AND (ss.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_KNIPPER_SAMPLES'::varchar(19)))), 0))) EXCEPT  SELECT ss.order_source_order_id AS activity,
        to_char(ss.ship_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((ss.order_source_order_id || '-'::varchar(1)) || coalesce(b.name, ''::varchar)) AS trackback_id,
        NULL AS previous_line_item,
        (b.basket_id)::varchar(20) AS level_master_id,
        'Alternate_Sample_Programs'::varchar(25) AS activity_type,
        'Alternate_Sample_Programs'::varchar(25) AS native_type,
        concat((('Alternate Sample Programs-'::varchar(26) || coalesce(b.name, ''::varchar)) || ' , '::varchar(3)), (ss.quantity)::varchar) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((((integration.sample_shipment ss JOIN datamart.tvcmid_xref fed ON (((ss.tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dfm ON ((dfm.file_id = ss.file_id))) LEFT  JOIN product.source_product sp ON (((ss.ndc = sp.source_product_code) AND (dfm.feed_id = sp.feed_id) AND (dfm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id))) LEFT  JOIN ( SELECT bb.name,
        bb.basket_id,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON (((bip.entity_id = bp.basket_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) bb ON ((sp.entity_id = bb.prod_id)))
 WHERE ((substr(ss.order_source_order_id, 1, 1) <> 'C'::varchar(1)) AND (ss.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_KNIPPER_SAMPLES'::varchar(19)))), 0)));

CREATE  VIEW outbound.zzz_activity_line_item_copay AS
 SELECT ((c.file_id)::varchar || (c.record_id)::varchar) AS activity,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((c.file_id)::varchar || (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        (b.basket_id)::varchar(20) AS level_master_id,
        'Voucher/Coupon Redemption'::varchar(25) AS activity_type,
        'Voucher/Coupon Redemption'::varchar(25) AS native_type,
        cvp.program_description AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON (((bip.entity_id = bp.basket_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.basket_id)))
 WHERE ((c.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (c.fill_date >= add_months((now())::date, (-6)))) EXCEPT  SELECT ((c.file_id)::varchar || (c.record_id)::varchar) AS activity,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        ((c.file_id)::varchar || (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        (b.basket_id)::varchar(20) AS level_master_id,
        'Voucher/Coupon Redemption'::varchar(25) AS activity_type,
        'Voucher/Coupon Redemption'::varchar(25) AS native_type,
        cvp.program_description AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM (((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON (((bip.entity_id = bp.basket_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.basket_id)))
 WHERE ((c.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (c.fill_date >= add_months((now())::date, (-6))));

CREATE  VIEW outbound.zzz_rems_program_lookup AS
 SELECT rems_prescriber.program_id AS PROGRAM_ID,
        rems_prescriber.program_name AS PROGRAM_NAME
 FROM datamart.rems_prescriber
 GROUP BY rems_prescriber.program_id,
          rems_prescriber.program_name;

CREATE  VIEW outbound.zzz_asi_rems_programs AS
 SELECT p.program_id,
        p.program_name
 FROM integration.rems_prescriber p
 GROUP BY p.program_id,
          p.program_name;

CREATE  VIEW outbound.zzz_azilect_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_azilect_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_create_mm_ram_to_rsm AS
 SELECT mm_ram_to_rsm.mm_ram AS MM_RAM,
        mm_ram_to_rsm.rsm AS RSM
 FROM datamart.mm_ram_to_rsm
 GROUP BY mm_ram_to_rsm.mm_ram,
          mm_ram_to_rsm.rsm
 ORDER BY mm_ram_to_rsm.mm_ram,
          mm_ram_to_rsm.rsm;

CREATE  VIEW outbound.zzz_create_product_lookup AS
(( SELECT '100100'::varchar(6) AS PRODUCT_ID,
        'Provigil'::varchar(8) AS PRODUCT_DESC,
        'Wake'::varchar(4) AS MARKET_DESC
 FROM v_catalog.dual UNION ALL  SELECT '100700'::varchar(6),
        'Nuvigil'::varchar(7),
        'Wake'::varchar(4)
 FROM v_catalog.dual) UNION ALL  SELECT '300500'::varchar(6),
        'Fentora'::varchar(7),
        'Pain'::varchar(4)
 FROM v_catalog.dual) UNION ALL  SELECT '700100'::varchar(6),
        'Azilect'::varchar(7),
        'Wake'::varchar(4)
 FROM v_catalog.dual;

CREATE  VIEW outbound.zzz_create_tb_ds_accountsummary AS
 SELECT dsd.account_id AS ACCOUNT_ID,
        dsd.location_id AS LOCATION_ID,
        dsd.account_name AS ACCOUNT_NAME,
        dsd.account_class AS ACCOUNT_CLASS,
        dsd.address_1 AS ADDRESS_1,
        dsd.address_2 AS ADDRESS_2,
        dsd.city AS CITY,
        dsd.state AS STATE,
        dsd.zip AS ZIP
 FROM datamart.direct_sales_demographics dsd
 WHERE (dsd.file_id = ( SELECT max(direct_sales_demographics.file_id) AS MAX
 FROM datamart.direct_sales_demographics));

CREATE  VIEW outbound.zzz_create_tb_ds_transactions AS
 SELECT ds.account_id AS ACCOUNT_ID,
        ds.location_id AS LOCATION_ID,
        ds.shipment_date AS SHIPMENT_DATE,
        ds.ndc_code AS NDC_CODE,
        ds.product_name AS PRODUCT_NAME,
        ds.transaction_type AS TRANSACTION_TYPE,
        CASE mod(ds.direct_sales_units, 1::float) WHEN NULLSEQUAL 0::float THEN ((ds.direct_sales_units)::int)::varchar ELSE rtrim((ds.direct_sales_units)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_UNITS,
        CASE mod(ds.direct_sales_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((ds.direct_sales_dollars)::int)::varchar ELSE rtrim((ds.direct_sales_dollars)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_DOLLARS,
        CASE mod(ds.unit_ap, 1::float) WHEN NULLSEQUAL 0::float THEN ((ds.unit_ap)::int)::varchar ELSE rtrim((ds.unit_ap)::varchar, '0'::varchar(1)) END AS UNIT_AP,
        CASE mod(ds.total_ap, 1::float) WHEN NULLSEQUAL 0::float THEN ((ds.total_ap)::int)::varchar ELSE rtrim((ds.total_ap)::varchar, '0'::varchar(1)) END AS AP
 FROM datamart.direct_sales ds
 WHERE (ds.file_id = ( SELECT max(direct_sales.file_id) AS MAX
 FROM datamart.direct_sales));

CREATE  VIEW outbound.zzz_fentora_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_fentora_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_kc_copay_voucher_program AS
SELECT c.redemption_type, c.program_number, c.program_description, c.sales_force_id, c.program_type, c.product_name, to_char(c.program_start_date, 'YYYY-MM-DD'::varchar(10)) AS program_start_date, to_char(c.program_end_date, 'YYYY-MM-DD'::varchar(10)) AS program_end_date, c.number_of_tablets FROM reference.copay_voucher_program c;

CREATE  VIEW outbound.zzz_nuvigil_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_nuvigil_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_v_factory_sales_852 AS
 SELECT fs.trading_partner AS TRADING_PARTNER,
        fs.distribution_center AS DISTRIB_CENTER,
        fs.distribution_center_dea_number AS DISTRIB_CENTER_DEA_NUM,
        to_char(fs.reporting_date, 'DD-MON-YY'::varchar(9)) AS REPORTING_DATE,
        fs.ndc AS NDC,
        coalesce(b.teva_product_code, 'ERROR'::varchar(5)) AS PRODUCT_CODE,
        fs.product_name AS PRODUCT_NAME,
        fs.description AS DESCRIPTION,
        CASE mod(fs.qty_received, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_received)::int)::varchar ELSE rtrim((fs.qty_received)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED,
        CASE mod(fs.qty_received_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_received_dollars)::int)::varchar ELSE rtrim((fs.qty_received_dollars)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED_DOLLARS,
        CASE mod(fs.qty_sold, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_sold)::int)::varchar ELSE rtrim((fs.qty_sold)::varchar, '0'::varchar(1)) END AS QTY_SOLD,
        CASE mod(fs.qty_sold_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_sold_dollars)::int)::varchar ELSE rtrim((fs.qty_sold_dollars)::varchar, '0'::varchar(1)) END AS QTY_SOLD_DOLLARS,
        CASE mod(fs.qty_omit, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_omit)::int)::varchar ELSE rtrim((fs.qty_omit)::varchar, '0'::varchar(1)) END AS QTY_OMIT,
        CASE mod(fs.qty_omit_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_omit_dollars)::int)::varchar ELSE rtrim((fs.qty_omit_dollars)::varchar, '0'::varchar(1)) END AS QTY_OMIT_DOLLARS,
        CASE mod(fs.month_end_qty_on_hand, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_qty_on_hand)::int)::varchar ELSE rtrim((fs.month_end_qty_on_hand)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND,
        CASE mod(fs.month_end_qty_on_hand_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_qty_on_hand_dollars)::int)::varchar ELSE rtrim((fs.month_end_qty_on_hand_dollars)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND_DOLLARS,
        CASE mod(fs.month_end_committed, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_committed)::int)::varchar ELSE rtrim((fs.month_end_committed)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED,
        CASE mod(fs.month_end_committed_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_committed_dollars)::int)::varchar ELSE rtrim((fs.month_end_committed_dollars)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED_DOLLARS,
        CASE mod(fs.month_end_reserved, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_reserved)::int)::varchar ELSE rtrim((fs.month_end_reserved)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED,
        CASE mod(fs.month_end_reserved_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.month_end_reserved_dollars)::int)::varchar ELSE rtrim((fs.month_end_reserved_dollars)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED_DOLLARS,
        CASE mod(fs.qty_return, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_return)::int)::varchar ELSE rtrim((fs.qty_return)::varchar, '0'::varchar(1)) END AS QTY_RETURN,
        CASE mod(fs.qty_return_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_return_dollars)::int)::varchar ELSE rtrim((fs.qty_return_dollars)::varchar, '0'::varchar(1)) END AS QTY_RETURN_DOLLARS,
        CASE mod(fs.qty_customer_return, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_customer_return)::int)::varchar ELSE rtrim((fs.qty_customer_return)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN,
        CASE mod(fs.qty_customer_return_dollars, 1::float) WHEN NULLSEQUAL 0::float THEN ((fs.qty_customer_return_dollars)::int)::varchar ELSE rtrim((fs.qty_customer_return_dollars)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN_DOLLARS,
        to_char((statement_timestamp())::timestamp, 'DD-MON-YY'::varchar(9)) AS LAST_BUILD_DATE
 FROM (datamart.factory_sales_852 fs LEFT  JOIN product.basket b ON ((fs.basket_id = b.basket_id)));

CREATE  VIEW outbound.zzz_v_touchpoint_call AS
 SELECT tpc.call_id AS ID,
        tpc.call_attempt_id AS AttemptID,
        tpc.touchpoint_id AS TouchpointID,
        tpc.veeva_id AS ClientID,
        tpc.ims_id AS IMSID,
        tpc.first_name AS FirstName,
        tpc.last_name AS LastName,
        tpc.call_type AS Type,
        tpc.call_date AS Date,
        tpc.status_code AS StatusCode,
        tpc.status_description AS StatusDescription,
        tpc.rep_id AS RepID,
        tpc.rep_first_name AS RepFirstName,
        tpc.rep_last_name AS RepLastName
 FROM datamart.touchpoint_call tpc
 WHERE (tpc.file_id = ( SELECT max(touchpoint_call.file_id) AS MAX
 FROM datamart.touchpoint_call));

CREATE  VIEW outbound.zzz_zs_agile_voucher_redemptions AS
 SELECT c.physician_tvcmid AS TVCMID,
        c.physician_ims_id AS IMS_ID,
        c.physician_veeva_id AS VEEVA_ACCOUNT_ID,
        c.program_number AS ASI_PROGRAM_NUM,
        v.program_description AS PROGRAM_DESC,
        c.copay_card_number AS VOUCHER_NUM,
        c.physician_zip AS ZIP_CODE,
        to_char(c.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        c.basket_name AS PRODUCT_NAME,
        p.source_product_description AS DRUG_DESC,
        CASE mod(c.quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.quantity)::int)::varchar ELSE rtrim((c.quantity)::varchar, '0'::varchar(1)) END AS QTY
 FROM ((datamart.copay c JOIN reference.copay_voucher_program v ON (((c.program_number = v.program_number) AND (c.redemption_type = v.redemption_type)))) LEFT  JOIN product.source_product p ON ((c.basket_id = p.entity_id)))
 WHERE ((c.basket_name = 'NUVIGIL'::varchar(7)) AND (c.fill_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (c.fill_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))));

CREATE  VIEW outbound.i_sfa_onc_trx AS
 SELECT p.time_period,
        p.ims_id,
        p.product,
        sum(p.trx_curr_mth) AS trx_curr_mth,
        sum(p.trx_prior_mth) AS trx_prior_mth,
        sum(p.trx_3mth) AS trx_3mth,
        sum(p.trx_6mth) AS trx_6mth,
        sum(p.trx_sem) AS trx_sem,
        p.sort_order,
        p.data_date
 FROM ( SELECT ((to_char(rx1.data_date, 'yyyy'::varchar(4)) || '-'::varchar(1)) || to_char(rx1.data_date, 'mm'::varchar(2))) AS time_period,
        rx1.ims_id,
        CASE rx1.basket_id WHEN NULLSEQUAL 207 THEN 'TRETINOIN'::varchar(9) WHEN NULLSEQUAL 203 THEN 'LEUKERAN'::varchar(8) WHEN NULLSEQUAL 242 THEN 'GLEEVEC'::varchar(7) WHEN NULLSEQUAL 243 THEN 'SPRYCEL'::varchar(7) WHEN NULLSEQUAL 244 THEN 'TASIGNA'::varchar(7) WHEN NULLSEQUAL 59 THEN 'BOSULIF'::varchar(7) WHEN NULLSEQUAL 450 THEN 'ICLUSIG'::varchar(7) WHEN NULLSEQUAL 79 THEN 'TKI TOTAL'::varchar(9) WHEN NULLSEQUAL 474 THEN 'IMBRUVICA'::varchar(9) WHEN NULLSEQUAL 379 THEN 'GRANIX'::varchar(6) WHEN NULLSEQUAL 666 THEN 'NEUPOGEN'::varchar(8) WHEN NULLSEQUAL 668 THEN 'LEUKINE'::varchar(7) ELSE NULL END AS product,
        sum(CASE WHEN (to_char(rx1.date, 'YYYYMM'::varchar(6)) = to_char(rx1.data_date, 'YYYYMM'::varchar(6))) THEN rx1.trx_count ELSE 0::float END) AS trx_curr_mth,
        sum(CASE WHEN (to_char(rx1.date, 'YYYYMM'::varchar(6)) = to_char(add_months(rx1.data_date, (-1)), 'YYYYMM'::varchar(6))) THEN rx1.trx_count ELSE 0::float END) AS trx_prior_mth,
        sum(CASE WHEN ((to_char(rx1.date, 'YYYYMM'::varchar(6)) >= to_char(add_months(rx1.data_date, (-2)), 'YYYYMM'::varchar(6))) AND (to_char(rx1.date, 'YYYYMM'::varchar(6)) <= to_char(rx1.data_date, 'YYYYMM'::varchar(6)))) THEN rx1.trx_count ELSE 0::float END) AS trx_3mth,
        sum(CASE WHEN ((to_char(rx1.date, 'YYYYMM'::varchar(6)) >= to_char(add_months(rx1.data_date, (-5)), 'YYYYMM'::varchar(6))) AND (to_char(rx1.date, 'YYYYMM'::varchar(6)) <= to_char(rx1.data_date, 'YYYYMM'::varchar(6)))) THEN rx1.trx_count ELSE 0::float END) AS trx_6mth,
        sum(CASE WHEN ((rx1.rollup_month >= rpt_periods.s1_start) AND (rx1.rollup_month <= rpt_periods.s1_end)) THEN rx1.trx_count ELSE 0::float END) AS trx_sem,
        CASE rx1.basket_id WHEN NULLSEQUAL 207 THEN 1 WHEN NULLSEQUAL 203 THEN 2 WHEN NULLSEQUAL 242 THEN 3 WHEN NULLSEQUAL 243 THEN 4 WHEN NULLSEQUAL 244 THEN 5 WHEN NULLSEQUAL 59 THEN 6 WHEN NULLSEQUAL 450 THEN 7 WHEN NULLSEQUAL 79 THEN 8 WHEN NULLSEQUAL 474 THEN 9 WHEN NULLSEQUAL 379 THEN 10 WHEN NULLSEQUAL 666 THEN 11 WHEN NULLSEQUAL 668 THEN 12 ELSE NULL::int END AS sort_order,
        rx1.data_date
 FROM ((datamart.prescriber_rx rx1 JOIN datamart.prescriber_combined_demographics d ON ((rx1.ims_id = d.ims_id))) CROSS  JOIN ( SELECT pr.data_date,
        s1.semester_time_period AS s1_time_period,
        s1.semester_begin_date AS s1_start,
        s1.semester_end_date AS s1_end
 FROM (reference.date_dim s1 JOIN ( SELECT rx.data_date
 FROM datamart.prescriber_rx rx
 WHERE ((rx.basket_id = 151) AND (rx.data_date IN ( SELECT max(prescriber_rx.data_date) AS max
 FROM datamart.prescriber_rx
 WHERE (prescriber_rx.basket_id = 151))))
 LIMIT 1) pr ON ((s1.calendar_date = pr.data_date)))) rpt_periods)
 WHERE ((d.sales_force_id = 'TO'::varchar(2)) AND (d.pdrp_flag = 'N'::varchar(1)) AND (rx1.basket_id = ANY (ARRAY[668, 59, 243, 244, 79, 242, 474, 666, 203, 207, 379, 450])) AND (to_char(rx1.date, 'YYYYMM'::varchar(6)) >= to_char(add_months(rx1.data_date, (-5)), 'YYYYMM'::varchar(6))) AND (to_char(rx1.date, 'YYYYMM'::varchar(6)) <= to_char(rx1.data_date, 'YYYYMM'::varchar(6))) AND (rx1.tvcmid IN ( SELECT sfa_demographics.tvcmid
 FROM datamart.sfa_demographics
 WHERE (sfa_demographics.sales_force_id = 'TO'::varchar(2)))))
 GROUP BY rx1.data_date,
          rx1.ims_id,
          rx1.basket_id) p
 GROUP BY p.time_period,
          p.ims_id,
          p.product,
          p.sort_order,
          p.data_date;

CREATE  VIEW outbound.zzz_axiom_market_w AS
 SELECT prescriber_rx.market_name,
        prescriber_rx.payer_plan_number AS plan_num,
        b.teva_product_code AS product_code,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt24,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt24
 FROM ((datamart.prescriber_rx prescriber_rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON ((prescriber_rx.rollup_month = mth.month_ending))) LEFT  JOIN product.basket b ON ((prescriber_rx.basket_id = b.basket_id)))
 WHERE ((prescriber_rx.nrx_count IS NOT NULL) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY prescriber_rx.market_name,
          prescriber_rx.payer_plan_number,
          b.teva_product_code
 ORDER BY prescriber_rx.payer_plan_number,
          b.teva_product_code,
          sum(CASE WHEN (prescriber_rx.date = add_months(last_day(prescriber_rx.data_date), (-1))) THEN prescriber_rx.nrx_count ELSE NULL::float END);

CREATE  VIEW outbound.zzz_zs_agile_sp_programs AS
 SELECT p.event_number AS EVENT_NUMBER,
        p.parent_event_number AS PARENT_EVENT_NUMBER,
        p.event_name AS EVENT_NAME,
        p.event_status_code AS EVENT_STATUS_CODE,
        p.event_status_description AS EVENT_STATUS_DESCRIPTION,
        to_char(p.event_status_change_date, 'YYYY-MM-DD'::varchar(10)) AS EVENT_STATUS_CHANGE_DATE,
        to_char(p.event_start_date, 'YYYY-MM-DD'::varchar(10)) AS EVENT_START_DATE,
        to_char(p.event_end_date, 'YYYY-MM-DD'::varchar(10)) AS EVENT_END_DATE,
        p.event_time_zone AS EVENT_TIME_ZONE,
        p.funding_source AS FUNDING_SOURCE,
        p.event_type AS EVENT_TYPE,
        p.event_type_description AS EVENT_TYPE_DESCRIPTION,
        p.event_format AS EVENT_FORMAT,
        p.event_location AS EVENT_LOCATION,
        to_char(p.pending_mgmnt_approval_date, 'YYYY-MM-DD'::varchar(10)) AS PENDING_MGMNT_APPROVAL_DATE,
        to_char(p.event_approval_date, 'YYYY-MM-DD'::varchar(10)) AS EVENT_APPROVAL_DATE,
        p.event_approver_id AS EVENT_APPROVER_ID,
        to_char(p.event_schedule_date, 'YYYY-MM-DD'::varchar(10)) AS EVENT_SCHEDULE_DATE,
        to_char(p.attendee_closeout_date, 'YYYY-MM-DD'::varchar(10)) AS ATTENDEE_CLOSEOUT_DATE,
        to_char(p.financial_closeout_date, 'YYYY-MM-DD'::varchar(10)) AS FINANCIAL_CLOSEOUT_DATE,
        to_char(p.cancellation_date, 'YYYY-MM-DD'::varchar(10)) AS CANCELLATION_DATE,
        p.cancellation_reason AS CANCELLATION_REASON,
        p.cancellation_source AS CANCELLATION_SOURCE,
        p.event_venue_min_cnt_req_ind AS EVENT_VENUE_MIN_CNT_REQ_IND,
        p.event_venue_min_count AS EVENT_VENUE_MIN_COUNT,
        p.estimated_attendance AS ESTIMATED_ATTENDANCE,
        p.venue_id AS VENUE_ID,
        p.venue_full_name AS VENUE_FULL_NAME,
        p.venue_address_line_1 AS VENUE_ADDRESS_LINE_1,
        p.venue_address_line_2 AS VENUE_ADDRESS_LINE_2,
        p.venue_address_line_3 AS VENUE_ADDRESS_LINE_3,
        p.venue_address_line_4 AS VENUE_ADDRESS_LINE_4,
        p.venue_city AS VENUE_CITY,
        p.venue_state AS VENUE_STATE_PROVINCE,
        p.venue_zip AS VENUE_POSTAL_CODE,
        p.venue_postal_extended_code AS VENUE_POSTAL_EXTENDED_CODE,
        p.venue_country_code AS VENUE_COUNTRY_CODE,
        p.venue_contact AS VENUE_CONTACT,
        p.venue_phone AS VENUE_PHONE,
        p.venue_fax AS VENUE_FAX,
        p.venue_email AS VENUE_EMAIL,
        p.trade_secret_indicator AS TRADE_SECRET_INDICATOR,
        p.trade_secret_reason AS TRADE_SECRET_REASON,
        p.custom_field_1 AS CUSTOM_FIELD_1,
        p.custom_field_2 AS CUSTOM_FIELD_2,
        p.custom_field_3 AS CUSTOM_FIELD_3,
        p.custom_field_4 AS CUSTOM_FIELD_4,
        p.custom_field_5 AS CUSTOM_FIELD_5,
        e.payment_id AS PAYEMNT_ID,
        e.expense_category AS EXPENSE_CATEGORY,
        CASE mod(e.amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((e.amount)::int)::varchar ELSE rtrim((e.amount)::varchar, '0'::varchar(1)) END AS AMOUNT
 FROM (datamart.event p LEFT  JOIN datamart.event_expense e ON ((p.event_number = e.event_number)));

CREATE  VIEW outbound.zzz_asi_survey_data AS
(( SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(sqr_main.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        CASE WHEN ((s.name = ANY (ARRAY['Pharmacy Survey'::varchar(34), 'Respiratory - RespiClick Readiness'::varchar(34)])) AND (q.order_vod__c = ANY (ARRAY[0::numeric(18,0), 1::numeric(18,0), 2::numeric(18,0)]))) THEN (concat(((q.order_vod__c + 1::numeric(18,0)))::varchar, '. '::varchar(2)) || sqr_main.question_text_vod__c) WHEN ((s.name = ANY (ARRAY['Pharmacy Survey'::varchar(34), 'Respiratory - RespiClick Readiness'::varchar(34)])) AND (q.order_vod__c <> ALL (ARRAY[0::numeric(18,0), 1::numeric(18,0), 2::numeric(18,0)]))) THEN ('. '::varchar(2) || sqr_main.question_text_vod__c) ELSE sqr_main.question_text_vod__c END AS question,
        sqr_main.response AS answer,
        to_char(sqr_main.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(sqr_main.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY t.account_vod__c, q.id, sqr_main.response ORDER BY sqr_main.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr4.createddate,
        sqr4.lastmodifieddate,
        sqr4.survey_target_vod__c,
        sqr4.survey_question_vod__c,
        sqr4.question_text_vod__c,
        response.response
 FROM (( SELECT sqr3.id,
        sqr3.createddate,
        sqr3.lastmodifieddate,
        sqr3.survey_target_vod__c,
        sqr3.survey_question_vod__c,
        sqr3.question_text_vod__c,
        row_number() OVER (PARTITION BY sqr3.id ORDER BY sqr3.file_id DESC) AS rnk
 FROM veeva.survey_question_response sqr3
 WHERE (sqr3.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr4 JOIN ( SELECT "substring"(v.values, 1, 18) AS id,
        "substring"(v.values, 19, length(v.values)) AS response
 FROM ( SELECT public.MapItems(r.v1) OVER () AS ( keys, values )
 FROM ( SELECT public.MapDelimitedExtractor((coalesce((sqr2.id || replace(sqr2.response_vod__c, ';'::varchar(1), (';'::varchar(1) || sqr2.id))), sqr2.id))::long varchar(10468) USING PARAMETERS delimiter=';'::varchar(1)) AS v1
 FROM ( SELECT sqr1.id,
        sqr1.response_vod__c,
        row_number() OVER (PARTITION BY st.account_vod__c, sqr1.survey_question_vod__c ORDER BY sqr1.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response sqr1 JOIN veeva.survey_target st ON ((sqr1.survey_target_vod__c = st.id)))
 WHERE (sqr1.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr2
 WHERE (sqr2.rnk = 1)) r) v
 GROUP BY "substring"(v.values, 1, 18),
          "substring"(v.values, 19, length(v.values))) response ON (((sqr4.id = response.id) AND (sqr4.rnk = 1))))) sqr_main ON ((q.id = sqr_main.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = sqr_main.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS MAX
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS MAX
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS MAX
 FROM veeva.survey_target)) AND (s.name = ANY (ARRAY['Pharmacy Survey'::varchar(42), 'Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(42), 'Respiratory - RespiClick Readiness'::varchar(42), 'Respiratory Business Survey'::varchar(42), 'Respiratory Professional Survey'::varchar(42), 'e-Rx Survey'::varchar(42)])))) a
 WHERE (a.rnk = 1) UNION  SELECT B.veeva_account_id,
        B.bu,
        max(B.survey_update_date) OVER (PARTITION BY B.veeva_account_id),
        B.survey,
        B.question,
        B.answer,
        B.response_update_date,
        B.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        (s.name || ' B'::varchar(2)) AS survey,
        r.question_text_vod__c AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY t.account_vod__c, q.id ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT a.createddate,
        a.lastmodifieddate,
        a.survey_target_vod__c,
        a.survey_question_vod__c,
        a.question_text_vod__c,
        response.response
 FROM (( SELECT sqr.id,
        sqr.createddate,
        sqr.lastmodifieddate,
        sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c
 FROM ( SELECT survey_question_response.id,
        survey_question_response.isdeleted,
        survey_question_response.name,
        survey_question_response.recordtypeid,
        survey_question_response.createddate,
        survey_question_response.createdbyid,
        survey_question_response.lastmodifieddate,
        survey_question_response.lastmodifiedbyid,
        survey_question_response.systemmodstamp,
        survey_question_response.mayedit,
        survey_question_response.islocked,
        survey_question_response.survey_target_vod__c,
        survey_question_response.answer_choice_vod__c,
        survey_question_response.date_vod__c,
        survey_question_response.datetime_vod__c,
        survey_question_response.external_id_vod__c,
        survey_question_response.mobile_id_vod__c,
        survey_question_response.number_vod__c,
        survey_question_response.order_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.required_vod__c,
        survey_question_response.response_hash_vod__c,
        survey_question_response.response_vod__c,
        survey_question_response.score_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.text_vod__c,
        survey_question_response.type_vod__c,
        survey_question_response.file_id,
        survey_question_response.record_id
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr) a LEFT  JOIN ( SELECT "substring"(v.values, 1, 18) AS id,
        "substring"(v.values, 19, length(v.values)) AS response
 FROM ( SELECT public.MapItems(r.v1) OVER () AS ( keys, values )
 FROM ( SELECT public.MapDelimitedExtractor(((sqr.id || replace(sqr.response_vod__c, ';'::varchar(1), (';'::varchar(1) || sqr.id))))::long varchar(10468) USING PARAMETERS delimiter=';'::varchar(1)) AS v1
 FROM veeva.survey_question_response sqr
 WHERE (sqr.file_id = ( SELECT max(survey_question_response.file_id) AS max
 FROM veeva.survey_question_response))) r) v
 GROUP BY "substring"(v.values, 1, 18),
          "substring"(v.values, 19, length(v.values))) response ON ((a.id = response.id)))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(s1.file_id) AS MAX
 FROM veeva.survey s1)) AND (q.file_id = ( SELECT max(q1.file_id) AS MAX
 FROM veeva.survey_question q1)) AND (t.file_id = ( SELECT max(t1.file_id) AS MAX
 FROM veeva.survey_target t1)) AND (s.name = 'e-Rx Survey'::varchar(11)) AND (q.order_vod__c = 1::numeric(18,0)))) B
 WHERE (B.rnk = 1)
 GROUP BY B.veeva_account_id,
          B.bu,
          B.survey_update_date,
          B.survey,
          B.question,
          B.answer,
          B.response_update_date,
          B.response_create_date) UNION  SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        '*Future Scheduled Adasuve Formulary Review Date'::varchar(47) AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY s.id, q.id, t.account_vod__c, r.response ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr_yr.survey_target_vod__c,
        sqr_yr.survey_question_vod__c,
        sqr_yr.question_text_vod__c,
        sqr_yr.lastmodifieddate,
        sqr_yr.createddate,
        ((((coalesce(sqr_yr.response_vod__c, ''::varchar) || '-'::varchar(1)) || CASE WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jan'::varchar(3)) THEN '01'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Feb'::varchar(3)) THEN '02'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Mar'::varchar(3)) THEN '03'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Apr'::varchar(3)) THEN '04'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'May'::varchar(3)) THEN '05'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jun'::varchar(3)) THEN '06'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jul'::varchar(3)) THEN '07'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Aug'::varchar(3)) THEN '08'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Sep'::varchar(3)) THEN '09'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Oct'::varchar(3)) THEN '10'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Nov'::varchar(3)) THEN '11'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Dec'::varchar(3)) THEN '12'::varchar(2) ELSE ''::varchar END) || '-'::varchar(1)) || coalesce(sqr_day.response_vod__c, ''::varchar)) AS response
 FROM ((( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.lastmodifieddate,
        sqr.createddate,
        row_number() OVER (PARTITION BY sqr.survey_target_vod__c, sqr.survey_question_vod__c ORDER BY sqr.createddate DESC) AS rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        survey_question_response.lastmodifieddate,
        survey_question_response.createddate,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Year%'::varchar(40))) sqr
 WHERE (sqr.rnk = 1)) sqr_yr JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT qr.survey_target_vod__c,
        qr.survey_question_vod__c,
        qr.question_text_vod__c,
        qr.response_vod__c,
        row_number() OVER (PARTITION BY st.account_vod__c, qr.survey_question_vod__c ORDER BY qr.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response qr JOIN ( SELECT survey_target.id,
        survey_target.account_vod__c
 FROM veeva.survey_target
 GROUP BY survey_target.id,
          survey_target.account_vod__c) st ON ((qr.survey_target_vod__c = st.id)))
 WHERE (qr.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Month%'::varchar(41))) sqr
 WHERE (sqr.rnk = 1)) sqr_mth ON (((sqr_mth.survey_target_vod__c = sqr_yr.survey_target_vod__c) AND (sqr_yr.rnk = 1)))) JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Date%'::varchar(40))) sqr
 WHERE (sqr.rnk = 1)) sqr_day ON ((sqr_day.survey_target_vod__c = sqr_yr.survey_target_vod__c)))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS max
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS max
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS max
 FROM veeva.survey_target)) AND (s.name = 'REMS Enrollment and Formulary'::varchar(29)))) a
 WHERE (a.rnk = 1)) UNION  SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        '*Prior Adasuve Formulary Review Date'::varchar(36) AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY s.id, q.id, t.account_vod__c, r.response ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr_yr.survey_target_vod__c,
        sqr_yr.survey_question_vod__c,
        sqr_yr.question_text_vod__c,
        sqr_yr.lastmodifieddate,
        sqr_yr.createddate,
        ((coalesce(sqr_yr.response_vod__c, ''::varchar) || '-'::varchar(1)) || CASE WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jan'::varchar(3)) THEN '01'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Feb'::varchar(3)) THEN '02'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Mar'::varchar(3)) THEN '03'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Apr'::varchar(3)) THEN '04'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'May'::varchar(3)) THEN '05'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jun'::varchar(3)) THEN '06'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jul'::varchar(3)) THEN '07'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Aug'::varchar(3)) THEN '08'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Sep'::varchar(3)) THEN '09'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Oct'::varchar(3)) THEN '10'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Nov'::varchar(3)) THEN '11'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Dec'::varchar(3)) THEN '12'::varchar(2) ELSE ''::varchar END) AS response
 FROM (( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.lastmodifieddate,
        sqr.createddate,
        row_number() OVER (PARTITION BY sqr.survey_target_vod__c, sqr.survey_question_vod__c ORDER BY sqr.createddate DESC) AS rnk
 FROM ( SELECT qr.survey_target_vod__c,
        qr.survey_question_vod__c,
        qr.question_text_vod__c,
        qr.response_vod__c,
        qr.lastmodifieddate,
        qr.createddate,
        row_number() OVER (PARTITION BY st.account_vod__c, qr.survey_question_vod__c ORDER BY qr.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response qr JOIN ( SELECT survey_target.id,
        survey_target.account_vod__c
 FROM veeva.survey_target
 GROUP BY survey_target.id,
          survey_target.account_vod__c) st ON ((qr.survey_target_vod__c = st.id)))
 WHERE (qr.question_text_vod__c ~~ '%Prior Adasuve % Review Year'::varchar(28))) sqr
 WHERE (sqr.rnk = 1)) sqr_yr JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Prior Adasuve % Review Month'::varchar(29))) sqr
 WHERE (sqr.rnk = 1)) sqr_mth ON (((sqr_mth.survey_target_vod__c = sqr_yr.survey_target_vod__c) AND (sqr_yr.rnk = 1))))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS max
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS max
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS max
 FROM veeva.survey_target)) AND (s.name = 'REMS Enrollment and Formulary'::varchar(29)))) a
 WHERE (a.rnk = 1);

CREATE  VIEW outbound.zzz_zs_agile_copay_voucher_drops AS
 SELECT d.tvcmid AS TVCMID,
        d.ims_id AS IMS_ID,
        d.veeva_account_id AS VEEVA_ACCOUNT_ID,
        d.item_type AS RESOURCE_TYPE,
        d.territory_number AS TERRITORY_NUM,
        d.distribution_date AS DISTRIBUTION_DATE,
        d.quantity AS QTY
 FROM datamart.sfa_promotional_items d
 WHERE ((d.product_name = 'NUVIGIL'::varchar(7)) AND (d.item_type = 'Voucher/Co-Pay'::varchar(14)) AND (d.ims_id IS NOT NULL) AND (d.distribution_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (d.distribution_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))));

CREATE  VIEW outbound.zzz_create_tb_cb_accountsummary AS
 SELECT cd.account_id AS ACCOUNT_ID,
        cd.location_id AS LOCATION_ID,
        cd.dea_number AS DEA_NUMBER,
        cd.end_customer AS END_CUSTOMER,
        cd.address_1 AS ADDRESS_1,
        cd.address_2 AS ADDRESS_2,
        cd.city AS CITY,
        cd.state AS STATE,
        cd.zip AS ZIP,
        cd.contract_title AS CONTRACT_TITLE,
        cd.contract_id AS CONTRACT_ID,
        cd.wholesaler_name AS WHOLESALER_NAME,
        cd.hin AS HIN,
        NULL AS CONTRACT_ALIAS,
        cd.wholesaler_dea AS WHOLESALER_DEA,
        cd.cot_source AS COT_SOURCE,
        cd.class_of_trade AS CLASS_OF_TRADE
 FROM datamart.chargeback_demographics cd;

CREATE  VIEW outbound.zzz_asi_rx_by_market AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, NULL AS zip_other, rx.ims_id, d.primary_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, NULL AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, NULL AS me_num, d.last_name, d.first_name, d.middle_name, d.address_line1 AS address, d.city, d.state, d.zip, d.address_line2 AS supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, 48 AS bucket_count, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN customer_master.hcp_demo d ON ((rx.tvcmid = d.tvcmid))) WHERE ((rx.market_name = ANY (ARRAY['MULTIPLE SCLEROSIS'::varchar(18), 'PAIN'::varchar(4), 'ANTI-PARKINSON'::varchar(14), 'SMR'::varchar(3), 'WAKE'::varchar(4)])) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (d.file_id = (SELECT max(hcp_demo.file_id) AS file_id FROM customer_master.hcp_demo))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_id, d.primary_specialty, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), d.last_name, d.first_name, d.middle_name, d.address_line1, d.city, d.state, d.zip, d.address_line2, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END, rx.data_date UNION SELECT mkt.market_name, '111'::varchar(3) AS ims_client_num, '55'::varchar(2) AS ims_report_num, NULL AS zip_other, sp.ims_id, d.primary_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pr.ims_product_group_num, NULL AS filler_01, NULL AS me_num, d.last_name, d.first_name, d.middle_name, d.address_line1 AS address, d.city, d.state, d.zip, d.address_line2 AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, sp.ship_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 0) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((((datamart.specialty_pharmacy_shipment sp JOIN integration.ims_week_buckets mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN customer_master.hcp_demo d ON ((sp.tvcmid = d.tvcmid))) JOIN (SELECT bi.entity_id, pb.name AS market_name FROM (product.basket_item bi JOIN product.basket pb ON ((bi.basket_id = pb.basket_id))) WHERE ((pb.basket_type = 'market'::varchar(6)) AND (pb.name = 'MS MARKET'::varchar(9)))) mkt ON ((sp.basket_id = mkt.entity_id))) LEFT JOIN (SELECT sp.entity_id AS basket_id, sp.source_product_code AS ims_product_group_num, sp.source_product_name FROM (metadata.data_feed_metadata dfeed JOIN product.source_product sp ON ((dfeed.feed_id = sp.feed_id))) WHERE ((dfeed.short_name = 'ims_mhj_cnt_m'::varchar(13)) AND (sp.source_client_num = '632'::varchar(3)) AND (sp.source_report_num = '2'::varchar(1)))) pr ON ((sp.basket_id = pr.basket_id))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL) AND (d.file_id = (SELECT max(hcp_demo.file_id) AS file_id FROM customer_master.hcp_demo))) GROUP BY mkt.market_name, sp.ims_id, d.primary_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pr.ims_product_group_num, d.last_name, d.first_name, d.middle_name, d.address_line1, d.city, d.state, d.zip, d.address_line2, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END, sp.ship_date) UNION SELECT mkt.name AS market_name, cm.zip, '111'::varchar(3) AS ims_client_num, '55'::varchar(2) AS ims_report_num, NULL AS zip_other, NULL AS ims_id, NULL AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pr.ims_product_group_num, NULL AS filler_01, NULL AS me_num, NULL AS last_name, NULL AS first_name, NULL AS address, NULL AS city, NULL AS state, NULL AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, mth.month_ending AS data_month, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 0) THEN cm.total_rxs ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.total_rxs ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.total_rxs ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.total_rxs ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.total_rxs ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.total_rxs ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.total_rxs ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.total_rxs ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.total_rxs ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.total_rxs ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.total_rxs ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.total_rxs ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.total_rxs ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.total_rxs ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.total_rxs ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.total_rxs ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.total_rxs ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.total_rxs ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.total_rxs ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.total_rxs ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.total_rxs ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.total_rxs ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.total_rxs ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.total_rxs ELSE NULL::float END) AS trx_024 FROM (((datamart.cmop_rx cm JOIN integration.ims_week_buckets mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT bi.entity_id, pb.name FROM (product.basket_item bi JOIN product.basket pb ON ((bi.basket_id = pb.basket_id))) WHERE ((pb.basket_type = 'market'::varchar(6)) AND (pb.name = ANY (ARRAY['MS MARKET'::varchar(9), 'PD MARKET'::varchar(9)])))) mkt ON ((cm.basket_id = mkt.entity_id))) LEFT JOIN (SELECT sp.entity_id AS basket_id, sp.source_product_code AS ims_product_group_num, sp.source_product_name FROM (metadata.data_feed_metadata dfeed JOIN product.source_product sp ON ((dfeed.feed_id = sp.feed_id))) WHERE ((dfeed.short_name = 'ims_mhj_cnt_m'::varchar(13)) AND (sp.source_client_num = '632'::varchar(3)) AND (sp.source_report_num = '2'::varchar(1)))) pr ON ((cm.basket_id = pr.basket_id))) GROUP BY mkt.name, cm.zip, pr.ims_product_group_num, mth.month_ending;

CREATE  VIEW outbound.zzz_asi_rx_by_market_pain AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '74'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zzz_asi_rx_by_market_wake AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '71'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zzz_asi_rx_by_market_oc AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '757'::varchar(3)) AND (rx.ims_report_number_cnt = '23'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zzz_zs_agile_copay_redemptions AS
 SELECT CASE mod(cd.physician_tvcmid, 1::float) WHEN NULLSEQUAL 0::float THEN cd.physician_tvcmid ELSE cd.physician_tvcmid END AS TVCMID,
        cd.physician_ims_id AS IMS_ID,
        cd.physician_veeva_id AS VEEVA_ACCOUNT_ID,
        p.program_number AS ASI_PROGRAM_NUM,
        p.program_description AS PROGRAM_DESC,
        cd.copay_card_number AS COPAY_CARD_NUM,
        coalesce(cd.physician_zip, cd.pharmacy_zip) AS ZIP_CODE,
        to_char(cd.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        cd.basket_name AS BRAND_NAME,
        replace(cd.basket_name, 'NUVIGIL '::varchar(8), ''::varchar) AS DRUG_DESC,
        (cd.quantity)::int AS QTY
 FROM (datamart.copay cd LEFT  JOIN reference.copay_voucher_program p ON (((cd.program_number = p.program_number) AND (cd.redemption_type = p.redemption_type))))
 WHERE ((cd.basket_name ~~ '%NUVIGIL%'::varchar(9)) AND (cd.fill_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (cd.fill_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.report_frequency = 'WEEK'::varchar(4)) AND (cd.redemption_type = 'COPAY'::varchar(5)))
 GROUP BY CASE mod(cd.physician_tvcmid, 1::float) WHEN NULLSEQUAL 0::float THEN cd.physician_tvcmid ELSE cd.physician_tvcmid END,
          cd.physician_ims_id,
          cd.physician_veeva_id,
          p.program_number,
          p.program_description,
          cd.copay_card_number,
          coalesce(cd.physician_zip, cd.pharmacy_zip),
          to_char(cd.fill_date, 'YYYY-MM-DD'::varchar(10)),
          cd.basket_name,
          replace(cd.basket_name, 'NUVIGIL '::varchar(8), ''::varchar),
          (cd.quantity)::int;

CREATE  VIEW outbound.zzz_zs_agile_samples AS
 SELECT substr(c.territory_vod__c, 1, 2) AS SALES_FORCE_ID,
        c.territory_vod__c AS TERRITORY_NUM,
        pcd.tvcmid AS TVCMID,
        pcd.ims_id AS IMS_ID,
        s.veeva_id AS VEEVA_ACCOUNT_ID,
        to_char(s.ship_date, 'YYYY-MM-DD'::varchar(10)) AS SHIP_DATE,
        b.teva_product_code AS PRODUCT_CODE,
        s.basket_name AS PRODUCT,
        CASE mod(s.ship_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (s.ship_qty)::varchar ELSE rtrim((s.ship_qty)::varchar, '0'::varchar(1)) END AS SHIP_QTY
 FROM (((datamart.sample_shipment s LEFT  JOIN ( SELECT call.name,
        call.territory_vod__c
 FROM veeva.call
 WHERE (substr(call.territory_vod__c, 1, 2) = 'TP'::varchar(2))
 GROUP BY call.name,
          call.territory_vod__c) c ON ((c.name = s.order_id))) LEFT  JOIN datamart.prescriber_combined_demographics pcd ON (((s.veeva_id = pcd.veeva_account_id) AND (pcd.sales_force_id = 'TP'::varchar(2)) AND (pcd.ptr_territory_type <> 'Mirror'::varchar(6))))) JOIN product.basket b ON ((s.basket_id = b.basket_id)))
 WHERE ((s.ship_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (s.ship_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (b.teva_product_code ~~ '100N%'::varchar(5)));

CREATE  VIEW outbound.zzz_zs_agile_details AS
 SELECT c.tvcmid AS TVCMID,
        c.ims_id AS IMS_ID,
        c.veeva_account_id AS VEEVA_ACCOUNT_ID,
        initcap(d.last_name) AS LAST_NAME,
        initcap(d.first_name) AS FIRST_NAME,
        initcap(d.middle_name) AS MIDDLE_NAME,
        d.credentials AS DEGREE,
        d.zip AS ZIP,
        c.rep_id AS REP_ID,
        c.territory_number AS TERRITORY_NUMBER,
        to_char(c.call_date, 'YYYY-MM-DD'::varchar(10)) AS CALL_DATE,
        cd.product AS PRODUCT,
        cd.detail_position AS DETAIL_POSITION
 FROM datamart.sfa_call c, datamart.sfa_call_detail cd, datamart.sfa_demographics d, datamart.current_alignment z
 WHERE ((c.call_id = cd.call_id) AND (c.sales_force_id = 'TC'::varchar(2)) AND (c.sales_force_id = d.sales_force_id) AND (c.territory_number = d.territory_number) AND (c.call_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (c.call_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (c.veeva_account_id = d.veeva_account_id) AND (d.zip = z.zip_code) AND (cd.product = 'NUVIGIL'::varchar(7)))
 GROUP BY c.tvcmid,
          c.ims_id,
          c.veeva_account_id,
          initcap(d.last_name),
          initcap(d.first_name),
          initcap(d.middle_name),
          d.credentials,
          d.zip,
          c.rep_id,
          c.territory_number,
          c.call_date,
          cd.product,
          cd.detail_position;

CREATE  VIEW outbound.zzz_v_asi_plan_name AS
 SELECT plantrak_workbook.payer_plan_number AS payer_plan_num,
        plantrak_workbook.plan_name,
        CASE WHEN (plantrak_workbook.payer_number = '000002'::varchar(6)) THEN plantrak_workbook.plan_name ELSE plantrak_workbook.payer_name END AS payer_name,
        plantrak_workbook.model
 FROM datamart.plantrak_workbook
 ORDER BY plantrak_workbook.payer_plan_number;

CREATE  VIEW outbound.zzz_ddd_category AS
 SELECT ddd_category.category_code AS CATEGORY_CODE,
        ddd_category.category_description AS CATEGORY_DESC,
        ddd_category.category_definition AS CATEGORY_DEFN
 FROM reference.ddd_category
 ORDER BY ddd_category.category_code;

CREATE  VIEW outbound.mcm_hcp_alignment AS
 SELECT cmid.id_num AS federation_id,
        t.territory_name,
        cp.territory_number,
        t.region_name,
        cp.region_number,
        t.area_name,
        cp.area_number,
        (now())::date AS created_date
 FROM ((datamart.call_plan cp JOIN datamart.tvcmid_xref cmid ON (((cp.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN ( SELECT current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.region_name,
        current_alignment.area_name
 FROM datamart.current_alignment
 GROUP BY current_alignment.territory_number,
          current_alignment.territory_name,
          current_alignment.region_name,
          current_alignment.area_name) t ON ((cp.territory_number = t.territory_number)))
 GROUP BY cmid.id_num,
          t.territory_name,
          cp.territory_number,
          t.region_name,
          cp.region_number,
          t.area_name,
          cp.area_number,
          (now())::date;

CREATE  VIEW outbound.mcm_product_segmentation AS
 SELECT cmid.id_num AS federation_id,
        rx.basket_id AS product_id,
        dec1.decile_name AS decile_name_1,
        dec1.decile_trx_count_6_mo AS "6_month_decile_1",
        dec1.decile_trx_count_12_mo AS "12_month_decile_1",
        dec2.decile_name AS decile_name_2,
        dec2.decile_trx_count_6_mo AS "6_month_decile_2",
        dec2.decile_trx_count_12_mo AS "12_month_decile_2",
        dec3.decile_name AS decile_name_3,
        dec3.decile_trx_count_6_mo AS "6_month_decile_3",
        dec3.decile_trx_count_12_mo AS "12_month_decile_3",
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, 0)) AND (rx.date <= rx.data_date)) THEN rx.trx_count ELSE NULL::float END) AS trx_cnt_01_01,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-2))) AND (rx.date <= rx.data_date)) THEN rx.trx_count ELSE NULL::float END) AS trx_cnt_01_03,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-5))) AND (rx.date <= rx.data_date)) THEN rx.trx_count ELSE NULL::float END) AS trx_cnt_01_06,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-11))) AND (rx.date <= rx.data_date)) THEN rx.trx_count ELSE NULL::float END) AS trx_cnt_01_12,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-23))) AND (rx.date <= rx.data_date)) THEN rx.trx_count ELSE NULL::float END) AS trx_cnt_01_24,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, 0)) AND (rx.date <= rx.data_date)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_cnt_01_01,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-2))) AND (rx.date <= rx.data_date)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_cnt_01_03,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-5))) AND (rx.date <= rx.data_date)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_cnt_01_06,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-11))) AND (rx.date <= rx.data_date)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_cnt_01_12,
        sum(CASE WHEN ((rx.date >= add_months(rx.data_date, (-23))) AND (rx.date <= rx.data_date)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_cnt_01_24,
        NULL AS call_plan_target,
        NULL AS call_plan_effective_date,
        NULL AS call_plan_end_date,
        ds.segment_name,
        ds.segment_value,
        NULL AS target_type_indicator,
        (now())::date AS create_date
 FROM ((((((datamart.prescriber_rx rx LEFT  JOIN reference.decile_extract_control dectrl ON ((rx.basket_id = dectrl.basket_id))) JOIN datamart.tvcmid_xref cmid ON (((rx.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN datamart.rx_deciles dec1 ON (((rx.ims_id = dec1.ims_id) AND (rx.basket_id = dec1.basket_id) AND (dectrl.decile_name_1 = dec1.decile_name)))) LEFT  JOIN datamart.rx_deciles dec2 ON (((rx.ims_id = dec2.ims_id) AND (rx.basket_id = dec2.basket_id) AND (dectrl.decile_name_2 = dec2.decile_name)))) LEFT  JOIN datamart.rx_deciles dec3 ON (((rx.ims_id = dec3.ims_id) AND (rx.basket_id = dec3.basket_id) AND (dectrl.decile_name_3 = dec3.decile_name)))) LEFT  JOIN datamart.dynamic_segment ds ON (((cmid.id_num = ds.federation_id) AND (rx.basket_id = ds.basket_id))))
 WHERE (rx.basket_type = 'brand'::varchar(5))
 GROUP BY cmid.id_num,
          rx.basket_id,
          dec1.decile_name,
          dec1.decile_trx_count_6_mo,
          dec1.decile_trx_count_12_mo,
          dec2.decile_name,
          dec2.decile_trx_count_6_mo,
          dec2.decile_trx_count_12_mo,
          dec3.decile_name,
          dec3.decile_trx_count_6_mo,
          dec3.decile_trx_count_12_mo,
          ds.segment_name,
          ds.segment_value,
          (now())::date;

CREATE  VIEW outbound.zzz_tw_specialty_account AS
SELECT tw_account.specialty_pharmacy_data_source AS data_source, tw_account.customer_id AS customer_code, tw_account.customer_name, tw_account.parent_customer_id AS parent_customer_code, tw_account.parent_customer_name, tw_account.customer_type AS customer_type_code, tw_account.pvp_340B_id AS pvp_340b_id, NULL AS start_date, NULL AS end_date, 'Y'::varchar(1) AS active_ind, NULL AS dea_num, NULL AS hin FROM datamart.tw_account;

CREATE  VIEW outbound.zzz_tw_specialty_address AS
SELECT tw_address.specialty_pharmacy_data_source AS data_source, tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code, tw_address.phone, tw_address.fax, tw_address.email, tw_address.tax_id FROM datamart.tw_address;

CREATE  VIEW outbound.zzz_tw_specialty_addr_xref AS
SELECT tw_address_xref.specialty_pharmacy_data_source AS data_source, tw_address_xref.customer_code, tw_address_xref.address_id, tw_address_xref.address_type, NULL AS start_date, NULL AS end_date, 'Y'::varchar(1) AS active_ind FROM datamart.tw_address_xref;

CREATE  VIEW outbound.zzz_ahm_postalcodeterritory AS
 SELECT 'US'::varchar(2) AS "COUNTRY CODE",
        current_alignment.zip_code AS "POSTAL CODE",
        current_alignment.territory_number AS TERRITORY
 FROM datamart.current_alignment
 WHERE (current_alignment.territory_number !~~ '%ZZZZ%'::varchar(6))
 GROUP BY 'US'::varchar(2),
          current_alignment.zip_code,
          current_alignment.territory_number
 ORDER BY current_alignment.territory_number,
          current_alignment.zip_code,
          'US'::varchar(2);

CREATE  VIEW outbound.zzz_activity_voucher_coupon_redemption AS
 SELECT cmid.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(cw.rx_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        coalesce(cw.asi_txn_id, concat((cw.file_id)::varchar, (cw.record_id)::varchar)) AS trackback_id,
        NULL AS previous_activity,
        coalesce((sp.entity_id)::varchar(20), cw.ndc_code) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((('Voucher/Coupon Redemption,'::varchar(26) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cw.program_name, ''::varchar)) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((integration.copay_weekly cw JOIN datamart.tvcmid_xref cmid ON (((cw.tvcmid_physician = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dm ON ((cw.file_id = dm.file_id))) LEFT  JOIN product.source_product sp ON (((cw.ndc_code = sp.source_product_code) AND (dm.feed_id = sp.feed_id) AND (dm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE ((cw.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (cw.rx_date >= add_months((now())::date, (-6)))) EXCEPT  SELECT cmid.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(cw.rx_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        coalesce(cw.asi_txn_id, concat((cw.file_id)::varchar, (cw.record_id)::varchar)) AS trackback_id,
        NULL AS previous_activity,
        coalesce((sp.entity_id)::varchar(20), cw.ndc_code) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((('Voucher/Coupon Redemption,'::varchar(26) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cw.program_name, ''::varchar)) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((integration.copay_weekly cw JOIN datamart.tvcmid_xref cmid ON (((cw.tvcmid_physician = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) JOIN metadata.data_file_metadata dm ON ((cw.file_id = dm.file_id))) LEFT  JOIN product.source_product sp ON (((cw.ndc_code = sp.source_product_code) AND (dm.feed_id = sp.feed_id) AND (dm.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE ((cw.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (cw.rx_date >= add_months((now())::date, (-6))));

CREATE  VIEW outbound.zzz_axiom_product_totals_w AS
 SELECT prescriber_rx.market_name,
        b.teva_product_code AS product_code,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.nrx_count ELSE NULL::float END) AS nrx_cnt24,
        sum(CASE WHEN (mth.month_bucket = 1) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt1,
        sum(CASE WHEN (mth.month_bucket = 2) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt2,
        sum(CASE WHEN (mth.month_bucket = 3) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt3,
        sum(CASE WHEN (mth.month_bucket = 4) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt4,
        sum(CASE WHEN (mth.month_bucket = 5) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt5,
        sum(CASE WHEN (mth.month_bucket = 6) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt6,
        sum(CASE WHEN (mth.month_bucket = 7) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt7,
        sum(CASE WHEN (mth.month_bucket = 8) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt8,
        sum(CASE WHEN (mth.month_bucket = 9) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt9,
        sum(CASE WHEN (mth.month_bucket = 10) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt10,
        sum(CASE WHEN (mth.month_bucket = 11) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt11,
        sum(CASE WHEN (mth.month_bucket = 12) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt12,
        sum(CASE WHEN (mth.month_bucket = 13) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt13,
        sum(CASE WHEN (mth.month_bucket = 14) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt14,
        sum(CASE WHEN (mth.month_bucket = 15) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt15,
        sum(CASE WHEN (mth.month_bucket = 16) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt16,
        sum(CASE WHEN (mth.month_bucket = 17) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt17,
        sum(CASE WHEN (mth.month_bucket = 18) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt18,
        sum(CASE WHEN (mth.month_bucket = 19) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt19,
        sum(CASE WHEN (mth.month_bucket = 20) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt20,
        sum(CASE WHEN (mth.month_bucket = 21) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt21,
        sum(CASE WHEN (mth.month_bucket = 22) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt22,
        sum(CASE WHEN (mth.month_bucket = 23) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt23,
        sum(CASE WHEN (mth.month_bucket = 24) THEN prescriber_rx.trx_count ELSE NULL::float END) AS trx_cnt24
 FROM ((datamart.prescriber_rx prescriber_rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON ((prescriber_rx.rollup_month = mth.month_ending))) LEFT  JOIN product.basket b ON ((prescriber_rx.basket_id = b.basket_id)))
 WHERE ((prescriber_rx.nrx_count IS NOT NULL) AND (mth.month_bucket <= 24) AND (mth.month_bucket >= 1) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY prescriber_rx.market_name,
          b.teva_product_code
 ORDER BY prescriber_rx.market_name,
          b.teva_product_code;

CREATE  VIEW outbound.zzz_ahm_sales_roster AS
 SELECT r.employee_id AS "EMPLOYEE ID",
        r.username AS USERNAME,
        CASE r.last_name WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE r.last_name END AS "LAST NAME",
        CASE r.first_name WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE r.first_name END AS "FIRST NAME",
        btrim(r.middle_name) AS "MIDDLE NAME",
        r.salutation AS SALUTATION,
        btrim(r.suffix) AS SUFFIX,
        r.title AS TITLE,
        r.territory_number AS TERRITORY,
        r.territory_name AS "TERRITORY NAME",
        CASE WHEN (substr(r.parent_territory_number, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (r.parent_territory_number = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (r.parent_territory_number = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE r.parent_territory_number END AS "MANAGER TERRITORY",
        r.team AS TEAM,
        r.business_address_line1 AS "BUSINESS LINE 1 ADDR",
        btrim(r.business_address_line2) AS "BUSINESS LINE 2 ADDR",
        NULL AS "BUSINESS LINE 3 ADDR",
        r.business_city AS "BUSINESS CITY",
        r.business_state AS "BUSINESS STATE",
        r.business_zip AS "BUSINESS POSTAL CODE",
        'US'::varchar(2) AS "BUSINESS COUNTRY CODE",
        r.address_line1 AS "HOME LINE 1 ADDR",
        btrim(r.address_line2) AS "HOME LINE 2 ADDR",
        NULL AS "HOME LINE 3 ADDR",
        r.city AS "HOME CITY",
        r.state AS "HOME STATE",
        r.zip AS "HOME POSTAL CODE",
        'US'::varchar(2) AS "HOME COUNTRY CODE",
        'Business'::varchar(8) AS "CORRESPONDENCE ADDRESS",
        r.business_phone AS "BUSINESS PHONE",
        NULL AS "BUSINESS PHONE EXTENSION",
        r.fax AS "BUSINESS FAX",
        r.voice_mail_extension AS "VOICE MAIL",
        r.mobile_phone AS "MOBILE PHONE",
        r.home_phone AS "HOME PHONE",
        NULL AS "HOME FAX",
        'Business'::varchar(8) AS "CORRESPONDENCE PHONE",
        r.email AS "BUSINESS EMAIL",
        NULL AS "HOME EMAIL",
        'Business'::varchar(8) AS "CORRESPONDENCE EMAIL",
        r.cost_center AS "COST CENTER"
 FROM datamart.roster r
 WHERE ((r.territory_number !~~ '%ZZZZ%'::varchar(6)) AND (((r.team <> 'Teva Clin Nurse Educ'::varchar(20)) AND (r.team <> 'Field Medical Affairs'::varchar(21)) AND (r.team <> 'Clinical Nurse Educator'::varchar(23)) AND (r.team <> 'Market Access'::varchar(13)) AND (r.team <> 'Specialty Pharm Strat'::varchar(21)) AND (r.team <> 'THS Sales'::varchar(9))) OR (r.team IS NULL)))
 GROUP BY r.employee_id,
          r.username,
          CASE r.last_name WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE r.last_name END,
          CASE r.first_name WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE r.first_name END,
          btrim(r.middle_name),
          r.salutation,
          btrim(r.suffix),
          r.title,
          r.territory_number,
          r.territory_name,
          CASE WHEN (substr(r.parent_territory_number, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (r.parent_territory_number = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (r.parent_territory_number = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE r.parent_territory_number END,
          r.team,
          r.business_address_line1,
          btrim(r.business_address_line2),
          NULL,
          r.business_city,
          r.business_state,
          r.business_zip,
          'US'::varchar(2),
          r.address_line1,
          btrim(r.address_line2),
          r.city,
          r.state,
          r.zip,
          'Business'::varchar(8),
          r.business_phone,
          r.fax,
          r.voice_mail_extension,
          r.mobile_phone,
          r.home_phone,
          r.email,
          r.cost_center;

CREATE  VIEW outbound.zzz_touchpoint_call AS
 SELECT tpc.call_id AS ID,
        tpc.call_attempt_id AS AttemptID,
        tpc.touchpoint_id AS TouchpointID,
        tpc.veeva_id AS ClientID,
        tpc.ims_id AS IMSID,
        tpc.first_name AS FirstName,
        tpc.last_name AS LastName,
        tpc.call_type AS Type,
        to_char(tpc.call_date, 'YYYYMMDD'::varchar(8)) AS Date,
        tpc.status_code AS StatusCode,
        tpc.status_description AS StatusDescription,
        tpc.rep_id AS RepID,
        tpc.rep_first_name AS RepFirstName,
        tpc.rep_last_name AS RepLastName
 FROM datamart.touchpoint_call tpc;

CREATE  VIEW outbound.zzz_touchpoint_presentation AS
 SELECT tpp.call_id AS CallID,
        tpp.call_attempt_id AS CallAttemptID,
        tpp.presentation_id AS ID,
        tpp.product AS Product,
        tpp."position" AS "Position",
        tpp.item_type AS ItemType,
        tpp.item_description AS ItemDescription,
        tpp.quantity AS Quantity
 FROM datamart.touchpoint_presentation tpp;

CREATE  VIEW outbound.zzz_dmd_product AS
 SELECT sp.source_product_code,
        'GCSF'::varchar(4) AS market_name,
        prod.brand_name,
        prod.product_name
 FROM (product.source_product sp LEFT  JOIN ( SELECT bm.basket_id AS market_basket_id,
        bm.name AS market_name,
        bb.basket_id AS brand_basket_id,
        bb.name AS brand_name,
        bp.basket_id AS product_basket_id,
        bp.name AS product_name
 FROM ((((product.basket_item bimb JOIN product.basket bm ON (((bimb.basket_id = bm.basket_id) AND (bm.name = 'ONCOLOGY MARKET'::varchar(15)) AND (bm.basket_type = 'market'::varchar(6))))) JOIN product.basket bb ON (((bimb.entity_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5))))) JOIN product.basket_item bibp ON ((bibp.basket_id = bb.basket_id))) JOIN product.basket bp ON (((bibp.entity_id = bp.basket_id) AND (bp.basket_type = 'product'::varchar(7)))))) prod ON (((sp.entity_id = prod.product_basket_id) AND (sp.source_id = 1))))
 WHERE ((prod.brand_name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)])) AND (prod.market_name = 'ONCOLOGY MARKET'::varchar(15)) AND (sp.feed_id = 318))
 GROUP BY sp.source_product_code,
          'GCSF'::varchar(4),
          prod.brand_name,
          prod.product_name;

CREATE  VIEW outbound.zzz_zs_ic_medicaid_plan_groups AS
(( SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.payer_name AS plan_group,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['QNASL 80'::varchar(9), 'QNASL 40'::varchar(9), 'NASONEX'::varchar(9), 'NASACORT'::varchar(9), 'OMNARIS'::varchar(9), 'RHINOCORT'::varchar(9), 'VERAMYST'::varchar(9), 'ZETONNA'::varchar(9)])) AND ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_number = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)]))) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          v.veeva_account_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.payer_name AS plan_group,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['AEROBID'::varchar(20), 'AEROSPAN'::varchar(20), 'ALVESCO'::varchar(20), 'ARNUITY ELLIPTA'::varchar(20), 'ASMANEX HFA MDI'::varchar(20), 'ASMANEX TWISTHALER'::varchar(20), 'AZMACORT'::varchar(20), 'FLOVENT DISK 100'::varchar(20), 'FLOVENT DISK 250'::varchar(20), 'FLOVENT DISK 50'::varchar(20), 'FLOVENT MDI 110'::varchar(20), 'FLOVENT MDI 220'::varchar(20), 'FLOVENT MDI 44'::varchar(20), 'FLOVENT MDI HOSP 110'::varchar(20), 'FLOVENT MDI HOSP 220'::varchar(20), 'FLOVENT MDI HOSP 44'::varchar(20), 'PULMICORT'::varchar(20), 'QVAR 40MCG'::varchar(20), 'QVAR 80MCG'::varchar(20)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          v.veeva_account_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name) UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.payer_name AS plan_group,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['ALL OTHER'::varchar(16), 'FLONASE'::varchar(16), 'FLUTICASONE PROP'::varchar(16), 'NASACORT/AQ/HFA'::varchar(16), 'NASONEX'::varchar(16), 'OMNARIS'::varchar(16), 'RHINOCORT/AQUA'::varchar(16), 'VERAMYST'::varchar(16)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          v.veeva_account_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name) UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.payer_name AS plan_group,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['ALBUTEROL'::varchar(20), 'ALL OTHERS'::varchar(20), 'MAXAIR AUTOHALER MDI'::varchar(20), 'PROAIR HFA'::varchar(20), 'PROAIR HFA COUNTER'::varchar(20), 'PROVENTIL HFA'::varchar(20), 'RELION VENTOLIN HFA'::varchar(20), 'VENTOLIN HFA'::varchar(20), 'XOPENEX HFA'::varchar(20)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          v.veeva_account_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name;

CREATE  VIEW outbound.zzz_zs_ic_mop AS
(( SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payment_method,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['QNASL 80'::varchar(9), 'QNASL 40'::varchar(9), 'NASONEX'::varchar(9), 'NASACORT'::varchar(9), 'OMNARIS'::varchar(9), 'RHINOCORT'::varchar(9), 'VERAMYST'::varchar(9), 'ZETONNA'::varchar(9)])) AND ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_number = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)]))) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          coalesce(v.veeva_account_id, rx.ims_id),
          rx.payment_method,
          rx.basket_name UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payment_method,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['AEROBID'::varchar(20), 'AEROSPAN'::varchar(20), 'ALVESCO'::varchar(20), 'ARNUITY ELLIPTA'::varchar(20), 'ASMANEX HFA MDI'::varchar(20), 'ASMANEX TWISTHALER'::varchar(20), 'AZMACORT'::varchar(20), 'FLOVENT DISK 100'::varchar(20), 'FLOVENT DISK 250'::varchar(20), 'FLOVENT DISK 50'::varchar(20), 'FLOVENT MDI 110'::varchar(20), 'FLOVENT MDI 220'::varchar(20), 'FLOVENT MDI 44'::varchar(20), 'FLOVENT MDI HOSP 110'::varchar(20), 'FLOVENT MDI HOSP 220'::varchar(20), 'FLOVENT MDI HOSP 44'::varchar(20), 'PULMICORT'::varchar(20), 'QVAR 40MCG'::varchar(20), 'QVAR 80MCG'::varchar(20)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          coalesce(v.veeva_account_id, rx.ims_id),
          rx.payment_method,
          rx.basket_name) UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payment_method,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['ALL OTHER'::varchar(16), 'FLONASE'::varchar(16), 'FLUTICASONE PROP'::varchar(16), 'NASACORT/AQ/HFA'::varchar(16), 'NASONEX'::varchar(16), 'OMNARIS'::varchar(16), 'RHINOCORT/AQUA'::varchar(16), 'VERAMYST'::varchar(16)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          coalesce(v.veeva_account_id, rx.ims_id),
          rx.payment_method,
          rx.basket_name) UNION ALL  SELECT rx.ims_id,
        coalesce(v.veeva_account_id, rx.ims_id) AS hcp_id,
        rx.payment_method,
        rx.basket_name AS product,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_mth1,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth2,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth3,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth4,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth5,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth6,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth7,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth8,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth9,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth10,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth11,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth12,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth13,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth14,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth15,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth16,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth17,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth18,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth19,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth20,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth21,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth22,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth23,
        sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_mth24
 FROM (datamart.prescriber_rx rx LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.file_id = ( SELECT max(a.file_id) AS max
 FROM datamart.tvcmid_xref a
 WHERE (a.id_type = 'VEEVA_ID'::varchar(8)))))) v ON ((rx.tvcmid = v.tvcmid)))
 WHERE ((rx.basket_name = ANY (ARRAY['ALBUTEROL'::varchar(20), 'ALL OTHERS'::varchar(20), 'MAXAIR AUTOHALER MDI'::varchar(20), 'PROAIR HFA'::varchar(20), 'PROAIR HFA COUNTER'::varchar(20), 'PROVENTIL HFA'::varchar(20), 'RELION VENTOLIN HFA'::varchar(20), 'VENTOLIN HFA'::varchar(20), 'XOPENEX HFA'::varchar(20)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.date >= add_months(last_day(rx.data_date), (-23))) AND (rx.date <= add_months(last_day(rx.data_date), 0)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          coalesce(v.veeva_account_id, rx.ims_id),
          rx.payment_method,
          rx.basket_name;

CREATE  VIEW outbound.month_rollup_and_bucket AS
 SELECT prescriber_rx.rollup_month AS month_ending,
        rank() OVER (ORDER BY prescriber_rx.rollup_month DESC) AS month_bucket
 FROM datamart.prescriber_rx
 WHERE (prescriber_rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY prescriber_rx.rollup_month;

CREATE  VIEW outbound.zzz_zs_agile_demographics AS
SELECT d.tvcmid AS TVCMID, d.ims_id AS IMS_ID, d.veeva_account_id AS VEEVA_ACCOUNT_ID, d.first_name AS FIRST_NAME, d.middle_name AS MID_NAME, d.last_name AS LAST_NAME, d.degree AS DEGREE, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3) AS ADDRESS, d.ptr_city AS CITY, d.ptr_state AS STATE, d.ptr_zip AS ZIP, d.specialty AS PRIM_SPECIALTY, s1.nuvigil_report_group AS NUVIGIL_REPORT_GROUP, dec1.decile_trx_count_6_mo AS NUVIGIL_DECILE, dec2.decile_trx_count_6_mo AS WAKE_DECILE, s1.amrix_target_flag AS TARGET_FLAG FROM ((((datamart.prescriber_combined_demographics d LEFT JOIN reference.specialty_xref s1 ON ((s1.specialty_code = d.specialty))) LEFT JOIN datamart.rx_deciles dec1 ON (((dec1.ims_id = d.ims_id) AND (upper(dec1.decile_name) = 'NUVIGIL'::varchar(7))))) LEFT JOIN datamart.rx_deciles dec2 ON (((dec2.ims_id = d.ims_id) AND (upper(dec2.decile_name) = 'MODAFINIL'::varchar(9))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx prescriber_rx WHERE ((prescriber_rx.basket_id = 36) AND (prescriber_rx.rollup_month >= add_months(prescriber_rx.data_date, (-24))) AND (prescriber_rx.rollup_month <= add_months(prescriber_rx.data_date, (-1))) AND (upper(prescriber_rx.basket_type) = 'PRODUCT'::varchar(7)) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY prescriber_rx.ims_id UNION SELECT sfa_demographics.ims_id FROM datamart.sfa_demographics WHERE (sfa_demographics.sales_force_id = 'TP'::varchar(2)) GROUP BY sfa_demographics.ims_id) rx ON ((d.ims_id = rx.ims_id))) WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL)) GROUP BY d.tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.middle_name, d.last_name, d.degree, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3), d.ptr_city, d.ptr_state, d.ptr_zip, d.specialty, s1.nuvigil_report_group, dec1.decile_trx_count_6_mo, dec2.decile_trx_count_6_mo, s1.amrix_target_flag;

CREATE  VIEW outbound.zzz_zs_tr_calls_obw AS
 SELECT c.sales_force_id AS SALES_FORCE_ID,
        c.territory_number AS TERRITORY_NUM,
        c.veeva_account_id AS VEEVA_ACCOUNT_ID,
        c.ims_id AS IMS_ID,
        to_char(c.call_date, 'MM/DD/YYYY'::varchar(10)) AS CALL_DATE,
        cd1.product AS FIRST_PRODUCT_DETAILED,
        cd2.product AS SECOND_PRODUCT_DETAILED,
        cd3.product AS THIRD_PRODUCT_DETAILED,
        cd4.product AS FOURTH_PRODUCT_DETAILED,
        s1.product_name AS SAMPLE_NAME,
        s1.sample_ndc AS SAMPLE_NDC,
        s1.qty AS QUANTITY_DROPPED,
        c.call_type AS CALL_TYPE
 FROM (((((datamart.sfa_call c LEFT  JOIN datamart.sfa_call_detail cd1 ON (((c.call_id = cd1.call_id) AND (cd1.detail_position = 1::numeric(18,0))))) LEFT  JOIN datamart.sfa_call_detail cd2 ON (((c.call_id = cd2.call_id) AND (cd2.detail_position = 2::numeric(18,0))))) LEFT  JOIN datamart.sfa_call_detail cd3 ON (((c.call_id = cd3.call_id) AND (cd3.detail_position = 3::numeric(18,0))))) LEFT  JOIN datamart.sfa_call_detail cd4 ON (((c.call_id = cd4.call_id) AND (cd4.detail_position = 4::numeric(18,0))))) LEFT  JOIN datamart.sfa_sample s1 ON (((c.call_id = s1.call_id) AND (s1.basket_name = 'PROAIR'::varchar(6)))))
 WHERE ((c.sales_force_id = 'TR'::varchar(2)) AND (c.call_date > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)) AND (c.call_date <= (trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float)) AND (c.veeva_account_id IN ( SELECT account.id
 FROM veeva.account
 WHERE (account.ispersonaccount = 'true'::varchar(4)))));

CREATE  VIEW outbound.zzz_cmop_product AS
 SELECT sp.source_product_code AS va_product,
        pb.teva_product_code AS prod_code,
        pb.name AS prod_name,
        coalesce(bb.teva_product_code, pb.teva_product_code) AS brand_code,
        coalesce(bb.name, pb.name) AS brand_name,
        mb.teva_product_code AS market_code,
        mb.name AS market_name
 FROM (((((product.source_product sp JOIN product.basket pb ON ((pb.basket_id = sp.entity_id))) LEFT  JOIN datamart.product_basket brand ON (((brand.child_basket_id = pb.basket_id) AND (brand.parent_basket_type = 'brand'::varchar(5))))) LEFT  JOIN product.basket bb ON ((brand.parent_basket_id = bb.basket_id))) LEFT  JOIN datamart.product_basket market ON (((market.child_basket_id = pb.basket_id) AND (market.parent_basket_type = 'market'::varchar(6))))) LEFT  JOIN product.basket mb ON ((market.parent_basket_id = mb.basket_id)))
 WHERE ((sp.feed_id = 305) AND (pb.teva_product_code <> ALL (ARRAY['200102'::varchar(6), '200104'::varchar(6), '200112'::varchar(6), '200116'::varchar(6), 'V00100'::varchar(6)])))
 ORDER BY sp.source_product_code;

CREATE  VIEW outbound.zzz_create_tb_cb_transactions AS
 SELECT c.account_id AS ACCOUNT_ID,
        c.location_id AS LOCATION_ID,
        to_char(c.shipment_date, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE,
        c.ndc_code AS NDC_CODE,
        c.product_name AS PRODUCT_NAME,
        c.contract_id AS CONTRACT_ID,
        CASE mod(c.chargeback_quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.chargeback_quantity)::int)::varchar ELSE rtrim((c.chargeback_quantity)::varchar, '0'::varchar(1)) END AS CHARGEBACK_UNITS,
        CASE mod(c.chargeback_amount, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.chargeback_amount)::int)::varchar ELSE rtrim((c.chargeback_amount)::varchar, '0'::varchar(1)) END AS CHARGEBACK_DOLLARS,
        to_char(c.receipt_date, 'YYYY-MM-DD'::varchar(10)) AS RECEIPT_DATE,
        c.unit_ap AS UNIT_AP,
        c.ap AS AP,
        c.debit_memo_number AS DEBIT_MEMO_NUM,
        to_char(c.credit_memo_date, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS CREDIT_MEMO_DATE,
        c.credit_memo_number AS CREDIT_MEMO_NUM,
        to_char(c.settlement_date, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS SETTLEMENT_DATE,
        CASE mod(c.contract_price, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.contract_price)::int)::varchar ELSE rtrim((c.contract_price)::varchar, '0'::varchar(1)) END AS CONTRACT_PRICE,
        ct.contract_alias AS CONTRACT_ALIAS
 FROM (datamart.chargebacks c JOIN ( SELECT chargeback_demographics.contract_id,
        chargeback_demographics.contract_alias
 FROM datamart.chargeback_demographics
 GROUP BY chargeback_demographics.contract_id,
          chargeback_demographics.contract_alias) ct ON ((c.contract_id = ct.contract_id)))
 WHERE (c.file_id = ( SELECT max(chargebacks.file_id) AS MAX
 FROM datamart.chargebacks));

CREATE  VIEW outbound.v_ob_ahm_customer_credentials AS
 SELECT d.profession_code_shortname AS CredentialCode,
        d.profession_code_fullname AS CredentialName
 FROM reference.Designations d
 GROUP BY d.profession_code_shortname,
          d.profession_code_fullname;

CREATE  VIEW outbound.v_ob_ahm_customer_specialty AS
 SELECT sp.Specialty_Code AS SpecialtyCode,
        sp.Specialty_Description AS SpecialtyName,
        ''::varchar AS SpecialtyGroupName
 FROM reference.specialties sp
 GROUP BY sp.Specialty_Code,
          sp.Specialty_Description,
          ''::varchar;

CREATE  VIEW outbound.zzz_v_asi_pbm_lookup AS
 SELECT pbm_xref.payer_plan_number,
        pbm_xref.pbm_name
 FROM integration.pbm_xref
 GROUP BY pbm_xref.payer_plan_number,
          pbm_xref.pbm_name;

CREATE  VIEW outbound.zzz_asi_rx_by_market_ms_new AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '2'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, rx.ims_zip AS zip_other, sp.ims_id, rx.ims_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, rx.ims_me_num AS me_num, rx.ims_last_name AS last_name, rx.ims_first_name AS first_name, rx.ims_middle_name AS middle_name, rx.ims_address AS address, rx.ims_city AS city, rx.ims_state AS state_code, rx.ims_zip AS zip, NULL AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, to_char(max(mth.month_ending), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM (((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN reference.asi_outbound_ims_product_group_mapping pg ON (((sp.specialty_pharmacy_data_source = pg.data_source) AND (sp.basket_id = pg.basket_id) AND (pg.market_name = 'MS MARKET'::varchar(9))))) LEFT JOIN (SELECT a.ims_last_name, a.ims_first_name, a.ims_middle_name, a.ims_address, a.ims_city, a.ims_state, a.ims_zip, a.ims_client_number, a.ims_me_num, a.ims_id, a.ims_specialty, a.rnk FROM (SELECT axd.ims_last_name, axd.ims_first_name, axd.ims_middle_name, axd.ims_address, axd.ims_city, axd.ims_state, axd.ims_zip, axd.ims_client_number, axd.ims_me_num, axd.ims_id, axd.ims_specialty, row_number() OVER (PARTITION BY axd.ims_id ORDER BY axd.ims_specialty) AS rnk FROM outbound.asi_xponent_demographics axd) a WHERE (a.rnk = 1)) rx ON ((rx.ims_id = sp.ims_id))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (rx.ims_client_number = '632'::varchar(3)) AND (sp.ims_id IS NOT NULL)) GROUP BY pg.market_name, sp.ims_id, rx.ims_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pg.ims_product_group, rx.ims_me_num, rx.ims_last_name, rx.ims_first_name, rx.ims_middle_name, rx.ims_address, rx.ims_city, rx.ims_state, rx.ims_zip, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, (SELECT to_char(x.month_ending, 'MMDDYY'::varchar(7)) AS to_char FROM (SELECT max(ims_week_buckets.month_ending) AS month_ending FROM integration.ims_week_buckets WHERE (ims_week_buckets.full_month = 'Y'::varchar(1))) x) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_024 FROM ((datamart.cmop_rx cm JOIN (SELECT ims_week_buckets.month_ending, ims_week_buckets.month_bucket FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_ending, ims_week_buckets.month_bucket) mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.cmop_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MMDDYY'::varchar(7)) AS to_char FROM (SELECT max(ims_week_buckets.month_ending) AS month_ending FROM integration.ims_week_buckets WHERE (ims_week_buckets.full_month = 'Y'::varchar(1))) x);

CREATE  VIEW outbound.zzz_asi_rx_by_market_pd AS
SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '6'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '6'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MMDDYY'::varchar(6)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_024 FROM ((datamart.cmop_rx cm JOIN outbound.month_rollup_and_bucket mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'PD MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.cmop_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MMDDYY'::varchar(6)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1));

CREATE  VIEW outbound.zzz_asi_market_access_w_tot AS
SELECT asi_market_access_w.report_num, asi_market_access_w.ims_product_group_num AS product_num, asi_market_access_w.data_month, sum(asi_market_access_w.nrx_001) AS total_nrx_01, sum(asi_market_access_w.nrx_002) AS total_nrx_02, sum(asi_market_access_w.nrx_003) AS total_nrx_03, sum(asi_market_access_w.nrx_004) AS total_nrx_04, sum(asi_market_access_w.nrx_005) AS total_nrx_05, sum(asi_market_access_w.nrx_006) AS total_nrx_06, sum(asi_market_access_w.nrx_007) AS total_nrx_07, sum(asi_market_access_w.nrx_008) AS total_nrx_08, sum(asi_market_access_w.nrx_009) AS total_nrx_09, sum(asi_market_access_w.nrx_010) AS total_nrx_10, sum(asi_market_access_w.nrx_011) AS total_nrx_11, sum(asi_market_access_w.nrx_012) AS total_nrx_12, sum(asi_market_access_w.nrx_013) AS total_nrx_13, sum(asi_market_access_w.nrx_014) AS total_nrx_14, sum(asi_market_access_w.nrx_015) AS total_nrx_15, sum(asi_market_access_w.nrx_016) AS total_nrx_16, sum(asi_market_access_w.nrx_017) AS total_nrx_17, sum(asi_market_access_w.nrx_018) AS total_nrx_18, sum(asi_market_access_w.nrx_019) AS total_nrx_19, sum(asi_market_access_w.nrx_020) AS total_nrx_20, sum(asi_market_access_w.nrx_021) AS total_nrx_21, sum(asi_market_access_w.nrx_022) AS total_nrx_22, sum(asi_market_access_w.nrx_023) AS total_nrx_23, sum(asi_market_access_w.nrx_024) AS total_nrx_24, sum(asi_market_access_w.trx_001) AS total_trx_01, sum(asi_market_access_w.trx_002) AS total_trx_02, sum(asi_market_access_w.trx_003) AS total_trx_03, sum(asi_market_access_w.trx_004) AS total_trx_04, sum(asi_market_access_w.trx_005) AS total_trx_05, sum(asi_market_access_w.trx_006) AS total_trx_06, sum(asi_market_access_w.trx_007) AS total_trx_07, sum(asi_market_access_w.trx_008) AS total_trx_08, sum(asi_market_access_w.trx_009) AS total_trx_09, sum(asi_market_access_w.trx_010) AS total_trx_10, sum(asi_market_access_w.trx_011) AS total_trx_11, sum(asi_market_access_w.trx_012) AS total_trx_12, sum(asi_market_access_w.trx_013) AS total_trx_13, sum(asi_market_access_w.trx_014) AS total_trx_14, sum(asi_market_access_w.trx_015) AS total_trx_15, sum(asi_market_access_w.trx_016) AS total_trx_16, sum(asi_market_access_w.trx_017) AS total_trx_17, sum(asi_market_access_w.trx_018) AS total_trx_18, sum(asi_market_access_w.trx_019) AS total_trx_19, sum(asi_market_access_w.trx_020) AS total_trx_20, sum(asi_market_access_w.trx_021) AS total_trx_21, sum(asi_market_access_w.trx_022) AS total_trx_22, sum(asi_market_access_w.trx_023) AS total_trx_23, sum(asi_market_access_w.trx_024) AS total_trx_24 FROM outbound.asi_market_access_w GROUP BY asi_market_access_w.report_num, asi_market_access_w.ims_product_group_num, asi_market_access_w.data_month;

CREATE  VIEW outbound.zzz_asi_market_access_m_tot AS
SELECT asi_market_access_m.report_num, asi_market_access_m.ims_product_group_num AS product_num, asi_market_access_m.data_month, sum(asi_market_access_m.nrx_001) AS total_nrx_01, sum(asi_market_access_m.nrx_002) AS total_nrx_02, sum(asi_market_access_m.nrx_003) AS total_nrx_03, sum(asi_market_access_m.nrx_004) AS total_nrx_04, sum(asi_market_access_m.nrx_005) AS total_nrx_05, sum(asi_market_access_m.nrx_006) AS total_nrx_06, sum(asi_market_access_m.nrx_007) AS total_nrx_07, sum(asi_market_access_m.nrx_008) AS total_nrx_08, sum(asi_market_access_m.nrx_009) AS total_nrx_09, sum(asi_market_access_m.nrx_010) AS total_nrx_10, sum(asi_market_access_m.nrx_011) AS total_nrx_11, sum(asi_market_access_m.nrx_012) AS total_nrx_12, sum(asi_market_access_m.nrx_013) AS total_nrx_13, sum(asi_market_access_m.nrx_014) AS total_nrx_14, sum(asi_market_access_m.nrx_015) AS total_nrx_15, sum(asi_market_access_m.nrx_016) AS total_nrx_16, sum(asi_market_access_m.nrx_017) AS total_nrx_17, sum(asi_market_access_m.nrx_018) AS total_nrx_18, sum(asi_market_access_m.nrx_019) AS total_nrx_19, sum(asi_market_access_m.nrx_020) AS total_nrx_20, sum(asi_market_access_m.nrx_021) AS total_nrx_21, sum(asi_market_access_m.nrx_022) AS total_nrx_22, sum(asi_market_access_m.nrx_023) AS total_nrx_23, sum(asi_market_access_m.nrx_024) AS total_nrx_24, sum(asi_market_access_m.trx_001) AS total_trx_01, sum(asi_market_access_m.trx_002) AS total_trx_02, sum(asi_market_access_m.trx_003) AS total_trx_03, sum(asi_market_access_m.trx_004) AS total_trx_04, sum(asi_market_access_m.trx_005) AS total_trx_05, sum(asi_market_access_m.trx_006) AS total_trx_06, sum(asi_market_access_m.trx_007) AS total_trx_07, sum(asi_market_access_m.trx_008) AS total_trx_08, sum(asi_market_access_m.trx_009) AS total_trx_09, sum(asi_market_access_m.trx_010) AS total_trx_10, sum(asi_market_access_m.trx_011) AS total_trx_11, sum(asi_market_access_m.trx_012) AS total_trx_12, sum(asi_market_access_m.trx_013) AS total_trx_13, sum(asi_market_access_m.trx_014) AS total_trx_14, sum(asi_market_access_m.trx_015) AS total_trx_15, sum(asi_market_access_m.trx_016) AS total_trx_16, sum(asi_market_access_m.trx_017) AS total_trx_17, sum(asi_market_access_m.trx_018) AS total_trx_18, sum(asi_market_access_m.trx_019) AS total_trx_19, sum(asi_market_access_m.trx_020) AS total_trx_20, sum(asi_market_access_m.trx_021) AS total_trx_21, sum(asi_market_access_m.trx_022) AS total_trx_22, sum(asi_market_access_m.trx_023) AS total_trx_23, sum(asi_market_access_m.trx_024) AS total_trx_24 FROM outbound.asi_market_access_m GROUP BY asi_market_access_m.report_num, asi_market_access_m.ims_product_group_num, asi_market_access_m.data_month;

CREATE  VIEW outbound.zzz_ics_medicaidplangroups AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        coalesce(a.veeva_account_id, rx.ims_id) AS HCP_ID,
        rx.payer_plan_number AS PLAN_CODE,
        rx.plan_name AS PLAN_NAME,
        rx.model AS MODEL,
        rx.payer_name AS PLAN_GROUP,
        CASE WHEN (rx.basket_name ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (rx.basket_name ~~ 'FLOVENT%'::varchar(8)) THEN 'FLOVENT'::varchar(7) ELSE rx.basket_name END AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code = ANY (ARRAY['330-13-010'::varchar(10), '330-13-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-008'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-13-017'::varchar(10)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          coalesce(a.veeva_account_id, rx.ims_id),
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          CASE WHEN (rx.basket_name ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (rx.basket_name ~~ 'FLOVENT%'::varchar(8)) THEN 'FLOVENT'::varchar(7) ELSE rx.basket_name END;

CREATE  VIEW outbound.zzz_nasal_medicaidplangroups AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        coalesce(a.veeva_account_id, rx.ims_id) AS HCP_ID,
        rx.payer_plan_number AS PLAN_CODE,
        rx.plan_name AS PLAN_NAME,
        rx.model AS MODEL,
        rx.payer_name AS PLAN_GROUP,
        rx.basket_name AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          coalesce(a.veeva_account_id, rx.ims_id),
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name;

CREATE  VIEW outbound.zzz_nasal_mop AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END AS HCP_ID,
        rx.payment_method AS PAYMENT_METHOD,
        rx.basket_name AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        NULL::float,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND ((length(rx.ims_id) = 7) OR ((length(rx.ims_id) <> 7) AND (rx.basket_name = ANY (ARRAY['NASONEX'::varchar(7), 'OMNARIS'::varchar(7)])))))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          NULL::float,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week UNION ALL  SELECT prescriber_rx.ims_id,
        prescriber_rx.payer_plan_number,
        prescriber_rx.plan_name,
        prescriber_rx.model,
        prescriber_rx.payer_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_month,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_count,
        prescriber_rx.tvcmid,
        prescriber_rx.payment_method,
        prescriber_rx.rollup_week
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.basket_type = 'product'::varchar(7)) AND (prescriber_rx.basket_name <> ALL (ARRAY['NASONEX'::varchar(7), 'OMNARIS'::varchar(7)])) AND (length(prescriber_rx.ims_id) <> 7))) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END,
          rx.payment_method,
          rx.basket_name;

CREATE  VIEW outbound.zzz_paytype AS
 SELECT rx.model AS MODEL,
        rx.payment_method AS PAYMENT_METHOD
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((length(rx.ims_id) = 7) AND (rx.basket_type = 'product'::varchar(7)) AND (b.teva_product_code = ANY (ARRAY['330-12-002'::varchar(11), '330-12-003'::varchar(11), '330-12-015'::varchar(11), '330-12-019'::varchar(11), '330-12-023'::varchar(11), '330-13-005'::varchar(11), '330-13-006'::varchar(11), '330-13-009'::varchar(11), '330-13-011'::varchar(11), '330-13-016'::varchar(11), '330-13-020'::varchar(11), '330-13-021'::varchar(11), '330-13-022'::varchar(11), '330-13-023'::varchar(11), '330-13-024'::varchar(11), '330-13-025'::varchar(11), '330-13-026'::varchar(11), '330-13-027'::varchar(11), '330-13-028'::varchar(11), '330-13-029'::varchar(11), '330-13-030'::varchar(11), '330-14-001'::varchar(11), '330-14-0025'::varchar(11), '330-14-003'::varchar(11), '330-14-004'::varchar(11), '330-14-005'::varchar(11), '330-14-006'::varchar(11), '330-14-007'::varchar(11), '330-14-008'::varchar(11), '330-14-009'::varchar(11), '330-15-001'::varchar(11), '330-15-005'::varchar(11), '330-15-010'::varchar(11), '330-15-015'::varchar(11), '330-15-019'::varchar(11), '330-15-025'::varchar(11), '330-15-030'::varchar(11), '330-15-040'::varchar(11), '330-15-047'::varchar(11), '330-15-050'::varchar(11), '330-16-020'::varchar(11), '330-16-027'::varchar(11), '330-16-028'::varchar(11), '330-16-029'::varchar(11), '330-16-050'::varchar(11), '330-16-055'::varchar(11), '330-16-056'::varchar(11)])))
 GROUP BY rx.model,
          rx.payment_method;

CREATE  VIEW outbound.zzz_planname AS
 SELECT rx.payer_plan_number AS PAYER_PLAN_NUM,
        rx.plan_name AS PLAN_NAME,
        rx.model AS MODEL,
        rx.payer_name AS PAYER_NAME
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((length(rx.ims_id) = 7) AND (b.teva_product_code = ANY (ARRAY['330-14-001'::varchar(11), '330-14-007'::varchar(11), '330-14-009'::varchar(11), '330-14-0025'::varchar(11), '330-16-050'::varchar(11), '330-14-003'::varchar(11), '330-14-008'::varchar(11), '330-16-055'::varchar(11), '330-14-004'::varchar(11), '330-16-056'::varchar(11), '330-14-006'::varchar(11), '330-15-050'::varchar(11), '330-14-005'::varchar(11), '330-15-005'::varchar(11), '330-12-002'::varchar(11), '330-15-010'::varchar(11), '330-15-019'::varchar(11), '330-12-015'::varchar(11), '330-15-015'::varchar(11), '330-12-003'::varchar(11), '330-15-025'::varchar(11), '330-12-023'::varchar(11), '330-15-030'::varchar(11), '330-12-019'::varchar(11), '330-15-047'::varchar(11), '330-15-050'::varchar(11), '330-13-020'::varchar(11), '330-16-020'::varchar(11), '330-13-021'::varchar(11), '330-13-016'::varchar(11), '330-13-022'::varchar(11), '330-13-023'::varchar(11), '330-13-024'::varchar(11), '330-13-025'::varchar(11), '330-13-026'::varchar(11), '330-13-027'::varchar(11), '330-13-028'::varchar(11), '330-13-029'::varchar(11), '330-13-030'::varchar(11), '330-16-027'::varchar(11), '330-16-028'::varchar(11), '330-16-029'::varchar(11), '330-13-009'::varchar(11), '330-13-005'::varchar(11), '330-13-006'::varchar(11), '330-13-011'::varchar(11), '330-15-019'::varchar(11), '330-12-015'::varchar(11), '330-15-015'::varchar(11), '330-12-003'::varchar(11), '330-15-025'::varchar(11), '330-12-023'::varchar(11), '330-15-001'::varchar(11), '330-15-030'::varchar(11), '330-12-019'::varchar(11), '330-15-047'::varchar(11), '330-15-040'::varchar(11)])))
 GROUP BY rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name;

CREATE  VIEW outbound.zzz_saba_medicaidplangroups AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        coalesce(a.veeva_account_id, rx.ims_id) AS HCP_ID,
        rx.payer_plan_number AS PLAN_CODE,
        rx.plan_name AS PLAN_NAME,
        rx.model AS MODEL,
        rx.payer_name AS PLAN_GROUP,
        CASE WHEN (rx.basket_name ~~ 'PROAIR HFA%'::varchar(11)) THEN 'PROAIR'::varchar(6) ELSE rx.basket_name END AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10), '330-14-010'::varchar(10)])) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10)) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          coalesce(a.veeva_account_id, rx.ims_id),
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          CASE WHEN (rx.basket_name ~~ 'PROAIR HFA%'::varchar(11)) THEN 'PROAIR'::varchar(6) ELSE rx.basket_name END;

CREATE  VIEW outbound.zzz_saba_mop AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END AS HCP_ID,
        rx.payment_method AS PAYMENT_METHOD,
        CASE WHEN (rx.basket_name ~~ 'PROAIR HFA%'::varchar(11)) THEN 'PROAIR'::varchar(6) ELSE rx.basket_name END AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        rx.nrx_count,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE (rx.basket_type = 'product'::varchar(7))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          rx.nrx_count,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10), '330-14-010'::varchar(10)])) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END,
          rx.payment_method,
          CASE WHEN (rx.basket_name ~~ 'PROAIR HFA%'::varchar(11)) THEN 'PROAIR'::varchar(6) ELSE rx.basket_name END;

CREATE  VIEW outbound.zzz_zs_agile_rx AS
 SELECT rx.ims_id AS IMS_ID,
        b.teva_product_code AS PRODUCT_CODE,
        rx.basket_name AS PRODUCT_NAME,
        rx.rollup_month AS MONTH_ENDING,
        sum(CASE mod(rx.nrx_quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((rx.nrx_quantity)::int)::varchar ELSE rtrim((rx.nrx_quantity)::varchar, '0'::varchar(1)) END) AS NRX_QTY,
        sum(CASE mod(rx.trx_quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((rx.trx_quantity)::int)::varchar ELSE rtrim((rx.trx_quantity)::varchar, '0'::varchar(1)) END) AS TRX_QTY,
        sum(CASE mod(rx.unnormalized_nrx_count, 1::float) WHEN NULLSEQUAL 0::float THEN ((rx.unnormalized_nrx_count)::int)::varchar ELSE rtrim((rx.unnormalized_nrx_count)::varchar, '0'::varchar(1)) END) AS NRX_CNT,
        sum(CASE mod(rx.unnormalized_trx_count, 1::float) WHEN NULLSEQUAL 0::float THEN ((rx.unnormalized_trx_count)::int)::varchar ELSE rtrim((rx.unnormalized_trx_count)::varchar, '0'::varchar(1)) END) AS TRX_CNT
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) LEFT  JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((rx.rollup_month >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (rx.rollup_month <= last_day(add_months((statement_timestamp())::timestamp, (-2)))) AND (((b.teva_product_code = ANY (ARRAY['100120'::varchar(6), '100N25'::varchar(6), '100N15'::varchar(6), '100101'::varchar(6), '100N20'::varchar(6), '100102'::varchar(6), '100N05'::varchar(6)])) AND (rx.basket_type = 'product'::varchar(7))) OR ((b.teva_product_code = ANY (ARRAY['100100'::varchar(6), '100N00'::varchar(6)])) AND (rx.basket_type = 'brand'::varchar(5))) OR ((b.teva_product_code = ANY (ARRAY['100700'::varchar(6)])) AND (rx.basket_type = 'submarket'::varchar(9)))) AND (length(rx.ims_id) = 7) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.ims_id,
          b.teva_product_code,
          rx.basket_name,
          rx.rollup_month;

CREATE  VIEW outbound.zzz_amrix_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_amrix_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW teva_ingestion.EXT_PSR_REPORT AS
 SELECT btrim(EXT_PSR_REPORT_src.prescriber_npi) AS prescriber_npi,
        btrim(EXT_PSR_REPORT_src.prescriber_name) AS prescriber_name,
        btrim(EXT_PSR_REPORT_src.prescriber_state) AS prescriber_state,
        btrim(EXT_PSR_REPORT_src.product) AS product,
        btrim(EXT_PSR_REPORT_src.month) AS month,
        btrim(EXT_PSR_REPORT_src.indication) AS indication,
        CASE WHEN (EXT_PSR_REPORT_src.in_progress = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PSR_REPORT_src.in_progress))::int END AS in_progress,
        CASE WHEN (EXT_PSR_REPORT_src.completed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PSR_REPORT_src.completed))::int END AS completed,
        CASE WHEN (EXT_PSR_REPORT_src.cancelled = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PSR_REPORT_src.cancelled))::int END AS cancelled,
        CASE WHEN (EXT_PSR_REPORT_src.psr_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PSR_REPORT_src.psr_count))::int END AS psr_count,
        EXT_PSR_REPORT_src.batch_id,
        EXT_PSR_REPORT_src.row_id,
        EXT_PSR_REPORT_src.update_ts
 FROM teva_ingestion.EXT_PSR_REPORT_src;

CREATE  VIEW raw.ext_psr_report AS
 SELECT src.prescriber_npi,
        src.prescriber_name,
        src.prescriber_state,
        src.product,
        src.month,
        src.indication,
        src.in_progress,
        src.completed,
        src.cancelled,
        src.psr_count,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PSR_REPORT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PSR_REPORT'::varchar(14)))));

CREATE  VIEW teva_ingestion.EXT_IMS_SD809_TRANSACTION AS
 SELECT CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.patient_yob = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.patient_yob))::int END AS patient_yob,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.patient_gender = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.patient_gender))::int END AS patient_gender,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_surrogate_patient_id) AS ims_surrogate_patient_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.product_ndc) AS product_ndc,
        btrim(EXT_IMS_SD809_TRANSACTION_src.product_name) AS product_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.product_strength) AS product_strength,
        btrim(EXT_IMS_SD809_TRANSACTION_src.unit_of_measure) AS unit_of_measure,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.extended_wac_price = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.extended_wac_price))::numeric(37,2) END AS extended_wac_price,
        btrim(EXT_IMS_SD809_TRANSACTION_src.transaction_id) AS transaction_id,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.patient_status_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.patient_status_date))::date END AS patient_status_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.patient_status_) AS patient_status_,
        btrim(EXT_IMS_SD809_TRANSACTION_src.patient_sub_status) AS patient_sub_status,
        btrim(EXT_IMS_SD809_TRANSACTION_src.specialty_pharmacy_patient_or_case_id) AS specialty_pharmacy_patient_or_case_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_icd_9) AS primary_icd_9,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_icd_10) AS primary_icd_10,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.script_reciept_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.script_reciept_date))::date END AS script_reciept_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_appeal_status) AS primary_appeal_status,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_copay_type) AS primary_copay_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_deductible) AS primary_deductible,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_pa_required) AS primary_pa_required,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.primary_copay_amount = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.primary_copay_amount))::numeric(37,2) END AS primary_copay_amount,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_payer_name) AS primary_payer_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_plan_name) AS primary_plan_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_payer_type) AS primary_payer_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_plan_type) AS primary_plan_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_payer_reject_reason_code) AS primary_payer_reject_reason_code,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_reimbursement_status) AS primary_reimbursement_status,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.primary_reimbursement_status_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.primary_reimbursement_status_date))::date END AS primary_reimbursement_status_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_step_therapy_required) AS primary_step_therapy_required,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_copay_type) AS secondary_copay_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_deductible) AS secondary_deductible,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_pa_required) AS secondary_pa_required,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.secondary_copay_amount = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_copay_amount))::numeric(37,2) END AS secondary_copay_amount,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_payer_name) AS secondary_payer_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_plan_name) AS secondary_plan_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_payer_type) AS secondary_payer_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_plan_type) AS secondary_plan_type,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_payer_reject_reason_code) AS secondary_payer_reject_reason_code,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_step_therapy_required) AS secondary_step_therapy_required,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ncpdp_number) AS ncpdp_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.pharmacy_zip) AS pharmacy_zip,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_first_name) AS prescribing_physician_first_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_last_name) AS prescribing_physician_last_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_middle_initial) AS prescribing_physician_middle_initial,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_dea_number) AS prescribing_physician_dea_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_me_number) AS prescribing_physician_me_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_npi_number) AS prescribing_physician_npi_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_address_1) AS prescribing_physician_address_1,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_address_2) AS prescribing_physician_address_2,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_city) AS prescribing_physician_city,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_state) AS prescribing_physician_state,
        btrim(EXT_IMS_SD809_TRANSACTION_src.prescribing_physician_zip) AS prescribing_physician_zip,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.number_of_fills_prescribed = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.number_of_fills_prescribed))::numeric(37,2) END AS number_of_fills_prescribed,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.number_of_refills_remaining = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.number_of_refills_remaining))::numeric(37,2) END AS number_of_refills_remaining,
        btrim(EXT_IMS_SD809_TRANSACTION_src.fill_type) AS fill_type,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.rx_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.rx_date))::date END AS rx_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.rx_number) AS rx_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.carrier) AS carrier,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.date_of_drug_receipt = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.date_of_drug_receipt))::date END AS date_of_drug_receipt,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.initial_ship_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.initial_ship_date))::date END AS initial_ship_date,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.quantity_shipped = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.quantity_shipped))::numeric(37,2) END AS quantity_shipped,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.out_of_pocket_cost = ''::varchar) THEN NULL::numeric(37,2) ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.out_of_pocket_cost))::numeric(37,2) END AS out_of_pocket_cost,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.shipment_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.shipment_date))::date END AS shipment_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.product_lot_number) AS product_lot_number,
        btrim(EXT_IMS_SD809_TRANSACTION_src.program_dispense_type) AS program_dispense_type,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.days_supply_dispensed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.days_supply_dispensed))::int END AS days_supply_dispensed,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_payer_pa_outcome) AS primary_payer_pa_outcome,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_payer_pa_outcome) AS secondary_payer_pa_outcome,
        btrim(EXT_IMS_SD809_TRANSACTION_src.rx_communication_method) AS rx_communication_method,
        btrim(EXT_IMS_SD809_TRANSACTION_src.tertiary_icd_10) AS tertiary_icd_10,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_file_id) AS ims_file_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_transaction_id) AS ims_transaction_id,
        CASE WHEN (EXT_IMS_SD809_TRANSACTION_src.ims_cycle_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_SD809_TRANSACTION_src.ims_cycle_date))::date END AS ims_cycle_date,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_supplier_id) AS ims_supplier_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_supplier_name) AS ims_supplier_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_transaction_type_code) AS ims_transaction_type_code,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_duplicate_transaction) AS ims_duplicate_transaction,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_prescriber_id) AS ims_prescriber_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_first_name) AS ims_phys_first_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_last_name) AS ims_phys_last_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_address) AS ims_phys_address,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_city) AS ims_phys_city,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_state) AS ims_phys_state,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_zip) AS ims_phys_zip,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_phys_specialty) AS ims_phys_specialty,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_product_id) AS ims_product_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_product_description) AS ims_product_description,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_id) AS ims_outlet_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_name) AS ims_outlet_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_address) AS ims_outlet_address,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_city) AS ims_outlet_city,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_state) AS ims_outlet_state,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_zip) AS ims_outlet_zip,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_outlet_subcategory) AS ims_outlet_subcategory,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_plan_id) AS ims_plan_id,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_plan_name) AS ims_plan_name,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_plan_model) AS ims_plan_model,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_icd10_grouping) AS primary_icd10_grouping,
        btrim(EXT_IMS_SD809_TRANSACTION_src.primary_icd10_grouping_reason_code) AS primary_icd10_grouping_reason_code,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_icd10_grouping) AS secondary_icd10_grouping,
        btrim(EXT_IMS_SD809_TRANSACTION_src.secondary_icd10_grouping_reason_code) AS secondary_icd10_grouping_reason_code,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_ndc_flag) AS ims_ndc_flag,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_dispensed_date_flag) AS ims_dispensed_date_flag,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_dispensed_quantity_flag) AS ims_dispensed_quantity_flag,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_cost_flag) AS ims_cost_flag,
        btrim(EXT_IMS_SD809_TRANSACTION_src.ims_overall_flag) AS ims_overall_flag,
        EXT_IMS_SD809_TRANSACTION_src.batch_id,
        EXT_IMS_SD809_TRANSACTION_src.row_id,
        EXT_IMS_SD809_TRANSACTION_src.update_ts
 FROM teva_ingestion.EXT_IMS_SD809_TRANSACTION_src;

CREATE  VIEW raw.ext_ims_sd809_transaction AS
 SELECT src.patient_yob,
        src.patient_gender,
        src.ims_surrogate_patient_id,
        src.product_ndc,
        src.product_name,
        src.product_strength,
        src.unit_of_measure,
        src.extended_wac_price,
        src.transaction_id,
        src.patient_status_date,
        src.patient_status_,
        src.patient_sub_status,
        src.specialty_pharmacy_patient_or_case_id,
        src.primary_icd_9,
        src.primary_icd_10,
        src.script_reciept_date,
        src.primary_appeal_status,
        src.primary_copay_type,
        src.primary_deductible,
        src.primary_pa_required,
        src.primary_copay_amount,
        src.primary_payer_name,
        src.primary_plan_name,
        src.primary_payer_type,
        src.primary_plan_type,
        src.primary_payer_reject_reason_code,
        src.primary_reimbursement_status,
        src.primary_reimbursement_status_date,
        src.primary_step_therapy_required,
        src.secondary_copay_type,
        src.secondary_deductible,
        src.secondary_pa_required,
        src.secondary_copay_amount,
        src.secondary_payer_name,
        src.secondary_plan_name,
        src.secondary_payer_type,
        src.secondary_plan_type,
        src.secondary_payer_reject_reason_code,
        src.secondary_step_therapy_required,
        src.ncpdp_number,
        src.pharmacy_name,
        src.pharmacy_zip,
        src.prescribing_physician_first_name,
        src.prescribing_physician_last_name,
        src.prescribing_physician_middle_initial,
        src.prescribing_physician_dea_number,
        src.prescribing_physician_me_number,
        src.prescribing_physician_npi_number,
        src.prescribing_physician_address_1,
        src.prescribing_physician_address_2,
        src.prescribing_physician_city,
        src.prescribing_physician_state,
        src.prescribing_physician_zip,
        src.number_of_fills_prescribed,
        src.number_of_refills_remaining,
        src.fill_type,
        src.rx_date,
        src.rx_number,
        src.carrier,
        src.date_of_drug_receipt,
        src.initial_ship_date,
        src.quantity_shipped,
        src.out_of_pocket_cost,
        src.shipment_date,
        src.product_lot_number,
        src.program_dispense_type,
        src.days_supply_dispensed,
        src.primary_payer_pa_outcome,
        src.secondary_payer_pa_outcome,
        src.rx_communication_method,
        src.tertiary_icd_10,
        src.ims_file_id,
        src.ims_transaction_id,
        src.ims_cycle_date,
        src.ims_supplier_id,
        src.ims_supplier_name,
        src.ims_transaction_type_code,
        src.ims_duplicate_transaction,
        src.ims_prescriber_id,
        src.ims_phys_first_name,
        src.ims_phys_last_name,
        src.ims_phys_address,
        src.ims_phys_city,
        src.ims_phys_state,
        src.ims_phys_zip,
        src.ims_phys_specialty,
        src.ims_product_id,
        src.ims_product_description,
        src.ims_outlet_id,
        src.ims_outlet_name,
        src.ims_outlet_address,
        src.ims_outlet_city,
        src.ims_outlet_state,
        src.ims_outlet_zip,
        src.ims_outlet_subcategory,
        src.ims_plan_id,
        src.ims_plan_name,
        src.ims_plan_model,
        src.primary_icd10_grouping,
        src.primary_icd10_grouping_reason_code,
        src.secondary_icd10_grouping,
        src.secondary_icd10_grouping_reason_code,
        src.ims_ndc_flag,
        src.ims_dispensed_date_flag,
        src.ims_dispensed_quantity_flag,
        src.ims_cost_flag,
        src.ims_overall_flag,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_SD809_TRANSACTION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_SD809_TRANSACTION'::varchar(25)))));

CREATE  VIEW outbound.v_ob_ahm_customer_individual AS
 SELECT cm.tvcmid AS CustomerId,
        coalesce(cm.first_name, ''::varchar) AS FirstName,
        coalesce(cm.last_name, ''::varchar) AS LastName,
        coalesce(cm.middle_name, ''::varchar) AS MiddleName,
        ''::varchar AS Salutation,
        coalesce(cm.suffix, ''::varchar) AS PersonalSuffix,
        cm.sub_type_name AS CustomerType,
        CASE WHEN (cm.teva_specialty_code = 'NRP'::varchar(3)) THEN 'NP'::varchar(2) ELSE d.profession_code_shortname END AS ProfessionalDesignation,
        coalesce(cm.teva_specialty_code, ''::varchar) AS PrimarySpecialtyCode,
        ''::varchar AS SecondarySpecialtyCode,
        ''::varchar AS GovernmentEmployeeIndicator,
        ''::varchar AS TaxId,
        ''::varchar AS TaxIdType,
        ''::varchar AS BusinessEmail,
        ''::varchar AS BusinessPhone,
        ''::varchar AS BusinessFax,
        ''::varchar AS MobilePhone,
        ''::varchar AS HomePhone,
        'US'::varchar(2) AS RegionId,
        CASE WHEN (cm.healthcare_professional_status_code = 'A'::varchar(1)) THEN 'Active'::varchar(6) WHEN (cm.healthcare_professional_status_code <> 'A'::varchar(1)) THEN 'Inactive'::varchar(8) ELSE ''::varchar END AS Status
 FROM ((mdm.hcp cm LEFT  JOIN ( SELECT Desig.tvcmid,
        Desig.profession_code,
        Desig.rownum
 FROM ( SELECT DISTINCT professional.tvcmid,
        professional.profession_code,
        row_number() OVER (PARTITION BY professional.tvcmid ORDER BY professional.profession_rank, professional.updated_date DESC NULLS LAST, professional.profession_code) AS rownum
 FROM mdm.professional
 ORDER BY professional.tvcmid,
          professional.profession_code,
          row_number() OVER (PARTITION BY professional.tvcmid ORDER BY professional.profession_rank, professional.updated_date DESC NULLS LAST, professional.profession_code)) Desig
 WHERE (Desig.rownum = 1)) prof ON ((cm.tvcmid = prof.tvcmid))) JOIN reference.Designations d ON ((d.profession_code = prof.profession_code)))
 WHERE ((cm.tvcmid IS NOT NULL) AND (cm.file_id IN ( SELECT max(hcp.file_id) AS max
 FROM mdm.hcp)))
 GROUP BY cm.tvcmid,
          coalesce(cm.first_name, ''::varchar),
          coalesce(cm.last_name, ''::varchar),
          coalesce(cm.middle_name, ''::varchar),
          ''::varchar,
          coalesce(cm.suffix, ''::varchar),
          cm.sub_type_name,
          CASE WHEN (cm.teva_specialty_code = 'NRP'::varchar(3)) THEN 'NP'::varchar(2) ELSE d.profession_code_shortname END,
          coalesce(cm.teva_specialty_code, ''::varchar),
          'US'::varchar(2),
          CASE WHEN (cm.healthcare_professional_status_code = 'A'::varchar(1)) THEN 'Active'::varchar(6) WHEN (cm.healthcare_professional_status_code <> 'A'::varchar(1)) THEN 'Inactive'::varchar(8) ELSE ''::varchar END;

CREATE  VIEW outbound.zzz_zs_tr_launch_analytics AS
 SELECT rx.ims_id,
        rx.model,
        rx.payment_method AS method_of_payment,
        rx.payer_plan_number,
        rx.basket_name,
        rx.ims_product_group,
        rx.rollup_month AS month_ending,
        rx.rollup_week AS week_ending,
        rx.nrx_count,
        rx.trx_count,
        rx.sales_category
 FROM (((datamart.prescriber_rx rx JOIN product.basket b ON ((rx.basket_id = b.basket_id))) JOIN outbound.month_rollup_and_bucket mth ON ((rx.rollup_month = mth.month_ending))) JOIN reference.ims_report_cnt_qty_mapping irc ON (((rx.ims_client_number = irc.ims_client_number) AND (coalesce(rx.ims_report_number_cnt, ''::varchar) = coalesce(irc.ims_report_number_cnt, ''::varchar)) AND (coalesce(rx.ims_report_number_qty, ''::varchar) = coalesce(irc.ims_report_number_qty, ''::varchar)) AND (irc.active_flag = 'Y'::char(1)))))
 WHERE ((b.teva_product_code ~~ '330-14%'::varchar(7)) AND (rx.basket_type = 'product'::varchar(7)) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 12) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)));

CREATE  VIEW outbound.zzz_ddd_normalization_control AS
 SELECT 241 AS ClientNo,
        22 AS RxReportNo,
        sp.source_product_code AS ProductGroupNo,
        21 AS CorrespondingDollarsReportNo,
        b.name AS ProductGroupName,
        nf.divisor AS Divisor,
        nf.multiplier AS Multiplier
 FROM ((product.source_product sp JOIN product.normalization_factor nf ON ((sp.entity_id = nf.entity_id))) JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE ((sp.feed_id = 462) AND (nf.source_id = 1))
 ORDER BY sp.source_product_code;

CREATE  VIEW outbound.ftf_ims_monthly_market_obm AS
(SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = ANY (ARRAY['ALLERGY MARKET TOTAL'::varchar(20), 'BDP NASAL MARKET TOTAL'::varchar(22), 'ICS MARKET TOTAL'::varchar(16), 'ICS SPLIT MARKET TOTAL'::varchar(22), 'LABA MARKET TOTAL'::varchar(17), 'SABA MARKET TOTAL'::varchar(17)])) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month UNION SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = ANY (ARRAY['MS MARKET'::varchar(9), 'PD MARKET'::varchar(9)])) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month) UNION SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = 'TOTAL STIMULANT/SLEEP/SEDATIVE'::varchar(30)) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month;

CREATE  VIEW outbound.zzz_asi_psr_enrollment AS
 SELECT enrollment_summary.tvcmid,
        enrollment_summary.ims_id,
        enrollment_summary.npi,
        CASE WHEN (enrollment_summary.veeva_account_id IS NULL) THEN enrollment_summary.ims_id ELSE enrollment_summary.veeva_account_id END AS veeva_account_id,
        enrollment_summary.ndc,
        enrollment_summary.indication,
        to_char(enrollment_summary.week_ending, 'YYYYMMDD'::varchar(8)) AS week_ending,
        enrollment_summary.in_progress_count,
        enrollment_summary.completed_count,
        enrollment_summary.cancelled_count,
        enrollment_summary.prescriber_count
 FROM datamart.enrollment_summary
 ORDER BY to_char(enrollment_summary.week_ending, 'YYYYMMDD'::varchar(8));

CREATE  VIEW outbound.zzz_tr_launch_analytics_rx AS
 SELECT rx.ims_id,
        rx.model,
        rx.payment_method AS method_of_payment,
        rx.payer_plan_number AS payer_plan_num,
        b.name AS product_name,
        b.teva_product_code AS product_code,
        rx.rollup_month AS month_ending,
        mth.month_bucket,
        rx.rollup_week AS week_ending,
        mth.calendar_week_bucket AS week_bucket,
        sum(rx.nrx_count) AS nrx_count,
        sum(rx.trx_count) AS trx_count,
        rx.sales_category
 FROM (((datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) LEFT  JOIN product.basket b ON ((rx.basket_id = b.basket_id))) JOIN ( SELECT ims_week_buckets.month_bucket,
        ims_week_buckets.calendar_week,
        ims_week_buckets.calendar_week_bucket,
        ims_week_buckets.split_week_ending,
        ims_week_buckets.month_ending
 FROM integration.ims_week_buckets) mth ON (((rx.rollup_week = mth.calendar_week) AND (rx.rollup_month = mth.month_ending))))
 WHERE (((b.teva_product_code ~~ '%330-14%'::varchar(8)) OR (b.basket_id IN ( SELECT basket_item.entity_id
 FROM product.basket_item
 WHERE (basket_item.basket_id = 5398)))) AND (rx.basket_type = 'product'::varchar(7)) AND (mth.calendar_week_bucket >= 1) AND (mth.calendar_week_bucket <= 52))
 GROUP BY rx.ims_id,
          rx.model,
          rx.payment_method,
          rx.payer_plan_number,
          b.name,
          b.teva_product_code,
          rx.rollup_month,
          mth.month_bucket,
          rx.rollup_week,
          mth.calendar_week_bucket,
          rx.nrx_count,
          rx.trx_count,
          rx.sales_category;

CREATE  VIEW outbound.v_ob_ahm_customer_address AS
 SELECT concat('A'::varchar(1), (addr.tvcmid)::varchar) AS CustomerAddressId,
        addr.tvcmid AS CustomerId,
        'Business'::varchar(8) AS AddressType,
        coalesce(addr.address_line_1, ''::varchar) AS AddressLine1,
        coalesce(addr.address_line_2, ''::varchar) AS AddressLine2,
        ''::varchar AS AddressLine3,
        coalesce(addr.city, ''::varchar) AS City,
        ''::varchar AS Neighborhood,
        coalesce(addr.state, ''::varchar) AS StateProvince,
        coalesce(addr.zip5_postal_code, ''::varchar) AS PostalCode,
        coalesce(addr.zip4_postal_extension_code, ''::varchar) AS PostalCodeExtension,
        'US'::varchar(2) AS CountryCode,
        'Y'::varchar(1) AS PrimaryIndicator,
        coalesce(deaaddr.dea_number, coalesce(rdea.dea_number, ''::varchar)) AS DEANumber,
        coalesce(((deaaddr.dea_expiration_date)::date)::varchar(10), ''::varchar) AS DEAExpirationDate,
        ''::varchar AS EffectiveDate,
        ''::varchar AS EndDate
 FROM (((mdm.address addr JOIN ( SELECT PrimaryAddress.tvcmid,
        PrimaryAddress.address_id,
        PrimaryAddress.file_id,
        PrimaryAddress.single_address_indicator
 FROM ( SELECT Address.tvcmid,
        Address.address_id,
        coalesce(Address.single_address_indicator, 'N'::varchar(1)) AS single_address_indicator,
        coalesce(Address.practice_location_rank, '- 7'::varchar(3)) AS practice_location_rank,
        Address.file_id,
        rank() OVER (PARTITION BY Address.tvcmid ORDER BY coalesce(Address.single_address_indicator, 'N'::varchar(1)) DESC, coalesce(Address.practice_location_rank, '- 7'::varchar(3)) DESC, Address.address_effective_date DESC, Address.address_id DESC) AS rnk
 FROM ( SELECT address.tvcmid,
        address.address_id,
        max(address.single_address_indicator) AS single_address_indicator,
        max(address.practice_location_rank) AS practice_location_rank,
        max(address.address_effective_date) AS address_effective_date,
        address.file_id
 FROM mdm.address
 WHERE ((address.address_type = 2::float) AND (address.address_status = 'A'::varchar(1)) AND (address.file_id = ( SELECT max(address.file_id) AS max
 FROM mdm.address)))
 GROUP BY address.tvcmid,
          address.address_id,
          address.file_id) Address) PrimaryAddress
 WHERE ((PrimaryAddress.tvcmid IN ( SELECT hcp.tvcmid
 FROM mdm.hcp
 WHERE (hcp.file_id = ( SELECT max(hcp.file_id) AS max
 FROM mdm.hcp)))) AND (PrimaryAddress.rnk = 1))) PA ON (((PA.address_id = addr.address_id) AND (addr.tvcmid = PA.tvcmid) AND (addr.file_id = PA.file_id) AND (coalesce(addr.single_address_indicator, 'N'::varchar(1)) = PA.single_address_indicator)))) LEFT  JOIN ( SELECT dea_address.tvcmid,
        max(dea_address.address_id) AS address_id,
        max(dea_address.dea_number) AS dea_number,
        max(dea_address.dea_expiration_date) AS dea_expiration_date
 FROM mdm.dea_address
 WHERE ((dea_address.file_id = ( SELECT max(dea_address.file_id) AS max
 FROM mdm.dea_address)) AND (dea_address.dea_status_code = 'A'::varchar(1)))
 GROUP BY dea_address.tvcmid) deaaddr ON (((addr.address_id = deaaddr.address_id) AND (addr.tvcmid = deaaddr.tvcmid)))) LEFT  JOIN ( SELECT raw_dea.tvcmid,
        raw_dea.state,
        max(raw_dea.dea_number) AS dea_number
 FROM mdm.raw_dea
 WHERE (raw_dea.file_id = ( SELECT max(raw_dea.file_id) AS max
 FROM mdm.raw_dea))
 GROUP BY raw_dea.tvcmid,
          raw_dea.state) rdea ON (((addr.state = rdea.state) AND (addr.tvcmid = rdea.tvcmid))))
 GROUP BY concat('A'::varchar(1), (addr.tvcmid)::varchar),
          addr.tvcmid,
          'Business'::varchar(8),
          coalesce(addr.address_line_1, ''::varchar),
          coalesce(addr.address_line_2, ''::varchar),
          ''::varchar,
          coalesce(addr.city, ''::varchar),
          coalesce(addr.state, ''::varchar),
          coalesce(addr.zip5_postal_code, ''::varchar),
          coalesce(addr.zip4_postal_extension_code, ''::varchar),
          'US'::varchar(2),
          'Y'::varchar(1),
          coalesce(deaaddr.dea_number, coalesce(rdea.dea_number, ''::varchar)),
          coalesce(((deaaddr.dea_expiration_date)::date)::varchar(10), ''::varchar);

CREATE  VIEW outbound.zzz_brandedims_medicaidplangroups AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        coalesce(a.veeva_account_id, rx.ims_id) AS HCP_ID,
        rx.payer_plan_number AS PLAN_CODE,
        rx.plan_name AS PLAN_NAME,
        rx.model AS MODEL,
        rx.payer_name AS PLAN_GROUP,
        rx.basket_name AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM (((( SELECT rx.ims_id,
        rx.payer_plan_number,
        rx.plan_name,
        rx.model,
        rx.payer_name,
        rx.basket_name,
        rx.basket_id,
        rx.basket_type,
        rx.rollup_month,
        rx.trx_count,
        rx.tvcmid,
        rx.payment_method,
        rx.rollup_week
 FROM (datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency))))
 WHERE (((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_number = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)]))) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name,
          rx.basket_id,
          rx.basket_type,
          rx.rollup_month,
          rx.trx_count,
          rx.tvcmid,
          rx.payment_method,
          rx.rollup_week) rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE (((b.basket_id)::varchar = ANY (ARRAY['85'::varchar(10), '84'::varchar(10), '86'::varchar(10), '63'::varchar(10), '405'::varchar(10), '87'::varchar(10), '89'::varchar(10), '88'::varchar(10), '580'::varchar(10), '581'::varchar(10), '582'::varchar(10), '583'::varchar(10), '584'::varchar(10), '585'::varchar(10), '5346'::varchar(10), '5347'::varchar(10), '5348'::varchar(10), '589'::varchar(10), '590'::varchar(10), '5394'::varchar(10), '5395'::varchar(10), '5396'::varchar(10), '586'::varchar(10), '587'::varchar(10), '103'::varchar(10)])) AND ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_number = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)]))) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY rx.ims_id,
          a.veeva_account_id,
          rx.payer_plan_number,
          rx.plan_name,
          rx.model,
          rx.payer_name,
          rx.basket_name;

CREATE  VIEW outbound.zzz_brandedims_mop AS
 SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS IMS_ID,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END AS HCP_ID,
        rx.payment_method AS PAYMENT_METHOD,
        rx.basket_name AS PRODUCT,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH24,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH23,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH22,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH21,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH20,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH19,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH18,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH17,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH16,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH15,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH14,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH13,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH12,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH11,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH10,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH9,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH8,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH7,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH6,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH5,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH4,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH3,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH2,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS TRX_MTH1
 FROM ((((datamart.prescriber_rx rx JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.report_frequency
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) LEFT  JOIN ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.tvcmid) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE ((xref.id_type = 'VEEVA_ID'::varchar(8)) AND (xref.tvcmid IS NOT NULL))) a ON (((a.tvcmid = rx.tvcmid) AND (a.rnk = 1)))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE (((b.basket_id)::varchar = ANY (ARRAY['85'::varchar(10), '84'::varchar(10), '86'::varchar(10), '63'::varchar(10), '405'::varchar(10), '87'::varchar(10), '89'::varchar(10), '88'::varchar(10), '580'::varchar(10), '581'::varchar(10), '582'::varchar(10), '583'::varchar(10), '584'::varchar(10), '585'::varchar(10), '5346'::varchar(10), '5347'::varchar(10), '5348'::varchar(10), '589'::varchar(10), '590'::varchar(10), '5394'::varchar(10), '5395'::varchar(10), '5396'::varchar(10), '586'::varchar(10), '587'::varchar(10), '103'::varchar(10)])) AND (rx.basket_type = 'product'::varchar(7)))
 GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END,
          CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(a.veeva_account_id, rx.ims_id) END,
          rx.payment_method,
          rx.basket_name;

CREATE  VIEW outbound.zzz_asi_rems_extract AS
 SELECT r.ACCOUNT_ID,
        r.ENROLLMENT_ID,
        r.NPI,
        r.DEA_NUM,
        r.PROGRAM_ID,
        r.REMS_PROGRAM,
        r.ENROLLMENT_STATUS,
        r.CURRENT_ENROLLMENT_STEP,
        r.EFFECTIVE_DATE,
        r.EXPIRATION_DATE
 FROM ( SELECT coalesce(cm_vvid.id_num, cm_imsid.id_num) AS ACCOUNT_ID,
        r.enrollment_id AS ENROLLMENT_ID,
        r.npi AS NPI,
        r.dea_num AS DEA_NUM,
        r.program_id AS PROGRAM_ID,
        "substring"(r.program_name, 1, 4) AS REMS_PROGRAM,
        r.status AS ENROLLMENT_STATUS,
        r.in_progress_step AS CURRENT_ENROLLMENT_STEP,
        r.effective_date AS EFFECTIVE_DATE,
        r.expiration_date AS EXPIRATION_DATE
 FROM ((datamart.rems_prescriber r LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        max(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) cm_vvid ON ((r.prescriber_tvcmid = cm_vvid.tvcmid))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        max(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))
 GROUP BY tvcmid_xref.tvcmid) cm_imsid ON ((r.prescriber_tvcmid = cm_imsid.tvcmid)))) r
 WHERE (r.ACCOUNT_ID IS NOT NULL);

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_demo AS
SELECT pcd.tvcmid, pcd.ims_id, pcd.veeva_account_id, pcd.first_name, pcd.middle_name, pcd.last_name, pcd.degree, ((pcd.ptr_address_1 || pcd.ptr_address_2) || pcd.ptr_address_3) AS address, pcd.ptr_city, pcd.ptr_state, pcd.ptr_zip, pcd.specialty AS prim_specialty, s.fentora_report_group, rxd.decile_trx_count_6_mo AS fentora_decile, CASE WHEN (cp.ims_id IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS target_flag FROM ((((datamart.prescriber_combined_demographics pcd LEFT JOIN reference.specialty_xref s ON ((pcd.specialty = s.specialty_code))) LEFT JOIN datamart.rx_deciles rxd ON (((pcd.ims_id = rxd.ims_id) AND (rxd.decile_name = 'AMRIX'::varchar(5))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx WHERE (prescriber_rx.basket_id = 40)) rx ON ((rx.ims_id = pcd.ims_id))) LEFT JOIN datamart.call_plan cp ON (((pcd.ims_id = cp.ims_id) AND (pcd.sales_force_id = cp.sales_force_id) AND (cp.basket_id = 40)))) WHERE ((pcd.sales_force_id = 'TP'::varchar(2)) AND (pcd.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (pcd.first_name IS NOT NULL)) GROUP BY pcd.tvcmid, pcd.ims_id, pcd.veeva_account_id, pcd.first_name, pcd.middle_name, pcd.last_name, pcd.degree, ((pcd.ptr_address_1 || pcd.ptr_address_2) || pcd.ptr_address_3), pcd.ptr_city, pcd.ptr_state, pcd.ptr_zip, pcd.specialty, s.fentora_report_group, rxd.decile_trx_count_6_mo, CASE WHEN (cp.ims_id IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END;

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_rems_enrollment AS
 SELECT NULL AS CEPH_ID,
        rp.program_id AS PROGRAM_ID,
        rp.program_name AS PROGRAM_NAME,
        rp.channel AS CHANNEL,
        rp.enrollment_id AS ENROLLMENT_ID,
        rp.first_name AS FIRST_NAME,
        rp.middle_name AS MIDDLE_NAME,
        rp.last_name AS LAST_NAME,
        irp.credential AS CREDENTIAL,
        NULL AS SPECIALTY,
        rp.site_name AS SITE_NAME,
        rp.address_line_1 AS ADDRESS1,
        rp.address_line_2 AS ADDRESS2,
        rp.city AS CITY,
        rp.state AS STATE,
        rp.zip AS ZIP,
        rp.status AS STATUS,
        rp.in_progress_step AS IN_PROGRESS_STEP,
        rp.phone AS PHONE,
        rp.effective_date AS EFFECTIVE_DATE,
        rp.expiration_date AS EXPIRATION_DATE,
        rp.npi AS NPI,
        rp.dea_num AS DEA_NUM,
        rp.obsolescence_date AS OBSOLESCENCE_DATE,
        NULL AS OBSOLESCENCE_REASON,
        (statement_timestamp())::timestamp AS LAST_BUILD_DATE,
        rp.ppaf_count AS PPAF_COUNT,
        NULL AS HAD_ENROLLED_IN_FENTORA_REMS,
        NULL AS CM_ID,
        cm_ims.id_num AS IMS_ID,
        cm_vv.id_num AS VEEVA_ACCOUNT_ID
 FROM (((datamart.rems_prescriber rp JOIN integration.rems_prescriber irp ON (((rp.file_id = irp.file_id) AND (rp.record_id = irp.record_id)))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))
 GROUP BY tvcmid_xref.tvcmid) cm_ims ON ((rp.prescriber_tvcmid = cm_ims.tvcmid))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) cm_vv ON ((rp.prescriber_tvcmid = cm_vv.tvcmid)));

CREATE  VIEW outbound.zzz_asi_rx_by_market_hd_parallel AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM ((datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending)))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '046'::varchar(3)) AND (rx.ims_report_number_cnt = '8'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (((rx.basket_id = ANY (ARRAY[5264, 5266, 5216, 5265])) AND (rx.indication = 'HD'::varchar(2))) OR (rx.basket_id <> ALL (ARRAY[5264, 5266, 5216, 5265]))))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.i_sfa_decile AS
 SELECT rx_deciles.ims_id,
        'CNS'::varchar(3) AS category,
        CASE WHEN (rx_deciles.decile_name = 'MS MARKET'::varchar(9)) THEN 'MS'::varchar(2) WHEN (rx_deciles.decile_name = 'MODAFINIL'::varchar(9)) THEN 'WAKE'::varchar(4) ELSE NULL END AS decile_name,
        rx_deciles.decile_trx_count_6_mo AS trx_cnt_01_06,
        rx_deciles.decile_trx_count_12_mo AS trx_cnt_01_12,
        rx_deciles.tvcmid
 FROM datamart.rx_deciles
 WHERE (((rx_deciles.decile_name = 'MS MARKET'::varchar(9)) OR (rx_deciles.decile_name = 'MODAFINIL'::varchar(9))) AND (rx_deciles.ims_id IN ( SELECT sfa_demographics.ims_id
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)))));

CREATE  VIEW outbound.zzz_rx_amrix AS
 SELECT rx.ims_id,
        rx.payment_method AS mop,
        b.teva_product_code AS product_code,
        b.name AS product_name,
        rx.rollup_month AS month_ending,
        sum(rx.nrx_quantity) AS nrx_qty,
        sum(rx.trx_quantity) AS trx_qty,
        sum(rx.unnormalized_nrx_count) AS nrx_cnt,
        sum(rx.unnormalized_trx_count) AS trx_cnt
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT basket.basket_id,
        basket.name,
        basket.description,
        basket.teva_product_code,
        basket.basket_type
 FROM product.basket
 WHERE (basket.basket_id = ANY (ARRAY[40, 147, 173, 197, 198, 199, 216, 217, 235]))) b ON ((rx.basket_id = b.basket_id))) JOIN ( SELECT ims_report_cnt_qty_mapping.ims_client_number,
        ims_report_cnt_qty_mapping.ims_report_number_cnt,
        ims_report_cnt_qty_mapping.ims_report_number_qty,
        ims_report_cnt_qty_mapping.report_frequency,
        ims_report_cnt_qty_mapping.active_flag,
        ims_report_cnt_qty_mapping.indication_flag
 FROM reference.ims_report_cnt_qty_mapping
 WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) m ON (((rx.ims_client_number = m.ims_client_number) AND (rx.ims_report_number_cnt <=> m.ims_report_number_cnt) AND (rx.ims_report_number_qty <=> m.ims_report_number_qty))))
 WHERE ((rx.rollup_month >= last_day(add_months((statement_timestamp())::timestamp, (-25)))) AND (rx.rollup_month <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (length(rx.ims_id) = 7))
 GROUP BY rx.ims_id,
          rx.payment_method,
          b.teva_product_code,
          b.name,
          rx.rollup_month;

CREATE  VIEW outbound.zzz_details_amrix AS
 SELECT c.tvcmid,
        c.ims_id,
        c.veeva_account_id,
        initcap(d.last_name) AS last_name,
        initcap(d.first_name) AS first_name,
        initcap(d.middle_name) AS middle_name,
        d.credentials,
        d.zip,
        c.rep_id,
        c.territory_number AS territory_num,
        c.call_date,
        'AMRIX'::varchar(5) AS product,
        cd.detail_position
 FROM (((( SELECT sfa_call_detail.sales_force_id,
        sfa_call_detail.call_id,
        sfa_call_detail.product,
        sfa_call_detail.basket_id,
        sfa_call_detail.basket_name,
        sfa_call_detail.detail_position,
        sfa_call_detail.indication
 FROM datamart.sfa_call_detail
 WHERE ((sfa_call_detail.sales_force_id = ANY (ARRAY['TP'::varchar(2), 'TC'::varchar(2)])) AND (sfa_call_detail.product = 'AMRIX'::varchar(5)))) cd JOIN ( SELECT sfa_call.sales_force_id,
        sfa_call.call_id,
        sfa_call.veeva_account_id,
        sfa_call.ims_id,
        sfa_call.ims_outlet_id,
        sfa_call.customer_type,
        sfa_call.first_name,
        sfa_call.last_name,
        sfa_call.call_type,
        sfa_call.legacy_call_type,
        sfa_call.ceph_id,
        sfa_call.dea_num,
        sfa_call.rep_id,
        sfa_call.rep_first_name,
        sfa_call.rep_last_name,
        sfa_call.territory_number,
        sfa_call.zip_on_call,
        sfa_call.call_date,
        sfa_call.submit_date,
        sfa_call.attendees,
        sfa_call.attendee_type,
        sfa_call.area_number,
        sfa_call.region_number,
        sfa_call.tvcmid,
        sfa_call.call_recordtype,
        sfa_call.call_duration,
        sfa_call.call_datetime,
        sfa_call.call_timezone
 FROM datamart.sfa_call
 WHERE ((sfa_call.call_date >= last_day(add_months((statement_timestamp())::timestamp, (-25)))) AND (sfa_call.call_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))))) c ON ((cd.call_id = c.call_id))) JOIN ( SELECT sfa_demographics.veeva_account_id,
        sfa_demographics.sales_force_id,
        sfa_demographics.customer_type,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.ims_outlet_code,
        sfa_demographics.territory_number,
        sfa_demographics.territory_type,
        sfa_demographics.territory_status,
        sfa_demographics.last_name,
        sfa_demographics.first_name,
        sfa_demographics.middle_name,
        sfa_demographics.suffix_name,
        sfa_demographics.credentials,
        sfa_demographics.organization_name,
        sfa_demographics.veeva_address_id,
        sfa_demographics.address_line1,
        sfa_demographics.address_line2,
        sfa_demographics.address_line3,
        sfa_demographics.city,
        sfa_demographics.state,
        sfa_demographics.zip,
        sfa_demographics.address_status,
        sfa_demographics.phone,
        sfa_demographics.phone_ext,
        sfa_demographics.fax,
        sfa_demographics.mobile,
        sfa_demographics.email,
        sfa_demographics.prim_specialty,
        sfa_demographics.specialty_code,
        sfa_demographics.sfa_create_date,
        sfa_demographics.demo_rank,
        sfa_demographics.last_call_date,
        sfa_demographics.calls_last_90_days,
        sfa_demographics.zip_valid_for_territory_num,
        sfa_demographics.bp_code,
        sfa_demographics.sfa_align_date,
        sfa_demographics.account_demo_id,
        sfa_demographics.pdrp_flag,
        sfa_demographics.designation,
        sfa_demographics.business_type,
        sfa_demographics.area_number,
        sfa_demographics.region_number,
        sfa_demographics.tvcmid
 FROM datamart.sfa_demographics) d ON ((c.veeva_account_id = d.veeva_account_id))) JOIN ( SELECT current_alignment.zip_code,
        current_alignment.city,
        current_alignment.state_code,
        current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.area_number,
        current_alignment.area_name,
        current_alignment.region_number,
        current_alignment.region_name,
        current_alignment.sales_force_id,
        current_alignment.organization_code,
        current_alignment.inactive_flag,
        current_alignment.comments,
        current_alignment.mirror_flag,
        current_alignment.mirror_territory_number,
        current_alignment.file_id,
        current_alignment.record_id
 FROM datamart.current_alignment) al ON ((d.zip = al.zip_code)))
 GROUP BY c.tvcmid,
          c.ims_id,
          c.veeva_account_id,
          initcap(d.last_name),
          initcap(d.first_name),
          initcap(d.middle_name),
          d.credentials,
          d.zip,
          c.rep_id,
          c.territory_number,
          c.call_date,
          'AMRIX'::varchar(5),
          cd.detail_position;

CREATE  VIEW outbound.zzz_demo_amrix AS
SELECT d.tvcmid AS TVCMID, d.ims_id AS IMS_ID, d.veeva_account_id AS VEEVA_ACCOUNT_ID, d.first_name AS FIRST_NAME, d.middle_name AS MID_NAME, d.last_name AS LAST_NAME, d.degree AS DEGREE, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3) AS ADDRESS, d.ptr_city AS CITY, d.ptr_state AS STATE, d.ptr_zip AS ZIP, d.specialty AS PRIM_SPECIALTY, s1.nuvigil_report_group AS amrix_report_group, dec1.decile_trx_count_6_mo AS amrix_decile, dec2.decile_trx_count_6_mo AS bsmr_decile, dec3.decile_trx_count_6_mo AS total_muscal_relaxant_decile, NULL AS bsmr_less_soma_zanaflex_decile, dec4.decile_trx_count_6_mo AS Cyclobenzaprine_HCL_decile, s1.amrix_target_flag AS TARGET_FLAG FROM ((((((datamart.prescriber_combined_demographics d LEFT JOIN reference.specialty_xref s1 ON ((s1.specialty_code = d.specialty))) LEFT JOIN datamart.rx_deciles dec1 ON (((dec1.ims_id = d.ims_id) AND (upper(dec1.decile_name) = 'AMRIX'::varchar(5))))) LEFT JOIN datamart.rx_deciles dec2 ON (((dec2.ims_id = d.ims_id) AND (upper(dec2.decile_name) = 'BRANDED MUSCLE RELAXANTS'::varchar(24))))) LEFT JOIN datamart.rx_deciles dec3 ON (((dec3.ims_id = d.ims_id) AND (upper(dec3.decile_name) = 'TOTAL MUSCLE RELAXANTS'::varchar(22))))) LEFT JOIN datamart.rx_deciles dec4 ON (((dec4.ims_id = d.ims_id) AND (upper(dec4.decile_name) = 'CYCLOBENZAPRINE HCL'::varchar(19))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx prescriber_rx WHERE ((prescriber_rx.basket_id = 176) AND (prescriber_rx.rollup_month >= add_months(prescriber_rx.data_date, (-24))) AND (prescriber_rx.rollup_month <= add_months(prescriber_rx.data_date, (-1))) AND (upper(prescriber_rx.basket_type) = 'PRODUCT'::varchar(7)) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY prescriber_rx.ims_id UNION SELECT sfa_demographics.ims_id FROM datamart.sfa_demographics WHERE (sfa_demographics.sales_force_id = 'TP'::varchar(2)) GROUP BY sfa_demographics.ims_id) rx ON ((d.ims_id = rx.ims_id))) WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL)) GROUP BY d.tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.middle_name, d.last_name, d.degree, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3), d.ptr_city, d.ptr_state, d.ptr_zip, d.specialty, s1.nuvigil_report_group, dec1.decile_trx_count_6_mo, dec2.decile_trx_count_6_mo, dec3.decile_trx_count_6_mo, dec4.decile_trx_count_6_mo, s1.amrix_target_flag;

CREATE  VIEW outbound.zzz_copay_redemption_amrix AS
 SELECT cd.physician_tvcmid AS TVCMID,
        cd.physician_ims_id AS IMS_ID,
        cd.physician_veeva_id AS VEEVA_ACCOUNT_ID,
        p.program_number AS ASI_PROGRAM_NUM,
        p.program_description AS PROGRAM_DESC,
        cd.copay_card_number AS COPAY_CARD_NUM,
        coalesce(cd.physician_zip, cd.pharmacy_zip) AS ZIP_CODE,
        to_char(cd.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        cd.basket_name AS BRAND_NAME,
        replace(cd.basket_name, 'AMRIX'::varchar(5), ''::varchar) AS DRUG_DESC,
        cd.quantity AS QTY
 FROM (datamart.copay cd LEFT  JOIN reference.copay_voucher_program p ON (((cd.program_number = p.program_number) AND (cd.redemption_type = p.redemption_type))))
 WHERE ((cd.basket_name ~~ '%AMRIX%'::varchar(7)) AND (cd.fill_date >= last_day((add_months((statement_timestamp())::timestamp, (-25)) + 1))) AND (cd.fill_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.report_frequency = 'WEEK'::varchar(4)) AND (cd.redemption_type = 'COPAY'::varchar(5)))
 GROUP BY cd.physician_tvcmid,
          cd.physician_ims_id,
          cd.physician_veeva_id,
          p.program_number,
          p.program_description,
          cd.copay_card_number,
          coalesce(cd.physician_zip, cd.pharmacy_zip),
          to_char(cd.fill_date, 'YYYY-MM-DD'::varchar(10)),
          cd.basket_name,
          replace(cd.basket_name, 'AMRIX'::varchar(5), ''::varchar),
          cd.quantity;

CREATE  VIEW teva_ingestion.MDM_MERGES AS
 SELECT CASE WHEN (MDM_MERGES_src.previous_tvcmid = ''::varchar) THEN NULL::int ELSE (btrim(MDM_MERGES_src.previous_tvcmid))::int END AS previous_tvcmid,
        CASE WHEN (MDM_MERGES_src.current_tvcmid = ''::varchar) THEN NULL::int ELSE (btrim(MDM_MERGES_src.current_tvcmid))::int END AS current_tvcmid,
        btrim(MDM_MERGES_src.merge_cycle) AS merge_cycle,
        MDM_MERGES_src.batch_id,
        MDM_MERGES_src.row_id,
        MDM_MERGES_src.update_ts
 FROM teva_ingestion.MDM_MERGES_src;

CREATE  VIEW raw.mdm_merges AS
 SELECT src.previous_tvcmid,
        src.current_tvcmid,
        src.merge_cycle,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_MERGES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_merges'::varchar(10)))));

CREATE  VIEW outbound.zs_calls_by_specialty AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, sum(c.calls) AS calls_6mth FROM (((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.veeva_account_id, c.territory_number AS territory_num, sum(1) AS calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.veeva_account_id, c.territory_number) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num)))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_calls_by_sales_force AS
 SELECT 'TEVA'::varchar(4) AS company,
        to_char(month_lookup.m01, 'yyyymm'::varchar(6)) AS month_ending,
        c.sales_force_id,
        CASE c.sales_force_id WHEN NULLSEQUAL 'TP'::varchar(2) THEN 'Psychiatry'::varchar(10) WHEN NULLSEQUAL 'TN'::varchar(2) THEN 'Neuroscience'::varchar(12) WHEN NULLSEQUAL 'TO'::varchar(2) THEN 'Oncology'::varchar(8) WHEN NULLSEQUAL 'TR'::varchar(2) THEN 'Respiratory'::varchar(11) WHEN NULLSEQUAL 'TS'::varchar(2) THEN 'Severe Asthma'::varchar(13) ELSE NULL END AS sales_team,
        count(DISTINCT c.territory_num) AS num_terrs,
        count(DISTINCT c.rep_id) AS num_reps,
        sum(c.p1_calls_mth1) AS p1_calls_mth1,
        sum(c.p2_calls_mth1) AS p2_calls_mth1,
        sum(c.p3_calls_mth1) AS p3_calls_mth1,
        sum(c.p4_calls_mth1) AS p4_calls_mth1,
        sum(c.p1_calls_mth2) AS p1_calls_mth2,
        sum(c.p2_calls_mth2) AS p2_calls_mth2,
        sum(c.p3_calls_mth2) AS p3_calls_mth2,
        sum(c.p4_calls_mth2) AS p4_calls_mth2,
        sum(c.p1_calls_mth3) AS p1_calls_mth3,
        sum(c.p2_calls_mth3) AS p2_calls_mth3,
        sum(c.p3_calls_mth3) AS p3_calls_mth3,
        sum(c.p4_calls_mth3) AS p4_calls_mth3,
        sum(c.p1_calls_mth4) AS p1_calls_mth4,
        sum(c.p2_calls_mth4) AS p2_calls_mth4,
        sum(c.p3_calls_mth4) AS p3_calls_mth4,
        sum(c.p4_calls_mth4) AS p4_calls_mth4,
        sum(c.p1_calls_mth5) AS p1_calls_mth5,
        sum(c.p2_calls_mth5) AS p2_calls_mth5,
        sum(c.p3_calls_mth5) AS p3_calls_mth5,
        sum(c.p4_calls_mth5) AS p4_calls_mth5,
        sum(c.p1_calls_mth6) AS p1_calls_mth6,
        sum(c.p2_calls_mth6) AS p2_calls_mth6,
        sum(c.p3_calls_mth6) AS p3_calls_mth6,
        sum(c.p4_calls_mth6) AS p4_calls_mth6
 FROM ( SELECT c.sales_force_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.sales_force_id,
        c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        d.product,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.sales_force_id,
          c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          d.product,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.sales_force_id,
          c.territory_num,
          c.rep_id) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) month_lookup
 WHERE (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)]))
 GROUP BY c.sales_force_id,
          to_char(month_lookup.m01, 'yyyymm'::varchar(6));

CREATE  VIEW outbound.zs_calls_by_product AS
 SELECT 'TEVA'::varchar(4) AS company,
        to_char(month_lookup.m01, 'yyyymm'::varchar(6)) AS month_ending,
        c.product,
        sum(c.p1_calls_mth1) AS p1_calls_mth1,
        sum(c.p2_calls_mth1) AS p2_calls_mth1,
        sum(c.p3_calls_mth1) AS p3_calls_mth1,
        sum(c.p4_calls_mth1) AS p4_calls_mth1,
        sum(c.p1_calls_mth2) AS p1_calls_mth2,
        sum(c.p2_calls_mth2) AS p2_calls_mth2,
        sum(c.p3_calls_mth2) AS p3_calls_mth2,
        sum(c.p4_calls_mth2) AS p4_calls_mth2,
        sum(c.p1_calls_mth3) AS p1_calls_mth3,
        sum(c.p2_calls_mth3) AS p2_calls_mth3,
        sum(c.p3_calls_mth3) AS p3_calls_mth3,
        sum(c.p4_calls_mth3) AS p4_calls_mth3,
        sum(c.p1_calls_mth4) AS p1_calls_mth4,
        sum(c.p2_calls_mth4) AS p2_calls_mth4,
        sum(c.p3_calls_mth4) AS p3_calls_mth4,
        sum(c.p4_calls_mth4) AS p4_calls_mth4,
        sum(c.p1_calls_mth5) AS p1_calls_mth5,
        sum(c.p2_calls_mth5) AS p2_calls_mth5,
        sum(c.p3_calls_mth5) AS p3_calls_mth5,
        sum(c.p4_calls_mth5) AS p4_calls_mth5,
        sum(c.p1_calls_mth6) AS p1_calls_mth6,
        sum(c.p2_calls_mth6) AS p2_calls_mth6,
        sum(c.p3_calls_mth6) AS p3_calls_mth6,
        sum(c.p4_calls_mth6) AS p4_calls_mth6
 FROM ( SELECT c.product,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        d.product,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          d.product,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.product) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) month_lookup
 GROUP BY to_char(month_lookup.m01, 'yyyymm'::varchar(6)),
          c.product;

CREATE  VIEW outbound.zs_call_plan_semester_ts_qvar AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TS'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QVAR'::varchar(4)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QVAR'::varchar(4)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TS'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QVAR'::varchar(4)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QVAR'::varchar(4)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_ts_airduo AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TS'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AIRDUO'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AIRDUO'::varchar(6)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TS'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AIRDUO'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AIRDUO'::varchar(6)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tr_qvar AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TR'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QVAR'::varchar(4)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QVAR'::varchar(4)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TR'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QVAR'::varchar(4)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QVAR'::varchar(4)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tr_qnasl AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TR'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QNASL'::varchar(5)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QNASL'::varchar(5)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TR'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'QNASL'::varchar(5)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'QNASL'::varchar(5)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_ts_proair AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TR'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'PROAIR'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'PROAIR'::varchar(6)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TR'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'PROAIR'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'PROAIR'::varchar(6)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tr_airduo AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TR'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AIRDUO'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AIRDUO'::varchar(6)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TR'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TR'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AIRDUO'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AIRDUO'::varchar(6)) AND (cp.sales_force_id = 'TR'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tp_amrix AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TP'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TP'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AMRIX'::varchar(5)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AMRIX'::varchar(5)) AND (cp.sales_force_id = 'TP'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TP'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TP'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AMRIX'::varchar(5)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AMRIX'::varchar(5)) AND (cp.sales_force_id = 'TP'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tn_copaxone AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TN'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TN'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'COPAXONE'::varchar(8)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'COPAXONE'::varchar(8)) AND (cp.sales_force_id = 'TN'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TN'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TN'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'COPAXONE'::varchar(8)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'COPAXONE'::varchar(8)) AND (cp.sales_force_id = 'TN'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_call_plan_semester_tn_austedo AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TN'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TN'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AUSTEDO'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AUSTEDO'::varchar(7)) AND (cp.sales_force_id = 'TN'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TN'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TN'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'AUSTEDO'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'AUSTEDO'::varchar(7)) AND (cp.sales_force_id = 'TN'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zzz_zs_calls_oncology_trinsenox AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TO'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, d.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6
 FROM ((( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'TRISENOX'::varchar(8)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num))));

CREATE  VIEW sandbox.asi_market_access_w_test AS
SELECT A.zip, A.state, A.payer_plan_num, A.report_num, A.ims_product_group_num, A.data_month, A.nrx_001, A.nrx_002, A.nrx_003, A.nrx_004, A.nrx_005, A.nrx_006, A.nrx_007, A.nrx_008, A.nrx_009, A.nrx_010, A.nrx_011, A.nrx_012, A.nrx_013, A.nrx_014, A.nrx_015, A.nrx_016, A.nrx_017, A.nrx_018, A.nrx_019, A.nrx_020, A.nrx_021, A.nrx_022, A.nrx_023, A.nrx_024, A.trx_001, A.trx_002, A.trx_003, A.trx_004, A.trx_005, A.trx_006, A.trx_007, A.trx_008, A.trx_009, A.trx_010, A.trx_011, A.trx_012, A.trx_013, A.trx_014, A.trx_015, A.trx_016, A.trx_017, A.trx_018, A.trx_019, A.trx_020, A.trx_021, A.trx_022, A.trx_023, A.trx_024 FROM ((SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state, mpzd.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((((datamart.prescriber_rx rx JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN (SELECT market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo WHERE (hcp_demo.file_id = (SELECT max(customer_hcp_demographics.file_id) AS MAX FROM datamart.customer_hcp_demographics))) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo WHERE (hco_demo.file_id = (SELECT max(customer_hco_demographics.file_id) AS MAX FROM datamart.customer_hco_demographics))) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_report_number_cnt = ANY (ARRAY['1'::varchar(1), '2'::varchar(1), '3'::varchar(1), '4'::varchar(1), '5'::varchar(1), '6'::varchar(1), '68'::varchar(2)])) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state, mpzd.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime Therapeutics'::varchar(18)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((add_months(last_day(sp.ship_date), 1) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) A;

CREATE  VIEW teva_ingestion.EXT_ACTIVITY AS
 SELECT btrim(EXT_ACTIVITY_src.ACTIVITY_ID) AS ACTIVITY_ID,
        btrim(EXT_ACTIVITY_src.FEDERATION_ID) AS FEDERATION_ID,
        btrim(EXT_ACTIVITY_src.CONTACT) AS CONTACT,
        btrim(EXT_ACTIVITY_src.SOURCE_NAME) AS SOURCE_NAME,
        CASE WHEN (EXT_ACTIVITY_src."DATETIME" = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ACTIVITY_src."DATETIME"))::timestamp END AS "DATETIME",
        btrim(EXT_ACTIVITY_src.TRACKBACK_ID) AS TRACKBACK_ID,
        btrim(EXT_ACTIVITY_src.PREVIOUS_ACTIVITY) AS PREVIOUS_ACTIVITY,
        btrim(EXT_ACTIVITY_src.LEVEL_NAME) AS LEVEL_NAME,
        btrim(EXT_ACTIVITY_src.ACTIVITY_ROLE_NAME) AS ACTIVITY_ROLE_NAME,
        btrim(EXT_ACTIVITY_src.TYPE_NAME) AS TYPE_NAME,
        btrim(EXT_ACTIVITY_src.NATIVE_TYPE) AS NATIVE_TYPE,
        btrim(EXT_ACTIVITY_src.DETAILS) AS DETAILS,
        CASE WHEN (EXT_ACTIVITY_src.BASKET_ID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ACTIVITY_src.BASKET_ID))::int END AS BASKET_ID,
        btrim(EXT_ACTIVITY_src.WEB_URL) AS WEB_URL,
        EXT_ACTIVITY_src.batch_id,
        EXT_ACTIVITY_src.row_id,
        EXT_ACTIVITY_src.update_ts
 FROM teva_ingestion.EXT_ACTIVITY_src;

CREATE  VIEW raw.ext_activity AS
 SELECT src.ACTIVITY_ID,
        src.FEDERATION_ID,
        src.CONTACT,
        src.SOURCE_NAME,
        src."DATETIME",
        src.TRACKBACK_ID,
        src.PREVIOUS_ACTIVITY,
        src.LEVEL_NAME,
        src.ACTIVITY_ROLE_NAME,
        src.TYPE_NAME,
        src.NATIVE_TYPE,
        src.DETAILS,
        src.BASKET_ID,
        src.WEB_URL,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ACTIVITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ACTIVITY'::varchar(12)))));

CREATE  VIEW teva_ingestion.ext_tw_biologics_missing_info AS
 SELECT btrim(ext_tw_biologics_missing_info_src.FAX_DATE) AS FAX_DATE,
        btrim(ext_tw_biologics_missing_info_src.PH_STATE) AS PH_STATE,
        btrim(ext_tw_biologics_missing_info_src.PH_CITY) AS PH_CITY,
        btrim(ext_tw_biologics_missing_info_src.PHYSICIAN) AS PHYSICIAN,
        btrim(ext_tw_biologics_missing_info_src.PH_NPI) AS PH_NPI,
        btrim(ext_tw_biologics_missing_info_src.MRM) AS MRM,
        btrim(ext_tw_biologics_missing_info_src.PH_ZIP) AS PH_ZIP,
        ext_tw_biologics_missing_info_src.batch_id,
        ext_tw_biologics_missing_info_src.row_id,
        ext_tw_biologics_missing_info_src.update_ts
 FROM teva_ingestion.ext_tw_biologics_missing_info_src;

CREATE  VIEW raw.ext_tw_biologics_missing_info AS
 SELECT src.FAX_DATE,
        src.PH_STATE,
        src.PH_CITY,
        src.PHYSICIAN,
        src.PH_NPI,
        src.MRM,
        src.PH_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_tw_biologics_missing_info_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_BIOLOGICS_MISSING_INFO'::varchar(29)))));

CREATE  VIEW outbound.zzz_create_copay_voucher_redemption AS
 SELECT coalesce(c.physician_veeva_id, c.physician_ims_id) AS VEEVA_ACCOUNT_ID,
        c.physician_ims_id AS IMS_ID,
        c.redemption_type AS REDEMPTION_TYPE,
        to_char(c.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        to_char(c.date_written, 'YYYY-MM-DD'::varchar(10)) AS HCP_DATE_WRITTEN,
        CASE mod(c.days_supply, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.days_supply)::varchar ELSE rtrim((c.days_supply)::varchar, '0'::varchar(1)) END AS DAYS_SUPPLY,
        c.ndc_code AS NDC_CODE,
        c.basket_name AS BRAND_NAME,
        CASE mod(c.quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.quantity)::int)::varchar ELSE rtrim((c.quantity)::varchar, '0'::varchar(1)) END AS QTY,
        CASE mod(c.refills, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.refills)::varchar ELSE rtrim((c.refills)::varchar, '0'::varchar(1)) END AS REFILLS,
        c.program_number AS PROGRAM_NUM,
        c.copay_card_number AS COPAY_VOUCHER_NUM,
        c.pharmacy_chain_number AS PHARMACY_CHAIN_NUM,
        c.pharmacy_chain AS PHARMACY_CHAIN,
        c.pharmacy_name AS PHARMACY_NAME,
        c.pharmacy_address AS PHARMACY_ADDRESS,
        c.pharmacy_address2 AS PHARMACY_ADDRESS2,
        c.pharmacy_city AS PHARMACY_CITY,
        c.pharmacy_state AS PHARMACY_STATE,
        c.pharmacy_zip AS PHARMACY_ZIP,
        CASE mod(c.pharmacy_npi_num, 1::float) WHEN NULLSEQUAL 0::float THEN c.pharmacy_npi_num ELSE rtrim(c.pharmacy_npi_num, '0'::varchar(1)) END AS PHARMACY_NPI_NUM,
        NULL AS CEPH_ID,
        NULL AS ME_NUM,
        c.principle_physician_dea AS PRINCIPLE_PHYS_DEA_NUM,
        CASE mod(c.physician_npi, 1::float) WHEN NULLSEQUAL 0::float THEN c.physician_npi ELSE rtrim(c.physician_npi, '0'::varchar(1)) END AS PRINCIPLE_PHYS_NPI_NUM,
        c.physician_name AS PHYSICIAN_NAME,
        c.physician_address1 AS PHYSICIAN_ADDRESS1,
        c.physician_address2 AS PHYSICIAN_ADDRESS2,
        c.physician_city AS PHYSICIAN_CITY,
        c.physician_state AS PHYSICIAN_STATE,
        c.physician_zip AS PHYSICIAN_ZIP,
        CASE mod(c.rebate_amount, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.rebate_amount)::int)::varchar ELSE rtrim((c.rebate_amount)::varchar, '0'::varchar(1)) END AS REBATE_AMOUNT,
        CASE mod(c.member_cash_expense, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.member_cash_expense)::int)::varchar ELSE rtrim((c.member_cash_expense)::varchar, '0'::varchar(1)) END AS MEMBER_CASH_EXPENSE,
        CASE mod(c.submitted_cost, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.submitted_cost)::int)::varchar ELSE rtrim((c.submitted_cost)::varchar, '0'::varchar(1)) END AS SUBMITTED_COST,
        CASE mod(c.pharmacy_fee, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.pharmacy_fee)::int)::varchar ELSE rtrim((c.pharmacy_fee)::varchar, '0'::varchar(1)) END AS PHARMACY_FEE,
        CASE mod(c.total_amount_due, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.total_amount_due)::int)::varchar ELSE rtrim((c.total_amount_due)::varchar, '0'::varchar(1)) END AS TOTAL_AMOUNT_DUE,
        CASE mod(c.calc_awp, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.calc_awp)::int)::varchar ELSE rtrim((c.calc_awp)::varchar, '0'::varchar(1)) END AS CALC_AWP,
        c.occ_payment_type AS OCC_PAYMENT_TYPE,
        CASE mod(c.new_refill, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.new_refill)::varchar ELSE rtrim((c.new_refill)::varchar, '0'::varchar(1)) END AS NEW_REFILL,
        NULL AS ADMIN_HCP_NAME,
        NULL AS ADMIN_HCP_NPI,
        NULL AS ADMIN_HCP_ADDRESS,
        NULL AS ADMIN_HCP_ADDRESS_2,
        NULL AS ADMIN_HCP_CITY,
        NULL AS ADMIN_HCP_STATE,
        NULL AS ADMIN_HCP_ZIP,
        NULL AS SOC_NAME,
        NULL AS SOC_ID,
        NULL AS SOC_NPI,
        NULL AS SOC_ADDRESS,
        NULL AS SOC_CITY,
        NULL AS SOC_STATE,
        NULL AS SOC_ZIP,
        NULL AS SOC_PHONE,
        NULL AS SOC_FAX,
        NULL AS PAYER_NAME,
        NULL AS CLAIM_TYPE,
        NULL AS CPT_CODE,
        c.other_coverage_code AS COVERAGE_CODE
 FROM datamart.copay c
 WHERE ((c.basket_name = ANY (ARRAY['PROAIR RESPICLICK'::varchar(17), 'QNASL'::varchar(5), 'QNASL CHILDREN'::varchar(14), 'ZECUITY'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'ADIPEX'::varchar(6), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9), 'CINQAIR'::varchar(7)])) AND (c.report_frequency = 'WEEK'::varchar(4)) AND (c.fill_date < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) AND ((c.date_written < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) OR (c.date_written IS NULL)) AND (months_between(trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)), c.fill_date) <= 24::float)) UNION  SELECT coalesce(c.physician_veeva_id, c.physician_ims_id) AS VEEVA_ACCOUNT_ID,
        c.physician_ims_id AS IMS_ID,
        c.redemption_type AS REDEMPTION_TYPE,
        to_char(c.fill_date, 'YYYY-MM-DD'::varchar(10)) AS FILL_DATE,
        to_char(c.date_written, 'YYYY-MM-DD'::varchar(10)) AS HCP_DATE_WRITTEN,
        CASE mod(c.days_supply, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.days_supply)::varchar ELSE rtrim((c.days_supply)::varchar, '0'::varchar(1)) END AS DAYS_SUPPLY,
        c.ndc_code AS NDC_CODE,
        CASE WHEN (b.name = 'BDP NASAL MARKET TOTAL'::varchar(22)) THEN 'QNASL'::varchar(5) ELSE b.name END AS BRAND_NAME,
        CASE mod(c.quantity, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.quantity)::int)::varchar ELSE rtrim((c.quantity)::varchar, '0'::varchar(1)) END AS QTY,
        CASE mod(c.refills, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.refills)::varchar ELSE rtrim((c.refills)::varchar, '0'::varchar(1)) END AS REFILLS,
        c.program_number AS PROGRAM_NUM,
        c.copay_card_number AS COPAY_VOUCHER_NUM,
        c.pharmacy_chain_number AS PHARMACY_CHAIN_NUM,
        c.pharmacy_chain AS PHARMACY_CHAIN,
        c.pharmacy_name AS PHARMACY_NAME,
        c.pharmacy_address AS PHARMACY_ADDRESS,
        c.pharmacy_address2 AS PHARMACY_ADDRESS2,
        c.pharmacy_city AS PHARMACY_CITY,
        c.pharmacy_state AS PHARMACY_STATE,
        c.pharmacy_zip AS PHARMACY_ZIP,
        CASE mod(c.pharmacy_npi_num, 1::float) WHEN NULLSEQUAL 0::float THEN c.pharmacy_npi_num ELSE rtrim(c.pharmacy_npi_num, '0'::varchar(1)) END AS PHARMACY_NPI_NUM,
        NULL AS CEPH_ID,
        NULL AS ME_NUM,
        c.principle_physician_dea AS PRINCIPLE_PHYS_DEA_NUM,
        CASE mod(c.physician_npi, 1::float) WHEN NULLSEQUAL 0::float THEN c.physician_npi ELSE rtrim(c.physician_npi, '0'::varchar(1)) END AS PRINCIPLE_PHYS_NPI_NUM,
        c.physician_name AS PHYSICIAN_NAME,
        c.physician_address1 AS PHYSICIAN_ADDRESS1,
        c.physician_address2 AS PHYSICIAN_ADDRESS2,
        c.physician_city AS PHYSICIAN_CITY,
        c.physician_state AS PHYSICIAN_STATE,
        c.physician_zip AS PHYSICIAN_ZIP,
        CASE mod(c.rebate_amount, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.rebate_amount)::int)::varchar ELSE rtrim((c.rebate_amount)::varchar, '0'::varchar(1)) END AS REBATE_AMOUNT,
        CASE mod(c.member_cash_expense, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.member_cash_expense)::int)::varchar ELSE rtrim((c.member_cash_expense)::varchar, '0'::varchar(1)) END AS MEMBER_CASH_EXPENSE,
        CASE mod(c.submitted_cost, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.submitted_cost)::int)::varchar ELSE rtrim((c.submitted_cost)::varchar, '0'::varchar(1)) END AS SUBMITTED_COST,
        CASE mod(c.pharmacy_fee, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.pharmacy_fee)::int)::varchar ELSE rtrim((c.pharmacy_fee)::varchar, '0'::varchar(1)) END AS PHARMACY_FEE,
        CASE mod(c.total_amount_due, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.total_amount_due)::int)::varchar ELSE rtrim((c.total_amount_due)::varchar, '0'::varchar(1)) END AS TOTAL_AMOUNT_DUE,
        CASE mod(c.calc_awp, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((c.calc_awp)::int)::varchar ELSE rtrim((c.calc_awp)::varchar, '0'::varchar(1)) END AS CALC_AWP,
        c.occ_payment_type AS OCC_PAYMENT_TYPE,
        CASE mod(c.new_refill, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (c.new_refill)::varchar ELSE rtrim((c.new_refill)::varchar, '0'::varchar(1)) END AS NEW_REFILL,
        NULL AS ADMIN_HCP_NAME,
        NULL AS ADMIN_HCP_NPI,
        NULL AS ADMIN_HCP_ADDRESS,
        NULL AS ADMIN_HCP_ADDRESS_2,
        NULL AS ADMIN_HCP_CITY,
        NULL AS ADMIN_HCP_STATE,
        NULL AS ADMIN_HCP_ZIP,
        NULL AS SOC_NAME,
        NULL AS SOC_ID,
        NULL AS SOC_NPI,
        NULL AS SOC_ADDRESS,
        NULL AS SOC_CITY,
        NULL AS SOC_STATE,
        NULL AS SOC_ZIP,
        NULL AS SOC_PHONE,
        NULL AS SOC_FAX,
        NULL AS PAYER_NAME,
        NULL AS CLAIM_TYPE,
        NULL AS CPT_CODE,
        c.other_coverage_code
 FROM ((datamart.copay c LEFT  JOIN product.basket_item bi ON ((c.basket_id = bi.entity_id))) LEFT  JOIN product.basket b ON ((bi.basket_id = b.basket_id)))
 WHERE ((b.name = ANY (ARRAY['PROAIR RESPICLICK'::varchar(22), 'QNASL'::varchar(22), 'QNASL CHILDREN'::varchar(22), 'ZECUITY'::varchar(22), 'AMRIX'::varchar(22), 'ADIPEX-P'::varchar(22), 'TEV-TROPIN'::varchar(22), 'AZILECT'::varchar(22), 'QUARTETTE'::varchar(22), 'ADIPEX'::varchar(22), 'BDP NASAL MARKET TOTAL'::varchar(22), 'CINQAIR'::varchar(22), 'CINQAIR'::varchar(22)])) AND (c.report_frequency = 'WEEK'::varchar(4)) AND (c.fill_date < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) AND ((c.date_written < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) OR (c.date_written IS NULL)) AND (months_between(trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)), c.fill_date) <= 24::float));

CREATE  VIEW teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS AS
 SELECT btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.id) AS id,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.ownerid) AS ownerid,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.isdeleted) AS isdeleted,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.name) AS name,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.createddate))::timestamp END AS createddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.systemmodstamp))::timestamp END AS systemmodstamp,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastactivitydate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastactivitydate))::timestamp END AS lastactivitydate,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.assignment_end_date__c) AS assignment_end_date__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.assignment_start_date__c) AS assignment_start_date__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.assignment_status__c) AS assignment_status__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.assignment_type__c) AS assignment_type__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.global_employee_id__c) AS global_employee_id__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.rms_territory_name__c) AS rms_territory_name__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.rms_territory_number__c) AS rms_territory_number__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.employee__c) AS employee__c,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.batch_id,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.row_id,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src.update_ts
 FROM teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src;

CREATE  VIEW raw.ext_axtria_employee_assignment_status AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.assignment_end_date__c,
        src.assignment_start_date__c,
        src.assignment_status__c,
        src.assignment_type__c,
        src.global_employee_id__c,
        src.rms_territory_name__c,
        src.rms_territory_number__c,
        src.employee__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS'::varchar(37)))));

CREATE  VIEW outbound.zzz_samples_amrix AS
 SELECT dm.sales_force_id,
        dm.ptr_territory_num AS territory_num,
        dm.tvcmid,
        coalesce(sh.ims_id, xref.id_num) AS ims_id,
        sh.veeva_id,
        sh.ship_date,
        sh.teva_product_code AS product_code,
        sh.basket_name AS product,
        sh.ship_qty
 FROM ((( SELECT a.ims_id,
        a.veeva_id,
        a.ship_date,
        a.ship_qty,
        b.teva_product_code,
        b.name AS basket_name
 FROM (datamart.sample_shipment a JOIN product.basket b ON ((a.basket_id = b.basket_id)))
 WHERE ((b.teva_product_code ~~ 'A00%'::varchar(4)) AND (a.ship_date >= last_day(add_months((statement_timestamp())::timestamp, (-25)))) AND (a.ship_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))))) sh LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        tvcmid_xref.id_num,
        tvcmid_xref.id_type,
        tvcmid_xref.state,
        tvcmid_xref.file_id,
        tvcmid_xref.record_id
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))) xref ON ((sh.ims_id = xref.id_num))) LEFT  JOIN ( SELECT prescriber_combined_demographics.sales_force_id,
        prescriber_combined_demographics.ptr_territory_num,
        prescriber_combined_demographics.veeva_account_id,
        prescriber_combined_demographics.tvcmid
 FROM datamart.prescriber_combined_demographics
 WHERE ((prescriber_combined_demographics.sales_force_id = ANY (ARRAY['TP'::varchar(2), 'TC'::varchar(2)])) AND (prescriber_combined_demographics.veeva_account_id IS NOT NULL))) dm ON ((sh.veeva_id = dm.veeva_account_id)));

CREATE  VIEW teva_ingestion.EXT_ONC_ACCOUNT_TARGETS AS
 SELECT CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.ACCT_DEMO_ID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.ACCT_DEMO_ID))::int END AS ACCT_DEMO_ID,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.TARGET_TYPE) AS TARGET_TYPE,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.TARGET_VALUE) AS TARGET_VALUE,
        CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.APPLIES_FROM_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.APPLIES_FROM_DATE))::date END AS APPLIES_FROM_DATE,
        CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.APPLIES_TO_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.APPLIES_TO_DATE))::date END AS APPLIES_TO_DATE,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.ACTIVE_IND) AS ACTIVE_IND,
        CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.SYSTEM_START_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.SYSTEM_START_DATE))::date END AS SYSTEM_START_DATE,
        CASE WHEN (EXT_ONC_ACCOUNT_TARGETS_src.SYSTEM_END_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_ONC_ACCOUNT_TARGETS_src.SYSTEM_END_DATE))::date END AS SYSTEM_END_DATE,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.END_REASON) AS END_REASON,
        btrim(EXT_ONC_ACCOUNT_TARGETS_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        EXT_ONC_ACCOUNT_TARGETS_src.batch_id,
        EXT_ONC_ACCOUNT_TARGETS_src.row_id,
        EXT_ONC_ACCOUNT_TARGETS_src.update_ts
 FROM teva_ingestion.EXT_ONC_ACCOUNT_TARGETS_src;

CREATE  VIEW raw.ext_onc_account_targets AS
 SELECT src.TVCMID,
        src.SALES_FORCE_ID,
        src.PRODUCT_NAME,
        src.ACCT_DEMO_ID,
        src.IMS_OUTLET_CODE,
        src.TARGET_TYPE,
        src.TARGET_VALUE,
        src.APPLIES_FROM_DATE,
        src.APPLIES_TO_DATE,
        src.ACTIVE_IND,
        src.SYSTEM_START_DATE,
        src.SYSTEM_END_DATE,
        src.END_REASON,
        src.VEEVA_ACCOUNT_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_ACCOUNT_TARGETS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_ACCOUNT_TARGETS'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE AS
 SELECT btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.id) AS id,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.ownerid) AS ownerid,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.isdeleted) AS isdeleted,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.name) AS name,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.createddate))::timestamp END AS createddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.systemmodstamp))::timestamp END AS systemmodstamp,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastactivitydate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastactivitydate))::timestamp END AS lastactivitydate,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.birth_month_day__c) AS birth_month_day__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.business_mobile__c) AS business_mobile__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.business_phone__c) AS business_phone__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.cost_center_name__c) AS cost_center_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.demotion__c) AS demotion__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.ec_creation_date__c) AS ec_creation_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.ec_last_modified_date__c) AS ec_last_modified_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.ec_territory_id__c) AS ec_territory_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.email_address__c) AS email_address__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.employee_status__c) AS employee_status__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.first_name__c) AS first_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.full_part_time__c) AS full_part_time__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.global_employee_id__c) AS global_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.hire_date__c) AS hire_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_address_1__c) AS home_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_address_2__c) AS home_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_address_3__c) AS home_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_city_municipality__c) AS home_city_municipality__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_country__c) AS home_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_phone__c) AS home_phone__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_postal_code__c) AS home_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.home_state_province__c) AS home_state_province__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.job_code__c) AS job_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.job_grade__c) AS job_grade__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.loa_end_date__c) AS loa_end_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.loa_start_date__c) AS loa_start_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.last_name__c) AS last_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.local_employee_id__c) AS local_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_address_1__c) AS mailing_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_address_2__c) AS mailing_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_address_3__c) AS mailing_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_city__c) AS mailing_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_country__c) AS mailing_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_postal_code__c) AS mailing_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.mailing_state__c) AS mailing_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.middle_name__c) AS middle_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.name_suffix__c) AS name_suffix__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.oracle_string__c) AS oracle_string__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.payroll_id__c) AS payroll_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.position_title__c) AS position_title__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.preferred_name__c) AS preferred_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.promotion__c) AS promotion__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.reg_contract__c) AS reg_contract__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_eligibility_indicator__c) AS sample_eligibility_indicator__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_address_1__c) AS sample_shippingstorage_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_address_2__c) AS sample_shippingstorage_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_address_3__c) AS sample_shippingstorage_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_address_status__c) AS sample_shippingstorage_address_status__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_city__c) AS sample_shippingstorage_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_country__c) AS sample_shippingstorage_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_postal_code__c) AS sample_shippingstorage_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.sample_shippingstorage_state__c) AS sample_shippingstorage_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_address_1__c) AS shipping_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_address_2__c) AS shipping_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_address_3__c) AS shipping_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_city__c) AS shipping_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_country__c) AS shipping_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_postal_code__c) AS shipping_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.shipping_state__c) AS shipping_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.supervisor_global_employee_id__c) AS supervisor_global_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.transfer_date__c) AS transfer_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.uid__c) AS uid__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.windows_logon_id__c) AS windows_logon_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.teva_id__c) AS teva_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.employee_status_effective_date__c) AS employee_status_effective_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.separation_date__c) AS separation_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.separation_reason__c) AS separation_reason__c,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.batch_id,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.row_id,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src.update_ts
 FROM teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src;

CREATE  VIEW raw.ext_axtria_axtriasalesiqtm_employee AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.birth_month_day__c,
        src.business_mobile__c,
        src.business_phone__c,
        src.cost_center_name__c,
        src.demotion__c,
        src.ec_creation_date__c,
        src.ec_last_modified_date__c,
        src.ec_territory_id__c,
        src.email_address__c,
        src.employee_status__c,
        src.first_name__c,
        src.full_part_time__c,
        src.global_employee_id__c,
        src.hire_date__c,
        src.home_address_1__c,
        src.home_address_2__c,
        src.home_address_3__c,
        src.home_city_municipality__c,
        src.home_country__c,
        src.home_phone__c,
        src.home_postal_code__c,
        src.home_state_province__c,
        src.job_code__c,
        src.job_grade__c,
        src.loa_end_date__c,
        src.loa_start_date__c,
        src.last_name__c,
        src.local_employee_id__c,
        src.mailing_address_1__c,
        src.mailing_address_2__c,
        src.mailing_address_3__c,
        src.mailing_city__c,
        src.mailing_country__c,
        src.mailing_postal_code__c,
        src.mailing_state__c,
        src.middle_name__c,
        src.name_suffix__c,
        src.oracle_string__c,
        src.payroll_id__c,
        src.position_title__c,
        src.preferred_name__c,
        src.promotion__c,
        src.reg_contract__c,
        src.sample_eligibility_indicator__c,
        src.sample_shippingstorage_address_1__c,
        src.sample_shippingstorage_address_2__c,
        src.sample_shippingstorage_address_3__c,
        src.sample_shippingstorage_address_status__c,
        src.sample_shippingstorage_city__c,
        src.sample_shippingstorage_country__c,
        src.sample_shippingstorage_postal_code__c,
        src.sample_shippingstorage_state__c,
        src.shipping_address_1__c,
        src.shipping_address_2__c,
        src.shipping_address_3__c,
        src.shipping_city__c,
        src.shipping_country__c,
        src.shipping_postal_code__c,
        src.shipping_state__c,
        src.supervisor_global_employee_id__c,
        src.transfer_date__c,
        src.uid__c,
        src.windows_logon_id__c,
        src.teva_id__c,
        src.employee_status_effective_date__c,
        src.separation_date__c,
        src.separation_reason__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE'::varchar(35)))));

CREATE  VIEW sandbox.V_HCOS_KAISER_PROF_AFFIL AS
 SELECT hcp.tvcmid AS TVCMID,
        p.ims_id AS IMS_ID,
        p.npi AS NPI,
        p.all_dea AS ALL_DEA,
        p.last_name AS LAST_NAME,
        p.first_name AS FIRST_NAME,
        p.middle_name AS MIDDLE_NAME,
        at.affil_type_desc AS AFFIL_TYPE_DESC,
        b.ims_org_id AS IMS_FACILITY_NUMBER,
        b.cot_facility_type AS COT_FACILITY_TYPE,
        b.business_name AS BUSINESS_NAME,
        b.physical_addr_1 AS PHYSICAL_ADDR_1,
        b.physical_addr_2 AS PHYSICAL_ADDR_2,
        b.physical_city AS PHYSICAL_CITY,
        b.physical_state AS PHYSICAL_STATE,
        b.physical_zip AS PHYSICAL_ZIP
 FROM (((((( SELECT bx.ims_org_id,
        bx.cot_facility_type,
        bx.business_name,
        bx.physical_addr_1,
        bx.physical_addr_2,
        bx.physical_city,
        bx.physical_state,
        bx.physical_zip
 FROM hcos.ims_hcos_business bx
 WHERE (bx.file_id = ( SELECT max(ims_hcos_business.file_id) AS file_id
 FROM hcos.ims_hcos_business))) b JOIN ( SELECT pafx.ims_org_id,
        pafx.hce_id_prfsnl,
        pafx.affil_type_id
 FROM hcos.ims_hcos_provider_affiliation_fact pafx
 WHERE (pafx.file_id = ( SELECT max(ims_hcos_provider_affiliation_fact.file_id) AS file_id
 FROM hcos.ims_hcos_provider_affiliation_fact))) paf ON ((b.ims_org_id = paf.ims_org_id))) JOIN ( SELECT px.ims_id,
        px.npi,
        px.all_dea,
        px.last_name,
        px.first_name,
        px.middle_name,
        px.hce_id_prfsnl
 FROM hcos.ims_hcos_professional px
 WHERE (px.file_id = ( SELECT max(ims_hcos_professional.file_id) AS file_id
 FROM hcos.ims_hcos_professional))) p ON ((paf.hce_id_prfsnl = p.hce_id_prfsnl))) LEFT  JOIN ( SELECT atx.affil_type_id,
        atx.affil_type_desc
 FROM hcos.ims_hcos_affiliation_type atx
 WHERE (atx.file_id = ( SELECT max(ims_hcos_affiliation_type.file_id) AS file_id
 FROM hcos.ims_hcos_affiliation_type))) at ON ((paf.affil_type_id = at.affil_type_id))) JOIN ( SELECT rfx.ims_org_id_child,
        rfx.ims_org_id_parent
 FROM hcos.ims_hcos_relationship_fact rfx
 WHERE (rfx.file_id = ( SELECT max(ims_hcos_relationship_fact.file_id) AS max
 FROM hcos.ims_hcos_relationship_fact))) rf ON ((b.ims_org_id = rf.ims_org_id_child))) LEFT  JOIN mdm.hcp hcp ON ((p.ims_id = hcp.ims_prescriber_id)))
 WHERE (rf.ims_org_id_parent = 'INS00000226'::varchar(11));

CREATE  VIEW teva_ingestion.EXT_PROGNOS_CINQAIR AS
 SELECT btrim(EXT_PROGNOS_CINQAIR_src.week_end_date) AS week_end_date,
        btrim(EXT_PROGNOS_CINQAIR_src.practice_name) AS practice_name,
        btrim(EXT_PROGNOS_CINQAIR_src.practice_address_line_1) AS practice_address_line_1,
        btrim(EXT_PROGNOS_CINQAIR_src.pracitce_address_line_2) AS pracitce_address_line_2,
        btrim(EXT_PROGNOS_CINQAIR_src.city) AS city,
        btrim(EXT_PROGNOS_CINQAIR_src.state) AS state,
        btrim(EXT_PROGNOS_CINQAIR_src.zip_code) AS zip_code,
        btrim(EXT_PROGNOS_CINQAIR_src.provider_first_name) AS provider_first_name,
        btrim(EXT_PROGNOS_CINQAIR_src.provider_last_name) AS provider_last_name,
        btrim(EXT_PROGNOS_CINQAIR_src.npi) AS npi,
        btrim(EXT_PROGNOS_CINQAIR_src.specialty_1) AS specialty_1,
        btrim(EXT_PROGNOS_CINQAIR_src.specialty_2) AS specialty_2,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_0_149 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_0_149))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_0_149,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_150_399 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_150_399))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_150_399,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_0_149 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_0_149))::int END AS pts_with_ao_asthma_and_eosinophils_0_149,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_150_399 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_150_399))::int END AS pts_with_ao_asthma_and_eosinophils_150_399,
        CASE WHEN (EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_400_or_greater = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_src.pts_with_ao_asthma_and_eosinophils_400_or_greater))::int END AS pts_with_ao_asthma_and_eosinophils_400_or_greater,
        EXT_PROGNOS_CINQAIR_src.batch_id,
        EXT_PROGNOS_CINQAIR_src.row_id,
        EXT_PROGNOS_CINQAIR_src.update_ts
 FROM teva_ingestion.EXT_PROGNOS_CINQAIR_src;

CREATE  VIEW raw.ext_prognos_cinqair AS
 SELECT src.week_end_date,
        src.practice_name,
        src.practice_address_line_1,
        src.pracitce_address_line_2,
        src.city,
        src.state,
        src.zip_code,
        src.provider_first_name,
        src.provider_last_name,
        src.npi,
        src.specialty_1,
        src.specialty_2,
        src.pts_with_moderate_severe_asthma_and_eosinophils_0_149,
        src.pts_with_moderate_severe_asthma_and_eosinophils_150_399,
        src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
        src.pts_with_ao_asthma_and_eosinophils_0_149,
        src.pts_with_ao_asthma_and_eosinophils_150_399,
        src.pts_with_ao_asthma_and_eosinophils_400_or_greater,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PROGNOS_CINQAIR_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PROGNOS_CINQAIR'::varchar(19)))));

CREATE  VIEW teva_ingestion.ext_tw_anda_sales AS
 SELECT btrim(ext_tw_anda_sales_src.YEAR) AS YEAR,
        btrim(ext_tw_anda_sales_src.SALES_MONTH) AS SALES_MONTH,
        btrim(ext_tw_anda_sales_src.SALES_DATE) AS SALES_DATE,
        btrim(ext_tw_anda_sales_src.CUSTOMER_NO) AS CUSTOMER_NO,
        btrim(ext_tw_anda_sales_src.CUSTOMER) AS CUSTOMER,
        btrim(ext_tw_anda_sales_src.CUSTOMER_ADDRESS_LINE1) AS CUSTOMER_ADDRESS_LINE1,
        btrim(ext_tw_anda_sales_src.CUSTOMER_ADDRESS_LINE2) AS CUSTOMER_ADDRESS_LINE2,
        btrim(ext_tw_anda_sales_src.CITY) AS CITY,
        btrim(ext_tw_anda_sales_src.STATE) AS STATE,
        btrim(ext_tw_anda_sales_src.ZIP) AS ZIP,
        btrim(ext_tw_anda_sales_src.BILL_CUSTOMER_NO) AS BILL_CUSTOMER_NO,
        btrim(ext_tw_anda_sales_src.BILL_ADDRESS_LINE1) AS BILL_ADDRESS_LINE1,
        btrim(ext_tw_anda_sales_src.BILL_ADDRESS_LINE2) AS BILL_ADDRESS_LINE2,
        btrim(ext_tw_anda_sales_src.BILL_CITY) AS BILL_CITY,
        btrim(ext_tw_anda_sales_src.BILL_STATE) AS BILL_STATE,
        btrim(ext_tw_anda_sales_src.BILL_ZIP) AS BILL_ZIP,
        btrim(ext_tw_anda_sales_src.CUSTOMER_TYPE_CD) AS CUSTOMER_TYPE_CD,
        btrim(ext_tw_anda_sales_src.CUSTOMER_TYPE) AS CUSTOMER_TYPE,
        btrim(ext_tw_anda_sales_src.PVP_340B_ID) AS PVP_340B_ID,
        btrim(ext_tw_anda_sales_src.TRADE_CLASS) AS TRADE_CLASS,
        btrim(ext_tw_anda_sales_src.HEALTH_INDUSTRY_NO) AS HEALTH_INDUSTRY_NO,
        btrim(ext_tw_anda_sales_src.DEA_REGISTRATION_NO) AS DEA_REGISTRATION_NO,
        btrim(ext_tw_anda_sales_src.DEA_REGISTRATION_EXPIRATION) AS DEA_REGISTRATION_EXPIRATION,
        btrim(ext_tw_anda_sales_src.STATE_LICENSE) AS STATE_LICENSE,
        btrim(ext_tw_anda_sales_src.STATE_LICENSE_EXPIRATION) AS STATE_LICENSE_EXPIRATION,
        btrim(ext_tw_anda_sales_src.ITEM_NO) AS ITEM_NO,
        btrim(ext_tw_anda_sales_src.NDC) AS NDC,
        btrim(ext_tw_anda_sales_src.BRAND) AS BRAND,
        btrim(ext_tw_anda_sales_src.PACKAGE_SIZE) AS PACKAGE_SIZE,
        btrim(ext_tw_anda_sales_src.VENDOR) AS VENDOR,
        btrim(ext_tw_anda_sales_src.DOCUMENT_NO) AS DOCUMENT_NO,
        btrim(ext_tw_anda_sales_src.ORDER_NO) AS ORDER_NO,
        btrim(ext_tw_anda_sales_src.UNITS_NET) AS UNITS_NET,
        btrim(ext_tw_anda_sales_src.NET_COST) AS NET_COST,
        btrim(ext_tw_anda_sales_src.NET_SALES_AMT) AS NET_SALES_AMT,
        ext_tw_anda_sales_src.batch_id,
        ext_tw_anda_sales_src.row_id,
        ext_tw_anda_sales_src.update_ts
 FROM teva_ingestion.ext_tw_anda_sales_src;

CREATE  VIEW raw.ext_tw_anda_sales AS
 SELECT src.YEAR,
        src.SALES_MONTH,
        src.SALES_DATE,
        src.CUSTOMER_NO,
        src.CUSTOMER,
        src.CUSTOMER_ADDRESS_LINE1,
        src.CUSTOMER_ADDRESS_LINE2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.BILL_CUSTOMER_NO,
        src.BILL_ADDRESS_LINE1,
        src.BILL_ADDRESS_LINE2,
        src.BILL_CITY,
        src.BILL_STATE,
        src.BILL_ZIP,
        src.CUSTOMER_TYPE_CD,
        src.CUSTOMER_TYPE,
        src.PVP_340B_ID,
        src.TRADE_CLASS,
        src.HEALTH_INDUSTRY_NO,
        src.DEA_REGISTRATION_NO,
        src.DEA_REGISTRATION_EXPIRATION,
        src.STATE_LICENSE,
        src.STATE_LICENSE_EXPIRATION,
        src.ITEM_NO,
        src.NDC,
        src.BRAND,
        src.PACKAGE_SIZE,
        src.VENDOR,
        src.DOCUMENT_NO,
        src.ORDER_NO,
        src.UNITS_NET,
        src.NET_COST,
        src.NET_SALES_AMT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_tw_anda_sales_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_ANDA_SALES'::varchar(17)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FR61 AS
 SELECT btrim(EXT_IMS_FR61_src.ddd_outlet_number) AS ddd_outlet_number,
        btrim(EXT_IMS_FR61_src.subcategory_code) AS subcategory_code,
        btrim(EXT_IMS_FR61_src.ddd_outlet_name) AS ddd_outlet_name,
        btrim(EXT_IMS_FR61_src.ddd_outlet_address) AS ddd_outlet_address,
        btrim(EXT_IMS_FR61_src.city) AS city,
        btrim(EXT_IMS_FR61_src.state) AS state,
        btrim(EXT_IMS_FR61_src.activity_date) AS activity_date,
        btrim(EXT_IMS_FR61_src.dea_number) AS dea_number,
        btrim(EXT_IMS_FR61_src.blank1) AS blank1,
        btrim(EXT_IMS_FR61_src.blank2) AS blank2,
        btrim(EXT_IMS_FR61_src.outlet_status) AS outlet_status,
        EXT_IMS_FR61_src.batch_id,
        EXT_IMS_FR61_src.row_id,
        EXT_IMS_FR61_src.update_ts
 FROM teva_ingestion.EXT_IMS_FR61_src;

CREATE  VIEW raw.ext_ims_fr61 AS
 SELECT src.ddd_outlet_number,
        src.subcategory_code,
        src.ddd_outlet_name,
        src.ddd_outlet_address,
        src.city,
        src.state,
        src.activity_date,
        src.dea_number,
        src.blank1,
        src.blank2,
        src.outlet_status,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FR61_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FR61'::varchar(12)))));

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CNT_M_ADHOC AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.address) AS address,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.city) AS city,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.state) AS state,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_ADHOC_src.trx_024))::numeric(9,3) END AS trx_024,
        EXT_IMS_MHJ_CNT_M_ADHOC_src.batch_id,
        EXT_IMS_MHJ_CNT_M_ADHOC_src.row_id,
        EXT_IMS_MHJ_CNT_M_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CNT_M_ADHOC_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CNT_W_ADHOC AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.address) AS address,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.city) AS city,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.state) AS state,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_025))::numeric(9,3) END AS nrx_025,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_026))::numeric(9,3) END AS nrx_026,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_027))::numeric(9,3) END AS nrx_027,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_028))::numeric(9,3) END AS nrx_028,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_029))::numeric(9,3) END AS nrx_029,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_030))::numeric(9,3) END AS nrx_030,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_031))::numeric(9,3) END AS nrx_031,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_032))::numeric(9,3) END AS nrx_032,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_033))::numeric(9,3) END AS nrx_033,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_034))::numeric(9,3) END AS nrx_034,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_035))::numeric(9,3) END AS nrx_035,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_036))::numeric(9,3) END AS nrx_036,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_037))::numeric(9,3) END AS nrx_037,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_038))::numeric(9,3) END AS nrx_038,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_039))::numeric(9,3) END AS nrx_039,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_040))::numeric(9,3) END AS nrx_040,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_041))::numeric(9,3) END AS nrx_041,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_042))::numeric(9,3) END AS nrx_042,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_043))::numeric(9,3) END AS nrx_043,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_044))::numeric(9,3) END AS nrx_044,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_045))::numeric(9,3) END AS nrx_045,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_046))::numeric(9,3) END AS nrx_046,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_047))::numeric(9,3) END AS nrx_047,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_048))::numeric(9,3) END AS nrx_048,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_049))::numeric(9,3) END AS nrx_049,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_050))::numeric(9,3) END AS nrx_050,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_051))::numeric(9,3) END AS nrx_051,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_052))::numeric(9,3) END AS nrx_052,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_053))::numeric(9,3) END AS nrx_053,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_054))::numeric(9,3) END AS nrx_054,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_055))::numeric(9,3) END AS nrx_055,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_056))::numeric(9,3) END AS nrx_056,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_057))::numeric(9,3) END AS nrx_057,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_058))::numeric(9,3) END AS nrx_058,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_059))::numeric(9,3) END AS nrx_059,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_060))::numeric(9,3) END AS nrx_060,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_061))::numeric(9,3) END AS nrx_061,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_062))::numeric(9,3) END AS nrx_062,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_063))::numeric(9,3) END AS nrx_063,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_064))::numeric(9,3) END AS nrx_064,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_065))::numeric(9,3) END AS nrx_065,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_066))::numeric(9,3) END AS nrx_066,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_067))::numeric(9,3) END AS nrx_067,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_068))::numeric(9,3) END AS nrx_068,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_069))::numeric(9,3) END AS nrx_069,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_070))::numeric(9,3) END AS nrx_070,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_071))::numeric(9,3) END AS nrx_071,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_072))::numeric(9,3) END AS nrx_072,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_073))::numeric(9,3) END AS nrx_073,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_074))::numeric(9,3) END AS nrx_074,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_075))::numeric(9,3) END AS nrx_075,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_076))::numeric(9,3) END AS nrx_076,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_077))::numeric(9,3) END AS nrx_077,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_078))::numeric(9,3) END AS nrx_078,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_079))::numeric(9,3) END AS nrx_079,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_080))::numeric(9,3) END AS nrx_080,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_081))::numeric(9,3) END AS nrx_081,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_082))::numeric(9,3) END AS nrx_082,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_083))::numeric(9,3) END AS nrx_083,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_084))::numeric(9,3) END AS nrx_084,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_085))::numeric(9,3) END AS nrx_085,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_086))::numeric(9,3) END AS nrx_086,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_087))::numeric(9,3) END AS nrx_087,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_088))::numeric(9,3) END AS nrx_088,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_089))::numeric(9,3) END AS nrx_089,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_090))::numeric(9,3) END AS nrx_090,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_091))::numeric(9,3) END AS nrx_091,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_092))::numeric(9,3) END AS nrx_092,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_093))::numeric(9,3) END AS nrx_093,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_094))::numeric(9,3) END AS nrx_094,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_095))::numeric(9,3) END AS nrx_095,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_096))::numeric(9,3) END AS nrx_096,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_097))::numeric(9,3) END AS nrx_097,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_098))::numeric(9,3) END AS nrx_098,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_099))::numeric(9,3) END AS nrx_099,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_100))::numeric(9,3) END AS nrx_100,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_101))::numeric(9,3) END AS nrx_101,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_102))::numeric(9,3) END AS nrx_102,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_103))::numeric(9,3) END AS nrx_103,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_104))::numeric(9,3) END AS nrx_104,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_105))::numeric(9,3) END AS nrx_105,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_106))::numeric(9,3) END AS nrx_106,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_107))::numeric(9,3) END AS nrx_107,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_108))::numeric(9,3) END AS nrx_108,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_109))::numeric(9,3) END AS nrx_109,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_110))::numeric(9,3) END AS nrx_110,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_111))::numeric(9,3) END AS nrx_111,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_112))::numeric(9,3) END AS nrx_112,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_113))::numeric(9,3) END AS nrx_113,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_114))::numeric(9,3) END AS nrx_114,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_115))::numeric(9,3) END AS nrx_115,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_116))::numeric(9,3) END AS nrx_116,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_117))::numeric(9,3) END AS nrx_117,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_118))::numeric(9,3) END AS nrx_118,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_119))::numeric(9,3) END AS nrx_119,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_120))::numeric(9,3) END AS nrx_120,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_121))::numeric(9,3) END AS nrx_121,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_122))::numeric(9,3) END AS nrx_122,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_123))::numeric(9,3) END AS nrx_123,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_124))::numeric(9,3) END AS nrx_124,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_125))::numeric(9,3) END AS nrx_125,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_126))::numeric(9,3) END AS nrx_126,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_127))::numeric(9,3) END AS nrx_127,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_128))::numeric(9,3) END AS nrx_128,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_129))::numeric(9,3) END AS nrx_129,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_130))::numeric(9,3) END AS nrx_130,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_131))::numeric(9,3) END AS nrx_131,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.nrx_132))::numeric(9,3) END AS nrx_132,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_024))::numeric(9,3) END AS trx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_025))::numeric(9,3) END AS trx_025,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_026))::numeric(9,3) END AS trx_026,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_027))::numeric(9,3) END AS trx_027,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_028))::numeric(9,3) END AS trx_028,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_029))::numeric(9,3) END AS trx_029,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_030))::numeric(9,3) END AS trx_030,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_031))::numeric(9,3) END AS trx_031,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_032))::numeric(9,3) END AS trx_032,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_033))::numeric(9,3) END AS trx_033,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_034))::numeric(9,3) END AS trx_034,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_035))::numeric(9,3) END AS trx_035,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_036))::numeric(9,3) END AS trx_036,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_037))::numeric(9,3) END AS trx_037,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_038))::numeric(9,3) END AS trx_038,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_039))::numeric(9,3) END AS trx_039,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_040))::numeric(9,3) END AS trx_040,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_041))::numeric(9,3) END AS trx_041,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_042))::numeric(9,3) END AS trx_042,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_043))::numeric(9,3) END AS trx_043,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_044))::numeric(9,3) END AS trx_044,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_045))::numeric(9,3) END AS trx_045,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_046))::numeric(9,3) END AS trx_046,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_047))::numeric(9,3) END AS trx_047,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_048))::numeric(9,3) END AS trx_048,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_049))::numeric(9,3) END AS trx_049,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_050))::numeric(9,3) END AS trx_050,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_051))::numeric(9,3) END AS trx_051,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_052))::numeric(9,3) END AS trx_052,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_053))::numeric(9,3) END AS trx_053,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_054))::numeric(9,3) END AS trx_054,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_055))::numeric(9,3) END AS trx_055,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_056))::numeric(9,3) END AS trx_056,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_057))::numeric(9,3) END AS trx_057,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_058))::numeric(9,3) END AS trx_058,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_059))::numeric(9,3) END AS trx_059,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_060))::numeric(9,3) END AS trx_060,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_061))::numeric(9,3) END AS trx_061,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_062))::numeric(9,3) END AS trx_062,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_063))::numeric(9,3) END AS trx_063,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_064))::numeric(9,3) END AS trx_064,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_065))::numeric(9,3) END AS trx_065,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_066))::numeric(9,3) END AS trx_066,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_067))::numeric(9,3) END AS trx_067,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_068))::numeric(9,3) END AS trx_068,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_069))::numeric(9,3) END AS trx_069,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_070))::numeric(9,3) END AS trx_070,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_071))::numeric(9,3) END AS trx_071,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_072))::numeric(9,3) END AS trx_072,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_073))::numeric(9,3) END AS trx_073,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_074))::numeric(9,3) END AS trx_074,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_075))::numeric(9,3) END AS trx_075,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_076))::numeric(9,3) END AS trx_076,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_077))::numeric(9,3) END AS trx_077,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_078))::numeric(9,3) END AS trx_078,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_079))::numeric(9,3) END AS trx_079,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_080))::numeric(9,3) END AS trx_080,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_081))::numeric(9,3) END AS trx_081,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_082))::numeric(9,3) END AS trx_082,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_083))::numeric(9,3) END AS trx_083,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_084))::numeric(9,3) END AS trx_084,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_085))::numeric(9,3) END AS trx_085,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_086))::numeric(9,3) END AS trx_086,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_087))::numeric(9,3) END AS trx_087,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_088))::numeric(9,3) END AS trx_088,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_089))::numeric(9,3) END AS trx_089,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_090))::numeric(9,3) END AS trx_090,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_091))::numeric(9,3) END AS trx_091,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_092))::numeric(9,3) END AS trx_092,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_093))::numeric(9,3) END AS trx_093,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_094))::numeric(9,3) END AS trx_094,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_095))::numeric(9,3) END AS trx_095,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_096))::numeric(9,3) END AS trx_096,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_097))::numeric(9,3) END AS trx_097,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_098))::numeric(9,3) END AS trx_098,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_099))::numeric(9,3) END AS trx_099,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_100))::numeric(9,3) END AS trx_100,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_101))::numeric(9,3) END AS trx_101,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_102))::numeric(9,3) END AS trx_102,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_103))::numeric(9,3) END AS trx_103,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_104))::numeric(9,3) END AS trx_104,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_105))::numeric(9,3) END AS trx_105,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_106))::numeric(9,3) END AS trx_106,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_107))::numeric(9,3) END AS trx_107,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_108))::numeric(9,3) END AS trx_108,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_109))::numeric(9,3) END AS trx_109,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_110))::numeric(9,3) END AS trx_110,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_111))::numeric(9,3) END AS trx_111,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_112))::numeric(9,3) END AS trx_112,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_113))::numeric(9,3) END AS trx_113,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_114))::numeric(9,3) END AS trx_114,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_115))::numeric(9,3) END AS trx_115,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_116))::numeric(9,3) END AS trx_116,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_117))::numeric(9,3) END AS trx_117,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_118))::numeric(9,3) END AS trx_118,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_119))::numeric(9,3) END AS trx_119,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_120))::numeric(9,3) END AS trx_120,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_121))::numeric(9,3) END AS trx_121,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_122))::numeric(9,3) END AS trx_122,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_123))::numeric(9,3) END AS trx_123,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_124))::numeric(9,3) END AS trx_124,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_125))::numeric(9,3) END AS trx_125,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_126))::numeric(9,3) END AS trx_126,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_127))::numeric(9,3) END AS trx_127,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_128))::numeric(9,3) END AS trx_128,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_129))::numeric(9,3) END AS trx_129,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_130))::numeric(9,3) END AS trx_130,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_131))::numeric(9,3) END AS trx_131,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_ADHOC_src.trx_132))::numeric(9,3) END AS trx_132,
        EXT_IMS_MHJ_CNT_W_ADHOC_src.batch_id,
        EXT_IMS_MHJ_CNT_W_ADHOC_src.row_id,
        EXT_IMS_MHJ_CNT_W_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CNT_W_ADHOC_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_QTY_M_ADHOC AS
 SELECT CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.address) AS address,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.city) AS city,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.state) AS state,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_ADHOC_src.trx_024))::numeric(9,3) END AS trx_024,
        EXT_IMS_MHJ_QTY_M_ADHOC_src.batch_id,
        EXT_IMS_MHJ_QTY_M_ADHOC_src.row_id,
        EXT_IMS_MHJ_QTY_M_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_QTY_M_ADHOC_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_QTY_W_ADHOC AS
 SELECT CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.address) AS address,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.city) AS city,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.state) AS state,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_025))::numeric(9,3) END AS nrx_025,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_026))::numeric(9,3) END AS nrx_026,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_027))::numeric(9,3) END AS nrx_027,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_028))::numeric(9,3) END AS nrx_028,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_029))::numeric(9,3) END AS nrx_029,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_030))::numeric(9,3) END AS nrx_030,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_031))::numeric(9,3) END AS nrx_031,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_032))::numeric(9,3) END AS nrx_032,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_033))::numeric(9,3) END AS nrx_033,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_034))::numeric(9,3) END AS nrx_034,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_035))::numeric(9,3) END AS nrx_035,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_036))::numeric(9,3) END AS nrx_036,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_037))::numeric(9,3) END AS nrx_037,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_038))::numeric(9,3) END AS nrx_038,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_039))::numeric(9,3) END AS nrx_039,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_040))::numeric(9,3) END AS nrx_040,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_041))::numeric(9,3) END AS nrx_041,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_042))::numeric(9,3) END AS nrx_042,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_043))::numeric(9,3) END AS nrx_043,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_044))::numeric(9,3) END AS nrx_044,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_045))::numeric(9,3) END AS nrx_045,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_046))::numeric(9,3) END AS nrx_046,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_047))::numeric(9,3) END AS nrx_047,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_048))::numeric(9,3) END AS nrx_048,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_049))::numeric(9,3) END AS nrx_049,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_050))::numeric(9,3) END AS nrx_050,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_051))::numeric(9,3) END AS nrx_051,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_052))::numeric(9,3) END AS nrx_052,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_053))::numeric(9,3) END AS nrx_053,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_054))::numeric(9,3) END AS nrx_054,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_055))::numeric(9,3) END AS nrx_055,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_056))::numeric(9,3) END AS nrx_056,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_057))::numeric(9,3) END AS nrx_057,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_058))::numeric(9,3) END AS nrx_058,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_059))::numeric(9,3) END AS nrx_059,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_060))::numeric(9,3) END AS nrx_060,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_061))::numeric(9,3) END AS nrx_061,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_062))::numeric(9,3) END AS nrx_062,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_063))::numeric(9,3) END AS nrx_063,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_064))::numeric(9,3) END AS nrx_064,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_065))::numeric(9,3) END AS nrx_065,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_066))::numeric(9,3) END AS nrx_066,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_067))::numeric(9,3) END AS nrx_067,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_068))::numeric(9,3) END AS nrx_068,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_069))::numeric(9,3) END AS nrx_069,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_070))::numeric(9,3) END AS nrx_070,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_071))::numeric(9,3) END AS nrx_071,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_072))::numeric(9,3) END AS nrx_072,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_073))::numeric(9,3) END AS nrx_073,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_074))::numeric(9,3) END AS nrx_074,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_075))::numeric(9,3) END AS nrx_075,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_076))::numeric(9,3) END AS nrx_076,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_077))::numeric(9,3) END AS nrx_077,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_078))::numeric(9,3) END AS nrx_078,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_079))::numeric(9,3) END AS nrx_079,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_080))::numeric(9,3) END AS nrx_080,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_081))::numeric(9,3) END AS nrx_081,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_082))::numeric(9,3) END AS nrx_082,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_083))::numeric(9,3) END AS nrx_083,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_084))::numeric(9,3) END AS nrx_084,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_085))::numeric(9,3) END AS nrx_085,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_086))::numeric(9,3) END AS nrx_086,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_087))::numeric(9,3) END AS nrx_087,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_088))::numeric(9,3) END AS nrx_088,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_089))::numeric(9,3) END AS nrx_089,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_090))::numeric(9,3) END AS nrx_090,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_091))::numeric(9,3) END AS nrx_091,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_092))::numeric(9,3) END AS nrx_092,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_093))::numeric(9,3) END AS nrx_093,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_094))::numeric(9,3) END AS nrx_094,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_095))::numeric(9,3) END AS nrx_095,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_096))::numeric(9,3) END AS nrx_096,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_097))::numeric(9,3) END AS nrx_097,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_098))::numeric(9,3) END AS nrx_098,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_099))::numeric(9,3) END AS nrx_099,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_100))::numeric(9,3) END AS nrx_100,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_101))::numeric(9,3) END AS nrx_101,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_102))::numeric(9,3) END AS nrx_102,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_103))::numeric(9,3) END AS nrx_103,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_104))::numeric(9,3) END AS nrx_104,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_105))::numeric(9,3) END AS nrx_105,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_106))::numeric(9,3) END AS nrx_106,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_107))::numeric(9,3) END AS nrx_107,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_108))::numeric(9,3) END AS nrx_108,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_109))::numeric(9,3) END AS nrx_109,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_110))::numeric(9,3) END AS nrx_110,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_111))::numeric(9,3) END AS nrx_111,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_112))::numeric(9,3) END AS nrx_112,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_113))::numeric(9,3) END AS nrx_113,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_114))::numeric(9,3) END AS nrx_114,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_115))::numeric(9,3) END AS nrx_115,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_116))::numeric(9,3) END AS nrx_116,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_117))::numeric(9,3) END AS nrx_117,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_118))::numeric(9,3) END AS nrx_118,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_119))::numeric(9,3) END AS nrx_119,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_120))::numeric(9,3) END AS nrx_120,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_121))::numeric(9,3) END AS nrx_121,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_122))::numeric(9,3) END AS nrx_122,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_123))::numeric(9,3) END AS nrx_123,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_124))::numeric(9,3) END AS nrx_124,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_125))::numeric(9,3) END AS nrx_125,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_126))::numeric(9,3) END AS nrx_126,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_127))::numeric(9,3) END AS nrx_127,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_128))::numeric(9,3) END AS nrx_128,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_129))::numeric(9,3) END AS nrx_129,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_130))::numeric(9,3) END AS nrx_130,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_131))::numeric(9,3) END AS nrx_131,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.nrx_132))::numeric(9,3) END AS nrx_132,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_024))::numeric(9,3) END AS trx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_025))::numeric(9,3) END AS trx_025,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_026))::numeric(9,3) END AS trx_026,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_027))::numeric(9,3) END AS trx_027,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_028))::numeric(9,3) END AS trx_028,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_029))::numeric(9,3) END AS trx_029,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_030))::numeric(9,3) END AS trx_030,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_031))::numeric(9,3) END AS trx_031,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_032))::numeric(9,3) END AS trx_032,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_033))::numeric(9,3) END AS trx_033,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_034))::numeric(9,3) END AS trx_034,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_035))::numeric(9,3) END AS trx_035,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_036))::numeric(9,3) END AS trx_036,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_037))::numeric(9,3) END AS trx_037,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_038))::numeric(9,3) END AS trx_038,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_039))::numeric(9,3) END AS trx_039,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_040))::numeric(9,3) END AS trx_040,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_041))::numeric(9,3) END AS trx_041,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_042))::numeric(9,3) END AS trx_042,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_043))::numeric(9,3) END AS trx_043,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_044))::numeric(9,3) END AS trx_044,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_045))::numeric(9,3) END AS trx_045,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_046))::numeric(9,3) END AS trx_046,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_047))::numeric(9,3) END AS trx_047,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_048))::numeric(9,3) END AS trx_048,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_049))::numeric(9,3) END AS trx_049,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_050))::numeric(9,3) END AS trx_050,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_051))::numeric(9,3) END AS trx_051,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_052))::numeric(9,3) END AS trx_052,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_053))::numeric(9,3) END AS trx_053,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_054))::numeric(9,3) END AS trx_054,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_055))::numeric(9,3) END AS trx_055,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_056))::numeric(9,3) END AS trx_056,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_057))::numeric(9,3) END AS trx_057,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_058))::numeric(9,3) END AS trx_058,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_059))::numeric(9,3) END AS trx_059,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_060))::numeric(9,3) END AS trx_060,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_061))::numeric(9,3) END AS trx_061,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_062))::numeric(9,3) END AS trx_062,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_063))::numeric(9,3) END AS trx_063,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_064))::numeric(9,3) END AS trx_064,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_065))::numeric(9,3) END AS trx_065,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_066))::numeric(9,3) END AS trx_066,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_067))::numeric(9,3) END AS trx_067,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_068))::numeric(9,3) END AS trx_068,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_069))::numeric(9,3) END AS trx_069,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_070))::numeric(9,3) END AS trx_070,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_071))::numeric(9,3) END AS trx_071,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_072))::numeric(9,3) END AS trx_072,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_073))::numeric(9,3) END AS trx_073,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_074))::numeric(9,3) END AS trx_074,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_075))::numeric(9,3) END AS trx_075,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_076))::numeric(9,3) END AS trx_076,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_077))::numeric(9,3) END AS trx_077,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_078))::numeric(9,3) END AS trx_078,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_079))::numeric(9,3) END AS trx_079,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_080))::numeric(9,3) END AS trx_080,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_081))::numeric(9,3) END AS trx_081,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_082))::numeric(9,3) END AS trx_082,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_083))::numeric(9,3) END AS trx_083,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_084))::numeric(9,3) END AS trx_084,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_085))::numeric(9,3) END AS trx_085,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_086))::numeric(9,3) END AS trx_086,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_087))::numeric(9,3) END AS trx_087,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_088))::numeric(9,3) END AS trx_088,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_089))::numeric(9,3) END AS trx_089,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_090))::numeric(9,3) END AS trx_090,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_091))::numeric(9,3) END AS trx_091,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_092))::numeric(9,3) END AS trx_092,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_093))::numeric(9,3) END AS trx_093,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_094))::numeric(9,3) END AS trx_094,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_095))::numeric(9,3) END AS trx_095,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_096))::numeric(9,3) END AS trx_096,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_097))::numeric(9,3) END AS trx_097,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_098))::numeric(9,3) END AS trx_098,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_099))::numeric(9,3) END AS trx_099,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_100))::numeric(9,3) END AS trx_100,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_101))::numeric(9,3) END AS trx_101,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_102))::numeric(9,3) END AS trx_102,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_103))::numeric(9,3) END AS trx_103,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_104))::numeric(9,3) END AS trx_104,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_105))::numeric(9,3) END AS trx_105,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_106))::numeric(9,3) END AS trx_106,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_107))::numeric(9,3) END AS trx_107,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_108))::numeric(9,3) END AS trx_108,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_109))::numeric(9,3) END AS trx_109,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_110))::numeric(9,3) END AS trx_110,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_111))::numeric(9,3) END AS trx_111,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_112))::numeric(9,3) END AS trx_112,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_113))::numeric(9,3) END AS trx_113,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_114))::numeric(9,3) END AS trx_114,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_115))::numeric(9,3) END AS trx_115,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_116))::numeric(9,3) END AS trx_116,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_117))::numeric(9,3) END AS trx_117,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_118))::numeric(9,3) END AS trx_118,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_119))::numeric(9,3) END AS trx_119,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_120))::numeric(9,3) END AS trx_120,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_121))::numeric(9,3) END AS trx_121,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_122))::numeric(9,3) END AS trx_122,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_123))::numeric(9,3) END AS trx_123,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_124))::numeric(9,3) END AS trx_124,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_125))::numeric(9,3) END AS trx_125,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_126))::numeric(9,3) END AS trx_126,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_127))::numeric(9,3) END AS trx_127,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_128))::numeric(9,3) END AS trx_128,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_129))::numeric(9,3) END AS trx_129,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_130))::numeric(9,3) END AS trx_130,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_131))::numeric(9,3) END AS trx_131,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_ADHOC_src.trx_132))::numeric(9,3) END AS trx_132,
        EXT_IMS_MHJ_QTY_W_ADHOC_src.batch_id,
        EXT_IMS_MHJ_QTY_W_ADHOC_src.row_id,
        EXT_IMS_MHJ_QTY_W_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_QTY_W_ADHOC_src;

CREATE  VIEW raw.ext_ims_mhj_cnt_m_adhoc AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CNT_M_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CNT_M_ADHOC'::varchar(23)))));

CREATE  VIEW raw.ext_ims_mhj_cnt_w_adhoc AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.nrx_025,
        src.nrx_026,
        src.nrx_027,
        src.nrx_028,
        src.nrx_029,
        src.nrx_030,
        src.nrx_031,
        src.nrx_032,
        src.nrx_033,
        src.nrx_034,
        src.nrx_035,
        src.nrx_036,
        src.nrx_037,
        src.nrx_038,
        src.nrx_039,
        src.nrx_040,
        src.nrx_041,
        src.nrx_042,
        src.nrx_043,
        src.nrx_044,
        src.nrx_045,
        src.nrx_046,
        src.nrx_047,
        src.nrx_048,
        src.nrx_049,
        src.nrx_050,
        src.nrx_051,
        src.nrx_052,
        src.nrx_053,
        src.nrx_054,
        src.nrx_055,
        src.nrx_056,
        src.nrx_057,
        src.nrx_058,
        src.nrx_059,
        src.nrx_060,
        src.nrx_061,
        src.nrx_062,
        src.nrx_063,
        src.nrx_064,
        src.nrx_065,
        src.nrx_066,
        src.nrx_067,
        src.nrx_068,
        src.nrx_069,
        src.nrx_070,
        src.nrx_071,
        src.nrx_072,
        src.nrx_073,
        src.nrx_074,
        src.nrx_075,
        src.nrx_076,
        src.nrx_077,
        src.nrx_078,
        src.nrx_079,
        src.nrx_080,
        src.nrx_081,
        src.nrx_082,
        src.nrx_083,
        src.nrx_084,
        src.nrx_085,
        src.nrx_086,
        src.nrx_087,
        src.nrx_088,
        src.nrx_089,
        src.nrx_090,
        src.nrx_091,
        src.nrx_092,
        src.nrx_093,
        src.nrx_094,
        src.nrx_095,
        src.nrx_096,
        src.nrx_097,
        src.nrx_098,
        src.nrx_099,
        src.nrx_100,
        src.nrx_101,
        src.nrx_102,
        src.nrx_103,
        src.nrx_104,
        src.nrx_105,
        src.nrx_106,
        src.nrx_107,
        src.nrx_108,
        src.nrx_109,
        src.nrx_110,
        src.nrx_111,
        src.nrx_112,
        src.nrx_113,
        src.nrx_114,
        src.nrx_115,
        src.nrx_116,
        src.nrx_117,
        src.nrx_118,
        src.nrx_119,
        src.nrx_120,
        src.nrx_121,
        src.nrx_122,
        src.nrx_123,
        src.nrx_124,
        src.nrx_125,
        src.nrx_126,
        src.nrx_127,
        src.nrx_128,
        src.nrx_129,
        src.nrx_130,
        src.nrx_131,
        src.nrx_132,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.trx_025,
        src.trx_026,
        src.trx_027,
        src.trx_028,
        src.trx_029,
        src.trx_030,
        src.trx_031,
        src.trx_032,
        src.trx_033,
        src.trx_034,
        src.trx_035,
        src.trx_036,
        src.trx_037,
        src.trx_038,
        src.trx_039,
        src.trx_040,
        src.trx_041,
        src.trx_042,
        src.trx_043,
        src.trx_044,
        src.trx_045,
        src.trx_046,
        src.trx_047,
        src.trx_048,
        src.trx_049,
        src.trx_050,
        src.trx_051,
        src.trx_052,
        src.trx_053,
        src.trx_054,
        src.trx_055,
        src.trx_056,
        src.trx_057,
        src.trx_058,
        src.trx_059,
        src.trx_060,
        src.trx_061,
        src.trx_062,
        src.trx_063,
        src.trx_064,
        src.trx_065,
        src.trx_066,
        src.trx_067,
        src.trx_068,
        src.trx_069,
        src.trx_070,
        src.trx_071,
        src.trx_072,
        src.trx_073,
        src.trx_074,
        src.trx_075,
        src.trx_076,
        src.trx_077,
        src.trx_078,
        src.trx_079,
        src.trx_080,
        src.trx_081,
        src.trx_082,
        src.trx_083,
        src.trx_084,
        src.trx_085,
        src.trx_086,
        src.trx_087,
        src.trx_088,
        src.trx_089,
        src.trx_090,
        src.trx_091,
        src.trx_092,
        src.trx_093,
        src.trx_094,
        src.trx_095,
        src.trx_096,
        src.trx_097,
        src.trx_098,
        src.trx_099,
        src.trx_100,
        src.trx_101,
        src.trx_102,
        src.trx_103,
        src.trx_104,
        src.trx_105,
        src.trx_106,
        src.trx_107,
        src.trx_108,
        src.trx_109,
        src.trx_110,
        src.trx_111,
        src.trx_112,
        src.trx_113,
        src.trx_114,
        src.trx_115,
        src.trx_116,
        src.trx_117,
        src.trx_118,
        src.trx_119,
        src.trx_120,
        src.trx_121,
        src.trx_122,
        src.trx_123,
        src.trx_124,
        src.trx_125,
        src.trx_126,
        src.trx_127,
        src.trx_128,
        src.trx_129,
        src.trx_130,
        src.trx_131,
        src.trx_132,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_CNT_W_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_CNT_W_ADHOC'::varchar(23)))));

CREATE  VIEW raw.ext_ims_mhj_qty_m_adhoc AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_QTY_M_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_QTY_M_ADHOC'::varchar(23)))));

CREATE  VIEW raw.ext_ims_mhj_qty_w_adhoc AS
 SELECT src.ims_client_num,
        src.ims_report_num,
        src.zip_other,
        src.ims_id,
        src.specialty,
        src.plan_id,
        src.sales_category,
        src.rx_type,
        src.ims_product_group_num,
        src.filler_01,
        src.me_num,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address,
        src.city,
        src.state,
        src.zip,
        src.supplemental_data,
        src.plan_name,
        src.data_date,
        src.bucket_count,
        src.nrx_001,
        src.nrx_002,
        src.nrx_003,
        src.nrx_004,
        src.nrx_005,
        src.nrx_006,
        src.nrx_007,
        src.nrx_008,
        src.nrx_009,
        src.nrx_010,
        src.nrx_011,
        src.nrx_012,
        src.nrx_013,
        src.nrx_014,
        src.nrx_015,
        src.nrx_016,
        src.nrx_017,
        src.nrx_018,
        src.nrx_019,
        src.nrx_020,
        src.nrx_021,
        src.nrx_022,
        src.nrx_023,
        src.nrx_024,
        src.nrx_025,
        src.nrx_026,
        src.nrx_027,
        src.nrx_028,
        src.nrx_029,
        src.nrx_030,
        src.nrx_031,
        src.nrx_032,
        src.nrx_033,
        src.nrx_034,
        src.nrx_035,
        src.nrx_036,
        src.nrx_037,
        src.nrx_038,
        src.nrx_039,
        src.nrx_040,
        src.nrx_041,
        src.nrx_042,
        src.nrx_043,
        src.nrx_044,
        src.nrx_045,
        src.nrx_046,
        src.nrx_047,
        src.nrx_048,
        src.nrx_049,
        src.nrx_050,
        src.nrx_051,
        src.nrx_052,
        src.nrx_053,
        src.nrx_054,
        src.nrx_055,
        src.nrx_056,
        src.nrx_057,
        src.nrx_058,
        src.nrx_059,
        src.nrx_060,
        src.nrx_061,
        src.nrx_062,
        src.nrx_063,
        src.nrx_064,
        src.nrx_065,
        src.nrx_066,
        src.nrx_067,
        src.nrx_068,
        src.nrx_069,
        src.nrx_070,
        src.nrx_071,
        src.nrx_072,
        src.nrx_073,
        src.nrx_074,
        src.nrx_075,
        src.nrx_076,
        src.nrx_077,
        src.nrx_078,
        src.nrx_079,
        src.nrx_080,
        src.nrx_081,
        src.nrx_082,
        src.nrx_083,
        src.nrx_084,
        src.nrx_085,
        src.nrx_086,
        src.nrx_087,
        src.nrx_088,
        src.nrx_089,
        src.nrx_090,
        src.nrx_091,
        src.nrx_092,
        src.nrx_093,
        src.nrx_094,
        src.nrx_095,
        src.nrx_096,
        src.nrx_097,
        src.nrx_098,
        src.nrx_099,
        src.nrx_100,
        src.nrx_101,
        src.nrx_102,
        src.nrx_103,
        src.nrx_104,
        src.nrx_105,
        src.nrx_106,
        src.nrx_107,
        src.nrx_108,
        src.nrx_109,
        src.nrx_110,
        src.nrx_111,
        src.nrx_112,
        src.nrx_113,
        src.nrx_114,
        src.nrx_115,
        src.nrx_116,
        src.nrx_117,
        src.nrx_118,
        src.nrx_119,
        src.nrx_120,
        src.nrx_121,
        src.nrx_122,
        src.nrx_123,
        src.nrx_124,
        src.nrx_125,
        src.nrx_126,
        src.nrx_127,
        src.nrx_128,
        src.nrx_129,
        src.nrx_130,
        src.nrx_131,
        src.nrx_132,
        src.trx_001,
        src.trx_002,
        src.trx_003,
        src.trx_004,
        src.trx_005,
        src.trx_006,
        src.trx_007,
        src.trx_008,
        src.trx_009,
        src.trx_010,
        src.trx_011,
        src.trx_012,
        src.trx_013,
        src.trx_014,
        src.trx_015,
        src.trx_016,
        src.trx_017,
        src.trx_018,
        src.trx_019,
        src.trx_020,
        src.trx_021,
        src.trx_022,
        src.trx_023,
        src.trx_024,
        src.trx_025,
        src.trx_026,
        src.trx_027,
        src.trx_028,
        src.trx_029,
        src.trx_030,
        src.trx_031,
        src.trx_032,
        src.trx_033,
        src.trx_034,
        src.trx_035,
        src.trx_036,
        src.trx_037,
        src.trx_038,
        src.trx_039,
        src.trx_040,
        src.trx_041,
        src.trx_042,
        src.trx_043,
        src.trx_044,
        src.trx_045,
        src.trx_046,
        src.trx_047,
        src.trx_048,
        src.trx_049,
        src.trx_050,
        src.trx_051,
        src.trx_052,
        src.trx_053,
        src.trx_054,
        src.trx_055,
        src.trx_056,
        src.trx_057,
        src.trx_058,
        src.trx_059,
        src.trx_060,
        src.trx_061,
        src.trx_062,
        src.trx_063,
        src.trx_064,
        src.trx_065,
        src.trx_066,
        src.trx_067,
        src.trx_068,
        src.trx_069,
        src.trx_070,
        src.trx_071,
        src.trx_072,
        src.trx_073,
        src.trx_074,
        src.trx_075,
        src.trx_076,
        src.trx_077,
        src.trx_078,
        src.trx_079,
        src.trx_080,
        src.trx_081,
        src.trx_082,
        src.trx_083,
        src.trx_084,
        src.trx_085,
        src.trx_086,
        src.trx_087,
        src.trx_088,
        src.trx_089,
        src.trx_090,
        src.trx_091,
        src.trx_092,
        src.trx_093,
        src.trx_094,
        src.trx_095,
        src.trx_096,
        src.trx_097,
        src.trx_098,
        src.trx_099,
        src.trx_100,
        src.trx_101,
        src.trx_102,
        src.trx_103,
        src.trx_104,
        src.trx_105,
        src.trx_106,
        src.trx_107,
        src.trx_108,
        src.trx_109,
        src.trx_110,
        src.trx_111,
        src.trx_112,
        src.trx_113,
        src.trx_114,
        src.trx_115,
        src.trx_116,
        src.trx_117,
        src.trx_118,
        src.trx_119,
        src.trx_120,
        src.trx_121,
        src.trx_122,
        src.trx_123,
        src.trx_124,
        src.trx_125,
        src.trx_126,
        src.trx_127,
        src.trx_128,
        src.trx_129,
        src.trx_130,
        src.trx_131,
        src.trx_132,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_MHJ_QTY_W_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_MHJ_QTY_W_ADHOC'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_PSKW_GRANIX_COUPON_SAVINGS AS
 SELECT btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.transaction_type) AS transaction_type,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.claim_authorization_number) AS claim_authorization_number,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.original_claim_authorization_number) AS original_claim_authorization_number,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.rx_num) AS rx_num,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_of_fill = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_of_fill))::timestamp END AS date_of_fill,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_written = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_written))::timestamp END AS date_written,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.day_supply = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.day_supply))::int END AS day_supply,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.daw) AS daw,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.ndc) AS ndc,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.drug_desc) AS drug_desc,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.new_refill_code) AS new_refill_code,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.number_of_refills) AS number_of_refills,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.other_coverage_code) AS other_coverage_code,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.group_num) AS group_num,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.member_id) AS member_id,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_gender) AS patient_gender,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_processed = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.date_processed))::timestamp END AS date_processed,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.nabp) AS nabp,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_name) AS phm_name,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_add1) AS phm_add1,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_add2) AS phm_add2,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_city) AS phm_city,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_state) AS phm_state,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phm_zip) AS phm_zip,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.npi) AS npi,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_name) AS phy_name,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_fn) AS phy_fn,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_mi) AS phy_mi,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_ln) AS phy_ln,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_suffix) AS phy_suffix,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_prof_desg) AS phy_prof_desg,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.spec1) AS spec1,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.spec2) AS spec2,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_add1) AS phy_add1,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_add2) AS phy_add2,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_city) AS phy_city,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_state) AS phy_state,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.phy_zip) AS phy_zip,
        btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.submission_method) AS submission_method,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.quantity = ''::varchar) THEN NULL::float ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.quantity))::float END AS quantity,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_benefit = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_benefit))::numeric(9,2) END AS patient_benefit,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_copay_before_benefit_applied = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_copay_before_benefit_applied))::numeric(9,2) END AS patient_copay_before_benefit_applied,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_oop = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.patient_oop))::numeric(9,2) END AS patient_oop,
        CASE WHEN (EXT_PSKW_GRANIX_COUPON_SAVINGS_src.pharmacy_transaction_fee = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_PSKW_GRANIX_COUPON_SAVINGS_src.pharmacy_transaction_fee))::numeric(9,2) END AS pharmacy_transaction_fee,
        EXT_PSKW_GRANIX_COUPON_SAVINGS_src.batch_id,
        EXT_PSKW_GRANIX_COUPON_SAVINGS_src.row_id,
        EXT_PSKW_GRANIX_COUPON_SAVINGS_src.update_ts
 FROM teva_ingestion.EXT_PSKW_GRANIX_COUPON_SAVINGS_src;

CREATE  VIEW raw.ext_pskw_granix_coupon_savings AS
 SELECT src.transaction_type,
        src.claim_authorization_number,
        src.original_claim_authorization_number,
        src.rx_num,
        src.date_of_fill,
        src.date_written,
        src.day_supply,
        src.daw,
        src.ndc,
        src.drug_desc,
        src.new_refill_code,
        src.number_of_refills,
        src.other_coverage_code,
        src.group_num,
        src.member_id,
        src.patient_gender,
        src.date_processed,
        src.nabp,
        src.phm_name,
        src.phm_add1,
        src.phm_add2,
        src.phm_city,
        src.phm_state,
        src.phm_zip,
        src.npi,
        src.phy_name,
        src.phy_fn,
        src.phy_mi,
        src.phy_ln,
        src.phy_suffix,
        src.phy_prof_desg,
        src.spec1,
        src.spec2,
        src.phy_add1,
        src.phy_add2,
        src.phy_city,
        src.phy_state,
        src.phy_zip,
        src.submission_method,
        src.quantity,
        src.patient_benefit,
        src.patient_copay_before_benefit_applied,
        src.patient_oop,
        src.pharmacy_transaction_fee,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PSKW_GRANIX_COUPON_SAVINGS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PSKW_GRANIX_COUPON_SAVINGS'::varchar(30)))));

CREATE  VIEW outbound.zzz_access_monitor_calls_by_specialty_oncology AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW teva_ingestion.MDM_HCO AS
 SELECT btrim(MDM_HCO_src.TVCMID) AS TVCMID,
        btrim(MDM_HCO_src.IMS_ORGANIZATION_ID) AS IMS_ORGANIZATION_ID,
        btrim(MDM_HCO_src.DBA_NAME) AS DBA_NAME,
        btrim(MDM_HCO_src.BUSINESS_NAME) AS BUSINESS_NAME,
        btrim(MDM_HCO_src.CARE_OF_LOCATION) AS CARE_OF_LOCATION,
        btrim(MDM_HCO_src.RECORD_TYPE) AS RECORD_TYPE,
        btrim(MDM_HCO_src.RECORD_TYPE_NAME) AS RECORD_TYPE_NAME,
        btrim(MDM_HCO_src.SUB_TYPE) AS SUB_TYPE,
        btrim(MDM_HCO_src.SUB_TYPE_NAME) AS SUB_TYPE_NAME,
        btrim(MDM_HCO_src.OWNER_STATUS) AS OWNER_STATUS,
        btrim(MDM_HCO_src.PROFIT_STATUS) AS PROFIT_STATUS,
        CASE WHEN (MDM_HCO_src.CMI = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.CMI))::int END AS CMI,
        CASE WHEN (MDM_HCO_src.NO_OF_PROVIDERS = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.NO_OF_PROVIDERS))::int END AS NO_OF_PROVIDERS,
        CASE WHEN (MDM_HCO_src.PRIMARY_COT_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.PRIMARY_COT_ID))::int END AS PRIMARY_COT_ID,
        CASE WHEN (MDM_HCO_src.COT_CLASSIFICATION_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.COT_CLASSIFICATION_ID))::int END AS COT_CLASSIFICATION_ID,
        btrim(MDM_HCO_src.COT_CLASSIFICATION) AS COT_CLASSIFICATION,
        CASE WHEN (MDM_HCO_src.COT_FACILITY_TYPE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.COT_FACILITY_TYPE_ID))::int END AS COT_FACILITY_TYPE_ID,
        btrim(MDM_HCO_src.COT_FACILITY_TYPE) AS COT_FACILITY_TYPE,
        CASE WHEN (MDM_HCO_src.COT_SPECIALTY_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.COT_SPECIALTY_ID))::int END AS COT_SPECIALTY_ID,
        btrim(MDM_HCO_src.COT_SPECIALTY) AS COT_SPECIALTY,
        CASE WHEN (MDM_HCO_src.TTL_LICENSE_BEDS = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.TTL_LICENSE_BEDS))::int END AS TTL_LICENSE_BEDS,
        CASE WHEN (MDM_HCO_src.TTL_CENSUS_BEDS = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.TTL_CENSUS_BEDS))::int END AS TTL_CENSUS_BEDS,
        CASE WHEN (MDM_HCO_src.TTL_STAFFED_BEDS = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCO_src.TTL_STAFFED_BEDS))::int END AS TTL_STAFFED_BEDS,
        btrim(MDM_HCO_src.TEACHING_HOSP) AS TEACHING_HOSP,
        btrim(MDM_HCO_src.COMMHOSP) AS COMMHOSP,
        btrim(MDM_HCO_src.FORMULARY) AS FORMULARY,
        btrim(MDM_HCO_src.ELECTRONIC_MEDICAL_RECORD) AS ELECTRONIC_MEDICAL_RECORD,
        btrim(MDM_HCO_src.EPRESCRIBE) AS EPRESCRIBE,
        btrim(MDM_HCO_src.PAYPERFORM) AS PAYPERFORM,
        btrim(MDM_HCO_src.GENFIRST) AS GENFIRST,
        btrim(MDM_HCO_src.SREP_ACCESS) AS SREP_ACCESS,
        btrim(MDM_HCO_src.PRACTICING_STATUS_CODE_HEALTHCARE_ORGANIZATION) AS PRACTICING_STATUS_CODE_HEALTHCARE_ORGANIZATION,
        btrim(MDM_HCO_src.MPN) AS MPN,
        btrim(MDM_HCO_src.MPN_ORDER) AS MPN_ORDER,
        btrim(MDM_HCO_src.STATUS_INDICATOR) AS STATUS_INDICATOR,
        btrim(MDM_HCO_src.STATUS_INDICATOR_NAME) AS STATUS_INDICATOR_NAME,
        btrim(MDM_HCO_src.DEACTIVATION_REASON) AS DEACTIVATION_REASON,
        btrim(MDM_HCO_src.LOGICAL_DELETION_DATE) AS LOGICAL_DELETION_DATE,
        btrim(MDM_HCO_src.HCE_INSERT_DATE) AS HCE_INSERT_DATE,
        btrim(MDM_HCO_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_HCO_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_HCO_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_HCO_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_HCO_src.batch_id,
        MDM_HCO_src.row_id,
        MDM_HCO_src.update_ts
 FROM teva_ingestion.MDM_HCO_src;

CREATE  VIEW raw.mdm_hco AS
 SELECT src.TVCMID,
        src.IMS_ORGANIZATION_ID,
        src.DBA_NAME,
        src.BUSINESS_NAME,
        src.CARE_OF_LOCATION,
        src.RECORD_TYPE,
        src.RECORD_TYPE_NAME,
        src.SUB_TYPE,
        src.SUB_TYPE_NAME,
        src.OWNER_STATUS,
        src.PROFIT_STATUS,
        src.CMI,
        src.NO_OF_PROVIDERS,
        src.PRIMARY_COT_ID,
        src.COT_CLASSIFICATION_ID,
        src.COT_CLASSIFICATION,
        src.COT_FACILITY_TYPE_ID,
        src.COT_FACILITY_TYPE,
        src.COT_SPECIALTY_ID,
        src.COT_SPECIALTY,
        src.TTL_LICENSE_BEDS,
        src.TTL_CENSUS_BEDS,
        src.TTL_STAFFED_BEDS,
        src.TEACHING_HOSP,
        src.COMMHOSP,
        src.FORMULARY,
        src.ELECTRONIC_MEDICAL_RECORD,
        src.EPRESCRIBE,
        src.PAYPERFORM,
        src.GENFIRST,
        src.SREP_ACCESS,
        src.PRACTICING_STATUS_CODE_HEALTHCARE_ORGANIZATION,
        src.MPN,
        src.MPN_ORDER,
        src.STATUS_INDICATOR,
        src.STATUS_INDICATOR_NAME,
        src.DEACTIVATION_REASON,
        src.LOGICAL_DELETION_DATE,
        src.HCE_INSERT_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_HCO_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_hco'::varchar(7)))));

CREATE  VIEW outbound.tn_physician_univ AS
 SELECT x.npi,
        x.dea_num,
        x.last_name,
        x.first_name,
        x.middle_name,
        x.address,
        x.city,
        x.state,
        x.zip
 FROM ( SELECT dc.npi,
        dc.dea_num,
        upper(dc.last_name) AS last_name,
        upper(dc.first_name) AS first_name,
        upper(dc.middle_name) AS middle_name,
        btrim(upper(((((coalesce(dc.ptr_address_1, ''::varchar) || ' '::varchar(1)) || coalesce(dc.ptr_address_2, ''::varchar)) || ' '::varchar(1)) || coalesce(dc.ptr_address_3, ''::varchar)))) AS address,
        upper(dc.ptr_city) AS city,
        dc.ptr_state AS state,
        dc.ptr_zip AS zip,
        row_number() OVER (PARTITION BY dc.sales_force_id, dc.npi ORDER BY dc.ptr_territory_num) AS rnk
 FROM datamart.prescriber_combined_demographics dc
 WHERE ((dc.ims_id IS NOT NULL) AND (dc.npi IS NOT NULL) AND (dc.sales_force_id = 'TN'::varchar(2)))) x
 WHERE (x.rnk = 1);

CREATE  VIEW outbound.zzz_rxnormalizationcontrol AS
 SELECT m.ims_client_number AS ClientNo,
        m.ims_report_number_cnt AS RxReportNo,
        sp_cnt.source_product_code AS ProductGroupNo,
        m.ims_report_number_qty AS CorrespondingUnitsReportNo,
        sp_cnt.source_product_name AS ProductGroupName,
        CASE WHEN (nf.divisor = (nf.divisor)::int) THEN ((nf.divisor)::int)::varchar ELSE rtrim((nf.divisor)::varchar, '0'::varchar(1)) END AS Divisor,
        CASE WHEN (nf.multiplier = (nf.multiplier)::int) THEN ((nf.multiplier)::int)::varchar ELSE rtrim((nf.multiplier)::varchar, '0'::varchar(1)) END AS Multiplier
 FROM ((product.normalization_factor nf JOIN product.source_product sp_cnt ON ((nf.entity_id = sp_cnt.entity_id))) JOIN reference.ims_report_cnt_qty_mapping m ON (((sp_cnt.source_client_num = m.ims_client_number) AND (sp_cnt.source_report_num = m.ims_report_number_cnt))))
 WHERE ((nf.source_id = 1) AND (m.report_frequency = 'SPLITWEEK'::varchar(9)) AND (m.ims_report_number_qty IS NOT NULL) AND (m.sent_from_iqvia_to_asi_flag = 'Y'::char(1)))
 ORDER BY m.ims_client_number,
          m.ims_report_number_cnt,
          sp_cnt.source_product_code;

CREATE  VIEW outbound.zzz_asi_rx_by_market_bdpnasal AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '16'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW teva_ingestion.EXT_CONNECTIVERX_COUPON AS
 SELECT btrim(EXT_CONNECTIVERX_COUPON_src.redemption_type) AS redemption_type,
        btrim(EXT_CONNECTIVERX_COUPON_src.transaction_type) AS transaction_type,
        btrim(EXT_CONNECTIVERX_COUPON_src.claim_authorization_number) AS claim_authorization_number,
        btrim(EXT_CONNECTIVERX_COUPON_src.original_claim_authorization_number) AS original_claim_authorization_number,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.date_of_fill = ''::varchar) THEN NULL::date ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.date_of_fill))::date END AS date_of_fill,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.date_written = ''::varchar) THEN NULL::date ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.date_written))::date END AS date_written,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.day_supply = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.day_supply))::int END AS day_supply,
        btrim(EXT_CONNECTIVERX_COUPON_src.ndc) AS ndc,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.daw = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.daw))::int END AS daw,
        btrim(EXT_CONNECTIVERX_COUPON_src.drug_title) AS drug_title,
        btrim(EXT_CONNECTIVERX_COUPON_src.drug_strength_and_form) AS drug_strength_and_form,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.new_refill_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.new_refill_code))::int END AS new_refill_code,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.quantity = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.quantity))::numeric(37,15) END AS quantity,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.number_of_refills = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.number_of_refills))::int END AS number_of_refills,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.other_coverage_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.other_coverage_code))::int END AS other_coverage_code,
        btrim(EXT_CONNECTIVERX_COUPON_src.group_num) AS group_num,
        btrim(EXT_CONNECTIVERX_COUPON_src.member_id) AS member_id,
        btrim(EXT_CONNECTIVERX_COUPON_src.patient_gender) AS patient_gender,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.age = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.age))::int END AS age,
        btrim(EXT_CONNECTIVERX_COUPON_src.date_processed) AS date_processed,
        btrim(EXT_CONNECTIVERX_COUPON_src.nabp) AS nabp,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_chain) AS pharmacy_chain,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_npi) AS pharmacy_npi,
        btrim(EXT_CONNECTIVERX_COUPON_src.rx_num) AS rx_num,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_address_1) AS pharmacy_address_1,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_address_2) AS pharmacy_address_2,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_city) AS pharmacy_city,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_state) AS pharmacy_state,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_zip) AS pharmacy_zip,
        btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_phone) AS pharmacy_phone,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_npi) AS hcp_npi,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_first_name) AS hcp_first_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_middle_name) AS hcp_middle_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_last_name) AS hcp_last_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_suffix) AS hcp_suffix,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_designation) AS hcp_designation,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_specialty_1) AS hcp_specialty_1,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_specialty_2) AS hcp_specialty_2,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_address_1) AS hcp_address_1,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_address_2) AS hcp_address_2,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_city) AS hcp_city,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_state) AS hcp_state,
        btrim(EXT_CONNECTIVERX_COUPON_src.hcp_zip) AS hcp_zip,
        btrim(EXT_CONNECTIVERX_COUPON_src.submission_method) AS submission_method,
        btrim(EXT_CONNECTIVERX_COUPON_src.previous_payer_id) AS previous_payer_id,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.patient_expense = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.patient_expense))::numeric(9,2) END AS patient_expense,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.patient_benefit = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.patient_benefit))::numeric(9,2) END AS patient_benefit,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.patient_copay = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.patient_copay))::numeric(37,15) END AS patient_copay,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.patient_oop = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.patient_oop))::numeric(37,15) END AS patient_oop,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.pharmacy_fee = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.pharmacy_fee))::numeric(37,15) END AS pharmacy_fee,
        CASE WHEN (EXT_CONNECTIVERX_COUPON_src.amount_due = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CONNECTIVERX_COUPON_src.amount_due))::numeric(37,15) END AS amount_due,
        btrim(EXT_CONNECTIVERX_COUPON_src.create_date) AS create_date,
        btrim(EXT_CONNECTIVERX_COUPON_src.occ_payment_type) AS occ_payment_type,
        btrim(EXT_CONNECTIVERX_COUPON_src.calc_awp) AS calc_awp,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_npi) AS admin_hcp_npi,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_name) AS admin_hcp_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_address) AS admin_hcp_address,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_address2) AS admin_hcp_address2,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_city) AS admin_hcp_city,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_state) AS admin_hcp_state,
        btrim(EXT_CONNECTIVERX_COUPON_src.admin_hcp_zip) AS admin_hcp_zip,
        btrim(EXT_CONNECTIVERX_COUPON_src.claim_type) AS claim_type,
        btrim(EXT_CONNECTIVERX_COUPON_src.administration_flag) AS administration_flag,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_name) AS soc_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_phone) AS soc_phone,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_fax) AS soc_fax,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_address) AS soc_address,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_city) AS soc_city,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_state) AS soc_state,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_zip) AS soc_zip,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_id) AS soc_id,
        btrim(EXT_CONNECTIVERX_COUPON_src.soc_npi) AS soc_npi,
        btrim(EXT_CONNECTIVERX_COUPON_src.payer_name) AS payer_name,
        btrim(EXT_CONNECTIVERX_COUPON_src.cpt_code) AS cpt_code,
        EXT_CONNECTIVERX_COUPON_src.batch_id,
        EXT_CONNECTIVERX_COUPON_src.row_id,
        EXT_CONNECTIVERX_COUPON_src.update_ts
 FROM teva_ingestion.EXT_CONNECTIVERX_COUPON_src;

CREATE  VIEW raw.ext_connectiverx_coupon AS
 SELECT src.redemption_type,
        src.transaction_type,
        src.claim_authorization_number,
        src.original_claim_authorization_number,
        src.date_of_fill,
        src.date_written,
        src.day_supply,
        src.ndc,
        src.daw,
        src.drug_title,
        src.drug_strength_and_form,
        src.new_refill_code,
        src.quantity,
        src.number_of_refills,
        src.other_coverage_code,
        src.group_num,
        src.member_id,
        src.patient_gender,
        src.age,
        src.date_processed,
        src.nabp,
        src.pharmacy_chain,
        src.pharmacy_npi,
        src.rx_num,
        src.pharmacy_name,
        src.pharmacy_address_1,
        src.pharmacy_address_2,
        src.pharmacy_city,
        src.pharmacy_state,
        src.pharmacy_zip,
        src.pharmacy_phone,
        src.hcp_npi,
        src.hcp_first_name,
        src.hcp_middle_name,
        src.hcp_last_name,
        src.hcp_suffix,
        src.hcp_designation,
        src.hcp_specialty_1,
        src.hcp_specialty_2,
        src.hcp_address_1,
        src.hcp_address_2,
        src.hcp_city,
        src.hcp_state,
        src.hcp_zip,
        src.submission_method,
        src.previous_payer_id,
        src.patient_expense,
        src.patient_benefit,
        src.patient_copay,
        src.patient_oop,
        src.pharmacy_fee,
        src.amount_due,
        src.create_date,
        src.occ_payment_type,
        src.calc_awp,
        src.admin_hcp_npi,
        src.admin_hcp_name,
        src.admin_hcp_address,
        src.admin_hcp_address2,
        src.admin_hcp_city,
        src.admin_hcp_state,
        src.admin_hcp_zip,
        src.claim_type,
        src.administration_flag,
        src.soc_name,
        src.soc_phone,
        src.soc_fax,
        src.soc_address,
        src.soc_city,
        src.soc_state,
        src.soc_zip,
        src.soc_id,
        src.soc_npi,
        src.payer_name,
        src.cpt_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CONNECTIVERX_COUPON_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CONNECTIVERX_COUPON'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_OPTUMRX_V2 AS
 SELECT btrim(EXT_OPTUMRX_V2_src.fill_month) AS fill_month,
        btrim(EXT_OPTUMRX_V2_src.npi) AS npi,
        btrim(EXT_OPTUMRX_V2_src.full_name) AS full_name,
        btrim(EXT_OPTUMRX_V2_src.specialty) AS specialty,
        btrim(EXT_OPTUMRX_V2_src.address_1) AS address_1,
        btrim(EXT_OPTUMRX_V2_src.address_2) AS address_2,
        btrim(EXT_OPTUMRX_V2_src.city) AS city,
        btrim(EXT_OPTUMRX_V2_src.state) AS state,
        btrim(EXT_OPTUMRX_V2_src.zip) AS zip,
        btrim(EXT_OPTUMRX_V2_src.ndc) AS ndc,
        btrim(EXT_OPTUMRX_V2_src.product_name) AS product_name,
        btrim(EXT_OPTUMRX_V2_src.trx_count) AS trx_count,
        btrim(EXT_OPTUMRX_V2_src.trx_quantity) AS trx_quantity,
        btrim(EXT_OPTUMRX_V2_src.payer_flag) AS payer_flag,
        btrim(EXT_OPTUMRX_V2_src.briova_flag) AS briova_flag,
        EXT_OPTUMRX_V2_src.batch_id,
        EXT_OPTUMRX_V2_src.row_id,
        EXT_OPTUMRX_V2_src.update_ts
 FROM teva_ingestion.EXT_OPTUMRX_V2_src;

CREATE  VIEW raw.ext_optumrx_v2 AS
 SELECT src.fill_month,
        src.npi,
        src.full_name,
        src.specialty,
        src.address_1,
        src.address_2,
        src.city,
        src.state,
        src.zip,
        src.ndc,
        src.product_name,
        src.trx_count,
        src.trx_quantity,
        src.payer_flag,
        src.briova_flag,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_OPTUMRX_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_OPTUMRX_V2'::varchar(14)))));

CREATE  VIEW outbound.mdm_hco AS
 SELECT NULL AS dsp_id,
        NULL AS dsp_hce_id,
        NULL AS dba_name,
        NULL AS business_name,
        NULL AS care_of_location,
        NULL AS sub_type,
        NULL AS owner_status,
        NULL AS profit_status,
        NULL AS cmi,
        NULL AS no_of_providers,
        NULL AS ttl_license_beds,
        NULL AS ttl_census_beds,
        NULL AS ttl_staffed_beds,
        NULL AS teaching_hosp,
        NULL AS commhosp,
        NULL AS formulary,
        NULL AS electronic_medical_record,
        NULL AS eprescribe,
        NULL AS payperform,
        NULL AS genfirst,
        NULL AS srep_access,
        NULL AS mpn,
        NULL AS mpn_order,
        NULL AS status_indicator,
        NULL AS deactivation_reason
 FROM v_catalog.dual
 LIMIT 0;

CREATE  VIEW outbound.mdm_relationship AS
 SELECT NULL AS dsp_id,
        NULL AS parent_dsp_id,
        NULL AS parent_dsp_hce_id,
        NULL AS child_dsp_id,
        NULL AS child_dsp_hce_id,
        NULL AS hierarchy_code,
        NULL AS relationship_type_code,
        NULL AS relationship_status_code,
        NULL::date AS relationship_effective_date,
        NULL::date AS relationship_end_date
 FROM v_catalog.dual
 LIMIT 0;

CREATE  VIEW outbound.mdm_alternate_name AS
 SELECT NULL AS dsp_id,
        NULL AS dsp_hce_id,
        NULL AS name_type,
        NULL AS name_value
 FROM v_catalog.dual
 LIMIT 0;

CREATE  VIEW outbound.mdm_specialty AS
 SELECT NULL AS dsp_id,
        NULL AS dsp_hce_id,
        NULL AS specialty_code,
        NULL AS specialty_rank_number,
        NULL AS specialty_status
 FROM v_catalog.dual
 LIMIT 0;

CREATE  VIEW outbound.mdm_alternate_identifier AS
 SELECT 'OPTMRX'::varchar(6) AS dsp_id,
        substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100) AS dsp_hce_id,
        'NPI'::varchar(3) AS alternate_id_type,
        specialty_pharmacy_shipment.source_customer_id AS alternate_id_value,
        NULL AS state,
        NULL AS identifier_category,
        NULL AS status,
        NULL AS source_deactivation_reason_code
 FROM datamart.specialty_pharmacy_shipment
 WHERE ((specialty_pharmacy_shipment.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (specialty_pharmacy_shipment.customer_type = 'HCP'::varchar(3)))
 GROUP BY 'OPTMRX'::varchar(6),
          substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100),
          'NPI'::varchar(3),
          specialty_pharmacy_shipment.source_customer_id,
          NULL UNION  SELECT A.dsp_id,
        substr(A.dsp_hce_id, 1, 100) AS dsp_hce_id,
        A.alternate_id_type,
        A.alternate_id_value,
        A.state,
        A.identifier_category,
        A.status,
        A.source_deactivation_reason_code
 FROM ( SELECT 'PT'::varchar(2) AS dsp_id,
        replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar) AS dsp_hce_id,
        'NPI'::varchar(3) AS alternate_id_type,
        prime_rx.prescriber_npi AS alternate_id_value,
        NULL AS state,
        NULL AS identifier_category,
        NULL AS status,
        NULL AS source_deactivation_reason_code
 FROM cleansed.prime_rx
 WHERE (prime_rx.prescriber_npi IS NOT NULL)
 GROUP BY 'PT'::varchar(2),
          replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar),
          'NPI'::varchar(3),
          prime_rx.prescriber_npi,
          NULL) A
 ORDER BY 1,
          2,
          3;

CREATE  VIEW outbound.mdm_address AS
 SELECT 'OPTMRX'::varchar(6) AS dsp_id,
        substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100) AS dsp_hce_id,
        upper(substr(replace((((((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_address_line_1, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_city, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_state, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_zip, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100)) AS dsp_addr_id,
        NULL AS address_type,
        specialty_pharmacy_shipment.ship_to_address_line_1 AS address_line_1,
        specialty_pharmacy_shipment.ship_to_address_line_2 AS address_line_2,
        specialty_pharmacy_shipment.ship_to_city AS city,
        specialty_pharmacy_shipment.ship_to_state AS state,
        'USA'::varchar(3) AS country_code,
        specialty_pharmacy_shipment.ship_to_zip AS postal_code,
        NULL AS postal_extension_code,
        NULL AS address_status,
        NULL::date AS address_effective_date,
        NULL AS single_address_indicator
 FROM datamart.specialty_pharmacy_shipment
 WHERE ((specialty_pharmacy_shipment.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (specialty_pharmacy_shipment.customer_type = 'HCP'::varchar(3)))
 GROUP BY 'OPTMRX'::varchar(6),
          substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100),
          upper(substr(replace((((((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_address_line_1, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_city, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_state, ''::varchar)) || coalesce(specialty_pharmacy_shipment.ship_to_zip, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100)),
          NULL,
          specialty_pharmacy_shipment.ship_to_address_line_1,
          specialty_pharmacy_shipment.ship_to_address_line_2,
          specialty_pharmacy_shipment.ship_to_city,
          specialty_pharmacy_shipment.ship_to_state,
          'USA'::varchar(3),
          specialty_pharmacy_shipment.ship_to_zip,
          NULL::date UNION  SELECT A.dsp_id,
        substr(A.dsp_hce_id, 1, 100) AS dsp_hce_id,
        substr(A.dsp_addr_id, 1, 100) AS dsp_addr_id,
        A.address_type,
        A.address_line_1,
        A.address_line_2,
        A.city,
        A.state,
        A.country_code,
        A.postal_code,
        A.postal_extension_code,
        A.address_status,
        A.address_effective_date,
        A.single_address_indicator
 FROM ( SELECT 'PT'::varchar(2) AS dsp_id,
        replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar) AS dsp_hce_id,
        replace((((((((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name) || coalesce(prime_rx.md_addr1, ''::varchar)) || coalesce(prime_rx.md_addr2, ''::varchar)) || coalesce(prime_rx.md_city, ''::varchar)) || coalesce(prime_rx.md_state, ''::varchar)) || coalesce(prime_rx.md_zip, ''::varchar)), ' '::varchar(1), ''::varchar) AS dsp_addr_id,
        NULL AS address_type,
        prime_rx.md_addr1 AS address_line_1,
        prime_rx.md_addr2 AS address_line_2,
        prime_rx.md_city AS city,
        prime_rx.md_state AS state,
        'USA'::varchar(3) AS country_code,
        prime_rx.md_zip AS postal_code,
        NULL AS postal_extension_code,
        NULL AS address_status,
        NULL::date AS address_effective_date,
        NULL AS single_address_indicator
 FROM cleansed.prime_rx
 GROUP BY 'PT'::varchar(2),
          replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar),
          replace((((((((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name) || coalesce(prime_rx.md_addr1, ''::varchar)) || coalesce(prime_rx.md_addr2, ''::varchar)) || coalesce(prime_rx.md_city, ''::varchar)) || coalesce(prime_rx.md_state, ''::varchar)) || coalesce(prime_rx.md_zip, ''::varchar)), ' '::varchar(1), ''::varchar),
          NULL,
          prime_rx.md_addr1,
          prime_rx.md_addr2,
          prime_rx.md_city,
          prime_rx.md_state,
          'USA'::varchar(3),
          prime_rx.md_zip,
          NULL::date) A
 ORDER BY 1,
          2,
          3;

CREATE  VIEW outbound.sharepoint_roster_tn_tp AS
 SELECT sr.title,
        sr.territory
 FROM ( SELECT lower(r.username) AS title,
        r.territory_number AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)]))) UNION  SELECT lower(r.username) AS title,
        (r.employee_id || '_'::varchar(1)) AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])))) sr
 GROUP BY sr.title,
          sr.territory
 ORDER BY sr.title;

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_SAMPLE_VOD__C AS
 SELECT btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.id) AS id,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.name) AS name,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.createddate) AS createddate,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lastactivitydate) AS lastactivitydate,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lastvieweddate) AS lastvieweddate,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lastreferenceddate) AS lastreferenceddate,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.call_date_vod__c) AS call_date_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.is_parent_call_vod__c) AS is_parent_call_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.quantity_vod__c) AS quantity_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.lot_vod__c) AS lot_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.call2_vod__c) AS call2_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.product_vod__c) AS product_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.distributor_vod__c) AS distributor_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.attendee_type_vod__c) AS attendee_type_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.entity_reference_id_vod__c) AS entity_reference_id_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.delivery_status_vod__c) AS delivery_status_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.apply_limit_vod__c) AS apply_limit_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.limit_applied_vod__c) AS limit_applied_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.manufacturer_vod__c) AS manufacturer_vod__c,
        btrim(EXT_VV_CALL2_SAMPLE_VOD__C_src.product_value_vod__c) AS product_value_vod__c,
        EXT_VV_CALL2_SAMPLE_VOD__C_src.batch_id,
        EXT_VV_CALL2_SAMPLE_VOD__C_src.row_id,
        EXT_VV_CALL2_SAMPLE_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL2_SAMPLE_VOD__C_src;

CREATE  VIEW raw.ext_vv_call2_sample_vod__c AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.mayedit,
        src.islocked,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.account_vod__c,
        src.call_date_vod__c,
        src.is_parent_call_vod__c,
        src.quantity_vod__c,
        src.lot_vod__c,
        src.mobile_id_vod__c,
        src.call2_vod__c,
        src.product_vod__c,
        src.distributor_vod__c,
        src.attendee_type_vod__c,
        src.entity_reference_id_vod__c,
        src.delivery_status_vod__c,
        src.apply_limit_vod__c,
        src.limit_applied_vod__c,
        src.manufacturer_vod__c,
        src.product_value_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_SAMPLE_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_SAMPLE_VOD__C'::varchar(26)))));

CREATE  VIEW teva_ingestion.ext_ims_copay AS
 SELECT btrim(ext_ims_copay_src.group_number) AS group_number,
        btrim(ext_ims_copay_src.group_name) AS group_name,
        btrim(ext_ims_copay_src.claim_type) AS claim_type,
        btrim(ext_ims_copay_src.rx_number) AS rx_number,
        btrim(ext_ims_copay_src.date_of_fill) AS date_of_fill,
        btrim(ext_ims_copay_src.member_id) AS member_id,
        btrim(ext_ims_copay_src.other_coverage_code) AS other_coverage_code,
        btrim(ext_ims_copay_src.new_refill_code) AS new_refill_code,
        btrim(ext_ims_copay_src.basis_of_reimbursement) AS basis_of_reimbursement,
        btrim(ext_ims_copay_src.ndc) AS ndc,
        btrim(ext_ims_copay_src.drug_name) AS drug_name,
        btrim(ext_ims_copay_src.drug_form) AS drug_form,
        btrim(ext_ims_copay_src.drug_strength) AS drug_strength,
        btrim(ext_ims_copay_src.paid_quantity) AS paid_quantity,
        btrim(ext_ims_copay_src.days_supply) AS days_supply,
        btrim(ext_ims_copay_src.ingredient_cost_paid) AS ingredient_cost_paid,
        btrim(ext_ims_copay_src.dispensing_fee_paid) AS dispensing_fee_paid,
        btrim(ext_ims_copay_src.sales_tax_paid) AS sales_tax_paid,
        btrim(ext_ims_copay_src.copay_amount) AS copay_amount,
        btrim(ext_ims_copay_src.total_amount_paid) AS total_amount_paid,
        btrim(ext_ims_copay_src.usual_and_customary_amount) AS usual_and_customary_amount,
        btrim(ext_ims_copay_src.claim_number) AS claim_number,
        btrim(ext_ims_copay_src.adjusted_claim_number) AS adjusted_claim_number,
        btrim(ext_ims_copay_src.received_date) AS received_date,
        btrim(ext_ims_copay_src.pharmacy_nabp) AS pharmacy_nabp,
        btrim(ext_ims_copay_src.pharmacy_name) AS pharmacy_name,
        btrim(ext_ims_copay_src.pharamcy_address_1) AS pharamcy_address_1,
        btrim(ext_ims_copay_src.pharamcy_address_2) AS pharamcy_address_2,
        btrim(ext_ims_copay_src.pharamcy_city) AS pharamcy_city,
        btrim(ext_ims_copay_src.pharamcy_state) AS pharamcy_state,
        btrim(ext_ims_copay_src.pharamcy_zip) AS pharamcy_zip,
        btrim(ext_ims_copay_src.pharmacy_group_code) AS pharmacy_group_code,
        btrim(ext_ims_copay_src.prescriber_first_name) AS prescriber_first_name,
        btrim(ext_ims_copay_src.prescriber_middle_name) AS prescriber_middle_name,
        btrim(ext_ims_copay_src.prescriber_last_name) AS prescriber_last_name,
        btrim(ext_ims_copay_src.prescriber_address_1) AS prescriber_address_1,
        btrim(ext_ims_copay_src.prescriber_address_2) AS prescriber_address_2,
        btrim(ext_ims_copay_src.prescriber_city) AS prescriber_city,
        btrim(ext_ims_copay_src.prescriber_state) AS prescriber_state,
        btrim(ext_ims_copay_src.prescriber_zip) AS prescriber_zip,
        btrim(ext_ims_copay_src.prescriber_specialty) AS prescriber_specialty,
        btrim(ext_ims_copay_src.redemption) AS redemption,
        btrim(ext_ims_copay_src.mail_order_indicator) AS mail_order_indicator,
        btrim(ext_ims_copay_src.dea) AS dea,
        btrim(ext_ims_copay_src.npi) AS npi,
        btrim(ext_ims_copay_src.pdrp) AS pdrp,
        ext_ims_copay_src.batch_id,
        ext_ims_copay_src.row_id,
        ext_ims_copay_src.update_ts
 FROM teva_ingestion.ext_ims_copay_src;

CREATE  VIEW raw.ext_ims_copay AS
 SELECT src.group_number,
        src.group_name,
        src.claim_type,
        src.rx_number,
        src.date_of_fill,
        src.member_id,
        src.other_coverage_code,
        src.new_refill_code,
        src.basis_of_reimbursement,
        src.ndc,
        src.drug_name,
        src.drug_form,
        src.drug_strength,
        src.paid_quantity,
        src.days_supply,
        src.ingredient_cost_paid,
        src.dispensing_fee_paid,
        src.sales_tax_paid,
        src.copay_amount,
        src.total_amount_paid,
        src.usual_and_customary_amount,
        src.claim_number,
        src.adjusted_claim_number,
        src.received_date,
        src.pharmacy_nabp,
        src.pharmacy_name,
        src.pharamcy_address_1,
        src.pharamcy_address_2,
        src.pharamcy_city,
        src.pharamcy_state,
        src.pharamcy_zip,
        src.pharmacy_group_code,
        src.prescriber_first_name,
        src.prescriber_middle_name,
        src.prescriber_last_name,
        src.prescriber_address_1,
        src.prescriber_address_2,
        src.prescriber_city,
        src.prescriber_state,
        src.prescriber_zip,
        src.prescriber_specialty,
        src.redemption,
        src.mail_order_indicator,
        src.dea,
        src.npi,
        src.pdrp,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_ims_copay_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_COPAY'::varchar(13)))));

CREATE  VIEW teva_ingestion.ext_vv_approved_document__c AS
 SELECT btrim(ext_vv_approved_document__c_src.id) AS id,
        btrim(ext_vv_approved_document__c_src.ownerid) AS ownerid,
        btrim(ext_vv_approved_document__c_src.isdeleted) AS isdeleted,
        btrim(ext_vv_approved_document__c_src.name) AS name,
        btrim(ext_vv_approved_document__c_src.recordtypeid) AS recordtypeid,
        btrim(ext_vv_approved_document__c_src.createddate) AS createddate,
        btrim(ext_vv_approved_document__c_src.createdbyid) AS createdbyid,
        btrim(ext_vv_approved_document__c_src.lastmodifieddate) AS lastmodifieddate,
        btrim(ext_vv_approved_document__c_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(ext_vv_approved_document__c_src.systemmodstamp) AS systemmodstamp,
        btrim(ext_vv_approved_document__c_src.lastactivitydate) AS lastactivitydate,
        btrim(ext_vv_approved_document__c_src.mayedit) AS mayedit,
        btrim(ext_vv_approved_document__c_src.islocked) AS islocked,
        btrim(ext_vv_approved_document__c_src.lastvieweddate) AS lastvieweddate,
        btrim(ext_vv_approved_document__c_src.lastreferenceddate) AS lastreferenceddate,
        btrim(ext_vv_approved_document__c_src.detail_group_vod__c) AS detail_group_vod__c,
        btrim(ext_vv_approved_document__c_src.document_description_vod__c) AS document_description_vod__c,
        btrim(ext_vv_approved_document__c_src.document_host_url_vod__c) AS document_host_url_vod__c,
        btrim(ext_vv_approved_document__c_src.document_id_vod__c) AS document_id_vod__c,
        btrim(ext_vv_approved_document__c_src.document_last_mod_datetime_vod__c) AS document_last_mod_datetime_vod__c,
        btrim(ext_vv_approved_document__c_src.email_allows_documents_vod__c) AS email_allows_documents_vod__c,
        btrim(ext_vv_approved_document__c_src.email_domain_vod__c) AS email_domain_vod__c,
        btrim(ext_vv_approved_document__c_src.email_from_address_vod__c) AS email_from_address_vod__c,
        btrim(ext_vv_approved_document__c_src.email_from_name_vod__c) AS email_from_name_vod__c,
        btrim(ext_vv_approved_document__c_src.email_replyto_address_vod__c) AS email_replyto_address_vod__c,
        btrim(ext_vv_approved_document__c_src.email_replyto_name_vod__c) AS email_replyto_name_vod__c,
        btrim(ext_vv_approved_document__c_src.email_subject_vod__c) AS email_subject_vod__c,
        btrim(ext_vv_approved_document__c_src.email_template_fragment_document_id_vod__c) AS email_template_fragment_document_id_vod__c,
        btrim(ext_vv_approved_document__c_src.isi_document_id_vod__c) AS isi_document_id_vod__c,
        btrim(ext_vv_approved_document__c_src.language_vod__c) AS language_vod__c,
        btrim(ext_vv_approved_document__c_src.other_document_id_list_vod__c) AS other_document_id_list_vod__c,
        btrim(ext_vv_approved_document__c_src.pi_document_id_vod__c) AS pi_document_id_vod__c,
        btrim(ext_vv_approved_document__c_src.piece_document_id_vod__c) AS piece_document_id_vod__c,
        btrim(ext_vv_approved_document__c_src.product_vod__c) AS product_vod__c,
        btrim(ext_vv_approved_document__c_src.status_vod__c) AS status_vod__c,
        btrim(ext_vv_approved_document__c_src.territory_vod__c) AS territory_vod__c,
        btrim(ext_vv_approved_document__c_src.vault_instance_id_vod__c) AS vault_instance_id_vod__c,
        btrim(ext_vv_approved_document__c_src.expiration_date_tva__c) AS expiration_date_tva__c,
        btrim(ext_vv_approved_document__c_src.group_to_share_to__c) AS group_to_share_to__c,
        btrim(ext_vv_approved_document__c_src.training_org_tva__c) AS training_org_tva__c,
        btrim(ext_vv_approved_document__c_src.unsub_svr_tva__c) AS unsub_svr_tva__c,
        ext_vv_approved_document__c_src.batch_id,
        ext_vv_approved_document__c_src.row_id,
        ext_vv_approved_document__c_src.update_ts
 FROM teva_ingestion.ext_vv_approved_document__c_src;

CREATE  VIEW raw.ext_vv_approved_document__c AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.mayedit,
        src.islocked,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.detail_group_vod__c,
        src.document_description_vod__c,
        src.document_host_url_vod__c,
        src.document_id_vod__c,
        src.document_last_mod_datetime_vod__c,
        src.email_allows_documents_vod__c,
        src.email_domain_vod__c,
        src.email_from_address_vod__c,
        src.email_from_name_vod__c,
        src.email_replyto_address_vod__c,
        src.email_replyto_name_vod__c,
        src.email_subject_vod__c,
        src.email_template_fragment_document_id_vod__c,
        src.isi_document_id_vod__c,
        src.language_vod__c,
        src.other_document_id_list_vod__c,
        src.pi_document_id_vod__c,
        src.piece_document_id_vod__c,
        src.product_vod__c,
        src.status_vod__c,
        src.territory_vod__c,
        src.vault_instance_id_vod__c,
        src.expiration_date_tva__c,
        src.group_to_share_to__c,
        src.training_org_tva__c,
        src.unsub_svr_tva__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_vv_approved_document__c_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ext_vv_approved_document__c'::varchar(27)))));

CREATE  VIEW teva_ingestion.EXT_WHOLESALE_867_V2 AS
 SELECT btrim(EXT_WHOLESALE_867_V2_src.ndc) AS ndc,
        btrim(EXT_WHOLESALE_867_V2_src.product_description) AS product_description,
        btrim(EXT_WHOLESALE_867_V2_src.product_name) AS product_name,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_name) AS trading_partner_name,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dea) AS trading_partner_dea,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_hin) AS trading_partner_hin,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_location_type) AS trading_partner_location_type,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_dea) AS trading_partner_dc_dea,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_hin) AS trading_partner_dc_hin,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_name) AS trading_partner_dc_name,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_address) AS trading_partner_dc_address,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_address_2) AS trading_partner_dc_address_2,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_city) AS trading_partner_dc_city,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_state) AS trading_partner_dc_state,
        btrim(EXT_WHOLESALE_867_V2_src.trading_partner_dc_zip) AS trading_partner_dc_zip,
        btrim(EXT_WHOLESALE_867_V2_src.class_of_trade) AS class_of_trade,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_name) AS outlet_location_name,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_dea) AS outlet_dea,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_hin) AS outlet_hin,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_340b) AS outlet_340b,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_ncpdp) AS outlet_ncpdp,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_npi) AS outlet_npi,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_address) AS outlet_location_address,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_address_2) AS outlet_location_address_2,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_city) AS outlet_location_city,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_state) AS outlet_location_state,
        btrim(EXT_WHOLESALE_867_V2_src.outlet_location_zip) AS outlet_location_zip,
        btrim(EXT_WHOLESALE_867_V2_src.reporting_date) AS reporting_date,
        btrim(EXT_WHOLESALE_867_V2_src.contract_number) AS contract_number,
        btrim(EXT_WHOLESALE_867_V2_src.contract_description) AS contract_description,
        btrim(EXT_WHOLESALE_867_V2_src.invoice_number) AS invoice_number,
        btrim(EXT_WHOLESALE_867_V2_src.invoice_date) AS invoice_date,
        btrim(EXT_WHOLESALE_867_V2_src.invoice_line_id) AS invoice_line_id,
        btrim(EXT_WHOLESALE_867_V2_src.quanitity_stock_sales_ss) AS quanitity_stock_sales_ss,
        btrim(EXT_WHOLESALE_867_V2_src.ds_sales_ds) AS ds_sales_ds,
        btrim(EXT_WHOLESALE_867_V2_src.summary_sales_su) AS summary_sales_su,
        btrim(EXT_WHOLESALE_867_V2_src.dock_to_dock_bq) AS dock_to_dock_bq,
        btrim(EXT_WHOLESALE_867_V2_src.interbranch_ib) AS interbranch_ib,
        btrim(EXT_WHOLESALE_867_V2_src.return_to_useable_ru) AS return_to_useable_ru,
        btrim(EXT_WHOLESALE_867_V2_src.return_to_vendor_rv) AS return_to_vendor_rv,
        btrim(EXT_WHOLESALE_867_V2_src.transfer_to_disposal_td) AS transfer_to_disposal_td,
        btrim(EXT_WHOLESALE_867_V2_src.adjusted_price) AS adjusted_price,
        btrim(EXT_WHOLESALE_867_V2_src.gross_amount) AS gross_amount,
        EXT_WHOLESALE_867_V2_src.batch_id,
        EXT_WHOLESALE_867_V2_src.row_id,
        EXT_WHOLESALE_867_V2_src.update_ts
 FROM teva_ingestion.EXT_WHOLESALE_867_V2_src;

CREATE  VIEW raw.ext_wholesale_867_v2 AS
 SELECT src.ndc,
        src.product_description,
        src.product_name,
        src.trading_partner_name,
        src.trading_partner_dea,
        src.trading_partner_hin,
        src.trading_partner_location_type,
        src.trading_partner_dc_dea,
        src.trading_partner_dc_hin,
        src.trading_partner_dc_name,
        src.trading_partner_dc_address,
        src.trading_partner_dc_address_2,
        src.trading_partner_dc_city,
        src.trading_partner_dc_state,
        src.trading_partner_dc_zip,
        src.class_of_trade,
        src.outlet_location_name,
        src.outlet_dea,
        src.outlet_hin,
        src.outlet_340b,
        src.outlet_ncpdp,
        src.outlet_npi,
        src.outlet_location_address,
        src.outlet_location_address_2,
        src.outlet_location_city,
        src.outlet_location_state,
        src.outlet_location_zip,
        src.reporting_date,
        src.contract_number,
        src.contract_description,
        src.invoice_number,
        src.invoice_date,
        src.invoice_line_id,
        src.quanitity_stock_sales_ss,
        src.ds_sales_ds,
        src.summary_sales_su,
        src.dock_to_dock_bq,
        src.interbranch_ib,
        src.return_to_useable_ru,
        src.return_to_vendor_rv,
        src.transfer_to_disposal_td,
        src.adjusted_price,
        src.gross_amount,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_WHOLESALE_867_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_WHOLESALE_867_V2'::varchar(20)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_FACT AS
 SELECT CASE WHEN (EXT_IMS_FIA_FACT_src.claim_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.claim_id))::int END AS claim_id,
        CASE WHEN (EXT_IMS_FIA_FACT_src.patient_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.patient_id))::int END AS patient_id,
        CASE WHEN (EXT_IMS_FIA_FACT_src.sequence_number = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.sequence_number))::int END AS sequence_number,
        btrim(EXT_IMS_FIA_FACT_src.product_id) AS product_id,
        CASE WHEN (EXT_IMS_FIA_FACT_src.fill_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_FACT_src.fill_date))::date END AS fill_date,
        btrim(EXT_IMS_FIA_FACT_src.claim_type) AS claim_type,
        btrim(EXT_IMS_FIA_FACT_src.reject_code) AS reject_code,
        CASE WHEN (EXT_IMS_FIA_FACT_src.days_supply = ''::varchar) THEN NULL::numeric(10,6) ELSE (btrim(EXT_IMS_FIA_FACT_src.days_supply))::numeric(10,6) END AS days_supply,
        btrim(EXT_IMS_FIA_FACT_src.quantity) AS quantity,
        CASE WHEN (EXT_IMS_FIA_FACT_src.refill_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.refill_code))::int END AS refill_code,
        btrim(EXT_IMS_FIA_FACT_src.plantrak_id) AS plantrak_id,
        btrim(EXT_IMS_FIA_FACT_src.opc_ask) AS opc_ask,
        btrim(EXT_IMS_FIA_FACT_src.sec_plantrak_id) AS sec_plantrak_id,
        btrim(EXT_IMS_FIA_FACT_src.buy_down) AS buy_down,
        btrim(EXT_IMS_FIA_FACT_src.opc_paid) AS opc_paid,
        btrim(EXT_IMS_FIA_FACT_src.prescriber_id) AS prescriber_id,
        btrim(EXT_IMS_FIA_FACT_src.sob) AS sob,
        btrim(EXT_IMS_FIA_FACT_src.sub_product_id) AS sub_product_id,
        btrim(EXT_IMS_FIA_FACT_src.sub_opc) AS sub_opc,
        CASE WHEN (EXT_IMS_FIA_FACT_src.initial_claim_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.initial_claim_id))::int END AS initial_claim_id,
        btrim(EXT_IMS_FIA_FACT_src.prev_product_id) AS prev_product_id,
        btrim(EXT_IMS_FIA_FACT_src.daw_code) AS daw_code,
        CASE WHEN (EXT_IMS_FIA_FACT_src.wrt_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_FACT_src.wrt_date))::date END AS wrt_date,
        btrim(EXT_IMS_FIA_FACT_src.claim_status) AS claim_status,
        btrim(EXT_IMS_FIA_FACT_src.copay_card_flg) AS copay_card_flg,
        btrim(EXT_IMS_FIA_FACT_src.zip_code) AS zip_code,
        CASE WHEN (EXT_IMS_FIA_FACT_src.ecoup_flag = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_src.ecoup_flag))::int END AS ecoup_flag,
        CASE WHEN (EXT_IMS_FIA_FACT_src.ecoup_offset_amt = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_src.ecoup_offset_amt))::numeric(10,2) END AS ecoup_offset_amt,
        CASE WHEN (EXT_IMS_FIA_FACT_src.standard_copay = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_src.standard_copay))::numeric(10,2) END AS standard_copay,
        btrim(EXT_IMS_FIA_FACT_src.standard_copay_yn) AS standard_copay_yn,
        CASE WHEN (EXT_IMS_FIA_FACT_src.flexible_fld_1_nbr = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_src.flexible_fld_1_nbr))::numeric(10,2) END AS flexible_fld_1_nbr,
        CASE WHEN (EXT_IMS_FIA_FACT_src.flexible_fld_2_nbr = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_src.flexible_fld_2_nbr))::numeric(10,2) END AS flexible_fld_2_nbr,
        btrim(EXT_IMS_FIA_FACT_src.flexible_fld_3_char) AS flexible_fld_3_char,
        btrim(EXT_IMS_FIA_FACT_src.flexible_fld_4_char) AS flexible_fld_4_char,
        btrim(EXT_IMS_FIA_FACT_src.fia_market_id) AS fia_market_id,
        btrim(EXT_IMS_FIA_FACT_src.fia_market_desc) AS fia_market_desc,
        EXT_IMS_FIA_FACT_src.batch_id,
        EXT_IMS_FIA_FACT_src.row_id,
        EXT_IMS_FIA_FACT_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_FACT_src;

CREATE  VIEW raw.ext_ims_fia_fact AS
 SELECT src.claim_id,
        src.patient_id,
        src.sequence_number,
        src.product_id,
        src.fill_date,
        src.claim_type,
        src.reject_code,
        src.days_supply,
        src.quantity,
        src.refill_code,
        src.plantrak_id,
        src.opc_ask,
        src.sec_plantrak_id,
        src.buy_down,
        src.opc_paid,
        src.prescriber_id,
        src.sob,
        src.sub_product_id,
        src.sub_opc,
        src.initial_claim_id,
        src.prev_product_id,
        src.daw_code,
        src.wrt_date,
        src.claim_status,
        src.copay_card_flg,
        src.zip_code,
        src.ecoup_flag,
        src.ecoup_offset_amt,
        src.standard_copay,
        src.standard_copay_yn,
        src.flexible_fld_1_nbr,
        src.flexible_fld_2_nbr,
        src.flexible_fld_3_char,
        src.flexible_fld_4_char,
        src.fia_market_id,
        src.fia_market_desc,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_FACT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_FACT'::varchar(16)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_GEOGRAPHY AS
 SELECT btrim(EXT_IMS_FIA_GEOGRAPHY_src.zip_code) AS zip_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_src.msa_code) AS msa_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_src.msa_description) AS msa_description,
        btrim(EXT_IMS_FIA_GEOGRAPHY_src.cbsa_code) AS cbsa_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_src.cbsa_description) AS cbsa_description,
        btrim(EXT_IMS_FIA_GEOGRAPHY_src.state_code) AS state_code,
        EXT_IMS_FIA_GEOGRAPHY_src.batch_id,
        EXT_IMS_FIA_GEOGRAPHY_src.row_id,
        EXT_IMS_FIA_GEOGRAPHY_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_GEOGRAPHY_src;

CREATE  VIEW raw.ext_ims_fia_geography AS
 SELECT src.zip_code,
        src.msa_code,
        src.msa_description,
        src.cbsa_code,
        src.cbsa_description,
        src.state_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_GEOGRAPHY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_GEOGRAPHY'::varchar(21)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_PLAN AS
 SELECT btrim(EXT_IMS_FIA_PLAN_src.plantrak_id) AS plantrak_id,
        btrim(EXT_IMS_FIA_PLAN_src.payer_name) AS payer_name,
        btrim(EXT_IMS_FIA_PLAN_src.plan_name) AS plan_name,
        btrim(EXT_IMS_FIA_PLAN_src.pbm_name) AS pbm_name,
        btrim(EXT_IMS_FIA_PLAN_src.payment_type) AS payment_type,
        btrim(EXT_IMS_FIA_PLAN_src.model_type) AS model_type,
        EXT_IMS_FIA_PLAN_src.batch_id,
        EXT_IMS_FIA_PLAN_src.row_id,
        EXT_IMS_FIA_PLAN_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_PLAN_src;

CREATE  VIEW raw.ext_ims_fia_plan AS
 SELECT src.plantrak_id,
        src.payer_name,
        src.plan_name,
        src.pbm_name,
        src.payment_type,
        src.model_type,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_PLAN_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_PLAN'::varchar(16)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_PRODUCT AS
 SELECT btrim(EXT_IMS_FIA_PRODUCT_src.product_id) AS product_id,
        btrim(EXT_IMS_FIA_PRODUCT_src.product_group) AS product_group,
        btrim(EXT_IMS_FIA_PRODUCT_src.product_name) AS product_name,
        CASE WHEN (EXT_IMS_FIA_PRODUCT_src.product_group_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_PRODUCT_src.product_group_id))::int END AS product_group_id,
        btrim(EXT_IMS_FIA_PRODUCT_src.cmf10) AS cmf10,
        btrim(EXT_IMS_FIA_PRODUCT_src.fia_market_id) AS fia_market_id,
        btrim(EXT_IMS_FIA_PRODUCT_src.fia_market_desc) AS fia_market_desc,
        EXT_IMS_FIA_PRODUCT_src.batch_id,
        EXT_IMS_FIA_PRODUCT_src.row_id,
        EXT_IMS_FIA_PRODUCT_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_PRODUCT_src;

CREATE  VIEW raw.ext_ims_fia_product AS
 SELECT src.product_id,
        src.product_group,
        src.product_name,
        src.product_group_id,
        src.cmf10,
        src.fia_market_id,
        src.fia_market_desc,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_PRODUCT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_PRODUCT'::varchar(19)))));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_REJECT AS
 SELECT btrim(EXT_IMS_FIA_REJECT_src.reject_code) AS reject_code,
        btrim(EXT_IMS_FIA_REJECT_src.reject_reason) AS reject_reason,
        btrim(EXT_IMS_FIA_REJECT_src.reject_group) AS reject_group,
        EXT_IMS_FIA_REJECT_src.batch_id,
        EXT_IMS_FIA_REJECT_src.row_id,
        EXT_IMS_FIA_REJECT_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_REJECT_src;

CREATE  VIEW raw.ext_ims_fia_reject AS
 SELECT src.reject_code,
        src.reject_reason,
        src.reject_group,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_REJECT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_REJECT'::varchar(18)))));

CREATE  VIEW outbound.zs_ajovy_activity_call_detail AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position
 FROM (datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id)))
 WHERE (cd.basket_name ~~ 'AJOVY%'::varchar(6))
 ORDER BY c.call_date;

CREATE  VIEW veeva.v_approved_document AS
 SELECT approved_document.id,
        approved_document.ownerid,
        approved_document.isdeleted,
        approved_document.name,
        approved_document.recordtypeid,
        approved_document.createddate,
        approved_document.createdbyid,
        approved_document.lastmodifieddate,
        approved_document.lastmodifiedbyid,
        approved_document.systemmodstamp,
        approved_document.lastactivitydate,
        approved_document.mayedit,
        approved_document.islocked,
        approved_document.lastvieweddate,
        approved_document.lastreferenceddate,
        approved_document.detail_group_vod__c,
        approved_document.document_description_vod__c,
        approved_document.document_host_url_vod__c,
        approved_document.document_id_vod__c,
        approved_document.document_last_mod_datetime_vod__c,
        approved_document.email_allows_documents_vod__c,
        approved_document.email_domain_vod__c,
        approved_document.email_from_address_vod__c,
        approved_document.email_from_name_vod__c,
        approved_document.email_replyto_address_vod__c,
        approved_document.email_replyto_name_vod__c,
        approved_document.email_subject_vod__c,
        approved_document.email_template_fragment_document_id_vod__c,
        approved_document.isi_document_id_vod__c,
        approved_document.language_vod__c,
        approved_document.other_document_id_list_vod__c,
        approved_document.pi_document_id_vod__c,
        approved_document.piece_document_id_vod__c,
        approved_document.product_vod__c,
        approved_document.status_vod__c,
        approved_document.territory_vod__c,
        approved_document.vault_instance_id_vod__c,
        approved_document.expiration_date_tva__c,
        approved_document.group_to_share_to__c,
        approved_document.training_org_tva__c,
        approved_document.unsub_svr_tva__c,
        approved_document.file_id,
        approved_document.record_id
 FROM veeva.approved_document
 WHERE (approved_document.file_id = ( SELECT max(approved_document.file_id) AS max
 FROM veeva.approved_document));

CREATE  VIEW teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS AS
 SELECT btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.client_num) AS client_num,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.report_num) AS report_num,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.outlet_code) AS outlet_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.zip) AS zip,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.subcategory_code) AS subcategory_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.sra_4) AS sra_4,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.category_code) AS category_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.ims_product_code) AS ims_product_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.data_date) AS data_date,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth01) AS dol_mth01,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth02) AS dol_mth02,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth03) AS dol_mth03,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth04) AS dol_mth04,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth05) AS dol_mth05,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth06) AS dol_mth06,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth07) AS dol_mth07,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth08) AS dol_mth08,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth09) AS dol_mth09,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth10) AS dol_mth10,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth11) AS dol_mth11,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth12) AS dol_mth12,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth13) AS dol_mth13,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth14) AS dol_mth14,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth15) AS dol_mth15,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth16) AS dol_mth16,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth17) AS dol_mth17,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth18) AS dol_mth18,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth19) AS dol_mth19,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth20) AS dol_mth20,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth21) AS dol_mth21,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth22) AS dol_mth22,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth23) AS dol_mth23,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.dol_mth24) AS dol_mth24,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.city) AS city,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_src.state) AS state,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_src.batch_id,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_src.row_id,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_src.update_ts
 FROM teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS_src;

CREATE  VIEW raw.ext_antimigraine_ddd_dollars AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.dol_mth01,
        src.dol_mth02,
        src.dol_mth03,
        src.dol_mth04,
        src.dol_mth05,
        src.dol_mth06,
        src.dol_mth07,
        src.dol_mth08,
        src.dol_mth09,
        src.dol_mth10,
        src.dol_mth11,
        src.dol_mth12,
        src.dol_mth13,
        src.dol_mth14,
        src.dol_mth15,
        src.dol_mth16,
        src.dol_mth17,
        src.dol_mth18,
        src.dol_mth19,
        src.dol_mth20,
        src.dol_mth21,
        src.dol_mth22,
        src.dol_mth23,
        src.dol_mth24,
        src.city,
        src.state,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ANTIMIGRAINE_DDD_DOLLARS'::varchar(28)))));

CREATE  VIEW teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY AS
 SELECT btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.client_num) AS client_num,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.report_num) AS report_num,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.outlet_code) AS outlet_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.zip) AS zip,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.subcategory_code) AS subcategory_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.sra_4) AS sra_4,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.category_code) AS category_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.ims_product_code) AS ims_product_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.data_date) AS data_date,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth01) AS qty_mth01,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth02) AS qty_mth02,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth03) AS qty_mth03,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth04) AS qty_mth04,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth05) AS qty_mth05,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth06) AS qty_mth06,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth07) AS qty_mth07,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth08) AS qty_mth08,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth09) AS qty_mth09,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth10) AS qty_mth10,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth11) AS qty_mth11,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth12) AS qty_mth12,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth13) AS qty_mth13,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth14) AS qty_mth14,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth15) AS qty_mth15,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth16) AS qty_mth16,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth17) AS qty_mth17,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth18) AS qty_mth18,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth19) AS qty_mth19,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth20) AS qty_mth20,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth21) AS qty_mth21,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth22) AS qty_mth22,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth23) AS qty_mth23,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.qty_mth24) AS qty_mth24,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.city) AS city,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_src.state) AS state,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_src.batch_id,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_src.row_id,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_src.update_ts
 FROM teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY_src;

CREATE  VIEW raw.ext_antimigraine_ddd_quantity AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.qty_mth01,
        src.qty_mth02,
        src.qty_mth03,
        src.qty_mth04,
        src.qty_mth05,
        src.qty_mth06,
        src.qty_mth07,
        src.qty_mth08,
        src.qty_mth09,
        src.qty_mth10,
        src.qty_mth11,
        src.qty_mth12,
        src.qty_mth13,
        src.qty_mth14,
        src.qty_mth15,
        src.qty_mth16,
        src.qty_mth17,
        src.qty_mth18,
        src.qty_mth19,
        src.qty_mth20,
        src.qty_mth21,
        src.qty_mth22,
        src.qty_mth23,
        src.qty_mth24,
        src.city,
        src.state,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ANTIMIGRAINE_DDD_QUANTITY'::varchar(29)))));

CREATE  VIEW teva_ingestion.XPD_CORE_METRICS AS
 SELECT btrim(XPD_CORE_METRICS_src.ims_client_number) AS ims_client_number,
        btrim(XPD_CORE_METRICS_src.ims_report_number) AS ims_report_number,
        btrim(XPD_CORE_METRICS_src.channel_indicator) AS channel_indicator,
        btrim(XPD_CORE_METRICS_src.ims_id) AS ims_id,
        btrim(XPD_CORE_METRICS_src.filler_01) AS filler_01,
        btrim(XPD_CORE_METRICS_src.specialty) AS specialty,
        btrim(XPD_CORE_METRICS_src.flexible_field_2) AS flexible_field_2,
        btrim(XPD_CORE_METRICS_src.flexible_field_3) AS flexible_field_3,
        btrim(XPD_CORE_METRICS_src.flexible_field_4) AS flexible_field_4,
        btrim(XPD_CORE_METRICS_src.flexible_field_5) AS flexible_field_5,
        btrim(XPD_CORE_METRICS_src.flexible_field_6) AS flexible_field_6,
        btrim(XPD_CORE_METRICS_src.flexible_field_7) AS flexible_field_7,
        btrim(XPD_CORE_METRICS_src.flexible_field_8) AS flexible_field_8,
        btrim(XPD_CORE_METRICS_src.ims_product_group) AS ims_product_group,
        btrim(XPD_CORE_METRICS_src.month_ending) AS month_ending,
        btrim(XPD_CORE_METRICS_src.xpo_nrx) AS xpo_nrx,
        btrim(XPD_CORE_METRICS_src.xpo_trx) AS xpo_trx,
        btrim(XPD_CORE_METRICS_src.unknown_nrx) AS unknown_nrx,
        btrim(XPD_CORE_METRICS_src.unknown_trx) AS unknown_trx,
        btrim(XPD_CORE_METRICS_src.new_therapy_starts) AS new_therapy_starts,
        btrim(XPD_CORE_METRICS_src.continued_new) AS continued_new,
        btrim(XPD_CORE_METRICS_src.switch_to) AS switch_to,
        btrim(XPD_CORE_METRICS_src.add_on) AS add_on,
        btrim(XPD_CORE_METRICS_src.restart_same_new) AS restart_same_new,
        btrim(XPD_CORE_METRICS_src.restart_different) AS restart_different,
        btrim(XPD_CORE_METRICS_src.continued_refill) AS continued_refill,
        btrim(XPD_CORE_METRICS_src.restart_same_refill) AS restart_same_refill,
        btrim(XPD_CORE_METRICS_src.switch_from) AS switch_from,
        btrim(XPD_CORE_METRICS_src.restart_different_from) AS restart_different_from,
        btrim(XPD_CORE_METRICS_src.add_to) AS add_to,
        btrim(XPD_CORE_METRICS_src.market_new_to_brand_rx) AS market_new_to_brand_rx,
        btrim(XPD_CORE_METRICS_src.dynamic_capture_rx) AS dynamic_capture_rx,
        btrim(XPD_CORE_METRICS_src.filler_02) AS filler_02,
        XPD_CORE_METRICS_src.batch_id,
        XPD_CORE_METRICS_src.row_id,
        XPD_CORE_METRICS_src.update_ts
 FROM teva_ingestion.XPD_CORE_METRICS_src;

CREATE  VIEW raw.xpd_core_metrics AS
 SELECT src.ims_client_number,
        src.ims_report_number,
        src.channel_indicator,
        src.ims_id,
        src.filler_01,
        src.specialty,
        src.flexible_field_2,
        src.flexible_field_3,
        src.flexible_field_4,
        src.flexible_field_5,
        src.flexible_field_6,
        src.flexible_field_7,
        src.flexible_field_8,
        src.ims_product_group,
        src.month_ending,
        src.xpo_nrx,
        src.xpo_trx,
        src.unknown_nrx,
        src.unknown_trx,
        src.new_therapy_starts,
        src.continued_new,
        src.switch_to,
        src.add_on,
        src.restart_same_new,
        src.restart_different,
        src.continued_refill,
        src.restart_same_refill,
        src.switch_from,
        src.restart_different_from,
        src.add_to,
        src.market_new_to_brand_rx,
        src.dynamic_capture_rx,
        src.filler_02,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XPD_CORE_METRICS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XPD_CORE_METRICS'::varchar(16)))));

CREATE  VIEW teva_ingestion.XPD_DEMOGRAPHICS AS
 SELECT btrim(XPD_DEMOGRAPHICS_src.ims_client_number) AS ims_client_number,
        btrim(XPD_DEMOGRAPHICS_src.ims_report_number) AS ims_report_number,
        btrim(XPD_DEMOGRAPHICS_src.ims_id) AS ims_id,
        btrim(XPD_DEMOGRAPHICS_src.filler_01) AS filler_01,
        btrim(XPD_DEMOGRAPHICS_src.last_name) AS last_name,
        btrim(XPD_DEMOGRAPHICS_src.first_name) AS first_name,
        btrim(XPD_DEMOGRAPHICS_src.middle_name) AS middle_name,
        btrim(XPD_DEMOGRAPHICS_src.address_1) AS address_1,
        btrim(XPD_DEMOGRAPHICS_src.address_2) AS address_2,
        btrim(XPD_DEMOGRAPHICS_src.city) AS city,
        btrim(XPD_DEMOGRAPHICS_src.state) AS state,
        btrim(XPD_DEMOGRAPHICS_src.zip) AS zip,
        btrim(XPD_DEMOGRAPHICS_src.specialty) AS specialty,
        btrim(XPD_DEMOGRAPHICS_src.specialty_description) AS specialty_description,
        btrim(XPD_DEMOGRAPHICS_src.trx_decile_retail) AS trx_decile_retail,
        btrim(XPD_DEMOGRAPHICS_src.nrx_decile_retail) AS nrx_decile_retail,
        btrim(XPD_DEMOGRAPHICS_src.nbrx_decile_retail) AS nbrx_decile_retail,
        btrim(XPD_DEMOGRAPHICS_src.trx_decile_mail) AS trx_decile_mail,
        btrim(XPD_DEMOGRAPHICS_src.nrx_decile_mail) AS nrx_decile_mail,
        btrim(XPD_DEMOGRAPHICS_src.nbrx_decile_mail) AS nbrx_decile_mail,
        btrim(XPD_DEMOGRAPHICS_src.market_prescriber_reliability_retail) AS market_prescriber_reliability_retail,
        btrim(XPD_DEMOGRAPHICS_src.market_prescriber_reliability_mail) AS market_prescriber_reliability_mail,
        XPD_DEMOGRAPHICS_src.batch_id,
        XPD_DEMOGRAPHICS_src.row_id,
        XPD_DEMOGRAPHICS_src.update_ts
 FROM teva_ingestion.XPD_DEMOGRAPHICS_src;

CREATE  VIEW raw.xpd_demographics AS
 SELECT src.ims_client_number,
        src.ims_report_number,
        src.ims_id,
        src.filler_01,
        src.last_name,
        src.first_name,
        src.middle_name,
        src.address_1,
        src.address_2,
        src.city,
        src.state,
        src.zip,
        src.specialty,
        src.specialty_description,
        src.trx_decile_retail,
        src.nrx_decile_retail,
        src.nbrx_decile_retail,
        src.trx_decile_mail,
        src.nrx_decile_mail,
        src.nbrx_decile_mail,
        src.market_prescriber_reliability_retail,
        src.market_prescriber_reliability_mail,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XPD_DEMOGRAPHICS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XPD_DEMOGRAPHICS'::varchar(16)))));

CREATE  VIEW teva_ingestion.XPD_SWITCH_DETAILS AS
 SELECT btrim(XPD_SWITCH_DETAILS_src.ims_client_number) AS ims_client_number,
        btrim(XPD_SWITCH_DETAILS_src.ims_report_number) AS ims_report_number,
        btrim(XPD_SWITCH_DETAILS_src.channel_indicator) AS channel_indicator,
        btrim(XPD_SWITCH_DETAILS_src.ims_id) AS ims_id,
        btrim(XPD_SWITCH_DETAILS_src.filler_01) AS filler_01,
        btrim(XPD_SWITCH_DETAILS_src.specialty) AS specialty,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_2) AS flexible_field_2,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_3) AS flexible_field_3,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_4) AS flexible_field_4,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_5) AS flexible_field_5,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_6) AS flexible_field_6,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_7) AS flexible_field_7,
        btrim(XPD_SWITCH_DETAILS_src.flexible_field_8) AS flexible_field_8,
        btrim(XPD_SWITCH_DETAILS_src.switch_from_product_group_num) AS switch_from_product_group_num,
        btrim(XPD_SWITCH_DETAILS_src.switch_to_product_group_num) AS switch_to_product_group_num,
        btrim(XPD_SWITCH_DETAILS_src.month_ending) AS month_ending,
        btrim(XPD_SWITCH_DETAILS_src.rx) AS rx,
        XPD_SWITCH_DETAILS_src.batch_id,
        XPD_SWITCH_DETAILS_src.row_id,
        XPD_SWITCH_DETAILS_src.update_ts
 FROM teva_ingestion.XPD_SWITCH_DETAILS_src;

CREATE  VIEW raw.xpd_switch_details AS
 SELECT src.ims_client_number,
        src.ims_report_number,
        src.channel_indicator,
        src.ims_id,
        src.filler_01,
        src.specialty,
        src.flexible_field_2,
        src.flexible_field_3,
        src.flexible_field_4,
        src.flexible_field_5,
        src.flexible_field_6,
        src.flexible_field_7,
        src.flexible_field_8,
        src.switch_from_product_group_num,
        src.switch_to_product_group_num,
        src.month_ending,
        src.rx,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XPD_SWITCH_DETAILS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XPD_SWITCH_DETAILS'::varchar(18)))));

CREATE  VIEW outbound.zs_xpd_demographics AS
SELECT xpd_demographics.ims_client_number, xpd_demographics.ims_report_number, xpd_demographics.ims_id, xpd_demographics.tvcmid, xpd_demographics.last_name, xpd_demographics.first_name, xpd_demographics.middle_name, xpd_demographics.address_1, xpd_demographics.address_2, xpd_demographics.city, xpd_demographics.state, xpd_demographics.zip, xpd_demographics.specialty, xpd_demographics.specialty_description, xpd_demographics.trx_decile_retail, xpd_demographics.nrx_decile_retail, xpd_demographics.nbrx_decile_retail, xpd_demographics.trx_decile_mail, xpd_demographics.nrx_decile_mail, xpd_demographics.nbrx_decile_mail, xpd_demographics.market_prescriber_reliability_retail, xpd_demographics.market_prescriber_reliability_mail FROM datamart.xpd_demographics;

CREATE  VIEW outbound.zs_xpd_core_metrics AS
SELECT xpd_core_metrics.ims_client_number, xpd_core_metrics.ims_report_number, xpd_core_metrics.channel_indicator, xpd_core_metrics.ims_id, xpd_core_metrics.tvcmid, xpd_core_metrics.specialty, xpd_core_metrics.ims_product_group, xpd_core_metrics.basket_id, xpd_core_metrics.basket_name, xpd_core_metrics.rollup_month, xpd_core_metrics.xpo_nrx, xpd_core_metrics.xpo_trx, xpd_core_metrics.unknown_nrx, xpd_core_metrics.unknown_trx, xpd_core_metrics.new_therapy_starts, xpd_core_metrics.continued_new, xpd_core_metrics.switch_to, xpd_core_metrics.add_on, xpd_core_metrics.restart_same_new, xpd_core_metrics.restart_different, xpd_core_metrics.continued_refill, xpd_core_metrics.restart_same_refill, xpd_core_metrics.switch_from, xpd_core_metrics.restart_different_from, xpd_core_metrics.add_to, xpd_core_metrics.market_new_to_brand_rx, xpd_core_metrics.dynamic_capture_rx FROM datamart.xpd_core_metrics;

CREATE  VIEW teva_ingestion.EXT_AXTRIA_TERRITORY_HIERARCHY AS
 SELECT btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.id) AS id,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.ownerid) AS ownerid,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.isdeleted) AS isdeleted,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.name) AS name,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.createddate))::timestamp END AS createddate,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.systemmodstamp))::timestamp END AS systemmodstamp,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastactivitydate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastactivitydate))::timestamp END AS lastactivitydate,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.business_unit_code__c) AS business_unit_code__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.business_unit_name__c) AS business_unit_name__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.credentialing_eligible__c) AS credentialing_eligible__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.fleet_eligibile__c) AS fleet_eligibile__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.parent_territory_number__c) AS parent_territory_number__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.sales_team_code__c) AS sales_team_code__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.sales_team_name__c) AS sales_team_name__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_end_date__c) AS territory_end_date__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_level__c) AS territory_level__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_name__c) AS territory_name__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_number__c) AS territory_number__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_sampling__c) AS territory_sampling__c,
        btrim(EXT_AXTRIA_TERRITORY_HIERARCHY_src.territory_start_date__c) AS territory_start_date__c,
        EXT_AXTRIA_TERRITORY_HIERARCHY_src.batch_id,
        EXT_AXTRIA_TERRITORY_HIERARCHY_src.row_id,
        EXT_AXTRIA_TERRITORY_HIERARCHY_src.update_ts
 FROM teva_ingestion.EXT_AXTRIA_TERRITORY_HIERARCHY_src;

CREATE  VIEW raw.ext_axtria_territory_hierarchy AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.business_unit_code__c,
        src.business_unit_name__c,
        src.credentialing_eligible__c,
        src.fleet_eligibile__c,
        src.parent_territory_number__c,
        src.sales_team_code__c,
        src.sales_team_name__c,
        src.territory_end_date__c,
        src.territory_level__c,
        src.territory_name__c,
        src.territory_number__c,
        src.territory_sampling__c,
        src.territory_start_date__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AXTRIA_TERRITORY_HIERARCHY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AXTRIA_TERRITORY_HIERARCHY'::varchar(30)))));

CREATE  VIEW teva_ingestion.EXT_PROGNOS_CINQAIR_V2 AS
 SELECT btrim(EXT_PROGNOS_CINQAIR_V2_src.week_end_date) AS week_end_date,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.practice_name) AS practice_name,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.practice_address_line_1) AS practice_address_line_1,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.pracitce_address_line_2) AS pracitce_address_line_2,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.city) AS city,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.state) AS state,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.zip_code) AS zip_code,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.provider_first_name) AS provider_first_name,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.provider_last_name) AS provider_last_name,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.npi) AS npi,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.specialty_1) AS specialty_1,
        btrim(EXT_PROGNOS_CINQAIR_V2_src.specialty_2) AS specialty_2,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_0_149 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_0_149))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_0_149,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_150_399 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_150_399))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_150_399,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater))::int END AS pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_0_149 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_0_149))::int END AS pts_with_ao_asthma_and_eosinophils_0_149,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_150_399 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_150_399))::int END AS pts_with_ao_asthma_and_eosinophils_150_399,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_400_or_greater = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_ao_asthma_and_eosinophils_400_or_greater))::int END AS pts_with_ao_asthma_and_eosinophils_400_or_greater,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_has_eosinophils_300_499 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_has_eosinophils_300_499))::int END AS pts_with_moderate_severe_asthma_and_has_eosinophils_300_499,
        CASE WHEN (EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_CINQAIR_V2_src.pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater))::int END AS pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater,
        EXT_PROGNOS_CINQAIR_V2_src.batch_id,
        EXT_PROGNOS_CINQAIR_V2_src.row_id,
        EXT_PROGNOS_CINQAIR_V2_src.update_ts
 FROM teva_ingestion.EXT_PROGNOS_CINQAIR_V2_src;

CREATE  VIEW raw.ext_prognos_cinqair_v2 AS
 SELECT src.week_end_date,
        src.practice_name,
        src.practice_address_line_1,
        src.pracitce_address_line_2,
        src.city,
        src.state,
        src.zip_code,
        src.provider_first_name,
        src.provider_last_name,
        src.npi,
        src.specialty_1,
        src.specialty_2,
        src.pts_with_moderate_severe_asthma_and_eosinophils_0_149,
        src.pts_with_moderate_severe_asthma_and_eosinophils_150_399,
        src.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
        src.pts_with_ao_asthma_and_eosinophils_0_149,
        src.pts_with_ao_asthma_and_eosinophils_150_399,
        src.pts_with_ao_asthma_and_eosinophils_400_or_greater,
        src.pts_with_moderate_severe_asthma_and_has_eosinophils_300_499,
        src.pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PROGNOS_CINQAIR_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PROGNOS_CINQAIR_V2'::varchar(22)))));

CREATE  VIEW teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS_V2 AS
 SELECT btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.client_num) AS client_num,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.report_num) AS report_num,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_code) AS outlet_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.zip) AS zip,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.subcategory_code) AS subcategory_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.sra_4) AS sra_4,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.category_code) AS category_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.ims_product_code) AS ims_product_code,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.data_date) AS data_date,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth01) AS dol_mth01,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth02) AS dol_mth02,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth03) AS dol_mth03,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth04) AS dol_mth04,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth05) AS dol_mth05,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth06) AS dol_mth06,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth07) AS dol_mth07,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth08) AS dol_mth08,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth09) AS dol_mth09,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth10) AS dol_mth10,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth11) AS dol_mth11,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth12) AS dol_mth12,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth13) AS dol_mth13,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth14) AS dol_mth14,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth15) AS dol_mth15,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth16) AS dol_mth16,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth17) AS dol_mth17,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth18) AS dol_mth18,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth19) AS dol_mth19,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth20) AS dol_mth20,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth21) AS dol_mth21,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth22) AS dol_mth22,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth23) AS dol_mth23,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.dol_mth24) AS dol_mth24,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_name) AS outlet_name,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_address) AS outlet_address,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_city) AS outlet_city,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_state) AS outlet_state,
        btrim(EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.outlet_zip) AS outlet_zip,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.batch_id,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.row_id,
        EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src.update_ts
 FROM teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src;

CREATE  VIEW raw.ext_antimigraine_ddd_dollars_v2 AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.dol_mth01,
        src.dol_mth02,
        src.dol_mth03,
        src.dol_mth04,
        src.dol_mth05,
        src.dol_mth06,
        src.dol_mth07,
        src.dol_mth08,
        src.dol_mth09,
        src.dol_mth10,
        src.dol_mth11,
        src.dol_mth12,
        src.dol_mth13,
        src.dol_mth14,
        src.dol_mth15,
        src.dol_mth16,
        src.dol_mth17,
        src.dol_mth18,
        src.dol_mth19,
        src.dol_mth20,
        src.dol_mth21,
        src.dol_mth22,
        src.dol_mth23,
        src.dol_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ANTIMIGRAINE_DDD_DOLLARS_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ANTIMIGRAINE_DDD_DOLLARS_V2'::varchar(31)))));

CREATE  VIEW teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY_V2 AS
 SELECT btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.client_num) AS client_num,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.report_num) AS report_num,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_code) AS outlet_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.zip) AS zip,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.subcategory_code) AS subcategory_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.sra_4) AS sra_4,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.category_code) AS category_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.ims_product_code) AS ims_product_code,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.data_date) AS data_date,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth01) AS qty_mth01,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth02) AS qty_mth02,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth03) AS qty_mth03,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth04) AS qty_mth04,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth05) AS qty_mth05,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth06) AS qty_mth06,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth07) AS qty_mth07,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth08) AS qty_mth08,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth09) AS qty_mth09,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth10) AS qty_mth10,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth11) AS qty_mth11,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth12) AS qty_mth12,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth13) AS qty_mth13,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth14) AS qty_mth14,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth15) AS qty_mth15,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth16) AS qty_mth16,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth17) AS qty_mth17,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth18) AS qty_mth18,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth19) AS qty_mth19,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth20) AS qty_mth20,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth21) AS qty_mth21,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth22) AS qty_mth22,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth23) AS qty_mth23,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.qty_mth24) AS qty_mth24,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_name) AS outlet_name,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_address) AS outlet_address,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_city) AS outlet_city,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_state) AS outlet_state,
        btrim(EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.outlet_zip) AS outlet_zip,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.batch_id,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.row_id,
        EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src.update_ts
 FROM teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src;

CREATE  VIEW raw.ext_antimigraine_ddd_quantity_v2 AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.qty_mth01,
        src.qty_mth02,
        src.qty_mth03,
        src.qty_mth04,
        src.qty_mth05,
        src.qty_mth06,
        src.qty_mth07,
        src.qty_mth08,
        src.qty_mth09,
        src.qty_mth10,
        src.qty_mth11,
        src.qty_mth12,
        src.qty_mth13,
        src.qty_mth14,
        src.qty_mth15,
        src.qty_mth16,
        src.qty_mth17,
        src.qty_mth18,
        src.qty_mth19,
        src.qty_mth20,
        src.qty_mth21,
        src.qty_mth22,
        src.qty_mth23,
        src.qty_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ANTIMIGRAINE_DDD_QUANTITY_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ANTIMIGRAINE_DDD_QUANTITY_V2'::varchar(32)))));

CREATE  VIEW teva_ingestion.ONC_SALES_ADJUSTMENT_LOAD AS
 SELECT btrim(ONC_SALES_ADJUSTMENT_LOAD_src.adj_code) AS adj_code,
        btrim(ONC_SALES_ADJUSTMENT_LOAD_src.adj_time_period) AS adj_time_period,
        CASE WHEN (ONC_SALES_ADJUSTMENT_LOAD_src.tvcmid = ''::varchar) THEN NULL::int ELSE (btrim(ONC_SALES_ADJUSTMENT_LOAD_src.tvcmid))::int END AS tvcmid,
        CASE WHEN (ONC_SALES_ADJUSTMENT_LOAD_src.basket_id = ''::varchar) THEN NULL::int ELSE (btrim(ONC_SALES_ADJUSTMENT_LOAD_src.basket_id))::int END AS basket_id,
        CASE WHEN (ONC_SALES_ADJUSTMENT_LOAD_src.adj_factor = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(ONC_SALES_ADJUSTMENT_LOAD_src.adj_factor))::numeric(10,2) END AS adj_factor,
        ONC_SALES_ADJUSTMENT_LOAD_src.batch_id,
        ONC_SALES_ADJUSTMENT_LOAD_src.row_id,
        ONC_SALES_ADJUSTMENT_LOAD_src.update_ts
 FROM teva_ingestion.ONC_SALES_ADJUSTMENT_LOAD_src;

CREATE  VIEW raw.onc_sales_adjustment_load AS
 SELECT src.adj_code,
        src.adj_time_period,
        src.tvcmid,
        src.basket_id,
        src.adj_factor,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ONC_SALES_ADJUSTMENT_LOAD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ONC_SALES_ADJUSTMENT_LOAD'::varchar(25)))));

CREATE  VIEW outbound.vendormate_roster AS
 SELECT roster.sales_force_id,
        roster.employee_id,
        roster.username,
        roster.territory_number,
        roster.territory_name,
        roster.first_name,
        roster.middle_name,
        roster.last_name,
        roster.hr_status,
        roster.email,
        roster.business_address_line1,
        roster.business_address_line2,
        roster.business_address_line3,
        roster.business_city,
        roster.business_state,
        roster.business_zip,
        roster.shipping_address_line1,
        roster.shipping_address_line2,
        roster.shipping_address_line3,
        roster.shipping_city,
        roster.shipping_state,
        roster.shipping_zip,
        roster.mobile_phone,
        roster.business_phone,
        roster.home_phone,
        roster.voice_mail_extension,
        roster.hire_date,
        roster.birth_month_day
 FROM datamart.roster
 WHERE ((roster.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TE'::varchar(2), 'TM'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND (roster.last_name <> 'Vacant'::varchar(6)))
 ORDER BY roster.sales_force_id,
          roster.hire_date DESC;

CREATE  VIEW outbound.valuecentricrxdataextract AS
 SELECT '4416451422'::varchar(10) AS CUSTOMERID,
        a.basket_name AS BRAND_NAME,
        CASE WHEN (a.basket_name = 'COPAXONE 20MG'::varchar(13)) THEN '68546031730'::varchar(11) WHEN (a.basket_name = 'COPAXONE 40MG'::varchar(13)) THEN '68546032512'::varchar(11) WHEN (a.basket_name = 'PROAIR HFA'::varchar(10)) THEN '59310057920'::varchar(11) WHEN (a.basket_name = 'PROAIR HFA COUNTER'::varchar(18)) THEN '59310057922'::varchar(11) WHEN (a.basket_name = 'PROAIR RESPICLICK'::varchar(17)) THEN '59310058020'::varchar(11) WHEN (a.basket_name = 'QNASL 40'::varchar(8)) THEN '59310020606'::varchar(11) WHEN (a.basket_name = 'QNASL 80'::varchar(8)) THEN '59310021012'::varchar(11) WHEN (a.basket_name = 'QVAR 40MCG'::varchar(10)) THEN '59310020212'::varchar(11) WHEN (a.basket_name = 'QVAR 80MCG'::varchar(10)) THEN '59310020412'::varchar(11) ELSE NULL END AS NDCUPC,
        a.ptr_zip AS ZIP,
        to_char(a.rollup_month, 'MM/DD/YYYY'::varchar(10)) AS PERIOD_END_DATE,
        sum(a.trx_count) AS TRX_CNT,
        sum(a.trx_quantity) AS TRX_QTY
 FROM ( SELECT rx.ims_id,
        rx.rollup_month,
        rx.basket_name,
        rx.trx_count,
        rx.trx_quantity,
        pcd.ptr_zip
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT prescriber_combined_demographics.ims_id,
        min(prescriber_combined_demographics.ptr_zip) AS ptr_zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TN'::varchar(2))
 GROUP BY prescriber_combined_demographics.ims_id) pcd ON ((pcd.ims_id = rx.ims_id))) JOIN outbound.month_rollup_and_bucket mth ON ((rx.rollup_month = mth.month_ending)))
 WHERE ((rx.sales_category = '01'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (rx.basket_type = 'product'::varchar(7)) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 12) AND (rx.basket_name = ANY (ARRAY['COPAXONE 20MG'::varchar(13), 'COPAXONE 40MG'::varchar(13)]))) UNION ALL  SELECT rx.ims_id,
        rx.rollup_month,
        rx.basket_name,
        rx.trx_count,
        0 AS trx_quantity,
        pcd.ptr_zip
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT prescriber_combined_demographics.ims_id,
        min(prescriber_combined_demographics.ptr_zip) AS ptr_zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))
 GROUP BY prescriber_combined_demographics.ims_id) pcd ON ((pcd.ims_id = rx.ims_id))) JOIN outbound.month_rollup_and_bucket mth ON ((rx.rollup_month = mth.month_ending)))
 WHERE ((rx.sales_category = '01'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (rx.basket_type = 'product'::varchar(7)) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 12) AND (rx.basket_name = ANY (ARRAY['PROAIR HFA'::varchar(18), 'PROAIR HFA COUNTER'::varchar(18), 'PROAIR RESPICLICK'::varchar(18), 'QNASL 40'::varchar(18), 'QNASL 80'::varchar(18), 'QVAR 40MCG'::varchar(18), 'QVAR 80MCG'::varchar(18)])))) a
 GROUP BY a.basket_name,
          a.ptr_zip,
          a.rollup_month
 ORDER BY a.basket_name,
          a.ptr_zip,
          a.rollup_month;

CREATE  VIEW outbound.bullseye_prescriber_rx AS
 SELECT rx.tvcmid,
        rx.ims_id,
        CASE WHEN (rx.basket_name ~~ 'ARMONAIR RESPICLICK%'::varchar(20)) THEN 'ARMONAIR RESPICLICK'::varchar(19) WHEN (rx.basket_name ~~ 'ASMANEX%'::varchar(8)) THEN 'ASMANEX'::varchar(7) WHEN (rx.basket_name ~~ 'FLOVENT DISK%'::varchar(13)) THEN 'FLOVENT DISK'::varchar(12) WHEN (rx.basket_name ~~ 'FLOVENT MDI%'::varchar(12)) THEN 'FLOVENT MDI'::varchar(11) ELSE rx.basket_name END AS product,
        rx.rollup_month AS month_ending,
        rx.payment_method,
        sum(rx.nrx_count) AS nrx_cnt,
        sum(rx.trx_count) AS trx_cnt
 FROM datamart.prescriber_rx rx
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (rx.ims_id >= '0000002'::varchar(7)) AND (rx.ims_id <= '8999999'::varchar(7)) AND ((rx.basket_name = rx.market_name) OR (rx.rollup_flag IS NULL)) AND (rx.rollup_month = rx.data_date))
 GROUP BY rx.tvcmid,
          rx.ims_id,
          CASE WHEN (rx.basket_name ~~ 'ARMONAIR RESPICLICK%'::varchar(20)) THEN 'ARMONAIR RESPICLICK'::varchar(19) WHEN (rx.basket_name ~~ 'ASMANEX%'::varchar(8)) THEN 'ASMANEX'::varchar(7) WHEN (rx.basket_name ~~ 'FLOVENT DISK%'::varchar(13)) THEN 'FLOVENT DISK'::varchar(12) WHEN (rx.basket_name ~~ 'FLOVENT MDI%'::varchar(12)) THEN 'FLOVENT MDI'::varchar(11) ELSE rx.basket_name END,
          rx.rollup_month,
          rx.payment_method
 ORDER BY rx.tvcmid,
          rx.ims_id,
          CASE WHEN (rx.basket_name ~~ 'ARMONAIR RESPICLICK%'::varchar(20)) THEN 'ARMONAIR RESPICLICK'::varchar(19) WHEN (rx.basket_name ~~ 'ASMANEX%'::varchar(8)) THEN 'ASMANEX'::varchar(7) WHEN (rx.basket_name ~~ 'FLOVENT DISK%'::varchar(13)) THEN 'FLOVENT DISK'::varchar(12) WHEN (rx.basket_name ~~ 'FLOVENT MDI%'::varchar(12)) THEN 'FLOVENT MDI'::varchar(11) ELSE rx.basket_name END,
          rx.rollup_month,
          rx.payment_method;

CREATE  VIEW outbound.zs_austedo_activity_sample_shipment AS
 SELECT sample_shipment.veeva_id,
        sample_shipment.tvcmid,
        sample_shipment.ims_id,
        sample_shipment.first_name,
        sample_shipment.middle_name,
        sample_shipment.last_name,
        sample_shipment.designation,
        sample_shipment.state_license_number,
        sample_shipment.address_line_1,
        sample_shipment.address_line_2,
        sample_shipment.address_line_3,
        sample_shipment.city,
        sample_shipment.state,
        sample_shipment.zip,
        sample_shipment.dea_license_number,
        sample_shipment.order_id,
        sample_shipment.ndc,
        sample_shipment.basket_id,
        sample_shipment.basket_name,
        sample_shipment.order_job_code,
        sample_shipment.order_job_description,
        sample_shipment.ship_qty,
        sample_shipment.ship_date
 FROM datamart.sample_shipment
 WHERE ((sample_shipment.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (sample_shipment.ship_date >= '2018-01-01'::date) AND (sample_shipment.ship_date < trunc(now(), 'MONTH'::varchar(5))))
 ORDER BY sample_shipment.ship_date;

CREATE  VIEW outbound.zs_austedo_activity_ahm_participant AS
 SELECT p.sourcesystemid,
        p.batchid,
        p.batchdate,
        p.transactionstatuscode,
        p.interactionid,
        p.interactioncode,
        p.participantid,
        (p.clientcustomerid)::!int AS clientcustomerid,
        p.participanttype,
        p.firstname,
        p.middlename,
        p.lastname,
        p.suffix,
        p.professionaldesignation,
        p.primaryspecialty,
        p.organizationname,
        p.npinumber,
        p.addressid,
        p.clientaddressid,
        p.addressline1,
        p.addressline2,
        p.addressline3,
        p.addresscity,
        p.addressstateprovince,
        p.addresspostalcode,
        p.addresspostalcodeextension,
        p.addresscountry,
        p.region,
        p.primarystatelicensestate,
        p.primarystatelicensenumber,
        p.attended,
        p.mealconsumed,
        p.contractid,
        p.clientcontractid,
        p.contractname,
        p.contractcategory,
        p.contractsubcategory,
        p.contractclassification,
        p.contracttier,
        p.contracteffectivedate,
        p.contractexpirationdate,
        p.contracttotalvalue
 FROM (datamart.ahm_interactions i JOIN datamart.ahm_participant p ON ((i.interactionid = p.interactionid)))
 WHERE ((i.interactionstartdate >= '2018-01-01'::date) AND (('AUSTEDO'::varchar(7) = i.product1name) OR ('AUSTEDO'::varchar(7) = i.product2name) OR ('AUSTEDO'::varchar(7) = i.product3name)) AND ((p.clientcustomerid)::!int IS NOT NULL));

CREATE  VIEW outbound.zs_austedo_activity_ahm_interactions AS
 SELECT i.sourcesystemid,
        i.batchid,
        i.batchdate,
        i.transactionstatuscode,
        i.interactionid,
        i.interactioncode,
        i.interactionname,
        i.interactioncategory,
        i.interactiontype,
        i.locationtype,
        i.interactionstatus,
        i.interactionstartdate,
        i.interactionenddate,
        i.interactionstarttime,
        i.interactionendtime,
        i.interactiontimezone,
        i.interactionstartdatetime,
        i.interactionenddatetime,
        i.requestingregion,
        i.parentinteractionid,
        i.parentinteractioncode,
        i.employeeid,
        i.clientemployeeid,
        i.employeefirstname,
        i.employeelastname,
        i.employeeorganizationunitid,
        i.employeeorganizationunitcode,
        i.employeeorganizationunitname,
        i.venueid,
        i.clientvenueid,
        i.venuename,
        i.venueaddressline1,
        i.venueaddressline2,
        i.venueaddressline3,
        i.venuecity,
        i.venuestateprovince,
        i.venuepostalcode,
        i.venuecountry,
        i.venueregion,
        i.totalestimatedparticipantcount,
        i.financialcloseddate,
        i.product1name,
        i.product1id,
        i.product1clientid,
        i.topic1name,
        i.topic1id,
        i.topic1clientid,
        i.product2name,
        i.product2id,
        i.product2clientid,
        i.topic2name,
        i.topic2id,
        i.topic2clientid,
        i.product3name,
        i.product3id,
        i.product3clientid,
        i.topic3name,
        i.topic3id,
        i.topic3clientid,
        i.product4name,
        i.product4id,
        i.product4clientid,
        i.topic4name,
        i.topic4id,
        i.topic4clientid,
        i.product5name,
        i.product5id,
        i.product5clientid,
        i.topic5name,
        i.topic5id,
        i.topic5clientid
 FROM datamart.ahm_interactions i
 WHERE ((i.interactionstartdate >= '2018-01-01'::date) AND (('AUSTEDO'::varchar(7) = i.product1name) OR ('AUSTEDO'::varchar(7) = i.product2name) OR ('AUSTEDO'::varchar(7) = i.product3name)));

CREATE  VIEW outbound.zs_austedo_activity_copay AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.occ_payment_type,
        copay.auth_refills,
        copay.claim_type,
        copay.administration_flag,
        copay.payer_name,
        copay.trans_type,
        copay.previous_payer_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.source_name
 FROM datamart.copay
 WHERE ((copay.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (copay.fill_date >= '2018-01-01'::date) AND (copay.fill_date < trunc(now(), 'MONTH'::varchar(5))))
 ORDER BY copay.fill_date;

CREATE  VIEW outbound.millennium_roster AS
 SELECT r1.territory_number AS TERRITORY_NUM,
        r1.last_name AS LAST_NAME,
        r1.first_name AS FIRST_NAME,
        r1.shipping_address_line1 AS SHIP_ADDRESS_LINE1,
        r1.shipping_address_line2 AS SHIP_ADDRESS_LINE2,
        r1.shipping_city AS SHIP_CITY,
        r1.shipping_state AS SHIP_STATE,
        r1.shipping_zip AS SHIP_ZIP,
        coalesce(r1.business_phone, r1.mobile_phone, r1.home_phone) AS PHONE,
        r1.email AS EMAIL,
        CASE WHEN (r1.rep_type = 'REP'::varchar(3)) THEN r2.parent_territory_number WHEN (r1.rep_type = 'MGR'::varchar(3)) THEN r1.parent_territory_number WHEN (r1.rep_type = 'DIR'::varchar(3)) THEN r1.territory_number ELSE NULL END AS DISTRICT,
        CASE WHEN (r1.rep_type = 'REP'::varchar(3)) THEN r1.parent_territory_number WHEN (r1.rep_type = 'MGR'::varchar(3)) THEN r1.territory_number ELSE NULL END AS REGION
 FROM (datamart.roster r1 JOIN datamart.roster r2 ON ((r1.parent_territory_number = r2.territory_number)))
 WHERE ((r1.sales_force_id = ANY (ARRAY['TO'::varchar(2), 'TP'::varchar(2), 'TN'::varchar(2)])) AND (r1.last_name <> 'Vacant'::varchar(6)) AND (r1.rep_type = ANY (ARRAY['REP'::varchar(3), 'MGR'::varchar(3), 'DIR'::varchar(3)])))
 ORDER BY r1.last_name;

CREATE  VIEW teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2 AS
 SELECT btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.id) AS id,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.ownerid) AS ownerid,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.isdeleted) AS isdeleted,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.name) AS name,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.createddate) AS createddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.createdbyid) AS createdbyid,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.lastactivitydate) AS lastactivitydate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.lastvieweddate) AS lastvieweddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.lastreferenceddate) AS lastreferenceddate,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.assignment_end_date__c) AS assignment_end_date__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.assignment_start_date__c) AS assignment_start_date__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.assignment_status__c) AS assignment_status__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.assignment_type__c) AS assignment_type__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.global_employee_id__c) AS global_employee_id__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.rms_territory_name__c) AS rms_territory_name__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.rms_territory_number__c) AS rms_territory_number__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.employee__c) AS employee__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.first_name__c) AS first_name__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.hire_date__c) AS hire_date__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.last_name__c) AS last_name__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.local_employee_id__c) AS local_employee_id__c,
        btrim(EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.middle_name__c) AS middle_name__c,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.batch_id,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.row_id,
        EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src.update_ts
 FROM teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src;

CREATE  VIEW raw.ext_axtria_employee_assignment_status_v2 AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.assignment_end_date__c,
        src.assignment_start_date__c,
        src.assignment_status__c,
        src.assignment_type__c,
        src.global_employee_id__c,
        src.rms_territory_name__c,
        src.rms_territory_number__c,
        src.employee__c,
        src.first_name__c,
        src.hire_date__c,
        src.last_name__c,
        src.local_employee_id__c,
        src.middle_name__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AXTRIA_EMPLOYEE_ASSIGNMENT_STATUS_V2'::varchar(40)))));

CREATE  VIEW outbound.activity_line_item_centris_speaker_event AS
 SELECT concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar) AS activity,
        to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat((((e.interactionname || ':'::varchar(1)) || coalesce(e.topic1name, ''::varchar)) || ','::varchar(1)), (e.interactionstartdate)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN cmid.id_num ELSE (b.basket_id)::varchar END AS level_master_id,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN 'Speaker'::varchar(7) ELSE 'Topics'::varchar(6) END AS type,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN 'Speaker'::varchar(7) ELSE 'Topics'::varchar(6) END AS native_type,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN ea.participant_name ELSE e.topic1name END AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT dm.feed_id,
        dm.feed_version,
        ints.interactioncode,
        ints.interactionname,
        ints.interactionstartdate,
        ints.product1id,
        ints.product1name,
        ints.topic1name,
        max(ints.file_id) AS file_id
 FROM (datamart.ahm_interactions ints JOIN metadata.data_file_metadata dm ON ((dm.file_id = ints.file_id)))
 WHERE (ints.interactionstartdate >= add_months((now())::date, (-6)))
 GROUP BY dm.feed_id,
          dm.feed_version,
          ints.interactioncode,
          ints.interactionname,
          ints.interactionstartdate,
          ints.product1id,
          ints.product1name,
          ints.topic1name) e LEFT  JOIN ( SELECT ahm_participant.sourcesystemid,
        ahm_participant.interactioncode,
        ahm_participant.attended,
        ahm_participant.clientcustomerid,
        ahm_participant.participanttype,
        ((ahm_participant.firstname || ' '::varchar(1)) || ahm_participant.lastname) AS participant_name,
        ahm_participant.file_id
 FROM datamart.ahm_participant
 GROUP BY ahm_participant.sourcesystemid,
          ahm_participant.interactioncode,
          ahm_participant.attended,
          ahm_participant.clientcustomerid,
          ahm_participant.participanttype,
          ((ahm_participant.firstname || ' '::varchar(1)) || ahm_participant.lastname),
          ahm_participant.file_id) ea ON ((ea.interactioncode = e.interactioncode))) JOIN datamart.tvcmid_xref cmid ON (((ea.clientcustomerid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6)) AND (regexp_count(ea.clientcustomerid, '^[0-9.-]+$'::varchar(10), 1, ''::varchar) = 1)))) LEFT  JOIN product.source_product sp ON (((upper(e.product1id) = upper(sp.source_product_code)) AND (e.feed_id = sp.feed_id) AND (e.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE (ea.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_PARTICIPANT'::varchar(19)))), 0)) EXCEPT  SELECT concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar) AS activity,
        to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat((((e.interactionname || ':'::varchar(1)) || coalesce(e.topic1name, ''::varchar)) || ','::varchar(1)), (e.interactionstartdate)::varchar) AS trackback_id,
        NULL AS previous_line_item,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN cmid.id_num ELSE (b.basket_id)::varchar END AS level_master_id,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN 'Speaker'::varchar(7) ELSE 'Topics'::varchar(6) END AS type,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN 'Speaker'::varchar(7) ELSE 'Topics'::varchar(6) END AS native_type,
        CASE WHEN (ea.participanttype = 'Speaker'::varchar(7)) THEN ea.participant_name ELSE e.topic1name END AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((( SELECT dm.feed_id,
        dm.feed_version,
        ints.interactioncode,
        ints.interactionname,
        ints.interactionstartdate,
        ints.product1id,
        ints.product1name,
        ints.topic1name,
        max(ints.file_id) AS file_id
 FROM (datamart.ahm_interactions ints JOIN metadata.data_file_metadata dm ON ((dm.file_id = ints.file_id)))
 WHERE (ints.interactionstartdate >= add_months((now())::date, (-6)))
 GROUP BY dm.feed_id,
          dm.feed_version,
          ints.interactioncode,
          ints.interactionname,
          ints.interactionstartdate,
          ints.product1id,
          ints.product1name,
          ints.topic1name) e LEFT  JOIN ( SELECT ahm_participant.sourcesystemid,
        ahm_participant.interactioncode,
        ahm_participant.attended,
        ahm_participant.clientcustomerid,
        ahm_participant.participanttype,
        ((ahm_participant.firstname || ' '::varchar(1)) || ahm_participant.lastname) AS participant_name,
        ahm_participant.file_id
 FROM datamart.ahm_participant
 GROUP BY ahm_participant.sourcesystemid,
          ahm_participant.interactioncode,
          ahm_participant.attended,
          ahm_participant.clientcustomerid,
          ahm_participant.participanttype,
          ((ahm_participant.firstname || ' '::varchar(1)) || ahm_participant.lastname),
          ahm_participant.file_id) ea ON ((ea.interactioncode = e.interactioncode))) JOIN datamart.tvcmid_xref cmid ON (((ea.clientcustomerid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6)) AND (regexp_count(ea.clientcustomerid, '^[0-9.-]+$'::varchar(10), 1, ''::varchar) = 1)))) LEFT  JOIN product.source_product sp ON (((upper(e.product1id) = upper(sp.source_product_code)) AND (e.feed_id = sp.feed_id) AND (e.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE (ea.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_PARTICIPANT'::varchar(19)))), 0));

CREATE  VIEW outbound.zs_xpd_core_metrics_antimigraine_monthly AS
 SELECT xpd_core_metrics_antimigraine.ims_client_number,
        xpd_core_metrics_antimigraine.ims_report_number,
        xpd_core_metrics_antimigraine.channel_indicator,
        xpd_core_metrics_antimigraine.ims_id,
        xpd_core_metrics_antimigraine.tvcmid,
        xpd_core_metrics_antimigraine.specialty,
        xpd_core_metrics_antimigraine.ims_product_group,
        xpd_core_metrics_antimigraine.basket_id,
        xpd_core_metrics_antimigraine.basket_name,
        xpd_core_metrics_antimigraine.rollup_period,
        xpd_core_metrics_antimigraine.xpo_nrx,
        xpd_core_metrics_antimigraine.xpo_trx,
        xpd_core_metrics_antimigraine.unknown_nrx,
        xpd_core_metrics_antimigraine.unknown_trx,
        xpd_core_metrics_antimigraine.new_therapy_starts,
        xpd_core_metrics_antimigraine.continued_new,
        xpd_core_metrics_antimigraine.switch_to,
        xpd_core_metrics_antimigraine.add_on,
        xpd_core_metrics_antimigraine.restart_same_new,
        xpd_core_metrics_antimigraine.restart_different,
        xpd_core_metrics_antimigraine.continued_refill,
        xpd_core_metrics_antimigraine.restart_same_refill,
        xpd_core_metrics_antimigraine.switch_from,
        xpd_core_metrics_antimigraine.restart_different_from,
        xpd_core_metrics_antimigraine.add_to,
        xpd_core_metrics_antimigraine.market_new_to_brand_rx,
        xpd_core_metrics_antimigraine.dynamic_capture_rx,
        xpd_core_metrics_antimigraine.report_frequency
 FROM datamart.xpd_core_metrics_antimigraine
 WHERE (xpd_core_metrics_antimigraine.report_frequency = 'MONTH'::varchar(5));

CREATE  VIEW outbound.zs_qvar_week52_rx AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_week,
        prescriber_rx.sales_category,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        sum(prescriber_rx.nrx_count) AS nrx_count,
        sum(prescriber_rx.trx_count) AS trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (prescriber_rx.cnt_file_id = ANY (ARRAY[152703, 152704, 152705])))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.rollup_week,
          prescriber_rx.sales_category,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method;

CREATE  VIEW outbound.zs_to_ims_zip_xref AS
 SELECT CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END AS ims_id,
        prescriber_combined_demographics.ptr_zip AS zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TO'::varchar(2))
 GROUP BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip
 ORDER BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip;

CREATE  VIEW outbound.zs_to_zip_terr_xref AS
 SELECT aa.territory_number AS territory,
        aa.zip_code AS zip
 FROM datamart.alternate_alignments aa
 WHERE ((aa.sales_force_id = 'TO'::varchar(2)) AND (aa.file_id IN ( SELECT max(daa.file_id) AS max
 FROM datamart.alternate_alignments daa
 WHERE (daa.sales_force_id = 'TO'::varchar(2)))))
 ORDER BY aa.territory_number,
          aa.zip_code;

CREATE  VIEW outbound.iqvia_antimigraine_acute_weekly AS
 SELECT prescriber_rx.tvcmid,
        prescriber_rx.ims_id,
        product_basket.parent_basket_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.report_frequency,
        prescriber_rx.ims_product_group,
        prescriber_rx.date,
        prescriber_rx.sales_category,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.model,
        prescriber_rx.payment_method,
        prescriber_rx.ims_specialty,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.ims_report_number_cnt,
        prescriber_rx.cnt_file_id,
        prescriber_rx.cnt_record_id,
        prescriber_rx.ims_report_number_qty,
        prescriber_rx.qty_file_id,
        prescriber_rx.qty_record_id,
        prescriber_rx.rollup_flag,
        prescriber_rx.indication,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.data_date
 FROM (datamart.product_basket product_basket JOIN datamart.prescriber_rx prescriber_rx ON ((product_basket.child_basket_name = prescriber_rx.basket_name)))
 WHERE ((product_basket.parent_basket_name = 'ANTI-CGRP'::varchar(9)) AND (prescriber_rx.basket_type = 'product'::varchar(7)) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.qty_file_id IN ( SELECT max(prescriber_rx.qty_file_id) AS max
 FROM datamart.prescriber_rx
 WHERE (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))) AND (prescriber_rx.cnt_file_id IN ( SELECT max(prescriber_rx.cnt_file_id) AS max
 FROM datamart.prescriber_rx
 WHERE (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))))
 GROUP BY prescriber_rx.tvcmid,
          prescriber_rx.ims_id,
          product_basket.parent_basket_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.report_frequency,
          prescriber_rx.ims_product_group,
          prescriber_rx.date,
          prescriber_rx.sales_category,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.model,
          prescriber_rx.payment_method,
          prescriber_rx.ims_specialty,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.ims_report_number_cnt,
          prescriber_rx.cnt_file_id,
          prescriber_rx.cnt_record_id,
          prescriber_rx.ims_report_number_qty,
          prescriber_rx.qty_file_id,
          prescriber_rx.qty_record_id,
          prescriber_rx.rollup_flag,
          prescriber_rx.indication,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.data_date;

CREATE  VIEW outbound.CobbsCreek_austedo_copay_Weekly AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.pharmacy_chain_number,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.create_date,
        copay.occ_payment_type,
        copay.counted_copay,
        copay.auth_refills,
        copay.admin_hcp_npi,
        copay.admin_hcp_name,
        copay.admin_hcp_address,
        copay.admin_hcp_address2,
        copay.admin_hcp_city,
        copay.admin_hcp_state,
        copay.admin_hcp_zip,
        copay.claim_type,
        copay.administration_flag,
        copay.soc_name,
        copay.soc_phone,
        copay.soc_fax,
        copay.soc_address,
        copay.soc_city,
        copay.soc_state,
        copay.soc_zip,
        copay.soc_id,
        copay.soc_npi,
        copay.payer_name,
        copay.cpt_code,
        copay.trans_type,
        copay.previous_payer_id,
        copay.member_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.report_frequency,
        copay.source_name,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay copay
 WHERE (copay.basket_name ~~ 'AUSTEDO%'::varchar(8))
 GROUP BY copay.redemption_type,
          copay.physician_tvcmid,
          copay.pharmacy_tvcmid,
          copay.basket_id,
          copay.basket_name,
          copay.asi_txn_id,
          copay.orig_asi_txn_id,
          copay.rx_num,
          copay.fill_date,
          copay.date_written,
          copay.days_supply,
          copay.ndc_code,
          copay.daw,
          copay.new_refill,
          copay.quantity,
          copay.refills,
          copay.other_coverage_code,
          copay.program_number,
          copay.copay_card_number,
          copay.sex,
          copay.age_at_redemption,
          copay.pharmacy_process_date,
          copay.pharmacy_chain_number,
          copay.nabp,
          copay.pharmacy_chain,
          copay.pharmacy_name,
          copay.pharmacy_address,
          copay.pharmacy_address2,
          copay.pharmacy_city,
          copay.pharmacy_state,
          copay.pharmacy_zip,
          copay.pharmacy_phone,
          copay.pharmacy_npi_num,
          copay.principle_physician_dea,
          copay.physician_npi,
          copay.physician_ims_id,
          copay.physician_veeva_id,
          copay.physician_name,
          copay.physician_address1,
          copay.physician_address2,
          copay.physician_city,
          copay.physician_state,
          copay.physician_zip,
          copay.rebate_amount,
          copay.member_cash_expense,
          copay.submitted_cost,
          copay.pharmacy_fee,
          copay.total_amount_due,
          copay.calc_awp,
          copay.create_date,
          copay.occ_payment_type,
          copay.counted_copay,
          copay.auth_refills,
          copay.admin_hcp_npi,
          copay.admin_hcp_name,
          copay.admin_hcp_address,
          copay.admin_hcp_address2,
          copay.admin_hcp_city,
          copay.admin_hcp_state,
          copay.admin_hcp_zip,
          copay.claim_type,
          copay.administration_flag,
          copay.soc_name,
          copay.soc_phone,
          copay.soc_fax,
          copay.soc_address,
          copay.soc_city,
          copay.soc_state,
          copay.soc_zip,
          copay.soc_id,
          copay.soc_npi,
          copay.payer_name,
          copay.cpt_code,
          copay.trans_type,
          copay.previous_payer_id,
          copay.member_id,
          copay.benefit_amount,
          copay.patient_expense,
          copay.submission_method,
          copay.report_frequency,
          copay.source_name,
          copay.patient_type,
          copay.primary_bin,
          copay.primary_bin_description,
          copay.reject_code
 ORDER BY copay.physician_tvcmid;

CREATE  VIEW outbound.CobbsCreek_Austedo_cmop_rx_monthly AS
 SELECT cmop_rx.data_month,
        cmop_rx.comp_month,
        cmop_rx.pharmacy,
        cmop_rx.visn,
        cmop_rx.station_number,
        cmop_rx.station,
        cmop_rx.va_product,
        cmop_rx.basket_id,
        cmop_rx.basket_name,
        cmop_rx.cmop_rxs_raw,
        cmop_rx.cmop_rxs_normalized,
        cmop_rx.total_quantity,
        cmop_rx.cmop_quantity,
        cmop_rx.rxs_30_days,
        cmop_rx.zip,
        cmop_rx.id,
        cmop_rx.file_id,
        cmop_rx.record_id,
        cmop_rx.rollup_flag,
        cmop_rx.basket_type,
        cmop_rx.total_rxs_normalized,
        product_basket.child_basket_name AS MOVEMENT_DISORDER_PRODUCTS
 FROM (datamart.cmop_rx cmop_rx JOIN datamart.product_basket product_basket ON ((cmop_rx.basket_name = product_basket.child_basket_name)))
 WHERE ((product_basket.child_basket_type = 'product'::varchar(7)) AND (product_basket.parent_basket_name = 'MOVEMENT DISORDER MARKET'::varchar(24)))
 GROUP BY cmop_rx.data_month,
          cmop_rx.comp_month,
          cmop_rx.pharmacy,
          cmop_rx.visn,
          cmop_rx.station_number,
          cmop_rx.station,
          cmop_rx.va_product,
          cmop_rx.basket_id,
          cmop_rx.basket_name,
          cmop_rx.cmop_rxs_raw,
          cmop_rx.cmop_rxs_normalized,
          cmop_rx.total_quantity,
          cmop_rx.cmop_quantity,
          cmop_rx.rxs_30_days,
          cmop_rx.zip,
          cmop_rx.id,
          cmop_rx.file_id,
          cmop_rx.record_id,
          cmop_rx.rollup_flag,
          cmop_rx.basket_type,
          cmop_rx.total_rxs_normalized,
          product_basket.child_basket_name;

CREATE  VIEW teva_ingestion.EXT_VV_USER AS
 SELECT btrim(EXT_VV_USER_src.id) AS id,
        btrim(EXT_VV_USER_src.username) AS username,
        btrim(EXT_VV_USER_src.lastname) AS lastname,
        btrim(EXT_VV_USER_src.firstname) AS firstname,
        btrim(EXT_VV_USER_src.name) AS name,
        btrim(EXT_VV_USER_src.companyname) AS companyname,
        btrim(EXT_VV_USER_src.division) AS division,
        btrim(EXT_VV_USER_src.department) AS department,
        btrim(EXT_VV_USER_src.title) AS title,
        btrim(EXT_VV_USER_src.street) AS street,
        btrim(EXT_VV_USER_src.city) AS city,
        btrim(EXT_VV_USER_src.state) AS state,
        btrim(EXT_VV_USER_src.postalcode) AS postalcode,
        btrim(EXT_VV_USER_src.country) AS country,
        btrim(EXT_VV_USER_src.latitude) AS latitude,
        btrim(EXT_VV_USER_src.longitude) AS longitude,
        btrim(EXT_VV_USER_src.email) AS email,
        btrim(EXT_VV_USER_src.emailpreferencesautobcc) AS emailpreferencesautobcc,
        btrim(EXT_VV_USER_src.emailpreferencesautobccstayint) AS emailpreferencesautobccstayint,
        btrim(EXT_VV_USER_src.emailpreferencesstayintouchrem) AS emailpreferencesstayintouchrem,
        btrim(EXT_VV_USER_src.senderemail) AS senderemail,
        btrim(EXT_VV_USER_src.sendername) AS sendername,
        btrim(EXT_VV_USER_src.signature) AS signature,
        btrim(EXT_VV_USER_src.stayintouchsubject) AS stayintouchsubject,
        btrim(EXT_VV_USER_src.stayintouchsignature) AS stayintouchsignature,
        btrim(EXT_VV_USER_src.stayintouchnote) AS stayintouchnote,
        btrim(EXT_VV_USER_src.phone) AS phone,
        btrim(EXT_VV_USER_src.fax) AS fax,
        btrim(EXT_VV_USER_src.mobilephone) AS mobilephone,
        btrim(EXT_VV_USER_src.alias) AS alias,
        btrim(EXT_VV_USER_src.communitynickname) AS communitynickname,
        btrim(EXT_VV_USER_src.isactive) AS isactive,
        btrim(EXT_VV_USER_src.timezonesidkey) AS timezonesidkey,
        btrim(EXT_VV_USER_src.userroleid) AS userroleid,
        btrim(EXT_VV_USER_src.localesidkey) AS localesidkey,
        btrim(EXT_VV_USER_src.receivesinfoemails) AS receivesinfoemails,
        btrim(EXT_VV_USER_src.receivesadmininfoemails) AS receivesadmininfoemails,
        btrim(EXT_VV_USER_src.emailencodingkey) AS emailencodingkey,
        btrim(EXT_VV_USER_src.usertype) AS usertype,
        btrim(EXT_VV_USER_src.languagelocalekey) AS languagelocalekey,
        btrim(EXT_VV_USER_src.employeenumber) AS employeenumber,
        btrim(EXT_VV_USER_src.delegatedapproverid) AS delegatedapproverid,
        btrim(EXT_VV_USER_src.managerid) AS managerid,
        btrim(EXT_VV_USER_src.lastlogindate) AS lastlogindate,
        btrim(EXT_VV_USER_src.createddate) AS createddate,
        btrim(EXT_VV_USER_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_USER_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_USER_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_USER_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_USER_src.offlinetrialexpirationdate) AS offlinetrialexpirationdate,
        btrim(EXT_VV_USER_src.offlinepdatrialexpirationdate) AS offlinepdatrialexpirationdate,
        btrim(EXT_VV_USER_src.userpermissionsmarketinguser) AS userpermissionsmarketinguser,
        btrim(EXT_VV_USER_src.userpermissionsofflineuser) AS userpermissionsofflineuser,
        btrim(EXT_VV_USER_src.userpermissionswirelessuser) AS userpermissionswirelessuser,
        btrim(EXT_VV_USER_src.userpermissionsavantgouser) AS userpermissionsavantgouser,
        btrim(EXT_VV_USER_src.userpermscallcenterautologin) AS userpermscallcenterautologin,
        btrim(EXT_VV_USER_src.userpermissionsmobileuser) AS userpermissionsmobileuser,
        btrim(EXT_VV_USER_src.userpermissionssfcontentuser) AS userpermissionssfcontentuser,
        btrim(EXT_VV_USER_src.userpermissionsinteractionuser) AS userpermissionsinteractionuser,
        btrim(EXT_VV_USER_src.userpermschatteranswersuser) AS userpermschatteranswersuser,
        btrim(EXT_VV_USER_src.forecastenabled) AS forecastenabled,
        btrim(EXT_VV_USER_src.userprefsactivityreminderspopu) AS userprefsactivityreminderspopu,
        btrim(EXT_VV_USER_src.userprefseventreminderscheckbo) AS userprefseventreminderscheckbo,
        btrim(EXT_VV_USER_src.userprefstaskreminderscheckbox) AS userprefstaskreminderscheckbox,
        btrim(EXT_VV_USER_src.userprefsremindersoundoff) AS userprefsremindersoundoff,
        btrim(EXT_VV_USER_src.userprefshidecsngetchattermobi) AS userprefshidecsngetchattermobi,
        btrim(EXT_VV_USER_src.userprefshidecsndesktoptask) AS userprefshidecsndesktoptask,
        btrim(EXT_VV_USER_src.userpreferencesoptoutoftouch) AS userpreferencesoptoutoftouch,
        btrim(EXT_VV_USER_src.userprefsshowtitletoexternalus) AS userprefsshowtitletoexternalus,
        btrim(EXT_VV_USER_src.userprefsshowmanagertoexternal) AS userprefsshowmanagertoexternal,
        btrim(EXT_VV_USER_src.userprefsshowemailtoexternalus) AS userprefsshowemailtoexternalus,
        btrim(EXT_VV_USER_src.userprefsshowworkphonetoextern) AS userprefsshowworkphonetoextern,
        btrim(EXT_VV_USER_src.userprefsshowmobilephonetoexte) AS userprefsshowmobilephonetoexte,
        btrim(EXT_VV_USER_src.userprefsshowfaxtoexternaluser) AS userprefsshowfaxtoexternaluser,
        btrim(EXT_VV_USER_src.userprefsshowstreetaddresstoex) AS userprefsshowstreetaddresstoex,
        btrim(EXT_VV_USER_src.userprefsshowcitytoexternaluse) AS userprefsshowcitytoexternaluse,
        btrim(EXT_VV_USER_src.userprefsshowstatetoexternalus) AS userprefsshowstatetoexternalus,
        btrim(EXT_VV_USER_src.userprefsshowpostalcodetoexter) AS userprefsshowpostalcodetoexter,
        btrim(EXT_VV_USER_src.userprefsshowcountrytoexternal) AS userprefsshowcountrytoexternal,
        btrim(EXT_VV_USER_src.userprefsshowprofilepictoguest) AS userprefsshowprofilepictoguest,
        btrim(EXT_VV_USER_src.userprefsshowtitletoguestusers) AS userprefsshowtitletoguestusers,
        btrim(EXT_VV_USER_src.userprefsshowcitytoguestusers) AS userprefsshowcitytoguestusers,
        btrim(EXT_VV_USER_src.userprefsshowstatetoguestusers) AS userprefsshowstatetoguestusers,
        btrim(EXT_VV_USER_src.userprefsshowpostalcodetoguest) AS userprefsshowpostalcodetoguest,
        btrim(EXT_VV_USER_src.userprefsshowcountrytoguestuse) AS userprefsshowcountrytoguestuse,
        btrim(EXT_VV_USER_src.contactid) AS contactid,
        btrim(EXT_VV_USER_src.accountid) AS accountid,
        btrim(EXT_VV_USER_src.callcenterid) AS callcenterid,
        btrim(EXT_VV_USER_src.extension) AS extension,
        btrim(EXT_VV_USER_src.federationidentifier) AS federationidentifier,
        btrim(EXT_VV_USER_src.lastvieweddate) AS lastvieweddate,
        btrim(EXT_VV_USER_src.lastreferenceddate) AS lastreferenceddate,
        btrim(EXT_VV_USER_src.last_mobile_connect_vod__c) AS last_mobile_connect_vod__c,
        btrim(EXT_VV_USER_src.last_tablet_connect_vod__c) AS last_tablet_connect_vod__c,
        btrim(EXT_VV_USER_src.last_mobile_connect_version) AS last_mobile_connect_version,
        btrim(EXT_VV_USER_src.last_tablet_connect_version) AS last_tablet_connect_version,
        btrim(EXT_VV_USER_src.last_mobile_sync_vod__c) AS last_mobile_sync_vod__c,
        btrim(EXT_VV_USER_src.last_tablet_sync_vod__c) AS last_tablet_sync_vod__c,
        btrim(EXT_VV_USER_src.raiselogginglevel_vod__c) AS raiselogginglevel_vod__c,
        btrim(EXT_VV_USER_src.senddetailedlog_vod__c) AS senddetailedlog_vod__c,
        btrim(EXT_VV_USER_src.last_blackberry_connect_vod__c) AS last_blackberry_connect_vod__c,
        btrim(EXT_VV_USER_src.last_blackberry_connect_versio) AS last_blackberry_connect_versio,
        btrim(EXT_VV_USER_src.last_blackberry_sync_vod__c) AS last_blackberry_sync_vod__c,
        btrim(EXT_VV_USER_src.force_full_refresh_vod__c) AS force_full_refresh_vod__c,
        btrim(EXT_VV_USER_src.override_systemmodstamp_timest) AS override_systemmodstamp_timest,
        btrim(EXT_VV_USER_src.facetime_email_vod__c) AS facetime_email_vod__c,
        btrim(EXT_VV_USER_src.facetime_phone_vod__c) AS facetime_phone_vod__c,
        btrim(EXT_VV_USER_src.product_expertise_vod__c) AS product_expertise_vod__c,
        btrim(EXT_VV_USER_src.available_vod__c) AS available_vod__c,
        btrim(EXT_VV_USER_src.available_last_update_vod__c) AS available_last_update_vod__c,
        btrim(EXT_VV_USER_src.last_ipad_connect_version) AS last_ipad_connect_version,
        btrim(EXT_VV_USER_src.last_ipad_connect_vod__c) AS last_ipad_connect_vod__c,
        btrim(EXT_VV_USER_src.last_ipad_sync_vod__c) AS last_ipad_sync_vod__c,
        btrim(EXT_VV_USER_src.inventory_order_allocation_gro) AS inventory_order_allocation_gro,
        btrim(EXT_VV_USER_src.concur_user_id_vod__c) AS concur_user_id_vod__c,
        btrim(EXT_VV_USER_src.external_id_tva__c) AS external_id_tva__c,
        btrim(EXT_VV_USER_src.last_ipad_ios_version_vod__c) AS last_ipad_ios_version_vod__c,
        btrim(EXT_VV_USER_src.veeva_id__c) AS veeva_id__c,
        btrim(EXT_VV_USER_src.login_id_tva__c) AS login_id_tva__c,
        btrim(EXT_VV_USER_src.primary_territory_vod__c) AS primary_territory_vod__c,
        btrim(EXT_VV_USER_src.analytics_admin_vod__c) AS analytics_admin_vod__c,
        btrim(EXT_VV_USER_src.content_admin_vod__c) AS content_admin_vod__c,
        btrim(EXT_VV_USER_src.upload_vtrans_vod__c) AS upload_vtrans_vod__c,
        btrim(EXT_VV_USER_src.can_sample_tva__c) AS can_sample_tva__c,
        btrim(EXT_VV_USER_src.do_not_modify_tva__c) AS do_not_modify_tva__c,
        btrim(EXT_VV_USER_src.profile_name_vod__c) AS profile_name_vod__c,
        btrim(EXT_VV_USER_src.Remote_Meeting_Host_Id_vod__c) AS Remote_Meeting_Host_Id_vod__c,
        btrim(EXT_VV_USER_src.Remote_Meeting_Host_Token_vod__c) AS Remote_Meeting_Host_Token_vod__c,
        btrim(EXT_VV_USER_src.Remote_Meeting_Start_From_CRM_Online_vod__c) AS Remote_Meeting_Start_From_CRM_Online_vod__c,
        EXT_VV_USER_src.batch_id,
        EXT_VV_USER_src.row_id,
        EXT_VV_USER_src.update_ts
 FROM teva_ingestion.EXT_VV_USER_src;

CREATE  VIEW raw.ext_vv_user AS
 SELECT src.id,
        src.username,
        src.lastname,
        src.firstname,
        src.name,
        src.companyname,
        src.division,
        src.department,
        src.title,
        src.street,
        src.city,
        src.state,
        src.postalcode,
        src.country,
        src.latitude,
        src.longitude,
        src.email,
        src.emailpreferencesautobcc,
        src.emailpreferencesautobccstayint,
        src.emailpreferencesstayintouchrem,
        src.senderemail,
        src.sendername,
        src.signature,
        src.stayintouchsubject,
        src.stayintouchsignature,
        src.stayintouchnote,
        src.phone,
        src.fax,
        src.mobilephone,
        src.alias,
        src.communitynickname,
        src.isactive,
        src.timezonesidkey,
        src.userroleid,
        src.localesidkey,
        src.receivesinfoemails,
        src.receivesadmininfoemails,
        src.emailencodingkey,
        src.usertype,
        src.languagelocalekey,
        src.employeenumber,
        src.delegatedapproverid,
        src.managerid,
        src.lastlogindate,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.offlinetrialexpirationdate,
        src.offlinepdatrialexpirationdate,
        src.userpermissionsmarketinguser,
        src.userpermissionsofflineuser,
        src.userpermissionswirelessuser,
        src.userpermissionsavantgouser,
        src.userpermscallcenterautologin,
        src.userpermissionsmobileuser,
        src.userpermissionssfcontentuser,
        src.userpermissionsinteractionuser,
        src.userpermschatteranswersuser,
        src.forecastenabled,
        src.userprefsactivityreminderspopu,
        src.userprefseventreminderscheckbo,
        src.userprefstaskreminderscheckbox,
        src.userprefsremindersoundoff,
        src.userprefshidecsngetchattermobi,
        src.userprefshidecsndesktoptask,
        src.userpreferencesoptoutoftouch,
        src.userprefsshowtitletoexternalus,
        src.userprefsshowmanagertoexternal,
        src.userprefsshowemailtoexternalus,
        src.userprefsshowworkphonetoextern,
        src.userprefsshowmobilephonetoexte,
        src.userprefsshowfaxtoexternaluser,
        src.userprefsshowstreetaddresstoex,
        src.userprefsshowcitytoexternaluse,
        src.userprefsshowstatetoexternalus,
        src.userprefsshowpostalcodetoexter,
        src.userprefsshowcountrytoexternal,
        src.userprefsshowprofilepictoguest,
        src.userprefsshowtitletoguestusers,
        src.userprefsshowcitytoguestusers,
        src.userprefsshowstatetoguestusers,
        src.userprefsshowpostalcodetoguest,
        src.userprefsshowcountrytoguestuse,
        src.contactid,
        src.accountid,
        src.callcenterid,
        src.extension,
        src.federationidentifier,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.last_mobile_connect_vod__c,
        src.last_tablet_connect_vod__c,
        src.last_mobile_connect_version,
        src.last_tablet_connect_version,
        src.last_mobile_sync_vod__c,
        src.last_tablet_sync_vod__c,
        src.raiselogginglevel_vod__c,
        src.senddetailedlog_vod__c,
        src.last_blackberry_connect_vod__c,
        src.last_blackberry_connect_versio,
        src.last_blackberry_sync_vod__c,
        src.force_full_refresh_vod__c,
        src.override_systemmodstamp_timest,
        src.facetime_email_vod__c,
        src.facetime_phone_vod__c,
        src.product_expertise_vod__c,
        src.available_vod__c,
        src.available_last_update_vod__c,
        src.last_ipad_connect_version,
        src.last_ipad_connect_vod__c,
        src.last_ipad_sync_vod__c,
        src.inventory_order_allocation_gro,
        src.concur_user_id_vod__c,
        src.external_id_tva__c,
        src.last_ipad_ios_version_vod__c,
        src.veeva_id__c,
        src.login_id_tva__c,
        src.primary_territory_vod__c,
        src.analytics_admin_vod__c,
        src.content_admin_vod__c,
        src.upload_vtrans_vod__c,
        src.can_sample_tva__c,
        src.do_not_modify_tva__c,
        src.profile_name_vod__c,
        src.Remote_Meeting_Host_Id_vod__c,
        src.Remote_Meeting_Host_Token_vod__c,
        src.Remote_Meeting_Start_From_CRM_Online_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_USER_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_USER'::varchar(11)))));

CREATE  VIEW outbound.zs_saba_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_month,
        prescriber_rx.sales_category,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.model,
        prescriber_rx.payment_method,
        sum(prescriber_rx.nrx_count) AS nrx_count,
        sum(prescriber_rx.trx_count) AS trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = 'SABA MARKET TOTAL'::varchar(17)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.rollup_month,
          prescriber_rx.sales_category,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.model,
          prescriber_rx.payment_method;

CREATE  VIEW outbound.zs_ics_laba_market_monthly AS
 SELECT rx.ims_id,
        rx.tvcmid,
        rx.market_name,
        rx.basket_name,
        rx.basket_type,
        rx.rollup_month,
        rx.sales_category,
        rx.payer_plan_number,
        rx.payer_name,
        rx.plan_name,
        rx.pbm_name,
        rx.pbm_parent_name,
        rx.model,
        rx.payment_method,
        sum(rx.nrx_count) AS Sum_nrx_count,
        sum(rx.trx_count) AS Sum_trx_count
 FROM (datamart.prescriber_rx rx JOIN reference.ics_laba_saba ils ON ((rx.basket_name = ils.basket_name)))
 WHERE ((rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.ims_id,
          rx.tvcmid,
          rx.market_name,
          rx.basket_name,
          rx.basket_type,
          rx.rollup_month,
          rx.sales_category,
          rx.payer_plan_number,
          rx.payer_name,
          rx.plan_name,
          rx.pbm_name,
          rx.pbm_parent_name,
          rx.model,
          rx.payment_method;

CREATE  VIEW outbound.zs_onc_ic_data_monthly AS
 SELECT oas.tvcmid,
        CASE WHEN (oas.outlet_zip IS NULL) THEN hd.zip ELSE oas.outlet_zip END AS zip,
        oas.rollup_month,
        CASE WHEN (oas.basket_id = 539) THEN 'BENDEKA'::varchar(7) WHEN (oas.basket_id = ANY (ARRAY[381, 382, 515, 513, 134, 135, 516, 514, 9882, 9884])) THEN 'GRANIX'::varchar(6) WHEN (oas.basket_id = ANY (ARRAY[74, 73])) THEN 'TREANDA'::varchar(7) WHEN (oas.basket_id = ANY (ARRAY[10695, 10696])) THEN 'TRUXIMA'::varchar(7) ELSE 'brand ??'::varchar(8) END AS Brand,
        oas.basket_id,
        oas.basket_name,
        oas.reported_trx_strength_units
 FROM ((datamart.oncology_adjusted_sales oas LEFT  JOIN datamart.customer_hco_demographics hd ON ((hd.tvcmid = oas.tvcmid))) LEFT  JOIN datamart.dddmd_demographics ddemo ON ((ddemo.tvcmid = hd.tvcmid)))
 WHERE ((oas.report_frequency = 'MONTH'::varchar(5)) AND (oas.basket_id = ANY (ARRAY[539, 381, 382, 515, 513, 134, 135, 516, 514, 9882, 9884, 74, 73, 10695, 10696])) AND (oas.rollup_month >= trunc((now() + '-13'::interval month), 'month'::varchar(5))) AND (ddemo.subcategory_code <> 'A5'::varchar(2)))
 GROUP BY oas.tvcmid,
          CASE WHEN (oas.outlet_zip IS NULL) THEN hd.zip ELSE oas.outlet_zip END,
          oas.rollup_month,
          CASE WHEN (oas.basket_id = 539) THEN 'BENDEKA'::varchar(7) WHEN (oas.basket_id = ANY (ARRAY[381, 382, 515, 513, 134, 135, 516, 514, 9882, 9884])) THEN 'GRANIX'::varchar(6) WHEN (oas.basket_id = ANY (ARRAY[74, 73])) THEN 'TREANDA'::varchar(7) WHEN (oas.basket_id = ANY (ARRAY[10695, 10696])) THEN 'TRUXIMA'::varchar(7) ELSE 'brand ??'::varchar(8) END,
          oas.basket_id,
          oas.basket_name,
          oas.reported_trx_strength_units
 ORDER BY oas.rollup_month DESC;

CREATE  VIEW veeva.v_account AS
 SELECT account.id,
        account.isdeleted,
        account.masterrecordid,
        account.name,
        account.lastname,
        account.firstname,
        account.salutation,
        account.type AS TYPE,
        account.recordtypeid,
        account.phone,
        account.fax,
        account.website,
        account.numberofemployees,
        account.ownership,
        account.ownerid,
        account.createddate,
        account.createdbyid,
        account.lastmodifieddate,
        account.lastmodifiedbyid,
        account.systemmodstamp,
        account.lastactivitydate,
        account.mayedit,
        account.islocked,
        account.lastvieweddate,
        account.lastreferenceddate,
        account.isexcludedfromrealign,
        account.personcontactid,
        account.ispersonaccount,
        account.personmailingstreet,
        account.personmailingcity,
        account.personmailingstate,
        account.personmailingpostalcode,
        account.personmailingcountry,
        account.personmailinglatitude,
        account.personmailinglongitude,
        account.personotherstreet,
        account.personothercity,
        account.personotherstate,
        account.personotherpostalcode,
        account.personothercountry,
        account.personotherlatitude,
        account.personotherlongitude,
        account.personmobilephone,
        account.personhomephone,
        account.personotherphone,
        account.personassistantphone,
        account.personemail,
        account.staff_email,
        account.company_managed_email,
        account.alternate_email,
        account.persontitle,
        account.persondepartment,
        account.personassistantname,
        account.personbirthdate,
        account.personhasoptedoutofemail,
        account.personhasoptedoutoffax,
        account.persondonotcall,
        account.personlastcurequestdate,
        account.personlastcuupdatedate,
        account.personemailbouncedreason,
        account.personemailbounceddate,
        account.jigsaw,
        account.jigsawcompanyid,
        account.accountsource,
        account.sicdesc,
        account.external_id_vod__c,
        account.credentials_vod__c,
        account.exclude_from_zip_to_terr_proce,
        account.group_specialty_1_vod__c,
        account.group_specialty_2_vod__c,
        account.specialty_1_vod__c,
        account.specialty_2_vod__c,
        account.formatted_name_vod__c,
        account.territory_test_vod__c,
        account.mobile_id_vod__c,
        account.gender_vod__c,
        account.id_vod__c,
        account.do_not_sync_sales_data_vod__c,
        account.id2_vod__c,
        account.preferred_name_vod__c,
        account.sample_default_vod__c,
        account.segmentations_vod__c,
        account.restricted_products_vod__c,
        account.payer_id_vod__c,
        account.account_status_tva__c,
        account.do_not_call_vod__c,
        account.beds__c,
        account.spend_amount__c,
        account.pdrp_opt_out_vod__c,
        account.spend_status_value_vod__c,
        account.pdrp_opt_out_date_vod__c,
        account.spend_status_vod__c,
        account.enable_restricted_products,
        account.call_reminder_vod__c,
        account.account_group_vod__c,
        account.primary_parent_vod__c,
        account.color_vod__c,
        account.middle_vod__c,
        account.suffix_vod__c,
        account.account_location_tva__c,
        account.no_orders_vod__c,
        account.account_master_id_tva__c,
        account.account_email_tva__c,
        account.account_search_firstlast,
        account.account_search_lastfirst,
        account.person_preferred_name_tva__c,
        account.practice_at_hospital_vod__c,
        account.practice_near_hospital_vod__c,
        account.do_not_create_child_account,
        account.total_mds_dos__c,
        account.aha__c,
        account.order_type_vod__c,
        account.npi_vod__c,
        account.me__c,
        account.speaker__c,
        account.investigator_vod__c,
        account.default_order_type_vod__c,
        account.person_degree_tva__c,
        account.tax_status__c,
        account.model__c,
        account.offerings__c,
        account.departments__c,
        account.account_type__c,
        account.account_search_business_vod__c,
        account.business_professional_person,
        account.no_spend_tva__c,
        account.hospital_type_vod__c,
        account.account_class_vod__c,
        account.furigana_vod__c,
        account.tirf_rems_tva__c,
        account.fentora_app_tva__c,
        account.total_revenue_000__c,
        account.net_income_loss_000__c,
        account.pmpm_income_loss_000__c,
        account.commercial_premiums_pmpm__c,
        account.medical_loss_ratio__c,
        account.medical_expenses_pmpm__c,
        account.commercial_patient_days_1000,
        account.hmo_market_shr__c,
        account.hmo__c,
        account.hmo_pos__c,
        account.ppo__c,
        account.ppo_pos__c,
        account.medicare__c,
        account.medicaid__c,
        account.nuvigil_app_tva__c,
        account.mds_status_tva__c,
        account.lis_status_tva__c,
        account.dnc_pcs_tva__c,
        account.dnc_cns_tva__c,
        account.suffix_tva__c,
        account.tysabri_status_tva__c,
        account.business_description__c,
        account.regional_strategy__c,
        account.contracts_process__c,
        account.cml_profiled_tva__c,
        account.cell_phone_tva__c,
        account.no_contact_tva__c,
        account.outlet_id_tva__c,
        account.pmo_gpo_account_affiliations,
        account.territory_status_tva__c,
        account.zdea_number_tva__c,
        account.veeva_id_tva__c,
        account.treanda_lq_tgt_tva__c,
        account.tbo_filgrastim_target_tva__c,
        account.sln_rescrub_tva__c,
        account.account_identifier_vod__c,
        account.target__c,
        account.kol_vod__c,
        account.rems_expiration_date_teva__c,
        account.account_demo_id_tva__c,
        account.total_lives__c,
        account.total_physicians_enrolled__c,
        account.tirf_rems_eff_date_tva__c,
        account.business_associate_agreement,
        account.do_not_promote_tva__c,
        account.account_dea_tva__c,
        account.bp_number__c,
        account.paragard_segmentation_tva__c,
        account.telesales_activity_tva__c,
        account.designation_tva__c,
        account.total_pharmacists__c,
        account.comp_pricing_tva__c,
        account.formulary_tva__c,
        account.gln_tva__c,
        account.gpo_contracts_tva__c,
        account.hin_tva__c,
        account.max_id_tva__c,
        account.oncology_services_tva__c,
        account.pcp_program_tva__c,
        account.pharmacy_location_tva__c,
        account.primary_credential_tva__c,
        account.primary_wholesaler_tva__c,
        account.rep_credentialing_tva__c,
        account.secondary_credential_tva__c,
        account.sign_in_location_tva__c,
        account.special_tva__c,
        account.sub_type_id_tva__c,
        account.sub_type_tva__c,
        account.teva_contracts_tva__c,
        account.ims_org_id_tva__c,
        account.cm_id_tva__c,
        account.year_of_birth_tva__c,
        account.teaching_hospital_tva__c,
        account.account_archived_tva__c,
        account.mobile_id_vod__pc,
        account.file_id,
        account.record_id
 FROM veeva.account
 WHERE (account.file_id = ( SELECT max(account.file_id) AS MAX
 FROM veeva.account));

CREATE  VIEW teva_ingestion.EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C AS
 SELECT btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Id) AS ID,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Name) AS Name,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.RecordTypeId) AS RecordTypeId,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.CreatedDate) AS CreatedDate,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.CreatedById) AS CreatedById,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.LastModifiedDate) AS LastModifiedDate,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.LastModifiedById) AS LastModifiedById,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.SystemModstamp) AS SystemModstamp,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.MayEdit) AS MayEdit,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.IsLocked) AS IsLocked,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Remote_Meeting_vod__c) AS Remote_Meeting_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Call_vod__c) AS Call_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Join_Time_vod__c) AS Join_Time_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Leave_Time_vod__c) AS Leave_Time_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Meeting_End_Time_vod__c) AS Meeting_End_Time_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Meeting_Start_Time_vod__c) AS Meeting_Start_Time_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Name_vod__c) AS Name_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Participant_Id_vod__c) AS Participant_Id_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.VExternal_Id_vod__c) AS VExternal_Id_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Veeva_Remote_Meeting_Id_vod__c) AS Veeva_Remote_Meeting_Id_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Device_vod__c) AS Device_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.EM_Attendee_vod__c) AS EM_Attendee_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.EM_Event_Speaker_vod__c) AS EM_Event_Speaker_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Event_vod__c) AS Event_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Network_Type_vod__c) AS Network_Type_vod__c,
        CASE WHEN (EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Meeting_Duration_vod__c = ''::varchar) THEN NULL::float ELSE (btrim(EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.Meeting_Duration_vod__c))::float END AS Meeting_Duration_vod__c,
        EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.batch_id,
        EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.row_id,
        EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src;

CREATE  VIEW raw.EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C AS
 SELECT src.Id,
        src.IsDeleted,
        src.Name,
        src.RecordTypeId,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.MayEdit,
        src.IsLocked,
        src.Remote_Meeting_vod__c,
        src.Call_vod__c,
        src.Join_Time_vod__c,
        src.Leave_Time_vod__c,
        src.Meeting_End_Time_vod__c,
        src.Meeting_Start_Time_vod__c,
        src.Name_vod__c,
        src.Participant_Id_vod__c,
        src.VExternal_Id_vod__c,
        src.Veeva_Remote_Meeting_Id_vod__c,
        src.Device_vod__c,
        src.EM_Attendee_vod__c,
        src.EM_Event_Speaker_vod__c,
        src.Event_vod__c,
        src.Network_Type_vod__c,
        src.Meeting_Duration_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_REMOTE_MEETING_ATTENDEE_VOD__C'::varchar(37)))));

CREATE  VIEW teva_ingestion.EXT_IMS_OCHL_W AS
 SELECT btrim(EXT_IMS_OCHL_W_src.Constant_CL) AS Constant_CL,
        btrim(EXT_IMS_OCHL_W_src.ddd_client_number) AS ddd_client_number,
        btrim(EXT_IMS_OCHL_W_src.blank1) AS blank1,
        btrim(EXT_IMS_OCHL_W_src.client_territory_number) AS client_territory_number,
        btrim(EXT_IMS_OCHL_W_src.ddd_outlet_number) AS ddd_outlet_number,
        btrim(EXT_IMS_OCHL_W_src.ddd_outlet_name) AS ddd_outlet_name,
        btrim(EXT_IMS_OCHL_W_src.ddd_outlet_address) AS ddd_outlet_address,
        btrim(EXT_IMS_OCHL_W_src.city) AS city,
        btrim(EXT_IMS_OCHL_W_src.state) AS state,
        btrim(EXT_IMS_OCHL_W_src.subcategory_code) AS subcategory_code,
        btrim(EXT_IMS_OCHL_W_src.action_code) AS action_code,
        EXT_IMS_OCHL_W_src.batch_id,
        EXT_IMS_OCHL_W_src.row_id,
        EXT_IMS_OCHL_W_src.update_ts
 FROM teva_ingestion.EXT_IMS_OCHL_W_src;

CREATE  VIEW raw.EXT_IMS_OCHL_W AS
 SELECT src.Constant_CL,
        src.ddd_client_number,
        src.blank1,
        src.client_territory_number,
        src.ddd_outlet_number,
        src.ddd_outlet_name,
        src.ddd_outlet_address,
        src.city,
        src.state,
        src.subcategory_code,
        src.action_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_OCHL_W_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_OCHL_W'::varchar(14)))));

CREATE  VIEW teva_ingestion.EXT_IMS_OCHL_M AS
 SELECT btrim(EXT_IMS_OCHL_M_src.Constant_CL) AS Constant_CL,
        btrim(EXT_IMS_OCHL_M_src.ddd_client_number) AS ddd_client_number,
        btrim(EXT_IMS_OCHL_M_src.blank1) AS blank1,
        btrim(EXT_IMS_OCHL_M_src.client_territory_number) AS client_territory_number,
        btrim(EXT_IMS_OCHL_M_src.ddd_outlet_number) AS ddd_outlet_number,
        btrim(EXT_IMS_OCHL_M_src.ddd_outlet_name) AS ddd_outlet_name,
        btrim(EXT_IMS_OCHL_M_src.ddd_outlet_address) AS ddd_outlet_address,
        btrim(EXT_IMS_OCHL_M_src.city) AS city,
        btrim(EXT_IMS_OCHL_M_src.state) AS state,
        btrim(EXT_IMS_OCHL_M_src.subcategory_code) AS subcategory_code,
        btrim(EXT_IMS_OCHL_M_src.action_code) AS action_code,
        EXT_IMS_OCHL_M_src.batch_id,
        EXT_IMS_OCHL_M_src.row_id,
        EXT_IMS_OCHL_M_src.update_ts
 FROM teva_ingestion.EXT_IMS_OCHL_M_src;

CREATE  VIEW raw.EXT_IMS_OCHL_M AS
 SELECT src.Constant_CL,
        src.ddd_client_number,
        src.blank1,
        src.client_territory_number,
        src.ddd_outlet_number,
        src.ddd_outlet_name,
        src.ddd_outlet_address,
        src.city,
        src.state,
        src.subcategory_code,
        src.action_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_OCHL_M_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_OCHL_M'::varchar(14)))));

CREATE  VIEW teva_ingestion.XPD_ADD_ON_DETAILS AS
 SELECT btrim(XPD_ADD_ON_DETAILS_src.ims_client_number) AS ims_client_number,
        btrim(XPD_ADD_ON_DETAILS_src.ims_report_number) AS ims_report_number,
        btrim(XPD_ADD_ON_DETAILS_src.channel_indicator) AS channel_indicator,
        btrim(XPD_ADD_ON_DETAILS_src.ims_id) AS ims_id,
        btrim(XPD_ADD_ON_DETAILS_src.filler_01) AS filler_01,
        btrim(XPD_ADD_ON_DETAILS_src.specialty) AS specialty,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_2) AS flexible_field_2,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_3) AS flexible_field_3,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_4) AS flexible_field_4,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_5) AS flexible_field_5,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_6) AS flexible_field_6,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_7) AS flexible_field_7,
        btrim(XPD_ADD_ON_DETAILS_src.flexible_field_8) AS flexible_field_8,
        btrim(XPD_ADD_ON_DETAILS_src.add_to_product_group) AS add_to_product_group,
        btrim(XPD_ADD_ON_DETAILS_src.add_On_product_group) AS add_On_product_group,
        btrim(XPD_ADD_ON_DETAILS_src.month_ending) AS month_ending,
        btrim(XPD_ADD_ON_DETAILS_src.add_on_rx) AS add_on_rx,
        XPD_ADD_ON_DETAILS_src.batch_id,
        XPD_ADD_ON_DETAILS_src.row_id,
        XPD_ADD_ON_DETAILS_src.update_ts
 FROM teva_ingestion.XPD_ADD_ON_DETAILS_src;

CREATE  VIEW raw.XPD_ADD_ON_DETAILS AS
 SELECT src.ims_client_number,
        src.ims_report_number,
        src.channel_indicator,
        src.ims_id,
        src.filler_01,
        src.specialty,
        src.flexible_field_2,
        src.flexible_field_3,
        src.flexible_field_4,
        src.flexible_field_5,
        src.flexible_field_6,
        src.flexible_field_7,
        src.flexible_field_8,
        src.add_to_product_group,
        src.add_On_product_group,
        src.month_ending,
        src.add_on_rx,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XPD_ADD_ON_DETAILS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XPD_ADD_ON_DETAILS'::varchar(18)))));

CREATE  VIEW teva_ingestion.XPD_RESTART_DIFF_DETAILS AS
 SELECT btrim(XPD_RESTART_DIFF_DETAILS_src.ims_client_number) AS ims_client_number,
        btrim(XPD_RESTART_DIFF_DETAILS_src.ims_report_number) AS ims_report_number,
        btrim(XPD_RESTART_DIFF_DETAILS_src.channel_indicator) AS channel_indicator,
        btrim(XPD_RESTART_DIFF_DETAILS_src.ims_id) AS ims_id,
        btrim(XPD_RESTART_DIFF_DETAILS_src.filler_01) AS filler_01,
        btrim(XPD_RESTART_DIFF_DETAILS_src.specialty) AS specialty,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_2) AS flexible_field_2,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_3) AS flexible_field_3,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_4) AS flexible_field_4,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_5) AS flexible_field_5,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_6) AS flexible_field_6,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_7) AS flexible_field_7,
        btrim(XPD_RESTART_DIFF_DETAILS_src.flexible_field_8) AS flexible_field_8,
        btrim(XPD_RESTART_DIFF_DETAILS_src.rdf_product_group) AS rdf_product_group,
        btrim(XPD_RESTART_DIFF_DETAILS_src.rd_product_group) AS rd_product_group,
        btrim(XPD_RESTART_DIFF_DETAILS_src.month_ending) AS month_ending,
        btrim(XPD_RESTART_DIFF_DETAILS_src.restart_diff_rx) AS restart_diff_rx,
        XPD_RESTART_DIFF_DETAILS_src.batch_id,
        XPD_RESTART_DIFF_DETAILS_src.row_id,
        XPD_RESTART_DIFF_DETAILS_src.update_ts
 FROM teva_ingestion.XPD_RESTART_DIFF_DETAILS_src;

CREATE  VIEW raw.XPD_RESTART_DIFF_DETAILS AS
 SELECT src.ims_client_number,
        src.ims_report_number,
        src.channel_indicator,
        src.ims_id,
        src.filler_01,
        src.specialty,
        src.flexible_field_2,
        src.flexible_field_3,
        src.flexible_field_4,
        src.flexible_field_5,
        src.flexible_field_6,
        src.flexible_field_7,
        src.flexible_field_8,
        src.rdf_product_group,
        src.rd_product_group,
        src.month_ending,
        src.restart_diff_rx,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.XPD_RESTART_DIFF_DETAILS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'XPD_RESTART_DIFF_DETAILS'::varchar(24)))));

CREATE  VIEW teva_ingestion.EXT_TRIALCARD_COUPON AS
 SELECT btrim(EXT_TRIALCARD_COUPON_src.redemption_type) AS redemption_type,
        btrim(EXT_TRIALCARD_COUPON_src.transaction_type) AS transaction_type,
        btrim(EXT_TRIALCARD_COUPON_src.claim_authorization_number) AS claim_authorization_number,
        btrim(EXT_TRIALCARD_COUPON_src.original_claim_authorization_number) AS original_claim_authorization_number,
        CASE WHEN (EXT_TRIALCARD_COUPON_src.date_of_fill = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_TRIALCARD_COUPON_src.date_of_fill))::timestamp END AS date_of_fill,
        CASE WHEN (EXT_TRIALCARD_COUPON_src.date_written = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_TRIALCARD_COUPON_src.date_written))::timestamp END AS date_written,
        btrim(EXT_TRIALCARD_COUPON_src.day_supply) AS day_supply,
        btrim(EXT_TRIALCARD_COUPON_src.ndc) AS ndc,
        btrim(EXT_TRIALCARD_COUPON_src.daw) AS daw,
        btrim(EXT_TRIALCARD_COUPON_src.drug_name) AS drug_name,
        btrim(EXT_TRIALCARD_COUPON_src.drug_description) AS drug_description,
        btrim(EXT_TRIALCARD_COUPON_src.new_refill_code) AS new_refill_code,
        btrim(EXT_TRIALCARD_COUPON_src.quantity) AS quantity,
        btrim(EXT_TRIALCARD_COUPON_src.number_of_refills) AS number_of_refills,
        btrim(EXT_TRIALCARD_COUPON_src.other_coverage_code) AS other_coverage_code,
        btrim(EXT_TRIALCARD_COUPON_src.group_num) AS group_num,
        btrim(EXT_TRIALCARD_COUPON_src.member_id) AS member_id,
        btrim(EXT_TRIALCARD_COUPON_src.patient_gender) AS patient_gender,
        btrim(EXT_TRIALCARD_COUPON_src.patient_age) AS patient_age,
        CASE WHEN (EXT_TRIALCARD_COUPON_src.date_processed = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_TRIALCARD_COUPON_src.date_processed))::timestamp END AS date_processed,
        btrim(EXT_TRIALCARD_COUPON_src.nabp) AS nabp,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_chain) AS pharmacy_chain,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_npi) AS pharmacy_npi,
        btrim(EXT_TRIALCARD_COUPON_src.rx_num) AS rx_num,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_address_1) AS pharmacy_address_1,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_address_2) AS pharmacy_address_2,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_state) AS pharmacy_state,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_zip) AS pharmacy_zip,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_phone) AS pharmacy_phone,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_npi) AS hcp_npi,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_first_name) AS hcp_first_name,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_middle_name) AS hcp_middle_name,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_last_name) AS hcp_last_name,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_suffix) AS hcp_suffix,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_designation) AS hcp_designation,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_specialty_1) AS hcp_specialty_1,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_specialty_2) AS hcp_specialty_2,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_address_1) AS hcp_address_1,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_address_2) AS hcp_address_2,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_city) AS hcp_city,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_state) AS hcp_state,
        btrim(EXT_TRIALCARD_COUPON_src.hcp_zip) AS hcp_zip,
        btrim(EXT_TRIALCARD_COUPON_src.submission_method) AS submission_method,
        btrim(EXT_TRIALCARD_COUPON_src.previous_payer_id) AS previous_payer_id,
        btrim(EXT_TRIALCARD_COUPON_src.patient_expense) AS patient_expense,
        btrim(EXT_TRIALCARD_COUPON_src.patient_benefit) AS patient_benefit,
        btrim(EXT_TRIALCARD_COUPON_src.patient_copay) AS patient_copay,
        btrim(EXT_TRIALCARD_COUPON_src.patient_oop) AS patient_oop,
        btrim(EXT_TRIALCARD_COUPON_src.pharmacy_fee) AS pharmacy_fee,
        btrim(EXT_TRIALCARD_COUPON_src.amount_due) AS amount_due,
        CASE WHEN (EXT_TRIALCARD_COUPON_src.create_date = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_TRIALCARD_COUPON_src.create_date))::timestamp END AS create_date,
        btrim(EXT_TRIALCARD_COUPON_src.occ_payment_type) AS occ_payment_type,
        btrim(EXT_TRIALCARD_COUPON_src.calc_awp) AS calc_awp,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_npi) AS admin_hcp_npi,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_name) AS admin_hcp_name,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_address) AS admin_hcp_address,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_address2) AS admin_hcp_address2,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_city) AS admin_hcp_city,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_state) AS admin_hcp_state,
        btrim(EXT_TRIALCARD_COUPON_src.admin_hcp_zip) AS admin_hcp_zip,
        btrim(EXT_TRIALCARD_COUPON_src.claim_type) AS claim_type,
        btrim(EXT_TRIALCARD_COUPON_src.administration_flag) AS administration_flag,
        btrim(EXT_TRIALCARD_COUPON_src.soc_name) AS soc_name,
        btrim(EXT_TRIALCARD_COUPON_src.soc_phone) AS soc_phone,
        btrim(EXT_TRIALCARD_COUPON_src.soc_fax) AS soc_fax,
        btrim(EXT_TRIALCARD_COUPON_src.soc_address) AS soc_address,
        btrim(EXT_TRIALCARD_COUPON_src.soc_city) AS soc_city,
        btrim(EXT_TRIALCARD_COUPON_src.soc_state) AS soc_state,
        btrim(EXT_TRIALCARD_COUPON_src.soc_zip) AS soc_zip,
        btrim(EXT_TRIALCARD_COUPON_src.soc_id) AS soc_id,
        btrim(EXT_TRIALCARD_COUPON_src.soc_npi) AS soc_npi,
        btrim(EXT_TRIALCARD_COUPON_src.payer_name) AS payer_name,
        btrim(EXT_TRIALCARD_COUPON_src.cpt_code) AS cpt_code,
        btrim(EXT_TRIALCARD_COUPON_src.patient_type) AS patient_type,
        btrim(EXT_TRIALCARD_COUPON_src.primary_bin) AS primary_bin,
        btrim(EXT_TRIALCARD_COUPON_src.primary_bin_description) AS primary_bin_description,
        btrim(EXT_TRIALCARD_COUPON_src.reject_code) AS reject_code,
        EXT_TRIALCARD_COUPON_src.batch_id,
        EXT_TRIALCARD_COUPON_src.row_id,
        EXT_TRIALCARD_COUPON_src.update_ts
 FROM teva_ingestion.EXT_TRIALCARD_COUPON_src;

CREATE  VIEW raw.EXT_TRIALCARD_COUPON AS
 SELECT src.redemption_type,
        src.transaction_type,
        src.claim_authorization_number,
        src.original_claim_authorization_number,
        src.date_of_fill,
        src.date_written,
        src.day_supply,
        src.ndc,
        src.daw,
        src.drug_name,
        src.drug_description,
        src.new_refill_code,
        src.quantity,
        src.number_of_refills,
        src.other_coverage_code,
        src.group_num,
        src.member_id,
        src.patient_gender,
        src.patient_age,
        src.date_processed,
        src.nabp,
        src.pharmacy_chain,
        src.pharmacy_npi,
        src.rx_num,
        src.pharmacy_name,
        src.pharmacy_address_1,
        src.pharmacy_address_2,
        src.pharmacy_city,
        src.pharmacy_state,
        src.pharmacy_zip,
        src.pharmacy_phone,
        src.hcp_npi,
        src.hcp_first_name,
        src.hcp_middle_name,
        src.hcp_last_name,
        src.hcp_suffix,
        src.hcp_designation,
        src.hcp_specialty_1,
        src.hcp_specialty_2,
        src.hcp_address_1,
        src.hcp_address_2,
        src.hcp_city,
        src.hcp_state,
        src.hcp_zip,
        src.submission_method,
        src.previous_payer_id,
        src.patient_expense,
        src.patient_benefit,
        src.patient_copay,
        src.patient_oop,
        src.pharmacy_fee,
        src.amount_due,
        src.create_date,
        src.occ_payment_type,
        src.calc_awp,
        src.admin_hcp_npi,
        src.admin_hcp_name,
        src.admin_hcp_address,
        src.admin_hcp_address2,
        src.admin_hcp_city,
        src.admin_hcp_state,
        src.admin_hcp_zip,
        src.claim_type,
        src.administration_flag,
        src.soc_name,
        src.soc_phone,
        src.soc_fax,
        src.soc_address,
        src.soc_city,
        src.soc_state,
        src.soc_zip,
        src.soc_id,
        src.soc_npi,
        src.payer_name,
        src.cpt_code,
        src.patient_type,
        src.primary_bin,
        src.primary_bin_description,
        src.reject_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TRIALCARD_COUPON_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TRIALCARD_COUPON'::varchar(20)))));

CREATE  VIEW teva_ingestion.EXT_DDD_DOLLARS_M_ADHOC AS
 SELECT btrim(EXT_DDD_DOLLARS_M_ADHOC_src.client_num) AS client_num,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.report_num) AS report_num,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_code) AS outlet_code,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.zip) AS zip,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.subcategory_code) AS subcategory_code,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.sra_4) AS sra_4,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.category_code) AS category_code,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.ims_product_code) AS ims_product_code,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.data_date) AS data_date,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth01) AS dol_mth01,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth02) AS dol_mth02,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth03) AS dol_mth03,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth04) AS dol_mth04,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth05) AS dol_mth05,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth06) AS dol_mth06,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth07) AS dol_mth07,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth08) AS dol_mth08,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth09) AS dol_mth09,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth10) AS dol_mth10,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth11) AS dol_mth11,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth12) AS dol_mth12,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth13) AS dol_mth13,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth14) AS dol_mth14,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth15) AS dol_mth15,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth16) AS dol_mth16,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth17) AS dol_mth17,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth18) AS dol_mth18,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth19) AS dol_mth19,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth20) AS dol_mth20,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth21) AS dol_mth21,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth22) AS dol_mth22,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth23) AS dol_mth23,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.dol_mth24) AS dol_mth24,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_name) AS outlet_name,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_address) AS outlet_address,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_city) AS outlet_city,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_state) AS outlet_state,
        btrim(EXT_DDD_DOLLARS_M_ADHOC_src.outlet_zip) AS outlet_zip,
        EXT_DDD_DOLLARS_M_ADHOC_src.batch_id,
        EXT_DDD_DOLLARS_M_ADHOC_src.row_id,
        EXT_DDD_DOLLARS_M_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_DDD_DOLLARS_M_ADHOC_src;

CREATE  VIEW raw.EXT_DDD_DOLLARS_M_ADHOC AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.dol_mth01,
        src.dol_mth02,
        src.dol_mth03,
        src.dol_mth04,
        src.dol_mth05,
        src.dol_mth06,
        src.dol_mth07,
        src.dol_mth08,
        src.dol_mth09,
        src.dol_mth10,
        src.dol_mth11,
        src.dol_mth12,
        src.dol_mth13,
        src.dol_mth14,
        src.dol_mth15,
        src.dol_mth16,
        src.dol_mth17,
        src.dol_mth18,
        src.dol_mth19,
        src.dol_mth20,
        src.dol_mth21,
        src.dol_mth22,
        src.dol_mth23,
        src.dol_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_DOLLARS_M_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_DOLLARS_M_ADHOC'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_DDD_QUANTITY_M_ADHOC AS
 SELECT btrim(EXT_DDD_QUANTITY_M_ADHOC_src.client_num) AS client_num,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.report_num) AS report_num,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_code) AS outlet_code,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.zip) AS zip,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.subcategory_code) AS subcategory_code,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.sra_4) AS sra_4,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.category_code) AS category_code,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.ims_product_code) AS ims_product_code,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.data_date) AS data_date,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth01) AS qty_mth01,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth02) AS qty_mth02,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth03) AS qty_mth03,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth04) AS qty_mth04,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth05) AS qty_mth05,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth06) AS qty_mth06,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth07) AS qty_mth07,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth08) AS qty_mth08,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth09) AS qty_mth09,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth10) AS qty_mth10,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth11) AS qty_mth11,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth12) AS qty_mth12,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth13) AS qty_mth13,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth14) AS qty_mth14,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth15) AS qty_mth15,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth16) AS qty_mth16,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth17) AS qty_mth17,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth18) AS qty_mth18,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth19) AS qty_mth19,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth20) AS qty_mth20,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth21) AS qty_mth21,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth22) AS qty_mth22,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth23) AS qty_mth23,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.qty_mth24) AS qty_mth24,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_name) AS outlet_name,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_address) AS outlet_address,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_city) AS outlet_city,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_state) AS outlet_state,
        btrim(EXT_DDD_QUANTITY_M_ADHOC_src.outlet_zip) AS outlet_zip,
        EXT_DDD_QUANTITY_M_ADHOC_src.batch_id,
        EXT_DDD_QUANTITY_M_ADHOC_src.row_id,
        EXT_DDD_QUANTITY_M_ADHOC_src.update_ts
 FROM teva_ingestion.EXT_DDD_QUANTITY_M_ADHOC_src;

CREATE  VIEW raw.EXT_DDD_QUANTITY_M_ADHOC AS
 SELECT src.client_num,
        src.report_num,
        src.outlet_code,
        src.zip,
        src.subcategory_code,
        src.sra_4,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.qty_mth01,
        src.qty_mth02,
        src.qty_mth03,
        src.qty_mth04,
        src.qty_mth05,
        src.qty_mth06,
        src.qty_mth07,
        src.qty_mth08,
        src.qty_mth09,
        src.qty_mth10,
        src.qty_mth11,
        src.qty_mth12,
        src.qty_mth13,
        src.qty_mth14,
        src.qty_mth15,
        src.qty_mth16,
        src.qty_mth17,
        src.qty_mth18,
        src.qty_mth19,
        src.qty_mth20,
        src.qty_mth21,
        src.qty_mth22,
        src.qty_mth23,
        src.qty_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_QUANTITY_M_ADHOC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_QUANTITY_M_ADHOC'::varchar(24)))));

CREATE  VIEW outbound.zs_digihaler_activity_call_detail AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position,
        c.call_recordtype,
        c.how_executed
 FROM (datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id)))
 WHERE ((cd.basket_name ~~* '%DIGIHALER%'::varchar(11)) AND (c.call_date >= '2020-01-01'::date))
 GROUP BY c.sales_force_id,
          c.call_id,
          c.veeva_account_id,
          c.ims_id,
          c.customer_type,
          c.call_type,
          c.rep_id,
          c.territory_number,
          c.zip_on_call,
          c.call_date,
          c.submit_date,
          c.attendees,
          c.attendee_type,
          c.tvcmid,
          cd.product,
          cd.basket_id,
          cd.basket_name,
          cd.detail_position,
          c.call_recordtype,
          c.how_executed
 ORDER BY c.call_date;

CREATE  VIEW teva_ingestion.EXT_RELIANCE AS
 SELECT btrim(EXT_RELIANCE_src.referral_number) AS referral_number,
        btrim(EXT_RELIANCE_src.hub_order_trans_number) AS hub_order_trans_number,
        btrim(EXT_RELIANCE_src.date_written) AS date_written,
        btrim(EXT_RELIANCE_src.referral_source) AS referral_source,
        btrim(EXT_RELIANCE_src.referral_date) AS referral_date,
        btrim(EXT_RELIANCE_src.patient_first_ship_date) AS patient_first_ship_date,
        btrim(EXT_RELIANCE_src.ship_date) AS ship_date,
        btrim(EXT_RELIANCE_src.full_product_name) AS full_product_name,
        btrim(EXT_RELIANCE_src.product_strength) AS product_strength,
        btrim(EXT_RELIANCE_src.product_form) AS product_form,
        btrim(EXT_RELIANCE_src.ndc_number) AS ndc_number,
        btrim(EXT_RELIANCE_src.quantity_shipped) AS quantity_shipped,
        btrim(EXT_RELIANCE_src.quantity_uom) AS quantity_uom,
        btrim(EXT_RELIANCE_src.days_supplied) AS days_supplied,
        btrim(EXT_RELIANCE_src.dosing_instructions) AS dosing_instructions,
        btrim(EXT_RELIANCE_src.frequency) AS frequency,
        btrim(EXT_RELIANCE_src.rx_number) AS rx_number,
        btrim(EXT_RELIANCE_src.rx_type) AS rx_type,
        btrim(EXT_RELIANCE_src.authorized_refills) AS authorized_refills,
        btrim(EXT_RELIANCE_src.fill_number) AS fill_number,
        btrim(EXT_RELIANCE_src.refills_remaining) AS refills_remaining,
        btrim(EXT_RELIANCE_src.primary_icd_codes) AS primary_icd_codes,
        btrim(EXT_RELIANCE_src.secondary_icd_codes) AS secondary_icd_codes,
        btrim(EXT_RELIANCE_src.ship_to_location_type) AS ship_to_location_type,
        btrim(EXT_RELIANCE_src.shipping_carrier) AS shipping_carrier,
        btrim(EXT_RELIANCE_src.npi) AS npi,
        btrim(EXT_RELIANCE_src.dea) AS dea,
        btrim(EXT_RELIANCE_src.spp_physician_id) AS spp_physician_id,
        btrim(EXT_RELIANCE_src.first_name) AS first_name,
        btrim(EXT_RELIANCE_src.middle_name) AS middle_name,
        btrim(EXT_RELIANCE_src.last_name) AS last_name,
        btrim(EXT_RELIANCE_src.suffix) AS suffix,
        btrim(EXT_RELIANCE_src.physician_address1) AS physician_address1,
        btrim(EXT_RELIANCE_src.physician_address2) AS physician_address2,
        btrim(EXT_RELIANCE_src.physician_city) AS physician_city,
        btrim(EXT_RELIANCE_src.physician_state) AS physician_state,
        btrim(EXT_RELIANCE_src.physician_zip) AS physician_zip,
        btrim(EXT_RELIANCE_src.physician_phone) AS physician_phone,
        btrim(EXT_RELIANCE_src.physician_fax) AS physician_fax,
        btrim(EXT_RELIANCE_src.primary_payer_bin) AS primary_payer_bin,
        btrim(EXT_RELIANCE_src.primary_payer_pcn) AS primary_payer_pcn,
        btrim(EXT_RELIANCE_src.primary_group_num) AS primary_group_num,
        btrim(EXT_RELIANCE_src.primary_payer_name) AS primary_payer_name,
        btrim(EXT_RELIANCE_src.primary_payer_type) AS primary_payer_type,
        btrim(EXT_RELIANCE_src.primary_benefit_type) AS primary_benefit_type,
        btrim(EXT_RELIANCE_src.primary_co_pay_amount) AS primary_co_pay_amount,
        btrim(EXT_RELIANCE_src.primary_pa_required) AS primary_pa_required,
        btrim(EXT_RELIANCE_src.primary_pa_exp_date) AS primary_pa_exp_date,
        btrim(EXT_RELIANCE_src.secondary_payer_bin) AS secondary_payer_bin,
        btrim(EXT_RELIANCE_src.secondary_payer_pcn) AS secondary_payer_pcn,
        btrim(EXT_RELIANCE_src.secondary_group_num) AS secondary_group_num,
        btrim(EXT_RELIANCE_src.secondary_payer_name) AS secondary_payer_name,
        btrim(EXT_RELIANCE_src.secondary_copay_amount) AS secondary_copay_amount,
        btrim(EXT_RELIANCE_src.encrypted_spp_patient_id) AS encrypted_spp_patient_id,
        btrim(EXT_RELIANCE_src.hub_identifier) AS hub_identifier,
        btrim(EXT_RELIANCE_src.patient_state) AS patient_state,
        btrim(EXT_RELIANCE_src.patient_yob) AS patient_yob,
        btrim(EXT_RELIANCE_src.patient_gender) AS patient_gender,
        btrim(EXT_RELIANCE_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_RELIANCE_src.pharmacy_location_name) AS pharmacy_location_name,
        btrim(EXT_RELIANCE_src.location_dea) AS location_dea,
        btrim(EXT_RELIANCE_src.location_npi_number) AS location_npi_number,
        btrim(EXT_RELIANCE_src.location_ncpdp_number) AS location_ncpdp_number,
        btrim(EXT_RELIANCE_src.reliance_record_id) AS reliance_record_id,
        btrim(EXT_RELIANCE_src.restatement_flag) AS restatement_flag,
        btrim(EXT_RELIANCE_src.physician_sln) AS physician_slN,
        EXT_RELIANCE_src.batch_id,
        EXT_RELIANCE_src.row_id,
        EXT_RELIANCE_src.update_ts
 FROM teva_ingestion.EXT_RELIANCE_src;

CREATE  VIEW raw.EXT_RELIANCE AS
 SELECT src.referral_number,
        src.hub_order_trans_number,
        src.date_written,
        src.referral_source,
        src.referral_date,
        src.patient_first_ship_date,
        src.ship_date,
        src.full_product_name,
        src.product_strength,
        src.product_form,
        src.ndc_number,
        src.quantity_shipped,
        src.quantity_uom,
        src.days_supplied,
        src.dosing_instructions,
        src.frequency,
        src.rx_number,
        src.rx_type,
        src.authorized_refills,
        src.fill_number,
        src.refills_remaining,
        src.primary_icd_codes,
        src.secondary_icd_codes,
        src.ship_to_location_type,
        src.shipping_carrier,
        src.npi,
        src.dea,
        src.spp_physician_id,
        src.first_name,
        src.middle_name,
        src.last_name,
        src.suffix,
        src.physician_address1,
        src.physician_address2,
        src.physician_city,
        src.physician_state,
        src.physician_zip,
        src.physician_phone,
        src.physician_fax,
        src.primary_payer_bin,
        src.primary_payer_pcn,
        src.primary_group_num,
        src.primary_payer_name,
        src.primary_payer_type,
        src.primary_benefit_type,
        src.primary_co_pay_amount,
        src.primary_pa_required,
        src.primary_pa_exp_date,
        src.secondary_payer_bin,
        src.secondary_payer_pcn,
        src.secondary_group_num,
        src.secondary_payer_name,
        src.secondary_copay_amount,
        src.encrypted_spp_patient_id,
        src.hub_identifier,
        src.patient_state,
        src.patient_yob,
        src.patient_gender,
        src.pharmacy_name,
        src.pharmacy_location_name,
        src.location_dea,
        src.location_npi_number,
        src.location_ncpdp_number,
        src.reliance_record_id,
        src.restatement_flag,
        src.physician_sln,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_RELIANCE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_RELIANCE'::varchar(12)))));

CREATE  VIEW outbound.CobbsCreek_austedo_optum_rx_monthly AS
 SELECT specialty_pharmacy_shipment.specialty_pharmacy_data_source,
        specialty_pharmacy_shipment.ims_id,
        specialty_pharmacy_shipment.tw_ship_to_address_id,
        specialty_pharmacy_shipment.tw_bill_to_address_id,
        specialty_pharmacy_shipment.source_customer_id,
        specialty_pharmacy_shipment.customer_name,
        specialty_pharmacy_shipment.physician_first_name,
        specialty_pharmacy_shipment.physician_last_name,
        specialty_pharmacy_shipment.ship_to_address_line_1,
        specialty_pharmacy_shipment.ship_to_address_line_2,
        specialty_pharmacy_shipment.ship_to_city,
        specialty_pharmacy_shipment.ship_to_state,
        specialty_pharmacy_shipment.ship_to_zip,
        specialty_pharmacy_shipment.source_transaction_id,
        specialty_pharmacy_shipment.invoice_date,
        specialty_pharmacy_shipment.ship_date,
        specialty_pharmacy_shipment.source_product_code,
        specialty_pharmacy_shipment.basket_id,
        specialty_pharmacy_shipment.quantity,
        specialty_pharmacy_shipment.invoice_unit_price,
        specialty_pharmacy_shipment.invoice_amount,
        specialty_pharmacy_shipment.invoice_discount,
        specialty_pharmacy_shipment.order_type,
        specialty_pharmacy_shipment.customer_type,
        specialty_pharmacy_shipment.source_parent_customer_id,
        specialty_pharmacy_shipment.parent_customer_name,
        specialty_pharmacy_shipment.lob_code_desc,
        specialty_pharmacy_shipment.order_type_desc,
        specialty_pharmacy_shipment.price_matrix_def,
        specialty_pharmacy_shipment.whse_code,
        specialty_pharmacy_shipment.order_no,
        specialty_pharmacy_shipment.package_size,
        specialty_pharmacy_shipment.tvcmid,
        specialty_pharmacy_shipment.trx_cnt,
        specialty_pharmacy_shipment.net_sales_amt,
        specialty_pharmacy_shipment.adj_invoice_unit_price,
        specialty_pharmacy_shipment.adj_invoice_amount,
        specialty_pharmacy_shipment.net_cost,
        specialty_pharmacy_shipment.payer_flag,
        specialty_pharmacy_shipment.optum_briova_flag AS birova_flag,
        specialty_pharmacy_shipment.physician_middle_name,
        specialty_pharmacy_shipment.rollup_flag,
        specialty_pharmacy_shipment.basket_type,
        specialty_pharmacy_shipment.unnormalized_trx_count,
        specialty_pharmacy_shipment.file_id,
        specialty_pharmacy_shipment.basket_name,
        product_basket.parent_basket_name,
        product_basket.child_basket_name
 FROM (datamart.specialty_pharmacy_shipment specialty_pharmacy_shipment JOIN datamart.product_basket product_basket ON ((specialty_pharmacy_shipment.basket_name = product_basket.child_basket_name)))
 WHERE ((specialty_pharmacy_shipment.ship_date >= '2018-02-01'::date) AND (specialty_pharmacy_shipment.basket_type = 'product'::varchar(7)) AND (product_basket.parent_basket_name = 'MOVEMENT DISORDER MARKET'::varchar(24)))
 GROUP BY specialty_pharmacy_shipment.specialty_pharmacy_data_source,
          specialty_pharmacy_shipment.ims_id,
          specialty_pharmacy_shipment.tw_ship_to_address_id,
          specialty_pharmacy_shipment.tw_bill_to_address_id,
          specialty_pharmacy_shipment.source_customer_id,
          specialty_pharmacy_shipment.customer_name,
          specialty_pharmacy_shipment.physician_first_name,
          specialty_pharmacy_shipment.physician_last_name,
          specialty_pharmacy_shipment.ship_to_address_line_1,
          specialty_pharmacy_shipment.ship_to_address_line_2,
          specialty_pharmacy_shipment.ship_to_city,
          specialty_pharmacy_shipment.ship_to_state,
          specialty_pharmacy_shipment.ship_to_zip,
          specialty_pharmacy_shipment.source_transaction_id,
          specialty_pharmacy_shipment.invoice_date,
          specialty_pharmacy_shipment.ship_date,
          specialty_pharmacy_shipment.source_product_code,
          specialty_pharmacy_shipment.basket_id,
          specialty_pharmacy_shipment.quantity,
          specialty_pharmacy_shipment.invoice_unit_price,
          specialty_pharmacy_shipment.invoice_amount,
          specialty_pharmacy_shipment.invoice_discount,
          specialty_pharmacy_shipment.order_type,
          specialty_pharmacy_shipment.customer_type,
          specialty_pharmacy_shipment.source_parent_customer_id,
          specialty_pharmacy_shipment.parent_customer_name,
          specialty_pharmacy_shipment.lob_code_desc,
          specialty_pharmacy_shipment.order_type_desc,
          specialty_pharmacy_shipment.price_matrix_def,
          specialty_pharmacy_shipment.whse_code,
          specialty_pharmacy_shipment.order_no,
          specialty_pharmacy_shipment.package_size,
          specialty_pharmacy_shipment.tvcmid,
          specialty_pharmacy_shipment.trx_cnt,
          specialty_pharmacy_shipment.net_sales_amt,
          specialty_pharmacy_shipment.adj_invoice_unit_price,
          specialty_pharmacy_shipment.adj_invoice_amount,
          specialty_pharmacy_shipment.net_cost,
          specialty_pharmacy_shipment.payer_flag,
          specialty_pharmacy_shipment.optum_briova_flag,
          specialty_pharmacy_shipment.physician_middle_name,
          specialty_pharmacy_shipment.rollup_flag,
          specialty_pharmacy_shipment.basket_type,
          specialty_pharmacy_shipment.unnormalized_trx_count,
          specialty_pharmacy_shipment.file_id,
          specialty_pharmacy_shipment.basket_name,
          product_basket.parent_basket_name,
          product_basket.child_basket_name;

CREATE  VIEW outbound.zs_xpo_xpopt_AM_prodbrandmrkt_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)) AND (prescriber_rx.basket_type = ANY (ARRAY['brand'::varchar(7), 'market'::varchar(7), 'product'::varchar(7)])));

CREATE  VIEW outbound.zs_xpo_xpopt_AM_submrkt_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)) AND (prescriber_rx.basket_type = 'submarket'::varchar(9)));

CREATE  VIEW outbound.zs_sample_shipment AS
 SELECT ss.veeva_id,
        ss.tvcmid,
        ss.ims_id,
        ss.first_name,
        ss.middle_name,
        ss.last_name,
        ss.designation,
        ss.state_license_number,
        ss.address_line_1,
        ss.address_line_2,
        ss.address_line_3,
        ss.city,
        ss.state,
        ss.zip,
        ss.dea_license_number,
        ss.order_id,
        ss.ndc,
        ss.basket_id,
        ss.basket_name,
        ss.order_job_code,
        ss.order_job_description,
        ss.ship_qty,
        ss.ship_date,
        ss.repid,
        ss.territory,
        ss.signature_type,
        ss.attendeename
 FROM datamart.sample_shipment ss
 WHERE ((ss.basket_name !~~* '%QNASL%'::varchar(7)) AND (ss.ship_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))))
 GROUP BY ss.veeva_id,
          ss.tvcmid,
          ss.ims_id,
          ss.first_name,
          ss.middle_name,
          ss.last_name,
          ss.designation,
          ss.state_license_number,
          ss.address_line_1,
          ss.address_line_2,
          ss.address_line_3,
          ss.city,
          ss.state,
          ss.zip,
          ss.dea_license_number,
          ss.order_id,
          ss.ndc,
          ss.basket_id,
          ss.basket_name,
          ss.order_job_code,
          ss.order_job_description,
          ss.ship_qty,
          ss.ship_date,
          ss.repid,
          ss.territory,
          ss.signature_type,
          ss.attendeename;

CREATE  VIEW teva_ingestion.EXT_ZIP_TO_TERR_V2 AS
 SELECT btrim(EXT_ZIP_TO_TERR_V2_src.zip) AS zip,
        btrim(EXT_ZIP_TO_TERR_V2_src.city) AS city,
        btrim(EXT_ZIP_TO_TERR_V2_src.state) AS state,
        btrim(EXT_ZIP_TO_TERR_V2_src.territory_1_id) AS territory_1_id,
        btrim(EXT_ZIP_TO_TERR_V2_src.territory_name) AS territory_name,
        btrim(EXT_ZIP_TO_TERR_V2_src.area_name) AS area_name,
        btrim(EXT_ZIP_TO_TERR_V2_src.region_name) AS region_name,
        btrim(EXT_ZIP_TO_TERR_V2_src.mirror_flag) AS mirror_flag,
        btrim(EXT_ZIP_TO_TERR_V2_src.territory_2_id) AS territory_2_id,
        EXT_ZIP_TO_TERR_V2_src.batch_id,
        EXT_ZIP_TO_TERR_V2_src.row_id,
        EXT_ZIP_TO_TERR_V2_src.update_ts
 FROM teva_ingestion.EXT_ZIP_TO_TERR_V2_src;

CREATE  VIEW raw.EXT_ZIP_TO_TERR_V2 AS
 SELECT src.zip,
        src.city,
        src.state,
        src.territory_1_id,
        src.territory_name,
        src.area_name,
        src.region_name,
        src.mirror_flag,
        src.territory_2_id,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZIP_TO_TERR_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZIP_TO_TERR_V2'::varchar(18)))));

CREATE  VIEW sys_catalog.tables AS
 SELECT tables.table_schema_id,
        tables.table_schema,
        tables.table_id,
        tables.table_name,
        tables.owner_id,
        tables.owner_name,
        tables.is_temp_table,
        tables.is_system_table,
        tables.force_outer,
        tables.is_flextable,
        tables.has_aggregate_projection,
        tables.system_table_creator,
        tables.partition_expression,
        tables.create_time,
        tables.table_definition,
        tables.recover_priority,
        tables.storage_mode,
        tables.is_shared,
        tables.partition_group_expression,
        tables.active_partition_count
 FROM v_catalog.tables;

CREATE  VIEW sys_catalog.views AS
 SELECT views.table_schema_id,
        views.table_schema,
        views.table_id,
        views.table_name,
        views.owner_id,
        views.owner_name,
        views.view_definition,
        views.is_system_view,
        views.system_view_creator,
        views.create_time,
        views.is_local_temp_view,
        views.inherit_privileges
 FROM v_catalog.views;

CREATE  VIEW sys_catalog.grants AS
 SELECT grants.grant_id,
        grants.grantor_id,
        grants.grantor,
        grants.privileges_description,
        grants.object_schema,
        grants.object_name,
        grants.object_id,
        grants.object_type,
        grants.grantee_id,
        grants.grantee
 FROM v_catalog.grants;

CREATE  VIEW sys_catalog.users AS
 SELECT users.user_id,
        users.user_name,
        users.is_super_user,
        users.profile_name,
        users.is_locked,
        users.lock_time,
        users.resource_pool,
        users.memory_cap_kb,
        users.temp_space_cap_kb,
        users.run_time_cap,
        users.max_connections,
        users.connection_limit_mode,
        users.idle_session_timeout,
        users.grace_period,
        users.all_roles,
        users.default_roles,
        users.search_path,
        users.ldap_dn,
        users.ldap_uri_hash,
        users.is_orphaned_from_ldap
 FROM v_catalog.users;

CREATE  VIEW sys_catalog.query_events AS
 SELECT query_events.event_timestamp,
        query_events.node_name,
        query_events.user_id,
        query_events.user_name,
        query_events.session_id,
        query_events.request_id,
        query_events.transaction_id,
        query_events.statement_id,
        query_events.event_category,
        query_events.event_type,
        query_events.event_description,
        query_events.operator_name,
        query_events.path_id,
        query_events.object_id,
        query_events.event_details,
        query_events.event_severity,
        query_events.suggested_action
 FROM v_monitor.query_events;

CREATE  VIEW sys_catalog.query_consumption AS
 SELECT query_consumption.end_time,
        query_consumption.session_id,
        query_consumption.user_id,
        query_consumption.user_name,
        query_consumption.transaction_id,
        query_consumption.statement_id,
        query_consumption.cpu_cycles_us,
        query_consumption.network_bytes_received,
        query_consumption.network_bytes_sent,
        query_consumption.data_bytes_read,
        query_consumption.data_bytes_written,
        query_consumption.data_bytes_loaded,
        query_consumption.bytes_spilled,
        query_consumption.input_rows,
        query_consumption.input_rows_processed,
        query_consumption.thread_count,
        query_consumption.duration_ms,
        query_consumption.resource_pool,
        query_consumption.output_rows,
        query_consumption.request_type,
        query_consumption.label,
        query_consumption.is_retry,
        query_consumption.success
 FROM v_monitor.query_consumption;

CREATE  VIEW sys_catalog.query_metrics AS
 SELECT query_metrics.node_name,
        query_metrics.active_user_session_count,
        query_metrics.active_system_session_count,
        query_metrics.total_user_session_count,
        query_metrics.total_system_session_count,
        query_metrics.total_active_session_count,
        query_metrics.total_session_count,
        query_metrics.running_query_count,
        query_metrics.executed_query_count
 FROM v_monitor.query_metrics;

CREATE  VIEW sys_catalog.query_requests AS
 SELECT query_requests.node_name,
        query_requests.user_name,
        query_requests.session_id,
        query_requests.request_id,
        query_requests.transaction_id,
        query_requests.statement_id,
        query_requests.request_type,
        query_requests.request,
        query_requests.request_label,
        query_requests.search_path,
        query_requests.memory_acquired_mb,
        query_requests.success,
        query_requests.error_count,
        query_requests.start_timestamp,
        query_requests.end_timestamp,
        query_requests.request_duration,
        query_requests.request_duration_ms,
        query_requests.is_executing
 FROM v_monitor.query_requests;

CREATE  VIEW sys_catalog.sessions AS
 SELECT sessions.node_name,
        sessions.user_name,
        sessions.client_hostname,
        sessions.client_pid,
        sessions.login_timestamp,
        sessions.session_id,
        sessions.idle_session_timeout,
        sessions.grace_period,
        sessions.client_label,
        sessions.transaction_start,
        sessions.transaction_id,
        sessions.transaction_description,
        sessions.statement_start,
        sessions.statement_id,
        sessions.last_statement_duration_us,
        sessions.runtime_priority,
        sessions.current_statement,
        sessions.last_statement,
        sessions.ssl_state,
        sessions.authentication_method,
        sessions.client_type,
        sessions.client_version,
        sessions.client_os,
        sessions.client_os_user_name,
        sessions.client_authentication_name,
        sessions.client_authentication,
        sessions.requested_protocol,
        sessions.effective_protocol,
        sessions.external_memory_kb
 FROM v_monitor.sessions;

CREATE  VIEW sys_catalog.memory_usage AS
 SELECT memory_usage.node_name,
        memory_usage.start_time,
        memory_usage.end_time,
        memory_usage.average_memory_usage_percent
 FROM v_monitor.memory_usage;

CREATE  VIEW sys_catalog.cpu_usage AS
 SELECT cpu_usage.node_name,
        cpu_usage.start_time,
        cpu_usage.end_time,
        cpu_usage.average_cpu_usage_percent
 FROM v_monitor.cpu_usage;

CREATE  VIEW sys_catalog.resource_pool_status AS
 SELECT resource_pool_status.node_name,
        resource_pool_status.pool_oid,
        resource_pool_status.pool_name,
        resource_pool_status.is_internal,
        resource_pool_status.memory_size_kb,
        resource_pool_status.memory_size_actual_kb,
        resource_pool_status.memory_inuse_kb,
        resource_pool_status.general_memory_borrowed_kb,
        resource_pool_status.queueing_threshold_kb,
        resource_pool_status.max_memory_size_kb,
        resource_pool_status.max_query_memory_size_kb,
        resource_pool_status.running_query_count,
        resource_pool_status.planned_concurrency,
        resource_pool_status.max_concurrency,
        resource_pool_status.is_standalone,
        resource_pool_status.queue_timeout,
        resource_pool_status.queue_timeout_in_seconds,
        resource_pool_status.execution_parallelism,
        resource_pool_status.priority,
        resource_pool_status.runtime_priority,
        resource_pool_status.runtime_priority_threshold,
        resource_pool_status.single_initiator,
        resource_pool_status.query_budget_kb,
        resource_pool_status.cpu_affinity_set,
        resource_pool_status.cpu_affinity_mask,
        resource_pool_status.cpu_affinity_mode
 FROM v_monitor.resource_pool_status;

CREATE  VIEW sys_catalog.projection_storage AS
 SELECT projection_storage.node_name,
        projection_storage.projection_id,
        projection_storage.projection_name,
        projection_storage.projection_schema,
        projection_storage.projection_column_count,
        projection_storage.row_count,
        projection_storage.used_bytes,
        projection_storage.wos_row_count,
        projection_storage.wos_used_bytes,
        projection_storage.ros_row_count,
        projection_storage.ros_used_bytes,
        projection_storage.ros_count,
        projection_storage.anchor_table_name,
        projection_storage.anchor_table_schema,
        projection_storage.anchor_table_id
 FROM v_monitor.projection_storage;

CREATE  VIEW sys_catalog.projection_usage AS
 SELECT projection_usage.query_start_timestamp,
        projection_usage.node_name,
        projection_usage.user_name,
        projection_usage.session_id,
        projection_usage.request_id,
        projection_usage.transaction_id,
        projection_usage.statement_id,
        projection_usage.io_type,
        projection_usage.projection_id,
        projection_usage.projection_name,
        projection_usage.anchor_table_id,
        projection_usage.anchor_table_schema,
        projection_usage.anchor_table_name
 FROM v_monitor.projection_usage;

CREATE  VIEW outbound.zs_ddd_weekly AS
 SELECT ddd.outlet_code,
        ddd.outlet_name,
        ddd.outlet_zip,
        ddd.report_frequency,
        ddd.basket_id,
        ddd.basket_name,
        ddd.data_date,
        ddd.date,
        ddd.rollup_week,
        ddd.rollup_month,
        ddd.comp_month,
        ddd.quantity,
        ddd.market_name,
        ddd.outlet_tvcmid,
        ddd.sales_force_id,
        ddd.category_code,
        ddd.rollup_flag,
        ddd.basket_type,
        ddd.rollup_445_month,
        ddd.dollars,
        ddd.COUNT AS count,
        ddd.subcategory_code
 FROM datamart.ddd
 WHERE (ddd.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5)))
 GROUP BY ddd.outlet_code,
          ddd.outlet_name,
          ddd.outlet_zip,
          ddd.report_frequency,
          ddd.basket_id,
          ddd.basket_name,
          ddd.data_date,
          ddd.date,
          ddd.rollup_week,
          ddd.rollup_month,
          ddd.comp_month,
          ddd.quantity,
          ddd.market_name,
          ddd.outlet_tvcmid,
          ddd.sales_force_id,
          ddd.category_code,
          ddd.rollup_flag,
          ddd.basket_type,
          ddd.rollup_445_month,
          ddd.dollars,
          ddd.COUNT,
          ddd.subcategory_code;

CREATE  VIEW outbound.ajovy_fia_monthly AS
 SELECT fia.basket_id,
        fia.basket_name,
        fia.claim_id,
        fia.patient_id,
        fia.sequence_number,
        fia.product_id,
        fia.fill_date,
        fia.claim_type,
        fia.reject_code,
        fia.days_supply,
        fia.quantity,
        fia.refill_code,
        fia.payer_plan_id,
        fia.opc_ask,
        fia.sec_payer_plan_id,
        fia.buy_down,
        fia.opc_paid,
        fia.prescriber_id,
        fia.sob,
        fia.sub_product_id,
        fia.sub_opc,
        fia.initial_claim_id,
        fia.prev_product_id,
        fia.daw_code,
        fia.wrt_date,
        fia.claim_status,
        fia.copay_card_flg,
        fia.zip_code,
        fia.ecoup_flag,
        fia.ecoup_offset_amt,
        fia.standard_copay,
        fia.standard_copay_yn,
        fia.market_id,
        fia.flexible_fld_1_char,
        fia.flexible_fld_2_char,
        fia.flexible_fld_3_char,
        fia.flexible_fld_4_char,
        fia.file_id,
        fia.record_id,
        fia.cbsa_code,
        fia.cbsa_description,
        fia.state_code,
        fia.payer_name,
        fia.plan_name,
        fia.pbm_name,
        fia.pbm_id,
        fia.method_of_payment,
        fia.model_type,
        fia.product_group,
        fia.product_group_id,
        fia.product_name,
        fia.generic_name,
        fia.brand_generic_flag,
        fia.product_form,
        fia.product_strength,
        fia.package_size,
        fia.manufacturer,
        fia.cmf10,
        fia.usc_code,
        fia.fia_market_desc,
        fia.reject_reason,
        fia.reject_group,
        fia.mpd_year,
        fia.mpd_eligibility_class,
        fia.deductible_start_date,
        fia.copay_start_date,
        fia.gap_start_date,
        fia.catastrophic_start_date,
        fia.mpd_panel_patient,
        fia.PROVIDER_TYPE,
        fia.IQVIA_RXER_ID,
        fia.PRIMARY_SPECIALTY_CODE,
        fia.PRIMARY_SPECIALTY_DESC,
        fia.FIRST_NAME,
        fia.LAST_NAME,
        fia.ORG_NM,
        fia.ADDRESS,
        fia.CITY,
        fia.PVR_ZIP_CODE,
        fia.PVR_STATE_CODE,
        fia.PHONE_NUMBER
 FROM datamart.fia fia
 WHERE ((fia.fill_date >= '2020-01-01'::date) AND (fia.basket_id IN ( SELECT source_product.entity_id
 FROM product.source_product
 WHERE (source_product.source_file_code = 'LK715'::varchar(5)))))
 GROUP BY fia.basket_id,
          fia.basket_name,
          fia.claim_id,
          fia.patient_id,
          fia.sequence_number,
          fia.product_id,
          fia.fill_date,
          fia.claim_type,
          fia.reject_code,
          fia.days_supply,
          fia.quantity,
          fia.refill_code,
          fia.payer_plan_id,
          fia.opc_ask,
          fia.sec_payer_plan_id,
          fia.buy_down,
          fia.opc_paid,
          fia.prescriber_id,
          fia.sob,
          fia.sub_product_id,
          fia.sub_opc,
          fia.initial_claim_id,
          fia.prev_product_id,
          fia.daw_code,
          fia.wrt_date,
          fia.claim_status,
          fia.copay_card_flg,
          fia.zip_code,
          fia.ecoup_flag,
          fia.ecoup_offset_amt,
          fia.standard_copay,
          fia.standard_copay_yn,
          fia.market_id,
          fia.flexible_fld_1_char,
          fia.flexible_fld_2_char,
          fia.flexible_fld_3_char,
          fia.flexible_fld_4_char,
          fia.file_id,
          fia.record_id,
          fia.cbsa_code,
          fia.cbsa_description,
          fia.state_code,
          fia.payer_name,
          fia.plan_name,
          fia.pbm_name,
          fia.pbm_id,
          fia.method_of_payment,
          fia.model_type,
          fia.product_group,
          fia.product_group_id,
          fia.product_name,
          fia.generic_name,
          fia.brand_generic_flag,
          fia.product_form,
          fia.product_strength,
          fia.package_size,
          fia.manufacturer,
          fia.cmf10,
          fia.usc_code,
          fia.fia_market_desc,
          fia.reject_reason,
          fia.reject_group,
          fia.mpd_year,
          fia.mpd_eligibility_class,
          fia.deductible_start_date,
          fia.copay_start_date,
          fia.gap_start_date,
          fia.catastrophic_start_date,
          fia.mpd_panel_patient,
          fia.PROVIDER_TYPE,
          fia.IQVIA_RXER_ID,
          fia.PRIMARY_SPECIALTY_CODE,
          fia.PRIMARY_SPECIALTY_DESC,
          fia.FIRST_NAME,
          fia.LAST_NAME,
          fia.ORG_NM,
          fia.ADDRESS,
          fia.CITY,
          fia.PVR_ZIP_CODE,
          fia.PVR_STATE_CODE,
          fia.PHONE_NUMBER;

CREATE  VIEW outbound.blink_call_key_messages AS
 SELECT call_key_messages.veeva_account_id,
        call_key_messages.tvcmid,
        call_key_messages.call_id,
        call_key_messages.call_record_type,
        call_key_messages.product,
        call_key_messages.key_message,
        call_key_messages.call_date,
        call_key_messages.duration,
        call_key_messages.display_order,
        call_key_messages.call_status,
        call_key_messages.territory,
        call_key_messages.call_type,
        call_key_messages.hcp_name
 FROM reporting.call_key_messages
 WHERE ((call_key_messages.product = ANY (ARRAY['Blink Health  AJOVY'::varchar(24), 'Blink Health  AUSTEDO'::varchar(24)])) AND (call_key_messages.call_date >= '2021-02-01'::date));

CREATE  VIEW outbound.cei_roster AS
 SELECT rep.employee_id AS UniqueIdentifier,
        mgr.employee_id AS ParentUniqueEmployeeId,
        ((mgr.first_name || ' '::varchar(1)) || mgr.last_name) AS ReportsToName,
        rep.team AS EmployeeOrganization,
        rep.last_name AS LastName,
        rep.first_name AS FirstName,
        rep.middle_name AS MiddleName,
        rep.suffix AS Generation,
        rep.preferred_name AS PreferredName,
        rep.hire_date AS HireDate,
        rep.address_line1 AS Address1,
        rep.address_line2 AS Address2,
        rep.address_line3 AS Address3,
        rep.city AS City,
        rep.state AS StateProvince,
        rep.zip AS ZipPostalCode,
        rep.home_phone AS HomePhone,
        rep.mobile_phone AS CellPhoneHome,
        rep.business_phone AS Workphone,
        rep.email AS EmailWork,
        coalesce(rep.hr_status, 'Active'::varchar(6)) AS Status,
        rep.territory_number AS TerrID,
        rep.territory_name AS TerrName,
        '1900-01-01 00:00:00'::varchar(19) AS TermDate
 FROM (datamart.roster rep LEFT  JOIN datamart.roster mgr ON ((rep.supervisor_global_employee_id = mgr.global_employee_id)))
 WHERE ((rep.employee_id IS NOT NULL) AND (rep.sales_force_id = ANY (ARRAY['TM'::varchar(2), 'MA'::varchar(2), 'TE'::varchar(2), 'TS'::varchar(2), 'TR'::varchar(2), 'TO'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) AND (rep.fleet_eligible = 'Y'::varchar(1)));

CREATE  VIEW outbound.zs_wholesaler_sales_867_monthly AS
 SELECT wholesaler_sales_867.basket_id,
        wholesaler_sales_867.basket_name,
        wholesaler_sales_867.ndc,
        wholesaler_sales_867.product_description,
        wholesaler_sales_867.product_name,
        wholesaler_sales_867.trading_partner_name,
        wholesaler_sales_867.trading_partner_dea,
        wholesaler_sales_867.trading_partner_hin,
        wholesaler_sales_867.trading_partner_location_type,
        wholesaler_sales_867.trading_partner_dc_dea,
        wholesaler_sales_867.trading_partner_dc_hin,
        wholesaler_sales_867.trading_partner_dc_name,
        wholesaler_sales_867.trading_partner_dc_address,
        wholesaler_sales_867.trading_partner_dc_address_2,
        wholesaler_sales_867.trading_partner_dc_city,
        wholesaler_sales_867.trading_partner_dc_state,
        wholesaler_sales_867.trading_partner_dc_zip,
        wholesaler_sales_867.class_of_trade,
        wholesaler_sales_867.outlet_location_name,
        wholesaler_sales_867.outlet_dea,
        wholesaler_sales_867.outlet_hin,
        wholesaler_sales_867.outlet_340b,
        wholesaler_sales_867.outlet_ncpdp,
        wholesaler_sales_867.outlet_npi,
        wholesaler_sales_867.outlet_location_address,
        wholesaler_sales_867.outlet_location_address_2,
        wholesaler_sales_867.outlet_location_city,
        wholesaler_sales_867.outlet_location_state,
        wholesaler_sales_867.outlet_location_zip,
        wholesaler_sales_867.reporting_date,
        wholesaler_sales_867.rollup_reporting_month,
        wholesaler_sales_867.rollup_reporting_quarter,
        wholesaler_sales_867.contract_number,
        wholesaler_sales_867.contract_description,
        wholesaler_sales_867.invoice_number,
        wholesaler_sales_867.invoice_date,
        wholesaler_sales_867.invoice_line_id,
        wholesaler_sales_867.quanitity_stock_sales_ss,
        wholesaler_sales_867.ds_sales_ds,
        wholesaler_sales_867.summary_sales_su,
        wholesaler_sales_867.dock_to_dock_bq,
        wholesaler_sales_867.interbranch_ib,
        wholesaler_sales_867.return_to_useable_ru,
        wholesaler_sales_867.return_to_vendor_rv,
        wholesaler_sales_867.transfer_to_disposal_td,
        wholesaler_sales_867.adjusted_price,
        wholesaler_sales_867.gross_amount,
        wholesaler_sales_867.trx_count_normalized
 FROM datamart.wholesaler_sales_867
 WHERE (wholesaler_sales_867.reporting_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5)))
 GROUP BY wholesaler_sales_867.basket_id,
          wholesaler_sales_867.basket_name,
          wholesaler_sales_867.ndc,
          wholesaler_sales_867.product_description,
          wholesaler_sales_867.product_name,
          wholesaler_sales_867.trading_partner_name,
          wholesaler_sales_867.trading_partner_dea,
          wholesaler_sales_867.trading_partner_hin,
          wholesaler_sales_867.trading_partner_location_type,
          wholesaler_sales_867.trading_partner_dc_dea,
          wholesaler_sales_867.trading_partner_dc_hin,
          wholesaler_sales_867.trading_partner_dc_name,
          wholesaler_sales_867.trading_partner_dc_address,
          wholesaler_sales_867.trading_partner_dc_address_2,
          wholesaler_sales_867.trading_partner_dc_city,
          wholesaler_sales_867.trading_partner_dc_state,
          wholesaler_sales_867.trading_partner_dc_zip,
          wholesaler_sales_867.class_of_trade,
          wholesaler_sales_867.outlet_location_name,
          wholesaler_sales_867.outlet_dea,
          wholesaler_sales_867.outlet_hin,
          wholesaler_sales_867.outlet_340b,
          wholesaler_sales_867.outlet_ncpdp,
          wholesaler_sales_867.outlet_npi,
          wholesaler_sales_867.outlet_location_address,
          wholesaler_sales_867.outlet_location_address_2,
          wholesaler_sales_867.outlet_location_city,
          wholesaler_sales_867.outlet_location_state,
          wholesaler_sales_867.outlet_location_zip,
          wholesaler_sales_867.reporting_date,
          wholesaler_sales_867.rollup_reporting_month,
          wholesaler_sales_867.rollup_reporting_quarter,
          wholesaler_sales_867.contract_number,
          wholesaler_sales_867.contract_description,
          wholesaler_sales_867.invoice_number,
          wholesaler_sales_867.invoice_date,
          wholesaler_sales_867.invoice_line_id,
          wholesaler_sales_867.quanitity_stock_sales_ss,
          wholesaler_sales_867.ds_sales_ds,
          wholesaler_sales_867.summary_sales_su,
          wholesaler_sales_867.dock_to_dock_bq,
          wholesaler_sales_867.interbranch_ib,
          wholesaler_sales_867.return_to_useable_ru,
          wholesaler_sales_867.return_to_vendor_rv,
          wholesaler_sales_867.transfer_to_disposal_td,
          wholesaler_sales_867.adjusted_price,
          wholesaler_sales_867.gross_amount,
          wholesaler_sales_867.trx_count_normalized;

CREATE  VIEW outbound.ajovy_fia_adhoc_qtrly AS
 SELECT fia.basket_id,
        fia.basket_name,
        fia.claim_id,
        fia.patient_id,
        fia.sequence_number,
        fia.product_id,
        fia.fill_date,
        fia.claim_type,
        fia.reject_code,
        fia.days_supply,
        fia.quantity,
        fia.refill_code,
        fia.payer_plan_id,
        fia.opc_ask,
        fia.sec_payer_plan_id,
        fia.buy_down,
        fia.opc_paid,
        fia.prescriber_id,
        fia.sob,
        fia.sub_product_id,
        fia.sub_opc,
        fia.initial_claim_id,
        fia.prev_product_id,
        fia.daw_code,
        fia.wrt_date,
        fia.claim_status,
        fia.copay_card_flg,
        fia.zip_code,
        fia.ecoup_flag,
        fia.ecoup_offset_amt,
        fia.standard_copay,
        fia.standard_copay_yn,
        fia.market_id,
        fia.flexible_fld_1_char,
        fia.flexible_fld_2_char,
        fia.flexible_fld_3_char,
        fia.flexible_fld_4_char,
        fia.file_id,
        fia.record_id,
        fia.cbsa_code,
        fia.cbsa_description,
        fia.state_code,
        fia.payer_name,
        fia.plan_name,
        fia.pbm_name,
        fia.pbm_id,
        fia.method_of_payment,
        fia.model_type,
        fia.product_group,
        fia.product_group_id,
        fia.product_name,
        fia.generic_name,
        fia.brand_generic_flag,
        fia.product_form,
        fia.product_strength,
        fia.package_size,
        fia.manufacturer,
        fia.cmf10,
        fia.usc_code,
        fia.fia_market_desc,
        fia.reject_reason,
        fia.reject_group,
        fia.mpd_year,
        fia.mpd_eligibility_class,
        fia.deductible_start_date,
        fia.copay_start_date,
        fia.gap_start_date,
        fia.catastrophic_start_date,
        fia.mpd_panel_patient,
        fia.PROVIDER_TYPE,
        fia.IQVIA_RXER_ID,
        fia.PRIMARY_SPECIALTY_CODE,
        fia.PRIMARY_SPECIALTY_DESC,
        fia.FIRST_NAME,
        fia.LAST_NAME,
        fia.ORG_NM,
        fia.ADDRESS,
        fia.CITY,
        fia.PVR_ZIP_CODE,
        fia.PVR_STATE_CODE,
        fia.PHONE_NUMBER
 FROM datamart.fia_adhoc fia
 WHERE ((fia.fill_date >= '2020-01-01'::date) AND (fia.basket_id IN ( SELECT source_product.entity_id
 FROM product.source_product
 WHERE (source_product.source_file_code = 'A67.F12176'::varchar(10)))))
 GROUP BY fia.basket_id,
          fia.basket_name,
          fia.claim_id,
          fia.patient_id,
          fia.sequence_number,
          fia.product_id,
          fia.fill_date,
          fia.claim_type,
          fia.reject_code,
          fia.days_supply,
          fia.quantity,
          fia.refill_code,
          fia.payer_plan_id,
          fia.opc_ask,
          fia.sec_payer_plan_id,
          fia.buy_down,
          fia.opc_paid,
          fia.prescriber_id,
          fia.sob,
          fia.sub_product_id,
          fia.sub_opc,
          fia.initial_claim_id,
          fia.prev_product_id,
          fia.daw_code,
          fia.wrt_date,
          fia.claim_status,
          fia.copay_card_flg,
          fia.zip_code,
          fia.ecoup_flag,
          fia.ecoup_offset_amt,
          fia.standard_copay,
          fia.standard_copay_yn,
          fia.market_id,
          fia.flexible_fld_1_char,
          fia.flexible_fld_2_char,
          fia.flexible_fld_3_char,
          fia.flexible_fld_4_char,
          fia.file_id,
          fia.record_id,
          fia.cbsa_code,
          fia.cbsa_description,
          fia.state_code,
          fia.payer_name,
          fia.plan_name,
          fia.pbm_name,
          fia.pbm_id,
          fia.method_of_payment,
          fia.model_type,
          fia.product_group,
          fia.product_group_id,
          fia.product_name,
          fia.generic_name,
          fia.brand_generic_flag,
          fia.product_form,
          fia.product_strength,
          fia.package_size,
          fia.manufacturer,
          fia.cmf10,
          fia.usc_code,
          fia.fia_market_desc,
          fia.reject_reason,
          fia.reject_group,
          fia.mpd_year,
          fia.mpd_eligibility_class,
          fia.deductible_start_date,
          fia.copay_start_date,
          fia.gap_start_date,
          fia.catastrophic_start_date,
          fia.mpd_panel_patient,
          fia.PROVIDER_TYPE,
          fia.IQVIA_RXER_ID,
          fia.PRIMARY_SPECIALTY_CODE,
          fia.PRIMARY_SPECIALTY_DESC,
          fia.FIRST_NAME,
          fia.LAST_NAME,
          fia.ORG_NM,
          fia.ADDRESS,
          fia.CITY,
          fia.PVR_ZIP_CODE,
          fia.PVR_STATE_CODE,
          fia.PHONE_NUMBER;

CREATE  VIEW teva_ingestion.EXT_ZS_TEVA_PAYER_MASTER_DETALS AS
 SELECT btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.plan_code) AS plan_code,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.plan_name) AS plan_name,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.payer_name) AS payer_name,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.pbm) AS pbm,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.payment_type) AS payment_type,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.key_controlling_account) AS key_controlling_account,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.ajovy_access_for_ftf_plan) AS ajovy_access_for_ftf_plan,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.aimovig_access_for_ftf_plan) AS aimovig_access_for_ftf_plan,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.emgality_access_for_ftf_plan) AS emgality_access_for_ftf_plan,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.apportionment_factor) AS apportionment_factor,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.key_controlling_parent) AS key_controlling_parent,
        btrim(EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.pbm_payer_filter) AS pbm_payer_filter,
        EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.batch_id,
        EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.row_id,
        EXT_ZS_TEVA_PAYER_MASTER_DETALS_src.update_ts
 FROM teva_ingestion.EXT_ZS_TEVA_PAYER_MASTER_DETALS_src;

CREATE  VIEW raw.EXT_ZS_TEVA_PAYER_MASTER_DETALS AS
 SELECT src.plan_code,
        src.plan_name,
        src.payer_name,
        src.pbm,
        src.payment_type,
        src.key_controlling_plan_formulary,
        src.key_controlling_account,
        src.ajovy_access_for_ftf_plan,
        src.aimovig_access_for_ftf_plan,
        src.emgality_access_for_ftf_plan,
        src.apportionment_factor,
        src.key_controlling_parent,
        src.pbm_payer_filter,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_TEVA_PAYER_MASTER_DETALS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_TEVA_PAYER_MASTER_DETALS'::varchar(31)))));

CREATE  VIEW teva_ingestion.EXT_ZS_TEVA_PAYER_WRKBK AS
 SELECT btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.plan_code) AS plan_code,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Final_Key_Controlling_Account) AS Final_Key_Controlling_Account,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Key_Parent_Account) AS Key_Parent_Account,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.PBM) AS PBM,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Payer) AS Payer,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Plan) AS Plan,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.State_Code) AS State_Code,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.AJOVY_TRx) AS AJOVY_TRx,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Aimovig_TRx) AS Aimovig_TRx,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Emgality_TRx) AS Emgality_TRx,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.aCGRP_TRx) AS aCGRP_TRx,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.AJOVY_Share_Percent) AS AJOVY_Share_Percent,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Aimovig_Share_Percent) AS Aimovig_Share_Percent,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Emgality_Share_Percent) AS Emgality_Share_Percent,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Latest_Mth_AJOVY_TRx) AS Latest_Mth_AJOVY_TRx,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Latest_Mth_AJOVY_Share_Percent) AS Latest_Mth_AJOVY_Share_Percent,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Lives_Covered_Total) AS Lives_Covered_Total,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Ajovy_Formulary_Status) AS Ajovy_Formulary_Status,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Aimovig_Formulary_Status) AS Aimovig_Formulary_Status,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Emgality_Formulary_Status) AS Emgality_Formulary_Status,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Plan_Payment_Type) AS Plan_Payment_Type,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Priority_Account_flag) AS Priority_Account_flag,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Justification) AS Justification,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.Plan_Mapping) AS Plan_Mapping,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.key_controlling_parent) AS key_controlling_parent,
        btrim(EXT_ZS_TEVA_PAYER_WRKBK_src.pbm_payer_filter) AS pbm_payer_filter,
        EXT_ZS_TEVA_PAYER_WRKBK_src.batch_id,
        EXT_ZS_TEVA_PAYER_WRKBK_src.row_id,
        EXT_ZS_TEVA_PAYER_WRKBK_src.update_ts
 FROM teva_ingestion.EXT_ZS_TEVA_PAYER_WRKBK_src;

CREATE  VIEW raw.EXT_ZS_TEVA_PAYER_WRKBK AS
 SELECT src.plan_code,
        src.Final_Key_Controlling_Account,
        src.Key_Parent_Account,
        src.PBM,
        src.Payer,
        src.Plan,
        src.State_Code,
        src.AJOVY_TRx,
        src.Aimovig_TRx,
        src.Emgality_TRx,
        src.aCGRP_TRx,
        src.AJOVY_Share_Percent,
        src.Aimovig_Share_Percent,
        src.Emgality_Share_Percent,
        src.Latest_Mth_AJOVY_TRx,
        src.Latest_Mth_AJOVY_Share_Percent,
        src.Lives_Covered_Total,
        src.Ajovy_Formulary_Status,
        src.Aimovig_Formulary_Status,
        src.Emgality_Formulary_Status,
        src.Plan_Payment_Type,
        src.Priority_Account_flag,
        src.Justification,
        src.Plan_Mapping,
        src.key_controlling_parent,
        src.pbm_payer_filter,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_TEVA_PAYER_WRKBK_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_TEVA_PAYER_WRKBK'::varchar(23)))));

CREATE  VIEW sandbox.test_view AS
 SELECT ftf_restrictions.health_plan_id,
        ftf_restrictions.drug_id,
        ftf_restrictions.restriction_detail_id,
        ftf_restrictions.restriction_code,
        ftf_restrictions.formulary_entry_restriction_id,
        ftf_restrictions.restriction_detail_text,
        ftf_restrictions.restriction_addtnl_information_1,
        ftf_restrictions.restriction_addtnl_information_2,
        ftf_restrictions.record_id,
        ftf_restrictions.file_id
 FROM cleansed.ftf_restrictions
 WHERE (ftf_restrictions.file_id IN ( SELECT max(ftf_restrictions.file_id) AS max
 FROM cleansed.ftf_restrictions));

CREATE  VIEW sandbox.vw_ftf_formularies AS
 SELECT ftf_formularies.health_plan_id,
        ftf_formularies.drug_id,
        ftf_formularies.tier_code,
        ftf_formularies.restrictions,
        ftf_formularies.reason_code,
        ftf_formularies.reason_code_description,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW outbound.zs_call_plan AS
 SELECT cp.sales_force_id,
        cp.period,
        cp.veeva_account_id,
        cp.ims_id,
        cp.tvcmid,
        cp.first_name,
        cp.last_name,
        cp.specialty,
        cp.area_number,
        cp.region_number,
        cp.territory_number,
        cp.basket_id,
        cp.basket_name,
        cp.p1,
        cp.p2,
        cp.p3
 FROM (datamart.call_plan cp JOIN reference.call_plan_active_dates dt ON (((dt.period = cp.period) AND (dt.sales_force_id = cp.sales_force_id) AND ((statement_timestamp())::timestamp >= dt.start_date) AND ((statement_timestamp())::timestamp <= dt.end_date) AND (dt.include_in_alternates = 'Y'::varchar(1)))))
 GROUP BY cp.sales_force_id,
          cp.period,
          cp.veeva_account_id,
          cp.ims_id,
          cp.tvcmid,
          cp.first_name,
          cp.last_name,
          cp.specialty,
          cp.area_number,
          cp.region_number,
          cp.territory_number,
          cp.basket_id,
          cp.basket_name,
          cp.p1,
          cp.p2,
          cp.p3;

CREATE  VIEW outbound.Syneos_call_acitivty AS
 SELECT sc.sales_force_id,
        sc.veeva_account_id,
        sc.call_id,
        scd.basket_name,
        scd.detail_position,
        sc.tvcmid,
        sc.ims_id,
        sc.ims_outlet_id,
        sc.customer_type,
        sc.first_name,
        sc.last_name,
        sc.call_type,
        sc.rep_first_name,
        sc.rep_last_name,
        sc.territory_number,
        sc.zip_on_call,
        sc.call_date,
        sc.submit_date,
        sc.attendees,
        sc.attendee_type,
        sc.area_number,
        sc.region_number,
        sc.call_recordtype,
        sc.call_duration,
        sc.call_datetime,
        sc.how_executed
 FROM datamart.sfa_call_detail scd, datamart.sfa_call sc
 WHERE ((scd.call_id = sc.call_id) AND (scd.sales_force_id = sc.sales_force_id) AND (scd.basket_name = ANY (ARRAY['CINQAIR'::varchar(18), 'PROAIR DIGIHALER'::varchar(18), 'AIRDUO DIGIHALER'::varchar(18), 'ARMONAIR DIGIHALER'::varchar(18)])) AND (sc.territory_number IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE (((roster.employee_id ~~* '%CWKU%'::varchar(6)) OR (roster.employee_id = ANY (ARRAY['A061823'::varchar(7), 'A805771'::varchar(7)])) OR (roster.employee_id = ANY (ARRAY['061823'::varchar(6), '805771'::varchar(6)]))) AND (roster.sales_force_id = 'TR'::varchar(2))))) AND (sc.call_date > '2019-12-31'::date))
 GROUP BY sc.sales_force_id,
          sc.veeva_account_id,
          sc.call_id,
          scd.basket_name,
          scd.detail_position,
          sc.tvcmid,
          sc.ims_id,
          sc.ims_outlet_id,
          sc.customer_type,
          sc.first_name,
          sc.last_name,
          sc.call_type,
          sc.rep_first_name,
          sc.rep_last_name,
          sc.territory_number,
          sc.zip_on_call,
          sc.call_date,
          sc.submit_date,
          sc.attendees,
          sc.attendee_type,
          sc.area_number,
          sc.region_number,
          sc.call_recordtype,
          sc.call_duration,
          sc.call_datetime,
          sc.how_executed;

CREATE  VIEW outbound.Syneos_Digihaler_rx AS
 SELECT demo.sales_force_id,
        ca.territory_number,
        rx.ims_id,
        rx.tvcmid,
        rx.data_date,
        rx.date,
        rx.basket_name,
        rx.prescriber_first_name,
        rx.prescriber_last_name,
        demo.ptr_address_1,
        demo.ptr_address_2,
        demo.ptr_city,
        demo.ptr_state,
        demo.ptr_zip,
        rx.nrx_count,
        rx.trx_count,
        rx.nrx_quantity,
        rx.trx_quantity,
        rx.ims_specialty
 FROM datamart.prescriber_rx rx, datamart.prescriber_combined_demo_frozen demo, datamart.current_alignment ca
 WHERE ((demo.ptr_zip = ca.zip_code) AND (rx.ims_id = demo.ims_id) AND (demo.sales_force_id = ca.sales_force_id) AND (ca.territory_number IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE (((roster.employee_id ~~* '%CWKU%'::varchar(6)) OR (roster.employee_id = ANY (ARRAY['A061823'::varchar(7), 'A805771'::varchar(7)])) OR (roster.employee_id = ANY (ARRAY['061823'::varchar(6), '805771'::varchar(6)]))) AND (roster.sales_force_id = 'TR'::varchar(2))))) AND (rx.basket_name ~~* '%digihaler%'::varchar(11)) AND (rx.rollup_month > '2019-12-31'::date))
 GROUP BY demo.sales_force_id,
          ca.territory_number,
          rx.ims_id,
          rx.tvcmid,
          rx.data_date,
          rx.date,
          rx.basket_name,
          rx.prescriber_first_name,
          rx.prescriber_last_name,
          demo.ptr_address_1,
          demo.ptr_address_2,
          demo.ptr_city,
          demo.ptr_state,
          demo.ptr_zip,
          rx.nrx_count,
          rx.trx_count,
          rx.nrx_quantity,
          rx.trx_quantity,
          rx.ims_specialty;

CREATE  VIEW outbound.Syneos_Cinqair_dddmd AS
 SELECT ca.sales_force_id,
        ca.territory_number,
        dddmd.onc_account_demo_id,
        dddmd.outlet_name,
        demo.outlet_address,
        demo.outlet_city,
        demo.outlet_state,
        demo.outlet_zip,
        dddmd.outlet_code,
        dddmd.tvcmid,
        dddmd.subcategory_code,
        dddmd.basket_name,
        dddmd.data_date,
        dddmd.date,
        dddmd.rollup_month,
        dddmd.quantity,
        dddmd.dollars
 FROM datamart.ddd_md dddmd, datamart.dddmd_demographics demo, datamart.alternate_alignments ca
 WHERE ((demo.outlet_zip = ca.zip_code) AND (dddmd.outlet_code = demo.outlet_code) AND (ca.territory_number IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE (((roster.employee_id ~~* '%CWKU%'::varchar(6)) OR (roster.employee_id = ANY (ARRAY['A061823'::varchar(7), 'A805771'::varchar(7)])) OR (roster.employee_id = ANY (ARRAY['061823'::varchar(6), '805771'::varchar(6)]))) AND (roster.sales_force_id = 'TR'::varchar(2))))) AND (dddmd.basket_name ~~* '%CINQ%'::varchar(6)) AND (dddmd.rollup_month > '2019-12-31'::date))
 GROUP BY ca.sales_force_id,
          ca.territory_number,
          dddmd.onc_account_demo_id,
          dddmd.outlet_name,
          demo.outlet_address,
          demo.outlet_city,
          demo.outlet_state,
          demo.outlet_zip,
          dddmd.outlet_code,
          dddmd.tvcmid,
          dddmd.subcategory_code,
          dddmd.basket_name,
          dddmd.data_date,
          dddmd.date,
          dddmd.rollup_month,
          dddmd.quantity,
          dddmd.dollars;

CREATE  VIEW outbound.Syneos_digihaler_targets AS
 SELECT pcd.ims_id,
        fl.tvcmid,
        NULL AS basket_id,
        NULL AS basket_name,
        fl.territory_number,
        fl.sales_force_id,
        fl.flag_type,
        fl.flag_value,
        fl.flag_effective_start_date,
        fl.flag_effective_end_date,
        pcd.veeva_account_id,
        pcd.specialty
 FROM (datamart.customer_level_flags fl LEFT  JOIN datamart.prescriber_combined_demographics pcd ON ((fl.tvcmid = pcd.tvcmid)))
 WHERE ((fl.territory_number IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE (((roster.employee_id ~~* '%CWKU%'::varchar(6)) OR (roster.employee_id = ANY (ARRAY['A061823'::varchar(7), 'A805771'::varchar(7)])) OR (roster.employee_id = ANY (ARRAY['061823'::varchar(6), '805771'::varchar(6)]))) AND (roster.sales_force_id = 'TR'::varchar(2))))) AND (fl.basket_name ~~* '%DIGIHALER'::varchar(10)) AND ((statement_timestamp())::timestamp >= fl.flag_effective_start_date) AND ((statement_timestamp())::timestamp <= fl.flag_effective_end_date))
 GROUP BY pcd.ims_id,
          fl.tvcmid,
          NULL,
          fl.territory_number,
          fl.sales_force_id,
          fl.flag_type,
          fl.flag_value,
          fl.flag_effective_start_date,
          fl.flag_effective_end_date,
          pcd.veeva_account_id,
          pcd.specialty
 ORDER BY fl.territory_number,
          pcd.ims_id;

CREATE  VIEW teva_ingestion.EXT_VV_ACCOUNT AS
 SELECT btrim(EXT_VV_ACCOUNT_src.ID) AS ID,
        btrim(EXT_VV_ACCOUNT_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_ACCOUNT_src.MASTERRECORDID) AS MASTERRECORDID,
        btrim(EXT_VV_ACCOUNT_src.NAME) AS NAME,
        btrim(EXT_VV_ACCOUNT_src.LASTNAME) AS LASTNAME,
        btrim(EXT_VV_ACCOUNT_src.FIRSTNAME) AS FIRSTNAME,
        btrim(EXT_VV_ACCOUNT_src.SALUTATION) AS SALUTATION,
        btrim(EXT_VV_ACCOUNT_src.TYPE) AS TYPE,
        btrim(EXT_VV_ACCOUNT_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_ACCOUNT_src.PHONE) AS PHONE,
        btrim(EXT_VV_ACCOUNT_src.FAX) AS FAX,
        btrim(EXT_VV_ACCOUNT_src.WEBSITE) AS WEBSITE,
        CASE WHEN (EXT_VV_ACCOUNT_src.NUMBEROFEMPLOYEES = ''::varchar) THEN NULL::numeric(8,0) ELSE (btrim(EXT_VV_ACCOUNT_src.NUMBEROFEMPLOYEES))::numeric(8,0) END AS NUMBEROFEMPLOYEES,
        btrim(EXT_VV_ACCOUNT_src.OWNERSHIP) AS OWNERSHIP,
        btrim(EXT_VV_ACCOUNT_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_ACCOUNT_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_ACCOUNT_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_ACCOUNT_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_ACCOUNT_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_ACCOUNT_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_ACCOUNT_src.LASTACTIVITYDATE) AS LASTACTIVITYDATE,
        btrim(EXT_VV_ACCOUNT_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_ACCOUNT_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_ACCOUNT_src.LASTVIEWEDDATE) AS LASTVIEWEDDATE,
        btrim(EXT_VV_ACCOUNT_src.LASTREFERENCEDDATE) AS LASTREFERENCEDDATE,
        btrim(EXT_VV_ACCOUNT_src.ISEXCLUDEDFROMREALIGN) AS ISEXCLUDEDFROMREALIGN,
        btrim(EXT_VV_ACCOUNT_src.PERSONCONTACTID) AS PERSONCONTACTID,
        btrim(EXT_VV_ACCOUNT_src.ISPERSONACCOUNT) AS ISPERSONACCOUNT,
        btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGSTREET) AS PERSONMAILINGSTREET,
        btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGCITY) AS PERSONMAILINGCITY,
        btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGSTATE) AS PERSONMAILINGSTATE,
        btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGPOSTALCODE) AS PERSONMAILINGPOSTALCODE,
        btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGCOUNTRY) AS PERSONMAILINGCOUNTRY,
        CASE WHEN (EXT_VV_ACCOUNT_src.PERSONMAILINGLATITUDE = ''::varchar) THEN NULL::numeric(18,15) ELSE (btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGLATITUDE))::numeric(18,15) END AS PERSONMAILINGLATITUDE,
        CASE WHEN (EXT_VV_ACCOUNT_src.PERSONMAILINGLONGITUDE = ''::varchar) THEN NULL::numeric(18,15) ELSE (btrim(EXT_VV_ACCOUNT_src.PERSONMAILINGLONGITUDE))::numeric(18,15) END AS PERSONMAILINGLONGITUDE,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERSTREET) AS PERSONOTHERSTREET,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERCITY) AS PERSONOTHERCITY,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERSTATE) AS PERSONOTHERSTATE,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERPOSTALCODE) AS PERSONOTHERPOSTALCODE,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERCOUNTRY) AS PERSONOTHERCOUNTRY,
        CASE WHEN (EXT_VV_ACCOUNT_src.PERSONOTHERLATITUDE = ''::varchar) THEN NULL::numeric(18,15) ELSE (btrim(EXT_VV_ACCOUNT_src.PERSONOTHERLATITUDE))::numeric(18,15) END AS PERSONOTHERLATITUDE,
        CASE WHEN (EXT_VV_ACCOUNT_src.PERSONOTHERLONGITUDE = ''::varchar) THEN NULL::numeric(18,15) ELSE (btrim(EXT_VV_ACCOUNT_src.PERSONOTHERLONGITUDE))::numeric(18,15) END AS PERSONOTHERLONGITUDE,
        btrim(EXT_VV_ACCOUNT_src.PERSONMOBILEPHONE) AS PERSONMOBILEPHONE,
        btrim(EXT_VV_ACCOUNT_src.PERSONHOMEPHONE) AS PERSONHOMEPHONE,
        btrim(EXT_VV_ACCOUNT_src.PERSONOTHERPHONE) AS PERSONOTHERPHONE,
        btrim(EXT_VV_ACCOUNT_src.PERSONASSISTANTPHONE) AS PERSONASSISTANTPHONE,
        btrim(EXT_VV_ACCOUNT_src.PERSONEMAIL) AS PERSONEMAIL,
        btrim(EXT_VV_ACCOUNT_src.PERSONTITLE) AS PERSONTITLE,
        btrim(EXT_VV_ACCOUNT_src.PERSONDEPARTMENT) AS PERSONDEPARTMENT,
        btrim(EXT_VV_ACCOUNT_src.PERSONASSISTANTNAME) AS PERSONASSISTANTNAME,
        btrim(EXT_VV_ACCOUNT_src.PERSONBIRTHDATE) AS PERSONBIRTHDATE,
        btrim(EXT_VV_ACCOUNT_src.PERSONHASOPTEDOUTOFEMAIL) AS PERSONHASOPTEDOUTOFEMAIL,
        btrim(EXT_VV_ACCOUNT_src.PERSONHASOPTEDOUTOFFAX) AS PERSONHASOPTEDOUTOFFAX,
        btrim(EXT_VV_ACCOUNT_src.PERSONDONOTCALL) AS PERSONDONOTCALL,
        btrim(EXT_VV_ACCOUNT_src.PERSONLASTCUREQUESTDATE) AS PERSONLASTCUREQUESTDATE,
        btrim(EXT_VV_ACCOUNT_src.PERSONLASTCUUPDATEDATE) AS PERSONLASTCUUPDATEDATE,
        btrim(EXT_VV_ACCOUNT_src.PERSONEMAILBOUNCEDREASON) AS PERSONEMAILBOUNCEDREASON,
        btrim(EXT_VV_ACCOUNT_src.PERSONEMAILBOUNCEDDATE) AS PERSONEMAILBOUNCEDDATE,
        btrim(EXT_VV_ACCOUNT_src.JIGSAW) AS JIGSAW,
        btrim(EXT_VV_ACCOUNT_src.JIGSAWCOMPANYID) AS JIGSAWCOMPANYID,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNTSOURCE) AS ACCOUNTSOURCE,
        btrim(EXT_VV_ACCOUNT_src.SICDESC) AS SICDESC,
        btrim(EXT_VV_ACCOUNT_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.CREDENTIALS_VOD__C) AS CREDENTIALS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.EXCLUDE_FROM_ZIP_TO_TERR_PROCE) AS EXCLUDE_FROM_ZIP_TO_TERR_PROCE,
        btrim(EXT_VV_ACCOUNT_src.GROUP_SPECIALTY_1_VOD__C) AS GROUP_SPECIALTY_1_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.GROUP_SPECIALTY_2_VOD__C) AS GROUP_SPECIALTY_2_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SPECIALTY_1_VOD__C) AS SPECIALTY_1_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SPECIALTY_2_VOD__C) AS SPECIALTY_2_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.FORMATTED_NAME_VOD__C) AS FORMATTED_NAME_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.TERRITORY_TEST_VOD__C) AS TERRITORY_TEST_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.GENDER_VOD__C) AS GENDER_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ID_VOD__C) AS ID_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.DO_NOT_SYNC_SALES_DATA_VOD__C) AS DO_NOT_SYNC_SALES_DATA_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ID2_VOD__C) AS ID2_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PREFERRED_NAME_VOD__C) AS PREFERRED_NAME_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SAMPLE_DEFAULT_VOD__C) AS SAMPLE_DEFAULT_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SEGMENTATIONS_VOD__C) AS SEGMENTATIONS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.RESTRICTED_PRODUCTS_VOD__C) AS RESTRICTED_PRODUCTS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PAYER_ID_VOD__C) AS PAYER_ID_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_STATUS_TVA__C) AS ACCOUNT_STATUS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.DO_NOT_CALL_VOD__C) AS DO_NOT_CALL_VOD__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.BEDS__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_ACCOUNT_src.BEDS__C))::numeric(4,0) END AS BEDS__C,
        btrim(EXT_VV_ACCOUNT_src.SPEND_AMOUNT__C) AS SPEND_AMOUNT__C,
        btrim(EXT_VV_ACCOUNT_src.PDRP_OPT_OUT_VOD__C) AS PDRP_OPT_OUT_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SPEND_STATUS_VALUE_VOD__C) AS SPEND_STATUS_VALUE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PDRP_OPT_OUT_DATE_VOD__C) AS PDRP_OPT_OUT_DATE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SPEND_STATUS_VOD__C) AS SPEND_STATUS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ENABLE_RESTRICTED_PRODUCTS) AS ENABLE_RESTRICTED_PRODUCTS,
        btrim(EXT_VV_ACCOUNT_src.CALL_REMINDER_VOD__C) AS CALL_REMINDER_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_GROUP_VOD__C) AS ACCOUNT_GROUP_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PRIMARY_PARENT_VOD__C) AS PRIMARY_PARENT_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.COLOR_VOD__C) AS COLOR_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.MIDDLE_VOD__C) AS MIDDLE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.SUFFIX_VOD__C) AS SUFFIX_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_LOCATION_TVA__C) AS ACCOUNT_LOCATION_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.NO_ORDERS_VOD__C) AS NO_ORDERS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_MASTER_ID_TVA__C) AS ACCOUNT_MASTER_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_EMAIL_TVA__C) AS ACCOUNT_EMAIL_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_SEARCH_FIRSTLAST) AS ACCOUNT_SEARCH_FIRSTLAST,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_SEARCH_LASTFIRST) AS ACCOUNT_SEARCH_LASTFIRST,
        btrim(EXT_VV_ACCOUNT_src.PERSON_PREFERRED_NAME_TVA__C) AS PERSON_PREFERRED_NAME_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PRACTICE_AT_HOSPITAL_VOD__C) AS PRACTICE_AT_HOSPITAL_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PRACTICE_NEAR_HOSPITAL_VOD__C) AS PRACTICE_NEAR_HOSPITAL_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.DO_NOT_CREATE_CHILD_ACCOUNT) AS DO_NOT_CREATE_CHILD_ACCOUNT,
        CASE WHEN (EXT_VV_ACCOUNT_src.TOTAL_MDS_DOS__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.TOTAL_MDS_DOS__C))::numeric(18,0) END AS TOTAL_MDS_DOS__C,
        btrim(EXT_VV_ACCOUNT_src.AHA__C) AS AHA__C,
        btrim(EXT_VV_ACCOUNT_src.ORDER_TYPE_VOD__C) AS ORDER_TYPE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.NPI_VOD__C) AS NPI_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ME__C) AS ME__C,
        btrim(EXT_VV_ACCOUNT_src.SPEAKER__C) AS SPEAKER__C,
        btrim(EXT_VV_ACCOUNT_src.INVESTIGATOR_VOD__C) AS INVESTIGATOR_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.DEFAULT_ORDER_TYPE_VOD__C) AS DEFAULT_ORDER_TYPE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.PERSON_DEGREE_TVA__C) AS PERSON_DEGREE_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TAX_STATUS__C) AS TAX_STATUS__C,
        btrim(EXT_VV_ACCOUNT_src.MODEL__C) AS MODEL__C,
        btrim(EXT_VV_ACCOUNT_src.OFFERINGS__C) AS OFFERINGS__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.DEPARTMENTS__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.DEPARTMENTS__C))::numeric(18,0) END AS DEPARTMENTS__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_TYPE__C) AS ACCOUNT_TYPE__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_SEARCH_BUSINESS_VOD__C) AS ACCOUNT_SEARCH_BUSINESS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.BUSINESS_PROFESSIONAL_PERSON) AS BUSINESS_PROFESSIONAL_PERSON,
        btrim(EXT_VV_ACCOUNT_src.NO_SPEND_TVA__C) AS NO_SPEND_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.HOSPITAL_TYPE_VOD__C) AS HOSPITAL_TYPE_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_CLASS_VOD__C) AS ACCOUNT_CLASS_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.FURIGANA_VOD__C) AS FURIGANA_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.TIRF_REMS_TVA__C) AS TIRF_REMS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.FENTORA_APP_TVA__C) AS FENTORA_APP_TVA__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.TOTAL_REVENUE_000__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.TOTAL_REVENUE_000__C))::numeric(18,0) END AS TOTAL_REVENUE_000__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.NET_INCOME_LOSS_000__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.NET_INCOME_LOSS_000__C))::numeric(18,0) END AS NET_INCOME_LOSS_000__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.PMPM_INCOME_LOSS_000__C = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_VV_ACCOUNT_src.PMPM_INCOME_LOSS_000__C))::numeric(12,2) END AS PMPM_INCOME_LOSS_000__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.COMMERCIAL_PREMIUMS_PMPM__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.COMMERCIAL_PREMIUMS_PMPM__C))::numeric(18,0) END AS COMMERCIAL_PREMIUMS_PMPM__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.MEDICAL_LOSS_RATIO__C = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_VV_ACCOUNT_src.MEDICAL_LOSS_RATIO__C))::numeric(12,2) END AS MEDICAL_LOSS_RATIO__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.MEDICAL_EXPENSES_PMPM__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.MEDICAL_EXPENSES_PMPM__C))::numeric(18,0) END AS MEDICAL_EXPENSES_PMPM__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.COMMERCIAL_PATIENT_DAYS_1000 = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.COMMERCIAL_PATIENT_DAYS_1000))::numeric(18,0) END AS COMMERCIAL_PATIENT_DAYS_1000,
        CASE WHEN (EXT_VV_ACCOUNT_src.HMO_MARKET_SHR__C = ''::varchar) THEN NULL::numeric(6,1) ELSE (btrim(EXT_VV_ACCOUNT_src.HMO_MARKET_SHR__C))::numeric(6,1) END AS HMO_MARKET_SHR__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.HMO__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.HMO__C))::numeric(18,0) END AS HMO__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.HMO_POS__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.HMO_POS__C))::numeric(18,0) END AS HMO_POS__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.PPO__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.PPO__C))::numeric(18,0) END AS PPO__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.PPO_POS__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.PPO_POS__C))::numeric(18,0) END AS PPO_POS__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.MEDICARE__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.MEDICARE__C))::numeric(18,0) END AS MEDICARE__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.MEDICAID__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.MEDICAID__C))::numeric(18,0) END AS MEDICAID__C,
        btrim(EXT_VV_ACCOUNT_src.NUVIGIL_APP_TVA__C) AS NUVIGIL_APP_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.MDS_STATUS_TVA__C) AS MDS_STATUS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.LIS_STATUS_TVA__C) AS LIS_STATUS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.DNC_PCS_TVA__C) AS DNC_PCS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.DNC_CNS_TVA__C) AS DNC_CNS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SUFFIX_TVA__C) AS SUFFIX_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TYSABRI_STATUS_TVA__C) AS TYSABRI_STATUS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.BUSINESS_DESCRIPTION__C) AS BUSINESS_DESCRIPTION__C,
        btrim(EXT_VV_ACCOUNT_src.REGIONAL_STRATEGY__C) AS REGIONAL_STRATEGY__C,
        btrim(EXT_VV_ACCOUNT_src.CONTRACTS_PROCESS__C) AS CONTRACTS_PROCESS__C,
        btrim(EXT_VV_ACCOUNT_src.CML_PROFILED_TVA__C) AS CML_PROFILED_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.CELL_PHONE_TVA__C) AS CELL_PHONE_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.NO_CONTACT_TVA__C) AS NO_CONTACT_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.OUTLET_ID_TVA__C) AS OUTLET_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PMO_GPO_ACCOUNT_AFFILIATIONS) AS PMO_GPO_ACCOUNT_AFFILIATIONS,
        btrim(EXT_VV_ACCOUNT_src.TERRITORY_STATUS_TVA__C) AS TERRITORY_STATUS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ZDEA_NUMBER_TVA__C) AS ZDEA_NUMBER_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.VEEVA_ID_TVA__C) AS VEEVA_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TREANDA_LQ_TGT_TVA__C) AS TREANDA_LQ_TGT_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TBO_FILGRASTIM_TARGET_TVA__C) AS TBO_FILGRASTIM_TARGET_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SLN_RESCRUB_TVA__C) AS SLN_RESCRUB_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_IDENTIFIER_VOD__C) AS ACCOUNT_IDENTIFIER_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.TARGET__C) AS TARGET__C,
        btrim(EXT_VV_ACCOUNT_src.KOL_VOD__C) AS KOL_VOD__C,
        btrim(EXT_VV_ACCOUNT_src.REMS_EXPIRATION_DATE_TEVA__C) AS REMS_EXPIRATION_DATE_TEVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_DEMO_ID_TVA__C) AS ACCOUNT_DEMO_ID_TVA__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.TOTAL_LIVES__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.TOTAL_LIVES__C))::numeric(18,0) END AS TOTAL_LIVES__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.TOTAL_PHYSICIANS_ENROLLED__C = ''::varchar) THEN NULL::numeric(18,0) ELSE (btrim(EXT_VV_ACCOUNT_src.TOTAL_PHYSICIANS_ENROLLED__C))::numeric(18,0) END AS TOTAL_PHYSICIANS_ENROLLED__C,
        btrim(EXT_VV_ACCOUNT_src.TIRF_REMS_EFF_DATE_TVA__C) AS TIRF_REMS_EFF_DATE_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.BUSINESS_ASSOCIATE_AGREEMENT) AS BUSINESS_ASSOCIATE_AGREEMENT,
        btrim(EXT_VV_ACCOUNT_src.DO_NOT_PROMOTE_TVA__C) AS DO_NOT_PROMOTE_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_DEA_TVA__C) AS ACCOUNT_DEA_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.BP_NUMBER__C) AS BP_NUMBER__C,
        btrim(EXT_VV_ACCOUNT_src.PARAGARD_SEGMENTATION_TVA__C) AS PARAGARD_SEGMENTATION_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TELESALES_ACTIVITY_TVA__C) AS TELESALES_ACTIVITY_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.DESIGNATION_TVA__C) AS DESIGNATION_TVA__C,
        CASE WHEN (EXT_VV_ACCOUNT_src.TOTAL_PHARMACISTS__C = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_VV_ACCOUNT_src.TOTAL_PHARMACISTS__C))::numeric(3,0) END AS TOTAL_PHARMACISTS__C,
        btrim(EXT_VV_ACCOUNT_src.COMP_PRICING_TVA__C) AS COMP_PRICING_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.FORMULARY_TVA__C) AS FORMULARY_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.GLN_TVA__C) AS GLN_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.GPO_CONTRACTS_TVA__C) AS GPO_CONTRACTS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.HIN_TVA__C) AS HIN_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.MAX_ID_TVA__C) AS MAX_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ONCOLOGY_SERVICES_TVA__C) AS ONCOLOGY_SERVICES_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PCP_PROGRAM_TVA__C) AS PCP_PROGRAM_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PHARMACY_LOCATION_TVA__C) AS PHARMACY_LOCATION_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PRIMARY_CREDENTIAL_TVA__C) AS PRIMARY_CREDENTIAL_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.PRIMARY_WHOLESALER_TVA__C) AS PRIMARY_WHOLESALER_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.REP_CREDENTIALING_TVA__C) AS REP_CREDENTIALING_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SECONDARY_CREDENTIAL_TVA__C) AS SECONDARY_CREDENTIAL_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SIGN_IN_LOCATION_TVA__C) AS SIGN_IN_LOCATION_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SPECIAL_TVA__C) AS SPECIAL_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SUB_TYPE_ID_TVA__C) AS SUB_TYPE_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.SUB_TYPE_TVA__C) AS SUB_TYPE_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TEVA_CONTRACTS_TVA__C) AS TEVA_CONTRACTS_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.IMS_ORG_ID_TVA__C) AS IMS_ORG_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.CM_ID_TVA__C) AS CM_ID_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.YEAR_OF_BIRTH_TVA__C) AS YEAR_OF_BIRTH_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.TEACHING_HOSPITAL_TVA__C) AS TEACHING_HOSPITAL_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.ACCOUNT_ARCHIVED_TVA__C) AS ACCOUNT_ARCHIVED_TVA__C,
        btrim(EXT_VV_ACCOUNT_src.MOBILE_ID_VOD__PC) AS MOBILE_ID_VOD__PC,
        btrim(EXT_VV_ACCOUNT_src.STAFF_EMAIL) AS STAFF_EMAIL,
        btrim(EXT_VV_ACCOUNT_src.COMPANY_MANAGED_EMAIL) AS COMPANY_MANAGED_EMAIL,
        btrim(EXT_VV_ACCOUNT_src.ALTERNATE_EMAIL) AS ALTERNATE_EMAIL,
        btrim(EXT_VV_ACCOUNT_src.ACCREDITATIONS_KAM__C) AS ACCREDITATIONS_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ADDL_SVCS_PATIENT_SVCS_OFFERING_KAM__C) AS ADDL_SVCS_PATIENT_SVCS_OFFERING_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ADDL_SERVICES_SALESFORCE_KAM__C) AS ADDL_SERVICES_SALESFORCE_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.AGGREGATION_GROUP_KAM__C) AS AGGREGATION_GROUP_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ALVIMOPAN_ANDA_KAM__C) AS ALVIMOPAN_ANDA_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ALVIMOPAN_BRAND_USAGE_KAM__C) AS ALVIMOPAN_BRAND_USAGE_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ALVIMOPAN_CONVERTED_KAM__C) AS ALVIMOPAN_CONVERTED_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ALVIMOPAN_REMS_KAM__C) AS ALVIMOPAN_REMS_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ALVIMOPAN_USAGE_KAM__C) AS ALVIMOPAN_USAGE_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ANDA_ACCOUNT_KAM__C) AS ANDA_ACCOUNT_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.GPO_IDN__C) AS GPO_IDN__C,
        btrim(EXT_VV_ACCOUNT_src.GPO_OAKAM__C) AS GPO_OAKAM__C,
        btrim(EXT_VV_ACCOUNT_src.GPO_AFFILIATIONS_KAM__C) AS GPO_AFFILIATIONS_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.HERZUMA_TARGET_KAM__C) AS HERZUMA_TARGET_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.IDN_KAM__C) AS IDN_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.IDN_SPECIALTY_PHARMACY__C) AS IDN_SPECIALTY_PHARMACY__C,
        btrim(EXT_VV_ACCOUNT_src.KAM_PRIMARY_CONTACT__C) AS KAM_PRIMARY_CONTACT__C,
        btrim(EXT_VV_ACCOUNT_src.LOC_KAM__C) AS LOC_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PCP_KAM__C) AS PCP_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PHARMACY_CLASSIFICATION_KAM__C) AS PHARMACY_CLASSIFICATION_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PHARMACY_TYPE_KAM__C) AS PHARMACY_TYPE_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PREFERRED_WHOLESALER_KAM__C) AS PREFERRED_WHOLESALER_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PURCHASING_HERZUMA_KAM__C) AS PURCHASING_HERZUMA_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.PURCHASING_TRUXIMA_KAM__C) AS PURCHASING_TRUXIMA_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.RA_TARGET_KAM__C) AS RA_TARGET_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ROMIDEPSIN_CONVERTED_KAM__C) AS ROMIDEPSIN_CONVERTED_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.ROMIDEPSIN_TARGET_KAM__C) AS ROMIDEPSIN_TARGET_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.RX_NETWORKS_SUB_GROUP_KAM__C) AS RX_NETWORKS_SUB_GROUP_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.SECONDARY_WHOLESALER_KAM__C) AS SECONDARY_WHOLESALER_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.SPECIALTY_PHARMACY_NETWORK_AFFIL_KAM__C) AS SPECIALTY_PHARMACY_NETWORK_AFFIL_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.STATES_IN_NETWORK_FOR_MEDICAID_KAM__C) AS STATES_IN_NETWORK_FOR_MEDICAID_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.STATES_LICENSED_TO_DISPENSE_KAM__C) AS STATES_LICENSED_TO_DISPENSE_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.THERAPEUTIC_FOCUS_CONDITIONS_SERVED_KAM__C) AS THERAPEUTIC_FOCUS_CONDITIONS_SERVED_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.TRUXIMA_TARGET_KAM__C) AS TRUXIMA_TARGET_KAM__C,
        btrim(EXT_VV_ACCOUNT_src.WHOLESALER_KAM__C) AS WHOLESALER_KAM__C,
        EXT_VV_ACCOUNT_src.batch_id,
        EXT_VV_ACCOUNT_src.row_id,
        EXT_VV_ACCOUNT_src.update_ts
 FROM teva_ingestion.EXT_VV_ACCOUNT_src;

CREATE  VIEW raw.ext_vv_account AS
 SELECT src.ID,
        src.ISDELETED,
        src.MASTERRECORDID,
        src.NAME,
        src.LASTNAME,
        src.FIRSTNAME,
        src.SALUTATION,
        src.TYPE,
        src.RECORDTYPEID,
        src.PHONE,
        src.FAX,
        src.WEBSITE,
        src.NUMBEROFEMPLOYEES,
        src.OWNERSHIP,
        src.OWNERID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.LASTACTIVITYDATE,
        src.MAYEDIT,
        src.ISLOCKED,
        src.LASTVIEWEDDATE,
        src.LASTREFERENCEDDATE,
        src.ISEXCLUDEDFROMREALIGN,
        src.PERSONCONTACTID,
        src.ISPERSONACCOUNT,
        src.PERSONMAILINGSTREET,
        src.PERSONMAILINGCITY,
        src.PERSONMAILINGSTATE,
        src.PERSONMAILINGPOSTALCODE,
        src.PERSONMAILINGCOUNTRY,
        src.PERSONMAILINGLATITUDE,
        src.PERSONMAILINGLONGITUDE,
        src.PERSONOTHERSTREET,
        src.PERSONOTHERCITY,
        src.PERSONOTHERSTATE,
        src.PERSONOTHERPOSTALCODE,
        src.PERSONOTHERCOUNTRY,
        src.PERSONOTHERLATITUDE,
        src.PERSONOTHERLONGITUDE,
        src.PERSONMOBILEPHONE,
        src.PERSONHOMEPHONE,
        src.PERSONOTHERPHONE,
        src.PERSONASSISTANTPHONE,
        src.PERSONEMAIL,
        src.PERSONTITLE,
        src.PERSONDEPARTMENT,
        src.PERSONASSISTANTNAME,
        src.PERSONBIRTHDATE,
        src.PERSONHASOPTEDOUTOFEMAIL,
        src.PERSONHASOPTEDOUTOFFAX,
        src.PERSONDONOTCALL,
        src.PERSONLASTCUREQUESTDATE,
        src.PERSONLASTCUUPDATEDATE,
        src.PERSONEMAILBOUNCEDREASON,
        src.PERSONEMAILBOUNCEDDATE,
        src.JIGSAW,
        src.JIGSAWCOMPANYID,
        src.ACCOUNTSOURCE,
        src.SICDESC,
        src.EXTERNAL_ID_VOD__C,
        src.CREDENTIALS_VOD__C,
        src.EXCLUDE_FROM_ZIP_TO_TERR_PROCE,
        src.GROUP_SPECIALTY_1_VOD__C,
        src.GROUP_SPECIALTY_2_VOD__C,
        src.SPECIALTY_1_VOD__C,
        src.SPECIALTY_2_VOD__C,
        src.FORMATTED_NAME_VOD__C,
        src.TERRITORY_TEST_VOD__C,
        src.MOBILE_ID_VOD__C,
        src.GENDER_VOD__C,
        src.ID_VOD__C,
        src.DO_NOT_SYNC_SALES_DATA_VOD__C,
        src.ID2_VOD__C,
        src.PREFERRED_NAME_VOD__C,
        src.SAMPLE_DEFAULT_VOD__C,
        src.SEGMENTATIONS_VOD__C,
        src.RESTRICTED_PRODUCTS_VOD__C,
        src.PAYER_ID_VOD__C,
        src.ACCOUNT_STATUS_TVA__C,
        src.DO_NOT_CALL_VOD__C,
        src.BEDS__C,
        src.SPEND_AMOUNT__C,
        src.PDRP_OPT_OUT_VOD__C,
        src.SPEND_STATUS_VALUE_VOD__C,
        src.PDRP_OPT_OUT_DATE_VOD__C,
        src.SPEND_STATUS_VOD__C,
        src.ENABLE_RESTRICTED_PRODUCTS,
        src.CALL_REMINDER_VOD__C,
        src.ACCOUNT_GROUP_VOD__C,
        src.PRIMARY_PARENT_VOD__C,
        src.COLOR_VOD__C,
        src.MIDDLE_VOD__C,
        src.SUFFIX_VOD__C,
        src.ACCOUNT_LOCATION_TVA__C,
        src.NO_ORDERS_VOD__C,
        src.ACCOUNT_MASTER_ID_TVA__C,
        src.ACCOUNT_EMAIL_TVA__C,
        src.ACCOUNT_SEARCH_FIRSTLAST,
        src.ACCOUNT_SEARCH_LASTFIRST,
        src.PERSON_PREFERRED_NAME_TVA__C,
        src.PRACTICE_AT_HOSPITAL_VOD__C,
        src.PRACTICE_NEAR_HOSPITAL_VOD__C,
        src.DO_NOT_CREATE_CHILD_ACCOUNT,
        src.TOTAL_MDS_DOS__C,
        src.AHA__C,
        src.ORDER_TYPE_VOD__C,
        src.NPI_VOD__C,
        src.ME__C,
        src.SPEAKER__C,
        src.INVESTIGATOR_VOD__C,
        src.DEFAULT_ORDER_TYPE_VOD__C,
        src.PERSON_DEGREE_TVA__C,
        src.TAX_STATUS__C,
        src.MODEL__C,
        src.OFFERINGS__C,
        src.DEPARTMENTS__C,
        src.ACCOUNT_TYPE__C,
        src.ACCOUNT_SEARCH_BUSINESS_VOD__C,
        src.BUSINESS_PROFESSIONAL_PERSON,
        src.NO_SPEND_TVA__C,
        src.HOSPITAL_TYPE_VOD__C,
        src.ACCOUNT_CLASS_VOD__C,
        src.FURIGANA_VOD__C,
        src.TIRF_REMS_TVA__C,
        src.FENTORA_APP_TVA__C,
        src.TOTAL_REVENUE_000__C,
        src.NET_INCOME_LOSS_000__C,
        src.PMPM_INCOME_LOSS_000__C,
        src.COMMERCIAL_PREMIUMS_PMPM__C,
        src.MEDICAL_LOSS_RATIO__C,
        src.MEDICAL_EXPENSES_PMPM__C,
        src.COMMERCIAL_PATIENT_DAYS_1000,
        src.HMO_MARKET_SHR__C,
        src.HMO__C,
        src.HMO_POS__C,
        src.PPO__C,
        src.PPO_POS__C,
        src.MEDICARE__C,
        src.MEDICAID__C,
        src.NUVIGIL_APP_TVA__C,
        src.MDS_STATUS_TVA__C,
        src.LIS_STATUS_TVA__C,
        src.DNC_PCS_TVA__C,
        src.DNC_CNS_TVA__C,
        src.SUFFIX_TVA__C,
        src.TYSABRI_STATUS_TVA__C,
        src.BUSINESS_DESCRIPTION__C,
        src.REGIONAL_STRATEGY__C,
        src.CONTRACTS_PROCESS__C,
        src.CML_PROFILED_TVA__C,
        src.CELL_PHONE_TVA__C,
        src.NO_CONTACT_TVA__C,
        src.OUTLET_ID_TVA__C,
        src.PMO_GPO_ACCOUNT_AFFILIATIONS,
        src.TERRITORY_STATUS_TVA__C,
        src.ZDEA_NUMBER_TVA__C,
        src.VEEVA_ID_TVA__C,
        src.TREANDA_LQ_TGT_TVA__C,
        src.TBO_FILGRASTIM_TARGET_TVA__C,
        src.SLN_RESCRUB_TVA__C,
        src.ACCOUNT_IDENTIFIER_VOD__C,
        src.TARGET__C,
        src.KOL_VOD__C,
        src.REMS_EXPIRATION_DATE_TEVA__C,
        src.ACCOUNT_DEMO_ID_TVA__C,
        src.TOTAL_LIVES__C,
        src.TOTAL_PHYSICIANS_ENROLLED__C,
        src.TIRF_REMS_EFF_DATE_TVA__C,
        src.BUSINESS_ASSOCIATE_AGREEMENT,
        src.DO_NOT_PROMOTE_TVA__C,
        src.ACCOUNT_DEA_TVA__C,
        src.BP_NUMBER__C,
        src.PARAGARD_SEGMENTATION_TVA__C,
        src.TELESALES_ACTIVITY_TVA__C,
        src.DESIGNATION_TVA__C,
        src.TOTAL_PHARMACISTS__C,
        src.COMP_PRICING_TVA__C,
        src.FORMULARY_TVA__C,
        src.GLN_TVA__C,
        src.GPO_CONTRACTS_TVA__C,
        src.HIN_TVA__C,
        src.MAX_ID_TVA__C,
        src.ONCOLOGY_SERVICES_TVA__C,
        src.PCP_PROGRAM_TVA__C,
        src.PHARMACY_LOCATION_TVA__C,
        src.PRIMARY_CREDENTIAL_TVA__C,
        src.PRIMARY_WHOLESALER_TVA__C,
        src.REP_CREDENTIALING_TVA__C,
        src.SECONDARY_CREDENTIAL_TVA__C,
        src.SIGN_IN_LOCATION_TVA__C,
        src.SPECIAL_TVA__C,
        src.SUB_TYPE_ID_TVA__C,
        src.SUB_TYPE_TVA__C,
        src.TEVA_CONTRACTS_TVA__C,
        src.IMS_ORG_ID_TVA__C,
        src.CM_ID_TVA__C,
        src.YEAR_OF_BIRTH_TVA__C,
        src.TEACHING_HOSPITAL_TVA__C,
        src.ACCOUNT_ARCHIVED_TVA__C,
        src.MOBILE_ID_VOD__PC,
        src.STAFF_EMAIL,
        src.COMPANY_MANAGED_EMAIL,
        src.ALTERNATE_EMAIL,
        src.ACCREDITATIONS_KAM__C,
        src.ADDL_SVCS_PATIENT_SVCS_OFFERING_KAM__C,
        src.ADDL_SERVICES_SALESFORCE_KAM__C,
        src.AGGREGATION_GROUP_KAM__C,
        src.ALVIMOPAN_ANDA_KAM__C,
        src.ALVIMOPAN_BRAND_USAGE_KAM__C,
        src.ALVIMOPAN_CONVERTED_KAM__C,
        src.ALVIMOPAN_REMS_KAM__C,
        src.ALVIMOPAN_USAGE_KAM__C,
        src.ANDA_ACCOUNT_KAM__C,
        src.GPO_IDN__C,
        src.GPO_OAKAM__C,
        src.GPO_AFFILIATIONS_KAM__C,
        src.HERZUMA_TARGET_KAM__C,
        src.IDN_KAM__C,
        src.IDN_SPECIALTY_PHARMACY__C,
        src.KAM_PRIMARY_CONTACT__C,
        src.LOC_KAM__C,
        src.PCP_KAM__C,
        src.PHARMACY_CLASSIFICATION_KAM__C,
        src.PHARMACY_TYPE_KAM__C,
        src.PREFERRED_WHOLESALER_KAM__C,
        src.PURCHASING_HERZUMA_KAM__C,
        src.PURCHASING_TRUXIMA_KAM__C,
        src.RA_TARGET_KAM__C,
        src.ROMIDEPSIN_CONVERTED_KAM__C,
        src.ROMIDEPSIN_TARGET_KAM__C,
        src.RX_NETWORKS_SUB_GROUP_KAM__C,
        src.SECONDARY_WHOLESALER_KAM__C,
        src.SPECIALTY_PHARMACY_NETWORK_AFFIL_KAM__C,
        src.STATES_IN_NETWORK_FOR_MEDICAID_KAM__C,
        src.STATES_LICENSED_TO_DISPENSE_KAM__C,
        src.THERAPEUTIC_FOCUS_CONDITIONS_SERVED_KAM__C,
        src.TRUXIMA_TARGET_KAM__C,
        src.WHOLESALER_KAM__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_ACCOUNT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_ACCOUNT'::varchar(14)))));

CREATE  VIEW teva_ingestion.EXT_VV_SUGGESTION_TAG_VOD__C AS
 SELECT btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.id) AS id,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.name) AS name,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.recordtypeid) AS recordtypeid,
        CASE WHEN (EXT_VV_SUGGESTION_TAG_VOD__C_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.createddate))::timestamp END AS createddate,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_VV_SUGGESTION_TAG_VOD__C_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_VV_SUGGESTION_TAG_VOD__C_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.systemmodstamp))::timestamp END AS systemmodstamp,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.suggestion_vod__c) AS suggestion_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.detail_group_vod__c) AS detail_group_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.driver_vod__c) AS driver_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.email_fragment_order_vod__c) AS email_fragment_order_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.email_fragment_vod__c) AS email_fragment_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.external_id_vod__c) AS external_id_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.product_vod__c) AS product_vod__c,
        btrim(EXT_VV_SUGGESTION_TAG_VOD__C_src.record_type_name_vod__c) AS record_type_name_vod__c,
        EXT_VV_SUGGESTION_TAG_VOD__C_src.batch_id,
        EXT_VV_SUGGESTION_TAG_VOD__C_src.row_id,
        EXT_VV_SUGGESTION_TAG_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SUGGESTION_TAG_VOD__C_src;

CREATE  VIEW teva_ingestion.EXT_VV_SUGGESTION_VOD__C AS
 SELECT btrim(EXT_VV_SUGGESTION_VOD__C_src.id) AS id,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.ownerid) AS ownerid,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.name) AS name,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.recordtypeid) AS recordtypeid,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.createddate))::timestamp END AS createddate,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.systemmodstamp))::timestamp END AS systemmodstamp,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.islocked) AS islocked,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.account_priority_score_vod__c) AS account_priority_score_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.action_count_vod__c) AS action_count_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.actioned_vod__c) AS actioned_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.call_objective_clm_id_vod__c) AS call_objective_clm_id_vod__c,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.call_objective_from_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.call_objective_from_date_vod__c))::timestamp END AS call_objective_from_date_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.call_objective_on_by_default_vod__c) AS call_objective_on_by_default_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.call_objective_record_type_vod__c) AS call_objective_record_type_vod__c,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.call_objective_to_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.call_objective_to_date_vod__c))::timestamp END AS call_objective_to_date_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.dismiss_count_vod__c) AS dismiss_count_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.dismissed_vod__c) AS dismissed_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.display_dismiss_vod__c) AS display_dismiss_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.display_mark_as_complete_vod__c) AS display_mark_as_complete_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.display_score_vod__c) AS display_score_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.email_template_id_vod__c) AS email_template_id_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.email_template_vault_id_vod__c) AS email_template_vault_id_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.email_template_vod__c) AS email_template_vod__c,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.expiration_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.expiration_date_vod__c))::timestamp END AS expiration_date_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.mark_complete_count_vod__c) AS mark_complete_count_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.marked_as_complete_vod__c) AS marked_as_complete_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.no_homepage_vod__c) AS no_homepage_vod__c,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.planned_call_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.planned_call_date_vod__c))::timestamp END AS planned_call_date_vod__c,
        CASE WHEN (EXT_VV_SUGGESTION_VOD__C_src.posted_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_VOD__C_src.posted_date_vod__c))::timestamp END AS posted_date_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.priority_vod__c) AS priority_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.reason_vod__c) AS reason_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.record_type_name_vod__c) AS record_type_name_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.suggestion_external_id_vod__c) AS suggestion_external_id_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.suppress_reason_vod__c) AS suppress_reason_vod__c,
        btrim(EXT_VV_SUGGESTION_VOD__C_src.title_vod__c) AS title_vod__c,
        EXT_VV_SUGGESTION_VOD__C_src.batch_id,
        EXT_VV_SUGGESTION_VOD__C_src.row_id,
        EXT_VV_SUGGESTION_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SUGGESTION_VOD__C_src;

CREATE  VIEW raw.EXT_VV_SUGGESTION_VOD__C AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.account_priority_score_vod__c,
        src.account_vod__c,
        src.action_count_vod__c,
        src.actioned_vod__c,
        src.call_objective_clm_id_vod__c,
        src.call_objective_from_date_vod__c,
        src.call_objective_on_by_default_vod__c,
        src.call_objective_record_type_vod__c,
        src.call_objective_to_date_vod__c,
        src.dismiss_count_vod__c,
        src.dismissed_vod__c,
        src.display_dismiss_vod__c,
        src.display_mark_as_complete_vod__c,
        src.display_score_vod__c,
        src.email_template_id_vod__c,
        src.email_template_vault_id_vod__c,
        src.email_template_vod__c,
        src.expiration_date_vod__c,
        src.mark_complete_count_vod__c,
        src.marked_as_complete_vod__c,
        src.no_homepage_vod__c,
        src.planned_call_date_vod__c,
        src.posted_date_vod__c,
        src.priority_vod__c,
        src.reason_vod__c,
        src.record_type_name_vod__c,
        src.suggestion_external_id_vod__c,
        src.suppress_reason_vod__c,
        src.title_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SUGGESTION_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SUGGESTION'::varchar(17)))));

CREATE  VIEW raw.EXT_VV_SUGGESTION_TAG_VOD__C AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.suggestion_vod__c,
        src.detail_group_vod__c,
        src.driver_vod__c,
        src.email_fragment_order_vod__c,
        src.email_fragment_vod__c,
        src.external_id_vod__c,
        src.product_vod__c,
        src.record_type_name_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SUGGESTION_TAG_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SUGGESTION_TAG'::varchar(21)))));

CREATE  VIEW sandbox.vw_prev_month_payer_spine25_detailed_teva_brands_cdw_v1 AS
 SELECT payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.payment_type,
        payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_detailed_teva_brands_cdw_v1.saba_trx
 FROM sandbox.payer_spine25_detailed_teva_brands_cdw_v1
 WHERE (payer_spine25_detailed_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_detailed_teva_brands_cdw_v1'::varchar(41)))))));

CREATE  VIEW sandbox.vw_curr_comparison_payer_spine_cdw_v1 AS
 SELECT comparison_payer_spine_cdw_v1.iqvia_plan_code,
        comparison_payer_spine_cdw_v1.iqvia_plan_name,
        comparison_payer_spine_cdw_v1.iqvia_payer_name,
        comparison_payer_spine_cdw_v1.iqvia_pbm,
        comparison_payer_spine_cdw_v1.key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.key_controlling_account,
        comparison_payer_spine_cdw_v1.key_controlling_parent,
        comparison_payer_spine_cdw_v1.payer_pbm,
        comparison_payer_spine_cdw_v1.payment_type,
        comparison_payer_spine_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.lives_plan_lvl,
        comparison_payer_spine_cdw_v1.apportionment_factor,
        comparison_payer_spine_cdw_v1.saba_trx,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_code,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_name,
        comparison_payer_spine_cdw_v1.change_iqvia_payer_name,
        comparison_payer_spine_cdw_v1.change_iqvia_pbm,
        comparison_payer_spine_cdw_v1.change_key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.change_key_controlling_account,
        comparison_payer_spine_cdw_v1.change_key_controlling_parent,
        comparison_payer_spine_cdw_v1.change_payer_pbm,
        comparison_payer_spine_cdw_v1.change_payment_type,
        comparison_payer_spine_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.change_lives_plan_lvl,
        comparison_payer_spine_cdw_v1.change_apportionment_factor,
        comparison_payer_spine_cdw_v1.change_saba_trx,
        comparison_payer_spine_cdw_v1.change,
        comparison_payer_spine_cdw_v1.month_flag,
        comparison_payer_spine_cdw_v1.status,
        comparison_payer_spine_cdw_v1.cycle_id,
        comparison_payer_spine_cdw_v1.modified_time,
        comparison_payer_spine_cdw_v1.modified_by
 FROM sandbox.comparison_payer_spine_cdw_v1
 WHERE (comparison_payer_spine_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_payer_spine_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_iqvia_plans_discard AS
 SELECT iqvia_plans_discard_v01.payer_id,
        btrim(iqvia_plans_discard_v01.notes) AS notes
 FROM sandbox.iqvia_plans_discard_v01
 WHERE (iqvia_plans_discard_v01.file_id IN ( SELECT max(iqvia_plans_discard_v01.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v01));

CREATE  VIEW sandbox.vw_model_paytype_map AS
 SELECT btrim(model_paytype_map_v01.model) AS model,
        btrim(model_paytype_map_v01.paytype) AS paytype,
        btrim(model_paytype_map_v01.notes) AS notes
 FROM sandbox.model_paytype_map_v01
 WHERE (model_paytype_map_v01.file_id IN ( SELECT max(model_paytype_map_v01.file_id) AS max
 FROM sandbox.model_paytype_map_v01));

CREATE  VIEW sandbox.vw_iqvia_paytypeindex AS
 SELECT iqvia_paytypeindex_v01.paytype_index,
        btrim(iqvia_paytypeindex_v01.paytype) AS paytype
 FROM sandbox.iqvia_paytypeindex_v01
 WHERE (iqvia_paytypeindex_v01.file_id IN ( SELECT max(iqvia_paytypeindex_v01.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v01));

CREATE  VIEW sandbox.vw_iqvia_payer_paytype_override AS
 SELECT btrim(iqvia_payer_paytype_override_v01.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v01.paytype) AS paytype
 FROM sandbox.iqvia_payer_paytype_override_v01
 WHERE (iqvia_payer_paytype_override_v01.file_id IN ( SELECT max(iqvia_payer_paytype_override_v01.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v01));

CREATE  VIEW sandbox.vw_ftf_plans_paytypeindex AS
 SELECT btrim(ftf_plans_paytypeindex_v01.ftf_health_plan_type) AS ftf_health_plan_type,
        ftf_plans_paytypeindex_v01.paytype_index
 FROM sandbox.ftf_plans_paytypeindex_v01
 WHERE (ftf_plans_paytypeindex_v01.file_id IN ( SELECT max(ftf_plans_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v01));

CREATE  VIEW sandbox.vw_ftf_paytype_paytypeindex AS
 SELECT ftf_paytype_paytypeindex_v01.paytype_index,
        btrim(ftf_paytype_paytypeindex_v01.paytype) AS paytype
 FROM sandbox.ftf_paytype_paytypeindex_v01
 WHERE (ftf_paytype_paytypeindex_v01.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v01));

CREATE  VIEW sandbox.vw_ftf_override_provider AS
 SELECT ftf_override_provider_v01.provider_fid,
        ftf_override_provider_v01.paytype_index,
        btrim(ftf_override_provider_v01.notes) AS notes
 FROM sandbox.ftf_override_provider_v01
 WHERE (ftf_override_provider_v01.file_id IN ( SELECT max(ftf_override_provider_v01.file_id) AS max
 FROM sandbox.ftf_override_provider_v01));

CREATE  VIEW sandbox.vw_ftf_override_plan AS
 SELECT ftf_override_plan_v01.ftf_health_plan_fid,
        ftf_override_plan_v01.paytype_index,
        btrim(ftf_override_plan_v01.notes) AS notes
 FROM sandbox.ftf_override_plan_v01
 WHERE (ftf_override_plan_v01.file_id IN ( SELECT max(ftf_override_plan_v01.file_id) AS max
 FROM sandbox.ftf_override_plan_v01));

CREATE  VIEW sandbox.vw_drug_assignments AS
 SELECT drug_assignments_v01.drug_id,
        drug_assignments_v01.drug_seq,
        btrim(drug_assignments_v01.product) AS product
 FROM sandbox.drug_assignments_v01
 WHERE (drug_assignments_v01.file_id IN ( SELECT max(drug_assignments_v01.file_id) AS max
 FROM sandbox.drug_assignments_v01));

CREATE  VIEW sandbox.vw_ftf_pbm_functions AS
 SELECT ftf_pbm_functions_v01.pbm_function_id,
        btrim(ftf_pbm_functions_v01.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v01.notes) AS notes,
        ftf_pbm_functions_v01.used
 FROM sandbox.ftf_pbm_functions_v01
 WHERE (ftf_pbm_functions_v01.file_id IN ( SELECT max(ftf_pbm_functions_v01.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v01));

CREATE  VIEW sandbox.vw_botox_step_restriction AS
 SELECT botox_step_restriction_v01.code,
        btrim(botox_step_restriction_v01.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v01.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v01.notes) AS notes
 FROM sandbox.botox_step_restriction_v01
 WHERE (botox_step_restriction_v01.file_id IN ( SELECT max(botox_step_restriction_v01.file_id) AS max
 FROM sandbox.botox_step_restriction_v01));

CREATE  VIEW sandbox.vw_step_restriction AS
 SELECT step_restriction_v01.code,
        btrim(step_restriction_v01.step_category) AS step_category,
        btrim(step_restriction_v01.restriction_group) AS restriction_group,
        btrim(step_restriction_v01.notes) AS notes
 FROM sandbox.step_restriction_v01
 WHERE (step_restriction_v01.file_id IN ( SELECT max(step_restriction_v01.file_id) AS max
 FROM sandbox.step_restriction_v01));

CREATE  VIEW sandbox.vw_pa_restriction AS
 SELECT pa_restriction_v01.code,
        btrim(pa_restriction_v01.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v01.notes) AS notes
 FROM sandbox.pa_restriction_v01
 WHERE (pa_restriction_v01.file_id IN ( SELECT max(pa_restriction_v01.file_id) AS max
 FROM sandbox.pa_restriction_v01));

CREATE  VIEW sandbox.vw_patient_pa_restriction AS
 SELECT patient_pa_restriction_v01.code,
        btrim(patient_pa_restriction_v01.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v01.notes) AS notes
 FROM sandbox.patient_pa_restriction_v01
 WHERE (patient_pa_restriction_v01.file_id IN ( SELECT max(patient_pa_restriction_v01.file_id) AS max
 FROM sandbox.patient_pa_restriction_v01));

CREATE  VIEW sandbox.vw_medical_rec_restriction AS
 SELECT medical_rec_restriction_v01.code,
        btrim(medical_rec_restriction_v01.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v01.notes) AS notes
 FROM sandbox.medical_rec_restriction_v01
 WHERE (medical_rec_restriction_v01.file_id IN ( SELECT max(medical_rec_restriction_v01.file_id) AS max
 FROM sandbox.medical_rec_restriction_v01));

CREATE  VIEW sandbox.vw_unspecified_rec_restriction AS
 SELECT unspecified_rec_restriction_v01.code,
        btrim(unspecified_rec_restriction_v01.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v01.notes) AS notes
 FROM sandbox.unspecified_rec_restriction_v01
 WHERE (unspecified_rec_restriction_v01.file_id IN ( SELECT max(unspecified_rec_restriction_v01.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v01));

CREATE  VIEW sandbox.vw_override_bridge_ftf_plan_types AS
 SELECT btrim(override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v01.override_precedence
 FROM sandbox.override_bridge_ftf_plan_types_v01
 WHERE (override_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_delete_bridge_ftf_plan_types AS
 SELECT btrim(delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.delete_flag) AS delete_flag
 FROM sandbox.delete_bridge_ftf_plan_types_v01
 WHERE (delete_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_provider_override_default AS
 SELECT provider_override_default_v01.provider_id,
        btrim(provider_override_default_v01.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v01.provider_name) AS provider_name,
        btrim(provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_pbm) AS override_best_iqvia_pbm
 FROM sandbox.provider_override_default_v01
 WHERE (provider_override_default_v01.file_id IN ( SELECT max(provider_override_default_v01.file_id) AS max
 FROM sandbox.provider_override_default_v01));

CREATE  VIEW sandbox.vw_key_controller_list AS
 SELECT key_controller_list_v01.ftf_health_plan_fid,
        btrim(key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v01.payer_pbm) AS payer_pbm
 FROM sandbox.key_controller_list_v01
 WHERE (key_controller_list_v01.file_id IN ( SELECT max(key_controller_list_v01.file_id) AS max
 FROM sandbox.key_controller_list_v01));

CREATE  VIEW sandbox.vw_calculated_pbm_config AS
 SELECT btrim(calculated_pbm_config_v01.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v01.calculated_pbm_column) AS calculated_pbm_column
 FROM sandbox.calculated_pbm_config_v01
 WHERE (calculated_pbm_config_v01.file_id IN ( SELECT max(calculated_pbm_config_v01.file_id) AS max
 FROM sandbox.calculated_pbm_config_v01));

CREATE  VIEW sandbox.vw_calc_pbm_key_pbm_mapping AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v01.calculated_pbm) AS calculated_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.added_by) AS added_by
 FROM sandbox.calc_pbm_key_pbm_mapping_v01
 WHERE (calc_pbm_key_pbm_mapping_v01.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v01.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v01));

CREATE  VIEW sandbox.vw_has_pa_mapping AS
 SELECT has_pa_mapping_v01.has_pa,
        btrim(has_pa_mapping_v01.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v01.notes) AS notes
 FROM sandbox.has_pa_mapping_v01
 WHERE (has_pa_mapping_v01.file_id IN ( SELECT max(has_pa_mapping_v01.file_id) AS max
 FROM sandbox.has_pa_mapping_v01));

CREATE  VIEW sandbox.vw_has_st_mapping AS
 SELECT has_st_mapping_v01.has_st,
        btrim(has_st_mapping_v01.st_regex) AS st_regex,
        btrim(has_st_mapping_v01.notes) AS notes
 FROM sandbox.has_st_mapping_v01
 WHERE (has_st_mapping_v01.file_id IN ( SELECT max(has_st_mapping_v01.file_id) AS max
 FROM sandbox.has_st_mapping_v01));

CREATE  VIEW sandbox.vw_formulary_derivation_config AS
 SELECT btrim(formulary_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v01.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v01.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v01.formulary) AS formulary,
        btrim(formulary_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex
 FROM sandbox.formulary_derivation_config_v01
 WHERE (formulary_derivation_config_v01.file_id IN ( SELECT max(formulary_derivation_config_v01.file_id) AS max
 FROM sandbox.formulary_derivation_config_v01));

CREATE  VIEW sandbox.vw_copay_tier_derivation_config AS
 SELECT btrim(copay_tier_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        copay_tier_derivation_config_v01.tier_cat,
        btrim(copay_tier_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v01.copay_tier) AS copay_tier
 FROM sandbox.copay_tier_derivation_config_v01
 WHERE (copay_tier_derivation_config_v01.file_id IN ( SELECT max(copay_tier_derivation_config_v01.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v01));

CREATE  VIEW sandbox.vw_tier_cat_description_mapping AS
 SELECT tier_cat_description_mapping_v01.tier_cat,
        btrim(tier_cat_description_mapping_v01.description) AS description,
        btrim(tier_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.tier_cat_description_mapping_v01
 WHERE (tier_cat_description_mapping_v01.file_id IN ( SELECT max(tier_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.tier_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_restriction_category_derivation_config AS
 SELECT btrim(restriction_category_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v01.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v01.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v01.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v01.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v01.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v01.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v01.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v01.restcat,
        btrim(restriction_category_derivation_config_v01.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v01.meaning) AS meaning
 FROM sandbox.restriction_category_derivation_config_v01
 WHERE (restriction_category_derivation_config_v01.file_id IN ( SELECT max(restriction_category_derivation_config_v01.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_restriction_cat_description_mapping AS
 SELECT btrim(restriction_cat_description_mapping_v01.rest_cat) AS rest_cat,
        btrim(restriction_cat_description_mapping_v01.description) AS description,
        btrim(restriction_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.restriction_cat_description_mapping_v01
 WHERE (restriction_cat_description_mapping_v01.file_id IN ( SELECT max(restriction_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.restriction_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_coverage_category_derivation_config AS
 SELECT btrim(coverage_category_derivation_config_v01.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v01.coverage_cat_code,
        btrim(coverage_category_derivation_config_v01.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v01.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v01.meaning) AS meaning
 FROM sandbox.coverage_category_derivation_config_v01
 WHERE (coverage_category_derivation_config_v01.file_id IN ( SELECT max(coverage_category_derivation_config_v01.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_coverage_cat_description_mapping AS
 SELECT btrim(coverage_cat_description_mapping_v01.coverage_cat) AS coverage_cat,
        btrim(coverage_cat_description_mapping_v01.description) AS description,
        btrim(coverage_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.coverage_cat_description_mapping_v01
 WHERE (coverage_cat_description_mapping_v01.file_id IN ( SELECT max(coverage_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.coverage_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_step_restriction_description AS
 SELECT step_restriction_description_v01.step,
        btrim(step_restriction_description_v01.description) AS description
 FROM sandbox.step_restriction_description_v01
 WHERE (step_restriction_description_v01.file_id IN ( SELECT max(step_restriction_description_v01.file_id) AS max
 FROM sandbox.step_restriction_description_v01));

CREATE  VIEW sandbox.vw_pres_pa_restriction_description AS
 SELECT pres_pa_restriction_description_v01.prespa,
        btrim(pres_pa_restriction_description_v01.description) AS description
 FROM sandbox.pres_pa_restriction_description_v01
 WHERE (pres_pa_restriction_description_v01.file_id IN ( SELECT max(pres_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_pat_pa_restriction_description AS
 SELECT pat_pa_restriction_description_v01.patpa,
        btrim(pat_pa_restriction_description_v01.description) AS description
 FROM sandbox.pat_pa_restriction_description_v01
 WHERE (pat_pa_restriction_description_v01.file_id IN ( SELECT max(pat_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_override_fid_iqvia_key_controller_list AS
 SELECT override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
        btrim(override_fid_iqvia_key_controller_list_v01.iqvia_plan_name) AS iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
        btrim(override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(override_fid_iqvia_key_controller_list_v01.payer_pbm) AS payer_pbm
 FROM sandbox.override_fid_iqvia_key_controller_list_v01
 WHERE (override_fid_iqvia_key_controller_list_v01.file_id IN ( SELECT max(override_fid_iqvia_key_controller_list_v01.file_id) AS max
 FROM sandbox.override_fid_iqvia_key_controller_list_v01));

CREATE  VIEW sandbox.vw_comparison_payer_spine_detailed_report AS
 SELECT a.iqvia_plan_code AS "IQVIA Plan Code",
        a.iqvia_plan_name AS "IQVIA Plan Name",
        a.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        a.iqvia_payer_name AS "IQVIA Payer Name",
        a.iqvia_pbm AS "IQVIA PBM",
        a.key_controlling_account AS "Key Controlling Account",
        a.key_controlling_parent AS "Key Controlling Parent",
        a.payer_pbm AS "PBM/Payer",
        a.payment_type AS "Payment Type",
        a.ajovy_access_for_ftf_plan AS "AJOVY Access for FTF Plan",
        a.aimovig_access_for_ftf_plan AS "Aimovig Access for FTF Plan",
        a.emgality_access_for_ftf_plan AS "Emgality Access for FTF Plan",
        a.apportionment_factor AS "Apportionment Factor",
        a.saba_trx AS "Apportionment SABA TRx",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_code = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Code Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan Formulary Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "PBM/Payer Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payment_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payment Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ajovy_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "AJOVY Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_aimovig_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Aimovig Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_emgality_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Emgality Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_apportionment_factor = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Apportionment Factor Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_saba_trx = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Apportionment SABA TRx Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        a.month_flag AS "Month Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        0 AS "Change in TRx",
        tbl_lvl_audit.date_run AS "Date Run",
        (to_timestamptz((a.cycle_id)::float))::timestamp AS "Modified Time"
 FROM (sandbox.vw_curr_comparison_payer_spine_cdw_v1 a LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_payer_spine_cdw_v1'::varchar(29))))
 ORDER BY a.iqvia_plan_code,
          a.key_controlling_plan_formulary;

CREATE  VIEW veeva.v_survey_target AS
 SELECT survey_target.id,
        survey_target.ownerid,
        survey_target.isdeleted,
        survey_target.name,
        survey_target.recordtypeid,
        survey_target.createddate,
        survey_target.createdbyid,
        survey_target.lastmodifieddate,
        survey_target.lastmodifiedbyid,
        survey_target.systemmodstamp,
        survey_target.mayedit,
        survey_target.islocked,
        survey_target.lastvieweddate,
        survey_target.lastreferenceddate,
        survey_target.account_display_name_vod__c,
        survey_target.account_vod__c,
        survey_target.channels_vod__c,
        survey_target.end_date_vod__c,
        survey_target.entity_reference_id_vod__c,
        survey_target.external_id_vod__c,
        survey_target.language_vod__c,
        survey_target.lock_vod__c,
        survey_target.mobile_id_vod__c,
        survey_target.no_autoassign_vod__c,
        survey_target.not_completed_vod__c,
        survey_target.region_vod__c,
        survey_target.segment_vod__c,
        survey_target.start_date_vod__c,
        survey_target.status_vod__c,
        survey_target.survey_vod__c,
        survey_target.territory_vod__c,
        survey_target.zvod_address_vod__c,
        survey_target.zvod_specialty_vod__c,
        survey_target.score_vod__c,
        survey_target.coach_vod__c,
        survey_target.Employee_vod__c,
        survey_target.Review_date_vod__c,
        survey_target.report_status_vod__c,
        survey_target.file_id,
        survey_target.record_id
 FROM veeva.survey_target
 WHERE (survey_target.file_id = ( SELECT max(survey_target.file_id) AS MAX
 FROM veeva.survey_target));

CREATE  VIEW sandbox.vw_curr_saba_mkt_ajovy_payer_spine_prod_list AS
 SELECT btrim(saba_mkt_ajovy_payer_spine_prod_list.product_name) AS product_name,
        btrim(saba_mkt_ajovy_payer_spine_prod_list.notes) AS notes,
        saba_mkt_ajovy_payer_spine_prod_list.file_id,
        saba_mkt_ajovy_payer_spine_prod_list.record_id
 FROM sandbox.saba_mkt_ajovy_payer_spine_prod_list
 WHERE (saba_mkt_ajovy_payer_spine_prod_list.file_id IN ( SELECT max(saba_mkt_ajovy_payer_spine_prod_list.file_id) AS max
 FROM sandbox.saba_mkt_ajovy_payer_spine_prod_list));

CREATE  VIEW teva_ingestion.EXT_VV_TSF_VOD__C AS
 SELECT btrim(EXT_VV_TSF_VOD__C_src.id) AS id,
        btrim(EXT_VV_TSF_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_TSF_VOD__C_src.name) AS name,
        btrim(EXT_VV_TSF_VOD__C_src.recordtypeid) AS recordtypeid,
        btrim(EXT_VV_TSF_VOD__C_src.createddate) AS createddate,
        btrim(EXT_VV_TSF_VOD__C_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_TSF_VOD__C_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_TSF_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_TSF_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_TSF_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_TSF_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_TSF_VOD__C_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.address_vod__c) AS address_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.last_activity_date_vod__c) AS last_activity_date_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.my_target_vod__c) AS my_target_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.route_vod__c) AS route_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.external_id_vod__c) AS external_id_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.territory_vod__c) AS territory_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.ytd_activity_vod__c) AS ytd_activity_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.preferred_account_vod__c) AS preferred_account_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.allowed_products_vod__c) AS allowed_products_vod__c,
        btrim(EXT_VV_TSF_VOD__C_src.territory_status_tva__c) AS territory_status_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.territory_specialty_tva__c) AS territory_specialty_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.treats_es_osa_tva__c) AS treats_es_osa_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.osa_patients_tva__c) AS osa_patients_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.account_status_tva__c) AS account_status_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.dea_number_tva__c) AS dea_number_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.synribo_target_tva__c) AS synribo_target_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.treanda_sbo_tva__c) AS treanda_sbo_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.trisenox_sbo_tva__c) AS trisenox_sbo_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.appt_index_tva__c) AS appt_index_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.merged_mvn__c) AS merged_mvn__c,
        btrim(EXT_VV_TSF_VOD__C_src.call_plan_designation_tva__c) AS call_plan_designation_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.campaign_tva__c) AS campaign_tva__c,
        btrim(EXT_VV_TSF_VOD__C_src.detail_priority__c) AS detail_priority__c,
        btrim(EXT_VV_TSF_VOD__C_src.cinqair_call_plan_target__c) AS cinqair_call_plan_target__c,
        btrim(EXT_VV_TSF_VOD__C_src.digihaler_call_plan_target__c) AS digihaler_call_plan_target__c,
        EXT_VV_TSF_VOD__C_src.batch_id,
        EXT_VV_TSF_VOD__C_src.row_id,
        EXT_VV_TSF_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_TSF_VOD__C_src;

CREATE  VIEW raw.EXT_VV_TSF_VOD__C AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.account_vod__c,
        src.address_vod__c,
        src.last_activity_date_vod__c,
        src.my_target_vod__c,
        src.route_vod__c,
        src.mobile_id_vod__c,
        src.external_id_vod__c,
        src.territory_vod__c,
        src.ytd_activity_vod__c,
        src.preferred_account_vod__c,
        src.allowed_products_vod__c,
        src.territory_status_tva__c,
        src.territory_specialty_tva__c,
        src.treats_es_osa_tva__c,
        src.osa_patients_tva__c,
        src.account_status_tva__c,
        src.dea_number_tva__c,
        src.synribo_target_tva__c,
        src.treanda_sbo_tva__c,
        src.trisenox_sbo_tva__c,
        src.appt_index_tva__c,
        src.merged_mvn__c,
        src.call_plan_designation_tva__c,
        src.campaign_tva__c,
        src.detail_priority__c,
        src.cinqair_call_plan_target__c,
        src.digihaler_call_plan_target__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TSF_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TSF_VOD__C'::varchar(17)))));

CREATE  VIEW outbound.mcm_qvar_copay AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.pharmacy_chain_number,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.create_date,
        copay.occ_payment_type,
        copay.counted_copay,
        copay.auth_refills,
        copay.admin_hcp_npi,
        copay.admin_hcp_name,
        copay.admin_hcp_address,
        copay.admin_hcp_address2,
        copay.admin_hcp_city,
        copay.admin_hcp_state,
        copay.admin_hcp_zip,
        copay.claim_type,
        copay.administration_flag,
        copay.soc_name,
        copay.soc_phone,
        copay.soc_fax,
        copay.soc_address,
        copay.soc_city,
        copay.soc_state,
        copay.soc_zip,
        copay.soc_id,
        copay.soc_npi,
        copay.payer_name,
        copay.cpt_code,
        copay.trans_type,
        copay.previous_payer_id,
        copay.member_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.report_frequency,
        copay.source_name,
        copay.file_id,
        copay.record_id,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay
 WHERE (copay.basket_name ~~* '%QVAR%'::varchar(6))
 ORDER BY copay.fill_date;

CREATE  VIEW WSMP_ADMIN_ORA.v_do_not_promote AS
SELECT iq2.ims_id, iq2.last_name, iq2.first_name, iq2.mid_name, iq2.suffix FROM (SELECT iq1.ims_id, iq1.last_name, iq1.first_name, iq1.mid_name, iq1.suffix, row_number() OVER (PARTITION BY iq1.ims_id ORDER BY iq1.u_rnk) AS rnk FROM (SELECT dim_debarred.IMS_ID AS ims_id, dim_debarred.LAST_NAME AS last_name, dim_debarred.FIRST_NAME AS first_name, dim_debarred.MID_NAME AS mid_name, dim_debarred.SUFFIX AS suffix, 2 AS u_rnk FROM teva_archive.DIM_DEBARRED WHERE (dim_debarred.IMS_ID IS NOT NULL) UNION SELECT debarred.IMS_ID AS ims_id, debarred.LAST_NAME AS last_name, debarred.FIRST_NAME AS first_name, debarred.MIDDLE_NAME AS middle_name, debarred.SUFFIX AS suffix, 1 AS u_rnk FROM WSMP_ADMIN.DEBARRED WHERE ((debarred.IMS_ID IS NOT NULL) AND (debarred.CURRENT_IND = 'Y'::varchar(1)))) iq1) iq2 WHERE (iq2.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_zs_tr_demo_obw AS
SELECT acct.ID AS veeva_account_id, acct.ID_VOD__C AS ims_id, g.DEVELOPERNAME AS territory_num, acct.FIRSTNAME AS first_name, acct.LASTNAME AS last_name, addr.NAME AS address1, addr.ADDRESS_LINE_2_VOD__C AS address2, addr.CITY_VOD__C AS city, addr.STATE_VOD__C AS state, addr.ZIP_VOD__C AS zip, cg.call_goal, cg.committed_p1, cg.committed_p2, cg.committed_p3 FROM ((((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_TSF_VOD__C tsf ON (((tsf.ACCOUNT_VOD__C = acct.ID) AND (tsf.TERRITORY_VOD__C = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (tsf.ADDRESS_VOD__C = addr.ID)))) LEFT JOIN (SELECT cg.ACCOUNT_TVA__C AS account_tva__c, cg.TERRITORY_TVA__C AS territory_tva__c, sum(CASE WHEN (cg.PRIORITY_TVA__C = 1::numeric(18,0)) THEN cg.GOAL_TVA__C ELSE 0::numeric(18,0) END) AS call_goal, min(CASE WHEN (cg.PRIORITY_TVA__C = 1::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p1, min(CASE WHEN (cg.PRIORITY_TVA__C = 2::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p2, min(CASE WHEN (cg.PRIORITY_TVA__C = 3::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p3 FROM (WSMP_ADMIN.VV_CALL_GOAL_TVA__C cg JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((cg.PRODUCT_CATALOG_TVA__C = p.ID))) WHERE (cg.TERRITORY_TVA__C ~~ 'TR%'::varchar(3)) GROUP BY cg.ACCOUNT_TVA__C, cg.TERRITORY_TVA__C) cg ON (((cg.account_tva__c = acct.ID) AND (cg.territory_tva__c = g.DEVELOPERNAME)))) WHERE ((g.DEVELOPERNAME ~~ 'TR%'::varchar(3)) AND (acct.ISPERSONACCOUNT = 'true'::varchar(4)) AND (acct.ID IN (SELECT dw_call.VEEVA_ACCOUNT_ID AS veeva_account_id FROM WSMP_ADMIN.DW_CALL WHERE (dw_call.CALL_DATE > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_survey_backup AS
((SELECT a.account_id, a.bu, a.survey_update_date, a.survey, a.question, a.answer, a.response_update_date, a.response_create_date FROM (SELECT yr.account_id, yr.bu, yr.survey_update_date, yr.survey, '*Future Scheduled Adasuve Formulary Review Date'::varchar(47) AS question, ((((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) || '-'::varchar(1)) || coalesce(lpad(dy.answer, 2, '0'::varchar(1)), '  '::varchar(2))) AS answer, yr.response_update_date, yr.response_create_date FROM (((SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Year'::varchar(47))) yr JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question ~~ '*Future Scheduled Adasuve % Review Month'::varchar(40))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c))) JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Date'::varchar(47))) dy ON ((yr.survey_target_vod__c = dy.survey_target_vod__c)))) a UNION ALL SELECT b.account_id, b.bu, b.survey_update_date, b.survey, b.question, b.answer, b.response_update_date, b.response_create_date FROM (SELECT yr.account_id, yr.bu, yr.survey_update_date, yr.survey, '*Prior Adasuve Formulary Review Date'::varchar(36) AS question, ((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) AS answer, yr.response_update_date, yr.response_create_date FROM ((SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Prior Adasuve Formulary Review Year'::varchar(36))) yr JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question ~~ '*Prior Adasuve % Review Month'::varchar(29))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c)))) b) UNION ALL SELECT c.account_id, c.bu, c.survey_update_date, c.survey, c.question, c.answer, c.response_update_date, c.response_create_date FROM (SELECT x.account_id, x.bu, x.survey_update_date, x.survey, x.question, x.answer, x.response_update_date, x.response_create_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question !~~ '%Adasuve%Review%'::varchar(16))) c) UNION ALL SELECT y.account_id, y.bu, y.survey_update_date, y.survey, y.question, y.answer, y.response_update_date, y.response_create_date FROM (SELECT w.account_id, w.bu, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date, w.survey, w.question, w.answer, w.response_update_date, w.response_create_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = 'e-Rx Survey'::varchar(11)))) y;

CREATE  VIEW teva_ingestion.EXTERNAL_TABLE_CLEANUP AS
SELECT EXTERNAL_TABLE_CLEANUP_src.TABLE_NAME, EXTERNAL_TABLE_CLEANUP_src.ERROR_FLAG, CASE WHEN (EXTERNAL_TABLE_CLEANUP_src.NUM_ROWS = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXTERNAL_TABLE_CLEANUP_src.NUM_ROWS)::numeric(37,15) END AS NUM_ROWS, EXTERNAL_TABLE_CLEANUP_src.REMOVE, EXTERNAL_TABLE_CLEANUP_src.LOCATION, EXTERNAL_TABLE_CLEANUP_src.DIRECTORY_NAME, EXTERNAL_TABLE_CLEANUP_src.DIRECTORY_PATH, CASE WHEN (EXTERNAL_TABLE_CLEANUP_src.FILE_CREATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (EXTERNAL_TABLE_CLEANUP_src.FILE_CREATE_DATE)::timestamp END AS FILE_CREATE_DATE, EXTERNAL_TABLE_CLEANUP_src.FILE_EXISTS, EXTERNAL_TABLE_CLEANUP_src.batch_id, EXTERNAL_TABLE_CLEANUP_src.row_id, EXTERNAL_TABLE_CLEANUP_src.update_ts FROM teva_ingestion.EXTERNAL_TABLE_CLEANUP_src WHERE (EXTERNAL_TABLE_CLEANUP_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXTERNAL_TABLE_CLEANUP'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_CAREMARK_RX2 AS
SELECT EXT_CAREMARK_RX2_src.MD_ID, EXT_CAREMARK_RX2_src.MD_LAST_NAME, EXT_CAREMARK_RX2_src.MD_FIRST_NAME, EXT_CAREMARK_RX2_src.PRESCRIBER_NPI, EXT_CAREMARK_RX2_src.MD_ADDR1, EXT_CAREMARK_RX2_src.MD_ADDR2, EXT_CAREMARK_RX2_src.MD_CITY, EXT_CAREMARK_RX2_src.MD_STATE, EXT_CAREMARK_RX2_src.MD_ZIP, EXT_CAREMARK_RX2_src.NDC_NUMBER, EXT_CAREMARK_RX2_src.SHIP_DATE, CASE WHEN (EXT_CAREMARK_RX2_src.QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CAREMARK_RX2_src.QTY)::numeric(37,15) END AS QTY, EXT_CAREMARK_RX2_src.batch_id, EXT_CAREMARK_RX2_src.row_id, EXT_CAREMARK_RX2_src.update_ts FROM teva_ingestion.EXT_CAREMARK_RX2_src WHERE (EXT_CAREMARK_RX2_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_CAREMARK_RX2'::varchar(16))));

CREATE  VIEW teva_ingestion.EXT_CMOP_RX_DATA_TEVA_HIST AS
SELECT EXT_CMOP_RX_DATA_TEVA_HIST_src.CMOP, EXT_CMOP_RX_DATA_TEVA_HIST_src.VISN, EXT_CMOP_RX_DATA_TEVA_HIST_src.STATION_NUMBER, EXT_CMOP_RX_DATA_TEVA_HIST_src.STATION, EXT_CMOP_RX_DATA_TEVA_HIST_src.VA_PRODUCT, CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_RXS")::numeric(37,15) END AS "201012_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_QTY")::numeric(37,15) END AS "201012_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_30_DAY_RXS")::numeric(37,15) END AS "201012_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_RXS")::numeric(37,15) END AS "201101_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_QTY")::numeric(37,15) END AS "201101_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_30_DAY_RXS")::numeric(37,15) END AS "201101_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_RXS")::numeric(37,15) END AS "201102_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_QTY")::numeric(37,15) END AS "201102_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_30_DAY_RXS")::numeric(37,15) END AS "201102_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_RXS")::numeric(37,15) END AS "201103_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_QTY")::numeric(37,15) END AS "201103_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_30_DAY_RXS")::numeric(37,15) END AS "201103_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_RXS")::numeric(37,15) END AS "201104_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_QTY")::numeric(37,15) END AS "201104_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_30_DAY_RXS")::numeric(37,15) END AS "201104_30_DAY_RXS", EXT_CMOP_RX_DATA_TEVA_HIST_src.ZIP, EXT_CMOP_RX_DATA_TEVA_HIST_src.batch_id, EXT_CMOP_RX_DATA_TEVA_HIST_src.row_id, EXT_CMOP_RX_DATA_TEVA_HIST_src.update_ts FROM teva_ingestion.EXT_CMOP_RX_DATA_TEVA_HIST_src WHERE (EXT_CMOP_RX_DATA_TEVA_HIST_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_CMOP_RX_DATA_TEVA_HIST'::varchar(26))));

CREATE  VIEW teva_ingestion.EXT_IMS_DEA AS
SELECT EXT_IMS_DEA_src.IMS_ID, EXT_IMS_DEA_src.FIRST_NAME, EXT_IMS_DEA_src.LAST_NAME, EXT_IMS_DEA_src.DEA_NUM, EXT_IMS_DEA_src.DEA_EXPIR_DATE, EXT_IMS_DEA_src.DEA_STATUS, EXT_IMS_DEA_src.NPI, EXT_IMS_DEA_src.batch_id, EXT_IMS_DEA_src.row_id, EXT_IMS_DEA_src.update_ts FROM teva_ingestion.EXT_IMS_DEA_src WHERE (EXT_IMS_DEA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_DEA'::varchar(11))));

CREATE  VIEW teva_ingestion.EXT_NTIS AS
SELECT EXT_NTIS_src.DEA_NUM, EXT_NTIS_src.BUSINESS_ACTIVITY_CODE, EXT_NTIS_src.DRUG_SCHEDULES, EXT_NTIS_src.EXPIRATION_DATE, EXT_NTIS_src.COMPANY_NAME, EXT_NTIS_src.ADDRESS_LINE1, EXT_NTIS_src.ADDRESS_LINE2, EXT_NTIS_src.ADDRESS_LINE3, EXT_NTIS_src.CITY, EXT_NTIS_src.STATE, EXT_NTIS_src.ZIP_CODE, EXT_NTIS_src.BASC, EXT_NTIS_src.PAYMENT_INDICATOR, EXT_NTIS_src.CONTROLLED_SUBSTANCE_AUTH, EXT_NTIS_src.batch_id, EXT_NTIS_src.row_id, EXT_NTIS_src.update_ts FROM teva_ingestion.EXT_NTIS_src WHERE (EXT_NTIS_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_NTIS'::varchar(8))));

CREATE  VIEW teva_ingestion.EXT_SIEBEL_BUS_ACCTS_TO_VEEVA AS
SELECT EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.SIEBELID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.VEEVA_ID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.EXTERNAL_ID_VOD__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.NAME, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.RECORDTYPEID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.TYPE, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_STATUS_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_LOCATION_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_MASTER_ID_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ENDIT, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.batch_id, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.row_id, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.update_ts FROM teva_ingestion.EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src WHERE (EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_SIEBEL_BUS_ACCTS_TO_VEEVA'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA AS
SELECT EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.SIEBELID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.EXTERNAL_ID_VOD__C, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.VEEVA_ID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.INVEEVAALREADY, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.RECORDTYPEID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.FIRSTNAME, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.LASTNAME, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.batch_id, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.row_id, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.update_ts FROM teva_ingestion.EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src WHERE (EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_TW_ICS_ASI AS
SELECT EXT_TW_ICS_ASI_src.BP_NUMBER, EXT_TW_ICS_ASI_src.HCP_ID, EXT_TW_ICS_ASI_src.TRANSACTION_DATE, EXT_TW_ICS_ASI_src.INVOICE_NUMBER, EXT_TW_ICS_ASI_src.ACCOUNT_TYPE, EXT_TW_ICS_ASI_src.CLASS_OF_TRADE, EXT_TW_ICS_ASI_src.TERRITORY_ID, EXT_TW_ICS_ASI_src.AREA_ID, EXT_TW_ICS_ASI_src.SHIP_TO_STREET, EXT_TW_ICS_ASI_src.SHIP_TO_CITY, EXT_TW_ICS_ASI_src.SHIP_TO_STATE, EXT_TW_ICS_ASI_src.SHIP_TO_ZIP, CASE WHEN (EXT_TW_ICS_ASI_src.DOLLARS_PARAGARD = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_TW_ICS_ASI_src.DOLLARS_PARAGARD)::numeric(37,15) END AS DOLLARS_PARAGARD, CASE WHEN (EXT_TW_ICS_ASI_src.UNITS_PARAGARD = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_TW_ICS_ASI_src.UNITS_PARAGARD)::numeric(37,15) END AS UNITS_PARAGARD, EXT_TW_ICS_ASI_src.batch_id, EXT_TW_ICS_ASI_src.row_id, EXT_TW_ICS_ASI_src.update_ts FROM teva_ingestion.EXT_TW_ICS_ASI_src WHERE (EXT_TW_ICS_ASI_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_TW_ICS_ASI'::varchar(14))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Amrix_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Azilect_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rxnormalizationControl2014_backup AS
SELECT p.IMS_CLIENT_NUM_W AS ClientNo, p.IMS_REPORT_NUM_W_CNT AS RxReportNo, lpad(p.IMS_PRODUCT_GROUP_NUM, 9, '0'::varchar(1)) AS ProductGroupNo, p.IMS_REPORT_NUM_W_QTY AS CorrespondingUnitsReportNo, p.PRODUCT_NAME AS ProductGroupName, nf.DIVISOR AS Divisor, nf.MULTIPLIER AS Multiplier FROM (WSMP_ADMIN.DRM45_PRODUCT_2014 p JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_onc AS
SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = ANY (ARRAY['ONC'::varchar(3), 'TO'::varchar(2)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ceph_sales_roster AS
SELECT DIM_CSF_SALES_ROSTER_TEVA.EMAIL AS email, DIM_CSF_SALES_ROSTER_TEVA.FIRST_NAME AS first_name, DIM_CSF_SALES_ROSTER_TEVA.LAST_NAME AS last_name, NULL AS PASSWORD, CASE WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'REP'::varchar(3)) THEN 'Sales Representative'::varchar(20) WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'AD'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'RM'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) ELSE NULL END AS rep_desc, DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE AS rep_type FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((DIM_CSF_SALES_ROSTER_TEVA.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TR'::varchar(2), 'TN'::varchar(2)])) AND (DIM_CSF_SALES_ROSTER_TEVA.LAST_NAME <> 'Vacant'::varchar(6)) AND (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE IS NOT NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_accountsummary AS
SELECT STG_TB_DS_ACCOUNTS.ACCOUNT_ID, STG_TB_DS_ACCOUNTS.LOCATION_ID, STG_TB_DS_ACCOUNTS.ACCOUNT_NAME, STG_TB_DS_ACCOUNTS.ACCOUNT_CLASS, STG_TB_DS_ACCOUNTS.ADDRESS_1, STG_TB_DS_ACCOUNTS.ADDRESS_2, STG_TB_DS_ACCOUNTS.CITY, STG_TB_DS_ACCOUNTS.STATE, STG_TB_DS_ACCOUNTS.ZIP FROM WSMP_ADMIN.STG_TB_DS_ACCOUNTS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Touchpoint_Presentation AS
SELECT STG_TOUCHPOINT_PRESENTATION.CALL_ID, STG_TOUCHPOINT_PRESENTATION.CALL_ATTEMPT_ID, STG_TOUCHPOINT_PRESENTATION.PRESENTATION_ID, STG_TOUCHPOINT_PRESENTATION.PRODUCT, STG_TOUCHPOINT_PRESENTATION."POSITION", STG_TOUCHPOINT_PRESENTATION.ITEM_TYPE, STG_TOUCHPOINT_PRESENTATION.ITEM_DESCRIPTION, STG_TOUCHPOINT_PRESENTATION.QUANTITY FROM WSMP_ADMIN.STG_TOUCHPOINT_PRESENTATION;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Touchpoint_Call AS
SELECT STG_TOUCHPOINT_CALL.CALL_ID, STG_TOUCHPOINT_CALL.CALL_ATTEMPT_ID, STG_TOUCHPOINT_CALL.TOUCHPOINT_ID, STG_TOUCHPOINT_CALL.CLIENT_ID, STG_TOUCHPOINT_CALL.IMS_ID, STG_TOUCHPOINT_CALL.FIRST_NAME, STG_TOUCHPOINT_CALL.LAST_NAME, STG_TOUCHPOINT_CALL.CALL_TYPE, STG_TOUCHPOINT_CALL.CALL_DATE, STG_TOUCHPOINT_CALL.STATUS_CODE, STG_TOUCHPOINT_CALL.STATUS_DESCRIPTION, STG_TOUCHPOINT_CALL.REP_ID, STG_TOUCHPOINT_CALL.REP_FIRST_NAME, STG_TOUCHPOINT_CALL.REP_LAST_NAME FROM WSMP_ADMIN.STG_TOUCHPOINT_CALL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales_backup_2 AS
SELECT STG_ANDA_SALES.TRANSACTION_ID, to_char(STG_ANDA_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_ANDA_SALES.PRODUCT_BRAND, STG_ANDA_SALES.PRODUCT_NDC, STG_ANDA_SALES.PRODUCT_DESC, CASE mod(STG_ANDA_SALES.INVOICE_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_QTY)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_QTY)::varchar, '0'::varchar(1)) END AS INVOICE_QTY, CASE mod(STG_ANDA_SALES.INVOICE_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_UNITS)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_UNITS)::varchar, '0'::varchar(1)) END AS INVOICE_UNITS, CASE mod(STG_ANDA_SALES.INVOICE_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_COST)::varchar, '0'::varchar(1)) END AS INVOICE_COST, CASE mod(STG_ANDA_SALES.INVOICE_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_PACK_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_PACK_COST)::varchar, '0'::varchar(1)) END AS INVOICE_PACK_COST, CASE mod(STG_ANDA_SALES.INVOICE_UNIT_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_UNIT_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_UNIT_COST)::varchar, '0'::varchar(1)) END AS INVOICE_UNIT_COST, CASE mod(STG_ANDA_SALES.CONTRACT_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.CONTRACT_PACK_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.CONTRACT_PACK_COST)::varchar, '0'::varchar(1)) END AS CONTRACT_PACK_COST, CASE mod(STG_ANDA_SALES.CONTRACT_PURCHASES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.CONTRACT_PURCHASES)::int)::varchar ELSE rtrim((STG_ANDA_SALES.CONTRACT_PURCHASES)::varchar, '0'::varchar(1)) END AS CONTRACT_PURCHASES, STG_ANDA_SALES.CONTRACT_NUMBER, STG_ANDA_SALES.DISPENSING_LOCATION, STG_ANDA_SALES.DL_ADDRESS_1, STG_ANDA_SALES.DL_ADDRESS_2, STG_ANDA_SALES.DL_CITY, STG_ANDA_SALES.DL_STATE, STG_ANDA_SALES.DL_ZIP, STG_ANDA_SALES.DL_DEA_NUM, STG_ANDA_SALES.DEPOT_LOCATION, STG_ANDA_SALES.DEP_ADDRESS_1, STG_ANDA_SALES.DEP_ADDRESS_2, STG_ANDA_SALES.DEP_CITY, STG_ANDA_SALES.DEP_STATE, STG_ANDA_SALES.DEP_ZIP, STG_ANDA_SALES.DEP_DEA_NUM, CASE mod(STG_ANDA_SALES.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.UNIT_AP)::int)::varchar ELSE rtrim((STG_ANDA_SALES.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_ANDA_SALES.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.AP)::int)::varchar ELSE rtrim((STG_ANDA_SALES.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_ANDA_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_omnicare_sale AS
SELECT STG_OMNICARE_SALES.TRANSACTION_ID, to_char(STG_OMNICARE_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_OMNICARE_SALES.PRODUCT_BRAND, STG_OMNICARE_SALES.PRODUCT_NDC, STG_OMNICARE_SALES.PRODUCT_DESC, CASE mod(STG_OMNICARE_SALES.INVOICE_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_QTY)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_QTY)::varchar, '0'::varchar(1)) END AS INVOICE_QTY, CASE mod(STG_OMNICARE_SALES.INVOICE_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_UNITS)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_UNITS)::varchar, '0'::varchar(1)) END AS INVOICE_UNITS, CASE mod(STG_OMNICARE_SALES.INVOICE_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_COST)::varchar, '0'::varchar(1)) END AS INVOICE_COST, CASE mod(STG_OMNICARE_SALES.INVOICE_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_PACK_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_PACK_COST)::varchar, '0'::varchar(1)) END AS INVOICE_PACK_COST, CASE mod(STG_OMNICARE_SALES.INVOICE_UNIT_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_UNIT_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_UNIT_COST)::varchar, '0'::varchar(1)) END AS INVOICE_UNIT_COST, CASE mod(STG_OMNICARE_SALES.CONTRACT_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.CONTRACT_PACK_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.CONTRACT_PACK_COST)::varchar, '0'::varchar(1)) END AS CONTRACT_PACK_COST, CASE mod(STG_OMNICARE_SALES.CONTRACT_PURCHASES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.CONTRACT_PURCHASES)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.CONTRACT_PURCHASES)::varchar, '0'::varchar(1)) END AS CONTRACT_PURCHASES, STG_OMNICARE_SALES.CONTRACT_NUMBER, STG_OMNICARE_SALES.DISPENSING_LOCATION, STG_OMNICARE_SALES.DL_ADDRESS_1, STG_OMNICARE_SALES.DL_ADDRESS_2, STG_OMNICARE_SALES.DL_CITY, STG_OMNICARE_SALES.DL_STATE, STG_OMNICARE_SALES.DL_ZIP, STG_OMNICARE_SALES.DL_DEA_NUM, STG_OMNICARE_SALES.DEPOT_LOCATION, STG_OMNICARE_SALES.DEP_ADDRESS_1, STG_OMNICARE_SALES.DEP_ADDRESS_2, STG_OMNICARE_SALES.DEP_CITY, STG_OMNICARE_SALES.DEP_STATE, STG_OMNICARE_SALES.DEP_ZIP, STG_OMNICARE_SALES.DEP_DEA_NUM, CASE mod(STG_OMNICARE_SALES.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.UNIT_AP)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_OMNICARE_SALES.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.AP)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_OMNICARE_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_transactions AS
SELECT STG_TB_CB_TRANSACTIONS.ACCOUNT_ID, STG_TB_CB_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_CB_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_CB_TRANSACTIONS.NDC_CODE, STG_TB_CB_TRANSACTIONS.PRODUCT_NAME, STG_TB_CB_TRANSACTIONS.CONTRACT_ID, CASE mod(STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS)::varchar, '0'::varchar(1)) END AS CHARGEBACK_UNITS, CASE mod(STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS)::varchar, '0'::varchar(1)) END AS CHARGEBACK_DOLLARS, to_char(STG_TB_CB_TRANSACTIONS.RECEIPT_DATE, 'YYYY-MM-DD'::varchar(10)) AS RECEIPT_DATE, CASE mod(STG_TB_CB_TRANSACTIONS.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.UNIT_AP)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_TB_CB_TRANSACTIONS.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.AP)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.AP)::varchar, '0'::varchar(1)) END AS AP, STG_TB_CB_TRANSACTIONS.DEBIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS CREDIT_MEMO_DATE, STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.SETTLEMENT_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS SETTLEMENT_DATE, CASE mod(STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE)::varchar, '0'::varchar(1)) END AS CONTRACT_PRICE, STG_TB_CB_TRANSACTIONS.CONTRACT_ALIAS FROM WSMP_ADMIN.STG_TB_CB_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_transactions AS
SELECT STG_TB_DS_TRANSACTIONS.ACCOUNT_ID, STG_TB_DS_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_DS_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_DS_TRANSACTIONS.NDC_CODE, STG_TB_DS_TRANSACTIONS.PRODUCT_NAME, STG_TB_DS_TRANSACTIONS.TRANSACTION_TYPE, CASE mod(STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_UNITS, CASE mod(STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_DOLLARS, CASE mod(STG_TB_DS_TRANSACTIONS.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.UNIT_AP)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_TB_DS_TRANSACTIONS.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.AP)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_TB_DS_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_rems_account AS
SELECT stg.ASI_ACCOUNT_ID AS HCP_ID, align.TERRITORY_NUM AS territory_num, stg.SITE_NAME AS ACCOUNT_NAME, stg.ADDRESS_1 AS ADDRESS1, stg.ADDRESS_2 AS ADDRESS2, NULL AS ADDRESS3, stg.CITY, stg.STATE, stg.ZIP_CODE AS ZIP, 'Y'::varchar(1) AS PRIMARY_ADDRESS, stg.PHONE_NUMBER, fact.IMS_ORG_ID AS EXTERNAL_ID, 'HOSPITAL'::varchar(8) AS CUSTOMER_TYPE, NULL AS BPNUMBER, NULL AS SUBTYPE, NULL AS CM_ID FROM ((WSMP_ADMIN.STG_REMS_FACILITY stg LEFT JOIN (SELECT kc_zip_to_territory.ZIP, kc_zip_to_territory.CITY, kc_zip_to_territory.STATE, kc_zip_to_territory.TERRITORY_NUM, kc_zip_to_territory.IS_A_MIRROR, kc_zip_to_territory.MIRROR_TERRITORY_NUM, kc_zip_to_territory.TERRITORY_NAME, kc_zip_to_territory.AREA_NAME, kc_zip_to_territory.REGION_NAME, kc_zip_to_territory.SALES_FORCE_ID, kc_zip_to_territory.ORGANIZATION_CODE, kc_zip_to_territory.COMMENTS FROM WSMP_ADMIN.KC_ZIP_TO_TERRITORY WHERE (kc_zip_to_territory.SALES_FORCE_ID = 'TB'::varchar(2))) align ON ((substr(stg.ZIP_CODE, 1, 5) = align.ZIP))) LEFT JOIN WSMP_ADMIN.HCOS_IDENTIFIER_FACT fact ON (((fact.IDENTIFIER_ID = 15::numeric(18,0)) AND (fact.IDENTIFIER = stg.NPI)))) WHERE (stg.VEEVA_ACCOUNT_ID IS NULL);

CREATE  VIEW teva_ingestion.addresses AS
 SELECT CASE WHEN (addresses_src.ADDR_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(addresses_src.ADDR_ID))::numeric(38,0) END AS ADDR_ID,
        btrim(addresses_src.LINE_1) AS LINE_1,
        btrim(addresses_src.LINE_2) AS LINE_2,
        btrim(addresses_src.LINE_3) AS LINE_3,
        btrim(addresses_src.CITY) AS CITY,
        btrim(addresses_src.ST_ABBR) AS ST_ABBR,
        btrim(addresses_src.POSTAL_CD) AS POSTAL_CD,
        btrim(addresses_src.CNTRY_ISO_ABBR) AS CNTRY_ISO_ABBR,
        btrim(addresses_src.CRT_USER) AS CRT_USER,
        CASE WHEN (addresses_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(addresses_src.CRT_DT))::date END AS CRT_DT,
        btrim(addresses_src.UPD_USER) AS UPD_USER,
        CASE WHEN (addresses_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(addresses_src.UPD_DT))::date END AS UPD_DT,
        addresses_src.batch_id,
        addresses_src.row_id,
        addresses_src.update_ts
 FROM teva_ingestion.addresses_src
 WHERE (addresses_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'ADDRESSES'::varchar(9))));

CREATE  VIEW teva_ingestion.associates AS
 SELECT btrim(associates_src.TEVA_ID) AS TEVA_ID,
        btrim(associates_src.HR_ID) AS HR_ID,
        btrim(associates_src.CRT_USER) AS CRT_USER,
        CASE WHEN (associates_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.CRT_DT))::date END AS CRT_DT,
        btrim(associates_src.UPD_USER) AS UPD_USER,
        CASE WHEN (associates_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.UPD_DT))::date END AS UPD_DT,
        CASE WHEN (associates_src.HIRE_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.HIRE_DT))::date END AS HIRE_DT,
        btrim(associates_src.LOGON_ID) AS LOGON_ID,
        btrim(associates_src.REPORTS_TO) AS REPORTS_TO,
        btrim(associates_src.STAT_CD) AS STAT_CD,
        btrim(associates_src.TYPE_CD) AS TYPE_CD,
        btrim(associates_src.FULL_TIME) AS FULL_TIME,
        btrim(associates_src.EEO_CAT) AS EEO_CAT,
        btrim(associates_src.EXEMPT) AS EXEMPT,
        btrim(associates_src.EXPENSE_COST_CTR) AS EXPENSE_COST_CTR,
        CASE WHEN (associates_src.HRS_PER_WK = ''::varchar) THEN NULL::numeric(5,2) ELSE (btrim(associates_src.HRS_PER_WK))::numeric(5,2) END AS HRS_PER_WK,
        btrim(associates_src.MARITAL_STAT) AS MARITAL_STAT,
        btrim(associates_src.RACE) AS RACE,
        btrim(associates_src.SSN) AS SSN,
        btrim(associates_src.EMAIL) AS EMAIL,
        CASE WHEN (associates_src.BIRTH_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.BIRTH_DT))::date END AS BIRTH_DT,
        btrim(associates_src.COUNTRY_ID) AS COUNTRY_ID,
        btrim(associates_src.DFLT_CURR_ID) AS DFLT_CURR_ID,
        btrim(associates_src.TERR_ID) AS TERR_ID,
        btrim(associates_src.OFFICE) AS OFFICE,
        CASE WHEN (associates_src.PRSN_SYS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(associates_src.PRSN_SYS_ID))::numeric(38,0) END AS PRSN_SYS_ID,
        btrim(associates_src.LANGUAGE) AS LANGUAGE,
        btrim(associates_src."POSITION") AS "POSITION",
        CASE WHEN (associates_src.TERM_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.TERM_DT))::date END AS TERM_DT,
        CASE WHEN (associates_src.LAST_WRK_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.LAST_WRK_DT))::date END AS LAST_WRK_DT,
        CASE WHEN (associates_src.AUTH_LIMIT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(associates_src.AUTH_LIMIT))::numeric(12,2) END AS AUTH_LIMIT,
        btrim(associates_src.VEHICLE) AS VEHICLE,
        CASE WHEN (associates_src.VACATION_DAYS = ''::varchar) THEN NULL::numeric(6,3) ELSE (btrim(associates_src.VACATION_DAYS))::numeric(6,3) END AS VACATION_DAYS,
        CASE WHEN (associates_src.CHK_REQ_LIMIT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(associates_src.CHK_REQ_LIMIT))::numeric(12,2) END AS CHK_REQ_LIMIT,
        btrim(associates_src.EXPENSE_REPORT_APPROVER) AS EXPENSE_REPORT_APPROVER,
        btrim(associates_src.LOC_CD) AS LOC_CD,
        btrim(associates_src.PAY_CD) AS PAY_CD,
        btrim(associates_src.ED_CD) AS ED_CD,
        CASE WHEN (associates_src.ED_CD_DT = ''::varchar) THEN NULL::date ELSE (btrim(associates_src.ED_CD_DT))::date END AS ED_CD_DT,
        btrim(associates_src.JOB_CD) AS JOB_CD,
        btrim(associates_src.CNTRY_CITIZENSHIP) AS CNTRY_CITIZENSHIP,
        btrim(associates_src.DISABLED) AS DISABLED,
        btrim(associates_src.VIETNAM_VET) AS VIETNAM_VET,
        btrim(associates_src.EMERGENCY_CONTACT_NAME) AS EMERGENCY_CONTACT_NAME,
        btrim(associates_src.EMERGENCY_CONTACT_RELATIONSHIP) AS EMERGENCY_CONTACT_RELATIONSHIP,
        btrim(associates_src.EMERGENCY_CONTACT_PHONE) AS EMERGENCY_CONTACT_PHONE,
        btrim(associates_src.ADP_DEPT_NUM) AS ADP_DEPT_NUM,
        CASE WHEN (associates_src.VACATION_YR = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(associates_src.VACATION_YR))::numeric(4,0) END AS VACATION_YR,
        btrim(associates_src.FIN_AUTH_COMMENTS) AS FIN_AUTH_COMMENTS,
        btrim(associates_src.EEO_CAT_HR_UPDT) AS EEO_CAT_HR_UPDT,
        btrim(associates_src.EXPENSE_REPORTING) AS EXPENSE_REPORTING,
        btrim(associates_src.COMPANY_ID) AS COMPANY_ID,
        btrim(associates_src.CHECK_REQUEST_APPROVER) AS CHECK_REQUEST_APPROVER,
        btrim(associates_src.INVOICE_APPROVER) AS INVOICE_APPROVER,
        btrim(associates_src.PHANTOM_IND) AS PHANTOM_IND,
        btrim(associates_src.PAYROLL_COST_CTR) AS PAYROLL_COST_CTR,
        btrim(associates_src.SAMPLE_AUTH) AS SAMPLE_AUTH,
        btrim(associates_src.ORACLE_STRING) AS ORACLE_STRING,
        associates_src.batch_id,
        associates_src.row_id,
        associates_src.update_ts
 FROM teva_ingestion.associates_src
 WHERE (associates_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'ASSOCIATES'::varchar(10))));

CREATE  VIEW teva_ingestion.aud_associates AS
 SELECT btrim(aud_associates_src.TEVA_ID) AS TEVA_ID,
        btrim(aud_associates_src.HR_ID) AS HR_ID,
        btrim(aud_associates_src.CRT_USER) AS CRT_USER,
        CASE WHEN (aud_associates_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.CRT_DT))::date END AS CRT_DT,
        btrim(aud_associates_src.UPD_USER) AS UPD_USER,
        CASE WHEN (aud_associates_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.UPD_DT))::date END AS UPD_DT,
        CASE WHEN (aud_associates_src.HIRE_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.HIRE_DT))::date END AS HIRE_DT,
        btrim(aud_associates_src.LOGON_ID) AS LOGON_ID,
        btrim(aud_associates_src.REPORTS_TO) AS REPORTS_TO,
        btrim(aud_associates_src.STAT_CD) AS STAT_CD,
        btrim(aud_associates_src.TYPE_CD) AS TYPE_CD,
        btrim(aud_associates_src.FULL_TIME) AS FULL_TIME,
        btrim(aud_associates_src.EEO_CAT) AS EEO_CAT,
        btrim(aud_associates_src.EXEMPT) AS EXEMPT,
        btrim(aud_associates_src.EXPENSE_COST_CTR) AS EXPENSE_COST_CTR,
        CASE WHEN (aud_associates_src.HRS_PER_WK = ''::varchar) THEN NULL::numeric(5,2) ELSE (btrim(aud_associates_src.HRS_PER_WK))::numeric(5,2) END AS HRS_PER_WK,
        btrim(aud_associates_src.MARITAL_STAT) AS MARITAL_STAT,
        btrim(aud_associates_src.RACE) AS RACE,
        btrim(aud_associates_src.SSN) AS SSN,
        btrim(aud_associates_src.EMAIL) AS EMAIL,
        CASE WHEN (aud_associates_src.BIRTH_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.BIRTH_DT))::date END AS BIRTH_DT,
        btrim(aud_associates_src.COUNTRY_ID) AS COUNTRY_ID,
        btrim(aud_associates_src.DFLT_CURR_ID) AS DFLT_CURR_ID,
        btrim(aud_associates_src.TERR_ID) AS TERR_ID,
        btrim(aud_associates_src.OFFICE) AS OFFICE,
        CASE WHEN (aud_associates_src.PRSN_SYS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(aud_associates_src.PRSN_SYS_ID))::numeric(38,0) END AS PRSN_SYS_ID,
        btrim(aud_associates_src.LANGUAGE) AS LANGUAGE,
        btrim(aud_associates_src."POSITION") AS "POSITION",
        CASE WHEN (aud_associates_src.TERM_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.TERM_DT))::date END AS TERM_DT,
        CASE WHEN (aud_associates_src.LAST_WRK_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.LAST_WRK_DT))::date END AS LAST_WRK_DT,
        CASE WHEN (aud_associates_src.AUTH_LIMIT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(aud_associates_src.AUTH_LIMIT))::numeric(12,2) END AS AUTH_LIMIT,
        btrim(aud_associates_src.VEHICLE) AS VEHICLE,
        CASE WHEN (aud_associates_src.VACATION_DAYS = ''::varchar) THEN NULL::numeric(6,3) ELSE (btrim(aud_associates_src.VACATION_DAYS))::numeric(6,3) END AS VACATION_DAYS,
        CASE WHEN (aud_associates_src."TIMESTAMP" = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src."TIMESTAMP"))::date END AS "TIMESTAMP",
        btrim(aud_associates_src.ACTION) AS ACTION,
        CASE WHEN (aud_associates_src.CHK_REQ_LIMIT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(aud_associates_src.CHK_REQ_LIMIT))::numeric(12,2) END AS CHK_REQ_LIMIT,
        btrim(aud_associates_src.EXPENSE_REPORT_APPROVER) AS EXPENSE_REPORT_APPROVER,
        btrim(aud_associates_src.LOC_CD) AS LOC_CD,
        btrim(aud_associates_src.PAY_CD) AS PAY_CD,
        btrim(aud_associates_src.ED_CD) AS ED_CD,
        CASE WHEN (aud_associates_src.ED_CD_DT = ''::varchar) THEN NULL::date ELSE (btrim(aud_associates_src.ED_CD_DT))::date END AS ED_CD_DT,
        btrim(aud_associates_src.JOB_CD) AS JOB_CD,
        btrim(aud_associates_src.CNTRY_CITIZENSHIP) AS CNTRY_CITIZENSHIP,
        btrim(aud_associates_src.DISABLED) AS DISABLED,
        btrim(aud_associates_src.VIETNAM_VET) AS VIETNAM_VET,
        btrim(aud_associates_src.EMERGENCY_CONTACT_NAME) AS EMERGENCY_CONTACT_NAME,
        btrim(aud_associates_src.EMERGENCY_CONTACT_RELATIONSHIP) AS EMERGENCY_CONTACT_RELATIONSHIP,
        btrim(aud_associates_src.EMERGENCY_CONTACT_PHONE) AS EMERGENCY_CONTACT_PHONE,
        btrim(aud_associates_src.ADP_DEPT_NUM) AS ADP_DEPT_NUM,
        btrim(aud_associates_src.EEO_CAT_HR_UPDT) AS EEO_CAT_HR_UPDT,
        btrim(aud_associates_src.COMPANY_ID) AS COMPANY_ID,
        btrim(aud_associates_src.EXPENSE_REPORTING) AS EXPENSE_REPORTING,
        btrim(aud_associates_src.PHANTOM_IND) AS PHANTOM_IND,
        btrim(aud_associates_src.CHECK_REQUEST_APPROVER) AS CHECK_REQUEST_APPROVER,
        btrim(aud_associates_src.INVOICE_APPROVER) AS INVOICE_APPROVER,
        CASE WHEN (aud_associates_src.VACATION_YR = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(aud_associates_src.VACATION_YR))::numeric(4,0) END AS VACATION_YR,
        btrim(aud_associates_src.FIN_AUTH_COMMENTS) AS FIN_AUTH_COMMENTS,
        btrim(aud_associates_src.PAYROLL_COST_CTR) AS PAYROLL_COST_CTR,
        btrim(aud_associates_src.SAMPLE_AUTH) AS SAMPLE_AUTH,
        btrim(aud_associates_src.ORACLE_STRING) AS ORACLE_STRING,
        aud_associates_src.batch_id,
        aud_associates_src.row_id,
        aud_associates_src.update_ts
 FROM teva_ingestion.aud_associates_src
 WHERE (aud_associates_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'AUD_ASSOCIATES'::varchar(14))));

CREATE  VIEW teva_ingestion.c_bo_hce_alt_identifier AS
 SELECT btrim((c_bo_hce_alt_identifier_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(c_bo_hce_alt_identifier_src.CREATOR) AS CREATOR,
        CASE WHEN (c_bo_hce_alt_identifier_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_hce_alt_identifier_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(c_bo_hce_alt_identifier_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (c_bo_hce_alt_identifier_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_hce_alt_identifier_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (c_bo_hce_alt_identifier_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (c_bo_hce_alt_identifier_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(c_bo_hce_alt_identifier_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (c_bo_hce_alt_identifier_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_hce_alt_identifier_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((c_bo_hce_alt_identifier_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (c_bo_hce_alt_identifier_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (c_bo_hce_alt_identifier_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (c_bo_hce_alt_identifier_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (c_bo_hce_alt_identifier_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_hce_alt_identifier_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim((c_bo_hce_alt_identifier_src.TVCMID)::varchar(14)) AS TVCMID,
        btrim(c_bo_hce_alt_identifier_src.ALTERNATE_ID_VALUE) AS ALTERNATE_ID_VALUE,
        btrim(c_bo_hce_alt_identifier_src.ALTERNATE_ID_TYPE) AS ALTERNATE_ID_TYPE,
        btrim((c_bo_hce_alt_identifier_src.SOURCE_DEACT_REASON_CODE)::varchar(1)) AS SOURCE_DEACT_REASON_CODE,
        btrim(c_bo_hce_alt_identifier_src.SOURCE_DEACT_REASON_DESC) AS SOURCE_DEACT_REASON_DESC,
        btrim(c_bo_hce_alt_identifier_src.IDENTIFIER_CAT) AS IDENTIFIER_CAT,
        btrim(c_bo_hce_alt_identifier_src.STATUS) AS STATUS,
        btrim(c_bo_hce_alt_identifier_src.STATE) AS STATE,
        c_bo_hce_alt_identifier_src.batch_id,
        c_bo_hce_alt_identifier_src.row_id,
        c_bo_hce_alt_identifier_src.update_ts
 FROM teva_ingestion.c_bo_hce_alt_identifier_src
 WHERE (c_bo_hce_alt_identifier_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_HCE_ALT_IDENTIFIER'::varchar(23))));

CREATE  VIEW teva_ingestion.C_BO_HCE_RAW_DEA AS
 SELECT btrim((C_BO_HCE_RAW_DEA_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(C_BO_HCE_RAW_DEA_src.CREATOR) AS CREATOR,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCE_RAW_DEA_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(C_BO_HCE_RAW_DEA_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCE_RAW_DEA_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(C_BO_HCE_RAW_DEA_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCE_RAW_DEA_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((C_BO_HCE_RAW_DEA_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCE_RAW_DEA_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim((C_BO_HCE_RAW_DEA_src.TVCMID)::varchar(14)) AS TVCMID,
        btrim(C_BO_HCE_RAW_DEA_src.IMS_ID) AS IMS_ID,
        btrim(C_BO_HCE_RAW_DEA_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(C_BO_HCE_RAW_DEA_src.NAME) AS NAME,
        btrim(C_BO_HCE_RAW_DEA_src.ADDITIONAL_COMPANY_INFO) AS ADDITIONAL_COMPANY_INFO,
        btrim(C_BO_HCE_RAW_DEA_src.ADDRESS_LINE1) AS ADDRESS_LINE1,
        btrim(C_BO_HCE_RAW_DEA_src.ADDRESS_LINE2) AS ADDRESS_LINE2,
        btrim(C_BO_HCE_RAW_DEA_src.CITY) AS CITY,
        btrim(C_BO_HCE_RAW_DEA_src.STATE) AS STATE,
        btrim(C_BO_HCE_RAW_DEA_src.ZIP) AS ZIP,
        btrim((C_BO_HCE_RAW_DEA_src.BUSINESS_ACTIVITY_CODE)::varchar(1)) AS BUSINESS_ACTIVITY_CODE,
        btrim(C_BO_HCE_RAW_DEA_src.DRUG_SCHEDULES) AS DRUG_SCHEDULES,
        CASE WHEN (C_BO_HCE_RAW_DEA_src.EXPIRATION_DATE = ''::varchar) THEN NULL::date ELSE (btrim(C_BO_HCE_RAW_DEA_src.EXPIRATION_DATE))::date END AS EXPIRATION_DATE,
        btrim((C_BO_HCE_RAW_DEA_src.BUSINESS_ACTIVITY_SUB_CODE)::varchar(1)) AS BUSINESS_ACTIVITY_SUB_CODE,
        C_BO_HCE_RAW_DEA_src.batch_id,
        C_BO_HCE_RAW_DEA_src.row_id,
        C_BO_HCE_RAW_DEA_src.update_ts
 FROM teva_ingestion.C_BO_HCE_RAW_DEA_src
 WHERE (C_BO_HCE_RAW_DEA_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_HCE_RAW_DEA'::varchar(16))));

CREATE  VIEW teva_ingestion.C_BO_HCP_DETAIL AS
 SELECT btrim((C_BO_HCP_DETAIL_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(C_BO_HCP_DETAIL_src.CREATOR) AS CREATOR,
        CASE WHEN (C_BO_HCP_DETAIL_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCP_DETAIL_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(C_BO_HCP_DETAIL_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (C_BO_HCP_DETAIL_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCP_DETAIL_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (C_BO_HCP_DETAIL_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (C_BO_HCP_DETAIL_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(C_BO_HCP_DETAIL_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (C_BO_HCP_DETAIL_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_HCP_DETAIL_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((C_BO_HCP_DETAIL_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (C_BO_HCP_DETAIL_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (C_BO_HCP_DETAIL_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (C_BO_HCP_DETAIL_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (C_BO_HCP_DETAIL_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_HCP_DETAIL_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim((C_BO_HCP_DETAIL_src.TVCMID)::varchar(14)) AS TVCMID,
        btrim(C_BO_HCP_DETAIL_src.IMS_PRESCRIBER_ID) AS IMS_PRESCRIBER_ID,
        btrim(C_BO_HCP_DETAIL_src.PREFIX) AS PREFIX,
        btrim(C_BO_HCP_DETAIL_src.FIRST_NAME) AS FIRST_NAME,
        btrim(C_BO_HCP_DETAIL_src.LAST_NAME) AS LAST_NAME,
        btrim(C_BO_HCP_DETAIL_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(C_BO_HCP_DETAIL_src.SUFFIX) AS SUFFIX,
        btrim(C_BO_HCP_DETAIL_src.HEALTHCARE_PROF_STATUS_CD) AS HEALTHCARE_PROF_STATUS_CD,
        CASE WHEN (C_BO_HCP_DETAIL_src.YEAR_OF_BIRTH = ''::varchar) THEN NULL::date ELSE (btrim(C_BO_HCP_DETAIL_src.YEAR_OF_BIRTH))::date END AS YEAR_OF_BIRTH,
        CASE WHEN (C_BO_HCP_DETAIL_src.DATE_OF_DEATH = ''::varchar) THEN NULL::date ELSE (btrim(C_BO_HCP_DETAIL_src.DATE_OF_DEATH))::date END AS DATE_OF_DEATH,
        btrim(C_BO_HCP_DETAIL_src.GENDER_CODE) AS GENDER_CODE,
        btrim(C_BO_HCP_DETAIL_src.TEVA_SPECIALTY_CODE) AS TEVA_SPECIALTY_CODE,
        C_BO_HCP_DETAIL_src.batch_id,
        C_BO_HCP_DETAIL_src.row_id,
        C_BO_HCP_DETAIL_src.update_ts
 FROM teva_ingestion.C_BO_HCP_DETAIL_src
 WHERE (C_BO_HCP_DETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_HCP_DETAIL'::varchar(15))));

CREATE  VIEW teva_ingestion.C_BO_IMS_FLAG AS
 SELECT btrim((C_BO_IMS_FLAG_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(C_BO_IMS_FLAG_src.CREATOR) AS CREATOR,
        CASE WHEN (C_BO_IMS_FLAG_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_IMS_FLAG_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(C_BO_IMS_FLAG_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (C_BO_IMS_FLAG_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_IMS_FLAG_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (C_BO_IMS_FLAG_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (C_BO_IMS_FLAG_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(C_BO_IMS_FLAG_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (C_BO_IMS_FLAG_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_IMS_FLAG_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((C_BO_IMS_FLAG_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (C_BO_IMS_FLAG_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (C_BO_IMS_FLAG_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (C_BO_IMS_FLAG_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (C_BO_IMS_FLAG_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_IMS_FLAG_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim(C_BO_IMS_FLAG_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim((C_BO_IMS_FLAG_src.FLAG_VALUE)::varchar(1)) AS FLAG_VALUE,
        CASE WHEN (C_BO_IMS_FLAG_src.EFFECTIVE_DATE = ''::varchar) THEN NULL::date ELSE (btrim(C_BO_IMS_FLAG_src.EFFECTIVE_DATE))::date END AS EFFECTIVE_DATE,
        btrim((C_BO_IMS_FLAG_src.HCP_DETAIL_ID)::varchar(14)) AS HCP_DETAIL_ID,
        C_BO_IMS_FLAG_src.batch_id,
        C_BO_IMS_FLAG_src.row_id,
        C_BO_IMS_FLAG_src.update_ts
 FROM teva_ingestion.C_BO_IMS_FLAG_src
 WHERE (C_BO_IMS_FLAG_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_IMS_FLAG'::varchar(13))));

CREATE  VIEW teva_ingestion.C_BO_TEVA_FLAG AS
 SELECT btrim((C_BO_TEVA_FLAG_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(C_BO_TEVA_FLAG_src.CREATOR) AS CREATOR,
        CASE WHEN (C_BO_TEVA_FLAG_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_TEVA_FLAG_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(C_BO_TEVA_FLAG_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (C_BO_TEVA_FLAG_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_TEVA_FLAG_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (C_BO_TEVA_FLAG_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (C_BO_TEVA_FLAG_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(C_BO_TEVA_FLAG_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (C_BO_TEVA_FLAG_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp(6) ELSE (btrim(C_BO_TEVA_FLAG_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((C_BO_TEVA_FLAG_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (C_BO_TEVA_FLAG_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (C_BO_TEVA_FLAG_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (C_BO_TEVA_FLAG_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (C_BO_TEVA_FLAG_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(C_BO_TEVA_FLAG_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim(C_BO_TEVA_FLAG_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim(C_BO_TEVA_FLAG_src.FLAG_VALUE) AS FLAG_VALUE,
        CASE WHEN (C_BO_TEVA_FLAG_src.EFFECTIVE_DATE = ''::varchar) THEN NULL::date ELSE (btrim(C_BO_TEVA_FLAG_src.EFFECTIVE_DATE))::date END AS EFFECTIVE_DATE,
        btrim((C_BO_TEVA_FLAG_src.HCP_DETAIL_ID)::varchar(14)) AS HCP_DETAIL_ID,
        C_BO_TEVA_FLAG_src.batch_id,
        C_BO_TEVA_FLAG_src.row_id,
        C_BO_TEVA_FLAG_src.update_ts
 FROM teva_ingestion.C_BO_TEVA_FLAG_src
 WHERE (C_BO_TEVA_FLAG_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_TEVA_FLAG'::varchar(14))));

CREATE  VIEW teva_ingestion.c_bo_teva_sample_elig AS
 SELECT btrim((c_bo_teva_sample_elig_src.ROWID_OBJECT)::varchar(14)) AS ROWID_OBJECT,
        btrim(c_bo_teva_sample_elig_src.CREATOR) AS CREATOR,
        CASE WHEN (c_bo_teva_sample_elig_src.CREATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_teva_sample_elig_src.CREATE_DATE))::timestamp END AS CREATE_DATE,
        btrim(c_bo_teva_sample_elig_src.UPDATED_BY) AS UPDATED_BY,
        CASE WHEN (c_bo_teva_sample_elig_src.LAST_UPDATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_teva_sample_elig_src.LAST_UPDATE_DATE))::timestamp END AS LAST_UPDATE_DATE,
        CASE WHEN (c_bo_teva_sample_elig_src.CONSOLIDATION_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.CONSOLIDATION_IND))::int END AS CONSOLIDATION_IND,
        CASE WHEN (c_bo_teva_sample_elig_src.DELETED_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.DELETED_IND))::int END AS DELETED_IND,
        btrim(c_bo_teva_sample_elig_src.DELETED_BY) AS DELETED_BY,
        CASE WHEN (c_bo_teva_sample_elig_src.DELETED_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(c_bo_teva_sample_elig_src.DELETED_DATE))::timestamp END AS DELETED_DATE,
        btrim((c_bo_teva_sample_elig_src.LAST_ROWID_SYSTEM)::varchar(14)) AS LAST_ROWID_SYSTEM,
        CASE WHEN (c_bo_teva_sample_elig_src.DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.DIRTY_IND))::int END AS DIRTY_IND,
        CASE WHEN (c_bo_teva_sample_elig_src.INTERACTION_ID = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.INTERACTION_ID))::int END AS INTERACTION_ID,
        CASE WHEN (c_bo_teva_sample_elig_src.HUB_STATE_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.HUB_STATE_IND))::int END AS HUB_STATE_IND,
        CASE WHEN (c_bo_teva_sample_elig_src.CM_DIRTY_IND = ''::varchar) THEN NULL::int ELSE (btrim(c_bo_teva_sample_elig_src.CM_DIRTY_IND))::int END AS CM_DIRTY_IND,
        btrim((c_bo_teva_sample_elig_src.TVCMID)::varchar(14)) AS TVCMID,
        btrim(c_bo_teva_sample_elig_src.CERTIFICATION_DESC) AS CERTIFICATION_DESC,
        btrim(c_bo_teva_sample_elig_src.SLN) AS SLN,
        btrim(c_bo_teva_sample_elig_src.SLN_STATE) AS SLN_STATE,
        CASE WHEN (c_bo_teva_sample_elig_src.SLN_EXPIRATION_DATE = ''::varchar) THEN NULL::date ELSE (btrim(c_bo_teva_sample_elig_src.SLN_EXPIRATION_DATE))::date END AS SLN_EXPIRATION_DATE,
        btrim(c_bo_teva_sample_elig_src.SLN_STATUS_CODE) AS SLN_STATUS_CODE,
        btrim(c_bo_teva_sample_elig_src.SLN_STATUS_DESC) AS SLN_STATUS_DESC,
        btrim(c_bo_teva_sample_elig_src.TEVA_SAMPLE_ELIG_FLAG) AS TEVA_SAMPLE_ELIG_FLAG,
        btrim(c_bo_teva_sample_elig_src.TEVA_SCHED_IV_ELIG_FLAG) AS TEVA_SCHED_IV_ELIG_FLAG,
        btrim(c_bo_teva_sample_elig_src.TEVA_SCHED_V_ELIG_FLAG) AS TEVA_SCHED_V_ELIG_FLAG,
        btrim(c_bo_teva_sample_elig_src.PROFESSION_SHORT_DESC) AS PROFESSION_SHORT_DESC,
        btrim(c_bo_teva_sample_elig_src.TEVA_SPECIALTY_CODE) AS TEVA_SPECIALTY_CODE,
        btrim(c_bo_teva_sample_elig_src.CERTIFICATION_CODE) AS CERTIFICATION_CODE,
        c_bo_teva_sample_elig_src.batch_id,
        c_bo_teva_sample_elig_src.row_id,
        c_bo_teva_sample_elig_src.update_ts
 FROM teva_ingestion.c_bo_teva_sample_elig_src
 WHERE (c_bo_teva_sample_elig_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'C_BO_TEVA_SAMPLE_ELIG'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_ATTENDEE AS
 SELECT btrim(EXT_AHM_EVENT_ATTENDEE_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.EMPLOYEE_ID) AS EMPLOYEE_ID,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOMER_ID) AS CUSTOMER_ID,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_ID) AS ATTENDEE_ID,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_LAST_NAME) AS ATTENDEE_LAST_NAME,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_FIRST_NAME) AS ATTENDEE_FIRST_NAME,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_MIDDLE_NAME) AS ATTENDEE_MIDDLE_NAME,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_TITLE) AS ATTENDEE_TITLE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_SPECIALTY) AS ATTENDEE_SPECIALTY,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_DEGREE) AS ATTENDEE_DEGREE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_ADDRESS_LINE_1) AS ATTENDEE_ADDRESS_LINE_1,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_ADDRESS_LINE_2) AS ATTENDEE_ADDRESS_LINE_2,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_ADDRESS_LINE_3) AS ATTENDEE_ADDRESS_LINE_3,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_ADDRESS_LINE_4) AS ATTENDEE_ADDRESS_LINE_4,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_CITY) AS ATTENDEE_CITY,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_STATE_PROVINCE) AS ATTENDEE_STATE_PROVINCE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_POSTAL_CODE) AS ATTENDEE_POSTAL_CODE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_POSTAL_EXTENDED_CODE) AS ATTENDEE_POSTAL_EXTENDED_CODE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_COUNTRY_CODE) AS ATTENDEE_COUNTRY_CODE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_PHONE) AS ATTENDEE_PHONE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_FAX) AS ATTENDEE_FAX,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_EMAIL) AS ATTENDEE_EMAIL,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.IMS_NUMBER) AS IMS_NUMBER,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ME_NUMBER) AS ME_NUMBER,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.NPI_NUMBER) AS NPI_NUMBER,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDEE_CATEGORY_CODE) AS ATTENDEE_CATEGORY_CODE,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.ATTENDED) AS ATTENDED,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.MEAL) AS MEAL,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.NON_HCP_COUNT) AS NON_HCP_COUNT,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.OTHER_HCP_COUNT) AS OTHER_HCP_COUNT,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_ATTENDEE_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_ATTENDEE_src.batch_id,
        EXT_AHM_EVENT_ATTENDEE_src.row_id,
        EXT_AHM_EVENT_ATTENDEE_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_ATTENDEE_src
 WHERE (EXT_AHM_EVENT_ATTENDEE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_EVENT_ATTENDEE'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_EXPENSE AS
 SELECT btrim(EXT_AHM_EVENT_EXPENSE_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_EXPENSE_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_EXPENSE_src.PAYMENT_ID) AS PAYMENT_ID,
        btrim(EXT_AHM_EVENT_EXPENSE_src.EXPENSE_CATEGORY) AS EXPENSE_CATEGORY,
        CASE WHEN (EXT_AHM_EVENT_EXPENSE_src.AMOUNT = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_AHM_EVENT_EXPENSE_src.AMOUNT))::numeric(10,2) END AS AMOUNT,
        btrim(EXT_AHM_EVENT_EXPENSE_src.REMIT_TO_ID) AS REMIT_TO_ID,
        btrim(EXT_AHM_EVENT_EXPENSE_src.RECIPIENT_ID) AS RECIPIENT_ID,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CHECK_NUMBER) AS CHECK_NUMBER,
        CASE WHEN (EXT_AHM_EVENT_EXPENSE_src.CHECK_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_EVENT_EXPENSE_src.CHECK_DATE))::timestamp END AS CHECK_DATE,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_EXPENSE_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_EXPENSE_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_EXPENSE_src.batch_id,
        EXT_AHM_EVENT_EXPENSE_src.row_id,
        EXT_AHM_EVENT_EXPENSE_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_EXPENSE_src
 WHERE (EXT_AHM_EVENT_EXPENSE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_EVENT_EXPENSE'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_HOST AS
 SELECT btrim(EXT_AHM_EVENT_HOST_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_HOST_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_HOST_src.EMPLOYEE_ID) AS EMPLOYEE_ID,
        btrim(EXT_AHM_EVENT_HOST_src.TERRITORY) AS TERRITORY,
        btrim(EXT_AHM_EVENT_HOST_src.ORDINAL) AS ORDINAL,
        btrim(EXT_AHM_EVENT_HOST_src.BUDGET_PERCENT) AS BUDGET_PERCENT,
        btrim(EXT_AHM_EVENT_HOST_src.BUDGET_POOL) AS BUDGET_POOL,
        btrim(EXT_AHM_EVENT_HOST_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_HOST_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_HOST_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_HOST_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_HOST_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_HOST_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_HOST_src.batch_id,
        EXT_AHM_EVENT_HOST_src.row_id,
        EXT_AHM_EVENT_HOST_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_HOST_src
 WHERE (EXT_AHM_EVENT_HOST_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_EVENT_HOST'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_PRODUCT AS
 SELECT btrim(EXT_AHM_EVENT_PRODUCT_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_PRODUCT_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_PRODUCT_src.PRODUCT_ID) AS PRODUCT_ID,
        btrim(EXT_AHM_EVENT_PRODUCT_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_AHM_EVENT_PRODUCT_src.TOPIC_ID) AS TOPIC_ID,
        btrim(EXT_AHM_EVENT_PRODUCT_src.TOPIC_NAME) AS TOPIC_NAME,
        btrim(EXT_AHM_EVENT_PRODUCT_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_PRODUCT_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_PRODUCT_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_PRODUCT_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_PRODUCT_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_PRODUCT_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_PRODUCT_src.batch_id,
        EXT_AHM_EVENT_PRODUCT_src.row_id,
        EXT_AHM_EVENT_PRODUCT_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_PRODUCT_src
 WHERE (EXT_AHM_EVENT_PRODUCT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_EVENT_PRODUCT'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_AHM_EVENT_SPEAKER AS
 SELECT btrim(EXT_AHM_EVENT_SPEAKER_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_EVENT_SPEAKER_src.EVENT_NUMBER) AS EVENT_NUMBER,
        btrim(EXT_AHM_EVENT_SPEAKER_src.EVENT_SPEAKER_STATUS) AS EVENT_SPEAKER_STATUS,
        btrim(EXT_AHM_EVENT_SPEAKER_src.SPEAKER_ID) AS SPEAKER_ID,
        btrim(EXT_AHM_EVENT_SPEAKER_src.PRODUCT_ID) AS PRODUCT_ID,
        btrim(EXT_AHM_EVENT_SPEAKER_src.TOPIC_ID) AS TOPIC_ID,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CANCELLATION_REASON) AS CANCELLATION_REASON,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_EVENT_SPEAKER_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_EVENT_SPEAKER_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_EVENT_SPEAKER_src.batch_id,
        EXT_AHM_EVENT_SPEAKER_src.row_id,
        EXT_AHM_EVENT_SPEAKER_src.update_ts
 FROM teva_ingestion.EXT_AHM_EVENT_SPEAKER_src
 WHERE (EXT_AHM_EVENT_SPEAKER_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_EVENT_SPEAKER'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_AHM_ORGANIZATION AS
 SELECT btrim(EXT_AHM_ORGANIZATION_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_ORGANIZATION_src.AHM_ORG_ID) AS AHM_ORG_ID,
        btrim(EXT_AHM_ORGANIZATION_src.NAME) AS NAME,
        btrim(EXT_AHM_ORGANIZATION_src.ADDRESS_LINE_1) AS ADDRESS_LINE_1,
        btrim(EXT_AHM_ORGANIZATION_src.ADDRESS_LINE_2) AS ADDRESS_LINE_2,
        btrim(EXT_AHM_ORGANIZATION_src.ADDRESS_LINE_3) AS ADDRESS_LINE_3,
        btrim(EXT_AHM_ORGANIZATION_src.ADDRESS_LINE_4) AS ADDRESS_LINE_4,
        btrim(EXT_AHM_ORGANIZATION_src.CITY) AS CITY,
        btrim(EXT_AHM_ORGANIZATION_src.STATE_PROVINCE) AS STATE_PROVINCE,
        btrim(EXT_AHM_ORGANIZATION_src.POSTAL_CODE) AS POSTAL_CODE,
        btrim(EXT_AHM_ORGANIZATION_src.POSTAL_EXTENDED_CODE) AS POSTAL_EXTENDED_CODE,
        btrim(EXT_AHM_ORGANIZATION_src.COUNTRY_CODE) AS COUNTRY_CODE,
        btrim(EXT_AHM_ORGANIZATION_src.PHONE) AS PHONE,
        btrim(EXT_AHM_ORGANIZATION_src.FAX) AS FAX,
        btrim(EXT_AHM_ORGANIZATION_src.EMAIL) AS EMAIL,
        btrim(EXT_AHM_ORGANIZATION_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_ORGANIZATION_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_ORGANIZATION_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_ORGANIZATION_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_ORGANIZATION_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_ORGANIZATION_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_ORGANIZATION_src.batch_id,
        EXT_AHM_ORGANIZATION_src.row_id,
        EXT_AHM_ORGANIZATION_src.update_ts
 FROM teva_ingestion.EXT_AHM_ORGANIZATION_src
 WHERE (EXT_AHM_ORGANIZATION_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_ORGANIZATION'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_AHM_SPEAKER_CONTRACT AS
 SELECT btrim(EXT_AHM_SPEAKER_CONTRACT_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.SPEAKER_ID) AS SPEAKER_ID,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CONTRACT_TYPE_CODE) AS CONTRACT_TYPE_CODE,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CONTRACT_TYPE_NAME) AS CONTRACT_TYPE_NAME,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CONTRACT_EFFECTIVE_DATE) AS CONTRACT_EFFECTIVE_DATE,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CONTRACT_EXPIRATION_DATE) AS CONTRACT_EXPIRATION_DATE,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CONTRACT_SIGNED_DATE) AS CONTRACT_SIGNED_DATE,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_SPEAKER_CONTRACT_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_SPEAKER_CONTRACT_src.batch_id,
        EXT_AHM_SPEAKER_CONTRACT_src.row_id,
        EXT_AHM_SPEAKER_CONTRACT_src.update_ts
 FROM teva_ingestion.EXT_AHM_SPEAKER_CONTRACT_src
 WHERE (EXT_AHM_SPEAKER_CONTRACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_SPEAKER_CONTRACT'::varchar(24))));

CREATE  VIEW teva_ingestion.EXT_AHM_SPEAKER_LICENSE AS
 SELECT btrim(EXT_AHM_SPEAKER_LICENSE_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.SPEAKER_ID) AS SPEAKER_ID,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.STATE_CODE) AS STATE_CODE,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.STATE_LICENSE_NUMBER) AS STATE_LICENSE_NUMBER,
        CASE WHEN (EXT_AHM_SPEAKER_LICENSE_src.STATE_LICENSE_EFFECTIVE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_SPEAKER_LICENSE_src.STATE_LICENSE_EFFECTIVE_DATE))::timestamp END AS STATE_LICENSE_EFFECTIVE_DATE,
        CASE WHEN (EXT_AHM_SPEAKER_LICENSE_src.STATE_LICENSE_EXPIRATION_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_SPEAKER_LICENSE_src.STATE_LICENSE_EXPIRATION_DATE))::timestamp END AS STATE_LICENSE_EXPIRATION_DATE,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.DEBARMENT_INDICATOR) AS DEBARMENT_INDICATOR,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_SPEAKER_LICENSE_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_SPEAKER_LICENSE_src.batch_id,
        EXT_AHM_SPEAKER_LICENSE_src.row_id,
        EXT_AHM_SPEAKER_LICENSE_src.update_ts
 FROM teva_ingestion.EXT_AHM_SPEAKER_LICENSE_src
 WHERE (EXT_AHM_SPEAKER_LICENSE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_SPEAKER_LICENSE'::varchar(23))));

CREATE  VIEW teva_ingestion.EXT_AHM_SPEAKER_PROFILE AS
 SELECT btrim(EXT_AHM_SPEAKER_PROFILE_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.SPEAKER_ID) AS SPEAKER_ID,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.TITLE) AS TITLE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ADDRESS_LINE_1) AS ADDRESS_LINE_1,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ADDRESS_LINE_2) AS ADDRESS_LINE_2,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ADDRESS_LINE_3) AS ADDRESS_LINE_3,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ADDRESS_LINE_4) AS ADDRESS_LINE_4,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CITY) AS CITY,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.STATE_PROVINCE) AS STATE_PROVINCE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.POSTAL_CODE) AS POSTAL_CODE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.POSTAL_EXTENDED_CODE) AS POSTAL_EXTENDED_CODE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.COUNTRY_CODE) AS COUNTRY_CODE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.BUSINESS_PHONE) AS BUSINESS_PHONE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.BUSINESS_PHONE_EXTENSION) AS BUSINESS_PHONE_EXTENSION,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.HOME_PHONE) AS HOME_PHONE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.MOBILE_PHONE) AS MOBILE_PHONE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.BUSINESS_FAX) AS BUSINESS_FAX,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.HOME_FAX) AS HOME_FAX,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.EMAIL) AS EMAIL,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.PERSONAL_SUFFIX) AS PERSONAL_SUFFIX,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.DEGREE) AS DEGREE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ME_NUMBER) AS ME_NUMBER,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.IMS_NUMBER) AS IMS_NUMBER,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.NPI_NUMBER) AS NPI_NUMBER,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CLINICAL_AFFILIATION) AS CLINICAL_AFFILIATION,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CLINICAL_TITLE) AS CLINICAL_TITLE,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.ACADEMIC_AFFILIATION) AS ACADEMIC_AFFILIATION,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.OTHER_AFFILIATION) AS OTHER_AFFILIATION,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.FEDERAL_EMPLOYEE_INDICATOR) AS FEDERAL_EMPLOYEE_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.STATE_EMPLOYEE_INDICATOR) AS STATE_EMPLOYEE_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.LOCAL_EMPLOYEE_INDICATOR) AS LOCAL_EMPLOYEE_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.FDA_DEBARMENT_INDICATOR) AS FDA_DEBARMENT_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.OFAC_DEBARMENT_INDICATOR) AS OFAC_DEBARMENT_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.OIG_EXCLUSION_INDICATOR) AS OIG_EXCLUSION_INDICATOR,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.SPEAKER_BIOGRAPHY) AS SPEAKER_BIOGRAPHY,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_SPEAKER_PROFILE_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_SPEAKER_PROFILE_src.batch_id,
        EXT_AHM_SPEAKER_PROFILE_src.row_id,
        EXT_AHM_SPEAKER_PROFILE_src.update_ts
 FROM teva_ingestion.EXT_AHM_SPEAKER_PROFILE_src
 WHERE (EXT_AHM_SPEAKER_PROFILE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_SPEAKER_PROFILE'::varchar(23))));

CREATE  VIEW teva_ingestion.EXT_AHM_SPEAKER_TRAINING AS
 SELECT btrim(EXT_AHM_SPEAKER_TRAINING_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.SPEAKER_ID) AS SPEAKER_ID,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.TOPIC_ID) AS TOPIC_ID,
        CASE WHEN (EXT_AHM_SPEAKER_TRAINING_src.EFFECTIVE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_SPEAKER_TRAINING_src.EFFECTIVE_DATE))::timestamp END AS EFFECTIVE_DATE,
        CASE WHEN (EXT_AHM_SPEAKER_TRAINING_src.EXPIRATION_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_SPEAKER_TRAINING_src.EXPIRATION_DATE))::timestamp END AS EXPIRATION_DATE,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_SPEAKER_TRAINING_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_SPEAKER_TRAINING_src.batch_id,
        EXT_AHM_SPEAKER_TRAINING_src.row_id,
        EXT_AHM_SPEAKER_TRAINING_src.update_ts
 FROM teva_ingestion.EXT_AHM_SPEAKER_TRAINING_src
 WHERE (EXT_AHM_SPEAKER_TRAINING_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_SPEAKER_TRAINING'::varchar(24))));

CREATE  VIEW teva_ingestion.EXT_AHM_TOPIC_PRODUCT AS
 SELECT btrim(EXT_AHM_TOPIC_PRODUCT_src.SOURCE_SYSTEM_NAME) AS SOURCE_SYSTEM_NAME,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.TOPIC_ID) AS TOPIC_ID,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.TOPIC_NAME) AS TOPIC_NAME,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.PRODUCT_ID) AS PRODUCT_ID,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_AHM_TOPIC_PRODUCT_src.EFFECTIVE_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_TOPIC_PRODUCT_src.EFFECTIVE_DATE))::timestamp END AS EFFECTIVE_DATE,
        CASE WHEN (EXT_AHM_TOPIC_PRODUCT_src.EXPIRATION_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AHM_TOPIC_PRODUCT_src.EXPIRATION_DATE))::timestamp END AS EXPIRATION_DATE,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.CUSTOM_FIELD_1) AS CUSTOM_FIELD_1,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.CUSTOM_FIELD_2) AS CUSTOM_FIELD_2,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.CUSTOM_FIELD_3) AS CUSTOM_FIELD_3,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.CUSTOM_FIELD_4) AS CUSTOM_FIELD_4,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.CUSTOM_FIELD_5) AS CUSTOM_FIELD_5,
        btrim(EXT_AHM_TOPIC_PRODUCT_src.REC_STAT_CD) AS REC_STAT_CD,
        EXT_AHM_TOPIC_PRODUCT_src.batch_id,
        EXT_AHM_TOPIC_PRODUCT_src.row_id,
        EXT_AHM_TOPIC_PRODUCT_src.update_ts
 FROM teva_ingestion.EXT_AHM_TOPIC_PRODUCT_src
 WHERE (EXT_AHM_TOPIC_PRODUCT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_AHM_TOPIC_PRODUCT'::varchar(21))));

CREATE  VIEW teva_ingestion.ext_anda_sales AS
 SELECT btrim(EXT_ANDA_SALES_src.TRANSACTION_ID) AS TRANSACTION_ID,
        btrim(EXT_ANDA_SALES_src.INVOICE_DATE) AS INVOICE_DATE,
        btrim(EXT_ANDA_SALES_src.PRODUCT_BRAND) AS PRODUCT_BRAND,
        btrim(EXT_ANDA_SALES_src.PRODUCT_NDC) AS PRODUCT_NDC,
        btrim(EXT_ANDA_SALES_src.PRODUCT_DESC) AS PRODUCT_DESC,
        CASE WHEN (EXT_ANDA_SALES_src.INVOICE_QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.INVOICE_QTY))::numeric(37,15) END AS INVOICE_QTY,
        CASE WHEN (EXT_ANDA_SALES_src.INVOICE_UNITS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.INVOICE_UNITS))::numeric(37,15) END AS INVOICE_UNITS,
        CASE WHEN (EXT_ANDA_SALES_src.INVOICE_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.INVOICE_COST))::numeric(37,15) END AS INVOICE_COST,
        CASE WHEN (EXT_ANDA_SALES_src.INVOICE_PACK_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.INVOICE_PACK_COST))::numeric(37,15) END AS INVOICE_PACK_COST,
        CASE WHEN (EXT_ANDA_SALES_src.INVOICE_UNIT_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.INVOICE_UNIT_COST))::numeric(37,15) END AS INVOICE_UNIT_COST,
        CASE WHEN (EXT_ANDA_SALES_src.CONTRACT_PACK_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.CONTRACT_PACK_COST))::numeric(37,15) END AS CONTRACT_PACK_COST,
        CASE WHEN (EXT_ANDA_SALES_src.CONTRACT_PURCHASES = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ANDA_SALES_src.CONTRACT_PURCHASES))::numeric(37,15) END AS CONTRACT_PURCHASES,
        btrim(EXT_ANDA_SALES_src.CONTRACT_NUMBER) AS CONTRACT_NUMBER,
        btrim(EXT_ANDA_SALES_src.DISPENSING_LOCATION) AS DISPENSING_LOCATION,
        btrim(EXT_ANDA_SALES_src.DL_ADDRESS_1) AS DL_ADDRESS_1,
        btrim(EXT_ANDA_SALES_src.DL_ADDRESS_2) AS DL_ADDRESS_2,
        btrim(EXT_ANDA_SALES_src.DL_CITY) AS DL_CITY,
        btrim(EXT_ANDA_SALES_src.DL_STATE) AS DL_STATE,
        btrim(EXT_ANDA_SALES_src.DL_ZIP) AS DL_ZIP,
        btrim(EXT_ANDA_SALES_src.DL_DEA_NUM) AS DL_DEA_NUM,
        btrim(EXT_ANDA_SALES_src.DEPOT_LOCATION) AS DEPOT_LOCATION,
        btrim(EXT_ANDA_SALES_src.DEP_ADDRESS_1) AS DEP_ADDRESS_1,
        btrim(EXT_ANDA_SALES_src.DEP_ADDRESS_2) AS DEP_ADDRESS_2,
        btrim(EXT_ANDA_SALES_src.DEP_CITY) AS DEP_CITY,
        btrim(EXT_ANDA_SALES_src.DEP_STATE) AS DEP_STATE,
        btrim(EXT_ANDA_SALES_src.DEP_ZIP) AS DEP_ZIP,
        btrim(EXT_ANDA_SALES_src.DEP_DEA_NUM) AS DEP_DEA_NUM,
        EXT_ANDA_SALES_src.batch_id,
        EXT_ANDA_SALES_src.row_id,
        EXT_ANDA_SALES_src.update_ts
 FROM teva_ingestion.EXT_ANDA_SALES_src
 WHERE (EXT_ANDA_SALES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ANDA_SALES'::varchar(14))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.DAYS_SUPPLY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.DAYS_SUPPLY))::int END AS DAYS_SUPPLY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.NDC_CODE) AS NDC_CODE,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.DAW = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.DAW))::int END AS DAW,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.DRUG_DESC) AS DRUG_DESC,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.NEW_REFILL = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.NEW_REFILL))::int END AS NEW_REFILL,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.REFILLS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.REFILLS))::int END AS REFILLS,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.OTHER_COVERAGE_CODE))::int END AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.COUPON_NUM) AS COUPON_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.SEX) AS SEX,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.AGE_AT_REDEMPTION) AS AGE_AT_REDEMPTION,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_PROCESS_DATE) AS PHARMACY_PROCESS_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_CHAIN_NUM) AS PHARMACY_CHAIN_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.NABP) AS NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_CHAIN) AS PHARMACY_CHAIN,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_NPI_NUM) AS PHARMACY_NPI_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PRINCIPLE_PHYS_DEA_NUM) AS PRINCIPLE_PHYS_DEA_NUM,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_src.PHYS_NPI = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHYS_NPI))::int END AS PHYS_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.CALC_AWP) AS CALC_AWP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.CREATE_DATE) AS CREATE_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_src.OCC_PAYMENT_TYPE) AS OCC_PAYMENT_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_CGD AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.TRANSACTION_TYPE) AS TRANSACTION_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DATE_FILLED) AS DATE_FILLED,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DAYS_SUPPLY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DAYS_SUPPLY))::numeric(37,15) END AS DAYS_SUPPLY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PRODUCT_SERVICE_CODE) AS PRODUCT_SERVICE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DRUG_DESCRIPTION) AS DRUG_DESCRIPTION,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.NEW_REFILL_INDICATOR) AS NEW_REFILL_INDICATOR,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.QUANTITY_DISPENSED) AS QUANTITY_DISPENSED,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.REFILLS_AUTHORIZED) AS REFILLS_AUTHORIZED,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PATIENT_PAID_AMOUNT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PATIENT_PAID_AMOUNT))::numeric(37,15) END AS PATIENT_PAID_AMOUNT,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PATIENT_PAID_AMOUNT_QUALIFIER) AS PATIENT_PAID_AMOUNT_QUALIFIER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.STATUS) AS STATUS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.OTHER_COVERAGE) AS OTHER_COVERAGE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.GROUP_NUMBER) AS GROUP_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.MEMBER_NUMBER) AS MEMBER_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.TIME_STAMP) AS TIME_STAMP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_NABP) AS PHARMACY_NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_ADDRESS_LINE_1) AS PHARMACY_ADDRESS_LINE_1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_ADDRESS_LINE_2) AS PHARMACY_ADDRESS_LINE_2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_ADDRESS_LINE_3) AS PHARMACY_ADDRESS_LINE_3,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_DEA) AS DOCTOR_DEA,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.TOTAL_AMOUNT_AUTHORIZED) AS TOTAL_AMOUNT_AUTHORIZED,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.FEE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.FEE))::numeric(37,15) END AS FEE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PROVIDER_REIMB) AS PROVIDER_REIMB,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.COPAY) AS COPAY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.COUPON_AMOUNT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.COUPON_AMOUNT))::numeric(37,15) END AS COUPON_AMOUNT,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_CITY) AS DOCTOR_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_STATE) AS DOCTOR_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_ZIP) AS DOCTOR_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.CUSTOMER_PHYSICIAN_ID) AS CUSTOMER_PHYSICIAN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_LAST_NAME) AS DOCTOR_LAST_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_FIRST_NAME) AS DOCTOR_FIRST_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_MIDDLE_NAME) AS DOCTOR_MIDDLE_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_TITLE_CODE) AS DOCTOR_TITLE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_ADDRESS_LINE_1) AS DOCTOR_ADDRESS_LINE_1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_ADDRESS_LINE_2) AS DOCTOR_ADDRESS_LINE_2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_ADDRESS_LINE_3) AS DOCTOR_ADDRESS_LINE_3,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_STATE_LICENSE_NUMBER) AS DOCTOR_STATE_LICENSE_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.SLN_STATE) AS SLN_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PROGRAM_NAME) AS PROGRAM_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.BRAND) AS BRAND,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.PHARMACY_COMPANY) AS PHARMACY_COMPANY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.DOCTOR_NPI) AS DOCTOR_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.LINKED_CARDS) AS LINKED_CARDS,
        EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_CGD_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_CGD_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_CGD'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2 AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DAYS_SUPPLY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DAYS_SUPPLY))::int END AS DAYS_SUPPLY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.NDC_CODE) AS NDC_CODE,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DAW = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DAW))::int END AS DAW,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.DRUG_DESC) AS DRUG_DESC,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.NEW_REFILL = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.NEW_REFILL))::int END AS NEW_REFILL,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.REFILLS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.REFILLS))::int END AS REFILLS,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.OTHER_COVERAGE_CODE))::int END AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.COUPON_NUM) AS COUPON_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.SEX) AS SEX,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.AGE_AT_REDEMPTION) AS AGE_AT_REDEMPTION,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_PROCESS_DATE) AS PHARMACY_PROCESS_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_CHAIN_NUM) AS PHARMACY_CHAIN_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.NABP) AS NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_CHAIN) AS PHARMACY_CHAIN,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_NPI_NUM) AS PHARMACY_NPI_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PRINCIPLE_PHYS_DEA_NUM) AS PRINCIPLE_PHYS_DEA_NUM,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHYS_NPI = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHYS_NPI))::int END AS PHYS_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.CALC_AWP) AS CALC_AWP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.CREATE_DATE) AS CREATE_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.OCC_PAYMENT_TYPE) AS OCC_PAYMENT_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2'::varchar(33))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3 AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DAYS_SUPPLY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DAYS_SUPPLY))::int END AS DAYS_SUPPLY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.NDC_CODE) AS NDC_CODE,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DAW = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DAW))::int END AS DAW,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.DRUG_DESC) AS DRUG_DESC,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.NEW_REFILL = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.NEW_REFILL))::int END AS NEW_REFILL,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.REFILLS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.REFILLS))::int END AS REFILLS,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.OTHER_COVERAGE_CODE))::int END AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.COUPON_NUM) AS COUPON_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.SEX) AS SEX,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.AGE_AT_REDEMPTION) AS AGE_AT_REDEMPTION,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_PROCESS_DATE) AS PHARMACY_PROCESS_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_CHAIN_NUM) AS PHARMACY_CHAIN_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.NABP) AS NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_CHAIN) AS PHARMACY_CHAIN,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_NPI_NUM) AS PHARMACY_NPI_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PRINCIPLE_PHYS_DEA_NUM) AS PRINCIPLE_PHYS_DEA_NUM,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHYS_NPI = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHYS_NPI))::int END AS PHYS_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.CALC_AWP) AS CALC_AWP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.CREATE_DATE) AS CREATE_DATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.OCC_PAYMENT_TYPE) AS OCC_PAYMENT_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3'::varchar(33))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_PSKW AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DATE_OF_FILL) AS DATE_OF_FILL,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DAY_SUPPLY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DAY_SUPPLY))::numeric(37,15) END AS DAY_SUPPLY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DAW) AS DAW,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.NDC) AS NDC,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DRUG_DESC) AS DRUG_DESC,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.NEW_REFILL_CODE) AS NEW_REFILL_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.NUMBER_OF_REFILLS) AS NUMBER_OF_REFILLS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.OTHER_COVERAGE_CODE) AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.MEMBER_ID) AS MEMBER_ID,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_GENDER) AS PATIENT_GENDER,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_AGE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_AGE))::numeric(37,15) END AS PATIENT_AGE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DATE_PROCESSED) AS DATE_PROCESSED,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.NABP) AS NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_NAME) AS PHM_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_ADD1) AS PHM_ADD1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_ADD2) AS PHM_ADD2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_CITY) AS PHM_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_STATE) AS PHM_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHM_ZIP) AS PHM_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHARMACY_NPI) AS PHARMACY_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.NPI) AS NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.DEA) AS DEA,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_NAME) AS PHY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_FN) AS PHY_FN,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_MI) AS PHY_MI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_LN) AS PHY_LN,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_SUFFIX) AS PHY_SUFFIX,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_PROF_DESG) AS PHY_PROF_DESG,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.SPEC1) AS SPEC1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.SPEC2) AS SPEC2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_ADD1) AS PHY_ADD1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_ADD2) AS PHY_ADD2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_CITY) AS PHY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_STATE) AS PHY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHY_ZIP) AS PHY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.SUBMISSION_METHOD) AS SUBMISSION_METHOD,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_BENEFIT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_BENEFIT))::numeric(37,15) END AS PATIENT_BENEFIT,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_COPAY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_COPAY))::numeric(37,15) END AS PATIENT_COPAY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_OOP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PATIENT_OOP))::numeric(37,15) END AS PATIENT_OOP,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHARMACY_TRANSACTION_FEE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.PHARMACY_TRANSACTION_FEE))::numeric(37,15) END AS PHARMACY_TRANSACTION_FEE,
        EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_PSKW_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_PSKW'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_REDEMPTIONS AS
 SELECT btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PROGRAM_NUM) AS PROGRAM_NUM,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.CLAIM_CERT_NUM) AS CLAIM_CERT_NUM,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.NDC_CODE) AS NDC_CODE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.QUANTITY) AS QUANTITY,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.DOB) AS DOB,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.SEX) AS SEX,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PRINCIPAL_PHYS_LAST_NAME) AS PRINCIPAL_PHYS_LAST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PRINCIPAL_PHYS_FIRST_NAME) AS PRINCIPAL_PHYS_FIRST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.PRINCIPAL_PHYS_DEA_NUM) AS PRINCIPAL_PHYS_DEA_NUM,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_LAST_NAME) AS COMPANY_PHYS_LAST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_FIRST_NAME) AS COMPANY_PHYS_FIRST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_ADDRESS1) AS COMPANY_PHYS_ADDRESS1,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_ADDRESS2) AS COMPANY_PHYS_ADDRESS2,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_CITY) AS COMPANY_PHYS_CITY,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_STATE) AS COMPANY_PHYS_STATE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.COMPANY_PHYS_ZIP) AS COMPANY_PHYS_ZIP,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_LAST_NAME) AS ASI_PHYS_LAST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_FIRST_NAME) AS ASI_PHYS_FIRST_NAME,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_COPAY_REDEMPTIONS_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        CASE WHEN (EXT_ASI_COPAY_REDEMPTIONS_src.NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_REDEMPTIONS_src.NPI))::numeric(37,15) END AS NPI,
        CASE WHEN (EXT_ASI_COPAY_REDEMPTIONS_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_COPAY_REDEMPTIONS_src.OTHER_COVERAGE_CODE))::numeric(37,15) END AS OTHER_COVERAGE_CODE,
        EXT_ASI_COPAY_REDEMPTIONS_src.batch_id,
        EXT_ASI_COPAY_REDEMPTIONS_src.row_id,
        EXT_ASI_COPAY_REDEMPTIONS_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_REDEMPTIONS_src
 WHERE (EXT_ASI_COPAY_REDEMPTIONS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_REDEMPTIONS'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_ASI_REDEMPTIONS AS
 SELECT btrim(EXT_ASI_REDEMPTIONS_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_REDEMPTIONS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ASI_REDEMPTIONS_src.PROGRAM_NUM) AS PROGRAM_NUM,
        btrim(EXT_ASI_REDEMPTIONS_src.CLAIM_CERT_NUM) AS CLAIM_CERT_NUM,
        btrim(EXT_ASI_REDEMPTIONS_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_REDEMPTIONS_src.NDC_CODE) AS NDC_CODE,
        btrim(EXT_ASI_REDEMPTIONS_src.QUANTITY) AS QUANTITY,
        btrim(EXT_ASI_REDEMPTIONS_src.DOB) AS DOB,
        btrim(EXT_ASI_REDEMPTIONS_src.SEX) AS SEX,
        btrim(EXT_ASI_REDEMPTIONS_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_REDEMPTIONS_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_REDEMPTIONS_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_REDEMPTIONS_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_REDEMPTIONS_src.PRINCIPAL_PHYS_LAST_NAME) AS PRINCIPAL_PHYS_LAST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.PRINCIPAL_PHYS_FIRST_NAME) AS PRINCIPAL_PHYS_FIRST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.PRINCIPAL_PHYS_DEA_NUM) AS PRINCIPAL_PHYS_DEA_NUM,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_LAST_NAME) AS COMPANY_PHYS_LAST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_FIRST_NAME) AS COMPANY_PHYS_FIRST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_ADDRESS1) AS COMPANY_PHYS_ADDRESS1,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_ADDRESS2) AS COMPANY_PHYS_ADDRESS2,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_CITY) AS COMPANY_PHYS_CITY,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_STATE) AS COMPANY_PHYS_STATE,
        btrim(EXT_ASI_REDEMPTIONS_src.COMPANY_PHYS_ZIP) AS COMPANY_PHYS_ZIP,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_LAST_NAME) AS ASI_PHYS_LAST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_FIRST_NAME) AS ASI_PHYS_FIRST_NAME,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_REDEMPTIONS_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        CASE WHEN (EXT_ASI_REDEMPTIONS_src.NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_REDEMPTIONS_src.NPI))::numeric(37,15) END AS NPI,
        CASE WHEN (EXT_ASI_REDEMPTIONS_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_REDEMPTIONS_src.OTHER_COVERAGE_CODE))::numeric(37,15) END AS OTHER_COVERAGE_CODE,
        EXT_ASI_REDEMPTIONS_src.batch_id,
        EXT_ASI_REDEMPTIONS_src.row_id,
        EXT_ASI_REDEMPTIONS_src.update_ts
 FROM teva_ingestion.EXT_ASI_REDEMPTIONS_src
 WHERE (EXT_ASI_REDEMPTIONS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_REDEMPTIONS'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1 AS
 SELECT btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DAYS_SUPPLY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DAYS_SUPPLY))::numeric(37,15) END AS DAYS_SUPPLY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.NDC_CODE) AS NDC_CODE,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DAW = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DAW))::numeric(37,15) END AS DAW,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.DRUG_DESC) AS DRUG_DESC,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.NEW_REFILL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.NEW_REFILL))::numeric(37,15) END AS NEW_REFILL,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.REFILLS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.REFILLS))::numeric(37,15) END AS REFILLS,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.OTHER_COVERAGE_CODE))::numeric(37,15) END AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.COUPON_NUM) AS COUPON_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.SEX) AS SEX,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.AGE_AT_REDEMPTION) AS AGE_AT_REDEMPTION,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_PROCESS_DATE) AS PHARMACY_PROCESS_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_CHAIN_NUM) AS PHARMACY_CHAIN_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.NABP) AS NABP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_CHAIN) AS PHARMACY_CHAIN,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_NPI_NUM) AS PHARMACY_NPI_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PRINCIPLE_PHYS_DEA_NUM) AS PRINCIPLE_PHYS_DEA_NUM,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHYS_NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHYS_NPI))::numeric(37,15) END AS PHYS_NPI,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.CALC_AWP) AS CALC_AWP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.CREATE_DATE) AS CREATE_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.OCC_PAYMENT_TYPE) AS OCC_PAYMENT_TYPE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.batch_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.row_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.update_ts
 FROM teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src
 WHERE (EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1'::varchar(35))));

CREATE  VIEW teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER AS
 SELECT btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.TRANS_TYPE) AS TRANS_TYPE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_TXN_ID) AS ASI_TXN_ID,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ORIG_ASI_TXN_ID) AS ORIG_ASI_TXN_ID,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.RX_NUM) AS RX_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.RX_DATE) AS RX_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DATE_WRITTEN) AS DATE_WRITTEN,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DAYS_SUPPLY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DAYS_SUPPLY))::numeric(37,15) END AS DAYS_SUPPLY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.NDC_CODE) AS NDC_CODE,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DAW = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DAW))::numeric(37,15) END AS DAW,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.DRUG_DESC) AS DRUG_DESC,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.NEW_REFILL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.NEW_REFILL))::numeric(37,15) END AS NEW_REFILL,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.REFILLS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.REFILLS))::numeric(37,15) END AS REFILLS,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.OTHER_COVERAGE_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.OTHER_COVERAGE_CODE))::numeric(37,15) END AS OTHER_COVERAGE_CODE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.GROUP_NUM) AS GROUP_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.COUPON_NUM) AS COUPON_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.SEX) AS SEX,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.AGE_AT_REDEMPTION) AS AGE_AT_REDEMPTION,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_PROCESS_DATE) AS PHARMACY_PROCESS_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_CHAIN_NUM) AS PHARMACY_CHAIN_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.NABP) AS NABP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_CHAIN) AS PHARMACY_CHAIN,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_ADDRESS) AS PHARMACY_ADDRESS,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_NPI_NUM) AS PHARMACY_NPI_NUM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PRINCIPLE_PHYS_DEA_NUM) AS PRINCIPLE_PHYS_DEA_NUM,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHYS_NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHYS_NPI))::numeric(37,15) END AS PHYS_NPI,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_PHYS_ADDRESS1) AS ASI_PHYS_ADDRESS1,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_PHYS_ADDRESS2) AS ASI_PHYS_ADDRESS2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_PHYS_CITY) AS ASI_PHYS_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_PHYS_STATE) AS ASI_PHYS_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.ASI_PHYS_ZIP) AS ASI_PHYS_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.REBATE_AMOUNT) AS REBATE_AMOUNT,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.MEMBER_CASH_EXPENSE) AS MEMBER_CASH_EXPENSE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.SUBMITTED_COST) AS SUBMITTED_COST,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.PHARMACY_FEE) AS PHARMACY_FEE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.TOTAL_AMOUNT_DUE) AS TOTAL_AMOUNT_DUE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.CALC_AWP) AS CALC_AWP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.CREATE_DATE) AS CREATE_DATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.OCC_PAYMENT_TYPE) AS OCC_PAYMENT_TYPE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.batch_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.row_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.update_ts
 FROM teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src
 WHERE (EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER'::varchar(35))));

CREATE  VIEW teva_ingestion.ext_call_goals_kc AS
 SELECT CASE WHEN (ext_call_goals_kc_src.ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_call_goals_kc_src.ID))::numeric(38,0) END AS ID,
        btrim(ext_call_goals_kc_src.SFA_ID) AS SFA_ID,
        btrim(ext_call_goals_kc_src.IMS_ID) AS IMS_ID,
        btrim(ext_call_goals_kc_src.TERRITORY_NUM) AS TERRITORY_NUM,
        CASE WHEN (ext_call_goals_kc_src.PRIORITY = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(ext_call_goals_kc_src.PRIORITY))::numeric(3,0) END AS PRIORITY,
        btrim(ext_call_goals_kc_src.PRODUCT) AS PRODUCT,
        CASE WHEN (ext_call_goals_kc_src.GOAL = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(ext_call_goals_kc_src.GOAL))::numeric(3,0) END AS GOAL,
        CASE WHEN (ext_call_goals_kc_src.ACTUAL = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(ext_call_goals_kc_src.ACTUAL))::numeric(3,0) END AS ACTUAL,
        btrim(ext_call_goals_kc_src.MARKETING_SEGMENT) AS MARKETING_SEGMENT,
        btrim(ext_call_goals_kc_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(ext_call_goals_kc_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        ext_call_goals_kc_src.batch_id,
        ext_call_goals_kc_src.row_id,
        ext_call_goals_kc_src.update_ts
 FROM teva_ingestion.ext_call_goals_kc_src
 WHERE (ext_call_goals_kc_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CALL_GOALS_KC'::varchar(17))));

CREATE  VIEW teva_ingestion.EXT_CAREMARK_RX2_AOB AS
 SELECT btrim(EXT_CAREMARK_RX2_AOB_src.MD_ID) AS MD_ID,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_LAST_NAME) AS MD_LAST_NAME,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_FIRST_NAME) AS MD_FIRST_NAME,
        btrim(EXT_CAREMARK_RX2_AOB_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_CITY) AS MD_CITY,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_STATE) AS MD_STATE,
        btrim(EXT_CAREMARK_RX2_AOB_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_CAREMARK_RX2_AOB_src.NDC_NUMBER) AS NDC_NUMBER,
        btrim(EXT_CAREMARK_RX2_AOB_src.SHIP_DATE) AS SHIP_DATE,
        CASE WHEN (EXT_CAREMARK_RX2_AOB_src.QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CAREMARK_RX2_AOB_src.QTY))::numeric(37,15) END AS QTY,
        EXT_CAREMARK_RX2_AOB_src.batch_id,
        EXT_CAREMARK_RX2_AOB_src.row_id,
        EXT_CAREMARK_RX2_AOB_src.update_ts
 FROM teva_ingestion.EXT_CAREMARK_RX2_AOB_src
 WHERE (EXT_CAREMARK_RX2_AOB_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CAREMARK_RX2_AOB'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_CAREMARK_RX2_MEDICARE AS
 SELECT btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_ID) AS MD_ID,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_LAST_NAME) AS MD_LAST_NAME,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_FIRST_NAME) AS MD_FIRST_NAME,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_CITY) AS MD_CITY,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_STATE) AS MD_STATE,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.NDC_NUMBER) AS NDC_NUMBER,
        btrim(EXT_CAREMARK_RX2_MEDICARE_src.SHIP_DATE) AS SHIP_DATE,
        CASE WHEN (EXT_CAREMARK_RX2_MEDICARE_src.QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CAREMARK_RX2_MEDICARE_src.QTY))::numeric(37,15) END AS QTY,
        EXT_CAREMARK_RX2_MEDICARE_src.batch_id,
        EXT_CAREMARK_RX2_MEDICARE_src.row_id,
        EXT_CAREMARK_RX2_MEDICARE_src.update_ts
 FROM teva_ingestion.EXT_CAREMARK_RX2_MEDICARE_src
 WHERE (EXT_CAREMARK_RX2_MEDICARE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CAREMARK_RX2_MEDICARE'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_CLM_PRESENTATION_SLIDE_VC AS
 SELECT btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.ID) AS ID,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.ISDELETED) AS ISDELETED,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.NAME) AS NAME,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.CLM_PRESENTATION_VOD__C) AS CLM_PRESENTATION_VOD__C,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.KEY_MESSAGE_VOD__C) AS KEY_MESSAGE_VOD__C,
        CASE WHEN (EXT_CLM_PRESENTATION_SLIDE_VC_src.DISPLAY_ORDER_VOD__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.DISPLAY_ORDER_VOD__C))::numeric(4,0) END AS DISPLAY_ORDER_VOD__C,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.SUB_PRESENTATION_VOD__C) AS SUB_PRESENTATION_VOD__C,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_CLM_PRESENTATION_SLIDE_VC_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        EXT_CLM_PRESENTATION_SLIDE_VC_src.batch_id,
        EXT_CLM_PRESENTATION_SLIDE_VC_src.row_id,
        EXT_CLM_PRESENTATION_SLIDE_VC_src.update_ts
 FROM teva_ingestion.EXT_CLM_PRESENTATION_SLIDE_VC_src
 WHERE (EXT_CLM_PRESENTATION_SLIDE_VC_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CLM_PRESENTATION_SLIDE_VC'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_CLM_PRESENTATION_VOD__C AS
 SELECT btrim(EXT_CLM_PRESENTATION_VOD__C_src.APPROVED_VOD__C) AS APPROVED_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.COPIED_FROM_VOD__C) AS COPIED_FROM_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.COPY_DATE_VOD__C) AS COPY_DATE_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.DEFAULT_PRESENTATION_VOD__C) AS DEFAULT_PRESENTATION_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.GROUP_TO_SHARE_TO__C) AS GROUP_TO_SHARE_TO__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.HIDDEN_VOD__C) AS HIDDEN_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.ID) AS ID,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.NAME) AS NAME,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.ORIGINAL_RECORD_ID_VOD__C) AS ORIGINAL_RECORD_ID_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.PARENTID_VOD__C) AS PARENTID_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.PRESENTATION_ID_VOD__C) AS PRESENTATION_ID_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.PRODUCT_VOD__C) AS PRODUCT_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.TRAINING_VOD__C) AS TRAINING_VOD__C,
        btrim(EXT_CLM_PRESENTATION_VOD__C_src.TYPE_VOD__C) AS TYPE_VOD__C,
        EXT_CLM_PRESENTATION_VOD__C_src.batch_id,
        EXT_CLM_PRESENTATION_VOD__C_src.row_id,
        EXT_CLM_PRESENTATION_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_CLM_PRESENTATION_VOD__C_src
 WHERE (EXT_CLM_PRESENTATION_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CLM_PRESENTATION_VOD__C'::varchar(27))));

CREATE  VIEW teva_ingestion.EXT_CLOZAPINE_UNIT_AP AS
 SELECT btrim(EXT_CLOZAPINE_UNIT_AP_src.NDC_CODE) AS NDC_CODE,
        btrim(EXT_CLOZAPINE_UNIT_AP_src.DESCRIPTION) AS DESCRIPTION,
        CASE WHEN (EXT_CLOZAPINE_UNIT_AP_src.UNIT_AP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CLOZAPINE_UNIT_AP_src.UNIT_AP))::numeric(37,15) END AS UNIT_AP,
        EXT_CLOZAPINE_UNIT_AP_src.batch_id,
        EXT_CLOZAPINE_UNIT_AP_src.row_id,
        EXT_CLOZAPINE_UNIT_AP_src.update_ts
 FROM teva_ingestion.EXT_CLOZAPINE_UNIT_AP_src
 WHERE (EXT_CLOZAPINE_UNIT_AP_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CLOZAPINE_UNIT_AP'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_CMOP_RX_DATA_TEVA AS
 SELECT btrim(EXT_CMOP_RX_DATA_TEVA_src.MONTH) AS MONTH,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.CMOP) AS CMOP,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.VISN) AS VISN,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.STATION_NUMBER) AS STATION_NUMBER,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.STATION) AS STATION,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.VA_PRODUCT) AS VA_PRODUCT,
        CASE WHEN (EXT_CMOP_RX_DATA_TEVA_src.TOTAL_RXS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CMOP_RX_DATA_TEVA_src.TOTAL_RXS))::numeric(37,15) END AS TOTAL_RXS,
        CASE WHEN (EXT_CMOP_RX_DATA_TEVA_src.CMOP_RXS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CMOP_RX_DATA_TEVA_src.CMOP_RXS))::numeric(37,15) END AS CMOP_RXS,
        CASE WHEN (EXT_CMOP_RX_DATA_TEVA_src.TOTAL_QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CMOP_RX_DATA_TEVA_src.TOTAL_QTY))::numeric(37,15) END AS TOTAL_QTY,
        CASE WHEN (EXT_CMOP_RX_DATA_TEVA_src.CMOP_QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CMOP_RX_DATA_TEVA_src.CMOP_QTY))::numeric(37,15) END AS CMOP_QTY,
        CASE WHEN (EXT_CMOP_RX_DATA_TEVA_src."30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_CMOP_RX_DATA_TEVA_src."30_DAY_RXS"))::numeric(37,15) END AS "30_DAY_RXS",
        btrim(EXT_CMOP_RX_DATA_TEVA_src.ZIP) AS ZIP,
        btrim(EXT_CMOP_RX_DATA_TEVA_src.ID) AS ID,
        EXT_CMOP_RX_DATA_TEVA_src.batch_id,
        EXT_CMOP_RX_DATA_TEVA_src.row_id,
        EXT_CMOP_RX_DATA_TEVA_src.update_ts
 FROM teva_ingestion.EXT_CMOP_RX_DATA_TEVA_src
 WHERE (EXT_CMOP_RX_DATA_TEVA_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CMOP_RX_DATA_TEVA'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_DDD_DOD_QTY AS
 SELECT btrim(EXT_DDD_DOD_QTY_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_DDD_DOD_QTY_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_DDD_DOD_QTY_src.filler_01) AS filler_01,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_CODE) AS OUTLET_CODE,
        btrim(EXT_DDD_DOD_QTY_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_DDD_DOD_QTY_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_DDD_DOD_QTY_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        btrim(EXT_DDD_DOD_QTY_src.MTH_YYYYMM) AS MTH_YYYYMM,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH01 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH01))::numeric(37,15) END AS QTY_MTH01,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH02 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH02))::numeric(37,15) END AS QTY_MTH02,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH03 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH03))::numeric(37,15) END AS QTY_MTH03,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH04 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH04))::numeric(37,15) END AS QTY_MTH04,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH05 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH05))::numeric(37,15) END AS QTY_MTH05,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH06 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH06))::numeric(37,15) END AS QTY_MTH06,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH07 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH07))::numeric(37,15) END AS QTY_MTH07,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH08 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH08))::numeric(37,15) END AS QTY_MTH08,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH09 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH09))::numeric(37,15) END AS QTY_MTH09,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH10 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH10))::numeric(37,15) END AS QTY_MTH10,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH11 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH11))::numeric(37,15) END AS QTY_MTH11,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH12 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH12))::numeric(37,15) END AS QTY_MTH12,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH13 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH13))::numeric(37,15) END AS QTY_MTH13,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH14 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH14))::numeric(37,15) END AS QTY_MTH14,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH15 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH15))::numeric(37,15) END AS QTY_MTH15,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH16 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH16))::numeric(37,15) END AS QTY_MTH16,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH17 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH17))::numeric(37,15) END AS QTY_MTH17,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH18 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH18))::numeric(37,15) END AS QTY_MTH18,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH19 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH19))::numeric(37,15) END AS QTY_MTH19,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH20 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH20))::numeric(37,15) END AS QTY_MTH20,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH21 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH21))::numeric(37,15) END AS QTY_MTH21,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH22 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH22))::numeric(37,15) END AS QTY_MTH22,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH23 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH23))::numeric(37,15) END AS QTY_MTH23,
        CASE WHEN (EXT_DDD_DOD_QTY_src.QTY_MTH24 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_QTY_src.QTY_MTH24))::numeric(37,15) END AS QTY_MTH24,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_DDD_DOD_QTY_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_DDD_DOD_QTY_src.batch_id,
        EXT_DDD_DOD_QTY_src.row_id,
        EXT_DDD_DOD_QTY_src.update_ts
 FROM teva_ingestion.EXT_DDD_DOD_QTY_src
 WHERE (EXT_DDD_DOD_QTY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_DDD_DOD_QTY'::varchar(15))));

CREATE  VIEW teva_ingestion.EXT_DDD_DOD_SALES_MS AS
 SELECT btrim(EXT_DDD_DOD_SALES_MS_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_DDD_DOD_SALES_MS_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_DDD_DOD_SALES_MS_src.filler_01) AS filler_01,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_CODE) AS OUTLET_CODE,
        btrim(EXT_DDD_DOD_SALES_MS_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_DDD_DOD_SALES_MS_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_DDD_DOD_SALES_MS_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        btrim(EXT_DDD_DOD_SALES_MS_src.MTH_YYYYMM) AS MTH_YYYYMM,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH01 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH01))::numeric(37,15) END AS DOL_MTH01,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH02 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH02))::numeric(37,15) END AS DOL_MTH02,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH03 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH03))::numeric(37,15) END AS DOL_MTH03,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH04 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH04))::numeric(37,15) END AS DOL_MTH04,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH05 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH05))::numeric(37,15) END AS DOL_MTH05,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH06 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH06))::numeric(37,15) END AS DOL_MTH06,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH07 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH07))::numeric(37,15) END AS DOL_MTH07,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH08 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH08))::numeric(37,15) END AS DOL_MTH08,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH09 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH09))::numeric(37,15) END AS DOL_MTH09,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH10 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH10))::numeric(37,15) END AS DOL_MTH10,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH11 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH11))::numeric(37,15) END AS DOL_MTH11,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH12 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH12))::numeric(37,15) END AS DOL_MTH12,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH13 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH13))::numeric(37,15) END AS DOL_MTH13,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH14 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH14))::numeric(37,15) END AS DOL_MTH14,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH15 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH15))::numeric(37,15) END AS DOL_MTH15,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH16 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH16))::numeric(37,15) END AS DOL_MTH16,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH17 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH17))::numeric(37,15) END AS DOL_MTH17,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH18 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH18))::numeric(37,15) END AS DOL_MTH18,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH19 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH19))::numeric(37,15) END AS DOL_MTH19,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH20 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH20))::numeric(37,15) END AS DOL_MTH20,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH21 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH21))::numeric(37,15) END AS DOL_MTH21,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH22 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH22))::numeric(37,15) END AS DOL_MTH22,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH23 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH23))::numeric(37,15) END AS DOL_MTH23,
        CASE WHEN (EXT_DDD_DOD_SALES_MS_src.DOL_MTH24 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_MS_src.DOL_MTH24))::numeric(37,15) END AS DOL_MTH24,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_DDD_DOD_SALES_MS_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_DDD_DOD_SALES_MS_src.batch_id,
        EXT_DDD_DOD_SALES_MS_src.row_id,
        EXT_DDD_DOD_SALES_MS_src.update_ts
 FROM teva_ingestion.EXT_DDD_DOD_SALES_MS_src
 WHERE (EXT_DDD_DOD_SALES_MS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_DDD_DOD_SALES_MS'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_DDD_DOD_SALES_PD AS
 SELECT btrim(EXT_DDD_DOD_SALES_PD_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_DDD_DOD_SALES_PD_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_DDD_DOD_SALES_PD_src.filler_01) AS filler_01,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_CODE) AS OUTLET_CODE,
        btrim(EXT_DDD_DOD_SALES_PD_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_DDD_DOD_SALES_PD_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_DDD_DOD_SALES_PD_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        btrim(EXT_DDD_DOD_SALES_PD_src.MTH_YYYYMM) AS MTH_YYYYMM,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH01 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH01))::numeric(37,15) END AS DOL_MTH01,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH02 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH02))::numeric(37,15) END AS DOL_MTH02,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH03 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH03))::numeric(37,15) END AS DOL_MTH03,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH04 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH04))::numeric(37,15) END AS DOL_MTH04,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH05 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH05))::numeric(37,15) END AS DOL_MTH05,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH06 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH06))::numeric(37,15) END AS DOL_MTH06,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH07 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH07))::numeric(37,15) END AS DOL_MTH07,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH08 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH08))::numeric(37,15) END AS DOL_MTH08,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH09 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH09))::numeric(37,15) END AS DOL_MTH09,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH10 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH10))::numeric(37,15) END AS DOL_MTH10,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH11 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH11))::numeric(37,15) END AS DOL_MTH11,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH12 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH12))::numeric(37,15) END AS DOL_MTH12,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH13 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH13))::numeric(37,15) END AS DOL_MTH13,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH14 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH14))::numeric(37,15) END AS DOL_MTH14,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH15 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH15))::numeric(37,15) END AS DOL_MTH15,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH16 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH16))::numeric(37,15) END AS DOL_MTH16,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH17 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH17))::numeric(37,15) END AS DOL_MTH17,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH18 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH18))::numeric(37,15) END AS DOL_MTH18,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH19 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH19))::numeric(37,15) END AS DOL_MTH19,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH20 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH20))::numeric(37,15) END AS DOL_MTH20,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH21 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH21))::numeric(37,15) END AS DOL_MTH21,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH22 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH22))::numeric(37,15) END AS DOL_MTH22,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH23 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH23))::numeric(37,15) END AS DOL_MTH23,
        CASE WHEN (EXT_DDD_DOD_SALES_PD_src.DOL_MTH24 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_DDD_DOD_SALES_PD_src.DOL_MTH24))::numeric(37,15) END AS DOL_MTH24,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_DDD_DOD_SALES_PD_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_DDD_DOD_SALES_PD_src.batch_id,
        EXT_DDD_DOD_SALES_PD_src.row_id,
        EXT_DDD_DOD_SALES_PD_src.update_ts
 FROM teva_ingestion.EXT_DDD_DOD_SALES_PD_src
 WHERE (EXT_DDD_DOD_SALES_PD_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_DDD_DOD_SALES_PD'::varchar(20))));

CREATE  VIEW teva_ingestion.ext_diplomat_enrollment AS
 SELECT btrim(ext_diplomat_enrollment_src.PATIENT_ID) AS PATIENT_ID,
        btrim(ext_diplomat_enrollment_src.RX_RECEIVED_DATE) AS RX_RECEIVED_DATE,
        btrim(ext_diplomat_enrollment_src.INSURANCE_INFORMATION) AS INSURANCE_INFORMATION,
        btrim(ext_diplomat_enrollment_src.MOST_RECENT_CML_TREATMENT) AS MOST_RECENT_CML_TREATMENT,
        btrim(ext_diplomat_enrollment_src.DATE_OF_DISCONTINUATION) AS DATE_OF_DISCONTINUATION,
        btrim(ext_diplomat_enrollment_src.REASON_FOR_DISCONTINUATION) AS REASON_FOR_DISCONTINUATION,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_LAST_NAME) AS PHYSICIAN_LAST_NAME,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_FIRST_NAME) AS PHYSICIAN_FIRST_NAME,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_ADDRESS) AS PHYSICIAN_ADDRESS,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_CITY) AS PHYSICIAN_CITY,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_STATE) AS PHYSICIAN_STATE,
        btrim(ext_diplomat_enrollment_src.PHYSICIAN_ZIP) AS PHYSICIAN_ZIP,
        ext_diplomat_enrollment_src.batch_id,
        ext_diplomat_enrollment_src.row_id,
        ext_diplomat_enrollment_src.update_ts
 FROM teva_ingestion.ext_diplomat_enrollment_src
 WHERE (ext_diplomat_enrollment_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_DIPLOMAT_ENROLLMENT'::varchar(23))));

CREATE  VIEW teva_ingestion.EXT_F60Q AS
 SELECT btrim(EXT_F60Q_src."CLI#") AS "CLI#",
        btrim(EXT_F60Q_src.SUFFIX) AS SUFFIX,
        btrim(EXT_F60Q_src."TERR#") AS "TERR#",
        btrim(EXT_F60Q_src.BLANK1) AS BLANK1,
        btrim(EXT_F60Q_src."OUTLET#") AS "OUTLET#",
        btrim(EXT_F60Q_src.NAME) AS NAME,
        btrim(EXT_F60Q_src.ADDRESS) AS ADDRESS,
        btrim(EXT_F60Q_src.CITY) AS CITY,
        btrim(EXT_F60Q_src.STATE) AS STATE,
        btrim(EXT_F60Q_src.RPT_TYPE) AS RPT_TYPE,
        btrim(EXT_F60Q_src.BLANK2) AS BLANK2,
        btrim(EXT_F60Q_src.STATUS) AS STATUS,
        btrim(EXT_F60Q_src.BLANK3) AS BLANK3,
        btrim(EXT_F60Q_src.SUBCAT) AS SUBCAT,
        btrim(EXT_F60Q_src.STATE_CODE) AS STATE_CODE,
        btrim(EXT_F60Q_src.COUNTY_CODE) AS COUNTY_CODE,
        btrim(EXT_F60Q_src.REC_TYPE) AS REC_TYPE,
        EXT_F60Q_src.batch_id,
        EXT_F60Q_src.row_id,
        EXT_F60Q_src.update_ts
 FROM teva_ingestion.EXT_F60Q_src
 WHERE (EXT_F60Q_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_F60Q'::varchar(8))));

CREATE  VIEW teva_ingestion.EXT_FACTORY_SALES_852 AS
 SELECT btrim(EXT_FACTORY_SALES_852_src.TRADING_PARTNER) AS TRADING_PARTNER,
        btrim(EXT_FACTORY_SALES_852_src.DISTRIB_CENTER) AS DISTRIB_CENTER,
        btrim(EXT_FACTORY_SALES_852_src.DISTRIB_CENTER_DEA_NUM) AS DISTRIB_CENTER_DEA_NUM,
        btrim(EXT_FACTORY_SALES_852_src.REPORTING_DATE) AS REPORTING_DATE,
        btrim(EXT_FACTORY_SALES_852_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_FACTORY_SALES_852_src.DESCRIPTION) AS DESCRIPTION,
        btrim(EXT_FACTORY_SALES_852_src.NDC) AS NDC,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_RECEIVED = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_RECEIVED))::numeric(37,15) END AS QTY_RECEIVED,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_RECEIVED_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_RECEIVED_DOLLARS))::numeric(37,15) END AS QTY_RECEIVED_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_SOLD = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_SOLD))::numeric(37,15) END AS QTY_SOLD,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_SOLD_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_SOLD_DOLLARS))::numeric(37,15) END AS QTY_SOLD_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_OMIT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_OMIT))::numeric(37,15) END AS QTY_OMIT,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_OMIT_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_OMIT_DOLLARS))::numeric(37,15) END AS QTY_OMIT_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_QTY_ON_HAND = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_QTY_ON_HAND))::numeric(37,15) END AS MTH_END_QTY_ON_HAND,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_QTY_ON_HAND_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_QTY_ON_HAND_DOLLARS))::numeric(37,15) END AS MTH_END_QTY_ON_HAND_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_COMMITTED = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_COMMITTED))::numeric(37,15) END AS MTH_END_COMMITTED,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_COMMITTED_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_COMMITTED_DOLLARS))::numeric(37,15) END AS MTH_END_COMMITTED_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_RESERVED = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_RESERVED))::numeric(37,15) END AS MTH_END_RESERVED,
        CASE WHEN (EXT_FACTORY_SALES_852_src.MTH_END_RESERVED_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.MTH_END_RESERVED_DOLLARS))::numeric(37,15) END AS MTH_END_RESERVED_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_RETURN = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_RETURN))::numeric(37,15) END AS QTY_RETURN,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_RETURN_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_RETURN_DOLLARS))::numeric(37,15) END AS QTY_RETURN_DOLLARS,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_CUSTOMER_RETURN = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_CUSTOMER_RETURN))::numeric(37,15) END AS QTY_CUSTOMER_RETURN,
        CASE WHEN (EXT_FACTORY_SALES_852_src.QTY_CUSTOMER_RETURN_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_FACTORY_SALES_852_src.QTY_CUSTOMER_RETURN_DOLLARS))::numeric(37,15) END AS QTY_CUSTOMER_RETURN_DOLLARS,
        EXT_FACTORY_SALES_852_src.batch_id,
        EXT_FACTORY_SALES_852_src.row_id,
        EXT_FACTORY_SALES_852_src.update_ts
 FROM teva_ingestion.EXT_FACTORY_SALES_852_src
 WHERE (EXT_FACTORY_SALES_852_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FACTORY_SALES_852'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_HCOS_ACO_DETAIL AS
 SELECT CASE WHEN (EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_ID))::numeric(37,15) END AS ACO_DETAIL_ID,
        btrim(EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_CODE) AS ACO_DETAIL_CODE,
        btrim(EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_DESC) AS ACO_DETAIL_DESC,
        btrim(EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_GROUP_CODE) AS ACO_DETAIL_GROUP_CODE,
        btrim(EXT_HCOS_ACO_DETAIL_src.ACO_DETAIL_GROUP_DESC) AS ACO_DETAIL_GROUP_DESC,
        EXT_HCOS_ACO_DETAIL_src.batch_id,
        EXT_HCOS_ACO_DETAIL_src.row_id,
        EXT_HCOS_ACO_DETAIL_src.update_ts
 FROM teva_ingestion.EXT_HCOS_ACO_DETAIL_src
 WHERE (EXT_HCOS_ACO_DETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_ACO_DETAIL'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_HCOS_ACO_DETAIL_FACT AS
 SELECT btrim(EXT_HCOS_ACO_DETAIL_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_ACO_DETAIL_FACT_src.ACO_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_DETAIL_FACT_src.ACO_TYPE_ID))::numeric(37,15) END AS ACO_TYPE_ID,
        CASE WHEN (EXT_HCOS_ACO_DETAIL_FACT_src.ACO_DETAIL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_DETAIL_FACT_src.ACO_DETAIL_ID))::numeric(37,15) END AS ACO_DETAIL_ID,
        btrim(EXT_HCOS_ACO_DETAIL_FACT_src.ACO_VAL) AS ACO_VAL,
        EXT_HCOS_ACO_DETAIL_FACT_src.batch_id,
        EXT_HCOS_ACO_DETAIL_FACT_src.row_id,
        EXT_HCOS_ACO_DETAIL_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_ACO_DETAIL_FACT_src
 WHERE (EXT_HCOS_ACO_DETAIL_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_ACO_DETAIL_FACT'::varchar(24))));

CREATE  VIEW teva_ingestion.EXT_HCOS_ACO_ORG_FACT AS
 SELECT btrim(EXT_HCOS_ACO_ORG_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_ACO_ORG_FACT_src.ACO_TYPE_DESC = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_ORG_FACT_src.ACO_TYPE_DESC))::numeric(37,15) END AS ACO_TYPE_DESC,
        EXT_HCOS_ACO_ORG_FACT_src.batch_id,
        EXT_HCOS_ACO_ORG_FACT_src.row_id,
        EXT_HCOS_ACO_ORG_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_ACO_ORG_FACT_src
 WHERE (EXT_HCOS_ACO_ORG_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_ACO_ORG_FACT'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_HCOS_ACO_PROFESSIONAL_RSTR AS
 SELECT btrim(EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.ACO_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.ACO_TYPE_ID))::numeric(37,15) END AS ACO_TYPE_ID,
        CASE WHEN (EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.HCE_ID_PRFSNL))::numeric(37,15) END AS HCE_ID_PRFSNL,
        CASE WHEN (EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.PROFESSIONAL_ID))::numeric(37,15) END AS PROFESSIONAL_ID,
        EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.batch_id,
        EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.row_id,
        EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.update_ts
 FROM teva_ingestion.EXT_HCOS_ACO_PROFESSIONAL_RSTR_src
 WHERE (EXT_HCOS_ACO_PROFESSIONAL_RSTR_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_ACO_PROFESSIONAL_RSTR'::varchar(30))));

CREATE  VIEW teva_ingestion.ext_hcos_aco_type AS
 SELECT CASE WHEN (EXT_HCOS_ACO_TYPE_src.ACO_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_ACO_TYPE_src.ACO_TYPE_ID))::numeric(37,15) END AS ACO_TYPE_ID,
        btrim(EXT_HCOS_ACO_TYPE_src.ACO_TYPE_DESC) AS ACO_TYPE_DESC,
        btrim(EXT_HCOS_ACO_TYPE_src.ACO_TYPE_CATG) AS ACO_TYPE_CATG,
        btrim(EXT_HCOS_ACO_TYPE_src.ACO_MODEL) AS ACO_MODEL,
        EXT_HCOS_ACO_TYPE_src.batch_id,
        EXT_HCOS_ACO_TYPE_src.row_id,
        EXT_HCOS_ACO_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_ACO_TYPE_src
 WHERE (EXT_HCOS_ACO_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_ACO_TYPE'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_hcos_affiliation_type AS
 SELECT CASE WHEN (EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_ID))::numeric(37,15) END AS AFFIL_TYPE_ID,
        btrim(EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_CODE) AS AFFIL_TYPE_CODE,
        btrim(EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_DESC) AS AFFIL_TYPE_DESC,
        btrim(EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_GROUP_CODE) AS AFFIL_GROUP_CODE,
        btrim(EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_GROUP_DESC) AS AFFIL_GROUP_DESC,
        EXT_HCOS_AFFILIATION_TYPE_src.batch_id,
        EXT_HCOS_AFFILIATION_TYPE_src.row_id,
        EXT_HCOS_AFFILIATION_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_AFFILIATION_TYPE_src
 WHERE (EXT_HCOS_AFFILIATION_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_AFFILIATION_TYPE'::varchar(25))));

CREATE  VIEW teva_ingestion.ext_hcos_bed_cluster_type AS
 SELECT CASE WHEN (EXT_HCOS_BED_CLUSTER_TYPE_src.BED_CLUSTER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_CLUSTER_TYPE_src.BED_CLUSTER_ID))::numeric(37,15) END AS BED_CLUSTER_ID,
        btrim(EXT_HCOS_BED_CLUSTER_TYPE_src.BED_CLUSTER_DESC) AS BED_CLUSTER_DESC,
        EXT_HCOS_BED_CLUSTER_TYPE_src.batch_id,
        EXT_HCOS_BED_CLUSTER_TYPE_src.row_id,
        EXT_HCOS_BED_CLUSTER_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BED_CLUSTER_TYPE_src
 WHERE (EXT_HCOS_BED_CLUSTER_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BED_CLUSTER_TYPE'::varchar(25))));

CREATE  VIEW teva_ingestion.ext_hcos_bed_fact AS
 SELECT btrim(EXT_HCOS_BED_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_BED_FACT_src.BED_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_FACT_src.BED_ID))::numeric(37,15) END AS BED_ID,
        CASE WHEN (EXT_HCOS_BED_FACT_src.LICENSE_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_FACT_src.LICENSE_BEDS))::numeric(37,15) END AS LICENSE_BEDS,
        CASE WHEN (EXT_HCOS_BED_FACT_src.CENSUS_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_FACT_src.CENSUS_BEDS))::numeric(37,15) END AS CENSUS_BEDS,
        CASE WHEN (EXT_HCOS_BED_FACT_src.STAFFED_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_FACT_src.STAFFED_BEDS))::numeric(37,15) END AS STAFFED_BEDS,
        EXT_HCOS_BED_FACT_src.batch_id,
        EXT_HCOS_BED_FACT_src.row_id,
        EXT_HCOS_BED_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BED_FACT_src
 WHERE (EXT_HCOS_BED_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BED_FACT'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_hcos_bed_type AS
 SELECT CASE WHEN (EXT_HCOS_BED_TYPE_src.BED_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BED_TYPE_src.BED_ID))::numeric(37,15) END AS BED_ID,
        btrim(EXT_HCOS_BED_TYPE_src.BED_CODE) AS BED_CODE,
        btrim(EXT_HCOS_BED_TYPE_src.BED_DESC) AS BED_DESC,
        EXT_HCOS_BED_TYPE_src.batch_id,
        EXT_HCOS_BED_TYPE_src.row_id,
        EXT_HCOS_BED_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BED_TYPE_src
 WHERE (EXT_HCOS_BED_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BED_TYPE'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_hcos_business AS
 SELECT btrim(EXT_HCOS_BUSINESS_src.IMS_ORG_ID) AS IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.BUSINESS_NAME) AS BUSINESS_NAME,
        btrim(EXT_HCOS_BUSINESS_src.DBA_NAME) AS DBA_NAME,
        btrim(EXT_HCOS_BUSINESS_src.CARE_OF_LOCATION) AS CARE_OF_LOCATION,
        btrim(EXT_HCOS_BUSINESS_src.ADDRESS_ID) AS ADDRESS_ID,
        btrim(EXT_HCOS_BUSINESS_src.STF_ID) AS STF_ID,
        btrim(EXT_HCOS_BUSINESS_src.PHYSICAL_ADDR_1) AS PHYSICAL_ADDR_1,
        btrim(EXT_HCOS_BUSINESS_src.PHYSICAL_ADDR_2) AS PHYSICAL_ADDR_2,
        btrim(EXT_HCOS_BUSINESS_src.PHYSICAL_CITY) AS PHYSICAL_CITY,
        btrim(EXT_HCOS_BUSINESS_src.PHYSICAL_STATE) AS PHYSICAL_STATE,
        btrim(EXT_HCOS_BUSINESS_src.PHYSICAL_ZIP) AS PHYSICAL_ZIP,
        btrim(EXT_HCOS_BUSINESS_src.POSTAL_ADDR_1) AS POSTAL_ADDR_1,
        btrim(EXT_HCOS_BUSINESS_src.POSTAL_ADDR_2) AS POSTAL_ADDR_2,
        btrim(EXT_HCOS_BUSINESS_src.POSTAL_CITY) AS POSTAL_CITY,
        btrim(EXT_HCOS_BUSINESS_src.POSTAL_STATE) AS POSTAL_STATE,
        btrim(EXT_HCOS_BUSINESS_src.POSTAL_ZIP) AS POSTAL_ZIP,
        btrim(EXT_HCOS_BUSINESS_src.PHONE) AS PHONE,
        btrim(EXT_HCOS_BUSINESS_src.FAX) AS FAX,
        btrim(EXT_HCOS_BUSINESS_src.WEBSITE) AS WEBSITE,
        CASE WHEN (EXT_HCOS_BUSINESS_src.LATITUDE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.LATITUDE))::numeric(37,15) END AS LATITUDE,
        CASE WHEN (EXT_HCOS_BUSINESS_src.LONGITUDE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.LONGITUDE))::numeric(37,15) END AS LONGITUDE,
        btrim(EXT_HCOS_BUSINESS_src.OWNER_STATUS) AS OWNER_STATUS,
        btrim(EXT_HCOS_BUSINESS_src.PROFIT_STATUS) AS PROFIT_STATUS,
        CASE WHEN (EXT_HCOS_BUSINESS_src.CMI = ''::varchar) THEN NULL::numeric(6,4) ELSE (btrim(EXT_HCOS_BUSINESS_src.CMI))::numeric(6,4) END AS CMI,
        CASE WHEN (EXT_HCOS_BUSINESS_src.PRIMARY_COT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.PRIMARY_COT_ID))::numeric(37,15) END AS PRIMARY_COT_ID,
        CASE WHEN (EXT_HCOS_BUSINESS_src.COT_CLASSIFICATION_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.COT_CLASSIFICATION_ID))::numeric(37,15) END AS COT_CLASSIFICATION_ID,
        btrim(EXT_HCOS_BUSINESS_src.COT_CLASSIFICATION) AS COT_CLASSIFICATION,
        CASE WHEN (EXT_HCOS_BUSINESS_src.COT_FACILITY_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.COT_FACILITY_TYPE_ID))::numeric(37,15) END AS COT_FACILITY_TYPE_ID,
        btrim(EXT_HCOS_BUSINESS_src.COT_FACILITY_TYPE) AS COT_FACILITY_TYPE,
        CASE WHEN (EXT_HCOS_BUSINESS_src.COT_SPECIALTY_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.COT_SPECIALTY_ID))::numeric(37,15) END AS COT_SPECIALTY_ID,
        btrim(EXT_HCOS_BUSINESS_src.COT_SPECIALTY) AS COT_SPECIALTY,
        btrim(EXT_HCOS_BUSINESS_src.RECORD_TYPE) AS RECORD_TYPE,
        CASE WHEN (EXT_HCOS_BUSINESS_src.BED_CLUSTER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.BED_CLUSTER_ID))::numeric(37,15) END AS BED_CLUSTER_ID,
        CASE WHEN (EXT_HCOS_BUSINESS_src.TTL_LICENSE_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.TTL_LICENSE_BEDS))::numeric(37,15) END AS TTL_LICENSE_BEDS,
        CASE WHEN (EXT_HCOS_BUSINESS_src.TTL_CENSUS_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.TTL_CENSUS_BEDS))::numeric(37,15) END AS TTL_CENSUS_BEDS,
        CASE WHEN (EXT_HCOS_BUSINESS_src.TTL_STAFFED_BEDS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.TTL_STAFFED_BEDS))::numeric(37,15) END AS TTL_STAFFED_BEDS,
        btrim((EXT_HCOS_BUSINESS_src.TEACHING_HOSP)::varchar(1)) AS TEACHING_HOSP,
        btrim(EXT_HCOS_BUSINESS_src.COMMHOSP) AS COMMHOSP,
        btrim(EXT_HCOS_BUSINESS_src.ALL_DDD) AS ALL_DDD,
        btrim(EXT_HCOS_BUSINESS_src.ALL_NPI) AS ALL_NPI,
        btrim(EXT_HCOS_BUSINESS_src.HIN) AS HIN,
        btrim(EXT_HCOS_BUSINESS_src.DEA) AS DEA,
        btrim(EXT_HCOS_BUSINESS_src.MPN) AS MPN,
        btrim(EXT_HCOS_BUSINESS_src.MPN_ORDER) AS MPN_ORDER,
        btrim(EXT_HCOS_BUSINESS_src.MSA) AS MSA,
        btrim(EXT_HCOS_BUSINESS_src.FIPS_STATE) AS FIPS_STATE,
        btrim(EXT_HCOS_BUSINESS_src.FIPS_COUNTY) AS FIPS_COUNTY,
        CASE WHEN (EXT_HCOS_BUSINESS_src.NUM_OF_PROVIDERS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_src.NUM_OF_PROVIDERS))::numeric(37,15) END AS NUM_OF_PROVIDERS,
        btrim(EXT_HCOS_BUSINESS_src.CORP_PARENT_IMS_ORG_ID) AS CORP_PARENT_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.CORP_PARENT_NAME) AS CORP_PARENT_NAME,
        btrim(EXT_HCOS_BUSINESS_src.OWNER_SUB_IMS_ORG_ID) AS OWNER_SUB_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.OWNER_SUB_NAME) AS OWNER_SUB_NAME,
        btrim(EXT_HCOS_BUSINESS_src.GPO_PHARMA_IMS_ORG_ID) AS GPO_PHARMA_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.GPO_PHARMA_NAME) AS GPO_PHARMA_NAME,
        btrim(EXT_HCOS_BUSINESS_src.GPO_MEDSURG_IMS_ORG_ID) AS GPO_MEDSURG_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.GPO_MEDSURG_NAME) AS GPO_MEDSURG_NAME,
        btrim(EXT_HCOS_BUSINESS_src.PHARMA_PROV_IMS_ORG_ID) AS PHARMA_PROV_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.PHARMA_PROV_NAME) AS PHARMA_PROV_NAME,
        btrim(EXT_HCOS_BUSINESS_src.FORMULARY) AS FORMULARY,
        btrim(EXT_HCOS_BUSINESS_src.ELECTRONIC_MED_REC) AS ELECTRONIC_MED_REC,
        btrim(EXT_HCOS_BUSINESS_src.EPRESCRIBE) AS EPRESCRIBE,
        btrim(EXT_HCOS_BUSINESS_src.PAYPERFORM) AS PAYPERFORM,
        btrim(EXT_HCOS_BUSINESS_src.GENFIRST) AS GENFIRST,
        btrim(EXT_HCOS_BUSINESS_src.SREP_ACCESS) AS SREP_ACCESS,
        btrim(EXT_HCOS_BUSINESS_src.DEACTIVATION_REASON) AS DEACTIVATION_REASON,
        btrim(EXT_HCOS_BUSINESS_src.REFERBACK_IMS_ORG_ID) AS REFERBACK_IMS_ORG_ID,
        btrim(EXT_HCOS_BUSINESS_src.STATUS_INDICATOR) AS STATUS_INDICATOR,
        EXT_HCOS_BUSINESS_src.batch_id,
        EXT_HCOS_BUSINESS_src.row_id,
        EXT_HCOS_BUSINESS_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BUSINESS_src
 WHERE (EXT_HCOS_BUSINESS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BUSINESS'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_hcos_business_detail AS
 SELECT CASE WHEN (EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_ID))::numeric(37,15) END AS DETAIL_ID,
        btrim(EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_CODE) AS DETAIL_CODE,
        btrim(EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_DESC) AS DETAIL_DESC,
        btrim(EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_GROUP_CODE) AS DETAIL_GROUP_CODE,
        btrim(EXT_HCOS_BUSINESS_DETAIL_src.DETAIL_GROUP_CODE_DESC) AS DETAIL_GROUP_CODE_DESC,
        EXT_HCOS_BUSINESS_DETAIL_src.batch_id,
        EXT_HCOS_BUSINESS_DETAIL_src.row_id,
        EXT_HCOS_BUSINESS_DETAIL_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BUSINESS_DETAIL_src
 WHERE (EXT_HCOS_BUSINESS_DETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BUSINESS_DETAIL'::varchar(24))));

CREATE  VIEW teva_ingestion.ext_hcos_business_detail_fact AS
 SELECT btrim(EXT_HCOS_BUSINESS_DETAIL_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_BUSINESS_DETAIL_FACT_src.DETAIL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_BUSINESS_DETAIL_FACT_src.DETAIL_ID))::numeric(37,15) END AS DETAIL_ID,
        btrim(EXT_HCOS_BUSINESS_DETAIL_FACT_src.DETAIL_VALUE) AS DETAIL_VALUE,
        CASE WHEN (EXT_HCOS_BUSINESS_DETAIL_FACT_src.DETAIL_COUNT = ''::varchar) THEN NULL::numeric(12,4) ELSE (btrim(EXT_HCOS_BUSINESS_DETAIL_FACT_src.DETAIL_COUNT))::numeric(12,4) END AS DETAIL_COUNT,
        EXT_HCOS_BUSINESS_DETAIL_FACT_src.batch_id,
        EXT_HCOS_BUSINESS_DETAIL_FACT_src.row_id,
        EXT_HCOS_BUSINESS_DETAIL_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_BUSINESS_DETAIL_FACT_src
 WHERE (EXT_HCOS_BUSINESS_DETAIL_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_BUSINESS_DETAIL_FACT'::varchar(29))));

CREATE  VIEW teva_ingestion.ext_hcos_class_of_trade AS
 SELECT CASE WHEN (EXT_HCOS_CLASS_OF_TRADE_src.COT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLASS_OF_TRADE_src.COT_ID))::numeric(37,15) END AS COT_ID,
        CASE WHEN (EXT_HCOS_CLASS_OF_TRADE_src.CLASSIFICATION_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLASS_OF_TRADE_src.CLASSIFICATION_ID))::numeric(37,15) END AS CLASSIFICATION_ID,
        btrim(EXT_HCOS_CLASS_OF_TRADE_src.CLASSIFICATION) AS CLASSIFICATION,
        CASE WHEN (EXT_HCOS_CLASS_OF_TRADE_src.FACILITY_TYPE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLASS_OF_TRADE_src.FACILITY_TYPE_ID))::numeric(37,15) END AS FACILITY_TYPE_ID,
        btrim(EXT_HCOS_CLASS_OF_TRADE_src.FACILITY_TYPE) AS FACILITY_TYPE,
        CASE WHEN (EXT_HCOS_CLASS_OF_TRADE_src.SPECIALTY_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLASS_OF_TRADE_src.SPECIALTY_ID))::numeric(37,15) END AS SPECIALTY_ID,
        btrim(EXT_HCOS_CLASS_OF_TRADE_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_HCOS_CLASS_OF_TRADE_src.RECORD_TYPE) AS RECORD_TYPE,
        EXT_HCOS_CLASS_OF_TRADE_src.batch_id,
        EXT_HCOS_CLASS_OF_TRADE_src.row_id,
        EXT_HCOS_CLASS_OF_TRADE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_CLASS_OF_TRADE_src
 WHERE (EXT_HCOS_CLASS_OF_TRADE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CLASS_OF_TRADE'::varchar(23))));

CREATE  VIEW teva_ingestion.ext_hcos_clinical_code AS
 SELECT CASE WHEN (EXT_HCOS_CLINICAL_CODE_src.CODE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_CODE_src.CODE_ID))::numeric(37,15) END AS CODE_ID,
        btrim(EXT_HCOS_CLINICAL_CODE_src.CLIN_CODE) AS CLIN_CODE,
        btrim(EXT_HCOS_CLINICAL_CODE_src.CLIN_CODE_DESC) AS CLIN_CODE_DESC,
        CASE WHEN (EXT_HCOS_CLINICAL_CODE_src.CCS_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_CODE_src.CCS_CODE))::numeric(37,15) END AS CCS_CODE,
        btrim(EXT_HCOS_CLINICAL_CODE_src.CCS_DESC) AS CCS_DESC,
        CASE WHEN (EXT_HCOS_CLINICAL_CODE_src.MDC_CODE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_CODE_src.MDC_CODE))::numeric(37,15) END AS MDC_CODE,
        btrim(EXT_HCOS_CLINICAL_CODE_src.MDC_DESC) AS MDC_DESC,
        btrim(EXT_HCOS_CLINICAL_CODE_src.CODE_CATEGORY) AS CODE_CATEGORY,
        btrim((EXT_HCOS_CLINICAL_CODE_src.SURGICAL_CODE)::varchar(1)) AS SURGICAL_CODE,
        btrim((EXT_HCOS_CLINICAL_CODE_src.OR_CODE)::varchar(1)) AS OR_CODE,
        EXT_HCOS_CLINICAL_CODE_src.batch_id,
        EXT_HCOS_CLINICAL_CODE_src.row_id,
        EXT_HCOS_CLINICAL_CODE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_CLINICAL_CODE_src
 WHERE (EXT_HCOS_CLINICAL_CODE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CLINICAL_CODE'::varchar(22))));

CREATE  VIEW teva_ingestion.ext_hcos_clinical_fact AS
 SELECT btrim(EXT_HCOS_CLINICAL_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.CODE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.CODE_ID))::numeric(37,15) END AS CODE_ID,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.DATA_YEAR = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.DATA_YEAR))::numeric(4,0) END AS DATA_YEAR,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.INPAT_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.INPAT_VOL))::numeric(37,15) END AS INPAT_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.OUTPAT_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.OUTPAT_VOL))::numeric(37,15) END AS OUTPAT_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.TTL_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.TTL_VOL))::numeric(37,15) END AS TTL_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.DECILE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.DECILE))::numeric(37,15) END AS DECILE,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.AVG_LOS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.AVG_LOS))::numeric(9,2) END AS AVG_LOS,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_src.AVG_COS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_src.AVG_COS))::numeric(9,2) END AS AVG_COS,
        btrim(EXT_HCOS_CLINICAL_FACT_src.CODE_ORDER) AS CODE_ORDER,
        btrim(EXT_HCOS_CLINICAL_FACT_src.GPO_VIEW) AS GPO_VIEW,
        btrim(EXT_HCOS_CLINICAL_FACT_src.USE_FOR_AGG) AS USE_FOR_AGG,
        EXT_HCOS_CLINICAL_FACT_src.batch_id,
        EXT_HCOS_CLINICAL_FACT_src.row_id,
        EXT_HCOS_CLINICAL_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_CLINICAL_FACT_src
 WHERE (EXT_HCOS_CLINICAL_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CLINICAL_FACT'::varchar(22))));

CREATE  VIEW teva_ingestion.ext_hcos_clinical_fact_national AS
 SELECT CASE WHEN (ext_hcos_clinical_fact_national_src.CODE_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_clinical_fact_national_src.CODE_ID))::int END AS CODE_ID,
        CASE WHEN (ext_hcos_clinical_fact_national_src.DATA_YEAR = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_clinical_fact_national_src.DATA_YEAR))::int END AS DATA_YEAR,
        CASE WHEN (ext_hcos_clinical_fact_national_src.INPAT_VOL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_clinical_fact_national_src.INPAT_VOL))::int END AS INPAT_VOL,
        CASE WHEN (ext_hcos_clinical_fact_national_src.OUTPAT_VOL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_clinical_fact_national_src.OUTPAT_VOL))::int END AS OUTPAT_VOL,
        CASE WHEN (ext_hcos_clinical_fact_national_src.TTL_VOL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_clinical_fact_national_src.TTL_VOL))::int END AS TTL_VOL,
        CASE WHEN (ext_hcos_clinical_fact_national_src.AVG_LOS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(ext_hcos_clinical_fact_national_src.AVG_LOS))::numeric(9,2) END AS AVG_LOS,
        CASE WHEN (ext_hcos_clinical_fact_national_src.AVG_COS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(ext_hcos_clinical_fact_national_src.AVG_COS))::numeric(9,2) END AS AVG_COS,
        CASE WHEN (ext_hcos_clinical_fact_national_src.TREND = ''::varchar) THEN NULL::numeric(5,2) ELSE (btrim(ext_hcos_clinical_fact_national_src.TREND))::numeric(5,2) END AS TREND,
        btrim(ext_hcos_clinical_fact_national_src.CODE_ORDER) AS CODE_ORDER,
        ext_hcos_clinical_fact_national_src.batch_id,
        ext_hcos_clinical_fact_national_src.row_id,
        ext_hcos_clinical_fact_national_src.update_ts
 FROM teva_ingestion.ext_hcos_clinical_fact_national_src
 WHERE (ext_hcos_clinical_fact_national_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CLINICAL_FACT_NATIONAL'::varchar(31))));

CREATE  VIEW teva_ingestion.ext_hcos_clinical_fact_state AS
 SELECT CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.CODE_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.CODE_ID))::numeric(37,15) END AS CODE_ID,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.DATA_YEAR = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.DATA_YEAR))::numeric(4,0) END AS DATA_YEAR,
        btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.STATE) AS STATE,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.INPAT_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.INPAT_VOL))::numeric(37,15) END AS INPAT_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.OUTPAT_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.OUTPAT_VOL))::numeric(37,15) END AS OUTPAT_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.TTL_VOL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.TTL_VOL))::numeric(37,15) END AS TTL_VOL,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.AVG_LOS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.AVG_LOS))::numeric(9,2) END AS AVG_LOS,
        CASE WHEN (EXT_HCOS_CLINICAL_FACT_STATE_src.AVG_COS = ''::varchar) THEN NULL::numeric(9,2) ELSE (btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.AVG_COS))::numeric(9,2) END AS AVG_COS,
        btrim(EXT_HCOS_CLINICAL_FACT_STATE_src.CODE_ORDER) AS CODE_ORDER,
        EXT_HCOS_CLINICAL_FACT_STATE_src.batch_id,
        EXT_HCOS_CLINICAL_FACT_STATE_src.row_id,
        EXT_HCOS_CLINICAL_FACT_STATE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_CLINICAL_FACT_STATE_src
 WHERE (EXT_HCOS_CLINICAL_FACT_STATE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CLINICAL_FACT_STATE'::varchar(28))));

CREATE  VIEW teva_ingestion.ext_hcos_contact_affiltn_fact AS
 SELECT btrim(EXT_HCOS_CONTACT_AFFILTN_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_CONTACT_AFFILTN_FACT_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CONTACT_AFFILTN_FACT_src.HCE_ID_PRFSNL))::numeric(37,15) END AS HCE_ID_PRFSNL,
        CASE WHEN (EXT_HCOS_CONTACT_AFFILTN_FACT_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_CONTACT_AFFILTN_FACT_src.PROFESSIONAL_ID))::numeric(37,15) END AS PROFESSIONAL_ID,
        btrim(EXT_HCOS_CONTACT_AFFILTN_FACT_src.TITLE_GROUP_CODE) AS TITLE_GROUP_CODE,
        EXT_HCOS_CONTACT_AFFILTN_FACT_src.batch_id,
        EXT_HCOS_CONTACT_AFFILTN_FACT_src.row_id,
        EXT_HCOS_CONTACT_AFFILTN_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_CONTACT_AFFILTN_FACT_src
 WHERE (EXT_HCOS_CONTACT_AFFILTN_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_CONTACT_AFFILTN_FACT'::varchar(29))));

CREATE  VIEW teva_ingestion.ext_hcos_cot_fact AS
 SELECT btrim(EXT_HCOS_COT_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_COT_FACT_src.COT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_COT_FACT_src.COT_ID))::numeric(37,15) END AS COT_ID,
        CASE WHEN (EXT_HCOS_COT_FACT_src.COT_ORDER = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_COT_FACT_src.COT_ORDER))::numeric(37,15) END AS COT_ORDER,
        EXT_HCOS_COT_FACT_src.batch_id,
        EXT_HCOS_COT_FACT_src.row_id,
        EXT_HCOS_COT_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_COT_FACT_src
 WHERE (EXT_HCOS_COT_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_COT_FACT'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_hcos_financial_fact AS
 SELECT btrim(EXT_HCOS_FINANCIAL_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.DATA_YEAR = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.DATA_YEAR))::numeric(4,0) END AS DATA_YEAR,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.INPAT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.INPAT_REV))::numeric(37,15) END AS INPAT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.OUTPAT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.OUTPAT_REV))::numeric(37,15) END AS OUTPAT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.TTL_PAT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.TTL_PAT_REV))::numeric(37,15) END AS TTL_PAT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.NET_PAT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.NET_PAT_REV))::numeric(37,15) END AS NET_PAT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.OP_EXP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.OP_EXP))::numeric(37,15) END AS OP_EXP,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.OTH_EXP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.OTH_EXP))::numeric(37,15) END AS OTH_EXP,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.TTL_EXP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.TTL_EXP))::numeric(37,15) END AS TTL_EXP,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.SUPPLY_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.SUPPLY_COST))::numeric(37,15) END AS SUPPLY_COST,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.DRUG_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.DRUG_COST))::numeric(37,15) END AS DRUG_COST,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.TTL_SALARIES = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.TTL_SALARIES))::numeric(37,15) END AS TTL_SALARIES,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.NET_INC_PAT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.NET_INC_PAT))::numeric(37,15) END AS NET_INC_PAT,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.NET_INC = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.NET_INC))::numeric(37,15) END AS NET_INC,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.COST_PER_BED = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.COST_PER_BED))::numeric(37,15) END AS COST_PER_BED,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.TTL_ASSETS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.TTL_ASSETS))::numeric(37,15) END AS TTL_ASSETS,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.FTE_EMP = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.FTE_EMP))::numeric(37,15) END AS FTE_EMP,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.CURR_ASSETS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.CURR_ASSETS))::numeric(37,15) END AS CURR_ASSETS,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.CURR_LIAB = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.CURR_LIAB))::numeric(37,15) END AS CURR_LIAB,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.FIX_ASSETS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.FIX_ASSETS))::numeric(37,15) END AS FIX_ASSETS,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.FRINGE_BENEFITS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.FRINGE_BENEFITS))::numeric(37,15) END AS FRINGE_BENEFITS,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.FUND_BAL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.FUND_BAL))::numeric(37,15) END AS FUND_BAL,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.GOV_APPR = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.GOV_APPR))::numeric(37,15) END AS GOV_APPR,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.H_IN_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.H_IN_REV))::numeric(37,15) END AS H_IN_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.L_T_LIAB = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.L_T_LIAB))::numeric(37,15) END AS L_T_LIAB,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.NON_PAT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.NON_PAT_REV))::numeric(37,15) END AS NON_PAT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.OTH_ASSETS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.OTH_ASSETS))::numeric(37,15) END AS OTH_ASSETS,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.OTH_INCOME = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.OTH_INCOME))::numeric(37,15) END AS OTH_INCOME,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.H_OUT_REV = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.H_OUT_REV))::numeric(37,15) END AS H_OUT_REV,
        CASE WHEN (EXT_HCOS_FINANCIAL_FACT_src.TOT_LIAB = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_FINANCIAL_FACT_src.TOT_LIAB))::numeric(37,15) END AS TOT_LIAB,
        EXT_HCOS_FINANCIAL_FACT_src.batch_id,
        EXT_HCOS_FINANCIAL_FACT_src.row_id,
        EXT_HCOS_FINANCIAL_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_FINANCIAL_FACT_src
 WHERE (EXT_HCOS_FINANCIAL_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_FINANCIAL_FACT'::varchar(23))));

CREATE  VIEW teva_ingestion.ext_hcos_identifier_fact AS
 SELECT btrim(EXT_HCOS_IDENTIFIER_FACT_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (EXT_HCOS_IDENTIFIER_FACT_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_IDENTIFIER_FACT_src.HCE_ID_PRFSNL))::numeric(37,15) END AS HCE_ID_PRFSNL,
        CASE WHEN (EXT_HCOS_IDENTIFIER_FACT_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_IDENTIFIER_FACT_src.PROFESSIONAL_ID))::numeric(37,15) END AS PROFESSIONAL_ID,
        CASE WHEN (EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_ID))::numeric(37,15) END AS IDENTIFIER_ID,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER) AS IDENTIFIER,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_ORDER) AS IDENTIFIER_ORDER,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_CATEGORY) AS IDENTIFIER_CATEGORY,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_STATE) AS IDENTIFIER_STATE,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.SRC_STRT_DT) AS SRC_STRT_DT,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.SRC_TRMTN_DT) AS SRC_TRMTN_DT,
        btrim(EXT_HCOS_IDENTIFIER_FACT_src.SRC_TRMTN_CD) AS SRC_TRMTN_CD,
        EXT_HCOS_IDENTIFIER_FACT_src.batch_id,
        EXT_HCOS_IDENTIFIER_FACT_src.row_id,
        EXT_HCOS_IDENTIFIER_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_IDENTIFIER_FACT_src
 WHERE (EXT_HCOS_IDENTIFIER_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_IDENTIFIER_FACT'::varchar(24))));

CREATE  VIEW teva_ingestion.ext_hcos_identifier_type AS
 SELECT CASE WHEN (EXT_HCOS_IDENTIFIER_TYPE_src.IDENTIFIER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_IDENTIFIER_TYPE_src.IDENTIFIER_ID))::numeric(37,15) END AS IDENTIFIER_ID,
        btrim(EXT_HCOS_IDENTIFIER_TYPE_src.IDENTIFIER_CODE) AS IDENTIFIER_CODE,
        btrim(EXT_HCOS_IDENTIFIER_TYPE_src.IDENTIFIER_DESC) AS IDENTIFIER_DESC,
        EXT_HCOS_IDENTIFIER_TYPE_src.batch_id,
        EXT_HCOS_IDENTIFIER_TYPE_src.row_id,
        EXT_HCOS_IDENTIFIER_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_IDENTIFIER_TYPE_src
 WHERE (EXT_HCOS_IDENTIFIER_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_IDENTIFIER_TYPE'::varchar(24))));

CREATE  VIEW teva_ingestion.ext_hcos_indentifier_cat_type AS
 SELECT CASE WHEN (EXT_HCOS_INDENTIFIER_CAT_TYPE_src.IDENTIFIER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_INDENTIFIER_CAT_TYPE_src.IDENTIFIER_ID))::numeric(37,15) END AS IDENTIFIER_ID,
        btrim(EXT_HCOS_INDENTIFIER_CAT_TYPE_src.IDENTIFIER_CATEGORY) AS IDENTIFIER_CATEGORY,
        btrim(EXT_HCOS_INDENTIFIER_CAT_TYPE_src.IDENTIFIER_CATEGORY_DESC) AS IDENTIFIER_CATEGORY_DESC,
        EXT_HCOS_INDENTIFIER_CAT_TYPE_src.batch_id,
        EXT_HCOS_INDENTIFIER_CAT_TYPE_src.row_id,
        EXT_HCOS_INDENTIFIER_CAT_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_INDENTIFIER_CAT_TYPE_src
 WHERE (EXT_HCOS_INDENTIFIER_CAT_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_INDENTIFIER_CAT_TYPE'::varchar(29))));

CREATE  VIEW teva_ingestion.ext_hcos_indentifier_term_type AS
 SELECT CASE WHEN (EXT_HCOS_INDENTIFIER_TERM_TYPE_src.IDENTIFIER_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_INDENTIFIER_TERM_TYPE_src.IDENTIFIER_ID))::numeric(37,15) END AS IDENTIFIER_ID,
        btrim(EXT_HCOS_INDENTIFIER_TERM_TYPE_src.SRC_TRMTN_CD) AS SRC_TRMTN_CD,
        btrim(EXT_HCOS_INDENTIFIER_TERM_TYPE_src.SRC_TRMTN_DESC) AS SRC_TRMTN_DESC,
        EXT_HCOS_INDENTIFIER_TERM_TYPE_src.batch_id,
        EXT_HCOS_INDENTIFIER_TERM_TYPE_src.row_id,
        EXT_HCOS_INDENTIFIER_TERM_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_INDENTIFIER_TERM_TYPE_src
 WHERE (EXT_HCOS_INDENTIFIER_TERM_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_INDENTIFIER_TERM_TYPE'::varchar(30))));

CREATE  VIEW teva_ingestion.ext_hcos_professional AS
 SELECT CASE WHEN (EXT_HCOS_PROFESSIONAL_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_PROFESSIONAL_src.HCE_ID_PRFSNL))::numeric(37,15) END AS HCE_ID_PRFSNL,
        CASE WHEN (EXT_HCOS_PROFESSIONAL_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_PROFESSIONAL_src.PROFESSIONAL_ID))::numeric(37,15) END AS PROFESSIONAL_ID,
        btrim(EXT_HCOS_PROFESSIONAL_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_HCOS_PROFESSIONAL_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(EXT_HCOS_PROFESSIONAL_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_HCOS_PROFESSIONAL_src.GEN_SUFFIX) AS GEN_SUFFIX,
        btrim(EXT_HCOS_PROFESSIONAL_src.DESIGNATION) AS DESIGNATION,
        btrim(EXT_HCOS_PROFESSIONAL_src.GENDER) AS GENDER,
        btrim((EXT_HCOS_PROFESSIONAL_src.ROLE)::varchar(1)) AS ROLE,
        btrim(EXT_HCOS_PROFESSIONAL_src.PRIMARY_SPEC) AS PRIMARY_SPEC,
        btrim(EXT_HCOS_PROFESSIONAL_src.SECONDARY_SPEC) AS SECONDARY_SPEC,
        btrim(EXT_HCOS_PROFESSIONAL_src.TERTIARY_SPEC) AS TERTIARY_SPEC,
        btrim(EXT_HCOS_PROFESSIONAL_src.PRIMARY_PROF_CODE) AS PRIMARY_PROF_CODE,
        btrim(EXT_HCOS_PROFESSIONAL_src.PRIMARY_PROF_DESC) AS PRIMARY_PROF_DESC,
        btrim(EXT_HCOS_PROFESSIONAL_src.IMS_ID) AS IMS_ID,
        btrim(EXT_HCOS_PROFESSIONAL_src.UPIN) AS UPIN,
        btrim(EXT_HCOS_PROFESSIONAL_src.ME) AS ME,
        btrim(EXT_HCOS_PROFESSIONAL_src.ALL_DEA) AS ALL_DEA,
        btrim(EXT_HCOS_PROFESSIONAL_src.NPI) AS NPI,
        btrim(EXT_HCOS_PROFESSIONAL_src.STATUS_DESC) AS STATUS_DESC,
        EXT_HCOS_PROFESSIONAL_src.batch_id,
        EXT_HCOS_PROFESSIONAL_src.row_id,
        EXT_HCOS_PROFESSIONAL_src.update_ts
 FROM teva_ingestion.EXT_HCOS_PROFESSIONAL_src
 WHERE (EXT_HCOS_PROFESSIONAL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL'::varchar(21))));

CREATE  VIEW teva_ingestion.ext_hcos_professional_detail AS
 SELECT CASE WHEN (EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_ID))::numeric(37,15) END AS DETAIL_ID,
        btrim(EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_CODE) AS DETAIL_CODE,
        btrim(EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_DESC) AS DETAIL_DESC,
        btrim(EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_GROUP_CODE) AS DETAIL_GROUP_CODE,
        btrim(EXT_HCOS_PROFESSIONAL_DETAIL_src.DETAIL_GROUP_DESC) AS DETAIL_GROUP_DESC,
        EXT_HCOS_PROFESSIONAL_DETAIL_src.batch_id,
        EXT_HCOS_PROFESSIONAL_DETAIL_src.row_id,
        EXT_HCOS_PROFESSIONAL_DETAIL_src.update_ts
 FROM teva_ingestion.EXT_HCOS_PROFESSIONAL_DETAIL_src
 WHERE (EXT_HCOS_PROFESSIONAL_DETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL_DETAIL'::varchar(28))));

CREATE  VIEW teva_ingestion.ext_hcos_professional_detail_fact AS
 SELECT CASE WHEN (ext_hcos_professional_detail_fact_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_detail_fact_src.HCE_ID_PRFSNL))::int END AS HCE_ID_PRFSNL,
        CASE WHEN (ext_hcos_professional_detail_fact_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_detail_fact_src.PROFESSIONAL_ID))::int END AS PROFESSIONAL_ID,
        CASE WHEN (ext_hcos_professional_detail_fact_src.DETAIL_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_detail_fact_src.DETAIL_ID))::int END AS DETAIL_ID,
        btrim(ext_hcos_professional_detail_fact_src.DETAIL_VALUE) AS DETAIL_VALUE,
        CASE WHEN (ext_hcos_professional_detail_fact_src.DETAIL_COUNT = ''::varchar) THEN NULL::numeric(12,4) ELSE (btrim(ext_hcos_professional_detail_fact_src.DETAIL_COUNT))::numeric(12,4) END AS DETAIL_COUNT,
        ext_hcos_professional_detail_fact_src.batch_id,
        ext_hcos_professional_detail_fact_src.row_id,
        ext_hcos_professional_detail_fact_src.update_ts
 FROM teva_ingestion.ext_hcos_professional_detail_fact_src
 WHERE (ext_hcos_professional_detail_fact_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL_DETAIL_FACT'::varchar(33))));

CREATE  VIEW teva_ingestion.ext_hcos_professional_specialty AS
 SELECT btrim(ext_hcos_professional_specialty_src.SPEC_CODE) AS SPEC_CODE,
        btrim(ext_hcos_professional_specialty_src.SPEC_DESC) AS SPEC_DESC,
        CASE WHEN (ext_hcos_professional_specialty_src.SPEC_SUB_GROUP_CODE = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_specialty_src.SPEC_SUB_GROUP_CODE))::int END AS SPEC_SUB_GROUP_CODE,
        btrim(ext_hcos_professional_specialty_src.SPEC_SUB_GROUP_DESC) AS SPEC_SUB_GROUP_DESC,
        btrim(ext_hcos_professional_specialty_src.SPEC_GROUP_CODE) AS SPEC_GROUP_CODE,
        btrim(ext_hcos_professional_specialty_src.SPEC_GROUP_DESC) AS SPEC_GROUP_DESC,
        CASE WHEN (ext_hcos_professional_specialty_src.ALTERNATE_SUB_GROUP_CODE = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_specialty_src.ALTERNATE_SUB_GROUP_CODE))::int END AS ALTERNATE_SUB_GROUP_CODE,
        btrim(ext_hcos_professional_specialty_src.ALTERNATE_SUB_GROUP_DESC) AS ALTERNATE_SUB_GROUP_DESC,
        ext_hcos_professional_specialty_src.batch_id,
        ext_hcos_professional_specialty_src.row_id,
        ext_hcos_professional_specialty_src.update_ts
 FROM teva_ingestion.ext_hcos_professional_specialty_src
 WHERE (ext_hcos_professional_specialty_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL_SPECIALTY'::varchar(31))));

CREATE  VIEW teva_ingestion.ext_hcos_professional_spec_fact AS
 SELECT CASE WHEN (ext_hcos_professional_spec_fact_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_spec_fact_src.HCE_ID_PRFSNL))::int END AS HCE_ID_PRFSNL,
        CASE WHEN (ext_hcos_professional_spec_fact_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_spec_fact_src.PROFESSIONAL_ID))::int END AS PROFESSIONAL_ID,
        btrim(ext_hcos_professional_spec_fact_src.SPEC_CODE) AS SPEC_CODE,
        CASE WHEN (ext_hcos_professional_spec_fact_src.SPEC_RANKING = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_professional_spec_fact_src.SPEC_RANKING))::int END AS SPEC_RANKING,
        btrim(ext_hcos_professional_spec_fact_src.SPEC_RANK_DESC) AS SPEC_RANK_DESC,
        ext_hcos_professional_spec_fact_src.batch_id,
        ext_hcos_professional_spec_fact_src.row_id,
        ext_hcos_professional_spec_fact_src.update_ts
 FROM teva_ingestion.ext_hcos_professional_spec_fact_src
 WHERE (ext_hcos_professional_spec_fact_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL_SPEC_FACT'::varchar(31))));

CREATE  VIEW teva_ingestion.ext_hcos_professional_title AS
 SELECT btrim(EXT_HCOS_PROFESSIONAL_TITLE_src.TITLE_GROUP_CODE) AS TITLE_GROUP_CODE,
        btrim(EXT_HCOS_PROFESSIONAL_TITLE_src.TITLE_GROUP_DESC) AS TITLE_GROUP_DESC,
        EXT_HCOS_PROFESSIONAL_TITLE_src.batch_id,
        EXT_HCOS_PROFESSIONAL_TITLE_src.row_id,
        EXT_HCOS_PROFESSIONAL_TITLE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_PROFESSIONAL_TITLE_src
 WHERE (EXT_HCOS_PROFESSIONAL_TITLE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROFESSIONAL_TITLE'::varchar(27))));

CREATE  VIEW teva_ingestion.ext_hcos_provider_affiliation_fact AS
 SELECT btrim(ext_hcos_provider_affiliation_fact_src.IMS_ORG_ID) AS IMS_ORG_ID,
        CASE WHEN (ext_hcos_provider_affiliation_fact_src.HCE_ID_PRFSNL = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_provider_affiliation_fact_src.HCE_ID_PRFSNL))::int END AS HCE_ID_PRFSNL,
        CASE WHEN (ext_hcos_provider_affiliation_fact_src.PROFESSIONAL_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_provider_affiliation_fact_src.PROFESSIONAL_ID))::int END AS PROFESSIONAL_ID,
        CASE WHEN (ext_hcos_provider_affiliation_fact_src.AFFIL_TYPE_ID = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_provider_affiliation_fact_src.AFFIL_TYPE_ID))::int END AS AFFIL_TYPE_ID,
        btrim(ext_hcos_provider_affiliation_fact_src.DEA) AS DEA,
        btrim(ext_hcos_provider_affiliation_fact_src.AFFIL_IND) AS AFFIL_IND,
        CASE WHEN (ext_hcos_provider_affiliation_fact_src.AFFIL_RANK = ''::varchar) THEN NULL::int ELSE (btrim(ext_hcos_provider_affiliation_fact_src.AFFIL_RANK))::int END AS AFFIL_RANK,
        ext_hcos_provider_affiliation_fact_src.batch_id,
        ext_hcos_provider_affiliation_fact_src.row_id,
        ext_hcos_provider_affiliation_fact_src.update_ts
 FROM teva_ingestion.ext_hcos_provider_affiliation_fact_src
 WHERE (ext_hcos_provider_affiliation_fact_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_PROVIDER_AFFILIATION_FACT'::varchar(34))));

CREATE  VIEW teva_ingestion.ext_hcos_relationship_fact AS
 SELECT btrim(EXT_HCOS_RELATIONSHIP_FACT_src.IMS_ORG_ID_PARENT) AS IMS_ORG_ID_PARENT,
        btrim(EXT_HCOS_RELATIONSHIP_FACT_src.IMS_ORG_ID_CHILD) AS IMS_ORG_ID_CHILD,
        CASE WHEN (EXT_HCOS_RELATIONSHIP_FACT_src.REL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_RELATIONSHIP_FACT_src.REL_ID))::numeric(37,15) END AS REL_ID,
        CASE WHEN (EXT_HCOS_RELATIONSHIP_FACT_src.REL_ORDER = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_RELATIONSHIP_FACT_src.REL_ORDER))::numeric(37,15) END AS REL_ORDER,
        EXT_HCOS_RELATIONSHIP_FACT_src.batch_id,
        EXT_HCOS_RELATIONSHIP_FACT_src.row_id,
        EXT_HCOS_RELATIONSHIP_FACT_src.update_ts
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_FACT_src
 WHERE (EXT_HCOS_RELATIONSHIP_FACT_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_RELATIONSHIP_FACT'::varchar(26))));

CREATE  VIEW teva_ingestion.ext_hcos_relationship_type AS
 SELECT CASE WHEN (EXT_HCOS_RELATIONSHIP_TYPE_src.REL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_ID))::numeric(37,15) END AS REL_ID,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CODE) AS REL_CODE,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_DESC) AS REL_DESC,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_GROUP_CODE) AS REL_GROUP_CODE,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_GROUP_DESC) AS REL_GROUP_DESC,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CATEGORY_CODE) AS REL_CATEGORY_CODE,
        btrim(EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CATEGORY_DESC) AS REL_CATEGORY_DESC,
        EXT_HCOS_RELATIONSHIP_TYPE_src.batch_id,
        EXT_HCOS_RELATIONSHIP_TYPE_src.row_id,
        EXT_HCOS_RELATIONSHIP_TYPE_src.update_ts
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_TYPE_src
 WHERE (EXT_HCOS_RELATIONSHIP_TYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_HCOS_RELATIONSHIP_TYPE'::varchar(26))));

CREATE  VIEW teva_ingestion.EXT_I3_RX AS
 SELECT btrim(EXT_I3_RX_src.FULL_NAME) AS FULL_NAME,
        btrim(EXT_I3_RX_src.SPECIALTY) AS SPECIALTY,
        CASE WHEN (EXT_I3_RX_src.RANK = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.RANK))::numeric(37,15) END AS RANK,
        CASE WHEN (EXT_I3_RX_src.TOTAL = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.TOTAL))::numeric(37,15) END AS TOTAL,
        CASE WHEN (EXT_I3_RX_src.AUBAGIO = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.AUBAGIO))::numeric(37,15) END AS AUBAGIO,
        CASE WHEN (EXT_I3_RX_src.AVONEX = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.AVONEX))::numeric(37,15) END AS AVONEX,
        CASE WHEN (EXT_I3_RX_src.BETASERON = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.BETASERON))::numeric(37,15) END AS BETASERON,
        CASE WHEN (EXT_I3_RX_src.COPAXONE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.COPAXONE))::numeric(37,15) END AS COPAXONE,
        CASE WHEN (EXT_I3_RX_src.EXTAVIA = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.EXTAVIA))::numeric(37,15) END AS EXTAVIA,
        CASE WHEN (EXT_I3_RX_src.GILENYA = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.GILENYA))::numeric(37,15) END AS GILENYA,
        CASE WHEN (EXT_I3_RX_src.REBIF = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.REBIF))::numeric(37,15) END AS REBIF,
        CASE WHEN (EXT_I3_RX_src.TECFIDERA = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.TECFIDERA))::numeric(37,15) END AS TECFIDERA,
        btrim(EXT_I3_RX_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_I3_RX_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_I3_RX_src.MD_CITY) AS MD_CITY,
        btrim(EXT_I3_RX_src.MD_STATE) AS MD_STATE,
        btrim(EXT_I3_RX_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_I3_RX_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        CASE WHEN (EXT_I3_RX_src.DNC_FLAG = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_I3_RX_src.DNC_FLAG))::numeric(37,15) END AS DNC_FLAG,
        EXT_I3_RX_src.batch_id,
        EXT_I3_RX_src.row_id,
        EXT_I3_RX_src.update_ts
 FROM teva_ingestion.EXT_I3_RX_src
 WHERE (EXT_I3_RX_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_I3_RX'::varchar(9))));

CREATE  VIEW teva_ingestion.EXT_I3_TYSABRI_RX AS
 SELECT btrim(EXT_I3_TYSABRI_RX_src.FULL_NAME) AS FULL_NAME,
        btrim(EXT_I3_TYSABRI_RX_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_I3_TYSABRI_RX_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_I3_TYSABRI_RX_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_I3_TYSABRI_RX_src.MD_CITY) AS MD_CITY,
        btrim(EXT_I3_TYSABRI_RX_src.MD_STATE) AS MD_STATE,
        btrim(EXT_I3_TYSABRI_RX_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_I3_TYSABRI_RX_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.DNC_FLAG = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.DNC_FLAG))::int END AS DNC_FLAG,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_12))::int END AS RX_12,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_11))::int END AS RX_11,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_10))::int END AS RX_10,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_09))::int END AS RX_09,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_08))::int END AS RX_08,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_07))::int END AS RX_07,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_06))::int END AS RX_06,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_05))::int END AS RX_05,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_04))::int END AS RX_04,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_03))::int END AS RX_03,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_02))::int END AS RX_02,
        CASE WHEN (EXT_I3_TYSABRI_RX_src.RX_01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_TYSABRI_RX_src.RX_01))::int END AS RX_01,
        EXT_I3_TYSABRI_RX_src.batch_id,
        EXT_I3_TYSABRI_RX_src.row_id,
        EXT_I3_TYSABRI_RX_src.update_ts
 FROM teva_ingestion.EXT_I3_TYSABRI_RX_src
 WHERE (EXT_I3_TYSABRI_RX_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_I3_TYSABRI_RX'::varchar(17))));

CREATE  VIEW teva_ingestion.EXT_IDS_CALL2_DETAIL_VOD__C AS
 SELECT btrim(EXT_IDS_CALL2_DETAIL_VOD__C_src.ID) AS ID,
        EXT_IDS_CALL2_DETAIL_VOD__C_src.batch_id,
        EXT_IDS_CALL2_DETAIL_VOD__C_src.row_id,
        EXT_IDS_CALL2_DETAIL_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_IDS_CALL2_DETAIL_VOD__C_src
 WHERE (EXT_IDS_CALL2_DETAIL_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IDS_CALL2_DETAIL_VOD__C'::varchar(27))));

CREATE  VIEW teva_ingestion.EXT_IDS_CALL2_VOD__C AS
 SELECT btrim(EXT_IDS_CALL2_VOD__C_src.ID) AS ID,
        EXT_IDS_CALL2_VOD__C_src.batch_id,
        EXT_IDS_CALL2_VOD__C_src.row_id,
        EXT_IDS_CALL2_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_IDS_CALL2_VOD__C_src
 WHERE (EXT_IDS_CALL2_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IDS_CALL2_VOD__C'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_IMS_DDD_CHANGE_LOG AS
SELECT btrim(EXT_IMS_DDD_CHANGE_LOG_src.CONSTANT) AS CONSTANT, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CLI_SFX) AS CLI_SFX, btrim(EXT_IMS_DDD_CHANGE_LOG_src.NOT_USED) AS NOT_USED, btrim(EXT_IMS_DDD_CHANGE_LOG_src."TERR#") AS "TERR#", btrim(EXT_IMS_DDD_CHANGE_LOG_src."OUTLET#") AS "OUTLET#", btrim(EXT_IMS_DDD_CHANGE_LOG_src.OUTLET_NAME) AS OUTLET_NAME, btrim(EXT_IMS_DDD_CHANGE_LOG_src.ADDRESS) AS ADDRESS, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CITY) AS CITY, btrim(EXT_IMS_DDD_CHANGE_LOG_src.STATE) AS STATE, btrim(EXT_IMS_DDD_CHANGE_LOG_src.SUBCAT) AS SUBCAT, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CODE) AS CODE, EXT_IMS_DDD_CHANGE_LOG_src.batch_id, EXT_IMS_DDD_CHANGE_LOG_src.row_id, EXT_IMS_DDD_CHANGE_LOG_src.update_ts FROM teva_ingestion.EXT_IMS_DDD_CHANGE_LOG_src WHERE (EXT_IMS_DDD_CHANGE_LOG_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_DDD_CHANGE_LOG'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_IMS_DRM45_M AS
 SELECT btrim(EXT_IMS_DRM45_M_src.FILE_CODE) AS FILE_CODE,
        btrim(EXT_IMS_DRM45_M_src.PRODUCT_GROUP) AS PRODUCT_GROUP,
        btrim(EXT_IMS_DRM45_M_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_IMS_DRM45_M_src.MFG_NUM) AS MFG_NUM,
        btrim(EXT_IMS_DRM45_M_src.STATUS) AS STATUS,
        btrim(EXT_IMS_DRM45_M_src.CMF) AS CMF,
        btrim(EXT_IMS_DRM45_M_src.PRODUCT_DESCRIPTION) AS PRODUCT_DESCRIPTION,
        btrim(EXT_IMS_DRM45_M_src.MFG_NAME) AS MFG_NAME,
        btrim(EXT_IMS_DRM45_M_src.USC) AS USC,
        EXT_IMS_DRM45_M_src.batch_id,
        EXT_IMS_DRM45_M_src.row_id,
        EXT_IMS_DRM45_M_src.update_ts
 FROM teva_ingestion.EXT_IMS_DRM45_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_DRM45_W AS
 SELECT btrim(EXT_IMS_DRM45_W_src.FILE_CODE) AS FILE_CODE,
        btrim(EXT_IMS_DRM45_W_src.PRODUCT_GROUP) AS PRODUCT_GROUP,
        btrim(EXT_IMS_DRM45_W_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_IMS_DRM45_W_src.MFG_NUM) AS MFG_NUM,
        btrim(EXT_IMS_DRM45_W_src.STATUS) AS STATUS,
        btrim(EXT_IMS_DRM45_W_src.CMF) AS CMF,
        btrim(EXT_IMS_DRM45_W_src.PRODUCT_DESCRIPTION) AS PRODUCT_DESCRIPTION,
        btrim(EXT_IMS_DRM45_W_src.MFG_NAME) AS MFG_NAME,
        btrim(EXT_IMS_DRM45_W_src.USC) AS USC,
        EXT_IMS_DRM45_W_src.batch_id,
        EXT_IMS_DRM45_W_src.row_id,
        EXT_IMS_DRM45_W_src.update_ts
 FROM teva_ingestion.EXT_IMS_DRM45_W_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CNT_M AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CNT_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_CNT_M_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_CNT_M_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_CNT_M_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_CNT_M_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_CNT_M_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_CNT_M_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_CNT_M_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_CNT_M_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_CNT_M_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_CNT_M_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_CNT_M_src.address) AS address,
        btrim(EXT_IMS_MHJ_CNT_M_src.city) AS city,
        btrim(EXT_IMS_MHJ_CNT_M_src.state) AS state,
        btrim(EXT_IMS_MHJ_CNT_M_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_CNT_M_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_CNT_M_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_CNT_M_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_M_src.trx_024))::numeric(9,3) END AS trx_024,
        EXT_IMS_MHJ_CNT_M_src.batch_id,
        EXT_IMS_MHJ_CNT_M_src.row_id,
        EXT_IMS_MHJ_CNT_M_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CNT_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CNT_W AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CNT_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_CNT_W_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_CNT_W_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_CNT_W_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_CNT_W_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_CNT_W_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_CNT_W_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_CNT_W_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_CNT_W_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_CNT_W_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_CNT_W_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_CNT_W_src.address) AS address,
        btrim(EXT_IMS_MHJ_CNT_W_src.city) AS city,
        btrim(EXT_IMS_MHJ_CNT_W_src.state) AS state,
        btrim(EXT_IMS_MHJ_CNT_W_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_CNT_W_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_CNT_W_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_CNT_W_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_025))::numeric(9,3) END AS nrx_025,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_026))::numeric(9,3) END AS nrx_026,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_027))::numeric(9,3) END AS nrx_027,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_028))::numeric(9,3) END AS nrx_028,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_029))::numeric(9,3) END AS nrx_029,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_030))::numeric(9,3) END AS nrx_030,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_031))::numeric(9,3) END AS nrx_031,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_032))::numeric(9,3) END AS nrx_032,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_033))::numeric(9,3) END AS nrx_033,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_034))::numeric(9,3) END AS nrx_034,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_035))::numeric(9,3) END AS nrx_035,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_036))::numeric(9,3) END AS nrx_036,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_037))::numeric(9,3) END AS nrx_037,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_038))::numeric(9,3) END AS nrx_038,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_039))::numeric(9,3) END AS nrx_039,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_040))::numeric(9,3) END AS nrx_040,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_041))::numeric(9,3) END AS nrx_041,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_042))::numeric(9,3) END AS nrx_042,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_043))::numeric(9,3) END AS nrx_043,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_044))::numeric(9,3) END AS nrx_044,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_045))::numeric(9,3) END AS nrx_045,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_046))::numeric(9,3) END AS nrx_046,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_047))::numeric(9,3) END AS nrx_047,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_048))::numeric(9,3) END AS nrx_048,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_049))::numeric(9,3) END AS nrx_049,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_050))::numeric(9,3) END AS nrx_050,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_051))::numeric(9,3) END AS nrx_051,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_052))::numeric(9,3) END AS nrx_052,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_053))::numeric(9,3) END AS nrx_053,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_054))::numeric(9,3) END AS nrx_054,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_055))::numeric(9,3) END AS nrx_055,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_056))::numeric(9,3) END AS nrx_056,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_057))::numeric(9,3) END AS nrx_057,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_058))::numeric(9,3) END AS nrx_058,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_059))::numeric(9,3) END AS nrx_059,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_060))::numeric(9,3) END AS nrx_060,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_061))::numeric(9,3) END AS nrx_061,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_062))::numeric(9,3) END AS nrx_062,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_063))::numeric(9,3) END AS nrx_063,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_064))::numeric(9,3) END AS nrx_064,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_065))::numeric(9,3) END AS nrx_065,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_066))::numeric(9,3) END AS nrx_066,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_067))::numeric(9,3) END AS nrx_067,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_068))::numeric(9,3) END AS nrx_068,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_069))::numeric(9,3) END AS nrx_069,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_070))::numeric(9,3) END AS nrx_070,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_071))::numeric(9,3) END AS nrx_071,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_072))::numeric(9,3) END AS nrx_072,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_073))::numeric(9,3) END AS nrx_073,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_074))::numeric(9,3) END AS nrx_074,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_075))::numeric(9,3) END AS nrx_075,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_076))::numeric(9,3) END AS nrx_076,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_077))::numeric(9,3) END AS nrx_077,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_078))::numeric(9,3) END AS nrx_078,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_079))::numeric(9,3) END AS nrx_079,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_080))::numeric(9,3) END AS nrx_080,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_081))::numeric(9,3) END AS nrx_081,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_082))::numeric(9,3) END AS nrx_082,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_083))::numeric(9,3) END AS nrx_083,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_084))::numeric(9,3) END AS nrx_084,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_085))::numeric(9,3) END AS nrx_085,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_086))::numeric(9,3) END AS nrx_086,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_087))::numeric(9,3) END AS nrx_087,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_088))::numeric(9,3) END AS nrx_088,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_089))::numeric(9,3) END AS nrx_089,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_090))::numeric(9,3) END AS nrx_090,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_091))::numeric(9,3) END AS nrx_091,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_092))::numeric(9,3) END AS nrx_092,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_093))::numeric(9,3) END AS nrx_093,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_094))::numeric(9,3) END AS nrx_094,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_095))::numeric(9,3) END AS nrx_095,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_096))::numeric(9,3) END AS nrx_096,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_097))::numeric(9,3) END AS nrx_097,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_098))::numeric(9,3) END AS nrx_098,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_099))::numeric(9,3) END AS nrx_099,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_100))::numeric(9,3) END AS nrx_100,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_101))::numeric(9,3) END AS nrx_101,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_102))::numeric(9,3) END AS nrx_102,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_103))::numeric(9,3) END AS nrx_103,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_104))::numeric(9,3) END AS nrx_104,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_105))::numeric(9,3) END AS nrx_105,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_106))::numeric(9,3) END AS nrx_106,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_107))::numeric(9,3) END AS nrx_107,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_108))::numeric(9,3) END AS nrx_108,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_109))::numeric(9,3) END AS nrx_109,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_110))::numeric(9,3) END AS nrx_110,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_111))::numeric(9,3) END AS nrx_111,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_112))::numeric(9,3) END AS nrx_112,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_113))::numeric(9,3) END AS nrx_113,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_114))::numeric(9,3) END AS nrx_114,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_115))::numeric(9,3) END AS nrx_115,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_116))::numeric(9,3) END AS nrx_116,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_117))::numeric(9,3) END AS nrx_117,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_118))::numeric(9,3) END AS nrx_118,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_119))::numeric(9,3) END AS nrx_119,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_120))::numeric(9,3) END AS nrx_120,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_121))::numeric(9,3) END AS nrx_121,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_122))::numeric(9,3) END AS nrx_122,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_123))::numeric(9,3) END AS nrx_123,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_124))::numeric(9,3) END AS nrx_124,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_125))::numeric(9,3) END AS nrx_125,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_126))::numeric(9,3) END AS nrx_126,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_127))::numeric(9,3) END AS nrx_127,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_128))::numeric(9,3) END AS nrx_128,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_129))::numeric(9,3) END AS nrx_129,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_130))::numeric(9,3) END AS nrx_130,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_131))::numeric(9,3) END AS nrx_131,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.nrx_132))::numeric(9,3) END AS nrx_132,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_024))::numeric(9,3) END AS trx_024,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_025))::numeric(9,3) END AS trx_025,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_026))::numeric(9,3) END AS trx_026,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_027))::numeric(9,3) END AS trx_027,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_028))::numeric(9,3) END AS trx_028,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_029))::numeric(9,3) END AS trx_029,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_030))::numeric(9,3) END AS trx_030,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_031))::numeric(9,3) END AS trx_031,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_032))::numeric(9,3) END AS trx_032,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_033))::numeric(9,3) END AS trx_033,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_034))::numeric(9,3) END AS trx_034,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_035))::numeric(9,3) END AS trx_035,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_036))::numeric(9,3) END AS trx_036,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_037))::numeric(9,3) END AS trx_037,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_038))::numeric(9,3) END AS trx_038,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_039))::numeric(9,3) END AS trx_039,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_040))::numeric(9,3) END AS trx_040,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_041))::numeric(9,3) END AS trx_041,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_042))::numeric(9,3) END AS trx_042,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_043))::numeric(9,3) END AS trx_043,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_044))::numeric(9,3) END AS trx_044,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_045))::numeric(9,3) END AS trx_045,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_046))::numeric(9,3) END AS trx_046,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_047))::numeric(9,3) END AS trx_047,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_048))::numeric(9,3) END AS trx_048,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_049))::numeric(9,3) END AS trx_049,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_050))::numeric(9,3) END AS trx_050,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_051))::numeric(9,3) END AS trx_051,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_052))::numeric(9,3) END AS trx_052,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_053))::numeric(9,3) END AS trx_053,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_054))::numeric(9,3) END AS trx_054,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_055))::numeric(9,3) END AS trx_055,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_056))::numeric(9,3) END AS trx_056,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_057))::numeric(9,3) END AS trx_057,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_058))::numeric(9,3) END AS trx_058,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_059))::numeric(9,3) END AS trx_059,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_060))::numeric(9,3) END AS trx_060,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_061))::numeric(9,3) END AS trx_061,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_062))::numeric(9,3) END AS trx_062,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_063))::numeric(9,3) END AS trx_063,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_064))::numeric(9,3) END AS trx_064,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_065))::numeric(9,3) END AS trx_065,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_066))::numeric(9,3) END AS trx_066,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_067))::numeric(9,3) END AS trx_067,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_068))::numeric(9,3) END AS trx_068,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_069))::numeric(9,3) END AS trx_069,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_070))::numeric(9,3) END AS trx_070,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_071))::numeric(9,3) END AS trx_071,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_072))::numeric(9,3) END AS trx_072,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_073))::numeric(9,3) END AS trx_073,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_074))::numeric(9,3) END AS trx_074,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_075))::numeric(9,3) END AS trx_075,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_076))::numeric(9,3) END AS trx_076,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_077))::numeric(9,3) END AS trx_077,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_078))::numeric(9,3) END AS trx_078,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_079))::numeric(9,3) END AS trx_079,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_080))::numeric(9,3) END AS trx_080,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_081))::numeric(9,3) END AS trx_081,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_082))::numeric(9,3) END AS trx_082,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_083))::numeric(9,3) END AS trx_083,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_084))::numeric(9,3) END AS trx_084,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_085))::numeric(9,3) END AS trx_085,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_086))::numeric(9,3) END AS trx_086,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_087))::numeric(9,3) END AS trx_087,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_088))::numeric(9,3) END AS trx_088,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_089))::numeric(9,3) END AS trx_089,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_090))::numeric(9,3) END AS trx_090,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_091))::numeric(9,3) END AS trx_091,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_092))::numeric(9,3) END AS trx_092,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_093))::numeric(9,3) END AS trx_093,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_094))::numeric(9,3) END AS trx_094,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_095))::numeric(9,3) END AS trx_095,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_096))::numeric(9,3) END AS trx_096,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_097))::numeric(9,3) END AS trx_097,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_098))::numeric(9,3) END AS trx_098,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_099))::numeric(9,3) END AS trx_099,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_100))::numeric(9,3) END AS trx_100,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_101))::numeric(9,3) END AS trx_101,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_102))::numeric(9,3) END AS trx_102,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_103))::numeric(9,3) END AS trx_103,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_104))::numeric(9,3) END AS trx_104,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_105))::numeric(9,3) END AS trx_105,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_106))::numeric(9,3) END AS trx_106,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_107))::numeric(9,3) END AS trx_107,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_108))::numeric(9,3) END AS trx_108,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_109))::numeric(9,3) END AS trx_109,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_110))::numeric(9,3) END AS trx_110,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_111))::numeric(9,3) END AS trx_111,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_112))::numeric(9,3) END AS trx_112,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_113))::numeric(9,3) END AS trx_113,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_114))::numeric(9,3) END AS trx_114,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_115))::numeric(9,3) END AS trx_115,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_116))::numeric(9,3) END AS trx_116,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_117))::numeric(9,3) END AS trx_117,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_118))::numeric(9,3) END AS trx_118,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_119))::numeric(9,3) END AS trx_119,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_120))::numeric(9,3) END AS trx_120,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_121))::numeric(9,3) END AS trx_121,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_122))::numeric(9,3) END AS trx_122,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_123))::numeric(9,3) END AS trx_123,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_124))::numeric(9,3) END AS trx_124,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_125))::numeric(9,3) END AS trx_125,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_126))::numeric(9,3) END AS trx_126,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_127))::numeric(9,3) END AS trx_127,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_128))::numeric(9,3) END AS trx_128,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_129))::numeric(9,3) END AS trx_129,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_130))::numeric(9,3) END AS trx_130,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_131))::numeric(9,3) END AS trx_131,
        CASE WHEN (EXT_IMS_MHJ_CNT_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_CNT_W_src.trx_132))::numeric(9,3) END AS trx_132,
        EXT_IMS_MHJ_CNT_W_src.batch_id,
        EXT_IMS_MHJ_CNT_W_src.row_id,
        EXT_IMS_MHJ_CNT_W_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CNT_W_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CONTROL_M AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.IMS_CLIENT_NUM = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.IMS_CLIENT_NUM))::numeric(3,0) END AS IMS_CLIENT_NUM,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.IMS_REPORT_NUM = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.IMS_REPORT_NUM))::numeric(3,0) END AS IMS_REPORT_NUM,
        btrim(EXT_IMS_MHJ_CONTROL_M_src.SRA) AS SRA,
        btrim(EXT_IMS_MHJ_CONTROL_M_src.SALES_CATEGORY) AS SALES_CATEGORY,
        btrim(EXT_IMS_MHJ_CONTROL_M_src.IMS_PRODUCT_GROUP_NUM) AS IMS_PRODUCT_GROUP_NUM,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX001 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX001))::numeric(37,15) END AS NRX001,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX002 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX002))::numeric(37,15) END AS NRX002,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX003 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX003))::numeric(37,15) END AS NRX003,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX004 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX004))::numeric(37,15) END AS NRX004,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX005 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX005))::numeric(37,15) END AS NRX005,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX006 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX006))::numeric(37,15) END AS NRX006,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX007 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX007))::numeric(37,15) END AS NRX007,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX008 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX008))::numeric(37,15) END AS NRX008,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX009 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX009))::numeric(37,15) END AS NRX009,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX010 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX010))::numeric(37,15) END AS NRX010,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX011 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX011))::numeric(37,15) END AS NRX011,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX012 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX012))::numeric(37,15) END AS NRX012,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX013 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX013))::numeric(37,15) END AS NRX013,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX014 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX014))::numeric(37,15) END AS NRX014,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX015 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX015))::numeric(37,15) END AS NRX015,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX016 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX016))::numeric(37,15) END AS NRX016,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX017 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX017))::numeric(37,15) END AS NRX017,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX018 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX018))::numeric(37,15) END AS NRX018,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX019 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX019))::numeric(37,15) END AS NRX019,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX020 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX020))::numeric(37,15) END AS NRX020,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX021 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX021))::numeric(37,15) END AS NRX021,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX022 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX022))::numeric(37,15) END AS NRX022,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX023 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX023))::numeric(37,15) END AS NRX023,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.NRX024 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.NRX024))::numeric(37,15) END AS NRX024,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX001 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX001))::numeric(37,15) END AS TRX001,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX002 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX002))::numeric(37,15) END AS TRX002,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX003 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX003))::numeric(37,15) END AS TRX003,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX004 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX004))::numeric(37,15) END AS TRX004,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX005 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX005))::numeric(37,15) END AS TRX005,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX006 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX006))::numeric(37,15) END AS TRX006,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX007 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX007))::numeric(37,15) END AS TRX007,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX008 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX008))::numeric(37,15) END AS TRX008,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX009 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX009))::numeric(37,15) END AS TRX009,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX010 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX010))::numeric(37,15) END AS TRX010,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX011 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX011))::numeric(37,15) END AS TRX011,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX012 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX012))::numeric(37,15) END AS TRX012,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX013 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX013))::numeric(37,15) END AS TRX013,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX014 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX014))::numeric(37,15) END AS TRX014,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX015 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX015))::numeric(37,15) END AS TRX015,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX016 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX016))::numeric(37,15) END AS TRX016,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX017 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX017))::numeric(37,15) END AS TRX017,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX018 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX018))::numeric(37,15) END AS TRX018,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX019 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX019))::numeric(37,15) END AS TRX019,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX020 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX020))::numeric(37,15) END AS TRX020,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX021 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX021))::numeric(37,15) END AS TRX021,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX022 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX022))::numeric(37,15) END AS TRX022,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX023 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX023))::numeric(37,15) END AS TRX023,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_M_src.TRX024 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_M_src.TRX024))::numeric(37,15) END AS TRX024,
        EXT_IMS_MHJ_CONTROL_M_src.batch_id,
        EXT_IMS_MHJ_CONTROL_M_src.row_id,
        EXT_IMS_MHJ_CONTROL_M_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CONTROL_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_CONTROL_W AS
 SELECT CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.IMS_CLIENT_NUM = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.IMS_CLIENT_NUM))::numeric(3,0) END AS IMS_CLIENT_NUM,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.IMS_REPORT_NUM = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.IMS_REPORT_NUM))::numeric(3,0) END AS IMS_REPORT_NUM,
        btrim(EXT_IMS_MHJ_CONTROL_W_src.SRA) AS SRA,
        btrim(EXT_IMS_MHJ_CONTROL_W_src.SALES_CATEGORY) AS SALES_CATEGORY,
        btrim(EXT_IMS_MHJ_CONTROL_W_src.IMS_PRODUCT_GROUP_NUM) AS IMS_PRODUCT_GROUP_NUM,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX001 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX001))::numeric(37,15) END AS NRX001,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX002 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX002))::numeric(37,15) END AS NRX002,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX003 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX003))::numeric(37,15) END AS NRX003,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX004 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX004))::numeric(37,15) END AS NRX004,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX005 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX005))::numeric(37,15) END AS NRX005,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX006 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX006))::numeric(37,15) END AS NRX006,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX007 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX007))::numeric(37,15) END AS NRX007,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX008 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX008))::numeric(37,15) END AS NRX008,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX009 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX009))::numeric(37,15) END AS NRX009,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX010 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX010))::numeric(37,15) END AS NRX010,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX011 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX011))::numeric(37,15) END AS NRX011,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX012 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX012))::numeric(37,15) END AS NRX012,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX013 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX013))::numeric(37,15) END AS NRX013,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX014 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX014))::numeric(37,15) END AS NRX014,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX015 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX015))::numeric(37,15) END AS NRX015,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX016 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX016))::numeric(37,15) END AS NRX016,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX017 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX017))::numeric(37,15) END AS NRX017,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX018 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX018))::numeric(37,15) END AS NRX018,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX019 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX019))::numeric(37,15) END AS NRX019,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX020 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX020))::numeric(37,15) END AS NRX020,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX021 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX021))::numeric(37,15) END AS NRX021,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX022 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX022))::numeric(37,15) END AS NRX022,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX023 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX023))::numeric(37,15) END AS NRX023,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX024 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX024))::numeric(37,15) END AS NRX024,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX025 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX025))::numeric(37,15) END AS NRX025,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX026 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX026))::numeric(37,15) END AS NRX026,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX027 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX027))::numeric(37,15) END AS NRX027,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX028 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX028))::numeric(37,15) END AS NRX028,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX029 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX029))::numeric(37,15) END AS NRX029,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX030 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX030))::numeric(37,15) END AS NRX030,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX031 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX031))::numeric(37,15) END AS NRX031,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX032 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX032))::numeric(37,15) END AS NRX032,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX033 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX033))::numeric(37,15) END AS NRX033,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX034 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX034))::numeric(37,15) END AS NRX034,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX035 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX035))::numeric(37,15) END AS NRX035,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX036 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX036))::numeric(37,15) END AS NRX036,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX037 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX037))::numeric(37,15) END AS NRX037,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX038 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX038))::numeric(37,15) END AS NRX038,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX039 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX039))::numeric(37,15) END AS NRX039,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX040 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX040))::numeric(37,15) END AS NRX040,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX041 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX041))::numeric(37,15) END AS NRX041,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX042 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX042))::numeric(37,15) END AS NRX042,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX043 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX043))::numeric(37,15) END AS NRX043,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX044 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX044))::numeric(37,15) END AS NRX044,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX045 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX045))::numeric(37,15) END AS NRX045,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX046 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX046))::numeric(37,15) END AS NRX046,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX047 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX047))::numeric(37,15) END AS NRX047,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX048 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX048))::numeric(37,15) END AS NRX048,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX049 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX049))::numeric(37,15) END AS NRX049,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX050 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX050))::numeric(37,15) END AS NRX050,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX051 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX051))::numeric(37,15) END AS NRX051,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX052 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX052))::numeric(37,15) END AS NRX052,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX053 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX053))::numeric(37,15) END AS NRX053,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX054 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX054))::numeric(37,15) END AS NRX054,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX055 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX055))::numeric(37,15) END AS NRX055,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX056 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX056))::numeric(37,15) END AS NRX056,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX057 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX057))::numeric(37,15) END AS NRX057,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX058 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX058))::numeric(37,15) END AS NRX058,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX059 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX059))::numeric(37,15) END AS NRX059,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX060 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX060))::numeric(37,15) END AS NRX060,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX061 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX061))::numeric(37,15) END AS NRX061,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX062 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX062))::numeric(37,15) END AS NRX062,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX063 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX063))::numeric(37,15) END AS NRX063,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX064 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX064))::numeric(37,15) END AS NRX064,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX065 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX065))::numeric(37,15) END AS NRX065,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX066 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX066))::numeric(37,15) END AS NRX066,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX067 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX067))::numeric(37,15) END AS NRX067,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX068 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX068))::numeric(37,15) END AS NRX068,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX069 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX069))::numeric(37,15) END AS NRX069,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX070 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX070))::numeric(37,15) END AS NRX070,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX071 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX071))::numeric(37,15) END AS NRX071,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX072 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX072))::numeric(37,15) END AS NRX072,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX073 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX073))::numeric(37,15) END AS NRX073,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX074 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX074))::numeric(37,15) END AS NRX074,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX075 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX075))::numeric(37,15) END AS NRX075,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX076 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX076))::numeric(37,15) END AS NRX076,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX077 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX077))::numeric(37,15) END AS NRX077,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX078 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX078))::numeric(37,15) END AS NRX078,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX079 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX079))::numeric(37,15) END AS NRX079,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX080 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX080))::numeric(37,15) END AS NRX080,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX081 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX081))::numeric(37,15) END AS NRX081,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX082 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX082))::numeric(37,15) END AS NRX082,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX083 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX083))::numeric(37,15) END AS NRX083,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX084 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX084))::numeric(37,15) END AS NRX084,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX085 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX085))::numeric(37,15) END AS NRX085,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX086 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX086))::numeric(37,15) END AS NRX086,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX087 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX087))::numeric(37,15) END AS NRX087,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX088 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX088))::numeric(37,15) END AS NRX088,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX089 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX089))::numeric(37,15) END AS NRX089,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX090 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX090))::numeric(37,15) END AS NRX090,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX091 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX091))::numeric(37,15) END AS NRX091,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX092 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX092))::numeric(37,15) END AS NRX092,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX093 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX093))::numeric(37,15) END AS NRX093,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX094 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX094))::numeric(37,15) END AS NRX094,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX095 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX095))::numeric(37,15) END AS NRX095,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX096 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX096))::numeric(37,15) END AS NRX096,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX097 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX097))::numeric(37,15) END AS NRX097,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX098 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX098))::numeric(37,15) END AS NRX098,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX099 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX099))::numeric(37,15) END AS NRX099,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX100 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX100))::numeric(37,15) END AS NRX100,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX101 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX101))::numeric(37,15) END AS NRX101,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX102 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX102))::numeric(37,15) END AS NRX102,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX103 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX103))::numeric(37,15) END AS NRX103,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX104 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX104))::numeric(37,15) END AS NRX104,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX105 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX105))::numeric(37,15) END AS NRX105,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX106 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX106))::numeric(37,15) END AS NRX106,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX107 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX107))::numeric(37,15) END AS NRX107,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX108 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX108))::numeric(37,15) END AS NRX108,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX109 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX109))::numeric(37,15) END AS NRX109,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX110 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX110))::numeric(37,15) END AS NRX110,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX111 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX111))::numeric(37,15) END AS NRX111,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX112 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX112))::numeric(37,15) END AS NRX112,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX113 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX113))::numeric(37,15) END AS NRX113,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX114 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX114))::numeric(37,15) END AS NRX114,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX115 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX115))::numeric(37,15) END AS NRX115,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX116 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX116))::numeric(37,15) END AS NRX116,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX117 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX117))::numeric(37,15) END AS NRX117,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX118 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX118))::numeric(37,15) END AS NRX118,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX119 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX119))::numeric(37,15) END AS NRX119,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX120 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX120))::numeric(37,15) END AS NRX120,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX121 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX121))::numeric(37,15) END AS NRX121,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX122 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX122))::numeric(37,15) END AS NRX122,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX123 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX123))::numeric(37,15) END AS NRX123,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX124 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX124))::numeric(37,15) END AS NRX124,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX125 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX125))::numeric(37,15) END AS NRX125,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX126 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX126))::numeric(37,15) END AS NRX126,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX127 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX127))::numeric(37,15) END AS NRX127,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX128 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX128))::numeric(37,15) END AS NRX128,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX129 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX129))::numeric(37,15) END AS NRX129,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX130 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX130))::numeric(37,15) END AS NRX130,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX131 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX131))::numeric(37,15) END AS NRX131,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.NRX132 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.NRX132))::numeric(37,15) END AS NRX132,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX001 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX001))::numeric(37,15) END AS TRX001,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX002 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX002))::numeric(37,15) END AS TRX002,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX003 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX003))::numeric(37,15) END AS TRX003,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX004 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX004))::numeric(37,15) END AS TRX004,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX005 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX005))::numeric(37,15) END AS TRX005,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX006 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX006))::numeric(37,15) END AS TRX006,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX007 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX007))::numeric(37,15) END AS TRX007,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX008 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX008))::numeric(37,15) END AS TRX008,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX009 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX009))::numeric(37,15) END AS TRX009,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX010 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX010))::numeric(37,15) END AS TRX010,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX011 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX011))::numeric(37,15) END AS TRX011,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX012 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX012))::numeric(37,15) END AS TRX012,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX013 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX013))::numeric(37,15) END AS TRX013,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX014 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX014))::numeric(37,15) END AS TRX014,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX015 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX015))::numeric(37,15) END AS TRX015,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX016 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX016))::numeric(37,15) END AS TRX016,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX017 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX017))::numeric(37,15) END AS TRX017,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX018 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX018))::numeric(37,15) END AS TRX018,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX019 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX019))::numeric(37,15) END AS TRX019,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX020 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX020))::numeric(37,15) END AS TRX020,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX021 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX021))::numeric(37,15) END AS TRX021,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX022 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX022))::numeric(37,15) END AS TRX022,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX023 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX023))::numeric(37,15) END AS TRX023,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX024 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX024))::numeric(37,15) END AS TRX024,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX025 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX025))::numeric(37,15) END AS TRX025,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX026 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX026))::numeric(37,15) END AS TRX026,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX027 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX027))::numeric(37,15) END AS TRX027,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX028 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX028))::numeric(37,15) END AS TRX028,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX029 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX029))::numeric(37,15) END AS TRX029,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX030 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX030))::numeric(37,15) END AS TRX030,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX031 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX031))::numeric(37,15) END AS TRX031,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX032 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX032))::numeric(37,15) END AS TRX032,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX033 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX033))::numeric(37,15) END AS TRX033,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX034 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX034))::numeric(37,15) END AS TRX034,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX035 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX035))::numeric(37,15) END AS TRX035,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX036 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX036))::numeric(37,15) END AS TRX036,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX037 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX037))::numeric(37,15) END AS TRX037,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX038 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX038))::numeric(37,15) END AS TRX038,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX039 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX039))::numeric(37,15) END AS TRX039,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX040 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX040))::numeric(37,15) END AS TRX040,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX041 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX041))::numeric(37,15) END AS TRX041,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX042 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX042))::numeric(37,15) END AS TRX042,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX043 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX043))::numeric(37,15) END AS TRX043,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX044 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX044))::numeric(37,15) END AS TRX044,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX045 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX045))::numeric(37,15) END AS TRX045,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX046 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX046))::numeric(37,15) END AS TRX046,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX047 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX047))::numeric(37,15) END AS TRX047,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX048 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX048))::numeric(37,15) END AS TRX048,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX049 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX049))::numeric(37,15) END AS TRX049,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX050 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX050))::numeric(37,15) END AS TRX050,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX051 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX051))::numeric(37,15) END AS TRX051,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX052 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX052))::numeric(37,15) END AS TRX052,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX053 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX053))::numeric(37,15) END AS TRX053,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX054 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX054))::numeric(37,15) END AS TRX054,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX055 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX055))::numeric(37,15) END AS TRX055,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX056 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX056))::numeric(37,15) END AS TRX056,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX057 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX057))::numeric(37,15) END AS TRX057,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX058 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX058))::numeric(37,15) END AS TRX058,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX059 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX059))::numeric(37,15) END AS TRX059,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX060 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX060))::numeric(37,15) END AS TRX060,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX061 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX061))::numeric(37,15) END AS TRX061,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX062 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX062))::numeric(37,15) END AS TRX062,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX063 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX063))::numeric(37,15) END AS TRX063,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX064 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX064))::numeric(37,15) END AS TRX064,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX065 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX065))::numeric(37,15) END AS TRX065,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX066 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX066))::numeric(37,15) END AS TRX066,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX067 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX067))::numeric(37,15) END AS TRX067,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX068 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX068))::numeric(37,15) END AS TRX068,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX069 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX069))::numeric(37,15) END AS TRX069,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX070 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX070))::numeric(37,15) END AS TRX070,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX071 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX071))::numeric(37,15) END AS TRX071,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX072 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX072))::numeric(37,15) END AS TRX072,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX073 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX073))::numeric(37,15) END AS TRX073,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX074 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX074))::numeric(37,15) END AS TRX074,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX075 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX075))::numeric(37,15) END AS TRX075,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX076 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX076))::numeric(37,15) END AS TRX076,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX077 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX077))::numeric(37,15) END AS TRX077,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX078 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX078))::numeric(37,15) END AS TRX078,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX079 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX079))::numeric(37,15) END AS TRX079,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX080 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX080))::numeric(37,15) END AS TRX080,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX081 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX081))::numeric(37,15) END AS TRX081,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX082 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX082))::numeric(37,15) END AS TRX082,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX083 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX083))::numeric(37,15) END AS TRX083,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX084 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX084))::numeric(37,15) END AS TRX084,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX085 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX085))::numeric(37,15) END AS TRX085,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX086 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX086))::numeric(37,15) END AS TRX086,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX087 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX087))::numeric(37,15) END AS TRX087,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX088 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX088))::numeric(37,15) END AS TRX088,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX089 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX089))::numeric(37,15) END AS TRX089,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX090 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX090))::numeric(37,15) END AS TRX090,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX091 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX091))::numeric(37,15) END AS TRX091,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX092 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX092))::numeric(37,15) END AS TRX092,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX093 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX093))::numeric(37,15) END AS TRX093,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX094 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX094))::numeric(37,15) END AS TRX094,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX095 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX095))::numeric(37,15) END AS TRX095,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX096 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX096))::numeric(37,15) END AS TRX096,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX097 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX097))::numeric(37,15) END AS TRX097,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX098 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX098))::numeric(37,15) END AS TRX098,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX099 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX099))::numeric(37,15) END AS TRX099,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX100 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX100))::numeric(37,15) END AS TRX100,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX101 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX101))::numeric(37,15) END AS TRX101,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX102 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX102))::numeric(37,15) END AS TRX102,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX103 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX103))::numeric(37,15) END AS TRX103,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX104 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX104))::numeric(37,15) END AS TRX104,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX105 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX105))::numeric(37,15) END AS TRX105,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX106 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX106))::numeric(37,15) END AS TRX106,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX107 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX107))::numeric(37,15) END AS TRX107,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX108 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX108))::numeric(37,15) END AS TRX108,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX109 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX109))::numeric(37,15) END AS TRX109,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX110 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX110))::numeric(37,15) END AS TRX110,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX111 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX111))::numeric(37,15) END AS TRX111,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX112 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX112))::numeric(37,15) END AS TRX112,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX113 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX113))::numeric(37,15) END AS TRX113,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX114 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX114))::numeric(37,15) END AS TRX114,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX115 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX115))::numeric(37,15) END AS TRX115,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX116 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX116))::numeric(37,15) END AS TRX116,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX117 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX117))::numeric(37,15) END AS TRX117,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX118 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX118))::numeric(37,15) END AS TRX118,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX119 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX119))::numeric(37,15) END AS TRX119,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX120 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX120))::numeric(37,15) END AS TRX120,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX121 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX121))::numeric(37,15) END AS TRX121,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX122 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX122))::numeric(37,15) END AS TRX122,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX123 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX123))::numeric(37,15) END AS TRX123,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX124 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX124))::numeric(37,15) END AS TRX124,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX125 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX125))::numeric(37,15) END AS TRX125,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX126 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX126))::numeric(37,15) END AS TRX126,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX127 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX127))::numeric(37,15) END AS TRX127,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX128 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX128))::numeric(37,15) END AS TRX128,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX129 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX129))::numeric(37,15) END AS TRX129,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX130 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX130))::numeric(37,15) END AS TRX130,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX131 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX131))::numeric(37,15) END AS TRX131,
        CASE WHEN (EXT_IMS_MHJ_CONTROL_W_src.TRX132 = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_IMS_MHJ_CONTROL_W_src.TRX132))::numeric(37,15) END AS TRX132,
        EXT_IMS_MHJ_CONTROL_W_src.batch_id,
        EXT_IMS_MHJ_CONTROL_W_src.row_id,
        EXT_IMS_MHJ_CONTROL_W_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_CONTROL_W_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_QTY_M AS
 SELECT CASE WHEN (EXT_IMS_MHJ_QTY_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_QTY_M_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_QTY_M_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_QTY_M_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_QTY_M_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_QTY_M_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_QTY_M_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_QTY_M_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_QTY_M_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_QTY_M_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_QTY_M_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_QTY_M_src.address) AS address,
        btrim(EXT_IMS_MHJ_QTY_M_src.city) AS city,
        btrim(EXT_IMS_MHJ_QTY_M_src.state) AS state,
        btrim(EXT_IMS_MHJ_QTY_M_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_QTY_M_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_QTY_M_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_QTY_M_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_M_src.trx_024))::numeric(9,3) END AS trx_024,
        EXT_IMS_MHJ_QTY_M_src.batch_id,
        EXT_IMS_MHJ_QTY_M_src.row_id,
        EXT_IMS_MHJ_QTY_M_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_QTY_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHJ_QTY_W AS
 SELECT CASE WHEN (EXT_IMS_MHJ_QTY_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.ims_client_num))::int END AS ims_client_num,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.ims_report_num))::int END AS ims_report_num,
        btrim(EXT_IMS_MHJ_QTY_W_src.zip_other) AS zip_other,
        btrim(EXT_IMS_MHJ_QTY_W_src.ims_id) AS ims_id,
        btrim(EXT_IMS_MHJ_QTY_W_src.specialty) AS specialty,
        btrim(EXT_IMS_MHJ_QTY_W_src.plan_id) AS plan_id,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.sales_category))::int END AS sales_category,
        btrim(EXT_IMS_MHJ_QTY_W_src.rx_type) AS rx_type,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.ims_product_group_num))::int END AS ims_product_group_num,
        btrim(EXT_IMS_MHJ_QTY_W_src.filler_01) AS filler_01,
        btrim(EXT_IMS_MHJ_QTY_W_src.me_num) AS me_num,
        btrim(EXT_IMS_MHJ_QTY_W_src.last_name) AS last_name,
        btrim(EXT_IMS_MHJ_QTY_W_src.first_name) AS first_name,
        btrim(EXT_IMS_MHJ_QTY_W_src.middle_name) AS middle_name,
        btrim(EXT_IMS_MHJ_QTY_W_src.address) AS address,
        btrim(EXT_IMS_MHJ_QTY_W_src.city) AS city,
        btrim(EXT_IMS_MHJ_QTY_W_src.state) AS state,
        btrim(EXT_IMS_MHJ_QTY_W_src.zip) AS zip,
        btrim(EXT_IMS_MHJ_QTY_W_src.supplemental_data) AS supplemental_data,
        btrim(EXT_IMS_MHJ_QTY_W_src.plan_name) AS plan_name,
        btrim(EXT_IMS_MHJ_QTY_W_src.data_date) AS data_date,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.bucket_count))::int END AS bucket_count,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_001))::numeric(9,3) END AS nrx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_002))::numeric(9,3) END AS nrx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_003))::numeric(9,3) END AS nrx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_004))::numeric(9,3) END AS nrx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_005))::numeric(9,3) END AS nrx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_006))::numeric(9,3) END AS nrx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_007))::numeric(9,3) END AS nrx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_008))::numeric(9,3) END AS nrx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_009))::numeric(9,3) END AS nrx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_010))::numeric(9,3) END AS nrx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_011))::numeric(9,3) END AS nrx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_012))::numeric(9,3) END AS nrx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_013))::numeric(9,3) END AS nrx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_014))::numeric(9,3) END AS nrx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_015))::numeric(9,3) END AS nrx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_016))::numeric(9,3) END AS nrx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_017))::numeric(9,3) END AS nrx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_018))::numeric(9,3) END AS nrx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_019))::numeric(9,3) END AS nrx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_020))::numeric(9,3) END AS nrx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_021))::numeric(9,3) END AS nrx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_022))::numeric(9,3) END AS nrx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_023))::numeric(9,3) END AS nrx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_024))::numeric(9,3) END AS nrx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_025))::numeric(9,3) END AS nrx_025,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_026))::numeric(9,3) END AS nrx_026,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_027))::numeric(9,3) END AS nrx_027,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_028))::numeric(9,3) END AS nrx_028,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_029))::numeric(9,3) END AS nrx_029,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_030))::numeric(9,3) END AS nrx_030,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_031))::numeric(9,3) END AS nrx_031,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_032))::numeric(9,3) END AS nrx_032,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_033))::numeric(9,3) END AS nrx_033,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_034))::numeric(9,3) END AS nrx_034,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_035))::numeric(9,3) END AS nrx_035,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_036))::numeric(9,3) END AS nrx_036,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_037))::numeric(9,3) END AS nrx_037,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_038))::numeric(9,3) END AS nrx_038,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_039))::numeric(9,3) END AS nrx_039,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_040))::numeric(9,3) END AS nrx_040,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_041))::numeric(9,3) END AS nrx_041,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_042))::numeric(9,3) END AS nrx_042,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_043))::numeric(9,3) END AS nrx_043,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_044))::numeric(9,3) END AS nrx_044,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_045))::numeric(9,3) END AS nrx_045,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_046))::numeric(9,3) END AS nrx_046,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_047))::numeric(9,3) END AS nrx_047,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_048))::numeric(9,3) END AS nrx_048,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_049))::numeric(9,3) END AS nrx_049,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_050))::numeric(9,3) END AS nrx_050,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_051))::numeric(9,3) END AS nrx_051,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_052))::numeric(9,3) END AS nrx_052,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_053))::numeric(9,3) END AS nrx_053,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_054))::numeric(9,3) END AS nrx_054,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_055))::numeric(9,3) END AS nrx_055,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_056))::numeric(9,3) END AS nrx_056,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_057))::numeric(9,3) END AS nrx_057,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_058))::numeric(9,3) END AS nrx_058,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_059))::numeric(9,3) END AS nrx_059,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_060))::numeric(9,3) END AS nrx_060,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_061))::numeric(9,3) END AS nrx_061,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_062))::numeric(9,3) END AS nrx_062,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_063))::numeric(9,3) END AS nrx_063,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_064))::numeric(9,3) END AS nrx_064,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_065))::numeric(9,3) END AS nrx_065,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_066))::numeric(9,3) END AS nrx_066,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_067))::numeric(9,3) END AS nrx_067,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_068))::numeric(9,3) END AS nrx_068,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_069))::numeric(9,3) END AS nrx_069,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_070))::numeric(9,3) END AS nrx_070,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_071))::numeric(9,3) END AS nrx_071,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_072))::numeric(9,3) END AS nrx_072,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_073))::numeric(9,3) END AS nrx_073,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_074))::numeric(9,3) END AS nrx_074,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_075))::numeric(9,3) END AS nrx_075,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_076))::numeric(9,3) END AS nrx_076,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_077))::numeric(9,3) END AS nrx_077,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_078))::numeric(9,3) END AS nrx_078,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_079))::numeric(9,3) END AS nrx_079,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_080))::numeric(9,3) END AS nrx_080,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_081))::numeric(9,3) END AS nrx_081,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_082))::numeric(9,3) END AS nrx_082,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_083))::numeric(9,3) END AS nrx_083,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_084))::numeric(9,3) END AS nrx_084,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_085))::numeric(9,3) END AS nrx_085,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_086))::numeric(9,3) END AS nrx_086,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_087))::numeric(9,3) END AS nrx_087,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_088))::numeric(9,3) END AS nrx_088,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_089))::numeric(9,3) END AS nrx_089,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_090))::numeric(9,3) END AS nrx_090,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_091))::numeric(9,3) END AS nrx_091,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_092))::numeric(9,3) END AS nrx_092,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_093))::numeric(9,3) END AS nrx_093,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_094))::numeric(9,3) END AS nrx_094,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_095))::numeric(9,3) END AS nrx_095,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_096))::numeric(9,3) END AS nrx_096,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_097))::numeric(9,3) END AS nrx_097,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_098))::numeric(9,3) END AS nrx_098,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_099))::numeric(9,3) END AS nrx_099,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_100))::numeric(9,3) END AS nrx_100,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_101))::numeric(9,3) END AS nrx_101,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_102))::numeric(9,3) END AS nrx_102,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_103))::numeric(9,3) END AS nrx_103,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_104))::numeric(9,3) END AS nrx_104,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_105))::numeric(9,3) END AS nrx_105,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_106))::numeric(9,3) END AS nrx_106,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_107))::numeric(9,3) END AS nrx_107,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_108))::numeric(9,3) END AS nrx_108,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_109))::numeric(9,3) END AS nrx_109,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_110))::numeric(9,3) END AS nrx_110,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_111))::numeric(9,3) END AS nrx_111,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_112))::numeric(9,3) END AS nrx_112,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_113))::numeric(9,3) END AS nrx_113,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_114))::numeric(9,3) END AS nrx_114,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_115))::numeric(9,3) END AS nrx_115,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_116))::numeric(9,3) END AS nrx_116,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_117))::numeric(9,3) END AS nrx_117,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_118))::numeric(9,3) END AS nrx_118,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_119))::numeric(9,3) END AS nrx_119,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_120))::numeric(9,3) END AS nrx_120,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_121))::numeric(9,3) END AS nrx_121,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_122))::numeric(9,3) END AS nrx_122,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_123))::numeric(9,3) END AS nrx_123,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_124))::numeric(9,3) END AS nrx_124,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_125))::numeric(9,3) END AS nrx_125,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_126))::numeric(9,3) END AS nrx_126,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_127))::numeric(9,3) END AS nrx_127,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_128))::numeric(9,3) END AS nrx_128,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_129))::numeric(9,3) END AS nrx_129,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_130))::numeric(9,3) END AS nrx_130,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_131))::numeric(9,3) END AS nrx_131,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.nrx_132))::numeric(9,3) END AS nrx_132,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_001))::numeric(9,3) END AS trx_001,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_002))::numeric(9,3) END AS trx_002,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_003))::numeric(9,3) END AS trx_003,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_004))::numeric(9,3) END AS trx_004,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_005))::numeric(9,3) END AS trx_005,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_006))::numeric(9,3) END AS trx_006,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_007))::numeric(9,3) END AS trx_007,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_008))::numeric(9,3) END AS trx_008,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_009))::numeric(9,3) END AS trx_009,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_010))::numeric(9,3) END AS trx_010,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_011))::numeric(9,3) END AS trx_011,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_012))::numeric(9,3) END AS trx_012,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_013))::numeric(9,3) END AS trx_013,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_014))::numeric(9,3) END AS trx_014,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_015))::numeric(9,3) END AS trx_015,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_016))::numeric(9,3) END AS trx_016,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_017))::numeric(9,3) END AS trx_017,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_018))::numeric(9,3) END AS trx_018,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_019))::numeric(9,3) END AS trx_019,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_020))::numeric(9,3) END AS trx_020,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_021))::numeric(9,3) END AS trx_021,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_022))::numeric(9,3) END AS trx_022,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_023))::numeric(9,3) END AS trx_023,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_024))::numeric(9,3) END AS trx_024,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_025))::numeric(9,3) END AS trx_025,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_026))::numeric(9,3) END AS trx_026,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_027))::numeric(9,3) END AS trx_027,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_028))::numeric(9,3) END AS trx_028,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_029))::numeric(9,3) END AS trx_029,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_030))::numeric(9,3) END AS trx_030,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_031))::numeric(9,3) END AS trx_031,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_032))::numeric(9,3) END AS trx_032,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_033))::numeric(9,3) END AS trx_033,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_034))::numeric(9,3) END AS trx_034,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_035))::numeric(9,3) END AS trx_035,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_036))::numeric(9,3) END AS trx_036,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_037))::numeric(9,3) END AS trx_037,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_038))::numeric(9,3) END AS trx_038,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_039))::numeric(9,3) END AS trx_039,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_040))::numeric(9,3) END AS trx_040,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_041))::numeric(9,3) END AS trx_041,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_042))::numeric(9,3) END AS trx_042,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_043))::numeric(9,3) END AS trx_043,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_044))::numeric(9,3) END AS trx_044,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_045))::numeric(9,3) END AS trx_045,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_046))::numeric(9,3) END AS trx_046,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_047))::numeric(9,3) END AS trx_047,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_048))::numeric(9,3) END AS trx_048,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_049))::numeric(9,3) END AS trx_049,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_050))::numeric(9,3) END AS trx_050,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_051))::numeric(9,3) END AS trx_051,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_052))::numeric(9,3) END AS trx_052,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_053))::numeric(9,3) END AS trx_053,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_054))::numeric(9,3) END AS trx_054,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_055))::numeric(9,3) END AS trx_055,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_056))::numeric(9,3) END AS trx_056,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_057))::numeric(9,3) END AS trx_057,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_058))::numeric(9,3) END AS trx_058,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_059))::numeric(9,3) END AS trx_059,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_060))::numeric(9,3) END AS trx_060,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_061))::numeric(9,3) END AS trx_061,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_062))::numeric(9,3) END AS trx_062,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_063))::numeric(9,3) END AS trx_063,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_064))::numeric(9,3) END AS trx_064,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_065))::numeric(9,3) END AS trx_065,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_066))::numeric(9,3) END AS trx_066,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_067))::numeric(9,3) END AS trx_067,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_068))::numeric(9,3) END AS trx_068,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_069))::numeric(9,3) END AS trx_069,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_070))::numeric(9,3) END AS trx_070,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_071))::numeric(9,3) END AS trx_071,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_072))::numeric(9,3) END AS trx_072,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_073))::numeric(9,3) END AS trx_073,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_074))::numeric(9,3) END AS trx_074,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_075))::numeric(9,3) END AS trx_075,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_076))::numeric(9,3) END AS trx_076,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_077))::numeric(9,3) END AS trx_077,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_078))::numeric(9,3) END AS trx_078,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_079))::numeric(9,3) END AS trx_079,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_080))::numeric(9,3) END AS trx_080,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_081))::numeric(9,3) END AS trx_081,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_082))::numeric(9,3) END AS trx_082,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_083))::numeric(9,3) END AS trx_083,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_084))::numeric(9,3) END AS trx_084,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_085))::numeric(9,3) END AS trx_085,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_086))::numeric(9,3) END AS trx_086,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_087))::numeric(9,3) END AS trx_087,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_088))::numeric(9,3) END AS trx_088,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_089))::numeric(9,3) END AS trx_089,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_090))::numeric(9,3) END AS trx_090,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_091))::numeric(9,3) END AS trx_091,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_092))::numeric(9,3) END AS trx_092,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_093))::numeric(9,3) END AS trx_093,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_094))::numeric(9,3) END AS trx_094,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_095))::numeric(9,3) END AS trx_095,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_096))::numeric(9,3) END AS trx_096,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_097))::numeric(9,3) END AS trx_097,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_098))::numeric(9,3) END AS trx_098,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_099))::numeric(9,3) END AS trx_099,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_100))::numeric(9,3) END AS trx_100,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_101))::numeric(9,3) END AS trx_101,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_102))::numeric(9,3) END AS trx_102,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_103))::numeric(9,3) END AS trx_103,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_104))::numeric(9,3) END AS trx_104,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_105))::numeric(9,3) END AS trx_105,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_106))::numeric(9,3) END AS trx_106,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_107))::numeric(9,3) END AS trx_107,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_108))::numeric(9,3) END AS trx_108,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_109))::numeric(9,3) END AS trx_109,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_110))::numeric(9,3) END AS trx_110,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_111))::numeric(9,3) END AS trx_111,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_112))::numeric(9,3) END AS trx_112,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_113))::numeric(9,3) END AS trx_113,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_114))::numeric(9,3) END AS trx_114,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_115))::numeric(9,3) END AS trx_115,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_116))::numeric(9,3) END AS trx_116,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_117))::numeric(9,3) END AS trx_117,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_118))::numeric(9,3) END AS trx_118,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_119))::numeric(9,3) END AS trx_119,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_120))::numeric(9,3) END AS trx_120,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_121))::numeric(9,3) END AS trx_121,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_122))::numeric(9,3) END AS trx_122,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_123))::numeric(9,3) END AS trx_123,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_124))::numeric(9,3) END AS trx_124,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_125))::numeric(9,3) END AS trx_125,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_126))::numeric(9,3) END AS trx_126,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_127))::numeric(9,3) END AS trx_127,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_128))::numeric(9,3) END AS trx_128,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_129))::numeric(9,3) END AS trx_129,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_130))::numeric(9,3) END AS trx_130,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_131))::numeric(9,3) END AS trx_131,
        CASE WHEN (EXT_IMS_MHJ_QTY_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHJ_QTY_W_src.trx_132))::numeric(9,3) END AS trx_132,
        EXT_IMS_MHJ_QTY_W_src.batch_id,
        EXT_IMS_MHJ_QTY_W_src.row_id,
        EXT_IMS_MHJ_QTY_W_src.update_ts
 FROM teva_ingestion.EXT_IMS_MHJ_QTY_W_src;

CREATE  VIEW teva_ingestion.ext_ims_pbm_xref AS
 SELECT btrim(EXT_IMS_PBM_XREF_src.PBM_NAME) AS PBM_NAME,
        btrim(EXT_IMS_PBM_XREF_src.PAYER_PLAN_NUM) AS PAYER_PLAN_NUM,
        btrim(EXT_IMS_PBM_XREF_src.XREF_TO_PAYER_PLAN_NUM) AS XREF_TO_PAYER_PLAN_NUM,
        btrim(EXT_IMS_PBM_XREF_src.IPD_ID) AS IPD_ID,
        btrim(EXT_IMS_PBM_XREF_src.IPD_TYPE) AS IPD_TYPE,
        btrim(EXT_IMS_PBM_XREF_src.PLAN_NAME) AS PLAN_NAME,
        btrim(EXT_IMS_PBM_XREF_src.PBM_NUM) AS PBM_NUM,
        btrim(EXT_IMS_PBM_XREF_src.IMS_PROCESSOR_NUM) AS IMS_PROCESSOR_NUM,
        EXT_IMS_PBM_XREF_src.batch_id,
        EXT_IMS_PBM_XREF_src.row_id,
        EXT_IMS_PBM_XREF_src.update_ts
 FROM teva_ingestion.EXT_IMS_PBM_XREF_src
 WHERE (EXT_IMS_PBM_XREF_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IMS_PBM_XREF'::varchar(16))));

CREATE  VIEW teva_ingestion.EXT_IMS_PDRP AS
SELECT btrim(EXT_IMS_PDRP_src.IMS_ID) AS IMS_ID, btrim(EXT_IMS_PDRP_src.FILLER_01) AS FILLER_01, btrim(EXT_IMS_PDRP_src.FILLER_02) AS FILLER_02, btrim(EXT_IMS_PDRP_src.ME_NBR) AS ME_NBR, btrim(EXT_IMS_PDRP_src.LAST_NAME) AS LAST_NAME, btrim(EXT_IMS_PDRP_src.FIRST_NAME) AS FIRST_NAME, btrim(EXT_IMS_PDRP_src.MIDDLE) AS MIDDLE, btrim(EXT_IMS_PDRP_src.FILLER_03) AS FILLER_03, CASE WHEN (EXT_IMS_PDRP_src.PDRP_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_IMS_PDRP_src.PDRP_DATE))::timestamp END AS PDRP_DATE, EXT_IMS_PDRP_src.batch_id, EXT_IMS_PDRP_src.row_id, EXT_IMS_PDRP_src.update_ts FROM teva_ingestion.EXT_IMS_PDRP_src WHERE (EXT_IMS_PDRP_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_PDRP'::varchar(12))));

CREATE  VIEW teva_ingestion.ext_ims_plan_xref AS
 SELECT btrim(EXT_IMS_PLAN_XREF_src.PAYER_NUM) AS PAYER_NUM,
        btrim(EXT_IMS_PLAN_XREF_src.PAYER_NAME) AS PAYER_NAME,
        btrim(EXT_IMS_PLAN_XREF_src.PLAN_NUM) AS PLAN_NUM,
        btrim(EXT_IMS_PLAN_XREF_src.PAYER_PLAN_NUM) AS PAYER_PLAN_NUM,
        btrim(EXT_IMS_PLAN_XREF_src.PLAN_NAME) AS PLAN_NAME,
        btrim(EXT_IMS_PLAN_XREF_src.MODEL) AS MODEL,
        btrim(EXT_IMS_PLAN_XREF_src.CITY) AS CITY,
        btrim(EXT_IMS_PLAN_XREF_src.HQ_STATE) AS HQ_STATE,
        btrim(EXT_IMS_PLAN_XREF_src.OPERATING_STATE) AS OPERATING_STATE,
        btrim(EXT_IMS_PLAN_XREF_src.MONTHS_WITH_DATA) AS MONTHS_WITH_DATA,
        EXT_IMS_PLAN_XREF_src.batch_id,
        EXT_IMS_PLAN_XREF_src.row_id,
        EXT_IMS_PLAN_XREF_src.update_ts
 FROM teva_ingestion.EXT_IMS_PLAN_XREF_src
 WHERE (EXT_IMS_PLAN_XREF_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IMS_PLAN_XREF'::varchar(17))));

CREATE  VIEW teva_ingestion.ext_ims_plan_xref_accelerated AS
 SELECT btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.PAYER_NUM) AS PAYER_NUM,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.PAYER_NAME) AS PAYER_NAME,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.PLAN_NUM) AS PLAN_NUM,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.PAYER_PLAN_NUM) AS PAYER_PLAN_NUM,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.PLAN_NAME) AS PLAN_NAME,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.MODEL) AS MODEL,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.CITY) AS CITY,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.HQ_STATE) AS HQ_STATE,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.OPERATING_STATE) AS OPERATING_STATE,
        btrim(EXT_IMS_PLAN_XREF_ACCELERATED_src.MONTHS_WITH_DATA) AS MONTHS_WITH_DATA,
        EXT_IMS_PLAN_XREF_ACCELERATED_src.batch_id,
        EXT_IMS_PLAN_XREF_ACCELERATED_src.row_id,
        EXT_IMS_PLAN_XREF_ACCELERATED_src.update_ts
 FROM teva_ingestion.EXT_IMS_PLAN_XREF_ACCELERATED_src
 WHERE (EXT_IMS_PLAN_XREF_ACCELERATED_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IMS_PLAN_XREF_ACCELERATED'::varchar(29))));

CREATE  VIEW teva_ingestion.ext_ims_sln_xref_kc AS
 SELECT btrim(ext_ims_sln_xref_kc_src.IMS_ID) AS IMS_ID,
        btrim(ext_ims_sln_xref_kc_src.STATE_LICENSE_NUMBER) AS STATE_LICENSE_NUMBER,
        btrim(ext_ims_sln_xref_kc_src.STATE_LICENSE_STATE) AS STATE_LICENSE_STATE,
        ext_ims_sln_xref_kc_src.batch_id,
        ext_ims_sln_xref_kc_src.row_id,
        ext_ims_sln_xref_kc_src.update_ts
 FROM teva_ingestion.ext_ims_sln_xref_kc_src
 WHERE (ext_ims_sln_xref_kc_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_IMS_SLN_XREF_KC'::varchar(19))));

CREATE  VIEW teva_ingestion.ext_kc_zip_to_territory AS
 SELECT btrim(ext_kc_zip_to_territory_src.ZIP) AS ZIP,
        btrim(ext_kc_zip_to_territory_src.CITY) AS CITY,
        btrim(ext_kc_zip_to_territory_src.STATE) AS STATE,
        btrim(ext_kc_zip_to_territory_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(ext_kc_zip_to_territory_src.TERRITORY_NAME) AS TERRITORY_NAME,
        btrim(ext_kc_zip_to_territory_src.AREA_NAME) AS AREA_NAME,
        btrim(ext_kc_zip_to_territory_src.REGION_NAME) AS REGION_NAME,
        btrim(ext_kc_zip_to_territory_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(ext_kc_zip_to_territory_src.ORGANIZATION_CODE) AS ORGANIZATION_CODE,
        CASE WHEN (ext_kc_zip_to_territory_src.INACTIVE_FLAG = ''::varchar) THEN NULL::numeric(1,0) ELSE (btrim(ext_kc_zip_to_territory_src.INACTIVE_FLAG))::numeric(1,0) END AS INACTIVE_FLAG,
        btrim(ext_kc_zip_to_territory_src.COMMENTS) AS COMMENTS,
        CASE WHEN (ext_kc_zip_to_territory_src.MIRROR_FLAG = ''::varchar) THEN NULL::numeric(1,0) ELSE (btrim(ext_kc_zip_to_territory_src.MIRROR_FLAG))::numeric(1,0) END AS MIRROR_FLAG,
        btrim(ext_kc_zip_to_territory_src.MIRROR_TERRITORY_NUM) AS MIRROR_TERRITORY_NUM,
        ext_kc_zip_to_territory_src.batch_id,
        ext_kc_zip_to_territory_src.row_id,
        ext_kc_zip_to_territory_src.update_ts
 FROM teva_ingestion.ext_kc_zip_to_territory_src
 WHERE (ext_kc_zip_to_territory_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_KC_ZIP_TO_TERRITORY'::varchar(23))));

CREATE  VIEW teva_ingestion.ext_knipper_samples_shipped AS
 SELECT btrim(ext_knipper_samples_shipped_src.CLIENT_PRAC_ID) AS CLIENT_PRAC_ID,
        btrim(ext_knipper_samples_shipped_src.TERR_CODE) AS TERR_CODE,
        btrim(ext_knipper_samples_shipped_src.SAMPLE_PROD_CODE) AS SAMPLE_PROD_CODE,
        btrim(ext_knipper_samples_shipped_src.SAMPLE_DATE) AS SAMPLE_DATE,
        CASE WHEN (ext_knipper_samples_shipped_src.SAMPLE_QTY = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_knipper_samples_shipped_src.SAMPLE_QTY))::numeric(38,0) END AS SAMPLE_QTY,
        btrim(ext_knipper_samples_shipped_src.REQUEST_DATE) AS REQUEST_DATE,
        CASE WHEN (ext_knipper_samples_shipped_src.REQUEST_QTY = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_knipper_samples_shipped_src.REQUEST_QTY))::numeric(38,0) END AS REQUEST_QTY,
        ext_knipper_samples_shipped_src.batch_id,
        ext_knipper_samples_shipped_src.row_id,
        ext_knipper_samples_shipped_src.update_ts
 FROM teva_ingestion.ext_knipper_samples_shipped_src
 WHERE (ext_knipper_samples_shipped_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_KNIPPER_SAMPLES_SHIPPED'::varchar(27))));

CREATE  VIEW teva_ingestion.EXT_MM_RAM_TO_STATE AS
 SELECT btrim(EXT_MM_RAM_TO_STATE_src.MM_RAM) AS MM_RAM,
        btrim(EXT_MM_RAM_TO_STATE_src.STATE) AS STATE,
        EXT_MM_RAM_TO_STATE_src.batch_id,
        EXT_MM_RAM_TO_STATE_src.row_id,
        EXT_MM_RAM_TO_STATE_src.update_ts
 FROM teva_ingestion.EXT_MM_RAM_TO_STATE_src
 WHERE (EXT_MM_RAM_TO_STATE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_MM_RAM_TO_STATE'::varchar(19))));

CREATE  VIEW teva_ingestion.ext_omnicare_sales AS
 SELECT btrim(EXT_OMNICARE_SALES_src.TRANSACTION_ID) AS TRANSACTION_ID,
        btrim(EXT_OMNICARE_SALES_src.INVOICE_DATE) AS INVOICE_DATE,
        btrim(EXT_OMNICARE_SALES_src.PRODUCT_BRAND) AS PRODUCT_BRAND,
        btrim(EXT_OMNICARE_SALES_src.PRODUCT_NDC) AS PRODUCT_NDC,
        btrim(EXT_OMNICARE_SALES_src.PRODUCT_DESC) AS PRODUCT_DESC,
        CASE WHEN (EXT_OMNICARE_SALES_src.INVOICE_QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.INVOICE_QTY))::numeric(37,15) END AS INVOICE_QTY,
        CASE WHEN (EXT_OMNICARE_SALES_src.INVOICE_UNITS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.INVOICE_UNITS))::numeric(37,15) END AS INVOICE_UNITS,
        CASE WHEN (EXT_OMNICARE_SALES_src.INVOICE_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.INVOICE_COST))::numeric(37,15) END AS INVOICE_COST,
        CASE WHEN (EXT_OMNICARE_SALES_src.INVOICE_PACK_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.INVOICE_PACK_COST))::numeric(37,15) END AS INVOICE_PACK_COST,
        CASE WHEN (EXT_OMNICARE_SALES_src.INVOICE_UNIT_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.INVOICE_UNIT_COST))::numeric(37,15) END AS INVOICE_UNIT_COST,
        CASE WHEN (EXT_OMNICARE_SALES_src.CONTRACT_PACK_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.CONTRACT_PACK_COST))::numeric(37,15) END AS CONTRACT_PACK_COST,
        CASE WHEN (EXT_OMNICARE_SALES_src.CONTRACT_PURCHASES = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_OMNICARE_SALES_src.CONTRACT_PURCHASES))::numeric(37,15) END AS CONTRACT_PURCHASES,
        btrim(EXT_OMNICARE_SALES_src.CONTRACT_NUMBER) AS CONTRACT_NUMBER,
        btrim(EXT_OMNICARE_SALES_src.DISPENSING_LOCATION) AS DISPENSING_LOCATION,
        btrim(EXT_OMNICARE_SALES_src.DL_ADDRESS_1) AS DL_ADDRESS_1,
        btrim(EXT_OMNICARE_SALES_src.DL_ADDRESS_2) AS DL_ADDRESS_2,
        btrim(EXT_OMNICARE_SALES_src.DL_CITY) AS DL_CITY,
        btrim(EXT_OMNICARE_SALES_src.DL_STATE) AS DL_STATE,
        btrim(EXT_OMNICARE_SALES_src.DL_ZIP) AS DL_ZIP,
        btrim(EXT_OMNICARE_SALES_src.DL_DEA_NUM) AS DL_DEA_NUM,
        btrim(EXT_OMNICARE_SALES_src.DEPOT_LOCATION) AS DEPOT_LOCATION,
        btrim(EXT_OMNICARE_SALES_src.DEP_ADDRESS_1) AS DEP_ADDRESS_1,
        btrim(EXT_OMNICARE_SALES_src.DEP_ADDRESS_2) AS DEP_ADDRESS_2,
        btrim(EXT_OMNICARE_SALES_src.DEP_CITY) AS DEP_CITY,
        btrim(EXT_OMNICARE_SALES_src.DEP_STATE) AS DEP_STATE,
        btrim(EXT_OMNICARE_SALES_src.DEP_ZIP) AS DEP_ZIP,
        btrim(EXT_OMNICARE_SALES_src.DEP_DEA_NUM) AS DEP_DEA_NUM,
        EXT_OMNICARE_SALES_src.batch_id,
        EXT_OMNICARE_SALES_src.row_id,
        EXT_OMNICARE_SALES_src.update_ts
 FROM teva_ingestion.EXT_OMNICARE_SALES_src
 WHERE (EXT_OMNICARE_SALES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_OMNICARE_SALES'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_ONC_DDD_MONTHLY_RETAIL AS
 SELECT btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.sra_1) AS sra_1,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.ZIP) AS ZIP,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.sra_3) AS sra_3,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.sra_4) AS sra_4,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.DATA_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.DATA_DATE))::timestamp END AS DATA_DATE,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH01))::numeric(19,0) END AS QTY_MTH01,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH02))::numeric(19,0) END AS QTY_MTH02,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH03))::numeric(19,0) END AS QTY_MTH03,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH04))::numeric(19,0) END AS QTY_MTH04,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH05))::numeric(19,0) END AS QTY_MTH05,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH06))::numeric(19,0) END AS QTY_MTH06,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH07))::numeric(19,0) END AS QTY_MTH07,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH08))::numeric(19,0) END AS QTY_MTH08,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH09))::numeric(19,0) END AS QTY_MTH09,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH10))::numeric(19,0) END AS QTY_MTH10,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH11))::numeric(19,0) END AS QTY_MTH11,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH12))::numeric(19,0) END AS QTY_MTH12,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH13))::numeric(19,0) END AS QTY_MTH13,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH14))::numeric(19,0) END AS QTY_MTH14,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH15))::numeric(19,0) END AS QTY_MTH15,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH16))::numeric(19,0) END AS QTY_MTH16,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH17))::numeric(19,0) END AS QTY_MTH17,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH18))::numeric(19,0) END AS QTY_MTH18,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH19))::numeric(19,0) END AS QTY_MTH19,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH20))::numeric(19,0) END AS QTY_MTH20,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH21))::numeric(19,0) END AS QTY_MTH21,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH22))::numeric(19,0) END AS QTY_MTH22,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH23))::numeric(19,0) END AS QTY_MTH23,
        CASE WHEN (EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.QTY_MTH24))::numeric(19,0) END AS QTY_MTH24,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.CITY) AS CITY,
        btrim(EXT_ONC_DDD_MONTHLY_RETAIL_src.STATE) AS STATE,
        EXT_ONC_DDD_MONTHLY_RETAIL_src.batch_id,
        EXT_ONC_DDD_MONTHLY_RETAIL_src.row_id,
        EXT_ONC_DDD_MONTHLY_RETAIL_src.update_ts
 FROM teva_ingestion.EXT_ONC_DDD_MONTHLY_RETAIL_src
 WHERE (EXT_ONC_DDD_MONTHLY_RETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DDD_MONTHLY_RETAIL'::varchar(26))));

CREATE  VIEW teva_ingestion.EXT_ONC_DDD_WEEKLY_RETAIL AS
 SELECT btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.ZIP) AS ZIP,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.sra_2) AS sra_2,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.sra_3) AS sra_3,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.sra_4) AS sra_4,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.DATA_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.DATA_DATE))::timestamp END AS DATA_DATE,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK01))::numeric(19,0) END AS QTY_WK01,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK02))::numeric(19,0) END AS QTY_WK02,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK03))::numeric(19,0) END AS QTY_WK03,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK04))::numeric(19,0) END AS QTY_WK04,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK05))::numeric(19,0) END AS QTY_WK05,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK06))::numeric(19,0) END AS QTY_WK06,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK07))::numeric(19,0) END AS QTY_WK07,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK08))::numeric(19,0) END AS QTY_WK08,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK09))::numeric(19,0) END AS QTY_WK09,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK10))::numeric(19,0) END AS QTY_WK10,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK11))::numeric(19,0) END AS QTY_WK11,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK12))::numeric(19,0) END AS QTY_WK12,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK13))::numeric(19,0) END AS QTY_WK13,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK14))::numeric(19,0) END AS QTY_WK14,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK15))::numeric(19,0) END AS QTY_WK15,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK16))::numeric(19,0) END AS QTY_WK16,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK17))::numeric(19,0) END AS QTY_WK17,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK18))::numeric(19,0) END AS QTY_WK18,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK19))::numeric(19,0) END AS QTY_WK19,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK20))::numeric(19,0) END AS QTY_WK20,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK21))::numeric(19,0) END AS QTY_WK21,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK22))::numeric(19,0) END AS QTY_WK22,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK23))::numeric(19,0) END AS QTY_WK23,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK24))::numeric(19,0) END AS QTY_WK24,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK25 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK25))::numeric(19,0) END AS QTY_WK25,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK26 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK26))::numeric(19,0) END AS QTY_WK26,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK27 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK27))::numeric(19,0) END AS QTY_WK27,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK28 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK28))::numeric(19,0) END AS QTY_WK28,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK29 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK29))::numeric(19,0) END AS QTY_WK29,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK30 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK30))::numeric(19,0) END AS QTY_WK30,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK31 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK31))::numeric(19,0) END AS QTY_WK31,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK32 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK32))::numeric(19,0) END AS QTY_WK32,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK33 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK33))::numeric(19,0) END AS QTY_WK33,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK34 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK34))::numeric(19,0) END AS QTY_WK34,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK35 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK35))::numeric(19,0) END AS QTY_WK35,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK36 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK36))::numeric(19,0) END AS QTY_WK36,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK37 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK37))::numeric(19,0) END AS QTY_WK37,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK38 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK38))::numeric(19,0) END AS QTY_WK38,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK39 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK39))::numeric(19,0) END AS QTY_WK39,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK40 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK40))::numeric(19,0) END AS QTY_WK40,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK41 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK41))::numeric(19,0) END AS QTY_WK41,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK42 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK42))::numeric(19,0) END AS QTY_WK42,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK43 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK43))::numeric(19,0) END AS QTY_WK43,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK44 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK44))::numeric(19,0) END AS QTY_WK44,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK45 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK45))::numeric(19,0) END AS QTY_WK45,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK46 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK46))::numeric(19,0) END AS QTY_WK46,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK47 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK47))::numeric(19,0) END AS QTY_WK47,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK48 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK48))::numeric(19,0) END AS QTY_WK48,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK49 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK49))::numeric(19,0) END AS QTY_WK49,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK50 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK50))::numeric(19,0) END AS QTY_WK50,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK51 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK51))::numeric(19,0) END AS QTY_WK51,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK52 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK52))::numeric(19,0) END AS QTY_WK52,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK53 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK53))::numeric(19,0) END AS QTY_WK53,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK54 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK54))::numeric(19,0) END AS QTY_WK54,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK55 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK55))::numeric(19,0) END AS QTY_WK55,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK56 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK56))::numeric(19,0) END AS QTY_WK56,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK57 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK57))::numeric(19,0) END AS QTY_WK57,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK58 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK58))::numeric(19,0) END AS QTY_WK58,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK59 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK59))::numeric(19,0) END AS QTY_WK59,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK60 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK60))::numeric(19,0) END AS QTY_WK60,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK61 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK61))::numeric(19,0) END AS QTY_WK61,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK62 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK62))::numeric(19,0) END AS QTY_WK62,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK63 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK63))::numeric(19,0) END AS QTY_WK63,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK64 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK64))::numeric(19,0) END AS QTY_WK64,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK65 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK65))::numeric(19,0) END AS QTY_WK65,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK66 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK66))::numeric(19,0) END AS QTY_WK66,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK67 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK67))::numeric(19,0) END AS QTY_WK67,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK68 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK68))::numeric(19,0) END AS QTY_WK68,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK69 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK69))::numeric(19,0) END AS QTY_WK69,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK70 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK70))::numeric(19,0) END AS QTY_WK70,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK71 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK71))::numeric(19,0) END AS QTY_WK71,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK72 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK72))::numeric(19,0) END AS QTY_WK72,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK73 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK73))::numeric(19,0) END AS QTY_WK73,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK74 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK74))::numeric(19,0) END AS QTY_WK74,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK75 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK75))::numeric(19,0) END AS QTY_WK75,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK76 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK76))::numeric(19,0) END AS QTY_WK76,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK77 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK77))::numeric(19,0) END AS QTY_WK77,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK78 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK78))::numeric(19,0) END AS QTY_WK78,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK79 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK79))::numeric(19,0) END AS QTY_WK79,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK80 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK80))::numeric(19,0) END AS QTY_WK80,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK81 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK81))::numeric(19,0) END AS QTY_WK81,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK82 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK82))::numeric(19,0) END AS QTY_WK82,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK83 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK83))::numeric(19,0) END AS QTY_WK83,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK84 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK84))::numeric(19,0) END AS QTY_WK84,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK85 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK85))::numeric(19,0) END AS QTY_WK85,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK86 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK86))::numeric(19,0) END AS QTY_WK86,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK87 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK87))::numeric(19,0) END AS QTY_WK87,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK88 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK88))::numeric(19,0) END AS QTY_WK88,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK89 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK89))::numeric(19,0) END AS QTY_WK89,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK90 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK90))::numeric(19,0) END AS QTY_WK90,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK91 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK91))::numeric(19,0) END AS QTY_WK91,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK92 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK92))::numeric(19,0) END AS QTY_WK92,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK93 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK93))::numeric(19,0) END AS QTY_WK93,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK94 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK94))::numeric(19,0) END AS QTY_WK94,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK95 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK95))::numeric(19,0) END AS QTY_WK95,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK96 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK96))::numeric(19,0) END AS QTY_WK96,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK97 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK97))::numeric(19,0) END AS QTY_WK97,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK98 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK98))::numeric(19,0) END AS QTY_WK98,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK99 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK99))::numeric(19,0) END AS QTY_WK99,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK100 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK100))::numeric(19,0) END AS QTY_WK100,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK101 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK101))::numeric(19,0) END AS QTY_WK101,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK102 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK102))::numeric(19,0) END AS QTY_WK102,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK103 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK103))::numeric(19,0) END AS QTY_WK103,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK104 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK104))::numeric(19,0) END AS QTY_WK104,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK105 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK105))::numeric(19,0) END AS QTY_WK105,
        CASE WHEN (EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK106 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.QTY_WK106))::numeric(19,0) END AS QTY_WK106,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.CITY) AS CITY,
        btrim(EXT_ONC_DDD_WEEKLY_RETAIL_src.STATE) AS STATE,
        EXT_ONC_DDD_WEEKLY_RETAIL_src.batch_id,
        EXT_ONC_DDD_WEEKLY_RETAIL_src.row_id,
        EXT_ONC_DDD_WEEKLY_RETAIL_src.update_ts
 FROM teva_ingestion.EXT_ONC_DDD_WEEKLY_RETAIL_src
 WHERE (EXT_ONC_DDD_WEEKLY_RETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DDD_WEEKLY_RETAIL'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_DOL AS
 SELECT btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.IMS_FACILITY_NUMBER) AS IMS_FACILITY_NUMBER,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.IMS_PRESCRIBER_NUMBER) AS IMS_PRESCRIBER_NUMBER,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.OUTLET_ZIP) AS OUTLET_ZIP,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_NAME) AS FACILITY_PRESCRIBER_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_ADDRESS1) AS FACILITY_PRESCRIBER_ADDRESS1,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_ADDRESS2) AS FACILITY_PRESCRIBER_ADDRESS2,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_ADDRESS3) AS FACILITY_PRESCRIBER_ADDRESS3,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_ADDRESS4) AS FACILITY_PRESCRIBER_ADDRESS4,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_CITY) AS FACILITY_PRESCRIBER_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_STATE) AS FACILITY_PRESCRIBER_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.FACILITY_PRESCRIBER_ZIP) AS FACILITY_PRESCRIBER_ZIP,
        EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.batch_id,
        EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.row_id,
        EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_DOL_src
 WHERE (EXT_ONC_DMD_MONTHLY_DEMO_DOL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_MONTHLY_DEMO_DOL'::varchar(28))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_QTY AS
 SELECT btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.IMS_FACILITY_NUMBER) AS IMS_FACILITY_NUMBER,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.IMS_PRESCRIBER_NUMBER) AS IMS_PRESCRIBER_NUMBER,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.OUTLET_ZIP) AS OUTLET_ZIP,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_NAME) AS FACILITY_PRESCRIBER_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_ADDRESS1) AS FACILITY_PRESCRIBER_ADDRESS1,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_ADDRESS2) AS FACILITY_PRESCRIBER_ADDRESS2,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_ADDRESS3) AS FACILITY_PRESCRIBER_ADDRESS3,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_ADDRESS4) AS FACILITY_PRESCRIBER_ADDRESS4,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_CITY) AS FACILITY_PRESCRIBER_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_STATE) AS FACILITY_PRESCRIBER_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.FACILITY_PRESCRIBER_ZIP) AS FACILITY_PRESCRIBER_ZIP,
        EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.batch_id,
        EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.row_id,
        EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_MONTHLY_DEMO_QTY_src
 WHERE (EXT_ONC_DMD_MONTHLY_DEMO_QTY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_MONTHLY_DEMO_QTY'::varchar(28))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_MONTHLY_DOLLARS AS
 SELECT btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.ALT_SEQ_NUM) AS ALT_SEQ_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DATA_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DATA_DATE))::timestamp END AS DATA_DATE,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH01))::numeric(19,0) END AS DOL_MTH01,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH02))::numeric(19,0) END AS DOL_MTH02,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH03))::numeric(19,0) END AS DOL_MTH03,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH04))::numeric(19,0) END AS DOL_MTH04,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH05))::numeric(19,0) END AS DOL_MTH05,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH06))::numeric(19,0) END AS DOL_MTH06,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH07))::numeric(19,0) END AS DOL_MTH07,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH08))::numeric(19,0) END AS DOL_MTH08,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH09))::numeric(19,0) END AS DOL_MTH09,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH10))::numeric(19,0) END AS DOL_MTH10,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH11))::numeric(19,0) END AS DOL_MTH11,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH12))::numeric(19,0) END AS DOL_MTH12,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH13))::numeric(19,0) END AS DOL_MTH13,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH14))::numeric(19,0) END AS DOL_MTH14,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH15))::numeric(19,0) END AS DOL_MTH15,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH16))::numeric(19,0) END AS DOL_MTH16,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH17))::numeric(19,0) END AS DOL_MTH17,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH18))::numeric(19,0) END AS DOL_MTH18,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH19))::numeric(19,0) END AS DOL_MTH19,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH20))::numeric(19,0) END AS DOL_MTH20,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH21))::numeric(19,0) END AS DOL_MTH21,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH22))::numeric(19,0) END AS DOL_MTH22,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH23))::numeric(19,0) END AS DOL_MTH23,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.DOL_MTH24))::numeric(19,0) END AS DOL_MTH24,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_DOLLARS_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_ONC_DMD_MONTHLY_DOLLARS_src.batch_id,
        EXT_ONC_DMD_MONTHLY_DOLLARS_src.row_id,
        EXT_ONC_DMD_MONTHLY_DOLLARS_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_MONTHLY_DOLLARS_src
 WHERE (EXT_ONC_DMD_MONTHLY_DOLLARS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_MONTHLY_DOLLARS'::varchar(27))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_MONTHLY_QUANTITY AS
 SELECT btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.FILLER_01) AS FILLER_01,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.ALT_SEQ_NUM) AS ALT_SEQ_NUM,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.DATA_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.DATA_DATE))::timestamp END AS DATA_DATE,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH01))::numeric(19,0) END AS QTY_MTH01,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH02))::numeric(19,0) END AS QTY_MTH02,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH03))::numeric(19,0) END AS QTY_MTH03,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH04))::numeric(19,0) END AS QTY_MTH04,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH05))::numeric(19,0) END AS QTY_MTH05,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH06))::numeric(19,0) END AS QTY_MTH06,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH07))::numeric(19,0) END AS QTY_MTH07,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH08))::numeric(19,0) END AS QTY_MTH08,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH09))::numeric(19,0) END AS QTY_MTH09,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH10))::numeric(19,0) END AS QTY_MTH10,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH11))::numeric(19,0) END AS QTY_MTH11,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH12))::numeric(19,0) END AS QTY_MTH12,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH13))::numeric(19,0) END AS QTY_MTH13,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH14))::numeric(19,0) END AS QTY_MTH14,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH15))::numeric(19,0) END AS QTY_MTH15,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH16))::numeric(19,0) END AS QTY_MTH16,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH17))::numeric(19,0) END AS QTY_MTH17,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH18))::numeric(19,0) END AS QTY_MTH18,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH19))::numeric(19,0) END AS QTY_MTH19,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH20))::numeric(19,0) END AS QTY_MTH20,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH21))::numeric(19,0) END AS QTY_MTH21,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH22))::numeric(19,0) END AS QTY_MTH22,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH23))::numeric(19,0) END AS QTY_MTH23,
        CASE WHEN (EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.QTY_MTH24))::numeric(19,0) END AS QTY_MTH24,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_MONTHLY_QUANTITY_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_ONC_DMD_MONTHLY_QUANTITY_src.batch_id,
        EXT_ONC_DMD_MONTHLY_QUANTITY_src.row_id,
        EXT_ONC_DMD_MONTHLY_QUANTITY_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_MONTHLY_QUANTITY_src
 WHERE (EXT_ONC_DMD_MONTHLY_QUANTITY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_MONTHLY_QUANTITY'::varchar(28))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_WEEKLY_DEMO AS
 SELECT btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.IMS_FACILITY_NUMBER) AS IMS_FACILITY_NUMBER,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.IMS_PRESCRIBER_NUMBER) AS IMS_PRESCRIBER_NUMBER,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.OUTLET_ZIP) AS OUTLET_ZIP,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_NAME) AS FACILITY_PRESCRIBER_NAME,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_ADDRESS1) AS FACILITY_PRESCRIBER_ADDRESS1,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_ADDRESS2) AS FACILITY_PRESCRIBER_ADDRESS2,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_ADDRESS3) AS FACILITY_PRESCRIBER_ADDRESS3,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_ADDRESS4) AS FACILITY_PRESCRIBER_ADDRESS4,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_CITY) AS FACILITY_PRESCRIBER_CITY,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_STATE) AS FACILITY_PRESCRIBER_STATE,
        btrim(EXT_ONC_DMD_WEEKLY_DEMO_src.FACILITY_PRESCRIBER_ZIP) AS FACILITY_PRESCRIBER_ZIP,
        EXT_ONC_DMD_WEEKLY_DEMO_src.batch_id,
        EXT_ONC_DMD_WEEKLY_DEMO_src.row_id,
        EXT_ONC_DMD_WEEKLY_DEMO_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_WEEKLY_DEMO_src
 WHERE (EXT_ONC_DMD_WEEKLY_DEMO_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_WEEKLY_DEMO'::varchar(23))));

CREATE  VIEW teva_ingestion.EXT_ONC_DMD_WEEKLY_SALES AS
 SELECT btrim(EXT_ONC_DMD_WEEKLY_SALES_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.ALT_SEQ_NUM) AS ALT_SEQ_NUM,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.FILLER_01) AS FILLER_01,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.DATA_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.DATA_DATE))::timestamp END AS DATA_DATE,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK01))::numeric(19,0) END AS QTY_WK01,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK02))::numeric(19,0) END AS QTY_WK02,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK03))::numeric(19,0) END AS QTY_WK03,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK04))::numeric(19,0) END AS QTY_WK04,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK05))::numeric(19,0) END AS QTY_WK05,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK06))::numeric(19,0) END AS QTY_WK06,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK07))::numeric(19,0) END AS QTY_WK07,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK08))::numeric(19,0) END AS QTY_WK08,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK09))::numeric(19,0) END AS QTY_WK09,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK10))::numeric(19,0) END AS QTY_WK10,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK11))::numeric(19,0) END AS QTY_WK11,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK12))::numeric(19,0) END AS QTY_WK12,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK13))::numeric(19,0) END AS QTY_WK13,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK14))::numeric(19,0) END AS QTY_WK14,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK15))::numeric(19,0) END AS QTY_WK15,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK16))::numeric(19,0) END AS QTY_WK16,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK17))::numeric(19,0) END AS QTY_WK17,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK18))::numeric(19,0) END AS QTY_WK18,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK19))::numeric(19,0) END AS QTY_WK19,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK20))::numeric(19,0) END AS QTY_WK20,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK21))::numeric(19,0) END AS QTY_WK21,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK22))::numeric(19,0) END AS QTY_WK22,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK23))::numeric(19,0) END AS QTY_WK23,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK24))::numeric(19,0) END AS QTY_WK24,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK25 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK25))::numeric(19,0) END AS QTY_WK25,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK26 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK26))::numeric(19,0) END AS QTY_WK26,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK27 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK27))::numeric(19,0) END AS QTY_WK27,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK28 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK28))::numeric(19,0) END AS QTY_WK28,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK29 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK29))::numeric(19,0) END AS QTY_WK29,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK30 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK30))::numeric(19,0) END AS QTY_WK30,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK31 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK31))::numeric(19,0) END AS QTY_WK31,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK32 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK32))::numeric(19,0) END AS QTY_WK32,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK33 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK33))::numeric(19,0) END AS QTY_WK33,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK34 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK34))::numeric(19,0) END AS QTY_WK34,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK35 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK35))::numeric(19,0) END AS QTY_WK35,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK36 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK36))::numeric(19,0) END AS QTY_WK36,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK37 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK37))::numeric(19,0) END AS QTY_WK37,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK38 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK38))::numeric(19,0) END AS QTY_WK38,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK39 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK39))::numeric(19,0) END AS QTY_WK39,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK40 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK40))::numeric(19,0) END AS QTY_WK40,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK41 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK41))::numeric(19,0) END AS QTY_WK41,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK42 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK42))::numeric(19,0) END AS QTY_WK42,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK43 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK43))::numeric(19,0) END AS QTY_WK43,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK44 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK44))::numeric(19,0) END AS QTY_WK44,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK45 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK45))::numeric(19,0) END AS QTY_WK45,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK46 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK46))::numeric(19,0) END AS QTY_WK46,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK47 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK47))::numeric(19,0) END AS QTY_WK47,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK48 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK48))::numeric(19,0) END AS QTY_WK48,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK49 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK49))::numeric(19,0) END AS QTY_WK49,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK50 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK50))::numeric(19,0) END AS QTY_WK50,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK51 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK51))::numeric(19,0) END AS QTY_WK51,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK52 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK52))::numeric(19,0) END AS QTY_WK52,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK53 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK53))::numeric(19,0) END AS QTY_WK53,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK54 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK54))::numeric(19,0) END AS QTY_WK54,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK55 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK55))::numeric(19,0) END AS QTY_WK55,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK56 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK56))::numeric(19,0) END AS QTY_WK56,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK57 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK57))::numeric(19,0) END AS QTY_WK57,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK58 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK58))::numeric(19,0) END AS QTY_WK58,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK59 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK59))::numeric(19,0) END AS QTY_WK59,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK60 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK60))::numeric(19,0) END AS QTY_WK60,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK61 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK61))::numeric(19,0) END AS QTY_WK61,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK62 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK62))::numeric(19,0) END AS QTY_WK62,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK63 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK63))::numeric(19,0) END AS QTY_WK63,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK64 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK64))::numeric(19,0) END AS QTY_WK64,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK65 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK65))::numeric(19,0) END AS QTY_WK65,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK66 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK66))::numeric(19,0) END AS QTY_WK66,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK67 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK67))::numeric(19,0) END AS QTY_WK67,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK68 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK68))::numeric(19,0) END AS QTY_WK68,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK69 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK69))::numeric(19,0) END AS QTY_WK69,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK70 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK70))::numeric(19,0) END AS QTY_WK70,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK71 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK71))::numeric(19,0) END AS QTY_WK71,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK72 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK72))::numeric(19,0) END AS QTY_WK72,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK73 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK73))::numeric(19,0) END AS QTY_WK73,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK74 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK74))::numeric(19,0) END AS QTY_WK74,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK75 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK75))::numeric(19,0) END AS QTY_WK75,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK76 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK76))::numeric(19,0) END AS QTY_WK76,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK77 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK77))::numeric(19,0) END AS QTY_WK77,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK78 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK78))::numeric(19,0) END AS QTY_WK78,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK79 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK79))::numeric(19,0) END AS QTY_WK79,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK80 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK80))::numeric(19,0) END AS QTY_WK80,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK81 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK81))::numeric(19,0) END AS QTY_WK81,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK82 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK82))::numeric(19,0) END AS QTY_WK82,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK83 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK83))::numeric(19,0) END AS QTY_WK83,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK84 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK84))::numeric(19,0) END AS QTY_WK84,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK85 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK85))::numeric(19,0) END AS QTY_WK85,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK86 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK86))::numeric(19,0) END AS QTY_WK86,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK87 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK87))::numeric(19,0) END AS QTY_WK87,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK88 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK88))::numeric(19,0) END AS QTY_WK88,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK89 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK89))::numeric(19,0) END AS QTY_WK89,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK90 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK90))::numeric(19,0) END AS QTY_WK90,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK91 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK91))::numeric(19,0) END AS QTY_WK91,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK92 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK92))::numeric(19,0) END AS QTY_WK92,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK93 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK93))::numeric(19,0) END AS QTY_WK93,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK94 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK94))::numeric(19,0) END AS QTY_WK94,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK95 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK95))::numeric(19,0) END AS QTY_WK95,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK96 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK96))::numeric(19,0) END AS QTY_WK96,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK97 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK97))::numeric(19,0) END AS QTY_WK97,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK98 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK98))::numeric(19,0) END AS QTY_WK98,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK99 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK99))::numeric(19,0) END AS QTY_WK99,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK100 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK100))::numeric(19,0) END AS QTY_WK100,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK101 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK101))::numeric(19,0) END AS QTY_WK101,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK102 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK102))::numeric(19,0) END AS QTY_WK102,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK103 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK103))::numeric(19,0) END AS QTY_WK103,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK104 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK104))::numeric(19,0) END AS QTY_WK104,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK105 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK105))::numeric(19,0) END AS QTY_WK105,
        CASE WHEN (EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK106 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_ONC_DMD_WEEKLY_SALES_src.QTY_WK106))::numeric(19,0) END AS QTY_WK106,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_ONC_DMD_WEEKLY_SALES_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_ONC_DMD_WEEKLY_SALES_src.batch_id,
        EXT_ONC_DMD_WEEKLY_SALES_src.row_id,
        EXT_ONC_DMD_WEEKLY_SALES_src.update_ts
 FROM teva_ingestion.EXT_ONC_DMD_WEEKLY_SALES_src
 WHERE (EXT_ONC_DMD_WEEKLY_SALES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_DMD_WEEKLY_SALES'::varchar(24))));

CREATE  VIEW teva_ingestion.EXT_PCS_DDD_NONRETAIL AS
 SELECT btrim(EXT_PCS_DDD_NONRETAIL_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_PCS_DDD_NONRETAIL_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_PCS_DDD_NONRETAIL_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_CODE) AS OUTLET_CODE,
        btrim(EXT_PCS_DDD_NONRETAIL_src.SUBCATEGORY_CODE) AS SUBCATEGORY_CODE,
        btrim(EXT_PCS_DDD_NONRETAIL_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_PCS_DDD_NONRETAIL_src.IMS_PRODUCT_CODE) AS IMS_PRODUCT_CODE,
        btrim(EXT_PCS_DDD_NONRETAIL_src.MTH_YYYYMM) AS MTH_YYYYMM,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH01))::numeric(19,0) END AS QTY_MTH01,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH02))::numeric(19,0) END AS QTY_MTH02,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH03))::numeric(19,0) END AS QTY_MTH03,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH04))::numeric(19,0) END AS QTY_MTH04,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH05))::numeric(19,0) END AS QTY_MTH05,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH06))::numeric(19,0) END AS QTY_MTH06,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH07))::numeric(19,0) END AS QTY_MTH07,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH08))::numeric(19,0) END AS QTY_MTH08,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH09))::numeric(19,0) END AS QTY_MTH09,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH10))::numeric(19,0) END AS QTY_MTH10,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH11))::numeric(19,0) END AS QTY_MTH11,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH12))::numeric(19,0) END AS QTY_MTH12,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH13))::numeric(19,0) END AS QTY_MTH13,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH14))::numeric(19,0) END AS QTY_MTH14,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH15))::numeric(19,0) END AS QTY_MTH15,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH16))::numeric(19,0) END AS QTY_MTH16,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH17))::numeric(19,0) END AS QTY_MTH17,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH18))::numeric(19,0) END AS QTY_MTH18,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH19))::numeric(19,0) END AS QTY_MTH19,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH20))::numeric(19,0) END AS QTY_MTH20,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH21))::numeric(19,0) END AS QTY_MTH21,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH22))::numeric(19,0) END AS QTY_MTH22,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH23))::numeric(19,0) END AS QTY_MTH23,
        CASE WHEN (EXT_PCS_DDD_NONRETAIL_src.QTY_MTH24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_NONRETAIL_src.QTY_MTH24))::numeric(19,0) END AS QTY_MTH24,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_NAME) AS OUTLET_NAME,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_ADDRESS) AS OUTLET_ADDRESS,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_STATE) AS OUTLET_STATE,
        btrim(EXT_PCS_DDD_NONRETAIL_src.OUTLET_ZIP) AS OUTLET_ZIP,
        EXT_PCS_DDD_NONRETAIL_src.batch_id,
        EXT_PCS_DDD_NONRETAIL_src.row_id,
        EXT_PCS_DDD_NONRETAIL_src.update_ts
 FROM teva_ingestion.EXT_PCS_DDD_NONRETAIL_src
 WHERE (EXT_PCS_DDD_NONRETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_PCS_DDD_NONRETAIL'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_PCS_DDD_RETAIL AS
 SELECT btrim(EXT_PCS_DDD_RETAIL_src.CLIENT_NUM) AS CLIENT_NUM,
        btrim(EXT_PCS_DDD_RETAIL_src.REPORT_NUM) AS REPORT_NUM,
        btrim(EXT_PCS_DDD_RETAIL_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_PCS_DDD_RETAIL_src.OUTLET_ZIP) AS OUTLET_ZIP,
        btrim(EXT_PCS_DDD_RETAIL_src.SRA3) AS SRA3,
        btrim(EXT_PCS_DDD_RETAIL_src.SRA4) AS SRA4,
        btrim(EXT_PCS_DDD_RETAIL_src.CATEGORY_CODE) AS CATEGORY_CODE,
        btrim(EXT_PCS_DDD_RETAIL_src.PRODUCT_GROUP) AS PRODUCT_GROUP,
        btrim(EXT_PCS_DDD_RETAIL_src.MTH_YYYYMM) AS MTH_YYYYMM,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH01 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH01))::numeric(19,0) END AS QTY_MTH01,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH02 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH02))::numeric(19,0) END AS QTY_MTH02,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH03 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH03))::numeric(19,0) END AS QTY_MTH03,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH04 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH04))::numeric(19,0) END AS QTY_MTH04,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH05 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH05))::numeric(19,0) END AS QTY_MTH05,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH06 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH06))::numeric(19,0) END AS QTY_MTH06,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH07 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH07))::numeric(19,0) END AS QTY_MTH07,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH08 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH08))::numeric(19,0) END AS QTY_MTH08,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH09 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH09))::numeric(19,0) END AS QTY_MTH09,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH10 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH10))::numeric(19,0) END AS QTY_MTH10,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH11 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH11))::numeric(19,0) END AS QTY_MTH11,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH12 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH12))::numeric(19,0) END AS QTY_MTH12,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH13 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH13))::numeric(19,0) END AS QTY_MTH13,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH14 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH14))::numeric(19,0) END AS QTY_MTH14,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH15 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH15))::numeric(19,0) END AS QTY_MTH15,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH16 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH16))::numeric(19,0) END AS QTY_MTH16,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH17 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH17))::numeric(19,0) END AS QTY_MTH17,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH18 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH18))::numeric(19,0) END AS QTY_MTH18,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH19 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH19))::numeric(19,0) END AS QTY_MTH19,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH20 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH20))::numeric(19,0) END AS QTY_MTH20,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH21 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH21))::numeric(19,0) END AS QTY_MTH21,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH22 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH22))::numeric(19,0) END AS QTY_MTH22,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH23 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH23))::numeric(19,0) END AS QTY_MTH23,
        CASE WHEN (EXT_PCS_DDD_RETAIL_src.QTY_MTH24 = ''::varchar) THEN NULL::numeric(19,0) ELSE (btrim(EXT_PCS_DDD_RETAIL_src.QTY_MTH24))::numeric(19,0) END AS QTY_MTH24,
        btrim(EXT_PCS_DDD_RETAIL_src.OUTLET_CITY) AS OUTLET_CITY,
        btrim(EXT_PCS_DDD_RETAIL_src.OUTLET_STATE) AS OUTLET_STATE,
        EXT_PCS_DDD_RETAIL_src.batch_id,
        EXT_PCS_DDD_RETAIL_src.row_id,
        EXT_PCS_DDD_RETAIL_src.update_ts
 FROM teva_ingestion.EXT_PCS_DDD_RETAIL_src
 WHERE (EXT_PCS_DDD_RETAIL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_PCS_DDD_RETAIL'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_PRIME_RX AS
 SELECT btrim(EXT_PRIME_RX_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_PRIME_RX_src.MD_LAST_NAME) AS MD_LAST_NAME,
        btrim(EXT_PRIME_RX_src.MD_FIRST_NAME) AS MD_FIRST_NAME,
        btrim(EXT_PRIME_RX_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        btrim(EXT_PRIME_RX_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_PRIME_RX_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_PRIME_RX_src.MD_CITY) AS MD_CITY,
        btrim(EXT_PRIME_RX_src.MD_STATE) AS MD_STATE,
        btrim(EXT_PRIME_RX_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_PRIME_RX_src.MD_PHONE) AS MD_PHONE,
        btrim(EXT_PRIME_RX_src.SHIP_DATE) AS SHIP_DATE,
        btrim(EXT_PRIME_RX_src.NDC_NUMBER) AS NDC_NUMBER,
        btrim(EXT_PRIME_RX_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_PRIME_RX_src.FILL_NUMBER = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_PRIME_RX_src.FILL_NUMBER))::numeric(37,15) END AS FILL_NUMBER,
        CASE WHEN (EXT_PRIME_RX_src.QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_PRIME_RX_src.QTY))::numeric(37,15) END AS QTY,
        EXT_PRIME_RX_src.batch_id,
        EXT_PRIME_RX_src.row_id,
        EXT_PRIME_RX_src.update_ts
 FROM teva_ingestion.EXT_PRIME_RX_src
 WHERE (EXT_PRIME_RX_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_PRIME_RX'::varchar(12))));

CREATE  VIEW teva_ingestion.EXT_REMS_FACILITY AS
 SELECT CASE WHEN (EXT_REMS_FACILITY_src.PROGRAM_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_REMS_FACILITY_src.PROGRAM_ID))::numeric(37,15) END AS PROGRAM_ID,
        btrim(EXT_REMS_FACILITY_src.PROGRAM_NAME) AS PROGRAM_NAME,
        btrim(EXT_REMS_FACILITY_src.CHANNEL_INITIATED) AS CHANNEL_INITIATED,
        btrim(EXT_REMS_FACILITY_src.ENROLLMENT_ID) AS ENROLLMENT_ID,
        btrim(EXT_REMS_FACILITY_src.HEALTHCARE_FACILITY_TYPE) AS HEALTHCARE_FACILITY_TYPE,
        btrim(EXT_REMS_FACILITY_src.SITE_NAME) AS SITE_NAME,
        btrim(EXT_REMS_FACILITY_src.ADDRESS_1) AS ADDRESS_1,
        btrim(EXT_REMS_FACILITY_src.ADDRESS_2) AS ADDRESS_2,
        btrim(EXT_REMS_FACILITY_src.CITY) AS CITY,
        btrim(EXT_REMS_FACILITY_src.STATE) AS STATE,
        btrim(EXT_REMS_FACILITY_src.ZIP_CODE) AS ZIP_CODE,
        btrim(EXT_REMS_FACILITY_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_REMS_FACILITY_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(EXT_REMS_FACILITY_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_REMS_FACILITY_src.STATUS_DESCRIPTION) AS STATUS_DESCRIPTION,
        btrim(EXT_REMS_FACILITY_src.IN_PROGRESS_STEP) AS IN_PROGRESS_STEP,
        btrim(EXT_REMS_FACILITY_src.PHONE_NUMBER) AS PHONE_NUMBER,
        btrim(EXT_REMS_FACILITY_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(EXT_REMS_FACILITY_src.EXPIRATION_DATE) AS EXPIRATION_DATE,
        btrim(EXT_REMS_FACILITY_src.NCPDP) AS NCPDP,
        btrim(EXT_REMS_FACILITY_src.NPI) AS NPI,
        btrim(EXT_REMS_FACILITY_src.DEA) AS DEA,
        btrim(EXT_REMS_FACILITY_src.OBSOLESCENCE_DATE) AS OBSOLESCENCE_DATE,
        btrim(EXT_REMS_FACILITY_src.OBSOLESCENCE_REASON) AS OBSOLESCENCE_REASON,
        EXT_REMS_FACILITY_src.batch_id,
        EXT_REMS_FACILITY_src.row_id,
        EXT_REMS_FACILITY_src.update_ts
 FROM teva_ingestion.EXT_REMS_FACILITY_src
 WHERE (EXT_REMS_FACILITY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_REMS_FACILITY'::varchar(17))));

CREATE  VIEW teva_ingestion.EXT_REMS_PHARMACY AS
 SELECT CASE WHEN (EXT_REMS_PHARMACY_src.PROGRAM_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_REMS_PHARMACY_src.PROGRAM_ID))::numeric(37,15) END AS PROGRAM_ID,
        btrim(EXT_REMS_PHARMACY_src.PROGRAM_NAME) AS PROGRAM_NAME,
        btrim(EXT_REMS_PHARMACY_src.CHANNEL) AS CHANNEL,
        btrim(EXT_REMS_PHARMACY_src.ENROLLMENT_ID) AS ENROLLMENT_ID,
        btrim(EXT_REMS_PHARMACY_src.PHARMACY_TYPE) AS PHARMACY_TYPE,
        btrim(EXT_REMS_PHARMACY_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_REMS_PHARMACY_src.ADDRESS1) AS ADDRESS1,
        btrim(EXT_REMS_PHARMACY_src.ADDRESS2) AS ADDRESS2,
        btrim(EXT_REMS_PHARMACY_src.CITY) AS CITY,
        btrim(EXT_REMS_PHARMACY_src.STATE) AS STATE,
        btrim(EXT_REMS_PHARMACY_src.ZIP) AS ZIP,
        btrim(EXT_REMS_PHARMACY_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_REMS_PHARMACY_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(EXT_REMS_PHARMACY_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_REMS_PHARMACY_src.STATUS) AS STATUS,
        btrim(EXT_REMS_PHARMACY_src.IN_PROGRESS_STEP) AS IN_PROGRESS_STEP,
        btrim(EXT_REMS_PHARMACY_src.PHONE) AS PHONE,
        btrim(EXT_REMS_PHARMACY_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(EXT_REMS_PHARMACY_src.EXPIRATION_DATE) AS EXPIRATION_DATE,
        btrim(EXT_REMS_PHARMACY_src.NCPDP) AS NCPDP,
        btrim(EXT_REMS_PHARMACY_src.NPI) AS NPI,
        btrim(EXT_REMS_PHARMACY_src.DEA_NUM) AS DEA_NUM,
        btrim(EXT_REMS_PHARMACY_src.LICENSE_NUMBER) AS LICENSE_NUMBER,
        btrim(EXT_REMS_PHARMACY_src.OBSOLESCENCE_DATE) AS OBSOLESCENCE_DATE,
        btrim(EXT_REMS_PHARMACY_src.OBSOLESCENCE_REASON) AS OBSOLESCENCE_REASON,
        EXT_REMS_PHARMACY_src.batch_id,
        EXT_REMS_PHARMACY_src.row_id,
        EXT_REMS_PHARMACY_src.update_ts
 FROM teva_ingestion.EXT_REMS_PHARMACY_src
 WHERE (EXT_REMS_PHARMACY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_REMS_PHARMACY'::varchar(17))));

CREATE  VIEW teva_ingestion.EXT_REMS_PRESCRIBER AS
 SELECT CASE WHEN (EXT_REMS_PRESCRIBER_src.PROGRAM_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_REMS_PRESCRIBER_src.PROGRAM_ID))::numeric(37,15) END AS PROGRAM_ID,
        btrim(EXT_REMS_PRESCRIBER_src.PROGRAM_NAME) AS PROGRAM_NAME,
        btrim(EXT_REMS_PRESCRIBER_src.CHANNEL) AS CHANNEL,
        btrim(EXT_REMS_PRESCRIBER_src.ENROLLMENT_ID) AS ENROLLMENT_ID,
        btrim(EXT_REMS_PRESCRIBER_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_REMS_PRESCRIBER_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(EXT_REMS_PRESCRIBER_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_REMS_PRESCRIBER_src.CREDENTIAL) AS CREDENTIAL,
        btrim(EXT_REMS_PRESCRIBER_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_REMS_PRESCRIBER_src.SITE_NAME) AS SITE_NAME,
        btrim(EXT_REMS_PRESCRIBER_src.ADDRESS1) AS ADDRESS1,
        btrim(EXT_REMS_PRESCRIBER_src.ADDRESS2) AS ADDRESS2,
        btrim(EXT_REMS_PRESCRIBER_src.CITY) AS CITY,
        btrim(EXT_REMS_PRESCRIBER_src.STATE) AS STATE,
        btrim(EXT_REMS_PRESCRIBER_src.ZIP) AS ZIP,
        btrim(EXT_REMS_PRESCRIBER_src.STATUS) AS STATUS,
        btrim(EXT_REMS_PRESCRIBER_src.IN_PROGRESS_STEP) AS IN_PROGRESS_STEP,
        btrim(EXT_REMS_PRESCRIBER_src.PHONE) AS PHONE,
        btrim(EXT_REMS_PRESCRIBER_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(EXT_REMS_PRESCRIBER_src.EXPIRATION_DATE) AS EXPIRATION_DATE,
        btrim(EXT_REMS_PRESCRIBER_src.NPI) AS NPI,
        btrim(EXT_REMS_PRESCRIBER_src.DEA_NUM) AS DEA_NUM,
        btrim(EXT_REMS_PRESCRIBER_src.OBSOLESCENCE_DATE) AS OBSOLESCENCE_DATE,
        btrim(EXT_REMS_PRESCRIBER_src.OBSOLESCENCE_REASON) AS OBSOLESCENCE_REASON,
        CASE WHEN (EXT_REMS_PRESCRIBER_src.PPAF_COUNT = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_REMS_PRESCRIBER_src.PPAF_COUNT))::numeric(37,15) END AS PPAF_COUNT,
        EXT_REMS_PRESCRIBER_src.batch_id,
        EXT_REMS_PRESCRIBER_src.row_id,
        EXT_REMS_PRESCRIBER_src.update_ts
 FROM teva_ingestion.EXT_REMS_PRESCRIBER_src
 WHERE (EXT_REMS_PRESCRIBER_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_REMS_PRESCRIBER'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_SPECIALTY_PHARMACY_CM_LKUP AS
 SELECT btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.SOURCE_KEY) AS SOURCE_KEY,
        btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.SOURCE_NAME) AS SOURCE_NAME,
        btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.FILE_NAME) AS FILE_NAME,
        btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.ROWID_OBJECT_MATCHED) AS ROWID_OBJECT_MATCHED,
        CASE WHEN (EXT_SPECIALTY_PHARMACY_CM_LKUP_src.RULE_NO = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.RULE_NO))::numeric(37,15) END AS RULE_NO,
        btrim((EXT_SPECIALTY_PHARMACY_CM_LKUP_src.ROWID_MATCH_RULE)::varchar(14)) AS ROWID_MATCH_RULE,
        CASE WHEN (EXT_SPECIALTY_PHARMACY_CM_LKUP_src.AUTOMERGE_IND = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.AUTOMERGE_IND))::numeric(37,15) END AS AUTOMERGE_IND,
        btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.CREATOR) AS CREATOR,
        btrim(EXT_SPECIALTY_PHARMACY_CM_LKUP_src.CREATE_DATE) AS CREATE_DATE,
        EXT_SPECIALTY_PHARMACY_CM_LKUP_src.batch_id,
        EXT_SPECIALTY_PHARMACY_CM_LKUP_src.row_id,
        EXT_SPECIALTY_PHARMACY_CM_LKUP_src.update_ts
 FROM teva_ingestion.EXT_SPECIALTY_PHARMACY_CM_LKUP_src
 WHERE (EXT_SPECIALTY_PHARMACY_CM_LKUP_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_SPECIALTY_PHARMACY_CM_LKUP'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_SPECIALTY_PHARMACY_LOOKUPS AS
 SELECT btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.SOURCE_ID) AS SOURCE_ID,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.NPI) AS NPI,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.ADDRESS1) AS ADDRESS1,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.ADDRESS2) AS ADDRESS2,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.CITY) AS CITY,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.STATE) AS STATE,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.ZIP) AS ZIP,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.IMS_ID) AS IMS_ID,
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src."MATCH") AS "MATCH",
        btrim(EXT_SPECIALTY_PHARMACY_LOOKUPS_src.HCE_ID) AS HCE_ID,
        EXT_SPECIALTY_PHARMACY_LOOKUPS_src.batch_id,
        EXT_SPECIALTY_PHARMACY_LOOKUPS_src.row_id,
        EXT_SPECIALTY_PHARMACY_LOOKUPS_src.update_ts
 FROM teva_ingestion.EXT_SPECIALTY_PHARMACY_LOOKUPS_src
 WHERE (EXT_SPECIALTY_PHARMACY_LOOKUPS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_SPECIALTY_PHARMACY_LOOKUPS'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_TB_CB_TRANSACTIONS AS
 SELECT btrim(EXT_TB_CB_TRANSACTIONS_src.ACCOUNT_ID) AS ACCOUNT_ID,
        btrim(EXT_TB_CB_TRANSACTIONS_src.LOCATION_ID) AS LOCATION_ID,
        btrim(EXT_TB_CB_TRANSACTIONS_src.SHIPMENT_DATE) AS SHIPMENT_DATE,
        btrim(EXT_TB_CB_TRANSACTIONS_src.NDC_CODE) AS NDC_CODE,
        btrim(EXT_TB_CB_TRANSACTIONS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_TB_CB_TRANSACTIONS_src.CONTRACT_ID) AS CONTRACT_ID,
        CASE WHEN (EXT_TB_CB_TRANSACTIONS_src.CHARGEBACK_UNITS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TB_CB_TRANSACTIONS_src.CHARGEBACK_UNITS))::numeric(37,15) END AS CHARGEBACK_UNITS,
        CASE WHEN (EXT_TB_CB_TRANSACTIONS_src.CHARGEBACK_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TB_CB_TRANSACTIONS_src.CHARGEBACK_DOLLARS))::numeric(37,15) END AS CHARGEBACK_DOLLARS,
        btrim(EXT_TB_CB_TRANSACTIONS_src.RECEIPT_DATE) AS RECEIPT_DATE,
        btrim(EXT_TB_CB_TRANSACTIONS_src.DEBIT_MEMO_NUM) AS DEBIT_MEMO_NUM,
        btrim(EXT_TB_CB_TRANSACTIONS_src.CREDIT_MEMO_DATE) AS CREDIT_MEMO_DATE,
        btrim(EXT_TB_CB_TRANSACTIONS_src.CREDIT_MEMO_NUM) AS CREDIT_MEMO_NUM,
        btrim(EXT_TB_CB_TRANSACTIONS_src.SETTLEMENT_DATE) AS SETTLEMENT_DATE,
        CASE WHEN (EXT_TB_CB_TRANSACTIONS_src.CONTRACT_PRICE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TB_CB_TRANSACTIONS_src.CONTRACT_PRICE))::numeric(37,15) END AS CONTRACT_PRICE,
        EXT_TB_CB_TRANSACTIONS_src.batch_id,
        EXT_TB_CB_TRANSACTIONS_src.row_id,
        EXT_TB_CB_TRANSACTIONS_src.update_ts
 FROM teva_ingestion.EXT_TB_CB_TRANSACTIONS_src
 WHERE (EXT_TB_CB_TRANSACTIONS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TB_CB_TRANSACTIONS'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_TB_DS_ACCOUNTS AS
 SELECT btrim(EXT_TB_DS_ACCOUNTS_src.ACCOUNT_ID) AS ACCOUNT_ID,
        btrim(EXT_TB_DS_ACCOUNTS_src.LOCATION_ID) AS LOCATION_ID,
        btrim(EXT_TB_DS_ACCOUNTS_src.ACCOUNT_NAME) AS ACCOUNT_NAME,
        btrim(EXT_TB_DS_ACCOUNTS_src.ACCOUNT_CLASS) AS ACCOUNT_CLASS,
        btrim(EXT_TB_DS_ACCOUNTS_src.ADDRESS_1) AS ADDRESS_1,
        btrim(EXT_TB_DS_ACCOUNTS_src.ADDRESS_2) AS ADDRESS_2,
        btrim(EXT_TB_DS_ACCOUNTS_src.CITY) AS CITY,
        btrim(EXT_TB_DS_ACCOUNTS_src.STATE) AS STATE,
        btrim(EXT_TB_DS_ACCOUNTS_src.ZIP) AS ZIP,
        EXT_TB_DS_ACCOUNTS_src.batch_id,
        EXT_TB_DS_ACCOUNTS_src.row_id,
        EXT_TB_DS_ACCOUNTS_src.update_ts
 FROM teva_ingestion.EXT_TB_DS_ACCOUNTS_src
 WHERE (EXT_TB_DS_ACCOUNTS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TB_DS_ACCOUNTS'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_TB_DS_TRANSACTIONS AS
 SELECT btrim(EXT_TB_DS_TRANSACTIONS_src.ACCOUNT_ID) AS ACCOUNT_ID,
        btrim(EXT_TB_DS_TRANSACTIONS_src.LOCATION_ID) AS LOCATION_ID,
        btrim(EXT_TB_DS_TRANSACTIONS_src.SHIPMENT_DATE) AS SHIPMENT_DATE,
        btrim(EXT_TB_DS_TRANSACTIONS_src.NDC_CODE) AS NDC_CODE,
        btrim(EXT_TB_DS_TRANSACTIONS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_TB_DS_TRANSACTIONS_src.TRANSACTION_TYPE) AS TRANSACTION_TYPE,
        CASE WHEN (EXT_TB_DS_TRANSACTIONS_src.DIRECT_SALES_UNITS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TB_DS_TRANSACTIONS_src.DIRECT_SALES_UNITS))::numeric(37,15) END AS DIRECT_SALES_UNITS,
        CASE WHEN (EXT_TB_DS_TRANSACTIONS_src.DIRECT_SALES_DOLLARS = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TB_DS_TRANSACTIONS_src.DIRECT_SALES_DOLLARS))::numeric(37,15) END AS DIRECT_SALES_DOLLARS,
        EXT_TB_DS_TRANSACTIONS_src.batch_id,
        EXT_TB_DS_TRANSACTIONS_src.row_id,
        EXT_TB_DS_TRANSACTIONS_src.update_ts
 FROM teva_ingestion.EXT_TB_DS_TRANSACTIONS_src
 WHERE (EXT_TB_DS_TRANSACTIONS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TB_DS_TRANSACTIONS'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_TIME_OFF_TERRITORY_VOD__C AS
 SELECT btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.DATE_VOD__C) AS DATE_VOD__C,
        CASE WHEN (EXT_TIME_OFF_TERRITORY_VOD__C_src.HOURS_OFF_VOD__C = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.HOURS_OFF_VOD__C))::numeric(3,0) END AS HOURS_OFF_VOD__C,
        CASE WHEN (EXT_TIME_OFF_TERRITORY_VOD__C_src.HOURS_VOD__C = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.HOURS_VOD__C))::numeric(3,0) END AS HOURS_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.ID) AS ID,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.LASTACTIVITYDATE) AS LASTACTIVITYDATE,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.NAME) AS NAME,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.REASON_VOD__C) AS REASON_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.START_TIME_VOD__C) AS START_TIME_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.STATUS_VOD__C) AS STATUS_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.TERRITORY_VOD__C) AS TERRITORY_VOD__C,
        btrim(EXT_TIME_OFF_TERRITORY_VOD__C_src.TIME_VOD__C) AS TIME_VOD__C,
        EXT_TIME_OFF_TERRITORY_VOD__C_src.batch_id,
        EXT_TIME_OFF_TERRITORY_VOD__C_src.row_id,
        EXT_TIME_OFF_TERRITORY_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_TIME_OFF_TERRITORY_VOD__C_src
 WHERE (EXT_TIME_OFF_TERRITORY_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TIME_OFF_TERRITORY_VOD__C'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_TOUCHPOINT_CALL AS
 SELECT CASE WHEN (EXT_TOUCHPOINT_CALL_src.CALL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_CALL_src.CALL_ID))::numeric(37,15) END AS CALL_ID,
        CASE WHEN (EXT_TOUCHPOINT_CALL_src.CALL_ATTEMPT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_CALL_src.CALL_ATTEMPT_ID))::numeric(37,15) END AS CALL_ATTEMPT_ID,
        CASE WHEN (EXT_TOUCHPOINT_CALL_src.TOUCHPOINT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_CALL_src.TOUCHPOINT_ID))::numeric(37,15) END AS TOUCHPOINT_ID,
        btrim(EXT_TOUCHPOINT_CALL_src.CLIENT_ID) AS CLIENT_ID,
        btrim(EXT_TOUCHPOINT_CALL_src.IMS_ID) AS IMS_ID,
        btrim(EXT_TOUCHPOINT_CALL_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_TOUCHPOINT_CALL_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_TOUCHPOINT_CALL_src.CALL_TYPE) AS CALL_TYPE,
        CASE WHEN (EXT_TOUCHPOINT_CALL_src.CALL_DATE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_CALL_src.CALL_DATE))::numeric(37,15) END AS CALL_DATE,
        btrim(EXT_TOUCHPOINT_CALL_src.STATUS_CODE) AS STATUS_CODE,
        btrim(EXT_TOUCHPOINT_CALL_src.STATUS_DESCRIPTION) AS STATUS_DESCRIPTION,
        CASE WHEN (EXT_TOUCHPOINT_CALL_src.REP_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_CALL_src.REP_ID))::numeric(37,15) END AS REP_ID,
        btrim(EXT_TOUCHPOINT_CALL_src.REP_FIRST_NAME) AS REP_FIRST_NAME,
        btrim(EXT_TOUCHPOINT_CALL_src.REP_LAST_NAME) AS REP_LAST_NAME,
        EXT_TOUCHPOINT_CALL_src.batch_id,
        EXT_TOUCHPOINT_CALL_src.row_id,
        EXT_TOUCHPOINT_CALL_src.update_ts
 FROM teva_ingestion.EXT_TOUCHPOINT_CALL_src
 WHERE (EXT_TOUCHPOINT_CALL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TOUCHPOINT_CALL'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_TOUCHPOINT_PRESENTATION AS
 SELECT CASE WHEN (EXT_TOUCHPOINT_PRESENTATION_src.CALL_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_PRESENTATION_src.CALL_ID))::numeric(37,15) END AS CALL_ID,
        CASE WHEN (EXT_TOUCHPOINT_PRESENTATION_src.CALL_ATTEMPT_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_PRESENTATION_src.CALL_ATTEMPT_ID))::numeric(37,15) END AS CALL_ATTEMPT_ID,
        CASE WHEN (EXT_TOUCHPOINT_PRESENTATION_src.PRESENTATION_ID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_PRESENTATION_src.PRESENTATION_ID))::numeric(37,15) END AS PRESENTATION_ID,
        btrim(EXT_TOUCHPOINT_PRESENTATION_src.PRODUCT) AS PRODUCT,
        CASE WHEN (EXT_TOUCHPOINT_PRESENTATION_src."POSITION" = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_PRESENTATION_src."POSITION"))::numeric(37,15) END AS "POSITION",
        btrim(EXT_TOUCHPOINT_PRESENTATION_src.ITEM_TYPE) AS ITEM_TYPE,
        btrim(EXT_TOUCHPOINT_PRESENTATION_src.ITEM_DESCRIPTION) AS ITEM_DESCRIPTION,
        CASE WHEN (EXT_TOUCHPOINT_PRESENTATION_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TOUCHPOINT_PRESENTATION_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        EXT_TOUCHPOINT_PRESENTATION_src.batch_id,
        EXT_TOUCHPOINT_PRESENTATION_src.row_id,
        EXT_TOUCHPOINT_PRESENTATION_src.update_ts
 FROM teva_ingestion.EXT_TOUCHPOINT_PRESENTATION_src
 WHERE (EXT_TOUCHPOINT_PRESENTATION_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TOUCHPOINT_PRESENTATION'::varchar(27))));

CREATE  VIEW teva_ingestion.ext_tw_biologics_sales AS
 SELECT btrim(EXT_TW_BIOLOGICS_SALES_src.MRN) AS MRN,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ORDER_NO) AS ORDER_NO,
        btrim(EXT_TW_BIOLOGICS_SALES_src.REFERRAL_DATE) AS REFERRAL_DATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.REFERRAL_SOURCE) AS REFERRAL_SOURCE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.REFERRAL_METHOD) AS REFERRAL_METHOD,
        btrim(EXT_TW_BIOLOGICS_SALES_src.REFERRAL_TYPE) AS REFERRAL_TYPE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PATIENT_AUTH) AS PATIENT_AUTH,
        btrim(EXT_TW_BIOLOGICS_SALES_src.STATUS) AS STATUS,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PLACEMENT_DATE) AS PLACEMENT_DATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.BILLING_METHOD) AS BILLING_METHOD,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ICD_9) AS ICD_9,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_FIRST_NAME) AS PHY_FIRST_NAME,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_LAST_NAME) AS PHY_LAST_NAME,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PRACTICE_NAME) AS PRACTICE_NAME,
        btrim(EXT_TW_BIOLOGICS_SALES_src.NPI) AS NPI,
        btrim(EXT_TW_BIOLOGICS_SALES_src.TAX_ID) AS TAX_ID,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_NETWORK_STATUS) AS PHY_NETWORK_STATUS,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_STREET) AS PHY_STREET,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_CITY) AS PHY_CITY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_STATE) AS PHY_STATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_ZIP) AS PHY_ZIP,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_PHONE) AS PHY_PHONE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHY_FAX) AS PHY_FAX,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR) AS PAYOR,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR_TYPE) AS PAYOR_TYPE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR_PHONE) AS PAYOR_PHONE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR_CONTACT) AS PAYOR_CONTACT,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR_REFERENCE) AS PAYOR_REFERENCE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.BENEFIT_TYPE) AS BENEFIT_TYPE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PAYOR_RANK) AS PAYOR_RANK,
        btrim(EXT_TW_BIOLOGICS_SALES_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.DEDUCTIBLE) AS DEDUCTIBLE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.DEDUCTIBLE_MET) AS DEDUCTIBLE_MET,
        btrim(EXT_TW_BIOLOGICS_SALES_src.AMOUNT_MET) AS AMOUNT_MET,
        btrim(EXT_TW_BIOLOGICS_SALES_src.OOP_MAX) AS OOP_MAX,
        btrim(EXT_TW_BIOLOGICS_SALES_src.OOP_MET) AS OOP_MET,
        btrim(EXT_TW_BIOLOGICS_SALES_src.LIFETIME_MAX) AS LIFETIME_MAX,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ANNUAL_BENEFIT_CAP) AS ANNUAL_BENEFIT_CAP,
        btrim(EXT_TW_BIOLOGICS_SALES_src.LIMITATIONS_RESTRICTIONS) AS LIMITATIONS_RESTRICTIONS,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ASSIGNMENT_ALLOWED) AS ASSIGNMENT_ALLOWED,
        btrim(EXT_TW_BIOLOGICS_SALES_src.CO_INSURANCE) AS CO_INSURANCE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.COPAY) AS COPAY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.OFFICE_VISIT_COPAY) AS OFFICE_VISIT_COPAY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.FOLLOW_UP_COVERAGE) AS FOLLOW_UP_COVERAGE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.FOLLOW_UP_COPAY) AS FOLLOW_UP_COPAY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.J7300_COVERAGE_STATUS) AS J7300_COVERAGE_STATUS,
        btrim(EXT_TW_BIOLOGICS_SALES_src.J7300_COVERAGE_TYPE) AS J7300_COVERAGE_TYPE,
        btrim(EXT_TW_BIOLOGICS_SALES_src."58300_COVERAGE_STATUS") AS "58300_COVERAGE_STATUS",
        btrim(EXT_TW_BIOLOGICS_SALES_src."58300_COVERAGE_TYPE") AS "58300_COVERAGE_TYPE",
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_REQUIRED) AS PA_REQUIRED,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_TYPE) AS PA_TYPE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_CONTACT) AS PA_CONTACT,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_PHONE) AS PA_PHONE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_FAX) AS PA_FAX,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PA_TAT) AS PA_TAT,
        btrim(EXT_TW_BIOLOGICS_SALES_src.J7300_REIMBURSEMENT) AS J7300_REIMBURSEMENT,
        btrim(EXT_TW_BIOLOGICS_SALES_src."58300_INSERTION") AS "58300_INSERTION",
        btrim(EXT_TW_BIOLOGICS_SALES_src.PBM) AS PBM,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PBM_PHONE) AS PBM_PHONE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PREFERRED_PHARMACY) AS PREFERRED_PHARMACY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PHARMACY_FAX) AS PHARMACY_FAX,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SP_COPAY) AS SP_COPAY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SP_NAME) AS SP_NAME,
        btrim(EXT_TW_BIOLOGICS_SALES_src.TRIAGE_DATE) AS TRIAGE_DATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.INVOICE_NUMBER) AS INVOICE_NUMBER,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SP_SHIP_DATE) AS SP_SHIP_DATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_NAME) AS SHIP_TO_NAME,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_ADDRESS_1) AS SHIP_TO_ADDRESS_1,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_ADDRESS_2) AS SHIP_TO_ADDRESS_2,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_CITY) AS SHIP_TO_CITY,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_STATE) AS SHIP_TO_STATE,
        btrim(EXT_TW_BIOLOGICS_SALES_src.SHIP_TO_ZIP) AS SHIP_TO_ZIP,
        btrim(EXT_TW_BIOLOGICS_SALES_src.CALL_DATE_1) AS CALL_DATE_1,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PT_REACHED_1) AS PT_REACHED_1,
        btrim(EXT_TW_BIOLOGICS_SALES_src.WHO_WAS_REACHED_1) AS WHO_WAS_REACHED_1,
        btrim(EXT_TW_BIOLOGICS_SALES_src.CALL_DATE_2) AS CALL_DATE_2,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PT_REACHED_2) AS PT_REACHED_2,
        btrim(EXT_TW_BIOLOGICS_SALES_src.WHO_WAS_REACHED_2) AS WHO_WAS_REACHED_2,
        btrim(EXT_TW_BIOLOGICS_SALES_src.CALL_DATE_3) AS CALL_DATE_3,
        btrim(EXT_TW_BIOLOGICS_SALES_src.PT_REACHED_3) AS PT_REACHED_3,
        btrim(EXT_TW_BIOLOGICS_SALES_src.WHO_WAS_REACHED_3) AS WHO_WAS_REACHED_3,
        btrim(EXT_TW_BIOLOGICS_SALES_src.KEEPING_APPT) AS KEEPING_APPT,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ALTERNATE_METHOD) AS ALTERNATE_METHOD,
        btrim(EXT_TW_BIOLOGICS_SALES_src.ADDITIONAL_QUESTIONS) AS ADDITIONAL_QUESTIONS,
        btrim(EXT_TW_BIOLOGICS_SALES_src.TRANSFERRED) AS TRANSFERRED,
        btrim(EXT_TW_BIOLOGICS_SALES_src.TRANSFER_DESTINATION) AS TRANSFER_DESTINATION,
        btrim(EXT_TW_BIOLOGICS_SALES_src.DISCHARGE_REASON) AS DISCHARGE_REASON,
        EXT_TW_BIOLOGICS_SALES_src.batch_id,
        EXT_TW_BIOLOGICS_SALES_src.row_id,
        EXT_TW_BIOLOGICS_SALES_src.update_ts
 FROM teva_ingestion.EXT_TW_BIOLOGICS_SALES_src
 WHERE (EXT_TW_BIOLOGICS_SALES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TW_BIOLOGICS_SALES'::varchar(22))));

CREATE  VIEW teva_ingestion.ext_tw_hd_smith_sales AS
 SELECT btrim(EXT_TW_HD_SMITH_SALES_src.MONTH) AS MONTH,
        btrim(EXT_TW_HD_SMITH_SALES_src.ORDER_DATE) AS ORDER_DATE,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_DATE) AS SHIP_DATE,
        btrim(EXT_TW_HD_SMITH_SALES_src.ORDER_NUM) AS ORDER_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.INVOICE_NUM) AS INVOICE_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.ORDER_TYPE) AS ORDER_TYPE,
        btrim(EXT_TW_HD_SMITH_SALES_src.ORDER_CATEGORY) AS ORDER_CATEGORY,
        btrim(EXT_TW_HD_SMITH_SALES_src.RETURN_FLAG) AS RETURN_FLAG,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_CUSTOMER_NUM) AS SHIP_TO_CUSTOMER_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_CUSTOMER_NAME) AS SHIP_TO_CUSTOMER_NAME,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_ADDRESS_1) AS SHIP_TO_ADDRESS_1,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_ADDRESS_2) AS SHIP_TO_ADDRESS_2,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_CITY) AS SHIP_TO_CITY,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_STATE) AS SHIP_TO_STATE,
        btrim(EXT_TW_HD_SMITH_SALES_src.SHIP_TO_ZIP) AS SHIP_TO_ZIP,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_CUSTOMER_NUM) AS BILL_TO_CUSTOMER_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_CUSTOMER_NAME) AS BILL_TO_CUSTOMER_NAME,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_ADDRESS_1) AS BILL_TO_ADDRESS_1,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_ADDRESS_2) AS BILL_TO_ADDRESS_2,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_CITY) AS BILL_TO_CITY,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_STATE) AS BILL_TO_STATE,
        btrim(EXT_TW_HD_SMITH_SALES_src.BILL_TO_ZIP) AS BILL_TO_ZIP,
        btrim(EXT_TW_HD_SMITH_SALES_src.CLASS_OF_TRADE) AS CLASS_OF_TRADE,
        btrim(EXT_TW_HD_SMITH_SALES_src.CUSTOMER_DEA_NUM) AS CUSTOMER_DEA_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.CUSTOMER_340B_NUM) AS CUSTOMER_340B_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.HEALTH_INDUSTRY_NUM) AS HEALTH_INDUSTRY_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.STATE_LICENSE_NUM) AS STATE_LICENSE_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.PLANT) AS PLANT,
        btrim(EXT_TW_HD_SMITH_SALES_src.VENDOR) AS VENDOR,
        btrim(EXT_TW_HD_SMITH_SALES_src.MATERIAL_NUM) AS MATERIAL_NUM,
        btrim(EXT_TW_HD_SMITH_SALES_src.MATERIAL_DESC) AS MATERIAL_DESC,
        CASE WHEN (EXT_TW_HD_SMITH_SALES_src.PACK_SIZE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TW_HD_SMITH_SALES_src.PACK_SIZE))::numeric(37,15) END AS PACK_SIZE,
        btrim(EXT_TW_HD_SMITH_SALES_src.NDC) AS NDC,
        btrim(EXT_TW_HD_SMITH_SALES_src.CONTRACT_NUM) AS CONTRACT_NUM,
        CASE WHEN (EXT_TW_HD_SMITH_SALES_src.QUANTITY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TW_HD_SMITH_SALES_src.QUANTITY))::numeric(37,15) END AS QUANTITY,
        CASE WHEN (EXT_TW_HD_SMITH_SALES_src.VALUE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_TW_HD_SMITH_SALES_src.VALUE))::numeric(37,15) END AS VALUE,
        EXT_TW_HD_SMITH_SALES_src.batch_id,
        EXT_TW_HD_SMITH_SALES_src.row_id,
        EXT_TW_HD_SMITH_SALES_src.update_ts
 FROM teva_ingestion.EXT_TW_HD_SMITH_SALES_src
 WHERE (EXT_TW_HD_SMITH_SALES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TW_HD_SMITH_SALES'::varchar(21))));

CREATE  VIEW teva_ingestion.job_title_defs AS
 SELECT btrim(job_title_defs_src.JOB_CD) AS JOB_CD,
        btrim(job_title_defs_src.CD_DESC) AS CD_DESC,
        btrim(job_title_defs_src.ADP_JOB_CD) AS ADP_JOB_CD,
        CASE WHEN (job_title_defs_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(job_title_defs_src.CRT_DT))::date END AS CRT_DT,
        btrim(job_title_defs_src.CRT_USER) AS CRT_USER,
        CASE WHEN (job_title_defs_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(job_title_defs_src.UPD_DT))::date END AS UPD_DT,
        btrim(job_title_defs_src.UPD_USER) AS UPD_USER,
        CASE WHEN (job_title_defs_src.DISPLAY_SEQ = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(job_title_defs_src.DISPLAY_SEQ))::numeric(4,0) END AS DISPLAY_SEQ,
        btrim(job_title_defs_src.COMPANY_ID) AS COMPANY_ID,
        CASE WHEN (job_title_defs_src.EFF_DT = ''::varchar) THEN NULL::date ELSE (btrim(job_title_defs_src.EFF_DT))::date END AS EFF_DT,
        CASE WHEN (job_title_defs_src.EXP_DT = ''::varchar) THEN NULL::date ELSE (btrim(job_title_defs_src.EXP_DT))::date END AS EXP_DT,
        job_title_defs_src.batch_id,
        job_title_defs_src.row_id,
        job_title_defs_src.update_ts
 FROM teva_ingestion.job_title_defs_src
 WHERE (job_title_defs_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'JOB_TITLE_DEFS'::varchar(14))));

CREATE  VIEW teva_ingestion.people AS
 SELECT CASE WHEN (people_src.SYS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_src.SYS_ID))::numeric(38,0) END AS SYS_ID,
        CASE WHEN (people_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(people_src.CRT_DT))::date END AS CRT_DT,
        btrim(people_src.CRT_USER) AS CRT_USER,
        CASE WHEN (people_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(people_src.UPD_DT))::date END AS UPD_DT,
        btrim(people_src.UPD_USER) AS UPD_USER,
        btrim(people_src.LAST_NAME) AS LAST_NAME,
        btrim(people_src.FIRST_NAME) AS FIRST_NAME,
        btrim(people_src.STAT_CD) AS STAT_CD,
        btrim(people_src.GENDER) AS GENDER,
        btrim(people_src.MID_NAME) AS MID_NAME,
        btrim(people_src.NAME_SUFFIX) AS NAME_SUFFIX,
        btrim(people_src.PRSN_TITLE) AS PRSN_TITLE,
        btrim(people_src.PROF_TITLE) AS PROF_TITLE,
        btrim(people_src.EMAIL) AS EMAIL,
        btrim(people_src.PREF_NAME) AS PREF_NAME,
        btrim(people_src.PREV_LAST_NAME) AS PREV_LAST_NAME,
        people_src.batch_id,
        people_src.row_id,
        people_src.update_ts
 FROM teva_ingestion.people_src
 WHERE (people_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'PEOPLE'::varchar(6))));

CREATE  VIEW teva_ingestion.people_addresses AS
 SELECT CASE WHEN (people_addresses_src.PRSN_SYS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_addresses_src.PRSN_SYS_ID))::numeric(38,0) END AS PRSN_SYS_ID,
        CASE WHEN (people_addresses_src.ADDR_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_addresses_src.ADDR_ID))::numeric(38,0) END AS ADDR_ID,
        btrim(people_addresses_src.ATD_CD) AS ATD_CD,
        CASE WHEN (people_addresses_src.PRIORITY = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_addresses_src.PRIORITY))::numeric(38,0) END AS PRIORITY,
        btrim(people_addresses_src.MAIL_STOP) AS MAIL_STOP,
        CASE WHEN (people_addresses_src.EFF_DT = ''::varchar) THEN NULL::date ELSE (btrim(people_addresses_src.EFF_DT))::date END AS EFF_DT,
        CASE WHEN (people_addresses_src.END_DT = ''::varchar) THEN NULL::date ELSE (btrim(people_addresses_src.END_DT))::date END AS END_DT,
        people_addresses_src.batch_id,
        people_addresses_src.row_id,
        people_addresses_src.update_ts
 FROM teva_ingestion.people_addresses_src
 WHERE (people_addresses_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'PEOPLE_ADDRESSES'::varchar(16))));

CREATE  VIEW teva_ingestion.people_phones AS
 SELECT CASE WHEN (people_phones_src.PRSN_SYS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.PRSN_SYS_ID))::numeric(38,0) END AS PRSN_SYS_ID,
        CASE WHEN (people_phones_src.PHN_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.PHN_ID))::numeric(38,0) END AS PHN_ID,
        btrim(people_phones_src.PTD_CD) AS PTD_CD,
        CASE WHEN (people_phones_src.PRIORITY = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.PRIORITY))::numeric(38,0) END AS PRIORITY,
        CASE WHEN (people_phones_src.EXT = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.EXT))::numeric(38,0) END AS EXT,
        CASE WHEN (people_phones_src.VMAIL = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.VMAIL))::numeric(38,0) END AS VMAIL,
        CASE WHEN (people_phones_src.ADDR_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(people_phones_src.ADDR_ID))::numeric(38,0) END AS ADDR_ID,
        btrim(people_phones_src.PRVDR_CD) AS PRVDR_CD,
        people_phones_src.batch_id,
        people_phones_src.row_id,
        people_phones_src.update_ts
 FROM teva_ingestion.people_phones_src
 WHERE (people_phones_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'PEOPLE_PHONES'::varchar(13))));

CREATE  VIEW teva_ingestion.phones AS
 SELECT CASE WHEN (phones_src.PHN_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(phones_src.PHN_ID))::numeric(38,0) END AS PHN_ID,
        CASE WHEN (phones_src.CNTRY_DIAL_CD = ''::varchar) THEN NULL::numeric(3,0) ELSE (btrim(phones_src.CNTRY_DIAL_CD))::numeric(3,0) END AS CNTRY_DIAL_CD,
        btrim(phones_src.AREA_CD) AS AREA_CD,
        CASE WHEN (phones_src.PHN_NUMBER = ''::varchar) THEN NULL::numeric(20,0) ELSE (btrim(phones_src.PHN_NUMBER))::numeric(20,0) END AS PHN_NUMBER,
        btrim(phones_src.CRT_USER) AS CRT_USER,
        CASE WHEN (phones_src.CRT_DT = ''::varchar) THEN NULL::date ELSE (btrim(phones_src.CRT_DT))::date END AS CRT_DT,
        btrim(phones_src.UPD_USER) AS UPD_USER,
        CASE WHEN (phones_src.UPD_DT = ''::varchar) THEN NULL::date ELSE (btrim(phones_src.UPD_DT))::date END AS UPD_DT,
        phones_src.batch_id,
        phones_src.row_id,
        phones_src.update_ts
 FROM teva_ingestion.phones_src
 WHERE (phones_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'PHONES'::varchar(6))));

CREATE  VIEW teva_ingestion.territories AS
 SELECT btrim(territories_src.TERR_ID) AS TERR_ID,
        btrim(territories_src.NAME) AS NAME,
        btrim(territories_src.DESC_TEXT) AS DESC_TEXT,
        btrim(territories_src.COMPANY_CD) AS COMPANY_CD,
        btrim(territories_src.TERR_TYPE) AS TERR_TYPE,
        btrim(territories_src.TEAM) AS TEAM,
        btrim(territories_src.SAMPLE_DIST) AS SAMPLE_DIST,
        btrim(territories_src.COMMENTS) AS COMMENTS,
        btrim(territories_src.FLEET_ELIG) AS FLEET_ELIG,
        btrim(territories_src.REP_TYPE) AS REP_TYPE,
        territories_src.batch_id,
        territories_src.row_id,
        territories_src.update_ts
 FROM teva_ingestion.territories_src
 WHERE (territories_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'TERRITORIES'::varchar(11))));

CREATE  VIEW teva_ingestion.tvcmid_hco_demo AS
 SELECT CASE WHEN (tvcmid_hco_demo_src.TVCMID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_hco_demo_src.TVCMID))::numeric(38,0) END AS TVCMID,
        btrim(tvcmid_hco_demo_src.IMS_ORG_ID) AS IMS_ORG_ID,
        btrim(tvcmid_hco_demo_src.NPI) AS NPI,
        btrim(tvcmid_hco_demo_src.HIN) AS HIN,
        btrim(tvcmid_hco_demo_src.IMS_OUTLET_CODE) AS IMS_OUTLET_CODE,
        btrim(tvcmid_hco_demo_src.BUSINESS_NAME) AS BUSINESS_NAME,
        btrim(tvcmid_hco_demo_src.ADDRESS_LINE1) AS ADDRESS_LINE1,
        btrim(tvcmid_hco_demo_src.ADDRESS_LINE2) AS ADDRESS_LINE2,
        btrim(tvcmid_hco_demo_src.CITY) AS CITY,
        btrim(tvcmid_hco_demo_src.STATE) AS STATE,
        btrim(tvcmid_hco_demo_src.ZIP) AS ZIP,
        btrim((tvcmid_hco_demo_src.C_BO_HCE_ADDRESS__ADDRESS_ID)::varchar(14)) AS C_BO_HCE_ADDRESS__ADDRESS_ID,
        btrim(tvcmid_hco_demo_src.COT_CLASSIFICATION) AS COT_CLASSIFICATION,
        btrim(tvcmid_hco_demo_src.COT_FACILITY_TYPE) AS COT_FACILITY_TYPE,
        btrim(tvcmid_hco_demo_src.COT_SPECIALTY) AS COT_SPECIALTY,
        tvcmid_hco_demo_src.batch_id,
        tvcmid_hco_demo_src.row_id,
        tvcmid_hco_demo_src.update_ts
 FROM teva_ingestion.tvcmid_hco_demo_src
 WHERE (tvcmid_hco_demo_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'TVCMID_HCO_DEMO'::varchar(15))));

CREATE  VIEW teva_ingestion.tvcmid_merges AS
 SELECT CASE WHEN (tvcmid_merges_src.PREVIOUS_TVCMID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_merges_src.PREVIOUS_TVCMID))::numeric(38,0) END AS PREVIOUS_TVCMID,
        CASE WHEN (tvcmid_merges_src.CURRENT_TVCMID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_merges_src.CURRENT_TVCMID))::numeric(38,0) END AS CURRENT_TVCMID,
        btrim((tvcmid_merges_src.MERGE_CYCLE)::varchar(1)) AS MERGE_CYCLE,
        tvcmid_merges_src.batch_id,
        tvcmid_merges_src.row_id,
        tvcmid_merges_src.update_ts
 FROM teva_ingestion.tvcmid_merges_src
 WHERE (tvcmid_merges_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'TVCMID_MERGES'::varchar(13))));

CREATE  VIEW teva_ingestion.tvcmid_xref AS
 SELECT CASE WHEN (tvcmid_xref_src.TVCMID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_xref_src.TVCMID))::numeric(38,0) END AS TVCMID,
        btrim(tvcmid_xref_src.ID_NUM) AS ID_NUM,
        btrim(tvcmid_xref_src.ID_TYPE) AS ID_TYPE,
        btrim(tvcmid_xref_src.STATE) AS STATE,
        CASE WHEN (tvcmid_xref_src.EXPIRATION_DATE = ''::varchar) THEN NULL::date ELSE (btrim(tvcmid_xref_src.EXPIRATION_DATE))::date END AS EXPIRATION_DATE,
        tvcmid_xref_src.batch_id,
        tvcmid_xref_src.row_id,
        tvcmid_xref_src.update_ts
 FROM teva_ingestion.tvcmid_xref_src
 WHERE (tvcmid_xref_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'TVCMID_XREF'::varchar(11))));

CREATE  VIEW teva_ingestion.XX_SALES_LOA_MV AS
 SELECT btrim(XX_SALES_LOA_MV_src.FILE_NBR) AS FILE_NBR,
        btrim(XX_SALES_LOA_MV_src.NAME) AS NAME,
        btrim(XX_SALES_LOA_MV_src.JOB_TITLE) AS JOB_TITLE,
        btrim(XX_SALES_LOA_MV_src.COST_CENTER_NAME) AS COST_CENTER_NAME,
        btrim(XX_SALES_LOA_MV_src.DEPARTMENT) AS DEPARTMENT,
        btrim(XX_SALES_LOA_MV_src.EE_STATUS) AS EE_STATUS,
        btrim(XX_SALES_LOA_MV_src.LEAVE_DT) AS LEAVE_DT,
        btrim(XX_SALES_LOA_MV_src.RETURN_DT) AS RETURN_DT,
        CASE WHEN (XX_SALES_LOA_MV_src.LEAVE_DAYS = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(XX_SALES_LOA_MV_src.LEAVE_DAYS))::numeric(38,0) END AS LEAVE_DAYS,
        XX_SALES_LOA_MV_src.batch_id,
        XX_SALES_LOA_MV_src.row_id,
        XX_SALES_LOA_MV_src.update_ts
 FROM teva_ingestion.XX_SALES_LOA_MV_src
 WHERE (XX_SALES_LOA_MV_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'XX_SALES_LOA_MV'::varchar(15))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_paragard_anda_sales AS
SELECT ('A'::varchar(1) || btrim(to_char(STG_TW_ANDA_SALES.CUSTOMER_NO, '000000000'::varchar(9)))) AS BP_CODE, NULL AS ORTHO_E, STG_TW_ANDA_SALES.CUSTOMER AS BP_NAME, coalesce(STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE2, STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE1) AS SHIP_TO_ADDRESS, STG_TW_ANDA_SALES.CITY AS SHIP_TO_CITY, STG_TW_ANDA_SALES.STATE AS SHIP_TO_STATE, STG_TW_ANDA_SALES.ZIP AS SHIP_TO_ZIP_CODE, NULL AS SHIP_TO_COUNTRY, NULL AS SHIP_TO_PHONE, NULL AS SHIP_TO_FAX, NULL AS SHIP_TO_EMAIL, coalesce(STG_TW_ANDA_SALES.BILL_ADDRESS_LINE2, STG_TW_ANDA_SALES.BILL_ADDRESS_LINE1) AS BILL_TO_ADDRESS, STG_TW_ANDA_SALES.BILL_CITY AS BILL_TO_CITY, STG_TW_ANDA_SALES.BILL_STATE AS BILL_TO_STATE, STG_TW_ANDA_SALES.BILL_ZIP AS BILL_TO_ZIP_CODE, NULL AS BILL_TO_COUNTRY, NULL AS BILL_TO_PHONE, NULL AS BILL_TO_FAX, NULL AS BILL_TO_EMAIL, CASE mod(STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD)::varchar, '0'::varchar(1)) END AS CLASS_OF_TRADE, CASE mod(STG_TW_ANDA_SALES.ORDER_NO, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.ORDER_NO)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.ORDER_NO)::varchar, '0'::varchar(1)) END AS INVOICE_NUM, CASE mod(STG_TW_ANDA_SALES.NET_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.NET_COST)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.NET_COST)::varchar, '0'::varchar(1)) END AS DEL_AMT, to_char(to_date(STG_TW_ANDA_SALES.SALES_DATE, 'MM/DD/YY'::varchar(8)), 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, CASE mod(STG_TW_ANDA_SALES.UNITS_NET, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.UNITS_NET)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.UNITS_NET)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(STG_TW_ANDA_SALES.PACKAGE_SIZE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.PACKAGE_SIZE)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.PACKAGE_SIZE)::varchar, '0'::varchar(1)) END AS PACKS, NULL AS UNIT_PRICE, NULL AS TERRITORY, NULL AS ORDER_TYPE_CODE, NULL AS ORDER_TYPE_DESC, NULL AS LOB_CODE_DESC, NULL AS PRICE_MATRIX_DEF, ('A'::varchar(1) || btrim(to_char(STG_TW_ANDA_SALES.BILL_CUSTOMER_NO, '000000000'::varchar(9)))) AS PARENT_BP_CODE, NULL AS PARENT_BP_DESC, NULL AS GRAND_PARENT_BP_DESC, NULL AS PO_NUMBER, NULL AS UPS_NUMBER, CASE mod(STG_TW_ANDA_SALES.ORDER_NO, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.ORDER_NO)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.ORDER_NO)::varchar, '0'::varchar(1)) END AS ORDER_NUMBER, NULL AS ORDER_LINE_NUMBER, NULL AS DISC_AMT, NULL AS WHSE_CD FROM WSMP_ADMIN.STG_TW_ANDA_SALES WHERE (STG_TW_ANDA_SALES.BRAND ~~ '%PARAGARD%'::varchar(10));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_extract AS
SELECT coalesce(r.VEEVA_ACCOUNT_ID, r.IMS_ID) AS account_id, r.ENROLLMENT_ID AS enrollment_id, r.NPI AS npi, r.DEA_NUM AS dea_num, (r.PROGRAM_ID)::int AS program_id, substr(r.PROGRAM_NAME, 1, 4) AS REMS_PROGRAM, r.STATUS AS enrollment_status, r.IN_PROGRESS_STEP AS current_enrollment_step, to_char(r.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(r.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT coalesce(STG_REMS_FACILITY.VEEVA_ACCOUNT_ID, STG_REMS_FACILITY.ASI_ACCOUNT_ID) AS account_id, STG_REMS_FACILITY.ENROLLMENT_ID AS enrollment_id, STG_REMS_FACILITY.NPI AS npi, STG_REMS_FACILITY.DEA AS dea, (STG_REMS_FACILITY.PROGRAM_ID)::int AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS REMS_program, STG_REMS_FACILITY.STATUS_DESCRIPTION AS enrollment_status, STG_REMS_FACILITY.IN_PROGRESS_STEP AS current_enrollment_step, to_char(STG_REMS_FACILITY.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(STG_REMS_FACILITY.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_program_lookup AS
SELECT (r.PROGRAM_ID)::int AS program_id, r.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT (STG_REMS_FACILITY.PROGRAM_ID)::int AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ddd_category AS
SELECT DIM_DDD_CATEGORY.CATEGORY_CODE, DIM_DDD_CATEGORY.CATEGORY_DESC, DIM_DDD_CATEGORY.CATEGORY_DEFN FROM WSMP_ADMIN.DIM_DDD_CATEGORY ORDER BY DIM_DDD_CATEGORY.CATEGORY_CODE LIMIT 100;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_BrandedIMS_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, coalesce(demo.veeva_account_id, rx.ims_id) AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-019'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-15-001'::varchar(10), '330-15-002'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_num = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)])))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, coalesce(demo.veeva_account_id, rx.ims_id), rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_BrandedIMS_MoP AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-019'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-15-001'::varchar(10), '330-15-002'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ICS_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-13-010'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-008'::varchar(10), '330-13-011'::varchar(10), '330-13-017'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ics_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) ELSE 'UNKOWN'::varchar(6) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-13-010'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-008'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-13-017'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) ELSE 'UNKOWN'::varchar(6) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_NASAL_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_nasal_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_SABA_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-16-056'::varchar(10), '330-14-006'::varchar(10)])) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-16-056'::varchar(10), '330-14-006'::varchar(10)])) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_saba_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = '330-14-006'::varchar(10)) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = '330-14-006'::varchar(10)) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_nuvigil_demo AS
SELECT CASE mod(dem.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((dem.tvcmid)::int)::varchar ELSE rtrim((dem.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, dem.ims_id, dem.veeva_account_id, initcap(dem.first_name) AS first_name, initcap(dem.middle_name) AS middle_name, initcap(dem.last_name) AS last_name, dem.DEGREE, initcap(dem.address1) AS address1, initcap(dem.address2) AS address2, initcap(dem.address3) AS address3, initcap(dem.city) AS city, dem.state, dem.zip, dem.prim_specialty, dem.nuvigil_report_group, dec1.trx_cnt_01_06 AS nuvigil_decile, dec2.trx_cnt_01_06 AS wake_decile FROM (((SELECT demo.tvcmid, demo.ims_id, demo.veeva_account_id, demo.first_name, demo.middle_name, demo.last_name, demo.DEGREE, demo.address1, demo.address2, demo.address3, demo.city, demo.state, demo.zip, demo.prim_specialty, demo.nuvigil_report_group, demo.source_rank, rank() OVER (PARTITION BY demo.tvcmid, demo.ims_id ORDER BY demo.source_rank) AS demo_rank FROM (SELECT d.TVCMID AS tvcmid, d.IMS_ID AS ims_id, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.FIRST_NAME AS first_name, d.MIDDLE_NAME AS middle_name, d.LAST_NAME AS last_name, d.CREDENTIALS AS DEGREE, d.ADDRESS1 AS address1, d.ADDRESS2 AS address2, d.ADDRESS3 AS address3, d.CITY AS city, d.STATE AS state, d.ZIP AS zip, coalesce(d2.specialty, coalesce(s1.SPECIALTY_CODE, coalesce(s2.specialty_code, d.PRIM_SPECIALTY))) AS prim_specialty, coalesce(s1.NUVIGIL_REPORT_GROUP, s2.nuvigil_report_group) AS nuvigil_report_group, 1 AS source_rank FROM (((WSMP_ADMIN.DIM_SFA_CSF_DEMO d LEFT JOIN WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d2 ON (((d2.ims_id = d.IMS_ID) AND (d2.sales_force_id = 'TC'::varchar(2))))) LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.PRIM_SPECIALTY))) LEFT JOIN (SELECT TFC_SPECIALTY_XREF.SPECIALTY_CODE AS specialty_code, TFC_SPECIALTY_XREF.SPECIALTY_DESC AS specialty_desc, TFC_SPECIALTY_XREF.NUVIGIL_REPORT_GROUP AS nuvigil_report_group FROM WSMP_ADMIN.TFC_SPECIALTY_XREF WHERE (TFC_SPECIALTY_XREF.SPECIALTY_CODE IN (SELECT iq1.specialty_code FROM (SELECT TFC_SPECIALTY_XREF.SPECIALTY_DESC AS specialty_desc, min(TFC_SPECIALTY_XREF.SPECIALTY_CODE) AS specialty_code FROM WSMP_ADMIN.TFC_SPECIALTY_XREF GROUP BY TFC_SPECIALTY_XREF.SPECIALTY_DESC) iq1))) s2 ON ((upper(CASE d.PRIM_SPECIALTY WHEN NULLSEQUAL 'Other'::varchar(5) THEN 'OTHER SPECIALTY'::varchar(15) ELSE d.PRIM_SPECIALTY END) = s2.specialty_desc))) WHERE ((d.SALES_FORCE_ID = 'TC'::varchar(2)) AND (d.DEMO_TYPE = 'PROF'::varchar(4)) AND (d.DEMO_RANK = 1::numeric(18,0))) UNION ALL SELECT s1.tvcmid, s1.ims_id, NULL AS siebel_id, s1.first_name, s1.mid_name, s1.last_name, s1.DEGREE AS degree, s1.address1, s1.address2, s1.address3, s1.city, s1.state, s1.zip, s1.prim_specialty, s1.nuvigil_report_group, s1.source_rank FROM (SELECT cm1.TVCMID AS tvcmid, d.ims_id, cm1.ID_NUM AS siebel_id, d.first_name, d.mid_name, d.last_name, NULL AS DEGREE, d.ptr_address AS address1, NULL AS address2, NULL AS address3, d.ptr_city AS city, d.ptr_state AS state, d.ptr_zip AS zip, d.specialty AS prim_specialty, s1.NUVIGIL_REPORT_GROUP AS nuvigil_report_group, 2 AS source_rank FROM ((WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.specialty))) LEFT JOIN WSMP_ADMIN.tvcmid_xref cm1 ON (((cm1.ID_NUM = d.ims_id) AND (cm1.ID_TYPE = 'IMS_ID'::varchar(6))))) WHERE (d.sales_force_id = 'TC'::varchar(2))) s1) demo) dem LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec1 ON (((dec1.ims_id = dem.ims_id) AND (dec1.category = 'Provigil'::varchar(8)) AND (dec1.decile_name = 'Nuvigil'::varchar(7))))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec2 ON (((dec2.ims_id = dem.ims_id) AND (dec2.category = 'Provigil'::varchar(8)) AND (dec2.decile_name = 'Modafinil'::varchar(9))))) WHERE (dem.demo_rank = 1);

CREATE  VIEW public.ddl_tables AS
 SELECT ddl_columns.table_schema,
        ddl_columns.table_name
 FROM public.ddl_columns
 GROUP BY ddl_columns.table_schema,
          ddl_columns.table_name;

CREATE  VIEW teva_ingestion.XX_SALES_MV AS
 SELECT btrim(XX_SALES_MV_src.FILE_NBR) AS FILE_NBR,
        btrim(XX_SALES_MV_src.NAME) AS NAME,
        btrim(XX_SALES_MV_src.JOB_TITLE) AS JOB_TITLE,
        btrim(XX_SALES_MV_src.COST_CENTER_NAME) AS COST_CENTER_NAME,
        btrim(XX_SALES_MV_src.DEPARTMENT) AS DEPARTMENT,
        btrim(XX_SALES_MV_src.JOB_ENTRY_DT) AS JOB_ENTRY_DT,
        btrim(XX_SALES_MV_src.MANAGER_LEVEL) AS MANAGER_LEVEL,
        btrim(XX_SALES_MV_src.EE_STATUS) AS EE_STATUS,
        btrim(XX_SALES_MV_src.WORK_LOCATION) AS WORK_LOCATION,
        btrim(XX_SALES_MV_src.WORK_LOCATION_NAME) AS WORK_LOCATION_NAME,
        btrim(XX_SALES_MV_src.ORIG_HIRE_DT) AS ORIG_HIRE_DT,
        btrim(XX_SALES_MV_src.SERVICE_DT) AS SERVICE_DT,
        btrim(XX_SALES_MV_src.REHIRE_DT) AS REHIRE_DT,
        btrim(XX_SALES_MV_src.TERMINATION_DT) AS TERMINATION_DT,
        btrim(XX_SALES_MV_src.DIRECT_MANAGER) AS DIRECT_MANAGER,
        btrim(XX_SALES_MV_src.HOME_ADDRESS_LINE1) AS HOME_ADDRESS_LINE1,
        btrim(XX_SALES_MV_src.HOME_ADDRESS_LINE2) AS HOME_ADDRESS_LINE2,
        btrim(XX_SALES_MV_src.HOME_CITY) AS HOME_CITY,
        btrim(XX_SALES_MV_src.HOME_STATE) AS HOME_STATE,
        btrim(XX_SALES_MV_src.HOME_POSTAL_CODE) AS HOME_POSTAL_CODE,
        btrim(XX_SALES_MV_src.HOME_PHONE) AS HOME_PHONE,
        btrim(XX_SALES_MV_src.CELL_PHONE) AS CELL_PHONE,
        btrim(XX_SALES_MV_src.EMAIL_ADDRESS) AS EMAIL_ADDRESS,
        XX_SALES_MV_src.batch_id,
        XX_SALES_MV_src.row_id,
        XX_SALES_MV_src.update_ts
 FROM teva_ingestion.XX_SALES_MV_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_CNT_M AS
SELECT CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_CNT_M_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_CNT_M_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_CNT_M_src.ndc) AS ndc, btrim(EXT_IMS_MHK_CNT_M_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_CNT_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_CNT_M_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_CNT_M_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_CNT_M_src.me_num) AS me_num, btrim(EXT_IMS_MHK_CNT_M_src.last_name) AS last_name, btrim(EXT_IMS_MHK_CNT_M_src.first_name) AS first_name, btrim(EXT_IMS_MHK_CNT_M_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_CNT_M_src.address) AS address, btrim(EXT_IMS_MHK_CNT_M_src.city) AS city, btrim(EXT_IMS_MHK_CNT_M_src.state) AS state, btrim(EXT_IMS_MHK_CNT_M_src.zip) AS zip, btrim(EXT_IMS_MHK_CNT_M_src.specialty) AS specialty, btrim(EXT_IMS_MHK_CNT_M_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_CNT_M_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_CNT_M_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_CNT_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_024))::numeric(9,3) END AS trx_024, EXT_IMS_MHK_CNT_M_src.batch_id, EXT_IMS_MHK_CNT_M_src.row_id, EXT_IMS_MHK_CNT_M_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_CNT_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_CNT_W AS
SELECT CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_CNT_W_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_CNT_W_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_CNT_W_src.ndc) AS ndc, btrim(EXT_IMS_MHK_CNT_W_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_CNT_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_CNT_W_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_CNT_W_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_CNT_W_src.me_num) AS me_num, btrim(EXT_IMS_MHK_CNT_W_src.last_name) AS last_name, btrim(EXT_IMS_MHK_CNT_W_src.first_name) AS first_name, btrim(EXT_IMS_MHK_CNT_W_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_CNT_W_src.address) AS address, btrim(EXT_IMS_MHK_CNT_W_src.city) AS city, btrim(EXT_IMS_MHK_CNT_W_src.state) AS state, btrim(EXT_IMS_MHK_CNT_W_src.zip) AS zip, btrim(EXT_IMS_MHK_CNT_W_src.specialty) AS specialty, btrim(EXT_IMS_MHK_CNT_W_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_CNT_W_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_CNT_W_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_CNT_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_132))::numeric(9,3) END AS trx_132, EXT_IMS_MHK_CNT_W_src.batch_id, EXT_IMS_MHK_CNT_W_src.row_id, EXT_IMS_MHK_CNT_W_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_CNT_W_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_QTY_M AS
SELECT CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_QTY_M_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_QTY_M_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_QTY_M_src.ndc) AS ndc, btrim(EXT_IMS_MHK_QTY_M_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_QTY_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_QTY_M_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_QTY_M_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_QTY_M_src.me_num) AS me_num, btrim(EXT_IMS_MHK_QTY_M_src.last_name) AS last_name, btrim(EXT_IMS_MHK_QTY_M_src.first_name) AS first_name, btrim(EXT_IMS_MHK_QTY_M_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_QTY_M_src.address) AS address, btrim(EXT_IMS_MHK_QTY_M_src.city) AS city, btrim(EXT_IMS_MHK_QTY_M_src.state) AS state, btrim(EXT_IMS_MHK_QTY_M_src.zip) AS zip, btrim(EXT_IMS_MHK_QTY_M_src.specialty) AS specialty, btrim(EXT_IMS_MHK_QTY_M_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_QTY_M_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_QTY_M_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_QTY_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_024))::numeric(9,3) END AS trx_024, EXT_IMS_MHK_QTY_M_src.batch_id, EXT_IMS_MHK_QTY_M_src.row_id, EXT_IMS_MHK_QTY_M_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_QTY_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_QTY_W AS
SELECT CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_QTY_W_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_QTY_W_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_QTY_W_src.ndc) AS ndc, btrim(EXT_IMS_MHK_QTY_W_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_QTY_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_QTY_W_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_QTY_W_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_QTY_W_src.me_num) AS me_num, btrim(EXT_IMS_MHK_QTY_W_src.last_name) AS last_name, btrim(EXT_IMS_MHK_QTY_W_src.first_name) AS first_name, btrim(EXT_IMS_MHK_QTY_W_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_QTY_W_src.address) AS address, btrim(EXT_IMS_MHK_QTY_W_src.city) AS city, btrim(EXT_IMS_MHK_QTY_W_src.state) AS state, btrim(EXT_IMS_MHK_QTY_W_src.zip) AS zip, btrim(EXT_IMS_MHK_QTY_W_src.specialty) AS specialty, btrim(EXT_IMS_MHK_QTY_W_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_QTY_W_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_QTY_W_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_QTY_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_132))::numeric(9,3) END AS trx_132, EXT_IMS_MHK_QTY_W_src.batch_id, EXT_IMS_MHK_QTY_W_src.row_id, EXT_IMS_MHK_QTY_W_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_QTY_W_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pvs_for_data_stewards AS
SELECT sp_pharm_address_lookups.SOURCE_ID AS source_id, sp_pharm_address_lookups.TEVA_LAST_NAME AS last_name, sp_pharm_address_lookups.TEVA_FIRST_NAME AS first_name, sp_pharm_address_lookups.TEVA_PROFESSIONAL_ID AS npi, sp_pharm_address_lookups.TEVA_ADDRESS1 AS address1, sp_pharm_address_lookups.TEVA_ADDRESS2 AS address2, sp_pharm_address_lookups.TEVA_CITY AS city, sp_pharm_address_lookups.TEVA_STATE AS state, sp_pharm_address_lookups.TEVA_ZIP AS zip, NULL AS IMS_ID, NULL AS HCE_ID FROM WSMP_ADMIN.sp_pharm_address_lookups WHERE (trunc(sp_pharm_address_lookups.CREATE_DATE, 'DD'::varchar(2)) = trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) ORDER BY sp_pharm_address_lookups.TEVA_LAST_NAME, sp_pharm_address_lookups.TEVA_FIRST_NAME, sp_pharm_address_lookups.TEVA_ZIP;

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_VOD__HISTORY_HPS AS
 SELECT src.ID,
        src.ISDELETED,
        src.PARENTID,
        src.CREATEDBYID,
        src.CREATEDDATE,
        src.FIELD,
        src.OLDVALUE,
        src.NEWVALUE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_VOD__HISTORY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_VOD__HISTORY'::varchar(25)))));

CREATE  VIEW teva_ingestion.EXT_FTF_ACCOUNTS AS
 SELECT btrim(EXT_FTF_ACCOUNTS_src.ID) AS ID,
        btrim(EXT_FTF_ACCOUNTS_src.PROVIDER_ID) AS PROVIDER_ID,
        btrim(EXT_FTF_ACCOUNTS_src.SITE_ID) AS SITE_ID,
        btrim(EXT_FTF_ACCOUNTS_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_FTF_ACCOUNTS_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_FTF_ACCOUNTS_src.TITLE) AS TITLE,
        btrim(EXT_FTF_ACCOUNTS_src.ADDRESS_LINE_1) AS ADDRESS_LINE_1,
        btrim(EXT_FTF_ACCOUNTS_src.ADDRESS_LINE_2) AS ADDRESS_LINE_2,
        btrim(EXT_FTF_ACCOUNTS_src.CITY) AS CITY,
        btrim(EXT_FTF_ACCOUNTS_src.STATE) AS STATE,
        btrim(EXT_FTF_ACCOUNTS_src.POSTAL_CODE) AS POSTAL_CODE,
        btrim(EXT_FTF_ACCOUNTS_src.PHONE_1) AS PHONE_1,
        btrim(EXT_FTF_ACCOUNTS_src.PHONE_2) AS PHONE_2,
        btrim(EXT_FTF_ACCOUNTS_src.PHONE_MOBILE) AS PHONE_MOBILE,
        btrim(EXT_FTF_ACCOUNTS_src.PHONE_FAX) AS PHONE_FAX,
        btrim(EXT_FTF_ACCOUNTS_src.EMAIL) AS EMAIL,
        EXT_FTF_ACCOUNTS_src.batch_id,
        EXT_FTF_ACCOUNTS_src.row_id,
        EXT_FTF_ACCOUNTS_src.update_ts
 FROM teva_ingestion.EXT_FTF_ACCOUNTS_src
 WHERE (EXT_FTF_ACCOUNTS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_ACCOUNTS'::varchar(16))));

CREATE  VIEW teva_ingestion.EXT_FTF_CONTROL AS
 SELECT btrim(EXT_FTF_CONTROL_src.FILE_NAME) AS FILE_NAME,
        btrim(EXT_FTF_CONTROL_src.RECORDS) AS RECORDS,
        btrim(EXT_FTF_CONTROL_src.CREATED_AT) AS CREATED_AT,
        EXT_FTF_CONTROL_src.batch_id,
        EXT_FTF_CONTROL_src.row_id,
        EXT_FTF_CONTROL_src.update_ts
 FROM teva_ingestion.EXT_FTF_CONTROL_src
 WHERE (EXT_FTF_CONTROL_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_CONTROL'::varchar(15))));

CREATE  VIEW teva_ingestion.EXT_FTF_COPAYS AS
 SELECT btrim(EXT_FTF_COPAYS_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        CASE WHEN (EXT_FTF_COPAYS_src.TIER = ''::varchar) THEN NULL::int ELSE (btrim(EXT_FTF_COPAYS_src.TIER))::int END AS TIER,
        btrim(EXT_FTF_COPAYS_src.RETAIL_COPAY) AS RETAIL_COPAY,
        btrim(EXT_FTF_COPAYS_src.RETAIL_COINSURANCE) AS RETAIL_COINSURANCE,
        btrim(EXT_FTF_COPAYS_src.MAIL_ORDER_COPAY) AS MAIL_ORDER_COPAY,
        btrim(EXT_FTF_COPAYS_src.MAIL_ORDER_COINSURANCE) AS MAIL_ORDER_COINSURANCE,
        EXT_FTF_COPAYS_src.batch_id,
        EXT_FTF_COPAYS_src.row_id,
        EXT_FTF_COPAYS_src.update_ts
 FROM teva_ingestion.EXT_FTF_COPAYS_src
 WHERE (EXT_FTF_COPAYS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_COPAYS'::varchar(14))));

CREATE  VIEW teva_ingestion.EXT_FTF_DRUGS AS
 SELECT btrim(EXT_FTF_DRUGS_src.DRUG_CLASS_ID) AS DRUG_CLASS_ID,
        btrim(EXT_FTF_DRUGS_src.DRUG_CLASS) AS DRUG_CLASS,
        btrim(EXT_FTF_DRUGS_src.DRUG_ID) AS DRUG_ID,
        btrim(EXT_FTF_DRUGS_src.DRUG) AS DRUG,
        btrim(EXT_FTF_DRUGS_src.GENERIC) AS GENERIC,
        btrim(EXT_FTF_DRUGS_src.MANUFACTURER) AS MANUFACTURER,
        EXT_FTF_DRUGS_src.batch_id,
        EXT_FTF_DRUGS_src.row_id,
        EXT_FTF_DRUGS_src.update_ts
 FROM teva_ingestion.EXT_FTF_DRUGS_src
 WHERE (EXT_FTF_DRUGS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_DRUGS'::varchar(13))));

CREATE  VIEW teva_ingestion.EXT_FTF_DRUG_CLASS_THRPTC_AREA AS
 SELECT btrim(EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.DRUG_CLASS_ID) AS DRUG_CLASS_ID,
        btrim(EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.THERAPEUTIC_AREA_ID) AS THERAPEUTIC_AREA_ID,
        btrim(EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.THERAPEUTIC_AREA) AS THERAPEUTIC_AREA,
        EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.batch_id,
        EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.row_id,
        EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.update_ts
 FROM teva_ingestion.EXT_FTF_DRUG_CLASS_THRPTC_AREA_src
 WHERE (EXT_FTF_DRUG_CLASS_THRPTC_AREA_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_DRUG_CLASS_THRPTC_AREA'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_FTF_HEALTH_PLANS AS
 SELECT btrim(EXT_FTF_HEALTH_PLANS_src.FORMULARYF_ID) AS FORMULARYF_ID,
        btrim(EXT_FTF_HEALTH_PLANS_src.PROVIDER_ID) AS PROVIDER_ID,
        btrim(EXT_FTF_HEALTH_PLANS_src.PROVIDER) AS PROVIDER,
        btrim(EXT_FTF_HEALTH_PLANS_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        btrim(EXT_FTF_HEALTH_PLANS_src.HEALTH_PLAN) AS HEALTH_PLAN,
        btrim(EXT_FTF_HEALTH_PLANS_src.PARENT_ID) AS PARENT_ID,
        btrim(EXT_FTF_HEALTH_PLANS_src.PARENT) AS PARENT,
        CASE WHEN (EXT_FTF_HEALTH_PLANS_src.NATIONAL_LIVES_COUNT = ''::varchar) THEN NULL::int ELSE (btrim(EXT_FTF_HEALTH_PLANS_src.NATIONAL_LIVES_COUNT))::int END AS NATIONAL_LIVES_COUNT,
        btrim(EXT_FTF_HEALTH_PLANS_src.PLAN_TYPE_NAME) AS PLAN_TYPE_NAME,
        CASE WHEN (EXT_FTF_HEALTH_PLANS_src.PREFERRED_BRAND_TIER = ''::varchar) THEN NULL::int ELSE (btrim(EXT_FTF_HEALTH_PLANS_src.PREFERRED_BRAND_TIER))::int END AS PREFERRED_BRAND_TIER,
        EXT_FTF_HEALTH_PLANS_src.batch_id,
        EXT_FTF_HEALTH_PLANS_src.row_id,
        EXT_FTF_HEALTH_PLANS_src.update_ts
 FROM teva_ingestion.EXT_FTF_HEALTH_PLANS_src
 WHERE (EXT_FTF_HEALTH_PLANS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_HEALTH_PLANS'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_FTF_HEALTH_PLAN_GEOGRAPHY AS
 SELECT btrim(EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        btrim(EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.OPERATING_STATE) AS OPERATING_STATE,
        CASE WHEN (EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.LIVES_COVERAGE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.LIVES_COVERAGE))::int END AS LIVES_COVERAGE,
        EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.batch_id,
        EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.row_id,
        EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.update_ts
 FROM teva_ingestion.EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src
 WHERE (EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_HEALTH_PLAN_GEOGRAPHY'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_FTF_IMS_BRIDGE AS
 SELECT btrim(EXT_FTF_IMS_BRIDGE_src.PAYER_NAME) AS PAYER_NAME,
        btrim(EXT_FTF_IMS_BRIDGE_src.CODE) AS CODE,
        btrim(EXT_FTF_IMS_BRIDGE_src.NAME) AS NAME,
        btrim(EXT_FTF_IMS_BRIDGE_src.STATE) AS STATE,
        btrim(EXT_FTF_IMS_BRIDGE_src.COMMENTS) AS COMMENTS,
        btrim(EXT_FTF_IMS_BRIDGE_src.PLAN_ID) AS PLAN_ID,
        btrim(EXT_FTF_IMS_BRIDGE_src.PLAN_NAME) AS PLAN_NAME,
        btrim(EXT_FTF_IMS_BRIDGE_src.PROVIDER_NAME) AS PROVIDER_NAME,
        btrim(EXT_FTF_IMS_BRIDGE_src.PLAN_TYPE_NAME) AS PLAN_TYPE_NAME,
        EXT_FTF_IMS_BRIDGE_src.batch_id,
        EXT_FTF_IMS_BRIDGE_src.row_id,
        EXT_FTF_IMS_BRIDGE_src.update_ts
 FROM teva_ingestion.EXT_FTF_IMS_BRIDGE_src
 WHERE (EXT_FTF_IMS_BRIDGE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_IMS_BRIDGE'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_FTF_PBMS AS
 SELECT btrim(EXT_FTF_PBMS_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        btrim(EXT_FTF_PBMS_src.PBM_ID) AS PBM_ID,
        btrim(EXT_FTF_PBMS_src.PBM) AS PBM,
        btrim(EXT_FTF_PBMS_src.PBM_FUNCTION_ID) AS PBM_FUNCTION_ID,
        btrim(EXT_FTF_PBMS_src.PBM_FUNCTION) AS PBM_FUNCTION,
        EXT_FTF_PBMS_src.batch_id,
        EXT_FTF_PBMS_src.row_id,
        EXT_FTF_PBMS_src.update_ts
 FROM teva_ingestion.EXT_FTF_PBMS_src
 WHERE (EXT_FTF_PBMS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_PBMS'::varchar(12))));

CREATE  VIEW teva_ingestion.EXT_FTF_RESTRICTIONS AS
 SELECT btrim(EXT_FTF_RESTRICTIONS_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        btrim(EXT_FTF_RESTRICTIONS_src.DRUG_ID) AS DRUG_ID,
        btrim(EXT_FTF_RESTRICTIONS_src.RESTRICTION_DETAIL_ID) AS RESTRICTION_DETAIL_ID,
        btrim(EXT_FTF_RESTRICTIONS_src.RESTRICTION_CODE) AS RESTRICTION_CODE,
        btrim(EXT_FTF_RESTRICTIONS_src.FORMULARY_ENTRY_RESTRICTION_ID) AS FORMULARY_ENTRY_RESTRICTION_ID,
        btrim(EXT_FTF_RESTRICTIONS_src.RESTRICTION_DETAIL_TEXT) AS RESTRICTION_DETAIL_TEXT,
        btrim(EXT_FTF_RESTRICTIONS_src.RESTRICTION_ADDTNL_INFORMATION_1) AS RESTRICTION_ADDTNL_INFORMATION_1,
        btrim(EXT_FTF_RESTRICTIONS_src.RESTRICTION_ADDTNL_INFORMATION_2) AS RESTRICTION_ADDTNL_INFORMATION_2,
        EXT_FTF_RESTRICTIONS_src.batch_id,
        EXT_FTF_RESTRICTIONS_src.row_id,
        EXT_FTF_RESTRICTIONS_src.update_ts
 FROM teva_ingestion.EXT_FTF_RESTRICTIONS_src
 WHERE (EXT_FTF_RESTRICTIONS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_RESTRICTIONS'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_FTF_TEVA_WK_BRIDGE AS
 SELECT btrim(EXT_FTF_TEVA_WK_BRIDGE_src.NAME) AS NAME,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.AMC_NUMBER) AS AMC_NUMBER,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.PBM_AMC_NUMBER) AS PBM_AMC_NUMBER,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.PLAN_TYPE_CODE) AS PLAN_TYPE_CODE,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.ZIP_CODE) AS ZIP_CODE,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.COMMENTS) AS COMMENTS,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.FF_PLAN_ID) AS FF_PLAN_ID,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.FF_PLAN_NAME) AS FF_PLAN_NAME,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.FF_PROVIDER_NAME) AS FF_PROVIDER_NAME,
        btrim(EXT_FTF_TEVA_WK_BRIDGE_src.FF_PLAN_TYPE) AS FF_PLAN_TYPE,
        EXT_FTF_TEVA_WK_BRIDGE_src.batch_id,
        EXT_FTF_TEVA_WK_BRIDGE_src.row_id,
        EXT_FTF_TEVA_WK_BRIDGE_src.update_ts
 FROM teva_ingestion.EXT_FTF_TEVA_WK_BRIDGE_src
 WHERE (EXT_FTF_TEVA_WK_BRIDGE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_TEVA_WK_BRIDGE'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_FTF_TIERS AS
 SELECT CASE WHEN (EXT_FTF_TIERS_src.ID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_FTF_TIERS_src.ID))::int END AS ID,
        btrim(EXT_FTF_TIERS_src.NAME) AS NAME,
        btrim(EXT_FTF_TIERS_src.CODE_NAME) AS CODE_NAME,
        btrim(EXT_FTF_TIERS_src.EXPLANATION_TEXT) AS EXPLANATION_TEXT,
        EXT_FTF_TIERS_src.batch_id,
        EXT_FTF_TIERS_src.row_id,
        EXT_FTF_TIERS_src.update_ts
 FROM teva_ingestion.EXT_FTF_TIERS_src
 WHERE (EXT_FTF_TIERS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_TIERS'::varchar(13))));

CREATE  VIEW raw.ext_ftf_accounts AS
 SELECT src.ID,
        src.PROVIDER_ID,
        src.SITE_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.TITLE,
        src.ADDRESS_LINE_1,
        src.ADDRESS_LINE_2,
        src.CITY,
        src.STATE,
        src.POSTAL_CODE,
        src.PHONE_1,
        src.PHONE_2,
        src.PHONE_MOBILE,
        src.PHONE_FAX,
        src.EMAIL,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_ACCOUNTS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_ACCOUNTS'::varchar(16)))));

CREATE  VIEW raw.ext_ftf_control AS
 SELECT src.FILE_NAME,
        src.RECORDS,
        src.CREATED_AT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_CONTROL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_CONTROL'::varchar(15)))));

CREATE  VIEW raw.ext_ftf_copays AS
 SELECT src.HEALTH_PLAN_ID,
        src.TIER,
        src.RETAIL_COPAY,
        src.RETAIL_COINSURANCE,
        src.MAIL_ORDER_COPAY,
        src.MAIL_ORDER_COINSURANCE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_COPAYS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_COPAYS'::varchar(14)))));

CREATE  VIEW raw.ext_ftf_drugs AS
 SELECT src.DRUG_CLASS_ID,
        src.DRUG_CLASS,
        src.DRUG_ID,
        src.DRUG,
        src.GENERIC,
        src.MANUFACTURER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_DRUGS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_DRUGS'::varchar(13)))));

CREATE  VIEW raw.ext_ftf_drug_class_thrptc_area AS
 SELECT src.DRUG_CLASS_ID,
        src.THERAPEUTIC_AREA_ID,
        src.THERAPEUTIC_AREA,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_DRUG_CLASS_THRPTC_AREA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_DRUG_CLASS_THRPTC_AREA'::varchar(30)))));

CREATE  VIEW raw.ext_ftf_health_plans AS
 SELECT src.FORMULARYF_ID,
        src.PROVIDER_ID,
        src.PROVIDER,
        src.HEALTH_PLAN_ID,
        src.HEALTH_PLAN,
        src.PARENT_ID,
        src.PARENT,
        src.NATIONAL_LIVES_COUNT,
        src.PLAN_TYPE_NAME,
        src.PREFERRED_BRAND_TIER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_HEALTH_PLANS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_HEALTH_PLANS'::varchar(20)))));

CREATE  VIEW raw.ext_ftf_health_plan_geography AS
 SELECT src.HEALTH_PLAN_ID,
        src.OPERATING_STATE,
        src.LIVES_COVERAGE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_HEALTH_PLAN_GEOGRAPHY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_HEALTH_PLAN_GEOGRAPHY'::varchar(29)))));

CREATE  VIEW raw.ext_ftf_ims_bridge AS
 SELECT src.PAYER_NAME,
        src.CODE,
        src.NAME,
        src.STATE,
        src.COMMENTS,
        src.PLAN_ID,
        src.PLAN_NAME,
        src.PROVIDER_NAME,
        src.PLAN_TYPE_NAME,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_IMS_BRIDGE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_IMS_BRIDGE'::varchar(18)))));

CREATE  VIEW raw.ext_ftf_pbms AS
 SELECT src.HEALTH_PLAN_ID,
        src.PBM_ID,
        src.PBM,
        src.PBM_FUNCTION_ID,
        src.PBM_FUNCTION,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_PBMS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_PBMS'::varchar(12)))));

CREATE  VIEW raw.ext_ftf_restrictions AS
 SELECT src.HEALTH_PLAN_ID,
        src.DRUG_ID,
        src.RESTRICTION_DETAIL_ID,
        src.RESTRICTION_CODE,
        src.FORMULARY_ENTRY_RESTRICTION_ID,
        src.RESTRICTION_DETAIL_TEXT,
        src.RESTRICTION_ADDTNL_INFORMATION_1,
        src.RESTRICTION_ADDTNL_INFORMATION_2,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_RESTRICTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_RESTRICTIONS'::varchar(20)))));

CREATE  VIEW raw.ext_ftf_teva_wk_bridge AS
 SELECT src.NAME,
        src.AMC_NUMBER,
        src.PBM_AMC_NUMBER,
        src.PLAN_TYPE_CODE,
        src.ZIP_CODE,
        src.COMMENTS,
        src.FF_PLAN_ID,
        src.FF_PLAN_NAME,
        src.FF_PROVIDER_NAME,
        src.FF_PLAN_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_TEVA_WK_BRIDGE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_TEVA_WK_BRIDGE'::varchar(22)))));

CREATE  VIEW raw.ext_ftf_tiers AS
 SELECT src.ID,
        src.NAME,
        src.CODE_NAME,
        src.EXPLANATION_TEXT,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_TIERS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_TIERS'::varchar(13)))));

CREATE  VIEW raw.ext_cmop_rx_data_teva AS
 SELECT src.MONTH,
        src.CMOP,
        src.VISN,
        src.STATION_NUMBER,
        src.STATION,
        src.VA_PRODUCT,
        src.TOTAL_RXS,
        src.CMOP_RXS,
        src.TOTAL_QTY,
        src.CMOP_QTY,
        src."30_DAY_RXS" AS RXS_30_DAYS,
        src.ZIP,
        src.ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CMOP_RX_DATA_TEVA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CMOP_RX_DATA_TEVA'::varchar(21)))));

CREATE  VIEW raw.ext_tw_biologics_sales AS
 SELECT src.MRN,
        src.ORDER_NO,
        src.REFERRAL_DATE,
        src.REFERRAL_SOURCE,
        src.REFERRAL_METHOD,
        src.REFERRAL_TYPE,
        src.PATIENT_AUTH,
        src.STATUS,
        src.PLACEMENT_DATE,
        src.BILLING_METHOD,
        src.ICD_9,
        src.PHY_FIRST_NAME,
        src.PHY_LAST_NAME,
        src.PRACTICE_NAME,
        src.NPI,
        src.TAX_ID,
        src.PHY_NETWORK_STATUS,
        src.PHY_STREET,
        src.PHY_CITY,
        src.PHY_STATE,
        src.PHY_ZIP,
        src.PHY_PHONE,
        src.PHY_FAX,
        src.PAYOR,
        src.PAYOR_TYPE,
        src.PAYOR_PHONE,
        src.PAYOR_CONTACT,
        src.PAYOR_REFERENCE,
        src.BENEFIT_TYPE,
        src.PAYOR_RANK,
        src.EFFECTIVE_DATE,
        src.DEDUCTIBLE,
        src.DEDUCTIBLE_MET,
        src.AMOUNT_MET,
        src.OOP_MAX,
        src.OOP_MET,
        src.LIFETIME_MAX,
        src.ANNUAL_BENEFIT_CAP,
        src.LIMITATIONS_RESTRICTIONS,
        src.ASSIGNMENT_ALLOWED,
        src.CO_INSURANCE,
        src.COPAY,
        src.OFFICE_VISIT_COPAY,
        src.FOLLOW_UP_COVERAGE,
        src.FOLLOW_UP_COPAY,
        src.J7300_COVERAGE_STATUS,
        src.J7300_COVERAGE_TYPE,
        src."58300_COVERAGE_STATUS" AS CPT_58300_COVERAGE_STATUS,
        src."58300_COVERAGE_TYPE" AS CPT_58300_COVERAGE_TYPE,
        src.PA_REQUIRED,
        src.PA_TYPE,
        src.PA_CONTACT,
        src.PA_PHONE,
        src.PA_FAX,
        src.PA_TAT,
        src.J7300_REIMBURSEMENT,
        src."58300_INSERTION" AS CPT_58300_INSERTION,
        src.PBM,
        src.PBM_PHONE,
        src.PREFERRED_PHARMACY,
        src.PHARMACY_PHONE,
        src.PHARMACY_FAX,
        src.SP_COPAY,
        src.SP_NAME,
        src.TRIAGE_DATE,
        src.INVOICE_NUMBER,
        src.SP_SHIP_DATE,
        src.SHIP_TO_NAME,
        src.SHIP_TO_ADDRESS_1,
        src.SHIP_TO_ADDRESS_2,
        src.SHIP_TO_CITY,
        src.SHIP_TO_STATE,
        src.SHIP_TO_ZIP,
        src.CALL_DATE_1,
        src.PT_REACHED_1,
        src.WHO_WAS_REACHED_1,
        src.CALL_DATE_2,
        src.PT_REACHED_2,
        src.WHO_WAS_REACHED_2,
        src.CALL_DATE_3,
        src.PT_REACHED_3,
        src.WHO_WAS_REACHED_3,
        src.KEEPING_APPT,
        src.ALTERNATE_METHOD,
        src.ADDITIONAL_QUESTIONS,
        src.TRANSFERRED,
        src.TRANSFER_DESTINATION,
        src.DISCHARGE_REASON,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TW_BIOLOGICS_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_BIOLOGICS_SALES'::varchar(22)))));

CREATE  VIEW teva_ingestion.EXT_ONC_CALL_DETAIL_GOALS AS
 SELECT btrim(EXT_ONC_CALL_DETAIL_GOALS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ONC_CALL_DETAIL_GOALS_src.TIME_PERIOD) AS TIME_PERIOD,
        btrim(EXT_ONC_CALL_DETAIL_GOALS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ONC_CALL_DETAIL_GOALS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ONC_CALL_DETAIL_GOALS_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_CALL_DETAIL_GOALS_src.P1))::int END AS P1,
        CASE WHEN (EXT_ONC_CALL_DETAIL_GOALS_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_CALL_DETAIL_GOALS_src.P2))::int END AS P2,
        CASE WHEN (EXT_ONC_CALL_DETAIL_GOALS_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_CALL_DETAIL_GOALS_src.P3))::int END AS P3,
        EXT_ONC_CALL_DETAIL_GOALS_src.batch_id,
        EXT_ONC_CALL_DETAIL_GOALS_src.row_id,
        EXT_ONC_CALL_DETAIL_GOALS_src.update_ts
 FROM teva_ingestion.EXT_ONC_CALL_DETAIL_GOALS_src
 WHERE (EXT_ONC_CALL_DETAIL_GOALS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ONC_CALL_DETAIL_GOALS'::varchar(25))));

CREATE  VIEW raw.ext_onc_call_detail_goals AS
 SELECT src.SALES_FORCE_ID,
        src.TIME_PERIOD,
        src.TERRITORY_NUM,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_CALL_DETAIL_GOALS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_CALL_DETAIL_GOALS'::varchar(25)))));

CREATE  VIEW teva_ingestion.EXT_CUSTOMER_FLAGS AS
 SELECT CASE WHEN (EXT_CUSTOMER_FLAGS_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_CUSTOMER_FLAGS_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_CUSTOMER_FLAGS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_CUSTOMER_FLAGS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_CUSTOMER_FLAGS_src.TERRITORY_NUMBER) AS TERRITORY_NUMBER,
        btrim(EXT_CUSTOMER_FLAGS_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim(EXT_CUSTOMER_FLAGS_src.FLAG_VALUE) AS FLAG_VALUE,
        CASE WHEN (EXT_CUSTOMER_FLAGS_src.EFF_START_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_CUSTOMER_FLAGS_src.EFF_START_DATE))::date END AS EFF_START_DATE,
        CASE WHEN (EXT_CUSTOMER_FLAGS_src.EFF_END_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_CUSTOMER_FLAGS_src.EFF_END_DATE))::date END AS EFF_END_DATE,
        EXT_CUSTOMER_FLAGS_src.batch_id,
        EXT_CUSTOMER_FLAGS_src.row_id,
        EXT_CUSTOMER_FLAGS_src.update_ts
 FROM teva_ingestion.EXT_CUSTOMER_FLAGS_src
 WHERE (EXT_CUSTOMER_FLAGS_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_CUSTOMER_FLAGS'::varchar(18))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_MCK AS
 SELECT btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.GROUP_NUMBER) AS GROUP_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.GROUP_NAME) AS GROUP_NAME,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.CLAIM_TYPE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.CLAIM_TYPE))::int END AS CLAIM_TYPE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.RX_NUMBER) AS RX_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DATE_OF_FILL) AS DATE_OF_FILL,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.CARD_ID_NUMBER) AS CARD_ID_NUMBER,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PATIENT_AGE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PATIENT_AGE))::int END AS PATIENT_AGE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PATIENT_GENDER) AS PATIENT_GENDER,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.OTHER_COVERAGE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.OTHER_COVERAGE))::int END AS OTHER_COVERAGE,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.NEW_REFILL_CODE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.NEW_REFILL_CODE))::int END AS NEW_REFILL_CODE,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.REFILLS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.REFILLS))::int END AS REFILLS,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.NDC) AS NDC,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DRUG_DOSAGE_FORM) AS DRUG_DOSAGE_FORM,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DRUG_STRENGTH) AS DRUG_STRENGTH,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PAID_QUANTITY = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PAID_QUANTITY))::numeric(12,2) END AS PAID_QUANTITY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DAYS_SUPPLY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DAYS_SUPPLY))::int END AS DAYS_SUPPLY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.INGREDIENT_COST_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.INGREDIENT_COST_PAID))::numeric(12,2) END AS INGREDIENT_COST_PAID,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.SALES_TAX_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.SALES_TAX_PAID))::numeric(12,2) END AS SALES_TAX_PAID,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.SUBMITTED_COST = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.SUBMITTED_COST))::numeric(12,2) END AS SUBMITTED_COST,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.COPAY_AMOUNT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.COPAY_AMOUNT))::numeric(12,2) END AS COPAY_AMOUNT,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.TOTAL_AMOUNT_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.TOTAL_AMOUNT_PAID))::numeric(12,2) END AS TOTAL_AMOUNT_PAID,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.USUAL_AND_CUSTOMARY = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.USUAL_AND_CUSTOMARY))::numeric(12,2) END AS USUAL_AND_CUSTOMARY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.CLAIM_NUMBER) AS CLAIM_NUMBER,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_NPI) AS PHARMACY_NPI,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_NABP) AS PHARMACY_NABP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_ADDRESS1) AS PHARMACY_ADDRESS1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_FIRST) AS PRESCRIBER_FIRST,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_MIDDLE) AS PRESCRIBER_MIDDLE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_LAST) AS PRESCRIBER_LAST,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_ADDRESS_1) AS PRESCRIBER_ADDRESS_1,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_ADDRESS_2) AS PRESCRIBER_ADDRESS_2,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_CITY) AS PRESCRIBER_CITY,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_STATE) AS PRESCRIBER_STATE,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_ZIP) AS PRESCRIBER_ZIP,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.PRESCRIBER_SPECIALTY) AS PRESCRIBER_SPECIALTY,
        CASE WHEN (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.REDEMPTION = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.REDEMPTION))::int END AS REDEMPTION,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.MAIL_ORDER_INDICATOR) AS MAIL_ORDER_INDICATOR,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.DEA) AS DEA,
        btrim(EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.NPI) AS NPI,
        EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.batch_id,
        EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.row_id,
        EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_MCK_src
 WHERE (EXT_ASI_COPAY_DETAIL_WKLY_MCK_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_MCK'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_MK AS
 SELECT btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.GROUP_NUMBER) AS GROUP_NUMBER,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.GROUP_NAME) AS GROUP_NAME,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.CLAIM_TYPE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.CLAIM_TYPE))::int END AS CLAIM_TYPE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.RX_NUMBER) AS RX_NUMBER,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DATE_OF_FILL) AS DATE_OF_FILL,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.CARD_ID_NUMBER) AS CARD_ID_NUMBER,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PATIENT_AGE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PATIENT_AGE))::int END AS PATIENT_AGE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PATIENT_GENDER) AS PATIENT_GENDER,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.OTHER_COVERAGE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.OTHER_COVERAGE))::int END AS OTHER_COVERAGE,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.NEW_REFILL_CODE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.NEW_REFILL_CODE))::int END AS NEW_REFILL_CODE,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.REFILLS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.REFILLS))::int END AS REFILLS,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.NDC) AS NDC,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DRUG_NAME) AS DRUG_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DRUG_DOSAGE_FORM) AS DRUG_DOSAGE_FORM,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DRUG_STRENGTH) AS DRUG_STRENGTH,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PAID_QUANTITY = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PAID_QUANTITY))::numeric(12,2) END AS PAID_QUANTITY,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DAYS_SUPPLY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DAYS_SUPPLY))::int END AS DAYS_SUPPLY,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.INGREDIENT_COST_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.INGREDIENT_COST_PAID))::numeric(12,2) END AS INGREDIENT_COST_PAID,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.SALES_TAX_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.SALES_TAX_PAID))::numeric(12,2) END AS SALES_TAX_PAID,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.SUBMITTED_COST = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.SUBMITTED_COST))::numeric(12,2) END AS SUBMITTED_COST,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.COPAY_AMOUNT = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.COPAY_AMOUNT))::numeric(12,2) END AS COPAY_AMOUNT,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.TOTAL_AMOUNT_PAID = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.TOTAL_AMOUNT_PAID))::numeric(12,2) END AS TOTAL_AMOUNT_PAID,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.USUAL_AND_CUSTOMARY = ''::varchar) THEN NULL::numeric(12,2) ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.USUAL_AND_CUSTOMARY))::numeric(12,2) END AS USUAL_AND_CUSTOMARY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.CLAIM_NUMBER) AS CLAIM_NUMBER,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_NPI) AS PHARMACY_NPI,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_NABP) AS PHARMACY_NABP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_NAME) AS PHARMACY_NAME,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_ADDRESS1) AS PHARMACY_ADDRESS1,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_ADDRESS2) AS PHARMACY_ADDRESS2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_FIRST) AS PRESCRIBER_FIRST,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_MIDDLE) AS PRESCRIBER_MIDDLE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_LAST) AS PRESCRIBER_LAST,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_ADDRESS_1) AS PRESCRIBER_ADDRESS_1,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_ADDRESS_2) AS PRESCRIBER_ADDRESS_2,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_CITY) AS PRESCRIBER_CITY,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_STATE) AS PRESCRIBER_STATE,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_ZIP) AS PRESCRIBER_ZIP,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.PRESCRIBER_SPECIALTY) AS PRESCRIBER_SPECIALTY,
        CASE WHEN (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.REDEMPTION = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.REDEMPTION))::int END AS REDEMPTION,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.MAIL_ORDER_INDICATOR) AS MAIL_ORDER_INDICATOR,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.DEA) AS DEA,
        btrim(EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.NPI) AS NPI,
        EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.batch_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.row_id,
        EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.update_ts
 FROM teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src
 WHERE (EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_MK'::varchar(30))));

CREATE  VIEW raw.ext_customer_flags AS
 SELECT src.TVCMID,
        src.PRODUCT_NAME,
        src.SALES_FORCE_ID,
        src.TERRITORY_NUMBER,
        src.FLAG_TYPE,
        src.FLAG_VALUE,
        src.EFF_START_DATE,
        src.EFF_END_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CUSTOMER_FLAGS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CUSTOMER_FLAGS'::varchar(18)))));

CREATE  VIEW raw.ext_asi_copay_detail_wkly_mck AS
 SELECT src.GROUP_NUMBER,
        src.GROUP_NAME,
        src.CLAIM_TYPE,
        src.RX_NUMBER,
        src.DATE_OF_FILL,
        src.CARD_ID_NUMBER,
        src.PATIENT_AGE,
        src.PATIENT_GENDER,
        src.OTHER_COVERAGE,
        src.NEW_REFILL_CODE,
        src.REFILLS,
        src.NDC,
        src.DRUG_NAME,
        src.DRUG_DOSAGE_FORM,
        src.DRUG_STRENGTH,
        src.PAID_QUANTITY,
        src.DAYS_SUPPLY,
        src.INGREDIENT_COST_PAID,
        src.SALES_TAX_PAID,
        src.SUBMITTED_COST,
        src.COPAY_AMOUNT,
        src.TOTAL_AMOUNT_PAID,
        src.USUAL_AND_CUSTOMARY,
        src.CLAIM_NUMBER,
        src.PHARMACY_NPI,
        src.PHARMACY_NABP,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS1,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PRESCRIBER_FIRST,
        src.PRESCRIBER_MIDDLE,
        src.PRESCRIBER_LAST,
        src.PRESCRIBER_ADDRESS_1,
        src.PRESCRIBER_ADDRESS_2,
        src.PRESCRIBER_CITY,
        src.PRESCRIBER_STATE,
        src.PRESCRIBER_ZIP,
        src.PRESCRIBER_SPECIALTY,
        src.REDEMPTION,
        src.MAIL_ORDER_INDICATOR,
        src.DEA,
        src.NPI,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_MCK_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_DETAIL_WKLY_MCK'::varchar(29)))));

CREATE  VIEW raw.ext_asi_voucher_detail_wkly_mk AS
 SELECT src.GROUP_NUMBER,
        src.GROUP_NAME,
        src.CLAIM_TYPE,
        src.RX_NUMBER,
        src.DATE_OF_FILL,
        src.CARD_ID_NUMBER,
        src.PATIENT_AGE,
        src.PATIENT_GENDER,
        src.OTHER_COVERAGE,
        src.NEW_REFILL_CODE,
        src.REFILLS,
        src.NDC,
        src.DRUG_NAME,
        src.DRUG_DOSAGE_FORM,
        src.DRUG_STRENGTH,
        src.PAID_QUANTITY,
        src.DAYS_SUPPLY,
        src.INGREDIENT_COST_PAID,
        src.SALES_TAX_PAID,
        src.SUBMITTED_COST,
        src.COPAY_AMOUNT,
        src.TOTAL_AMOUNT_PAID,
        src.USUAL_AND_CUSTOMARY,
        src.CLAIM_NUMBER,
        src.PHARMACY_NPI,
        src.PHARMACY_NABP,
        src.PHARMACY_NAME,
        src.PHARMACY_ADDRESS1,
        src.PHARMACY_ADDRESS2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PRESCRIBER_FIRST,
        src.PRESCRIBER_MIDDLE,
        src.PRESCRIBER_LAST,
        src.PRESCRIBER_ADDRESS_1,
        src.PRESCRIBER_ADDRESS_2,
        src.PRESCRIBER_CITY,
        src.PRESCRIBER_STATE,
        src.PRESCRIBER_ZIP,
        src.PRESCRIBER_SPECIALTY,
        src.REDEMPTION,
        src.MAIL_ORDER_INDICATOR,
        src.DEA,
        src.NPI,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_MK_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_VOUCHER_DETAIL_WKLY_MK'::varchar(30)))));

CREATE  VIEW metadata.reference_table_counts AS
SELECT A.reference_table, A.counts FROM ((((((((((((((((((((((((SELECT 'reference.alignment_active_dates'::varchar(32) AS reference_table, count(*) AS counts FROM reference.alignment_active_dates GROUP BY 'reference.alignment_active_dates'::varchar(32) UNION ALL SELECT 'reference.bag'::varchar(13) AS reference_table, count(*) AS counts FROM reference.bag GROUP BY 'reference.bag'::varchar(13)) UNION ALL SELECT 'reference.bag_product'::varchar(21) AS reference_table, count(*) AS counts FROM reference.bag_product GROUP BY 'reference.bag_product'::varchar(21)) UNION ALL SELECT 'reference.bag_territory'::varchar(23) AS reference_table, count(*) AS counts FROM reference.bag_territory GROUP BY 'reference.bag_territory'::varchar(23)) UNION ALL SELECT 'reference.calendar'::varchar(18) AS reference_table, count(*) AS counts FROM reference.calendar GROUP BY 'reference.calendar'::varchar(18)) UNION ALL SELECT 'reference.call_plan_active_dates'::varchar(32) AS reference_table, count(*) AS counts FROM reference.call_plan_active_dates GROUP BY 'reference.call_plan_active_dates'::varchar(32)) UNION ALL SELECT 'reference.caremark_md_id_to_tvcmid'::varchar(34) AS reference_table, count(*) AS counts FROM reference.caremark_md_id_to_tvcmid GROUP BY 'reference.caremark_md_id_to_tvcmid'::varchar(34)) UNION ALL SELECT 'reference.city_state_zip'::varchar(24) AS reference_table, count(*) AS counts FROM reference.city_state_zip GROUP BY 'reference.city_state_zip'::varchar(24)) UNION ALL SELECT 'reference.comp_alignment_exceptions'::varchar(35) AS reference_table, count(*) AS counts FROM reference.comp_alignment_exceptions GROUP BY 'reference.comp_alignment_exceptions'::varchar(35)) UNION ALL SELECT 'reference.copay_voucher_program'::varchar(31) AS reference_table, count(*) AS counts FROM reference.copay_voucher_program GROUP BY 'reference.copay_voucher_program'::varchar(31)) UNION ALL SELECT 'reference.ddd_445_calendar'::varchar(26) AS reference_table, count(*) AS counts FROM reference.ddd_445_calendar GROUP BY 'reference.ddd_445_calendar'::varchar(26)) UNION ALL SELECT 'reference.ddd_category'::varchar(22) AS reference_table, count(*) AS counts FROM reference.ddd_category GROUP BY 'reference.ddd_category'::varchar(22)) UNION ALL SELECT 'reference.ddd_subcategory'::varchar(25) AS reference_table, count(*) AS counts FROM reference.ddd_subcategory GROUP BY 'reference.ddd_subcategory'::varchar(25)) UNION ALL SELECT 'reference.ims_model_payment_method'::varchar(34) AS reference_table, count(*) AS counts FROM reference.ims_model_payment_method GROUP BY 'reference.ims_model_payment_method'::varchar(34)) UNION ALL SELECT 'reference.invoice_adjustments'::varchar(29) AS reference_table, count(*) AS counts FROM reference.invoice_adjustments GROUP BY 'reference.invoice_adjustments'::varchar(29)) UNION ALL SELECT 'reference.market_sales_force'::varchar(28) AS reference_table, count(*) AS counts FROM reference.market_sales_force GROUP BY 'reference.market_sales_force'::varchar(28)) UNION ALL SELECT 'reference.oncology_account_id_867_xref'::varchar(38) AS reference_table, count(*) AS counts FROM reference.oncology_account_id_867_xref GROUP BY 'reference.oncology_account_id_867_xref'::varchar(38)) UNION ALL SELECT 'reference.oncology_account_id_ims_xref'::varchar(38) AS reference_table, count(*) AS counts FROM reference.oncology_account_id_ims_xref GROUP BY 'reference.oncology_account_id_ims_xref'::varchar(38)) UNION ALL SELECT 'reference.oncology_excluded_outlets'::varchar(35) AS reference_table, count(*) AS counts FROM reference.oncology_excluded_outlets GROUP BY 'reference.oncology_excluded_outlets'::varchar(35)) UNION ALL SELECT 'reference.payer_parent'::varchar(22) AS reference_table, count(*) AS counts FROM reference.payer_parent GROUP BY 'reference.payer_parent'::varchar(22)) UNION ALL SELECT 'reference.pbm_parent'::varchar(20) AS reference_table, count(*) AS counts FROM reference.pbm_parent GROUP BY 'reference.pbm_parent'::varchar(20)) UNION ALL SELECT 'reference.specialty_xref'::varchar(24) AS reference_table, count(*) AS counts FROM reference.specialty_xref GROUP BY 'reference.specialty_xref'::varchar(24)) UNION ALL SELECT 'reference.unreported_sales'::varchar(26) AS reference_table, count(*) AS counts FROM reference.unreported_sales GROUP BY 'reference.unreported_sales'::varchar(26)) UNION ALL SELECT 'reference.us_states'::varchar(19) AS reference_table, count(*) AS counts FROM reference.us_states GROUP BY 'reference.us_states'::varchar(19)) UNION ALL SELECT 'reference.zipcode_timezone'::varchar(26) AS reference_table, count(*) AS counts FROM reference.zipcode_timezone GROUP BY 'reference.zipcode_timezone'::varchar(26)) A;

CREATE  VIEW teva_ingestion.EXT_I3_BY_STRENGTH_RX AS
 SELECT CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.SHIP_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.SHIP_DATE))::date END AS SHIP_DATE,
        btrim(EXT_I3_BY_STRENGTH_RX_src.FULL_NAME) AS FULL_NAME,
        btrim(EXT_I3_BY_STRENGTH_RX_src.SPECIALTY) AS SPECIALTY,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.RANK = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.RANK))::int END AS RANK,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.TOTAL = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.TOTAL))::int END AS TOTAL,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.AUBAGIO_14 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.AUBAGIO_14))::int END AS AUBAGIO_14,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.AUBAGIO_7 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.AUBAGIO_7))::int END AS AUBAGIO_7,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.AVONEX_30 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.AVONEX_30))::int END AS AVONEX_30,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.AVONEX_PACK = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.AVONEX_PACK))::int END AS AVONEX_PACK,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.AVONEX_PEN_PACK = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.AVONEX_PEN_PACK))::int END AS AVONEX_PEN_PACK,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.BETASERON = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.BETASERON))::int END AS BETASERON,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.COPAXONE_20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.COPAXONE_20))::int END AS COPAXONE_20,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.COPAXONE_40 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.COPAXONE_40))::int END AS COPAXONE_40,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.GILENYA_0_5 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.GILENYA_0_5))::int END AS GILENYA_0_5,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.GLATOPA_20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.GLATOPA_20))::int END AS GLATOPA_20,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.LEMTRADA = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.LEMTRADA))::int END AS LEMTRADA,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.PLEGRIDY_PFS = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.PLEGRIDY_PFS))::int END AS PLEGRIDY_PFS,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.PLEGRIDY_PEN = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.PLEGRIDY_PEN))::int END AS PLEGRIDY_PEN,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_22_REBIDOSE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_22_REBIDOSE))::int END AS REBIF_22_REBIDOSE,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_22 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_22))::int END AS REBIF_22,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_44 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_44))::int END AS REBIF_44,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_44_REBIDOSE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_44_REBIDOSE))::int END AS REBIF_44_REBIDOSE,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_PACK = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_PACK))::int END AS REBIF_PACK,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.REBIF_PACK_REBIDOSE = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.REBIF_PACK_REBIDOSE))::int END AS REBIF_PACK_REBIDOSE,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_120 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_120))::int END AS TECFIDERA_120,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_240 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_240))::int END AS TECFIDERA_240,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_STARTER_PACK = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.TECFIDERA_STARTER_PACK))::int END AS TECFIDERA_STARTER_PACK,
        CASE WHEN (EXT_I3_BY_STRENGTH_RX_src.TYSABRI = ''::varchar) THEN NULL::int ELSE (btrim(EXT_I3_BY_STRENGTH_RX_src.TYSABRI))::int END AS TYSABRI,
        btrim(EXT_I3_BY_STRENGTH_RX_src.MD_ADDR1) AS MD_ADDR1,
        btrim(EXT_I3_BY_STRENGTH_RX_src.MD_ADDR2) AS MD_ADDR2,
        btrim(EXT_I3_BY_STRENGTH_RX_src.MD_CITY) AS MD_CITY,
        btrim(EXT_I3_BY_STRENGTH_RX_src.MD_STATE) AS MD_STATE,
        btrim(EXT_I3_BY_STRENGTH_RX_src.MD_ZIP) AS MD_ZIP,
        btrim(EXT_I3_BY_STRENGTH_RX_src.PRESCRIBER_NPI) AS PRESCRIBER_NPI,
        btrim(EXT_I3_BY_STRENGTH_RX_src.DNC_FLAG) AS DNC_FLAG,
        EXT_I3_BY_STRENGTH_RX_src.batch_id,
        EXT_I3_BY_STRENGTH_RX_src.row_id,
        EXT_I3_BY_STRENGTH_RX_src.update_ts
 FROM teva_ingestion.EXT_I3_BY_STRENGTH_RX_src;

CREATE  VIEW raw.ext_i3_by_strength_rx AS
 SELECT src.SHIP_DATE,
        src.FULL_NAME,
        src.SPECIALTY,
        src.RANK,
        src.TOTAL,
        src.AUBAGIO_14,
        src.AUBAGIO_7,
        src.AVONEX_30,
        src.AVONEX_PACK,
        src.AVONEX_PEN_PACK,
        src.BETASERON,
        src.COPAXONE_20,
        src.COPAXONE_40,
        src.GILENYA_0_5,
        src.GLATOPA_20,
        src.LEMTRADA,
        src.PLEGRIDY_PFS,
        src.PLEGRIDY_PEN,
        src.REBIF_22_REBIDOSE,
        src.REBIF_22,
        src.REBIF_44,
        src.REBIF_44_REBIDOSE,
        src.REBIF_PACK,
        src.REBIF_PACK_REBIDOSE,
        src.TECFIDERA_120,
        src.TECFIDERA_240,
        src.TECFIDERA_STARTER_PACK,
        src.TYSABRI,
        src.MD_ADDR1,
        src.MD_ADDR2,
        src.MD_CITY,
        src.MD_STATE,
        src.MD_ZIP,
        src.PRESCRIBER_NPI,
        src.DNC_FLAG,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_I3_BY_STRENGTH_RX_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_I3_BY_STRENGTH_RX'::varchar(21)))));

CREATE  VIEW veeva.v_dsa_slide AS
 SELECT dsa_slide.id,
        dsa_slide.isdeleted,
        dsa_slide.name,
        dsa_slide.createddate,
        dsa_slide.createdbyid,
        dsa_slide.lastmodifieddate,
        dsa_slide.lastmodifiedbyid,
        dsa_slide.systemmodstamp,
        dsa_slide.mayedit,
        dsa_slide.islocked,
        dsa_slide.clm_presentation_vod__c,
        dsa_slide.key_message_vod__c,
        dsa_slide.display_order_vod__c,
        dsa_slide.sub_presentation_vod__c,
        dsa_slide.mobile_id_vod__c,
        dsa_slide.external_id_vod__c,
        dsa_slide.file_id,
        dsa_slide.record_id
 FROM veeva.dsa_slide
 WHERE (dsa_slide.file_id = ( SELECT max(dsa_slide.file_id) AS max
 FROM veeva.dsa_slide));

CREATE  VIEW veeva.v_dsa_presentation AS
 SELECT dsa_presentation.approved_vod__c,
        dsa_presentation.copied_from_vod__c,
        dsa_presentation.copy_date_vod__c,
        dsa_presentation.createdbyid,
        dsa_presentation.createddate,
        dsa_presentation.default_presentation_vod__c,
        dsa_presentation.group_to_share_to__c,
        dsa_presentation.hidden_vod__c,
        dsa_presentation.id,
        dsa_presentation.isdeleted,
        dsa_presentation.islocked,
        dsa_presentation.lastmodifiedbyid,
        dsa_presentation.lastmodifieddate,
        dsa_presentation.mayedit,
        dsa_presentation.mobile_id_vod__c,
        dsa_presentation.name,
        dsa_presentation.original_record_id_vod__c,
        dsa_presentation.ownerid,
        dsa_presentation.parentid_vod__c,
        dsa_presentation.presentation_id_vod__c,
        dsa_presentation.product_vod__c,
        dsa_presentation.systemmodstamp,
        dsa_presentation.training_vod__c,
        dsa_presentation.type_vod__c,
        dsa_presentation.file_id,
        dsa_presentation.record_id
 FROM veeva.dsa_presentation
 WHERE (dsa_presentation.file_id = ( SELECT max(dsa_presentation.file_id) AS max
 FROM veeva.dsa_presentation));

CREATE  VIEW veeva.v_ids_call_detail AS
 SELECT ids_call_detail.id,
        ids_call_detail.file_id,
        ids_call_detail.record_id
 FROM veeva.ids_call_detail
 WHERE (ids_call_detail.file_id = ( SELECT max(ids_call_detail.file_id) AS max
 FROM veeva.ids_call_detail));

CREATE  VIEW veeva.v_ids_call AS
 SELECT ids_call.id,
        ids_call.file_id,
        ids_call.record_id
 FROM veeva.ids_call
 WHERE (ids_call.file_id = ( SELECT max(ids_call.file_id) AS max
 FROM veeva.ids_call));

CREATE  VIEW veeva.v_time_off_territory_kc AS
 SELECT time_off_territory_kc.id,
        time_off_territory_kc.event_row_id,
        time_off_territory_kc.rep_row_id,
        time_off_territory_kc.territory_num,
        time_off_territory_kc.time_off_date,
        time_off_territory_kc.time_on_date,
        time_off_territory_kc.description,
        time_off_territory_kc.comments,
        time_off_territory_kc.duration_in_minutes,
        time_off_territory_kc.duration_in_hours,
        time_off_territory_kc.duration_in_days,
        time_off_territory_kc.company,
        time_off_territory_kc.file_id,
        time_off_territory_kc.record_id
 FROM veeva.time_off_territory_kc
 WHERE (time_off_territory_kc.file_id = ( SELECT max(time_off_territory_kc.file_id) AS max
 FROM veeva.time_off_territory_kc));

CREATE  VIEW veeva.v_time_off_territory AS
 SELECT time_off_territory.createdbyid,
        time_off_territory.createddate,
        time_off_territory.date_vod__c,
        time_off_territory.hours_off_vod__c,
        time_off_territory.hours_vod__c,
        time_off_territory.id,
        time_off_territory.isdeleted,
        time_off_territory.islocked,
        time_off_territory.lastactivitydate,
        time_off_territory.lastmodifiedbyid,
        time_off_territory.lastmodifieddate,
        time_off_territory.mayedit,
        time_off_territory.mobile_id_vod__c,
        time_off_territory.name,
        time_off_territory.ownerid,
        time_off_territory.reason_vod__c,
        time_off_territory.start_time_vod__c,
        time_off_territory.status_vod__c,
        time_off_territory.systemmodstamp,
        time_off_territory.territory_vod__c,
        time_off_territory.time_vod__c,
        time_off_territory.file_id,
        time_off_territory.record_id
 FROM veeva.time_off_territory
 WHERE (time_off_territory.file_id = ( SELECT max(time_off_territory.file_id) AS max
 FROM veeva.time_off_territory));

CREATE  VIEW veeva.v_accountshare AS
 SELECT accountshare.accountaccesslevel,
        accountshare.accountid,
        accountshare.caseaccesslevel,
        accountshare.contactaccesslevel,
        accountshare.id,
        accountshare.isdeleted,
        accountshare.lastmodifiedbyid,
        accountshare.lastmodifieddate,
        accountshare.opportunityaccesslevel,
        accountshare.rowcause,
        accountshare.userorgroupid,
        accountshare.file_id,
        accountshare.record_id
 FROM veeva.accountshare
 WHERE (accountshare.file_id = ( SELECT max(accountshare.file_id) AS max
 FROM veeva.accountshare));

CREATE  VIEW veeva.v_account_merge_history AS
 SELECT account_merge_history.id,
        account_merge_history.isdeleted,
        account_merge_history.name,
        account_merge_history.createddate,
        account_merge_history.createdbyid,
        account_merge_history.lastmodifieddate,
        account_merge_history.lastmodifiedbyid,
        account_merge_history.systemmodstamp,
        account_merge_history.mayedit,
        account_merge_history.islocked,
        account_merge_history.account_vod__c,
        account_merge_history.personcontactid_vod__c,
        account_merge_history.account_personcontactid_vod__c,
        account_merge_history.file_id,
        account_merge_history.record_id
 FROM veeva.account_merge_history
 WHERE (account_merge_history.file_id = ( SELECT max(account_merge_history.file_id) AS max
 FROM veeva.account_merge_history));

CREATE  VIEW veeva.v_address AS
 SELECT address.id,
        address.isdeleted,
        address.name,
        address.recordtypeid,
        address.createddate,
        address.createdbyid,
        address.lastmodifieddate,
        address.lastmodifiedbyid,
        address.systemmodstamp,
        address.mayedit,
        address.islocked,
        address.account_vod__c,
        address.address_line_2_vod__c,
        address.city_vod__c,
        address.external_id_vod__c,
        address.dea_vod__c,
        address.dea_expiration_date_vod__c,
        address.dea_license_address_vod__c,
        address.phone_vod__c,
        address.fax_vod__c,
        address.map_vod__c,
        address.shipping_vod__c,
        address.primary_vod__c,
        address.license_vod__c,
        address.license_expiration_date_vod__c,
        address.staff_notes_vod__c,
        address.appt_required_vod__c,
        address.office_notes_vod__c,
        address.license_status_vod__c,
        address.zip_4_vod__c,
        address.phone_2_vod__c,
        address.fax_2_vod__c,
        address.license_valid_to_sample_vod__c,
        address.sample_status_vod__c,
        address.include_territory_assignment,
        address.mobile_id_vod__c,
        address.inactive_vod__c,
        address.lock_vod__c,
        address.country_vod__c,
        address.latitude_vod__c,
        address.zip_vod__c,
        address.best_times_vod__c,
        address.source_vod__c,
        address.brick_vod__c,
        address.assmca_vod__c,
        address.dea_address_vod__c,
        address.dea_schedule_vod__c,
        address.business_vod__c,
        address.billing_vod__c,
        address.home_vod__c,
        address.mailing_vod__c,
        address.state_vod__c,
        address.longitude_vod__c,
        address.dea_status_vod__c,
        address.entity_reference_id_vod__c,
        address.controlling_address_vod__c,
        address.controlled_address_vod__c,
        address.no_address_copy_vod__c,
        address.address_line_3_tva__c,
        address.county_tva__c,
        address.external_sln_tva__c,
        address.license_expiration_date_tva__c,
        address.rep_entered_sln_tva__c,
        address.dea_contact_tva__c,
        address.mark_for_deletion_tva__c,
        address.license_valid_date_tva__c,
        address.license_valid_num_tva__c,
        address.cm_id_tva__c,
        address.file_id,
        address.record_id
 FROM veeva.address
 WHERE (address.file_id = ( SELECT max(address.file_id) AS max
 FROM veeva.address));

CREATE  VIEW veeva.v_affiliation AS
 SELECT affiliation.child_affiliation_vod__c,
        affiliation.createdbyid,
        affiliation.createddate,
        affiliation.destroy_vod__c,
        affiliation.disable_trigger_vod__c,
        affiliation.external_id_vod__c,
        affiliation.from_account_vod__c,
        affiliation.from_contact_vod__c,
        affiliation.id,
        affiliation.influence_vod__c,
        affiliation.isdeleted,
        affiliation.islocked,
        affiliation.lastmodifiedbyid,
        affiliation.lastmodifieddate,
        affiliation.mayedit,
        affiliation.mobile_id_vod__c,
        affiliation.name,
        affiliation.ownerid,
        affiliation.parent_vod__c,
        affiliation.role_vod__c,
        affiliation.systemmodstamp,
        affiliation.to_account_vod__c,
        affiliation.to_contact_vod__c,
        affiliation.file_id,
        affiliation.record_id
 FROM veeva.affiliation
 WHERE (affiliation.file_id = ( SELECT max(affiliation.file_id) AS max
 FROM veeva.affiliation));

CREATE  VIEW veeva.v_assessment AS
 SELECT assessment.account__c,
        assessment.assessment_date_tva__c,
        assessment.cc_patient_profiles__c,
        assessment.cc_study_leverage__c,
        assessment.cml_q1_tva__c,
        assessment.cml_q2_tva__c,
        assessment.cml_q3_tva__c,
        assessment.cml_q4_tva__c,
        assessment.cml_q5_1_tva__c,
        assessment.cml_q5_tva__c,
        assessment.cml_q6_tva__c,
        assessment.cml_q7_1_tva__c,
        assessment.cml_q7_tva__c,
        assessment.community_activity__c,
        assessment.createdbyid,
        assessment.createddate,
        assessment.historical_assessment_tva__c,
        assessment.id,
        assessment.isdeleted,
        assessment.islocked,
        assessment.lastmodifiedbyid,
        assessment.lastmodifieddate,
        assessment.ln_patient_profiles__c,
        assessment.ln_study_leverage__c,
        assessment.mayedit,
        assessment.mobile_id_vod__c,
        assessment.name,
        assessment.oncology_board__c,
        assessment.preferred_pathologist__c,
        assessment.recordtypeid,
        assessment.research_focus__c,
        assessment.rl_patient_profiles__c,
        assessment.rl_study_leverage__c,
        assessment.systemmodstamp,
        assessment.treatment_preferences__c,
        assessment.treatment_volume__c,
        assessment.tumor_types__c,
        assessment.file_id,
        assessment.record_id
 FROM veeva.assessment
 WHERE (assessment.file_id = ( SELECT max(assessment.file_id) AS max
 FROM veeva.assessment));

CREATE  VIEW veeva.v_call_goal AS
 SELECT call_goal.account_tva__c,
        call_goal.active_tva__c,
        call_goal.actual_remaining_tva__c,
        call_goal.actual_tva__c,
        call_goal.createdbyid,
        call_goal.createddate,
        call_goal.end_date_tva__c,
        call_goal.external_id_tva__c,
        call_goal.goal_tva__c,
        call_goal.id,
        call_goal.isdeleted,
        call_goal.islocked,
        call_goal.lastactivitydate,
        call_goal.lastmodifiedbyid,
        call_goal.lastmodifieddate,
        call_goal.mayedit,
        call_goal.name,
        call_goal.ownerid,
        call_goal.priority_tva__c,
        call_goal.product_catalog_tva__c,
        call_goal.remaining_tva__c,
        call_goal.sort_order_tva__c,
        call_goal.start_date_tva__c,
        call_goal.systemmodstamp,
        call_goal.territory_tva__c,
        call_goal.file_id,
        call_goal.record_id
 FROM veeva.call_goal
 WHERE (call_goal.file_id = ( SELECT max(call_goal.file_id) AS max
 FROM veeva.call_goal));

CREATE  VIEW veeva.v_deciles AS
 SELECT deciles.account_vod__c,
        deciles.createdbyid,
        deciles.createddate,
        deciles.id,
        deciles.isdeleted,
        deciles.islocked,
        deciles.lastactivitydate,
        deciles.lastmodifiedbyid,
        deciles.lastmodifieddate,
        deciles.market_tva__c,
        deciles.mayedit,
        deciles.mobile_id_vod__c,
        deciles.name,
        deciles.systemmodstamp,
        deciles.value_tva__c,
        deciles.file_id,
        deciles.record_id
 FROM veeva.deciles
 WHERE (deciles.file_id = ( SELECT max(deciles.file_id) AS max
 FROM veeva.deciles));

CREATE  VIEW veeva.v_group AS
 SELECT "group".createdbyid,
        "group".createddate,
        "group".developername,
        "group".doesincludebosses,
        "group".doessendemailtomembers,
        "group".email,
        "group".id,
        "group".lastmodifiedbyid,
        "group".lastmodifieddate,
        "group".name,
        "group".ownerid,
        "group".relatedid,
        "group".systemmodstamp,
        "group".type,
        "group".file_id,
        "group".record_id
 FROM veeva."group"
 WHERE ("group".file_id = ( SELECT max("group".file_id) AS max
 FROM veeva."group"));

CREATE  VIEW veeva.v_key_message AS
 SELECT key_message.id,
        key_message.ownerid,
        key_message.isdeleted,
        key_message.name,
        key_message.createddate,
        key_message.createdbyid,
        key_message.lastmodifieddate,
        key_message.lastmodifiedbyid,
        key_message.systemmodstamp,
        key_message.mayedit,
        key_message.islocked,
        key_message.lastvieweddate,
        key_message.lastreferenceddate,
        key_message.description_vod__c,
        key_message.product_vod__c,
        key_message.product_strategy_vod__c,
        key_message.display_order_vod__c,
        key_message.active_vod__c,
        key_message.category_vod__c,
        key_message.vehicle_vod__c,
        key_message.clm_id_vod__c,
        key_message.custom_reaction_vod__c,
        key_message.slide_version_vod__c,
        key_message.language_vod__c,
        key_message.media_file_crc_vod__c,
        key_message.media_file_name_vod__c,
        key_message.media_file_size_vod__c,
        key_message.segment_vod__c,
        key_message.group_to_share_to__c,
        key_message.file_id,
        key_message.record_id
 FROM veeva.key_message
 WHERE (key_message.file_id = ( SELECT max(key_message.file_id) AS max
 FROM veeva.key_message));

CREATE  VIEW veeva.v_medical_inquiry AS
 SELECT medical_inquiry.account_vod__c,
        medical_inquiry.address_line_1_vod__c,
        medical_inquiry.address_line_2_vod__c,
        medical_inquiry.call2_vod__c,
        medical_inquiry.city_vod__c,
        medical_inquiry.country_vod__c,
        medical_inquiry.createdbyid,
        medical_inquiry.createddate,
        medical_inquiry.delivery_method_vod__c,
        medical_inquiry.disclaimer_vod__c,
        medical_inquiry.email_vod__c,
        medical_inquiry.entity_reference_id_vod__c,
        medical_inquiry.fax_number_vod__c,
        medical_inquiry.id,
        medical_inquiry.inquiry_text__c,
        medical_inquiry.isdeleted,
        medical_inquiry.islocked,
        medical_inquiry.lastmodifiedbyid,
        medical_inquiry.lastmodifieddate,
        medical_inquiry.lock_vod__c,
        medical_inquiry.mayedit,
        medical_inquiry.mobile_id_vod__c,
        medical_inquiry.msl_consult__c,
        medical_inquiry.name,
        medical_inquiry.new_email_tva__c,
        medical_inquiry.new_fax_tva__c,
        medical_inquiry.phone_number_vod__c,
        medical_inquiry.product__c,
        medical_inquiry.recordtypeid,
        medical_inquiry.rush_delivery__c,
        medical_inquiry.signature_date_vod__c,
        medical_inquiry.signature_vod__c,
        medical_inquiry.source__c,
        medical_inquiry.state_vod__c,
        medical_inquiry.status_vod__c,
        medical_inquiry.submitted_by_mobile_vod__c,
        medical_inquiry.systemmodstamp,
        medical_inquiry.zip_vod__c,
        medical_inquiry.zvod_delivery_method_vod__c,
        medical_inquiry.zvod_disclaimer_vod__c,
        medical_inquiry.file_id,
        medical_inquiry.record_id
 FROM veeva.medical_inquiry
 WHERE (medical_inquiry.file_id = ( SELECT max(medical_inquiry.file_id) AS max
 FROM veeva.medical_inquiry));

CREATE  VIEW veeva.v_product_metrics AS
 SELECT product_metrics.id,
        product_metrics.isdeleted,
        product_metrics.name,
        product_metrics.createddate,
        product_metrics.createdbyid,
        product_metrics.lastmodifieddate,
        product_metrics.lastmodifiedbyid,
        product_metrics.systemmodstamp,
        product_metrics.mayedit,
        product_metrics.islocked,
        product_metrics.account_vod__c,
        product_metrics.awareness__c,
        product_metrics.selling_stage__c,
        product_metrics.formulary_status__c,
        product_metrics.movement__c,
        product_metrics.products_vod__c,
        product_metrics.segment__c,
        product_metrics.x12_mo_trx_chg__c,
        product_metrics.speaker_skills__c,
        product_metrics.investigator_readiness__c,
        product_metrics.engagements__c,
        product_metrics.mobile_id_vod__c,
        product_metrics.external_id_vod__c,
        product_metrics.decile_value_tva__c,
        product_metrics.current_tva__c,
        product_metrics.external_id_tva__c,
        product_metrics.marketing_target_tva__c,
        product_metrics.prior_tva__c,
        product_metrics.rep_target_tva__c,
        product_metrics.sbo_target_tva__c,
        product_metrics.trx_3_month_tva__c,
        product_metrics.trx_6_month_tva__c,
        product_metrics.trx_ytd_tva__c,
        product_metrics.cp_decile_tva__c,
        product_metrics.business_segment_tva__c,
        product_metrics.file_id,
        product_metrics.record_id
 FROM veeva.product_metrics
 WHERE (product_metrics.file_id = ( SELECT max(product_metrics.file_id) AS max
 FROM veeva.product_metrics));

CREATE  VIEW veeva.v_survey_question_response AS
 SELECT survey_question_response.id,
        survey_question_response.isdeleted,
        survey_question_response.name,
        survey_question_response.recordtypeid,
        survey_question_response.createddate,
        survey_question_response.createdbyid,
        survey_question_response.lastmodifieddate,
        survey_question_response.lastmodifiedbyid,
        survey_question_response.systemmodstamp,
        survey_question_response.mayedit,
        survey_question_response.islocked,
        survey_question_response.survey_target_vod__c,
        survey_question_response.answer_choice_vod__c,
        survey_question_response.date_vod__c,
        survey_question_response.datetime_vod__c,
        survey_question_response.external_id_vod__c,
        survey_question_response.mobile_id_vod__c,
        survey_question_response.number_vod__c,
        survey_question_response.order_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.required_vod__c,
        survey_question_response.response_hash_vod__c,
        survey_question_response.response_vod__c,
        survey_question_response.score_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.text_vod__c,
        survey_question_response.type_vod__c,
        survey_question_response.file_id,
        survey_question_response.record_id
 FROM veeva.survey_question_response
 WHERE (survey_question_response.file_id = ( SELECT max(survey_question_response.file_id) AS max
 FROM veeva.survey_question_response));

CREATE  VIEW veeva.v_recordtype AS
 SELECT recordtype.businessprocessid,
        recordtype.createdbyid,
        recordtype.createddate,
        recordtype.description,
        recordtype.developername,
        recordtype.id,
        recordtype.isactive,
        recordtype.ispersontype,
        recordtype.lastmodifiedbyid,
        recordtype.lastmodifieddate,
        recordtype.name,
        recordtype.namespaceprefix,
        recordtype.sobjecttype,
        recordtype.systemmodstamp,
        recordtype.file_id,
        recordtype.record_id
 FROM veeva.recordtype
 WHERE (recordtype.file_id = ( SELECT max(recordtype.file_id) AS max
 FROM veeva.recordtype));

CREATE  VIEW veeva.v_survey_question AS
 SELECT survey_question.id,
        survey_question.isdeleted,
        survey_question.name,
        survey_question.recordtypeid,
        survey_question.createddate,
        survey_question.createdbyid,
        survey_question.lastmodifieddate,
        survey_question.lastmodifiedbyid,
        survey_question.systemmodstamp,
        survey_question.mayedit,
        survey_question.islocked,
        survey_question.survey_vod__c,
        survey_question.answer_choice_vod__c,
        survey_question.external_id_vod__c,
        survey_question.max_score_vod__c,
        survey_question.min_score_vod__c,
        survey_question.order_vod__c,
        survey_question.question_vod__c,
        survey_question.required_vod__c,
        survey_question.text_vod__c,
        survey_question.file_id,
        survey_question.record_id
 FROM veeva.survey_question
 WHERE (survey_question.file_id = ( SELECT max(survey_question.file_id) AS max
 FROM veeva.survey_question));

CREATE  VIEW veeva.v_survey AS
 SELECT survey.id,
        survey.ownerid,
        survey.isdeleted,
        survey.name,
        survey.recordtypeid,
        survey.createddate,
        survey.createdbyid,
        survey.lastmodifieddate,
        survey.lastmodifiedbyid,
        survey.systemmodstamp,
        survey.mayedit,
        survey.islocked,
        survey.lastvieweddate,
        survey.lastreferenceddate,
        survey.assignment_type_vod__c,
        survey.channels_vod__c,
        survey.end_date_vod__c,
        survey.expired_vod__c,
        survey.external_id_vod__c,
        survey.language_vod__c,
        survey.lock_vod__c,
        survey.open_vod__c,
        survey.product_vod__c,
        survey.region_vod__c,
        survey.segment_vod__c,
        survey.start_date_vod__c,
        survey.status_vod__c,
        survey.territory_vod__c,
        survey.zvod_questions_vod__c,
        survey.zvod_segments_vod__c,
        survey.zvod_targets_vod__c,
        survey.max_score_vod__c,
        survey.min_score_vod__c,
        survey.file_id,
        survey.record_id
 FROM veeva.survey
 WHERE (survey.file_id = ( SELECT max(survey.file_id) AS max
 FROM veeva.survey));

CREATE  VIEW veeva.v_sync_tracking AS
 SELECT sync_tracking.createdbyid,
        sync_tracking.createddate,
        sync_tracking.download_processed_vod__c,
        sync_tracking.id,
        sync_tracking.isdeleted,
        sync_tracking.islocked,
        sync_tracking.lastmodifiedbyid,
        sync_tracking.lastmodifieddate,
        sync_tracking.mayedit,
        sync_tracking.media_processed_vod__c,
        sync_tracking.mobile_id_vod__c,
        sync_tracking.name,
        sync_tracking.ownerid,
        sync_tracking.successful_sync_vod__c,
        sync_tracking.sync_completed_datetime_vod__c,
        sync_tracking.sync_duration_vod__c,
        sync_tracking.sync_start_datetime_vod__c,
        sync_tracking.sync_type_vod__c,
        sync_tracking.systemmodstamp,
        sync_tracking.upload_processed_vod__c,
        sync_tracking.version_vod__c,
        sync_tracking.vinsights_processed_vod__c,
        sync_tracking.file_id,
        sync_tracking.record_id
 FROM veeva.sync_tracking
 WHERE (sync_tracking.file_id = ( SELECT max(sync_tracking.file_id) AS max
 FROM veeva.sync_tracking));

CREATE  VIEW veeva.v_tsf AS
 SELECT tsf.id,
        tsf.isdeleted,
        tsf.name,
        tsf.recordtypeid,
        tsf.createddate,
        tsf.createdbyid,
        tsf.lastmodifieddate,
        tsf.lastmodifiedbyid,
        tsf.systemmodstamp,
        tsf.mayedit,
        tsf.islocked,
        tsf.account_vod__c,
        tsf.address_vod__c,
        tsf.last_activity_date_vod__c,
        tsf.my_target_vod__c,
        tsf.route_vod__c,
        tsf.mobile_id_vod__c,
        tsf.external_id_vod__c,
        tsf.territory_vod__c,
        tsf.ytd_activity_vod__c,
        tsf.preferred_account_vod__c,
        tsf.allowed_products_vod__c,
        tsf.territory_status_tva__c,
        tsf.territory_specialty_tva__c,
        tsf.treats_es_osa_tva__c,
        tsf.osa_patients_tva__c,
        tsf.account_status_tva__c,
        tsf.dea_number_tva__c,
        tsf.synribo_target_tva__c,
        tsf.treanda_sbo_tva__c,
        tsf.trisenox_sbo_tva__c,
        tsf.appt_index_tva__c,
        tsf.merged_mvn__c,
        tsf.call_plan_designation_tva__c,
        tsf.campaign_tva__c,
        tsf.file_id,
        tsf.record_id
 FROM veeva.tsf
 WHERE (tsf.file_id = ( SELECT max(tsf.file_id) AS max
 FROM veeva.tsf));

CREATE  VIEW veeva.v_veeva_user AS
 SELECT veeva_user.id,
        veeva_user.username,
        veeva_user.lastname,
        veeva_user.firstname,
        veeva_user.name,
        veeva_user.companyname,
        veeva_user.division,
        veeva_user.department,
        veeva_user.title,
        veeva_user.street,
        veeva_user.city,
        veeva_user.state,
        veeva_user.postalcode,
        veeva_user.country,
        veeva_user.latitude,
        veeva_user.longitude,
        veeva_user.email,
        veeva_user.emailpreferencesautobcc,
        veeva_user.emailpreferencesautobccstayint,
        veeva_user.emailpreferencesstayintouchrem,
        veeva_user.senderemail,
        veeva_user.sendername,
        veeva_user.signature,
        veeva_user.stayintouchsubject,
        veeva_user.stayintouchsignature,
        veeva_user.stayintouchnote,
        veeva_user.phone,
        veeva_user.fax,
        veeva_user.mobilephone,
        veeva_user.alias,
        veeva_user.communitynickname,
        veeva_user.isactive,
        veeva_user.timezonesidkey,
        veeva_user.userroleid,
        veeva_user.localesidkey,
        veeva_user.receivesinfoemails,
        veeva_user.receivesadmininfoemails,
        veeva_user.emailencodingkey,
        veeva_user.usertype,
        veeva_user.languagelocalekey,
        veeva_user.employeenumber,
        veeva_user.delegatedapproverid,
        veeva_user.managerid,
        veeva_user.lastlogindate,
        veeva_user.createddate,
        veeva_user.createdbyid,
        veeva_user.lastmodifieddate,
        veeva_user.lastmodifiedbyid,
        veeva_user.systemmodstamp,
        veeva_user.offlinetrialexpirationdate,
        veeva_user.offlinepdatrialexpirationdate,
        veeva_user.userpermissionsmarketinguser,
        veeva_user.userpermissionsofflineuser,
        veeva_user.userpermissionswirelessuser,
        veeva_user.userpermissionsavantgouser,
        veeva_user.userpermscallcenterautologin,
        veeva_user.userpermissionsmobileuser,
        veeva_user.userpermissionssfcontentuser,
        veeva_user.userpermissionsinteractionuser,
        veeva_user.userpermschatteranswersuser,
        veeva_user.forecastenabled,
        veeva_user.userprefsactivityreminderspopu,
        veeva_user.userprefseventreminderscheckbo,
        veeva_user.userprefstaskreminderscheckbox,
        veeva_user.userprefsremindersoundoff,
        veeva_user.userprefshidecsngetchattermobi,
        veeva_user.userprefshidecsndesktoptask,
        veeva_user.userpreferencesoptoutoftouch,
        veeva_user.userprefsshowtitletoexternalus,
        veeva_user.userprefsshowmanagertoexternal,
        veeva_user.userprefsshowemailtoexternalus,
        veeva_user.userprefsshowworkphonetoextern,
        veeva_user.userprefsshowmobilephonetoexte,
        veeva_user.userprefsshowfaxtoexternaluser,
        veeva_user.userprefsshowstreetaddresstoex,
        veeva_user.userprefsshowcitytoexternaluse,
        veeva_user.userprefsshowstatetoexternalus,
        veeva_user.userprefsshowpostalcodetoexter,
        veeva_user.userprefsshowcountrytoexternal,
        veeva_user.userprefsshowprofilepictoguest,
        veeva_user.userprefsshowtitletoguestusers,
        veeva_user.userprefsshowcitytoguestusers,
        veeva_user.userprefsshowstatetoguestusers,
        veeva_user.userprefsshowpostalcodetoguest,
        veeva_user.userprefsshowcountrytoguestuse,
        veeva_user.contactid,
        veeva_user.accountid,
        veeva_user.callcenterid,
        veeva_user.extension,
        veeva_user.federationidentifier,
        veeva_user.lastvieweddate,
        veeva_user.lastreferenceddate,
        veeva_user.last_mobile_connect_vod__c,
        veeva_user.last_tablet_connect_vod__c,
        veeva_user.last_mobile_connect_version,
        veeva_user.last_tablet_connect_version,
        veeva_user.last_mobile_sync_vod__c,
        veeva_user.last_tablet_sync_vod__c,
        veeva_user.raiselogginglevel_vod__c,
        veeva_user.senddetailedlog_vod__c,
        veeva_user.last_blackberry_connect_vod__c,
        veeva_user.last_blackberry_connect_versio,
        veeva_user.last_blackberry_sync_vod__c,
        veeva_user.force_full_refresh_vod__c,
        veeva_user.override_systemmodstamp_timest,
        veeva_user.facetime_email_vod__c,
        veeva_user.facetime_phone_vod__c,
        veeva_user.product_expertise_vod__c,
        veeva_user.available_vod__c,
        veeva_user.available_last_update_vod__c,
        veeva_user.last_ipad_connect_version,
        veeva_user.last_ipad_connect_vod__c,
        veeva_user.last_ipad_sync_vod__c,
        veeva_user.inventory_order_allocation_gro,
        veeva_user.concur_user_id_vod__c,
        veeva_user.external_id_tva__c,
        veeva_user.last_ipad_ios_version_vod__c,
        veeva_user.veeva_id__c,
        veeva_user.login_id_tva__c,
        veeva_user.primary_territory_vod__c,
        veeva_user.analytics_admin_vod__c,
        veeva_user.content_admin_vod__c,
        veeva_user.upload_vtrans_vod__c,
        veeva_user.can_sample_tva__c,
        veeva_user.do_not_modify_tva__c,
        veeva_user.profile_name_vod__c,
        veeva_user.file_id,
        veeva_user.record_id
 FROM veeva.veeva_user
 WHERE (veeva_user.file_id = ( SELECT max(veeva_user.file_id) AS max
 FROM veeva.veeva_user));

CREATE  VIEW veeva.v_user_role AS
 SELECT user_role.caseaccessforaccountowner,
        user_role.contactaccessforaccountowner,
        user_role.developername,
        user_role.forecastuserid,
        user_role.id,
        user_role.lastmodifiedbyid,
        user_role.lastmodifieddate,
        user_role.mayforecastmanagershare,
        user_role.name,
        user_role.opportunityaccessaccountowner,
        user_role.parentroleid,
        user_role.portalaccountid,
        user_role.portalaccountownerid,
        user_role.portaltype,
        user_role.rollupdescription,
        user_role.systemmodstamp,
        user_role.file_id,
        user_role.record_id
 FROM veeva.user_role
 WHERE (user_role.file_id = ( SELECT max(user_role.file_id) AS max
 FROM veeva.user_role));

CREATE  VIEW metadata.cleansed_table_counts_by_file_id AS
SELECT A.cleansed_table, A.file_id, A.counts FROM (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((SELECT 'cleansed.kc_hr_addresses'::varchar(24) AS cleansed_table, kc_hr_addresses.file_id, count(*) AS counts FROM cleansed.kc_hr_addresses GROUP BY 'cleansed.kc_hr_addresses'::varchar(24), kc_hr_addresses.file_id UNION ALL SELECT 'cleansed.kc_hr_associates'::varchar(25) AS cleansed_table, kc_hr_associates.file_id, count(*) AS counts FROM cleansed.kc_hr_associates GROUP BY 'cleansed.kc_hr_associates'::varchar(25), kc_hr_associates.file_id) UNION ALL SELECT 'cleansed.kc_hr_aud_associates'::varchar(29) AS cleansed_table, kc_hr_aud_associates.file_id, count(*) AS counts FROM cleansed.kc_hr_aud_associates GROUP BY 'cleansed.kc_hr_aud_associates'::varchar(29), kc_hr_aud_associates.file_id) UNION ALL SELECT 'customer_master.alternate_identifier'::varchar(36) AS cleansed_table, alternate_identifier.file_id, count(*) AS counts FROM customer_master.alternate_identifier GROUP BY 'customer_master.alternate_identifier'::varchar(36), alternate_identifier.file_id) UNION ALL SELECT 'customer_master.raw_dea'::varchar(23) AS cleansed_table, raw_dea.file_id, count(*) AS counts FROM customer_master.raw_dea GROUP BY 'customer_master.raw_dea'::varchar(23), raw_dea.file_id) UNION ALL SELECT 'customer_master.hcp_detail'::varchar(26) AS cleansed_table, hcp_detail.file_id, count(*) AS counts FROM customer_master.hcp_detail GROUP BY 'customer_master.hcp_detail'::varchar(26), hcp_detail.file_id) UNION ALL SELECT 'customer_master.ims_flag'::varchar(24) AS cleansed_table, ims_flag.file_id, count(*) AS counts FROM customer_master.ims_flag GROUP BY 'customer_master.ims_flag'::varchar(24), ims_flag.file_id) UNION ALL SELECT 'customer_master.teva_flag'::varchar(25) AS cleansed_table, teva_flag.file_id, count(*) AS counts FROM customer_master.teva_flag GROUP BY 'customer_master.teva_flag'::varchar(25), teva_flag.file_id) UNION ALL SELECT 'customer_master.sample_eligibility'::varchar(34) AS cleansed_table, sample_eligibility.file_id, count(*) AS counts FROM customer_master.sample_eligibility GROUP BY 'customer_master.sample_eligibility'::varchar(34), sample_eligibility.file_id) UNION ALL SELECT 'cleansed.ahm_event'::varchar(18) AS cleansed_table, ahm_event.file_id, count(*) AS counts FROM cleansed.ahm_event GROUP BY 'cleansed.ahm_event'::varchar(18), ahm_event.file_id) UNION ALL SELECT 'cleansed.ahm_event_attendee'::varchar(27) AS cleansed_table, ahm_event_attendee.file_id, count(*) AS counts FROM cleansed.ahm_event_attendee GROUP BY 'cleansed.ahm_event_attendee'::varchar(27), ahm_event_attendee.file_id) UNION ALL SELECT 'cleansed.ahm_event_count'::varchar(24) AS cleansed_table, ahm_event_count.file_id, count(*) AS counts FROM cleansed.ahm_event_count GROUP BY 'cleansed.ahm_event_count'::varchar(24), ahm_event_count.file_id) UNION ALL SELECT 'cleansed.ahm_event_expense'::varchar(26) AS cleansed_table, ahm_event_expense.file_id, count(*) AS counts FROM cleansed.ahm_event_expense GROUP BY 'cleansed.ahm_event_expense'::varchar(26), ahm_event_expense.file_id) UNION ALL SELECT 'cleansed.ahm_event_host'::varchar(23) AS cleansed_table, ahm_event_host.file_id, count(*) AS counts FROM cleansed.ahm_event_host GROUP BY 'cleansed.ahm_event_host'::varchar(23), ahm_event_host.file_id) UNION ALL SELECT 'cleansed.ahm_event_product'::varchar(26) AS cleansed_table, ahm_event_product.file_id, count(*) AS counts FROM cleansed.ahm_event_product GROUP BY 'cleansed.ahm_event_product'::varchar(26), ahm_event_product.file_id) UNION ALL SELECT 'cleansed.ahm_event_speaker'::varchar(26) AS cleansed_table, ahm_event_speaker.file_id, count(*) AS counts FROM cleansed.ahm_event_speaker GROUP BY 'cleansed.ahm_event_speaker'::varchar(26), ahm_event_speaker.file_id) UNION ALL SELECT 'cleansed.ahm_organization'::varchar(25) AS cleansed_table, ahm_organization.file_id, count(*) AS counts FROM cleansed.ahm_organization GROUP BY 'cleansed.ahm_organization'::varchar(25), ahm_organization.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_contract'::varchar(29) AS cleansed_table, ahm_speaker_contract.file_id, count(*) AS counts FROM cleansed.ahm_speaker_contract GROUP BY 'cleansed.ahm_speaker_contract'::varchar(29), ahm_speaker_contract.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_license'::varchar(28) AS cleansed_table, ahm_speaker_license.file_id, count(*) AS counts FROM cleansed.ahm_speaker_license GROUP BY 'cleansed.ahm_speaker_license'::varchar(28), ahm_speaker_license.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_profile'::varchar(28) AS cleansed_table, ahm_speaker_profile.file_id, count(*) AS counts FROM cleansed.ahm_speaker_profile GROUP BY 'cleansed.ahm_speaker_profile'::varchar(28), ahm_speaker_profile.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_training'::varchar(29) AS cleansed_table, ahm_speaker_training.file_id, count(*) AS counts FROM cleansed.ahm_speaker_training GROUP BY 'cleansed.ahm_speaker_training'::varchar(29), ahm_speaker_training.file_id) UNION ALL SELECT 'cleansed.ahm_topic_product'::varchar(26) AS cleansed_table, ahm_topic_product.file_id, count(*) AS counts FROM cleansed.ahm_topic_product GROUP BY 'cleansed.ahm_topic_product'::varchar(26), ahm_topic_product.file_id) UNION ALL SELECT 'cleansed.anda_sales'::varchar(19) AS cleansed_table, anda_sales.file_id, count(*) AS counts FROM cleansed.anda_sales GROUP BY 'cleansed.anda_sales'::varchar(19), anda_sales.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail'::varchar(39) AS cleansed_table, alphascrip_weekly_copay_detail.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail GROUP BY 'cleansed.alphascrip_weekly_copay_detail'::varchar(39), alphascrip_weekly_copay_detail.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_cgd'::varchar(36) AS cleansed_table, alphascrip_weekly_copay_cgd.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_cgd GROUP BY 'cleansed.alphascrip_weekly_copay_cgd'::varchar(36), alphascrip_weekly_copay_cgd.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail_2'::varchar(41) AS cleansed_table, alphascrip_weekly_copay_detail_2.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail_2 GROUP BY 'cleansed.alphascrip_weekly_copay_detail_2'::varchar(41), alphascrip_weekly_copay_detail_2.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail_3'::varchar(41) AS cleansed_table, alphascrip_weekly_copay_detail_3.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail_3 GROUP BY 'cleansed.alphascrip_weekly_copay_detail_3'::varchar(41), alphascrip_weekly_copay_detail_3.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_pskw'::varchar(37) AS cleansed_table, alphascrip_weekly_copay_pskw.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_pskw GROUP BY 'cleansed.alphascrip_weekly_copay_pskw'::varchar(37), alphascrip_weekly_copay_pskw.file_id) UNION ALL SELECT 'cleansed.alphascrip_copay_redemptions'::varchar(37) AS cleansed_table, alphascrip_copay_redemptions.file_id, count(*) AS counts FROM cleansed.alphascrip_copay_redemptions GROUP BY 'cleansed.alphascrip_copay_redemptions'::varchar(37), alphascrip_copay_redemptions.file_id) UNION ALL SELECT 'cleansed.alphascrip_redemptions'::varchar(31) AS cleansed_table, alphascrip_redemptions.file_id, count(*) AS counts FROM cleansed.alphascrip_redemptions GROUP BY 'cleansed.alphascrip_redemptions'::varchar(31), alphascrip_redemptions.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_voucher_detail_3'::varchar(43) AS cleansed_table, alphascrip_weekly_voucher_detail_3.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_voucher_detail_3 GROUP BY 'cleansed.alphascrip_weekly_voucher_detail_3'::varchar(43), alphascrip_weekly_voucher_detail_3.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_voucher_detail_2'::varchar(43) AS cleansed_table, alphascrip_weekly_voucher_detail_2.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_voucher_detail_2 GROUP BY 'cleansed.alphascrip_weekly_voucher_detail_2'::varchar(43), alphascrip_weekly_voucher_detail_2.file_id) UNION ALL SELECT 'cleansed.kc_sales_call_goals'::varchar(28) AS cleansed_table, kc_sales_call_goals.file_id, count(*) AS counts FROM cleansed.kc_sales_call_goals GROUP BY 'cleansed.kc_sales_call_goals'::varchar(28), kc_sales_call_goals.file_id) UNION ALL SELECT 'cleansed.caremark_rx_aob'::varchar(24) AS cleansed_table, caremark_rx_aob.file_id, count(*) AS counts FROM cleansed.caremark_rx_aob GROUP BY 'cleansed.caremark_rx_aob'::varchar(24), caremark_rx_aob.file_id) UNION ALL SELECT 'cleansed.caremark_rx_medicare'::varchar(29) AS cleansed_table, caremark_rx_medicare.file_id, count(*) AS counts FROM cleansed.caremark_rx_medicare GROUP BY 'cleansed.caremark_rx_medicare'::varchar(29), caremark_rx_medicare.file_id) UNION ALL SELECT 'veeva.dsa_slide'::varchar(15) AS cleansed_table, dsa_slide.file_id, count(*) AS counts FROM veeva.dsa_slide GROUP BY 'veeva.dsa_slide'::varchar(15), dsa_slide.file_id) UNION ALL SELECT 'veeva.dsa_presentation'::varchar(22) AS cleansed_table, dsa_presentation.file_id, count(*) AS counts FROM veeva.dsa_presentation GROUP BY 'veeva.dsa_presentation'::varchar(22), dsa_presentation.file_id) UNION ALL SELECT 'cleansed.clozapine_unit_ap'::varchar(26) AS cleansed_table, clozapine_unit_ap.file_id, count(*) AS counts FROM cleansed.clozapine_unit_ap GROUP BY 'cleansed.clozapine_unit_ap'::varchar(26), clozapine_unit_ap.file_id) UNION ALL SELECT 'cleansed.cmop_rx'::varchar(16) AS cleansed_table, cmop_rx.file_id, count(*) AS counts FROM cleansed.cmop_rx GROUP BY 'cleansed.cmop_rx'::varchar(16), cmop_rx.file_id) UNION ALL SELECT 'customer_master.customer_flags'::varchar(30) AS cleansed_table, customer_flags.file_id, count(*) AS counts FROM customer_master.customer_flags GROUP BY 'customer_master.customer_flags'::varchar(30), customer_flags.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_qty'::varchar(24) AS cleansed_table, ims_ddd_dod_qty.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_qty GROUP BY 'cleansed.ims_ddd_dod_qty'::varchar(24), ims_ddd_dod_qty.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_dollars_ms'::varchar(31) AS cleansed_table, ims_ddd_dod_dollars_ms.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_dollars_ms GROUP BY 'cleansed.ims_ddd_dod_dollars_ms'::varchar(31), ims_ddd_dod_dollars_ms.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_dollars_pd'::varchar(31) AS cleansed_table, ims_ddd_dod_dollars_pd.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_dollars_pd GROUP BY 'cleansed.ims_ddd_dod_dollars_pd'::varchar(31), ims_ddd_dod_dollars_pd.file_id) UNION ALL SELECT 'cleansed.diplomat_enrollment'::varchar(28) AS cleansed_table, diplomat_enrollment.file_id, count(*) AS counts FROM cleansed.diplomat_enrollment GROUP BY 'cleansed.diplomat_enrollment'::varchar(28), diplomat_enrollment.file_id) UNION ALL SELECT 'cleansed.diplomat_rx'::varchar(20) AS cleansed_table, diplomat_rx.file_id, count(*) AS counts FROM cleansed.diplomat_rx GROUP BY 'cleansed.diplomat_rx'::varchar(20), diplomat_rx.file_id) UNION ALL SELECT 'cleansed.ims_outlet_master'::varchar(26) AS cleansed_table, ims_outlet_master.file_id, count(*) AS counts FROM cleansed.ims_outlet_master GROUP BY 'cleansed.ims_outlet_master'::varchar(26), ims_outlet_master.file_id) UNION ALL SELECT 'cleansed.valuecentric_852'::varchar(25) AS cleansed_table, valuecentric_852.file_id, count(*) AS counts FROM cleansed.valuecentric_852 GROUP BY 'cleansed.valuecentric_852'::varchar(25), valuecentric_852.file_id) UNION ALL SELECT 'cleansed.ftf_accounts'::varchar(21) AS cleansed_table, ftf_accounts.file_id, count(*) AS counts FROM cleansed.ftf_accounts GROUP BY 'cleansed.ftf_accounts'::varchar(21), ftf_accounts.file_id) UNION ALL SELECT 'cleansed.ftf_control'::varchar(20) AS cleansed_table, ftf_control.file_id, count(*) AS counts FROM cleansed.ftf_control GROUP BY 'cleansed.ftf_control'::varchar(20), ftf_control.file_id) UNION ALL SELECT 'cleansed.ftf_copays'::varchar(19) AS cleansed_table, ftf_copays.file_id, count(*) AS counts FROM cleansed.ftf_copays GROUP BY 'cleansed.ftf_copays'::varchar(19), ftf_copays.file_id) UNION ALL SELECT 'cleansed.ftf_drug_class_therapeutic_area'::varchar(40) AS cleansed_table, ftf_drug_class_therapeutic_area.file_id, count(*) AS counts FROM cleansed.ftf_drug_class_therapeutic_area GROUP BY 'cleansed.ftf_drug_class_therapeutic_area'::varchar(40), ftf_drug_class_therapeutic_area.file_id) UNION ALL SELECT 'cleansed.ftf_drugs'::varchar(18) AS cleansed_table, ftf_drugs.file_id, count(*) AS counts FROM cleansed.ftf_drugs GROUP BY 'cleansed.ftf_drugs'::varchar(18), ftf_drugs.file_id) UNION ALL SELECT 'cleansed.ftf_formularies'::varchar(24) AS cleansed_table, ftf_formularies.file_id, count(*) AS counts FROM cleansed.ftf_formularies GROUP BY 'cleansed.ftf_formularies'::varchar(24), ftf_formularies.file_id) UNION ALL SELECT 'cleansed.ftf_health_plan_geography'::varchar(34) AS cleansed_table, ftf_health_plan_geography.file_id, count(*) AS counts FROM cleansed.ftf_health_plan_geography GROUP BY 'cleansed.ftf_health_plan_geography'::varchar(34), ftf_health_plan_geography.file_id) UNION ALL SELECT 'cleansed.ftf_health_plans'::varchar(25) AS cleansed_table, ftf_health_plans.file_id, count(*) AS counts FROM cleansed.ftf_health_plans GROUP BY 'cleansed.ftf_health_plans'::varchar(25), ftf_health_plans.file_id) UNION ALL SELECT 'cleansed.ftf_ims_bridge'::varchar(23) AS cleansed_table, ftf_ims_bridge.file_id, count(*) AS counts FROM cleansed.ftf_ims_bridge GROUP BY 'cleansed.ftf_ims_bridge'::varchar(23), ftf_ims_bridge.file_id) UNION ALL SELECT 'cleansed.ftf_pbms'::varchar(17) AS cleansed_table, ftf_pbms.file_id, count(*) AS counts FROM cleansed.ftf_pbms GROUP BY 'cleansed.ftf_pbms'::varchar(17), ftf_pbms.file_id) UNION ALL SELECT 'cleansed.ftf_restrictions'::varchar(25) AS cleansed_table, ftf_restrictions.file_id, count(*) AS counts FROM cleansed.ftf_restrictions GROUP BY 'cleansed.ftf_restrictions'::varchar(25), ftf_restrictions.file_id) UNION ALL SELECT 'cleansed.ftf_wk_bridge'::varchar(22) AS cleansed_table, ftf_wk_bridge.file_id, count(*) AS counts FROM cleansed.ftf_wk_bridge GROUP BY 'cleansed.ftf_wk_bridge'::varchar(22), ftf_wk_bridge.file_id) UNION ALL SELECT 'cleansed.ftf_tiers'::varchar(18) AS cleansed_table, ftf_tiers.file_id, count(*) AS counts FROM cleansed.ftf_tiers GROUP BY 'cleansed.ftf_tiers'::varchar(18), ftf_tiers.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_detail'::varchar(24) AS cleansed_table, ims_hcos_aco_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_detail GROUP BY 'hcos.ims_hcos_aco_detail'::varchar(24), ims_hcos_aco_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_detail_fact'::varchar(29) AS cleansed_table, ims_hcos_aco_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_detail_fact GROUP BY 'hcos.ims_hcos_aco_detail_fact'::varchar(29), ims_hcos_aco_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_org_fact'::varchar(26) AS cleansed_table, ims_hcos_aco_org_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_org_fact GROUP BY 'hcos.ims_hcos_aco_org_fact'::varchar(26), ims_hcos_aco_org_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_roster'::varchar(24) AS cleansed_table, ims_hcos_aco_roster.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_roster GROUP BY 'hcos.ims_hcos_aco_roster'::varchar(24), ims_hcos_aco_roster.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_type'::varchar(22) AS cleansed_table, ims_hcos_aco_type.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_type GROUP BY 'hcos.ims_hcos_aco_type'::varchar(22), ims_hcos_aco_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_affiliation_type'::varchar(30) AS cleansed_table, ims_hcos_affiliation_type.file_id, count(*) AS counts FROM hcos.ims_hcos_affiliation_type GROUP BY 'hcos.ims_hcos_affiliation_type'::varchar(30), ims_hcos_affiliation_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_cluster_type'::varchar(30) AS cleansed_table, ims_hcos_bed_cluster_type.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_cluster_type GROUP BY 'hcos.ims_hcos_bed_cluster_type'::varchar(30), ims_hcos_bed_cluster_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_fact'::varchar(22) AS cleansed_table, ims_hcos_bed_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_fact GROUP BY 'hcos.ims_hcos_bed_fact'::varchar(22), ims_hcos_bed_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_type'::varchar(22) AS cleansed_table, ims_hcos_bed_type.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_type GROUP BY 'hcos.ims_hcos_bed_type'::varchar(22), ims_hcos_bed_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_business'::varchar(22) AS cleansed_table, ims_hcos_business.file_id, count(*) AS counts FROM hcos.ims_hcos_business GROUP BY 'hcos.ims_hcos_business'::varchar(22), ims_hcos_business.file_id) UNION ALL SELECT 'hcos.ims_hcos_business_detail'::varchar(29) AS cleansed_table, ims_hcos_business_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_business_detail GROUP BY 'hcos.ims_hcos_business_detail'::varchar(29), ims_hcos_business_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_business_detail_fact'::varchar(34) AS cleansed_table, ims_hcos_business_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_business_detail_fact GROUP BY 'hcos.ims_hcos_business_detail_fact'::varchar(34), ims_hcos_business_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_class_of_trade'::varchar(28) AS cleansed_table, ims_hcos_class_of_trade.file_id, count(*) AS counts FROM hcos.ims_hcos_class_of_trade GROUP BY 'hcos.ims_hcos_class_of_trade'::varchar(28), ims_hcos_class_of_trade.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_code'::varchar(27) AS cleansed_table, ims_hcos_clinical_code.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_code GROUP BY 'hcos.ims_hcos_clinical_code'::varchar(27), ims_hcos_clinical_code.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact'::varchar(27) AS cleansed_table, ims_hcos_clinical_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact GROUP BY 'hcos.ims_hcos_clinical_fact'::varchar(27), ims_hcos_clinical_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact_national'::varchar(36) AS cleansed_table, ims_hcos_clinical_fact_national.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact_national GROUP BY 'hcos.ims_hcos_clinical_fact_national'::varchar(36), ims_hcos_clinical_fact_national.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact_state'::varchar(33) AS cleansed_table, ims_hcos_clinical_fact_state.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact_state GROUP BY 'hcos.ims_hcos_clinical_fact_state'::varchar(33), ims_hcos_clinical_fact_state.file_id) UNION ALL SELECT 'hcos.ims_hcos_contact_affiliation_fact'::varchar(38) AS cleansed_table, ims_hcos_contact_affiliation_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_contact_affiliation_fact GROUP BY 'hcos.ims_hcos_contact_affiliation_fact'::varchar(38), ims_hcos_contact_affiliation_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_cot_fact'::varchar(22) AS cleansed_table, ims_hcos_cot_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_cot_fact GROUP BY 'hcos.ims_hcos_cot_fact'::varchar(22), ims_hcos_cot_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_financial_fact'::varchar(28) AS cleansed_table, ims_hcos_financial_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_financial_fact GROUP BY 'hcos.ims_hcos_financial_fact'::varchar(28), ims_hcos_financial_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_fact'::varchar(29) AS cleansed_table, ims_hcos_identifier_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_fact GROUP BY 'hcos.ims_hcos_identifier_fact'::varchar(29), ims_hcos_identifier_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_type'::varchar(29) AS cleansed_table, ims_hcos_identifier_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_type GROUP BY 'hcos.ims_hcos_identifier_type'::varchar(29), ims_hcos_identifier_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_category_type'::varchar(38) AS cleansed_table, ims_hcos_identifier_category_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_category_type GROUP BY 'hcos.ims_hcos_identifier_category_type'::varchar(38), ims_hcos_identifier_category_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_term_type'::varchar(34) AS cleansed_table, ims_hcos_identifier_term_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_term_type GROUP BY 'hcos.ims_hcos_identifier_term_type'::varchar(34), ims_hcos_identifier_term_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional'::varchar(26) AS cleansed_table, ims_hcos_professional.file_id, count(*) AS counts FROM hcos.ims_hcos_professional GROUP BY 'hcos.ims_hcos_professional'::varchar(26), ims_hcos_professional.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_detail'::varchar(33) AS cleansed_table, ims_hcos_professional_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_detail GROUP BY 'hcos.ims_hcos_professional_detail'::varchar(33), ims_hcos_professional_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_detail_fact'::varchar(38) AS cleansed_table, ims_hcos_professional_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_detail_fact GROUP BY 'hcos.ims_hcos_professional_detail_fact'::varchar(38), ims_hcos_professional_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_specialty_fact'::varchar(41) AS cleansed_table, ims_hcos_professional_specialty_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_specialty_fact GROUP BY 'hcos.ims_hcos_professional_specialty_fact'::varchar(41), ims_hcos_professional_specialty_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_specialty'::varchar(36) AS cleansed_table, ims_hcos_professional_specialty.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_specialty GROUP BY 'hcos.ims_hcos_professional_specialty'::varchar(36), ims_hcos_professional_specialty.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_title'::varchar(32) AS cleansed_table, ims_hcos_professional_title.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_title GROUP BY 'hcos.ims_hcos_professional_title'::varchar(32), ims_hcos_professional_title.file_id) UNION ALL SELECT 'hcos.ims_hcos_provider_affiliation_fact'::varchar(39) AS cleansed_table, ims_hcos_provider_affiliation_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_provider_affiliation_fact GROUP BY 'hcos.ims_hcos_provider_affiliation_fact'::varchar(39), ims_hcos_provider_affiliation_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_relationship_fact'::varchar(31) AS cleansed_table, ims_hcos_relationship_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_relationship_fact GROUP BY 'hcos.ims_hcos_relationship_fact'::varchar(31), ims_hcos_relationship_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_relationship_type'::varchar(31) AS cleansed_table, ims_hcos_relationship_type.file_id, count(*) AS counts FROM hcos.ims_hcos_relationship_type GROUP BY 'hcos.ims_hcos_relationship_type'::varchar(31), ims_hcos_relationship_type.file_id) UNION ALL SELECT 'cleansed.i3_rx_by_strength'::varchar(26) AS cleansed_table, i3_rx_by_strength.file_id, count(*) AS counts FROM cleansed.i3_rx_by_strength GROUP BY 'cleansed.i3_rx_by_strength'::varchar(26), i3_rx_by_strength.file_id) UNION ALL SELECT 'cleansed.i3_rx'::varchar(14) AS cleansed_table, i3_rx.file_id, count(*) AS counts FROM cleansed.i3_rx GROUP BY 'cleansed.i3_rx'::varchar(14), i3_rx.file_id) UNION ALL SELECT 'cleansed.i3_rx_tysabri'::varchar(22) AS cleansed_table, i3_rx_tysabri.file_id, count(*) AS counts FROM cleansed.i3_rx_tysabri GROUP BY 'cleansed.i3_rx_tysabri'::varchar(22), i3_rx_tysabri.file_id) UNION ALL SELECT 'veeva.ids_call_detail'::varchar(21) AS cleansed_table, ids_call_detail.file_id, count(*) AS counts FROM veeva.ids_call_detail GROUP BY 'veeva.ids_call_detail'::varchar(21), ids_call_detail.file_id) UNION ALL SELECT 'veeva.ids_call'::varchar(14) AS cleansed_table, ids_call.file_id, count(*) AS counts FROM veeva.ids_call GROUP BY 'veeva.ids_call'::varchar(14), ids_call.file_id) UNION ALL SELECT 'cleansed.ims_product_list_monthly'::varchar(33) AS cleansed_table, ims_product_list_monthly.file_id, count(*) AS counts FROM cleansed.ims_product_list_monthly GROUP BY 'cleansed.ims_product_list_monthly'::varchar(33), ims_product_list_monthly.file_id) UNION ALL SELECT 'cleansed.ims_product_list_weekly'::varchar(32) AS cleansed_table, ims_product_list_weekly.file_id, count(*) AS counts FROM cleansed.ims_product_list_weekly GROUP BY 'cleansed.ims_product_list_weekly'::varchar(32), ims_product_list_weekly.file_id) UNION ALL SELECT 'cleansed.ims_mhj_cnt_m'::varchar(22) AS cleansed_table, ims_mhj_cnt_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_cnt_m GROUP BY 'cleansed.ims_mhj_cnt_m'::varchar(22), ims_mhj_cnt_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_cnt_w'::varchar(22) AS cleansed_table, ims_mhj_cnt_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_cnt_w GROUP BY 'cleansed.ims_mhj_cnt_w'::varchar(22), ims_mhj_cnt_w.file_id) UNION ALL SELECT 'cleansed.ims_mhj_control_m'::varchar(26) AS cleansed_table, ims_mhj_control_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_control_m GROUP BY 'cleansed.ims_mhj_control_m'::varchar(26), ims_mhj_control_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_control_w'::varchar(26) AS cleansed_table, ims_mhj_control_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_control_w GROUP BY 'cleansed.ims_mhj_control_w'::varchar(26), ims_mhj_control_w.file_id) UNION ALL SELECT 'cleansed.ims_mhj_qty_m'::varchar(22) AS cleansed_table, ims_mhj_qty_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_qty_m GROUP BY 'cleansed.ims_mhj_qty_m'::varchar(22), ims_mhj_qty_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_qty_w'::varchar(22) AS cleansed_table, ims_mhj_qty_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_qty_w GROUP BY 'cleansed.ims_mhj_qty_w'::varchar(22), ims_mhj_qty_w.file_id) UNION ALL SELECT 'cleansed.ims_pbm_xref'::varchar(21) AS cleansed_table, ims_pbm_xref.file_id, count(*) AS counts FROM cleansed.ims_pbm_xref GROUP BY 'cleansed.ims_pbm_xref'::varchar(21), ims_pbm_xref.file_id) UNION ALL SELECT 'cleansed.ims_plan_xref'::varchar(22) AS cleansed_table, ims_plan_xref.file_id, count(*) AS counts FROM cleansed.ims_plan_xref GROUP BY 'cleansed.ims_plan_xref'::varchar(22), ims_plan_xref.file_id) UNION ALL SELECT 'cleansed.ims_plan_xref_accelerated'::varchar(34) AS cleansed_table, ims_plan_xref_accelerated.file_id, count(*) AS counts FROM cleansed.ims_plan_xref_accelerated GROUP BY 'cleansed.ims_plan_xref_accelerated'::varchar(34), ims_plan_xref_accelerated.file_id) UNION ALL SELECT 'cleansed.kc_sales_zip_to_territory'::varchar(34) AS cleansed_table, kc_sales_zip_to_territory.file_id, count(*) AS counts FROM cleansed.kc_sales_zip_to_territory GROUP BY 'cleansed.kc_sales_zip_to_territory'::varchar(34), kc_sales_zip_to_territory.file_id) UNION ALL SELECT 'cleansed.knipper_samples_shipped'::varchar(32) AS cleansed_table, knipper_samples_shipped.file_id, count(*) AS counts FROM cleansed.knipper_samples_shipped GROUP BY 'cleansed.knipper_samples_shipped'::varchar(32), knipper_samples_shipped.file_id) UNION ALL SELECT 'cleansed.mm_ram_to_state'::varchar(24) AS cleansed_table, mm_ram_to_state.file_id, count(*) AS counts FROM cleansed.mm_ram_to_state GROUP BY 'cleansed.mm_ram_to_state'::varchar(24), mm_ram_to_state.file_id) UNION ALL SELECT 'cleansed.omnicare_sales'::varchar(23) AS cleansed_table, omnicare_sales.file_id, count(*) AS counts FROM cleansed.omnicare_sales GROUP BY 'cleansed.omnicare_sales'::varchar(23), omnicare_sales.file_id) UNION ALL SELECT 'cleansed.onc_account_targets'::varchar(28) AS cleansed_table, onc_account_targets.file_id, count(*) AS counts FROM cleansed.onc_account_targets GROUP BY 'cleansed.onc_account_targets'::varchar(28), onc_account_targets.file_id) UNION ALL SELECT 'cleansed.onc_call_detail_goals'::varchar(30) AS cleansed_table, onc_call_detail_goals.file_id, count(*) AS counts FROM cleansed.onc_call_detail_goals GROUP BY 'cleansed.onc_call_detail_goals'::varchar(30), onc_call_detail_goals.file_id) UNION ALL SELECT 'cleansed.ims_ddd_monthly_retail_onc'::varchar(35) AS cleansed_table, ims_ddd_monthly_retail_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_monthly_retail_onc GROUP BY 'cleansed.ims_ddd_monthly_retail_onc'::varchar(35), ims_ddd_monthly_retail_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_weekly_retail_onc'::varchar(34) AS cleansed_table, ims_ddd_weekly_retail_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_weekly_retail_onc GROUP BY 'cleansed.ims_ddd_weekly_retail_onc'::varchar(34), ims_ddd_weekly_retail_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_monthly_dollars'::varchar(40) AS cleansed_table, ims_ddd_md_demo_monthly_dollars.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_monthly_dollars GROUP BY 'cleansed.ims_ddd_md_demo_monthly_dollars'::varchar(40), ims_ddd_md_demo_monthly_dollars.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_monthly_qty'::varchar(36) AS cleansed_table, ims_ddd_md_demo_monthly_qty.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_monthly_qty GROUP BY 'cleansed.ims_ddd_md_demo_monthly_qty'::varchar(36), ims_ddd_md_demo_monthly_qty.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_monthly_dollars_onc'::varchar(39) AS cleansed_table, ims_ddd_md_monthly_dollars_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_monthly_dollars_onc GROUP BY 'cleansed.ims_ddd_md_monthly_dollars_onc'::varchar(39), ims_ddd_md_monthly_dollars_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_monthly_quantity_onc'::varchar(40) AS cleansed_table, ims_ddd_md_monthly_quantity_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_monthly_quantity_onc GROUP BY 'cleansed.ims_ddd_md_monthly_quantity_onc'::varchar(40), ims_ddd_md_monthly_quantity_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_weekly'::varchar(31) AS cleansed_table, ims_ddd_md_demo_weekly.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_weekly GROUP BY 'cleansed.ims_ddd_md_demo_weekly'::varchar(31), ims_ddd_md_demo_weekly.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_weekly_sales_onc'::varchar(36) AS cleansed_table, ims_ddd_md_weekly_sales_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_weekly_sales_onc GROUP BY 'cleansed.ims_ddd_md_weekly_sales_onc'::varchar(36), ims_ddd_md_weekly_sales_onc.file_id) UNION ALL SELECT 'cleansed.onc_manual_fcrs'::varchar(24) AS cleansed_table, onc_manual_fcrs.file_id, count(*) AS counts FROM cleansed.onc_manual_fcrs GROUP BY 'cleansed.onc_manual_fcrs'::varchar(24), onc_manual_fcrs.file_id) UNION ALL SELECT 'cleansed.onc_sales_quotas'::varchar(25) AS cleansed_table, onc_sales_quotas.file_id, count(*) AS counts FROM cleansed.onc_sales_quotas GROUP BY 'cleansed.onc_sales_quotas'::varchar(25), onc_sales_quotas.file_id) UNION ALL SELECT 'cleansed.ims_ddd_non_retail_pcs'::varchar(31) AS cleansed_table, ims_ddd_non_retail_pcs.file_id, count(*) AS counts FROM cleansed.ims_ddd_non_retail_pcs GROUP BY 'cleansed.ims_ddd_non_retail_pcs'::varchar(31), ims_ddd_non_retail_pcs.file_id) UNION ALL SELECT 'cleansed.ims_ddd_retail_pcs'::varchar(27) AS cleansed_table, ims_ddd_retail_pcs.file_id, count(*) AS counts FROM cleansed.ims_ddd_retail_pcs GROUP BY 'cleansed.ims_ddd_retail_pcs'::varchar(27), ims_ddd_retail_pcs.file_id) UNION ALL SELECT 'cleansed.prime_rx'::varchar(17) AS cleansed_table, prime_rx.file_id, count(*) AS counts FROM cleansed.prime_rx GROUP BY 'cleansed.prime_rx'::varchar(17), prime_rx.file_id) UNION ALL SELECT 'cleansed.rems_facility'::varchar(22) AS cleansed_table, rems_facility.file_id, count(*) AS counts FROM cleansed.rems_facility GROUP BY 'cleansed.rems_facility'::varchar(22), rems_facility.file_id) UNION ALL SELECT 'cleansed.rems_pharmacy'::varchar(22) AS cleansed_table, rems_pharmacy.file_id, count(*) AS counts FROM cleansed.rems_pharmacy GROUP BY 'cleansed.rems_pharmacy'::varchar(22), rems_pharmacy.file_id) UNION ALL SELECT 'cleansed.rems_prescriber'::varchar(24) AS cleansed_table, rems_prescriber.file_id, count(*) AS counts FROM cleansed.rems_prescriber GROUP BY 'cleansed.rems_prescriber'::varchar(24), rems_prescriber.file_id) UNION ALL SELECT 'cleansed.specialty_pharmacy_cm_lookup'::varchar(37) AS cleansed_table, specialty_pharmacy_cm_lookup.file_id, count(*) AS counts FROM cleansed.specialty_pharmacy_cm_lookup GROUP BY 'cleansed.specialty_pharmacy_cm_lookup'::varchar(37), specialty_pharmacy_cm_lookup.file_id) UNION ALL SELECT 'cleansed.specialty_pharmacy_lookups'::varchar(35) AS cleansed_table, specialty_pharmacy_lookups.file_id, count(*) AS counts FROM cleansed.specialty_pharmacy_lookups GROUP BY 'cleansed.specialty_pharmacy_lookups'::varchar(35), specialty_pharmacy_lookups.file_id) UNION ALL SELECT 'cleansed.tb_cb_accounts'::varchar(23) AS cleansed_table, tb_cb_accounts.file_id, count(*) AS counts FROM cleansed.tb_cb_accounts GROUP BY 'cleansed.tb_cb_accounts'::varchar(23), tb_cb_accounts.file_id) UNION ALL SELECT 'cleansed.tb_cb_transactions'::varchar(27) AS cleansed_table, tb_cb_transactions.file_id, count(*) AS counts FROM cleansed.tb_cb_transactions GROUP BY 'cleansed.tb_cb_transactions'::varchar(27), tb_cb_transactions.file_id) UNION ALL SELECT 'cleansed.tb_ds_accounts'::varchar(23) AS cleansed_table, tb_ds_accounts.file_id, count(*) AS counts FROM cleansed.tb_ds_accounts GROUP BY 'cleansed.tb_ds_accounts'::varchar(23), tb_ds_accounts.file_id) UNION ALL SELECT 'cleansed.tb_ds_transactions'::varchar(27) AS cleansed_table, tb_ds_transactions.file_id, count(*) AS counts FROM cleansed.tb_ds_transactions GROUP BY 'cleansed.tb_ds_transactions'::varchar(27), tb_ds_transactions.file_id) UNION ALL SELECT 'veeva.time_off_territory_kc'::varchar(27) AS cleansed_table, time_off_territory_kc.file_id, count(*) AS counts FROM veeva.time_off_territory_kc GROUP BY 'veeva.time_off_territory_kc'::varchar(27), time_off_territory_kc.file_id) UNION ALL SELECT 'veeva.time_off_territory'::varchar(24) AS cleansed_table, time_off_territory.file_id, count(*) AS counts FROM veeva.time_off_territory GROUP BY 'veeva.time_off_territory'::varchar(24), time_off_territory.file_id) UNION ALL SELECT 'cleansed.publicis_touchpoint_call'::varchar(33) AS cleansed_table, publicis_touchpoint_call.file_id, count(*) AS counts FROM cleansed.publicis_touchpoint_call GROUP BY 'cleansed.publicis_touchpoint_call'::varchar(33), publicis_touchpoint_call.file_id) UNION ALL SELECT 'cleansed.publicis_touchpoint_presentation'::varchar(41) AS cleansed_table, publicis_touchpoint_presentation.file_id, count(*) AS counts FROM cleansed.publicis_touchpoint_presentation GROUP BY 'cleansed.publicis_touchpoint_presentation'::varchar(41), publicis_touchpoint_presentation.file_id) UNION ALL SELECT 'cleansed.anda_sales_tw'::varchar(22) AS cleansed_table, anda_sales_tw.file_id, count(*) AS counts FROM cleansed.anda_sales_tw GROUP BY 'cleansed.anda_sales_tw'::varchar(22), anda_sales_tw.file_id) UNION ALL SELECT 'cleansed.biologics_sales_tw'::varchar(27) AS cleansed_table, biologics_sales_tw.file_id, count(*) AS counts FROM cleansed.biologics_sales_tw GROUP BY 'cleansed.biologics_sales_tw'::varchar(27), biologics_sales_tw.file_id) UNION ALL SELECT 'cleansed.hd_smith_sales_tw'::varchar(26) AS cleansed_table, hd_smith_sales_tw.file_id, count(*) AS counts FROM cleansed.hd_smith_sales_tw GROUP BY 'cleansed.hd_smith_sales_tw'::varchar(26), hd_smith_sales_tw.file_id) UNION ALL SELECT 'cleansed.ics_account_tw'::varchar(23) AS cleansed_table, ics_account_tw.file_id, count(*) AS counts FROM cleansed.ics_account_tw GROUP BY 'cleansed.ics_account_tw'::varchar(23), ics_account_tw.file_id) UNION ALL SELECT 'cleansed.ics_sales_tw'::varchar(21) AS cleansed_table, ics_sales_tw.file_id, count(*) AS counts FROM cleansed.ics_sales_tw GROUP BY 'cleansed.ics_sales_tw'::varchar(21), ics_sales_tw.file_id) UNION ALL SELECT 'veeva.account'::varchar(13) AS cleansed_table, account.file_id, count(*) AS counts FROM veeva.account GROUP BY 'veeva.account'::varchar(13), account.file_id) UNION ALL SELECT 'veeva.accountshare'::varchar(18) AS cleansed_table, accountshare.file_id, count(*) AS counts FROM veeva.accountshare GROUP BY 'veeva.accountshare'::varchar(18), accountshare.file_id) UNION ALL SELECT 'veeva.account_merge_history'::varchar(27) AS cleansed_table, account_merge_history.file_id, count(*) AS counts FROM veeva.account_merge_history GROUP BY 'veeva.account_merge_history'::varchar(27), account_merge_history.file_id) UNION ALL SELECT 'veeva.address'::varchar(13) AS cleansed_table, address.file_id, count(*) AS counts FROM veeva.address GROUP BY 'veeva.address'::varchar(13), address.file_id) UNION ALL SELECT 'veeva.affiliation'::varchar(17) AS cleansed_table, affiliation.file_id, count(*) AS counts FROM veeva.affiliation GROUP BY 'veeva.affiliation'::varchar(17), affiliation.file_id) UNION ALL SELECT 'veeva.assessment'::varchar(16) AS cleansed_table, assessment.file_id, count(*) AS counts FROM veeva.assessment GROUP BY 'veeva.assessment'::varchar(16), assessment.file_id) UNION ALL SELECT 'veeva.call_goal'::varchar(15) AS cleansed_table, call_goal.file_id, count(*) AS counts FROM veeva.call_goal GROUP BY 'veeva.call_goal'::varchar(15), call_goal.file_id) UNION ALL SELECT 'veeva.call_detail'::varchar(17) AS cleansed_table, call_detail.file_id, count(*) AS counts FROM veeva.call_detail GROUP BY 'veeva.call_detail'::varchar(17), call_detail.file_id) UNION ALL SELECT 'veeva.call_key_message'::varchar(22) AS cleansed_table, call_key_message.file_id, count(*) AS counts FROM veeva.call_key_message GROUP BY 'veeva.call_key_message'::varchar(22), call_key_message.file_id) UNION ALL SELECT 'veeva.call_sample'::varchar(17) AS cleansed_table, call_sample.file_id, count(*) AS counts FROM veeva.call_sample GROUP BY 'veeva.call_sample'::varchar(17), call_sample.file_id) UNION ALL SELECT 'veeva.call'::varchar(10) AS cleansed_table, call.file_id, count(*) AS counts FROM veeva.call GROUP BY 'veeva.call'::varchar(10), call.file_id) UNION ALL SELECT 'veeva.call_history'::varchar(18) AS cleansed_table, call_history.file_id, count(*) AS counts FROM veeva.call_history GROUP BY 'veeva.call_history'::varchar(18), call_history.file_id) UNION ALL SELECT 'veeva.deciles'::varchar(13) AS cleansed_table, deciles.file_id, count(*) AS counts FROM veeva.deciles GROUP BY 'veeva.deciles'::varchar(13), deciles.file_id) UNION ALL SELECT 'veeva.group'::varchar(11) AS cleansed_table, "group".file_id, count(*) AS counts FROM veeva."group" GROUP BY 'veeva.group'::varchar(11), "group".file_id) UNION ALL SELECT 'veeva.key_message'::varchar(17) AS cleansed_table, key_message.file_id, count(*) AS counts FROM veeva.key_message GROUP BY 'veeva.key_message'::varchar(17), key_message.file_id) UNION ALL SELECT 'veeva.medical_inquiry'::varchar(21) AS cleansed_table, medical_inquiry.file_id, count(*) AS counts FROM veeva.medical_inquiry GROUP BY 'veeva.medical_inquiry'::varchar(21), medical_inquiry.file_id) UNION ALL SELECT 'veeva.product_metrics'::varchar(21) AS cleansed_table, product_metrics.file_id, count(*) AS counts FROM veeva.product_metrics GROUP BY 'veeva.product_metrics'::varchar(21), product_metrics.file_id) UNION ALL SELECT 'veeva.product'::varchar(13) AS cleansed_table, product.file_id, count(*) AS counts FROM veeva.product GROUP BY 'veeva.product'::varchar(13), product.file_id) UNION ALL SELECT 'veeva.survey_question_response'::varchar(30) AS cleansed_table, survey_question_response.file_id, count(*) AS counts FROM veeva.survey_question_response GROUP BY 'veeva.survey_question_response'::varchar(30), survey_question_response.file_id) UNION ALL SELECT 'veeva.recordtype'::varchar(16) AS cleansed_table, recordtype.file_id, count(*) AS counts FROM veeva.recordtype GROUP BY 'veeva.recordtype'::varchar(16), recordtype.file_id) UNION ALL SELECT 'veeva.survey_question'::varchar(21) AS cleansed_table, survey_question.file_id, count(*) AS counts FROM veeva.survey_question GROUP BY 'veeva.survey_question'::varchar(21), survey_question.file_id) UNION ALL SELECT 'veeva.survey_target'::varchar(19) AS cleansed_table, survey_target.file_id, count(*) AS counts FROM veeva.survey_target GROUP BY 'veeva.survey_target'::varchar(19), survey_target.file_id) UNION ALL SELECT 'veeva.survey'::varchar(12) AS cleansed_table, survey.file_id, count(*) AS counts FROM veeva.survey GROUP BY 'veeva.survey'::varchar(12), survey.file_id) UNION ALL SELECT 'veeva.sync_tracking'::varchar(19) AS cleansed_table, sync_tracking.file_id, count(*) AS counts FROM veeva.sync_tracking GROUP BY 'veeva.sync_tracking'::varchar(19), sync_tracking.file_id) UNION ALL SELECT 'veeva.territory'::varchar(15) AS cleansed_table, territory.file_id, count(*) AS counts FROM veeva.territory GROUP BY 'veeva.territory'::varchar(15), territory.file_id) UNION ALL SELECT 'veeva.tsf'::varchar(9) AS cleansed_table, tsf.file_id, count(*) AS counts FROM veeva.tsf GROUP BY 'veeva.tsf'::varchar(9), tsf.file_id) UNION ALL SELECT 'veeva.veeva_user'::varchar(16) AS cleansed_table, veeva_user.file_id, count(*) AS counts FROM veeva.veeva_user GROUP BY 'veeva.veeva_user'::varchar(16), veeva_user.file_id) UNION ALL SELECT 'veeva.user_role'::varchar(15) AS cleansed_table, user_role.file_id, count(*) AS counts FROM veeva.user_role GROUP BY 'veeva.user_role'::varchar(15), user_role.file_id) UNION ALL SELECT 'veeva.user_territory'::varchar(20) AS cleansed_table, user_territory.file_id, count(*) AS counts FROM veeva.user_territory GROUP BY 'veeva.user_territory'::varchar(20), user_territory.file_id) UNION ALL SELECT 'cleansed.valuecentric_867'::varchar(25) AS cleansed_table, valuecentric_867.file_id, count(*) AS counts FROM cleansed.valuecentric_867 GROUP BY 'cleansed.valuecentric_867'::varchar(25), valuecentric_867.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tc'::varchar(24) AS cleansed_table, zs_call_plan_tc.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tc GROUP BY 'cleansed.zs_call_plan_tc'::varchar(24), zs_call_plan_tc.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tn'::varchar(24) AS cleansed_table, zs_call_plan_tn.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tn GROUP BY 'cleansed.zs_call_plan_tn'::varchar(24), zs_call_plan_tn.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tp'::varchar(24) AS cleansed_table, zs_call_plan_tp.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tp GROUP BY 'cleansed.zs_call_plan_tp'::varchar(24), zs_call_plan_tp.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tr'::varchar(24) AS cleansed_table, zs_call_plan_tr.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tr GROUP BY 'cleansed.zs_call_plan_tr'::varchar(24), zs_call_plan_tr.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tw'::varchar(24) AS cleansed_table, zs_call_plan_tw.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tw GROUP BY 'cleansed.zs_call_plan_tw'::varchar(24), zs_call_plan_tw.file_id) UNION ALL SELECT 'cleansed.kc_hr_job_titles'::varchar(25) AS cleansed_table, kc_hr_job_titles.file_id, count(*) AS counts FROM cleansed.kc_hr_job_titles GROUP BY 'cleansed.kc_hr_job_titles'::varchar(25), kc_hr_job_titles.file_id) UNION ALL SELECT 'cleansed.kc_hr_people'::varchar(21) AS cleansed_table, kc_hr_people.file_id, count(*) AS counts FROM cleansed.kc_hr_people GROUP BY 'cleansed.kc_hr_people'::varchar(21), kc_hr_people.file_id) UNION ALL SELECT 'cleansed.kc_hr_people_addresses'::varchar(31) AS cleansed_table, kc_hr_people_addresses.file_id, count(*) AS counts FROM cleansed.kc_hr_people_addresses GROUP BY 'cleansed.kc_hr_people_addresses'::varchar(31), kc_hr_people_addresses.file_id) UNION ALL SELECT 'cleansed.kc_hr_people_phones'::varchar(28) AS cleansed_table, kc_hr_people_phones.file_id, count(*) AS counts FROM cleansed.kc_hr_people_phones GROUP BY 'cleansed.kc_hr_people_phones'::varchar(28), kc_hr_people_phones.file_id) UNION ALL SELECT 'cleansed.kc_hr_phones'::varchar(21) AS cleansed_table, kc_hr_phones.file_id, count(*) AS counts FROM cleansed.kc_hr_phones GROUP BY 'cleansed.kc_hr_phones'::varchar(21), kc_hr_phones.file_id) UNION ALL SELECT 'cleansed.kc_hr_territories'::varchar(26) AS cleansed_table, kc_hr_territories.file_id, count(*) AS counts FROM cleansed.kc_hr_territories GROUP BY 'cleansed.kc_hr_territories'::varchar(26), kc_hr_territories.file_id) UNION ALL SELECT 'customer_master.hco_demo'::varchar(24) AS cleansed_table, hco_demo.file_id, count(*) AS counts FROM customer_master.hco_demo GROUP BY 'customer_master.hco_demo'::varchar(24), hco_demo.file_id) UNION ALL SELECT 'customer_master.hcp_demo'::varchar(24) AS cleansed_table, hcp_demo.file_id, count(*) AS counts FROM customer_master.hcp_demo GROUP BY 'customer_master.hcp_demo'::varchar(24), hcp_demo.file_id) UNION ALL SELECT 'customer_master.tvcmid_merges'::varchar(29) AS cleansed_table, tvcmid_merges.file_id, count(*) AS counts FROM customer_master.tvcmid_merges GROUP BY 'customer_master.tvcmid_merges'::varchar(29), tvcmid_merges.file_id) UNION ALL SELECT 'customer_master.tvcmid_xref'::varchar(27) AS cleansed_table, tvcmid_xref.file_id, count(*) AS counts FROM customer_master.tvcmid_xref GROUP BY 'customer_master.tvcmid_xref'::varchar(27), tvcmid_xref.file_id) UNION ALL SELECT 'cleansed.nw_hr_sales_loa'::varchar(24) AS cleansed_table, nw_hr_sales_loa.file_id, count(*) AS counts FROM cleansed.nw_hr_sales_loa GROUP BY 'cleansed.nw_hr_sales_loa'::varchar(24), nw_hr_sales_loa.file_id) UNION ALL SELECT 'cleansed.nw_hr_sales_roster'::varchar(27) AS cleansed_table, nw_hr_sales_roster.file_id, count(*) AS counts FROM cleansed.nw_hr_sales_roster GROUP BY 'cleansed.nw_hr_sales_roster'::varchar(27), nw_hr_sales_roster.file_id) UNION ALL SELECT 'cleansed.nw_hr_terr_id_change'::varchar(29) AS cleansed_table, nw_hr_terr_id_change.file_id, count(*) AS counts FROM cleansed.nw_hr_terr_id_change GROUP BY 'cleansed.nw_hr_terr_id_change'::varchar(29), nw_hr_terr_id_change.file_id) A ORDER BY A.cleansed_table, A.file_id;

CREATE  VIEW sandbox.create_paragard_anda_sales AS
SELECT sh.source_customer_id AS "BP #", NULL AS "Ortho E", sh.customer_name AS "BP Name", coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1) AS "Ship-to Street", sh.ship_to_city AS "Ship-to City", sh.ship_to_state AS "Ship-to State", sh.ship_to_zip AS "Ship-to ZipCd", NULL AS "Ship-to Ctry", NULL AS "Ship-to Phone", NULL AS "Ship-to Fax", NULL AS "Ship-to Email", ad.address AS "Bill-to Street", ad.city AS "Bill-to City", ad.state AS "Bill-to State", ad.zip_code AS "Bill-to ZipCd", NULL AS "Bill-to Ctry", NULL AS "Bill-to Phone", NULL AS "Bill-to Fax", NULL AS "Bill-to Email", CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END AS "Class of Trade", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS "Invoice #", CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END AS "Del Amt", to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS "Inv Date", CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END AS Packs, NULL AS UnitPrice, NULL AS Territory, NULL AS "Order Type Cd", NULL AS "Order Type Desc", NULL AS LOBCdDesc, NULL AS PriceMatrixDef, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))) AS ParentBPCd, NULL AS ParentBPCdDesc, NULL AS GrandParentBPCdDesc, NULL AS "PO#", NULL AS "UPS#", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS OrdNbr, NULL AS OrdLnNbr, NULL AS DiscAmt, NULL AS WhseCd, 'ANDA'::varchar(4) AS DATA_SOURCE, '51285020401'::varchar(11) AS NDC11_CODE FROM (datamart.specialty_pharmacy_shipment sh LEFT JOIN (SELECT tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code FROM datamart.tw_address) ad ON ((sh.tw_bill_to_address_id = ad.address_id))) WHERE ((sh.basket_name ~~ '%PARAGARD%'::varchar(10)) AND (sh.specialty_pharmacy_data_source = 'Anda'::varchar(4)) AND (sh.ship_date >= add_months(trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)), (-1))) AND (sh.ship_date < trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)))) GROUP BY sh.source_customer_id, NULL, sh.customer_name, coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1), sh.ship_to_city, sh.ship_to_state, sh.ship_to_zip, ad.address, ad.city, ad.state, ad.zip_code, CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END, CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END, CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END, to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)), CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END, CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))), 'ANDA'::varchar(4), '51285020401'::varchar(11);

CREATE  VIEW teva_ingestion.EXT_KNIPPER_SAMPLES AS
 SELECT btrim(EXT_KNIPPER_SAMPLES_src.TVCMID) AS TVCMID,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_VEEVA_ID) AS HCP_VEEVA_ID,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_FIRST_NAME) AS HCP_FIRST_NAME,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_MIDDLE_NAME) AS HCP_MIDDLE_NAME,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_LAST_NAME) AS HCP_LAST_NAME,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_DESIGNATION) AS HCP_DESIGNATION,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_STATE_LICENSE_NUMBER) AS HCP_STATE_LICENSE_NUMBER,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_ADDRESS1) AS HCP_ADDRESS1,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_ADDRESS2) AS HCP_ADDRESS2,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_ADDRESS3) AS HCP_ADDRESS3,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_CITY) AS HCP_CITY,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_STATE) AS HCP_STATE,
        btrim(EXT_KNIPPER_SAMPLES_src.HCP_ZIP) AS HCP_ZIP,
        btrim(EXT_KNIPPER_SAMPLES_src.DEA_LICENSE_NUMBER) AS DEA_LICENSE_NUMBER,
        btrim(EXT_KNIPPER_SAMPLES_src.ORDER_SOURCE_ORDER_ID) AS ORDER_SOURCE_ORDER_ID,
        btrim(EXT_KNIPPER_SAMPLES_src.NDC) AS NDC,
        CASE WHEN (EXT_KNIPPER_SAMPLES_src.QUANTITY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_KNIPPER_SAMPLES_src.QUANTITY))::int END AS QUANTITY,
        btrim(EXT_KNIPPER_SAMPLES_src.ORDER_SOURCE_JOB_CODE) AS ORDER_SOURCE_JOB_CODE,
        btrim(EXT_KNIPPER_SAMPLES_src.ORDER_SOURCE_JOB_CODE_DESCRIPTION) AS ORDER_SOURCE_JOB_CODE_DESCRIPTION,
        CASE WHEN (EXT_KNIPPER_SAMPLES_src.SHIP_DATE = ''::varchar) THEN NULL::date ELSE (btrim(EXT_KNIPPER_SAMPLES_src.SHIP_DATE))::date END AS SHIP_DATE,
        EXT_KNIPPER_SAMPLES_src.batch_id,
        EXT_KNIPPER_SAMPLES_src.row_id,
        EXT_KNIPPER_SAMPLES_src.update_ts
 FROM teva_ingestion.EXT_KNIPPER_SAMPLES_src;

CREATE  VIEW raw.ext_knipper_samples AS
 SELECT src.TVCMID,
        src.HCP_VEEVA_ID,
        src.HCP_FIRST_NAME,
        src.HCP_MIDDLE_NAME,
        src.HCP_LAST_NAME,
        src.HCP_DESIGNATION,
        src.HCP_STATE_LICENSE_NUMBER,
        src.HCP_ADDRESS1,
        src.HCP_ADDRESS2,
        src.HCP_ADDRESS3,
        src.HCP_CITY,
        src.HCP_STATE,
        src.HCP_ZIP,
        src.DEA_LICENSE_NUMBER,
        src.ORDER_SOURCE_ORDER_ID,
        src.NDC,
        src.QUANTITY,
        src.ORDER_SOURCE_JOB_CODE,
        src.ORDER_SOURCE_JOB_CODE_DESCRIPTION,
        src.SHIP_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_KNIPPER_SAMPLES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_KNIPPER_SAMPLES'::varchar(19)))));

CREATE  VIEW teva_ingestion.EXT_ACTIVITY_LINE_ITEM AS
 SELECT btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_ID) AS LINE_ITEM_ID,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.BRAND_NAME) AS BRAND_NAME,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.ACTIVITY) AS ACTIVITY,
        CASE WHEN (EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_DATETIME = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_DATETIME))::timestamp END AS LINE_ITEM_DATETIME,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_PREVIOUS_ITEM) AS LINE_ITEM_PREVIOUS_ITEM,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_TRACKBACK_ID) AS LINE_ITEM_TRACKBACK_ID,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_DETAILS) AS LINE_ITEM_DETAILS,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_TYPE_NAME) AS LINE_ITEM_TYPE_NAME,
        btrim(EXT_ACTIVITY_LINE_ITEM_src.LINE_ITEM_NATIVE_TYPE) AS LINE_ITEM_NATIVE_TYPE,
        EXT_ACTIVITY_LINE_ITEM_src.batch_id,
        EXT_ACTIVITY_LINE_ITEM_src.row_id,
        EXT_ACTIVITY_LINE_ITEM_src.update_ts
 FROM teva_ingestion.EXT_ACTIVITY_LINE_ITEM_src;

CREATE  VIEW raw.ext_activity_line_item AS
 SELECT src.LINE_ITEM_ID,
        src.BRAND_NAME,
        src.ACTIVITY,
        src.LINE_ITEM_DATETIME,
        src.LINE_ITEM_PREVIOUS_ITEM,
        src.LINE_ITEM_TRACKBACK_ID,
        src.LINE_ITEM_DETAILS,
        src.LINE_ITEM_TYPE_NAME,
        src.LINE_ITEM_NATIVE_TYPE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ACTIVITY_LINE_ITEM_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ACTIVITY_LINE_ITEM'::varchar(22)))));

CREATE  VIEW teva_ingestion.EXT_AGGREGATED_ACTIVITY AS
 SELECT btrim(EXT_AGGREGATED_ACTIVITY_src.AGGREGATED_ID) AS AGGREGATED_ID,
        btrim(EXT_AGGREGATED_ACTIVITY_src.LEVEL_NAME) AS LEVEL_NAME,
        btrim(EXT_AGGREGATED_ACTIVITY_src.FEDERATION_ID) AS FEDERATION_ID,
        btrim(EXT_AGGREGATED_ACTIVITY_src.SOURCE_NAME) AS SOURCE_NAME,
        btrim(EXT_AGGREGATED_ACTIVITY_src.CONTACT) AS CONTACT,
        btrim(EXT_AGGREGATED_ACTIVITY_src.ORIGINATING_ID) AS ORIGINATING_ID,
        btrim(EXT_AGGREGATED_ACTIVITY_src.PRIOR_ACTIVITY) AS PRIOR_ACTIVITY,
        btrim(EXT_AGGREGATED_ACTIVITY_src.ACTIVITY_ROLE_NAME) AS ACTIVITY_ROLE_NAME,
        CASE WHEN (EXT_AGGREGATED_ACTIVITY_src.COUNT = ''::varchar) THEN NULL::int ELSE (btrim(EXT_AGGREGATED_ACTIVITY_src.COUNT))::int END AS COUNT,
        btrim(EXT_AGGREGATED_ACTIVITY_src.AGGREGATED_TYPE_NAME) AS AGGREGATED_TYPE_NAME,
        EXT_AGGREGATED_ACTIVITY_src.batch_id,
        EXT_AGGREGATED_ACTIVITY_src.row_id,
        EXT_AGGREGATED_ACTIVITY_src.update_ts
 FROM teva_ingestion.EXT_AGGREGATED_ACTIVITY_src;

CREATE  VIEW raw.ext_aggregated_activity AS
 SELECT src.AGGREGATED_ID,
        src.LEVEL_NAME,
        src.FEDERATION_ID,
        src.SOURCE_NAME,
        src.CONTACT,
        src.ORIGINATING_ID,
        src.PRIOR_ACTIVITY,
        src.ACTIVITY_ROLE_NAME,
        src.COUNT,
        src.AGGREGATED_TYPE_NAME,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AGGREGATED_ACTIVITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AGGREGATED_ACTIVITY'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_DYNAMIC_SEGMENT AS
 SELECT btrim(EXT_DYNAMIC_SEGMENT_src.FEDERATION_ID) AS FEDERATION_ID,
        CASE WHEN (EXT_DYNAMIC_SEGMENT_src.BASKET_ID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DYNAMIC_SEGMENT_src.BASKET_ID))::int END AS BASKET_ID,
        btrim(EXT_DYNAMIC_SEGMENT_src.SEGMENT_NAME) AS SEGMENT_NAME,
        btrim(EXT_DYNAMIC_SEGMENT_src.SEGMENT_VALUE) AS SEGMENT_VALUE,
        EXT_DYNAMIC_SEGMENT_src.batch_id,
        EXT_DYNAMIC_SEGMENT_src.row_id,
        EXT_DYNAMIC_SEGMENT_src.update_ts
 FROM teva_ingestion.EXT_DYNAMIC_SEGMENT_src;

CREATE  VIEW raw.ext_dynamic_segment AS
 SELECT src.FEDERATION_ID,
        src.BASKET_ID,
        src.SEGMENT_NAME,
        src.SEGMENT_VALUE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DYNAMIC_SEGMENT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DYNAMIC_SEGMENT'::varchar(19)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_IMS_Plan_Workbook AS
 SELECT x.PAYER_PLAN_NUM AS payer_plan_num,
        x.PLAN_NAME AS plan_name,
        x.PAYER_NAME AS payer_name,
        m.PAYMENT_METHOD AS payment_method,
        x.MODEL AS model
 FROM WSMP_ADMIN_ORA.TFC_IMS_PLAN_XREF x, WSMP_ADMIN_ORA.DIM_IMS_MODEL_PAYMENT_METHOD m
 WHERE (x.MODEL = m.MODEL);

CREATE  VIEW teva_ingestion.EXT_MS_DDD_DOLLARS AS
 SELECT btrim(EXT_MS_DDD_DOLLARS_src.client_num) AS client_num,
        btrim(EXT_MS_DDD_DOLLARS_src.report_num) AS report_num,
        btrim(EXT_MS_DDD_DOLLARS_src.sra1) AS sra1,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_code) AS outlet_code,
        btrim(EXT_MS_DDD_DOLLARS_src.subcategory_code) AS subcategory_code,
        btrim(EXT_MS_DDD_DOLLARS_src.sra4) AS sra4,
        btrim(EXT_MS_DDD_DOLLARS_src.category_code) AS category_code,
        btrim(EXT_MS_DDD_DOLLARS_src.ims_product_code) AS ims_product_code,
        btrim(EXT_MS_DDD_DOLLARS_src.mth_yyyymmdd) AS mth_yyyymmdd,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth01 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth01))::numeric(19,1) END AS dol_mth01,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth02 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth02))::numeric(19,1) END AS dol_mth02,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth03 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth03))::numeric(19,1) END AS dol_mth03,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth04 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth04))::numeric(19,1) END AS dol_mth04,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth05 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth05))::numeric(19,1) END AS dol_mth05,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth06 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth06))::numeric(19,1) END AS dol_mth06,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth07 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth07))::numeric(19,1) END AS dol_mth07,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth08 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth08))::numeric(19,1) END AS dol_mth08,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth09 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth09))::numeric(19,1) END AS dol_mth09,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth10 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth10))::numeric(19,1) END AS dol_mth10,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth11 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth11))::numeric(19,1) END AS dol_mth11,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth12 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth12))::numeric(19,1) END AS dol_mth12,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth13 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth13))::numeric(19,1) END AS dol_mth13,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth14 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth14))::numeric(19,1) END AS dol_mth14,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth15 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth15))::numeric(19,1) END AS dol_mth15,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth16 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth16))::numeric(19,1) END AS dol_mth16,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth17 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth17))::numeric(19,1) END AS dol_mth17,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth18 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth18))::numeric(19,1) END AS dol_mth18,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth19 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth19))::numeric(19,1) END AS dol_mth19,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth20 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth20))::numeric(19,1) END AS dol_mth20,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth21 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth21))::numeric(19,1) END AS dol_mth21,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth22 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth22))::numeric(19,1) END AS dol_mth22,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth23 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth23))::numeric(19,1) END AS dol_mth23,
        CASE WHEN (EXT_MS_DDD_DOLLARS_src.dol_mth24 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_MS_DDD_DOLLARS_src.dol_mth24))::numeric(19,1) END AS dol_mth24,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_name) AS outlet_name,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_address) AS outlet_address,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_city) AS outlet_city,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_state) AS outlet_state,
        btrim(EXT_MS_DDD_DOLLARS_src.outlet_zip) AS outlet_zip,
        EXT_MS_DDD_DOLLARS_src.batch_id,
        EXT_MS_DDD_DOLLARS_src.row_id,
        EXT_MS_DDD_DOLLARS_src.update_ts
 FROM teva_ingestion.EXT_MS_DDD_DOLLARS_src;

CREATE  VIEW teva_ingestion.EXT_MS_DDD_QUANTITY AS
 SELECT btrim(EXT_MS_DDD_QUANTITY_src.client_num) AS client_num,
        btrim(EXT_MS_DDD_QUANTITY_src.report_num) AS report_num,
        btrim(EXT_MS_DDD_QUANTITY_src.sra1) AS sra1,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_code) AS outlet_code,
        btrim(EXT_MS_DDD_QUANTITY_src.subcategory_code) AS subcategory_code,
        btrim(EXT_MS_DDD_QUANTITY_src.sra4) AS sra4,
        btrim(EXT_MS_DDD_QUANTITY_src.category_code) AS category_code,
        btrim(EXT_MS_DDD_QUANTITY_src.ims_product_code) AS ims_product_code,
        btrim(EXT_MS_DDD_QUANTITY_src.mth_yyyymmdd) AS mth_yyyymmdd,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth01))::int END AS qty_mth01,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth02))::int END AS qty_mth02,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth03))::int END AS qty_mth03,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth04))::int END AS qty_mth04,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth05))::int END AS qty_mth05,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth06))::int END AS qty_mth06,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth07))::int END AS qty_mth07,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth08))::int END AS qty_mth08,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth09))::int END AS qty_mth09,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth10))::int END AS qty_mth10,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth11))::int END AS qty_mth11,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth12))::int END AS qty_mth12,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth13 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth13))::int END AS qty_mth13,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth14 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth14))::int END AS qty_mth14,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth15 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth15))::int END AS qty_mth15,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth16 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth16))::int END AS qty_mth16,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth17 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth17))::int END AS qty_mth17,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth18 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth18))::int END AS qty_mth18,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth19 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth19))::int END AS qty_mth19,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth20))::int END AS qty_mth20,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth21 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth21))::int END AS qty_mth21,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth22 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth22))::int END AS qty_mth22,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth23 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth23))::int END AS qty_mth23,
        CASE WHEN (EXT_MS_DDD_QUANTITY_src.qty_mth24 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_MS_DDD_QUANTITY_src.qty_mth24))::int END AS qty_mth24,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_name) AS outlet_name,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_address) AS outlet_address,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_city) AS outlet_city,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_state) AS outlet_state,
        btrim(EXT_MS_DDD_QUANTITY_src.outlet_zip) AS outlet_zip,
        EXT_MS_DDD_QUANTITY_src.batch_id,
        EXT_MS_DDD_QUANTITY_src.row_id,
        EXT_MS_DDD_QUANTITY_src.update_ts
 FROM teva_ingestion.EXT_MS_DDD_QUANTITY_src;

CREATE  VIEW teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL AS
 SELECT btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.client_num) AS client_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.report_num) AS report_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_outlet_code) AS ims_outlet_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_facility_number) AS ims_facility_number,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_prescriber_number) AS ims_prescriber_number,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_name) AS outlet_name,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_address) AS outlet_address,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_city) AS outlet_city,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_state) AS outlet_state,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_zip) AS outlet_zip,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_name) AS facility_prescriber_name,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address1) AS facility_prescriber_address1,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address2) AS facility_prescriber_address2,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address3) AS facility_prescriber_address3,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address4) AS facility_prescriber_address4,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_city) AS facility_prescriber_city,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_state) AS facility_prescriber_state,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_zip) AS facility_prescriber_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.batch_id,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.row_id,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.update_ts
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src;

CREATE  VIEW teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS AS
 SELECT btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.client_num) AS client_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.report_num) AS report_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_outlet_code) AS ims_outlet_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_facility_number) AS ims_facility_number,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_prescriber_number) AS ims_prescriber_number,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_name) AS outlet_name,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_address) AS outlet_address,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_city) AS outlet_city,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_state) AS outlet_state,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_zip) AS outlet_zip,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_name) AS facility_prescriber_name,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address1) AS facility_prescriber_address1,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address2) AS facility_prescriber_address2,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address3) AS facility_prescriber_address3,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address4) AS facility_prescriber_address4,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_city) AS facility_prescriber_city,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_state) AS facility_prescriber_state,
        btrim(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_zip) AS facility_prescriber_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.batch_id,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.row_id,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.update_ts
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src;

CREATE  VIEW teva_ingestion.EXT_TR_DDDMD_WEEKLY_DOLLARS AS
 SELECT btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.client_num) AS client_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.report_num) AS report_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.ims_outlet_code) AS ims_outlet_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.subcategory_code) AS subcategory_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.alt_seq_num) AS alt_seq_num,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.filler01) AS filler01,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.category_code) AS category_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.ims_product_code) AS ims_product_code,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.data_date) AS data_date,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk01 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk01))::numeric(19,1) END AS dol_wk01,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk02 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk02))::numeric(19,1) END AS dol_wk02,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk03 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk03))::numeric(19,1) END AS dol_wk03,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk04 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk04))::numeric(19,1) END AS dol_wk04,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk05 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk05))::numeric(19,1) END AS dol_wk05,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk06 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk06))::numeric(19,1) END AS dol_wk06,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk07 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk07))::numeric(19,1) END AS dol_wk07,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk08 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk08))::numeric(19,1) END AS dol_wk08,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk09 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk09))::numeric(19,1) END AS dol_wk09,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk10 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk10))::numeric(19,1) END AS dol_wk10,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk11 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk11))::numeric(19,1) END AS dol_wk11,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk12 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk12))::numeric(19,1) END AS dol_wk12,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk13 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk13))::numeric(19,1) END AS dol_wk13,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk14 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk14))::numeric(19,1) END AS dol_wk14,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk15 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk15))::numeric(19,1) END AS dol_wk15,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk16 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk16))::numeric(19,1) END AS dol_wk16,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk17 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk17))::numeric(19,1) END AS dol_wk17,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk18 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk18))::numeric(19,1) END AS dol_wk18,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk19 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk19))::numeric(19,1) END AS dol_wk19,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk20 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk20))::numeric(19,1) END AS dol_wk20,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk21 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk21))::numeric(19,1) END AS dol_wk21,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk22 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk22))::numeric(19,1) END AS dol_wk22,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk23 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk23))::numeric(19,1) END AS dol_wk23,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk24 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk24))::numeric(19,1) END AS dol_wk24,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk25 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk25))::numeric(19,1) END AS dol_wk25,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk26 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk26))::numeric(19,1) END AS dol_wk26,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk27 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk27))::numeric(19,1) END AS dol_wk27,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk28 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk28))::numeric(19,1) END AS dol_wk28,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk29 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk29))::numeric(19,1) END AS dol_wk29,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk30 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk30))::numeric(19,1) END AS dol_wk30,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk31 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk31))::numeric(19,1) END AS dol_wk31,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk32 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk32))::numeric(19,1) END AS dol_wk32,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk33 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk33))::numeric(19,1) END AS dol_wk33,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk34 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk34))::numeric(19,1) END AS dol_wk34,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk35 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk35))::numeric(19,1) END AS dol_wk35,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk36 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk36))::numeric(19,1) END AS dol_wk36,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk37 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk37))::numeric(19,1) END AS dol_wk37,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk38 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk38))::numeric(19,1) END AS dol_wk38,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk39 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk39))::numeric(19,1) END AS dol_wk39,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk40 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk40))::numeric(19,1) END AS dol_wk40,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk41 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk41))::numeric(19,1) END AS dol_wk41,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk42 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk42))::numeric(19,1) END AS dol_wk42,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk43 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk43))::numeric(19,1) END AS dol_wk43,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk44 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk44))::numeric(19,1) END AS dol_wk44,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk45 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk45))::numeric(19,1) END AS dol_wk45,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk46 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk46))::numeric(19,1) END AS dol_wk46,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk47 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk47))::numeric(19,1) END AS dol_wk47,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk48 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk48))::numeric(19,1) END AS dol_wk48,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk49 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk49))::numeric(19,1) END AS dol_wk49,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk50 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk50))::numeric(19,1) END AS dol_wk50,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk51 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk51))::numeric(19,1) END AS dol_wk51,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk52 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk52))::numeric(19,1) END AS dol_wk52,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk53 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk53))::numeric(19,1) END AS dol_wk53,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk54 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk54))::numeric(19,1) END AS dol_wk54,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk55 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk55))::numeric(19,1) END AS dol_wk55,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk56 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk56))::numeric(19,1) END AS dol_wk56,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk57 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk57))::numeric(19,1) END AS dol_wk57,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk58 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk58))::numeric(19,1) END AS dol_wk58,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk59 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk59))::numeric(19,1) END AS dol_wk59,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk60 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk60))::numeric(19,1) END AS dol_wk60,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk61 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk61))::numeric(19,1) END AS dol_wk61,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk62 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk62))::numeric(19,1) END AS dol_wk62,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk63 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk63))::numeric(19,1) END AS dol_wk63,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk64 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk64))::numeric(19,1) END AS dol_wk64,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk65 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk65))::numeric(19,1) END AS dol_wk65,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk66 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk66))::numeric(19,1) END AS dol_wk66,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk67 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk67))::numeric(19,1) END AS dol_wk67,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk68 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk68))::numeric(19,1) END AS dol_wk68,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk69 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk69))::numeric(19,1) END AS dol_wk69,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk70 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk70))::numeric(19,1) END AS dol_wk70,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk71 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk71))::numeric(19,1) END AS dol_wk71,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk72 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk72))::numeric(19,1) END AS dol_wk72,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk73 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk73))::numeric(19,1) END AS dol_wk73,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk74 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk74))::numeric(19,1) END AS dol_wk74,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk75 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk75))::numeric(19,1) END AS dol_wk75,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk76 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk76))::numeric(19,1) END AS dol_wk76,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk77 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk77))::numeric(19,1) END AS dol_wk77,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk78 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk78))::numeric(19,1) END AS dol_wk78,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk79 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk79))::numeric(19,1) END AS dol_wk79,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk80 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk80))::numeric(19,1) END AS dol_wk80,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk81 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk81))::numeric(19,1) END AS dol_wk81,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk82 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk82))::numeric(19,1) END AS dol_wk82,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk83 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk83))::numeric(19,1) END AS dol_wk83,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk84 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk84))::numeric(19,1) END AS dol_wk84,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk85 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk85))::numeric(19,1) END AS dol_wk85,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk86 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk86))::numeric(19,1) END AS dol_wk86,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk87 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk87))::numeric(19,1) END AS dol_wk87,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk88 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk88))::numeric(19,1) END AS dol_wk88,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk89 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk89))::numeric(19,1) END AS dol_wk89,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk90 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk90))::numeric(19,1) END AS dol_wk90,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk91 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk91))::numeric(19,1) END AS dol_wk91,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk92 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk92))::numeric(19,1) END AS dol_wk92,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk93 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk93))::numeric(19,1) END AS dol_wk93,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk94 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk94))::numeric(19,1) END AS dol_wk94,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk95 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk95))::numeric(19,1) END AS dol_wk95,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk96 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk96))::numeric(19,1) END AS dol_wk96,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk97 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk97))::numeric(19,1) END AS dol_wk97,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk98 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk98))::numeric(19,1) END AS dol_wk98,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk99 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk99))::numeric(19,1) END AS dol_wk99,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk100 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk100))::numeric(19,1) END AS dol_wk100,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk101 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk101))::numeric(19,1) END AS dol_wk101,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk102 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk102))::numeric(19,1) END AS dol_wk102,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk103 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk103))::numeric(19,1) END AS dol_wk103,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk104 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk104))::numeric(19,1) END AS dol_wk104,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk105 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk105))::numeric(19,1) END AS dol_wk105,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk106 = ''::varchar) THEN NULL::numeric(19,1) ELSE (btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk106))::numeric(19,1) END AS dol_wk106,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_name) AS outlet_name,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_address) AS outlet_address,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_city) AS outlet_city,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_state) AS outlet_state,
        btrim(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_zip) AS outlet_zip,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.batch_id,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.row_id,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.update_ts
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DOLLARS_src;

CREATE  VIEW teva_ingestion.EXT_TR_DDDMD_WEEKLY_UNITS AS
 SELECT btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.client_num) AS client_num,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.report_num) AS report_num,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.ims_outlet_code) AS ims_outlet_code,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.subcategory_code) AS subcategory_code,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.alt_seq_num) AS alt_seq_num,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.filler01) AS filler01,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.category_code) AS category_code,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.ims_product_code) AS ims_product_code,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.data_date) AS data_date,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk01))::int END AS qty_wk01,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk02))::int END AS qty_wk02,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk03))::int END AS qty_wk03,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk04))::int END AS qty_wk04,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk05))::int END AS qty_wk05,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk06))::int END AS qty_wk06,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk07))::int END AS qty_wk07,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk08))::int END AS qty_wk08,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk09))::int END AS qty_wk09,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk10))::int END AS qty_wk10,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk11))::int END AS qty_wk11,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk12))::int END AS qty_wk12,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk13 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk13))::int END AS qty_wk13,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk14 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk14))::int END AS qty_wk14,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk15 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk15))::int END AS qty_wk15,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk16 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk16))::int END AS qty_wk16,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk17 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk17))::int END AS qty_wk17,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk18 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk18))::int END AS qty_wk18,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk19 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk19))::int END AS qty_wk19,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk20))::int END AS qty_wk20,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk21 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk21))::int END AS qty_wk21,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk22 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk22))::int END AS qty_wk22,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk23 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk23))::int END AS qty_wk23,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk24 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk24))::int END AS qty_wk24,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk25 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk25))::int END AS qty_wk25,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk26 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk26))::int END AS qty_wk26,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk27 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk27))::int END AS qty_wk27,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk28 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk28))::int END AS qty_wk28,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk29 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk29))::int END AS qty_wk29,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk30 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk30))::int END AS qty_wk30,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk31 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk31))::int END AS qty_wk31,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk32 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk32))::int END AS qty_wk32,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk33 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk33))::int END AS qty_wk33,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk34 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk34))::int END AS qty_wk34,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk35 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk35))::int END AS qty_wk35,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk36 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk36))::int END AS qty_wk36,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk37 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk37))::int END AS qty_wk37,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk38 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk38))::int END AS qty_wk38,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk39 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk39))::int END AS qty_wk39,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk40 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk40))::int END AS qty_wk40,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk41 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk41))::int END AS qty_wk41,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk42 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk42))::int END AS qty_wk42,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk43 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk43))::int END AS qty_wk43,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk44 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk44))::int END AS qty_wk44,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk45 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk45))::int END AS qty_wk45,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk46 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk46))::int END AS qty_wk46,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk47 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk47))::int END AS qty_wk47,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk48 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk48))::int END AS qty_wk48,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk49 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk49))::int END AS qty_wk49,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk50 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk50))::int END AS qty_wk50,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk51 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk51))::int END AS qty_wk51,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk52 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk52))::int END AS qty_wk52,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk53 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk53))::int END AS qty_wk53,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk54 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk54))::int END AS qty_wk54,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk55 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk55))::int END AS qty_wk55,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk56 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk56))::int END AS qty_wk56,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk57 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk57))::int END AS qty_wk57,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk58 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk58))::int END AS qty_wk58,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk59 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk59))::int END AS qty_wk59,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk60 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk60))::int END AS qty_wk60,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk61 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk61))::int END AS qty_wk61,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk62 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk62))::int END AS qty_wk62,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk63 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk63))::int END AS qty_wk63,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk64 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk64))::int END AS qty_wk64,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk65 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk65))::int END AS qty_wk65,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk66 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk66))::int END AS qty_wk66,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk67 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk67))::int END AS qty_wk67,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk68 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk68))::int END AS qty_wk68,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk69 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk69))::int END AS qty_wk69,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk70 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk70))::int END AS qty_wk70,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk71 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk71))::int END AS qty_wk71,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk72 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk72))::int END AS qty_wk72,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk73 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk73))::int END AS qty_wk73,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk74 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk74))::int END AS qty_wk74,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk75 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk75))::int END AS qty_wk75,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk76 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk76))::int END AS qty_wk76,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk77 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk77))::int END AS qty_wk77,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk78 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk78))::int END AS qty_wk78,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk79 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk79))::int END AS qty_wk79,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk80 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk80))::int END AS qty_wk80,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk81 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk81))::int END AS qty_wk81,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk82 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk82))::int END AS qty_wk82,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk83 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk83))::int END AS qty_wk83,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk84 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk84))::int END AS qty_wk84,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk85 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk85))::int END AS qty_wk85,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk86 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk86))::int END AS qty_wk86,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk87 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk87))::int END AS qty_wk87,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk88 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk88))::int END AS qty_wk88,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk89 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk89))::int END AS qty_wk89,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk90 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk90))::int END AS qty_wk90,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk91 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk91))::int END AS qty_wk91,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk92 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk92))::int END AS qty_wk92,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk93 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk93))::int END AS qty_wk93,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk94 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk94))::int END AS qty_wk94,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk95 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk95))::int END AS qty_wk95,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk96 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk96))::int END AS qty_wk96,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk97 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk97))::int END AS qty_wk97,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk98 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk98))::int END AS qty_wk98,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk99 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk99))::int END AS qty_wk99,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk100 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk100))::int END AS qty_wk100,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk101 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk101))::int END AS qty_wk101,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk102 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk102))::int END AS qty_wk102,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk103 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk103))::int END AS qty_wk103,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk104 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk104))::int END AS qty_wk104,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk105 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk105))::int END AS qty_wk105,
        CASE WHEN (EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk106 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk106))::int END AS qty_wk106,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_name) AS outlet_name,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_address) AS outlet_address,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_city) AS outlet_city,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_state) AS outlet_state,
        btrim(EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_zip) AS outlet_zip,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.batch_id,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.row_id,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.update_ts
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_UNITS_src;

CREATE  VIEW raw.ext_ms_ddd_dollars AS
 SELECT src.client_num,
        src.report_num,
        src.sra1,
        src.outlet_code,
        src.subcategory_code,
        src.sra4,
        src.category_code,
        src.ims_product_code,
        src.mth_yyyymmdd,
        src.dol_mth01,
        src.dol_mth02,
        src.dol_mth03,
        src.dol_mth04,
        src.dol_mth05,
        src.dol_mth06,
        src.dol_mth07,
        src.dol_mth08,
        src.dol_mth09,
        src.dol_mth10,
        src.dol_mth11,
        src.dol_mth12,
        src.dol_mth13,
        src.dol_mth14,
        src.dol_mth15,
        src.dol_mth16,
        src.dol_mth17,
        src.dol_mth18,
        src.dol_mth19,
        src.dol_mth20,
        src.dol_mth21,
        src.dol_mth22,
        src.dol_mth23,
        src.dol_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_MS_DDD_DOLLARS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_MS_DDD_DOLLARS'::varchar(18)))));

CREATE  VIEW raw.ext_ms_ddd_quantity AS
 SELECT src.client_num,
        src.report_num,
        src.sra1,
        src.outlet_code,
        src.subcategory_code,
        src.sra4,
        src.category_code,
        src.ims_product_code,
        src.mth_yyyymmdd,
        src.qty_mth01,
        src.qty_mth02,
        src.qty_mth03,
        src.qty_mth04,
        src.qty_mth05,
        src.qty_mth06,
        src.qty_mth07,
        src.qty_mth08,
        src.qty_mth09,
        src.qty_mth10,
        src.qty_mth11,
        src.qty_mth12,
        src.qty_mth13,
        src.qty_mth14,
        src.qty_mth15,
        src.qty_mth16,
        src.qty_mth17,
        src.qty_mth18,
        src.qty_mth19,
        src.qty_mth20,
        src.qty_mth21,
        src.qty_mth22,
        src.qty_mth23,
        src.qty_mth24,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_MS_DDD_QUANTITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_MS_DDD_QUANTITY'::varchar(19)))));

CREATE  VIEW raw.ext_tr_dddmd_weekly_demo_dol AS
 SELECT src.client_num,
        src.report_num,
        src.ims_outlet_code,
        src.ims_facility_number,
        src.ims_prescriber_number,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.facility_prescriber_name,
        src.facility_prescriber_address1,
        src.facility_prescriber_address2,
        src.facility_prescriber_address3,
        src.facility_prescriber_address4,
        src.facility_prescriber_city,
        src.facility_prescriber_state,
        src.facility_prescriber_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TR_DDDMD_WEEKLY_DEMO_DOL'::varchar(28)))));

CREATE  VIEW raw.ext_tr_dddmd_weekly_demo_units AS
 SELECT src.client_num,
        src.report_num,
        src.ims_outlet_code,
        src.ims_facility_number,
        src.ims_prescriber_number,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.facility_prescriber_name,
        src.facility_prescriber_address1,
        src.facility_prescriber_address2,
        src.facility_prescriber_address3,
        src.facility_prescriber_address4,
        src.facility_prescriber_city,
        src.facility_prescriber_state,
        src.facility_prescriber_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TR_DDDMD_WEEKLY_DEMO_UNITS'::varchar(30)))));

CREATE  VIEW raw.ext_tr_dddmd_weekly_dollars AS
 SELECT src.client_num,
        src.report_num,
        src.ims_outlet_code,
        src.subcategory_code,
        src.alt_seq_num,
        src.filler01,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.dol_wk01,
        src.dol_wk02,
        src.dol_wk03,
        src.dol_wk04,
        src.dol_wk05,
        src.dol_wk06,
        src.dol_wk07,
        src.dol_wk08,
        src.dol_wk09,
        src.dol_wk10,
        src.dol_wk11,
        src.dol_wk12,
        src.dol_wk13,
        src.dol_wk14,
        src.dol_wk15,
        src.dol_wk16,
        src.dol_wk17,
        src.dol_wk18,
        src.dol_wk19,
        src.dol_wk20,
        src.dol_wk21,
        src.dol_wk22,
        src.dol_wk23,
        src.dol_wk24,
        src.dol_wk25,
        src.dol_wk26,
        src.dol_wk27,
        src.dol_wk28,
        src.dol_wk29,
        src.dol_wk30,
        src.dol_wk31,
        src.dol_wk32,
        src.dol_wk33,
        src.dol_wk34,
        src.dol_wk35,
        src.dol_wk36,
        src.dol_wk37,
        src.dol_wk38,
        src.dol_wk39,
        src.dol_wk40,
        src.dol_wk41,
        src.dol_wk42,
        src.dol_wk43,
        src.dol_wk44,
        src.dol_wk45,
        src.dol_wk46,
        src.dol_wk47,
        src.dol_wk48,
        src.dol_wk49,
        src.dol_wk50,
        src.dol_wk51,
        src.dol_wk52,
        src.dol_wk53,
        src.dol_wk54,
        src.dol_wk55,
        src.dol_wk56,
        src.dol_wk57,
        src.dol_wk58,
        src.dol_wk59,
        src.dol_wk60,
        src.dol_wk61,
        src.dol_wk62,
        src.dol_wk63,
        src.dol_wk64,
        src.dol_wk65,
        src.dol_wk66,
        src.dol_wk67,
        src.dol_wk68,
        src.dol_wk69,
        src.dol_wk70,
        src.dol_wk71,
        src.dol_wk72,
        src.dol_wk73,
        src.dol_wk74,
        src.dol_wk75,
        src.dol_wk76,
        src.dol_wk77,
        src.dol_wk78,
        src.dol_wk79,
        src.dol_wk80,
        src.dol_wk81,
        src.dol_wk82,
        src.dol_wk83,
        src.dol_wk84,
        src.dol_wk85,
        src.dol_wk86,
        src.dol_wk87,
        src.dol_wk88,
        src.dol_wk89,
        src.dol_wk90,
        src.dol_wk91,
        src.dol_wk92,
        src.dol_wk93,
        src.dol_wk94,
        src.dol_wk95,
        src.dol_wk96,
        src.dol_wk97,
        src.dol_wk98,
        src.dol_wk99,
        src.dol_wk100,
        src.dol_wk101,
        src.dol_wk102,
        src.dol_wk103,
        src.dol_wk104,
        src.dol_wk105,
        src.dol_wk106,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TR_DDDMD_WEEKLY_DOLLARS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TR_DDDMD_WEEKLY_DOLLARS'::varchar(27)))));

CREATE  VIEW raw.ext_tr_dddmd_weekly_units AS
 SELECT src.client_num,
        src.report_num,
        src.ims_outlet_code,
        src.subcategory_code,
        src.alt_seq_num,
        src.filler01,
        src.category_code,
        src.ims_product_code,
        src.data_date,
        src.qty_wk01,
        src.qty_wk02,
        src.qty_wk03,
        src.qty_wk04,
        src.qty_wk05,
        src.qty_wk06,
        src.qty_wk07,
        src.qty_wk08,
        src.qty_wk09,
        src.qty_wk10,
        src.qty_wk11,
        src.qty_wk12,
        src.qty_wk13,
        src.qty_wk14,
        src.qty_wk15,
        src.qty_wk16,
        src.qty_wk17,
        src.qty_wk18,
        src.qty_wk19,
        src.qty_wk20,
        src.qty_wk21,
        src.qty_wk22,
        src.qty_wk23,
        src.qty_wk24,
        src.qty_wk25,
        src.qty_wk26,
        src.qty_wk27,
        src.qty_wk28,
        src.qty_wk29,
        src.qty_wk30,
        src.qty_wk31,
        src.qty_wk32,
        src.qty_wk33,
        src.qty_wk34,
        src.qty_wk35,
        src.qty_wk36,
        src.qty_wk37,
        src.qty_wk38,
        src.qty_wk39,
        src.qty_wk40,
        src.qty_wk41,
        src.qty_wk42,
        src.qty_wk43,
        src.qty_wk44,
        src.qty_wk45,
        src.qty_wk46,
        src.qty_wk47,
        src.qty_wk48,
        src.qty_wk49,
        src.qty_wk50,
        src.qty_wk51,
        src.qty_wk52,
        src.qty_wk53,
        src.qty_wk54,
        src.qty_wk55,
        src.qty_wk56,
        src.qty_wk57,
        src.qty_wk58,
        src.qty_wk59,
        src.qty_wk60,
        src.qty_wk61,
        src.qty_wk62,
        src.qty_wk63,
        src.qty_wk64,
        src.qty_wk65,
        src.qty_wk66,
        src.qty_wk67,
        src.qty_wk68,
        src.qty_wk69,
        src.qty_wk70,
        src.qty_wk71,
        src.qty_wk72,
        src.qty_wk73,
        src.qty_wk74,
        src.qty_wk75,
        src.qty_wk76,
        src.qty_wk77,
        src.qty_wk78,
        src.qty_wk79,
        src.qty_wk80,
        src.qty_wk81,
        src.qty_wk82,
        src.qty_wk83,
        src.qty_wk84,
        src.qty_wk85,
        src.qty_wk86,
        src.qty_wk87,
        src.qty_wk88,
        src.qty_wk89,
        src.qty_wk90,
        src.qty_wk91,
        src.qty_wk92,
        src.qty_wk93,
        src.qty_wk94,
        src.qty_wk95,
        src.qty_wk96,
        src.qty_wk97,
        src.qty_wk98,
        src.qty_wk99,
        src.qty_wk100,
        src.qty_wk101,
        src.qty_wk102,
        src.qty_wk103,
        src.qty_wk104,
        src.qty_wk105,
        src.qty_wk106,
        src.outlet_name,
        src.outlet_address,
        src.outlet_city,
        src.outlet_state,
        src.outlet_zip,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TR_DDDMD_WEEKLY_UNITS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TR_DDDMD_WEEKLY_UNITS'::varchar(25)))));

CREATE  VIEW teva_ingestion.EXT_ONC_SALES_QUOTAS AS
 SELECT btrim(EXT_ONC_SALES_QUOTAS_src.TIME_PERIOD) AS TIME_PERIOD,
        btrim(EXT_ONC_SALES_QUOTAS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ONC_SALES_QUOTAS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ONC_SALES_QUOTAS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ONC_SALES_QUOTAS_src.QUOTA_QTY = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_SALES_QUOTAS_src.QUOTA_QTY))::int END AS QUOTA_QTY,
        CASE WHEN (EXT_ONC_SALES_QUOTAS_src.QUOTA_DOL = ''::varchar) THEN NULL::numeric(19,2) ELSE (btrim(EXT_ONC_SALES_QUOTAS_src.QUOTA_DOL))::numeric(19,2) END AS QUOTA_DOL,
        CASE WHEN (EXT_ONC_SALES_QUOTAS_src.QUOTA_STRENGTH_UNIT = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ONC_SALES_QUOTAS_src.QUOTA_STRENGTH_UNIT))::int END AS QUOTA_STRENGTH_UNIT,
        EXT_ONC_SALES_QUOTAS_src.batch_id,
        EXT_ONC_SALES_QUOTAS_src.row_id,
        EXT_ONC_SALES_QUOTAS_src.update_ts
 FROM teva_ingestion.EXT_ONC_SALES_QUOTAS_src;

CREATE  VIEW metadata.log_summary AS
 SELECT a.job,
        a.started,
        a.ended,
        a.elapsed_time,
        a.job_id,
        a.run
 FROM ( SELECT (split_part(starter.event_description, ':'::varchar(1), 2))::varchar(60) AS job,
        starter.event_date AS started,
        ender.event_date AS ended,
        ender.elapsed_time,
        starter.job_id,
        dense_rank() OVER (PARTITION BY (split_part(starter.event_description, ':'::varchar(1), 2))::varchar(60) ORDER BY starter.event_date DESC) AS run
 FROM (metadata.log_job_events starter LEFT  JOIN ( SELECT e.event_id,
        e.job_id,
        e.event_date,
        e.event_type,
        e.event_description,
        e.metric_name,
        e.metric_count,
        e.elapsed_time
 FROM metadata.log_job_events e
 WHERE ((e.event_description ~~ 'STEP%SQL_%'::varchar(10)) AND ((split_part(e.event_description, ':'::varchar(1), 1))::varchar(60) = 'STEP ENDED'::varchar(10)))) ender ON (((starter.job_id = ender.job_id) AND ((split_part(starter.event_description, ':'::varchar(1), 2))::varchar(60) = (split_part(ender.event_description, ':'::varchar(1), 2))::varchar(60)))))
 WHERE ((starter.event_description ~~ 'STEP%SQL_%'::varchar(10)) AND ((split_part(starter.event_description, ':'::varchar(1), 1))::varchar(60) = 'STEP STARTING'::varchar(13))) UNION  SELECT starter.metric_name,
        starter.event_date,
        ender.event_date AS event_date3,
        "datediff"('s'::varchar(1), starter.event_date, ender.event_date) AS elapsed_time,
        starter.job_id,
        dense_rank() OVER (PARTITION BY starter.metric_name ORDER BY starter.event_date DESC) AS run
 FROM (metadata.log_job_events starter LEFT  JOIN ( SELECT e.event_id,
        e.job_id,
        e.event_date,
        e.event_type,
        e.event_description,
        e.metric_name,
        e.metric_count,
        e.elapsed_time
 FROM metadata.log_job_events e
 WHERE ((e.event_description ~~ '%JOB REQUEST COMPLETED%'::varchar(23)) AND (e.metric_name = ANY (ARRAY['Cleansing'::varchar(11), 'Integration'::varchar(11)])))) ender ON (((starter.job_id = ender.job_id) AND (starter.metric_name = ender.metric_name))))
 WHERE ((starter.event_description ~~ '%JOB REQUEST STARTED%'::varchar(21)) AND (starter.metric_name = ANY (ARRAY['Cleansing'::varchar(11), 'Integration'::varchar(11)])))) a
 ORDER BY a.started DESC;

CREATE  VIEW teva_ingestion.MDM_ADDRESS AS
 SELECT btrim(MDM_ADDRESS_src.TVCMID) AS TVCMID,
        btrim(MDM_ADDRESS_src.ADDRESS_ID) AS ADDRESS_ID,
        btrim(MDM_ADDRESS_src.ADDRESS_TYPE) AS ADDRESS_TYPE,
        btrim(MDM_ADDRESS_src.ADDRESS_TYPE_NAME) AS ADDRESS_TYPE_NAME,
        btrim(MDM_ADDRESS_src.ADDRESS_LINE_1) AS ADDRESS_LINE_1,
        btrim(MDM_ADDRESS_src.ADDRESS_LINE_2) AS ADDRESS_LINE_2,
        btrim(MDM_ADDRESS_src.COUNTY) AS COUNTY,
        btrim(MDM_ADDRESS_src.CITY) AS CITY,
        btrim(MDM_ADDRESS_src.STATE) AS STATE,
        btrim(MDM_ADDRESS_src.STATE_NAME) AS STATE_NAME,
        btrim(MDM_ADDRESS_src.COUNTRY_CODE) AS COUNTRY_CODE,
        btrim(MDM_ADDRESS_src.COUNTRY_NAME) AS COUNTRY_NAME,
        btrim(MDM_ADDRESS_src.ZIP5_POSTAL_CODE) AS ZIP5_POSTAL_CODE,
        btrim(MDM_ADDRESS_src.ZIP4_POSTAL_EXTENSION_CODE) AS ZIP4_POSTAL_EXTENSION_CODE,
        btrim(MDM_ADDRESS_src.ADDRESS_STATUS) AS ADDRESS_STATUS,
        btrim(MDM_ADDRESS_src.ADDRESS_STATUS_NAME) AS ADDRESS_STATUS_NAME,
        btrim(MDM_ADDRESS_src.ADDRESS_EFFECTIVE_DATE) AS ADDRESS_EFFECTIVE_DATE,
        btrim(MDM_ADDRESS_src.MSA_CBSA) AS MSA_CBSA,
        btrim(MDM_ADDRESS_src.FIPS_STATE_CODE) AS FIPS_STATE_CODE,
        btrim(MDM_ADDRESS_src.FIPS_STATE_DESCRIPTION) AS FIPS_STATE_DESCRIPTION,
        btrim(MDM_ADDRESS_src.FIPS_COUNTY_CODE) AS FIPS_COUNTY_CODE,
        btrim(MDM_ADDRESS_src.FIPS_COUNTY_DESCRIPTION) AS FIPS_COUNTY_DESCRIPTION,
        btrim(MDM_ADDRESS_src.DELIVERABILITY_CONFIDENCE) AS DELIVERABILITY_CONFIDENCE,
        btrim(MDM_ADDRESS_src.ADDRESS_SETTING_TYPE_CODE) AS ADDRESS_SETTING_TYPE_CODE,
        btrim(MDM_ADDRESS_src.ADDRESS_SETTING_TYPE_DESCRIPTION) AS ADDRESS_SETTING_TYPE_DESCRIPTION,
        btrim(MDM_ADDRESS_src.ADDRESS_CATEGORY_CODE) AS ADDRESS_CATEGORY_CODE,
        btrim(MDM_ADDRESS_src.ADDRESS_CATEGORY_DESCRIPTION) AS ADDRESS_CATEGORY_DESCRIPTION,
        btrim(MDM_ADDRESS_src.ADDRESS_LATITUDE) AS ADDRESS_LATITUDE,
        btrim(MDM_ADDRESS_src.ADDRESS_LONGITUDE) AS ADDRESS_LONGITUDE,
        btrim(MDM_ADDRESS_src.POSTAL_BARCODE) AS POSTAL_BARCODE,
        btrim(MDM_ADDRESS_src.SINGLE_ADDRESS_INDICATOR) AS SINGLE_ADDRESS_INDICATOR,
        btrim(MDM_ADDRESS_src.PRACTICE_LOCATION_CONFIDENCE_INDICATOR) AS PRACTICE_LOCATION_CONFIDENCE_INDICATOR,
        btrim(MDM_ADDRESS_src.PRACTICE_LOCATION_RANK) AS PRACTICE_LOCATION_RANK,
        btrim(MDM_ADDRESS_src.VALIDATION_MESSAGE) AS VALIDATION_MESSAGE,
        btrim(MDM_ADDRESS_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_ADDRESS_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_ADDRESS_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_ADDRESS_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_ADDRESS_src.batch_id,
        MDM_ADDRESS_src.row_id,
        MDM_ADDRESS_src.update_ts
 FROM teva_ingestion.MDM_ADDRESS_src;

CREATE  VIEW teva_ingestion.MDM_ADDRESS_LINK AS
 SELECT btrim(MDM_ADDRESS_LINK_src.TVCMID) AS TVCMID,
        btrim(MDM_ADDRESS_LINK_src.ADDRESS_ID) AS ADDRESS_ID,
        btrim(MDM_ADDRESS_LINK_src.DSP_ID) AS DSP_ID,
        btrim(MDM_ADDRESS_LINK_src.DSP_HCE_ID) AS DSP_HCE_ID,
        btrim(MDM_ADDRESS_LINK_src.DSP_ADDRESS_ID) AS DSP_ADDRESS_ID,
        MDM_ADDRESS_LINK_src.batch_id,
        MDM_ADDRESS_LINK_src.row_id,
        MDM_ADDRESS_LINK_src.update_ts
 FROM teva_ingestion.MDM_ADDRESS_LINK_src;

CREATE  VIEW teva_ingestion.MDM_ALTERNATE_ID AS
 SELECT btrim(MDM_ALTERNATE_ID_src.TVCMID) AS TVCMID,
        btrim(MDM_ALTERNATE_ID_src.ALTERNATE_ID_TYPE) AS ALTERNATE_ID_TYPE,
        btrim(MDM_ALTERNATE_ID_src.ALTERNATE_ID_TYPE_NAME) AS ALTERNATE_ID_TYPE_NAME,
        btrim(MDM_ALTERNATE_ID_src.ALTERNATE_ID_VALUE) AS ALTERNATE_ID_VALUE,
        btrim(MDM_ALTERNATE_ID_src.STATE) AS STATE,
        btrim(MDM_ALTERNATE_ID_src.STATE_NAME) AS STATE_NAME,
        btrim(MDM_ALTERNATE_ID_src.IDENTIFIER_CATEGORY) AS IDENTIFIER_CATEGORY,
        btrim(MDM_ALTERNATE_ID_src.STATUS) AS STATUS,
        btrim(MDM_ALTERNATE_ID_src.STATUS_NAME) AS STATUS_NAME,
        btrim(MDM_ALTERNATE_ID_src.SOURCE_DEACTIVATION_REASON_CODE) AS SOURCE_DEACTIVATION_REASON_CODE,
        btrim(MDM_ALTERNATE_ID_src.SOURCE_DEACTIVATION_REASON_DESCRIPTION) AS SOURCE_DEACTIVATION_REASON_DESCRIPTION,
        btrim(MDM_ALTERNATE_ID_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_ALTERNATE_ID_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_ALTERNATE_ID_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_ALTERNATE_ID_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_ALTERNATE_ID_src.batch_id,
        MDM_ALTERNATE_ID_src.row_id,
        MDM_ALTERNATE_ID_src.update_ts
 FROM teva_ingestion.MDM_ALTERNATE_ID_src;

CREATE  VIEW teva_ingestion.MDM_ALTERNATE_NAME AS
 SELECT btrim(MDM_ALTERNATE_NAME_src.TVCMID) AS TVCMID,
        btrim(MDM_ALTERNATE_NAME_src.NAME_TYPE) AS NAME_TYPE,
        btrim(MDM_ALTERNATE_NAME_src.NAME_TYPE_NAME) AS NAME_TYPE_NAME,
        btrim(MDM_ALTERNATE_NAME_src.NAME_VALUE) AS NAME_VALUE,
        btrim(MDM_ALTERNATE_NAME_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_ALTERNATE_NAME_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_ALTERNATE_NAME_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_ALTERNATE_NAME_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_ALTERNATE_NAME_src.batch_id,
        MDM_ALTERNATE_NAME_src.row_id,
        MDM_ALTERNATE_NAME_src.update_ts
 FROM teva_ingestion.MDM_ALTERNATE_NAME_src;

CREATE  VIEW teva_ingestion.MDM_COMMUNICATION AS
 SELECT btrim(MDM_COMMUNICATION_src.TVCMID) AS TVCMID,
        btrim(MDM_COMMUNICATION_src.ADDRESS_ID) AS ADDRESS_ID,
        btrim(MDM_COMMUNICATION_src.COMMUNICATION_TYPE) AS COMMUNICATION_TYPE,
        btrim(MDM_COMMUNICATION_src.COMMUNICATION_TYPE_NAME) AS COMMUNICATION_TYPE_NAME,
        btrim(MDM_COMMUNICATION_src.COMMUNICATION_VALUE) AS COMMUNICATION_VALUE,
        btrim(MDM_COMMUNICATION_src.STATUS_CODE) AS STATUS_CODE,
        btrim(MDM_COMMUNICATION_src.STATUS_NAME) AS STATUS_NAME,
        btrim(MDM_COMMUNICATION_src.EFFECTIVE_START_DATE) AS EFFECTIVE_START_DATE,
        btrim(MDM_COMMUNICATION_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_COMMUNICATION_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_COMMUNICATION_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_COMMUNICATION_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_COMMUNICATION_src.batch_id,
        MDM_COMMUNICATION_src.row_id,
        MDM_COMMUNICATION_src.update_ts
 FROM teva_ingestion.MDM_COMMUNICATION_src;

CREATE  VIEW teva_ingestion.MDM_DEA_ADDRESS AS
 SELECT btrim(MDM_DEA_ADDRESS_src.TVCMID) AS TVCMID,
        btrim(MDM_DEA_ADDRESS_src.ADDRESS_ID) AS ADDRESS_ID,
        btrim(MDM_DEA_ADDRESS_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(MDM_DEA_ADDRESS_src.BUSINESS_ACTIVITY_CODE) AS BUSINESS_ACTIVITY_CODE,
        btrim(MDM_DEA_ADDRESS_src.BUSINESS_ACTIVITY_DESCRIPTION) AS BUSINESS_ACTIVITY_DESCRIPTION,
        btrim(MDM_DEA_ADDRESS_src.SUB_BUSINESS_ACTIVITY_CODE) AS SUB_BUSINESS_ACTIVITY_CODE,
        btrim(MDM_DEA_ADDRESS_src.SUB_BUSINESS_ACTIVITY_DESCRIPTION) AS SUB_BUSINESS_ACTIVITY_DESCRIPTION,
        btrim(MDM_DEA_ADDRESS_src.DEA_SCHEDULE_CLASS_CODE) AS DEA_SCHEDULE_CLASS_CODE,
        btrim(MDM_DEA_ADDRESS_src.DEA_STATUS_CODE) AS DEA_STATUS_CODE,
        btrim(MDM_DEA_ADDRESS_src.DEA_STATUS_DESCRIPTION) AS DEA_STATUS_DESCRIPTION,
        btrim(MDM_DEA_ADDRESS_src.DEA_EXPIRATION_DATE) AS DEA_EXPIRATION_DATE,
        btrim(MDM_DEA_ADDRESS_src.DEA_DEACTIVATION_REASON_CODE) AS DEA_DEACTIVATION_REASON_CODE,
        btrim(MDM_DEA_ADDRESS_src.DEA_DEACTIVATION_REASON_DESCRIPTION) AS DEA_DEACTIVATION_REASON_DESCRIPTION,
        btrim(MDM_DEA_ADDRESS_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_DEA_ADDRESS_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_DEA_ADDRESS_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_DEA_ADDRESS_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_DEA_ADDRESS_src.batch_id,
        MDM_DEA_ADDRESS_src.row_id,
        MDM_DEA_ADDRESS_src.update_ts
 FROM teva_ingestion.MDM_DEA_ADDRESS_src;

CREATE  VIEW teva_ingestion.MDM_EMAIL_PREF AS
 SELECT btrim(MDM_EMAIL_PREF_src.TVCMID) AS TVCMID,
        btrim(MDM_EMAIL_PREF_src.EMAIL) AS EMAIL,
        btrim(MDM_EMAIL_PREF_src.VALUE) AS VALUE,
        btrim(MDM_EMAIL_PREF_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_EMAIL_PREF_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_EMAIL_PREF_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_EMAIL_PREF_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_EMAIL_PREF_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_EMAIL_PREF_src.batch_id,
        MDM_EMAIL_PREF_src.row_id,
        MDM_EMAIL_PREF_src.update_ts
 FROM teva_ingestion.MDM_EMAIL_PREF_src;

CREATE  VIEW teva_ingestion.MDM_HCO_TEVA_FLAG AS
 SELECT btrim(MDM_HCO_TEVA_FLAG_src.TVCMID) AS TVCMID,
        btrim(MDM_HCO_TEVA_FLAG_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim(MDM_HCO_TEVA_FLAG_src.FLAG_TYPE_NAME) AS FLAG_TYPE_NAME,
        btrim(MDM_HCO_TEVA_FLAG_src.FLAG_VALUE) AS FLAG_VALUE,
        btrim(MDM_HCO_TEVA_FLAG_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_HCO_TEVA_FLAG_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_HCO_TEVA_FLAG_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_HCO_TEVA_FLAG_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_HCO_TEVA_FLAG_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_HCO_TEVA_FLAG_src.batch_id,
        MDM_HCO_TEVA_FLAG_src.row_id,
        MDM_HCO_TEVA_FLAG_src.update_ts
 FROM teva_ingestion.MDM_HCO_TEVA_FLAG_src;

CREATE  VIEW teva_ingestion.MDM_HCP AS
 SELECT btrim(MDM_HCP_src.TVCMID) AS TVCMID,
        CASE WHEN (MDM_HCP_src.IMS_HCE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_HCP_src.IMS_HCE_ID))::int END AS IMS_HCE_ID,
        btrim(MDM_HCP_src.IMS_PRESCRIBER_ID) AS IMS_PRESCRIBER_ID,
        btrim(MDM_HCP_src.FIRST_NAME) AS FIRST_NAME,
        btrim(MDM_HCP_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(MDM_HCP_src.LAST_NAME) AS LAST_NAME,
        btrim(MDM_HCP_src.PREFIX) AS PREFIX,
        btrim(MDM_HCP_src.SUFFIX) AS SUFFIX,
        btrim(MDM_HCP_src.SUFFIX_NAME) AS SUFFIX_NAME,
        btrim(MDM_HCP_src.SUB_TYPE) AS SUB_TYPE,
        btrim(MDM_HCP_src.SUB_TYPE_NAME) AS SUB_TYPE_NAME,
        btrim(MDM_HCP_src.HEALTHCARE_PROFESSIONAL_STATUS_CODE) AS HEALTHCARE_PROFESSIONAL_STATUS_CODE,
        btrim(MDM_HCP_src.HEALTHCARE_PROFESSIONAL_STATUS_NAME) AS HEALTHCARE_PROFESSIONAL_STATUS_NAME,
        btrim(MDM_HCP_src.YEAR_OF_BIRTH) AS YEAR_OF_BIRTH,
        btrim(MDM_HCP_src.DATE_OF_DEATH) AS DATE_OF_DEATH,
        btrim(MDM_HCP_src.GENDER_CODE) AS GENDER_CODE,
        btrim(MDM_HCP_src.GENDER_NAME) AS GENDER_NAME,
        btrim(MDM_HCP_src.TEVA_SPECIALTY_CODE) AS TEVA_SPECIALTY_CODE,
        btrim(MDM_HCP_src.TEVA_SPECIALTY_NAME) AS TEVA_SPECIALTY_NAME,
        btrim(MDM_HCP_src.LOGICAL_DELETION_DATE) AS LOGICAL_DELETION_DATE,
        btrim(MDM_HCP_src.HCE_INSERT_DATE) AS HCE_INSERT_DATE,
        btrim(MDM_HCP_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_HCP_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_HCP_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_HCP_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_HCP_src.batch_id,
        MDM_HCP_src.row_id,
        MDM_HCP_src.update_ts
 FROM teva_ingestion.MDM_HCP_src;

CREATE  VIEW teva_ingestion.MDM_HCP_TEVA_FLAG AS
 SELECT btrim(MDM_HCP_TEVA_FLAG_src.TVCMID) AS TVCMID,
        btrim(MDM_HCP_TEVA_FLAG_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim(MDM_HCP_TEVA_FLAG_src.FLAG_TYPE_NAME) AS FLAG_TYPE_NAME,
        btrim(MDM_HCP_TEVA_FLAG_src.FLAG_VALUE) AS FLAG_VALUE,
        btrim(MDM_HCP_TEVA_FLAG_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_HCP_TEVA_FLAG_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_HCP_TEVA_FLAG_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_HCP_TEVA_FLAG_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_HCP_TEVA_FLAG_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_HCP_TEVA_FLAG_src.batch_id,
        MDM_HCP_TEVA_FLAG_src.row_id,
        MDM_HCP_TEVA_FLAG_src.update_ts
 FROM teva_ingestion.MDM_HCP_TEVA_FLAG_src;

CREATE  VIEW teva_ingestion.MDM_IMS_FLAG AS
 SELECT btrim(MDM_IMS_FLAG_src.TVCMID) AS TVCMID,
        btrim(MDM_IMS_FLAG_src.FLAG_TYPE) AS FLAG_TYPE,
        btrim(MDM_IMS_FLAG_src.FLAG_TYPE_NAME) AS FLAG_TYPE_NAME,
        btrim(MDM_IMS_FLAG_src.FLAG_VALUE) AS FLAG_VALUE,
        btrim(MDM_IMS_FLAG_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_IMS_FLAG_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_IMS_FLAG_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_IMS_FLAG_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_IMS_FLAG_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_IMS_FLAG_src.batch_id,
        MDM_IMS_FLAG_src.row_id,
        MDM_IMS_FLAG_src.update_ts
 FROM teva_ingestion.MDM_IMS_FLAG_src;

CREATE  VIEW teva_ingestion.MDM_LICENSE AS
 SELECT btrim(MDM_LICENSE_src.TVCMID) AS TVCMID,
        btrim(MDM_LICENSE_src.HCE_REGULATION_ID) AS HCE_REGULATION_ID,
        CASE WHEN (MDM_LICENSE_src.LICENSE_TYPE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_LICENSE_src.LICENSE_TYPE_ID))::int END AS LICENSE_TYPE_ID,
        btrim(MDM_LICENSE_src.LICENSE_TYPE_NAME) AS LICENSE_TYPE_NAME,
        btrim(MDM_LICENSE_src.AUTHORIZATION_NUMBER) AS AUTHORIZATION_NUMBER,
        btrim(MDM_LICENSE_src.PROFESSION_CODE) AS PROFESSION_CODE,
        btrim(MDM_LICENSE_src.STATE) AS STATE,
        btrim(MDM_LICENSE_src.STATE_NAME) AS STATE_NAME,
        CASE WHEN (MDM_LICENSE_src.STATE_BOARD_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_LICENSE_src.STATE_BOARD_ID))::int END AS STATE_BOARD_ID,
        btrim(MDM_LICENSE_src.STATE_BOARD_NAME) AS STATE_BOARD_NAME,
        CASE WHEN (MDM_LICENSE_src.LICENSE_PRIVILEGE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_LICENSE_src.LICENSE_PRIVILEGE_ID))::int END AS LICENSE_PRIVILEGE_ID,
        btrim(MDM_LICENSE_src.LICENSE_PRIVILEGE) AS LICENSE_PRIVILEGE,
        btrim(MDM_LICENSE_src.LICENSE_CERTIFICATION_CODE) AS LICENSE_CERTIFICATION_CODE,
        btrim(MDM_LICENSE_src.LICENSE_CERTIFICATION_NAME) AS LICENSE_CERTIFICATION_NAME,
        CASE WHEN (MDM_LICENSE_src.LICENSE_TYPE_PRIVILEGE_RANK = ''::varchar) THEN NULL::int ELSE (btrim(MDM_LICENSE_src.LICENSE_TYPE_PRIVILEGE_RANK))::int END AS LICENSE_TYPE_PRIVILEGE_RANK,
        btrim(MDM_LICENSE_src.LICENSE_STATUS_CODE) AS LICENSE_STATUS_CODE,
        btrim(MDM_LICENSE_src.LICENSE_STATUS_DESCRIPTION) AS LICENSE_STATUS_DESCRIPTION,
        btrim(MDM_LICENSE_src.LICENSE_EFFECTIVE_DATE) AS LICENSE_EFFECTIVE_DATE,
        btrim(MDM_LICENSE_src.LICENSE_EXPIRATION_DATE) AS LICENSE_EXPIRATION_DATE,
        btrim(MDM_LICENSE_src.LICENSE_DEACTIVATION_REASON_CODE) AS LICENSE_DEACTIVATION_REASON_CODE,
        btrim(MDM_LICENSE_src.LICENSE_DEACTIVATION_REASON_DESCRIPTION) AS LICENSE_DEACTIVATION_REASON_DESCRIPTION,
        btrim(MDM_LICENSE_src.RECORD_TYPE) AS RECORD_TYPE,
        btrim(MDM_LICENSE_src.RECORD_TYPE_NAME) AS RECORD_TYPE_NAME,
        btrim(MDM_LICENSE_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_LICENSE_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_LICENSE_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_LICENSE_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_LICENSE_src.batch_id,
        MDM_LICENSE_src.row_id,
        MDM_LICENSE_src.update_ts
 FROM teva_ingestion.MDM_LICENSE_src;

CREATE  VIEW teva_ingestion.MDM_MARKETING_CHANNEL AS
 SELECT btrim(MDM_MARKETING_CHANNEL_src.TVCMID) AS TVCMID,
        btrim(MDM_MARKETING_CHANNEL_src.CHANNEL) AS CHANNEL,
        btrim(MDM_MARKETING_CHANNEL_src.VALUE) AS VALUE,
        btrim(MDM_MARKETING_CHANNEL_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_MARKETING_CHANNEL_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_MARKETING_CHANNEL_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_MARKETING_CHANNEL_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_MARKETING_CHANNEL_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_MARKETING_CHANNEL_src.batch_id,
        MDM_MARKETING_CHANNEL_src.row_id,
        MDM_MARKETING_CHANNEL_src.update_ts
 FROM teva_ingestion.MDM_MARKETING_CHANNEL_src;

CREATE  VIEW teva_ingestion.MDM_PROFESSIONAL AS
 SELECT btrim(MDM_PROFESSIONAL_src.TVCMID) AS TVCMID,
        btrim(MDM_PROFESSIONAL_src.PROFESSION_CODE) AS PROFESSION_CODE,
        btrim(MDM_PROFESSIONAL_src.PROFESSION_CODE_NAME) AS PROFESSION_CODE_NAME,
        btrim(MDM_PROFESSIONAL_src.PROFESSION_RANK) AS PROFESSION_RANK,
        btrim(MDM_PROFESSIONAL_src.STATUS) AS STATUS,
        btrim(MDM_PROFESSIONAL_src.PROFESSION_STATUS_NAME) AS PROFESSION_STATUS_NAME,
        btrim(MDM_PROFESSIONAL_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_PROFESSIONAL_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_PROFESSIONAL_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_PROFESSIONAL_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_PROFESSIONAL_src.batch_id,
        MDM_PROFESSIONAL_src.row_id,
        MDM_PROFESSIONAL_src.update_ts
 FROM teva_ingestion.MDM_PROFESSIONAL_src;

CREATE  VIEW teva_ingestion.MDM_RAW_DEA AS
 SELECT btrim(MDM_RAW_DEA_src.TVCMID) AS TVCMID,
        btrim(MDM_RAW_DEA_src.IMS_ID) AS IMS_ID,
        btrim(MDM_RAW_DEA_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(MDM_RAW_DEA_src.NAME) AS NAME,
        btrim(MDM_RAW_DEA_src.ADDITIONAL_COMPANY_INFO) AS ADDITIONAL_COMPANY_INFO,
        btrim(MDM_RAW_DEA_src.ADDRESS_LINE1) AS ADDRESS_LINE1,
        btrim(MDM_RAW_DEA_src.ADDRESS_LINE2) AS ADDRESS_LINE2,
        btrim(MDM_RAW_DEA_src.CITY) AS CITY,
        btrim(MDM_RAW_DEA_src.STATE) AS STATE,
        btrim(MDM_RAW_DEA_src.STATE_NAME) AS STATE_NAME,
        btrim(MDM_RAW_DEA_src.ZIP) AS ZIP,
        btrim(MDM_RAW_DEA_src.BUSINESS_ACTIVITY_CODE) AS BUSINESS_ACTIVITY_CODE,
        btrim(MDM_RAW_DEA_src.DRUG_SCHEDULES) AS DRUG_SCHEDULES,
        btrim(MDM_RAW_DEA_src.EXPIRATION_DATE) AS EXPIRATION_DATE,
        btrim(MDM_RAW_DEA_src.BUSINESS_ACTIVITY_SUB_CODE) AS BUSINESS_ACTIVITY_SUB_CODE,
        btrim(MDM_RAW_DEA_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_RAW_DEA_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_RAW_DEA_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_RAW_DEA_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_RAW_DEA_src.batch_id,
        MDM_RAW_DEA_src.row_id,
        MDM_RAW_DEA_src.update_ts
 FROM teva_ingestion.MDM_RAW_DEA_src;

CREATE  VIEW teva_ingestion.MDM_REGULATION AS
 SELECT CASE WHEN (MDM_REGULATION_src.STATE_LICENSE_TYPE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_REGULATION_src.STATE_LICENSE_TYPE_ID))::int END AS STATE_LICENSE_TYPE_ID,
        btrim(MDM_REGULATION_src.STATE_LICENSE_TYPE_NAME) AS STATE_LICENSE_TYPE_NAME,
        CASE WHEN (MDM_REGULATION_src.STATE_PRIVILEGE_TYPE_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_REGULATION_src.STATE_PRIVILEGE_TYPE_ID))::int END AS STATE_PRIVILEGE_TYPE_ID,
        btrim(MDM_REGULATION_src.STATE_LICENSE_PRIVILEGE_TYPE_NAME) AS STATE_LICENSE_PRIVILEGE_TYPE_NAME,
        CASE WHEN (MDM_REGULATION_src.STATE_LICENSE_PRIVILEGE_TYPE_RANK = ''::varchar) THEN NULL::int ELSE (btrim(MDM_REGULATION_src.STATE_LICENSE_PRIVILEGE_TYPE_RANK))::int END AS STATE_LICENSE_PRIVILEGE_TYPE_RANK,
        btrim(MDM_REGULATION_src.STATE_CODE) AS STATE_CODE,
        btrim(MDM_REGULATION_src.STATE_NAME) AS STATE_NAME,
        CASE WHEN (MDM_REGULATION_src.STATE_BOARD_ID = ''::varchar) THEN NULL::int ELSE (btrim(MDM_REGULATION_src.STATE_BOARD_ID))::int END AS STATE_BOARD_ID,
        btrim(MDM_REGULATION_src.STATE_BOARD_NAME) AS STATE_BOARD_NAME,
        btrim(MDM_REGULATION_src.CERTIFICATION_CODE) AS CERTIFICATION_CODE,
        btrim(MDM_REGULATION_src.REQUIRED_SAMPLE_NON_CTRL) AS REQUIRED_SAMPLE_NON_CTRL,
        btrim(MDM_REGULATION_src.REQUIRED_SAMPLE_CTRL) AS REQUIRED_SAMPLE_CTRL,
        btrim(MDM_REGULATION_src.RECEIVED_SAMPLE_NON_CTRL) AS RECEIVED_SAMPLE_NON_CTRL,
        btrim(MDM_REGULATION_src.RECEIVED_SAMPLE_CTRL) AS RECEIVED_SAMPLE_CTRL,
        btrim(MDM_REGULATION_src.DISTRIBUTED_SAMPLE_NON_CTRL) AS DISTRIBUTED_SAMPLE_NON_CTRL,
        btrim(MDM_REGULATION_src.DISTRIBUTED_SAMPLE_CTRL) AS DISTRIBUTED_SAMPLE_CTRL,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_I_FLAG) AS SAMPLE_DRUG_SCHEDULE_I_FLAG,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_II_FLAG) AS SAMPLE_DRUG_SCHEDULE_II_FLAG,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_III_FLAG) AS SAMPLE_DRUG_SCHEDULE_III_FLAG,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_IV_FLAG) AS SAMPLE_DRUG_SCHEDULE_IV_FLAG,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_V_FLAG) AS SAMPLE_DRUG_SCHEDULE_V_FLAG,
        btrim(MDM_REGULATION_src.SAMPLE_DRUG_SCHEDULE_VI_FLAG) AS SAMPLE_DRUG_SCHEDULE_VI_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_NON_CTRL_FLAG) AS PRESCRIBER_NON_CTRL_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_APP_REQUIRED_NON_CTRL_FLAG) AS PRESCRIBER_APP_REQUIRED_NON_CTRL_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_CTRL_FLAG) AS PRESCRIBER_CTRL_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_APP_REQUIRED_CTRL_FLAG) AS PRESCRIBER_APP_REQUIRED_CTRL_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_I_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_I_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_II_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_II_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_III_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_III_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_IV_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_IV_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_V_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_V_FLAG,
        btrim(MDM_REGULATION_src.PRESCRIBER_DRUG_SCHEDULE_VI_FLAG) AS PRESCRIBER_DRUG_SCHEDULE_VI_FLAG,
        btrim(MDM_REGULATION_src.SUPERVISORY_RELATIONSHIP_CODE_NON_CTRL) AS SUPERVISORY_RELATIONSHIP_CODE_NON_CTRL,
        btrim(MDM_REGULATION_src.SUPERVISORY_RELATIONSHIP_CODE_CTRL) AS SUPERVISORY_RELATIONSHIP_CODE_CTRL,
        btrim(MDM_REGULATION_src.COLLABORATIVE_NON_CTRL) AS COLLABORATIVE_NON_CTRL,
        btrim(MDM_REGULATION_src.COLLABORATIVE_CTRL) AS COLLABORATIVE_CTRL,
        btrim(MDM_REGULATION_src.INCLUSIONARY) AS INCLUSIONARY,
        btrim(MDM_REGULATION_src.EXCLUSIONARY) AS EXCLUSIONARY,
        btrim(MDM_REGULATION_src.DELEGATION_NON_CTRL) AS DELEGATION_NON_CTRL,
        btrim(MDM_REGULATION_src.DELEGATION_CTRL) AS DELEGATION_CTRL,
        btrim(MDM_REGULATION_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_REGULATION_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_REGULATION_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_REGULATION_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_REGULATION_src.batch_id,
        MDM_REGULATION_src.row_id,
        MDM_REGULATION_src.update_ts
 FROM teva_ingestion.MDM_REGULATION_src;

CREATE  VIEW teva_ingestion.MDM_RELATIONSHIP AS
 SELECT btrim(MDM_RELATIONSHIP_src.HIERARCHY_CODE) AS HIERARCHY_CODE,
        btrim(MDM_RELATIONSHIP_src.HIERARCHY_NAME) AS HIERARCHY_NAME,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_TYPE_CODE) AS RELATIONSHIP_TYPE_CODE,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_TYPE_NAME) AS RELATIONSHIP_TYPE_NAME,
        btrim(MDM_RELATIONSHIP_src.PARENT_TVCMID) AS PARENT_TVCMID,
        btrim(MDM_RELATIONSHIP_src.CHILD_TVCMID) AS CHILD_TVCMID,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_STATUS_CODE) AS RELATIONSHIP_STATUS_CODE,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_STATUS_NAME) AS RELATIONSHIP_STATUS_NAME,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_START_DATE) AS RELATIONSHIP_START_DATE,
        btrim(MDM_RELATIONSHIP_src.RELATIONSHIP_END_DATE) AS RELATIONSHIP_END_DATE,
        btrim(MDM_RELATIONSHIP_src.NOTES) AS NOTES,
        btrim(MDM_RELATIONSHIP_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_RELATIONSHIP_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_RELATIONSHIP_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_RELATIONSHIP_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_RELATIONSHIP_src.batch_id,
        MDM_RELATIONSHIP_src.row_id,
        MDM_RELATIONSHIP_src.update_ts
 FROM teva_ingestion.MDM_RELATIONSHIP_src;

CREATE  VIEW teva_ingestion.MDM_SAMPLE_ELIGIBILITY AS
 SELECT btrim(MDM_SAMPLE_ELIGIBILITY_src.TVCMID) AS TVCMID,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.SLN) AS SLN,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.SLN_STATE) AS SLN_STATE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.SLN_STATUS_CODE) AS SLN_STATUS_CODE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.SLN_STATUS_DESCRIPTION) AS SLN_STATUS_DESCRIPTION,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.SLN_EXPIRATION_DATE) AS SLN_EXPIRATION_DATE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.TEVA_SAMPLE_ELIGIBILITY_FLAG) AS TEVA_SAMPLE_ELIGIBILITY_FLAG,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.TEVA_SCHEDULE_IV_ELIGIBILITY_FLAG) AS TEVA_SCHEDULE_IV_ELIGIBILITY_FLAG,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.TEVA_SCHEDULE_V_ELIGIBILITY_FLAG) AS TEVA_SCHEDULE_V_ELIGIBILITY_FLAG,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.PROFESSION_SHORT_DESCRIPTION) AS PROFESSION_SHORT_DESCRIPTION,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.TEVA_SPECIALTY_CODE) AS TEVA_SPECIALTY_CODE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.CERTIFICATION_CODE) AS CERTIFICATION_CODE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.CERTIFICATION_DESCRIPTION) AS CERTIFICATION_DESCRIPTION,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_SAMPLE_ELIGIBILITY_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_SAMPLE_ELIGIBILITY_src.batch_id,
        MDM_SAMPLE_ELIGIBILITY_src.row_id,
        MDM_SAMPLE_ELIGIBILITY_src.update_ts
 FROM teva_ingestion.MDM_SAMPLE_ELIGIBILITY_src;

CREATE  VIEW teva_ingestion.MDM_SOURCE_DETAILS AS
 SELECT btrim(MDM_SOURCE_DETAILS_src.TVCMID) AS TVCMID,
        btrim(MDM_SOURCE_DETAILS_src.IDENTIFIER_CODE) AS IDENTIFIER_CODE,
        btrim(MDM_SOURCE_DETAILS_src.IDENTIFIER_DESCRIPTION) AS IDENTIFIER_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.IDENTIFIER_VALUE) AS IDENTIFIER_VALUE,
        btrim(MDM_SOURCE_DETAILS_src.LEGACY_IDENTIFIER_CODE) AS LEGACY_IDENTIFIER_CODE,
        CASE WHEN (MDM_SOURCE_DETAILS_src.AMA_MD_DO_FLAG = ''::varchar) THEN NULL::int ELSE (btrim(MDM_SOURCE_DETAILS_src.AMA_MD_DO_FLAG))::int END AS AMA_MD_DO_FLAG,
        btrim(MDM_SOURCE_DETAILS_src.MAJOR_PROFESSIONAL_ACTIVITY) AS MAJOR_PROFESSIONAL_ACTIVITY,
        btrim(MDM_SOURCE_DETAILS_src.MAJOR_PROFESSIONAL_ACTIVITY_DESCRIPTION) AS MAJOR_PROFESSIONAL_ACTIVITY_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.HOSPITAL_HOURS) AS HOSPITAL_HOURS,
        btrim(MDM_SOURCE_DETAILS_src.AMA_HOSPITAL_ID) AS AMA_HOSPITAL_ID,
        btrim(MDM_SOURCE_DETAILS_src.AMA_HOSPITAL_DESCRIPTION) AS AMA_HOSPITAL_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.PRACTICE_TYPE_CODE) AS PRACTICE_TYPE_CODE,
        btrim(MDM_SOURCE_DETAILS_src.PRACTICE_TYPE_DESCRIPTION) AS PRACTICE_TYPE_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.EMPLOYMENT_TYPE_CODE) AS EMPLOYMENT_TYPE_CODE,
        btrim(MDM_SOURCE_DETAILS_src.EMPLOYMENT_TYPE_DESCRIPTION) AS EMPLOYMENT_TYPE_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.BIRTH_CITY) AS BIRTH_CITY,
        btrim(MDM_SOURCE_DETAILS_src.BIRTH_STATE) AS BIRTH_STATE,
        btrim(MDM_SOURCE_DETAILS_src.BIRTH_COUNTRY_CODE) AS BIRTH_COUNTRY_CODE,
        btrim(MDM_SOURCE_DETAILS_src.BIRTH_COUNTRY_DESCRIPTION) AS BIRTH_COUNTRY_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.MEDICAL_SCHOOL_CODE) AS MEDICAL_SCHOOL_CODE,
        btrim(MDM_SOURCE_DETAILS_src.MEDICAL_SCHOOL_DESCRIPTION) AS MEDICAL_SCHOOL_DESCRIPTION,
        btrim(MDM_SOURCE_DETAILS_src.GRADUATION_YEAR) AS GRADUATION_YEAR,
        CASE WHEN (MDM_SOURCE_DETAILS_src.NUMBER_OF_PHYSICIAN_OFFICES = ''::varchar) THEN NULL::int ELSE (btrim(MDM_SOURCE_DETAILS_src.NUMBER_OF_PHYSICIAN_OFFICES))::int END AS NUMBER_OF_PHYSICIAN_OFFICES,
        btrim(MDM_SOURCE_DETAILS_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_SOURCE_DETAILS_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_SOURCE_DETAILS_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_SOURCE_DETAILS_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_SOURCE_DETAILS_src.batch_id,
        MDM_SOURCE_DETAILS_src.row_id,
        MDM_SOURCE_DETAILS_src.update_ts
 FROM teva_ingestion.MDM_SOURCE_DETAILS_src;

CREATE  VIEW teva_ingestion.MDM_SPECIALTY AS
 SELECT btrim(MDM_SPECIALTY_src.TVCMID) AS TVCMID,
        btrim(MDM_SPECIALTY_src.SPECIALTY_CODE) AS SPECIALTY_CODE,
        btrim(MDM_SPECIALTY_src.SPECIALTY_CODE_NAME) AS SPECIALTY_CODE_NAME,
        btrim(MDM_SPECIALTY_src.SPECIALTY_RANKING) AS SPECIALTY_RANKING,
        btrim(MDM_SPECIALTY_src.STATUS) AS STATUS,
        btrim(MDM_SPECIALTY_src.STATUS_NAME) AS STATUS_NAME,
        btrim(MDM_SPECIALTY_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_SPECIALTY_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_SPECIALTY_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_SPECIALTY_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_SPECIALTY_src.batch_id,
        MDM_SPECIALTY_src.row_id,
        MDM_SPECIALTY_src.update_ts
 FROM teva_ingestion.MDM_SPECIALTY_src;

CREATE  VIEW teva_ingestion.MDM_EMAIL_PREFERENCE AS
 SELECT btrim(MDM_EMAIL_PREFERENCE_src.TVCMID) AS TVCMID,
        btrim(MDM_EMAIL_PREFERENCE_src.EMAIL) AS EMAIL,
        btrim(MDM_EMAIL_PREFERENCE_src.VALUE) AS VALUE,
        btrim(MDM_EMAIL_PREFERENCE_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(MDM_EMAIL_PREFERENCE_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_EMAIL_PREFERENCE_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_EMAIL_PREFERENCE_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_EMAIL_PREFERENCE_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_EMAIL_PREFERENCE_src.batch_id,
        MDM_EMAIL_PREFERENCE_src.row_id,
        MDM_EMAIL_PREFERENCE_src.update_ts
 FROM teva_ingestion.MDM_EMAIL_PREFERENCE_src;

CREATE  VIEW raw.mdm_email_pref AS
 SELECT src.TVCMID,
        src.EMAIL,
        src.VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_EMAIL_PREF_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'MDM_EMAL_PREFERENCE'::varchar(19)))));

CREATE  VIEW teva_ingestion.MDM_RAW_NPI AS
 SELECT btrim(MDM_RAW_NPI_src.TVCMID) AS TVCMID,
        btrim(MDM_RAW_NPI_src.NPI_NUMBER) AS NPI_NUMBER,
        btrim(MDM_RAW_NPI_src.NPI_FIRST_NAME) AS NPI_FIRST_NAME,
        btrim(MDM_RAW_NPI_src.NPI_MIDDLE_NAME) AS NPI_MIDDLE_NAME,
        btrim(MDM_RAW_NPI_src.NPI_LAST_NAME) AS NPI_LAST_NAME,
        btrim(MDM_RAW_NPI_src.PRACTICE_ADDRESS_1) AS PRACTICE_ADDRESS_1,
        btrim(MDM_RAW_NPI_src.PRACTICE_ADDRESS_2) AS PRACTICE_ADDRESS_2,
        btrim(MDM_RAW_NPI_src.PRACTICE_CITY) AS PRACTICE_CITY,
        btrim(MDM_RAW_NPI_src.PRACTICE_STATE_NAME) AS PRACTICE_STATE_NAME,
        btrim(MDM_RAW_NPI_src.PRACTICE_POSTAL_CODE) AS PRACTICE_POSTAL_CODE,
        btrim(MDM_RAW_NPI_src.PRACTICE_COUNTRY_CODE) AS PRACTICE_COUNTRY_CODE,
        btrim(MDM_RAW_NPI_src.PRIMARY_TAXONOMY_CODE) AS PRIMARY_TAXONOMY_CODE,
        btrim(MDM_RAW_NPI_src.PRIMARY_TAXONOMY_TYPE) AS PRIMARY_TAXONOMY_TYPE,
        btrim(MDM_RAW_NPI_src.PRIMARY_TAXONOMY_CLASSIFICATION) AS PRIMARY_TAXONOMY_CLASSIFICATION,
        btrim(MDM_RAW_NPI_src.PRIMARY_TAXONOMY_SPECIALTY) AS PRIMARY_TAXONOMY_SPECIALTY,
        btrim(MDM_RAW_NPI_src.IMS_SPECIALTY_CODE) AS IMS_SPECIALTY_CODE,
        btrim(MDM_RAW_NPI_src.IMS_SPECIALTY_DESCRIPTION) AS IMS_SPECIALTY_DESCRIPTION,
        btrim(MDM_RAW_NPI_src.NPI_DEACTIVATION_REASON_CODE) AS NPI_DEACTIVATION_REASON_CODE,
        btrim(MDM_RAW_NPI_src.NPI_DEACTIVATION_DATE) AS NPI_DEACTIVATION_DATE,
        btrim(MDM_RAW_NPI_src.CREATED_BY) AS CREATED_BY,
        btrim(MDM_RAW_NPI_src.CREATED_DATE) AS CREATED_DATE,
        btrim(MDM_RAW_NPI_src.UPDATED_BY) AS UPDATED_BY,
        btrim(MDM_RAW_NPI_src.UPDATED_DATE) AS UPDATED_DATE,
        MDM_RAW_NPI_src.batch_id,
        MDM_RAW_NPI_src.row_id,
        MDM_RAW_NPI_src.update_ts
 FROM teva_ingestion.MDM_RAW_NPI_src;

CREATE  VIEW outbound.zzz_asi_rx_by_market_smr AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx LEFT  JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '435'::varchar(3)) AND (rx.ims_report_number_cnt = '68'::varchar(2)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.v_ob_ahm_customer_individual_duplicate_Check AS
 SELECT cm.tvcmid AS CustomerId,
        coalesce(cm.first_name, ''::varchar) AS FirstName,
        coalesce(cm.last_name, ''::varchar) AS LastName,
        coalesce(cm.middle_name, ''::varchar) AS MiddleName,
        ''::varchar AS Salutation,
        coalesce(cm.suffix, ''::varchar) AS PersonalSuffix,
        cm.sub_type_name AS CustomerType,
        CASE WHEN (cm.teva_specialty_code = 'NRP'::varchar(3)) THEN 'NP'::varchar(2) ELSE d.profession_code_shortname END AS ProfessionalDesignation,
        coalesce(cm.teva_specialty_code, ''::varchar) AS PrimarySpecialtyCode,
        ''::varchar AS SecondarySpecialtyCode,
        ''::varchar AS GovernmentEmployeeIndicator,
        ''::varchar AS TaxId,
        ''::varchar AS TaxIdType,
        ''::varchar AS BusinessEmail,
        ''::varchar AS BusinessPhone,
        ''::varchar AS BusinessFax,
        ''::varchar AS MobilePhone,
        ''::varchar AS HomePhone,
        'US'::varchar(2) AS RegionId,
        CASE WHEN (cm.healthcare_professional_status_code = 'A'::varchar(1)) THEN 'Active'::varchar(6) WHEN (cm.healthcare_professional_status_code <> 'A'::varchar(1)) THEN 'Inactive'::varchar(8) ELSE ''::varchar END AS Status
 FROM ((mdm.hcp cm LEFT  JOIN mdm.professional prof ON (((cm.tvcmid = prof.tvcmid) AND (prof.profession_rank = 1::float)))) JOIN reference.Designations d ON ((d.profession_code = prof.profession_code)))
 WHERE ((cm.tvcmid IS NOT NULL) AND (cm.tvcmid = ANY (ARRAY[102904, 1244562, 1377015, 1582445, 1609131, 1925288, 2020622, 3243439, 5010145, 5120229, 5122932])))
 GROUP BY cm.tvcmid,
          coalesce(cm.first_name, ''::varchar),
          coalesce(cm.last_name, ''::varchar),
          coalesce(cm.middle_name, ''::varchar),
          ''::varchar,
          coalesce(cm.suffix, ''::varchar),
          cm.sub_type_name,
          CASE WHEN (cm.teva_specialty_code = 'NRP'::varchar(3)) THEN 'NP'::varchar(2) ELSE d.profession_code_shortname END,
          coalesce(cm.teva_specialty_code, ''::varchar),
          'US'::varchar(2),
          CASE WHEN (cm.healthcare_professional_status_code = 'A'::varchar(1)) THEN 'Active'::varchar(6) WHEN (cm.healthcare_professional_status_code <> 'A'::varchar(1)) THEN 'Inactive'::varchar(8) ELSE ''::varchar END;

CREATE  VIEW public.DDDMD_WEEKLY_DEMO_DOL AS
 SELECT EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.client_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.report_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_facility_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_prescriber_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address1,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address2,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address3,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address4,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src
 WHERE (EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src));

CREATE  VIEW public.DDDMD_WEEKLY_DEMO_UNITS AS
 SELECT EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.client_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.report_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_facility_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_prescriber_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address1,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address2,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address3,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address4,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src
 WHERE (EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src));

CREATE  VIEW teva_ingestion.EXT_VV_MEDICAL_EVENT_VOD__C AS
 SELECT btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.active_vod__c) AS active_vod__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.address_tva__c) AS address_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.city_tva__c) AS city_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.createddate) AS createddate,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.demo_led_by_tva__c) AS demo_led_by_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.description_vod__c) AS description_vod__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.end_date_vod__c) AS end_date_vod__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.event_type__c) AS event_type__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.id) AS id,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.lastactivitydate) AS lastactivitydate,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.lastreferenceddate) AS lastreferenceddate,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.lastvieweddate) AS lastvieweddate,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.location__c) AS location__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.name) AS name,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.number_of_attendees_tva__c) AS number_of_attendees_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.ownerid) AS ownerid,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.primary_product__c) AS primary_product__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.recordtypeid) AS recordtypeid,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.secondary_product__c) AS secondary_product__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.start_date_vod__c) AS start_date_vod__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.state_tva__c) AS state_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.status_tva__c) AS status_tva__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.website__c) AS website__c,
        btrim(EXT_VV_MEDICAL_EVENT_VOD__C_src.zip_tva__c) AS zip_tva__c,
        EXT_VV_MEDICAL_EVENT_VOD__C_src.batch_id,
        EXT_VV_MEDICAL_EVENT_VOD__C_src.row_id,
        EXT_VV_MEDICAL_EVENT_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_MEDICAL_EVENT_VOD__C_src;

CREATE  VIEW raw.ext_vv_medical_event_vod__c AS
 SELECT src.active_vod__c,
        src.address_tva__c,
        src.city_tva__c,
        src.createdbyid,
        src.createddate,
        src.demo_led_by_tva__c,
        src.description_vod__c,
        src.end_date_vod__c,
        src.event_type__c,
        src.id,
        src.isdeleted,
        src.islocked,
        src.lastactivitydate,
        src.lastmodifiedbyid,
        src.lastmodifieddate,
        src.lastreferenceddate,
        src.lastvieweddate,
        src.location__c,
        src.mayedit,
        src.mobile_id_vod__c,
        src.name,
        src.number_of_attendees_tva__c,
        src.ownerid,
        src.primary_product__c,
        src.recordtypeid,
        src.secondary_product__c,
        src.start_date_vod__c,
        src.state_tva__c,
        src.status_tva__c,
        src.systemmodstamp,
        src.website__c,
        src.zip_tva__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_MEDICAL_EVENT_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_MEDICAL_EVENT_VOD__C'::varchar(27)))));

CREATE  VIEW outbound.DDDMD_WEEKLY_DOLLARS AS
 SELECT EXT_TR_DDDMD_WEEKLY_DOLLARS_src.client_num,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.report_num,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.subcategory_code,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.alt_seq_num,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.filler01,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.category_code,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.ims_product_code,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.data_date,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk01,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk02,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk03,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk04,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk05,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk06,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk07,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk08,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk09,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk10,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk11,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk12,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk13,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk14,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk15,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk16,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk17,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk18,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk19,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk20,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk21,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk22,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk23,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk24,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk25,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk26,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk27,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk28,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk29,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk30,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk31,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk32,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk33,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk34,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk35,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk36,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk37,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk38,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk39,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk40,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk41,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk42,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk43,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk44,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk45,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk46,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk47,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk48,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk49,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk50,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk51,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk52,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk53,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk54,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk55,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk56,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk57,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk58,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk59,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk60,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk61,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk62,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk63,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk64,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk65,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk66,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk67,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk68,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk69,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk70,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk71,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk72,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk73,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk74,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk75,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk76,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk77,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk78,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk79,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk80,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk81,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk82,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk83,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk84,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk85,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk86,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk87,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk88,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk89,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk90,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk91,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk92,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk93,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk94,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk95,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk96,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk97,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk98,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk99,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk100,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk101,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk102,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk103,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk104,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk105,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.dol_wk106,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_DOLLARS_src.outlet_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DOLLARS_src
 WHERE (EXT_TR_DDDMD_WEEKLY_DOLLARS_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_DOLLARS_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DOLLARS_src));

CREATE  VIEW outbound.DDDMD_WEEKLY_DEMO_DOL AS
 SELECT EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.client_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.report_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_facility_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.ims_prescriber_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.outlet_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address1,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address2,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address3,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_address4,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.facility_prescriber_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src
 WHERE (EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_DOL_src));

CREATE  VIEW teva_ingestion.EXT_TW_ICS_SALES AS
 SELECT btrim(EXT_TW_ICS_SALES_src.BP_CODE) AS BP_CODE,
        btrim(EXT_TW_ICS_SALES_src.ORTHO_E) AS ORTHO_E,
        btrim(EXT_TW_ICS_SALES_src.BP_NAME) AS BP_NAME,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_ADDRESS) AS SHIP_TO_ADDRESS,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_CITY) AS SHIP_TO_CITY,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_STATE) AS SHIP_TO_STATE,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_ZIP_CODE) AS SHIP_TO_ZIP_CODE,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_COUNTRY) AS SHIP_TO_COUNTRY,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_PHONE) AS SHIP_TO_PHONE,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_FAX) AS SHIP_TO_FAX,
        btrim(EXT_TW_ICS_SALES_src.SHIP_TO_EMAIL) AS SHIP_TO_EMAIL,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_ADDRESS) AS BILL_TO_ADDRESS,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_CITY) AS BILL_TO_CITY,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_STATE) AS BILL_TO_STATE,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_ZIP_CODE) AS BILL_TO_ZIP_CODE,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_COUNTRY) AS BILL_TO_COUNTRY,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_PHONE) AS BILL_TO_PHONE,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_FAX) AS BILL_TO_FAX,
        btrim(EXT_TW_ICS_SALES_src.BILL_TO_EMAIL) AS BILL_TO_EMAIL,
        btrim(EXT_TW_ICS_SALES_src.CLASS_OF_TRADE) AS CLASS_OF_TRADE,
        btrim(EXT_TW_ICS_SALES_src.INVOICE_NUM) AS INVOICE_NUM,
        btrim(EXT_TW_ICS_SALES_src.DEL_AMT) AS DEL_AMT,
        btrim(EXT_TW_ICS_SALES_src.INVOICE_DATE) AS INVOICE_DATE,
        btrim(EXT_TW_ICS_SALES_src."24237") AS "24237",
        btrim(EXT_TW_ICS_SALES_src."24238") AS "24238",
        btrim(EXT_TW_ICS_SALES_src."24800") AS "24800",
        btrim(EXT_TW_ICS_SALES_src."33223") AS "33223",
        btrim(EXT_TW_ICS_SALES_src.PACKS) AS PACKS,
        btrim(EXT_TW_ICS_SALES_src.UNIT_PRICE) AS UNIT_PRICE,
        btrim(EXT_TW_ICS_SALES_src.TERRITORY) AS TERRITORY,
        btrim(EXT_TW_ICS_SALES_src.ORDER_TYPE_CODE) AS ORDER_TYPE_CODE,
        btrim(EXT_TW_ICS_SALES_src.ORDER_TYPE_DESC) AS ORDER_TYPE_DESC,
        btrim(EXT_TW_ICS_SALES_src.LOB_CODE_DESC) AS LOB_CODE_DESC,
        btrim(EXT_TW_ICS_SALES_src.PRICE_MATRIX_DEF) AS PRICE_MATRIX_DEF,
        btrim(EXT_TW_ICS_SALES_src.PARENT_BP_CODE) AS PARENT_BP_CODE,
        btrim(EXT_TW_ICS_SALES_src.PARENT_BP_DESC) AS PARENT_BP_DESC,
        btrim(EXT_TW_ICS_SALES_src.GRAND_PARENT_BP_DESC) AS GRAND_PARENT_BP_DESC,
        btrim(EXT_TW_ICS_SALES_src.PO_NUMBER) AS PO_NUMBER,
        btrim(EXT_TW_ICS_SALES_src.UPS_NUMBER) AS UPS_NUMBER,
        btrim(EXT_TW_ICS_SALES_src.ORDER_NUMBER) AS ORDER_NUMBER,
        btrim(EXT_TW_ICS_SALES_src.ORDER_LINE_NUMBER) AS ORDER_LINE_NUMBER,
        btrim(EXT_TW_ICS_SALES_src.DISC_AMT) AS DISC_AMT,
        btrim(EXT_TW_ICS_SALES_src.WHSE_CD) AS WHSE_CD,
        btrim(EXT_TW_ICS_SALES_src.ORDER_DATE) AS ORDER_DATE,
        EXT_TW_ICS_SALES_src.batch_id,
        EXT_TW_ICS_SALES_src.row_id,
        EXT_TW_ICS_SALES_src.update_ts
 FROM teva_ingestion.EXT_TW_ICS_SALES_src;

CREATE  VIEW raw.ext_tw_ics_sales AS
 SELECT src.BP_CODE,
        src.ORTHO_E,
        src.BP_NAME,
        src.SHIP_TO_ADDRESS,
        src.SHIP_TO_CITY,
        src.SHIP_TO_STATE,
        src.SHIP_TO_ZIP_CODE,
        src.SHIP_TO_COUNTRY,
        src.SHIP_TO_PHONE,
        src.SHIP_TO_FAX,
        src.SHIP_TO_EMAIL,
        src.BILL_TO_ADDRESS,
        src.BILL_TO_CITY,
        src.BILL_TO_STATE,
        src.BILL_TO_ZIP_CODE,
        src.BILL_TO_COUNTRY,
        src.BILL_TO_PHONE,
        src.BILL_TO_FAX,
        src.BILL_TO_EMAIL,
        src.CLASS_OF_TRADE,
        src.INVOICE_NUM,
        src.DEL_AMT,
        src.INVOICE_DATE,
        src."24237" AS item_24237,
        src."24238" AS item_24238,
        src."24800" AS item_24800,
        src."33223" AS item_33223,
        src.PACKS,
        src.UNIT_PRICE,
        src.TERRITORY,
        src.ORDER_TYPE_CODE,
        src.ORDER_TYPE_DESC,
        src.LOB_CODE_DESC,
        src.PRICE_MATRIX_DEF,
        src.PARENT_BP_CODE,
        src.PARENT_BP_DESC,
        src.GRAND_PARENT_BP_DESC,
        src.PO_NUMBER,
        src.UPS_NUMBER,
        src.ORDER_NUMBER,
        src.ORDER_LINE_NUMBER,
        src.DISC_AMT,
        src.WHSE_CD,
        src.ORDER_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TW_ICS_SALES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_ICS_SALES'::varchar(16)))));

CREATE  VIEW teva_ingestion.EXT_TEVA_AHM_INTERACTIONS AS
 SELECT btrim(EXT_TEVA_AHM_INTERACTIONS_src.sourcesystemid) AS sourcesystemid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.batchid) AS batchid,
        CASE WHEN (EXT_TEVA_AHM_INTERACTIONS_src.batchdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_INTERACTIONS_src.batchdate))::date END AS batchdate,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.transactionstatuscode) AS transactionstatuscode,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionid) AS interactionid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactioncode) AS interactioncode,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionname) AS interactionname,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactioncategory) AS interactioncategory,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactiontype) AS interactiontype,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.locationtype) AS locationtype,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionstatus) AS interactionstatus,
        CASE WHEN (EXT_TEVA_AHM_INTERACTIONS_src.interactionstartdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionstartdate))::date END AS interactionstartdate,
        CASE WHEN (EXT_TEVA_AHM_INTERACTIONS_src.interactionenddate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionenddate))::date END AS interactionenddate,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionstarttime) AS interactionstarttime,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionendtime) AS interactionendtime,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactiontimezone) AS interactiontimezone,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionstartdatetime) AS interactionstartdatetime,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.interactionenddatetime) AS interactionenddatetime,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.requestingregion) AS requestingregion,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.parentinteractionid) AS parentinteractionid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.parentinteractioncode) AS parentinteractioncode,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeeid) AS employeeid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.clientemployeeid) AS clientemployeeid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeefirstname) AS employeefirstname,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeelastname) AS employeelastname,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeeorganizationunitid) AS employeeorganizationunitid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeeorganizationunitcode) AS employeeorganizationunitcode,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.employeeorganizationunitname) AS employeeorganizationunitname,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venueid) AS venueid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.clientvenueid) AS clientvenueid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venuename) AS venuename,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venueaddressline1) AS venueaddressline1,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venueaddressline2) AS venueaddressline2,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venueaddressline3) AS venueaddressline3,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venuecity) AS venuecity,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venuestateprovince) AS venuestateprovince,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venuepostalcode) AS venuepostalcode,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venuecountry) AS venuecountry,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.venueregion) AS venueregion,
        CASE WHEN (EXT_TEVA_AHM_INTERACTIONS_src.totalestimatedparticipantcount = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TEVA_AHM_INTERACTIONS_src.totalestimatedparticipantcount))::int END AS totalestimatedparticipantcount,
        CASE WHEN (EXT_TEVA_AHM_INTERACTIONS_src.financialcloseddate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_INTERACTIONS_src.financialcloseddate))::date END AS financialcloseddate,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product1name) AS product1name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product1id) AS product1id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product1clientid) AS product1clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic1name) AS topic1name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic1id) AS topic1id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic1clientid) AS topic1clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product2name) AS product2name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product2id) AS product2id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product2clientid) AS product2clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic2name) AS topic2name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic2id) AS topic2id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic2clientid) AS topic2clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product3name) AS product3name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product3id) AS product3id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product3clientid) AS product3clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic3name) AS topic3name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic3id) AS topic3id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic3clientid) AS topic3clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product4name) AS product4name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product4id) AS product4id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product4clientid) AS product4clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic4name) AS topic4name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic4id) AS topic4id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic4clientid) AS topic4clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product5name) AS product5name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product5id) AS product5id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.product5clientid) AS product5clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic5name) AS topic5name,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic5id) AS topic5id,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.topic5clientid) AS topic5clientid,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield1) AS reservedfield1,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield2) AS reservedfield2,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield3) AS reservedfield3,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield4) AS reservedfield4,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield5) AS reservedfield5,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield6) AS reservedfield6,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield7) AS reservedfield7,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield8) AS reservedfield8,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield9) AS reservedfield9,
        btrim(EXT_TEVA_AHM_INTERACTIONS_src.reservedfield10) AS reservedfield10,
        EXT_TEVA_AHM_INTERACTIONS_src.batch_id,
        EXT_TEVA_AHM_INTERACTIONS_src.row_id,
        EXT_TEVA_AHM_INTERACTIONS_src.update_ts
 FROM teva_ingestion.EXT_TEVA_AHM_INTERACTIONS_src;

CREATE  VIEW raw.ext_teva_ahm_interactions AS
 SELECT src.sourcesystemid,
        src.batchid,
        src.batchdate,
        src.transactionstatuscode,
        src.interactionid,
        src.interactioncode,
        src.interactionname,
        src.interactioncategory,
        src.interactiontype,
        src.locationtype,
        src.interactionstatus,
        src.interactionstartdate,
        src.interactionenddate,
        src.interactionstarttime,
        src.interactionendtime,
        src.interactiontimezone,
        src.interactionstartdatetime,
        src.interactionenddatetime,
        src.requestingregion,
        src.parentinteractionid,
        src.parentinteractioncode,
        src.employeeid,
        src.clientemployeeid,
        src.employeefirstname,
        src.employeelastname,
        src.employeeorganizationunitid,
        src.employeeorganizationunitcode,
        src.employeeorganizationunitname,
        src.venueid,
        src.clientvenueid,
        src.venuename,
        src.venueaddressline1,
        src.venueaddressline2,
        src.venueaddressline3,
        src.venuecity,
        src.venuestateprovince,
        src.venuepostalcode,
        src.venuecountry,
        src.venueregion,
        src.totalestimatedparticipantcount,
        src.financialcloseddate,
        src.product1name,
        src.product1id,
        src.product1clientid,
        src.topic1name,
        src.topic1id,
        src.topic1clientid,
        src.product2name,
        src.product2id,
        src.product2clientid,
        src.topic2name,
        src.topic2id,
        src.topic2clientid,
        src.product3name,
        src.product3id,
        src.product3clientid,
        src.topic3name,
        src.topic3id,
        src.topic3clientid,
        src.product4name,
        src.product4id,
        src.product4clientid,
        src.topic4name,
        src.topic4id,
        src.topic4clientid,
        src.product5name,
        src.product5id,
        src.product5clientid,
        src.topic5name,
        src.topic5id,
        src.topic5clientid,
        src.reservedfield1,
        src.reservedfield2,
        src.reservedfield3,
        src.reservedfield4,
        src.reservedfield5,
        src.reservedfield6,
        src.reservedfield7,
        src.reservedfield8,
        src.reservedfield9,
        src.reservedfield10,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TEVA_AHM_INTERACTIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TEVA_AHM_INTERACTIONS'::varchar(25)))));

CREATE  VIEW teva_ingestion.EXT_TEVA_AHM_PARTICIPANT AS
 SELECT btrim(EXT_TEVA_AHM_PARTICIPANT_src.sourcesystemid) AS sourcesystemid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.batchid) AS batchid,
        CASE WHEN (EXT_TEVA_AHM_PARTICIPANT_src.batchdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_PARTICIPANT_src.batchdate))::date END AS batchdate,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.transactionstatuscode) AS transactionstatuscode,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.interactionid) AS interactionid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.interactioncode) AS interactioncode,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.participantid) AS participantid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.clientcustomerid) AS clientcustomerid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.participanttype) AS participanttype,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.firstname) AS firstname,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.middlename) AS middlename,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.lastname) AS lastname,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.suffix) AS suffix,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.professionaldesignation) AS professionaldesignation,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.primaryspecialty) AS primaryspecialty,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.organizationname) AS organizationname,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.npinumber) AS npinumber,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addressid) AS addressid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.clientaddressid) AS clientaddressid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addressline1) AS addressline1,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addressline2) AS addressline2,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addressline3) AS addressline3,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addresscity) AS addresscity,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addressstateprovince) AS addressstateprovince,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addresspostalcode) AS addresspostalcode,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addresspostalcodeextension) AS addresspostalcodeextension,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.addresscountry) AS addresscountry,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.region) AS region,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.primarystatelicensestate) AS primarystatelicensestate,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.primarystatelicensenumber) AS primarystatelicensenumber,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.attended) AS attended,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.mealconsumed) AS mealconsumed,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractid) AS contractid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.clientcontractid) AS clientcontractid,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractname) AS contractname,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractcategory) AS contractcategory,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractsubcategory) AS contractsubcategory,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractclassification) AS contractclassification,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.contracttier) AS contracttier,
        CASE WHEN (EXT_TEVA_AHM_PARTICIPANT_src.contracteffectivedate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_PARTICIPANT_src.contracteffectivedate))::date END AS contracteffectivedate,
        CASE WHEN (EXT_TEVA_AHM_PARTICIPANT_src.contractexpirationdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_PARTICIPANT_src.contractexpirationdate))::date END AS contractexpirationdate,
        CASE WHEN (EXT_TEVA_AHM_PARTICIPANT_src.contracttotalvalue = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_TEVA_AHM_PARTICIPANT_src.contracttotalvalue))::numeric(10,2) END AS contracttotalvalue,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield1) AS reservedfield1,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield2) AS reservedfield2,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield3) AS reservedfield3,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield4) AS reservedfield4,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield5) AS reservedfield5,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield6) AS reservedfield6,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield7) AS reservedfield7,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield8) AS reservedfield8,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield9) AS reservedfield9,
        btrim(EXT_TEVA_AHM_PARTICIPANT_src.reservedfield10) AS reservedfield10,
        EXT_TEVA_AHM_PARTICIPANT_src.batch_id,
        EXT_TEVA_AHM_PARTICIPANT_src.row_id,
        EXT_TEVA_AHM_PARTICIPANT_src.update_ts
 FROM teva_ingestion.EXT_TEVA_AHM_PARTICIPANT_src;

CREATE  VIEW raw.ext_teva_ahm_participant AS
 SELECT src.sourcesystemid,
        src.batchid,
        src.batchdate,
        src.transactionstatuscode,
        src.interactionid,
        src.interactioncode,
        src.participantid,
        src.clientcustomerid,
        src.participanttype,
        src.firstname,
        src.middlename,
        src.lastname,
        src.suffix,
        src.professionaldesignation,
        src.primaryspecialty,
        src.organizationname,
        src.npinumber,
        src.addressid,
        src.clientaddressid,
        src.addressline1,
        src.addressline2,
        src.addressline3,
        src.addresscity,
        src.addressstateprovince,
        src.addresspostalcode,
        src.addresspostalcodeextension,
        src.addresscountry,
        src.region,
        src.primarystatelicensestate,
        src.primarystatelicensenumber,
        src.attended,
        src.mealconsumed,
        src.contractid,
        src.clientcontractid,
        src.contractname,
        src.contractcategory,
        src.contractsubcategory,
        src.contractclassification,
        src.contracttier,
        src.contracteffectivedate,
        src.contractexpirationdate,
        src.contracttotalvalue,
        src.reservedfield1,
        src.reservedfield2,
        src.reservedfield3,
        src.reservedfield4,
        src.reservedfield5,
        src.reservedfield6,
        src.reservedfield7,
        src.reservedfield8,
        src.reservedfield9,
        src.reservedfield10,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TEVA_AHM_PARTICIPANT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TEVA_AHM_PARTICIPANT'::varchar(24)))));

CREATE  VIEW teva_ingestion.EXT_TEVA_AHM_UNNAMEDPARTICIPANT AS
 SELECT btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.sourcesystemid) AS sourcesystemid,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.batchid) AS batchid,
        CASE WHEN (EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.batchdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.batchdate))::date END AS batchdate,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.transactionstatuscode) AS transactionstatuscode,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.interactionid) AS interactionid,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.interactioncode) AS interactioncode,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.particpantcategoryid) AS particpantcategoryid,
        btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.categorytype) AS categorytype,
        CASE WHEN (EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.totalattendedcount = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.totalattendedcount))::int END AS totalattendedcount,
        CASE WHEN (EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.totalmealconsumedcount = ''::varchar) THEN NULL::int ELSE (btrim(EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.totalmealconsumedcount))::int END AS totalmealconsumedcount,
        EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.batch_id,
        EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.row_id,
        EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src.update_ts
 FROM teva_ingestion.EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src;

CREATE  VIEW raw.ext_teva_ahm_unnamedparticipant AS
 SELECT src.sourcesystemid,
        src.batchid,
        src.batchdate,
        src.transactionstatuscode,
        src.interactionid,
        src.interactioncode,
        src.particpantcategoryid,
        src.categorytype,
        src.totalattendedcount,
        src.totalmealconsumedcount,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TEVA_AHM_UNNAMEDPARTICIPANT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TEVA_AHM_UNNAMEDPARTICIPANT'::varchar(31)))));

CREATE  VIEW teva_ingestion.EXT_TEVA_AHM_EXPENSE AS
 SELECT btrim(EXT_TEVA_AHM_EXPENSE_src.sourcesystemid) AS sourcesystemid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.batchid) AS batchid,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.batchdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.batchdate))::date END AS batchdate,
        btrim(EXT_TEVA_AHM_EXPENSE_src.transactionstatuscode) AS transactionstatuscode,
        btrim(EXT_TEVA_AHM_EXPENSE_src.interactionid) AS interactionid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.interactioncode) AS interactioncode,
        btrim(EXT_TEVA_AHM_EXPENSE_src.spendid) AS spendid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.clientspendid) AS clientspendid,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.spendamount = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.spendamount))::numeric(10,2) END AS spendamount,
        btrim(EXT_TEVA_AHM_EXPENSE_src.spendcurrency) AS spendcurrency,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.spenddate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.spenddate))::date END AS spenddate,
        btrim(EXT_TEVA_AHM_EXPENSE_src.spendtype) AS spendtype,
        btrim(EXT_TEVA_AHM_EXPENSE_src.spendpurpose) AS spendpurpose,
        btrim(EXT_TEVA_AHM_EXPENSE_src.traveldestinationcity) AS traveldestinationcity,
        btrim(EXT_TEVA_AHM_EXPENSE_src.traveldestinationstateprovince) AS traveldestinationstateprovince,
        btrim(EXT_TEVA_AHM_EXPENSE_src.traveldestinationcountry) AS traveldestinationcountry,
        btrim(EXT_TEVA_AHM_EXPENSE_src.spenddescription) AS spenddescription,
        btrim(EXT_TEVA_AHM_EXPENSE_src.taxincludedindicator) AS taxincludedindicator,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.taxamount = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.taxamount))::numeric(10,2) END AS taxamount,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.taxrate = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.taxrate))::numeric(10,2) END AS taxrate,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientid) AS recipientid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.clientrecipientid) AS clientrecipientid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.participantid) AS participantid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientfirstname) AS recipientfirstname,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientmiddlename) AS recipientmiddlename,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientlastname) AS recipientlastname,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientsuffix) AS recipientsuffix,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientprofessionaldesignation) AS recipientprofessionaldesignation,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientprimaryspecialty) AS recipientprimaryspecialty,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientorganizationname) AS recipientorganizationname,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientnpinumber) AS recipientnpinumber,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddressid) AS recipientaddressid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientclientaddressid) AS recipientclientaddressid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddressline1) AS recipientaddressline1,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddressline2) AS recipientaddressline2,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddressline3) AS recipientaddressline3,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddresscity) AS recipientaddresscity,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddressstateprovince) AS recipientaddressstateprovince,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddresspostalcode) AS recipientaddresspostalcode,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddresspostalcodeextension) AS recipientaddresspostalcodeextension,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientaddresscountry) AS recipientaddresscountry,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientprimarystatelicensestate) AS recipientprimarystatelicensestate,
        btrim(EXT_TEVA_AHM_EXPENSE_src.recipientprimarystatelicensenumber) AS recipientprimarystatelicensenumber,
        btrim(EXT_TEVA_AHM_EXPENSE_src.thirdpartyrecipientindicator) AS thirdpartyrecipientindicator,
        btrim(EXT_TEVA_AHM_EXPENSE_src.thirdpartyrecipientid) AS thirdpartyrecipientid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.thirdpartyclientrecipientid) AS thirdpartyclientrecipientid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.thirdpartyrecipientname) AS thirdpartyrecipientname,
        btrim(EXT_TEVA_AHM_EXPENSE_src.thirdpartycoveredrecipientindicator) AS thirdpartycoveredrecipientindicator,
        btrim(EXT_TEVA_AHM_EXPENSE_src.paymentid) AS paymentid,
        btrim(EXT_TEVA_AHM_EXPENSE_src.clientpaymentid) AS clientpaymentid,
        CASE WHEN (EXT_TEVA_AHM_EXPENSE_src.paymentdate = ''::varchar) THEN NULL::date ELSE (btrim(EXT_TEVA_AHM_EXPENSE_src.paymentdate))::date END AS paymentdate,
        btrim(EXT_TEVA_AHM_EXPENSE_src.paymentmethod) AS paymentmethod,
        btrim(EXT_TEVA_AHM_EXPENSE_src.paymentreferencenumber) AS paymentreferencenumber,
        btrim(EXT_TEVA_AHM_EXPENSE_src.paymentstatus) AS paymentstatus,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield1) AS reservedfield1,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield2) AS reservedfield2,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield3) AS reservedfield3,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield4) AS reservedfield4,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield5) AS reservedfield5,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield6) AS reservedfield6,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield7) AS reservedfield7,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield8) AS reservedfield8,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield9) AS reservedfield9,
        btrim(EXT_TEVA_AHM_EXPENSE_src.reservedfield10) AS reservedfield10,
        EXT_TEVA_AHM_EXPENSE_src.batch_id,
        EXT_TEVA_AHM_EXPENSE_src.row_id,
        EXT_TEVA_AHM_EXPENSE_src.update_ts
 FROM teva_ingestion.EXT_TEVA_AHM_EXPENSE_src;

CREATE  VIEW raw.ext_teva_ahm_expense AS
 SELECT src.sourcesystemid,
        src.batchid,
        src.batchdate,
        src.transactionstatuscode,
        src.interactionid,
        src.interactioncode,
        src.spendid,
        src.clientspendid,
        src.spendamount,
        src.spendcurrency,
        src.spenddate,
        src.spendtype,
        src.spendpurpose,
        src.traveldestinationcity,
        src.traveldestinationstateprovince,
        src.traveldestinationcountry,
        src.spenddescription,
        src.taxincludedindicator,
        src.taxamount,
        src.taxrate,
        src.recipientid,
        src.clientrecipientid,
        src.participantid,
        src.recipientfirstname,
        src.recipientmiddlename,
        src.recipientlastname,
        src.recipientsuffix,
        src.recipientprofessionaldesignation,
        src.recipientprimaryspecialty,
        src.recipientorganizationname,
        src.recipientnpinumber,
        src.recipientaddressid,
        src.recipientclientaddressid,
        src.recipientaddressline1,
        src.recipientaddressline2,
        src.recipientaddressline3,
        src.recipientaddresscity,
        src.recipientaddressstateprovince,
        src.recipientaddresspostalcode,
        src.recipientaddresspostalcodeextension,
        src.recipientaddresscountry,
        src.recipientprimarystatelicensestate,
        src.recipientprimarystatelicensenumber,
        src.thirdpartyrecipientindicator,
        src.thirdpartyrecipientid,
        src.thirdpartyclientrecipientid,
        src.thirdpartyrecipientname,
        src.thirdpartycoveredrecipientindicator,
        src.paymentid,
        src.clientpaymentid,
        src.paymentdate,
        src.paymentmethod,
        src.paymentreferencenumber,
        src.paymentstatus,
        src.reservedfield1,
        src.reservedfield2,
        src.reservedfield3,
        src.reservedfield4,
        src.reservedfield5,
        src.reservedfield6,
        src.reservedfield7,
        src.reservedfield8,
        src.reservedfield9,
        src.reservedfield10,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TEVA_AHM_EXPENSE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TEVA_AHM_EXPENSE'::varchar(20)))));

CREATE  VIEW teva_ingestion.EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT AS
 SELECT btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.week_end_date) AS week_end_date,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.practice_name) AS practice_name,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.practice_address_line_1) AS practice_address_line_1,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.pracitce_address_line_2) AS pracitce_address_line_2,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.city) AS city,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.state) AS state,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.zip_code) AS zip_code,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.provider_first_name) AS provider_first_name,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.provider_last_name) AS provider_last_name,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.npi) AS npi,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.specialty_1) AS specialty_1,
        btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.specialty_2) AS specialty_2,
        CASE WHEN (EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.total_cml_patients_with_poor_response_to_treatment = ''::varchar) THEN NULL::int ELSE (btrim(EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.total_cml_patients_with_poor_response_to_treatment))::int END AS total_cml_patients_with_poor_response_to_treatment,
        EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.batch_id,
        EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.row_id,
        EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src.update_ts
 FROM teva_ingestion.EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src;

CREATE  VIEW raw.ext_prognos_syndicated_trigger_report AS
 SELECT src.week_end_date,
        src.practice_name,
        src.practice_address_line_1,
        src.pracitce_address_line_2,
        src.city,
        src.state,
        src.zip_code,
        src.provider_first_name,
        src.provider_last_name,
        src.npi,
        src.specialty_1,
        src.specialty_2,
        src.total_cml_patients_with_poor_response_to_treatment,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_PROGNOS_SYNDICATED_TRIGGER_REPORT'::varchar(37)))));

CREATE  VIEW outbound.zzz_kc_cns_deciles AS
 SELECT d.ims_id AS hcp_id,
        d.decile_name,
        d.decile_trx_count_6_mo AS decile_value
 FROM datamart.rx_deciles d
 WHERE ((d.decile_name = ANY (ARRAY['FENTORA'::varchar(8), 'ACTIQ'::varchar(8), 'NUVIGIL'::varchar(8), 'AMRIX'::varchar(8), 'AZILECT'::varchar(8), 'COPAXONE'::varchar(8)])) AND (EXISTS ( SELECT 1
 FROM datamart.prescriber_combined_demographics pd
 WHERE (pd.ims_id = d.ims_id))))
 GROUP BY d.ims_id,
          d.decile_name,
          d.decile_trx_count_6_mo UNION ALL  SELECT d.ims_id AS hcp_id,
        d.decile_name,
        d.decile_trx_count_6_mo AS decile_value
 FROM datamart.rx_deciles d
 WHERE (d.decile_name = ANY (ARRAY['TIRF TOTAL'::varchar(22), 'COMBO SAO TOTAL'::varchar(22), 'TOTAL OPIOID MARKET'::varchar(22), 'LAO TOTAL'::varchar(22), 'PURE SAO TOTAL'::varchar(22), 'BRANDED SLEEP/SEDATIVE'::varchar(22), 'TOTAL MUSCLE RELAXANTS'::varchar(22)]))
 GROUP BY d.ims_id,
          d.decile_name,
          d.decile_trx_count_6_mo;

CREATE  VIEW teva_ingestion.EXT_TW_BIOLOGICS_HUB AS
 SELECT btrim(EXT_TW_BIOLOGICS_HUB_src.HUB_ID) AS HUB_ID,
        btrim(EXT_TW_BIOLOGICS_HUB_src.SP_ID) AS SP_ID,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PORTAL_ID) AS PORTAL_ID,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REFERRAL_DATE) AS REFERRAL_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REFERRAL_RECEIVED_DATE) AS REFERRAL_RECEIVED_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REFERRAL_SOURCE) AS REFERRAL_SOURCE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REFERRAL_METHOD) AS REFERRAL_METHOD,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REFERRAL_TYPE) AS REFERRAL_TYPE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BILLING_METHOD) AS BILLING_METHOD,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PATIENT_AUTH) AS PATIENT_AUTH,
        btrim(EXT_TW_BIOLOGICS_HUB_src.ORDER_CREATE_DATE) AS ORDER_CREATE_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PATIENT_STATUS) AS PATIENT_STATUS,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BV_DATE) AS BV_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.EFFECTIVE_DATE) AS EFFECTIVE_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_RANK) AS PAYOR_RANK,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_TYPE) AS PAYOR_TYPE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR) AS PAYOR,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PLAN_NAME) AS PLAN_NAME,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_MAJOR_MEDICAL) AS COVERED_MAJOR_MEDICAL,
        btrim(EXT_TW_BIOLOGICS_HUB_src.DEDUCTIBLE_APPLIES_PARAGARD) AS DEDUCTIBLE_APPLIES_PARAGARD,
        btrim(EXT_TW_BIOLOGICS_HUB_src.J7300_REIMBURSEMENT) AS J7300_REIMBURSEMENT,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BUNDLED_SERVICES) AS BUNDLED_SERVICES,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PBM) AS PBM,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_PHARMACY) AS COVERED_PHARMACY,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REJECTION_CODE) AS REJECTION_CODE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERAGE_TYPE) AS COVERAGE_TYPE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE) AS LOW_PHARM_REIMBURSE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE_AMOUNT) AS LOW_PHARM_REIMBURSE_AMOUNT,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_REQUIRED) AS PA_REQUIRED,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_TYPE) AS PA_TYPE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_CONTACT) AS PA_CONTACT,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_PHONE) AS PA_PHONE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_FAX) AS PA_FAX,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BV_DATE_2) AS BV_DATE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.EFFECTIVE_DATE_2) AS EFFECTIVE_DATE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_RANK_2) AS PAYOR_RANK_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_TYPE_2) AS PAYOR_TYPE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_2) AS PAYOR_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PLAN_NAME_2) AS PLAN_NAME_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_MAJOR_MEDICAL_2) AS COVERED_MAJOR_MEDICAL_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.DEDUCTIBLE_APPLIES_PARAGARD_2) AS DEDUCTIBLE_APPLIES_PARAGARD_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.J7300_REIMBURSEMENT_2) AS J7300_REIMBURSEMENT_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BUNDLED_SERVICES_2) AS BUNDLED_SERVICES_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PBM_2) AS PBM_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_PHARMACY_2) AS COVERED_PHARMACY_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REJECTION_CODE_2) AS REJECTION_CODE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERAGE_TYPE_2) AS COVERAGE_TYPE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE_2) AS LOW_PHARM_REIMBURSE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE_AMOUNT_2) AS LOW_PHARM_REIMBURSE_AMOUNT_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_REQUIRED_2) AS PA_REQUIRED_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_TYPE_2) AS PA_TYPE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_CONTACT_2) AS PA_CONTACT_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_PHONE_2) AS PA_PHONE_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_FAX_2) AS PA_FAX_2,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BV_DATE_3) AS BV_DATE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.EFFECTIVE_DATE_3) AS EFFECTIVE_DATE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_RANK_3) AS PAYOR_RANK_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_TYPE_3) AS PAYOR_TYPE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PAYOR_3) AS PAYOR_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PLAN_NAME_3) AS PLAN_NAME_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_MAJOR_MEDICAL_3) AS COVERED_MAJOR_MEDICAL_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.DEDUCTIBLE_APPLIES_PARAGARD_3) AS DEDUCTIBLE_APPLIES_PARAGARD_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.J7300_REIMBURSEMENT_3) AS J7300_REIMBURSEMENT_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.BUNDLED_SERVICES_3) AS BUNDLED_SERVICES_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PBM_3) AS PBM_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERED_PHARMACY_3) AS COVERED_PHARMACY_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REJECTION_CODE_3) AS REJECTION_CODE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COVERAGE_TYPE_3) AS COVERAGE_TYPE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE_3) AS LOW_PHARM_REIMBURSE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.LOW_PHARM_REIMBURSE_AMOUNT_3) AS LOW_PHARM_REIMBURSE_AMOUNT_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_REQUIRED_3) AS PA_REQUIRED_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_TYPE_3) AS PA_TYPE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_CONTACT_3) AS PA_CONTACT_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_PHONE_3) AS PA_PHONE_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PA_FAX_3) AS PA_FAX_3,
        btrim(EXT_TW_BIOLOGICS_HUB_src.COPAY) AS COPAY,
        btrim(EXT_TW_BIOLOGICS_HUB_src.TRIAGE_DATE) AS TRIAGE_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.SP_SHIP_DATE) AS SP_SHIP_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.REPLACEMENT_FLAG) AS REPLACEMENT_FLAG,
        btrim(EXT_TW_BIOLOGICS_HUB_src.INSERTION_MEDICAID) AS INSERTION_MEDICAID,
        btrim(EXT_TW_BIOLOGICS_HUB_src.MEDICAID_RETURN_DATE_CALL) AS MEDICAID_RETURN_DATE_CALL,
        btrim(EXT_TW_BIOLOGICS_HUB_src.MEDICAID_RETURN_REQUEST_DATE) AS MEDICAID_RETURN_REQUEST_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.MEDICAID_REQUEST_REASON) AS MEDICAID_REQUEST_REASON,
        btrim(EXT_TW_BIOLOGICS_HUB_src.MEDICAID_RETURN_DATE) AS MEDICAID_RETURN_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_ID) AS PH_ID,
        btrim(EXT_TW_BIOLOGICS_HUB_src.NPI) AS NPI,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PRACTICE_NAME) AS PRACTICE_NAME,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_ADDRESS) AS PH_ADDRESS,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_CITY) AS PH_CITY,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_STATE) AS PH_STATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_ZIP) AS PH_ZIP,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_PHONE) AS PH_PHONE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.PH_FAX) AS PH_FAX,
        btrim(EXT_TW_BIOLOGICS_HUB_src.DISC_DATE) AS DISC_DATE,
        btrim(EXT_TW_BIOLOGICS_HUB_src.DISCHARGE_REASON) AS DISCHARGE_REASON,
        EXT_TW_BIOLOGICS_HUB_src.batch_id,
        EXT_TW_BIOLOGICS_HUB_src.row_id,
        EXT_TW_BIOLOGICS_HUB_src.update_ts
 FROM teva_ingestion.EXT_TW_BIOLOGICS_HUB_src;

CREATE  VIEW raw.ext_tw_biologics_hub AS
 SELECT src.HUB_ID,
        src.SP_ID,
        src.PORTAL_ID,
        src.REFERRAL_DATE,
        src.REFERRAL_RECEIVED_DATE,
        src.REFERRAL_SOURCE,
        src.REFERRAL_METHOD,
        src.REFERRAL_TYPE,
        src.BILLING_METHOD,
        src.PATIENT_AUTH,
        src.ORDER_CREATE_DATE,
        src.PATIENT_STATUS,
        src.BV_DATE,
        src.EFFECTIVE_DATE,
        src.PAYOR_RANK,
        src.PAYOR_TYPE,
        src.PAYOR,
        src.PLAN_NAME,
        src.COVERED_MAJOR_MEDICAL,
        src.DEDUCTIBLE_APPLIES_PARAGARD,
        src.J7300_REIMBURSEMENT,
        src.BUNDLED_SERVICES,
        src.PBM,
        src.COVERED_PHARMACY,
        src.REJECTION_CODE,
        src.COVERAGE_TYPE,
        src.LOW_PHARM_REIMBURSE,
        src.LOW_PHARM_REIMBURSE_AMOUNT,
        src.PA_REQUIRED,
        src.PA_TYPE,
        src.PA_CONTACT,
        src.PA_PHONE,
        src.PA_FAX,
        src.BV_DATE_2,
        src.EFFECTIVE_DATE_2,
        src.PAYOR_RANK_2,
        src.PAYOR_TYPE_2,
        src.PAYOR_2,
        src.PLAN_NAME_2,
        src.COVERED_MAJOR_MEDICAL_2,
        src.DEDUCTIBLE_APPLIES_PARAGARD_2,
        src.J7300_REIMBURSEMENT_2,
        src.BUNDLED_SERVICES_2,
        src.PBM_2,
        src.COVERED_PHARMACY_2,
        src.REJECTION_CODE_2,
        src.COVERAGE_TYPE_2,
        src.LOW_PHARM_REIMBURSE_2,
        src.LOW_PHARM_REIMBURSE_AMOUNT_2,
        src.PA_REQUIRED_2,
        src.PA_TYPE_2,
        src.PA_CONTACT_2,
        src.PA_PHONE_2,
        src.PA_FAX_2,
        src.BV_DATE_3,
        src.EFFECTIVE_DATE_3,
        src.PAYOR_RANK_3,
        src.PAYOR_TYPE_3,
        src.PAYOR_3,
        src.PLAN_NAME_3,
        src.COVERED_MAJOR_MEDICAL_3,
        src.DEDUCTIBLE_APPLIES_PARAGARD_3,
        src.J7300_REIMBURSEMENT_3,
        src.BUNDLED_SERVICES_3,
        src.PBM_3,
        src.COVERED_PHARMACY_3,
        src.REJECTION_CODE_3,
        src.COVERAGE_TYPE_3,
        src.LOW_PHARM_REIMBURSE_3,
        src.LOW_PHARM_REIMBURSE_AMOUNT_3,
        src.PA_REQUIRED_3,
        src.PA_TYPE_3,
        src.PA_CONTACT_3,
        src.PA_PHONE_3,
        src.PA_FAX_3,
        src.COPAY,
        src.TRIAGE_DATE,
        src.SP_SHIP_DATE,
        src.REPLACEMENT_FLAG,
        src.INSERTION_MEDICAID,
        src.MEDICAID_RETURN_DATE_CALL,
        src.MEDICAID_RETURN_REQUEST_DATE,
        src.MEDICAID_REQUEST_REASON,
        src.MEDICAID_RETURN_DATE,
        src.PH_ID,
        src.NPI,
        src.PHYSICIAN_NAME,
        src.PRACTICE_NAME,
        src.PH_ADDRESS,
        src.PH_CITY,
        src.PH_STATE,
        src.PH_ZIP,
        src.PH_PHONE,
        src.PH_FAX,
        src.DISC_DATE,
        src.DISCHARGE_REASON,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TW_BIOLOGICS_HUB_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_BIOLOGICS_HUB'::varchar(20)))));

CREATE  VIEW teva_ingestion.EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW AS
 SELECT btrim((EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.trans_type)::varchar(1)) AS trans_type,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.claim_trans_id) AS claim_trans_id,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.original_claim_trans_id) AS original_claim_trans_id,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_of_fill = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_of_fill))::int END AS date_of_fill,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_written = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_written))::int END AS date_written,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.days_supply = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.days_supply))::int END AS days_supply,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.ndc_drug_code) AS ndc_drug_code,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.daw = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.daw))::int END AS daw,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.drug_title) AS drug_title,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.drug_strength_and_form) AS drug_strength_and_form,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.fill_number_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.fill_number_code))::int END AS fill_number_code,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.quantity_disp = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.quantity_disp))::int END AS quantity_disp,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.auth_refills = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.auth_refills))::int END AS auth_refills,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.other_coverage_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.other_coverage_code))::int END AS other_coverage_code,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.previous_other_payer_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.previous_other_payer_id))::int END AS previous_other_payer_id,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.group_number) AS group_number,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.serial_id) AS serial_id,
        btrim((EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.gender)::varchar(11)) AS gender,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.age = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.age))::int END AS age,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_processed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.date_processed))::int END AS date_processed,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_chain = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_chain))::int END AS pharmacy_chain,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.ncpdp = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.ncpdp))::int END AS ncpdp,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_chain_name) AS pharmacy_chain_name,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_address) AS pharmacy_address,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_address2) AS pharmacy_address2,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_city) AS pharmacy_city,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_state) AS pharmacy_state,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_zip = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_zip))::int END AS pharmacy_zip,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_phone = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_phone))::int END AS pharmacy_phone,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_npi = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_npi))::int END AS pharmacy_npi,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_dea) AS hcp_dea,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_npi = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_npi))::int END AS hcp_npi,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_name) AS hcp_name,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_address) AS hcp_address,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_address2) AS hcp_address2,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_city) AS hcp_city,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_state) AS hcp_state,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_zip = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.hcp_zip))::int END AS hcp_zip,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.benefit_amount = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.benefit_amount))::numeric(32,15) END AS benefit_amount,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.patient_expense = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.patient_expense))::numeric(32,15) END AS patient_expense,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.submitted_cost = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.submitted_cost))::numeric(32,15) END AS submitted_cost,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_fee = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.pharmacy_fee))::numeric(32,15) END AS pharmacy_fee,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.amount_due = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.amount_due))::numeric(32,15) END AS amount_due,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.calc_awp = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.calc_awp))::numeric(32,15) END AS calc_awp,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.create_date = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.create_date))::int END AS create_date,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.occ_payment_type) AS occ_payment_type,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_npi = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_npi))::int END AS admin_hcp_npi,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_name) AS admin_hcp_name,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_address) AS admin_hcp_address,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_address2) AS admin_hcp_address2,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_city) AS admin_hcp_city,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_state) AS admin_hcp_state,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_zip = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.admin_hcp_zip))::int END AS admin_hcp_zip,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.claim_type) AS claim_type,
        btrim((EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.administration_flag)::varchar(1)) AS administration_flag,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_name) AS soc_name,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_phone = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_phone))::int END AS soc_phone,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_fax = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_fax))::int END AS soc_fax,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_address) AS soc_address,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_city) AS soc_city,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_state = ''::varchar) THEN NULL::numeric(32,15) ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_state))::numeric(32,15) END AS soc_state,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_zip = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_zip))::int END AS soc_zip,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_id) AS soc_id,
        CASE WHEN (EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_npi = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.soc_npi))::int END AS soc_npi,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.payer_name) AS payer_name,
        btrim(EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.cpt_code) AS cpt_code,
        EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.batch_id,
        EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.row_id,
        EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src.update_ts
 FROM teva_ingestion.EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src;

CREATE  VIEW raw.ext_asi_copay_voucher_detail_wkly_pskw AS
 SELECT src.trans_type,
        src.claim_trans_id,
        src.original_claim_trans_id,
        src.date_of_fill,
        src.date_written,
        src.days_supply,
        src.ndc_drug_code,
        src.daw,
        src.drug_title,
        src.drug_strength_and_form,
        src.fill_number_code,
        src.quantity_disp,
        src.auth_refills,
        src.other_coverage_code,
        src.previous_other_payer_id,
        src.group_number,
        src.serial_id,
        src.gender,
        src.age,
        src.date_processed,
        src.pharmacy_chain,
        src.ncpdp,
        src.pharmacy_chain_name,
        src.pharmacy_name,
        src.pharmacy_address,
        src.pharmacy_address2,
        src.pharmacy_city,
        src.pharmacy_state,
        src.pharmacy_zip,
        src.pharmacy_phone,
        src.pharmacy_npi,
        src.hcp_dea,
        src.hcp_npi,
        src.hcp_name,
        src.hcp_address,
        src.hcp_address2,
        src.hcp_city,
        src.hcp_state,
        src.hcp_zip,
        src.benefit_amount,
        src.patient_expense,
        src.submitted_cost,
        src.pharmacy_fee,
        src.amount_due,
        src.calc_awp,
        src.create_date,
        src.occ_payment_type,
        src.admin_hcp_npi,
        src.admin_hcp_name,
        src.admin_hcp_address,
        src.admin_hcp_address2,
        src.admin_hcp_city,
        src.admin_hcp_state,
        src.admin_hcp_zip,
        src.claim_type,
        src.administration_flag,
        src.soc_name,
        src.soc_phone,
        src.soc_fax,
        src.soc_address,
        src.soc_city,
        src.soc_state,
        src.soc_zip,
        src.soc_id,
        src.soc_npi,
        src.payer_name,
        src.cpt_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ASI_COPAY_VOUCHER_DETAIL_WKLY_PSKW'::varchar(38)))));

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_copay_redemption AS
 SELECT c.physician_tvcmid AS TVCMID,
        cm_ims.id_num AS IMS_ID,
        cm_vv.id_num AS VEEVA_ACCOUNT_ID,
        c.program_number AS ASI_PROGRAM_NUM,
        cvp.program_description AS PROGRAM_DESC,
        c.copay_card_number AS COPAY_CARD_NUM,
        c.physician_zip AS ZIP_CODE,
        to_char(c.fill_date, 'MM/DD/YYYY'::varchar(10)) AS FILL_DATE,
        brand.brand_name AS BRAND_NAME,
        c.basket_name AS DRUG_DESC,
        c.quantity AS QTY
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.redemption_type = cvp.redemption_type) AND (c.program_number = cvp.program_number)))) JOIN ( SELECT bp.basket_id AS prod_basket_id,
        bb.basket_id AS brand_basket_id,
        bb.name AS brand_name
 FROM ((product.basket bp JOIN product.basket_item bi ON (((bp.basket_id = bi.entity_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bb.basket_id = bi.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_basket_id))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))
 GROUP BY tvcmid_xref.tvcmid) cm_ims ON ((c.physician_tvcmid = cm_ims.tvcmid))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) cm_vv ON ((c.physician_tvcmid = cm_vv.tvcmid)))
 WHERE ((c.basket_name ~~ '%FENTORA%'::varchar(9)) AND (c.redemption_type = 'COPAY'::varchar(5)) AND (c.report_frequency = 'MONTH'::varchar(5)) AND (c.physician_tvcmid IS NOT NULL) AND (c.fill_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (c.fill_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))));

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_voucher_redemption AS
 SELECT c.physician_tvcmid AS TVCMID,
        cm_ims.id_num AS IMS_ID,
        cm_vv.id_num AS VEEVA_ACCOUNT_ID,
        c.program_number AS ASI_PROGRAM_NUM,
        cvp.program_description AS PROGRAM_DESC,
        c.copay_card_number AS VOUCHER_NUM,
        c.physician_zip AS ZIP_CODE,
        to_char(c.fill_date, 'MM/DD/YYYY'::varchar(10)) AS FILL_DATE,
        brand.brand_name AS BRAND_NAME,
        c.basket_name AS DRUG_DESC,
        c.quantity AS QTY
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.redemption_type = cvp.redemption_type) AND (c.program_number = cvp.program_number)))) JOIN ( SELECT bp.basket_id AS prod_basket_id,
        bb.basket_id AS brand_basket_id,
        bb.name AS brand_name
 FROM ((product.basket bp JOIN product.basket_item bi ON (((bp.basket_id = bi.entity_id) AND (bp.basket_type = 'product'::varchar(7))))) JOIN product.basket bb ON (((bb.basket_id = bi.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_basket_id))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))
 GROUP BY tvcmid_xref.tvcmid) cm_ims ON ((c.physician_tvcmid = cm_ims.tvcmid))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) cm_vv ON ((c.physician_tvcmid = cm_vv.tvcmid)))
 WHERE ((c.basket_name ~~ '%FENTORA%'::varchar(9)) AND (c.redemption_type = 'VOUCHER'::varchar(7)) AND (c.report_frequency = 'MONTH'::varchar(5)) AND (c.physician_tvcmid IS NOT NULL) AND (c.fill_date >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (c.fill_date <= last_day(add_months((statement_timestamp())::timestamp, (-1)))));

CREATE  VIEW sandbox.knipper_merge_test AS
 SELECT merges.current_tvcmid AS TVCMIDWinner,
        merges.previous_tvcmid AS TVCMIDLoser,
        to_char((now())::date, 'MM/DD/YYYY'::varchar(10)) AS TVCMIDMergeEffectiveDate
 FROM mdm.merges
 GROUP BY merges.current_tvcmid,
          merges.previous_tvcmid,
          to_char((now())::date, 'MM/DD/YYYY'::varchar(10));

CREATE  VIEW sandbox.knipper_supplemental_test AS
 SELECT a.tvcmid AS TVCMID,
        CASE WHEN (a.medical_suffix IS NULL) THEN ''::varchar ELSE a.medical_suffix END AS ProfDesig,
        a.first_name AS FName,
        a.last_name AS Lname,
        CASE WHEN (a.middle_name IS NULL) THEN ''::varchar ELSE a.middle_name END AS MI,
        CASE WHEN (a.personal_suffix IS NULL) THEN ''::varchar ELSE a.personal_suffix END AS Suffix,
        CASE WHEN (a.hce_status_desc IS NULL) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'ACTIVE'::varchar(6)) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'INACTIVE'::varchar(8)) THEN 'I'::varchar(1) ELSE 'D'::varchar(1) END AS Status,
        CASE WHEN (a.hce_status_desc = 'PRESUMED DEAD'::varchar(13)) THEN 'D'::varchar(1) WHEN (a.hce_status_desc = 'SEMI-RETIRED'::varchar(12)) THEN 'O'::varchar(1) WHEN (a.hce_status_desc = 'RETIRED'::varchar(7)) THEN 'R'::varchar(1) ELSE ''::varchar END AS DeleteReason,
        CASE WHEN ((a.hce_status_desc IS NULL) OR (a.hce_status_desc <> ALL (ARRAY['ACTIVE'::varchar(8), 'INACTIVE'::varchar(8)]))) THEN to_char(e.last_update_date, 'MM/DD/YYYY'::varchar(10)) ELSE ''::varchar END AS DeleteDate,
        CASE WHEN (a.primary_specialty IS NULL) THEN 'US'::varchar(2) ELSE a.primary_specialty END AS Specialty,
        CASE WHEN (a.address_line1 IS NULL) THEN ''::varchar ELSE a.address_line1 END AS Address1,
        CASE WHEN (a.address_line2 IS NULL) THEN ''::varchar ELSE a.address_line2 END AS Address2,
        ''::varchar AS Address3,
        CASE WHEN (a.city IS NULL) THEN ''::varchar ELSE a.city END AS City,
        CASE WHEN (a.state IS NULL) THEN ''::varchar ELSE a.state END AS State,
        CASE WHEN (a.zip IS NULL) THEN ''::varchar ELSE a.zip END AS Zip,
        CASE WHEN (b.sln IS NULL) THEN ''::varchar ELSE b.sln END AS SLN,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE CASE WHEN (b.sln_status_code = 'A'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END END AS SLNActiveFlag,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE to_char(b.sln_expiration_date, 'MM/DD/YYYY'::varchar(10)) END AS SLNExpirationDate,
        CASE WHEN (c.flag_value = 'Y'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNCWakeFlag,
        CASE WHEN (d.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP
 FROM (((((( SELECT prescriber_rx.tvcmid
 FROM datamart.prescriber_rx
 GROUP BY prescriber_rx.tvcmid) exp JOIN ( SELECT hcp_demo.tvcmid,
        hcp_demo.ims_id,
        hcp_demo.npi,
        hcp_demo.last_name,
        hcp_demo.first_name,
        hcp_demo.middle_name,
        hcp_demo.personal_suffix,
        hcp_demo.medical_suffix,
        hcp_demo.primary_specialty,
        hcp_demo.address_line1,
        hcp_demo.address_line2,
        hcp_demo.city,
        hcp_demo.state_code AS state,
        hcp_demo.zip,
        hcp_demo.business_phone,
        hcp_demo.business_email,
        hcp_demo.hce_status_desc,
        hcp_demo.file_id,
        hcp_demo.record_id,
        hcp_demo.np_pa_flag
 FROM datamart.customer_hcp_demographics hcp_demo
 WHERE (hcp_demo.file_id = ( SELECT max(customer_hcp_demographics.file_id) AS MAX
 FROM datamart.customer_hcp_demographics))) a ON ((exp.tvcmid = a.tvcmid))) JOIN ( SELECT sample_eligibility.sln,
        sample_eligibility.sln_state,
        sample_eligibility.sln_expiration_date,
        sample_eligibility.sln_status_code,
        sample_eligibility.tvcmid
 FROM mdm.sample_eligibility
 WHERE (sample_eligibility.file_id = ( SELECT max(sample_eligibility.file_id) AS MAX
 FROM mdm.sample_eligibility))) b ON (((a.tvcmid = b.tvcmid) AND (a.state = b.sln_state)))) LEFT  JOIN ( SELECT ims_flag.tvcmid,
        ims_flag.flag_type,
        ims_flag.flag_value
 FROM mdm.ims_flag
 WHERE ((ims_flag.file_id = ( SELECT max(ims_flag.file_id) AS MAX
 FROM mdm.ims_flag)) AND (ims_flag.flag_type = 'AMADNC'::varchar(6)))) c ON ((a.tvcmid = c.tvcmid))) LEFT  JOIN datamart.do_not_promote d ON ((a.tvcmid = d.tvcmid))) LEFT  JOIN ( SELECT hcp.updated_date AS last_update_date,
        hcp.tvcmid
 FROM mdm.hcp
 WHERE (hcp.file_id = ( SELECT max(hcp.file_id) AS MAX
 FROM mdm.hcp))) e ON ((a.tvcmid = e.tvcmid)));

CREATE  VIEW outbound.zzz_v_cmop_rx AS
 SELECT cr.station_number AS STATION_NUMBER,
        cr.va_product AS VA_PRODUCT,
        0 AS PRODUCT_ID,
        CASE WHEN ((b.teva_product_code IS NULL) AND (cr.va_product ~~ 'LEVONORGESTREL%'::varchar(15))) THEN 'TW0900'::varchar(6) WHEN ((b.teva_product_code IS NULL) AND (cr.va_product ~~ 'MOMETASONE FUROATE%'::varchar(19))) THEN 'TR0900'::varchar(6) WHEN ((b.teva_product_code IS NULL) AND (cr.va_product ~~ 'ESTROGENS,CONJUGATED%'::varchar(21))) THEN 'TW0900'::varchar(6) WHEN ((b.teva_product_code IS NULL) AND (cr.va_product ~~ 'BECLOMETHASONE DIPROPIONATE%'::varchar(28))) THEN 'TR0900'::varchar(6) WHEN ((b.teva_product_code IS NULL) AND (cr.va_product ~~ 'INTERFERON BETA%'::varchar(16))) THEN '600230'::varchar(6) ELSE b.teva_product_code END AS PRODUCT_CODE,
        (add_months(cr.data_month, (-1)) + 1) AS MONTH,
        cr.total_rxs_normalized AS TRX_CNT,
        cr.cmop_rxs_normalized AS CMOP_CNT,
        cr.total_quantity AS TRX_QTY,
        cr.cmop_quantity AS CMOP_QTY,
        ((cr.rxs_30_days)::int)::varchar AS CNT_30_DAY_RX,
        cr.id AS ID
 FROM ((datamart.cmop_rx cr JOIN ( SELECT a.month_ending,
        a.month_bucket
 FROM ( SELECT last_day(cmop_rx.data_month) AS month_ending,
        rank() OVER (ORDER BY last_day(cmop_rx.data_month) DESC) AS month_bucket
 FROM datamart.cmop_rx
 GROUP BY last_day(cmop_rx.data_month)) a
 WHERE ((a.month_bucket >= 1) AND (a.month_bucket <= 24))) mth ON ((last_day(cr.data_month) = mth.month_ending))) LEFT  JOIN product.basket b ON ((cr.basket_id = b.basket_id)))
 WHERE (cr.va_product IS NOT NULL);

CREATE  VIEW outbound.zzz_asi_market_access_w AS
SELECT A.zip, A.state, A.payer_plan_num, A.report_num, A.ims_product_group_num, A.data_month, A.nrx_001, A.nrx_002, A.nrx_003, A.nrx_004, A.nrx_005, A.nrx_006, A.nrx_007, A.nrx_008, A.nrx_009, A.nrx_010, A.nrx_011, A.nrx_012, A.nrx_013, A.nrx_014, A.nrx_015, A.nrx_016, A.nrx_017, A.nrx_018, A.nrx_019, A.nrx_020, A.nrx_021, A.nrx_022, A.nrx_023, A.nrx_024, A.trx_001, A.trx_002, A.trx_003, A.trx_004, A.trx_005, A.trx_006, A.trx_007, A.trx_008, A.trx_009, A.trx_010, A.trx_011, A.trx_012, A.trx_013, A.trx_014, A.trx_015, A.trx_016, A.trx_017, A.trx_018, A.trx_019, A.trx_020, A.trx_021, A.trx_022, A.trx_023, A.trx_024 FROM ((SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state, mpzd.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((((datamart.prescriber_rx rx JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN (SELECT market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo WHERE (hcp_demo.file_id = (SELECT max(customer_hcp_demographics.file_id) AS MAX FROM datamart.customer_hcp_demographics))) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo WHERE (hco_demo.file_id = (SELECT max(customer_hco_demographics.file_id) AS MAX FROM datamart.customer_hco_demographics))) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_report_number_cnt = ANY (ARRAY['1'::varchar(1), '2'::varchar(1), '3'::varchar(1), '4'::varchar(1), '5'::varchar(1), '6'::varchar(1), '68'::varchar(2)])) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state, mpzd.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime Therapeutics'::varchar(18)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((add_months(last_day(sp.ship_date), 1) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) A;

CREATE  VIEW outbound.zzz_asi_rx_by_market_ms AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '2'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, rx.ims_zip AS zip_other, sp.ims_id, rx.ims_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, rx.ims_me_num AS me_num, rx.ims_last_name AS last_name, rx.ims_first_name AS first_name, rx.ims_middle_name AS middle_name, rx.ims_address AS address, rx.ims_city AS city, rx.ims_state AS state_code, rx.ims_zip AS zip, NULL AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, to_char(mth2.data_date, 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN (SELECT max(month_rollup_and_bucket.month_ending) AS data_date FROM outbound.month_rollup_and_bucket) mth2 ON (true)) JOIN reference.asi_outbound_ims_product_group_mapping pg ON (((sp.specialty_pharmacy_data_source = pg.data_source) AND (sp.basket_id = pg.basket_id) AND (pg.market_name = 'MS MARKET'::varchar(9))))) LEFT JOIN (SELECT a.ims_last_name, a.ims_first_name, a.ims_middle_name, a.ims_address, a.ims_city, a.ims_state, a.ims_zip, a.ims_client_number, a.ims_me_num, a.ims_id, a.ims_specialty, a.rnk FROM (SELECT axd.ims_last_name, axd.ims_first_name, axd.ims_middle_name, axd.ims_address, axd.ims_city, axd.ims_state, axd.ims_zip, axd.ims_client_number, axd.ims_me_num, axd.ims_id, axd.ims_specialty, row_number() OVER (PARTITION BY axd.ims_id ORDER BY axd.ims_specialty) AS rnk FROM outbound.asi_xponent_demographics axd) a WHERE (a.rnk = 1)) rx ON (((rx.ims_id = sp.ims_id) AND (rx.ims_client_number = '632'::varchar(3))))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY pg.market_name, sp.ims_id, rx.ims_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pg.ims_product_group, rx.ims_me_num, rx.ims_last_name, rx.ims_first_name, rx.ims_middle_name, rx.ims_address, rx.ims_city, rx.ims_state, rx.ims_zip, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END, to_char(mth2.data_date, 'MMDDYY'::varchar(6))) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, to_char(mth2.data_date, 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_024 FROM (((datamart.cmop_rx cm JOIN outbound.month_rollup_and_bucket mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT max(month_rollup_and_bucket.month_ending) AS data_date FROM outbound.month_rollup_and_bucket) mth2 ON (true)) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.total_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, to_char(mth2.data_date, 'MMDDYY'::varchar(6));

CREATE  VIEW sandbox.ad_hoc_ad AS
 SELECT ('"'::varchar(1) || fed.id_num) AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat((c.file_id)::varchar, (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (brand.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((((('Voucher/Coupon Redemption - '::varchar(28) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cvp.program_description, ''::varchar)) || ','::varchar(1)) || c.redemption_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        (to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) || '"'::varchar(1)) AS modified
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) JOIN datamart.tvcmid_xref fed ON (((c.physician_tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_id)));

CREATE  VIEW outbound.pdrp AS
 SELECT d.ims_id AS IMS_ID,
        coalesce(d.dea_num, dea.id_num) AS DEA_NUM,
        d.last_name AS LAST_NAME,
        d.first_name AS FIRST_NAME,
        d.middle_name AS MID_NAME,
        ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3) AS ADDRESS,
        d.ptr_city AS CITY,
        d.ptr_state AS STATE,
        d.ptr_zip AS ZIP,
        d.npi AS NPI
 FROM ((datamart.prescriber_combined_demographics d JOIN ( SELECT a.tvcmid,
        a.flag_type,
        a.flag_value
 FROM ( SELECT customer_level_flags.tvcmid,
        customer_level_flags.flag_type,
        customer_level_flags.flag_value,
        customer_level_flags.flag_effective_start_date,
        row_number() OVER (PARTITION BY customer_level_flags.tvcmid ORDER BY customer_level_flags.flag_effective_start_date DESC NULLS LAST, customer_level_flags.flag_value DESC) AS rnk
 FROM datamart.customer_level_flags
 WHERE (customer_level_flags.flag_type = 'PDRP'::varchar(4))) a
 WHERE (a.rnk = 1)) clf ON (((d.tvcmid = clf.tvcmid) AND (clf.flag_type = 'PDRP'::varchar(4)) AND (clf.flag_value = 'Y'::varchar(1))))) LEFT  JOIN ( SELECT b.tvcmid,
        b.id_num,
        b.state
 FROM ( SELECT tvcmid_xref.tvcmid,
        tvcmid_xref.id_num,
        tvcmid_xref.id_type,
        tvcmid_xref.state,
        row_number() OVER (PARTITION BY tvcmid_xref.tvcmid, tvcmid_xref.state ORDER BY tvcmid_xref.id_num) AS rnk
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'DEA_NUM'::varchar(7))) b
 WHERE (b.rnk = 1)) dea ON (((d.tvcmid = dea.tvcmid) AND (d.ptr_state = dea.state))))
 GROUP BY d.ims_id,
          coalesce(d.dea_num, dea.id_num),
          d.last_name,
          d.first_name,
          d.middle_name,
          ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3),
          d.ptr_city,
          d.ptr_state,
          d.ptr_zip,
          d.npi;

CREATE  VIEW outbound.zzz_asi_patient_month AS
 SELECT pmc.tvcmid,
        pmc.ims_id,
        pmc.npi,
        coalesce(vvid.veeva_account_id, pmc.ims_id) AS veeva_account_id,
        pmc.ims_surrogate_patient_id,
        pmc.basket_name AS product_name,
        pmc.indication,
        pmc.dispense_type,
        to_char(pmc.rollup_shipment_month, 'YYYYMMDD'::varchar(8)) AS rollup_shipment_month,
        (pmc.patient_months)::numeric(32,3) AS patient_months
 FROM ((datamart.patient_months_count pmc LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        min(tvcmid_xref.id_num) AS veeva_account_id
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) vvid ON ((pmc.tvcmid = vvid.tvcmid))) JOIN ( SELECT to_char(ims_week_buckets.month_ending, 'YYYYMMDD'::varchar(8)) AS full_month
 FROM integration.ims_week_buckets
 WHERE (ims_week_buckets.full_month = 'Y'::varchar(1))
 GROUP BY to_char(ims_week_buckets.month_ending, 'YYYYMMDD'::varchar(8))) fm ON ((to_char(pmc.rollup_shipment_month, 'YYYYMMDD'::varchar(8)) = fm.full_month)))
 WHERE (pmc.approved_indication = 'Y'::varchar(1))
 ORDER BY pmc.tvcmid,
          pmc.ims_surrogate_patient_id;

CREATE  VIEW outbound.zzz_generic_roster AS
 SELECT rep.employee_id AS TevaID,
        rep.territory_number AS Terr_id,
        rep.territory_name AS TerritoryName,
        rep.sales_force_id AS SalesForceID,
        rep.first_name AS FirstName,
        rep.middle_name AS MiddleName,
        rep.preferred_name AS PreferredName,
        rep.last_name AS LastName,
        replace(((((rep.first_name || ' '::varchar(1)) || coalesce(rep.middle_name, ''::varchar)) || ' '::varchar(1)) || rep.last_name), '  '::varchar(2), ' '::varchar(1)) AS FullName,
        rep.title AS Title,
        rep.hr_status AS RepStatus,
        CASE WHEN (upper(rep.reg_contract) = 'EX'::varchar(2)) THEN 'Contract'::varchar(8) ELSE rep.rep_type END AS RepType,
        ''::varchar AS Contractor,
        rep.email AS Email,
        mgr.employee_id AS ManagerID,
        mgr.first_name AS ManagerFirstName,
        coalesce(mgr.middle_name, ''::varchar) AS ManagerMiddleName,
        mgr.last_name AS ManagerLastName,
        replace(((((mgr.first_name || ' '::varchar(1)) || coalesce(mgr.middle_name, ''::varchar)) || ' '::varchar(1)) || mgr.last_name), '  '::varchar(2), ' '::varchar(1)) AS ManagerFullName,
        rep.business_address_line1 AS BusinessAddress1,
        rep.business_address_line2 AS BusinessAddress2,
        ''::varchar AS BusinessAddress3,
        rep.business_city AS BusinessAddressCity,
        rep.business_state AS BusinessAddressState,
        rep.business_zip AS BusinessZip,
        rep.business_country AS BusinessAddressCtry,
        'Active'::varchar(6) AS BusinessAddressStatus,
        rep.shipping_address_line1 AS ShippingAddress1,
        rep.shipping_address_line2 AS ShippingAddress2,
        ''::varchar AS ShippingAddress3,
        rep.shipping_city AS ShippingAddressCity,
        rep.shipping_state AS ShippingAddressState,
        rep.shipping_zip AS ShippingZip,
        rep.shipping_country AS ShippingAddressCtry,
        'Active'::varchar(6) AS ShippingAddressStatus,
        rep.samplestorage_address_line1 AS SampleStorageAddress1,
        rep.samplestorage_address_line2 AS SampleStorageAddress2,
        rep.samplestorage_address_line3 AS SampleStorageAddress3,
        rep.samplestorage_city AS SampleStorageAddressCity,
        rep.samplestorage_state AS SampleStorageAddressState,
        rep.samplestorage_zip AS SampleStorageAddressZip,
        rep.samplestorage_country AS SampleStorageAddressCtry,
        'Active'::varchar(6) AS SampleStorageAddressStatus,
        rep.business_phone AS BusinessPhone,
        rep.mobile_phone AS MobilePhone,
        rep.home_phone AS HomePhone,
        rep.hire_date AS HireDate,
        rep.username AS LoginID,
        'Primary'::varchar(7) AS TerritoryAssignment,
        substr(('0'::varchar(1) || rep.birth_month_day), ((length(('0'::varchar(1) || rep.birth_month_day)) - 4) + 1), 4) AS BirthMonthDay
 FROM (datamart.roster rep LEFT  JOIN datamart.roster mgr ON ((mgr.employee_id = rep.mngr_employee_id)))
 WHERE ((rep.employee_id IS NOT NULL) AND (rep.hr_status = 'Active'::varchar(6)) AND (rep.territory_number IS NOT NULL) AND (rep.sales_force_id <> ALL (ARRAY['TWH'::varchar(3), 'TX'::varchar(2)])) AND (rep.calculated_rep_type <> 'CONTRACT'::varchar(8)))
 GROUP BY rep.employee_id,
          rep.territory_number,
          rep.territory_name,
          rep.sales_force_id,
          rep.first_name,
          rep.middle_name,
          rep.preferred_name,
          rep.last_name,
          replace(((((rep.first_name || ' '::varchar(1)) || coalesce(rep.middle_name, ''::varchar)) || ' '::varchar(1)) || rep.last_name), '  '::varchar(2), ' '::varchar(1)),
          rep.title,
          rep.hr_status,
          CASE WHEN (upper(rep.reg_contract) = 'EX'::varchar(2)) THEN 'Contract'::varchar(8) ELSE rep.rep_type END,
          ''::varchar,
          rep.email,
          mgr.employee_id,
          mgr.first_name,
          coalesce(mgr.middle_name, ''::varchar),
          mgr.last_name,
          replace(((((mgr.first_name || ' '::varchar(1)) || coalesce(mgr.middle_name, ''::varchar)) || ' '::varchar(1)) || mgr.last_name), '  '::varchar(2), ' '::varchar(1)),
          rep.business_address_line1,
          rep.business_address_line2,
          rep.business_city,
          rep.business_state,
          rep.business_zip,
          rep.business_country,
          'Active'::varchar(6),
          rep.shipping_address_line1,
          rep.shipping_address_line2,
          rep.shipping_city,
          rep.shipping_state,
          rep.shipping_zip,
          rep.shipping_country,
          rep.samplestorage_address_line1,
          rep.samplestorage_address_line2,
          rep.samplestorage_address_line3,
          rep.samplestorage_city,
          rep.samplestorage_state,
          rep.samplestorage_zip,
          rep.samplestorage_country,
          rep.business_phone,
          rep.mobile_phone,
          rep.home_phone,
          rep.hire_date,
          rep.username,
          'Primary'::varchar(7),
          substr(('0'::varchar(1) || rep.birth_month_day), ((length(('0'::varchar(1) || rep.birth_month_day)) - 4) + 1), 4);

CREATE  VIEW outbound.zzz_asi_rx_by_market_onc AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        coalesce(rx.payer_plan_number, 'NOPLANCODE'::varchar(10)) AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_001,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_002,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_003,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_004,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_005,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_006,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_007,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_008,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_009,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_010,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_011,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_012,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_013,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_014,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_015,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_016,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_017,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_018,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_019,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_020,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_021,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_022,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_023,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.nrx_count ELSE NULL::numeric(18,3) END) AS nrx_024,
        sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_001,
        sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_002,
        sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_003,
        sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_004,
        sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_005,
        sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_006,
        sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_007,
        sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_008,
        sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_009,
        sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_010,
        sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_011,
        sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_012,
        sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_013,
        sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_014,
        sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_015,
        sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_016,
        sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_017,
        sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_018,
        sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_019,
        sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_020,
        sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_021,
        sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_022,
        sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_023,
        sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE NULL::numeric(18,3) END) AS trx_024
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) mth ON ((rx.rollup_month = mth.month_ending))) JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number <=> axd.ims_client_number) AND (rx.ims_report_number_cnt <=> axd.ims_report_number) AND (rx.ims_id <=> axd.ims_id) AND (rx.ims_product_group <=> axd.ims_product_group) AND (rx.ims_specialty <=> axd.ims_specialty) AND (rx.ims_zip_other <=> axd.ims_zip_other))))
 WHERE ((rx.rollup_flag IS NULL) AND (rx.ims_client_number = '994'::varchar(3)) AND (rx.ims_report_number_cnt = '18'::varchar(2)) AND (rx.ims_report_number_qty = '17'::varchar(2)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW teva_ingestion.EXT_DX_CLAIMS AS
 SELECT btrim(EXT_DX_CLAIMS_src.ims_rxer_id) AS ims_rxer_id,
        btrim(EXT_DX_CLAIMS_src.npi) AS npi,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_01))::int END AS g244_clm_cnt_mth_01,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_02))::int END AS g244_clm_cnt_mth_02,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_03))::int END AS g244_clm_cnt_mth_03,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_04))::int END AS g244_clm_cnt_mth_04,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_05))::int END AS g244_clm_cnt_mth_05,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_06))::int END AS g244_clm_cnt_mth_06,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_07))::int END AS g244_clm_cnt_mth_07,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_08))::int END AS g244_clm_cnt_mth_08,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_09))::int END AS g244_clm_cnt_mth_09,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_10))::int END AS g244_clm_cnt_mth_10,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_11))::int END AS g244_clm_cnt_mth_11,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_clm_cnt_mth_12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_clm_cnt_mth_12))::int END AS g244_clm_cnt_mth_12,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_01))::int END AS g244_pat_cnt_mth_01,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_02))::int END AS g244_pat_cnt_mth_02,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_03))::int END AS g244_pat_cnt_mth_03,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_04))::int END AS g244_pat_cnt_mth_04,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_05))::int END AS g244_pat_cnt_mth_05,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_06))::int END AS g244_pat_cnt_mth_06,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_07))::int END AS g244_pat_cnt_mth_07,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_08))::int END AS g244_pat_cnt_mth_08,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_09))::int END AS g244_pat_cnt_mth_09,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_10))::int END AS g244_pat_cnt_mth_10,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_11))::int END AS g244_pat_cnt_mth_11,
        CASE WHEN (EXT_DX_CLAIMS_src.g244_pat_cnt_mth_12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g244_pat_cnt_mth_12))::int END AS g244_pat_cnt_mth_12,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_01))::int END AS g2401_clm_cnt_mth_01,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_02))::int END AS g2401_clm_cnt_mth_02,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_03))::int END AS g2401_clm_cnt_mth_03,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_04))::int END AS g2401_clm_cnt_mth_04,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_05))::int END AS g2401_clm_cnt_mth_05,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_06))::int END AS g2401_clm_cnt_mth_06,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_07))::int END AS g2401_clm_cnt_mth_07,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_08))::int END AS g2401_clm_cnt_mth_08,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_09))::int END AS g2401_clm_cnt_mth_09,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_10))::int END AS g2401_clm_cnt_mth_10,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_11))::int END AS g2401_clm_cnt_mth_11,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_clm_cnt_mth_12))::int END AS g2401_clm_cnt_mth_12,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_01 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_01))::int END AS g2401_pat_cnt_mth_01,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_02 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_02))::int END AS g2401_pat_cnt_mth_02,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_03 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_03))::int END AS g2401_pat_cnt_mth_03,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_04 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_04))::int END AS g2401_pat_cnt_mth_04,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_05 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_05))::int END AS g2401_pat_cnt_mth_05,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_06 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_06))::int END AS g2401_pat_cnt_mth_06,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_07 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_07))::int END AS g2401_pat_cnt_mth_07,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_08 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_08))::int END AS g2401_pat_cnt_mth_08,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_09 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_09))::int END AS g2401_pat_cnt_mth_09,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_10 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_10))::int END AS g2401_pat_cnt_mth_10,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_11 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_11))::int END AS g2401_pat_cnt_mth_11,
        CASE WHEN (EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_12 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DX_CLAIMS_src.g2401_pat_cnt_mth_12))::int END AS g2401_pat_cnt_mth_12,
        EXT_DX_CLAIMS_src.batch_id,
        EXT_DX_CLAIMS_src.row_id,
        EXT_DX_CLAIMS_src.update_ts
 FROM teva_ingestion.EXT_DX_CLAIMS_src;

CREATE  VIEW raw.ext_dx_claims AS
 SELECT src.ims_rxer_id,
        src.npi,
        src.g244_clm_cnt_mth_01,
        src.g244_clm_cnt_mth_02,
        src.g244_clm_cnt_mth_03,
        src.g244_clm_cnt_mth_04,
        src.g244_clm_cnt_mth_05,
        src.g244_clm_cnt_mth_06,
        src.g244_clm_cnt_mth_07,
        src.g244_clm_cnt_mth_08,
        src.g244_clm_cnt_mth_09,
        src.g244_clm_cnt_mth_10,
        src.g244_clm_cnt_mth_11,
        src.g244_clm_cnt_mth_12,
        src.g244_pat_cnt_mth_01,
        src.g244_pat_cnt_mth_02,
        src.g244_pat_cnt_mth_03,
        src.g244_pat_cnt_mth_04,
        src.g244_pat_cnt_mth_05,
        src.g244_pat_cnt_mth_06,
        src.g244_pat_cnt_mth_07,
        src.g244_pat_cnt_mth_08,
        src.g244_pat_cnt_mth_09,
        src.g244_pat_cnt_mth_10,
        src.g244_pat_cnt_mth_11,
        src.g244_pat_cnt_mth_12,
        src.g2401_clm_cnt_mth_01,
        src.g2401_clm_cnt_mth_02,
        src.g2401_clm_cnt_mth_03,
        src.g2401_clm_cnt_mth_04,
        src.g2401_clm_cnt_mth_05,
        src.g2401_clm_cnt_mth_06,
        src.g2401_clm_cnt_mth_07,
        src.g2401_clm_cnt_mth_08,
        src.g2401_clm_cnt_mth_09,
        src.g2401_clm_cnt_mth_10,
        src.g2401_clm_cnt_mth_11,
        src.g2401_clm_cnt_mth_12,
        src.g2401_pat_cnt_mth_01,
        src.g2401_pat_cnt_mth_02,
        src.g2401_pat_cnt_mth_03,
        src.g2401_pat_cnt_mth_04,
        src.g2401_pat_cnt_mth_05,
        src.g2401_pat_cnt_mth_06,
        src.g2401_pat_cnt_mth_07,
        src.g2401_pat_cnt_mth_08,
        src.g2401_pat_cnt_mth_09,
        src.g2401_pat_cnt_mth_10,
        src.g2401_pat_cnt_mth_11,
        src.g2401_pat_cnt_mth_12,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DX_CLAIMS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DX_CLAIMS'::varchar(13)))));

CREATE  VIEW outbound.zs_access_monitor_control_file_oncology AS
 SELECT 'TEVA'::varchar(4) AS company,
        c.sales_force_id,
        c.sales_force_id AS sales_team,
        count(DISTINCT c.rep_id) AS num_reps,
        count(DISTINCT c.territory_num) AS num_terrs,
        sum(c.p1_calls_mth1) AS p1_calls_mth1,
        sum(c.p1_calls_mth2) AS p1_calls_mth2,
        sum(c.p1_calls_mth3) AS p1_calls_mth3,
        sum(c.p1_calls_mth4) AS p1_calls_mth4,
        sum(c.p1_calls_mth5) AS p1_calls_mth5,
        sum(c.p1_calls_mth6) AS p1_calls_mth6,
        sum(cp.plan_calls) AS total_planned_calls,
        count(c.tvcmid) AS total_records
 FROM ((( SELECT c.sales_force_id,
        c.territory_num,
        c.rep_id,
        c.tvcmid,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6
 FROM ( SELECT c.sales_force_id,
        c.tvcmid,
        c.territory_number AS territory_num,
        c.rep_id,
        d.product,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(1) AS pri_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1))
 GROUP BY c.sales_force_id,
          c.tvcmid,
          c.territory_number,
          c.rep_id,
          d.product,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.sales_force_id,
          c.territory_num,
          c.rep_id,
          c.tvcmid) c JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT cp.tvcmid,
        sum(cp.p1) AS plan_calls
 FROM datamart.call_plan cp
 WHERE (cp.sales_force_id = 'TO'::varchar(2))
 GROUP BY cp.tvcmid) cp ON ((c.tvcmid = cp.tvcmid)))
 WHERE (c.sales_force_id = 'TO'::varchar(2))
 GROUP BY c.sales_force_id;

CREATE  VIEW outbound.zs_access_monitor_control_file_cns AS
 SELECT 'TEVA'::varchar(4) AS company,
        d.sales_force_id,
        d.sales_force_id AS sales_team,
        count(DISTINCT d.rep_id) AS num_reps,
        count(DISTINCT d.territory_number) AS num_terrs,
        sum(d.p1_calls_mth1) AS p1_calls_mth1,
        sum(d.p1_calls_mth2) AS p1_calls_mth2,
        sum(d.p1_calls_mth3) AS p1_calls_mth3,
        sum(d.p1_calls_mth4) AS p1_calls_mth4,
        sum(d.p1_calls_mth5) AS p1_calls_mth5,
        sum(d.p1_calls_mth6) AS p1_calls_mth6,
        sum(d.plan_calls) AS total_planned_calls,
        count(d.tvcmid) AS total_records
 FROM ( SELECT calls_by_detail.sales_force_id,
        calls_by_detail.territory_number,
        calls_by_detail.rep_id,
        calls_by_detail.tvcmid,
        calls_by_detail.p1_calls_mth1,
        calls_by_detail.p1_calls_mth2,
        calls_by_detail.p1_calls_mth3,
        calls_by_detail.p1_calls_mth4,
        calls_by_detail.p1_calls_mth5,
        calls_by_detail.p1_calls_mth6,
        0 AS plan_calls
 FROM ( SELECT c.sales_force_id,
        c.territory_number,
        c.rep_id,
        c.tvcmid,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6
 FROM ( SELECT c.sales_force_id,
        c.tvcmid,
        c.territory_number,
        c.rep_id,
        d.product,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(1) AS pri_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1))
 GROUP BY c.sales_force_id,
          c.tvcmid,
          c.territory_number,
          c.rep_id,
          d.product,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.sales_force_id,
          c.territory_number,
          c.rep_id,
          c.tvcmid) calls_by_detail UNION  SELECT cp.sales_force_id,
        NULL AS territory_number,
        NULL AS rep_id,
        0 AS tvcmid,
        0 AS p1_calls_mth1,
        0 AS p1_calls_mth2,
        0 AS p1_calls_mth3,
        0 AS p1_calls_mth4,
        0 AS p1_calls_mth5,
        0 AS p1_calls_mth6,
        cp.plan_calls
 FROM ( SELECT cp.sales_force_id,
        sum(cp.p1) AS plan_calls
 FROM datamart.call_plan cp
 WHERE (cp.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)]))
 GROUP BY cp.sales_force_id) cp) d
 GROUP BY d.sales_force_id;

CREATE  VIEW outbound.zs_access_monitor_control_file_respiratory AS
 SELECT 'TEVA'::varchar(4) AS company,
        d.sales_force_id,
        d.sales_force_id AS sales_team,
        count(DISTINCT d.rep_id) AS num_reps,
        count(DISTINCT d.territory_number) AS num_terrs,
        sum(d.p1_calls_mth1) AS p1_calls_mth1,
        sum(d.p1_calls_mth2) AS p1_calls_mth2,
        sum(d.p1_calls_mth3) AS p1_calls_mth3,
        sum(d.p1_calls_mth4) AS p1_calls_mth4,
        sum(d.p1_calls_mth5) AS p1_calls_mth5,
        sum(d.p1_calls_mth6) AS p1_calls_mth6,
        sum(d.plan_calls) AS total_planned_calls,
        count(d.tvcmid) AS total_records
 FROM ( SELECT calls_by_detail.sales_force_id,
        calls_by_detail.territory_number,
        calls_by_detail.rep_id,
        calls_by_detail.tvcmid,
        calls_by_detail.p1_calls_mth1,
        calls_by_detail.p1_calls_mth2,
        calls_by_detail.p1_calls_mth3,
        calls_by_detail.p1_calls_mth4,
        calls_by_detail.p1_calls_mth5,
        calls_by_detail.p1_calls_mth6,
        0 AS plan_calls
 FROM ( SELECT c.sales_force_id,
        c.territory_number,
        c.rep_id,
        c.tvcmid,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6
 FROM ( SELECT c.sales_force_id,
        c.tvcmid,
        c.territory_number,
        c.rep_id,
        d.product,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(1) AS pri_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1))
 GROUP BY c.sales_force_id,
          c.tvcmid,
          c.territory_number,
          c.rep_id,
          d.product,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.sales_force_id,
          c.territory_number,
          c.rep_id,
          c.tvcmid) calls_by_detail UNION  SELECT cp.sales_force_id,
        NULL AS territory_number,
        NULL AS rep_id,
        0 AS tvcmid,
        0 AS p1_calls_mth1,
        0 AS p1_calls_mth2,
        0 AS p1_calls_mth3,
        0 AS p1_calls_mth4,
        0 AS p1_calls_mth5,
        0 AS p1_calls_mth6,
        cp.plan_calls
 FROM ( SELECT cp.sales_force_id,
        sum(cp.p1) AS plan_calls
 FROM datamart.call_plan cp
 WHERE (cp.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)]))
 GROUP BY cp.sales_force_id) cp) d
 GROUP BY d.sales_force_id;

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_cns AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_no_contact_respiratory AS
 SELECT a.sales_force_id,
        b.me__c AS me_number,
        a.npi,
        b.id AS veeva_id,
        a.tvcmid,
        a.ims_id
 FROM (datamart.sfa_demographics a JOIN veeva.account b ON ((a.veeva_account_id = b.id)))
 WHERE ((b.no_contact_tva__c IS NOT NULL) AND (a.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])))
 GROUP BY a.sales_force_id,
          b.me__c,
          a.npi,
          b.id,
          a.tvcmid,
          a.ims_id
 ORDER BY b.me__c;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_cns AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_oncology AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = 'TO'::varchar(2)) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.veeva_account_id, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.veeva_account_id, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.tp_physician_univ AS
 SELECT x.npi,
        x.dea_num,
        x.last_name,
        x.first_name,
        x.middle_name,
        x.address,
        x.city,
        x.state,
        x.zip
 FROM ( SELECT dc.npi,
        dc.dea_num,
        upper(dc.last_name) AS last_name,
        upper(dc.first_name) AS first_name,
        upper(dc.middle_name) AS middle_name,
        btrim(upper(((((coalesce(dc.ptr_address_1, ''::varchar) || ' '::varchar(1)) || coalesce(dc.ptr_address_2, ''::varchar)) || ' '::varchar(1)) || coalesce(dc.ptr_address_3, ''::varchar)))) AS address,
        upper(dc.ptr_city) AS city,
        dc.ptr_state AS state,
        dc.ptr_zip AS zip,
        row_number() OVER (PARTITION BY dc.sales_force_id, dc.npi ORDER BY dc.ptr_territory_num) AS rnk
 FROM datamart.prescriber_combined_demographics dc
 WHERE ((dc.ims_id IS NOT NULL) AND (dc.npi IS NOT NULL) AND (dc.sales_force_id = 'TP'::varchar(2)))) x
 WHERE (x.rnk = 1);

CREATE  VIEW teva_ingestion.EXT_OPTUMRX AS
 SELECT CASE WHEN (EXT_OPTUMRX_src.ship_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_OPTUMRX_src.ship_date))::date END AS ship_date,
        btrim(EXT_OPTUMRX_src.full_name) AS full_name,
        btrim(EXT_OPTUMRX_src.specialty) AS specialty,
        CASE WHEN (EXT_OPTUMRX_src.rank = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rank))::int END AS rank,
        CASE WHEN (EXT_OPTUMRX_src.total = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.total))::int END AS total,
        CASE WHEN (EXT_OPTUMRX_src.aubagio_14 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.aubagio_14))::int END AS aubagio_14,
        CASE WHEN (EXT_OPTUMRX_src.aubagio_7 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.aubagio_7))::int END AS aubagio_7,
        CASE WHEN (EXT_OPTUMRX_src.avonex_30 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.avonex_30))::int END AS avonex_30,
        CASE WHEN (EXT_OPTUMRX_src.avonex_pack = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.avonex_pack))::int END AS avonex_pack,
        CASE WHEN (EXT_OPTUMRX_src.avonex_pen_pack = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.avonex_pen_pack))::int END AS avonex_pen_pack,
        CASE WHEN (EXT_OPTUMRX_src.betaseron = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.betaseron))::int END AS betaseron,
        CASE WHEN (EXT_OPTUMRX_src.copaxone_20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.copaxone_20))::int END AS copaxone_20,
        CASE WHEN (EXT_OPTUMRX_src.copaxone_40 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.copaxone_40))::int END AS copaxone_40,
        CASE WHEN (EXT_OPTUMRX_src.gilenya_0_5_2x14 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.gilenya_0_5_2x14))::int END AS gilenya_0_5_2x14,
        CASE WHEN (EXT_OPTUMRX_src.gilenya_0_5_1x7 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.gilenya_0_5_1x7))::int END AS gilenya_0_5_1x7,
        CASE WHEN (EXT_OPTUMRX_src.glatiramer_acetate_20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.glatiramer_acetate_20))::int END AS glatiramer_acetate_20,
        CASE WHEN (EXT_OPTUMRX_src.glatiramer_acetate_40 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.glatiramer_acetate_40))::int END AS glatiramer_acetate_40,
        CASE WHEN (EXT_OPTUMRX_src.glatopa_20 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.glatopa_20))::int END AS glatopa_20,
        CASE WHEN (EXT_OPTUMRX_src.lemtrada = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.lemtrada))::int END AS lemtrada,
        CASE WHEN (EXT_OPTUMRX_src.plegridy_pfs = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.plegridy_pfs))::int END AS plegridy_pfs,
        CASE WHEN (EXT_OPTUMRX_src.plegridy_pen = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.plegridy_pen))::int END AS plegridy_pen,
        CASE WHEN (EXT_OPTUMRX_src.rebif_22_rebidose = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_22_rebidose))::int END AS rebif_22_rebidose,
        CASE WHEN (EXT_OPTUMRX_src.rebif_22 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_22))::int END AS rebif_22,
        CASE WHEN (EXT_OPTUMRX_src.rebif_44 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_44))::int END AS rebif_44,
        CASE WHEN (EXT_OPTUMRX_src.rebif_44_rebidose = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_44_rebidose))::int END AS rebif_44_rebidose,
        CASE WHEN (EXT_OPTUMRX_src.rebif_pack = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_pack))::int END AS rebif_pack,
        CASE WHEN (EXT_OPTUMRX_src.rebif_pack_rebidose = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.rebif_pack_rebidose))::int END AS rebif_pack_rebidose,
        CASE WHEN (EXT_OPTUMRX_src.tecfidera_120 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.tecfidera_120))::int END AS tecfidera_120,
        CASE WHEN (EXT_OPTUMRX_src.tecfidera_240 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.tecfidera_240))::int END AS tecfidera_240,
        CASE WHEN (EXT_OPTUMRX_src.tecfidera_starter_pack = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.tecfidera_starter_pack))::int END AS tecfidera_starter_pack,
        CASE WHEN (EXT_OPTUMRX_src.tysabri = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.tysabri))::int END AS tysabri,
        CASE WHEN (EXT_OPTUMRX_src.zinbryta_150 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_OPTUMRX_src.zinbryta_150))::int END AS zinbryta_150,
        btrim(EXT_OPTUMRX_src.md_addr1) AS md_addr1,
        btrim(EXT_OPTUMRX_src.md_addr2) AS md_addr2,
        btrim(EXT_OPTUMRX_src.md_city) AS md_city,
        btrim(EXT_OPTUMRX_src.md_state) AS md_state,
        btrim(EXT_OPTUMRX_src.md_zip) AS md_zip,
        btrim(EXT_OPTUMRX_src.prescriber_npi) AS prescriber_npi,
        EXT_OPTUMRX_src.batch_id,
        EXT_OPTUMRX_src.row_id,
        EXT_OPTUMRX_src.update_ts
 FROM teva_ingestion.EXT_OPTUMRX_src;

CREATE  VIEW raw.ext_optumrx AS
 SELECT src.ship_date,
        src.full_name,
        src.specialty,
        src.rank,
        src.total,
        src.aubagio_14,
        src.aubagio_7,
        src.avonex_30,
        src.avonex_pack,
        src.avonex_pen_pack,
        src.betaseron,
        src.copaxone_20,
        src.copaxone_40,
        src.gilenya_0_5_2x14,
        src.gilenya_0_5_1x7,
        src.glatiramer_acetate_20,
        src.glatiramer_acetate_40,
        src.glatopa_20,
        src.lemtrada,
        src.plegridy_pfs,
        src.plegridy_pen,
        src.rebif_22_rebidose,
        src.rebif_22,
        src.rebif_44,
        src.rebif_44_rebidose,
        src.rebif_pack,
        src.rebif_pack_rebidose,
        src.tecfidera_120,
        src.tecfidera_240,
        src.tecfidera_starter_pack,
        src.tysabri,
        src.zinbryta_150,
        src.md_addr1,
        src.md_addr2,
        src.md_city,
        src.md_state,
        src.md_zip,
        src.prescriber_npi,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_OPTUMRX_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_OPTUMRX'::varchar(11)))));

CREATE  VIEW teva_ingestion.EXT_VV_PRODUCT_VOD__C AS
 SELECT btrim(EXT_VV_PRODUCT_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_PRODUCT_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_PRODUCT_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_PRODUCT_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_PRODUCT_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_PRODUCT_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_PRODUCT_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_PRODUCT_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_PRODUCT_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_PRODUCT_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_PRODUCT_VOD__C_src.LASTVIEWEDDATE) AS LASTVIEWEDDATE,
        btrim(EXT_VV_PRODUCT_VOD__C_src.LASTREFERENCEDDATE) AS LASTREFERENCEDDATE,
        btrim(EXT_VV_PRODUCT_VOD__C_src.CONSUMER_SITE__C) AS CONSUMER_SITE__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRODUCT_INFO__C) AS PRODUCT_INFO__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.THERAPEUTIC_CLASS_VOD__C) AS THERAPEUTIC_CLASS_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PARENT_PRODUCT_VOD__C) AS PARENT_PRODUCT_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.THERAPEUTIC_AREA_VOD__C) AS THERAPEUTIC_AREA_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRODUCT_TYPE_VOD__C) AS PRODUCT_TYPE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.REQUIRE_KEY_MESSAGE_VOD__C) AS REQUIRE_KEY_MESSAGE_VOD__C,
        CASE WHEN (EXT_VV_PRODUCT_VOD__C_src.COST_VOD__C = ''::varchar) THEN NULL::numeric(14,2) ELSE (btrim(EXT_VV_PRODUCT_VOD__C_src.COST_VOD__C))::numeric(14,2) END AS COST_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.MANUFACTURER_VOD__C) AS MANUFACTURER_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.COMPANY_PRODUCT_VOD__C) AS COMPANY_PRODUCT_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.CONTROLLED_SUBSTANCE_VOD__C) AS CONTROLLED_SUBSTANCE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.DESCRIPTION_VOD__C) AS DESCRIPTION_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SAMPLE_QUANTITY_PICKLIST_VOD__) AS SAMPLE_QUANTITY_PICKLIST_VOD__,
        CASE WHEN (EXT_VV_PRODUCT_VOD__C_src.DISPLAY_ORDER_VOD__C = ''::varchar) THEN NULL::numeric(5,0) ELSE (btrim(EXT_VV_PRODUCT_VOD__C_src.DISPLAY_ORDER_VOD__C))::numeric(5,0) END AS DISPLAY_ORDER_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.NO_METRICS_VOD__C) AS NO_METRICS_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.DISTRIBUTOR_VOD__C) AS DISTRIBUTOR_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SAMPLE_QUANTITY_BOUND_VOD__C) AS SAMPLE_QUANTITY_BOUND_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SAMPLE_U_M_VOD__C) AS SAMPLE_U_M_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.NO_DETAILS_VOD__C) AS NO_DETAILS_VOD__C,
        CASE WHEN (EXT_VV_PRODUCT_VOD__C_src.QUANTITY_PER_CASE_VOD__C = ''::varchar) THEN NULL::numeric(10,0) ELSE (btrim(EXT_VV_PRODUCT_VOD__C_src.QUANTITY_PER_CASE_VOD__C))::numeric(10,0) END AS QUANTITY_PER_CASE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SCHEDULE_VOD__C) AS SCHEDULE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.RESTRICTED_VOD__C) AS RESTRICTED_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRICING_RULE_QUANTITY_BOUND_VO) AS PRICING_RULE_QUANTITY_BOUND_VO,
        btrim(EXT_VV_PRODUCT_VOD__C_src.NO_PROMO_ITEMS_VOD__C) AS NO_PROMO_ITEMS_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.USER_ALIGNED_VOD__C) AS USER_ALIGNED_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.RESTRICTED_STATES_VOD__C) AS RESTRICTED_STATES_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SORT_CODE_VOD__C) AS SORT_CODE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.NO_CYCLE_PLANS_VOD__C) AS NO_CYCLE_PLANS_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.INVENTORY_ORDER_UOM_VOD__C) AS INVENTORY_ORDER_UOM_VOD__C,
        CASE WHEN (EXT_VV_PRODUCT_VOD__C_src.INVENTORY_QUANTITY_PER_CASE_VO = ''::varchar) THEN NULL::numeric(10,0) ELSE (btrim(EXT_VV_PRODUCT_VOD__C_src.INVENTORY_QUANTITY_PER_CASE_VO))::numeric(10,0) END AS INVENTORY_QUANTITY_PER_CASE_VO,
        btrim(EXT_VV_PRODUCT_VOD__C_src.SUB_TYPE__C) AS SUB_TYPE__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.ORGANIZATION__C) AS ORGANIZATION__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRODUCT_ID_TEVA__C) AS PRODUCT_ID_TEVA__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRODUCT_LINE_TVA__C) AS PRODUCT_LINE_TVA__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.VEXTERNAL_ID_VOD__C) AS VEXTERNAL_ID_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.PRODUCT_VALUE_VOD__C) AS PRODUCT_VALUE_VOD__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.ENCRYPT_VEEVA_EXTERNAL_ID_TVA__C) AS ENCRYPT_VEEVA_EXTERNAL_ID_TVA__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.AVAILABLE_QTY_TVA__C) AS AVAILABLE_QTY_TVA__C,
        btrim(EXT_VV_PRODUCT_VOD__C_src.EXPIRATION_DATE_TVA__C) AS EXPIRATION_DATE_TVA__C,
        EXT_VV_PRODUCT_VOD__C_src.batch_id,
        EXT_VV_PRODUCT_VOD__C_src.row_id,
        EXT_VV_PRODUCT_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_PRODUCT_VOD__C_src;

CREATE  VIEW raw.ext_vv_product_vod__c AS
 SELECT src.ID,
        src.OWNERID,
        src.ISDELETED,
        src.NAME,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.LASTVIEWEDDATE,
        src.LASTREFERENCEDDATE,
        src.CONSUMER_SITE__C,
        src.PRODUCT_INFO__C,
        src.THERAPEUTIC_CLASS_VOD__C,
        src.PARENT_PRODUCT_VOD__C,
        src.THERAPEUTIC_AREA_VOD__C,
        src.PRODUCT_TYPE_VOD__C,
        src.REQUIRE_KEY_MESSAGE_VOD__C,
        src.COST_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.MANUFACTURER_VOD__C,
        src.COMPANY_PRODUCT_VOD__C,
        src.CONTROLLED_SUBSTANCE_VOD__C,
        src.DESCRIPTION_VOD__C,
        src.SAMPLE_QUANTITY_PICKLIST_VOD__,
        src.DISPLAY_ORDER_VOD__C,
        src.NO_METRICS_VOD__C,
        src.DISTRIBUTOR_VOD__C,
        src.SAMPLE_QUANTITY_BOUND_VOD__C,
        src.SAMPLE_U_M_VOD__C,
        src.NO_DETAILS_VOD__C,
        src.QUANTITY_PER_CASE_VOD__C,
        src.SCHEDULE_VOD__C,
        src.RESTRICTED_VOD__C,
        src.PRICING_RULE_QUANTITY_BOUND_VO,
        src.NO_PROMO_ITEMS_VOD__C,
        src.USER_ALIGNED_VOD__C,
        src.RESTRICTED_STATES_VOD__C,
        src.SORT_CODE_VOD__C,
        src.NO_CYCLE_PLANS_VOD__C,
        src.INVENTORY_ORDER_UOM_VOD__C,
        src.INVENTORY_QUANTITY_PER_CASE_VO,
        src.SUB_TYPE__C,
        src.ORGANIZATION__C,
        src.PRODUCT_ID_TEVA__C,
        src.PRODUCT_LINE_TVA__C,
        src.VEXTERNAL_ID_VOD__C,
        src.PRODUCT_VALUE_VOD__C,
        src.ENCRYPT_VEEVA_EXTERNAL_ID_TVA__C,
        src.AVAILABLE_QTY_TVA__C,
        src.EXPIRATION_DATE_TVA__C,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_PRODUCT_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_PRODUCT_VOD__C'::varchar(21)))));

CREATE  VIEW datamart.territory_region_area_hierarchy AS
 SELECT a.geography_number AS territory_number,
        a.geography_name AS territory_name,
        b.geography_number AS region_number,
        b.geography_name AS region_name,
        c.geography_number AS area_number,
        c.geography_name AS area_name
 FROM ((datamart.sales_geography a LEFT  JOIN datamart.sales_geography b ON ((a.parent_geography_number = b.geography_number))) LEFT  JOIN datamart.sales_geography c ON ((b.parent_geography_number = c.geography_number)))
 ORDER BY a.geography_number;

CREATE  VIEW veeva.v_ids_call_sample AS
 SELECT ids_call_sample.id,
        ids_call_sample.file_id,
        ids_call_sample.record_id
 FROM veeva.ids_call_sample
 WHERE (ids_call_sample.file_id = ( SELECT max(ids_call_sample.file_id) AS max
 FROM veeva.ids_call_sample));

CREATE  VIEW outbound.zzz_asi_market_access_m AS
(SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((datamart.prescriber_rx rx LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.ims_report_number_cnt = ANY (ARRAY['2'::varchar(1), '6'::varchar(1), '14'::varchar(2), '16'::varchar(2), '81'::varchar(2)])) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime T'::varchar(7)])) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (sp.ims_id IS NOT NULL)) GROUP BY sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1))) UNION ALL SELECT sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (sp.ims_id IS NOT NULL)) GROUP BY sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1));

CREATE  VIEW outbound.zzz_create_copay_voucher_program AS
 SELECT copay_voucher_program.redemption_type AS REDEMPTION_TYPE,
        copay_voucher_program.program_number AS ASI_PROGRAM_NUM,
        copay_voucher_program.program_description AS PROGRAM_DESC,
        NULL AS SALES_FORCE_ID,
        NULL AS PROGRAM_TYPE,
        NULL AS PRODUCT_NAME,
        NULL AS PROGRAM_START_DATE,
        NULL AS PROGRAM_END_DATE,
        NULL AS NUMBER_OF_TABLETS
 FROM reference.copay_voucher_program;

CREATE  VIEW outbound.i_bag_territory_product AS
( SELECT i_bag_territory_product_terr.territory_number,
        i_bag_territory_product_terr.bag_name,
        i_bag_territory_product_terr."position",
        i_bag_territory_product_terr.basket_name
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr UNION  SELECT i_bag_territory_product_mgr.territory_number,
        i_bag_territory_product_mgr.bag_name,
        i_bag_territory_product_mgr."position",
        i_bag_territory_product_mgr.basket_name
 FROM ( SELECT m.territory_number,
        (m.sales_force_id || 'MGR'::varchar(3)) AS bag_name,
        row_number() OVER (PARTITION BY m.territory_number ORDER BY p.basket_name) AS "position",
        p.basket_name
 FROM (( SELECT substr(i_bag_territory_product_terr.territory_number, 1, 2) AS sales_force_id,
        i_bag_territory_product_terr.basket_name
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr
 GROUP BY substr(i_bag_territory_product_terr.territory_number, 1, 2),
          i_bag_territory_product_terr.basket_name) p JOIN ( SELECT substr(i_bag_territory_product_terr.territory_number, 1, 2) AS sales_force_id,
        (substr(i_bag_territory_product_terr.territory_number, 1, 6) || '00'::varchar(2)) AS territory_number
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr
 GROUP BY substr(i_bag_territory_product_terr.territory_number, 1, 2),
          (substr(i_bag_territory_product_terr.territory_number, 1, 6) || '00'::varchar(2))) m ON ((p.sales_force_id = m.sales_force_id)))) i_bag_territory_product_mgr) UNION  SELECT terrs.territory_number,
        NULL AS bag_name,
        (90 + row_number() OVER (PARTITION BY terrs.territory_number ORDER BY sfpm.PRODUCT_NAME)) AS "position",
        sfpm.PRODUCT_NAME AS product_name
 FROM (reference.sales_force_product_metrics sfpm JOIN ( SELECT i_bag_territory_product_terr.territory_number
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr UNION  SELECT i_bag_territory_product_mgr.territory_number
 FROM ( SELECT m.territory_number,
        (m.sales_force_id || 'MGR'::varchar(3)) AS bag_name,
        row_number() OVER (PARTITION BY m.territory_number ORDER BY p.basket_name) AS "position",
        p.basket_name
 FROM (( SELECT substr(i_bag_territory_product_terr.territory_number, 1, 2) AS sales_force_id,
        i_bag_territory_product_terr.basket_name
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr
 GROUP BY substr(i_bag_territory_product_terr.territory_number, 1, 2),
          i_bag_territory_product_terr.basket_name) p JOIN ( SELECT substr(i_bag_territory_product_terr.territory_number, 1, 2) AS sales_force_id,
        (substr(i_bag_territory_product_terr.territory_number, 1, 6) || '00'::varchar(2)) AS territory_number
 FROM ( SELECT bt.territory_number,
        b.bag_name,
        bp."position",
        bp.basket_name
 FROM ((reference.bag b JOIN reference.bag_territory bt ON ((b.bag_id = bt.bag_id))) JOIN reference.bag_product bp ON ((b.bag_id = bp.bag_id)))
 WHERE (((statement_timestamp())::timestamp >= b.first_valid_date) AND ((statement_timestamp())::timestamp <= b.last_valid_date) AND ((statement_timestamp())::timestamp >= bt.detail_first_valid_date) AND ((statement_timestamp())::timestamp <= bt.detail_last_valid_date))) i_bag_territory_product_terr
 GROUP BY substr(i_bag_territory_product_terr.territory_number, 1, 2),
          (substr(i_bag_territory_product_terr.territory_number, 1, 6) || '00'::varchar(2))) m ON ((p.sales_force_id = m.sales_force_id)))) i_bag_territory_product_mgr) terrs ON ((terrs.territory_number ~~ (sfpm.SALES_FORCE_ID || '%'::varchar(1)))));

CREATE  VIEW outbound.mdm_hcp AS
 SELECT 'OPTMRX'::varchar(6) AS dsp_id,
        substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100) AS dsp_hce_id,
        specialty_pharmacy_shipment.physician_first_name AS first_name,
        specialty_pharmacy_shipment.physician_middle_name AS middle_name,
        specialty_pharmacy_shipment.physician_last_name AS last_name,
        NULL AS prefix,
        NULL AS suffix,
        '1'::varchar(50) AS sub_type,
        NULL AS status_code,
        NULL::date AS year_of_birth,
        NULL::date AS year_of_death,
        NULL AS gender_code,
        NULL AS teva_specialty_code
 FROM datamart.specialty_pharmacy_shipment
 WHERE ((specialty_pharmacy_shipment.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (specialty_pharmacy_shipment.customer_type = 'HCP'::varchar(3)))
 GROUP BY 'OPTMRX'::varchar(6),
          substr(replace((coalesce(specialty_pharmacy_shipment.source_customer_id, ''::varchar) || coalesce(specialty_pharmacy_shipment.customer_name, ''::varchar)), ' '::varchar(1), ''::varchar), 1, 100),
          specialty_pharmacy_shipment.physician_first_name,
          specialty_pharmacy_shipment.physician_middle_name,
          specialty_pharmacy_shipment.physician_last_name,
          NULL,
          '1'::varchar(50),
          NULL::date UNION  SELECT a.dsp_id,
        substr(a.dsp_hce_id, 1, 100) AS dsp_hce_id,
        a.first_name,
        a.middle_name,
        a.last_name,
        a.prefix,
        a.suffix,
        a.sub_type,
        a.status_code,
        a.year_of_birth,
        a.year_of_death,
        a.gender_code,
        a.teva_specialty_code
 FROM ( SELECT 'PT'::varchar(2) AS dsp_id,
        replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar) AS dsp_hce_id,
        prime_rx.md_first_name AS first_name,
        NULL AS middle_name,
        prime_rx.md_last_name AS last_name,
        NULL AS prefix,
        NULL AS suffix,
        '1'::varchar(50) AS sub_type,
        NULL AS status_code,
        NULL::date AS year_of_birth,
        NULL::date AS year_of_death,
        NULL AS gender_code,
        NULL AS teva_specialty_code
 FROM cleansed.prime_rx
 GROUP BY 'PT'::varchar(2),
          replace(((coalesce(prime_rx.prescriber_npi, ''::varchar) || prime_rx.md_last_name) || prime_rx.md_first_name), ' '::varchar(1), ''::varchar),
          prime_rx.md_first_name,
          NULL,
          prime_rx.md_last_name,
          '1'::varchar(50),
          NULL::date) a
 ORDER BY 1,
          2,
          3;

CREATE  VIEW outbound.sharepoint_roster_to AS
 SELECT sr.title,
        sr.territory
 FROM ( SELECT lower(r.username) AS title,
        r.territory_number AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = 'TO'::varchar(2))) UNION  SELECT lower(r.username) AS title,
        (r.employee_id || '_'::varchar(1)) AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = 'TO'::varchar(2)))) sr
 GROUP BY sr.title,
          sr.territory
 ORDER BY sr.title;

CREATE  VIEW outbound.zs_antimigraine_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_month,
        prescriber_rx.sales_category,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.model,
        prescriber_rx.payment_method
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)) AND ((prescriber_rx.basket_name ~~ 'AIMOVIG%'::varchar(8)) OR (prescriber_rx.basket_name ~~ 'EMGALITY%'::varchar(9)) OR (prescriber_rx.basket_name ~~ 'AJOVY%'::varchar(6))) AND (prescriber_rx.rollup_flag IS NULL))
 ORDER BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.rollup_month,
          prescriber_rx.sales_category,
          prescriber_rx.payer_plan_number;

CREATE  VIEW outbound.asrs_product AS
 SELECT 99 AS product_id,
        b.trans_id AS txn_id,
        CASE WHEN (instr(replace(a.detail_product_id, '  '::varchar(2), ' '::varchar(1)), ' '::varchar(1), 1, 1) = 0) THEN a.detail_product_id ELSE substr(a.detail_product_id, 1, instr(replace(a.detail_product_id, '  '::varchar(2), ' '::varchar(1)), ' '::varchar(1), 1, 1)) END AS product_name,
        NULL AS weight,
        'VEEVA'::varchar(5) AS source_system_description,
        to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)) AS rec_create_Date,
        NULL AS rec_last_update_date,
        NULL AS record_delete_date
 FROM (((( SELECT call.id AS event_id,
        call.detailed_products_vod__c AS detail_product_id,
        call.account_vod__c AS account_id
 FROM veeva.call
 WHERE ((call.call_date_vod__c >= to_date('01/01/2018'::varchar(10), 'mm/dd/yyyy'::varchar(10))) AND (call.id IS NOT NULL) AND (call.detailed_products_vod__c IS NOT NULL))) a JOIN ( SELECT call_sample.id AS trans_id,
        call_sample.call2_vod__c AS event_id,
        call_sample.product_vod__c AS product_id
 FROM veeva.call_sample) b ON ((a.event_id = b.event_id))) JOIN ( SELECT product.id AS product_id
 FROM veeva.product
 WHERE (product.cost_vod__c IS NOT NULL)) c ON ((c.product_id = b.product_id))) JOIN ( SELECT account.id AS account_id
 FROM veeva.account
 WHERE (account.recordtypeid = '012E0000000a8X9IAI'::varchar(18))) d ON ((d.account_id = a.account_id)))
 GROUP BY b.trans_id,
          CASE WHEN (instr(replace(a.detail_product_id, '  '::varchar(2), ' '::varchar(1)), ' '::varchar(1), 1, 1) = 0) THEN a.detail_product_id ELSE substr(a.detail_product_id, 1, instr(replace(a.detail_product_id, '  '::varchar(2), ' '::varchar(1)), ' '::varchar(1), 1, 1)) END,
          NULL,
          'VEEVA'::varchar(5),
          to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10));

CREATE  VIEW outbound.zs_ajovy_activity_sample_request AS
 SELECT sfa_sample.sample_id,
        sfa_sample.call_id,
        sfa_sample.veeva_account_id,
        sfa_sample.ims_id,
        sfa_sample.call_date,
        sfa_sample.sales_force_id,
        sfa_sample.territory_number,
        sfa_sample.call_type,
        sfa_sample.attendee_type,
        sfa_sample.customer_type,
        sfa_sample.sample_type,
        sfa_sample.product_name,
        sfa_sample.sample_name,
        sfa_sample.sample_ndc,
        sfa_sample.basket_id,
        sfa_sample.basket_name,
        sfa_sample.qty,
        sfa_sample.zip_on_call,
        sfa_sample.employee_number,
        sfa_sample.tvcmid
 FROM datamart.sfa_sample
 WHERE ((sfa_sample.basket_name ~~ 'AJOVY%'::varchar(6)) AND (sfa_sample.sample_type = 'REQUEST'::varchar(7)))
 ORDER BY sfa_sample.call_date;

CREATE  VIEW veeva.v_product AS
 SELECT product.id,
        product.ownerid,
        product.isdeleted,
        product.name,
        product.createddate,
        product.createdbyid,
        product.lastmodifieddate,
        product.lastmodifiedbyid,
        product.systemmodstamp,
        product.mayedit,
        product.islocked,
        product.lastvieweddate,
        product.lastreferenceddate,
        product.consumer_site__c,
        product.product_info__c,
        product.therapeutic_class_vod__c,
        product.parent_product_vod__c,
        product.therapeutic_area_vod__c,
        product.product_type_vod__c,
        product.require_key_message_vod__c,
        product.cost_vod__c,
        product.external_id_vod__c,
        product.manufacturer_vod__c,
        product.company_product_vod__c,
        product.controlled_substance_vod__c,
        product.description_vod__c,
        product.sample_quantity_picklist_vod__,
        product.display_order_vod__c,
        product.no_metrics_vod__c,
        product.distributor_vod__c,
        product.sample_quantity_bound_vod__c,
        product.sample_u_m_vod__c,
        product.no_details_vod__c,
        product.quantity_per_case_vod__c,
        product.schedule_vod__c,
        product.restricted_vod__c,
        product.pricing_rule_quantity_bound_vo,
        product.no_promo_items_vod__c,
        product.user_aligned_vod__c,
        product.restricted_states_vod__c,
        product.sort_code_vod__c,
        product.no_cycle_plans_vod__c,
        product.inventory_order_uom_vod__c,
        product.inventory_quantity_per_case_vo,
        product.sub_type__c,
        product.organization__c,
        product.product_id_teva__c,
        product.product_line_tva__c,
        product.file_id,
        product.record_id,
        product.vexternal_id_vod__c,
        product.product_value_vod__c,
        product.encrypt_veeva_external_id_tva__c,
        product.available_qty_tva__c,
        product.expiration_date_tva__c
 FROM veeva.product
 WHERE (product.file_id = ( SELECT max(product.file_id) AS max
 FROM veeva.product));

CREATE  VIEW outbound.asrs_fact AS
 SELECT b.trans_id,
        b.trans_date AS trans_Date,
        a.event_id,
        a.event_date,
        'Educational Items'::varchar(17) AS expense_Type_cd,
        'Educational Items'::varchar(17) AS spend_type_cd,
        'N'::varchar(1) AS identified_attendee_ind,
        NULL AS event_level1_cd,
        round((b.quantity * c.product_value), 2) AS total_expense_amount,
        'VEEVA'::varchar(5) AS source_system_description,
        to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)) AS rec_create_Date,
        NULL AS rec_last_update_date,
        NULL AS record_delete_date,
        NULL AS corpt_ds
 FROM (((( SELECT sfa_call.call_id AS event_id,
        to_char(sfa_call.call_date, 'yyyy-mm-dd'::varchar(10)) AS event_date,
        sfa_call.veeva_account_id AS account_id
 FROM datamart.sfa_call
 WHERE ((sfa_call.call_date >= to_date('01/01/2018'::varchar(10), 'mm/dd/yyyy'::varchar(10))) AND (sfa_call.call_id IS NOT NULL))
 GROUP BY sfa_call.call_id,
          to_char(sfa_call.call_date, 'yyyy-mm-dd'::varchar(10)),
          sfa_call.veeva_account_id) a JOIN ( SELECT sfa_reprints.veeva_sample_id AS trans_id,
        to_char(sfa_reprints.distribution_date, 'yyyy-mm-dd'::varchar(10)) AS trans_date,
        sfa_reprints.quantity,
        sfa_reprints.call_id AS event_id,
        sfa_reprints.reprint_id AS product_id
 FROM datamart.sfa_reprints) b ON ((a.event_id = b.event_id))) JOIN ( SELECT v_product.external_id_vod__c AS product_id,
        v_product.product_value_vod__c AS product_value
 FROM veeva.v_product
 WHERE (v_product.cost_vod__c IS NOT NULL)) c ON ((b.product_id = c.product_id))) JOIN ( SELECT v_account.id AS account_id
 FROM veeva.v_account
 WHERE (v_account.recordtypeid = '012E0000000a8X9IAI'::varchar(18))) d ON ((d.account_id = a.account_id)))
 GROUP BY b.trans_id,
          b.trans_date,
          a.event_id,
          a.event_date,
          'Educational Items'::varchar(17),
          'N'::varchar(1),
          NULL,
          round((b.quantity * c.product_value), 2),
          'VEEVA'::varchar(5),
          to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10));

CREATE  VIEW outbound.asrs_attendee AS
 SELECT b.trans_id AS txn_id,
        a.event_id,
        NULL AS address_id,
        c.attendee_id,
        NULL AS pfsnl_desgn,
        'N'::varchar(1) AS emp_ind,
        'N'::varchar(1) AS spk_ind,
        'VEEVA'::varchar(5) AS source_system_description,
        to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)) AS rec_create_Date,
        NULL AS rec_last_update_date,
        NULL AS record_delete_date,
        'TVCMID'::varchar(6) AS cust_src_system_description
 FROM (((( SELECT sfa_call.call_id AS event_id,
        sfa_call.veeva_account_id AS account_id
 FROM datamart.sfa_call
 WHERE ((sfa_call.call_date >= to_date('01/01/2018'::varchar(10), 'mm/dd/yyyy'::varchar(10))) AND (sfa_call.call_id IS NOT NULL))) a JOIN ( SELECT sfa_reprints.veeva_sample_id AS trans_id,
        sfa_reprints.call_id AS event_id,
        sfa_reprints.reprint_id AS product_id
 FROM datamart.sfa_reprints) b ON ((a.event_id = b.event_id))) JOIN ( SELECT v_account.cm_id_tva__c AS attendee_id,
        v_account.id AS account_id
 FROM veeva.v_account
 WHERE (v_account.recordtypeid = '012E0000000a8X9IAI'::varchar(18))) c ON ((a.account_id = c.account_id))) JOIN ( SELECT v_product.external_id_vod__c AS product_id
 FROM veeva.v_product
 WHERE (v_product.cost_vod__c IS NOT NULL)) d ON ((b.product_id = d.product_id)))
 GROUP BY b.trans_id,
          a.event_id,
          NULL,
          c.attendee_id,
          'N'::varchar(1),
          'VEEVA'::varchar(5),
          to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)),
          'TVCMID'::varchar(6);

CREATE  VIEW outbound.connectiverx_ajovy_demographics AS
 SELECT a.sales_force_id,
        a.ptr_territory_num AS terr,
        b.reg,
        b.area,
        a.ims_id,
        a.npi,
        a.first_name,
        a.last_name,
        a.ptr_city,
        a.ptr_state,
        a.ptr_zip,
        a.specialty
 FROM datamart.prescriber_combined_demographics a, ( SELECT a.geography_number AS terr,
        b.geography_number AS reg,
        c.geography_number AS area
 FROM datamart.sales_geography a, datamart.sales_geography b, datamart.sales_geography c
 WHERE ((a.parent_geography_number = b.geography_number) AND (b.parent_geography_number = c.geography_number) AND (a.geography_type = 'Territory'::varchar(9)) AND (b.geography_type = 'Region'::varchar(6)) AND (c.geography_type = 'Area'::varchar(4)) AND (a.sales_force_id = ANY (ARRAY['TR'::varchar(2), 'TN'::varchar(2), 'TE'::varchar(2)])))
 GROUP BY a.geography_number,
          b.geography_number,
          c.geography_number) b
 WHERE ((a.ptr_territory_num = b.terr) AND (a.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TR'::varchar(2), 'TE'::varchar(2)])))
 GROUP BY a.sales_force_id,
          a.ptr_territory_num,
          b.reg,
          b.area,
          a.ims_id,
          a.npi,
          a.first_name,
          a.last_name,
          a.ptr_city,
          a.ptr_state,
          a.ptr_zip,
          a.specialty
 ORDER BY a.sales_force_id,
          a.ims_id;

CREATE  VIEW outbound.aptus_hcp_ajovy AS
 SELECT p.territory_number,
        p.tvcmid,
        d.last_name,
        d.first_name,
        d.credentials AS professional_designation,
        CASE WHEN (d.address_line1 ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.address_line1) || '"'::varchar(1)) ELSE d.address_line1 END AS address_line1,
        CASE WHEN (d.address_line2 ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.address_line2) || '"'::varchar(1)) ELSE d.address_line2 END AS address_line2,
        CASE WHEN (d.city ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.city) || '"'::varchar(1)) ELSE d.city END AS city,
        d.state,
        d.zip
 FROM (datamart.sfa_promotional_items p JOIN datamart.sfa_demographics d ON (((p.veeva_account_id = d.veeva_account_id) AND (p.territory_number = d.territory_number))))
 WHERE ((p.item_name ~~ 'FRE-40475%'::varchar(10)) AND (p.tvcmid IS NOT NULL))
 GROUP BY p.territory_number,
          p.tvcmid,
          d.last_name,
          d.first_name,
          d.credentials,
          CASE WHEN (d.address_line1 ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.address_line1) || '"'::varchar(1)) ELSE d.address_line1 END,
          CASE WHEN (d.address_line2 ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.address_line2) || '"'::varchar(1)) ELSE d.address_line2 END,
          CASE WHEN (d.city ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || d.city) || '"'::varchar(1)) ELSE d.city END,
          d.state,
          d.zip
 ORDER BY d.last_name,
          d.first_name;

CREATE  VIEW outbound.mcm_hcp_segmentation AS
 SELECT y.federation_id,
        y.tvcmid,
        y.veeva_account_id,
        y.npi,
        y.ims_id,
        y.me_number,
        y.first_name,
        y.last_name,
        y.middle_name,
        y.personal_suffix,
        y.medical_suffix,
        y.address_line_1,
        y.address_line_2,
        y.city,
        y.state,
        y.zip_code,
        y.state_license_state,
        y.state_license_number,
        y.state_license_expiration_date,
        y.sample_eligibility_code,
        y.primary_specialty_code,
        y.primary_specialty_description,
        y.primary_specialty_group_code,
        y.np_pa_flag,
        y.created_date
 FROM ( SELECT rank() OVER (PARTITION BY x.tvcmid ORDER BY x.veeva_account_id DESC, x.me_number DESC, x.state_license_number DESC, x.npi DESC) AS rank,
        x.federation_id,
        x.tvcmid,
        x.veeva_account_id,
        x.npi,
        x.ims_id,
        x.me_number,
        x.first_name,
        x.last_name,
        x.middle_name,
        x.personal_suffix,
        x.medical_suffix,
        x.address_line_1,
        x.address_line_2,
        x.city,
        x.state,
        x.zip_code,
        x.zip_code_extension,
        x.state_license_state,
        x.state_license_number,
        x.state_license_expiration_date,
        x.sample_eligibility_code,
        x.primary_specialty_code,
        x.primary_specialty_description,
        x.primary_specialty_group_code,
        x.primary_specialty_group_description,
        x.np_pa_flag,
        x.created_date
 FROM ( SELECT cmid.id_num AS federation_id,
        pcd.tvcmid,
        pcd.veeva_account_id,
        CASE WHEN (chd.tvcmid IS NULL) THEN pcd.npi ELSE chd.npi END AS npi,
        CASE WHEN (chd.tvcmid IS NULL) THEN pcd.ims_id ELSE chd.ims_id END AS ims_id,
        hcos.me AS me_number,
        CASE WHEN (chd.tvcmid IS NULL) THEN pcd.first_name ELSE chd.first_name END AS first_name,
        CASE WHEN (chd.tvcmid IS NULL) THEN pcd.last_name ELSE chd.last_name END AS last_name,
        CASE WHEN (chd.tvcmid IS NULL) THEN pcd.middle_name ELSE chd.middle_name END AS middle_name,
        chd.personal_suffix,
        chd.medical_suffix,
        chd.address_line1 AS address_line_1,
        chd.address_line2 AS address_line_2,
        chd.city,
        chd.state_code AS state,
        chd.zip AS zip_code,
        NULL AS zip_code_extension,
        se.sln_state AS state_license_state,
        se.sln AS state_license_number,
        se.sln_expiration_date AS state_license_expiration_date,
        se.teva_sample_eligibility_flag AS sample_eligibility_code,
        chd.primary_specialty AS primary_specialty_code,
        spec.Specialty_Description AS primary_specialty_description,
        NULL AS primary_specialty_group_code,
        NULL AS primary_specialty_group_description,
        chd.np_pa_flag,
        (now())::date AS created_date
 FROM (((((datamart.prescriber_combined_demographics pcd LEFT  JOIN datamart.customer_hcp_demographics chd ON ((pcd.tvcmid = chd.tvcmid))) JOIN datamart.tvcmid_xref cmid ON (((pcd.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN hcos.ims_hcos_professional hcos ON ((hcos.ims_id = pcd.ims_id))) LEFT  JOIN mdm.sample_eligibility se ON (((se.tvcmid = pcd.tvcmid) AND (upper(se.sln_state) = upper(chd.state_code))))) LEFT  JOIN reference.specialties spec ON ((spec.Specialty_Code = chd.primary_specialty)))
 GROUP BY cmid.id_num,
          pcd.tvcmid,
          pcd.veeva_account_id,
          CASE WHEN (chd.tvcmid IS NULL) THEN pcd.npi ELSE chd.npi END,
          CASE WHEN (chd.tvcmid IS NULL) THEN pcd.ims_id ELSE chd.ims_id END,
          hcos.me,
          CASE WHEN (chd.tvcmid IS NULL) THEN pcd.first_name ELSE chd.first_name END,
          CASE WHEN (chd.tvcmid IS NULL) THEN pcd.last_name ELSE chd.last_name END,
          CASE WHEN (chd.tvcmid IS NULL) THEN pcd.middle_name ELSE chd.middle_name END,
          chd.personal_suffix,
          chd.medical_suffix,
          chd.address_line1,
          chd.address_line2,
          chd.city,
          chd.state_code,
          chd.zip,
          NULL,
          se.sln_state,
          se.sln,
          se.sln_expiration_date,
          se.teva_sample_eligibility_flag,
          chd.primary_specialty,
          spec.Specialty_Description,
          chd.np_pa_flag,
          (now())::date) x) y
 WHERE (y.rank = 1);

CREATE  VIEW outbound.ics_mop AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.payment_method,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.payment_method,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT row_number() OVER (ORDER BY z.rollup_month DESC) AS month_bucket,
        z.rollup_month
 FROM ( SELECT prescriber_rx.rollup_month
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY prescriber_rx.rollup_month) z) w ON ((rx.rollup_month = w.rollup_month))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.payment_method,
          rx_vertical.basket_name;

CREATE  VIEW outbound.fingertip_monthly_plantrak_rx AS
 SELECT substr(rx.payer_plan_number, ((length(rx.payer_plan_number) - 4) + 1), 4) AS plan_id,
        rx.plan_name,
        substr(rx.payer_plan_number, 1, 6) AS payer_id,
        rx.payer_name,
        rx.market_name,
        rx.basket_name,
        d.ptr_zip,
        to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS rollup_month,
        round(sum((rx.trx_count / d.divisor)), 3) AS trx,
        round(sum((rx.nrx_count / d.divisor)), 3) AS nrx
 FROM (((( SELECT a.market_name,
        a.report_frequency,
        a.data_date
 FROM ( SELECT market_frequency.market_name,
        market_frequency.report_frequency,
        market_frequency.data_date,
        row_number() OVER (PARTITION BY market_frequency.market_name ORDER BY market_frequency.report_frequency DESC) AS rnk
 FROM ( SELECT prescriber_rx.market_name,
        prescriber_rx.report_frequency,
        prescriber_rx.data_date
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.payer_plan_number IS NOT NULL) AND (prescriber_rx.rollup_flag IS NULL) AND (((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.data_date >= (trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)) + '-3'::interval month))) OR ((prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.data_date >= (trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)) + '-1'::interval month)))))
 GROUP BY prescriber_rx.market_name,
          prescriber_rx.report_frequency,
          prescriber_rx.data_date) market_frequency) a
 WHERE (a.rnk = 1)) mte JOIN datamart.prescriber_rx rx ON (((mte.market_name = rx.market_name) AND (mte.report_frequency = rx.report_frequency) AND (mte.data_date = rx.data_date)))) JOIN ( SELECT a.ims_id,
        a.ptr_zip,
        count(*) OVER (PARTITION BY a.ims_id) AS divisor
 FROM ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.ptr_zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)]))
 GROUP BY prescriber_combined_demographics.ims_id,
          prescriber_combined_demographics.ptr_zip) a) d ON ((rx.ims_id = d.ims_id))) CROSS  JOIN ( SELECT (trunc(max(markets_to_extract.data_date), 'MON'::varchar(3)) + '-23'::interval month) AS start_month,
        max(markets_to_extract.data_date) AS end_month
 FROM ( SELECT a.market_name,
        a.report_frequency,
        a.data_date
 FROM ( SELECT market_frequency.market_name,
        market_frequency.report_frequency,
        market_frequency.data_date,
        row_number() OVER (PARTITION BY market_frequency.market_name ORDER BY market_frequency.report_frequency DESC) AS rnk
 FROM ( SELECT prescriber_rx.market_name,
        prescriber_rx.report_frequency,
        prescriber_rx.data_date
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.payer_plan_number IS NOT NULL) AND (prescriber_rx.rollup_flag IS NULL) AND (((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.data_date >= (trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)) + '-3'::interval month))) OR ((prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.data_date >= (trunc((statement_timestamp())::timestamp, 'MON'::varchar(3)) + '-1'::interval month)))))
 GROUP BY prescriber_rx.market_name,
          prescriber_rx.report_frequency,
          prescriber_rx.data_date) market_frequency) a
 WHERE (a.rnk = 1)) markets_to_extract
 WHERE (markets_to_extract.report_frequency = 'MONTH'::varchar(5))) dr)
 WHERE ((rx.rollup_flag IS NULL) AND (rx.rollup_month >= dr.start_month) AND (rx.rollup_month <= dr.end_month))
 GROUP BY substr(rx.payer_plan_number, ((length(rx.payer_plan_number) - 4) + 1), 4),
          rx.plan_name,
          substr(rx.payer_plan_number, 1, 6),
          rx.payer_name,
          rx.market_name,
          rx.basket_name,
          d.ptr_zip,
          to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10));

CREATE  VIEW outbound.stride_segmentation AS
 SELECT hcp.ims_id,
        hcp.npi,
        hcp.tvcmid,
        hcp.first_name,
        hcp.middle_name,
        hcp.last_name,
        hcp.primary_specialty,
        'specialty_grp_AJOVY'::varchar(19) AS specialty_group_ajovy,
        hcp.address_line1,
        hcp.address_line2,
        hcp.city,
        hcp.state_code,
        hcp.zip,
        flags.ajovy_tier,
        CASE WHEN (callplan.tvcmid IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS target,
        calls.ltdcalls AS ajovy_details_ltd,
        dec.trx_ACGRP_dec,
        dec.trx_AIMOVIG_dec,
        dec.trx_AJOVY_dec,
        dec.trx_EMGALITY_dec,
        flags.ha_specialist_flag,
        flags.exclude_flag
 FROM ((((datamart.customer_hcp_demographics hcp LEFT  JOIN ( SELECT call_plan.tvcmid
 FROM datamart.call_plan
 WHERE (call_plan.basket_name = 'AJOVY'::varchar(5))
 GROUP BY call_plan.tvcmid) callplan ON ((hcp.tvcmid = callplan.tvcmid))) LEFT  JOIN ( SELECT sfa.tvcmid,
        count(*) AS ltdcalls
 FROM (datamart.sfa_call sfa LEFT  JOIN datamart.sfa_call_detail sfadetail ON (((sfa.call_id = sfadetail.call_id) AND (sfadetail.basket_name = 'AJOVY'::varchar(5)))))
 GROUP BY sfa.tvcmid) calls ON ((hcp.tvcmid = calls.tvcmid))) LEFT  JOIN ( SELECT rx_deciles.tvcmid,
        max(CASE WHEN (rx_deciles.basket_name = 'ANTI-CGRP'::varchar(9)) THEN rx_deciles.trx_count_12_mo ELSE NULL::float END) AS trx_ACGRP_dec,
        max(CASE WHEN (rx_deciles.basket_name = 'AIMOVIG'::varchar(7)) THEN rx_deciles.trx_count_12_mo ELSE NULL::float END) AS trx_AIMOVIG_dec,
        max(CASE WHEN (rx_deciles.basket_name = 'AJOVY'::varchar(5)) THEN rx_deciles.trx_count_12_mo ELSE NULL::float END) AS trx_AJOVY_dec,
        max(CASE WHEN (rx_deciles.basket_name = 'EMGALITY'::varchar(8)) THEN rx_deciles.trx_count_12_mo ELSE NULL::float END) AS trx_EMGALITY_dec
 FROM datamart.rx_deciles
 GROUP BY rx_deciles.tvcmid
 ORDER BY rx_deciles.tvcmid) dec ON ((hcp.tvcmid = dec.tvcmid))) LEFT  JOIN ( SELECT customer_level_flags.tvcmid,
        max(CASE WHEN (customer_level_flags.flag_type = 'MIGRAINE_TIER'::varchar(13)) THEN customer_level_flags.flag_value ELSE NULL END) AS ajovy_tier,
        max(CASE WHEN (customer_level_flags.flag_type = 'HEADACHE_SPECIALIST'::varchar(19)) THEN customer_level_flags.flag_value ELSE NULL END) AS ha_specialist_flag,
        max(CASE WHEN (customer_level_flags.flag_type = 'AMADNC'::varchar(6)) THEN customer_level_flags.flag_value ELSE NULL END) AS exclude_flag
 FROM datamart.customer_level_flags
 WHERE (customer_level_flags.flag_type = ANY (ARRAY['MIGRAINE_TIER'::varchar(19), 'HEADACHE_SPECIALIST'::varchar(19), 'AMADNC'::varchar(19)]))
 GROUP BY customer_level_flags.tvcmid
 ORDER BY customer_level_flags.tvcmid) flags ON ((hcp.tvcmid = flags.tvcmid)));

CREATE  VIEW teva_ingestion.EXT_FTF_RESTRICTIONS_V2 AS
 SELECT btrim(EXT_FTF_RESTRICTIONS_V2_src.health_plan_id) AS health_plan_id,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.drug_id) AS drug_id,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.restriction_code) AS restriction_code,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.restriction_detail_id) AS restriction_detail_id,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.restriction_detail_text) AS restriction_detail_text,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.restriction_addtnl_information_1) AS restriction_addtnl_information_1,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.restriction_addtnl_information_2) AS restriction_addtnl_information_2,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.step_count) AS step_count,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.pa_form) AS pa_form,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.indication) AS indication,
        btrim(EXT_FTF_RESTRICTIONS_V2_src.grouped_restriction_level) AS grouped_restriction_level,
        EXT_FTF_RESTRICTIONS_V2_src.batch_id,
        EXT_FTF_RESTRICTIONS_V2_src.row_id,
        EXT_FTF_RESTRICTIONS_V2_src.update_ts
 FROM teva_ingestion.EXT_FTF_RESTRICTIONS_V2_src;

CREATE  VIEW raw.ext_ftf_restrictions_v2 AS
 SELECT src.health_plan_id,
        src.drug_id,
        src.restriction_code,
        src.restriction_detail_id,
        src.restriction_detail_text,
        src.restriction_addtnl_information_1,
        src.restriction_addtnl_information_2,
        src.step_count,
        src.pa_form,
        src.indication,
        src.grouped_restriction_level,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_RESTRICTIONS_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_RESTRICTIONS_V2'::varchar(23)))));

CREATE  VIEW outbound.mcm_ajovy_copay AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.pharmacy_chain_number,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.create_date,
        copay.occ_payment_type,
        copay.counted_copay,
        copay.auth_refills,
        copay.admin_hcp_npi,
        copay.admin_hcp_name,
        copay.admin_hcp_address,
        copay.admin_hcp_address2,
        copay.admin_hcp_city,
        copay.admin_hcp_state,
        copay.admin_hcp_zip,
        copay.claim_type,
        copay.administration_flag,
        copay.soc_name,
        copay.soc_phone,
        copay.soc_fax,
        copay.soc_address,
        copay.soc_city,
        copay.soc_state,
        copay.soc_zip,
        copay.soc_id,
        copay.soc_npi,
        copay.payer_name,
        copay.cpt_code,
        copay.trans_type,
        copay.previous_payer_id,
        copay.member_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.report_frequency,
        copay.source_name,
        copay.file_id,
        copay.record_id,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay
 WHERE (copay.basket_name ~~ 'AJOVY%'::varchar(6))
 ORDER BY copay.fill_date;

CREATE  VIEW outbound.zs_xpd_demographics_antimigraine_monthly AS
 SELECT xpd_demographics_antimigraine.ims_client_number,
        xpd_demographics_antimigraine.ims_report_number,
        xpd_demographics_antimigraine.ims_id,
        xpd_demographics_antimigraine.tvcmid,
        xpd_demographics_antimigraine.last_name,
        xpd_demographics_antimigraine.first_name,
        xpd_demographics_antimigraine.middle_name,
        xpd_demographics_antimigraine.address_1,
        xpd_demographics_antimigraine.address_2,
        xpd_demographics_antimigraine.city,
        xpd_demographics_antimigraine.state,
        xpd_demographics_antimigraine.zip,
        xpd_demographics_antimigraine.specialty,
        xpd_demographics_antimigraine.specialty_description,
        xpd_demographics_antimigraine.trx_decile_retail,
        xpd_demographics_antimigraine.nrx_decile_retail,
        xpd_demographics_antimigraine.nbrx_decile_retail,
        xpd_demographics_antimigraine.trx_decile_mail,
        xpd_demographics_antimigraine.nrx_decile_mail,
        xpd_demographics_antimigraine.nbrx_decile_mail,
        xpd_demographics_antimigraine.market_prescriber_reliability_retail,
        xpd_demographics_antimigraine.market_prescriber_reliability_mail,
        xpd_demographics_antimigraine.report_frequency
 FROM datamart.xpd_demographics_antimigraine
 WHERE (xpd_demographics_antimigraine.report_frequency = 'MONTH'::varchar(5));

CREATE  VIEW outbound.zs_cgrp_accute_preventive_monthly AS
 SELECT rx.ims_id,
        'ACGRP_ACUTE_PREVENTIVE_ZS'::varchar(25) AS sub_market,
        rx.payer_plan_number,
        rx.plan_name,
        rx.payer_name,
        rx.pbm_name,
        sum(rx.trx_count) AS Sum_trx_cnt,
        sum(rx.nrx_count) AS Sum_nrx_cnt,
        sum(rx.trx_quantity) AS Sum_trx_qty,
        sum(rx.nrx_quantity) AS Sum_nrx_qty,
        rx.rollup_month
 FROM datamart.prescriber_rx rx, product.basket b, product.basket_item bi, outbound.month_rollup_and_bucket mth
 WHERE ((rx.report_frequency = 'MONTH'::varchar(5)) AND (rx.rollup_month = mth.month_ending) AND (mth.month_bucket <= 12) AND (bi.basket_id = ( SELECT basket.basket_id
 FROM product.basket
 WHERE ((basket.name = 'ACGRP_ACUTE_PREVENTIVE_ZS'::varchar(25)) AND (basket.basket_type = 'submarket'::varchar(9))))) AND (b.basket_id = bi.entity_id) AND (rx.basket_id = bi.entity_id))
 GROUP BY rx.report_frequency,
          rx.pbm_name,
          rx.payer_name,
          rx.plan_name,
          rx.payer_plan_number,
          rx.ims_id,
          rx.data_date,
          rx.rollup_month
 ORDER BY rx.ims_id,
          rx.rollup_month;

CREATE  VIEW outbound.zs_acutemigraine_managed_care AS
 SELECT a.ims_id,
        a.payer_plan_number,
        a.payment_method,
        a.pbm_name,
        a.payer_name,
        a.plan_name,
        b.product_group,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), 0)) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx1,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-1))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx2,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-2))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx3,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-3))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx4,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-4))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx5,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-5))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx6,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-6))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx7,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-7))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx8,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-8))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx9,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-9))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx10,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-10))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx11,
        sum(CASE WHEN (a.date = add_months(last_day(a.data_date), (-11))) THEN a.trx_count ELSE 0::numeric(18,0) END) AS trx12
 FROM datamart.prescriber_rx a, reference.acute_market_definition b
 WHERE ((a.basket_id = b.bfs_id) AND (a.report_frequency = 'MONTH'::varchar(5)) AND (a.rollup_month >= add_months(last_day(a.data_date), (-11))) AND (a.rollup_month <= add_months(last_day(a.data_date), 0)) AND (a.basket_type = 'product'::varchar(7)))
 GROUP BY a.ims_id,
          a.payer_plan_number,
          a.payment_method,
          a.pbm_name,
          a.payer_name,
          a.plan_name,
          b.product_group
 ORDER BY a.ims_id,
          a.payer_plan_number,
          a.payment_method,
          a.pbm_name,
          a.payer_name,
          a.plan_name,
          b.product_group;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_PROVIDER_V2 AS
 SELECT btrim(EXT_IMS_FIA_PROVIDER_V2_src.PROVIDER_ID) AS PROVIDER_ID,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.PROVIDER_TYPE) AS PROVIDER_TYPE,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.IQVIA_RXER_ID) AS IQVIA_RXER_ID,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.PRIMARY_SPECIALTY_CODE) AS PRIMARY_SPECIALTY_CODE,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.PRIMARY_SPECIALTY_DESC) AS PRIMARY_SPECIALTY_DESC,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.ORG_NM) AS ORG_NM,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.ADDRESS) AS ADDRESS,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.CITY) AS CITY,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.ZIP_CODE) AS ZIP_CODE,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.STATE_CODE) AS STATE_CODE,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.PHONE_NUMBER) AS PHONE_NUMBER,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.DEA_NUMBER) AS DEA_NUMBER,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.ME_NUMBER) AS ME_NUMBER,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.FLEXIBLE_FLD_1_CHAR) AS FLEXIBLE_FLD_1_CHAR,
        btrim(EXT_IMS_FIA_PROVIDER_V2_src.FLEXIBLE_FLD_2_CHAR) AS FLEXIBLE_FLD_2_CHAR,
        EXT_IMS_FIA_PROVIDER_V2_src.batch_id,
        EXT_IMS_FIA_PROVIDER_V2_src.row_id,
        EXT_IMS_FIA_PROVIDER_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_PROVIDER_V2_src;

CREATE  VIEW raw.ext_ims_fia_provider_v2 AS
 SELECT src.PROVIDER_ID,
        src.PROVIDER_TYPE,
        src.IQVIA_RXER_ID,
        src.PRIMARY_SPECIALTY_CODE,
        src.PRIMARY_SPECIALTY_DESC,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.ORG_NM,
        src.ADDRESS,
        src.CITY,
        src.ZIP_CODE,
        src.STATE_CODE,
        src.PHONE_NUMBER,
        src.DEA_NUMBER,
        src.ME_NUMBER,
        src.FLEXIBLE_FLD_1_CHAR,
        src.FLEXIBLE_FLD_2_CHAR,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_PROVIDER_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_PROVIDER_V2'::varchar(23)))));

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TS AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TS_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        btrim(EXT_ZS_CALL_PLAN_TS_src.TVCMID) AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TS_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TS_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TS_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TS_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TS_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TS_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TS_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TS_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TS_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TS_src.PRODUCT_NAME) AS PRODUCT_NAME,
        btrim(EXT_ZS_CALL_PLAN_TS_src.P1) AS P1,
        btrim(EXT_ZS_CALL_PLAN_TS_src.P2) AS P2,
        btrim(EXT_ZS_CALL_PLAN_TS_src.P3) AS P3,
        btrim(EXT_ZS_CALL_PLAN_TS_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TS_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TS_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TS_src.batch_id,
        EXT_ZS_CALL_PLAN_TS_src.row_id,
        EXT_ZS_CALL_PLAN_TS_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TS_src;

CREATE  VIEW raw.ext_zs_call_plan_ts AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TS'::varchar(19)))));

CREATE  VIEW outbound.CobbsCreek_austedo_xpo_rx_pt_monthly AS
 SELECT customer_hcp_demographics.ims_id AS demo_ims_id,
        prescriber_rx.ims_id AS rx_ims_id,
        prescriber_rx.payer_plan_number,
        prescriber_rx.ims_client_number,
        prescriber_rx.report_frequency,
        prescriber_rx.ims_product_group,
        prescriber_rx.basket_id,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.sales_category,
        prescriber_rx.tvcmid AS rx_tvmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.model,
        prescriber_rx.payment_method,
        prescriber_rx.ims_specialty,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.ims_report_number_cnt,
        prescriber_rx.cnt_file_id,
        prescriber_rx.cnt_record_id,
        prescriber_rx.ims_report_number_qty,
        prescriber_rx.qty_file_id,
        prescriber_rx.qty_record_id,
        prescriber_rx.rollup_flag,
        prescriber_rx.indication,
        prescriber_rx.pbm_parent_name,
        customer_hcp_demographics.tvcmid AS demo_tvcmid,
        customer_hcp_demographics.npi,
        customer_hcp_demographics.last_name,
        customer_hcp_demographics.first_name,
        customer_hcp_demographics.middle_name,
        customer_hcp_demographics.personal_suffix,
        customer_hcp_demographics.medical_suffix,
        customer_hcp_demographics.primary_specialty,
        customer_hcp_demographics.secondary_specialty,
        customer_hcp_demographics.address_line1,
        customer_hcp_demographics.address_line2,
        customer_hcp_demographics.city,
        customer_hcp_demographics.state_code,
        customer_hcp_demographics.zip,
        customer_hcp_demographics.business_phone,
        customer_hcp_demographics.business_email,
        customer_hcp_demographics.hce_status_desc,
        customer_hcp_demographics.np_pa_flag,
        customer_hcp_demographics.address_id,
        customer_hcp_demographics.address_latitude,
        customer_hcp_demographics.address_longitude,
        customer_hcp_demographics.file_id,
        customer_hcp_demographics.record_id
 FROM (datamart.customer_hcp_demographics customer_hcp_demographics RIGHT  JOIN datamart.prescriber_rx prescriber_rx ON ((customer_hcp_demographics.ims_id = prescriber_rx.ims_id)))
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = 'MOVEMENT DISORDER MARKET'::varchar(24)) AND (prescriber_rx.basket_type = 'product'::varchar(7)))
 GROUP BY customer_hcp_demographics.ims_id,
          prescriber_rx.ims_id,
          prescriber_rx.payer_plan_number,
          prescriber_rx.ims_client_number,
          prescriber_rx.report_frequency,
          prescriber_rx.ims_product_group,
          prescriber_rx.basket_id,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.sales_category,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.model,
          prescriber_rx.payment_method,
          prescriber_rx.ims_specialty,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.ims_report_number_cnt,
          prescriber_rx.cnt_file_id,
          prescriber_rx.cnt_record_id,
          prescriber_rx.ims_report_number_qty,
          prescriber_rx.qty_file_id,
          prescriber_rx.qty_record_id,
          prescriber_rx.rollup_flag,
          prescriber_rx.indication,
          prescriber_rx.pbm_parent_name,
          customer_hcp_demographics.tvcmid,
          customer_hcp_demographics.npi,
          customer_hcp_demographics.last_name,
          customer_hcp_demographics.first_name,
          customer_hcp_demographics.middle_name,
          customer_hcp_demographics.personal_suffix,
          customer_hcp_demographics.medical_suffix,
          customer_hcp_demographics.primary_specialty,
          customer_hcp_demographics.secondary_specialty,
          customer_hcp_demographics.address_line1,
          customer_hcp_demographics.address_line2,
          customer_hcp_demographics.city,
          customer_hcp_demographics.state_code,
          customer_hcp_demographics.zip,
          customer_hcp_demographics.business_phone,
          customer_hcp_demographics.business_email,
          customer_hcp_demographics.hce_status_desc,
          customer_hcp_demographics.np_pa_flag,
          customer_hcp_demographics.address_id,
          customer_hcp_demographics.address_latitude,
          customer_hcp_demographics.address_longitude,
          customer_hcp_demographics.file_id,
          customer_hcp_demographics.record_id
 ORDER BY customer_hcp_demographics.ims_id;

CREATE  VIEW outbound.CobbsCreek_Austedo_867_Monthly AS
 SELECT wholesaler_sales_867.basket_id,
        wholesaler_sales_867.basket_name,
        wholesaler_sales_867.ndc,
        wholesaler_sales_867.product_description,
        wholesaler_sales_867.product_name,
        wholesaler_sales_867.trading_partner_name,
        wholesaler_sales_867.trading_partner_dea,
        wholesaler_sales_867.trading_partner_hin,
        wholesaler_sales_867.trading_partner_location_type,
        wholesaler_sales_867.trading_partner_dc_dea,
        wholesaler_sales_867.trading_partner_dc_hin,
        wholesaler_sales_867.trading_partner_dc_name,
        wholesaler_sales_867.trading_partner_dc_address,
        wholesaler_sales_867.trading_partner_dc_address_2,
        wholesaler_sales_867.trading_partner_dc_city,
        wholesaler_sales_867.trading_partner_dc_state,
        wholesaler_sales_867.trading_partner_dc_zip,
        wholesaler_sales_867.class_of_trade,
        wholesaler_sales_867.outlet_location_name,
        wholesaler_sales_867.outlet_dea,
        wholesaler_sales_867.outlet_hin,
        wholesaler_sales_867.outlet_340b,
        wholesaler_sales_867.outlet_ncpdp,
        wholesaler_sales_867.outlet_npi,
        wholesaler_sales_867.outlet_location_address,
        wholesaler_sales_867.outlet_location_address_2,
        wholesaler_sales_867.outlet_location_city,
        wholesaler_sales_867.outlet_location_state,
        wholesaler_sales_867.outlet_location_zip,
        wholesaler_sales_867.reporting_date,
        wholesaler_sales_867.rollup_reporting_month,
        wholesaler_sales_867.rollup_reporting_quarter,
        wholesaler_sales_867.contract_number,
        wholesaler_sales_867.contract_description,
        wholesaler_sales_867.invoice_number,
        wholesaler_sales_867.invoice_date,
        wholesaler_sales_867.invoice_line_id,
        wholesaler_sales_867.quanitity_stock_sales_ss,
        wholesaler_sales_867.ds_sales_ds,
        wholesaler_sales_867.summary_sales_su,
        wholesaler_sales_867.dock_to_dock_bq,
        wholesaler_sales_867.interbranch_ib,
        wholesaler_sales_867.return_to_useable_ru,
        wholesaler_sales_867.return_to_vendor_rv,
        wholesaler_sales_867.transfer_to_disposal_td,
        wholesaler_sales_867.adjusted_price,
        wholesaler_sales_867.gross_amount,
        wholesaler_sales_867.trx_count_normalized,
        wholesaler_sales_867.file_id
 FROM datamart.wholesaler_sales_867 wholesaler_sales_867
 WHERE ((wholesaler_sales_867.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (wholesaler_sales_867.reporting_date >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))
 GROUP BY wholesaler_sales_867.basket_id,
          wholesaler_sales_867.basket_name,
          wholesaler_sales_867.ndc,
          wholesaler_sales_867.product_description,
          wholesaler_sales_867.product_name,
          wholesaler_sales_867.trading_partner_name,
          wholesaler_sales_867.trading_partner_dea,
          wholesaler_sales_867.trading_partner_hin,
          wholesaler_sales_867.trading_partner_location_type,
          wholesaler_sales_867.trading_partner_dc_dea,
          wholesaler_sales_867.trading_partner_dc_hin,
          wholesaler_sales_867.trading_partner_dc_name,
          wholesaler_sales_867.trading_partner_dc_address,
          wholesaler_sales_867.trading_partner_dc_address_2,
          wholesaler_sales_867.trading_partner_dc_city,
          wholesaler_sales_867.trading_partner_dc_state,
          wholesaler_sales_867.trading_partner_dc_zip,
          wholesaler_sales_867.class_of_trade,
          wholesaler_sales_867.outlet_location_name,
          wholesaler_sales_867.outlet_dea,
          wholesaler_sales_867.outlet_hin,
          wholesaler_sales_867.outlet_340b,
          wholesaler_sales_867.outlet_ncpdp,
          wholesaler_sales_867.outlet_npi,
          wholesaler_sales_867.outlet_location_address,
          wholesaler_sales_867.outlet_location_address_2,
          wholesaler_sales_867.outlet_location_city,
          wholesaler_sales_867.outlet_location_state,
          wholesaler_sales_867.outlet_location_zip,
          wholesaler_sales_867.reporting_date,
          wholesaler_sales_867.rollup_reporting_month,
          wholesaler_sales_867.rollup_reporting_quarter,
          wholesaler_sales_867.contract_number,
          wholesaler_sales_867.contract_description,
          wholesaler_sales_867.invoice_number,
          wholesaler_sales_867.invoice_date,
          wholesaler_sales_867.invoice_line_id,
          wholesaler_sales_867.quanitity_stock_sales_ss,
          wholesaler_sales_867.ds_sales_ds,
          wholesaler_sales_867.summary_sales_su,
          wholesaler_sales_867.dock_to_dock_bq,
          wholesaler_sales_867.interbranch_ib,
          wholesaler_sales_867.return_to_useable_ru,
          wholesaler_sales_867.return_to_vendor_rv,
          wholesaler_sales_867.transfer_to_disposal_td,
          wholesaler_sales_867.adjusted_price,
          wholesaler_sales_867.gross_amount,
          wholesaler_sales_867.trx_count_normalized,
          wholesaler_sales_867.file_id
 ORDER BY wholesaler_sales_867.outlet_npi;

CREATE  VIEW outbound.zs_laba_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_month,
        prescriber_rx.sales_category,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.model,
        prescriber_rx.payment_method,
        sum(prescriber_rx.nrx_count) AS nrx_count,
        sum(prescriber_rx.trx_count) AS trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = 'LABA MARKET TOTAL'::varchar(17)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.rollup_month,
          prescriber_rx.sales_category,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.model,
          prescriber_rx.payment_method;

CREATE  VIEW teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2 AS
 SELECT btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.id) AS id,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.ownerid) AS ownerid,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.isdeleted) AS isdeleted,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.name) AS name,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.createddate))::timestamp END AS createddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.systemmodstamp))::timestamp END AS systemmodstamp,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastactivitydate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastactivitydate))::timestamp END AS lastactivitydate,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.birth_month_day__c) AS birth_month_day__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.business_mobile__c) AS business_mobile__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.business_phone__c) AS business_phone__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.cost_center_name__c) AS cost_center_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.demotion__c) AS demotion__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.ec_creation_date__c) AS ec_creation_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.ec_last_modified_date__c) AS ec_last_modified_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.ec_territory_id__c) AS ec_territory_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.email_address__c) AS email_address__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.employee_status__c) AS employee_status__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.first_name__c) AS first_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.full_part_time__c) AS full_part_time__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.global_employee_id__c) AS global_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.hire_date__c) AS hire_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_address_1__c) AS home_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_address_2__c) AS home_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_address_3__c) AS home_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_city_municipality__c) AS home_city_municipality__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_country__c) AS home_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_phone__c) AS home_phone__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_postal_code__c) AS home_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.home_state_province__c) AS home_state_province__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.job_code__c) AS job_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.job_grade__c) AS job_grade__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.loa_end_date__c) AS loa_end_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.loa_start_date__c) AS loa_start_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.last_name__c) AS last_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.local_employee_id__c) AS local_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_address_1__c) AS mailing_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_address_2__c) AS mailing_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_address_3__c) AS mailing_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_city__c) AS mailing_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_country__c) AS mailing_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_postal_code__c) AS mailing_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.mailing_state__c) AS mailing_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.middle_name__c) AS middle_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.name_suffix__c) AS name_suffix__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.oracle_string__c) AS oracle_string__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.payroll_id__c) AS payroll_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.position_title__c) AS position_title__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.preferred_name__c) AS preferred_name__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.promotion__c) AS promotion__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.reg_contract__c) AS reg_contract__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_eligibility_indicator__c) AS sample_eligibility_indicator__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_address_1__c) AS sample_shippingstorage_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_address_2__c) AS sample_shippingstorage_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_address_3__c) AS sample_shippingstorage_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_address_status__c) AS sample_shippingstorage_address_status__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_city__c) AS sample_shippingstorage_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_country__c) AS sample_shippingstorage_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_postal_code__c) AS sample_shippingstorage_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.sample_shippingstorage_state__c) AS sample_shippingstorage_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_address_1__c) AS shipping_address_1__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_address_2__c) AS shipping_address_2__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_address_3__c) AS shipping_address_3__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_city__c) AS shipping_city__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_country__c) AS shipping_country__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_postal_code__c) AS shipping_postal_code__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.shipping_state__c) AS shipping_state__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.supervisor_global_employee_id__c) AS supervisor_global_employee_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.transfer_date__c) AS transfer_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.uid__c) AS uid__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.windows_logon_id__c) AS windows_logon_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.teva_id__c) AS teva_id__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.employee_status_effective_date__c) AS employee_status_effective_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.separation_date__c) AS separation_date__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.separation_reason__c) AS separation_reason__c,
        btrim(EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.Certified_Field_Trainer__c) AS Certified_Field_Trainer__c,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.batch_id,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.row_id,
        EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src.update_ts
 FROM teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src;

CREATE  VIEW raw.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2 AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.birth_month_day__c,
        src.business_mobile__c,
        src.business_phone__c,
        src.cost_center_name__c,
        src.demotion__c,
        src.ec_creation_date__c,
        src.ec_last_modified_date__c,
        src.ec_territory_id__c,
        src.email_address__c,
        src.employee_status__c,
        src.first_name__c,
        src.full_part_time__c,
        src.global_employee_id__c,
        src.hire_date__c,
        src.home_address_1__c,
        src.home_address_2__c,
        src.home_address_3__c,
        src.home_city_municipality__c,
        src.home_country__c,
        src.home_phone__c,
        src.home_postal_code__c,
        src.home_state_province__c,
        src.job_code__c,
        src.job_grade__c,
        src.loa_end_date__c,
        src.loa_start_date__c,
        src.last_name__c,
        src.local_employee_id__c,
        src.mailing_address_1__c,
        src.mailing_address_2__c,
        src.mailing_address_3__c,
        src.mailing_city__c,
        src.mailing_country__c,
        src.mailing_postal_code__c,
        src.mailing_state__c,
        src.middle_name__c,
        src.name_suffix__c,
        src.oracle_string__c,
        src.payroll_id__c,
        src.position_title__c,
        src.preferred_name__c,
        src.promotion__c,
        src.reg_contract__c,
        src.sample_eligibility_indicator__c,
        src.sample_shippingstorage_address_1__c,
        src.sample_shippingstorage_address_2__c,
        src.sample_shippingstorage_address_3__c,
        src.sample_shippingstorage_address_status__c,
        src.sample_shippingstorage_city__c,
        src.sample_shippingstorage_country__c,
        src.sample_shippingstorage_postal_code__c,
        src.sample_shippingstorage_state__c,
        src.shipping_address_1__c,
        src.shipping_address_2__c,
        src.shipping_address_3__c,
        src.shipping_city__c,
        src.shipping_country__c,
        src.shipping_postal_code__c,
        src.shipping_state__c,
        src.supervisor_global_employee_id__c,
        src.transfer_date__c,
        src.uid__c,
        src.windows_logon_id__c,
        src.teva_id__c,
        src.employee_status_effective_date__c,
        src.separation_date__c,
        src.separation_reason__c,
        src.Certified_Field_Trainer__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_v2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_AXTRIA_AXTRIASALESIQTM_EMPLOYEE_V2'::varchar(38)))));

CREATE  VIEW reporting.v_nv_dc_chicago_reps AS
 SELECT r.full_name AS rep_name,
        r.title,
        r.territory_number,
        r.territory_name,
        r.team,
        r.hire_date,
        coalesce(m.full_name, 'NA'::varchar(2)) AS manager_name,
        coalesce(d.full_name, 'NA'::varchar(2)) AS director_name
 FROM (((datamart.roster r LEFT  JOIN datamart.roster m ON (((r.parent_territory_number = m.territory_number) AND (r.rep_type = 'REP'::varchar(3))))) LEFT  JOIN datamart.roster d ON (((m.parent_territory_number = d.territory_number) AND (m.rep_type = 'MGR'::varchar(3))))) JOIN (( SELECT current_alignment.territory_number
 FROM datamart.current_alignment
 WHERE ((upper(current_alignment.city) = 'CHICAGO'::varchar(7)) OR (current_alignment.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))) UNION  SELECT aa.territory_number
 FROM (datamart.alternate_alignments aa JOIN datamart.current_alignment ca ON ((aa.zip_code = ca.zip_code)))
 WHERE (((now())::date >= aa.start_date) AND ((now())::date <= aa.end_date) AND ((upper(ca.city) = 'CHICAGO'::varchar(7)) OR (ca.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))))
 GROUP BY aa.territory_number) UNION  SELECT c.territory_number
 FROM (datamart.sfa_call c JOIN datamart.current_alignment ca ON (((c.zip_on_call = ca.zip_code) AND ((upper(ca.city) = 'CHICAGO'::varchar(7)) OR (ca.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))))))
 WHERE ("datediff"('day'::varchar(3), c.call_date, (now())::date) <= 60)
 GROUP BY c.territory_number) t ON ((r.territory_number = t.territory_number)))
 WHERE (r.full_name <> 'Vacant'::varchar(6))
 GROUP BY r.full_name,
          r.title,
          r.territory_number,
          r.territory_name,
          r.team,
          r.hire_date,
          coalesce(m.full_name, 'NA'::varchar(2)),
          coalesce(d.full_name, 'NA'::varchar(2))
 ORDER BY r.territory_number;

CREATE  VIEW outbound.zs_ts_ims_zip_xref AS
 SELECT CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END AS ims_id,
        prescriber_combined_demographics.ptr_zip AS zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))
 GROUP BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip
 ORDER BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip;

CREATE  VIEW outbound.zs_xpo_xpopt_AM_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.sales_category,
          prescriber_rx.market_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.model,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.indication,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.rollup_flag,
          prescriber_rx.rollup_week,
          prescriber_rx.rollup_month,
          prescriber_rx.report_frequency,
          prescriber_rx.plan_name,
          prescriber_rx.payer_name,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count;

CREATE  VIEW teva_ingestion.EXT_VV_CALL_CLICKSTREAM_VOD__C AS
 SELECT btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Id) AS Id,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Name) AS Name,
        CASE WHEN (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.CreatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.CreatedById) AS CreatedById,
        CASE WHEN (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.LastModifiedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.LastModifiedDate))::timestamp END AS LastModifiedDate,
        CASE WHEN (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.LastModifiedById) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.LastModifiedById))::timestamp END AS LastModifiedById,
        CASE WHEN (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.SystemModstamp) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.MayEdit) AS MayEdit,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.IsLocked) AS IsLocked,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Answer_vod__c) AS Answer_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Call_vod__c) AS Call_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Key_Message_vod__c) AS Key_Message_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Mobile_ID_vod__c) AS Mobile_ID_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Popup_Opened_vod__c) AS Popup_Opened_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Possible_Answers_vod__c) AS Possible_Answers_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Presentation_ID_vod__c) AS Presentation_ID_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Product_vod__c) AS Product_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Range_Value_vod__c) AS Range_Value_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Rollover_Entered_vod__c) AS Rollover_Entered_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Selected_Items_vod__c) AS Selected_Items_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.CLM_ID_vod__c) AS CLM_ID_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Question_vod__c) AS Question_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Survey_Type_vod__c) AS Survey_Type_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Text_Entered_vod__c) AS Text_Entered_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Toggle_Button_On_vod__c) AS Toggle_Button_On_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Track_Element_Description_vod__c) AS Track_Element_Description_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Track_Element_Id_vod__c) AS Track_Element_Id_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Track_Element_Type_vod__c) AS Track_Element_Type_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Usage_Duration_vod__c) AS Usage_Duration_vod__c,
        CASE WHEN (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Usage_Start_Time_vod__c) = ''::varchar) THEN NULL::numeric(1,0) ELSE (btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Usage_Start_Time_vod__c))::numeric END AS Usage_Start_Time_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.AuxillaryId_vod__c) AS AuxillaryId_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.ParentId_vod__c) AS ParentId_vod__c,
        btrim(EXT_VV_CALL_CLICKSTREAM_VOD__C_src.Revision_vod__c) AS Revision_vod__c,
        EXT_VV_CALL_CLICKSTREAM_VOD__C_src.batch_id,
        EXT_VV_CALL_CLICKSTREAM_VOD__C_src.row_id,
        EXT_VV_CALL_CLICKSTREAM_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL_CLICKSTREAM_VOD__C_src;

CREATE  VIEW raw.EXT_VV_CALL_CLICKSTREAM_VOD__C AS
 SELECT src.Id,
        src.IsDeleted,
        src.Name,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.MayEdit,
        src.IsLocked,
        src.Answer_vod__c,
        src.Call_vod__c,
        src.Key_Message_vod__c,
        src.Mobile_ID_vod__c,
        src.Popup_Opened_vod__c,
        src.Possible_Answers_vod__c,
        src.Presentation_ID_vod__c,
        src.Product_vod__c,
        src.Range_Value_vod__c,
        src.Rollover_Entered_vod__c,
        src.Selected_Items_vod__c,
        src.CLM_ID_vod__c,
        src.Question_vod__c,
        src.Survey_Type_vod__c,
        src.Text_Entered_vod__c,
        src.Toggle_Button_On_vod__c,
        src.Track_Element_Description_vod__c,
        src.Track_Element_Id_vod__c,
        src.Track_Element_Type_vod__c,
        src.Usage_Duration_vod__c,
        src.Usage_Start_Time_vod__c,
        src.AuxillaryId_vod__c,
        src.ParentId_vod__c,
        src.Revision_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL_CLICKSTREAM_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL_CLICKSTREAM_VOD__C'::varchar(30)))));

CREATE  VIEW teva_ingestion.ext_vv_objectterritory2assignmentrule AS
 SELECT btrim(ext_vv_objectterritory2assignmentrule_src.id) AS id,
        btrim(ext_vv_objectterritory2assignmentrule_src.isdeleted) AS isdeleted,
        CASE WHEN (ext_vv_objectterritory2assignmentrule_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentrule_src.createddate))::timestamp END AS createddate,
        btrim(ext_vv_objectterritory2assignmentrule_src.createdbyid) AS createdbyid,
        CASE WHEN (ext_vv_objectterritory2assignmentrule_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentrule_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(ext_vv_objectterritory2assignmentrule_src.lastmodifiedbyid) AS LastModifiedById,
        CASE WHEN (ext_vv_objectterritory2assignmentrule_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentrule_src.systemmodstamp))::timestamp END AS SystemModstamp,
        btrim(ext_vv_objectterritory2assignmentrule_src.mayedit) AS mayedit,
        btrim(ext_vv_objectterritory2assignmentrule_src.islocked) AS islocked,
        btrim(ext_vv_objectterritory2assignmentrule_src.territory2id) AS territory2id,
        btrim(ext_vv_objectterritory2assignmentrule_src.ruleid) AS ruleid,
        btrim(ext_vv_objectterritory2assignmentrule_src.isinherited) AS isinherited,
        ext_vv_objectterritory2assignmentrule_src.batch_id,
        ext_vv_objectterritory2assignmentrule_src.row_id,
        ext_vv_objectterritory2assignmentrule_src.update_ts
 FROM teva_ingestion.ext_vv_objectterritory2assignmentrule_src;

CREATE  VIEW raw.ext_vv_objectterritory2assignmentrule AS
 SELECT src.id,
        src.isdeleted,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.territory2id,
        src.ruleid,
        src.isinherited,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_vv_objectterritory2assignmentrule_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ext_vv_objectterritory2assignmentrule'::varchar(37)))));

CREATE  VIEW teva_ingestion.ext_vv_objectterritory2assignmentruleitem AS
 SELECT btrim(ext_vv_objectterritory2assignmentruleitem_src.Id) AS Id,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.IsDeleted) AS IsDeleted,
        CASE WHEN (ext_vv_objectterritory2assignmentruleitem_src.CreatedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentruleitem_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.CreatedById) AS CreatedById,
        CASE WHEN (ext_vv_objectterritory2assignmentruleitem_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentruleitem_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (ext_vv_objectterritory2assignmentruleitem_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_vv_objectterritory2assignmentruleitem_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.RuleId) AS RuleId,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.Field) AS Field,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.Operation) AS Operation,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.SortOrder) AS SortOrder,
        btrim(ext_vv_objectterritory2assignmentruleitem_src.Value) AS Value,
        ext_vv_objectterritory2assignmentruleitem_src.batch_id,
        ext_vv_objectterritory2assignmentruleitem_src.row_id,
        ext_vv_objectterritory2assignmentruleitem_src.update_ts
 FROM teva_ingestion.ext_vv_objectterritory2assignmentruleitem_src;

CREATE  VIEW raw.ext_vv_objectterritory2assignmentruleitem AS
 SELECT src.Id,
        src.IsDeleted,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.RuleId,
        src.Field,
        src.Operation,
        src.SortOrder,
        src.Value,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_vv_objectterritory2assignmentruleitem_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'ext_vv_objectterritory2assignmentruleitem'::varchar(41)))));

CREATE  VIEW teva_ingestion.EXT_VV_OBJECTTERRITORY2ASSOCIATION AS
 SELECT btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.Id) AS Id,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.ObjectId) AS ObjectId,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.Territory2Id) AS Territory2Id,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.AssociationCause) AS AssociationCause,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.SobjectType) AS SobjectType,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.IsDeleted) AS IsDeleted,
        CASE WHEN (EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.SystemModstamp))::timestamp END AS SystemModstamp,
        EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.batch_id,
        EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.row_id,
        EXT_VV_OBJECTTERRITORY2ASSOCIATION_src.update_ts
 FROM teva_ingestion.EXT_VV_OBJECTTERRITORY2ASSOCIATION_src;

CREATE  VIEW raw.EXT_VV_OBJECTTERRITORY2ASSOCIATION AS
 SELECT src.Id,
        src.ObjectId,
        src.Territory2Id,
        src.AssociationCause,
        src.SobjectType,
        src.IsDeleted,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_OBJECTTERRITORY2ASSOCIATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_OBJECTTERRITORY2ASSOCIATION'::varchar(34)))));

CREATE  VIEW teva_ingestion.EXT_VV_RULETERRITORY2ASSOCIATION AS
 SELECT btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.Id) AS Id,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.IsDeleted) AS IsDeleted,
        CASE WHEN (btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.CreatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.CreatedById) AS CreatedById,
        CASE WHEN (EXT_VV_RULETERRITORY2ASSOCIATION_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (EXT_VV_RULETERRITORY2ASSOCIATION_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.MayEdit) AS MayEdit,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.IsLocked) AS IsLocked,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.Territory2Id) AS Territory2Id,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.RuleId) AS RuleId,
        btrim(EXT_VV_RULETERRITORY2ASSOCIATION_src.IsInherited) AS IsInherited,
        EXT_VV_RULETERRITORY2ASSOCIATION_src.batch_id,
        EXT_VV_RULETERRITORY2ASSOCIATION_src.row_id,
        EXT_VV_RULETERRITORY2ASSOCIATION_src.update_ts
 FROM teva_ingestion.EXT_VV_RULETERRITORY2ASSOCIATION_src;

CREATE  VIEW raw.EXT_VV_RULETERRITORY2ASSOCIATION AS
 SELECT src.Id,
        src.IsDeleted,
        src.CreatedDate,
        src.CreatedById,
        CASE WHEN (src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(src.SystemModstamp))::timestamp END AS SystemModstamp,
        src.MayEdit,
        src.IsLocked,
        src.Territory2Id,
        src.RuleId,
        src.IsInherited,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_RULETERRITORY2ASSOCIATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_RULETERRITORY2ASSOCIATION'::varchar(32)))));

CREATE  VIEW teva_ingestion.EXT_VV_TERRITORY2MODEL AS
 SELECT btrim(EXT_VV_TERRITORY2MODEL_src.Id) AS Id,
        btrim(EXT_VV_TERRITORY2MODEL_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_TERRITORY2MODEL_src.Name) AS Name,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODEL_src.CreatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(EXT_VV_TERRITORY2MODEL_src.CreatedById) AS CreatedById,
        CASE WHEN (EXT_VV_TERRITORY2MODEL_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_TERRITORY2MODEL_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (EXT_VV_TERRITORY2MODEL_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(EXT_VV_TERRITORY2MODEL_src.MayEdit) AS MayEdit,
        btrim(EXT_VV_TERRITORY2MODEL_src.IsLocked) AS IsLocked,
        btrim(EXT_VV_TERRITORY2MODEL_src.Description) AS Description,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODEL_src.ActivatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.ActivatedDate))::timestamp END AS ActivatedDate,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODEL_src.DeactivatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.DeactivatedDate))::timestamp END AS DeactivatedDate,
        btrim(EXT_VV_TERRITORY2MODEL_src.State) AS State,
        btrim(EXT_VV_TERRITORY2MODEL_src.DeveloperName) AS DeveloperName,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODEL_src.LastRunRulesEndDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.LastRunRulesEndDate))::timestamp END AS LastRunRulesEndDate,
        btrim(EXT_VV_TERRITORY2MODEL_src.IsCloneSource) AS IsCloneSource,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODEL_src.LastOppTerrAssignEndDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODEL_src.LastOppTerrAssignEndDate))::timestamp END AS LastOppTerrAssignEndDate,
        EXT_VV_TERRITORY2MODEL_src.batch_id,
        EXT_VV_TERRITORY2MODEL_src.row_id,
        EXT_VV_TERRITORY2MODEL_src.update_ts
 FROM teva_ingestion.EXT_VV_TERRITORY2MODEL_src;

CREATE  VIEW raw.EXT_VV_TERRITORY2MODEL AS
 SELECT src.Id,
        src.IsDeleted,
        src.Name,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.MayEdit,
        src.IsLocked,
        src.Description,
        src.ActivatedDate,
        src.DeactivatedDate,
        src.State,
        src.DeveloperName,
        src.LastRunRulesEndDate,
        src.IsCloneSource,
        src.LastOppTerrAssignEndDate,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TERRITORY2MODEL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TERRITORY2MODEL'::varchar(22)))));

CREATE  VIEW teva_ingestion.EXT_VV_TERRITORY2MODELHISTORY AS
 SELECT btrim(EXT_VV_TERRITORY2MODELHISTORY_src.Id) AS Id,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.Territory2ModelId) AS Territory2ModelId,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.CreatedById) AS CreatedById,
        CASE WHEN (btrim(EXT_VV_TERRITORY2MODELHISTORY_src.CreatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2MODELHISTORY_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.Field) AS Field,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.OldValue) AS OldValue,
        btrim(EXT_VV_TERRITORY2MODELHISTORY_src.NewValue) AS NewValue,
        EXT_VV_TERRITORY2MODELHISTORY_src.batch_id,
        EXT_VV_TERRITORY2MODELHISTORY_src.row_id,
        EXT_VV_TERRITORY2MODELHISTORY_src.update_ts
 FROM teva_ingestion.EXT_VV_TERRITORY2MODELHISTORY_src;

CREATE  VIEW raw.EXT_VV_TERRITORY2MODELHISTORY AS
 SELECT src.Id,
        src.IsDeleted,
        src.Territory2ModelId,
        src.CreatedById,
        src.CreatedDate,
        src.Field,
        src.OldValue,
        src.NewValue,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TERRITORY2MODELHISTORY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TERRITORY2MODELHISTORY'::varchar(29)))));

CREATE  VIEW teva_ingestion.EXT_VV_TERRITORY2TYPE AS
 SELECT btrim(EXT_VV_TERRITORY2TYPE_src.Id) AS Id,
        btrim(EXT_VV_TERRITORY2TYPE_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_TERRITORY2TYPE_src.DeveloperName) AS DeveloperName,
        btrim(EXT_VV_TERRITORY2TYPE_src.Language) AS Language,
        btrim(EXT_VV_TERRITORY2TYPE_src.MasterLabel) AS MasterLabel,
        CASE WHEN (btrim(EXT_VV_TERRITORY2TYPE_src.CreatedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2TYPE_src.CreatedDate))::timestamp END AS CreatedDate,
        btrim(EXT_VV_TERRITORY2TYPE_src.CreatedById) AS CreatedById,
        CASE WHEN (EXT_VV_TERRITORY2TYPE_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2TYPE_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_TERRITORY2TYPE_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (EXT_VV_TERRITORY2TYPE_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2TYPE_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(EXT_VV_TERRITORY2TYPE_src.Description) AS Description,
        EXT_VV_TERRITORY2TYPE_src.Priority,
        EXT_VV_TERRITORY2TYPE_src.batch_id,
        EXT_VV_TERRITORY2TYPE_src.row_id,
        EXT_VV_TERRITORY2TYPE_src.update_ts
 FROM teva_ingestion.EXT_VV_TERRITORY2TYPE_src;

CREATE  VIEW raw.EXT_VV_TERRITORY2TYPE AS
 SELECT src.Id,
        src.IsDeleted,
        src.DeveloperName,
        src.Language,
        src.MasterLabel,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.Description,
        src.Priority,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TERRITORY2TYPE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TERRITORY2TYPE'::varchar(21)))));

CREATE  VIEW teva_ingestion.EXT_VV_USERTERRITORY2ASSOCIATION AS
 SELECT btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.Id) AS Id,
        btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.UserId) AS UserId,
        btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.Territory2Id) AS Territory2Id,
        btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.IsActive) AS IsActive,
        btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.RoleInTerritory2) AS RoleInTerritory2,
        CASE WHEN (btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.LastModifiedDate) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.LastModifiedDate))::timestamp END AS LastModifiedDate,
        btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.SystemModstamp) = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_USERTERRITORY2ASSOCIATION_src.SystemModstamp))::timestamp END AS SystemModstamp,
        EXT_VV_USERTERRITORY2ASSOCIATION_src.batch_id,
        EXT_VV_USERTERRITORY2ASSOCIATION_src.row_id,
        EXT_VV_USERTERRITORY2ASSOCIATION_src.update_ts
 FROM teva_ingestion.EXT_VV_USERTERRITORY2ASSOCIATION_src;

CREATE  VIEW raw.EXT_VV_USERTERRITORY2ASSOCIATION AS
 SELECT src.Id,
        src.UserId,
        src.Territory2Id,
        src.IsActive,
        src.RoleInTerritory2,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_USERTERRITORY2ASSOCIATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_USERTERRITORY2ASSOCIATION'::varchar(32)))));

CREATE  VIEW teva_ingestion.EXT_VV_TERRITORY2 AS
 SELECT btrim(EXT_VV_TERRITORY2_src.Id) AS Id,
        btrim(EXT_VV_TERRITORY2_src.Name) AS Name,
        btrim(EXT_VV_TERRITORY2_src.Territory2TypeId) AS Territory2TypeId,
        btrim(EXT_VV_TERRITORY2_src.Territory2ModelId) AS Territory2ModelId,
        btrim(EXT_VV_TERRITORY2_src.ParentTerritory2Id) AS ParentTerritory2Id,
        btrim(EXT_VV_TERRITORY2_src.Description) AS Description,
        btrim(EXT_VV_TERRITORY2_src.AccountAccessLevel) AS AccountAccessLevel,
        btrim(EXT_VV_TERRITORY2_src.OpportunityAccessLevel) AS OpportunityAccessLevel,
        btrim(EXT_VV_TERRITORY2_src.CaseAccessLevel) AS CaseAccessLevel,
        btrim(EXT_VV_TERRITORY2_src.ContactAccessLevel) AS ContactAccessLevel,
        CASE WHEN (EXT_VV_TERRITORY2_src.LastModifiedDate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2_src.LastModifiedDate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_TERRITORY2_src.LastModifiedById) AS LastModifiedById,
        CASE WHEN (EXT_VV_TERRITORY2_src.SystemModstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_TERRITORY2_src.SystemModstamp))::timestamp END AS SystemModstamp,
        btrim(EXT_VV_TERRITORY2_src.DeveloperName) AS DeveloperName,
        btrim(EXT_VV_TERRITORY2_src.ParentTerritory1Id__c) AS ParentTerritory1Id__c,
        btrim(EXT_VV_TERRITORY2_src.Territory1Id__c) AS Territory1Id__c,
        EXT_VV_TERRITORY2_src.batch_id,
        EXT_VV_TERRITORY2_src.row_id,
        EXT_VV_TERRITORY2_src.update_ts
 FROM teva_ingestion.EXT_VV_TERRITORY2_src;

CREATE  VIEW raw.EXT_VV_TERRITORY2 AS
 SELECT src.Id,
        src.Name,
        src.Territory2TypeId,
        src.Territory2ModelId,
        src.ParentTerritory2Id,
        src.Description,
        src.AccountAccessLevel,
        src.OpportunityAccessLevel,
        src.CaseAccessLevel,
        src.ContactAccessLevel,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.DeveloperName,
        src.ParentTerritory1Id__c,
        src.Territory1Id__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_TERRITORY2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_TERRITORY2'::varchar(17)))));

CREATE  VIEW outbound.archer_rte AS
 SELECT se.id AS veeva_sent_email_id,
        se.sent_email_id,
        se.product_display_vod__c AS product,
        se.email_sent_date_vod__c AS date_sent,
        CASE WHEN (se.status_vod__c = 'Delivered_vod'::varchar(13)) THEN 'Delivered'::varchar(9) WHEN (se.status_vod__c = 'Failed_vod'::varchar(10)) THEN 'Failed'::varchar(6) WHEN (se.status_vod__c = 'Saved_vod'::varchar(9)) THEN 'Saved'::varchar(5) WHEN (se.status_vod__c = 'Sent_vod'::varchar(8)) THEN 'Sent'::varchar(4) WHEN (se.status_vod__c = 'Dropped_vod'::varchar(11)) THEN 'Dropped'::varchar(7) ELSE NULL END AS status,
        se.failure_msg_vod__c AS failure_message,
        se.account_vod__c AS veeva_account_id,
        tx.tvcmid,
        se.call2_vod__c AS veeva_call_id,
        se.call_id,
        se.sender_email_vod__c AS sender_email,
        se.territory_number AS territory,
        se.account_email_vod__c AS recipient_email,
        se.click_count_vod__c AS click_count,
        se.open_count_vod__c AS open_count,
        se.last_open_date_vod__c AS last_open_date,
        se.valid_consent_exists_vod__c AS valid_consent,
        CASE WHEN (ea1.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS delivered,
        CASE WHEN (ea2.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS opened,
        CASE WHEN (ea3.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS dropped,
        CASE WHEN (ea4.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS clicked,
        CASE WHEN (ea5.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS downloaded,
        CASE WHEN (ea6.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS viewed,
        se.approved_email_template_vod__c AS template_id,
        ad.name AS template_name,
        ea7.event_msg_vod__c,
        ea7.click_url_vod__c,
        se.subject
 FROM (((((((((( SELECT a.id,
        a.sent_email_id,
        a.product_display_vod__c,
        a.email_sent_date_vod__c,
        a.status_vod__c,
        a.failure_msg_vod__c,
        a.account_vod__c,
        a.call2_vod__c,
        a.call_id,
        a.sender_email_vod__c,
        a.territory_number,
        a.account_email_vod__c,
        a.click_count_vod__c,
        a.open_count_vod__c,
        a.last_open_date_vod__c,
        a.valid_consent_exists_vod__c,
        a.subject,
        a.approved_email_template_vod__c,
        a.ranked
 FROM ( SELECT se.Id AS id,
        se.Name AS sent_email_id,
        se.Product_Display_vod__c AS product_display_vod__c,
        se.Email_Sent_Date_vod__c AS email_sent_date_vod__c,
        se.Status_vod__c AS status_vod__c,
        se.Failure_Msg_vod__c AS failure_msg_vod__c,
        se.Account_vod__c AS account_vod__c,
        se.Call2_vod__c AS call2_vod__c,
        c.name AS call_id,
        se.Sender_Email_vod__c AS sender_email_vod__c,
        t.territory_number,
        se.Account_Email_vod__c AS account_email_vod__c,
        se.Click_Count_vod__c AS click_count_vod__c,
        se.Open_Count_vod__c AS open_count_vod__c,
        se.Last_Open_Date_vod__c AS last_open_date_vod__c,
        se.Valid_Consent_Exists_vod__c AS valid_consent_exists_vod__c,
        se.subject,
        se.Approved_Email_Template_vod__c AS approved_email_template_vod__c,
        rank() OVER (PARTITION BY se.Id ORDER BY se.file_id DESC) AS ranked
 FROM ((veeva.sent_email se LEFT  JOIN ( SELECT call.id,
        call.name
 FROM veeva.call
 WHERE (call.createddate >= '2020-01-01 00:00:00'::timestamp(0))
 GROUP BY call.id,
          call.name) c ON ((se.Call2_vod__c = c.id))) JOIN ( SELECT ad.account_vod__c,
        ad.zip_vod__c,
        ca.zip_code,
        ca.territory_number,
        ca.sales_force_id
 FROM veeva.address ad, sandbox.archer_zip_terr ca
 WHERE (ad.zip_vod__c = ca.zip_code)
 GROUP BY ad.account_vod__c,
          ad.zip_vod__c,
          ca.zip_code,
          ca.territory_number,
          ca.sales_force_id) t ON (((se.Account_vod__c = t.account_vod__c) AND (substr(se.Territory_vod__c, 1, 2) = t.sales_force_id))))
 WHERE (se.CreatedDate >= '2020-01-01 00:00:00'::timestamp(0))) a
 WHERE (a.ranked = 1)) se LEFT  JOIN ( SELECT approved_document.id,
        approved_document.ownerid,
        approved_document.isdeleted,
        approved_document.name,
        approved_document.recordtypeid,
        approved_document.createddate,
        approved_document.createdbyid,
        approved_document.lastmodifieddate,
        approved_document.lastmodifiedbyid,
        approved_document.systemmodstamp,
        approved_document.lastactivitydate,
        approved_document.mayedit,
        approved_document.islocked,
        approved_document.lastvieweddate,
        approved_document.lastreferenceddate,
        approved_document.detail_group_vod__c,
        approved_document.document_description_vod__c,
        approved_document.document_host_url_vod__c,
        approved_document.document_id_vod__c,
        approved_document.document_last_mod_datetime_vod__c,
        approved_document.email_allows_documents_vod__c,
        approved_document.email_domain_vod__c,
        approved_document.email_from_address_vod__c,
        approved_document.email_from_name_vod__c,
        approved_document.email_replyto_address_vod__c,
        approved_document.email_replyto_name_vod__c,
        approved_document.email_subject_vod__c,
        approved_document.email_template_fragment_document_id_vod__c,
        approved_document.isi_document_id_vod__c,
        approved_document.language_vod__c,
        approved_document.other_document_id_list_vod__c,
        approved_document.pi_document_id_vod__c,
        approved_document.piece_document_id_vod__c,
        approved_document.product_vod__c,
        approved_document.status_vod__c,
        approved_document.territory_vod__c,
        approved_document.vault_instance_id_vod__c,
        approved_document.expiration_date_tva__c,
        approved_document.group_to_share_to__c,
        approved_document.training_org_tva__c,
        approved_document.unsub_svr_tva__c,
        approved_document.file_id,
        approved_document.record_id
 FROM veeva.approved_document
 WHERE (approved_document.file_id IN ( SELECT max(approved_document.file_id) AS max
 FROM veeva.approved_document))) ad ON ((se.approved_email_template_vod__c = ad.id))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea1 ON (((se.id = ea1.sent_email_vod__c) AND (ea1.event_type_vod__c = 'Delivered_vod'::varchar(13))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea2 ON (((se.id = ea2.sent_email_vod__c) AND (ea2.event_type_vod__c = 'Opened_vod'::varchar(10))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea3 ON (((se.id = ea3.sent_email_vod__c) AND (ea3.event_type_vod__c = 'Dropped_vod'::varchar(11))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea4 ON (((se.id = ea4.sent_email_vod__c) AND (ea4.event_type_vod__c = 'Clicked_vod'::varchar(11))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea5 ON (((se.id = ea5.sent_email_vod__c) AND (ea5.event_type_vod__c = 'Downloaded_vod'::varchar(14))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea6 ON (((se.id = ea6.sent_email_vod__c) AND (ea6.event_type_vod__c = 'Viewed_vod'::varchar(10))))) LEFT  JOIN ( SELECT a.id,
        a.sent_email_vod__c,
        a.event_type_vod__c,
        a.event_msg_vod__c,
        a.click_url_vod__c,
        a.ranked
 FROM ( SELECT email_activity.Id AS id,
        email_activity.Sent_Email_vod__c AS sent_email_vod__c,
        email_activity.Event_type_vod__c AS event_type_vod__c,
        email_activity.Event_Msg_vod__c AS event_msg_vod__c,
        email_activity.Click_URL_vod__c AS click_url_vod__c,
        rank() OVER (PARTITION BY email_activity.Sent_Email_vod__c, email_activity.Event_type_vod__c ORDER BY email_activity.file_id DESC, email_activity.Name DESC) AS ranked
 FROM veeva.email_activity) a
 WHERE (a.ranked = 1)) ea7 ON ((se.id = ea7.sent_email_vod__c))) LEFT  JOIN datamart.tvcmid_xref tx ON (((se.account_vod__c = tx.id_num) AND (tx.id_type = 'VEEVA_ID'::varchar(8)))))
 GROUP BY se.id,
          se.sent_email_id,
          se.product_display_vod__c,
          se.email_sent_date_vod__c,
          CASE WHEN (se.status_vod__c = 'Delivered_vod'::varchar(13)) THEN 'Delivered'::varchar(9) WHEN (se.status_vod__c = 'Failed_vod'::varchar(10)) THEN 'Failed'::varchar(6) WHEN (se.status_vod__c = 'Saved_vod'::varchar(9)) THEN 'Saved'::varchar(5) WHEN (se.status_vod__c = 'Sent_vod'::varchar(8)) THEN 'Sent'::varchar(4) WHEN (se.status_vod__c = 'Dropped_vod'::varchar(11)) THEN 'Dropped'::varchar(7) ELSE NULL END,
          se.failure_msg_vod__c,
          se.account_vod__c,
          tx.tvcmid,
          se.call2_vod__c,
          se.call_id,
          se.sender_email_vod__c,
          se.territory_number,
          se.account_email_vod__c,
          se.click_count_vod__c,
          se.open_count_vod__c,
          se.last_open_date_vod__c,
          se.valid_consent_exists_vod__c,
          CASE WHEN (ea1.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          CASE WHEN (ea2.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          CASE WHEN (ea3.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          CASE WHEN (ea4.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          CASE WHEN (ea5.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          CASE WHEN (ea6.event_type_vod__c IS NULL) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END,
          se.approved_email_template_vod__c,
          ad.name,
          ea7.event_msg_vod__c,
          ea7.click_url_vod__c,
          se.subject;

CREATE  VIEW outbound.archer_dnc AS
 SELECT clf.tvcmid,
        atd.ims_id,
        atd.npi,
        CASE WHEN (clf.flag_type = ANY (ARRAY['DNC'::varchar(6), 'AMADNC'::varchar(6)])) THEN 'Do Not Call'::varchar(11) WHEN (clf.flag_type = ANY (ARRAY['OIG'::varchar(6), 'FDA'::varchar(6), 'DEA'::varchar(6), 'PERPRM'::varchar(6)])) THEN 'Do Not Promote'::varchar(14) ELSE clf.flag_type END AS flag_type,
        clf.flag_value,
        clf.flag_effective_start_date,
        clf.flag_effective_end_date
 FROM datamart.customer_level_flags clf, sandbox.archer_target_data atd
 WHERE ((clf.tvcmid = atd.tvcmid) AND (clf.flag_type = ANY (ARRAY['DNC'::varchar(6), 'AMADNC'::varchar(6), 'OIG'::varchar(6), 'FDA'::varchar(6), 'DEA'::varchar(6), 'PERPRM'::varchar(6)])) AND ((statement_timestamp())::timestamp >= clf.flag_effective_start_date) AND ((statement_timestamp())::timestamp <= clf.flag_effective_end_date))
 GROUP BY clf.tvcmid,
          atd.ims_id,
          atd.npi,
          CASE WHEN (clf.flag_type = ANY (ARRAY['DNC'::varchar(6), 'AMADNC'::varchar(6)])) THEN 'Do Not Call'::varchar(11) WHEN (clf.flag_type = ANY (ARRAY['OIG'::varchar(6), 'FDA'::varchar(6), 'DEA'::varchar(6), 'PERPRM'::varchar(6)])) THEN 'Do Not Promote'::varchar(14) ELSE clf.flag_type END,
          clf.flag_value,
          clf.flag_effective_start_date,
          clf.flag_effective_end_date;

CREATE  VIEW outbound.v_ob_ahm_employee AS
 SELECT Employee.employee_id AS EmployeeId,
        coalesce(Employee.username, ''::varchar) AS Username,
        coalesce(upper(Employee.username), ''::varchar) AS FederationId,
        CASE WHEN (Employee.rep_type = 'REP'::varchar(3)) THEN 'TEVA Pharma Rep'::varchar(15) ELSE 'TEVA Pharma Manager'::varchar(19) END AS SFDCUserProfile,
        coalesce(Manager.employee_id, ''::varchar) AS ManagerEmployeeId,
        coalesce(Employee.first_name, ''::varchar) AS FirstName,
        coalesce(Employee.last_name, ''::varchar) AS LastName,
        coalesce(Employee.middle_name, ''::varchar) AS MiddleName,
        ''::varchar AS Nickname,
        ''::varchar AS GenderCode,
        'Sales Specialist'::varchar(16) AS EmployeeRole,
        coalesce(Employee.shipping_address_line1, Employee.address_line1) AS ShippingAddressLine1,
        coalesce(Employee.shipping_address_line2, Employee.address_line2) AS ShippingAddressLine2,
        ''::varchar AS ShippingAddressLine3,
        coalesce(Employee.shipping_city, Employee.city) AS ShippingCity,
        ''::varchar AS ShippingNeighborhood,
        coalesce(Employee.shipping_state, Employee.state) AS ShippingStateProvince,
        coalesce(Employee.shipping_zip, Employee.zip) AS ShippingPostalCode,
        ''::varchar AS ShippingPostalCodeExtension,
        'US'::varchar(2) AS ShippingCountryCode,
        coalesce(Employee.address_line1, ''::varchar) AS HomeAddressLine1,
        coalesce(Employee.address_line2, ''::varchar) AS HomeAddressLine2,
        ''::varchar AS HomeAddressLine3,
        coalesce(Employee.city, ''::varchar) AS HomeCity,
        ''::varchar AS HomeNeighborhood,
        coalesce(Employee.state, ''::varchar) AS HomeStateProvince,
        coalesce(Employee.zip, ''::varchar) AS HomePostalCode,
        ''::varchar AS HomePostalCodeExtension,
        'US'::varchar(2) AS HomeCountryCode,
        coalesce(Employee.business_address_line1, ''::varchar) AS WorkAddressLine1,
        coalesce(Employee.business_address_line2, ''::varchar) AS WorkAddressLine2,
        ''::varchar AS WorkAddressLine3,
        coalesce(Employee.business_city, ''::varchar) AS WorkCity,
        ''::varchar AS WorkNeighborhood,
        coalesce(Employee.business_state, ''::varchar) AS WorkStateProvince,
        coalesce(Employee.business_zip, ''::varchar) AS WorkPostalCode,
        ''::varchar AS WorkPostalCodeExtension,
        'US'::varchar(2) AS WorkCountryCode,
        coalesce(Employee.mobile_phone, ''::varchar) AS WorkPhone,
        ''::varchar AS WorkPhoneExtension,
        coalesce(Employee.email, ''::varchar) AS EmailAddress,
        coalesce(Employee.fax, ''::varchar) AS Fax,
        'US'::varchar(2) AS RegionId,
        coalesce((Employee.hire_date)::varchar(10), ''::varchar) AS HireDate,
        ''::varchar AS TerminationDate,
        'Active'::varchar(6) AS Status
 FROM (datamart.roster Employee LEFT  JOIN datamart.roster Manager ON ((Employee.parent_territory_number = Manager.territory_number)))
 WHERE ((Employee.employee_id IS NOT NULL) AND (Employee.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2)])));

CREATE  VIEW sandbox.v_sent_email AS
 SELECT se.id,
        se.isdeleted,
        se.name,
        se.createddate,
        se.createdbyid,
        se.lastmodifieddate,
        se.lastmodifiedbyid,
        se.systemmodstamp,
        se.mayedit,
        se.islocked,
        se.is_parent_call_vod__c,
        se.call2_vod__c,
        se.product_vod__c,
        se.detail_priority_vod__c,
        se.mobile_id_vod__c,
        se.type_vod__c,
        se.file_id,
        se.record_id
 FROM (veeva.call_detail se JOIN ( SELECT call_detail.id,
        max(call_detail.file_id) AS file_id
 FROM veeva.call_detail
 WHERE (call_detail.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call_detail.id) se2 ON (((se.id = se2.id) AND (se.file_id = se2.file_id))));

CREATE  VIEW sandbox.account AS
 SELECT x.id,
        x.isdeleted,
        x.masterrecordid,
        x.name,
        x.lastname,
        x.firstname,
        x.salutation,
        x.type,
        x.recordtypeid,
        x.phone,
        x.fax,
        x.website,
        x.numberofemployees,
        x.ownership,
        x.ownerid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.isexcludedfromrealign,
        x.personcontactid,
        x.ispersonaccount,
        x.personmailingstreet,
        x.personmailingcity,
        x.personmailingstate,
        x.personmailingpostalcode,
        x.personmailingcountry,
        x.personmailinglatitude,
        x.personmailinglongitude,
        x.personotherstreet,
        x.personothercity,
        x.personotherstate,
        x.personotherpostalcode,
        x.personothercountry,
        x.personotherlatitude,
        x.personotherlongitude,
        x.personmobilephone,
        x.personhomephone,
        x.personotherphone,
        x.personassistantphone,
        x.personemail,
        x.persontitle,
        x.persondepartment,
        x.personassistantname,
        x.personbirthdate,
        x.personhasoptedoutofemail,
        x.personhasoptedoutoffax,
        x.persondonotcall,
        x.personlastcurequestdate,
        x.personlastcuupdatedate,
        x.personemailbouncedreason,
        x.personemailbounceddate,
        x.jigsaw,
        x.jigsawcompanyid,
        x.accountsource,
        x.sicdesc,
        x.external_id_vod__c,
        x.credentials_vod__c,
        x.exclude_from_zip_to_terr_proce,
        x.group_specialty_1_vod__c,
        x.group_specialty_2_vod__c,
        x.specialty_1_vod__c,
        x.specialty_2_vod__c,
        x.formatted_name_vod__c,
        x.territory_test_vod__c,
        x.mobile_id_vod__c,
        x.gender_vod__c,
        x.id_vod__c,
        x.do_not_sync_sales_data_vod__c,
        x.id2_vod__c,
        x.preferred_name_vod__c,
        x.sample_default_vod__c,
        x.segmentations_vod__c,
        x.restricted_products_vod__c,
        x.payer_id_vod__c,
        x.account_status_tva__c,
        x.do_not_call_vod__c,
        x.beds__c,
        x.spend_amount__c,
        x.pdrp_opt_out_vod__c,
        x.spend_status_value_vod__c,
        x.pdrp_opt_out_date_vod__c,
        x.spend_status_vod__c,
        x.enable_restricted_products,
        x.call_reminder_vod__c,
        x.account_group_vod__c,
        x.primary_parent_vod__c,
        x.color_vod__c,
        x.middle_vod__c,
        x.suffix_vod__c,
        x.account_location_tva__c,
        x.no_orders_vod__c,
        x.account_master_id_tva__c,
        x.account_email_tva__c,
        x.account_search_firstlast,
        x.account_search_lastfirst,
        x.person_preferred_name_tva__c,
        x.practice_at_hospital_vod__c,
        x.practice_near_hospital_vod__c,
        x.do_not_create_child_account,
        x.total_mds_dos__c,
        x.aha__c,
        x.order_type_vod__c,
        x.npi_vod__c,
        x.me__c,
        x.speaker__c,
        x.investigator_vod__c,
        x.default_order_type_vod__c,
        x.person_degree_tva__c,
        x.tax_status__c,
        x.model__c,
        x.offerings__c,
        x.departments__c,
        x.account_type__c,
        x.account_search_business_vod__c,
        x.business_professional_person,
        x.no_spend_tva__c,
        x.hospital_type_vod__c,
        x.account_class_vod__c,
        x.furigana_vod__c,
        x.tirf_rems_tva__c,
        x.fentora_app_tva__c,
        x.total_revenue_000__c,
        x.net_income_loss_000__c,
        x.pmpm_income_loss_000__c,
        x.commercial_premiums_pmpm__c,
        x.medical_loss_ratio__c,
        x.medical_expenses_pmpm__c,
        x.commercial_patient_days_1000,
        x.hmo_market_shr__c,
        x.hmo__c,
        x.hmo_pos__c,
        x.ppo__c,
        x.ppo_pos__c,
        x.medicare__c,
        x.medicaid__c,
        x.nuvigil_app_tva__c,
        x.mds_status_tva__c,
        x.lis_status_tva__c,
        x.dnc_pcs_tva__c,
        x.dnc_cns_tva__c,
        x.suffix_tva__c,
        x.tysabri_status_tva__c,
        x.business_description__c,
        x.regional_strategy__c,
        x.contracts_process__c,
        x.cml_profiled_tva__c,
        x.cell_phone_tva__c,
        x.no_contact_tva__c,
        x.outlet_id_tva__c,
        x.pmo_gpo_account_affiliations,
        x.territory_status_tva__c,
        x.zdea_number_tva__c,
        x.veeva_id_tva__c,
        x.treanda_lq_tgt_tva__c,
        x.tbo_filgrastim_target_tva__c,
        x.sln_rescrub_tva__c,
        x.account_identifier_vod__c,
        x.target__c,
        x.kol_vod__c,
        x.rems_expiration_date_teva__c,
        x.account_demo_id_tva__c,
        x.total_lives__c,
        x.total_physicians_enrolled__c,
        x.tirf_rems_eff_date_tva__c,
        x.business_associate_agreement,
        x.do_not_promote_tva__c,
        x.account_dea_tva__c,
        x.bp_number__c,
        x.paragard_segmentation_tva__c,
        x.telesales_activity_tva__c,
        x.designation_tva__c,
        x.total_pharmacists__c,
        x.comp_pricing_tva__c,
        x.formulary_tva__c,
        x.gln_tva__c,
        x.gpo_contracts_tva__c,
        x.hin_tva__c,
        x.max_id_tva__c,
        x.oncology_services_tva__c,
        x.pcp_program_tva__c,
        x.pharmacy_location_tva__c,
        x.primary_credential_tva__c,
        x.primary_wholesaler_tva__c,
        x.rep_credentialing_tva__c,
        x.secondary_credential_tva__c,
        x.sign_in_location_tva__c,
        x.special_tva__c,
        x.sub_type_id_tva__c,
        x.sub_type_tva__c,
        x.teva_contracts_tva__c,
        x.ims_org_id_tva__c,
        x.year_of_birth_tva__c,
        x.teaching_hospital_tva__c,
        x.account_archived_tva__c,
        x.mobile_id_vod__pc,
        x.file_id,
        x.record_id,
        x.cm_id_tva__c,
        x.staff_email,
        x.company_managed_email,
        x.alternate_email
 FROM (veeva.account x JOIN ( SELECT account.id,
        max(account.file_id) AS file_id
 FROM veeva.account
 GROUP BY account.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.v_account AS
 SELECT x.id,
        x.isdeleted,
        x.masterrecordid,
        x.name,
        x.lastname,
        x.firstname,
        x.salutation,
        x.type,
        x.recordtypeid,
        x.phone,
        x.fax,
        x.website,
        x.numberofemployees,
        x.ownership,
        x.ownerid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.isexcludedfromrealign,
        x.personcontactid,
        x.ispersonaccount,
        x.personmailingstreet,
        x.personmailingcity,
        x.personmailingstate,
        x.personmailingpostalcode,
        x.personmailingcountry,
        x.personmailinglatitude,
        x.personmailinglongitude,
        x.personotherstreet,
        x.personothercity,
        x.personotherstate,
        x.personotherpostalcode,
        x.personothercountry,
        x.personotherlatitude,
        x.personotherlongitude,
        x.personmobilephone,
        x.personhomephone,
        x.personotherphone,
        x.personassistantphone,
        x.personemail,
        x.persontitle,
        x.persondepartment,
        x.personassistantname,
        x.personbirthdate,
        x.personhasoptedoutofemail,
        x.personhasoptedoutoffax,
        x.persondonotcall,
        x.personlastcurequestdate,
        x.personlastcuupdatedate,
        x.personemailbouncedreason,
        x.personemailbounceddate,
        x.jigsaw,
        x.jigsawcompanyid,
        x.accountsource,
        x.sicdesc,
        x.external_id_vod__c,
        x.credentials_vod__c,
        x.exclude_from_zip_to_terr_proce,
        x.group_specialty_1_vod__c,
        x.group_specialty_2_vod__c,
        x.specialty_1_vod__c,
        x.specialty_2_vod__c,
        x.formatted_name_vod__c,
        x.territory_test_vod__c,
        x.mobile_id_vod__c,
        x.gender_vod__c,
        x.id_vod__c,
        x.do_not_sync_sales_data_vod__c,
        x.id2_vod__c,
        x.preferred_name_vod__c,
        x.sample_default_vod__c,
        x.segmentations_vod__c,
        x.restricted_products_vod__c,
        x.payer_id_vod__c,
        x.account_status_tva__c,
        x.do_not_call_vod__c,
        x.beds__c,
        x.spend_amount__c,
        x.pdrp_opt_out_vod__c,
        x.spend_status_value_vod__c,
        x.pdrp_opt_out_date_vod__c,
        x.spend_status_vod__c,
        x.enable_restricted_products,
        x.call_reminder_vod__c,
        x.account_group_vod__c,
        x.primary_parent_vod__c,
        x.color_vod__c,
        x.middle_vod__c,
        x.suffix_vod__c,
        x.account_location_tva__c,
        x.no_orders_vod__c,
        x.account_master_id_tva__c,
        x.account_email_tva__c,
        x.account_search_firstlast,
        x.account_search_lastfirst,
        x.person_preferred_name_tva__c,
        x.practice_at_hospital_vod__c,
        x.practice_near_hospital_vod__c,
        x.do_not_create_child_account,
        x.total_mds_dos__c,
        x.aha__c,
        x.order_type_vod__c,
        x.npi_vod__c,
        x.me__c,
        x.speaker__c,
        x.investigator_vod__c,
        x.default_order_type_vod__c,
        x.person_degree_tva__c,
        x.tax_status__c,
        x.model__c,
        x.offerings__c,
        x.departments__c,
        x.account_type__c,
        x.account_search_business_vod__c,
        x.business_professional_person,
        x.no_spend_tva__c,
        x.hospital_type_vod__c,
        x.account_class_vod__c,
        x.furigana_vod__c,
        x.tirf_rems_tva__c,
        x.fentora_app_tva__c,
        x.total_revenue_000__c,
        x.net_income_loss_000__c,
        x.pmpm_income_loss_000__c,
        x.commercial_premiums_pmpm__c,
        x.medical_loss_ratio__c,
        x.medical_expenses_pmpm__c,
        x.commercial_patient_days_1000,
        x.hmo_market_shr__c,
        x.hmo__c,
        x.hmo_pos__c,
        x.ppo__c,
        x.ppo_pos__c,
        x.medicare__c,
        x.medicaid__c,
        x.nuvigil_app_tva__c,
        x.mds_status_tva__c,
        x.lis_status_tva__c,
        x.dnc_pcs_tva__c,
        x.dnc_cns_tva__c,
        x.suffix_tva__c,
        x.tysabri_status_tva__c,
        x.business_description__c,
        x.regional_strategy__c,
        x.contracts_process__c,
        x.cml_profiled_tva__c,
        x.cell_phone_tva__c,
        x.no_contact_tva__c,
        x.outlet_id_tva__c,
        x.pmo_gpo_account_affiliations,
        x.territory_status_tva__c,
        x.zdea_number_tva__c,
        x.veeva_id_tva__c,
        x.treanda_lq_tgt_tva__c,
        x.tbo_filgrastim_target_tva__c,
        x.sln_rescrub_tva__c,
        x.account_identifier_vod__c,
        x.target__c,
        x.kol_vod__c,
        x.rems_expiration_date_teva__c,
        x.account_demo_id_tva__c,
        x.total_lives__c,
        x.total_physicians_enrolled__c,
        x.tirf_rems_eff_date_tva__c,
        x.business_associate_agreement,
        x.do_not_promote_tva__c,
        x.account_dea_tva__c,
        x.bp_number__c,
        x.paragard_segmentation_tva__c,
        x.telesales_activity_tva__c,
        x.designation_tva__c,
        x.total_pharmacists__c,
        x.comp_pricing_tva__c,
        x.formulary_tva__c,
        x.gln_tva__c,
        x.gpo_contracts_tva__c,
        x.hin_tva__c,
        x.max_id_tva__c,
        x.oncology_services_tva__c,
        x.pcp_program_tva__c,
        x.pharmacy_location_tva__c,
        x.primary_credential_tva__c,
        x.primary_wholesaler_tva__c,
        x.rep_credentialing_tva__c,
        x.secondary_credential_tva__c,
        x.sign_in_location_tva__c,
        x.special_tva__c,
        x.sub_type_id_tva__c,
        x.sub_type_tva__c,
        x.teva_contracts_tva__c,
        x.ims_org_id_tva__c,
        x.year_of_birth_tva__c,
        x.teaching_hospital_tva__c,
        x.account_archived_tva__c,
        x.mobile_id_vod__pc,
        x.file_id,
        x.record_id,
        x.cm_id_tva__c,
        x.staff_email,
        x.company_managed_email,
        x.alternate_email
 FROM (veeva.account x JOIN ( SELECT account.id,
        max(account.file_id) AS file_id
 FROM veeva.account
 GROUP BY account.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW outbound.anda_ajovyTRx_monthly AS
 SELECT r.ims_id AS IMS_ID,
        r.tvcmid,
        r.prescriber_first_name,
        r.prescriber_last_name,
        r.rollup_month,
        sum(CASE WHEN (r.basket_name ~~* '%AJOVY%'::varchar(7)) THEN r.trx_count ELSE 0::numeric(18,0) END) AS Sum_AJOVY_TRx,
        sum(CASE WHEN (r.basket_name ~~* '%AIMOVIG%'::varchar(9)) THEN r.trx_count ELSE 0::numeric(18,0) END) AS Sum_AIMOVIG_TRx,
        sum(CASE WHEN (r.basket_name ~~* '%EMGALITY%'::varchar(10)) THEN r.trx_count ELSE 0::numeric(18,0) END) AS Sum_EMGALITY_TRx,
        sum(r.trx_count) AS Sum_ANTICGRP_TRx
 FROM ((datamart.prescriber_rx r JOIN ( SELECT prescriber_rx.rollup_month AS month_end
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.market_name ~~* '%ANTI-MIGRAINE MARKET%'::varchar(22)) AND (prescriber_rx.rollup_flag IS NULL) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.rollup_month <= last_day((trunc((now())::timestamp, 'DD'::varchar(2)) + '-1'::interval month))))
 GROUP BY prescriber_rx.rollup_month
 ORDER BY prescriber_rx.rollup_month DESC
 LIMIT 12) m ON ((r.rollup_month = m.month_end))) JOIN ( SELECT b.basket_id,
        b.name
 FROM ((product.basket m JOIN product.basket_item mi ON ((mi.basket_id = m.basket_id))) JOIN product.basket b ON ((b.basket_id = mi.entity_id)))
 WHERE ((m.basket_type = 'submarket'::varchar(9)) AND (m.name = 'ANTI-CGRP'::varchar(9)))) a ON ((r.basket_id = a.basket_id)))
 WHERE ((r.market_name ~~* '%ANTI-MIGRAINE MARKET%'::varchar(22)) AND (r.rollup_flag IS NULL) AND (r.report_frequency = 'SPLITWEEK'::varchar(9)) AND (r.ims_id <= '9499999'::varchar(7)))
 GROUP BY r.ims_id,
          r.tvcmid,
          r.prescriber_first_name,
          r.prescriber_last_name,
          r.rollup_month
 ORDER BY r.ims_id,
          r.rollup_month;

CREATE  VIEW outbound.anda_austedoTRx_monthly AS
 SELECT r.ims_id AS IMS_ID,
        r.tvcmid,
        r.prescriber_first_name,
        r.prescriber_last_name,
        r.rollup_month,
        sum(r.trx_count) AS AUSTEDO_TRx
 FROM (datamart.prescriber_rx r JOIN ( SELECT prescriber_rx.rollup_month AS month_end
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.basket_name ~~* '%AUSTEDO%'::varchar(9)) AND (prescriber_rx.rollup_flag IS NULL) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.rollup_month <= last_day((trunc((now())::timestamp, 'DD'::varchar(2)) + '-1'::interval month))))
 GROUP BY prescriber_rx.rollup_month
 ORDER BY prescriber_rx.rollup_month DESC
 LIMIT 12) m ON ((r.rollup_month = m.month_end)))
 WHERE ((r.basket_name ~~* '%AUSTEDO%'::varchar(9)) AND (r.rollup_flag IS NULL) AND (r.report_frequency = 'SPLITWEEK'::varchar(9)) AND (r.ims_id <= '9499999'::varchar(7)))
 GROUP BY r.ims_id,
          r.tvcmid,
          r.prescriber_first_name,
          r.prescriber_last_name,
          r.rollup_month
 ORDER BY r.ims_id,
          r.rollup_month;

CREATE  VIEW outbound.zs_xpd_addon_details_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.addon_from_product_group_num,
        rx.addon_from_basket_id,
        rx.addon_from_basket_name,
        rx.addon_to_product_group_num,
        rx.addon_to_basket_id,
        rx.addon_to_basket_name,
        rx.rollup_period,
        rx.addon_rx,
        rx.report_frequency
 FROM ((datamart.xpd_add_on_details rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.addon_from_product_group_num,
          rx.addon_from_basket_id,
          rx.addon_from_basket_name,
          rx.addon_to_product_group_num,
          rx.addon_to_basket_id,
          rx.addon_to_basket_name,
          rx.rollup_period,
          rx.addon_rx,
          rx.report_frequency;

CREATE  VIEW outbound.hco_hcp_affiliation AS
 SELECT hco.tvcmid AS hco_tvcmid,
        hco.business_name,
        af.role_vod__c AS affiliation_role,
        af.influence_vod__c AS affiliation_influence,
        ((hcp.lastname || ', '::varchar(2)) || hcp.firstname) AS hcp_name,
        hcp.cm_id_tva__c AS hcp_tvcmid
 FROM (((datamart.customer_hco_demographics hco JOIN veeva.v_account ac ON ((hco.tvcmid = ac.cm_id_tva__c))) JOIN veeva.v_affiliation af ON ((af.to_account_vod__c = ac.id))) JOIN veeva.v_account hcp ON (((hcp.id = af.from_account_vod__c) AND (hcp.ispersonaccount = 'true'::varchar(4)))))
 WHERE ((hco.cot_classification = 'OUTPATIENT CENTER'::varchar(17)) AND (hco.cot_facility_type = 'MEDICAL GROUP'::varchar(13)) AND (hco.cot_specialty = ANY (ARRAY['NEUROLOGY'::varchar(15), 'PAIN MANAGEMENT'::varchar(15)])) AND (ac.ispersonaccount = 'false'::varchar(5)) AND (hcp.cm_id_tva__c IS NOT NULL) AND (ac.account_status_tva__c = 'ACTIVE'::varchar(6)))
 GROUP BY hco.tvcmid,
          hco.business_name,
          af.role_vod__c,
          af.influence_vod__c,
          ((hcp.lastname || ', '::varchar(2)) || hcp.firstname),
          hcp.cm_id_tva__c;

CREATE  VIEW sandbox.v_call AS
 SELECT x.id,
        x.ownerid,
        x.isdeleted,
        x.name,
        x.recordtypeid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.sample_card_vod__c,
        x.add_detail_vod__c,
        x.property_vod__c,
        x.account_vod__c,
        x.zvod_product_discussion_vod__c,
        x.status_vod__c,
        x.parent_address_vod__c,
        x.account_plan_vod__c,
        x.zvod_savenew_vod__c,
        x.next_call_notes_vod__c,
        x.mobile_id_vod__c,
        x.zvod_account_credentials_vod_c,
        x.zvod_account_preferred_name_vo,
        x.zvod_account_sample_status_vod,
        x.zvod_attendees_vod__c,
        x.zvod_key_messages_vod__c,
        x.zvod_detailing_vod__c,
        x.zvod_expenses_vod__c,
        x.zvod_followup_vod__c,
        x.zvod_samples_vod__c,
        x.zvod_save_vod__c,
        x.zvod_submit_vod__c,
        x.zvod_delete_vod__c,
        x.activity_type__c,
        x.significant_event__c,
        x.location_vod__c,
        x.subject_vod__c,
        x.call_datetime_vod__c,
        x.disbursed_to_vod__c,
        x.request_receipt_vod__c,
        x.signature_date_vod__c,
        x.territory_vod__c,
        x.submitted_by_mobile_vod__c,
        x.call_type_vod__c,
        x.add_key_message_vod__c,
        x.address_vod__c,
        x.attendees_vod__c,
        x.attendee_type_vod__c,
        x.call_date_vod__c,
        x.detailed_products_vod__c,
        x.no_disbursement_vod__c,
        x.parent_call_vod__c,
        x.user_vod__c,
        x.contact_vod__c,
        x.zvod_entity_vod__c,
        x.medical_event_vod__c,
        x.mobile_created_datetime_vod__c,
        x.mobile_last_modified_datetime,
        x.license_vod__c,
        x.is_parent_call_vod__c,
        x.entity_display_name_vod__c,
        x.last_device_vod__c,
        x.ship_address_line_1_vod__c,
        x.ship_address_line_2_vod__c,
        x.ship_city_vod__c,
        x.ship_country_vod__c,
        x.ship_license_expiration_date,
        x.ship_license_status_vod__c,
        x.ship_license_vod__c,
        x.ship_state_vod__c,
        x.ship_to_address_vod__c,
        x.ship_zip_vod__c,
        x.ship_to_address_text_vod__c,
        x.clm_vod__c,
        x.zvod_clmdetails_vod__c,
        x.is_sampled_call_vod__c,
        x.zvod_surveys_vod__c,
        x.presentations_vod__c,
        x.entity_reference_id_vod__c,
        x.error_reference_call_vod__c,
        x.duration_vod__c,
        x.color_vod__c,
        x.allowed_products_vod__c,
        x.zvod_attachments_vod__c,
        x.sample_card_reason_vod__c,
        x.assmca_vod__c,
        x.address_line_1_vod__c,
        x.address_line_2_vod__c,
        x.city_vod__c,
        x.dea_address_line_1_vod__c,
        x.dea_address_line_2_vod__c,
        x.dea_address_vod__c,
        x.dea_city_vod__c,
        x.dea_expiration_date_vod__c,
        x.dea_state_vod__c,
        x.dea_zip_4_vod__c,
        x.dea_zip_vod__c,
        x.dea_vod__c,
        x.ship_zip_4_vod__c,
        x.state_vod__c,
        x.zip_4_vod__c,
        x.zip_vod__c,
        x.sample_send_card_vod__c,
        x.zvod_address_vod_c_dea_status_,
        x.signature_page_image_vod__c,
        x.credentials_vod__c,
        x.salutation_vod__c,
        x.zvod_account_call_reminder_vod,
        x.sales_org_tva__c,
        x.zvod_business_account_vod__c,
        x.product_priority_1_vod__c,
        x.product_priority_2_vod__c,
        x.product_priority_3_vod__c,
        x.product_priority_4_vod__c,
        x.product_priority_5_vod__c,
        x.zvod_more_actions_vod__c,
        x.zvod_call_conflict_status,
        x.signature_timestamp_vod__c,
        x.expense_amount_vod__c,
        x.total_expense_attendees_count,
        x.attendee_list_vod__c,
        x.expense_post_status_vod__c,
        x.attendee_post_status_vod__c,
        x.expense_system_external_id,
        x.incurred_expense_vod__c,
        x.assigner_vod__c,
        x.assignment_datetime_vod__c,
        x.zvod_call_objective_vod__c,
        x.signature_location_longitude,
        x.signature_location_latitude,
        x.location_services_status,
        x.created_by_timezone_tva__c,
        x.license_expiration_date_vod__c,
        x.license_status_vod__c,
        x.ship_assmca_vod__c,
        x.ship_dea_expiration_date,
        x.ship_dea_vod__c,
        x.call_method_tva__c,
        x.bendeka_indication_tva__c,
        x.file_id,
        x.record_id,
        x.austedo_indication_tva__c,
        x.call_duration_tva__c,
        x.how_executed_tva__c,
        x.Remote_Meeting_vod__c,
        x.Veeva_Remote_Meeting_Id_vod__c,
        x.Cobrowse_URL_Participant_vod__c,
        x.Signature_Captured_Remotely_vod__c,
        x.Remote_Signature_Attendee_Name_vod__c
 FROM (veeva.call x JOIN ( SELECT call.id,
        max(call.file_id) AS file_id
 FROM veeva.call
 WHERE (call.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.v_call_detail AS
 SELECT x.id,
        x.isdeleted,
        x.name,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.mayedit,
        x.islocked,
        x.is_parent_call_vod__c,
        x.call2_vod__c,
        x.product_vod__c,
        x.detail_priority_vod__c,
        x.mobile_id_vod__c,
        x.type_vod__c,
        x.file_id,
        x.record_id
 FROM (veeva.call_detail x JOIN ( SELECT call_detail.id,
        max(call_detail.file_id) AS file_id
 FROM veeva.call_detail
 WHERE (call_detail.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call_detail.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW outbound.newman_roster AS
 SELECT rep.territory_number AS Territory,
        rep.last_name AS LastName,
        rep.first_name AS FirstName,
        substr(rep.middle_name, 1, 1) AS "Middle Initial",
        rep.suffix AS Suffix,
        CASE WHEN regexp_like(rep.employee_id, '^[[:digit:]]'::varchar(12), ''::varchar) THEN ('A'::varchar(1) || rep.employee_id) ELSE rep.employee_id END AS "Teva ID",
        rep.email AS Email,
        rep.business_address_line1 AS "Business Address1",
        rep.business_address_line2 AS "Business Address2",
        rep.shipping_address_line3 AS "Business Address3",
        rep.business_city AS "Business City",
        rep.business_state AS "Business State",
        rep.business_zip AS "Business Zip",
        rep.shipping_address_line1 AS "Shipping Address1",
        rep.shipping_address_line2 AS "Shipping Address2",
        rep.shipping_address_line3 AS "Shipping Address3",
        rep.shipping_city AS "Shipping City",
        rep.shipping_state AS "Shipping State",
        rep.shipping_zip AS "Shipping Zip",
        rep.mobile_phone AS "Cell Phone",
        rep.business_phone AS "Business Phone",
        rep.sales_force_id AS Company,
        CASE WHEN (upper(rep.reg_contract) = 'EX'::varchar(2)) THEN 'Contractor'::varchar(10) ELSE 'Associate'::varchar(9) END AS "Profile Type",
        coalesce(rep.username, 'zzzzz'::varchar(5)) AS "Newman User Name"
 FROM datamart.roster rep
 WHERE ((rep.employee_id IS NOT NULL) AND (rep.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TE'::varchar(2), 'TM'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])));

CREATE  VIEW outbound.zs_revo_engage_call_activity AS
 SELECT engage_call_activity.call_id,
        engage_call_activity.engage_meeting_id,
        engage_call_activity.sales_force_id,
        engage_call_activity.territory_number,
        engage_call_activity.tvcmid,
        engage_call_activity.call_record_type,
        engage_call_activity.call_type,
        engage_call_activity.customer_type,
        engage_call_activity.how_executed,
        engage_call_activity.rep_first_name,
        engage_call_activity.rep_last_name,
        engage_call_activity.hcp_first_name,
        engage_call_activity.hcp_last_name,
        engage_call_activity.hco_name,
        engage_call_activity.call_date,
        engage_call_activity.address,
        engage_call_activity.first_product_detailed,
        engage_call_activity.second_product_detailed,
        engage_call_activity.third_product_detailed,
        engage_call_activity.meeting_scheduled_date,
        engage_call_activity.latest_meeting_start_date,
        engage_call_activity.meeting_duration,
        engage_call_activity.non_host_attendees,
        engage_call_activity.avg_attendee_duration,
        engage_call_activity.hcp_invites,
        engage_call_activity.teva_engage_meeting_status,
        engage_call_activity.attendance_report_process_status_vod__c,
        engage_call_activity.meeting_outcome_status_vod__c
 FROM reporting.engage_call_activity
 WHERE ((engage_call_activity.first_product_detailed <> ALL (ARRAY['Blink Health  AJOVY'::varchar(24), 'Blink Health  AUSTEDO'::varchar(24), 'Unassociated'::varchar(24)])) AND (engage_call_activity.second_product_detailed <> ALL (ARRAY['Blink Health  AJOVY'::varchar(24), 'Blink Health  AUSTEDO'::varchar(24), 'Unassociated'::varchar(24)])) AND (engage_call_activity.third_product_detailed <> ALL (ARRAY['Blink Health  AJOVY'::varchar(24), 'Blink Health  AUSTEDO'::varchar(24), 'Unassociated'::varchar(24)])) AND (engage_call_activity.call_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))));

CREATE  VIEW outbound.zs_revo_approved_email AS
 SELECT approved_email.veeva_sent_email_id,
        approved_email.sent_email_id,
        approved_email.product,
        approved_email.date_sent,
        approved_email.status,
        approved_email.failure_message,
        approved_email.veeva_account_id,
        approved_email.tvcmid,
        approved_email.veeva_call_id,
        approved_email.call_id,
        approved_email.sender_email,
        approved_email.territory,
        approved_email.recipient_email,
        approved_email.click_count,
        approved_email.open_count,
        approved_email.last_open_date,
        approved_email.valid_consent,
        approved_email.delivered,
        approved_email.opened,
        approved_email.dropped,
        approved_email.clicked,
        approved_email.downloaded,
        approved_email.viewed,
        approved_email.template_id,
        approved_email.template_name,
        approved_email.event_msg_vod__c,
        approved_email.click_url_vod__c,
        approved_email.subject
 FROM reporting.approved_email
 WHERE ((upper(approved_email.template_name) !~~ upper('%Blink%'::varchar(7))) AND (approved_email.date_sent >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))));

CREATE  VIEW outbound.speakers_weekly AS
 SELECT ap.sourcesystemid,
        ap.batchdate,
        ap.transactionstatuscode,
        ap.interactioncode,
        ap.clientcustomerid,
        ap.participanttype,
        ap.firstname,
        ap.middlename,
        ap.lastname,
        ap.suffix,
        ap.professionaldesignation,
        ap.primaryspecialty,
        ap.organizationname,
        ap.clientaddressid,
        ap.addressline1,
        ap.addressline2,
        ap.addressline3,
        ap.addresscity,
        ap.addressstateprovince,
        ap.addresspostalcode,
        ap.addresspostalcodeextension,
        ap.addresscountry,
        ap.region,
        ap.primarystatelicensestate,
        ap.primarystatelicensenumber,
        ap.attended,
        ap.mealconsumed,
        ap.contractid,
        ap.clientcontractid,
        ap.contractname,
        ap.contractcategory,
        ap.contractsubcategory,
        ap.contractclassification,
        ap.contracttier,
        ap.contracteffectivedate,
        ap.contractexpirationdate,
        ai.interactionname,
        ai.interactioncategory,
        ai.interactiontype,
        ai.locationtype,
        ai.interactionstatus,
        ai.interactionstartdate,
        ai.interactionenddate,
        ai.interactionstartdatetime,
        ai.interactionenddatetime,
        ai.requestingregion,
        ai.parentinteractioncode,
        ai.clientemployeeid,
        ai.employeefirstname,
        ai.employeelastname,
        ai.employeeorganizationunitcode,
        ai.employeeorganizationunitname,
        ai.venuename,
        ai.venueaddressline1,
        ai.venueaddressline2,
        ai.venueaddressline3,
        ai.venuecity,
        ai.venuestateprovince,
        ai.venuepostalcode,
        ai.venuecountry,
        ai.venueregion,
        ai.totalestimatedparticipantcount,
        ai.financialcloseddate,
        ai.product1name,
        ai.topic1name,
        ai.product2name,
        ai.topic2name,
        ai.product3name,
        ai.topic3name,
        ai.product4name,
        ai.topic4name,
        ai.product5name,
        ai.topic5name
 FROM (datamart.ahm_participant ap JOIN datamart.ahm_interactions ai ON (((ap.interactionid = ai.interactionid) AND (ai.batchdate = ap.batchdate) AND ((ai.product1name = ANY (ARRAY['AUSTEDO'::varchar(19), 'AJOVY'::varchar(19), 'Digihaler Portfolio'::varchar(19)])) OR (ai.product2name = ANY (ARRAY['AUSTEDO'::varchar(19), 'AJOVY'::varchar(19), 'Digihaler Portfolio'::varchar(19)])) OR (ai.product3name = ANY (ARRAY['AUSTEDO'::varchar(19), 'AJOVY'::varchar(19), 'Digihaler Portfolio'::varchar(19)])) OR (ai.product4name = ANY (ARRAY['AUSTEDO'::varchar(19), 'AJOVY'::varchar(19), 'Digihaler Portfolio'::varchar(19)])) OR (ai.product5name = ANY (ARRAY['AUSTEDO'::varchar(19), 'AJOVY'::varchar(19), 'Digihaler Portfolio'::varchar(19)]))) AND (ai.interactionstartdate >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))))
 GROUP BY ap.sourcesystemid,
          ap.batchdate,
          ap.transactionstatuscode,
          ap.interactioncode,
          ap.clientcustomerid,
          ap.participanttype,
          ap.firstname,
          ap.middlename,
          ap.lastname,
          ap.suffix,
          ap.professionaldesignation,
          ap.primaryspecialty,
          ap.organizationname,
          ap.clientaddressid,
          ap.addressline1,
          ap.addressline2,
          ap.addressline3,
          ap.addresscity,
          ap.addressstateprovince,
          ap.addresspostalcode,
          ap.addresspostalcodeextension,
          ap.addresscountry,
          ap.region,
          ap.primarystatelicensestate,
          ap.primarystatelicensenumber,
          ap.attended,
          ap.mealconsumed,
          ap.contractid,
          ap.clientcontractid,
          ap.contractname,
          ap.contractcategory,
          ap.contractsubcategory,
          ap.contractclassification,
          ap.contracttier,
          ap.contracteffectivedate,
          ap.contractexpirationdate,
          ai.interactionname,
          ai.interactioncategory,
          ai.interactiontype,
          ai.locationtype,
          ai.interactionstatus,
          ai.interactionstartdate,
          ai.interactionenddate,
          ai.interactionstartdatetime,
          ai.interactionenddatetime,
          ai.requestingregion,
          ai.parentinteractioncode,
          ai.clientemployeeid,
          ai.employeefirstname,
          ai.employeelastname,
          ai.employeeorganizationunitcode,
          ai.employeeorganizationunitname,
          ai.venuename,
          ai.venueaddressline1,
          ai.venueaddressline2,
          ai.venueaddressline3,
          ai.venuecity,
          ai.venuestateprovince,
          ai.venuepostalcode,
          ai.venuecountry,
          ai.venueregion,
          ai.totalestimatedparticipantcount,
          ai.financialcloseddate,
          ai.product1name,
          ai.topic1name,
          ai.product2name,
          ai.topic2name,
          ai.product3name,
          ai.topic3name,
          ai.product4name,
          ai.topic4name,
          ai.product5name,
          ai.topic5name;

CREATE  VIEW teva_ingestion.EXT_VV_SUGGESTION_FEEDBACK_VOD__C AS
 SELECT btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.id) AS id,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.name) AS name,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.recordtypeid) AS recordtypeid,
        CASE WHEN (EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.createddate))::timestamp END AS createddate,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        CASE WHEN (EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.systemmodstamp = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.systemmodstamp))::timestamp END AS systemmodstamp,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.suggestion_vod__c) AS suggestion_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.activity_execution_type_vod__c) AS activity_execution_type_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.call2_vod__c) AS call2_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.dismissfeedback1_vod__c) AS dismissfeedback1_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.dismissfeedback2_vod__c) AS dismissfeedback2_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.dismissfeedback3_vod__c) AS dismissfeedback3_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.dismissfeedback4_vod__c) AS dismissfeedback4_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.sent_email_vod__c) AS sent_email_vod__c,
        EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.batch_id,
        EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.row_id,
        EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src;

CREATE  VIEW sandbox.vw_curr_provider_override_default_v1 AS
 SELECT btrim(provider_override_default_v1.provider_id) AS provider_id,
        btrim(provider_override_default_v1.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v1.provider_name) AS provider_name,
        btrim(provider_override_default_v1.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v1.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v1.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v1.override_best_iqvia_pbm) AS override_best_iqvia_pbm,
        provider_override_default_v1.file_id,
        provider_override_default_v1.record_id
 FROM sandbox.provider_override_default_v1
 WHERE (provider_override_default_v1.file_id IN ( SELECT max(provider_override_default_v1.file_id) AS max
 FROM sandbox.provider_override_default_v1));

CREATE  VIEW sandbox.vw_curr_calculated_pbm_config_v1 AS
 SELECT btrim(calculated_pbm_config_v1.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v1.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v1.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v1.calculated_pbm_column) AS calculated_pbm_column,
        calculated_pbm_config_v1.file_id,
        calculated_pbm_config_v1.record_id
 FROM sandbox.calculated_pbm_config_v1
 WHERE (calculated_pbm_config_v1.file_id IN ( SELECT max(calculated_pbm_config_v1.file_id) AS max
 FROM sandbox.calculated_pbm_config_v1));

CREATE  VIEW sandbox.vw_curr_has_pa_mapping_v1 AS
 SELECT has_pa_mapping_v1.has_pa,
        btrim(has_pa_mapping_v1.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v1.notes) AS notes,
        has_pa_mapping_v1.file_id,
        has_pa_mapping_v1.record_id
 FROM sandbox.has_pa_mapping_v1
 WHERE (has_pa_mapping_v1.file_id IN ( SELECT max(has_pa_mapping_v1.file_id) AS max
 FROM sandbox.has_pa_mapping_v1));

CREATE  VIEW sandbox.vw_curr_has_st_mapping_v1 AS
 SELECT has_st_mapping_v1.has_st,
        btrim(has_st_mapping_v1.st_regex) AS st_regex,
        btrim(has_st_mapping_v1.notes) AS notes,
        has_st_mapping_v1.file_id,
        has_st_mapping_v1.record_id
 FROM sandbox.has_st_mapping_v1
 WHERE (has_st_mapping_v1.file_id IN ( SELECT max(has_st_mapping_v1.file_id) AS max
 FROM sandbox.has_st_mapping_v1));

CREATE  VIEW sandbox.vw_curr_calc_pbm_key_pbm_mapping_v1 AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v1.calculated_pbm) AS calculated_pbm_value,
        btrim(calc_pbm_key_pbm_mapping_v1.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v1.added_by) AS added_by,
        calc_pbm_key_pbm_mapping_v1.file_id,
        calc_pbm_key_pbm_mapping_v1.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v1
 WHERE (calc_pbm_key_pbm_mapping_v1.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v1.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v1));

CREATE  VIEW sandbox.vw_curr_copay_tier_derivation_config AS
 SELECT btrim(copay_tier_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(copay_tier_derivation_config_v1.tier_cat) AS tier_cat,
        btrim(copay_tier_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v1.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v1.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v1.copay_tier) AS copay_tier,
        copay_tier_derivation_config_v1.file_id,
        copay_tier_derivation_config_v1.record_id
 FROM sandbox.copay_tier_derivation_config_v1
 WHERE (copay_tier_derivation_config_v1.file_id IN ( SELECT max(copay_tier_derivation_config_v1.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_restriction_category_derivation_config AS
 SELECT btrim(restriction_category_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v1.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v1.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v1.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v1.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v1.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v1.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v1.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v1.restcat,
        btrim(restriction_category_derivation_config_v1.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v1.meaning) AS meaning,
        restriction_category_derivation_config_v1.file_id,
        restriction_category_derivation_config_v1.record_id
 FROM sandbox.restriction_category_derivation_config_v1
 WHERE (restriction_category_derivation_config_v1.file_id IN ( SELECT max(restriction_category_derivation_config_v1.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_formulary_derivation_config AS
 SELECT btrim(formulary_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v1.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v1.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v1.formulary) AS formulary,
        btrim(formulary_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v1.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v1.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        formulary_derivation_config_v1.file_id,
        formulary_derivation_config_v1.record_id
 FROM sandbox.formulary_derivation_config_v1
 WHERE (formulary_derivation_config_v1.file_id IN ( SELECT max(formulary_derivation_config_v1.file_id) AS max
 FROM sandbox.formulary_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_key_controller_list_v1 AS
 SELECT key_controller_list_v1.ftf_health_plan_fid,
        btrim(key_controller_list_v1.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v1.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v1.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v1.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v1.payer_pbm) AS payer_pbm,
        key_controller_list_v1.file_id,
        key_controller_list_v1.record_id
 FROM sandbox.key_controller_list_v1
 WHERE (key_controller_list_v1.file_id IN ( SELECT max(key_controller_list_v1.file_id) AS max
 FROM sandbox.key_controller_list_v1));

CREATE  VIEW sandbox.vw_curr_botox_step_restriction_v1 AS
 SELECT botox_step_restriction_v1.code,
        btrim(botox_step_restriction_v1.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v1.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v1.notes) AS notes,
        botox_step_restriction_v1.file_id,
        botox_step_restriction_v1.record_id
 FROM sandbox.botox_step_restriction_v1
 WHERE (botox_step_restriction_v1.file_id IN ( SELECT max(botox_step_restriction_v1.file_id) AS max
 FROM sandbox.botox_step_restriction_v1));

CREATE  VIEW sandbox.vw_curr_step_restriction_v1 AS
 SELECT step_restriction_v1.code,
        btrim(step_restriction_v1.step_category) AS step_category,
        btrim(step_restriction_v1.restriction_group) AS restriction_group,
        btrim(step_restriction_v1.notes) AS notes,
        step_restriction_v1.file_id,
        step_restriction_v1.record_id
 FROM sandbox.step_restriction_v1
 WHERE (step_restriction_v1.file_id IN ( SELECT max(step_restriction_v1.file_id) AS max
 FROM sandbox.step_restriction_v1));

CREATE  VIEW sandbox.vw_curr_pa_restriction_v1 AS
 SELECT pa_restriction_v1.code,
        btrim(pa_restriction_v1.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v1.notes) AS notes,
        pa_restriction_v1.file_id,
        pa_restriction_v1.record_id
 FROM sandbox.pa_restriction_v1
 WHERE (pa_restriction_v1.file_id IN ( SELECT max(pa_restriction_v1.file_id) AS max
 FROM sandbox.pa_restriction_v1));

CREATE  VIEW sandbox.vw_curr_patient_pa_restriction_v1 AS
 SELECT patient_pa_restriction_v1.code,
        btrim(patient_pa_restriction_v1.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v1.notes) AS notes,
        patient_pa_restriction_v1.file_id,
        patient_pa_restriction_v1.record_id
 FROM sandbox.patient_pa_restriction_v1
 WHERE (patient_pa_restriction_v1.file_id IN ( SELECT max(patient_pa_restriction_v1.file_id) AS max
 FROM sandbox.patient_pa_restriction_v1));

CREATE  VIEW sandbox.vw_curr_medical_rec_restriction_v1 AS
 SELECT medical_rec_restriction_v1.code,
        btrim(medical_rec_restriction_v1.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v1.notes) AS notes,
        medical_rec_restriction_v1.file_id,
        medical_rec_restriction_v1.record_id
 FROM sandbox.medical_rec_restriction_v1
 WHERE (medical_rec_restriction_v1.file_id IN ( SELECT max(medical_rec_restriction_v1.file_id) AS max
 FROM sandbox.medical_rec_restriction_v1));

CREATE  VIEW sandbox.vw_curr_unspecified_rec_restriction_v1 AS
 SELECT unspecified_rec_restriction_v1.code,
        btrim(unspecified_rec_restriction_v1.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v1.notes) AS notes,
        unspecified_rec_restriction_v1.file_id,
        unspecified_rec_restriction_v1.record_id
 FROM sandbox.unspecified_rec_restriction_v1
 WHERE (unspecified_rec_restriction_v1.file_id IN ( SELECT max(unspecified_rec_restriction_v1.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v1));

CREATE  VIEW sandbox.vw_curr_step_restriction_description_v1 AS
 SELECT step_restriction_description_v1.step,
        btrim(step_restriction_description_v1.description) AS description,
        step_restriction_description_v1.file_id,
        step_restriction_description_v1.record_id
 FROM sandbox.step_restriction_description_v1
 WHERE (step_restriction_description_v1.file_id IN ( SELECT max(step_restriction_description_v1.file_id) AS max
 FROM sandbox.step_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_pres_pa_restriction_description_v1 AS
 SELECT pres_pa_restriction_description_v1.prespa,
        btrim(pres_pa_restriction_description_v1.description) AS description,
        pres_pa_restriction_description_v1.file_id,
        pres_pa_restriction_description_v1.record_id
 FROM sandbox.pres_pa_restriction_description_v1
 WHERE (pres_pa_restriction_description_v1.file_id IN ( SELECT max(pres_pa_restriction_description_v1.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_pat_pa_restriction_description_v1 AS
 SELECT pat_pa_restriction_description_v1.patpa,
        btrim(pat_pa_restriction_description_v1.description) AS description,
        pat_pa_restriction_description_v1.file_id,
        pat_pa_restriction_description_v1.record_id
 FROM sandbox.pat_pa_restriction_description_v1
 WHERE (pat_pa_restriction_description_v1.file_id IN ( SELECT max(pat_pa_restriction_description_v1.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_ftf_paytype_paytypeindex_v1 AS
 SELECT ftf_paytype_paytypeindex_v1.paytype_index,
        btrim(ftf_paytype_paytypeindex_v1.paytype) AS paytype,
        ftf_paytype_paytypeindex_v1.file_id,
        ftf_paytype_paytypeindex_v1.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v1
 WHERE (ftf_paytype_paytypeindex_v1.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v1.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_ftf_override_provider_v1 AS
 SELECT ftf_override_provider_v1.paytype_index,
        ftf_override_provider_v1.ftf_provider_fid,
        ftf_override_provider_v1.file_id,
        ftf_override_provider_v1.record_id
 FROM sandbox.ftf_override_provider_v1
 WHERE (ftf_override_provider_v1.file_id IN ( SELECT max(ftf_override_provider_v1.file_id) AS max
 FROM sandbox.ftf_override_provider_v1));

CREATE  VIEW sandbox.vw_curr_ftf_override_plan_v1 AS
 SELECT ftf_override_plan_v1.paytype_index,
        ftf_override_plan_v1.ftf_health_plan_fid,
        ftf_override_plan_v1.file_id,
        ftf_override_plan_v1.record_id
 FROM sandbox.ftf_override_plan_v1
 WHERE (ftf_override_plan_v1.file_id IN ( SELECT max(ftf_override_plan_v1.file_id) AS max
 FROM sandbox.ftf_override_plan_v1));

CREATE  VIEW sandbox.vw_curr_coverage_category_derivation_config AS
 SELECT btrim(coverage_category_derivation_config_v1.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v1.coverage_cat_code,
        btrim(coverage_category_derivation_config_v1.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v1.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v1.meaning) AS meaning,
        coverage_category_derivation_config_v1.file_id,
        coverage_category_derivation_config_v1.record_id
 FROM sandbox.coverage_category_derivation_config_v1
 WHERE (coverage_category_derivation_config_v1.file_id IN ( SELECT max(coverage_category_derivation_config_v1.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v1));

CREATE  VIEW outbound.mcm_digihaler_copay AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.pharmacy_chain_number,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.create_date,
        copay.occ_payment_type,
        copay.counted_copay,
        copay.auth_refills,
        copay.admin_hcp_npi,
        copay.admin_hcp_name,
        copay.admin_hcp_address,
        copay.admin_hcp_address2,
        copay.admin_hcp_city,
        copay.admin_hcp_state,
        copay.admin_hcp_zip,
        copay.claim_type,
        copay.administration_flag,
        copay.soc_name,
        copay.soc_phone,
        copay.soc_fax,
        copay.soc_address,
        copay.soc_city,
        copay.soc_state,
        copay.soc_zip,
        copay.soc_id,
        copay.soc_npi,
        copay.payer_name,
        copay.cpt_code,
        copay.trans_type,
        copay.previous_payer_id,
        copay.member_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.report_frequency,
        copay.source_name,
        copay.file_id,
        copay.record_id,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay
 WHERE (copay.basket_name ~~ '%DIGIHALER%'::varchar(11))
 ORDER BY copay.fill_date;

CREATE  VIEW sandbox.vw_key_controlling_plan_formulary_coverage_categories AS
 SELECT pivot_plan_prod_master_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_v1.paytype,
        pivot_plan_prod_master_v1.ftf_health_plan_type,
        pivot_plan_prod_master_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_v1.Coverage_Category_Emgality,
        count(DISTINCT pivot_plan_prod_master_v1.ftf_health_plan_fid) AS count_ftf_health_plan_fid,
        sum(pivot_plan_prod_master_v1.lives_mn) AS sum_lives,
        dense_rank() OVER (PARTITION BY pivot_plan_prod_master_v1.key_controlling_plan_formulary ORDER BY pivot_plan_prod_master_v1.key_controlling_plan_formulary) AS sequence
 FROM sandbox.pivot_plan_prod_master_v1 pivot_plan_prod_master_v1
 GROUP BY pivot_plan_prod_master_v1.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1.paytype,
          pivot_plan_prod_master_v1.ftf_health_plan_type,
          pivot_plan_prod_master_v1.Coverage_Category_Ajovy,
          pivot_plan_prod_master_v1.Coverage_Category_Aimovig,
          pivot_plan_prod_master_v1.Coverage_Category_Emgality
 ORDER BY pivot_plan_prod_master_v1.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1.paytype,
          pivot_plan_prod_master_v1.ftf_health_plan_type;

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_formularies_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_formularies_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_formularies_cdw.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies_cdw.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies_cdw
 WHERE (raw_ftf_formularies_cdw.file_id IN ( SELECT max(raw_ftf_formularies_cdw.file_id) AS max
 FROM sandbox.raw_ftf_formularies_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plan_geography_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography_cdw.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography_cdw.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 WHERE (raw_ftf_health_plan_geography_cdw.file_id IN ( SELECT max(raw_ftf_health_plan_geography_cdw.file_id) AS max
 FROM sandbox.raw_ftf_health_plan_geography_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_pbms_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms_cdw
 WHERE (raw_ftf_pbms_cdw.file_id IN ( SELECT max(raw_ftf_pbms_cdw.file_id) AS max
 FROM sandbox.raw_ftf_pbms_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_restrictions_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_restrictions_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions_cdw.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions_cdw.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions_cdw.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions_cdw.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions_cdw.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_cdw
 WHERE (raw_ftf_restrictions_cdw.file_id IN ( SELECT max(raw_ftf_restrictions_cdw.file_id) AS max
 FROM sandbox.raw_ftf_restrictions_cdw));

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref_cdw AS
 SELECT (replace(replace(btrim(raw_iqvia_plan_cdw.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_iqvia_plan_cdw.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_num,
        (replace(replace(btrim(raw_iqvia_plan_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan_cdw.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan_cdw.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan_cdw.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan_cdw.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan_cdw.months_with_data
 FROM sandbox.raw_iqvia_plan_cdw
 WHERE (raw_iqvia_plan_cdw.file_id IN ( SELECT max(raw_iqvia_plan_cdw.file_id) AS max
 FROM sandbox.raw_iqvia_plan_cdw));

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref_cdw AS
 SELECT replace(replace(btrim(raw_iqvia_pbm_cdw.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        (replace(replace(btrim(raw_iqvia_pbm_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm_cdw.pbm_num,
        raw_iqvia_pbm_cdw.ims_processor_num
 FROM sandbox.raw_iqvia_pbm_cdw
 WHERE (raw_iqvia_pbm_cdw.file_id IN ( SELECT max(raw_iqvia_pbm_cdw.file_id) AS max
 FROM sandbox.raw_iqvia_pbm_cdw));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_formularies_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_formularies_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_formularies_cdw.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies_cdw.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies_cdw
 WHERE (raw_ftf_formularies_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_formularies_cdw.file_id
 FROM sandbox.raw_ftf_formularies_cdw
 GROUP BY raw_ftf_formularies_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plans_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plans_cdw.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS formularyf_id,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans_cdw.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        raw_ftf_health_plans_cdw.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_cdw
 WHERE (raw_ftf_health_plans_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_health_plans_cdw.file_id
 FROM sandbox.raw_ftf_health_plans_cdw
 GROUP BY raw_ftf_health_plans_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plan_geography_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plan_geography_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography_cdw.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography_cdw.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 WHERE (raw_ftf_health_plan_geography_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_health_plan_geography_cdw.file_id
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 GROUP BY raw_ftf_health_plan_geography_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_pbms_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_pbms_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms_cdw
 WHERE (raw_ftf_pbms_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_pbms_cdw.file_id
 FROM sandbox.raw_ftf_pbms_cdw
 GROUP BY raw_ftf_pbms_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_restrictions_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_restrictions_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions_cdw.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions_cdw.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions_cdw.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions_cdw.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions_cdw.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_cdw
 WHERE (raw_ftf_restrictions_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_restrictions_cdw.file_id
 FROM sandbox.raw_ftf_restrictions_cdw
 GROUP BY raw_ftf_restrictions_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_plan_xref_cdw AS
 SELECT (replace(replace(btrim(raw_iqvia_plan_cdw.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_iqvia_plan_cdw.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_num,
        (replace(replace(btrim(raw_iqvia_plan_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan_cdw.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan_cdw.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan_cdw.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan_cdw.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan_cdw.months_with_data
 FROM sandbox.raw_iqvia_plan_cdw
 WHERE (raw_iqvia_plan_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_iqvia_plan_cdw.file_id
 FROM sandbox.raw_iqvia_plan_cdw
 GROUP BY raw_iqvia_plan_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_pbm_xref_cdw AS
 SELECT replace(replace(btrim(raw_iqvia_pbm_cdw.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        (replace(replace(btrim(raw_iqvia_pbm_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm_cdw.pbm_num,
        raw_iqvia_pbm_cdw.ims_processor_num
 FROM sandbox.raw_iqvia_pbm_cdw
 WHERE (raw_iqvia_pbm_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_iqvia_pbm_cdw.file_id
 FROM sandbox.raw_iqvia_pbm_cdw
 GROUP BY raw_iqvia_pbm_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_curr_iqvia_plans_discard_cdw AS
 SELECT iqvia_plans_discard_v01.payer_id,
        btrim(iqvia_plans_discard_v01.notes) AS notes,
        iqvia_plans_discard_v01.file_id,
        iqvia_plans_discard_v01.record_id
 FROM sandbox.iqvia_plans_discard_v01
 WHERE (iqvia_plans_discard_v01.file_id IN ( SELECT max(iqvia_plans_discard_v01.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v01));

CREATE  VIEW sandbox.vw_curr_model_paytype_map_cdw AS
 SELECT btrim(model_paytype_map_v01.model) AS model,
        btrim(model_paytype_map_v01.paytype) AS paytype,
        btrim(model_paytype_map_v01.notes) AS notes,
        model_paytype_map_v01.file_id,
        model_paytype_map_v01.record_id
 FROM sandbox.model_paytype_map_v01
 WHERE (model_paytype_map_v01.file_id IN ( SELECT max(model_paytype_map_v01.file_id) AS max
 FROM sandbox.model_paytype_map_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_paytypeindex_cdw AS
 SELECT iqvia_paytypeindex_v01.paytype_index,
        btrim(iqvia_paytypeindex_v01.paytype) AS paytype,
        iqvia_paytypeindex_v01.file_id,
        iqvia_paytypeindex_v01.record_id
 FROM sandbox.iqvia_paytypeindex_v01
 WHERE (iqvia_paytypeindex_v01.file_id IN ( SELECT max(iqvia_paytypeindex_v01.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_paytype_override_cdw AS
 SELECT btrim(iqvia_payer_paytype_override_v01.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v01.paytype) AS paytype,
        iqvia_payer_paytype_override_v01.file_id,
        iqvia_payer_paytype_override_v01.record_id
 FROM sandbox.iqvia_payer_paytype_override_v01
 WHERE (iqvia_payer_paytype_override_v01.file_id IN ( SELECT max(iqvia_payer_paytype_override_v01.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v01));

CREATE  VIEW sandbox.vw_curr_ftf_plans_paytypeindex_cdw AS
 SELECT btrim(ftf_plans_paytypeindex_v01.ftf_health_plan_type) AS ftf_health_plan_type,
        ftf_plans_paytypeindex_v01.paytype_index,
        ftf_plans_paytypeindex_v01.file_id,
        ftf_plans_paytypeindex_v01.record_id
 FROM sandbox.ftf_plans_paytypeindex_v01
 WHERE (ftf_plans_paytypeindex_v01.file_id IN ( SELECT max(ftf_plans_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_ftf_paytype_paytypeindex_cdw AS
 SELECT ftf_paytype_paytypeindex_v01.paytype_index,
        btrim(ftf_paytype_paytypeindex_v01.paytype) AS paytype,
        ftf_paytype_paytypeindex_v01.file_id,
        ftf_paytype_paytypeindex_v01.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v01
 WHERE (ftf_paytype_paytypeindex_v01.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_ftf_override_provider_cdw AS
 SELECT ftf_override_provider_v01.provider_fid,
        ftf_override_provider_v01.paytype_index,
        btrim(ftf_override_provider_v01.notes) AS notes,
        ftf_override_provider_v01.file_id,
        ftf_override_provider_v01.record_id
 FROM sandbox.ftf_override_provider_v01
 WHERE (ftf_override_provider_v01.file_id IN ( SELECT max(ftf_override_provider_v01.file_id) AS max
 FROM sandbox.ftf_override_provider_v01));

CREATE  VIEW sandbox.vw_curr_ftf_override_plan_cdw AS
 SELECT ftf_override_plan_v01.ftf_health_plan_fid,
        ftf_override_plan_v01.paytype_index,
        btrim(ftf_override_plan_v01.notes) AS notes,
        ftf_override_plan_v01.file_id,
        ftf_override_plan_v01.record_id
 FROM sandbox.ftf_override_plan_v01
 WHERE (ftf_override_plan_v01.file_id IN ( SELECT max(ftf_override_plan_v01.file_id) AS max
 FROM sandbox.ftf_override_plan_v01));

CREATE  VIEW sandbox.vw_curr_drug_assignments_cdw AS
 SELECT drug_assignments_v01.drug_id,
        drug_assignments_v01.drug_seq,
        btrim(drug_assignments_v01.product) AS product,
        drug_assignments_v01.file_id,
        drug_assignments_v01.record_id
 FROM sandbox.drug_assignments_v01
 WHERE (drug_assignments_v01.file_id IN ( SELECT max(drug_assignments_v01.file_id) AS max
 FROM sandbox.drug_assignments_v01));

CREATE  VIEW sandbox.vw_curr_ftf_pbm_functions_cdw AS
 SELECT ftf_pbm_functions_v01.pbm_function_id,
        btrim(ftf_pbm_functions_v01.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v01.notes) AS notes,
        ftf_pbm_functions_v01.used,
        ftf_pbm_functions_v01.file_id,
        ftf_pbm_functions_v01.record_id
 FROM sandbox.ftf_pbm_functions_v01
 WHERE (ftf_pbm_functions_v01.file_id IN ( SELECT max(ftf_pbm_functions_v01.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v01));

CREATE  VIEW sandbox.vw_curr_botox_step_restriction_cdw AS
 SELECT botox_step_restriction_v01.code,
        btrim(botox_step_restriction_v01.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v01.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v01.notes) AS notes,
        botox_step_restriction_v01.file_id,
        botox_step_restriction_v01.record_id
 FROM sandbox.botox_step_restriction_v01
 WHERE (botox_step_restriction_v01.file_id IN ( SELECT max(botox_step_restriction_v01.file_id) AS max
 FROM sandbox.botox_step_restriction_v01));

CREATE  VIEW sandbox.vw_curr_step_restriction_cdw AS
 SELECT step_restriction_v01.code,
        btrim(step_restriction_v01.step_category) AS step_category,
        btrim(step_restriction_v01.restriction_group) AS restriction_group,
        btrim(step_restriction_v01.notes) AS notes,
        step_restriction_v01.file_id,
        step_restriction_v01.record_id
 FROM sandbox.step_restriction_v01
 WHERE (step_restriction_v01.file_id IN ( SELECT max(step_restriction_v01.file_id) AS max
 FROM sandbox.step_restriction_v01));

CREATE  VIEW sandbox.vw_curr_pa_restriction_cdw AS
 SELECT pa_restriction_v01.code,
        btrim(pa_restriction_v01.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v01.notes) AS notes,
        pa_restriction_v01.file_id,
        pa_restriction_v01.record_id
 FROM sandbox.pa_restriction_v01
 WHERE (pa_restriction_v01.file_id IN ( SELECT max(pa_restriction_v01.file_id) AS max
 FROM sandbox.pa_restriction_v01));

CREATE  VIEW sandbox.vw_curr_patient_pa_restriction_cdw AS
 SELECT patient_pa_restriction_v01.code,
        btrim(patient_pa_restriction_v01.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v01.notes) AS notes,
        patient_pa_restriction_v01.file_id,
        patient_pa_restriction_v01.record_id
 FROM sandbox.patient_pa_restriction_v01
 WHERE (patient_pa_restriction_v01.file_id IN ( SELECT max(patient_pa_restriction_v01.file_id) AS max
 FROM sandbox.patient_pa_restriction_v01));

CREATE  VIEW sandbox.vw_curr_medical_rec_restriction_cdw AS
 SELECT medical_rec_restriction_v01.code,
        btrim(medical_rec_restriction_v01.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v01.notes) AS notes,
        medical_rec_restriction_v01.file_id,
        medical_rec_restriction_v01.record_id
 FROM sandbox.medical_rec_restriction_v01
 WHERE (medical_rec_restriction_v01.file_id IN ( SELECT max(medical_rec_restriction_v01.file_id) AS max
 FROM sandbox.medical_rec_restriction_v01));

CREATE  VIEW sandbox.vw_curr_unspecified_rec_restriction_cdw AS
 SELECT unspecified_rec_restriction_v01.code,
        btrim(unspecified_rec_restriction_v01.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v01.notes) AS notes,
        unspecified_rec_restriction_v01.file_id,
        unspecified_rec_restriction_v01.record_id
 FROM sandbox.unspecified_rec_restriction_v01
 WHERE (unspecified_rec_restriction_v01.file_id IN ( SELECT max(unspecified_rec_restriction_v01.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v01));

CREATE  VIEW sandbox.vw_curr_override_bridge_ftf_plan_types_cdw AS
 SELECT btrim(override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v01.override_precedence,
        override_bridge_ftf_plan_types_v01.file_id,
        override_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v01
 WHERE (override_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_curr_delete_bridge_ftf_plan_types_cdw AS
 SELECT btrim(delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.delete_flag) AS delete_flag,
        delete_bridge_ftf_plan_types_v01.file_id,
        delete_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v01
 WHERE (delete_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_curr_provider_override_default_cdw AS
 SELECT provider_override_default_v01.provider_id,
        btrim(provider_override_default_v01.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v01.provider_name) AS provider_name,
        btrim(provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_pbm) AS override_best_iqvia_pbm,
        provider_override_default_v01.file_id,
        provider_override_default_v01.record_id
 FROM sandbox.provider_override_default_v01
 WHERE (provider_override_default_v01.file_id IN ( SELECT max(provider_override_default_v01.file_id) AS max
 FROM sandbox.provider_override_default_v01));

CREATE  VIEW sandbox.vw_curr_key_controller_list_cdw AS
 SELECT key_controller_list_v01.ftf_health_plan_fid,
        btrim(key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v01.payer_pbm) AS payer_pbm,
        key_controller_list_v01.file_id,
        key_controller_list_v01.record_id
 FROM sandbox.key_controller_list_v01
 WHERE (key_controller_list_v01.file_id IN ( SELECT max(key_controller_list_v01.file_id) AS max
 FROM sandbox.key_controller_list_v01));

CREATE  VIEW sandbox.vw_curr_calculated_pbm_config_cdw AS
 SELECT btrim(calculated_pbm_config_v01.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v01.calculated_pbm_column) AS calculated_pbm_column,
        calculated_pbm_config_v01.file_id,
        calculated_pbm_config_v01.record_id
 FROM sandbox.calculated_pbm_config_v01
 WHERE (calculated_pbm_config_v01.file_id IN ( SELECT max(calculated_pbm_config_v01.file_id) AS max
 FROM sandbox.calculated_pbm_config_v01));

CREATE  VIEW sandbox.vw_curr_calc_pbm_key_pbm_mapping_cdw AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v01.calculated_pbm) AS calculated_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.added_by) AS added_by,
        calc_pbm_key_pbm_mapping_v01.file_id,
        calc_pbm_key_pbm_mapping_v01.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v01
 WHERE (calc_pbm_key_pbm_mapping_v01.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v01.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v01));

CREATE  VIEW sandbox.vw_curr_has_pa_mapping_cdw AS
 SELECT has_pa_mapping_v01.has_pa,
        btrim(has_pa_mapping_v01.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v01.notes) AS notes,
        has_pa_mapping_v01.file_id,
        has_pa_mapping_v01.record_id
 FROM sandbox.has_pa_mapping_v01
 WHERE (has_pa_mapping_v01.file_id IN ( SELECT max(has_pa_mapping_v01.file_id) AS max
 FROM sandbox.has_pa_mapping_v01));

CREATE  VIEW sandbox.vw_curr_has_st_mapping_cdw AS
 SELECT has_st_mapping_v01.has_st,
        btrim(has_st_mapping_v01.st_regex) AS st_regex,
        btrim(has_st_mapping_v01.notes) AS notes,
        has_st_mapping_v01.file_id,
        has_st_mapping_v01.record_id
 FROM sandbox.has_st_mapping_v01
 WHERE (has_st_mapping_v01.file_id IN ( SELECT max(has_st_mapping_v01.file_id) AS max
 FROM sandbox.has_st_mapping_v01));

CREATE  VIEW sandbox.vw_curr_formulary_derivation_config_cdw AS
 SELECT btrim(formulary_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v01.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v01.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v01.formulary) AS formulary,
        btrim(formulary_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        formulary_derivation_config_v01.file_id,
        formulary_derivation_config_v01.record_id
 FROM sandbox.formulary_derivation_config_v01
 WHERE (formulary_derivation_config_v01.file_id IN ( SELECT max(formulary_derivation_config_v01.file_id) AS max
 FROM sandbox.formulary_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_restriction_category_derivation_config_cdw AS
 SELECT btrim(restriction_category_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v01.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v01.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v01.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v01.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v01.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v01.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v01.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v01.restcat,
        btrim(restriction_category_derivation_config_v01.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v01.meaning) AS meaning,
        restriction_category_derivation_config_v01.file_id,
        restriction_category_derivation_config_v01.record_id
 FROM sandbox.restriction_category_derivation_config_v01
 WHERE (restriction_category_derivation_config_v01.file_id IN ( SELECT max(restriction_category_derivation_config_v01.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_restriction_cat_description_mapping_cdw AS
 SELECT btrim(restriction_cat_description_mapping_v01.rest_cat) AS rest_cat,
        btrim(restriction_cat_description_mapping_v01.description) AS description,
        btrim(restriction_cat_description_mapping_v01.notes) AS notes,
        restriction_cat_description_mapping_v01.file_id,
        restriction_cat_description_mapping_v01.record_id
 FROM sandbox.restriction_cat_description_mapping_v01
 WHERE (restriction_cat_description_mapping_v01.file_id IN ( SELECT max(restriction_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.restriction_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_coverage_cat_description_mapping_cdw AS
 SELECT btrim(coverage_cat_description_mapping_v01.coverage_cat) AS coverage_cat,
        btrim(coverage_cat_description_mapping_v01.description) AS description,
        btrim(coverage_cat_description_mapping_v01.notes) AS notes,
        coverage_cat_description_mapping_v01.file_id,
        coverage_cat_description_mapping_v01.record_id
 FROM sandbox.coverage_cat_description_mapping_v01
 WHERE (coverage_cat_description_mapping_v01.file_id IN ( SELECT max(coverage_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.coverage_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_step_restriction_description_cdw AS
 SELECT step_restriction_description_v01.step,
        btrim(step_restriction_description_v01.description) AS description,
        step_restriction_description_v01.file_id,
        step_restriction_description_v01.record_id
 FROM sandbox.step_restriction_description_v01
 WHERE (step_restriction_description_v01.file_id IN ( SELECT max(step_restriction_description_v01.file_id) AS max
 FROM sandbox.step_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_pres_pa_restriction_description_cdw AS
 SELECT pres_pa_restriction_description_v01.prespa,
        btrim(pres_pa_restriction_description_v01.description) AS description,
        pres_pa_restriction_description_v01.file_id,
        pres_pa_restriction_description_v01.record_id
 FROM sandbox.pres_pa_restriction_description_v01
 WHERE (pres_pa_restriction_description_v01.file_id IN ( SELECT max(pres_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_pat_pa_restriction_description_cdw AS
 SELECT pat_pa_restriction_description_v01.patpa,
        btrim(pat_pa_restriction_description_v01.description) AS description,
        pat_pa_restriction_description_v01.file_id,
        pat_pa_restriction_description_v01.record_id
 FROM sandbox.pat_pa_restriction_description_v01
 WHERE (pat_pa_restriction_description_v01.file_id IN ( SELECT max(pat_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_override_fid_iqvia_key_controller_list_cdw AS
 SELECT override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
        btrim(override_fid_iqvia_key_controller_list_v01.iqvia_plan_name) AS iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
        btrim(override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(override_fid_iqvia_key_controller_list_v01.payer_pbm) AS payer_pbm,
        override_fid_iqvia_key_controller_list_v01.file_id,
        override_fid_iqvia_key_controller_list_v01.record_id
 FROM sandbox.override_fid_iqvia_key_controller_list_v01
 WHERE (override_fid_iqvia_key_controller_list_v01.file_id IN ( SELECT max(override_fid_iqvia_key_controller_list_v01.file_id) AS max
 FROM sandbox.override_fid_iqvia_key_controller_list_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_plan_preprocessed_cdw_v1 AS
 SELECT iqvia_plan_preprocessed_cdw_v1.iqvia_payer_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_payer_name,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_plan_preprocessed_cdw_v1.model,
        iqvia_plan_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_plan_preprocessed_cdw_v1.paytype,
        iqvia_plan_preprocessed_cdw_v1.paytype_index,
        iqvia_plan_preprocessed_cdw_v1.cycle_id,
        iqvia_plan_preprocessed_cdw_v1.modified_time,
        iqvia_plan_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_preprocessed_cdw_v1
 WHERE (iqvia_plan_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_preprocessed_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_pbm_preprocessed_cdw_v1 AS
 SELECT iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_pbm_preprocessed_cdw_v1.xref_to,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_pbm_preprocessed_cdw_v1.cycle_id,
        iqvia_pbm_preprocessed_cdw_v1.modified_time,
        iqvia_pbm_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_preprocessed_cdw_v1
 WHERE (iqvia_pbm_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_pbm_preprocessed_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 AS
 SELECT ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_name,
        ftf_health_plans_preprocessed_cdw_v1.parent_id,
        ftf_health_plans_preprocessed_cdw_v1.ftf_parent_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_health_plans_preprocessed_cdw_v1.pref_brand_tier,
        ftf_health_plans_preprocessed_cdw_v1.plan_lives,
        ftf_health_plans_preprocessed_cdw_v1.paytype,
        ftf_health_plans_preprocessed_cdw_v1.paytype_index,
        ftf_health_plans_preprocessed_cdw_v1.cycle_id,
        ftf_health_plans_preprocessed_cdw_v1.modified_time,
        ftf_health_plans_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_health_plans_preprocessed_cdw_v1
 WHERE (ftf_health_plans_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_health_plans_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formularies_preprocessed_cdw_v1 AS
 SELECT ftf_formularies_preprocessed_cdw_v1.drug_seq,
        ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_formularies_preprocessed_cdw_v1.drug_id,
        ftf_formularies_preprocessed_cdw_v1.tier_code,
        ftf_formularies_preprocessed_cdw_v1.restrictions,
        ftf_formularies_preprocessed_cdw_v1.reason_code,
        ftf_formularies_preprocessed_cdw_v1.reason_code_description,
        ftf_formularies_preprocessed_cdw_v1.pharmacy_status,
        ftf_formularies_preprocessed_cdw_v1.plan_lives,
        ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat,
        ftf_formularies_preprocessed_cdw_v1.cycle_id,
        ftf_formularies_preprocessed_cdw_v1.modified_time,
        ftf_formularies_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_formularies_preprocessed_cdw_v1
 WHERE (ftf_formularies_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formularies_preprocessed_cdw_v1'::varchar(35)))))));

CREATE  VIEW sandbox.vw_curr_ftf_pbms_preprocessed_cdw_v1 AS
 SELECT ftf_pbms_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_pbms_preprocessed_cdw_v1.pbm_id,
        ftf_pbms_preprocessed_cdw_v1.pbm,
        ftf_pbms_preprocessed_cdw_v1.pbm_function_id,
        ftf_pbms_preprocessed_cdw_v1.pbm_function,
        ftf_pbms_preprocessed_cdw_v1.cycle_id,
        ftf_pbms_preprocessed_cdw_v1.modified_time,
        ftf_pbms_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_pbms_preprocessed_cdw_v1
 WHERE (ftf_pbms_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_pbms_preprocessed_cdw_v1'::varchar(28)))))));

CREATE  VIEW sandbox.vw_curr_ftf_restrictions_preprocessed_cdw_v1 AS
 SELECT ftf_restrictions_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v1.drug_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_code,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_text,
        ftf_restrictions_preprocessed_cdw_v1.grouped_restriction_level,
        ftf_restrictions_preprocessed_cdw_v1.drug_seq,
        ftf_restrictions_preprocessed_cdw_v1.botox,
        ftf_restrictions_preprocessed_cdw_v1.step,
        ftf_restrictions_preprocessed_cdw_v1.pres_pa,
        ftf_restrictions_preprocessed_cdw_v1.pat_pa,
        ftf_restrictions_preprocessed_cdw_v1.med_rec,
        ftf_restrictions_preprocessed_cdw_v1.unspec,
        ftf_restrictions_preprocessed_cdw_v1.cycle_id,
        ftf_restrictions_preprocessed_cdw_v1.modified_time,
        ftf_restrictions_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v1
 WHERE (ftf_restrictions_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_restrictions_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_restrictions_preprocessed_cdw_v2 AS
 SELECT ftf_restrictions_preprocessed_cdw_v2.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v2.drug_id,
        ftf_restrictions_preprocessed_cdw_v2.drug_seq,
        ftf_restrictions_preprocessed_cdw_v2.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v2.botox,
        ftf_restrictions_preprocessed_cdw_v2.step,
        ftf_restrictions_preprocessed_cdw_v2.pres_pa,
        ftf_restrictions_preprocessed_cdw_v2.pat_pa,
        ftf_restrictions_preprocessed_cdw_v2.med_rec,
        ftf_restrictions_preprocessed_cdw_v2.unspec,
        ftf_restrictions_preprocessed_cdw_v2.cycle_id,
        ftf_restrictions_preprocessed_cdw_v2.modified_time,
        ftf_restrictions_preprocessed_cdw_v2.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v2
 WHERE (ftf_restrictions_preprocessed_cdw_v2.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_restrictions_preprocessed_cdw_v2'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 AS
 SELECT ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_payer_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.comments,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_provider_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.hp_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.overriden_ftf_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.model,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_pbm,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_delete,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.old_ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_bridge_preprocessed_cdw_v1
 WHERE (ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_bridge_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge_cdw AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS code,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_id,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge_cdw
 WHERE (raw_teva_ims_bridge_cdw.file_id IN ( SELECT max(raw_teva_ims_bridge_cdw.file_id) AS max
 FROM sandbox.raw_teva_ims_bridge_cdw));

CREATE  VIEW sandbox.vw_prev_month_ftf_ims_bridge_cdw AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS code,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_id,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge_cdw
 WHERE (raw_teva_ims_bridge_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_teva_ims_bridge_cdw.file_id
 FROM sandbox.raw_teva_ims_bridge_cdw
 GROUP BY raw_teva_ims_bridge_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.ftf_delta_report AS
 SELECT comparison_ftf_health_plan_fid.ftf_health_plan_fid AS "FTF Health Plan FID",
        comparison_ftf_health_plan_fid.ftf_health_plan_name AS "FTF Health Plan Name",
        comparison_ftf_health_plan_fid.ftf_provider_fid AS "FTF Provider FID",
        comparison_ftf_health_plan_fid.ftf_provider_name AS "FTF Provider Name",
        comparison_ftf_health_plan_fid.ftf_parent_name AS "FTF Parent Name",
        comparison_ftf_health_plan_fid.paytype AS "Pay Type",
        comparison_ftf_health_plan_fid.ftf_health_plan_type AS "FTF Health Plan Type",
        comparison_ftf_health_plan_fid.key_controlling_account AS "Key Controlling Account",
        comparison_ftf_health_plan_fid.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        comparison_ftf_health_plan_fid.key_controlling_parent AS "Key Controlling Parent",
        comparison_ftf_health_plan_fid.payer_pbm AS "Payer/PBM",
        comparison_ftf_health_plan_fid.key_pbm AS "Key PBM",
        comparison_ftf_health_plan_fid.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        comparison_ftf_health_plan_fid.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        comparison_ftf_health_plan_fid.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        comparison_ftf_health_plan_fid.lives_mn AS Lives,
        comparison_ftf_health_plan_fid.iqvia_payer_name AS "IQVIA Payer Name best matched to FTF Plan",
        comparison_ftf_health_plan_fid.iqvia_pbm AS "IQVIA PBM best matched to FTF Plan",
        comparison_ftf_health_plan_fid.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        comparison_ftf_health_plan_fid.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        comparison_ftf_health_plan_fid.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        comparison_ftf_health_plan_fid.pref_brand_tier AS "Pref Brand Tier",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan FID Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider FID Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Parent Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pay Type Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payer/PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Management PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Influencer PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Claims Processing PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Lives Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name best matched to FTF Plan Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM best matched to FTF Plan Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Ajovy Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Aimovig Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Emgality Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pref Brand Tier Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change > 0) THEN 'FALSE'::varchar(5) ELSE comparison_ftf_health_plan_fid.status END AS "Final Flag",
        comparison_ftf_health_plan_fid.month_flag AS "Month Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE comparison_ftf_health_plan_fid.status END AS Status,
        comparison_ftf_health_plan_fid.change_in_lives AS "Change in Lives",
        (now())::date AS date_run,
        ('2021-08-10 10:58:30+00'::timestamptz)::timestamp AS modified_time
 FROM sandbox.comparison_ftf_health_plan_fid
 WHERE (comparison_ftf_health_plan_fid.cycle_id IN ( SELECT max(comparison_ftf_health_plan_fid.cycle_id) AS max
 FROM sandbox.comparison_ftf_health_plan_fid));

CREATE  VIEW teva_ingestion.EXT_VV_SURVEY_TARGET_VOD__C AS
 SELECT btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LASTVIEWEDDATE) AS LASTVIEWEDDATE,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LASTREFERENCEDDATE) AS LASTREFERENCEDDATE,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ACCOUNT_DISPLAY_NAME_VOD__C) AS ACCOUNT_DISPLAY_NAME_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.CHANNELS_VOD__C) AS CHANNELS_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.END_DATE_VOD__C) AS END_DATE_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ENTITY_REFERENCE_ID_VOD__C) AS ENTITY_REFERENCE_ID_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LANGUAGE_VOD__C) AS LANGUAGE_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.LOCK_VOD__C) AS LOCK_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.NO_AUTOASSIGN_VOD__C) AS NO_AUTOASSIGN_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.NOT_COMPLETED_VOD__C) AS NOT_COMPLETED_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.REGION_VOD__C) AS REGION_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.SEGMENT_VOD__C) AS SEGMENT_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.START_DATE_VOD__C) AS START_DATE_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.STATUS_VOD__C) AS STATUS_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.SURVEY_VOD__C) AS SURVEY_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.TERRITORY_VOD__C) AS TERRITORY_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ZVOD_ADDRESS_VOD__C) AS ZVOD_ADDRESS_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.ZVOD_SPECIALTY_VOD__C) AS ZVOD_SPECIALTY_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_TARGET_VOD__C_src.SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.SCORE_VOD__C))::numeric(11,0) END AS SCORE_VOD__C,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.Review_date_vod__c) AS Review_date_vod__c,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.Employee_vod__c) AS Employee_vod__c,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.coach_vod__c) AS coach_vod__c,
        btrim(EXT_VV_SURVEY_TARGET_VOD__C_src.Report_Status_vod__c) AS Report_Status_vod__c,
        EXT_VV_SURVEY_TARGET_VOD__C_src.batch_id,
        EXT_VV_SURVEY_TARGET_VOD__C_src.row_id,
        EXT_VV_SURVEY_TARGET_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SURVEY_TARGET_VOD__C_src;

CREATE  VIEW raw.ext_vv_survey_target_vod__c AS
 SELECT src.ID,
        src.OWNERID,
        src.ISDELETED,
        src.NAME,
        src.RECORDTYPEID,
        src.CREATEDDATE,
        src.CREATEDBYID,
        src.LASTMODIFIEDDATE,
        src.LASTMODIFIEDBYID,
        src.SYSTEMMODSTAMP,
        src.MAYEDIT,
        src.ISLOCKED,
        src.LASTVIEWEDDATE,
        src.LASTREFERENCEDDATE,
        src.ACCOUNT_DISPLAY_NAME_VOD__C,
        src.ACCOUNT_VOD__C,
        src.CHANNELS_VOD__C,
        src.END_DATE_VOD__C,
        src.ENTITY_REFERENCE_ID_VOD__C,
        src.EXTERNAL_ID_VOD__C,
        src.LANGUAGE_VOD__C,
        src.LOCK_VOD__C,
        src.MOBILE_ID_VOD__C,
        src.NO_AUTOASSIGN_VOD__C,
        src.NOT_COMPLETED_VOD__C,
        src.REGION_VOD__C,
        src.SEGMENT_VOD__C,
        src.START_DATE_VOD__C,
        src.STATUS_VOD__C,
        src.SURVEY_VOD__C,
        src.TERRITORY_VOD__C,
        src.ZVOD_ADDRESS_VOD__C,
        src.ZVOD_SPECIALTY_VOD__C,
        src.SCORE_VOD__C,
        src.Review_date_vod__c,
        src.Employee_vod__c,
        src.coach_vod__c,
        src.Report_Status_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SURVEY_TARGET_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SURVEY_TARGET_VOD__C'::varchar(27)))));

CREATE  VIEW teva_ingestion.ext_knipper_samples_v2 AS
 SELECT btrim(ext_knipper_samples_v2_src.tvcmid) AS tvcmid,
        btrim(ext_knipper_samples_v2_src.hcp_veeva_id) AS hcp_veeva_id,
        btrim(ext_knipper_samples_v2_src.hcp_first_name) AS hcp_first_name,
        btrim(ext_knipper_samples_v2_src.hcp_middle_name) AS hcp_middle_name,
        btrim(ext_knipper_samples_v2_src.hcp_last_name) AS hcp_last_name,
        btrim(ext_knipper_samples_v2_src.hcp_designation) AS hcp_designation,
        btrim(ext_knipper_samples_v2_src.hcp_state_license_number) AS hcp_state_license_number,
        btrim(ext_knipper_samples_v2_src.hcp_address1) AS hcp_address1,
        btrim(ext_knipper_samples_v2_src.hcp_address2) AS hcp_address2,
        btrim(ext_knipper_samples_v2_src.hcp_address3) AS hcp_address3,
        btrim(ext_knipper_samples_v2_src.hcp_city) AS hcp_city,
        btrim(ext_knipper_samples_v2_src.hcp_state) AS hcp_state,
        btrim(ext_knipper_samples_v2_src.hcp_zip) AS hcp_zip,
        btrim(ext_knipper_samples_v2_src.dea_license_number) AS dea_license_number,
        btrim(ext_knipper_samples_v2_src.order_source_order_id) AS order_source_order_id,
        btrim(ext_knipper_samples_v2_src.ndc) AS ndc,
        btrim(ext_knipper_samples_v2_src.quantity) AS quantity,
        btrim(ext_knipper_samples_v2_src.order_source_job_code) AS order_source_job_code,
        btrim(ext_knipper_samples_v2_src.order_source_job_code_description) AS order_source_job_code_description,
        CASE WHEN (ext_knipper_samples_v2_src.ship_date = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_knipper_samples_v2_src.ship_date))::timestamp END AS ship_date,
        btrim(ext_knipper_samples_v2_src.territory) AS territory,
        btrim(ext_knipper_samples_v2_src.repid) AS repid,
        btrim(ext_knipper_samples_v2_src.replastname) AS replastname,
        btrim(ext_knipper_samples_v2_src.repmiddlename) AS repmiddlename,
        btrim(ext_knipper_samples_v2_src.repfirstname) AS repfirstname,
        btrim(ext_knipper_samples_v2_src.signature_type) AS signature_type,
        btrim(ext_knipper_samples_v2_src.attendeename) AS attendeename,
        btrim(ext_knipper_samples_v2_src.literature_product_id) AS literature_product_id,
        btrim(ext_knipper_samples_v2_src.literature_product_name) AS literature_product_name,
        ext_knipper_samples_v2_src.batch_id,
        ext_knipper_samples_v2_src.row_id,
        ext_knipper_samples_v2_src.update_ts
 FROM teva_ingestion.ext_knipper_samples_v2_src;

CREATE  VIEW raw.ext_knipper_samples_v2 AS
 SELECT src.tvcmid,
        src.hcp_veeva_id,
        src.hcp_first_name,
        src.hcp_middle_name,
        src.hcp_last_name,
        src.hcp_designation,
        src.hcp_state_license_number,
        src.hcp_address1,
        src.hcp_address2,
        src.hcp_address3,
        src.hcp_city,
        src.hcp_state,
        src.hcp_zip,
        src.dea_license_number,
        src.order_source_order_id,
        src.ndc,
        src.quantity,
        src.order_source_job_code,
        src.order_source_job_code_description,
        src.ship_date,
        src.territory,
        src.repid,
        src.replastname,
        src.repmiddlename,
        src.repfirstname,
        src.signature_type,
        src.attendeename,
        src.literature_product_id,
        src.literature_product_name,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_knipper_samples_v2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_KNIPPER_SAMPLES_v2'::varchar(22)))));

CREATE  VIEW sandbox.teva_iqvia_bridge_mismatch_analysis AS
 SELECT vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code AS IQVIA_Plan_Code,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_name AS IQVIA_Plan_Name,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid AS "FTF Health Plan FID",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index AS PayTypeIndex,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.paytype AS "Pay Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.hp_type AS "HP Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_paytype AS "IQVIA Pay Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.model AS Model,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types AS "Check Pay Types",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types AS "Check HP Types",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.old_ftf_health_plan_type AS "Old_FTF Health Plan Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time
 FROM sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1
 WHERE (coalesce(vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW sandbox.vw_iqvia_plan_change AS
 SELECT a.entity AS "Change Type",
        a.id AS ID,
        a.name AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM ((((((((((( SELECT 'Payer'::varchar(5) AS entity,
        curr_month_ims_plan_xref.payer_num AS id,
        curr_month_ims_plan_xref.payer_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ANTI  JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        prev_month_ims_plan_xref.payer_num AS id,
        prev_month_ims_plan_xref.payer_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ANTI  JOIN sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num)))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        vw_curr_month_ims_plan_xref_cdw.payer_num AS id,
        vw_curr_month_ims_plan_xref_cdw.payer_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_plan_xref_cdw
 WHERE (vw_curr_month_ims_plan_xref_cdw.payer_num IN ( SELECT curr_month_ims_plan_xref.payer_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num) AND (curr_month_ims_plan_xref.payer_name <> prev_month_ims_plan_xref.payer_name))))))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        vw_prev_month_ims_plan_xref_cdw.payer_num AS id,
        vw_prev_month_ims_plan_xref_cdw.payer_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_plan_xref_cdw
 WHERE (vw_prev_month_ims_plan_xref_cdw.payer_num IN ( SELECT prev_month_ims_plan_xref.payer_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num) AND (curr_month_ims_plan_xref.payer_name <> prev_month_ims_plan_xref.payer_name))))))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        curr_month_ims_plan_xref.payer_plan_num AS id,
        curr_month_ims_plan_xref.plan_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ANTI  JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num)))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        prev_month_ims_plan_xref.payer_plan_num AS id,
        prev_month_ims_plan_xref.plan_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ANTI  JOIN sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num)))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        vw_curr_month_ims_plan_xref_cdw.payer_plan_num AS id,
        vw_curr_month_ims_plan_xref_cdw.plan_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_plan_xref_cdw
 WHERE (vw_curr_month_ims_plan_xref_cdw.payer_plan_num IN ( SELECT curr_month_ims_plan_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num) AND (curr_month_ims_plan_xref.plan_name <> prev_month_ims_plan_xref.plan_name))))))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        vw_prev_month_ims_plan_xref_cdw.payer_plan_num AS id,
        vw_prev_month_ims_plan_xref_cdw.plan_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_plan_xref_cdw
 WHERE (vw_prev_month_ims_plan_xref_cdw.payer_plan_num IN ( SELECT prev_month_ims_plan_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num) AND (curr_month_ims_plan_xref.plan_name <> prev_month_ims_plan_xref.plan_name))))))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        curr_month_ims_pbm_xref.payer_plan_num AS id,
        curr_month_ims_pbm_xref.pbm_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref ANTI  JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON ((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num)))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        prev_month_ims_pbm_xref.payer_plan_num AS id,
        prev_month_ims_pbm_xref.pbm_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ANTI  JOIN sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref ON ((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num)))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        vw_curr_month_ims_pbm_xref_cdw.payer_plan_num AS id,
        vw_curr_month_ims_pbm_xref_cdw.pbm_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_pbm_xref_cdw
 WHERE (vw_curr_month_ims_pbm_xref_cdw.payer_plan_num IN ( SELECT curr_month_ims_pbm_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON (((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num) AND (curr_month_ims_pbm_xref.pbm_name <> prev_month_ims_pbm_xref.pbm_name))))))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        vw_prev_month_ims_pbm_xref_cdw.payer_plan_num AS id,
        vw_prev_month_ims_pbm_xref_cdw.pbm_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_pbm_xref_cdw
 WHERE (vw_prev_month_ims_pbm_xref_cdw.payer_plan_num IN ( SELECT prev_month_ims_pbm_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON (((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num) AND (curr_month_ims_pbm_xref.pbm_name <> prev_month_ims_pbm_xref.pbm_name))))))) a
 ORDER BY a.entity,
          a.status,
          a.id,
          a.name;

CREATE  VIEW sandbox.vw_curr_iqvia_plancode_fid_xref_cdw_v1 AS
 SELECT iqvia_plancode_fid_xref_cdw_v1.iqvia_payer_name,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_code,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.comments,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_parent_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_type,
        iqvia_plancode_fid_xref_cdw_v1.paytype_index,
        iqvia_plancode_fid_xref_cdw_v1.paytype,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_pbm,
        iqvia_plancode_fid_xref_cdw_v1.hp_type,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_paytype,
        iqvia_plancode_fid_xref_cdw_v1.pref_brand_tier,
        iqvia_plancode_fid_xref_cdw_v1.lives,
        iqvia_plancode_fid_xref_cdw_v1.cycle_id,
        iqvia_plancode_fid_xref_cdw_v1.modified_time,
        iqvia_plancode_fid_xref_cdw_v1.modified_by
 FROM sandbox.iqvia_plancode_fid_xref_cdw_v1
 WHERE (iqvia_plancode_fid_xref_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plancode_fid_xref_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_fid_best_iqviapayer_cdw_v1 AS
 SELECT fid_best_iqviapayer_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapayer_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapayer_cdw_v1.ftf_provider_fid,
        fid_best_iqviapayer_cdw_v1.ftf_provider_name,
        fid_best_iqviapayer_cdw_v1.iqvia_payer_name,
        fid_best_iqviapayer_cdw_v1.frequency,
        fid_best_iqviapayer_cdw_v1.cycle_id,
        fid_best_iqviapayer_cdw_v1.modified_time,
        fid_best_iqviapayer_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapayer_cdw_v1
 WHERE (fid_best_iqviapayer_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'fid_best_iqviapayer_cdw_v1'::varchar(26)))))));

CREATE  VIEW sandbox.vw_curr_fid_best_iqviapbm_cdw_v1 AS
 SELECT fid_best_iqviapbm_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapbm_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapbm_cdw_v1.ftf_provider_fid,
        fid_best_iqviapbm_cdw_v1.ftf_provider_name,
        fid_best_iqviapbm_cdw_v1.iqvia_pbm,
        fid_best_iqviapbm_cdw_v1.frequency,
        fid_best_iqviapbm_cdw_v1.cycle_id,
        fid_best_iqviapbm_cdw_v1.modified_time,
        fid_best_iqviapbm_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapbm_cdw_v1
 WHERE (fid_best_iqviapbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'fid_best_iqviapbm_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_amb4_cdw_v1 AS
 SELECT amb4_cdw_v1.ftf_health_plan_fid,
        amb4_cdw_v1.ftf_health_plan_name,
        amb4_cdw_v1.old_coverage_category_ajovy,
        amb4_cdw_v1.old_coverage_category_aimovig,
        amb4_cdw_v1.old_coverage_category_emgality,
        amb4_cdw_v1.old_ftf_provider_fid,
        amb4_cdw_v1.old_ftf_provider_name,
        amb4_cdw_v1.old_ftf_parent_name,
        amb4_cdw_v1.old_paytype_index,
        amb4_cdw_v1.old_paytype,
        amb4_cdw_v1.old_ftf_health_plan_type,
        amb4_cdw_v1.old_pref_brand_tier,
        amb4_cdw_v1.old_key_controlling_plan_formulary,
        amb4_cdw_v1.old_key_controlling_account,
        amb4_cdw_v1.old_key_pbm,
        amb4_cdw_v1.old_payer_pbm,
        amb4_cdw_v1.fillIn_blank_iqpayer,
        amb4_cdw_v1.fillIn_blank_iqpbm,
        amb4_cdw_v1.ftf_match_iqvia,
        amb4_cdw_v1.old_iqvia_payer_name,
        amb4_cdw_v1.old_iqvia_pbm,
        amb4_cdw_v1.old_ftf_formulary_management_pbm,
        amb4_cdw_v1.old_ftf_formulary_influencer_pbm,
        amb4_cdw_v1.old_ftf_claims_processing_pbm,
        amb4_cdw_v1.lives_mx,
        amb4_cdw_v1.new_ftf_health_plan_fid,
        amb4_cdw_v1.old_ftf_health_plan_fid,
        amb4_cdw_v1.new_ftf_health_plan_name,
        amb4_cdw_v1.old_ftf_health_plan_name,
        amb4_cdw_v1.ftf_provider_fid,
        amb4_cdw_v1.ftf_provider_name,
        amb4_cdw_v1.ftf_parent_name,
        amb4_cdw_v1.paytype_index,
        amb4_cdw_v1.paytype,
        amb4_cdw_v1.ftf_health_plan_type,
        amb4_cdw_v1.pref_brand_tier,
        amb4_cdw_v1.lives_mn,
        amb4_cdw_v1.iqvia_payer_name,
        amb4_cdw_v1.iqvia_pbm,
        amb4_cdw_v1.ftf_formulary_management_pbm,
        amb4_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_cdw_v1.ftf_claims_processing_pbm,
        amb4_cdw_v1.cycle_id,
        amb4_cdw_v1.modified_time,
        amb4_cdw_v1.modified_by
 FROM sandbox.amb4_cdw_v1
 WHERE (amb4_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_cdw_v1'::varchar(11)))))));

CREATE  VIEW sandbox.vw_curr_amb4_iqvia_payer_cdw_v1 AS
 SELECT amb4_iqvia_payer_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_payer_cdw_v1.ftf_provider_fid,
        amb4_iqvia_payer_cdw_v1.ftf_provider_name,
        amb4_iqvia_payer_cdw_v1.ftf_parent_name,
        amb4_iqvia_payer_cdw_v1.paytype_index,
        amb4_iqvia_payer_cdw_v1.paytype,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_payer_cdw_v1.pref_brand_tier,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_payer_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_payer_cdw_v1.iqvia_payer_name,
        amb4_iqvia_payer_cdw_v1.iqvia_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_payer_cdw_v1.lives_mn,
        amb4_iqvia_payer_cdw_v1.cycle_id,
        amb4_iqvia_payer_cdw_v1.modified_time,
        amb4_iqvia_payer_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_payer_cdw_v1
 WHERE (amb4_iqvia_payer_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_iqvia_payer_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_amb4_iqvia_pbm_cdw_v1 AS
 SELECT amb4_iqvia_pbm_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_name,
        amb4_iqvia_pbm_cdw_v1.ftf_parent_name,
        amb4_iqvia_pbm_cdw_v1.paytype_index,
        amb4_iqvia_pbm_cdw_v1.paytype,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_pbm_cdw_v1.pref_brand_tier,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_pbm_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_pbm_cdw_v1.iqvia_payer_name,
        amb4_iqvia_pbm_cdw_v1.iqvia_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_pbm_cdw_v1.lives_mn,
        amb4_iqvia_pbm_cdw_v1.cycle_id,
        amb4_iqvia_pbm_cdw_v1.modified_time,
        amb4_iqvia_pbm_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_pbm_cdw_v1
 WHERE (amb4_iqvia_pbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_iqvia_pbm_cdw_v1'::varchar(21)))))));

CREATE  VIEW sandbox.vw_curr_amb7_cdw_v1 AS
 SELECT amb7_cdw_v1.ftf_health_plan_fid,
        amb7_cdw_v1.ftf_health_plan_name,
        amb7_cdw_v1.ftf_provider_fid,
        amb7_cdw_v1.ftf_provider_name,
        amb7_cdw_v1.ftf_parent_name,
        amb7_cdw_v1.paytype_index,
        amb7_cdw_v1.paytype,
        amb7_cdw_v1.ftf_health_plan_type,
        amb7_cdw_v1.pref_brand_tier,
        amb7_cdw_v1.fillIn_blank_iqpayer,
        amb7_cdw_v1.fillIn_blank_iqpbm,
        amb7_cdw_v1.ftf_match_iqvia,
        amb7_cdw_v1.iqvia_payer_name,
        amb7_cdw_v1.iqvia_pbm,
        amb7_cdw_v1.ftf_formulary_management_pbm,
        amb7_cdw_v1.ftf_formulary_influencer_pbm,
        amb7_cdw_v1.ftf_claims_processing_pbm,
        amb7_cdw_v1.lives_mn,
        amb7_cdw_v1.calculated_pbm_value,
        amb7_cdw_v1.key_pbm,
        amb7_cdw_v1.cycle_id,
        amb7_cdw_v1.modified_time,
        amb7_cdw_v1.modified_by
 FROM sandbox.amb7_cdw_v1
 WHERE (amb7_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb7_cdw_v1'::varchar(11)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hpid_keypbm_cdw_v1 AS
 SELECT ftf_hpid_keypbm_cdw_v1.ftf_health_plan_fid,
        ftf_hpid_keypbm_cdw_v1.ftf_health_plan_name,
        ftf_hpid_keypbm_cdw_v1.ftf_provider_name,
        ftf_hpid_keypbm_cdw_v1.paytype,
        ftf_hpid_keypbm_cdw_v1.iqvia_pbm,
        ftf_hpid_keypbm_cdw_v1.key_pbm,
        ftf_hpid_keypbm_cdw_v1.cycle_id,
        ftf_hpid_keypbm_cdw_v1.modified_time,
        ftf_hpid_keypbm_cdw_v1.modified_by
 FROM sandbox.ftf_hpid_keypbm_cdw_v1
 WHERE (ftf_hpid_keypbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hpid_keypbm_cdw_v1'::varchar(22)))))));

CREATE  VIEW sandbox.vw_curr_plan_prod_master_cdw_v1 AS
 SELECT plan_prod_master_cdw_v1.ftf_health_plan_fid,
        plan_prod_master_cdw_v1.ftf_health_plan_name,
        plan_prod_master_cdw_v1.ftf_provider_fid,
        plan_prod_master_cdw_v1.ftf_provider_name,
        plan_prod_master_cdw_v1.ftf_parent_name,
        plan_prod_master_cdw_v1.paytype_index,
        plan_prod_master_cdw_v1.paytype,
        plan_prod_master_cdw_v1.ftf_health_plan_type,
        plan_prod_master_cdw_v1.pref_brand_tier,
        plan_prod_master_cdw_v1.fillIn_blank_iqpayer,
        plan_prod_master_cdw_v1.fillIn_blank_iqpbm,
        plan_prod_master_cdw_v1.ftf_match_iqvia,
        plan_prod_master_cdw_v1.iqvia_payer_name,
        plan_prod_master_cdw_v1.iqvia_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        plan_prod_master_cdw_v1.lives_mn,
        plan_prod_master_cdw_v1.calculated_pbm_value,
        plan_prod_master_cdw_v1.key_pbm,
        plan_prod_master_cdw_v1.drug_id,
        plan_prod_master_cdw_v1.drug_seq,
        plan_prod_master_cdw_v1.tier_code,
        plan_prod_master_cdw_v1.restrictions,
        plan_prod_master_cdw_v1.reason_code,
        plan_prod_master_cdw_v1.pharmacy_status,
        plan_prod_master_cdw_v1.botox,
        plan_prod_master_cdw_v1.step,
        plan_prod_master_cdw_v1.pres_pa,
        plan_prod_master_cdw_v1.pat_pa,
        plan_prod_master_cdw_v1.med_rec,
        plan_prod_master_cdw_v1.unspec,
        plan_prod_master_cdw_v1.tier,
        plan_prod_master_cdw_v1.has_pa,
        plan_prod_master_cdw_v1.has_st,
        plan_prod_master_cdw_v1.formulary,
        plan_prod_master_cdw_v1.copay_tier,
        plan_prod_master_cdw_v1.tier_cat,
        plan_prod_master_cdw_v1.restcat,
        plan_prod_master_cdw_v1.restriction_category,
        plan_prod_master_cdw_v1.coverage_cat_code,
        plan_prod_master_cdw_v1.coverage_category,
        plan_prod_master_cdw_v1.cycle_id,
        plan_prod_master_cdw_v1.modified_time,
        plan_prod_master_cdw_v1.modified_by
 FROM sandbox.plan_prod_master_cdw_v1
 WHERE (plan_prod_master_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'plan_prod_master_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_ftf_plan_master_file_cdw_v1 AS
 SELECT ftf_plan_master_file_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_cdw_v1.ftf_provider_fid,
        ftf_plan_master_file_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_cdw_v1.ftf_parent_name,
        ftf_plan_master_file_cdw_v1.paytype_index,
        ftf_plan_master_file_cdw_v1.paytype,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpayer,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpbm,
        ftf_plan_master_file_cdw_v1.ftf_match_iqvia,
        ftf_plan_master_file_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_cdw_v1.lives_mn,
        ftf_plan_master_file_cdw_v1.calculated_pbm_value,
        ftf_plan_master_file_cdw_v1.key_pbm,
        ftf_plan_master_file_cdw_v1.drug_id,
        ftf_plan_master_file_cdw_v1.drug_seq,
        ftf_plan_master_file_cdw_v1.product,
        ftf_plan_master_file_cdw_v1.tier_code,
        ftf_plan_master_file_cdw_v1.restrictions,
        ftf_plan_master_file_cdw_v1.reason_code,
        ftf_plan_master_file_cdw_v1.pharmacy_status,
        ftf_plan_master_file_cdw_v1.botox,
        ftf_plan_master_file_cdw_v1.botox_step_flag,
        ftf_plan_master_file_cdw_v1.step,
        ftf_plan_master_file_cdw_v1.step_category,
        ftf_plan_master_file_cdw_v1.pres_pa,
        ftf_plan_master_file_cdw_v1.prescriber_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.pat_pa,
        ftf_plan_master_file_cdw_v1.med_rec,
        ftf_plan_master_file_cdw_v1.unspec,
        ftf_plan_master_file_cdw_v1.patient_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.medical_records_submission_required_flag,
        ftf_plan_master_file_cdw_v1.unspecified_restriction_flag,
        ftf_plan_master_file_cdw_v1.ftf_tier,
        ftf_plan_master_file_cdw_v1.has_pa,
        ftf_plan_master_file_cdw_v1.has_st,
        ftf_plan_master_file_cdw_v1.formulary,
        ftf_plan_master_file_cdw_v1.copay_Tier,
        ftf_plan_master_file_cdw_v1.tier_cat,
        ftf_plan_master_file_cdw_v1.restcat,
        ftf_plan_master_file_cdw_v1.restriction_category,
        ftf_plan_master_file_cdw_v1.coverage_cat_code,
        ftf_plan_master_file_cdw_v1.coverage_category,
        ftf_plan_master_file_cdw_v1.key_controlling_account,
        ftf_plan_master_file_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_cdw_v1.payer_pbm,
        ftf_plan_master_file_cdw_v1.cycle_id,
        ftf_plan_master_file_cdw_v1.modified_time,
        ftf_plan_master_file_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_cdw_v1
 WHERE (ftf_plan_master_file_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_plan_master_file_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_curr_pivot_plan_prod_master_cdw_v1 AS
 SELECT pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_name,
        pivot_plan_prod_master_cdw_v1.ftf_provider_fid,
        pivot_plan_prod_master_cdw_v1.ftf_provider_name,
        pivot_plan_prod_master_cdw_v1.ftf_parent_name,
        pivot_plan_prod_master_cdw_v1.paytype,
        pivot_plan_prod_master_cdw_v1.paytype_index,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_type,
        pivot_plan_prod_master_cdw_v1.key_controlling_account,
        pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_cdw_v1.key_controlling_parent,
        pivot_plan_prod_master_cdw_v1.payer_pbm,
        pivot_plan_prod_master_cdw_v1.key_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        pivot_plan_prod_master_cdw_v1.lives_mn,
        pivot_plan_prod_master_cdw_v1.iqvia_payer_name,
        pivot_plan_prod_master_cdw_v1.iqvia_pbm,
        pivot_plan_prod_master_cdw_v1.pref_brand_tier,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality,
        pivot_plan_prod_master_cdw_v1.prev_lives,
        pivot_plan_prod_master_cdw_v1.ftf_match_iqvia,
        pivot_plan_prod_master_cdw_v1.cycle_id,
        pivot_plan_prod_master_cdw_v1.modified_time,
        pivot_plan_prod_master_cdw_v1.modified_by
 FROM sandbox.pivot_plan_prod_master_cdw_v1
 WHERE (pivot_plan_prod_master_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'pivot_plan_prod_master_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1 AS
 SELECT comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.paytype,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_paytype,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.change_payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.change,
        comparison_ftf_health_plan_fid_cdw_v1.month_flag,
        comparison_ftf_health_plan_fid_cdw_v1.status,
        comparison_ftf_health_plan_fid_cdw_v1.change_in_lives,
        comparison_ftf_health_plan_fid_cdw_v1.cycle_id,
        comparison_ftf_health_plan_fid_cdw_v1.modified_time,
        comparison_ftf_health_plan_fid_cdw_v1.modified_by
 FROM sandbox.comparison_ftf_health_plan_fid_cdw_v1
 WHERE (comparison_ftf_health_plan_fid_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_ftf_health_plan_fid_cdw_v1'::varchar(37)))))));

CREATE  VIEW sandbox.vw_curr_access_master_bridge_cdw_v1 AS
 SELECT access_master_bridge_cdw_v1.ftf_health_plan_fid,
        access_master_bridge_cdw_v1.ftf_health_plan_name,
        access_master_bridge_cdw_v1.coverage_category_ajovy,
        access_master_bridge_cdw_v1.coverage_category_aimovig,
        access_master_bridge_cdw_v1.coverage_category_emgality,
        access_master_bridge_cdw_v1.ftf_provider_fid,
        access_master_bridge_cdw_v1.ftf_provider_name,
        access_master_bridge_cdw_v1.ftf_parent_name,
        access_master_bridge_cdw_v1.paytype_index,
        access_master_bridge_cdw_v1.paytype,
        access_master_bridge_cdw_v1.ftf_health_plan_type,
        access_master_bridge_cdw_v1.key_controlling_plan_formulary,
        access_master_bridge_cdw_v1.key_controlling_account,
        access_master_bridge_cdw_v1.key_controlling_parent,
        access_master_bridge_cdw_v1.payer_pbm,
        access_master_bridge_cdw_v1.key_pbm,
        access_master_bridge_cdw_v1.iqvia_payer_name,
        access_master_bridge_cdw_v1.iqvia_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_management_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm,
        access_master_bridge_cdw_v1.ftf_claims_processing_pbm,
        access_master_bridge_cdw_v1.pref_brand_tier,
        access_master_bridge_cdw_v1.ftf_match_iqvia,
        access_master_bridge_cdw_v1.previous_lives,
        access_master_bridge_cdw_v1.current_lives,
        access_master_bridge_cdw_v1.cycle_id,
        access_master_bridge_cdw_v1.modified_time,
        access_master_bridge_cdw_v1.modified_by
 FROM sandbox.access_master_bridge_cdw_v1
 WHERE (access_master_bridge_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'access_master_bridge_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_prev_month_access_master_bridge_cdw_v1 AS
 SELECT access_master_bridge_cdw_v1.ftf_health_plan_fid,
        access_master_bridge_cdw_v1.ftf_health_plan_name,
        access_master_bridge_cdw_v1.coverage_category_ajovy,
        access_master_bridge_cdw_v1.coverage_category_aimovig,
        access_master_bridge_cdw_v1.coverage_category_emgality,
        access_master_bridge_cdw_v1.ftf_provider_fid,
        access_master_bridge_cdw_v1.ftf_provider_name,
        access_master_bridge_cdw_v1.ftf_parent_name,
        access_master_bridge_cdw_v1.paytype_index,
        access_master_bridge_cdw_v1.paytype,
        access_master_bridge_cdw_v1.ftf_health_plan_type,
        access_master_bridge_cdw_v1.key_controlling_plan_formulary,
        access_master_bridge_cdw_v1.key_controlling_account,
        access_master_bridge_cdw_v1.key_controlling_parent,
        access_master_bridge_cdw_v1.payer_pbm,
        access_master_bridge_cdw_v1.key_pbm,
        access_master_bridge_cdw_v1.iqvia_payer_name,
        access_master_bridge_cdw_v1.iqvia_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_management_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm,
        access_master_bridge_cdw_v1.ftf_claims_processing_pbm,
        access_master_bridge_cdw_v1.pref_brand_tier,
        access_master_bridge_cdw_v1.ftf_match_iqvia,
        access_master_bridge_cdw_v1.previous_lives,
        access_master_bridge_cdw_v1.current_lives,
        access_master_bridge_cdw_v1.cycle_id,
        access_master_bridge_cdw_v1.modified_time,
        access_master_bridge_cdw_v1.modified_by
 FROM sandbox.access_master_bridge_cdw_v1
 WHERE (access_master_bridge_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'access_master_bridge_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_curr_copay_tier_derivation_config_cdw AS
 SELECT btrim(copay_tier_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        copay_tier_derivation_config_v01.tier_cat,
        btrim(copay_tier_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v01.copay_tier) AS copay_tier,
        copay_tier_derivation_config_v01.file_id,
        copay_tier_derivation_config_v01.record_id
 FROM sandbox.copay_tier_derivation_config_v01
 WHERE (copay_tier_derivation_config_v01.file_id IN ( SELECT max(copay_tier_derivation_config_v01.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_tier_cat_description_mapping_cdw AS
 SELECT tier_cat_description_mapping_v01.tier_cat,
        btrim(tier_cat_description_mapping_v01.description) AS description,
        btrim(tier_cat_description_mapping_v01.notes) AS notes,
        tier_cat_description_mapping_v01.file_id,
        tier_cat_description_mapping_v01.record_id
 FROM sandbox.tier_cat_description_mapping_v01
 WHERE (tier_cat_description_mapping_v01.file_id IN ( SELECT max(tier_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.tier_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_coverage_category_derivation_config_cdw AS
 SELECT btrim(coverage_category_derivation_config_v01.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v01.coverage_cat_code,
        btrim(coverage_category_derivation_config_v01.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v01.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v01.meaning) AS meaning,
        coverage_category_derivation_config_v01.file_id,
        coverage_category_derivation_config_v01.record_id
 FROM sandbox.coverage_category_derivation_config_v01
 WHERE (coverage_category_derivation_config_v01.file_id IN ( SELECT max(coverage_category_derivation_config_v01.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v01));

CREATE  VIEW teva_ingestion.PS_BOTOX_STEP_RESTRICTION_V01 AS
 SELECT btrim(PS_BOTOX_STEP_RESTRICTION_V01_src.code) AS code,
        btrim(PS_BOTOX_STEP_RESTRICTION_V01_src.botox_step_flag) AS botox_step_flag,
        btrim(PS_BOTOX_STEP_RESTRICTION_V01_src.restriction_group) AS restriction_group,
        btrim(PS_BOTOX_STEP_RESTRICTION_V01_src.notes) AS notes,
        PS_BOTOX_STEP_RESTRICTION_V01_src.batch_id,
        PS_BOTOX_STEP_RESTRICTION_V01_src.row_id,
        PS_BOTOX_STEP_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_BOTOX_STEP_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_BOTOX_STEP_RESTRICTION_V01 AS
 SELECT src.code,
        src.botox_step_flag,
        src.restriction_group,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_BOTOX_STEP_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_BOTOX_STEP_RESTRICTION_V01'::varchar(29)))));

CREATE  VIEW teva_ingestion.PS_CALCULATED_PBM_CONFIG_V01 AS
 SELECT btrim(PS_CALCULATED_PBM_CONFIG_V01_src.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(PS_CALCULATED_PBM_CONFIG_V01_src.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(PS_CALCULATED_PBM_CONFIG_V01_src.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(PS_CALCULATED_PBM_CONFIG_V01_src.calculated_pbm_column) AS calculated_pbm_column,
        PS_CALCULATED_PBM_CONFIG_V01_src.batch_id,
        PS_CALCULATED_PBM_CONFIG_V01_src.row_id,
        PS_CALCULATED_PBM_CONFIG_V01_src.update_ts
 FROM teva_ingestion.PS_CALCULATED_PBM_CONFIG_V01_src;

CREATE  VIEW raw.PS_CALCULATED_PBM_CONFIG_V01 AS
 SELECT src.ftf_formulary_management_pbm_regex,
        src.ftf_formulary_influencer_pbm_regex,
        src.ftf_claims_processing_pbm_regex,
        src.calculated_pbm_column,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_CALCULATED_PBM_CONFIG_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_CALCULATED_PBM_CONFIG_V01'::varchar(28)))));

CREATE  VIEW teva_ingestion.PS_CALC_PBM_KEY_PBM_MAPPING_V01 AS
 SELECT btrim(PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.calculated_pbm) AS calculated_pbm,
        btrim(PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.key_pbm) AS key_pbm,
        btrim(PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.added_by) AS added_by,
        PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.batch_id,
        PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.row_id,
        PS_CALC_PBM_KEY_PBM_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_CALC_PBM_KEY_PBM_MAPPING_V01_src;

CREATE  VIEW raw.PS_CALC_PBM_KEY_PBM_MAPPING_V01 AS
 SELECT src.calculated_pbm,
        src.key_pbm,
        src.added_by,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_CALC_PBM_KEY_PBM_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_CALC_PBM_KEY_PBM_MAPPING_V01'::varchar(31)))));

CREATE  VIEW teva_ingestion.PS_COPAY_TIER_DERIVATION_CONFIG_V01 AS
 SELECT btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.tier_cat) AS tier_cat,
        btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.tier_regex) AS tier_regex,
        btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.copay_tier) AS copay_tier,
        PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.batch_id,
        PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.row_id,
        PS_COPAY_TIER_DERIVATION_CONFIG_V01_src.update_ts
 FROM teva_ingestion.PS_COPAY_TIER_DERIVATION_CONFIG_V01_src;

CREATE  VIEW raw.PS_COPAY_TIER_DERIVATION_CONFIG_V01 AS
 SELECT src.pharmacy_status_regex,
        src.tier_cat,
        src.tier_regex,
        src.pref_brand_tier_regex,
        src.ftf_health_plan_type_regex,
        src.copay_tier,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_COPAY_TIER_DERIVATION_CONFIG_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_COPAY_TIER_DERIVATION_CONFIG_V01'::varchar(35)))));

CREATE  VIEW teva_ingestion.PS_COVERAGE_CATEGORY_DERIVATION_CONFIG AS
 SELECT btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.paytype_regex) AS paytype_regex,
        btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.coverage_cat_code) AS coverage_cat_code,
        btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.coverage_category) AS coverage_category,
        btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.meaning) AS meaning,
        PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.batch_id,
        PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.row_id,
        PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src.update_ts
 FROM teva_ingestion.PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src;

CREATE  VIEW raw.PS_COVERAGE_CATEGORY_DERIVATION_CONFIG AS
 SELECT src.paytype_regex,
        src.pharmacy_status_regex,
        src.coverage_cat_code,
        src.coverage_category,
        src.restriction_cat_code_regex,
        src.meaning,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_COVERAGE_CATEGORY_DERIVATION_CONFIG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_COVERAGE_CATEGORY_DERIVATION_CONFIG'::varchar(38)))));

CREATE  VIEW teva_ingestion.PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT btrim(PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.coverage_cat) AS coverage_cat,
        btrim(PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.description) AS description,
        btrim(PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.notes) AS notes,
        PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.batch_id,
        PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.row_id,
        PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src;

CREATE  VIEW raw.PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT src.coverage_cat,
        src.description,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_COVERAGE_CAT_DESCRIPTION_MAPPING_V01'::varchar(39)))));

CREATE  VIEW teva_ingestion.PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01 AS
 SELECT btrim(PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.delete_flag) AS delete_flag,
        PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.batch_id,
        PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.row_id,
        PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src.update_ts
 FROM teva_ingestion.PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src;

CREATE  VIEW raw.PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01 AS
 SELECT src.ftf_health_plan_name_regex,
        src.iqvia_payer_name_regex,
        src.iqvia_plan_name_regex,
        src.delete_flag,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_DELETE_BRIDGE_FTF_PLAN_TYPES_V01'::varchar(35)))));

CREATE  VIEW teva_ingestion.PS_DRUG_ASSIGNMENTS_V01 AS
 SELECT btrim(PS_DRUG_ASSIGNMENTS_V01_src.drug_id) AS drug_id,
        btrim(PS_DRUG_ASSIGNMENTS_V01_src.drug_seq) AS drug_seq,
        btrim(PS_DRUG_ASSIGNMENTS_V01_src.product) AS product,
        PS_DRUG_ASSIGNMENTS_V01_src.batch_id,
        PS_DRUG_ASSIGNMENTS_V01_src.row_id,
        PS_DRUG_ASSIGNMENTS_V01_src.update_ts
 FROM teva_ingestion.PS_DRUG_ASSIGNMENTS_V01_src;

CREATE  VIEW raw.PS_DRUG_ASSIGNMENTS_V01 AS
 SELECT src.drug_id,
        src.drug_seq,
        src.product,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_DRUG_ASSIGNMENTS_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_DRUG_ASSIGNMENTS_V01'::varchar(23)))));

CREATE  VIEW teva_ingestion.PS_FORMULARY_DERIVATION_CONFIG_V01 AS
 SELECT btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.has_pa_regex) AS has_pa_regex,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.has_st_regex) AS has_st_regex,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.formulary) AS formulary,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.tier_regex) AS tier_regex,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(PS_FORMULARY_DERIVATION_CONFIG_V01_src.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        PS_FORMULARY_DERIVATION_CONFIG_V01_src.batch_id,
        PS_FORMULARY_DERIVATION_CONFIG_V01_src.row_id,
        PS_FORMULARY_DERIVATION_CONFIG_V01_src.update_ts
 FROM teva_ingestion.PS_FORMULARY_DERIVATION_CONFIG_V01_src;

CREATE  VIEW raw.PS_FORMULARY_DERIVATION_CONFIG_V01 AS
 SELECT src.pharmacy_status_regex,
        src.has_pa_regex,
        src.has_st_regex,
        src.formulary,
        src.tier_regex,
        src.pref_brand_tier_regex,
        src.ftf_health_plan_type_regex,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FORMULARY_DERIVATION_CONFIG_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FORMULARY_DERIVATION_CONFIG_V01'::varchar(34)))));

CREATE  VIEW teva_ingestion.PS_FTF_OVERRIDE_PLAN_V01 AS
 SELECT btrim(PS_FTF_OVERRIDE_PLAN_V01_src.ftf_health_plan_fid) AS ftf_health_plan_fid,
        btrim(PS_FTF_OVERRIDE_PLAN_V01_src.paytype_index) AS paytype_index,
        btrim(PS_FTF_OVERRIDE_PLAN_V01_src.notes) AS notes,
        PS_FTF_OVERRIDE_PLAN_V01_src.batch_id,
        PS_FTF_OVERRIDE_PLAN_V01_src.row_id,
        PS_FTF_OVERRIDE_PLAN_V01_src.update_ts
 FROM teva_ingestion.PS_FTF_OVERRIDE_PLAN_V01_src;

CREATE  VIEW raw.PS_FTF_OVERRIDE_PLAN_V01 AS
 SELECT src.ftf_health_plan_fid,
        src.paytype_index,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FTF_OVERRIDE_PLAN_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FTF_OVERRIDE_PLAN_V01'::varchar(24)))));

CREATE  VIEW teva_ingestion.PS_FTF_OVERRIDE_PROVIDER_V01 AS
 SELECT btrim(PS_FTF_OVERRIDE_PROVIDER_V01_src.provider_fid) AS provider_fid,
        btrim(PS_FTF_OVERRIDE_PROVIDER_V01_src.paytype_index) AS paytype_index,
        btrim(PS_FTF_OVERRIDE_PROVIDER_V01_src.notes) AS notes,
        PS_FTF_OVERRIDE_PROVIDER_V01_src.batch_id,
        PS_FTF_OVERRIDE_PROVIDER_V01_src.row_id,
        PS_FTF_OVERRIDE_PROVIDER_V01_src.update_ts
 FROM teva_ingestion.PS_FTF_OVERRIDE_PROVIDER_V01_src;

CREATE  VIEW raw.PS_FTF_OVERRIDE_PROVIDER_V01 AS
 SELECT src.provider_fid,
        src.paytype_index,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FTF_OVERRIDE_PROVIDER_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FTF_OVERRIDE_PROVIDER_V01'::varchar(28)))));

CREATE  VIEW teva_ingestion.PS_FTF_PAYTYPE_PAYTYPEINDEX_V01 AS
 SELECT btrim(PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src.paytype_index) AS paytype_index,
        btrim(PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src.paytype) AS paytype,
        PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src.batch_id,
        PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src.row_id,
        PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src.update_ts
 FROM teva_ingestion.PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src;

CREATE  VIEW raw.PS_FTF_PAYTYPE_PAYTYPEINDEX_V01 AS
 SELECT src.paytype_index,
        src.paytype,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FTF_PAYTYPE_PAYTYPEINDEX_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FTF_PAYTYPE_PAYTYPEINDEX_V01'::varchar(31)))));

CREATE  VIEW teva_ingestion.PS_FTF_PLANS_PAYTYPEINDEX_V01 AS
 SELECT btrim(PS_FTF_PLANS_PAYTYPEINDEX_V01_src.ftf_health_plan_type) AS ftf_health_plan_type,
        btrim(PS_FTF_PLANS_PAYTYPEINDEX_V01_src.paytype_index) AS paytype_index,
        PS_FTF_PLANS_PAYTYPEINDEX_V01_src.batch_id,
        PS_FTF_PLANS_PAYTYPEINDEX_V01_src.row_id,
        PS_FTF_PLANS_PAYTYPEINDEX_V01_src.update_ts
 FROM teva_ingestion.PS_FTF_PLANS_PAYTYPEINDEX_V01_src;

CREATE  VIEW raw.PS_FTF_PLANS_PAYTYPEINDEX_V01 AS
 SELECT src.ftf_health_plan_type,
        src.paytype_index,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FTF_PLANS_PAYTYPEINDEX_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FTF_PLANS_PAYTYPEINDEX_V01'::varchar(29)))));

CREATE  VIEW teva_ingestion.PS_HAS_PA_MAPPING_V01 AS
 SELECT btrim(PS_HAS_PA_MAPPING_V01_src.has_pa) AS has_pa,
        btrim(PS_HAS_PA_MAPPING_V01_src.pa_regex) AS pa_regex,
        btrim(PS_HAS_PA_MAPPING_V01_src.notes) AS notes,
        PS_HAS_PA_MAPPING_V01_src.batch_id,
        PS_HAS_PA_MAPPING_V01_src.row_id,
        PS_HAS_PA_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_HAS_PA_MAPPING_V01_src;

CREATE  VIEW raw.PS_HAS_PA_MAPPING_V01 AS
 SELECT src.has_pa,
        src.pa_regex,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_HAS_PA_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_HAS_PA_MAPPING_V01'::varchar(21)))));

CREATE  VIEW teva_ingestion.PS_HAS_ST_MAPPING_V01 AS
 SELECT btrim(PS_HAS_ST_MAPPING_V01_src.has_st) AS has_st,
        btrim(PS_HAS_ST_MAPPING_V01_src.st_regex) AS st_regex,
        btrim(PS_HAS_ST_MAPPING_V01_src.notes) AS notes,
        PS_HAS_ST_MAPPING_V01_src.batch_id,
        PS_HAS_ST_MAPPING_V01_src.row_id,
        PS_HAS_ST_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_HAS_ST_MAPPING_V01_src;

CREATE  VIEW raw.PS_HAS_ST_MAPPING_V01 AS
 SELECT src.has_st,
        src.st_regex,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_HAS_ST_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_HAS_ST_MAPPING_V01'::varchar(21)))));

CREATE  VIEW teva_ingestion.PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01 AS
 SELECT btrim(PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.iqvia_payer_name) AS iqvia_payer_name,
        btrim(PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.paytype) AS paytype,
        PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.batch_id,
        PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.row_id,
        PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src.update_ts
 FROM teva_ingestion.PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src;

CREATE  VIEW raw.PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01 AS
 SELECT src.iqvia_payer_name,
        src.iqvia_plan_name_regex,
        src.paytype,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_IQVIA_PAYER_PAYTYPE_OVERRIDE_V01'::varchar(35)))));

CREATE  VIEW teva_ingestion.PS_IQVIA_PAYTYPEINDEX_V01 AS
 SELECT btrim(PS_IQVIA_PAYTYPEINDEX_V01_src.paytype_index) AS paytype_index,
        btrim(PS_IQVIA_PAYTYPEINDEX_V01_src.paytype) AS paytype,
        PS_IQVIA_PAYTYPEINDEX_V01_src.batch_id,
        PS_IQVIA_PAYTYPEINDEX_V01_src.row_id,
        PS_IQVIA_PAYTYPEINDEX_V01_src.update_ts
 FROM teva_ingestion.PS_IQVIA_PAYTYPEINDEX_V01_src;

CREATE  VIEW raw.PS_IQVIA_PAYTYPEINDEX_V01 AS
 SELECT src.paytype_index,
        src.paytype,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_IQVIA_PAYTYPEINDEX_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_IQVIA_PAYTYPEINDEX_V01'::varchar(25)))));

CREATE  VIEW teva_ingestion.PS_IQVIA_PLANS_DISCARD_V01 AS
 SELECT btrim(PS_IQVIA_PLANS_DISCARD_V01_src.payer_id) AS payer_id,
        btrim(PS_IQVIA_PLANS_DISCARD_V01_src.notes) AS notes,
        PS_IQVIA_PLANS_DISCARD_V01_src.batch_id,
        PS_IQVIA_PLANS_DISCARD_V01_src.row_id,
        PS_IQVIA_PLANS_DISCARD_V01_src.update_ts
 FROM teva_ingestion.PS_IQVIA_PLANS_DISCARD_V01_src;

CREATE  VIEW raw.PS_IQVIA_PLANS_DISCARD_V01 AS
 SELECT src.payer_id,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_IQVIA_PLANS_DISCARD_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_IQVIA_PLANS_DISCARD_V01'::varchar(26)))));

CREATE  VIEW teva_ingestion.PS_KEY_CONTROLLER_LIST_V01 AS
 SELECT btrim(PS_KEY_CONTROLLER_LIST_V01_src.ftf_health_plan_fid) AS ftf_health_plan_fid,
        btrim(PS_KEY_CONTROLLER_LIST_V01_src.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(PS_KEY_CONTROLLER_LIST_V01_src.key_controlling_account) AS key_controlling_account,
        btrim(PS_KEY_CONTROLLER_LIST_V01_src.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(PS_KEY_CONTROLLER_LIST_V01_src.key_controlling_parent) AS key_controlling_parent,
        btrim(PS_KEY_CONTROLLER_LIST_V01_src.payer_pbm) AS payer_pbm,
        PS_KEY_CONTROLLER_LIST_V01_src.batch_id,
        PS_KEY_CONTROLLER_LIST_V01_src.row_id,
        PS_KEY_CONTROLLER_LIST_V01_src.update_ts
 FROM teva_ingestion.PS_KEY_CONTROLLER_LIST_V01_src;

CREATE  VIEW raw.PS_KEY_CONTROLLER_LIST_V01 AS
 SELECT src.ftf_health_plan_fid,
        src.ftf_health_plan_name,
        src.key_controlling_account,
        src.key_controlling_plan_formulary,
        src.key_controlling_parent,
        src.payer_pbm,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_KEY_CONTROLLER_LIST_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_KEY_CONTROLLER_LIST_V01'::varchar(26)))));

CREATE  VIEW teva_ingestion.PS_MEDICAL_REC_RESTRICTION_V01 AS
 SELECT btrim(PS_MEDICAL_REC_RESTRICTION_V01_src.code) AS code,
        btrim(PS_MEDICAL_REC_RESTRICTION_V01_src.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(PS_MEDICAL_REC_RESTRICTION_V01_src.restriction_detail_id) AS restriction_detail_id,
        btrim(PS_MEDICAL_REC_RESTRICTION_V01_src.notes) AS notes,
        PS_MEDICAL_REC_RESTRICTION_V01_src.batch_id,
        PS_MEDICAL_REC_RESTRICTION_V01_src.row_id,
        PS_MEDICAL_REC_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_MEDICAL_REC_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_MEDICAL_REC_RESTRICTION_V01 AS
 SELECT src.code,
        src.medical_records_submission_required_flag,
        src.restriction_detail_id,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_MEDICAL_REC_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_MEDICAL_REC_RESTRICTION_V01'::varchar(30)))));

CREATE  VIEW teva_ingestion.PS_MODEL_PAYTYPE_MAP_V01 AS
 SELECT btrim(PS_MODEL_PAYTYPE_MAP_V01_src.model) AS model,
        btrim(PS_MODEL_PAYTYPE_MAP_V01_src.paytype) AS paytype,
        btrim(PS_MODEL_PAYTYPE_MAP_V01_src.notes) AS notes,
        PS_MODEL_PAYTYPE_MAP_V01_src.batch_id,
        PS_MODEL_PAYTYPE_MAP_V01_src.row_id,
        PS_MODEL_PAYTYPE_MAP_V01_src.update_ts
 FROM teva_ingestion.PS_MODEL_PAYTYPE_MAP_V01_src;

CREATE  VIEW raw.PS_MODEL_PAYTYPE_MAP_V01 AS
 SELECT src.model,
        src.paytype,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_MODEL_PAYTYPE_MAP_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_MODEL_PAYTYPE_MAP_V01'::varchar(24)))));

CREATE  VIEW teva_ingestion.PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01 AS
 SELECT btrim(PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        btrim(PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.override_precedence) AS override_precedence,
        PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.batch_id,
        PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.row_id,
        PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src.update_ts
 FROM teva_ingestion.PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src;

CREATE  VIEW raw.PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01 AS
 SELECT src.ftf_health_plan_name_regex,
        src.iqvia_payer_name_regex,
        src.iqvia_plan_name_regex,
        src.override_ftf_health_plan_type,
        src.override_precedence,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_OVERRIDE_BRIDGE_FTF_PLAN_TYPES_V01'::varchar(37)))));

CREATE  VIEW teva_ingestion.PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01 AS
 SELECT btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.iqvia_plan_code) AS iqvia_plan_code,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.iqvia_plan_name) AS iqvia_plan_name,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.ftf_health_plan_fid) AS ftf_health_plan_fid,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.key_controlling_account) AS key_controlling_account,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.key_controlling_parent) AS key_controlling_parent,
        btrim(PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.payer_pbm) AS payer_pbm,
        PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.batch_id,
        PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.row_id,
        PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src.update_ts
 FROM teva_ingestion.PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src;

CREATE  VIEW raw.PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01 AS
 SELECT src.iqvia_plan_code,
        src.iqvia_plan_name,
        src.ftf_health_plan_fid,
        src.ftf_health_plan_name,
        src.key_controlling_plan_formulary,
        src.key_controlling_account,
        src.key_controlling_parent,
        src.payer_pbm,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_OVERRIDE_FID_IQVIA_KEY_CONTROLLER_LIST_V01'::varchar(45)))));

CREATE  VIEW teva_ingestion.PS_PATIENT_PA_RESTRICTION_V01 AS
 SELECT btrim(PS_PATIENT_PA_RESTRICTION_V01_src.code) AS code,
        btrim(PS_PATIENT_PA_RESTRICTION_V01_src.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(PS_PATIENT_PA_RESTRICTION_V01_src.restriction_detail_id) AS restriction_detail_id,
        btrim(PS_PATIENT_PA_RESTRICTION_V01_src.notes) AS notes,
        PS_PATIENT_PA_RESTRICTION_V01_src.batch_id,
        PS_PATIENT_PA_RESTRICTION_V01_src.row_id,
        PS_PATIENT_PA_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_PATIENT_PA_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_PATIENT_PA_RESTRICTION_V01 AS
 SELECT src.code,
        src.patient_prior_authorization_category,
        src.restriction_detail_id,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_PATIENT_PA_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_PATIENT_PA_RESTRICTION_V01'::varchar(29)))));

CREATE  VIEW teva_ingestion.PS_PAT_PA_RESTRICTION_DESCRIPTION_V01 AS
 SELECT btrim(PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src.patpa) AS patpa,
        btrim(PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src.description) AS description,
        PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src.batch_id,
        PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src.row_id,
        PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src.update_ts
 FROM teva_ingestion.PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src;

CREATE  VIEW raw.PS_PAT_PA_RESTRICTION_DESCRIPTION_V01 AS
 SELECT src.patpa,
        src.description,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_PAT_PA_RESTRICTION_DESCRIPTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_PAT_PA_RESTRICTION_DESCRIPTION_V01'::varchar(37)))));

CREATE  VIEW teva_ingestion.PS_PA_RESTRICTION_V01 AS
 SELECT btrim(PS_PA_RESTRICTION_V01_src.code) AS code,
        btrim(PS_PA_RESTRICTION_V01_src.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(PS_PA_RESTRICTION_V01_src.restriction_detail_id) AS restriction_detail_id,
        btrim(PS_PA_RESTRICTION_V01_src.notes) AS notes,
        PS_PA_RESTRICTION_V01_src.batch_id,
        PS_PA_RESTRICTION_V01_src.row_id,
        PS_PA_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_PA_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_PA_RESTRICTION_V01 AS
 SELECT src.code,
        src.prescriber_prior_authorization_category,
        src.restriction_detail_id,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_PA_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_PA_RESTRICTION_V01'::varchar(21)))));

CREATE  VIEW teva_ingestion.PS_PRES_PA_RESTRICTION_DESCRIPTION_V01 AS
 SELECT btrim(PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src.prespa) AS prespa,
        btrim(PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src.description) AS description,
        PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src.batch_id,
        PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src.row_id,
        PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src.update_ts
 FROM teva_ingestion.PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src;

CREATE  VIEW raw.PS_PRES_PA_RESTRICTION_DESCRIPTION_V01 AS
 SELECT src.prespa,
        src.description,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_PRES_PA_RESTRICTION_DESCRIPTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_PRES_PA_RESTRICTION_DESCRIPTION_V01'::varchar(38)))));

CREATE  VIEW teva_ingestion.PS_PROVIDER_OVERRIDE_DEFAULT_V01 AS
 SELECT btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.provider_id) AS provider_id,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.paytype_regex) AS paytype_regex,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.provider_name) AS provider_name,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.override_best_iqvia_pbm) AS override_best_iqvia_pbm,
        PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.batch_id,
        PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.row_id,
        PS_PROVIDER_OVERRIDE_DEFAULT_V01_src.update_ts
 FROM teva_ingestion.PS_PROVIDER_OVERRIDE_DEFAULT_V01_src;

CREATE  VIEW raw.PS_PROVIDER_OVERRIDE_DEFAULT_V01 AS
 SELECT src.provider_id,
        src.paytype_regex,
        src.provider_name,
        src.fill_in_iqvia_payer_name_if_no_bridge,
        src.override_best_iqvia_payer,
        src.fill_in_iqvia_pbm_if_no_bridge,
        src.override_best_iqvia_pbm,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_PROVIDER_OVERRIDE_DEFAULT_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_PROVIDER_OVERRIDE_DEFAULT_V01'::varchar(32)))));

CREATE  VIEW teva_ingestion.PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01 AS
 SELECT btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.tier_regex) AS tier_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.unspec_regex) AS unspec_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.step_regex) AS step_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.botox_regex) AS botox_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.prespa_regex) AS prespa_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.tier_cat_regex) AS tier_cat_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.medrecs_regex) AS medrecs_regex,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.restcat) AS restcat,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.restriction_category) AS restriction_category,
        btrim(PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.meaning) AS meaning,
        PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.batch_id,
        PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.row_id,
        PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src.update_ts
 FROM teva_ingestion.PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src;

CREATE  VIEW raw.PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01 AS
 SELECT src.tier_regex,
        src.has_pa_has_st_regex,
        src.unspec_regex,
        src.step_regex,
        src.botox_regex,
        src.prespa_regex,
        src.tier_cat_regex,
        src.medrecs_regex,
        src.restcat,
        src.restriction_category,
        src.meaning,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_RESTRICTION_CATEGORY_DERIVATION_CONFIG_V01'::varchar(45)))));

CREATE  VIEW teva_ingestion.PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT btrim(PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.rest_cat) AS rest_cat,
        btrim(PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.description) AS description,
        btrim(PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.notes) AS notes,
        PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.batch_id,
        PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.row_id,
        PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src;

CREATE  VIEW raw.PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT src.rest_cat,
        src.description,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_RESTRICTION_CAT_DESCRIPTION_MAPPING_V01'::varchar(42)))));

CREATE  VIEW teva_ingestion.PS_STEP_RESTRICTION_DESCRIPTION_V01 AS
 SELECT btrim(PS_STEP_RESTRICTION_DESCRIPTION_V01_src.step) AS step,
        btrim(PS_STEP_RESTRICTION_DESCRIPTION_V01_src.description) AS description,
        PS_STEP_RESTRICTION_DESCRIPTION_V01_src.batch_id,
        PS_STEP_RESTRICTION_DESCRIPTION_V01_src.row_id,
        PS_STEP_RESTRICTION_DESCRIPTION_V01_src.update_ts
 FROM teva_ingestion.PS_STEP_RESTRICTION_DESCRIPTION_V01_src;

CREATE  VIEW raw.PS_STEP_RESTRICTION_DESCRIPTION_V01 AS
 SELECT src.step,
        src.description,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_STEP_RESTRICTION_DESCRIPTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_STEP_RESTRICTION_DESCRIPTION_V01'::varchar(35)))));

CREATE  VIEW teva_ingestion.PS_STEP_RESTRICTION_V01 AS
 SELECT btrim(PS_STEP_RESTRICTION_V01_src.code) AS code,
        btrim(PS_STEP_RESTRICTION_V01_src.step_category) AS step_category,
        btrim(PS_STEP_RESTRICTION_V01_src.restriction_group) AS restriction_group,
        btrim(PS_STEP_RESTRICTION_V01_src.notes) AS notes,
        PS_STEP_RESTRICTION_V01_src.batch_id,
        PS_STEP_RESTRICTION_V01_src.row_id,
        PS_STEP_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_STEP_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_STEP_RESTRICTION_V01 AS
 SELECT src.code,
        src.step_category,
        src.restriction_group,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_STEP_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_STEP_RESTRICTION_V01'::varchar(23)))));

CREATE  VIEW teva_ingestion.PS_TIER_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT btrim(PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.tier_cat) AS tier_cat,
        btrim(PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.description) AS description,
        btrim(PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.notes) AS notes,
        PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.batch_id,
        PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.row_id,
        PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src.update_ts
 FROM teva_ingestion.PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src;

CREATE  VIEW raw.PS_TIER_CAT_DESCRIPTION_MAPPING_V01 AS
 SELECT src.tier_cat,
        src.description,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_TIER_CAT_DESCRIPTION_MAPPING_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_TIER_CAT_DESCRIPTION_MAPPING_V01'::varchar(35)))));

CREATE  VIEW teva_ingestion.PS_UNSPECIFIED_REC_RESTRICTION_V01 AS
 SELECT btrim(PS_UNSPECIFIED_REC_RESTRICTION_V01_src.code) AS code,
        btrim(PS_UNSPECIFIED_REC_RESTRICTION_V01_src.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(PS_UNSPECIFIED_REC_RESTRICTION_V01_src.restriction_detail_id) AS restriction_detail_id,
        btrim(PS_UNSPECIFIED_REC_RESTRICTION_V01_src.notes) AS notes,
        PS_UNSPECIFIED_REC_RESTRICTION_V01_src.batch_id,
        PS_UNSPECIFIED_REC_RESTRICTION_V01_src.row_id,
        PS_UNSPECIFIED_REC_RESTRICTION_V01_src.update_ts
 FROM teva_ingestion.PS_UNSPECIFIED_REC_RESTRICTION_V01_src;

CREATE  VIEW raw.PS_UNSPECIFIED_REC_RESTRICTION_V01 AS
 SELECT src.code,
        src.unspecified_restriction_flag,
        src.restriction_detail_id,
        src.notes,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_UNSPECIFIED_REC_RESTRICTION_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_UNSPECIFIED_REC_RESTRICTION_V01'::varchar(34)))));

CREATE  VIEW teva_ingestion.PS_FTF_PBM_FUNCTIONS_V01 AS
 SELECT btrim(PS_FTF_PBM_FUNCTIONS_V01_src.pbm_function_id) AS pbm_function_id,
        btrim(PS_FTF_PBM_FUNCTIONS_V01_src.pbm_function) AS pbm_function,
        btrim(PS_FTF_PBM_FUNCTIONS_V01_src.notes) AS notes,
        btrim(PS_FTF_PBM_FUNCTIONS_V01_src.used) AS used,
        PS_FTF_PBM_FUNCTIONS_V01_src.batch_id,
        PS_FTF_PBM_FUNCTIONS_V01_src.row_id,
        PS_FTF_PBM_FUNCTIONS_V01_src.update_ts
 FROM teva_ingestion.PS_FTF_PBM_FUNCTIONS_V01_src;

CREATE  VIEW raw.PS_FTF_PBM_FUNCTIONS_V01 AS
 SELECT src.pbm_function_id,
        src.pbm_function,
        src.notes,
        src.used,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.PS_FTF_PBM_FUNCTIONS_V01_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'PS_FTF_PBM_FUNCTIONS_V01'::varchar(24)))));

CREATE  VIEW sandbox.vw_curr_payer_spine25_detailed_teva_brands_cdw_v1 AS
 SELECT payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.payment_type,
        payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_detailed_teva_brands_cdw_v1.saba_trx,
        payer_spine25_detailed_teva_brands_cdw_v1.cycle_id,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_time,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_by
 FROM sandbox.payer_spine25_detailed_teva_brands_cdw_v1
 WHERE (payer_spine25_detailed_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_detailed_teva_brands_cdw_v1'::varchar(41)))))));

CREATE  VIEW teva_ingestion.EXT_FTF_FORMULARIES AS
 SELECT btrim(EXT_FTF_FORMULARIES_src.HEALTH_PLAN_ID) AS HEALTH_PLAN_ID,
        btrim(EXT_FTF_FORMULARIES_src.DRUG_ID) AS DRUG_ID,
        btrim(EXT_FTF_FORMULARIES_src.TIER_CODE) AS TIER_CODE,
        btrim(EXT_FTF_FORMULARIES_src.RESTRICTIONS) AS RESTRICTIONS,
        btrim(EXT_FTF_FORMULARIES_src.REASON_CODE) AS REASON_CODE,
        btrim(EXT_FTF_FORMULARIES_src.REASON_CODE_DESCRIPTION) AS REASON_CODE_DESCRIPTION,
        btrim(EXT_FTF_FORMULARIES_src.pharmacy_status) AS pharmacy_status,
        btrim(EXT_FTF_FORMULARIES_src.market_access_coverage) AS market_access_coverage,
        EXT_FTF_FORMULARIES_src.batch_id,
        EXT_FTF_FORMULARIES_src.row_id,
        EXT_FTF_FORMULARIES_src.update_ts
 FROM teva_ingestion.EXT_FTF_FORMULARIES_src
 WHERE (EXT_FTF_FORMULARIES_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_FTF_FORMULARIES'::varchar(19))));

CREATE  VIEW raw.ext_ftf_formularies AS
 SELECT src.HEALTH_PLAN_ID,
        src.DRUG_ID,
        src.TIER_CODE,
        src.RESTRICTIONS,
        src.REASON_CODE,
        src.REASON_CODE_DESCRIPTION,
        src.pharmacy_status,
        src.market_access_coverage,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_FTF_FORMULARIES_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_FTF_FORMULARIES'::varchar(19)))));

CREATE  VIEW outbound.v_ob_ahm_orgstructure AS
 SELECT R.territory_number AS OrganizationUnitId,
        coalesce(R.territory_name, ''::varchar) AS OrganizationUnitName,
        'ORGU'::varchar(4) AS OrganizationUnitType,
        CASE WHEN (G.geography_type = 'Territory'::varchar(9)) THEN 'TERR'::varchar(4) WHEN (G.geography_type = 'Region'::varchar(6)) THEN 'DIST'::varchar(4) WHEN (G.geography_type = 'Area'::varchar(4)) THEN 'REG'::varchar(3) ELSE NULL END AS OrganizationUnitSubType,
        CASE WHEN (G.geography_type = 'Area'::varchar(4)) THEN CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END ELSE coalesce(G.parent_geography_number, ''::varchar) END AS ParentOrganizationUnitId,
        'US'::varchar(2) AS RegionId,
        'TEVA'::varchar(4) AS CompanyId,
        B.ref_code AS BusinessUnitId,
        CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END AS OrganizationId,
        ''::varchar AS TeamId,
        '2017-01-01'::varchar(10) AS EffectiveDate,
        '2040-12-31'::varchar(10) AS EndDate,
        'ACTIVE'::varchar(6) AS Status
 FROM datamart.roster R, datamart.sales_geography G, reference.salesforce_reference B, reference.salesforce_reference P
 WHERE ((R.territory_number = G.geography_number) AND (R.sales_force_id = B.sales_force_id) AND (B.ref_type = 'Bus_Unit'::varchar(8)) AND (R.sales_force_id = P.sales_force_id) AND (P.ref_type = 'Org_ID'::varchar(6)) AND (R.territory_number IS NOT NULL) AND (R.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND ((R.territory_number !~~ '%ZZZZ99'::varchar(7)) OR (R.territory_number <> ALL (ARRAY['TRZZZZ99'::varchar(8), 'TOSCGZ02'::varchar(8), 'TOSCGZ03'::varchar(8), 'TOSCGZ04'::varchar(8), 'TEZZZZZZ'::varchar(8)]))) AND (G.geography_type <> 'National'::varchar(8)))
 GROUP BY R.territory_number,
          coalesce(R.territory_name, ''::varchar),
          'ORGU'::varchar(4),
          CASE WHEN (G.geography_type = 'Territory'::varchar(9)) THEN 'TERR'::varchar(4) WHEN (G.geography_type = 'Region'::varchar(6)) THEN 'DIST'::varchar(4) WHEN (G.geography_type = 'Area'::varchar(4)) THEN 'REG'::varchar(3) ELSE NULL END,
          CASE WHEN (G.geography_type = 'Area'::varchar(4)) THEN CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END ELSE coalesce(G.parent_geography_number, ''::varchar) END,
          'US'::varchar(2),
          'TEVA'::varchar(4),
          B.ref_code,
          CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END,
          ''::varchar,
          '2017-01-01'::varchar(10),
          '2040-12-31'::varchar(10),
          'ACTIVE'::varchar(6) UNION  SELECT R.territory_number AS OrganizationUnitId,
        coalesce(R.territory_name, ''::varchar) AS OrganizationUnitName,
        'ORGU'::varchar(4) AS OrganizationUnitType,
        'REG'::varchar(3) AS OrganizationUnitSubType,
        CASE WHEN (G.geography_type = 'Area'::varchar(4)) THEN CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END ELSE coalesce(G.parent_geography_number, ''::varchar) END AS ParentOrganizationUnitId,
        'US'::varchar(2) AS RegionId,
        'TEVA'::varchar(4) AS CompanyId,
        B.ref_code AS BusinessUnitId,
        CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END AS OrganizationId,
        ''::varchar AS TeamId,
        '2017-01-01'::varchar(10) AS EffectiveDate,
        '2040-12-31'::varchar(10) AS EndDate,
        'ACTIVE'::varchar(6) AS Status
 FROM datamart.roster R, datamart.sales_geography G, reference.salesforce_reference B, reference.salesforce_reference P
 WHERE ((R.territory_number = G.geography_number) AND (R.sales_force_id = B.sales_force_id) AND (B.ref_type = 'Bus_Unit'::varchar(8)) AND (R.sales_force_id = P.sales_force_id) AND (P.ref_type = 'Org_ID'::varchar(6)) AND (R.territory_number IS NOT NULL) AND (R.territory_number = 'TRZZZZ00'::varchar(8)))
 GROUP BY R.territory_number,
          coalesce(R.territory_name, ''::varchar),
          'ORGU'::varchar(4),
          'REG'::varchar(3),
          CASE WHEN (G.geography_type = 'Area'::varchar(4)) THEN CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END ELSE coalesce(G.parent_geography_number, ''::varchar) END,
          'US'::varchar(2),
          'TEVA'::varchar(4),
          B.ref_code,
          CASE WHEN (substr(R.territory_number, 1, 3) = 'TEC'::varchar(3)) THEN 'CNS_PS'::varchar(6) WHEN (substr(R.territory_number, 1, 3) = 'TER'::varchar(3)) THEN 'RES_PS'::varchar(6) ELSE P.ref_code END,
          ''::varchar,
          '2017-01-01'::varchar(10),
          '2040-12-31'::varchar(10),
          'ACTIVE'::varchar(6);

CREATE  VIEW public.parquet_export_events AS
 SELECT udx_events.report_time,
        udx_events.node_name,
        udx_events.session_id,
        udx_events.user_id,
        udx_events.user_name,
        udx_events.transaction_id,
        udx_events.statement_id,
        udx_events.request_id,
        udx_events.udx_name,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'file'::varchar(4)) AS file,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'created'::varchar(7)) AS created,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'closed'::varchar(6)) AS closed,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'rows'::varchar(4)) AS rows,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'row_groups'::varchar(10)) AS row_groups,
        public.MapLookup((udx_events.__raw__)::long varchar(64000), 'size_mb'::varchar(7)) AS size_mb
 FROM v_monitor.udx_events
 WHERE (udx_events.udx_name ~~* 'ParquetExport%'::varchar(14));

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_VOD__C AS
 SELECT btrim(EXT_VV_CALL2_VOD__C_src.id) AS id,
        btrim(EXT_VV_CALL2_VOD__C_src.ownerid) AS ownerid,
        btrim(EXT_VV_CALL2_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_CALL2_VOD__C_src.name) AS name,
        btrim(EXT_VV_CALL2_VOD__C_src.recordtypeid) AS recordtypeid,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.createddate))::timestamp END AS createddate,
        btrim(EXT_VV_CALL2_VOD__C_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_CALL2_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_CALL2_VOD__C_src.systemmodstamp) AS systemmodstamp,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.lastactivitydate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.lastactivitydate))::timestamp END AS lastactivitydate,
        btrim(EXT_VV_CALL2_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_CALL2_VOD__C_src.islocked) AS islocked,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_VV_CALL2_VOD__C_src.sample_card_vod__c) AS sample_card_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.add_detail_vod__c) AS add_detail_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.property_vod__c) AS property_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_product_discussion_vod__c) AS zvod_product_discussion_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.status_vod__c) AS status_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.parent_address_vod__c) AS parent_address_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.account_plan_vod__c) AS account_plan_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_savenew_vod__c) AS zvod_savenew_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.next_call_notes_vod__c) AS next_call_notes_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_account_credentials_vod_c) AS zvod_account_credentials_vod_c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_account_preferred_name_vo) AS zvod_account_preferred_name_vo,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_account_sample_status_vod) AS zvod_account_sample_status_vod,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_attendees_vod__c) AS zvod_attendees_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_key_messages_vod__c) AS zvod_key_messages_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_detailing_vod__c) AS zvod_detailing_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_expenses_vod__c) AS zvod_expenses_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_followup_vod__c) AS zvod_followup_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_samples_vod__c) AS zvod_samples_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_save_vod__c) AS zvod_save_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_submit_vod__c) AS zvod_submit_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_delete_vod__c) AS zvod_delete_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.activity_type__c) AS activity_type__c,
        btrim(EXT_VV_CALL2_VOD__C_src.significant_event__c) AS significant_event__c,
        btrim(EXT_VV_CALL2_VOD__C_src.location_vod__c) AS location_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.subject_vod__c) AS subject_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.call_datetime_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.call_datetime_vod__c))::timestamp END AS call_datetime_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.disbursed_to_vod__c) AS disbursed_to_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.request_receipt_vod__c) AS request_receipt_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.signature_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.signature_date_vod__c))::timestamp END AS signature_date_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.territory_vod__c) AS territory_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.submitted_by_mobile_vod__c) AS submitted_by_mobile_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.call_type_vod__c) AS call_type_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.add_key_message_vod__c) AS add_key_message_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.address_vod__c) AS address_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.attendees_vod__c) AS attendees_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.attendee_type_vod__c) AS attendee_type_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.call_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.call_date_vod__c))::timestamp END AS call_date_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.detailed_products_vod__c) AS detailed_products_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.no_disbursement_vod__c) AS no_disbursement_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.parent_call_vod__c) AS parent_call_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.user_vod__c) AS user_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.contact_vod__c) AS contact_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_entity_vod__c) AS zvod_entity_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.medical_event_vod__c) AS medical_event_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.mobile_created_datetime_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.mobile_created_datetime_vod__c))::timestamp END AS mobile_created_datetime_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.mobile_last_modified_datetime = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.mobile_last_modified_datetime))::timestamp END AS mobile_last_modified_datetime,
        btrim(EXT_VV_CALL2_VOD__C_src.license_vod__c) AS license_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.is_parent_call_vod__c) AS is_parent_call_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.entity_display_name_vod__c) AS entity_display_name_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.last_device_vod__c) AS last_device_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_address_line_1_vod__c) AS ship_address_line_1_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_address_line_2_vod__c) AS ship_address_line_2_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_city_vod__c) AS ship_city_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_country_vod__c) AS ship_country_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.ship_license_expiration_date = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.ship_license_expiration_date))::timestamp END AS ship_license_expiration_date,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_license_status_vod__c) AS ship_license_status_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_license_vod__c) AS ship_license_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_state_vod__c) AS ship_state_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_to_address_vod__c) AS ship_to_address_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_zip_vod__c) AS ship_zip_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_to_address_text_vod__c) AS ship_to_address_text_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.clm_vod__c) AS clm_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_clmdetails_vod__c) AS zvod_clmdetails_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.is_sampled_call_vod__c) AS is_sampled_call_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_surveys_vod__c) AS zvod_surveys_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.presentations_vod__c) AS presentations_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.entity_reference_id_vod__c) AS entity_reference_id_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.error_reference_call_vod__c) AS error_reference_call_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.duration_vod__c) AS duration_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.color_vod__c) AS color_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.allowed_products_vod__c) AS allowed_products_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_attachments_vod__c) AS zvod_attachments_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.sample_card_reason_vod__c) AS sample_card_reason_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.assmca_vod__c) AS assmca_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.address_line_1_vod__c) AS address_line_1_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.address_line_2_vod__c) AS address_line_2_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.city_vod__c) AS city_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_address_line_1_vod__c) AS dea_address_line_1_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_address_line_2_vod__c) AS dea_address_line_2_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_address_vod__c) AS dea_address_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_city_vod__c) AS dea_city_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.dea_expiration_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.dea_expiration_date_vod__c))::timestamp END AS dea_expiration_date_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_state_vod__c) AS dea_state_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_zip_4_vod__c) AS dea_zip_4_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_zip_vod__c) AS dea_zip_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.dea_vod__c) AS dea_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_zip_4_vod__c) AS ship_zip_4_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.state_vod__c) AS state_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zip_4_vod__c) AS zip_4_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zip_vod__c) AS zip_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.sample_send_card_vod__c) AS sample_send_card_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_address_vod_c_dea_status_) AS zvod_address_vod_c_dea_status_,
        btrim(EXT_VV_CALL2_VOD__C_src.signature_page_image_vod__c) AS signature_page_image_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.credentials_vod__c) AS credentials_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.salutation_vod__c) AS salutation_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_account_call_reminder_vod) AS zvod_account_call_reminder_vod,
        btrim(EXT_VV_CALL2_VOD__C_src.sales_org_tva__c) AS sales_org_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_business_account_vod__c) AS zvod_business_account_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.product_priority_1_vod__c) AS product_priority_1_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.product_priority_2_vod__c) AS product_priority_2_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.product_priority_3_vod__c) AS product_priority_3_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.product_priority_4_vod__c) AS product_priority_4_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.product_priority_5_vod__c) AS product_priority_5_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_more_actions_vod__c) AS zvod_more_actions_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_call_conflict_status) AS zvod_call_conflict_status,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.signature_timestamp_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.signature_timestamp_vod__c))::timestamp END AS signature_timestamp_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.expense_amount_vod__c) AS expense_amount_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.total_expense_attendees_count) AS total_expense_attendees_count,
        btrim(EXT_VV_CALL2_VOD__C_src.attendee_list_vod__c) AS attendee_list_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.expense_post_status_vod__c) AS expense_post_status_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.attendee_post_status_vod__c) AS attendee_post_status_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.expense_system_external_id) AS expense_system_external_id,
        btrim(EXT_VV_CALL2_VOD__C_src.incurred_expense_vod__c) AS incurred_expense_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.assigner_vod__c) AS assigner_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.assignment_datetime_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.assignment_datetime_vod__c))::timestamp END AS assignment_datetime_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.zvod_call_objective_vod__c) AS zvod_call_objective_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.signature_location_longitude) AS signature_location_longitude,
        btrim(EXT_VV_CALL2_VOD__C_src.signature_location_latitude) AS signature_location_latitude,
        btrim(EXT_VV_CALL2_VOD__C_src.location_services_status) AS location_services_status,
        btrim(EXT_VV_CALL2_VOD__C_src.created_by_timezone_tva__c) AS created_by_timezone_tva__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.license_expiration_date_vod__c = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.license_expiration_date_vod__c))::timestamp END AS license_expiration_date_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.license_status_vod__c) AS license_status_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_assmca_vod__c) AS ship_assmca_vod__c,
        CASE WHEN (EXT_VV_CALL2_VOD__C_src.ship_dea_expiration_date = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_CALL2_VOD__C_src.ship_dea_expiration_date))::timestamp END AS ship_dea_expiration_date,
        btrim(EXT_VV_CALL2_VOD__C_src.ship_dea_vod__c) AS ship_dea_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.call_method_tva__c) AS call_method_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.bendeka_indication_tva__c) AS bendeka_indication_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.austedo_indication_tva__c) AS austedo_indication_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.call_duration_tva__c) AS call_duration_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.How_Executed_TVA__c) AS how_executed_tva__c,
        btrim(EXT_VV_CALL2_VOD__C_src.Remote_Meeting_vod__c) AS remote_meeting_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.Veeva_Remote_Meeting_Id_vod__c) AS veeva_remote_meeting_id_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.Cobrowse_URL_Participant_vod__c) AS cobrowse_url_participant_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.Signature_Captured_Remotely_vod__c) AS signature_captured_remotely_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.Remote_Signature_Attendee_Name_vod__c) AS remote_signature_attendee_name_vod__c,
        btrim(EXT_VV_CALL2_VOD__C_src.t21s10_austedo_indication_tva__c) AS t21s10_austedo_indication_tva__c,
        EXT_VV_CALL2_VOD__C_src.batch_id,
        EXT_VV_CALL2_VOD__C_src.row_id,
        EXT_VV_CALL2_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL2_VOD__C_src;

CREATE  VIEW raw.EXT_VV_CALL2_VOD__C AS
 SELECT src.id,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.lastactivitydate,
        src.mayedit,
        src.islocked,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.sample_card_vod__c,
        src.add_detail_vod__c,
        src.property_vod__c,
        src.account_vod__c,
        src.zvod_product_discussion_vod__c,
        src.status_vod__c,
        src.parent_address_vod__c,
        src.account_plan_vod__c,
        src.zvod_savenew_vod__c,
        src.next_call_notes_vod__c,
        src.mobile_id_vod__c,
        src.zvod_account_credentials_vod_c,
        src.zvod_account_preferred_name_vo,
        src.zvod_account_sample_status_vod,
        src.zvod_attendees_vod__c,
        src.zvod_key_messages_vod__c,
        src.zvod_detailing_vod__c,
        src.zvod_expenses_vod__c,
        src.zvod_followup_vod__c,
        src.zvod_samples_vod__c,
        src.zvod_save_vod__c,
        src.zvod_submit_vod__c,
        src.zvod_delete_vod__c,
        src.activity_type__c,
        src.significant_event__c,
        src.location_vod__c,
        src.subject_vod__c,
        src.call_datetime_vod__c,
        src.disbursed_to_vod__c,
        src.request_receipt_vod__c,
        src.signature_date_vod__c,
        src.territory_vod__c,
        src.submitted_by_mobile_vod__c,
        src.call_type_vod__c,
        src.add_key_message_vod__c,
        src.address_vod__c,
        src.attendees_vod__c,
        src.attendee_type_vod__c,
        src.call_date_vod__c,
        src.detailed_products_vod__c,
        src.no_disbursement_vod__c,
        src.parent_call_vod__c,
        src.user_vod__c,
        src.contact_vod__c,
        src.zvod_entity_vod__c,
        src.medical_event_vod__c,
        src.mobile_created_datetime_vod__c,
        src.mobile_last_modified_datetime,
        src.license_vod__c,
        src.is_parent_call_vod__c,
        src.entity_display_name_vod__c,
        src.last_device_vod__c,
        src.ship_address_line_1_vod__c,
        src.ship_address_line_2_vod__c,
        src.ship_city_vod__c,
        src.ship_country_vod__c,
        src.ship_license_expiration_date,
        src.ship_license_status_vod__c,
        src.ship_license_vod__c,
        src.ship_state_vod__c,
        src.ship_to_address_vod__c,
        src.ship_zip_vod__c,
        src.ship_to_address_text_vod__c,
        src.clm_vod__c,
        src.zvod_clmdetails_vod__c,
        src.is_sampled_call_vod__c,
        src.zvod_surveys_vod__c,
        src.presentations_vod__c,
        src.entity_reference_id_vod__c,
        src.error_reference_call_vod__c,
        src.duration_vod__c,
        src.color_vod__c,
        src.allowed_products_vod__c,
        src.zvod_attachments_vod__c,
        src.sample_card_reason_vod__c,
        src.assmca_vod__c,
        src.address_line_1_vod__c,
        src.address_line_2_vod__c,
        src.city_vod__c,
        src.dea_address_line_1_vod__c,
        src.dea_address_line_2_vod__c,
        src.dea_address_vod__c,
        src.dea_city_vod__c,
        src.dea_expiration_date_vod__c,
        src.dea_state_vod__c,
        src.dea_zip_4_vod__c,
        src.dea_zip_vod__c,
        src.dea_vod__c,
        src.ship_zip_4_vod__c,
        src.state_vod__c,
        src.zip_4_vod__c,
        src.zip_vod__c,
        src.sample_send_card_vod__c,
        src.zvod_address_vod_c_dea_status_,
        src.signature_page_image_vod__c,
        src.credentials_vod__c,
        src.salutation_vod__c,
        src.zvod_account_call_reminder_vod,
        src.sales_org_tva__c,
        src.zvod_business_account_vod__c,
        src.product_priority_1_vod__c,
        src.product_priority_2_vod__c,
        src.product_priority_3_vod__c,
        src.product_priority_4_vod__c,
        src.product_priority_5_vod__c,
        src.zvod_more_actions_vod__c,
        src.zvod_call_conflict_status,
        src.signature_timestamp_vod__c,
        src.expense_amount_vod__c,
        src.total_expense_attendees_count,
        src.attendee_list_vod__c,
        src.expense_post_status_vod__c,
        src.attendee_post_status_vod__c,
        src.expense_system_external_id,
        src.incurred_expense_vod__c,
        src.assigner_vod__c,
        src.assignment_datetime_vod__c,
        src.zvod_call_objective_vod__c,
        src.signature_location_longitude,
        src.signature_location_latitude,
        src.location_services_status,
        src.created_by_timezone_tva__c,
        src.license_expiration_date_vod__c,
        src.license_status_vod__c,
        src.ship_assmca_vod__c,
        src.ship_dea_expiration_date,
        src.ship_dea_vod__c,
        src.call_method_tva__c,
        src.bendeka_indication_tva__c,
        src.austedo_indication_tva__c,
        src.call_duration_tva__c,
        src.How_Executed_TVA__c AS how_executed_tva__c,
        src.Remote_Meeting_vod__c AS remote_meeting_vod__c,
        src.Veeva_Remote_Meeting_Id_vod__c AS veeva_remote_meeting_id_vod__c,
        src.Cobrowse_URL_Participant_vod__c AS cobrowse_url_participant_vod__c,
        src.Signature_Captured_Remotely_vod__c AS signature_captured_remotely_vod__c,
        src.Remote_Signature_Attendee_Name_vod__c AS remote_signature_attendee_name_vod__c,
        src.t21s10_austedo_indication_tva__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_CALL2_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_CALL2_VOD__C'::varchar(19)))));

CREATE  VIEW public.sql_files_view AS
 SELECT 'Please run compute_flextable_keys_and_build_view() to update this view to reflect real and virtual columns in the flex table'::varchar(124) AS status
 FROM v_catalog.dual;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_tb_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, replace(rt1.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_from_account_type, acct1.OUTLET_ID_TVA__C AS ims_outlet_code, acct1.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, replace(rt2.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_to_account_type, acct2.ID_VOD__C AS ims_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt1 ON ((acct1.RECORDTYPEID = rt1.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt2 ON ((acct2.RECORDTYPEID = rt2.ID))) JOIN (SELECT acctshr.ACCOUNTID AS accountid FROM (WSMP_ADMIN.VV_ACCOUNTSHARE acctshr JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) WHERE (g.DEVELOPERNAME ~~ 'TB%'::varchar(3)) GROUP BY acctshr.ACCOUNTID) x ON ((acct1.ID = x.accountid))) WHERE (rt1.NAME <> ALL (ARRAY['Professional_vod'::varchar(16), 'Staff'::varchar(5)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_segment AS
SELECT iq.veeva_account_id, iq.product_name, iq.segment FROM (SELECT pm.ACCOUNT_VOD__C AS veeva_account_id, p.NAME AS product_name, coalesce(pm.SEGMENT__C, pm.BUSINESS_SEGMENT_TVA__C) AS segment, row_number() OVER (PARTITION BY pm.ACCOUNT_VOD__C, p.NAME ORDER BY pm.LASTMODIFIEDDATE) AS rnk FROM (WSMP_ADMIN.VV_PRODUCT_METRICS_VOD__C pm JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((pm.PRODUCTS_VOD__C = p.ID))) WHERE ((pm.SEGMENT__C IS NOT NULL) OR (pm.BUSINESS_SEGMENT_TVA__C IS NOT NULL))) iq WHERE (iq.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_samples AS
SELECT s.ID AS sample_id, c.ID AS call_id, a.ID AS veeva_account_id, trunc(c.LOCAL_CALL_DATETIME_VOD__C, 'DD'::varchar(2)) AS call_date, substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.CALL_TYPE_VOD__C AS call_type, c.ATTENDEE_TYPE_VOD__C AS attendee_type, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (a.ID_VOD__C IS NULL) AND (a.CREDENTIALS_VOD__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS demo_type, CASE WHEN (p.PRODUCT_TYPE_VOD__C = 'BRC'::varchar(3)) THEN 'REQUEST'::varchar(7) ELSE 'DROP'::varchar(4) END AS sample_type, upper(pp.NAME) AS product_name, upper(p.NAME) AS sample_name, p.PRODUCT_ID_TEVA__C AS sample_ndc, s.QUANTITY_VOD__C AS qty, c.ENTITY_DISPLAY_NAME_VOD__C AS name_on_call, c.ADDRESS_LINE_1_VOD__C AS address1_on_call, c.ADDRESS_LINE_2_VOD__C AS address2_on_call, c.CITY_VOD__C AS city_on_call, c.STATE_VOD__C AS state_on_call, c.ZIP_VOD__C AS zip_on_call, a.ID_VOD__C AS ims_id, c.DEA_VOD__C AS dea_num, c.OWNERID AS ownerid, u.EMPLOYEENUMBER AS employeenumber, c.PARENT_CALL_VOD__C AS parent_call_id, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date FROM (((((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_CALL2_SAMPLE_VOD__C s ON ((c.ID = s.CALL2_VOD__C))) JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((s.PRODUCT_VOD__C = p.ID))) LEFT JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C pp ON ((p.PARENT_PRODUCT_VOD__C = pp.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rtc ON ((c.RECORDTYPEID = rtc.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((a.RECORDTYPEID = rta.ID))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) WHERE ((c.LOCAL_CALL_DATETIME_VOD__C >= '2012-01-01 00:00:00'::timestamp(0)) AND (c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)) AND (p.PRODUCT_TYPE_VOD__C = ANY (ARRAY['BRC'::varchar(3), 'Sample'::varchar(6)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_rtm AS
SELECT substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.ID AS call_id, c.ACCOUNT_VOD__C AS veeva_account_id, a.ID_VOD__C AS ims_id, a.EXTERNAL_ID_VOD__C AS siebel_id, trunc(c.CALL_DATETIME_VOD__C, 'DD'::varchar(2)) AS rtm_letter_date, CASE WHEN (p.PRODUCT_ID_TEVA__C ~~ 'AMR%'::varchar(4)) THEN 'AMRIX'::varchar(5) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'FEN%'::varchar(4)) THEN 'FENTORA'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'NUV%'::varchar(4)) THEN 'NUVIGIL'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TIRF%'::varchar(5)) THEN 'FENTORA'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TRE%'::varchar(4)) THEN 'TREANDA'::varchar(7) ELSE 'error'::varchar(5) END AS product_name, CASE WHEN (p.PRODUCT_ID_TEVA__C ~~ 'AMR%'::varchar(4)) THEN 'A00100'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'FEN%'::varchar(4)) THEN '300500'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'NUV%'::varchar(4)) THEN '100N00'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TIRF%'::varchar(5)) THEN '300500'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TRE%'::varchar(4)) THEN 'ONC590'::varchar(6) ELSE 'error'::varchar(5) END AS product_code, p.PRODUCT_ID_TEVA__C AS rtm_letter_code, p.DESCRIPTION_VOD__C AS description, c.ENTITY_DISPLAY_NAME_VOD__C AS prof_full_name, u.EMPLOYEENUMBER AS emp_id, u.NAME AS emp_full_name, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date FROM ((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_CALL2_SAMPLE_VOD__C s ON ((c.ID = s.CALL2_VOD__C))) JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((s.PRODUCT_VOD__C = p.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) WHERE ((p.PRODUCT_TYPE_VOD__C = 'Educational'::varchar(11)) AND (p.SUB_TYPE__C = 'Letters'::varchar(7)) AND (c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_merge_history AS
SELECT vv_acct_merge_history_vod__c.NAME AS old_veeva_account_id, vv_acct_merge_history_vod__c.ACCOUNT_VOD__C AS new_veeva_account_id, vv_acct_merge_history_vod__c.CREATEDDATE AS merge_date FROM WSMP_ADMIN.VV_ACCT_MERGE_HISTORY_VOD__C;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_call_plan AS
SELECT iq.account_tva__c AS veeva_account_id, iq.id_vod__c AS ims_id, substr(iq.territory_tva__c, 1, 2) AS sales_force_id, iq.territory_tva__c AS territory_num, initcap(iq.name) AS prod, sum(CASE WHEN (iq.priority_tva__c = 1::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p1, sum(CASE WHEN (iq.priority_tva__c = 2::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p2, sum(CASE WHEN (iq.priority_tva__c = 3::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p3, iq.lastname AS last_name, iq.firstname AS first_name, iq.start_date_tva__c AS start_date, iq.end_date_tva__c AS end_date FROM (SELECT cg.ACCOUNT_TVA__C AS account_tva__c, a.ID_VOD__C AS id_vod__c, cg.TERRITORY_TVA__C AS territory_tva__c, p.NAME AS name, cg.PRIORITY_TVA__C AS priority_tva__c, cg.GOAL_TVA__C AS goal_tva__c, a.LASTNAME AS lastname, a.FIRSTNAME AS firstname, cg.START_DATE_TVA__C AS start_date_tva__c, cg.END_DATE_TVA__C AS end_date_tva__c FROM ((WSMP_ADMIN.VV_CALL_GOAL_TVA__C cg JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((cg.PRODUCT_CATALOG_TVA__C = p.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((cg.ACCOUNT_TVA__C = a.ID)))) iq GROUP BY iq.account_tva__c, iq.id_vod__c, iq.territory_tva__c, iq.name, iq.lastname, iq.firstname, iq.start_date_tva__c, iq.end_date_tva__c;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_bp_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, acct1.EXTERNAL_ID_VOD__C AS bp_code, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, acct2.ID_VOD__C AS ims_id FROM (((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt ON ((acct1.RECORDTYPEID = rt.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) WHERE (rt.NAME = 'ParaGard_TVA'::varchar(12));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, replace(rt1.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_from_account_type, acct1.OUTLET_ID_TVA__C AS ims_outlet_code, acct1.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, replace(rt2.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_to_account_type, acct2.ID_VOD__C AS ims_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt1 ON ((acct1.RECORDTYPEID = rt1.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt2 ON ((acct2.RECORDTYPEID = rt2.ID))) JOIN (SELECT acctshr.ACCOUNTID AS accountid FROM (WSMP_ADMIN.VV_ACCOUNTSHARE acctshr JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) GROUP BY acctshr.ACCOUNTID) x ON ((acct1.ID = x.accountid))) WHERE (rt1.NAME <> ALL (ARRAY['Professional_vod'::varchar(16), 'Staff'::varchar(5)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_territory_rep_mgr_dir AS
SELECT rep.SALES_FORCE_ID AS sales_force_id, rep.TERRITORY_NUM AS rep_territory_num, rep.TERRITORY_NAME AS rep_territory_name, m.TERRITORY_NUM AS m_territory_num, m.TERRITORY_NAME AS m_territory_name, d.TERRITORY_NUM AS d_territory_num, d.TERRITORY_NAME AS d_territory_name, h.TERRITORY_NUM AS h_territory_num, h.TERRITORY_NAME AS h_territory_name FROM (((WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA rep LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA m ON ((rep.PARENT_TERRITORY_NUM = m.TERRITORY_NUM))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA d ON (((m.PARENT_TERRITORY_NUM = d.TERRITORY_NUM) AND (d.REP_TYPE IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA h ON ((d.PARENT_TERRITORY_NUM = h.TERRITORY_NUM))) WHERE (rep.REP_TYPE = 'REP'::varchar(3));

CREATE  VIEW WSMP_ADMIN_ORA.v_roster_teva_rep_mgr_dir AS
SELECT rep.SALES_FORCE_ID AS sales_force_id, rep.EMPLOYEE_ID AS rep_emp_id, rep.TERRITORY_NUM AS rep_territory_num, rep.FIRST_NAME AS rep_first_name, rep.LAST_NAME AS rep_last_name, rep.FULL_NAME AS rep_full_name, rep.EMAIL AS rep_email, rep.USERNAME AS rep_username, rep.HIRE_DATE AS rep_hire_date, m.EMPLOYEE_ID AS m_emp_id, m.TERRITORY_NUM AS m_territory_num, m.FIRST_NAME AS m_first_name, m.LAST_NAME AS m_last_name, m.FULL_NAME AS m_full_name, m.EMAIL AS m_email, m.USERNAME AS m_username, d.EMPLOYEE_ID AS d_emp_id, d.TERRITORY_NUM AS d_territory_num, d.FIRST_NAME AS d_first_name, d.LAST_NAME AS d_last_name, d.FULL_NAME AS d_full_name, d.EMAIL AS d_email, d.USERNAME AS d_username, h.EMPLOYEE_ID AS h_emp_id, h.TERRITORY_NUM AS h_territory_num, h.FIRST_NAME AS h_first_name, h.LAST_NAME AS h_last_name, h.FULL_NAME AS h_full_name, h.EMAIL AS h_email, h.USERNAME AS h_username FROM (((WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA rep LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA m ON ((rep.PARENT_TERRITORY_NUM = m.TERRITORY_NUM))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA d ON (((m.PARENT_TERRITORY_NUM = d.TERRITORY_NUM) AND (d.REP_TYPE IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA h ON ((d.PARENT_TERRITORY_NUM = h.TERRITORY_NUM))) WHERE (rep.REP_TYPE = 'REP'::varchar(3)) ORDER BY rep.TERRITORY_NUM;

CREATE  VIEW WSMP_ADMIN_ORA.v_onc_related_accounts AS
SELECT ra.ACCT_DEMO_ID AS acct_demo_id, coalesce(ad.OUTLET_NAME, ad.FACILITY_NAME, ad.PRESCRIBER_NAME) AS acct_name, ra.REL_TYPE AS rel_type, ra.REL_ACCT_DEMO_ID AS rel_acct_demo_id, coalesce(rd.OUTLET_NAME, rd.FACILITY_NAME, rd.PRESCRIBER_NAME) AS rel_acct_name FROM ((WSMP_ADMIN.DIM_ONC_RELATED_ACCOUNTS ra JOIN WSMP_ADMIN.DIM_ONC_ACCOUNT_DEMO ad ON ((ad.ACCT_DEMO_ID = ra.ACCT_DEMO_ID))) JOIN WSMP_ADMIN.DIM_ONC_ACCOUNT_DEMO rd ON ((rd.ACCT_DEMO_ID = ra.REL_ACCT_DEMO_ID)));

CREATE  VIEW WSMP_ADMIN_ORA.v_hcos_kaiser_prof_affil AS
SELECT p.IMS_ID AS ims_id, p.NPI AS npi, p.ALL_DEA AS all_dea, p.LAST_NAME AS last_name, p.FIRST_NAME AS first_name, p.MIDDLE_NAME AS middle_name, at.AFFIL_TYPE_DESC AS affil_type_desc, b.IMS_ORG_ID AS ims_facility_number, b.COT_FACILITY_TYPE AS cot_facility_type, b.BUSINESS_NAME AS business_name, b.PHYSICAL_ADDR_1 AS physical_addr_1, b.PHYSICAL_ADDR_2 AS physical_addr_2, b.PHYSICAL_CITY AS physical_city, b.PHYSICAL_STATE AS physical_state, b.PHYSICAL_ZIP AS physical_zip FROM ((((WSMP_ADMIN.HCOS_BUSINESS b JOIN WSMP_ADMIN.HCOS_PROVIDER_AFFILIATION_FACT paf ON ((b.IMS_ORG_ID = paf.IMS_ORG_ID))) JOIN WSMP_ADMIN.HCOS_PROFESSIONAL p ON ((paf.HCE_ID_PRFSNL = p.HCE_ID_PRFSNL))) LEFT JOIN WSMP_ADMIN.HCOS_AFFILIATION_TYPE at ON ((paf.AFFIL_TYPE_ID = at.AFFIL_TYPE_ID))) JOIN WSMP_ADMIN.HCOS_RELATIONSHIP_FACT rf ON ((b.IMS_ORG_ID = rf.IMS_ORG_ID_CHILD))) WHERE ((rf.IMS_ORG_ID_PARENT = 'INS00000226'::varchar(11)) AND (b.PHYSICAL_STATE = 'CA'::varchar(2)));

CREATE  VIEW WSMP_ADMIN_ORA.v_hcos_kaiser_contact_affil AS
SELECT p.IMS_ID AS ims_id, p.NPI AS npi, p.ALL_DEA AS all_dea, p.LAST_NAME AS last_name, p.FIRST_NAME AS first_name, p.MIDDLE_NAME AS middle_name, pt.TITLE_GROUP_DESC AS title_group_desc, b.IMS_ORG_ID AS ims_facility_number, b.BUSINESS_NAME AS business_name, b.PHYSICAL_ADDR_1 AS physical_addr_1, b.PHYSICAL_ADDR_2 AS physical_addr_2, b.PHYSICAL_CITY AS physical_city, b.PHYSICAL_STATE AS physical_state, b.PHYSICAL_ZIP AS physical_zip FROM ((((WSMP_ADMIN.HCOS_BUSINESS b JOIN WSMP_ADMIN.HCOS_CONTACT_AFFILTN_FACT caf ON ((b.IMS_ORG_ID = caf.IMS_ORG_ID))) JOIN WSMP_ADMIN.HCOS_PROFESSIONAL p ON ((caf.HCE_ID_PRFSNL = p.HCE_ID_PRFSNL))) LEFT JOIN WSMP_ADMIN.HCOS_PROFESSIONAL_TITLE pt ON ((caf.TITLE_GROUP_CODE = pt.TITLE_GROUP_CODE))) JOIN WSMP_ADMIN.HCOS_RELATIONSHIP_FACT rf ON ((b.IMS_ORG_ID = rf.IMS_ORG_ID_CHILD))) WHERE ((rf.IMS_ORG_ID_PARENT = 'INS00000226'::varchar(11)) AND (b.PHYSICAL_STATE = 'CA'::varchar(2)));

CREATE  VIEW WSMP_ADMIN_ORA.v_asi_voucher_redemption AS
SELECT 'asi'::varchar(3) AS provider, ar.RD_KEY AS rd_key, ar.PROGRAM_NUM AS program_num, ar.VOUCHER_NUM AS voucher_num, ar.CEPH_ID AS ceph_id, ar.NDC_CODE AS ndc_code, ar.PRODUCT_NAME AS product_name, ar.FILL_DATE AS fill_date, ar.QTY AS qty, ap.PROGRAM_DESC AS program_desc, ap.SALES_FORCE_ID AS sales_force_id, ap.PROGRAM_TYPE AS program_type, ar.COMP_INCLUDE AS comp_include FROM (WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL ar LEFT JOIN WSMP_ADMIN.DIM_ASI_PROGRAM ap ON ((ap.ASI_PROGRAM_NUM = ar.PROGRAM_NUM))) WHERE (ar.REDEMPTION_TYPE = 'VOUCHER'::varchar(7)) ORDER BY ar.CEPH_ID, ar.FILL_DATE, ar.NDC_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_asi_plan_name AS
SELECT tfc_ims_plan_xref.PAYER_PLAN_NUM AS payer_plan_num, tfc_ims_plan_xref.PLAN_NAME AS plan_name, CASE tfc_ims_plan_xref.PAYER_NUM WHEN NULLSEQUAL '000002'::varchar(6) THEN tfc_ims_plan_xref.PLAN_NAME ELSE tfc_ims_plan_xref.PAYER_NAME END AS payer_name, tfc_ims_plan_xref.MODEL AS model FROM WSMP_ADMIN.TFC_IMS_PLAN_XREF ORDER BY tfc_ims_plan_xref.PAYER_PLAN_NUM;

CREATE  VIEW WSMP_ADMIN_ORA.v_asi_pbm_lookup AS
 SELECT EXT_IMS_PBM_XREF.PAYER_PLAN_NUM AS payer_plan_num,
        EXT_IMS_PBM_XREF.PBM_NAME AS pbm_name
 FROM teva_ingestion.ext_ims_pbm_xref
 ORDER BY EXT_IMS_PBM_XREF.PAYER_PLAN_NUM;

CREATE  VIEW WSMP_ADMIN_ORA.v_adasuve_sampling AS
SELECT stg_rems_facility.ENROLLMENT_ID AS enrollment_id, stg_rems_facility.SITE_NAME AS site_name, stg_rems_facility.ADDRESS_1 AS address_1, stg_rems_facility.ADDRESS_2 AS address_2, stg_rems_facility.CITY AS city, stg_rems_facility.STATE AS state, stg_rems_facility.ZIP_CODE AS zip_code FROM WSMP_ADMIN.STG_REMS_FACILITY WHERE ((stg_rems_facility.STATUS_DESCRIPTION = 'Enrolled'::varchar(8)) AND (stg_rems_facility.EXPIRATION_DATE > (statement_timestamp())::timestamp));

CREATE  VIEW WSMP_ADMIN_ORA.i_adasuve_rems_facility AS
SELECT stg_rems_facility.VEEVA_ACCOUNT_ID AS veeva_account_id, stg_rems_facility.NPI AS npi, stg_rems_facility.DEA AS dea, stg_rems_facility.ENROLLMENT_ID AS enrollment_id, stg_rems_facility.PROGRAM_NAME AS program_name, stg_rems_facility.HEALTHCARE_FACILITY_TYPE AS healthcare_facility_type, stg_rems_facility.SITE_NAME AS site_name, stg_rems_facility.ADDRESS_1 AS address_1, stg_rems_facility.ADDRESS_2 AS address_2, stg_rems_facility.CITY AS city, stg_rems_facility.STATE AS state, stg_rems_facility.ZIP_CODE AS zip_code, stg_rems_facility.FIRST_NAME AS first_name, stg_rems_facility.MIDDLE_NAME AS middle_name, stg_rems_facility.LAST_NAME AS last_name, stg_rems_facility.STATUS_DESCRIPTION AS status_description, stg_rems_facility.IN_PROGRESS_STEP AS in_progress_step, stg_rems_facility.PHONE_NUMBER AS phone_number, stg_rems_facility.EFFECTIVE_DATE AS effective_date, stg_rems_facility.EXPIRATION_DATE AS expiration_date, stg_rems_facility.LAST_BUILD_DATE AS last_build_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW CUSTOMER_ORA.dim_product_price_mfg AS
SELECT p.PRODUCT_ID AS product_id, pr.FIRST_VALID_DATE AS first_valid_date, pr.LAST_VALID_DATE AS last_valid_date, p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE ((p.CEPHALON_PRODUCT = 'Y'::char(1)) AND (pr.PRICE_TYPE = 'MFGWAC'::varchar(6)));

CREATE  VIEW CUSTOMER_ORA.dim_product_price_comp AS
SELECT p.PRODUCT_ID AS product_id, pr.FIRST_VALID_DATE AS first_valid_date, pr.LAST_VALID_DATE AS last_valid_date, p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE (pr.PRICE_TYPE = 'COMPWAC'::varchar(7));

CREATE  VIEW CUSTOMER_ORA.dim_product_price AS
SELECT p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE ((p.CEPHALON_PRODUCT = 'Y'::char(1)) AND (pr.PRICE_TYPE = 'COMPWAC'::varchar(7)) AND ((statement_timestamp())::timestamp >= pr.FIRST_VALID_DATE) AND ((statement_timestamp())::timestamp <= pr.LAST_VALID_DATE));

CREATE  VIEW CUSTOMER_ORA.dim_product_ims_ddd AS
SELECT p.PRODUCT_ID AS product_id, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.PRODUCT_CODE AS product_code, vp.VENDOR_PRODUCT_NAME AS ims_product_name, p.CEPHALON_PRODUCT AS cephalon_product, p.THERAPEUTIC_AREA AS therapeutic_area, p.ACTIVE AS active, vp.SUMMARY_PRODUCT_IND AS summary_product_ind, CASE pp.PRODUCT_ID WHEN NULLSEQUAL NULL::numeric(1,0) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS parent_product_id, CASE pp.PRODUCT_CODE WHEN NULLSEQUAL NULL THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS parent_product, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS brand_id, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.NAME ELSE pp.NAME END AS brand_name, m.MARKET_CODE AS market_code, m.NAME AS market_name FROM ((((CUSTOMER.PRODUCT p JOIN CUSTOMER.VENDOR_PRODUCT vp ON ((vp.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = ANY (ARRAY[1::numeric(18,0), 4::numeric(18,0)])) AND (m.ACTIVE = 'Y'::char(1))))) WHERE ((vp.VENDOR_ID = 2::numeric(18,0)) AND (p.ACTIVE = 'Y'::char(1)));

CREATE  VIEW CUSTOMER_ORA.dim_product_brand AS
SELECT p.PRODUCT_CODE AS brand_code, p.PRODUCT_ID AS brand_id, p.NAME AS brand_name, m.MARKET_CODE AS market_code, p.PROMOTED_PRODUCT AS promoted_product, p.THERAPEUTIC_AREA AS therapeutic_area, p.CREATE_DATE AS create_date, p.CREATE_USER AS create_user, p.UPDATE_DATE AS update_date, p.UPDATE_USER AS update_user FROM ((CUSTOMER.PRODUCT p LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = 1::numeric(18,0))))) WHERE ((p.ACTIVE = 'Y'::char(1)) AND (p.PARENT_PRODUCT_IND = 'Y'::char(1)));

CREATE  VIEW CUSTOMER_ORA.dim_product AS
SELECT p.PRODUCT_ID AS product_id, p.PRODUCT_CODE AS product_code, p.NAME AS product_name, m.MARKET_CODE AS market_code, m.NAME AS market_name, p.ACTIVE AS active, p.CEPHALON_PRODUCT AS ceph_prod_flag, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS brand_id, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.NAME ELSE pp.NAME END AS brand_name, p.THERAPEUTIC_AREA AS therapeutic_area, p.CREATE_DATE AS create_date, p.CREATE_USER AS create_user, p.UPDATE_DATE AS update_date, p.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = ANY (ARRAY[1::numeric(18,0), 4::numeric(18,0)])) AND (m.ACTIVE = 'Y'::char(1)))));

CREATE  VIEW WSMP_ADMIN_ORA.i_contact_data AS
SELECT d.ims_id, d.veeva_account_id, CASE WHEN (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END AS nuvigil_dnc_flag, CASE WHEN (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END AS fentora_dnc_flag, CASE WHEN (s.IMS_ID IS NOT NULL) THEN 'Y'::varchar(1) ELSE NULL END AS dnp_flag, r.status AS tirf_rems_flag, r.effective_date AS tirf_rems_effective_date, r.expiration_date AS tirf_rems_expiration_date, seg.PARAGARD_SEGMENT AS paragard_segment FROM ((((((SELECT ims_ids.ims_id, a.ID AS veeva_account_id FROM ((((SELECT tfc_ims_presc_demo_w.ims_id FROM WSMP_ADMIN.tfc_ims_presc_demo_w UNION SELECT dim_dnc.IMS_ID AS ims_id FROM WSMP_ADMIN.DIM_DNC) UNION SELECT debarred.IMS_ID AS ims_id FROM WSMP_ADMIN.DEBARRED WHERE (debarred.CURRENT_IND = 'Y'::varchar(1))) UNION SELECT vv_account.ID_VOD__C AS ims_id FROM WSMP_ADMIN.VV_ACCOUNT WHERE (vv_account.ID_VOD__C IS NOT NULL)) ims_ids LEFT JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((ims_ids.ims_id = a.ID_VOD__C)))) d LEFT JOIN WSMP_ADMIN.DIM_DNC dncn ON (((d.ims_id = dncn.IMS_ID) AND (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7))))) LEFT JOIN WSMP_ADMIN.DIM_DNC dncf ON (((d.ims_id = dncf.IMS_ID) AND (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7))))) LEFT JOIN WSMP_ADMIN.DEBARRED s ON (((d.ims_id = s.IMS_ID) AND (s.CURRENT_IND = 'Y'::varchar(1))))) LEFT JOIN (SELECT r.IMS_ID AS ims_id, CASE WHEN ((r.STATUS = 'Enrolled'::varchar(8)) AND (r.PPAF_COUNT IS NOT NULL)) THEN concat('Enrolled-'::varchar(9), (r.PPAF_COUNT)::varchar) ELSE r.STATUS END AS status, r.EFFECTIVE_DATE AS effective_date, r.EXPIRATION_DATE AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r GROUP BY r.IMS_ID, CASE WHEN ((r.STATUS = 'Enrolled'::varchar(8)) AND (r.PPAF_COUNT IS NOT NULL)) THEN concat('Enrolled-'::varchar(9), (r.PPAF_COUNT)::varchar) ELSE r.STATUS END, r.EFFECTIVE_DATE, r.EXPIRATION_DATE) r ON ((d.ims_id = r.ims_id))) LEFT JOIN WSMP_ADMIN.STG_TW_PARAGARD_SEGMENT seg ON ((d.ims_id = seg.IMS_ID))) GROUP BY d.ims_id, d.veeva_account_id, CASE WHEN (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END, CASE WHEN (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END, CASE WHEN (s.IMS_ID IS NOT NULL) THEN 'Y'::varchar(1) ELSE NULL END, r.status, r.effective_date, r.expiration_date, seg.PARAGARD_SEGMENT;

CREATE  VIEW WSMP_ADMIN_ORA.roster_office_toolkit AS
(((((((((((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS username, dim_csf_sales_roster_teva.SALES_FORCE_ID AS sales_force_id FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (length(dim_csf_sales_roster_teva.TERRITORY_NUM) = 8)) UNION SELECT 'afoote'::varchar(6), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'sbischof'::varchar(8), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'phazel'::varchar(6), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'gfowler'::varchar(7), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mtarrant'::varchar(8), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'jpage'::varchar(5), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mday'::varchar(4), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'kreedy'::varchar(6), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'trainey'::varchar(7), 'TO'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mkartman'::varchar(8), 'TO'::varchar(2) FROM v_catalog.dual) UNION SELECT 'dmack01'::varchar(7), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'rkim'::varchar(4), 'TN'::varchar(2) FROM v_catalog.dual;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_dmd_product AS
SELECT lpad(dim_product_ims_ddd.ims_product_code, 8, '0'::varchar(1)) AS ims_product_code, 'GCSF'::varchar(4) AS market_name, dim_product_ims_ddd.brand_name, dim_product_ims_ddd.ims_product_name AS product_name FROM CUSTOMER.dim_product_ims_ddd WHERE ((dim_product_ims_ddd.brand_name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)])) AND (dim_product_ims_ddd.market_name = 'ONCOLOGY'::varchar(8)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Fentora_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx, CUSTOMER.dim_product p WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0)) AND (rx.PRODUCT_CODE = p.product_code)) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_tr_launch_analytics_rx AS
SELECT rx.ims_id, px.MODEL AS model, mpm.PAYMENT_METHOD AS method_of_payment, rx.payer_plan_num, p.product_name, rx.product_code, to_char(rx.month_ending, ' YYYY-MM-DD'::varchar(11)) AS month_ending, rx.month_bucket, to_char(rx.week_ending, ' YYYY-MM-DD'::varchar(11)) AS week_ending, rx.week_bucket, rx.nrx_cnt, rx.trx_cnt, rx.sales_category FROM (((WSMP_ADMIN.dw_presc_plan_rx_w rx JOIN CUSTOMER.dim_product p ON ((rx.product_code = p.product_code))) LEFT JOIN WSMP_ADMIN.TFC_IMS_PLAN_XREF px ON ((rx.payer_plan_num = px.PAYER_PLAN_NUM))) LEFT JOIN WSMP_ADMIN.DIM_IMS_MODEL_PAYMENT_METHOD mpm ON ((px.MODEL = mpm.MODEL))) WHERE ((rx.product_code ~~ '330-14%'::varchar(7)) AND (rx.product_code NOT IN (SELECT drm45_rollup.ROLLUP_WK_PRODUCT_CODE AS rollup_wk_product_code FROM WSMP_ADMIN.DRM45_ROLLUP GROUP BY drm45_rollup.ROLLUP_WK_PRODUCT_CODE)) AND (rx.week_bucket >= 1::numeric(18,0)) AND (rx.week_bucket <= 52::numeric(18,0)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Monthly_Rx AS
SELECT x.IMS_ID AS ims_id, x.PRODUCT_CODE AS product_code, p.product_name, x.MONTH_ENDING AS month_ending, sum(x.NRX_QTY) AS nrx_qty, sum(x.TRX_QTY) AS trx_qty, sum(x.UNNORMALIZED_NRX_CNT) AS nrx_cnt, sum(x.UNNORMALIZED_TRX_CNT) AS trx_cnt FROM WSMP_ADMIN.DW_PRESC_RX_M x, CUSTOMER.dim_product p WHERE ((x.MONTH_BUCKET >= 1::numeric(18,0)) AND (x.MONTH_BUCKET <= 24::numeric(18,0)) AND (x.PRODUCT_CODE = ANY (ARRAY['100N05'::varchar(6), '100N15'::varchar(6), '100N25'::varchar(6), '100101'::varchar(6), '100102'::varchar(6), '100120'::varchar(6)])) AND (x.PRODUCT_CODE = p.product_code)) GROUP BY x.IMS_ID, x.PRODUCT_CODE, p.product_name, x.MONTH_ENDING ORDER BY x.IMS_ID, x.PRODUCT_CODE, p.product_name, x.MONTH_ENDING;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_gcsf_dmd AS
SELECT coalesce(z.TO_TERRITORY_NUM_1, 'TOHZHZ99'::varchar(8)) AS TERRITORY_NUM, s.IMS_OUTLET_CODE, s.SUBCATEGORY_CODE, s.CATEGORY_CODE, s.IMS_PRODUCT_CODE, p.product_code AS PRODUCT_CODE, to_char(s.DATA_DATE, 'YYYYMM'::varchar(6)) AS MTH_YYYYMM, s.DOL_MTH01, s.DOL_MTH02, s.DOL_MTH03, s.DOL_MTH04, s.DOL_MTH05, s.DOL_MTH06, s.DOL_MTH07, s.DOL_MTH08, s.DOL_MTH09, s.DOL_MTH10, s.DOL_MTH11, s.DOL_MTH12, s.DOL_MTH13, s.DOL_MTH14, s.DOL_MTH15, s.DOL_MTH16, s.DOL_MTH17, s.DOL_MTH18, s.DOL_MTH19, s.DOL_MTH20, s.DOL_MTH21, s.DOL_MTH22, s.DOL_MTH23, s.DOL_MTH24, s.OUTLET_NAME, s.OUTLET_ADDRESS, s.OUTLET_CITY, s.OUTLET_STATE, s.OUTLET_ZIP FROM ((WSMP_ADMIN.STG_ONC_DMD_MONTHLY_DOLLARS s JOIN CUSTOMER.dim_product_ims_ddd p ON ((s.IMS_PRODUCT_CODE = p.ims_product_code))) LEFT JOIN WSMP_ADMIN.TFC_CURRENT_ZIP_ALIGNMENT z ON ((s.OUTLET_ZIP = z.ZIP))) WHERE (p.brand_name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_demo AS
SELECT c.ROW_ID AS csf_demo_id, p.X_SALES_FORCE AS sales_force_id, 'PROF'::varchar(4) AS demo_type, x.ATTRIB_03 AS ims_id, x.X_ATTRIB_50 AS hms_id, substr(btrim(x.ATTRIB_36), 1, 10) AS me_num, ca.DEA_NUM AS dea_num, ca.DEA_EXPR_DT AS dea_expir_date, substr(ca.X_ATTRIB_03, 1, 12) AS dea_drug_schedule, p.NAME AS territory_num, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, c.LAST_NAME AS last_name, c.FST_NAME AS first_name, c.MID_NAME AS middle_name, c.PER_TITLE_SUFFIX AS suffix_name, fnx.CRRPT_FMT_CD AS degree, substr(btrim(ap.ADDR), 1, 75) AS address1, substr(btrim(ap.ADDR_LINE_2), 1, 75) AS address2, substr(btrim(ap.ADDR_LINE_3), 1, 75) AS address3, ap.CITY AS city, ap.STATE AS state, ap.ZIPCODE AS zip, c.WORK_PH_NUM AS phone, c.FAX_PH_NUM AS fax, c.CELL_PH_NUM AS mobile, c.EMAIL_ADDR AS email, ms.NAME AS prim_specialty, substr(btrim(l.LICENSE_NUM), 1, 20) AS state_license_number, l.STATE_CD AS state_license_state, CASE WHEN (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1)) THEN 'E'::varchar(1) ELSE 'I'::varchar(1) END AS state_license_elig_code, l.LICENSE_EXP_DT AS state_license_expir_date, substr(btrim(CASE WHEN ((btrim(fnx.CRRPT_FMT_CD) IS NOT NULL) AND (btrim(l.STATE_CD) IS NOT NULL) AND (btrim(l.LICENSE_NUM) IS NOT NULL)) THEN ((((btrim(fnx.CRRPT_FMT_CD) || '-'::varchar(1)) || btrim(l.STATE_CD)) || '-'::varchar(1)) || btrim(l.LICENSE_NUM)) ELSE NULL END), 1, 30) AS state_num, l.X_VALIDATION_DT AS sln_validation_date, CASE WHEN ((l.X_VALIDATION_DT IS NOT NULL) AND (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1))) THEN 'MedPro'::varchar(6) ELSE NULL END AS sln_validation_source, x.ATTRIB_09 AS no_spend, pc.X_ATTRIB_11 AS treats_es, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_58 ELSE NULL END AS nuvigil_dnc, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_83 ELSE NULL::"char" END AS nuvigil_rems_pb, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN substr(x.X_ATTRIB_73, 1, 1) ELSE NULL END AS nuvigil_app, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_72 ELSE NULL END AS fentora_dnc, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_71 ELSE NULL::"char" END AS fentora_app, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.ATTRIB_42 ELSE NULL END AS fentora_rems_status, pc.LAST_CALL_DT AS sfa_last_call_date, coalesce(cm2.CM_ID, cm1.CM_ID) AS cm_id, c.ROW_ID AS siebel_contact_row_id, ap.ROW_ID AS siebel_addr_per_row_id, 'Y'::varchar(1) AS ora_viewable_flag, c.CREATED AS sfa_create_date, (statement_timestamp())::timestamp AS last_build_date, NULL AS ceph_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, pc.STATUS AS territory_status FROM (((((((((((WSMP_ADMIN.S_CONTACT c JOIN WSMP_ADMIN.S_POSTN_CON pc ON ((pc.CON_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN p ON ((pc.POSTN_ID = p.ROW_ID))) JOIN WSMP_ADMIN.S_ORG_EXT o ON ((p.BU_ID = o.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X x ON ((x.ROW_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_FNX fnx ON ((fnx.ROW_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ADDR_PER ap ON ((ap.ROW_ID = pc.PR_ADDR_ID))) LEFT JOIN WSMP_ADMIN.S_MED_SPEC ms ON ((ms.ROW_ID = c.MED_SPEC_ID))) LEFT JOIN (SELECT iq.ROW_ID, iq.CREATED, iq.CREATED_BY, iq.LAST_UPD, iq.LAST_UPD_BY, iq.MODIFICATION_NUM, iq.CONFLICT_ID, iq.ACTIVE_FLG, iq.ADDR_PER_ID, iq.BL_ADDR_FLG, iq.FRAUD_FLG, iq.MAIN_ADDR_FLG, iq.RELATION_TYPE_CD, iq.SHIP_ADDR_FLG, iq.DEA_EXPR_DT, iq.END_DT, iq.FRI_1ST_CLOSE_TM, iq.FRI_1ST_OPEN_TM, iq.FRI_2ND_CLOSE_TM, iq.FRI_2ND_OPEN_TM, iq.MON_1ST_CLOSE_TM, iq.MON_1ST_OPEN_TM, iq.MON_2ND_CLOSE_TM, iq.MON_2ND_OPEN_TM, iq.NUM_MONTHS_AT_ADDR, iq.SAT_1ST_CLOSE_TM, iq.SAT_1ST_OPEN_TM, iq.SAT_2ND_CLOSE_TM, iq.SAT_2ND_OPEN_TM, iq.START_DT, iq.SUN_1ST_CLOSE_TM, iq.SUN_1ST_OPEN_TM, iq.SUN_2ND_CLOSE_TM, iq.SUN_2ND_OPEN_TM, iq.THU_1ST_CLOSE_TM, iq.THU_1ST_OPEN_TM, iq.THU_2ND_CLOSE_TM, iq.THU_2ND_OPEN_TM, iq.TUE_1ST_CLOSE_TM, iq.TUE_1ST_OPEN_TM, iq.TUE_2ND_CLOSE_TM, iq.TUE_2ND_OPEN_TM, iq.WED_1ST_CLOSE_TM, iq.WED_1ST_OPEN_TM, iq.WED_2ND_CLOSE_TM, iq.WED_2ND_OPEN_TM, iq.ACCNT_ID, iq.ADDR_MAIL_CD, iq.ADDR_TYPE_CD, iq.BRICK_ID, iq.BU_ID, iq.CONTACT_ID, iq.DEA_NUM, iq.DFLT_SHIP_PRIO_CD, iq.EMAIL_ADDR, iq.FAX_PH_NUM, iq.MAIL_TYPE_CD, iq.OCCUPANCY_CD, iq.ORG_GROUP_ID, iq.PH_NUM, iq.TRNSPRT_ZONE_CD, iq.X_ATTRIB_01, iq.X_ATTRIB_02, iq.X_ATTRIB_03, iq.X_ATTRIB_04, iq.X_ATTRIB_05, iq.X_ATTRIB_06, iq.X_ATTRIB_07, iq.X_OK_TO_SAMPLE, iq.ADDRESSEE, iq.ALIGNMENT_FLG, iq.DB_LAST_UPD, iq.DB_LAST_UPD_SRC, iq.YEARLY_END_DT, iq.YEARLY_START_DT, iq.X_SRC_LAST_UPD, iq.rnk FROM (SELECT sca.ROW_ID, sca.CREATED, sca.CREATED_BY, sca.LAST_UPD, sca.LAST_UPD_BY, sca.MODIFICATION_NUM, sca.CONFLICT_ID, sca.ACTIVE_FLG, sca.ADDR_PER_ID, sca.BL_ADDR_FLG, sca.FRAUD_FLG, sca.MAIN_ADDR_FLG, sca.RELATION_TYPE_CD, sca.SHIP_ADDR_FLG, sca.DEA_EXPR_DT, sca.END_DT, sca.FRI_1ST_CLOSE_TM, sca.FRI_1ST_OPEN_TM, sca.FRI_2ND_CLOSE_TM, sca.FRI_2ND_OPEN_TM, sca.MON_1ST_CLOSE_TM, sca.MON_1ST_OPEN_TM, sca.MON_2ND_CLOSE_TM, sca.MON_2ND_OPEN_TM, sca.NUM_MONTHS_AT_ADDR, sca.SAT_1ST_CLOSE_TM, sca.SAT_1ST_OPEN_TM, sca.SAT_2ND_CLOSE_TM, sca.SAT_2ND_OPEN_TM, sca.START_DT, sca.SUN_1ST_CLOSE_TM, sca.SUN_1ST_OPEN_TM, sca.SUN_2ND_CLOSE_TM, sca.SUN_2ND_OPEN_TM, sca.THU_1ST_CLOSE_TM, sca.THU_1ST_OPEN_TM, sca.THU_2ND_CLOSE_TM, sca.THU_2ND_OPEN_TM, sca.TUE_1ST_CLOSE_TM, sca.TUE_1ST_OPEN_TM, sca.TUE_2ND_CLOSE_TM, sca.TUE_2ND_OPEN_TM, sca.WED_1ST_CLOSE_TM, sca.WED_1ST_OPEN_TM, sca.WED_2ND_CLOSE_TM, sca.WED_2ND_OPEN_TM, sca.ACCNT_ID, sca.ADDR_MAIL_CD, sca.ADDR_TYPE_CD, sca.BRICK_ID, sca.BU_ID, sca.CONTACT_ID, sca.DEA_NUM, sca.DFLT_SHIP_PRIO_CD, sca.EMAIL_ADDR, sca.FAX_PH_NUM, sca.MAIL_TYPE_CD, sca.OCCUPANCY_CD, sca.ORG_GROUP_ID, sca.PH_NUM, sca.TRNSPRT_ZONE_CD, sca.X_ATTRIB_01, sca.X_ATTRIB_02, sca.X_ATTRIB_03, sca.X_ATTRIB_04, sca.X_ATTRIB_05, sca.X_ATTRIB_06, sca.X_ATTRIB_07, sca.X_OK_TO_SAMPLE, sca.ADDRESSEE, sca.ALIGNMENT_FLG, sca.DB_LAST_UPD, sca.DB_LAST_UPD_SRC, sca.YEARLY_END_DT, sca.YEARLY_START_DT, sca.X_SRC_LAST_UPD, row_number() OVER (PARTITION BY sca.CONTACT_ID, sca.ADDR_PER_ID ORDER BY sca.LAST_UPD DESC, sca.CREATED DESC) AS rnk FROM WSMP_ADMIN.S_CON_ADDR sca) iq WHERE (iq.rnk = 1)) ca ON (((ca.ADDR_PER_ID = pc.PR_ADDR_ID) AND (ca.CONTACT_ID = pc.CON_ID)))) LEFT JOIN WSMP_ADMIN.S_STATE_LIC_LS l ON (((l.ROW_ID = ca.X_ATTRIB_02) AND (l.CONTACT_ID = ca.CONTACT_ID) AND (l.STATUS_CD <> 'Invalid'::varchar(7))))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF cm1 ON (((c.ROW_ID = cm1.ID_NUM) AND (cm1.ID_TYPE = 'SIEBEL_ID'::varchar(9))))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF cm2 ON (((x.ATTRIB_03 = cm2.ID_NUM) AND (cm2.ID_TYPE = 'IMS_ID'::varchar(6))))) WHERE ((p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)])) AND (p.NAME !~~ '%SiebelAdministrator%'::varchar(21)) AND (p.NAME <> 'Align_2007'::varchar(10)) AND (NOT ((x.ATTRIB_03 IS NULL) AND (c.DEGREE = ANY (ARRAY['Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)])))));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_PER_ID AS csf_demo_id, 'PROF'::varchar(4) AS legacy_call_type, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.INTEGRATION_ID AS integration_id, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_PER_ID AS siebel_target_per_id, d.ims_id, d.cm_id, d.me_num, ca.DEA_NUM AS dea_num, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.first_detailed_product, details.second_detailed_product, details.third_detailed_product, details.fourth_detailed_product, details.fifth_detailed_product, details.sixth_detailed_product, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM (((((((WSMP_ADMIN.S_EVT_ACT ea JOIN WSMP_ADMIN.S_CONTACT c ON ((c.ROW_ID = ea.TARGET_PER_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X x ON ((x.ROW_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT v_siebel_demo.ims_id, v_siebel_demo.cm_id, v_siebel_demo.me_num, v_siebel_demo.siebel_contact_row_id, row_number() OVER (PARTITION BY v_siebel_demo.siebel_contact_row_id ORDER BY v_siebel_demo.veeva_account_id, v_siebel_demo.sales_force_id) AS rnk FROM WSMP_ADMIN.v_siebel_demo) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) LEFT JOIN (SELECT iq2.ROW_ID, iq2.CREATED, iq2.CREATED_BY, iq2.LAST_UPD, iq2.LAST_UPD_BY, iq2.MODIFICATION_NUM, iq2.CONFLICT_ID, iq2.ACTIVE_FLG, iq2.ADDR_PER_ID, iq2.BL_ADDR_FLG, iq2.FRAUD_FLG, iq2.MAIN_ADDR_FLG, iq2.RELATION_TYPE_CD, iq2.SHIP_ADDR_FLG, iq2.DEA_EXPR_DT, iq2.END_DT, iq2.FRI_1ST_CLOSE_TM, iq2.FRI_1ST_OPEN_TM, iq2.FRI_2ND_CLOSE_TM, iq2.FRI_2ND_OPEN_TM, iq2.MON_1ST_CLOSE_TM, iq2.MON_1ST_OPEN_TM, iq2.MON_2ND_CLOSE_TM, iq2.MON_2ND_OPEN_TM, iq2.NUM_MONTHS_AT_ADDR, iq2.SAT_1ST_CLOSE_TM, iq2.SAT_1ST_OPEN_TM, iq2.SAT_2ND_CLOSE_TM, iq2.SAT_2ND_OPEN_TM, iq2.START_DT, iq2.SUN_1ST_CLOSE_TM, iq2.SUN_1ST_OPEN_TM, iq2.SUN_2ND_CLOSE_TM, iq2.SUN_2ND_OPEN_TM, iq2.THU_1ST_CLOSE_TM, iq2.THU_1ST_OPEN_TM, iq2.THU_2ND_CLOSE_TM, iq2.THU_2ND_OPEN_TM, iq2.TUE_1ST_CLOSE_TM, iq2.TUE_1ST_OPEN_TM, iq2.TUE_2ND_CLOSE_TM, iq2.TUE_2ND_OPEN_TM, iq2.WED_1ST_CLOSE_TM, iq2.WED_1ST_OPEN_TM, iq2.WED_2ND_CLOSE_TM, iq2.WED_2ND_OPEN_TM, iq2.ACCNT_ID, iq2.ADDR_MAIL_CD, iq2.ADDR_TYPE_CD, iq2.BRICK_ID, iq2.BU_ID, iq2.CONTACT_ID, iq2.DEA_NUM, iq2.DFLT_SHIP_PRIO_CD, iq2.EMAIL_ADDR, iq2.FAX_PH_NUM, iq2.MAIL_TYPE_CD, iq2.OCCUPANCY_CD, iq2.ORG_GROUP_ID, iq2.PH_NUM, iq2.TRNSPRT_ZONE_CD, iq2.X_ATTRIB_01, iq2.X_ATTRIB_02, iq2.X_ATTRIB_03, iq2.X_ATTRIB_04, iq2.X_ATTRIB_05, iq2.X_ATTRIB_06, iq2.X_ATTRIB_07, iq2.X_OK_TO_SAMPLE, iq2.ADDRESSEE, iq2.ALIGNMENT_FLG, iq2.DB_LAST_UPD, iq2.DB_LAST_UPD_SRC, iq2.YEARLY_END_DT, iq2.YEARLY_START_DT, iq2.X_SRC_LAST_UPD, iq2.rnk FROM (SELECT ca.ROW_ID, ca.CREATED, ca.CREATED_BY, ca.LAST_UPD, ca.LAST_UPD_BY, ca.MODIFICATION_NUM, ca.CONFLICT_ID, ca.ACTIVE_FLG, ca.ADDR_PER_ID, ca.BL_ADDR_FLG, ca.FRAUD_FLG, ca.MAIN_ADDR_FLG, ca.RELATION_TYPE_CD, ca.SHIP_ADDR_FLG, ca.DEA_EXPR_DT, ca.END_DT, ca.FRI_1ST_CLOSE_TM, ca.FRI_1ST_OPEN_TM, ca.FRI_2ND_CLOSE_TM, ca.FRI_2ND_OPEN_TM, ca.MON_1ST_CLOSE_TM, ca.MON_1ST_OPEN_TM, ca.MON_2ND_CLOSE_TM, ca.MON_2ND_OPEN_TM, ca.NUM_MONTHS_AT_ADDR, ca.SAT_1ST_CLOSE_TM, ca.SAT_1ST_OPEN_TM, ca.SAT_2ND_CLOSE_TM, ca.SAT_2ND_OPEN_TM, ca.START_DT, ca.SUN_1ST_CLOSE_TM, ca.SUN_1ST_OPEN_TM, ca.SUN_2ND_CLOSE_TM, ca.SUN_2ND_OPEN_TM, ca.THU_1ST_CLOSE_TM, ca.THU_1ST_OPEN_TM, ca.THU_2ND_CLOSE_TM, ca.THU_2ND_OPEN_TM, ca.TUE_1ST_CLOSE_TM, ca.TUE_1ST_OPEN_TM, ca.TUE_2ND_CLOSE_TM, ca.TUE_2ND_OPEN_TM, ca.WED_1ST_CLOSE_TM, ca.WED_1ST_OPEN_TM, ca.WED_2ND_CLOSE_TM, ca.WED_2ND_OPEN_TM, ca.ACCNT_ID, ca.ADDR_MAIL_CD, ca.ADDR_TYPE_CD, ca.BRICK_ID, ca.BU_ID, ca.CONTACT_ID, ca.DEA_NUM, ca.DFLT_SHIP_PRIO_CD, ca.EMAIL_ADDR, ca.FAX_PH_NUM, ca.MAIL_TYPE_CD, ca.OCCUPANCY_CD, ca.ORG_GROUP_ID, ca.PH_NUM, ca.TRNSPRT_ZONE_CD, ca.X_ATTRIB_01, ca.X_ATTRIB_02, ca.X_ATTRIB_03, ca.X_ATTRIB_04, ca.X_ATTRIB_05, ca.X_ATTRIB_06, ca.X_ATTRIB_07, ca.X_OK_TO_SAMPLE, ca.ADDRESSEE, ca.ALIGNMENT_FLG, ca.DB_LAST_UPD, ca.DB_LAST_UPD_SRC, ca.YEARLY_END_DT, ca.YEARLY_START_DT, ca.X_SRC_LAST_UPD, row_number() OVER (PARTITION BY ca.CONTACT_ID, ca.ADDR_PER_ID ORDER BY ca.LAST_UPD DESC, ca.CREATED DESC) AS rnk FROM WSMP_ADMIN.S_CON_ADDR ca) iq2 WHERE (iq2.rnk = 1)) ca ON (((ca.ADDR_PER_ID = ea.TARGET_PER_ADDR_ID) AND (ca.CONTACT_ID = ea.TARGET_PER_ID)))) LEFT JOIN (SELECT d.activity_id, max(CASE WHEN (d.priority = 1) THEN d.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (d.priority = 2) THEN d.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (d.priority = 3) THEN d.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (d.priority = 4) THEN d.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (d.priority = 5) THEN d.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (d.priority = 6) THEN d.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority FROM (WSMP_ADMIN.S_ACT_PROD_APPL appl LEFT JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE (appl.CONFLICT_ID = '0'::varchar(1))) d GROUP BY d.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID))) WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (((ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TN'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)]))) OR ((ea.APPT_START_DT >= '2012-03-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TC'::varchar(2), 'TP'::varchar(2)])))) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = ANY (ARRAY['Contact Call'::varchar(12), 'Attendee Call'::varchar(13)])) AND ((ea.TODO_CD ~~ '%Detail%'::varchar(8)) OR (ea.TODO_CD ~~ '%Call%'::varchar(6))));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_bp_affiliations AS
SELECT oex.ROW_ID AS siebel_account_row_id, oex.X_ATTRIB_109 AS bp_code, c.ROW_ID AS siebel_contact_row_id, cx.ATTRIB_03 AS ims_id FROM (((WSMP_ADMIN.S_ORG_EXT_X oex JOIN WSMP_ADMIN.S_PARTY_PER pp ON ((oex.ROW_ID = pp.PARTY_ID))) JOIN WSMP_ADMIN.S_CONTACT c ON ((pp.PERSON_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X cx ON ((cx.ROW_ID = c.ROW_ID))) WHERE (oex.X_ATTRIB_109 IS NOT NULL);

CREATE  VIEW WSMP_ADMIN_ORA.v_ims_dea AS
 SELECT x1.ID_NUM AS ims_id,
        x2.ID_NUM AS dea_num,
        x2.STATE AS state,
        x2.EXPIRATION_DATE AS expiration_date
 FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID)))
 WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'DEA_NUM'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ims_npi AS
SELECT x1.ID_NUM AS ims_id, x2.ID_NUM AS npi FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID))) WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'NPI'::varchar(3))) UNION SELECT hcos_professional.IMS_ID AS ims_id, hcos_professional.NPI AS npi FROM WSMP_ADMIN.HCOS_PROFESSIONAL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_mm_ram_to_rsm_test AS
SELECT x.MM_RAM, x.RSM FROM (SELECT a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2)) AS RSM FROM (teva_ingestion.EXT_MM_RAM_TO_STATE a JOIN WSMP_ADMIN.KC_ZIP_TO_TERRITORY b ON ((a.STATE = b.STATE))) WHERE ((substr(b.TERRITORY_NUM, 5, 2) <> 'ZZ'::varchar(2)) AND (b.TERRITORY_NAME IS NOT NULL)) GROUP BY a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2))) x ORDER BY x.MM_RAM, x.RSM LIMIT 1000000;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_calls AS
SELECT c.ID AS call_id, trunc((c.LOCAL_CALL_DATETIME_VOD__C)::timestamp, 'DD'::varchar(2)) AS call_date, h.submit_date, c.LOCAL_CALL_DATETIME_VOD__C AS call_datetime, a.ID AS csf_demo_id, substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.CALL_TYPE_VOD__C AS call_type_vod__c, c.ACCOUNT_VOD__C AS demo_id, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (a.ID_VOD__C IS NULL) AND (a.CREDENTIALS_VOD__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS legacy_call_type, substr(c.ENTITY_DISPLAY_NAME_VOD__C, 1, 150) AS name_on_call, c.ZIP_VOD__C AS zip_on_call, a.ID_VOD__C AS ims_id, a.ACCOUNT_MASTER_ID_TVA__C AS hms_id, a.NPI_VOD__C AS npi, a.CREDENTIALS_VOD__C AS degree, a.ID AS veeva_account_id, substr(btrim(a.ME__C), 1, 10) AS me_num, c.DEA_VOD__C AS dea_num, CASE WHEN (NOT regexp_like(a.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar)) THEN a.EXTERNAL_ID_VOD__C ELSE NULL END AS siebel_target_per_id, CASE WHEN regexp_like(a.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar) THEN a.EXTERNAL_ID_VOD__C ELSE NULL END AS bp_code, c.OWNERID AS ownerid, u.EMPLOYEENUMBER AS employeenumber, c.PARENT_CALL_VOD__C AS parent_call_vod__c, CASE WHEN (rtc.NAME = 'Account Management'::varchar(18)) THEN upper(rtc.NAME) ELSE d.first_detailed_product END AS first_detailed_product, d.second_detailed_product, d.third_detailed_product, d.fourth_detailed_product, d.fifth_detailed_product, d.sixth_detailed_product, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date, coalesce(c.ATTENDEES_VOD__C, 0::numeric(18,0)) AS attendees, CASE WHEN (c.ATTENDEE_TYPE_VOD__C = 'Group_Account_vod'::varchar(17)) THEN 'Group'::varchar(5) WHEN (c.ATTENDEE_TYPE_VOD__C = 'Person_Account_vod'::varchar(18)) THEN 'Person'::varchar(6) ELSE c.ATTENDEE_TYPE_VOD__C END AS attendee_type FROM ((((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rtc ON ((c.RECORDTYPEID = rtc.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((a.RECORDTYPEID = rta.ID))) LEFT JOIN (SELECT VV_CALL2_VOD__HISTORY.PARENTID AS parentid, trunc(max(VV_CALL2_VOD__HISTORY.CREATEDDATE), 'DD'::varchar(2)) AS submit_date FROM WSMP_ADMIN.VV_CALL2_VOD__HISTORY WHERE (VV_CALL2_VOD__HISTORY.NEWVALUE = 'Submitted_vod'::varchar(13)) GROUP BY VV_CALL2_VOD__HISTORY.PARENTID) h ON ((c.ID = h.parentid))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) LEFT JOIN (SELECT d.call2_vod__c, max(CASE WHEN (d.priority = 1) THEN d.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (d.priority = 2) THEN d.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (d.priority = 3) THEN d.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (d.priority = 4) THEN d.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (d.priority = 5) THEN d.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (d.priority = 6) THEN d.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT d.CALL2_VOD__C AS call2_vod__c, row_number() OVER (PARTITION BY d.CALL2_VOD__C ORDER BY d.DETAIL_PRIORITY_VOD__C, p.NAME) AS priority, upper(p.NAME) AS product_name FROM (WSMP_ADMIN.VV_CALL2_DETAIL_VOD__C d JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((d.PRODUCT_VOD__C = p.ID)))) d GROUP BY d.call2_vod__c) d ON ((d.call2_vod__c = c.ID))) WHERE ((c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)) AND (c.CALL_DATE_VOD__C < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) AND (c.CALL_TYPE_VOD__C <> 'Sample Only'::varchar(11)));

CREATE  VIEW WSMP_ADMIN_ORA.stg_ims_dea AS
 SELECT x1.ID_NUM AS ims_id,
        x2.ID_NUM AS dea_num,
        x2.STATE AS dea_state,
        x2.EXPIRATION_DATE AS dea_expir_date
 FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID)))
 WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'DEA_NUM'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_mkt_access_obw_wake AS
SELECT mpzd.ZIP AS zip, mpzd.STATE AS state, rx.plan_id AS payer_plan_num, to_char(rx.ims_report_num, '00'::varchar(2)) AS report_num, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) AS data_month, sum((((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_001, sum((((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_002, sum((((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_003, sum((((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_004, sum((((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_005, sum((((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_006, sum((((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_007, sum((((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_008, sum((((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_009, sum((((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_010, sum((((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_011, sum((((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_012, sum((((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_013, sum((((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_014, sum((((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_015, sum((((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_016, sum((((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_017, sum((((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_018, sum((((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_019, sum((((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_020, sum((((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_021, sum((((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_022, sum((((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_023, sum((((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_024, sum((((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_001, sum((((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_002, sum((((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_003, sum((((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_004, sum((((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_005, sum((((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_006, sum((((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_007, sum((((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_008, sum((((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_009, sum((((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_010, sum((((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_011, sum((((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_012, sum((((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_013, sum((((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_014, sum((((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_015, sum((((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_016, sum((((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_017, sum((((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_018, sum((((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_019, sum((((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_020, sum((((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_021, sum((((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_022, sum((((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_023, sum((((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_024 FROM (((ims.stg_ims_mhj_qty_m rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) JOIN WSMP_ADMIN.MARKET_PRESC_ZIP_DIVISOR mpzd ON (((p.MARKET_NAME = mpzd.MARKET_NAME) AND (rx.ims_id = mpzd.IMS_ID)))) WHERE (p.MARKET_NAME = 'WAKE'::varchar(4)) GROUP BY mpzd.ZIP, mpzd.STATE, rx.plan_id, to_char(rx.ims_report_num, '00'::varchar(2)), to_char(rx.ims_product_group_num, '000000000'::varchar(9)), ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) UNION ALL SELECT mpzd.ZIP AS zip, mpzd.STATE AS state, rx.plan_id AS payer_plan_num, to_char(rx.ims_report_num, '00'::varchar(2)) AS report_num, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) AS data_month, sum(rx.nrx_001) AS nrx_001, sum(rx.nrx_002) AS nrx_002, sum(rx.nrx_003) AS nrx_003, sum(rx.nrx_004) AS nrx_004, sum(rx.nrx_005) AS nrx_005, sum(rx.nrx_006) AS nrx_006, sum(rx.nrx_007) AS nrx_007, sum(rx.nrx_008) AS nrx_008, sum(rx.nrx_009) AS nrx_009, sum(rx.nrx_010) AS nrx_010, sum(rx.nrx_011) AS nrx_011, sum(rx.nrx_012) AS nrx_012, sum(rx.nrx_013) AS nrx_013, sum(rx.nrx_014) AS nrx_014, sum(rx.nrx_015) AS nrx_015, sum(rx.nrx_016) AS nrx_016, sum(rx.nrx_017) AS nrx_017, sum(rx.nrx_018) AS nrx_018, sum(rx.nrx_019) AS nrx_019, sum(rx.nrx_020) AS nrx_020, sum(rx.nrx_021) AS nrx_021, sum(rx.nrx_022) AS nrx_022, sum(rx.nrx_023) AS nrx_023, sum(rx.nrx_024) AS nrx_024, sum(rx.trx_001) AS trx_001, sum(rx.trx_002) AS trx_002, sum(rx.trx_003) AS trx_003, sum(rx.trx_004) AS trx_004, sum(rx.trx_005) AS trx_005, sum(rx.trx_006) AS trx_006, sum(rx.trx_007) AS trx_007, sum(rx.trx_008) AS trx_008, sum(rx.trx_009) AS trx_009, sum(rx.trx_010) AS trx_010, sum(rx.trx_011) AS trx_011, sum(rx.trx_012) AS trx_012, sum(rx.trx_013) AS trx_013, sum(rx.trx_014) AS trx_014, sum(rx.trx_015) AS trx_015, sum(rx.trx_016) AS trx_016, sum(rx.trx_017) AS trx_017, sum(rx.trx_018) AS trx_018, sum(rx.trx_019) AS trx_019, sum(rx.trx_020) AS trx_020, sum(rx.trx_021) AS trx_021, sum(rx.trx_022) AS trx_022, sum(rx.trx_023) AS trx_023, sum(rx.trx_024) AS trx_024 FROM (((ims.stg_ims_mhj_cnt_m rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) JOIN WSMP_ADMIN.MARKET_PRESC_ZIP_DIVISOR mpzd ON (((p.MARKET_NAME = mpzd.MARKET_NAME) AND (rx.ims_id = mpzd.IMS_ID)))) WHERE ((p.MARKET_NAME = 'WAKE'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL)) GROUP BY mpzd.ZIP, mpzd.STATE, rx.plan_id, to_char(rx.ims_report_num, '00'::varchar(2)), to_char(rx.ims_product_group_num, '000000000'::varchar(9)), ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Paytype AS
SELECT rx.model, rx.payment_method FROM WSMP_ADMIN.dw_presc_plan_rx_w rx WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-0025'::varchar(11), '330-16-050'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-16-055'::varchar(10), '330-14-004'::varchar(10), '330-16-056'::varchar(10), '330-14-006'::varchar(10), '330-15-050'::varchar(10), '330-14-005'::varchar(10), '330-15-005'::varchar(10), '330-12-002'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10), '330-13-020'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-16-027'::varchar(10), '330-16-028'::varchar(10), '330-16-029'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-001'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.model, rx.payment_method;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_planname AS
SELECT rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name FROM WSMP_ADMIN.dw_presc_plan_rx_w rx WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-0025'::varchar(11), '330-16-050'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-16-055'::varchar(10), '330-14-004'::varchar(10), '330-16-056'::varchar(10), '330-14-006'::varchar(10), '330-15-050'::varchar(10), '330-14-005'::varchar(10), '330-15-005'::varchar(10), '330-12-002'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10), '330-13-020'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-16-027'::varchar(10), '330-16-028'::varchar(10), '330-16-029'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-001'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_factory_sales_852 AS
SELECT STG_FACTORY_SALES_852.TRADING_PARTNER, STG_FACTORY_SALES_852.DISTRIB_CENTER, STG_FACTORY_SALES_852.DISTRIB_CENTER_DEA_NUM, to_char(STG_FACTORY_SALES_852.REPORTING_DATE, 'DD-MON-YY'::varchar(9)) AS REPORTING_DATE, STG_FACTORY_SALES_852.NDC, STG_FACTORY_SALES_852.PRODUCT_CODE, STG_FACTORY_SALES_852.PRODUCT_NAME, STG_FACTORY_SALES_852.DESCRIPTION, CASE mod(STG_FACTORY_SALES_852.QTY_RECEIVED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RECEIVED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RECEIVED)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED, CASE mod(STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_SOLD, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_SOLD)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_SOLD)::varchar, '0'::varchar(1)) END AS QTY_SOLD, CASE mod(STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_SOLD_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_OMIT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_OMIT)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_OMIT)::varchar, '0'::varchar(1)) END AS QTY_OMIT, CASE mod(STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_OMIT_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND, CASE mod(STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_COMMITTED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_COMMITTED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_COMMITTED)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED, CASE mod(STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_RESERVED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_RESERVED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_RESERVED)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED, CASE mod(STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_RETURN, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RETURN)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RETURN)::varchar, '0'::varchar(1)) END AS QTY_RETURN, CASE mod(STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_RETURN_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN, CASE mod(STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN_DOLLARS, to_char(STG_FACTORY_SALES_852.LAST_BUILD_DATE, 'DD-MON-YY'::varchar(9)) AS LAST_BUILD_DATE FROM WSMP_ADMIN.STG_FACTORY_SALES_852;

CREATE  VIEW teva_ingestion.EXT_VV_ACCOUNTSHARE AS
 SELECT btrim(EXT_VV_ACCOUNTSHARE_src.ACCOUNTACCESSLEVEL) AS ACCOUNTACCESSLEVEL,
        btrim(EXT_VV_ACCOUNTSHARE_src.ACCOUNTID) AS ACCOUNTID,
        btrim(EXT_VV_ACCOUNTSHARE_src.CASEACCESSLEVEL) AS CASEACCESSLEVEL,
        btrim(EXT_VV_ACCOUNTSHARE_src.CONTACTACCESSLEVEL) AS CONTACTACCESSLEVEL,
        btrim(EXT_VV_ACCOUNTSHARE_src.ID) AS ID,
        btrim(EXT_VV_ACCOUNTSHARE_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_ACCOUNTSHARE_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_ACCOUNTSHARE_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_ACCOUNTSHARE_src.OPPORTUNITYACCESSLEVEL) AS OPPORTUNITYACCESSLEVEL,
        btrim(EXT_VV_ACCOUNTSHARE_src.ROWCAUSE) AS ROWCAUSE,
        btrim(EXT_VV_ACCOUNTSHARE_src.USERORGROUPID) AS USERORGROUPID,
        EXT_VV_ACCOUNTSHARE_src.batch_id,
        EXT_VV_ACCOUNTSHARE_src.row_id,
        EXT_VV_ACCOUNTSHARE_src.update_ts
 FROM teva_ingestion.EXT_VV_ACCOUNTSHARE_src
 WHERE (EXT_VV_ACCOUNTSHARE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_ACCOUNTSHARE'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_VV_ACCT_MERGE_HISTORY_VOD AS
 SELECT btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.ID) AS ID,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.NAME) AS NAME,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.PERSONCONTACTID_VOD__C) AS PERSONCONTACTID_VOD__C,
        btrim(EXT_VV_ACCT_MERGE_HISTORY_VOD_src.ACCOUNT_PERSONCONTACTID_VOD__C) AS ACCOUNT_PERSONCONTACTID_VOD__C,
        EXT_VV_ACCT_MERGE_HISTORY_VOD_src.batch_id,
        EXT_VV_ACCT_MERGE_HISTORY_VOD_src.row_id,
        EXT_VV_ACCT_MERGE_HISTORY_VOD_src.update_ts
 FROM teva_ingestion.EXT_VV_ACCT_MERGE_HISTORY_VOD_src
 WHERE (EXT_VV_ACCT_MERGE_HISTORY_VOD_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_ACCT_MERGE_HISTORY_VOD'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_VV_ADDRESS_VOD__C AS
 SELECT btrim(EXT_VV_ADDRESS_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_ADDRESS_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_ADDRESS_VOD__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_ADDRESS_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_ADDRESS_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ADDRESS_LINE_2_VOD__C) AS ADDRESS_LINE_2_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CITY_VOD__C) AS CITY_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_VOD__C) AS DEA_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_EXPIRATION_DATE_VOD__C) AS DEA_EXPIRATION_DATE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_LICENSE_ADDRESS_VOD__C) AS DEA_LICENSE_ADDRESS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.PHONE_VOD__C) AS PHONE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.FAX_VOD__C) AS FAX_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.MAP_VOD__C) AS MAP_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.SHIPPING_VOD__C) AS SHIPPING_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.PRIMARY_VOD__C) AS PRIMARY_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_VOD__C) AS LICENSE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_EXPIRATION_DATE_VOD__C) AS LICENSE_EXPIRATION_DATE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.STAFF_NOTES_VOD__C) AS STAFF_NOTES_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.APPT_REQUIRED_VOD__C) AS APPT_REQUIRED_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.OFFICE_NOTES_VOD__C) AS OFFICE_NOTES_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_STATUS_VOD__C) AS LICENSE_STATUS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ZIP_4_VOD__C) AS ZIP_4_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.PHONE_2_VOD__C) AS PHONE_2_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.FAX_2_VOD__C) AS FAX_2_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_VALID_TO_SAMPLE_VOD__C) AS LICENSE_VALID_TO_SAMPLE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.SAMPLE_STATUS_VOD__C) AS SAMPLE_STATUS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.INCLUDE_TERRITORY_ASSIGNMENT) AS INCLUDE_TERRITORY_ASSIGNMENT,
        btrim(EXT_VV_ADDRESS_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.INACTIVE_VOD__C) AS INACTIVE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LOCK_VOD__C) AS LOCK_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.COUNTRY_VOD__C) AS COUNTRY_VOD__C,
        CASE WHEN (EXT_VV_ADDRESS_VOD__C_src.LATITUDE_VOD__C = ''::varchar) THEN NULL::numeric(15,6) ELSE (btrim(EXT_VV_ADDRESS_VOD__C_src.LATITUDE_VOD__C))::numeric(15,6) END AS LATITUDE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ZIP_VOD__C) AS ZIP_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.BEST_TIMES_VOD__C) AS BEST_TIMES_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.SOURCE_VOD__C) AS SOURCE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.BRICK_VOD__C) AS BRICK_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ASSMCA_VOD__C) AS ASSMCA_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_ADDRESS_VOD__C) AS DEA_ADDRESS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_SCHEDULE_VOD__C) AS DEA_SCHEDULE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.BUSINESS_VOD__C) AS BUSINESS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.BILLING_VOD__C) AS BILLING_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.HOME_VOD__C) AS HOME_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.MAILING_VOD__C) AS MAILING_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.STATE_VOD__C) AS STATE_VOD__C,
        CASE WHEN (EXT_VV_ADDRESS_VOD__C_src.LONGITUDE_VOD__C = ''::varchar) THEN NULL::numeric(15,6) ELSE (btrim(EXT_VV_ADDRESS_VOD__C_src.LONGITUDE_VOD__C))::numeric(15,6) END AS LONGITUDE_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_STATUS_VOD__C) AS DEA_STATUS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ENTITY_REFERENCE_ID_VOD__C) AS ENTITY_REFERENCE_ID_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CONTROLLING_ADDRESS_VOD__C) AS CONTROLLING_ADDRESS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CONTROLLED_ADDRESS_VOD__C) AS CONTROLLED_ADDRESS_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.NO_ADDRESS_COPY_VOD__C) AS NO_ADDRESS_COPY_VOD__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.ADDRESS_LINE_3_TVA__C) AS ADDRESS_LINE_3_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.COUNTY_TVA__C) AS COUNTY_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.EXTERNAL_SLN_TVA__C) AS EXTERNAL_SLN_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_EXPIRATION_DATE_TVA__C) AS LICENSE_EXPIRATION_DATE_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.REP_ENTERED_SLN_TVA__C) AS REP_ENTERED_SLN_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.DEA_CONTACT_TVA__C) AS DEA_CONTACT_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.MARK_FOR_DELETION_TVA__C) AS MARK_FOR_DELETION_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_VALID_DATE_TVA__C) AS LICENSE_VALID_DATE_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.LICENSE_VALID_NUM_TVA__C) AS LICENSE_VALID_NUM_TVA__C,
        btrim(EXT_VV_ADDRESS_VOD__C_src.CM_ID_TVA__C) AS CM_ID_TVA__C,
        EXT_VV_ADDRESS_VOD__C_src.batch_id,
        EXT_VV_ADDRESS_VOD__C_src.row_id,
        EXT_VV_ADDRESS_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_ADDRESS_VOD__C_src
 WHERE (EXT_VV_ADDRESS_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_ADDRESS_VOD__C'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_VV_AFFILIATION_VOD__C AS
 SELECT btrim(EXT_VV_AFFILIATION_VOD__C_src.CHILD_AFFILIATION_VOD__C) AS CHILD_AFFILIATION_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.DESTROY_VOD__C) AS DESTROY_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.DISABLE_TRIGGER_VOD__C) AS DISABLE_TRIGGER_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.FROM_ACCOUNT_VOD__C) AS FROM_ACCOUNT_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.FROM_CONTACT_VOD__C) AS FROM_CONTACT_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.INFLUENCE_VOD__C) AS INFLUENCE_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.PARENT_VOD__C) AS PARENT_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.ROLE_VOD__C) AS ROLE_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.TO_ACCOUNT_VOD__C) AS TO_ACCOUNT_VOD__C,
        btrim(EXT_VV_AFFILIATION_VOD__C_src.TO_CONTACT_VOD__C) AS TO_CONTACT_VOD__C,
        EXT_VV_AFFILIATION_VOD__C_src.batch_id,
        EXT_VV_AFFILIATION_VOD__C_src.row_id,
        EXT_VV_AFFILIATION_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_AFFILIATION_VOD__C_src
 WHERE (EXT_VV_AFFILIATION_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_AFFILIATION_VOD__C'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_VV_ASSESSMENT__C AS
 SELECT btrim(EXT_VV_ASSESSMENT__C_src.ACCOUNT__C) AS ACCOUNT__C,
        btrim(EXT_VV_ASSESSMENT__C_src.ASSESSMENT_DATE_TVA__C) AS ASSESSMENT_DATE_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CC_PATIENT_PROFILES__C) AS CC_PATIENT_PROFILES__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CC_STUDY_LEVERAGE__C) AS CC_STUDY_LEVERAGE__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q1_TVA__C) AS CML_Q1_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q2_TVA__C) AS CML_Q2_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q3_TVA__C) AS CML_Q3_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q4_TVA__C) AS CML_Q4_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q5_1_TVA__C) AS CML_Q5_1_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q5_TVA__C) AS CML_Q5_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q6_TVA__C) AS CML_Q6_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q7_1_TVA__C) AS CML_Q7_1_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CML_Q7_TVA__C) AS CML_Q7_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.COMMUNITY_ACTIVITY__C) AS COMMUNITY_ACTIVITY__C,
        btrim(EXT_VV_ASSESSMENT__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_ASSESSMENT__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_ASSESSMENT__C_src.HISTORICAL_ASSESSMENT_TVA__C) AS HISTORICAL_ASSESSMENT_TVA__C,
        btrim(EXT_VV_ASSESSMENT__C_src.ID) AS ID,
        btrim(EXT_VV_ASSESSMENT__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_ASSESSMENT__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_ASSESSMENT__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_ASSESSMENT__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_ASSESSMENT__C_src.LN_PATIENT_PROFILES__C) AS LN_PATIENT_PROFILES__C,
        btrim(EXT_VV_ASSESSMENT__C_src.LN_STUDY_LEVERAGE__C) AS LN_STUDY_LEVERAGE__C,
        btrim(EXT_VV_ASSESSMENT__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_ASSESSMENT__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_ASSESSMENT__C_src.NAME) AS NAME,
        btrim(EXT_VV_ASSESSMENT__C_src.ONCOLOGY_BOARD__C) AS ONCOLOGY_BOARD__C,
        btrim(EXT_VV_ASSESSMENT__C_src.PREFERRED_PATHOLOGIST__C) AS PREFERRED_PATHOLOGIST__C,
        btrim(EXT_VV_ASSESSMENT__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_ASSESSMENT__C_src.RESEARCH_FOCUS__C) AS RESEARCH_FOCUS__C,
        btrim(EXT_VV_ASSESSMENT__C_src.RL_PATIENT_PROFILES__C) AS RL_PATIENT_PROFILES__C,
        btrim(EXT_VV_ASSESSMENT__C_src.RL_STUDY_LEVERAGE__C) AS RL_STUDY_LEVERAGE__C,
        btrim(EXT_VV_ASSESSMENT__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_ASSESSMENT__C_src.TREATMENT_PREFERENCES__C) AS TREATMENT_PREFERENCES__C,
        btrim(EXT_VV_ASSESSMENT__C_src.TREATMENT_VOLUME__C) AS TREATMENT_VOLUME__C,
        btrim(EXT_VV_ASSESSMENT__C_src.TUMOR_TYPES__C) AS TUMOR_TYPES__C,
        EXT_VV_ASSESSMENT__C_src.batch_id,
        EXT_VV_ASSESSMENT__C_src.row_id,
        EXT_VV_ASSESSMENT__C_src.update_ts
 FROM teva_ingestion.EXT_VV_ASSESSMENT__C_src
 WHERE (EXT_VV_ASSESSMENT__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_ASSESSMENT__C'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_DETAIL_VOD__C AS
 SELECT btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.id) AS id,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.name) AS name,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.createddate) AS createddate,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.is_parent_call_vod__c) AS is_parent_call_vod__c,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.call2_vod__c) AS call2_vod__c,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.product_vod__c) AS product_vod__c,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.detail_priority_vod__c) AS detail_priority_vod__c,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_CALL2_DETAIL_VOD__C_src.type_vod__c) AS type_vod__c,
        EXT_VV_CALL2_DETAIL_VOD__C_src.batch_id,
        EXT_VV_CALL2_DETAIL_VOD__C_src.row_id,
        EXT_VV_CALL2_DETAIL_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL2_DETAIL_VOD__C_src
 WHERE (EXT_VV_CALL2_DETAIL_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_CALL2_DETAIL_VOD__C'::varchar(26))));

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_KEY_MESSAGE_VOD AS
 SELECT btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.id) AS id,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.name) AS name,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.createddate) AS createddate,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.createdbyid) AS createdbyid,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.lastmodifieddate) AS lastmodifieddate,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.mayedit) AS mayedit,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.islocked) AS islocked,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.account_vod__c) AS account_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.call2_vod__c) AS call2_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.reaction_vod__c) AS reaction_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.product_vod__c) AS product_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.key_message_vod__c) AS key_message_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.mobile_id_vod__c) AS mobile_id_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.contact_vod__c) AS contact_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.call_date_vod__c) AS call_date_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.user_vod__c) AS user_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.category_vod__c) AS category_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.vehicle_vod__c) AS vehicle_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.is_parent_call_vod__c) AS is_parent_call_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.clm_id_vod__c) AS clm_id_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.slide_version_vod__c) AS slide_version_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.duration_vod__c) AS duration_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.presentation_id_vod__c) AS presentation_id_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.start_time_vod__c) AS start_time_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.attendee_type_vod__c) AS attendee_type_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.entity_reference_id_vod__c) AS entity_reference_id_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.segment_vod__c) AS segment_vod__c,
        btrim(EXT_VV_CALL2_KEY_MESSAGE_VOD_src.display_order_vod__c) AS display_order_vod__c,
        EXT_VV_CALL2_KEY_MESSAGE_VOD_src.batch_id,
        EXT_VV_CALL2_KEY_MESSAGE_VOD_src.row_id,
        EXT_VV_CALL2_KEY_MESSAGE_VOD_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL2_KEY_MESSAGE_VOD_src
 WHERE (EXT_VV_CALL2_KEY_MESSAGE_VOD_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_CALL2_KEY_MESSAGE_VOD'::varchar(28))));

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_VOD__HISTORY AS
 SELECT btrim(EXT_VV_CALL2_VOD__HISTORY_src.ID) AS ID,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.PARENTID) AS PARENTID,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.FIELD) AS FIELD,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.OLDVALUE) AS OLDVALUE,
        btrim(EXT_VV_CALL2_VOD__HISTORY_src.NEWVALUE) AS NEWVALUE,
        EXT_VV_CALL2_VOD__HISTORY_src.batch_id,
        EXT_VV_CALL2_VOD__HISTORY_src.row_id,
        EXT_VV_CALL2_VOD__HISTORY_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL2_VOD__HISTORY_src
 WHERE (EXT_VV_CALL2_VOD__HISTORY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_CALL2_VOD__HISTORY'::varchar(25))));

CREATE  VIEW teva_ingestion.EXT_VV_CALL_GOAL_TVA__C AS
 SELECT btrim(EXT_VV_CALL_GOAL_TVA__C_src.ACCOUNT_TVA__C) AS ACCOUNT_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.ACTIVE_TVA__C) AS ACTIVE_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.ACTUAL_REMAINING_TVA__C) AS ACTUAL_REMAINING_TVA__C,
        CASE WHEN (EXT_VV_CALL_GOAL_TVA__C_src.ACTUAL_TVA__C = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_VV_CALL_GOAL_TVA__C_src.ACTUAL_TVA__C))::numeric(37,15) END AS ACTUAL_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.END_DATE_TVA__C) AS END_DATE_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.EXTERNAL_ID_TVA__C) AS EXTERNAL_ID_TVA__C,
        CASE WHEN (EXT_VV_CALL_GOAL_TVA__C_src.GOAL_TVA__C = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_VV_CALL_GOAL_TVA__C_src.GOAL_TVA__C))::numeric(37,15) END AS GOAL_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.ID) AS ID,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.LASTACTIVITYDATE) AS LASTACTIVITYDATE,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.NAME) AS NAME,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.OWNERID) AS OWNERID,
        CASE WHEN (EXT_VV_CALL_GOAL_TVA__C_src.PRIORITY_TVA__C = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_VV_CALL_GOAL_TVA__C_src.PRIORITY_TVA__C))::numeric(37,15) END AS PRIORITY_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.PRODUCT_CATALOG_TVA__C) AS PRODUCT_CATALOG_TVA__C,
        CASE WHEN (EXT_VV_CALL_GOAL_TVA__C_src.REMAINING_TVA__C = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_VV_CALL_GOAL_TVA__C_src.REMAINING_TVA__C))::numeric(37,15) END AS REMAINING_TVA__C,
        CASE WHEN (EXT_VV_CALL_GOAL_TVA__C_src.SORT_ORDER_TVA__C = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_VV_CALL_GOAL_TVA__C_src.SORT_ORDER_TVA__C))::numeric(37,15) END AS SORT_ORDER_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.START_DATE_TVA__C) AS START_DATE_TVA__C,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_CALL_GOAL_TVA__C_src.TERRITORY_TVA__C) AS TERRITORY_TVA__C,
        EXT_VV_CALL_GOAL_TVA__C_src.batch_id,
        EXT_VV_CALL_GOAL_TVA__C_src.row_id,
        EXT_VV_CALL_GOAL_TVA__C_src.update_ts
 FROM teva_ingestion.EXT_VV_CALL_GOAL_TVA__C_src
 WHERE (EXT_VV_CALL_GOAL_TVA__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_CALL_GOAL_TVA__C'::varchar(23))));

CREATE  VIEW teva_ingestion.EXT_VV_DECILES_TVA__C AS
 SELECT btrim(EXT_VV_DECILES_TVA__C_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_DECILES_TVA__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_DECILES_TVA__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_DECILES_TVA__C_src.ID) AS ID,
        btrim(EXT_VV_DECILES_TVA__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_DECILES_TVA__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_DECILES_TVA__C_src.LASTACTIVITYDATE) AS LASTACTIVITYDATE,
        btrim(EXT_VV_DECILES_TVA__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_DECILES_TVA__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_DECILES_TVA__C_src.MARKET_TVA__C) AS MARKET_TVA__C,
        btrim(EXT_VV_DECILES_TVA__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_DECILES_TVA__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_DECILES_TVA__C_src.NAME) AS NAME,
        btrim(EXT_VV_DECILES_TVA__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_DECILES_TVA__C_src.VALUE_TVA__C) AS VALUE_TVA__C,
        EXT_VV_DECILES_TVA__C_src.batch_id,
        EXT_VV_DECILES_TVA__C_src.row_id,
        EXT_VV_DECILES_TVA__C_src.update_ts
 FROM teva_ingestion.EXT_VV_DECILES_TVA__C_src
 WHERE (EXT_VV_DECILES_TVA__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_DECILES_TVA__C'::varchar(21))));

CREATE  VIEW teva_ingestion.EXT_VV_GROUP AS
 SELECT btrim(EXT_VV_GROUP_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_GROUP_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_GROUP_src.DEVELOPERNAME) AS DEVELOPERNAME,
        btrim(EXT_VV_GROUP_src.DOESINCLUDEBOSSES) AS DOESINCLUDEBOSSES,
        btrim(EXT_VV_GROUP_src.DOESSENDEMAILTOMEMBERS) AS DOESSENDEMAILTOMEMBERS,
        btrim(EXT_VV_GROUP_src.EMAIL) AS EMAIL,
        btrim(EXT_VV_GROUP_src.ID) AS ID,
        btrim(EXT_VV_GROUP_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_GROUP_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_GROUP_src.NAME) AS NAME,
        btrim(EXT_VV_GROUP_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_GROUP_src.RELATEDID) AS RELATEDID,
        btrim(EXT_VV_GROUP_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_GROUP_src.TYPE) AS TYPE,
        EXT_VV_GROUP_src.batch_id,
        EXT_VV_GROUP_src.row_id,
        EXT_VV_GROUP_src.update_ts
 FROM teva_ingestion.EXT_VV_GROUP_src
 WHERE (EXT_VV_GROUP_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_GROUP'::varchar(12))));

CREATE  VIEW teva_ingestion.EXT_VV_MEDICAL_INQUIRY_VOD__C AS
 SELECT btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ADDRESS_LINE_1_VOD__C) AS ADDRESS_LINE_1_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ADDRESS_LINE_2_VOD__C) AS ADDRESS_LINE_2_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.CALL2_VOD__C) AS CALL2_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.CITY_VOD__C) AS CITY_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.COUNTRY_VOD__C) AS COUNTRY_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.DELIVERY_METHOD_VOD__C) AS DELIVERY_METHOD_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.DISCLAIMER_VOD__C) AS DISCLAIMER_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.EMAIL_VOD__C) AS EMAIL_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ENTITY_REFERENCE_ID_VOD__C) AS ENTITY_REFERENCE_ID_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.FAX_NUMBER_VOD__C) AS FAX_NUMBER_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.INQUIRY_TEXT__C) AS INQUIRY_TEXT__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.LOCK_VOD__C) AS LOCK_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.MSL_CONSULT__C) AS MSL_CONSULT__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.NEW_EMAIL_TVA__C) AS NEW_EMAIL_TVA__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.NEW_FAX_TVA__C) AS NEW_FAX_TVA__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.PHONE_NUMBER_VOD__C) AS PHONE_NUMBER_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.PRODUCT__C) AS PRODUCT__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.RUSH_DELIVERY__C) AS RUSH_DELIVERY__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.SIGNATURE_DATE_VOD__C) AS SIGNATURE_DATE_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.SIGNATURE_VOD__C) AS SIGNATURE_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.SOURCE__C) AS SOURCE__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.STATE_VOD__C) AS STATE_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.STATUS_VOD__C) AS STATUS_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.SUBMITTED_BY_MOBILE_VOD__C) AS SUBMITTED_BY_MOBILE_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ZIP_VOD__C) AS ZIP_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ZVOD_DELIVERY_METHOD_VOD__C) AS ZVOD_DELIVERY_METHOD_VOD__C,
        btrim(EXT_VV_MEDICAL_INQUIRY_VOD__C_src.ZVOD_DISCLAIMER_VOD__C) AS ZVOD_DISCLAIMER_VOD__C,
        EXT_VV_MEDICAL_INQUIRY_VOD__C_src.batch_id,
        EXT_VV_MEDICAL_INQUIRY_VOD__C_src.row_id,
        EXT_VV_MEDICAL_INQUIRY_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_MEDICAL_INQUIRY_VOD__C_src
 WHERE (EXT_VV_MEDICAL_INQUIRY_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_MEDICAL_INQUIRY_VOD__C'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_VV_PRODUCT_METRICS_VOD__C AS
 SELECT btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.ACCOUNT_VOD__C) AS ACCOUNT_VOD__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.AWARENESS__C) AS AWARENESS__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.SELLING_STAGE__C) AS SELLING_STAGE__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.FORMULARY_STATUS__C) AS FORMULARY_STATUS__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.MOVEMENT__C = ''::varchar) THEN NULL::numeric(5,2) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.MOVEMENT__C))::numeric(5,2) END AS MOVEMENT__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.PRODUCTS_VOD__C) AS PRODUCTS_VOD__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.SEGMENT__C) AS SEGMENT__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.X12_MO_TRX_CHG__C = ''::varchar) THEN NULL::numeric(5,2) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.X12_MO_TRX_CHG__C))::numeric(5,2) END AS X12_MO_TRX_CHG__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.SPEAKER_SKILLS__C) AS SPEAKER_SKILLS__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.INVESTIGATOR_READINESS__C) AS INVESTIGATOR_READINESS__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.ENGAGEMENTS__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.ENGAGEMENTS__C))::numeric(4,0) END AS ENGAGEMENTS__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.DECILE_VALUE_TVA__C = ''::varchar) THEN NULL::numeric(2,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.DECILE_VALUE_TVA__C))::numeric(2,0) END AS DECILE_VALUE_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.CURRENT_TVA__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.CURRENT_TVA__C))::numeric(4,0) END AS CURRENT_TVA__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.EXTERNAL_ID_TVA__C) AS EXTERNAL_ID_TVA__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.MARKETING_TARGET_TVA__C) AS MARKETING_TARGET_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.PRIOR_TVA__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.PRIOR_TVA__C))::numeric(4,0) END AS PRIOR_TVA__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.REP_TARGET_TVA__C) AS REP_TARGET_TVA__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.SBO_TARGET_TVA__C) AS SBO_TARGET_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_3_MONTH_TVA__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_3_MONTH_TVA__C))::numeric(4,0) END AS TRX_3_MONTH_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_6_MONTH_TVA__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_6_MONTH_TVA__C))::numeric(4,0) END AS TRX_6_MONTH_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_YTD_TVA__C = ''::varchar) THEN NULL::numeric(4,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.TRX_YTD_TVA__C))::numeric(4,0) END AS TRX_YTD_TVA__C,
        CASE WHEN (EXT_VV_PRODUCT_METRICS_VOD__C_src.CP_DECILE_TVA__C = ''::varchar) THEN NULL::numeric(2,0) ELSE (btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.CP_DECILE_TVA__C))::numeric(2,0) END AS CP_DECILE_TVA__C,
        btrim(EXT_VV_PRODUCT_METRICS_VOD__C_src.BUSINESS_SEGMENT_TVA__C) AS BUSINESS_SEGMENT_TVA__C,
        EXT_VV_PRODUCT_METRICS_VOD__C_src.batch_id,
        EXT_VV_PRODUCT_METRICS_VOD__C_src.row_id,
        EXT_VV_PRODUCT_METRICS_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_PRODUCT_METRICS_VOD__C_src
 WHERE (EXT_VV_PRODUCT_METRICS_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_PRODUCT_METRICS_VOD__C'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_VV_QUESTION_RESPONSE_VOD AS
 SELECT btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.ID) AS ID,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.NAME) AS NAME,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.SURVEY_TARGET_VOD__C) AS SURVEY_TARGET_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.ANSWER_CHOICE_VOD__C) AS ANSWER_CHOICE_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.DATE_VOD__C) AS DATE_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.DATETIME_VOD__C) AS DATETIME_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        CASE WHEN (EXT_VV_QUESTION_RESPONSE_VOD_src.NUMBER_VOD__C = ''::varchar) THEN NULL::numeric(7,0) ELSE (btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.NUMBER_VOD__C))::numeric(7,0) END AS NUMBER_VOD__C,
        CASE WHEN (EXT_VV_QUESTION_RESPONSE_VOD_src.ORDER_VOD__C = ''::varchar) THEN NULL::numeric(2,0) ELSE (btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.ORDER_VOD__C))::numeric(2,0) END AS ORDER_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.QUESTION_TEXT_VOD__C) AS QUESTION_TEXT_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.REQUIRED_VOD__C) AS REQUIRED_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.RESPONSE_HASH_VOD__C) AS RESPONSE_HASH_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.RESPONSE_VOD__C) AS RESPONSE_VOD__C,
        CASE WHEN (EXT_VV_QUESTION_RESPONSE_VOD_src.SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.SCORE_VOD__C))::numeric(11,0) END AS SCORE_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.SURVEY_QUESTION_VOD__C) AS SURVEY_QUESTION_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.TEXT_VOD__C) AS TEXT_VOD__C,
        btrim(EXT_VV_QUESTION_RESPONSE_VOD_src.TYPE_VOD__C) AS TYPE_VOD__C,
        EXT_VV_QUESTION_RESPONSE_VOD_src.batch_id,
        EXT_VV_QUESTION_RESPONSE_VOD_src.row_id,
        EXT_VV_QUESTION_RESPONSE_VOD_src.update_ts
 FROM teva_ingestion.EXT_VV_QUESTION_RESPONSE_VOD_src
 WHERE (EXT_VV_QUESTION_RESPONSE_VOD_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_QUESTION_RESPONSE_VOD'::varchar(28))));

CREATE  VIEW teva_ingestion.EXT_VV_RECORDTYPE AS
 SELECT btrim(EXT_VV_RECORDTYPE_src.BUSINESSPROCESSID) AS BUSINESSPROCESSID,
        btrim(EXT_VV_RECORDTYPE_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_RECORDTYPE_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_RECORDTYPE_src.DESCRIPTION) AS DESCRIPTION,
        btrim(EXT_VV_RECORDTYPE_src.DEVELOPERNAME) AS DEVELOPERNAME,
        btrim(EXT_VV_RECORDTYPE_src.ID) AS ID,
        btrim(EXT_VV_RECORDTYPE_src.ISACTIVE) AS ISACTIVE,
        btrim(EXT_VV_RECORDTYPE_src.ISPERSONTYPE) AS ISPERSONTYPE,
        btrim(EXT_VV_RECORDTYPE_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_RECORDTYPE_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_RECORDTYPE_src.NAME) AS NAME,
        btrim(EXT_VV_RECORDTYPE_src.NAMESPACEPREFIX) AS NAMESPACEPREFIX,
        btrim(EXT_VV_RECORDTYPE_src.SOBJECTTYPE) AS SOBJECTTYPE,
        btrim(EXT_VV_RECORDTYPE_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        EXT_VV_RECORDTYPE_src.batch_id,
        EXT_VV_RECORDTYPE_src.row_id,
        EXT_VV_RECORDTYPE_src.update_ts
 FROM teva_ingestion.EXT_VV_RECORDTYPE_src
 WHERE (EXT_VV_RECORDTYPE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_RECORDTYPE'::varchar(17))));

CREATE  VIEW teva_ingestion.EXT_VV_SURVEY_QUESTION_VOD__C AS
 SELECT btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.SURVEY_VOD__C) AS SURVEY_VOD__C,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.ANSWER_CHOICE_VOD__C) AS ANSWER_CHOICE_VOD__C,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_QUESTION_VOD__C_src.MAX_SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.MAX_SCORE_VOD__C))::numeric(11,0) END AS MAX_SCORE_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_QUESTION_VOD__C_src.MIN_SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.MIN_SCORE_VOD__C))::numeric(11,0) END AS MIN_SCORE_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_QUESTION_VOD__C_src.ORDER_VOD__C = ''::varchar) THEN NULL::numeric(2,0) ELSE (btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.ORDER_VOD__C))::numeric(2,0) END AS ORDER_VOD__C,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.QUESTION_VOD__C) AS QUESTION_VOD__C,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.REQUIRED_VOD__C) AS REQUIRED_VOD__C,
        btrim(EXT_VV_SURVEY_QUESTION_VOD__C_src.TEXT_VOD__C) AS TEXT_VOD__C,
        EXT_VV_SURVEY_QUESTION_VOD__C_src.batch_id,
        EXT_VV_SURVEY_QUESTION_VOD__C_src.row_id,
        EXT_VV_SURVEY_QUESTION_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SURVEY_QUESTION_VOD__C_src
 WHERE (EXT_VV_SURVEY_QUESTION_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_SURVEY_QUESTION_VOD__C'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_VV_SURVEY_VOD__C AS
 SELECT btrim(EXT_VV_SURVEY_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_SURVEY_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_SURVEY_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_SURVEY_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_SURVEY_VOD__C_src.RECORDTYPEID) AS RECORDTYPEID,
        btrim(EXT_VV_SURVEY_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_SURVEY_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_SURVEY_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_SURVEY_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_SURVEY_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_SURVEY_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_SURVEY_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_SURVEY_VOD__C_src.LASTVIEWEDDATE) AS LASTVIEWEDDATE,
        btrim(EXT_VV_SURVEY_VOD__C_src.LASTREFERENCEDDATE) AS LASTREFERENCEDDATE,
        btrim(EXT_VV_SURVEY_VOD__C_src.ASSIGNMENT_TYPE_VOD__C) AS ASSIGNMENT_TYPE_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.CHANNELS_VOD__C) AS CHANNELS_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.END_DATE_VOD__C) AS END_DATE_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.EXPIRED_VOD__C) AS EXPIRED_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.EXTERNAL_ID_VOD__C) AS EXTERNAL_ID_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.LANGUAGE_VOD__C) AS LANGUAGE_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.LOCK_VOD__C) AS LOCK_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.OPEN_VOD__C) AS OPEN_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.PRODUCT_VOD__C) AS PRODUCT_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.REGION_VOD__C) AS REGION_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.SEGMENT_VOD__C) AS SEGMENT_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.START_DATE_VOD__C) AS START_DATE_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.STATUS_VOD__C) AS STATUS_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.TERRITORY_VOD__C) AS TERRITORY_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.ZVOD_QUESTIONS_VOD__C) AS ZVOD_QUESTIONS_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.ZVOD_SEGMENTS_VOD__C) AS ZVOD_SEGMENTS_VOD__C,
        btrim(EXT_VV_SURVEY_VOD__C_src.ZVOD_TARGETS_VOD__C) AS ZVOD_TARGETS_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_VOD__C_src.MAX_SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_SURVEY_VOD__C_src.MAX_SCORE_VOD__C))::numeric(11,0) END AS MAX_SCORE_VOD__C,
        CASE WHEN (EXT_VV_SURVEY_VOD__C_src.MIN_SCORE_VOD__C = ''::varchar) THEN NULL::numeric(11,0) ELSE (btrim(EXT_VV_SURVEY_VOD__C_src.MIN_SCORE_VOD__C))::numeric(11,0) END AS MIN_SCORE_VOD__C,
        EXT_VV_SURVEY_VOD__C_src.batch_id,
        EXT_VV_SURVEY_VOD__C_src.row_id,
        EXT_VV_SURVEY_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SURVEY_VOD__C_src
 WHERE (EXT_VV_SURVEY_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_SURVEY_VOD__C'::varchar(20))));

CREATE  VIEW teva_ingestion.EXT_VV_SYNC_TRACKING_VOD__C AS
 SELECT btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.CREATEDBYID) AS CREATEDBYID,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.CREATEDDATE) AS CREATEDDATE,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.DOWNLOAD_PROCESSED_VOD__C) AS DOWNLOAD_PROCESSED_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.ID) AS ID,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.ISDELETED) AS ISDELETED,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.ISLOCKED) AS ISLOCKED,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.MAYEDIT) AS MAYEDIT,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.MEDIA_PROCESSED_VOD__C) AS MEDIA_PROCESSED_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.MOBILE_ID_VOD__C) AS MOBILE_ID_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.NAME) AS NAME,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.OWNERID) AS OWNERID,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SUCCESSFUL_SYNC_VOD__C) AS SUCCESSFUL_SYNC_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SYNC_COMPLETED_DATETIME_VOD__C) AS SYNC_COMPLETED_DATETIME_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SYNC_DURATION_VOD__C) AS SYNC_DURATION_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SYNC_START_DATETIME_VOD__C) AS SYNC_START_DATETIME_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SYNC_TYPE_VOD__C) AS SYNC_TYPE_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.UPLOAD_PROCESSED_VOD__C) AS UPLOAD_PROCESSED_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.VERSION_VOD__C) AS VERSION_VOD__C,
        btrim(EXT_VV_SYNC_TRACKING_VOD__C_src.VINSIGHTS_PROCESSED_VOD__C) AS VINSIGHTS_PROCESSED_VOD__C,
        EXT_VV_SYNC_TRACKING_VOD__C_src.batch_id,
        EXT_VV_SYNC_TRACKING_VOD__C_src.row_id,
        EXT_VV_SYNC_TRACKING_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SYNC_TRACKING_VOD__C_src
 WHERE (EXT_VV_SYNC_TRACKING_VOD__C_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_SYNC_TRACKING_VOD__C'::varchar(27))));

CREATE  VIEW teva_ingestion.EXT_VV_TERRITORY AS
 SELECT btrim(EXT_VV_TERRITORY_src.ACCOUNTACCESSLEVEL) AS ACCOUNTACCESSLEVEL,
        btrim(EXT_VV_TERRITORY_src.CASEACCESSLEVEL) AS CASEACCESSLEVEL,
        btrim(EXT_VV_TERRITORY_src.CONTACTACCESSLEVEL) AS CONTACTACCESSLEVEL,
        btrim(EXT_VV_TERRITORY_src.DESCRIPTION) AS DESCRIPTION,
        btrim(EXT_VV_TERRITORY_src.DEVELOPERNAME) AS DEVELOPERNAME,
        btrim(EXT_VV_TERRITORY_src.FORECASTUSERID) AS FORECASTUSERID,
        btrim(EXT_VV_TERRITORY_src.ID) AS ID,
        btrim(EXT_VV_TERRITORY_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_TERRITORY_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_TERRITORY_src.MAYFORECASTMANAGERSHARE) AS MAYFORECASTMANAGERSHARE,
        btrim(EXT_VV_TERRITORY_src.NAME) AS NAME,
        btrim(EXT_VV_TERRITORY_src.OPPORTUNITYACCESSLEVEL) AS OPPORTUNITYACCESSLEVEL,
        btrim(EXT_VV_TERRITORY_src.PARENTTERRITORYID) AS PARENTTERRITORYID,
        btrim(EXT_VV_TERRITORY_src.RESTRICTOPPORTUNITYTRANSFER) AS RESTRICTOPPORTUNITYTRANSFER,
        btrim(EXT_VV_TERRITORY_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        EXT_VV_TERRITORY_src.batch_id,
        EXT_VV_TERRITORY_src.row_id,
        EXT_VV_TERRITORY_src.update_ts
 FROM teva_ingestion.EXT_VV_TERRITORY_src
 WHERE (EXT_VV_TERRITORY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_TERRITORY'::varchar(16))));

CREATE  VIEW teva_ingestion.EXT_VV_USERROLE AS
 SELECT btrim(EXT_VV_USERROLE_src.CASEACCESSFORACCOUNTOWNER) AS CASEACCESSFORACCOUNTOWNER,
        btrim(EXT_VV_USERROLE_src.CONTACTACCESSFORACCOUNTOWNER) AS CONTACTACCESSFORACCOUNTOWNER,
        btrim(EXT_VV_USERROLE_src.DEVELOPERNAME) AS DEVELOPERNAME,
        btrim(EXT_VV_USERROLE_src.FORECASTUSERID) AS FORECASTUSERID,
        btrim(EXT_VV_USERROLE_src.ID) AS ID,
        btrim(EXT_VV_USERROLE_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_USERROLE_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_USERROLE_src.MAYFORECASTMANAGERSHARE) AS MAYFORECASTMANAGERSHARE,
        btrim(EXT_VV_USERROLE_src.NAME) AS NAME,
        btrim(EXT_VV_USERROLE_src.OPPORTUNITYACCESSACCOUNTOWNER) AS OPPORTUNITYACCESSACCOUNTOWNER,
        btrim(EXT_VV_USERROLE_src.PARENTROLEID) AS PARENTROLEID,
        btrim(EXT_VV_USERROLE_src.PORTALACCOUNTID) AS PORTALACCOUNTID,
        btrim(EXT_VV_USERROLE_src.PORTALACCOUNTOWNERID) AS PORTALACCOUNTOWNERID,
        btrim(EXT_VV_USERROLE_src.PORTALTYPE) AS PORTALTYPE,
        btrim(EXT_VV_USERROLE_src.ROLLUPDESCRIPTION) AS ROLLUPDESCRIPTION,
        btrim(EXT_VV_USERROLE_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        EXT_VV_USERROLE_src.batch_id,
        EXT_VV_USERROLE_src.row_id,
        EXT_VV_USERROLE_src.update_ts
 FROM teva_ingestion.EXT_VV_USERROLE_src
 WHERE (EXT_VV_USERROLE_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_USERROLE'::varchar(15))));

CREATE  VIEW teva_ingestion.EXT_VV_USERTERRITORY AS
 SELECT btrim(EXT_VV_USERTERRITORY_src.ID) AS ID,
        btrim(EXT_VV_USERTERRITORY_src.ISACTIVE) AS ISACTIVE,
        btrim(EXT_VV_USERTERRITORY_src.LASTMODIFIEDBYID) AS LASTMODIFIEDBYID,
        btrim(EXT_VV_USERTERRITORY_src.LASTMODIFIEDDATE) AS LASTMODIFIEDDATE,
        btrim(EXT_VV_USERTERRITORY_src.SYSTEMMODSTAMP) AS SYSTEMMODSTAMP,
        btrim(EXT_VV_USERTERRITORY_src.TERRITORYID) AS TERRITORYID,
        btrim(EXT_VV_USERTERRITORY_src.USERID) AS USERID,
        EXT_VV_USERTERRITORY_src.batch_id,
        EXT_VV_USERTERRITORY_src.row_id,
        EXT_VV_USERTERRITORY_src.update_ts
 FROM teva_ingestion.EXT_VV_USERTERRITORY_src
 WHERE (EXT_VV_USERTERRITORY_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_VV_USERTERRITORY'::varchar(20))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_CSP_Attendees AS
SELECT (a.COGENIX_PROGRAM_ID)::int AS cogenix_program_id, a.PROGRAM_NAME, a.PROGRAM_DATE, a.SFA_PROF_ID, a.ME_NUM, a.DEA_NUM, (a.COGENIX_ID)::int AS cogenix_id, coalesce(a.CM_ID, (cm.CUSTOMER_MASTER_ID)::varchar) AS cm_id, a.STATE_LICENSE_STATE, a.STATE_LICENSE_NUMBER, a.FIRST_NAME, a.LAST_NAME, a.ADDRESS1, a.ADDRESS2, a.ADDRESS3, a.CITY, a.STATE, a.ZIP, a.PRIMARY_SPECIALTY, a.HCP_TYPE AS hcp_type, a.PRESCRIBER_FLAG FROM ((WSMP_ADMIN.STG_COGENIX_CSP_ATTENDEE a JOIN WSMP_ADMIN.STG_COGENIX_CSP_PROGRAM p ON ((p.COGENIX_PROGRAM_ID = a.COGENIX_PROGRAM_ID))) LEFT JOIN WSMP_ADMIN.STG_CUSTOMER_MASTER cm ON (((cm.SOURCE_ID = CASE WHEN (a.PRESCRIBER_FLAG = 'N'::varchar(1)) THEN ('NONHCP_'::varchar(7) || (a.COGENIX_ID)::varchar) ELSE (a.COGENIX_ID)::varchar END) AND (cm.RECORD_SOURCE_SYSTEM = 'CGX'::varchar(3))))) WHERE ((p.PROGRAM_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (p.PROGRAM_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (p.PRODUCT = 'Nuvigil'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_CSP_Programs AS
SELECT CASE mod(STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID)::varchar, '0'::varchar(1)) END AS COGENIX_PROGRAM_ID, STG_COGENIX_CSP_PROGRAM.PROGRAM_NAME, to_char(STG_COGENIX_CSP_PROGRAM.PROGRAM_REQUEST_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_REQUEST_DATE, to_char(STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_DATE, STG_COGENIX_CSP_PROGRAM.PRODUCT, STG_COGENIX_CSP_PROGRAM.TOPIC, STG_COGENIX_CSP_PROGRAM.PROGRAM_TYPE, STG_COGENIX_CSP_PROGRAM.PROGRAM_STATUS, STG_COGENIX_CSP_PROGRAM.VENUE_NAME, STG_COGENIX_CSP_PROGRAM.VENUE_CITY, STG_COGENIX_CSP_PROGRAM.VENUE_STATE, CASE mod(STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE)::varchar, '0'::varchar(1)) END AS ESTIMATED_ATTENDANCE, CASE mod(STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS)::varchar, '0'::varchar(1)) END AS NONPRESCRIBER_CEPHALON_COUNTS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA)::varchar, '0'::varchar(1)) END AS PRESCRIBERS_W_O_DEA, CASE mod(STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS)::varchar, '0'::varchar(1)) END AS NONHCP_OFFICE_STAFF_COUNTS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS)::varchar, '0'::varchar(1)) END AS PRESCRIBERS, CASE mod(STG_COGENIX_CSP_PROGRAM.HCPS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.HCPS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.HCPS)::varchar, '0'::varchar(1)) END AS HCPS, CASE mod(STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS)::varchar, '0'::varchar(1)) END AS TOTAL_PRESCRIBERS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW)::varchar, '0'::varchar(1)) END AS PRESCRIBERS_ACCEPTED_NO_SHOW, STG_COGENIX_CSP_PROGRAM.ATTENDEE_FORM_RECEIVED, STG_COGENIX_CSP_PROGRAM.ATTENDEE_SIGN_IN_SHEET_RECVD, CASE mod(STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE)::varchar, '0'::varchar(1)) END AS ACTUAL_ATTENDANCE, CASE mod(STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS)::varchar, '0'::varchar(1)) END AS ESTIMATED_COSTS, STG_COGENIX_CSP_PROGRAM.OFFICES_REPRESENTED, CASE mod(STG_COGENIX_CSP_PROGRAM.AV_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.AV_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.AV_EXPENSES)::varchar, '0'::varchar(1)) END AS AV_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE)::varchar, '0'::varchar(1)) END AS FOOD_AND_BEVERAGE, CASE mod(STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES)::varchar, '0'::varchar(1)) END AS MEETING_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS)::varchar, '0'::varchar(1)) END AS MISCELLANEOUS, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES)::varchar, '0'::varchar(1)) END AS SPEAKER_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA)::varchar, '0'::varchar(1)) END AS SPEAKER_HONORARIA, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL)::varchar, '0'::varchar(1)) END AS SPEAKER_TRAVEL, CASE mod(STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL)::varchar, '0'::varchar(1)) END AS VENUE_ROOM_RENTAL, CASE mod(STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS)::varchar, '0'::varchar(1)) END AS ACTUAL_COSTS, CASE mod(STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM)::varchar, '0'::varchar(1)) END AS UNMET_MINIMUM, to_char(STG_COGENIX_CSP_PROGRAM.CREATE_DATE, 'YYYY-MM-DD'::varchar(10)) AS CREATE_DATE, CASE mod(STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES)::varchar, '0'::varchar(1)) END AS TAKEDA_ATTENDEES FROM WSMP_ADMIN.STG_COGENIX_CSP_PROGRAM WHERE ((STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (STG_COGENIX_CSP_PROGRAM.PRODUCT = 'Nuvigil'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Copay_Voucher_Drops AS
SELECT CASE mod(x.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((x.tvcmid)::int)::varchar ELSE rtrim((x.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, x.ims_id, x.veeva_account_id, d.RESOURCE_TYPE AS Resource_type, d.TERRITORY_NUM AS Territory_num, d.DISTRIBUTION_DATE AS distribution_date, (d.QTY)::int AS qty FROM WSMP_ADMIN.TFC_SFA_RESOURCE_DIST_DETAIL d, (SELECT demo_combined.ims_id, demo_combined.tvcmid, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.ims_id, demo_combined.tvcmid, demo_combined.veeva_account_id) x WHERE ((d.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (d.DISTRIBUTION_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (d.DISTRIBUTION_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (d.IMS_ID = x.ims_id));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Demo AS
SELECT CASE mod(d.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((d.tvcmid)::int)::varchar ELSE rtrim((d.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.mid_name, d.last_name, d.degree AS DEGREE, d.address, d.city, d.state, d.zip, d.specialty AS prim_specialty, s1.NUVIGIL_REPORT_GROUP AS nuvigil_report_group, dec1.trx_cnt_01_06 AS nuvigil_decile, dec2.trx_cnt_01_06 AS wake_decile, cp.TARGET_VALUE AS target_flag FROM (((((WSMP_ADMIN.demo_combined d LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.specialty))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec1 ON (((dec1.ims_id = d.ims_id) AND (dec1.category = 'Provigil'::varchar(8)) AND (dec1.decile_name = 'Nuvigil'::varchar(7))))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec2 ON (((dec2.ims_id = d.ims_id) AND (dec2.category = 'Provigil'::varchar(8)) AND (dec2.decile_name = 'Modafinil'::varchar(9))))) JOIN (SELECT prodx.ims_id FROM (SELECT dw_presc_plan_rx_m.ims_id FROM WSMP_ADMIN.dw_presc_plan_rx_m WHERE ((dw_presc_plan_rx_m.product_code = '100N00'::varchar(6)) AND (dw_presc_plan_rx_m.month_bucket >= 1::numeric(18,0)) AND (dw_presc_plan_rx_m.month_bucket <= 24::numeric(18,0))) UNION ALL SELECT DIM_SFA_CSF_DEMO.IMS_ID AS ims_id FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO WHERE (DIM_SFA_CSF_DEMO.SALES_FORCE_ID = 'TC'::varchar(2))) prodx GROUP BY prodx.ims_id) r ON ((d.ims_id = r.ims_id))) LEFT JOIN WSMP_ADMIN.DIM_SFA_TARGETS cp ON (((d.ims_id = cp.IMS_ID) AND (cp.NAME = 'Nuvigil'::varchar(7)) AND (cp.PERIOD ~~ '2015%'::varchar(5))))) WHERE ((d.sales_force_id = 'TC'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_agile_mktg_mix_rx AS
SELECT rx.ims_id AS IMS_ID, rx.product_code, p.NAME AS product_name, rx.month_ending AS MONTH_ENDING, sum(CASE mod(rx.nrx_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.nrx_qty)::int)::varchar ELSE rtrim((rx.nrx_qty)::varchar, '0'::varchar(1)) END) AS nrx_qty, sum(CASE mod(rx.trx_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.trx_qty)::int)::varchar ELSE rtrim((rx.trx_qty)::varchar, '0'::varchar(1)) END) AS trx_qty, sum(CASE mod(rx.nrx_cnt, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.nrx_cnt)::int)::varchar ELSE rtrim((rx.nrx_cnt)::varchar, '0'::varchar(1)) END) AS nrx_cnt, sum(CASE mod(rx.trx_cnt, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.trx_cnt)::int)::varchar ELSE rtrim((rx.trx_cnt)::varchar, '0'::varchar(1)) END) AS trx_cnt FROM WSMP_ADMIN.dw_presc_plan_rx_m rx, CUSTOMER.PRODUCT p WHERE ((rx.product_code = p.PRODUCT_CODE) AND (rx.month_ending >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (rx.month_ending <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (rx.product_code = ANY (ARRAY['100100'::varchar(6), '100101'::varchar(6), '100102'::varchar(6), '100N00'::varchar(6), '100N05'::varchar(6), '100N15'::varchar(6), '100N20'::varchar(6), '100N25'::varchar(6), '100700'::varchar(6)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.ims_id, rx.product_code, p.NAME, rx.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Samples AS
SELECT S.sales_force_id, S.territory_num, CASE mod(IX.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((IX.tvcmid)::int)::varchar ELSE rtrim((IX.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, IX.ims_id, IX.veeva_account_id, to_char(S.ship_date, 'YYYY-MM-DD'::varchar(10)) AS ship_date, S.product_code, S.product, CASE mod(S.ship_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((S.ship_qty)::int)::varchar ELSE rtrim((S.ship_qty)::varchar, '0'::varchar(1)) END AS ship_qty FROM ((SELECT ss.SALES_FORCE_ID AS sales_force_id, ss.TERRITORY_NUM AS territory_num, NULL AS tvcmid, ss.IMS_ID AS ims_id, ss.DEMO_ID AS demo_id, ss.SHIP_DATE AS ship_date, ss.PRODUCT_CODE AS product_code, ss.PRODUCT AS product, ss.SHIP_QTY AS ship_qty FROM WSMP_ADMIN.STG_KNIPPER_SAMPLES_SHIPPED ss WHERE ((ss.SALES_FORCE_ID = 'TC'::varchar(2)) AND (ss.SHIP_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (ss.SHIP_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (ss.PRODUCT_CODE ~~ '100N%'::varchar(5)))) S LEFT JOIN (SELECT demo_combined.tvcmid, demo_combined.ims_id, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.tvcmid, demo_combined.ims_id, demo_combined.veeva_account_id) IX ON ((S.demo_id = IX.veeva_account_id)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Details AS
SELECT CASE mod(d.TVCMID, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((d.TVCMID)::int)::varchar ELSE rtrim((d.TVCMID)::varchar, '0'::varchar(1)) END AS tvcmid, cd.IMS_ID AS ims_id, cd.VEEVA_ACCOUNT_ID AS veeva_account_id, initcap(d.LAST_NAME) AS last_name, initcap(d.FIRST_NAME) AS first_name, initcap(d.MIDDLE_NAME) AS middle_name, d.CREDENTIALS AS DEGREE, d.ZIP AS zip, cd.REP_ID AS rep_id, cd.TERRITORY_NUM AS territory_num, to_char(cd.CALL_DATE, 'YYYY-MM-DD'::varchar(10)) AS call_date, 'NUVIGIL'::varchar(7) AS product, CASE WHEN (cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 1 WHEN (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 2 ELSE NULL::int END AS detail_position FROM WSMP_ADMIN.TFC_SFA_CSF_CALL_DETAIL cd, WSMP_ADMIN.DIM_SFA_CSF_DEMO d, WSMP_ADMIN.TFC_CURRENT_ZIP_ALIGNMENT z WHERE ((cd.SALES_FORCE_ID = 'TC'::varchar(2)) AND (cd.SALES_FORCE_ID = d.SALES_FORCE_ID) AND (cd.TERRITORY_NUM = d.TERRITORY_NUM) AND (cd.CALL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (cd.CALL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.VEEVA_ACCOUNT_ID = d.VEEVA_ACCOUNT_ID) AND (d.ZIP = z.ZIP) AND ((cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) OR (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7))) AND (cd.LEGACY_CALL_TYPE = 'PROF'::varchar(4)) AND ((cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) OR (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7))) AND (cd.LEGACY_CALL_TYPE = 'PROF'::varchar(4))) GROUP BY d.TVCMID, cd.IMS_ID, cd.VEEVA_ACCOUNT_ID, initcap(d.LAST_NAME), initcap(d.FIRST_NAME), initcap(d.MIDDLE_NAME), d.CREDENTIALS, d.ZIP, cd.REP_ID, cd.TERRITORY_NUM, cd.CALL_DATE, 'NUVIGIL'::varchar(7), CASE WHEN (cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 1 WHEN (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 2 ELSE NULL::int END;

CREATE  VIEW WSMP_ADMIN_ORA.v_tmp_ms AS
SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, rx.sales_category, rx.rx_type, rx.ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024, 'stg_ims_mhj_qty_m'::varchar(17) AS row_source FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) UNION ALL SELECT rx.ims_client_num, rx.ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, rx.sales_category, rx.rx_type, rx.ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24, 'stg_asi_ms_rx_cnt'::varchar(17) AS row_source FROM WSMP_ADMIN.stg_asi_ms_rx_cnt rx;

CREATE  VIEW teva_ingestion.XX_TERR_ID_CHANGE_V AS
 SELECT btrim(XX_TERR_ID_CHANGE_V_src.EE_NBR) AS EE_NBR,
        btrim(XX_TERR_ID_CHANGE_V_src.EE_NAME) AS EE_NAME,
        btrim(XX_TERR_ID_CHANGE_V_src.TERR_ID_FROM) AS TERR_ID_FROM,
        btrim(XX_TERR_ID_CHANGE_V_src.TERR_ID_TO) AS TERR_ID_TO,
        CASE WHEN (XX_TERR_ID_CHANGE_V_src.TERR_MOVE_DT = ''::varchar) THEN NULL::date ELSE (btrim(XX_TERR_ID_CHANGE_V_src.TERR_MOVE_DT))::date END AS TERR_MOVE_DT,
        XX_TERR_ID_CHANGE_V_src.batch_id,
        XX_TERR_ID_CHANGE_V_src.row_id,
        XX_TERR_ID_CHANGE_V_src.update_ts
 FROM teva_ingestion.XX_TERR_ID_CHANGE_V_src;

CREATE  VIEW teva_ingestion.ext_time_off_territory_kc_veev AS
 SELECT CASE WHEN (ext_time_off_territory_kc_veev_src.ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_time_off_territory_kc_veev_src.ID))::numeric(38,0) END AS ID,
        btrim(ext_time_off_territory_kc_veev_src.EVENT_ROW_ID) AS EVENT_ROW_ID,
        btrim(ext_time_off_territory_kc_veev_src.REP_ROW_ID) AS REP_ROW_ID,
        btrim(ext_time_off_territory_kc_veev_src.TERRITORY_NUM) AS TERRITORY_NUM,
        CASE WHEN (ext_time_off_territory_kc_veev_src.TIME_OFF_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_time_off_territory_kc_veev_src.TIME_OFF_DATE))::timestamp END AS TIME_OFF_DATE,
        CASE WHEN (ext_time_off_territory_kc_veev_src.TIME_ON_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(ext_time_off_territory_kc_veev_src.TIME_ON_DATE))::timestamp END AS TIME_ON_DATE,
        btrim(ext_time_off_territory_kc_veev_src.DESCRIPTION) AS DESCRIPTION,
        btrim(ext_time_off_territory_kc_veev_src.COMMENTS) AS COMMENTS,
        CASE WHEN (ext_time_off_territory_kc_veev_src.DURATION_IN_MINUTES = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_time_off_territory_kc_veev_src.DURATION_IN_MINUTES))::numeric(38,0) END AS DURATION_IN_MINUTES,
        CASE WHEN (ext_time_off_territory_kc_veev_src.DURATION_IN_HOURS = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_time_off_territory_kc_veev_src.DURATION_IN_HOURS))::numeric(38,0) END AS DURATION_IN_HOURS,
        CASE WHEN (ext_time_off_territory_kc_veev_src.DURATION_IN_DAYS = ''::varchar) THEN NULL::numeric(10,3) ELSE (btrim(ext_time_off_territory_kc_veev_src.DURATION_IN_DAYS))::numeric(10,3) END AS DURATION_IN_DAYS,
        CASE WHEN (ext_time_off_territory_kc_veev_src.COMPANY = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(ext_time_off_territory_kc_veev_src.COMPANY))::numeric(38,0) END AS COMPANY,
        ext_time_off_territory_kc_veev_src.batch_id,
        ext_time_off_territory_kc_veev_src.row_id,
        ext_time_off_territory_kc_veev_src.update_ts
 FROM teva_ingestion.ext_time_off_territory_kc_veev_src
 WHERE (ext_time_off_territory_kc_veev_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_TIME_OFF_TERRITORY_KC_VEEV'::varchar(30))));

CREATE  VIEW WSMP_ADMIN_ORA.dim_ims_month_buckets AS
SELECT dw_presc_rx_m.month_bucket, dw_presc_rx_m.month_ending FROM WSMP_ADMIN.dw_presc_rx_m GROUP BY dw_presc_rx_m.month_bucket, dw_presc_rx_m.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_wake AS
SELECT rx.ims_client_num, 71 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'WAKE'::varchar(4)) UNION ALL SELECT rx.ims_client_num, 71 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'WAKE'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_smr AS
SELECT rx.ims_client_num, 81 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'SMR'::varchar(3)) UNION ALL SELECT rx.ims_client_num, 81 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'SMR'::varchar(3)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_pd AS
(SELECT rx.ims_client_num, 6 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'ANTI-PARKINSON'::varchar(14)) UNION ALL SELECT rx.ims_client_num, 6 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'ANTI-PARKINSON'::varchar(14)) AND (nf.PRODUCT_CODE IS NULL))) UNION ALL SELECT rx.ims_client_num, 6 AS ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, to_char(rx.sales_category, '00'::varchar(2)) AS sales_category, rx.rx_type, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24 FROM WSMP_ADMIN.stg_asi_pd_rx_cnt rx;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_ms AS
(SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) UNION ALL SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) AND (nf.PRODUCT_CODE IS NULL))) UNION ALL SELECT rx.ims_client_num, 2 AS ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24 FROM WSMP_ADMIN.stg_asi_ms_rx_cnt rx;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_pain AS
SELECT rx.ims_client_num, 74 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'PAIN'::varchar(4)) UNION ALL SELECT rx.ims_client_num, 74 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'PAIN'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW teva_ingestion.MS_MTHLY_RX_CNT AS
SELECT CASE WHEN (MS_MTHLY_RX_CNT_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_MTHLY_RX_CNT_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_report_num))::int END AS ims_report_num, btrim(MS_MTHLY_RX_CNT_src.zip_other) AS zip_other, btrim(MS_MTHLY_RX_CNT_src.ims_id) AS ims_id, btrim(MS_MTHLY_RX_CNT_src.ndc) AS ndc, btrim(MS_MTHLY_RX_CNT_src.plan_id) AS plan_id, CASE WHEN (MS_MTHLY_RX_CNT_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.sales_category))::int END AS sales_category, btrim(MS_MTHLY_RX_CNT_src.rx_type) AS rx_type, CASE WHEN (MS_MTHLY_RX_CNT_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_MTHLY_RX_CNT_src.filler_01) AS filler_01, btrim(MS_MTHLY_RX_CNT_src.me_num) AS me_num, btrim(MS_MTHLY_RX_CNT_src.last_name) AS last_name, btrim(MS_MTHLY_RX_CNT_src.first_name) AS first_name, btrim(MS_MTHLY_RX_CNT_src.middle_name) AS middle_name, btrim(MS_MTHLY_RX_CNT_src.address) AS address, btrim(MS_MTHLY_RX_CNT_src.city) AS city, btrim(MS_MTHLY_RX_CNT_src.state) AS state, btrim(MS_MTHLY_RX_CNT_src.zip) AS zip, btrim(MS_MTHLY_RX_CNT_src.specialty) AS specialty, btrim(MS_MTHLY_RX_CNT_src.plan_name) AS plan_name, btrim(MS_MTHLY_RX_CNT_src.ndc_description) AS ndc_description, btrim(MS_MTHLY_RX_CNT_src.data_date) AS data_date, CASE WHEN (MS_MTHLY_RX_CNT_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_024))::numeric(9,3) END AS trx_024, MS_MTHLY_RX_CNT_src.batch_id, MS_MTHLY_RX_CNT_src.row_id, MS_MTHLY_RX_CNT_src.update_ts FROM teva_ingestion.MS_MTHLY_RX_CNT_src;

CREATE  VIEW teva_ingestion.MS_WKLY_RX_CNT AS
SELECT CASE WHEN (MS_WKLY_RX_CNT_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_WKLY_RX_CNT_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_report_num))::int END AS ims_report_num, btrim(MS_WKLY_RX_CNT_src.zip_other) AS zip_other, btrim(MS_WKLY_RX_CNT_src.ims_id) AS ims_id, btrim(MS_WKLY_RX_CNT_src.ndc) AS ndc, btrim(MS_WKLY_RX_CNT_src.plan_id) AS plan_id, CASE WHEN (MS_WKLY_RX_CNT_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.sales_category))::int END AS sales_category, btrim(MS_WKLY_RX_CNT_src.rx_type) AS rx_type, CASE WHEN (MS_WKLY_RX_CNT_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_WKLY_RX_CNT_src.filler_01) AS filler_01, btrim(MS_WKLY_RX_CNT_src.me_num) AS me_num, btrim(MS_WKLY_RX_CNT_src.last_name) AS last_name, btrim(MS_WKLY_RX_CNT_src.first_name) AS first_name, btrim(MS_WKLY_RX_CNT_src.middle_name) AS middle_name, btrim(MS_WKLY_RX_CNT_src.address) AS address, btrim(MS_WKLY_RX_CNT_src.city) AS city, btrim(MS_WKLY_RX_CNT_src.state) AS state, btrim(MS_WKLY_RX_CNT_src.zip) AS zip, btrim(MS_WKLY_RX_CNT_src.specialty) AS specialty, btrim(MS_WKLY_RX_CNT_src.plan_name) AS plan_name, btrim(MS_WKLY_RX_CNT_src.ndc_description) AS ndc_description, btrim(MS_WKLY_RX_CNT_src.data_date) AS data_date, CASE WHEN (MS_WKLY_RX_CNT_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (MS_WKLY_RX_CNT_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_WKLY_RX_CNT_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_WKLY_RX_CNT_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_WKLY_RX_CNT_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_WKLY_RX_CNT_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_WKLY_RX_CNT_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_WKLY_RX_CNT_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_WKLY_RX_CNT_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_WKLY_RX_CNT_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_WKLY_RX_CNT_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_WKLY_RX_CNT_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_WKLY_RX_CNT_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_WKLY_RX_CNT_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_WKLY_RX_CNT_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_WKLY_RX_CNT_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_WKLY_RX_CNT_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_WKLY_RX_CNT_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_WKLY_RX_CNT_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_WKLY_RX_CNT_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_WKLY_RX_CNT_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_WKLY_RX_CNT_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_WKLY_RX_CNT_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_WKLY_RX_CNT_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_WKLY_RX_CNT_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (MS_WKLY_RX_CNT_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (MS_WKLY_RX_CNT_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (MS_WKLY_RX_CNT_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (MS_WKLY_RX_CNT_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (MS_WKLY_RX_CNT_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (MS_WKLY_RX_CNT_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (MS_WKLY_RX_CNT_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (MS_WKLY_RX_CNT_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (MS_WKLY_RX_CNT_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (MS_WKLY_RX_CNT_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (MS_WKLY_RX_CNT_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (MS_WKLY_RX_CNT_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (MS_WKLY_RX_CNT_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (MS_WKLY_RX_CNT_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (MS_WKLY_RX_CNT_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (MS_WKLY_RX_CNT_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (MS_WKLY_RX_CNT_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (MS_WKLY_RX_CNT_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (MS_WKLY_RX_CNT_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (MS_WKLY_RX_CNT_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (MS_WKLY_RX_CNT_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (MS_WKLY_RX_CNT_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (MS_WKLY_RX_CNT_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (MS_WKLY_RX_CNT_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (MS_WKLY_RX_CNT_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (MS_WKLY_RX_CNT_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (MS_WKLY_RX_CNT_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (MS_WKLY_RX_CNT_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (MS_WKLY_RX_CNT_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (MS_WKLY_RX_CNT_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (MS_WKLY_RX_CNT_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (MS_WKLY_RX_CNT_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (MS_WKLY_RX_CNT_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (MS_WKLY_RX_CNT_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (MS_WKLY_RX_CNT_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (MS_WKLY_RX_CNT_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (MS_WKLY_RX_CNT_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (MS_WKLY_RX_CNT_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (MS_WKLY_RX_CNT_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (MS_WKLY_RX_CNT_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (MS_WKLY_RX_CNT_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (MS_WKLY_RX_CNT_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (MS_WKLY_RX_CNT_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (MS_WKLY_RX_CNT_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (MS_WKLY_RX_CNT_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (MS_WKLY_RX_CNT_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (MS_WKLY_RX_CNT_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (MS_WKLY_RX_CNT_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (MS_WKLY_RX_CNT_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (MS_WKLY_RX_CNT_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (MS_WKLY_RX_CNT_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (MS_WKLY_RX_CNT_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (MS_WKLY_RX_CNT_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (MS_WKLY_RX_CNT_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (MS_WKLY_RX_CNT_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (MS_WKLY_RX_CNT_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (MS_WKLY_RX_CNT_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (MS_WKLY_RX_CNT_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (MS_WKLY_RX_CNT_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (MS_WKLY_RX_CNT_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (MS_WKLY_RX_CNT_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (MS_WKLY_RX_CNT_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (MS_WKLY_RX_CNT_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (MS_WKLY_RX_CNT_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (MS_WKLY_RX_CNT_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (MS_WKLY_RX_CNT_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (MS_WKLY_RX_CNT_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (MS_WKLY_RX_CNT_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (MS_WKLY_RX_CNT_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (MS_WKLY_RX_CNT_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (MS_WKLY_RX_CNT_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (MS_WKLY_RX_CNT_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (MS_WKLY_RX_CNT_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (MS_WKLY_RX_CNT_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (MS_WKLY_RX_CNT_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (MS_WKLY_RX_CNT_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (MS_WKLY_RX_CNT_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (MS_WKLY_RX_CNT_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (MS_WKLY_RX_CNT_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (MS_WKLY_RX_CNT_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (MS_WKLY_RX_CNT_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (MS_WKLY_RX_CNT_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (MS_WKLY_RX_CNT_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (MS_WKLY_RX_CNT_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (MS_WKLY_RX_CNT_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (MS_WKLY_RX_CNT_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (MS_WKLY_RX_CNT_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (MS_WKLY_RX_CNT_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (MS_WKLY_RX_CNT_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (MS_WKLY_RX_CNT_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (MS_WKLY_RX_CNT_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (MS_WKLY_RX_CNT_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (MS_WKLY_RX_CNT_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (MS_WKLY_RX_CNT_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (MS_WKLY_RX_CNT_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (MS_WKLY_RX_CNT_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (MS_WKLY_RX_CNT_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (MS_WKLY_RX_CNT_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (MS_WKLY_RX_CNT_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (MS_WKLY_RX_CNT_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (MS_WKLY_RX_CNT_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (MS_WKLY_RX_CNT_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (MS_WKLY_RX_CNT_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (MS_WKLY_RX_CNT_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (MS_WKLY_RX_CNT_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (MS_WKLY_RX_CNT_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (MS_WKLY_RX_CNT_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (MS_WKLY_RX_CNT_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_132))::numeric(9,3) END AS trx_132, MS_WKLY_RX_CNT_src.batch_id, MS_WKLY_RX_CNT_src.row_id, MS_WKLY_RX_CNT_src.update_ts FROM teva_ingestion.MS_WKLY_RX_CNT_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_FTF_IMS_Monthly_Market_OBM_slow AS
((((SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'WAKE'::varchar(4)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'ICS'::varchar(3)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'SABA'::varchar(4)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'BDP NASAL'::varchar(9)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'ANTI-PARKINSON'::varchar(14)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'MULTIPLE SCLEROSIS'::varchar(18)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ValueCentricRxDataExtract AS
((SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN 'Nuvigil 50mg'::varchar(12) WHEN (x.product_code = '100N15'::varchar(6)) THEN 'Nuvigil 150mg'::varchar(13) WHEN (x.product_code = '100N25'::varchar(6)) THEN 'Nuvigil 250mg'::varchar(13) WHEN (x.product_code = '100N20'::varchar(6)) THEN 'Nuvigil 200mg'::varchar(13) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN '63459020530'::varchar(11) WHEN (x.product_code = '100N15'::varchar(6)) THEN '63459021530'::varchar(11) WHEN (x.product_code = '100N25'::varchar(6)) THEN '63459022530'::varchar(11) WHEN (x.product_code = '100N20'::varchar(6)) THEN '63459022030'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(x.trx_qty) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TC'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['100N05'::varchar(6), '100N15'::varchar(6), '100N25'::varchar(6), '100N20'::varchar(6)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN 'Nuvigil 50mg'::varchar(12) WHEN (x.product_code = '100N15'::varchar(6)) THEN 'Nuvigil 150mg'::varchar(13) WHEN (x.product_code = '100N25'::varchar(6)) THEN 'Nuvigil 250mg'::varchar(13) WHEN (x.product_code = '100N20'::varchar(6)) THEN 'Nuvigil 200mg'::varchar(13) ELSE NULL END, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN '63459020530'::varchar(11) WHEN (x.product_code = '100N15'::varchar(6)) THEN '63459021530'::varchar(11) WHEN (x.product_code = '100N25'::varchar(6)) THEN '63459022530'::varchar(11) WHEN (x.product_code = '100N20'::varchar(6)) THEN '63459022030'::varchar(11) ELSE NULL END, d.zip, x.month_ending UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN 'PROAIR HFA'::varchar(10) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN 'PROAIR HFA COUNTER'::varchar(18) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN 'QNASL'::varchar(5) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN 'QVAR 40MCG'::varchar(10) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN 'QVAR 80MCG'::varchar(10) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN '59310057920'::varchar(11) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN '59310057922'::varchar(11) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN '59310021012'::varchar(11) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN '59310020240'::varchar(11) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN '59310020480'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_w x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TR'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['330-14-002'::varchar(10), '330-14-009'::varchar(10), '330-15-001'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN 'PROAIR HFA'::varchar(10) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN 'PROAIR HFA COUNTER'::varchar(18) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN 'QNASL'::varchar(5) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN 'QVAR 40MCG'::varchar(10) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN 'QVAR 80MCG'::varchar(10) ELSE NULL END, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN '59310057920'::varchar(11) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN '59310057922'::varchar(11) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN '59310021012'::varchar(11) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN '59310020240'::varchar(11) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN '59310020480'::varchar(11) ELSE NULL END, d.zip, x.month_ending) UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN 'QUARTETTE'::varchar(9) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN '51285043165'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TW'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = '982-23-204'::varchar(10)) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN 'QUARTETTE'::varchar(9) ELSE NULL END, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN '51285043165'::varchar(11) ELSE NULL END, d.zip, x.month_ending) UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN 'COPAXONE 20mg'::varchar(13) WHEN (x.product_code = '600140'::varchar(6)) THEN 'COPAXONE 40mg'::varchar(13) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN '68546031730'::varchar(11) WHEN (x.product_code = '600140'::varchar(6)) THEN '68546032512'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TN'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['600120'::varchar(6), '600140'::varchar(6)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '600120'::varchar(6)) THEN 'COPAXONE 20mg'::varchar(13) WHEN (x.product_code = '600140'::varchar(6)) THEN 'COPAXONE 40mg'::varchar(13) ELSE NULL END, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN '68546031730'::varchar(11) WHEN (x.product_code = '600140'::varchar(6)) THEN '68546032512'::varchar(11) ELSE NULL END, d.zip, x.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_demo AS
SELECT substr(tsf.territory_vod__c, 1, 2) AS sales_force_id, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (acc.ID_VOD__C IS NULL) AND (acc.DESIGNATION_TVA__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS legacy_demo_type, replace(rta.NAME, '_vod'::varchar(4), ''::varchar) AS veeva_account_type, acc.TYPE AS veeva_business_type, acc.ID AS csf_demo_id, acc.CM_ID_TVA__C AS tvcmid, acc.ID_VOD__C AS ims_id, acc.ACCOUNT_MASTER_ID_TVA__C AS hms_id, substr(btrim(acc.ME__C), 1, 10) AS me_num, acc.NPI_VOD__C AS npi, addr.DEA_VOD__C AS dea_num, addr.DEA_EXPIRATION_DATE_VOD__C AS dea_expir_date, addr.DEA_SCHEDULE_VOD__C AS dea_drug_schedule, tsf.territory_vod__c AS territory_num, tsf.territory_status_tva__c AS territory_status, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN substr(acc.NAME, 1, 60) ELSE acc.LASTNAME END AS last_name, acc.FIRSTNAME AS first_name, acc.MIDDLE_VOD__C AS middle_name, acc.SUFFIX_TVA__C AS suffix_name, acc.CREDENTIALS_VOD__C AS credentials, acc.DESIGNATION_TVA__C AS designation, addr.NAME AS address1, addr.ADDRESS_LINE_2_VOD__C AS address2, addr.ADDRESS_LINE_3_TVA__C AS address3, addr.CITY_VOD__C AS city, addr.STATE_VOD__C AS state, addr.ZIP_VOD__C AS zip, acc.PHONE AS phone, CASE WHEN (addr.INACTIVE_VOD__C = 'false'::varchar(5)) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END AS address_status, acc.FAX AS fax, acc.CELL_PHONE_TVA__C AS cell_phone, acc.PERSONEMAIL AS email, CASE WHEN (acc.CML_PROFILED_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) WHEN (acc.CML_PROFILED_TVA__C = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS cml_profiled, acc.SPECIALTY_1_VOD__C AS prim_specialty, CASE WHEN (acc.NO_CONTACT_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) WHEN (acc.NO_CONTACT_TVA__C = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS no_contact, addr.LICENSE_VOD__C AS state_license_number, addr.STATE_VOD__C AS state_license_state, CASE WHEN (addr.LICENSE_VALID_TO_SAMPLE_VOD__C = 'Valid'::varchar(5)) THEN 'E'::varchar(1) ELSE 'I'::varchar(1) END AS state_license_elig_code, addr.LICENSE_EXPIRATION_DATE_VOD__C AS state_license_expir_date, substr(btrim(CASE WHEN ((btrim(acc.CREDENTIALS_VOD__C) IS NOT NULL) AND (btrim(addr.STATE_VOD__C) IS NOT NULL) AND (btrim(addr.LICENSE_VOD__C) IS NOT NULL)) THEN ((((btrim(acc.CREDENTIALS_VOD__C) || '-'::varchar(1)) || btrim(addr.STATE_VOD__C)) || '-'::varchar(1)) || btrim(addr.LICENSE_VOD__C)) ELSE NULL END), 1, 30) AS state_num, CASE WHEN (acc.NO_SPEND_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS no_spend, acc.DNC_CNS_TVA__C AS nuvigil_dnc, CASE WHEN (acc.NUVIGIL_APP_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS nuvigil_app, acc.DNC_PCS_TVA__C AS fentora_dnc, CASE WHEN (acc.FENTORA_APP_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS fentora_app, acc.TIRF_REMS_TVA__C AS fentora_rems_status, tsf.last_activity_date_vod__c AS sfa_last_call_date, acc.ID AS veeva_account_id, addr.ID AS veeva_address_id, 'Y'::varchar(1) AS ora_viewable_flag, acc.CREATEDDATE AS sfa_create_date, trunc(tsf.createddate, 'DD'::varchar(2)) AS sfa_align_date, (statement_timestamp())::timestamp AS last_build_date, CASE WHEN (NOT regexp_like(acc.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar)) THEN acc.EXTERNAL_ID_VOD__C ELSE NULL END AS siebel_contact_row_id, CASE WHEN regexp_like(acc.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar) THEN acc.EXTERNAL_ID_VOD__C ELSE NULL END AS bp_code, acc.OUTLET_ID_TVA__C AS ims_outlet_code, acc.PMO_GPO_ACCOUNT_AFFILIATIONS AS pmo_gpo_account_affiliations, tsf.synribo_target_tva__c AS onc_synribo_target, tsf.treanda_sbo_tva__c AS onc_treanda_sbo, tsf.trisenox_sbo_tva__c AS onc_trisenox_sbo, CASE WHEN (tsf.territory_vod__c ~~ 'TO%'::varchar(3)) THEN acc.TREANDA_LQ_TGT_TVA__C ELSE NULL END AS onc_treanda_target, acc.BUSINESS_ASSOCIATE_AGREEMENT AS business_associate_agreement, CASE WHEN (tsf.territory_vod__c ~~ 'TO%'::varchar(3)) THEN acc.TBO_FILGRASTIM_TARGET_TVA__C ELSE NULL END AS granix_indicator, acc.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acc JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acc.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acc.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN (SELECT x.id, x.isdeleted, x.name, x.recordtypeid, x.createddate, x.createdbyid, x.lastmodifieddate, x.lastmodifiedbyid, x.systemmodstamp, x.mayedit, x.islocked, x.account_vod__c, x.address_vod__c, x.last_activity_date_vod__c, x.my_target_vod__c, x.route_vod__c, x.mobile_id_vod__c, x.external_id_vod__c, x.territory_vod__c, x.ytd_activity_vod__c, x.preferred_account_vod__c, x.allowed_products_vod__c, x.territory_status_tva__c, x.territory_specialty_tva__c, x.treats_es_osa_tva__c, x.osa_patients_tva__c, x.account_status_tva__c, x.dea_number_tva__c, x.synribo_target_tva__c, x.treanda_sbo_tva__c, x.trisenox_sbo_tva__c, x.appt_index_tva__c, x.merged_mvn__c, x.call_plan_designation_tva__c, x.campaign_tva__c, x.rnk FROM (SELECT x.id, x.isdeleted, x.name, x.recordtypeid, x.createddate, x.createdbyid, x.lastmodifieddate, x.lastmodifiedbyid, x.systemmodstamp, x.mayedit, x.islocked, x.account_vod__c, x.address_vod__c, x.last_activity_date_vod__c, x.my_target_vod__c, x.route_vod__c, x.mobile_id_vod__c, x.external_id_vod__c, x.territory_vod__c, x.ytd_activity_vod__c, x.preferred_account_vod__c, x.allowed_products_vod__c, x.territory_status_tva__c, x.territory_specialty_tva__c, x.treats_es_osa_tva__c, x.osa_patients_tva__c, x.account_status_tva__c, x.dea_number_tva__c, x.synribo_target_tva__c, x.treanda_sbo_tva__c, x.trisenox_sbo_tva__c, x.appt_index_tva__c, x.merged_mvn__c, x.call_plan_designation_tva__c, x.campaign_tva__c, row_number() OVER (PARTITION BY x.account_vod__c, x.territory_vod__c ORDER BY x.createddate, x.lastmodifieddate, x.systemmodstamp, x.address_vod__c) AS rnk FROM WSMP_ADMIN.vv_tsf_vod__c x) x WHERE (x.rnk = 1)) tsf ON (((tsf.account_vod__c = acc.ID) AND (tsf.territory_vod__c = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acc.ID) AND (tsf.address_vod__c = addr.ID))));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product_terr AS
SELECT bt.TERRITORY_NUM AS territory_num, b.BAG_NAME AS bag_name, bp."POSITION" AS "position", bp.PRODUCT_NAME AS product_name FROM ((WSMP_ADMIN.BAG b JOIN WSMP_ADMIN.BAG_TERRITORY bt ON ((b.BAG_ID = bt.BAG_ID))) JOIN WSMP_ADMIN.BAG_PRODUCT bp ON ((b.BAG_ID = bp.BAG_ID))) WHERE ((b.VALID_FOR_TODAY = 'Y'::varchar(1)) AND (bt.VALID_FOR_TODAY = 'Y'::varchar(1)));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product_mgr AS
SELECT m.territory_num, (m.sales_force_id || 'MGR'::varchar(3)) AS bag_name, row_number() OVER (PARTITION BY m.territory_num ORDER BY p.product_name) AS "position", p.product_name FROM ((SELECT substr(i_bag_territory_product_terr.territory_num, 1, 2) AS sales_force_id, i_bag_territory_product_terr.product_name FROM WSMP_ADMIN.i_bag_territory_product_terr GROUP BY substr(i_bag_territory_product_terr.territory_num, 1, 2), i_bag_territory_product_terr.product_name) p JOIN (SELECT substr(i_bag_territory_product_terr.territory_num, 1, 2) AS sales_force_id, (substr(i_bag_territory_product_terr.territory_num, 1, 6) || '00'::varchar(2)) AS territory_num FROM WSMP_ADMIN.i_bag_territory_product_terr GROUP BY substr(i_bag_territory_product_terr.territory_num, 1, 2), (substr(i_bag_territory_product_terr.territory_num, 1, 6) || '00'::varchar(2))) m ON ((p.sales_force_id = m.sales_force_id)));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product AS
SELECT i_bag_territory_product_terr.territory_num, i_bag_territory_product_terr.bag_name, i_bag_territory_product_terr."position", i_bag_territory_product_terr.product_name FROM WSMP_ADMIN.i_bag_territory_product_terr UNION SELECT i_bag_territory_product_mgr.territory_num, i_bag_territory_product_mgr.bag_name, i_bag_territory_product_mgr."position", i_bag_territory_product_mgr.product_name FROM WSMP_ADMIN.i_bag_territory_product_mgr;

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TC AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TC_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        CASE WHEN (EXT_ZS_CALL_PLAN_TC_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TC_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TC_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TC_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TC_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TC_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TC_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TC_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TC_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TC_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TC_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TC_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ZS_CALL_PLAN_TC_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TC_src.P1))::int END AS P1,
        CASE WHEN (EXT_ZS_CALL_PLAN_TC_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TC_src.P2))::int END AS P2,
        CASE WHEN (EXT_ZS_CALL_PLAN_TC_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TC_src.P3))::int END AS P3,
        btrim(EXT_ZS_CALL_PLAN_TC_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TC_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TC_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TC_src.batch_id,
        EXT_ZS_CALL_PLAN_TC_src.row_id,
        EXT_ZS_CALL_PLAN_TC_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TC_src
 WHERE (EXT_ZS_CALL_PLAN_TC_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ZS_CALL_PLAN_TC'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TN AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TN_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        CASE WHEN (EXT_ZS_CALL_PLAN_TN_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TN_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TN_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TN_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TN_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TN_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TN_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TN_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TN_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TN_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TN_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TN_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ZS_CALL_PLAN_TN_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TN_src.P1))::int END AS P1,
        CASE WHEN (EXT_ZS_CALL_PLAN_TN_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TN_src.P2))::int END AS P2,
        CASE WHEN (EXT_ZS_CALL_PLAN_TN_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TN_src.P3))::int END AS P3,
        btrim(EXT_ZS_CALL_PLAN_TN_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TN_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TN_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TN_src.batch_id,
        EXT_ZS_CALL_PLAN_TN_src.row_id,
        EXT_ZS_CALL_PLAN_TN_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TN_src
 WHERE (EXT_ZS_CALL_PLAN_TN_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ZS_CALL_PLAN_TN'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TP AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TP_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        CASE WHEN (EXT_ZS_CALL_PLAN_TP_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TP_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TP_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TP_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TP_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TP_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TP_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TP_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TP_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TP_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TP_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TP_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ZS_CALL_PLAN_TP_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TP_src.P1))::int END AS P1,
        CASE WHEN (EXT_ZS_CALL_PLAN_TP_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TP_src.P2))::int END AS P2,
        CASE WHEN (EXT_ZS_CALL_PLAN_TP_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TP_src.P3))::int END AS P3,
        btrim(EXT_ZS_CALL_PLAN_TP_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TP_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TP_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TP_src.batch_id,
        EXT_ZS_CALL_PLAN_TP_src.row_id,
        EXT_ZS_CALL_PLAN_TP_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TP_src
 WHERE (EXT_ZS_CALL_PLAN_TP_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ZS_CALL_PLAN_TP'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TR AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TR_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        CASE WHEN (EXT_ZS_CALL_PLAN_TR_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TR_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TR_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TR_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TR_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TR_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TR_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TR_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TR_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TR_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TR_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TR_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ZS_CALL_PLAN_TR_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TR_src.P1))::int END AS P1,
        CASE WHEN (EXT_ZS_CALL_PLAN_TR_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TR_src.P2))::int END AS P2,
        CASE WHEN (EXT_ZS_CALL_PLAN_TR_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TR_src.P3))::int END AS P3,
        btrim(EXT_ZS_CALL_PLAN_TR_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TR_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TR_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TR_src.batch_id,
        EXT_ZS_CALL_PLAN_TR_src.row_id,
        EXT_ZS_CALL_PLAN_TR_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TR_src
 WHERE (EXT_ZS_CALL_PLAN_TR_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ZS_CALL_PLAN_TR'::varchar(19))));

CREATE  VIEW teva_ingestion.EXT_ZS_CALL_PLAN_TW AS
 SELECT btrim(EXT_ZS_CALL_PLAN_TW_src.VEEVA_ACCOUNT_ID) AS VEEVA_ACCOUNT_ID,
        CASE WHEN (EXT_ZS_CALL_PLAN_TW_src.TVCMID = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TW_src.TVCMID))::int END AS TVCMID,
        btrim(EXT_ZS_CALL_PLAN_TW_src.IMS_ID) AS IMS_ID,
        btrim(EXT_ZS_CALL_PLAN_TW_src.FIRST_NAME) AS FIRST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TW_src.LAST_NAME) AS LAST_NAME,
        btrim(EXT_ZS_CALL_PLAN_TW_src.SPECIALTY) AS SPECIALTY,
        btrim(EXT_ZS_CALL_PLAN_TW_src.TERRITORY_NUM) AS TERRITORY_NUM,
        btrim(EXT_ZS_CALL_PLAN_TW_src.ADDRESS) AS ADDRESS,
        btrim(EXT_ZS_CALL_PLAN_TW_src.CITY) AS CITY,
        btrim(EXT_ZS_CALL_PLAN_TW_src.STATE) AS STATE,
        btrim(EXT_ZS_CALL_PLAN_TW_src.ZIP) AS ZIP,
        btrim(EXT_ZS_CALL_PLAN_TW_src.PRODUCT_NAME) AS PRODUCT_NAME,
        CASE WHEN (EXT_ZS_CALL_PLAN_TW_src.P1 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TW_src.P1))::int END AS P1,
        CASE WHEN (EXT_ZS_CALL_PLAN_TW_src.P2 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TW_src.P2))::int END AS P2,
        CASE WHEN (EXT_ZS_CALL_PLAN_TW_src.P3 = ''::varchar) THEN NULL::int ELSE (btrim(EXT_ZS_CALL_PLAN_TW_src.P3))::int END AS P3,
        btrim(EXT_ZS_CALL_PLAN_TW_src.TARGET) AS TARGET,
        btrim(EXT_ZS_CALL_PLAN_TW_src.SALES_FORCE_ID) AS SALES_FORCE_ID,
        btrim(EXT_ZS_CALL_PLAN_TW_src.PERIOD) AS PERIOD,
        EXT_ZS_CALL_PLAN_TW_src.batch_id,
        EXT_ZS_CALL_PLAN_TW_src.row_id,
        EXT_ZS_CALL_PLAN_TW_src.update_ts
 FROM teva_ingestion.EXT_ZS_CALL_PLAN_TW_src
 WHERE (EXT_ZS_CALL_PLAN_TW_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_ZS_CALL_PLAN_TW'::varchar(19))));

CREATE  VIEW raw.ext_zs_call_plan_tc AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TC_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TC'::varchar(19)))));

CREATE  VIEW raw.ext_zs_call_plan_tn AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TN_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TN'::varchar(19)))));

CREATE  VIEW raw.ext_zs_call_plan_tp AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TP'::varchar(19)))));

CREATE  VIEW raw.ext_zs_call_plan_tr AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TR_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TR'::varchar(19)))));

CREATE  VIEW raw.ext_zs_call_plan_tw AS
 SELECT src.VEEVA_ACCOUNT_ID,
        src.TVCMID,
        src.IMS_ID,
        src.FIRST_NAME,
        src.LAST_NAME,
        src.SPECIALTY,
        src.TERRITORY_NUM,
        src.ADDRESS,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.PRODUCT_NAME,
        src.P1,
        src.P2,
        src.P3,
        src.TARGET,
        src.SALES_FORCE_ID,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ZS_CALL_PLAN_TW_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ZS_CALL_PLAN_TW'::varchar(19)))));

CREATE  VIEW teva_ingestion.EXT_DDD_445_CALENDAR AS
 SELECT btrim(EXT_DDD_445_CALENDAR_src.START_DATE) AS START_DATE,
        btrim(EXT_DDD_445_CALENDAR_src.END_DATE) AS END_DATE,
        btrim(EXT_DDD_445_CALENDAR_src.PERIOD) AS PERIOD,
        EXT_DDD_445_CALENDAR_src.batch_id,
        EXT_DDD_445_CALENDAR_src.row_id,
        EXT_DDD_445_CALENDAR_src.update_ts
 FROM teva_ingestion.EXT_DDD_445_CALENDAR_src
 WHERE (EXT_DDD_445_CALENDAR_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'EXT_DDD_445_CALENDAR'::varchar(20))));

CREATE  VIEW raw.ext_ddd_445_calendar AS
 SELECT src.START_DATE,
        src.END_DATE,
        src.PERIOD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DDD_445_CALENDAR_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DDD_445_CALENDAR'::varchar(20)))));

CREATE  VIEW teva_ingestion.tvcmid_hcp_demo AS
 SELECT CASE WHEN (tvcmid_hcp_demo_src.TVCMID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_hcp_demo_src.TVCMID))::numeric(38,0) END AS TVCMID,
        CASE WHEN (tvcmid_hcp_demo_src.IMS_HCE_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_hcp_demo_src.IMS_HCE_ID))::numeric(38,0) END AS IMS_HCE_ID,
        btrim(tvcmid_hcp_demo_src.IMS_ID) AS IMS_ID,
        btrim(tvcmid_hcp_demo_src.NPI) AS NPI,
        btrim(tvcmid_hcp_demo_src.LAST_NAME) AS LAST_NAME,
        btrim(tvcmid_hcp_demo_src.FIRST_NAME) AS FIRST_NAME,
        btrim(tvcmid_hcp_demo_src.MIDDLE_NAME) AS MIDDLE_NAME,
        btrim(tvcmid_hcp_demo_src.PERSONAL_SUFFIX) AS PERSONAL_SUFFIX,
        btrim(tvcmid_hcp_demo_src.MEDICAL_SUFFIX) AS MEDICAL_SUFFIX,
        btrim(tvcmid_hcp_demo_src.PRIMARY_SPECIALTY) AS PRIMARY_SPECIALTY,
        btrim(tvcmid_hcp_demo_src.ADDRESS_LINE1) AS ADDRESS_LINE1,
        btrim(tvcmid_hcp_demo_src.ADDRESS_LINE2) AS ADDRESS_LINE2,
        btrim(tvcmid_hcp_demo_src.CITY) AS CITY,
        btrim(tvcmid_hcp_demo_src.STATE) AS STATE,
        btrim(tvcmid_hcp_demo_src.ZIP) AS ZIP,
        btrim((tvcmid_hcp_demo_src.C_BO_HCE_ADDRESS__ADDRESS_ID)::varchar(14)) AS C_BO_HCE_ADDRESS__ADDRESS_ID,
        CASE WHEN (tvcmid_hcp_demo_src.LEGACY_ADDRESS_ID = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(tvcmid_hcp_demo_src.LEGACY_ADDRESS_ID))::numeric(38,0) END AS LEGACY_ADDRESS_ID,
        btrim(tvcmid_hcp_demo_src.BUSINESS_PHONE) AS BUSINESS_PHONE,
        btrim(tvcmid_hcp_demo_src.BUSINESS_EMAIL) AS BUSINESS_EMAIL,
        btrim(tvcmid_hcp_demo_src.HCE_STATUS_DESC) AS HCE_STATUS_DESC,
        btrim(tvcmid_hcp_demo_src.NP_PA_FLAG) AS NP_PA_FLAG,
        tvcmid_hcp_demo_src.batch_id,
        tvcmid_hcp_demo_src.row_id,
        tvcmid_hcp_demo_src.update_ts
 FROM teva_ingestion.tvcmid_hcp_demo_src
 WHERE (tvcmid_hcp_demo_src.batch_id = ( SELECT max(teva_ingestion_control.batch_id) AS max
 FROM teva_ingestion.teva_ingestion_control
 WHERE (teva_ingestion_control.file_class = 'TVCMID_HCP_DEMO'::varchar(15))));

CREATE  VIEW raw.tvcmid_hcp_demo AS
 SELECT src.TVCMID,
        src.IMS_HCE_ID,
        src.IMS_ID,
        src.NPI,
        src.LAST_NAME,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.PERSONAL_SUFFIX,
        src.MEDICAL_SUFFIX,
        src.PRIMARY_SPECIALTY,
        src.ADDRESS_LINE1,
        src.ADDRESS_LINE2,
        src.CITY,
        src.STATE,
        src.ZIP,
        src.C_BO_HCE_ADDRESS__ADDRESS_ID,
        src.LEGACY_ADDRESS_ID,
        src.BUSINESS_PHONE,
        src.BUSINESS_EMAIL,
        src.HCE_STATUS_DESC,
        src.NP_PA_FLAG,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.tvcmid_hcp_demo_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'TVCMID_HCP_DEMO'::varchar(15)))));

CREATE  VIEW raw.ext_onc_manual_fcrs AS
 SELECT src.TIME_PERIOD,
        src.SALES_FORCE_ID,
        src.TERRITORY_NUM,
        src.REP_ID,
        src.CONTACT_DATE,
        (src.DURATION_DAYS)::numeric(3,2) AS DURATION_DAYS,
        src.SS_OPENING,
        src.SS_PROBING,
        src.SS_RESOURCES,
        src.SS_COMMITMENT,
        src.SS_TRANSITIONING,
        src.SS_ACUMEN,
        src.ARCHIVE_FLAG,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_ONC_MANUAL_FCRS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_ONC_MANUAL_FCRS'::varchar(19)))));

CREATE  VIEW metadata.datamart_table_counts AS
SELECT A.datamart_table, A.counts FROM (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((SELECT 'datamart.activity_hub'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.activity_hub GROUP BY 'datamart.activity_hub'::varchar(21) UNION ALL SELECT 'datamart.affiliations'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.affiliations GROUP BY 'datamart.affiliations'::varchar(21)) UNION ALL SELECT 'datamart.alternate_alignments'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.alternate_alignments GROUP BY 'datamart.alternate_alignments'::varchar(29)) UNION ALL SELECT 'datamart.alternate_call_plans'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.alternate_call_plans GROUP BY 'datamart.alternate_call_plans'::varchar(29)) UNION ALL SELECT 'datamart.call_plan'::varchar(18) AS datamart_table, count(*) AS counts FROM datamart.call_plan GROUP BY 'datamart.call_plan'::varchar(18)) UNION ALL SELECT 'datamart.chargeback_demographics'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.chargeback_demographics GROUP BY 'datamart.chargeback_demographics'::varchar(32)) UNION ALL SELECT 'datamart.chargebacks'::varchar(20) AS datamart_table, count(*) AS counts FROM datamart.chargebacks GROUP BY 'datamart.chargebacks'::varchar(20)) UNION ALL SELECT 'datamart.clozapine_sales'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.clozapine_sales GROUP BY 'datamart.clozapine_sales'::varchar(24)) UNION ALL SELECT 'datamart.cmop_rx'::varchar(16) AS datamart_table, count(*) AS counts FROM datamart.cmop_rx GROUP BY 'datamart.cmop_rx'::varchar(16)) UNION ALL SELECT 'datamart.copay'::varchar(14) AS datamart_table, count(*) AS counts FROM datamart.copay GROUP BY 'datamart.copay'::varchar(14)) UNION ALL SELECT 'datamart.current_alignment'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.current_alignment GROUP BY 'datamart.current_alignment'::varchar(26)) UNION ALL SELECT 'datamart.customer_hco_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.customer_hco_demographics GROUP BY 'datamart.customer_hco_demographics'::varchar(34)) UNION ALL SELECT 'datamart.customer_hcp_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.customer_hcp_demographics GROUP BY 'datamart.customer_hcp_demographics'::varchar(34)) UNION ALL SELECT 'datamart.customer_level_flags'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.customer_level_flags GROUP BY 'datamart.customer_level_flags'::varchar(29)) UNION ALL SELECT 'datamart.ddd'::varchar(12) AS datamart_table, count(*) AS counts FROM datamart.ddd GROUP BY 'datamart.ddd'::varchar(12)) UNION ALL SELECT 'datamart.ddd_md'::varchar(15) AS datamart_table, count(*) AS counts FROM datamart.ddd_md GROUP BY 'datamart.ddd_md'::varchar(15)) UNION ALL SELECT 'datamart.digital_sales_aid_analysis'::varchar(35) AS datamart_table, count(*) AS counts FROM datamart.digital_sales_aid_analysis GROUP BY 'datamart.digital_sales_aid_analysis'::varchar(35)) UNION ALL SELECT 'datamart.direct_sales'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.direct_sales GROUP BY 'datamart.direct_sales'::varchar(21)) UNION ALL SELECT 'datamart.direct_sales_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.direct_sales_demographics GROUP BY 'datamart.direct_sales_demographics'::varchar(34)) UNION ALL SELECT 'datamart.dnc'::varchar(12) AS datamart_table, count(*) AS counts FROM datamart.dnc GROUP BY 'datamart.dnc'::varchar(12)) UNION ALL SELECT 'datamart.do_not_promote'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.do_not_promote GROUP BY 'datamart.do_not_promote'::varchar(23)) UNION ALL SELECT 'datamart.event'::varchar(14) AS datamart_table, count(*) AS counts FROM datamart.event GROUP BY 'datamart.event'::varchar(14)) UNION ALL SELECT 'datamart.event_attendee'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.event_attendee GROUP BY 'datamart.event_attendee'::varchar(23)) UNION ALL SELECT 'datamart.event_attendee_count'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.event_attendee_count GROUP BY 'datamart.event_attendee_count'::varchar(29)) UNION ALL SELECT 'datamart.event_expense'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.event_expense GROUP BY 'datamart.event_expense'::varchar(22)) UNION ALL SELECT 'datamart.factory_sales_852'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.factory_sales_852 GROUP BY 'datamart.factory_sales_852'::varchar(26)) UNION ALL SELECT 'datamart.formulary'::varchar(18) AS datamart_table, count(*) AS counts FROM datamart.formulary GROUP BY 'datamart.formulary'::varchar(18)) UNION ALL SELECT 'datamart.ic_demographics_semi_annual_frozen_snapshot'::varchar(52) AS datamart_table, count(*) AS counts FROM datamart.ic_demographics_semi_annual_frozen_snapshot GROUP BY 'datamart.ic_demographics_semi_annual_frozen_snapshot'::varchar(52)) UNION ALL SELECT 'datamart.ic_demographics_snapshot'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.ic_demographics_snapshot GROUP BY 'datamart.ic_demographics_snapshot'::varchar(33)) UNION ALL SELECT 'datamart.ims_outlet_master'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.ims_outlet_master GROUP BY 'datamart.ims_outlet_master'::varchar(26)) UNION ALL SELECT 'datamart.leave_of_absence'::varchar(25) AS datamart_table, count(*) AS counts FROM datamart.leave_of_absence GROUP BY 'datamart.leave_of_absence'::varchar(25)) UNION ALL SELECT 'datamart.mm_ram_to_rsm'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.mm_ram_to_rsm GROUP BY 'datamart.mm_ram_to_rsm'::varchar(22)) UNION ALL SELECT 'datamart.oncology_adjusted_sales'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.oncology_adjusted_sales GROUP BY 'datamart.oncology_adjusted_sales'::varchar(32)) UNION ALL SELECT 'datamart.oncology_demographics'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.oncology_demographics GROUP BY 'datamart.oncology_demographics'::varchar(30)) UNION ALL SELECT 'datamart.oncology_fcr'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.oncology_fcr GROUP BY 'datamart.oncology_fcr'::varchar(21)) UNION ALL SELECT 'datamart.oncology_related_accounts'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.oncology_related_accounts GROUP BY 'datamart.oncology_related_accounts'::varchar(34)) UNION ALL SELECT 'datamart.oncology_sales_adjustments'::varchar(35) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_adjustments GROUP BY 'datamart.oncology_sales_adjustments'::varchar(35)) UNION ALL SELECT 'datamart.oncology_sales_deciles'::varchar(31) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_deciles GROUP BY 'datamart.oncology_sales_deciles'::varchar(31)) UNION ALL SELECT 'datamart.oncology_sales_quotas'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_quotas GROUP BY 'datamart.oncology_sales_quotas'::varchar(30)) UNION ALL SELECT 'datamart.oncology_target_accounts'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.oncology_target_accounts GROUP BY 'datamart.oncology_target_accounts'::varchar(33)) UNION ALL SELECT 'datamart.plantrak_workbook'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.plantrak_workbook GROUP BY 'datamart.plantrak_workbook'::varchar(26)) UNION ALL SELECT 'datamart.prescriber_combined_demographics'::varchar(41) AS datamart_table, count(*) AS counts FROM datamart.prescriber_combined_demographics GROUP BY 'datamart.prescriber_combined_demographics'::varchar(41)) UNION ALL SELECT 'datamart.prescriber_rx'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.prescriber_rx GROUP BY 'datamart.prescriber_rx'::varchar(22)) UNION ALL SELECT 'datamart.product_basket'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.product_basket GROUP BY 'datamart.product_basket'::varchar(23)) UNION ALL SELECT 'datamart.rems_pharmacy'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.rems_pharmacy GROUP BY 'datamart.rems_pharmacy'::varchar(22)) UNION ALL SELECT 'datamart.rems_prescriber'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.rems_prescriber GROUP BY 'datamart.rems_prescriber'::varchar(24)) UNION ALL SELECT 'datamart.roster'::varchar(15) AS datamart_table, count(*) AS counts FROM datamart.roster GROUP BY 'datamart.roster'::varchar(15)) UNION ALL SELECT 'datamart.rx_deciles'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.rx_deciles GROUP BY 'datamart.rx_deciles'::varchar(19)) UNION ALL SELECT 'datamart.sample_shipment'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.sample_shipment GROUP BY 'datamart.sample_shipment'::varchar(24)) UNION ALL SELECT 'datamart.sfa_call'::varchar(17) AS datamart_table, count(*) AS counts FROM datamart.sfa_call GROUP BY 'datamart.sfa_call'::varchar(17)) UNION ALL SELECT 'datamart.sfa_call_detail'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.sfa_call_detail GROUP BY 'datamart.sfa_call_detail'::varchar(24)) UNION ALL SELECT 'datamart.sfa_demographics'::varchar(25) AS datamart_table, count(*) AS counts FROM datamart.sfa_demographics GROUP BY 'datamart.sfa_demographics'::varchar(25)) UNION ALL SELECT 'datamart.sfa_promotional_items'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.sfa_promotional_items GROUP BY 'datamart.sfa_promotional_items'::varchar(30)) UNION ALL SELECT 'datamart.sfa_reprints'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.sfa_reprints GROUP BY 'datamart.sfa_reprints'::varchar(21)) UNION ALL SELECT 'datamart.sfa_sample'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.sfa_sample GROUP BY 'datamart.sfa_sample'::varchar(19)) UNION ALL SELECT 'datamart.sfa_survey'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.sfa_survey GROUP BY 'datamart.sfa_survey'::varchar(19)) UNION ALL SELECT 'datamart.specialty_pharmacy_enrollment'::varchar(38) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_enrollment GROUP BY 'datamart.specialty_pharmacy_enrollment'::varchar(38)) UNION ALL SELECT 'datamart.specialty_pharmacy_rx'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_rx GROUP BY 'datamart.specialty_pharmacy_rx'::varchar(30)) UNION ALL SELECT 'datamart.specialty_pharmacy_shipment'::varchar(36) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_shipment GROUP BY 'datamart.specialty_pharmacy_shipment'::varchar(36)) UNION ALL SELECT 'datamart.territory_history'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.territory_history GROUP BY 'datamart.territory_history'::varchar(26)) UNION ALL SELECT 'datamart.time_off_territory'::varchar(27) AS datamart_table, count(*) AS counts FROM datamart.time_off_territory GROUP BY 'datamart.time_off_territory'::varchar(27)) UNION ALL SELECT 'datamart.touchpoint_call'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.touchpoint_call GROUP BY 'datamart.touchpoint_call'::varchar(24)) UNION ALL SELECT 'datamart.touchpoint_presentation'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.touchpoint_presentation GROUP BY 'datamart.touchpoint_presentation'::varchar(32)) UNION ALL SELECT 'datamart.tvcmid_xref'::varchar(20) AS datamart_table, count(*) AS counts FROM datamart.tvcmid_xref GROUP BY 'datamart.tvcmid_xref'::varchar(20)) UNION ALL SELECT 'datamart.tw_account'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.tw_account GROUP BY 'datamart.tw_account'::varchar(19)) UNION ALL SELECT 'datamart.tw_address'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.tw_address GROUP BY 'datamart.tw_address'::varchar(19)) UNION ALL SELECT 'datamart.tw_address_xref'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.tw_address_xref GROUP BY 'datamart.tw_address_xref'::varchar(24)) UNION ALL SELECT 'datamart.unmatched_caremark_md_id'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.unmatched_caremark_md_id GROUP BY 'datamart.unmatched_caremark_md_id'::varchar(33)) UNION ALL SELECT 'datamart.veeva_sync'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.veeva_sync GROUP BY 'datamart.veeva_sync'::varchar(19)) UNION ALL SELECT 'datamart.wholesaler_sales_867'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.wholesaler_sales_867 GROUP BY 'datamart.wholesaler_sales_867'::varchar(29)) A;

CREATE  VIEW sfa_history.v_siebel_samples_account_calls AS
 SELECT rep_p.X_SALES_FORCE AS sales_force_id,
        ea.PAR_EVT_ID AS par_evt_id,
        ea.ROW_ID AS csf_call_id,
        ea.TARGET_PER_ID AS csf_demo_id,
        'ACCT'::varchar(4) AS call_type,
        ea.NAME AS name_on_call,
        ea.ZIPCODE AS zip_on_call,
        ea.SUBTYPE_CD AS subtype_cd,
        ea.TODO_CD AS todo_cd,
        ea.INTEGRATION_ID AS integration_id,
        ea.ROW_ID AS siebel_evt_act_row_id,
        ea.TARGET_PER_ID AS siebel_target_per_id,
        emp.CSN AS rep_id,
        rep_p.NAME AS territory_num,
        trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date,
        details.product_name,
        details.lot_num,
        details.qty,
        details.relation_type_cd,
        o.OU_TYPE_CD AS ou_type_cd,
        CASE WHEN (length(emp.INTEGRATION_ID) = 18) THEN emp.INTEGRATION_ID ELSE NULL END AS veeva_account_id
 FROM ((((sfa_history.s_evt_act ea LEFT  JOIN sfa_history.s_postn rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT  JOIN sfa_history.s_org_ext o ON ((o.ROW_ID = rep_p.BU_ID))) LEFT  JOIN sfa_history.s_contact emp ON ((emp.ROW_ID = ea.TARGET_PER_ID))) JOIN ( SELECT appl.ACTIVITY_ID AS activity_id,
        upper(spi.NAME) AS product_name,
        appl.LOT_NUM AS lot_num,
        appl.QTY AS qty,
        appl.RELATION_TYPE_CD AS relation_type_cd
 FROM (sfa_history.s_act_prdint appl JOIN sfa_history.s_prod_int spi ON ((appl.PRDINT_ID = spi.ROW_ID)))
 WHERE ((appl.CONFLICT_ID = '0'::varchar(1)) AND (appl.RELATION_TYPE_CD = ANY (ARRAY['DirectSend'::varchar(10), 'Sample'::varchar(6)])))) details ON ((details.activity_id = ea.ROW_ID)))
 WHERE ((rep_p.NAME <> ALL (ARRAY['Siebel Administrator'::varchar(24), 'TWH Siebel Administrator'::varchar(24)])) AND (o.NAME <> ALL (ARRAY['Siebel Administration'::varchar(21), 'ERM AnonUser'::varchar(12), 'Default Organization'::varchar(20)])) AND (coalesce(o.OU_TYPE_CD, 'XXX'::varchar(3)) <> 'Manufacturer'::varchar(12)));

CREATE  VIEW sfa_history.v_siebel_demo AS
 SELECT c.ROW_ID AS csf_demo_id,
        p.X_SALES_FORCE AS sales_force_id,
        'PROF'::varchar(4) AS demo_type,
        x.ATTRIB_03 AS ims_id,
        x.X_ATTRIB_50 AS hms_id,
        substr(btrim(x.ATTRIB_36), 1, 10) AS me_num,
        ca.DEA_NUM AS dea_num,
        ca.DEA_EXPR_DT AS dea_expir_date,
        substr(ca.X_ATTRIB_03, 1, 12) AS dea_drug_schedule,
        p.NAME AS territory_num,
        'N'::varchar(1) AS house_acct_flag,
        'A'::varchar(1) AS src_verification_status,
        c.LAST_NAME AS last_name,
        c.FST_NAME AS first_name,
        c.MID_NAME AS middle_name,
        c.PER_TITLE_SUFFIX AS suffix_name,
        fnx.CRRPT_FMT_CD AS degree,
        substr(btrim(ap.ADDR), 1, 75) AS address1,
        substr(btrim(ap.ADDR_LINE_2), 1, 75) AS address2,
        substr(btrim(ap.ADDR_LINE_3), 1, 75) AS address3,
        ap.CITY AS city,
        ap.STATE AS state,
        ap.ZIPCODE AS zip,
        c.WORK_PH_NUM AS phone,
        c.FAX_PH_NUM AS fax,
        c.CELL_PH_NUM AS mobile,
        c.EMAIL_ADDR AS email,
        ms.NAME AS prim_specialty,
        substr(btrim(l.LICENSE_NUM), 1, 20) AS state_license_number,
        l.STATE_CD AS state_license_state,
        CASE WHEN (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1)) THEN 'E'::varchar(1) ELSE 'I'::varchar(1) END AS state_license_elig_code,
        l.LICENSE_EXP_DT AS state_license_expir_date,
        substr(btrim(CASE WHEN ((btrim(fnx.CRRPT_FMT_CD) IS NOT NULL) AND (btrim(l.STATE_CD) IS NOT NULL) AND (btrim(l.LICENSE_NUM) IS NOT NULL)) THEN ((((btrim(fnx.CRRPT_FMT_CD) || '-'::varchar(1)) || btrim(l.STATE_CD)) || '-'::varchar(1)) || btrim(l.LICENSE_NUM)) ELSE NULL END), 1, 30) AS state_num,
        l.X_VALIDATION_DT AS sln_validation_date,
        CASE WHEN ((l.X_VALIDATION_DT IS NOT NULL) AND (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1))) THEN 'MedPro'::varchar(6) ELSE NULL END AS sln_validation_source,
        x.ATTRIB_09 AS no_spend,
        pc.X_ATTRIB_11 AS treats_es,
        CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_58 ELSE NULL END AS nuvigil_dnc,
        CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_83 ELSE NULL::"char" END AS nuvigil_rems_pb,
        CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN substr(x.X_ATTRIB_73, 1, 1) ELSE NULL END AS nuvigil_app,
        CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_72 ELSE NULL END AS fentora_dnc,
        CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_71 ELSE NULL::"char" END AS fentora_app,
        CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.ATTRIB_42 ELSE NULL END AS fentora_rems_status,
        pc.LAST_CALL_DT AS sfa_last_call_date,
        coalesce(cm2.CM_ID, cm1.CM_ID) AS cm_id,
        c.ROW_ID AS sfa_history_contact_row_id,
        ap.ROW_ID AS sfa_history_addr_per_row_id,
        'Y'::varchar(1) AS ora_viewable_flag,
        c.CREATED AS sfa_create_date,
        (statement_timestamp())::timestamp AS last_build_date,
        NULL AS ceph_id,
        CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id,
        pc.STATUS AS territory_status
 FROM (((((((((((sfa_history.s_contact c JOIN sfa_history.s_postn_con pc ON ((pc.CON_ID = c.ROW_ID))) JOIN sfa_history.s_postn p ON ((pc.POSTN_ID = p.ROW_ID))) JOIN sfa_history.s_org_ext o ON ((p.BU_ID = o.ROW_ID))) LEFT  JOIN sfa_history.s_contact_x x ON ((x.ROW_ID = c.ROW_ID))) LEFT  JOIN sfa_history.s_contact_fnx fnx ON ((fnx.ROW_ID = c.ROW_ID))) LEFT  JOIN sfa_history.s_addr_per ap ON ((ap.ROW_ID = pc.PR_ADDR_ID))) LEFT  JOIN sfa_history.s_med_spec ms ON ((ms.ROW_ID = c.MED_SPEC_ID))) LEFT  JOIN ( SELECT iq.ROW_ID,
        iq.CREATED,
        iq.CREATED_BY,
        iq.LAST_UPD,
        iq.LAST_UPD_BY,
        iq.MODIFICATION_NUM,
        iq.CONFLICT_ID,
        iq.ACTIVE_FLG,
        iq.ADDR_PER_ID,
        iq.BL_ADDR_FLG,
        iq.FRAUD_FLG,
        iq.MAIN_ADDR_FLG,
        iq.RELATION_TYPE_CD,
        iq.SHIP_ADDR_FLG,
        iq.DEA_EXPR_DT,
        iq.END_DT,
        iq.FRI_1ST_CLOSE_TM,
        iq.FRI_1ST_OPEN_TM,
        iq.FRI_2ND_CLOSE_TM,
        iq.FRI_2ND_OPEN_TM,
        iq.MON_1ST_CLOSE_TM,
        iq.MON_1ST_OPEN_TM,
        iq.MON_2ND_CLOSE_TM,
        iq.MON_2ND_OPEN_TM,
        iq.NUM_MONTHS_AT_ADDR,
        iq.SAT_1ST_CLOSE_TM,
        iq.SAT_1ST_OPEN_TM,
        iq.SAT_2ND_CLOSE_TM,
        iq.SAT_2ND_OPEN_TM,
        iq.START_DT,
        iq.SUN_1ST_CLOSE_TM,
        iq.SUN_1ST_OPEN_TM,
        iq.SUN_2ND_CLOSE_TM,
        iq.SUN_2ND_OPEN_TM,
        iq.THU_1ST_CLOSE_TM,
        iq.THU_1ST_OPEN_TM,
        iq.THU_2ND_CLOSE_TM,
        iq.THU_2ND_OPEN_TM,
        iq.TUE_1ST_CLOSE_TM,
        iq.TUE_1ST_OPEN_TM,
        iq.TUE_2ND_CLOSE_TM,
        iq.TUE_2ND_OPEN_TM,
        iq.WED_1ST_CLOSE_TM,
        iq.WED_1ST_OPEN_TM,
        iq.WED_2ND_CLOSE_TM,
        iq.WED_2ND_OPEN_TM,
        iq.ACCNT_ID,
        iq.ADDR_MAIL_CD,
        iq.ADDR_TYPE_CD,
        iq.BRICK_ID,
        iq.BU_ID,
        iq.CONTACT_ID,
        iq.DEA_NUM,
        iq.DFLT_SHIP_PRIO_CD,
        iq.EMAIL_ADDR,
        iq.FAX_PH_NUM,
        iq.MAIL_TYPE_CD,
        iq.OCCUPANCY_CD,
        iq.ORG_GROUP_ID,
        iq.PH_NUM,
        iq.TRNSPRT_ZONE_CD,
        iq.X_ATTRIB_01,
        iq.X_ATTRIB_02,
        iq.X_ATTRIB_03,
        iq.X_ATTRIB_04,
        iq.X_ATTRIB_05,
        iq.X_ATTRIB_06,
        iq.X_ATTRIB_07,
        iq.X_OK_TO_SAMPLE,
        iq.ADDRESSEE,
        iq.ALIGNMENT_FLG,
        iq.DB_LAST_UPD,
        iq.DB_LAST_UPD_SRC,
        iq.YEARLY_END_DT,
        iq.YEARLY_START_DT,
        iq.X_SRC_LAST_UPD,
        iq.rnk
 FROM ( SELECT sca.ROW_ID,
        sca.CREATED,
        sca.CREATED_BY,
        sca.LAST_UPD,
        sca.LAST_UPD_BY,
        sca.MODIFICATION_NUM,
        sca.CONFLICT_ID,
        sca.ACTIVE_FLG,
        sca.ADDR_PER_ID,
        sca.BL_ADDR_FLG,
        sca.FRAUD_FLG,
        sca.MAIN_ADDR_FLG,
        sca.RELATION_TYPE_CD,
        sca.SHIP_ADDR_FLG,
        sca.DEA_EXPR_DT,
        sca.END_DT,
        sca.FRI_1ST_CLOSE_TM,
        sca.FRI_1ST_OPEN_TM,
        sca.FRI_2ND_CLOSE_TM,
        sca.FRI_2ND_OPEN_TM,
        sca.MON_1ST_CLOSE_TM,
        sca.MON_1ST_OPEN_TM,
        sca.MON_2ND_CLOSE_TM,
        sca.MON_2ND_OPEN_TM,
        sca.NUM_MONTHS_AT_ADDR,
        sca.SAT_1ST_CLOSE_TM,
        sca.SAT_1ST_OPEN_TM,
        sca.SAT_2ND_CLOSE_TM,
        sca.SAT_2ND_OPEN_TM,
        sca.START_DT,
        sca.SUN_1ST_CLOSE_TM,
        sca.SUN_1ST_OPEN_TM,
        sca.SUN_2ND_CLOSE_TM,
        sca.SUN_2ND_OPEN_TM,
        sca.THU_1ST_CLOSE_TM,
        sca.THU_1ST_OPEN_TM,
        sca.THU_2ND_CLOSE_TM,
        sca.THU_2ND_OPEN_TM,
        sca.TUE_1ST_CLOSE_TM,
        sca.TUE_1ST_OPEN_TM,
        sca.TUE_2ND_CLOSE_TM,
        sca.TUE_2ND_OPEN_TM,
        sca.WED_1ST_CLOSE_TM,
        sca.WED_1ST_OPEN_TM,
        sca.WED_2ND_CLOSE_TM,
        sca.WED_2ND_OPEN_TM,
        sca.ACCNT_ID,
        sca.ADDR_MAIL_CD,
        sca.ADDR_TYPE_CD,
        sca.BRICK_ID,
        sca.BU_ID,
        sca.CONTACT_ID,
        sca.DEA_NUM,
        sca.DFLT_SHIP_PRIO_CD,
        sca.EMAIL_ADDR,
        sca.FAX_PH_NUM,
        sca.MAIL_TYPE_CD,
        sca.OCCUPANCY_CD,
        sca.ORG_GROUP_ID,
        sca.PH_NUM,
        sca.TRNSPRT_ZONE_CD,
        sca.X_ATTRIB_01,
        sca.X_ATTRIB_02,
        sca.X_ATTRIB_03,
        sca.X_ATTRIB_04,
        sca.X_ATTRIB_05,
        sca.X_ATTRIB_06,
        sca.X_ATTRIB_07,
        sca.X_OK_TO_SAMPLE,
        sca.ADDRESSEE,
        sca.ALIGNMENT_FLG,
        sca.DB_LAST_UPD,
        sca.DB_LAST_UPD_SRC,
        sca.YEARLY_END_DT,
        sca.YEARLY_START_DT,
        sca.X_SRC_LAST_UPD,
        row_number() OVER (PARTITION BY sca.CONTACT_ID, sca.ADDR_PER_ID ORDER BY sca.LAST_UPD DESC, sca.CREATED DESC) AS rnk
 FROM sfa_history.s_con_addr sca) iq
 WHERE (iq.rnk = 1)) ca ON (((ca.ADDR_PER_ID = pc.PR_ADDR_ID) AND (ca.CONTACT_ID = pc.CON_ID)))) LEFT  JOIN sfa_history.s_state_lic_ls l ON (((l.ROW_ID = ca.X_ATTRIB_02) AND (l.CONTACT_ID = ca.CONTACT_ID) AND (l.STATUS_CD <> 'Invalid'::varchar(7))))) LEFT  JOIN sfa_history.STG_CM_ID_XREF cm1 ON (((c.ROW_ID = cm1.ID_NUM) AND (cm1.ID_TYPE = 'sfa_histo'::varchar(9))))) LEFT  JOIN sfa_history.STG_CM_ID_XREF cm2 ON (((x.ATTRIB_03 = cm2.ID_NUM) AND (cm2.ID_TYPE = 'IMS_ID'::varchar(6)))))
 WHERE ((p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)])) AND (p.NAME !~~ '%sfa_historyAdministr'::varchar(21)) AND (p.NAME <> 'Align_2007'::varchar(10)) AND (NOT ((x.ATTRIB_03 IS NULL) AND (c.DEGREE = ANY (ARRAY['Billing Staff'::varchar(24), 'Office Staff'::varchar(24), 'Other Contact'::varchar(24), 'Pharmacist/Pharm D'::varchar(24), 'Practice Manager'::varchar(24), 'Refill Coordinator'::varchar(24), 'Reimbursement Specialist'::varchar(24)])))));

CREATE  VIEW sfa_history.v_siebel_samples_prof AS
SELECT ap.ROW_ID AS sample_id, ea.ROW_ID AS call_id, c.ROW_ID AS siebel_contact_row_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, rep_p.X_SALES_FORCE AS sales_force_id, rep_p.NAME AS territory_num, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, CASE WHEN (ap.RELATION_TYPE_CD = 'Direct Send'::varchar(11)) THEN 'REQUEST'::varchar(7) WHEN (ap.RELATION_TYPE_CD = 'Sample'::varchar(6)) THEN 'DROP'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS sample_type, CASE WHEN (p.DESC_TEXT ~~ 'Adipex%'::varchar(7)) THEN 'ADIPEX-P'::varchar(8) WHEN (p.DESC_TEXT ~~ 'Amrix%'::varchar(6)) THEN 'AMRIX'::varchar(5) WHEN (p.DESC_TEXT ~~ 'Azilect%'::varchar(8)) THEN 'AZILECT'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Budesonide%'::varchar(11)) THEN 'BUDESONIDE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'COPAXONE%'::varchar(9)) THEN 'COPAXONE'::varchar(8) WHEN (p.DESC_TEXT ~~ 'ENJUVIA%'::varchar(8)) THEN 'ENJUVIA'::varchar(7) WHEN (p.DESC_TEXT ~~ 'LoSeasonique%'::varchar(13)) THEN 'LOSEASONIQUE'::varchar(12) WHEN (p.DESC_TEXT ~~ 'NIASPAN%'::varchar(8)) THEN 'NIASPAN'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Nuvigil%'::varchar(8)) THEN 'NUVIGIL'::varchar(7) WHEN (p.DESC_TEXT ~~ 'ProAir%'::varchar(7)) THEN 'PROAIR'::varchar(6) WHEN (p.DESC_TEXT ~~ 'Qnasl%'::varchar(6)) THEN 'QNASL'::varchar(5) WHEN (p.DESC_TEXT ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (p.DESC_TEXT ~~ 'Seasonique%'::varchar(11)) THEN 'SEASONIQUE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'Tev-Tropin%'::varchar(11)) THEN 'TEV-TROPIN'::varchar(10) ELSE 'UNKNOWN'::varchar(7) END AS product_name, p.DESC_TEXT AS sample_name, p.PART_NUM AS sample_ndc, ap.QTY AS qty, ea.NAME AS name_on_call, ea.COMMENTS AS address_line_on_call, ea.ZIPCODE AS zip_on_call, d.ims_id, eax.ATTRIB_03 AS dea_num, ea.OWNER_PER_ID AS ownerid, emp.CSN AS employeenumber, ea.CREATED_BY AS created_by, ea.CREATED AS created_date FROM (((((((sfa_history.s_evt_act ea JOIN sfa_history.s_contact c ON ((ea.TARGET_PER_ID = c.ROW_ID))) JOIN sfa_history.s_postn rep_p ON ((ea.OWNER_POSTN_ID = rep_p.ROW_ID))) JOIN sfa_history.s_act_prdint ap ON ((ea.ROW_ID = ap.ACTIVITY_ID))) JOIN sfa_history.s_prod_int p ON ((ap.PRDINT_ID = p.ROW_ID))) LEFT JOIN sfa_history.s_evt_act_x eax ON ((ea.ROW_ID = eax.ROW_ID))) LEFT JOIN sfa_history.s_contact emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT DIM_SFA_CSF_DEMO.IMS_ID AS ims_id, DIM_SFA_CSF_DEMO.CM_ID AS cm_id, DIM_SFA_CSF_DEMO.ME_NUM AS me_num, DIM_SFA_CSF_DEMO.SIEBEL_CONTACT_ROW_ID AS siebel_contact_row_id, row_number() OVER (PARTITION BY DIM_SFA_CSF_DEMO.SIEBEL_CONTACT_ROW_ID ORDER BY DIM_SFA_CSF_DEMO.VEEVA_ACCOUNT_ID, DIM_SFA_CSF_DEMO.SALES_FORCE_ID) AS rnk FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) WHERE ((rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ap.RELATION_TYPE_CD = ANY (ARRAY['Direct Send'::varchar(11), 'Sample'::varchar(6)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp));

CREATE  VIEW teva_ingestion.ext_hcos_ddd_xfer AS
 SELECT btrim(ext_hcos_ddd_xfer_src.IMS_ORG_ID) AS IMS_ORG_ID,
        btrim(ext_hcos_ddd_xfer_src.HCE_ID_PRFSNL) AS HCE_ID_PRFSNL,
        btrim(ext_hcos_ddd_xfer_src.PROFESSIONAL_ID) AS PROFESSIONAL_ID,
        btrim(ext_hcos_ddd_xfer_src.IDENTIFIER_ID) AS IDENTIFIER_ID,
        btrim(ext_hcos_ddd_xfer_src.IDENTIFIER) AS IDENTIFIER,
        btrim(ext_hcos_ddd_xfer_src.IDENTIFIER_ORDER) AS IDENTIFIER_ORDER,
        btrim(ext_hcos_ddd_xfer_src.IDENTIFIER_CATEGORY) AS IDENTIFIER_CATEGORY,
        btrim(ext_hcos_ddd_xfer_src.IDENTIFIER_STATE) AS IDENTIFIER_STATE,
        btrim(ext_hcos_ddd_xfer_src.SRC_STRT_DT) AS SRC_STRT_DT,
        btrim(ext_hcos_ddd_xfer_src.SRC_TRMTN_DT) AS SRC_TRMTN_DT,
        btrim(ext_hcos_ddd_xfer_src.SRC_TRMTN_CD) AS SRC_TRMTN_CD,
        ext_hcos_ddd_xfer_src.batch_id,
        ext_hcos_ddd_xfer_src.row_id,
        ext_hcos_ddd_xfer_src.update_ts
 FROM teva_ingestion.ext_hcos_ddd_xfer_src;

CREATE  VIEW raw.ext_hcos_ddd_xfer AS
 SELECT src.IMS_ORG_ID,
        src.HCE_ID_PRFSNL,
        src.PROFESSIONAL_ID,
        src.IDENTIFIER_ID,
        src.IDENTIFIER,
        src.IDENTIFIER_ORDER,
        src.IDENTIFIER_CATEGORY,
        src.IDENTIFIER_STATE,
        src.SRC_STRT_DT,
        src.SRC_TRMTN_DT,
        src.SRC_TRMTN_CD,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_hcos_ddd_xfer_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_HCOS_DDD_XFER'::varchar(17)))));

CREATE  VIEW teva_ingestion.ext_tw_biologics_dispense AS
 SELECT btrim(ext_tw_biologics_dispense_src.SP_ID) AS SP_ID,
        btrim(ext_tw_biologics_dispense_src.HUB_ID) AS HUB_ID,
        btrim(ext_tw_biologics_dispense_src.PAYOR) AS PAYOR,
        btrim(ext_tw_biologics_dispense_src.PAYOR_TYPE) AS PAYOR_TYPE,
        CASE WHEN (ext_tw_biologics_dispense_src.COPAY = ''::varchar) THEN NULL::numeric(6,2) ELSE (btrim(ext_tw_biologics_dispense_src.COPAY))::numeric(6,2) END AS COPAY,
        btrim(ext_tw_biologics_dispense_src.INVOICE_NUMBER) AS INVOICE_NUMBER,
        btrim(ext_tw_biologics_dispense_src.PHYSICIAN_NPI) AS PHYSICIAN_NPI,
        btrim(ext_tw_biologics_dispense_src.PHYSICIAN_NAME) AS PHYSICIAN_NAME,
        btrim(ext_tw_biologics_dispense_src.PHYSICIAN_ORG) AS PHYSICIAN_ORG,
        CASE WHEN (ext_tw_biologics_dispense_src.SHIP_DATE = ''::varchar) THEN NULL::date ELSE (btrim(ext_tw_biologics_dispense_src.SHIP_DATE))::date END AS SHIP_DATE,
        CASE WHEN (ext_tw_biologics_dispense_src.SHIP_NUM = ''::varchar) THEN NULL::int ELSE (btrim(ext_tw_biologics_dispense_src.SHIP_NUM))::int END AS SHIP_NUM,
        btrim(ext_tw_biologics_dispense_src.REPLACEMENT_FLAG) AS REPLACEMENT_FLAG,
        CASE WHEN (ext_tw_biologics_dispense_src.MEDICAID_RETURN_DATE = ''::varchar) THEN NULL::date ELSE (btrim(ext_tw_biologics_dispense_src.MEDICAID_RETURN_DATE))::date END AS MEDICAID_RETURN_DATE,
        CASE WHEN (ext_tw_biologics_dispense_src.SELF_PAY_REFUND_DATE = ''::varchar) THEN NULL::date ELSE (btrim(ext_tw_biologics_dispense_src.SELF_PAY_REFUND_DATE))::date END AS SELF_PAY_REFUND_DATE,
        btrim(ext_tw_biologics_dispense_src.SHIP_ADDRESS) AS SHIP_ADDRESS,
        btrim(ext_tw_biologics_dispense_src.SHIP_CITY) AS SHIP_CITY,
        btrim(ext_tw_biologics_dispense_src.SHIP_STATE) AS SHIP_STATE,
        btrim(ext_tw_biologics_dispense_src.SHIP_ZIP) AS SHIP_ZIP,
        ext_tw_biologics_dispense_src.batch_id,
        ext_tw_biologics_dispense_src.row_id,
        ext_tw_biologics_dispense_src.update_ts
 FROM teva_ingestion.ext_tw_biologics_dispense_src;

CREATE  VIEW raw.ext_tw_biologics_dispense AS
 SELECT src.SP_ID,
        src.HUB_ID,
        src.PAYOR,
        src.PAYOR_TYPE,
        src.COPAY,
        src.INVOICE_NUMBER,
        src.PHYSICIAN_NPI,
        src.PHYSICIAN_NAME,
        src.PHYSICIAN_ORG,
        src.SHIP_DATE,
        src.SHIP_NUM,
        src.REPLACEMENT_FLAG,
        src.MEDICAID_RETURN_DATE,
        src.SELF_PAY_REFUND_DATE,
        src.SHIP_ADDRESS,
        src.SHIP_CITY,
        src.SHIP_STATE,
        src.SHIP_ZIP,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_tw_biologics_dispense_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_BIOLOGICS_DISPENSE'::varchar(25)))));

CREATE  VIEW teva_ingestion.ext_tw_biologics_referral AS
 SELECT btrim(ext_tw_biologics_referral_src.PATIENT_CREATE_DATE) AS PATIENT_CREATE_DATE,
        btrim(ext_tw_biologics_referral_src.MRN) AS MRN,
        btrim(ext_tw_biologics_referral_src.PH_NPI) AS PH_NPI,
        btrim(ext_tw_biologics_referral_src.PHYSICIAN) AS PHYSICIAN,
        btrim(ext_tw_biologics_referral_src.REFERRAL_TYPE) AS REFERRAL_TYPE,
        btrim(ext_tw_biologics_referral_src.PH_SPEC) AS PH_SPEC,
        btrim(ext_tw_biologics_referral_src.PH_ORG) AS PH_ORG,
        btrim(ext_tw_biologics_referral_src.PH_ADDRESS) AS PH_ADDRESS,
        btrim(ext_tw_biologics_referral_src.PH_CITY) AS PH_CITY,
        btrim(ext_tw_biologics_referral_src.PH_STATE) AS PH_STATE,
        btrim(ext_tw_biologics_referral_src.PH_ZIP) AS PH_ZIP,
        btrim(ext_tw_biologics_referral_src.PH_PHONE) AS PH_PHONE,
        ext_tw_biologics_referral_src.batch_id,
        ext_tw_biologics_referral_src.row_id,
        ext_tw_biologics_referral_src.update_ts
 FROM teva_ingestion.ext_tw_biologics_referral_src;

CREATE  VIEW raw.ext_tw_biologics_referral AS
 SELECT src.PATIENT_CREATE_DATE,
        src.MRN,
        src.PH_NPI,
        src.PHYSICIAN,
        src.REFERRAL_TYPE,
        src.PH_SPEC,
        src.PH_ORG,
        src.PH_ADDRESS,
        src.PH_CITY,
        src.PH_STATE,
        src.PH_ZIP,
        src.PH_PHONE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_tw_biologics_referral_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_BIOLOGICS_REFERRAL'::varchar(25)))));

CREATE  VIEW teva_ingestion.ext_diplomat_rx AS
 SELECT btrim(ext_diplomat_rx_src.SPECIALTY_PHARMACY_NAME) AS SPECIALTY_PHARMACY_NAME,
        btrim(ext_diplomat_rx_src.SUB_SPECIALTY_PHARMACY_NAME) AS SUB_SPECIALTY_PHARMACY_NAME,
        btrim(ext_diplomat_rx_src.SPECIALTY_PHARMACY_HUB_ID) AS SPECIALTY_PHARMACY_HUB_ID,
        CASE WHEN (ext_diplomat_rx_src.PHARMACY_NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.PHARMACY_NPI))::numeric(37,15) END AS PHARMACY_NPI,
        btrim(ext_diplomat_rx_src.NCPDP) AS NCPDP,
        btrim(ext_diplomat_rx_src.PHARMACY_STORE_NUMBER) AS PHARMACY_STORE_NUMBER,
        btrim(ext_diplomat_rx_src.PHARMACY_ADDRESS_1) AS PHARMACY_ADDRESS_1,
        btrim(ext_diplomat_rx_src.PHARMACY_ADDRESS_2) AS PHARMACY_ADDRESS_2,
        btrim(ext_diplomat_rx_src.PHARMACY_CITY) AS PHARMACY_CITY,
        btrim(ext_diplomat_rx_src.PHARMACY_STATE) AS PHARMACY_STATE,
        btrim(ext_diplomat_rx_src.PHARMACY_ZIP) AS PHARMACY_ZIP,
        btrim(ext_diplomat_rx_src.PHARMACY_PHONE) AS PHARMACY_PHONE,
        btrim(ext_diplomat_rx_src.PHARMACY_FAX) AS PHARMACY_FAX,
        btrim(ext_diplomat_rx_src.DSP_PATIENT_ID) AS DSP_PATIENT_ID,
        btrim(ext_diplomat_rx_src.GENDER) AS GENDER,
        CASE WHEN (ext_diplomat_rx_src.AGE = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.AGE))::numeric(37,15) END AS AGE,
        btrim(ext_diplomat_rx_src.PATIENT_STATE) AS PATIENT_STATE,
        btrim(ext_diplomat_rx_src.PRIMARY_ICD9) AS PRIMARY_ICD9,
        btrim(ext_diplomat_rx_src.SECONDARY_ICD9) AS SECONDARY_ICD9,
        CASE WHEN (ext_diplomat_rx_src.PRESCRIBER_NPI = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.PRESCRIBER_NPI))::numeric(37,15) END AS PRESCRIBER_NPI,
        btrim(ext_diplomat_rx_src.PRESCRIBER_DEA) AS PRESCRIBER_DEA,
        btrim(ext_diplomat_rx_src.PRESCRIBER_HUB_ID) AS PRESCRIBER_HUB_ID,
        btrim(ext_diplomat_rx_src.PRESCRIBER_NAME_FIRST) AS PRESCRIBER_NAME_FIRST,
        btrim(ext_diplomat_rx_src.PRESCIBER_NAME_LAST) AS PRESCIBER_NAME_LAST,
        btrim(ext_diplomat_rx_src.PRESCRIBER_ADDRESS_1) AS PRESCRIBER_ADDRESS_1,
        btrim(ext_diplomat_rx_src.PRESCRIBER_ADDRESS_2) AS PRESCRIBER_ADDRESS_2,
        btrim(ext_diplomat_rx_src.PRESCRIBER_CITY) AS PRESCRIBER_CITY,
        btrim(ext_diplomat_rx_src.PRESCRIBER_STATE) AS PRESCRIBER_STATE,
        btrim(ext_diplomat_rx_src.PRESCRIBER_ZIP) AS PRESCRIBER_ZIP,
        btrim(ext_diplomat_rx_src.PRESCRIBER_PHONE) AS PRESCRIBER_PHONE,
        btrim(ext_diplomat_rx_src.PRESCRIBER_FAX) AS PRESCRIBER_FAX,
        btrim(ext_diplomat_rx_src.DRUG_NAME) AS DRUG_NAME,
        btrim(ext_diplomat_rx_src.DRUG_NDC_11) AS DRUG_NDC_11,
        btrim(ext_diplomat_rx_src.DRUG_STRENGTH) AS DRUG_STRENGTH,
        btrim(ext_diplomat_rx_src.DRUG_FORM) AS DRUG_FORM,
        btrim(ext_diplomat_rx_src.PACKAGE_SIZE) AS PACKAGE_SIZE,
        btrim(ext_diplomat_rx_src.DOSE_FORM) AS DOSE_FORM,
        btrim(ext_diplomat_rx_src.RX_NBR) AS RX_NBR,
        CASE WHEN (ext_diplomat_rx_src.REFILL_NUMBER = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.REFILL_NUMBER))::numeric(37,15) END AS REFILL_NUMBER,
        CASE WHEN (ext_diplomat_rx_src.RX_REFILLS_WRITTEN = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.RX_REFILLS_WRITTEN))::numeric(37,15) END AS RX_REFILLS_WRITTEN,
        CASE WHEN (ext_diplomat_rx_src.DISPENSE_QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.DISPENSE_QTY))::numeric(37,15) END AS DISPENSE_QTY,
        CASE WHEN (ext_diplomat_rx_src.DAYS_SUPPLY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.DAYS_SUPPLY))::numeric(37,15) END AS DAYS_SUPPLY,
        btrim(ext_diplomat_rx_src.RX_WRITTEN_DATE) AS RX_WRITTEN_DATE,
        btrim(ext_diplomat_rx_src.RX_RECEIPT_DATE) AS RX_RECEIPT_DATE,
        btrim(ext_diplomat_rx_src.FILL_DATE) AS FILL_DATE,
        btrim(ext_diplomat_rx_src.RX_TYPE) AS RX_TYPE,
        CASE WHEN (ext_diplomat_rx_src.COPAY = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.COPAY))::numeric(37,15) END AS COPAY,
        CASE WHEN (ext_diplomat_rx_src.INGREDIENT_WAC_COST = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.INGREDIENT_WAC_COST))::numeric(37,15) END AS INGREDIENT_WAC_COST,
        CASE WHEN (ext_diplomat_rx_src.TOTAL_PRICE_PAID = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(ext_diplomat_rx_src.TOTAL_PRICE_PAID))::numeric(37,15) END AS TOTAL_PRICE_PAID,
        btrim(ext_diplomat_rx_src.PRIMARY_PLAN_NAME) AS PRIMARY_PLAN_NAME,
        btrim(ext_diplomat_rx_src.PRIMARY_BIN) AS PRIMARY_BIN,
        btrim(ext_diplomat_rx_src.PRIMARY_PCN) AS PRIMARY_PCN,
        btrim(ext_diplomat_rx_src.SECONDARY_PLAN_NAME) AS SECONDARY_PLAN_NAME,
        btrim(ext_diplomat_rx_src.SECONDARY_BIN) AS SECONDARY_BIN,
        btrim(ext_diplomat_rx_src.SECONDARY_PCN) AS SECONDARY_PCN,
        btrim(ext_diplomat_rx_src.TERTIARY_PLAN_NAME) AS TERTIARY_PLAN_NAME,
        btrim(ext_diplomat_rx_src.TERTIARY_BIN) AS TERTIARY_BIN,
        btrim(ext_diplomat_rx_src.TERTIARY_PCN) AS TERTIARY_PCN,
        btrim(ext_diplomat_rx_src.SHIP_DATE) AS SHIP_DATE,
        btrim(ext_diplomat_rx_src.SHIPPING_CARRIER) AS SHIPPING_CARRIER,
        ext_diplomat_rx_src.batch_id,
        ext_diplomat_rx_src.row_id,
        ext_diplomat_rx_src.update_ts
 FROM teva_ingestion.ext_diplomat_rx_src;

CREATE  VIEW raw.ext_diplomat_rx AS
 SELECT src.SPECIALTY_PHARMACY_NAME,
        src.SUB_SPECIALTY_PHARMACY_NAME,
        src.SPECIALTY_PHARMACY_HUB_ID,
        src.PHARMACY_NPI,
        src.NCPDP,
        src.PHARMACY_STORE_NUMBER,
        src.PHARMACY_ADDRESS_1,
        src.PHARMACY_ADDRESS_2,
        src.PHARMACY_CITY,
        src.PHARMACY_STATE,
        src.PHARMACY_ZIP,
        src.PHARMACY_PHONE,
        src.PHARMACY_FAX,
        src.DSP_PATIENT_ID,
        src.GENDER,
        src.AGE,
        src.PATIENT_STATE,
        src.PRIMARY_ICD9,
        src.SECONDARY_ICD9,
        src.PRESCRIBER_NPI,
        src.PRESCRIBER_DEA,
        src.PRESCRIBER_HUB_ID,
        src.PRESCRIBER_NAME_FIRST,
        src.PRESCIBER_NAME_LAST,
        src.PRESCRIBER_ADDRESS_1,
        src.PRESCRIBER_ADDRESS_2,
        src.PRESCRIBER_CITY,
        src.PRESCRIBER_STATE,
        src.PRESCRIBER_ZIP,
        src.PRESCRIBER_PHONE,
        src.PRESCRIBER_FAX,
        src.DRUG_NAME,
        src.DRUG_NDC_11,
        src.DRUG_STRENGTH,
        src.DRUG_FORM,
        src.PACKAGE_SIZE,
        src.DOSE_FORM,
        src.RX_NBR,
        src.REFILL_NUMBER,
        src.RX_REFILLS_WRITTEN,
        src.DISPENSE_QTY,
        src.DAYS_SUPPLY,
        src.RX_WRITTEN_DATE,
        src.RX_RECEIPT_DATE,
        src.FILL_DATE,
        src.RX_TYPE,
        src.COPAY,
        src.INGREDIENT_WAC_COST,
        src.TOTAL_PRICE_PAID,
        src.PRIMARY_PLAN_NAME,
        src.PRIMARY_BIN,
        src.PRIMARY_PCN,
        src.SECONDARY_PLAN_NAME,
        src.SECONDARY_BIN,
        src.SECONDARY_PCN,
        src.TERTIARY_PLAN_NAME,
        src.TERTIARY_BIN,
        src.TERTIARY_PCN,
        src.SHIP_DATE,
        src.SHIPPING_CARRIER,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.ext_diplomat_rx_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DIPLOMAT_RX'::varchar(15)))));

CREATE  VIEW public.knipper_supplemental AS
 SELECT a.tvcmid AS TVCMID,
        CASE WHEN (a.medical_suffix IS NULL) THEN ''::varchar ELSE a.medical_suffix END AS ProfDesig,
        a.first_name AS FName,
        a.last_name AS Lname,
        CASE WHEN (a.middle_name IS NULL) THEN ''::varchar ELSE a.middle_name END AS MI,
        CASE WHEN (a.personal_suffix IS NULL) THEN ''::varchar ELSE a.personal_suffix END AS Suffix,
        CASE WHEN (a.hce_status_desc IS NULL) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'ACTIVE'::varchar(6)) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'INACTIVE'::varchar(8)) THEN 'I'::varchar(1) ELSE 'D'::varchar(1) END AS Status,
        CASE WHEN (a.hce_status_desc = 'PRESUMED DEAD'::varchar(13)) THEN 'D'::varchar(1) WHEN (a.hce_status_desc = 'SEMI-RETIRED'::varchar(12)) THEN 'O'::varchar(1) WHEN (a.hce_status_desc = 'RETIRED'::varchar(7)) THEN 'R'::varchar(1) ELSE ''::varchar END AS DeleteReason,
        CASE WHEN ((a.hce_status_desc IS NULL) OR (a.hce_status_desc <> ALL (ARRAY['ACTIVE'::varchar(8), 'INACTIVE'::varchar(8)]))) THEN to_char(e.last_update_date, 'MM/DD/YYYY'::varchar(10)) ELSE ''::varchar END AS DeleteDate,
        CASE WHEN (a.primary_specialty IS NULL) THEN ''::varchar ELSE a.primary_specialty END AS Specialty,
        CASE WHEN (a.address_line1 IS NULL) THEN ''::varchar ELSE a.address_line1 END AS Address1,
        CASE WHEN (a.address_line2 IS NULL) THEN ''::varchar ELSE a.address_line2 END AS Address2,
        ''::varchar AS Address3,
        CASE WHEN (a.city IS NULL) THEN ''::varchar ELSE a.city END AS City,
        CASE WHEN (a.state IS NULL) THEN ''::varchar ELSE a.state END AS State,
        CASE WHEN (a.zip IS NULL) THEN ''::varchar ELSE a.zip END AS Zip,
        CASE WHEN (b.sln IS NULL) THEN ''::varchar ELSE b.sln END AS SLN,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE CASE WHEN (b.sln_status_code = 'A'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END END AS SLNActiveFlag,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE to_char(b.sln_expiration_date, 'MM/DD/YYYY'::varchar(10)) END AS SLNExpirationDate,
        CASE WHEN (c.flag_value = 'DNC'::varchar(3)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNCWakeFlag,
        CASE WHEN (d.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP
 FROM (((((( SELECT prescriber_rx.tvcmid
 FROM datamart.prescriber_rx
 GROUP BY prescriber_rx.tvcmid) exp JOIN ( SELECT hcp_demo.tvcmid,
        hcp_demo.ims_hce_id,
        hcp_demo.ims_id,
        hcp_demo.npi,
        hcp_demo.last_name,
        hcp_demo.first_name,
        hcp_demo.middle_name,
        hcp_demo.personal_suffix,
        hcp_demo.medical_suffix,
        hcp_demo.primary_specialty,
        hcp_demo.address_line1,
        hcp_demo.address_line2,
        hcp_demo.city,
        hcp_demo.state,
        hcp_demo.zip,
        hcp_demo.c_bo_hce_address__address_id,
        hcp_demo.legacy_address_id,
        hcp_demo.business_phone,
        hcp_demo.business_email,
        hcp_demo.hce_status_desc,
        hcp_demo.file_id,
        hcp_demo.record_id,
        hcp_demo.np_pa_flag
 FROM customer_master.hcp_demo
 WHERE (hcp_demo.file_id = ( SELECT max(hcp_demo.file_id) AS max
 FROM customer_master.hcp_demo))) a ON ((exp.tvcmid = a.tvcmid))) JOIN ( SELECT sample_eligibility.rowid_object,
        sample_eligibility.creator,
        sample_eligibility.create_date,
        sample_eligibility.updated_by,
        sample_eligibility.last_update_date,
        sample_eligibility.consolidation_ind,
        sample_eligibility.deleted_ind,
        sample_eligibility.deleted_by,
        sample_eligibility.deleted_date,
        sample_eligibility.last_rowid_system,
        sample_eligibility.dirty_ind,
        sample_eligibility.interaction_id,
        sample_eligibility.hub_state_ind,
        sample_eligibility.cm_dirty_ind,
        sample_eligibility.certification_desc,
        sample_eligibility.sln,
        sample_eligibility.sln_state,
        sample_eligibility.sln_expiration_date,
        sample_eligibility.sln_status_code,
        sample_eligibility.sln_status_desc,
        sample_eligibility.teva_sample_elig_flag,
        sample_eligibility.teva_sched_iv_elig_flag,
        sample_eligibility.teva_sched_v_elig_flag,
        sample_eligibility.profession_short_desc,
        sample_eligibility.teva_specialty_code,
        sample_eligibility.certification_code,
        sample_eligibility.file_id,
        sample_eligibility.record_id,
        sample_eligibility.tvcmid
 FROM customer_master.sample_eligibility
 WHERE (sample_eligibility.file_id = ( SELECT max(sample_eligibility.file_id) AS max
 FROM customer_master.sample_eligibility))) b ON (((a.tvcmid = b.tvcmid) AND (a.state = b.sln_state)))) LEFT  JOIN ( SELECT customer_flags.tvcmid,
        customer_flags.product_name,
        customer_flags.sales_force_id,
        customer_flags.territory_number,
        customer_flags.flag_type,
        customer_flags.flag_value,
        customer_flags.eff_start_date,
        customer_flags.eff_end_date,
        customer_flags.file_id,
        customer_flags.record_id
 FROM customer_master.customer_flags
 WHERE (customer_flags.file_id = ( SELECT max(customer_flags.file_id) AS max
 FROM customer_master.customer_flags))) c ON (((a.tvcmid = c.tvcmid) AND (c.flag_type = 'DNC'::varchar(3)) AND (c.product_name = 'NUVIGIL'::varchar(7))))) LEFT  JOIN datamart.do_not_promote d ON ((a.tvcmid = d.tvcmid))) LEFT  JOIN ( SELECT hcp_detail.rowid_object,
        hcp_detail.creator,
        hcp_detail.create_date,
        hcp_detail.updated_by,
        hcp_detail.last_update_date,
        hcp_detail.consolidation_ind,
        hcp_detail.deleted_ind,
        hcp_detail.deleted_by,
        hcp_detail.deleted_date,
        hcp_detail.last_rowid_system,
        hcp_detail.dirty_ind,
        hcp_detail.interaction_id,
        hcp_detail.hub_state_ind,
        hcp_detail.cm_dirty_ind,
        hcp_detail.ims_prescriber_id,
        hcp_detail.prefix,
        hcp_detail.first_name,
        hcp_detail.last_name,
        hcp_detail.middle_name,
        hcp_detail.suffix,
        hcp_detail.healthcare_prof_status_cd,
        hcp_detail.year_of_birth,
        hcp_detail.date_of_death,
        hcp_detail.gender_code,
        hcp_detail.teva_specialty_code,
        hcp_detail.file_id,
        hcp_detail.record_id,
        hcp_detail.tvcmid
 FROM customer_master.hcp_detail
 WHERE ((hcp_detail.file_id = ( SELECT max(hcp_detail.file_id) AS max
 FROM customer_master.hcp_detail)) AND (hcp_detail.hub_state_ind = 1::float))) e ON ((a.tvcmid = e.tvcmid)));

CREATE  VIEW metadata.log_trend AS
 SELECT log_summary.job,
        max(CASE log_summary.run WHEN NULLSEQUAL 1 THEN log_summary.started ELSE NULL::timestamp END) AS LAST_RUN_DATE,
        max(CASE log_summary.run WHEN NULLSEQUAL 1 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN,
        max(CASE log_summary.run WHEN NULLSEQUAL 2 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_2,
        max(CASE log_summary.run WHEN NULLSEQUAL 3 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_3,
        max(CASE log_summary.run WHEN NULLSEQUAL 4 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_4,
        max(CASE log_summary.run WHEN NULLSEQUAL 5 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_5,
        max(CASE log_summary.run WHEN NULLSEQUAL 6 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_6,
        max(CASE log_summary.run WHEN NULLSEQUAL 7 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_7,
        max(CASE log_summary.run WHEN NULLSEQUAL 8 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_8,
        max(CASE log_summary.run WHEN NULLSEQUAL 9 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_9,
        max(CASE log_summary.run WHEN NULLSEQUAL 10 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_10,
        max(CASE log_summary.run WHEN NULLSEQUAL 11 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_11,
        max(CASE log_summary.run WHEN NULLSEQUAL 12 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_12,
        max(CASE log_summary.run WHEN NULLSEQUAL 13 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_13,
        max(CASE log_summary.run WHEN NULLSEQUAL 14 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_14,
        max(CASE log_summary.run WHEN NULLSEQUAL 15 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_15,
        max(CASE log_summary.run WHEN NULLSEQUAL 16 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_16,
        max(CASE log_summary.run WHEN NULLSEQUAL 17 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_17,
        max(CASE log_summary.run WHEN NULLSEQUAL 18 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_18,
        max(CASE log_summary.run WHEN NULLSEQUAL 19 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_19,
        max(CASE log_summary.run WHEN NULLSEQUAL 20 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_20,
        max(CASE log_summary.run WHEN NULLSEQUAL 21 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_21,
        max(CASE log_summary.run WHEN NULLSEQUAL 22 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_22,
        max(CASE log_summary.run WHEN NULLSEQUAL 23 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_23,
        max(CASE log_summary.run WHEN NULLSEQUAL 24 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_24,
        max(CASE log_summary.run WHEN NULLSEQUAL 25 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_25,
        max(CASE log_summary.run WHEN NULLSEQUAL 26 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_26,
        max(CASE log_summary.run WHEN NULLSEQUAL 27 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_27,
        max(CASE log_summary.run WHEN NULLSEQUAL 28 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_28,
        max(CASE log_summary.run WHEN NULLSEQUAL 29 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_29,
        max(CASE log_summary.run WHEN NULLSEQUAL 30 THEN log_summary.elapsed_time ELSE NULL::float END) AS LAST_RUN_30
 FROM metadata.log_summary
 GROUP BY log_summary.job
 ORDER BY max(CASE log_summary.run WHEN NULLSEQUAL 1 THEN log_summary.started ELSE NULL::timestamp END) DESC;

CREATE  VIEW public.v_ob_AHM_Employee AS
 SELECT coalesce(Employee.employee_id, ''::varchar) AS EmployeeId,
        coalesce(Employee.username, ''::varchar) AS Username,
        coalesce(upper(Employee.username), ''::varchar) AS FederationId,
        CASE WHEN (Employee.rep_type = 'REP'::varchar(3)) THEN 'TEVA Pharma Rep'::varchar(15) ELSE 'TEVA Pharma Manager'::varchar(19) END AS SFDCUserProfile,
        coalesce(Manager.employee_id, ''::varchar) AS ManagerEmployeeId,
        coalesce(Employee.first_name, ''::varchar) AS FirstName,
        coalesce(Employee.last_name, ''::varchar) AS LastName,
        coalesce(Employee.middle_name, ''::varchar) AS MiddleName,
        ''::varchar AS Nickname,
        ''::varchar AS GenderCode,
        coalesce(Employee.title, ''::varchar) AS EmployeeRole,
        coalesce(Employee.shipping_address_line1, ''::varchar) AS ShippingAddressLine1,
        coalesce(Employee.shipping_address_line2, ''::varchar) AS ShippingAddressLine2,
        ''::varchar AS ShippingAddressLine3,
        coalesce(Employee.shipping_city, ''::varchar) AS ShippingCity,
        ''::varchar AS ShippingNeighborhood,
        coalesce(Employee.shipping_state, ''::varchar) AS ShippingStateProvince,
        coalesce(Employee.shipping_zip, ''::varchar) AS ShippingPostalCode,
        ''::varchar AS ShippingPostalCodeExtension,
        'US'::varchar(2) AS ShippingCountryCode,
        coalesce(Employee.address_line1, ''::varchar) AS HomeAddressLine1,
        coalesce(Employee.address_line2, ''::varchar) AS HomeAddressLine2,
        ''::varchar AS HomeAddressLine3,
        coalesce(Employee.city, ''::varchar) AS HomeCity,
        ''::varchar AS HomeNeighborhood,
        coalesce(Employee.state, ''::varchar) AS HomeStateProvince,
        coalesce(Employee.zip, ''::varchar) AS HomePostalCode,
        ''::varchar AS HomePostalCodeExtension,
        'US'::varchar(2) AS HomeCountryCode,
        coalesce(Employee.business_address_line1, ''::varchar) AS WorkAddressLine1,
        coalesce(Employee.business_address_line2, ''::varchar) AS WorkAddressLine2,
        ''::varchar AS WorkAddressLine3,
        coalesce(Employee.business_city, ''::varchar) AS WorkCity,
        ''::varchar AS WorkNeighborhood,
        coalesce(Employee.business_state, ''::varchar) AS WorkStateProvince,
        coalesce(Employee.business_zip, ''::varchar) AS WorkPostalCode,
        ''::varchar AS WorkPostalCodeExtension,
        'US'::varchar(2) AS WorkCountryCode,
        coalesce(Employee.business_phone, ''::varchar) AS WorkPhone,
        ''::varchar AS WorkPhoneExtension,
        coalesce(Employee.email, ''::varchar) AS EmailAddress,
        coalesce(Employee.fax, ''::varchar) AS Fax,
        'US'::varchar(2) AS RegionId,
        coalesce((Employee.hire_date)::varchar(10), ''::varchar) AS HireDate,
        ''::varchar AS TerminationDate,
        'Active'::varchar(6) AS Status
 FROM (datamart.roster Employee LEFT  JOIN datamart.roster Manager ON ((Employee.parent_territory_number = Manager.territory_number)))
 WHERE (Employee.employee_id IS NOT NULL)
 GROUP BY coalesce(Employee.employee_id, ''::varchar),
          coalesce(Employee.username, ''::varchar),
          coalesce(upper(Employee.username), ''::varchar),
          CASE WHEN (Employee.rep_type = 'REP'::varchar(3)) THEN 'TEVA Pharma Rep'::varchar(15) ELSE 'TEVA Pharma Manager'::varchar(19) END,
          coalesce(Manager.employee_id, ''::varchar),
          coalesce(Employee.first_name, ''::varchar),
          coalesce(Employee.last_name, ''::varchar),
          coalesce(Employee.middle_name, ''::varchar),
          ''::varchar,
          coalesce(Employee.title, ''::varchar),
          coalesce(Employee.shipping_address_line1, ''::varchar),
          coalesce(Employee.shipping_address_line2, ''::varchar),
          coalesce(Employee.shipping_city, ''::varchar),
          coalesce(Employee.shipping_state, ''::varchar),
          coalesce(Employee.shipping_zip, ''::varchar),
          'US'::varchar(2),
          coalesce(Employee.address_line1, ''::varchar),
          coalesce(Employee.address_line2, ''::varchar),
          coalesce(Employee.city, ''::varchar),
          coalesce(Employee.state, ''::varchar),
          coalesce(Employee.zip, ''::varchar),
          coalesce(Employee.business_address_line1, ''::varchar),
          coalesce(Employee.business_address_line2, ''::varchar),
          coalesce(Employee.business_city, ''::varchar),
          coalesce(Employee.business_state, ''::varchar),
          coalesce(Employee.business_zip, ''::varchar),
          coalesce(Employee.business_phone, ''::varchar),
          coalesce(Employee.email, ''::varchar),
          coalesce(Employee.fax, ''::varchar),
          coalesce((Employee.hire_date)::varchar(10), ''::varchar),
          'Active'::varchar(6);

CREATE  VIEW raw.mdm_alternate_id AS
 SELECT src.TVCMID,
        src.ALTERNATE_ID_TYPE,
        src.ALTERNATE_ID_TYPE_NAME,
        src.ALTERNATE_ID_VALUE,
        src.STATE,
        src.STATE_NAME,
        src.IDENTIFIER_CATEGORY,
        src.STATUS,
        src.STATUS_NAME,
        src.SOURCE_DEACTIVATION_REASON_CODE,
        src.SOURCE_DEACTIVATION_REASON_DESCRIPTION,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_ALTERNATE_ID_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_alternate_id'::varchar(16)))));

CREATE  VIEW raw.mdm_alternate_name AS
 SELECT src.TVCMID,
        src.NAME_TYPE,
        src.NAME_TYPE_NAME,
        src.NAME_VALUE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_ALTERNATE_NAME_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_alternate_name'::varchar(18)))));

CREATE  VIEW raw.mdm_communication AS
 SELECT src.TVCMID,
        src.ADDRESS_ID,
        src.COMMUNICATION_TYPE,
        src.COMMUNICATION_TYPE_NAME,
        src.COMMUNICATION_VALUE,
        src.STATUS_CODE,
        src.STATUS_NAME,
        src.EFFECTIVE_START_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_COMMUNICATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_communication'::varchar(17)))));

CREATE  VIEW raw.mdm_dea_address AS
 SELECT src.TVCMID,
        src.ADDRESS_ID,
        src.DEA_NUMBER,
        src.BUSINESS_ACTIVITY_CODE,
        src.BUSINESS_ACTIVITY_DESCRIPTION,
        src.SUB_BUSINESS_ACTIVITY_CODE,
        src.SUB_BUSINESS_ACTIVITY_DESCRIPTION,
        src.DEA_SCHEDULE_CLASS_CODE,
        src.DEA_STATUS_CODE,
        src.DEA_STATUS_DESCRIPTION,
        src.DEA_EXPIRATION_DATE,
        src.DEA_DEACTIVATION_REASON_CODE,
        src.DEA_DEACTIVATION_REASON_DESCRIPTION,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_DEA_ADDRESS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_dea_address'::varchar(15)))));

CREATE  VIEW raw.mdm_hco_teva_flag AS
 SELECT src.TVCMID,
        src.FLAG_TYPE,
        src.FLAG_TYPE_NAME,
        src.FLAG_VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_HCO_TEVA_FLAG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_hco_teva_flag'::varchar(17)))));

CREATE  VIEW raw.mdm_hcp AS
 SELECT src.TVCMID,
        src.IMS_HCE_ID,
        src.IMS_PRESCRIBER_ID,
        src.FIRST_NAME,
        src.MIDDLE_NAME,
        src.LAST_NAME,
        src.PREFIX,
        src.SUFFIX,
        src.SUFFIX_NAME,
        src.SUB_TYPE,
        src.SUB_TYPE_NAME,
        src.HEALTHCARE_PROFESSIONAL_STATUS_CODE,
        src.HEALTHCARE_PROFESSIONAL_STATUS_NAME,
        src.YEAR_OF_BIRTH,
        src.DATE_OF_DEATH,
        src.GENDER_CODE,
        src.GENDER_NAME,
        src.TEVA_SPECIALTY_CODE,
        src.TEVA_SPECIALTY_NAME,
        src.LOGICAL_DELETION_DATE,
        src.HCE_INSERT_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_HCP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_hcp'::varchar(7)))));

CREATE  VIEW raw.mdm_hcp_teva_flag AS
 SELECT src.TVCMID,
        src.FLAG_TYPE,
        src.FLAG_TYPE_NAME,
        src.FLAG_VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_HCP_TEVA_FLAG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_hcp_teva_flag'::varchar(17)))));

CREATE  VIEW raw.mdm_ims_flag AS
 SELECT src.TVCMID,
        src.FLAG_TYPE,
        src.FLAG_TYPE_NAME,
        src.FLAG_VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_IMS_FLAG_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_ims_flag'::varchar(12)))));

CREATE  VIEW raw.mdm_license AS
 SELECT src.TVCMID,
        src.HCE_REGULATION_ID,
        src.LICENSE_TYPE_ID,
        src.LICENSE_TYPE_NAME,
        src.AUTHORIZATION_NUMBER,
        src.PROFESSION_CODE,
        src.STATE,
        src.STATE_NAME,
        src.STATE_BOARD_ID,
        src.STATE_BOARD_NAME,
        src.LICENSE_PRIVILEGE_ID,
        src.LICENSE_PRIVILEGE,
        src.LICENSE_CERTIFICATION_CODE,
        src.LICENSE_CERTIFICATION_NAME,
        src.LICENSE_TYPE_PRIVILEGE_RANK,
        src.LICENSE_STATUS_CODE,
        src.LICENSE_STATUS_DESCRIPTION,
        src.LICENSE_EFFECTIVE_DATE,
        src.LICENSE_EXPIRATION_DATE,
        src.LICENSE_DEACTIVATION_REASON_CODE,
        src.LICENSE_DEACTIVATION_REASON_DESCRIPTION,
        src.RECORD_TYPE,
        src.RECORD_TYPE_NAME,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_LICENSE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_license'::varchar(11)))));

CREATE  VIEW raw.mdm_marketing_channel AS
 SELECT src.TVCMID,
        src.CHANNEL,
        src.VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_MARKETING_CHANNEL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_marketing_channel'::varchar(21)))));

CREATE  VIEW raw.mdm_professional AS
 SELECT src.TVCMID,
        src.PROFESSION_CODE,
        src.PROFESSION_CODE_NAME,
        src.PROFESSION_RANK,
        src.STATUS,
        src.PROFESSION_STATUS_NAME,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_PROFESSIONAL_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_professional'::varchar(16)))));

CREATE  VIEW raw.mdm_raw_dea AS
 SELECT src.TVCMID,
        src.IMS_ID,
        src.DEA_NUMBER,
        src.NAME,
        src.ADDITIONAL_COMPANY_INFO,
        src.ADDRESS_LINE1,
        src.ADDRESS_LINE2,
        src.CITY,
        src.STATE,
        src.STATE_NAME,
        src.ZIP,
        src.BUSINESS_ACTIVITY_CODE,
        src.DRUG_SCHEDULES,
        src.EXPIRATION_DATE,
        src.BUSINESS_ACTIVITY_SUB_CODE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_RAW_DEA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_raw_dea'::varchar(11)))));

CREATE  VIEW raw.mdm_regulation AS
 SELECT src.STATE_LICENSE_TYPE_ID,
        src.STATE_LICENSE_TYPE_NAME,
        src.STATE_PRIVILEGE_TYPE_ID,
        src.STATE_LICENSE_PRIVILEGE_TYPE_NAME,
        src.STATE_LICENSE_PRIVILEGE_TYPE_RANK,
        src.STATE_CODE,
        src.STATE_NAME,
        src.STATE_BOARD_ID,
        src.STATE_BOARD_NAME,
        src.CERTIFICATION_CODE,
        src.REQUIRED_SAMPLE_NON_CTRL,
        src.REQUIRED_SAMPLE_CTRL,
        src.RECEIVED_SAMPLE_NON_CTRL,
        src.RECEIVED_SAMPLE_CTRL,
        src.DISTRIBUTED_SAMPLE_NON_CTRL,
        src.DISTRIBUTED_SAMPLE_CTRL,
        src.SAMPLE_DRUG_SCHEDULE_I_FLAG,
        src.SAMPLE_DRUG_SCHEDULE_II_FLAG,
        src.SAMPLE_DRUG_SCHEDULE_III_FLAG,
        src.SAMPLE_DRUG_SCHEDULE_IV_FLAG,
        src.SAMPLE_DRUG_SCHEDULE_V_FLAG,
        src.SAMPLE_DRUG_SCHEDULE_VI_FLAG,
        src.PRESCRIBER_NON_CTRL_FLAG,
        src.PRESCRIBER_APP_REQUIRED_NON_CTRL_FLAG,
        src.PRESCRIBER_CTRL_FLAG,
        src.PRESCRIBER_APP_REQUIRED_CTRL_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_I_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_II_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_III_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_IV_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_V_FLAG,
        src.PRESCRIBER_DRUG_SCHEDULE_VI_FLAG,
        src.SUPERVISORY_RELATIONSHIP_CODE_NON_CTRL,
        src.SUPERVISORY_RELATIONSHIP_CODE_CTRL,
        src.COLLABORATIVE_NON_CTRL,
        src.COLLABORATIVE_CTRL,
        src.INCLUSIONARY,
        src.EXCLUSIONARY,
        src.DELEGATION_NON_CTRL,
        src.DELEGATION_CTRL,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_REGULATION_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_regulation'::varchar(14)))));

CREATE  VIEW raw.mdm_relationship AS
 SELECT src.HIERARCHY_CODE,
        src.HIERARCHY_NAME,
        src.RELATIONSHIP_TYPE_CODE,
        src.RELATIONSHIP_TYPE_NAME,
        src.PARENT_TVCMID,
        src.CHILD_TVCMID,
        src.RELATIONSHIP_STATUS_CODE,
        src.RELATIONSHIP_STATUS_NAME,
        src.RELATIONSHIP_START_DATE,
        src.RELATIONSHIP_END_DATE,
        src.NOTES,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_RELATIONSHIP_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_relationship'::varchar(16)))));

CREATE  VIEW raw.mdm_sample_eligibility AS
 SELECT src.TVCMID,
        src.SLN,
        src.SLN_STATE,
        src.SLN_STATUS_CODE,
        src.SLN_STATUS_DESCRIPTION,
        src.SLN_EXPIRATION_DATE,
        src.TEVA_SAMPLE_ELIGIBILITY_FLAG,
        src.TEVA_SCHEDULE_IV_ELIGIBILITY_FLAG,
        src.TEVA_SCHEDULE_V_ELIGIBILITY_FLAG,
        src.PROFESSION_SHORT_DESCRIPTION,
        src.TEVA_SPECIALTY_CODE,
        src.CERTIFICATION_CODE,
        src.CERTIFICATION_DESCRIPTION,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_SAMPLE_ELIGIBILITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_sample_eligibility'::varchar(22)))));

CREATE  VIEW raw.mdm_source_details AS
 SELECT src.TVCMID,
        src.IDENTIFIER_CODE,
        src.IDENTIFIER_DESCRIPTION,
        src.IDENTIFIER_VALUE,
        src.LEGACY_IDENTIFIER_CODE,
        src.AMA_MD_DO_FLAG,
        src.MAJOR_PROFESSIONAL_ACTIVITY,
        src.MAJOR_PROFESSIONAL_ACTIVITY_DESCRIPTION,
        src.HOSPITAL_HOURS,
        src.AMA_HOSPITAL_ID,
        src.AMA_HOSPITAL_DESCRIPTION,
        src.PRACTICE_TYPE_CODE,
        src.PRACTICE_TYPE_DESCRIPTION,
        src.EMPLOYMENT_TYPE_CODE,
        src.EMPLOYMENT_TYPE_DESCRIPTION,
        src.BIRTH_CITY,
        src.BIRTH_STATE,
        src.BIRTH_COUNTRY_CODE,
        src.BIRTH_COUNTRY_DESCRIPTION,
        src.MEDICAL_SCHOOL_CODE,
        src.MEDICAL_SCHOOL_DESCRIPTION,
        src.GRADUATION_YEAR,
        src.NUMBER_OF_PHYSICIAN_OFFICES,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_SOURCE_DETAILS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_source_details'::varchar(18)))));

CREATE  VIEW raw.mdm_specialty AS
 SELECT src.TVCMID,
        src.SPECIALTY_CODE,
        src.SPECIALTY_CODE_NAME,
        src.SPECIALTY_RANKING,
        src.STATUS,
        src.STATUS_NAME,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_SPECIALTY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_specialty'::varchar(13)))));

CREATE  VIEW raw.mdm_email_preference AS
 SELECT src.TVCMID,
        src.EMAIL,
        src.VALUE,
        src.EFFECTIVE_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_EMAIL_PREFERENCE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_email_preference'::varchar(20)))));

CREATE  VIEW raw.mdm_raw_npi AS
 SELECT src.TVCMID,
        src.NPI_NUMBER,
        src.NPI_FIRST_NAME,
        src.NPI_MIDDLE_NAME,
        src.NPI_LAST_NAME,
        src.PRACTICE_ADDRESS_1,
        src.PRACTICE_ADDRESS_2,
        src.PRACTICE_CITY,
        src.PRACTICE_STATE_NAME,
        src.PRACTICE_POSTAL_CODE,
        src.PRACTICE_COUNTRY_CODE,
        src.PRIMARY_TAXONOMY_CODE,
        src.PRIMARY_TAXONOMY_TYPE,
        src.PRIMARY_TAXONOMY_CLASSIFICATION,
        src.PRIMARY_TAXONOMY_SPECIALTY,
        src.IMS_SPECIALTY_CODE,
        src.IMS_SPECIALTY_DESCRIPTION,
        src.NPI_DEACTIVATION_REASON_CODE,
        src.NPI_DEACTIVATION_DATE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_RAW_NPI_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_raw_npi'::varchar(11)))));

CREATE  VIEW raw.mdm_address AS
 SELECT src.TVCMID,
        src.ADDRESS_ID,
        src.ADDRESS_TYPE,
        src.ADDRESS_TYPE_NAME,
        src.ADDRESS_LINE_1,
        src.ADDRESS_LINE_2,
        src.COUNTY,
        src.CITY,
        src.STATE,
        src.STATE_NAME,
        src.COUNTRY_CODE,
        src.COUNTRY_NAME,
        src.ZIP5_POSTAL_CODE,
        src.ZIP4_POSTAL_EXTENSION_CODE,
        src.ADDRESS_STATUS,
        src.ADDRESS_STATUS_NAME,
        src.ADDRESS_EFFECTIVE_DATE,
        src.MSA_CBSA,
        src.FIPS_STATE_CODE,
        src.FIPS_STATE_DESCRIPTION,
        src.FIPS_COUNTY_CODE,
        src.FIPS_COUNTY_DESCRIPTION,
        src.DELIVERABILITY_CONFIDENCE,
        src.ADDRESS_SETTING_TYPE_CODE,
        src.ADDRESS_SETTING_TYPE_DESCRIPTION,
        src.ADDRESS_CATEGORY_CODE,
        src.ADDRESS_CATEGORY_DESCRIPTION,
        src.ADDRESS_LATITUDE,
        src.ADDRESS_LONGITUDE,
        src.POSTAL_BARCODE,
        src.SINGLE_ADDRESS_INDICATOR,
        src.PRACTICE_LOCATION_CONFIDENCE_INDICATOR,
        src.PRACTICE_LOCATION_RANK,
        src.VALIDATION_MESSAGE,
        src.CREATED_BY,
        src.CREATED_DATE,
        src.UPDATED_BY,
        src.UPDATED_DATE,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_ADDRESS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_address'::varchar(11)))));

CREATE  VIEW raw.mdm_address_link AS
 SELECT src.TVCMID,
        src.ADDRESS_ID,
        src.DSP_ID,
        src.DSP_HCE_ID,
        src.DSP_ADDRESS_ID,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.MDM_ADDRESS_LINK_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'mdm_address_link'::varchar(16)))));

CREATE  VIEW outbound.zzz_gcsf_dmd AS
 SELECT DISTINCT coalesce(ca.territory_number, 'TOHZHZ99'::varchar(8)) AS TERRITORY_NUM,
        dm.ims_outlet_code AS IMS_OUTLET_CODE,
        dm.subcategory_code AS SUBCATEGORY_CODE,
        cat.category_code AS CATEGORY_CODE,
        dm.ims_product_code AS IMS_PRODUCT_CODE,
        ba.teva_product_code AS PRODUCT_CODE,
        to_char(dm.data_date, 'YYYYMM'::varchar(6)) AS MTH_YYYYMM,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), 0)) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH01,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-1))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH02,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-2))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH03,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-3))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH04,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-4))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH05,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-5))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH06,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-6))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH07,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-7))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH08,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-8))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH09,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-9))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH010,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-10))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH011,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-11))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH012,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-12))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH013,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-13))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH014,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-14))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH015,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-15))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH016,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-16))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH017,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-17))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH018,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-18))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH019,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-19))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH020,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-20))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH021,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-21))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH022,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-22))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH023,
        sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-23))) THEN dm.dollars ELSE NULL::float END) AS DOL_MTH024,
        dm.outlet_name AS OUTLET_NAME,
        iom.address AS OUTLET_ADDRESS,
        iom.city AS OUTLET_CITY,
        iom.state AS OUTLET_STATE,
        iom.zip AS OUTLET_ZIP
 FROM (((((((((integration.ddd_md dm JOIN ( SELECT max(ddd.file_id) AS file_id,
        df.feed_id
 FROM (integration.ddd_md ddd JOIN metadata.data_file_metadata df ON ((ddd.file_id = df.file_id)))
 WHERE (df.feed_id = 318)
 GROUP BY df.feed_id) dollar_files ON ((dm.file_id = dollar_files.file_id))) JOIN metadata.data_file_metadata md ON ((dm.file_id = md.file_id))) LEFT  JOIN product.source_product sp ON (((sp.source_product_code = dm.ims_product_code) AND (sp.source_client_num = dm.client_number) AND (sp.source_report_num = dm.report_number) AND (sp.feed_id = md.feed_id) AND (sp.feed_version = md.feed_version)))) JOIN ( SELECT bi.entity_id AS eid,
        b.name AS product_name,
        c.name AS brand_name
 FROM product.basket_item bi, product.basket b, product.basket c
 WHERE ((bi.entity_id = b.basket_id) AND (bi.basket_id = c.basket_id) AND (c.basket_type = 'brand'::varchar(5)) AND (c.name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)])))) y ON ((sp.entity_id = y.eid))) LEFT  JOIN reference.ddd_subcategory sub ON ((dm.subcategory_code = sub.subcategory_code))) LEFT  JOIN reference.ddd_category cat ON ((sub.category_code = cat.category_code))) LEFT  JOIN product.basket ba ON ((sp.entity_id = ba.basket_id))) LEFT  JOIN datamart.ims_outlet_master iom ON ((dm.ims_outlet_code = iom.outlet_number))) LEFT  JOIN ( SELECT current_alignment.zip_code,
        current_alignment.city,
        current_alignment.state_code,
        current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.area_number,
        current_alignment.area_name,
        current_alignment.region_number,
        current_alignment.region_name,
        current_alignment.sales_force_id,
        current_alignment.organization_code,
        current_alignment.inactive_flag,
        current_alignment.comments,
        current_alignment.mirror_flag,
        current_alignment.mirror_territory_number,
        current_alignment.file_id,
        current_alignment.record_id
 FROM datamart.current_alignment
 WHERE ((current_alignment.sales_force_id = 'TO'::varchar(2)) AND (current_alignment.mirror_flag = 'N'::varchar(1)))) ca ON ((dm.outlet_zip = ca.zip_code)))
 GROUP BY ca.territory_number,
          dm.ims_outlet_code,
          dm.subcategory_code,
          cat.category_code,
          dm.ims_product_code,
          ba.teva_product_code,
          to_char(dm.data_date, 'YYYYMM'::varchar(6)),
          dm.outlet_name,
          iom.address,
          iom.city,
          iom.state,
          iom.zip,
          dm.alt_seq_number
 ORDER BY coalesce(ca.territory_number, 'TOHZHZ99'::varchar(8)),
          dm.ims_outlet_code,
          dm.subcategory_code,
          cat.category_code,
          dm.ims_product_code,
          ba.teva_product_code,
          to_char(dm.data_date, 'YYYYMM'::varchar(6)),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), 0)) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-1))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-2))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-3))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-4))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-5))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-6))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-7))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-8))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-9))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-10))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-11))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-12))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-13))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-14))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-15))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-16))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-17))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-18))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-19))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-20))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-21))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-22))) THEN dm.dollars ELSE NULL::float END),
          sum(CASE WHEN (dm.bucket_date = add_months(last_day(dm.data_date), (-23))) THEN dm.dollars ELSE NULL::float END),
          dm.outlet_name,
          iom.address,
          iom.city,
          iom.state,
          iom.zip;

CREATE  VIEW outbound.zzz_REMS_EXTRACT AS
 SELECT coalesce(veeva.id_num, ims.id_num) AS ACCOUNT_ID,
        ca.territory_number,
        R.site_name AS account_name,
        R.address_line_1 AS address1,
        R.address_line_2 AS address2,
        NULL AS address3,
        R.city,
        R.state,
        R.zip,
        'Y'::varchar(1) AS primary_address,
        R.phone AS phone_number,
        fact.ims_org_id AS EXTERNAL_ID,
        'HOSPITAL'::varchar(8) AS CUSTOMER_TYPE,
        NULL AS BPNUMBER,
        NULL AS SUBTYPE,
        NULL AS CM_ID
 FROM ((((datamart.rems_prescriber R LEFT  JOIN ( SELECT current_alignment.zip_code,
        current_alignment.city,
        current_alignment.state_code,
        current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.area_number,
        current_alignment.area_name,
        current_alignment.region_number,
        current_alignment.region_name,
        current_alignment.sales_force_id,
        current_alignment.organization_code,
        current_alignment.inactive_flag,
        current_alignment.comments,
        current_alignment.mirror_flag,
        current_alignment.mirror_territory_number,
        current_alignment.file_id,
        current_alignment.record_id
 FROM datamart.current_alignment) ca ON ((R.zip = ca.zip_code))) LEFT  JOIN hcos.ims_hcos_identifier_fact fact ON (((fact.identifier_id = 15::numeric(18,0)) AND (fact.identifier = R.npi)))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        max(tvcmid_xref.id_num) AS id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'VEEVA_ID'::varchar(8))
 GROUP BY tvcmid_xref.tvcmid) veeva ON ((R.prescriber_tvcmid = veeva.tvcmid))) LEFT  JOIN ( SELECT ims.tvcmid,
        max(ims.id_num) AS id_num
 FROM datamart.tvcmid_xref ims
 WHERE (ims.id_type = 'IMS_ID'::varchar(6))
 GROUP BY ims.tvcmid) ims ON ((R.prescriber_tvcmid = ims.tvcmid)));

CREATE  VIEW teva_ingestion.EXT_TW_ICS_ACCOUNT AS
 SELECT btrim(EXT_TW_ICS_ACCOUNT_src.PARENT_BP_CODE) AS PARENT_BP_CODE,
        btrim(EXT_TW_ICS_ACCOUNT_src.PARENT_BP_NAME) AS PARENT_BP_NAME,
        btrim(EXT_TW_ICS_ACCOUNT_src.ALT_ID) AS ALT_ID,
        btrim(EXT_TW_ICS_ACCOUNT_src.TAX_ID) AS TAX_ID,
        btrim(EXT_TW_ICS_ACCOUNT_src.ADDRESS) AS ADDRESS,
        btrim(EXT_TW_ICS_ACCOUNT_src.CITY) AS CITY,
        btrim(EXT_TW_ICS_ACCOUNT_src.ZIP_CODE) AS ZIP_CODE,
        btrim(EXT_TW_ICS_ACCOUNT_src.STATE) AS STATE,
        btrim(EXT_TW_ICS_ACCOUNT_src.PHONE) AS PHONE,
        btrim(EXT_TW_ICS_ACCOUNT_src.FAX) AS FAX,
        btrim(EXT_TW_ICS_ACCOUNT_src.EMAIL) AS EMAIL,
        btrim(EXT_TW_ICS_ACCOUNT_src.INVOICE_TO_BP_TYPE_CODE) AS INVOICE_TO_BP_TYPE_CODE,
        btrim(EXT_TW_ICS_ACCOUNT_src.BP_CODE) AS BP_CODE,
        btrim(EXT_TW_ICS_ACCOUNT_src.BP_NAME) AS BP_NAME,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_TAX_ID) AS BILL_TO_TAX_ID,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_ADDRESS) AS BILL_TO_ADDRESS,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_CITY) AS BILL_TO_CITY,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_ZIP_CODE) AS BILL_TO_ZIP_CODE,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_STATE) AS BILL_TO_STATE,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_PHONE) AS BILL_TO_PHONE,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_FAX) AS BILL_TO_FAX,
        btrim(EXT_TW_ICS_ACCOUNT_src.BILL_TO_EMAIL) AS BILL_TO_EMAIL,
        btrim(EXT_TW_ICS_ACCOUNT_src.DEA_LICENSE_NUM) AS DEA_LICENSE_NUM,
        btrim(EXT_TW_ICS_ACCOUNT_src.HIN_NUM) AS HIN_NUM,
        btrim(EXT_TW_ICS_ACCOUNT_src.CUSTOMER_340B) AS CUSTOMER_340B,
        EXT_TW_ICS_ACCOUNT_src.batch_id,
        EXT_TW_ICS_ACCOUNT_src.row_id,
        EXT_TW_ICS_ACCOUNT_src.update_ts
 FROM teva_ingestion.EXT_TW_ICS_ACCOUNT_src;

CREATE  VIEW raw.ext_tw_ics_account AS
 SELECT src.PARENT_BP_CODE,
        src.PARENT_BP_NAME,
        src.ALT_ID,
        src.TAX_ID,
        src.ADDRESS,
        src.CITY,
        src.ZIP_CODE,
        src.STATE,
        src.PHONE,
        src.FAX,
        src.EMAIL,
        src.INVOICE_TO_BP_TYPE_CODE,
        src.BP_CODE,
        src.BP_NAME,
        src.BILL_TO_TAX_ID,
        src.BILL_TO_ADDRESS,
        src.BILL_TO_CITY,
        src.BILL_TO_ZIP_CODE,
        src.BILL_TO_STATE,
        src.BILL_TO_PHONE,
        src.BILL_TO_FAX,
        src.BILL_TO_EMAIL,
        src.DEA_LICENSE_NUM,
        src.HIN_NUM,
        src.CUSTOMER_340B,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_TW_ICS_ACCOUNT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_TW_ICS_ACCOUNT'::varchar(18)))));

CREATE  VIEW veeva.v_medical_event AS
 SELECT me.name AS event_name,
        me.start_date_vod__c AS start_date,
        me.end_date_vod__c AS end_date,
        me.demo_led_by_tva__c AS training_led_by,
        me.number_of_attendees_tva__c AS number_of_attendees,
        me.address_tva__c AS address,
        me.city_tva__c AS city,
        me.state_tva__c AS state,
        me.zip_tva__c AS zip,
        me.primary_product__c AS primary_product
 FROM veeva.medical_event me
 WHERE (me.file_id = ( SELECT max(medical_event.file_id) AS max
 FROM veeva.medical_event));

CREATE  VIEW outbound.DDDMD_WEEKLY_UNITS AS
 SELECT EXT_TR_DDDMD_WEEKLY_UNITS_src.client_num,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.report_num,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.subcategory_code,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.alt_seq_num,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.filler01,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.category_code,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.ims_product_code,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.data_date,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk01,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk02,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk03,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk04,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk05,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk06,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk07,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk08,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk09,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk10,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk11,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk12,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk13,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk14,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk15,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk16,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk17,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk18,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk19,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk20,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk21,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk22,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk23,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk24,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk25,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk26,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk27,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk28,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk29,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk30,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk31,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk32,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk33,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk34,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk35,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk36,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk37,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk38,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk39,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk40,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk41,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk42,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk43,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk44,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk45,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk46,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk47,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk48,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk49,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk50,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk51,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk52,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk53,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk54,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk55,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk56,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk57,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk58,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk59,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk60,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk61,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk62,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk63,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk64,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk65,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk66,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk67,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk68,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk69,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk70,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk71,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk72,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk73,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk74,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk75,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk76,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk77,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk78,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk79,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk80,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk81,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk82,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk83,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk84,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk85,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk86,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk87,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk88,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk89,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk90,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk91,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk92,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk93,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk94,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk95,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk96,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk97,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk98,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk99,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk100,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk101,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk102,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk103,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk104,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk105,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.qty_wk106,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_UNITS_src.outlet_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_UNITS_src
 WHERE (EXT_TR_DDDMD_WEEKLY_UNITS_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_UNITS_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_UNITS_src));

CREATE  VIEW outbound.DDDMD_WEEKLY_DEMO_UNITS AS
 SELECT EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.client_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.report_num,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_outlet_code,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_facility_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.ims_prescriber_number,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_address,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.outlet_zip,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_name,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address1,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address2,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address3,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_address4,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_city,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_state,
        EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.facility_prescriber_zip
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src
 WHERE (EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.batch_id IN ( SELECT max(EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src.batch_id) AS max
 FROM teva_ingestion.EXT_TR_DDDMD_WEEKLY_DEMO_UNITS_src));

CREATE  VIEW outbound.zzz_create_paragard_specialty_rx AS
SELECT sh.source_customer_id AS "BP #", NULL AS "Ortho E", sh.customer_name AS "BP Name", coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1) AS "Ship-to Street", sh.ship_to_city AS "Ship-to City", sh.ship_to_state AS "Ship-to State", sh.ship_to_zip AS "Ship-to ZipCd", NULL AS "Ship-to Ctry", NULL AS "Ship-to Phone", NULL AS "Ship-to Fax", NULL AS "Ship-to Email", ad.address AS "Bill-to Street", ad.city AS "Bill-to City", ad.state AS "Bill-to State", ad.zip_code AS "Bill-to ZipCd", NULL AS "Bill-to Ctry", NULL AS "Bill-to Phone", NULL AS "Bill-to Fax", NULL AS "Bill-to Email", CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END AS "Class of Trade", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS "Invoice #", CASE mod(sh.net_cost, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.net_cost)::int)::varchar ELSE rtrim((sh.net_cost)::varchar, '0'::varchar(1)) END AS "Del Amt", to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS "Inv Date", CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END AS Packs, NULL AS UnitPrice, NULL AS Territory, NULL AS "Order Type Cd", NULL AS "Order Type Desc", NULL AS LOBCdDesc, NULL AS PriceMatrixDef, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))) AS ParentBPCd, NULL AS ParentBPCdDesc, NULL AS GrandParentBPCdDesc, NULL AS "PO#", NULL AS "UPS#", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS OrdNbr, NULL AS OrdLnNbr, NULL AS DiscAmt, NULL AS WhseCd, 'ANDA'::varchar(4) AS Data_Source, '51285020401'::varchar(11) AS NDC11_CODE FROM ((datamart.specialty_pharmacy_shipment sh LEFT JOIN (SELECT tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code FROM datamart.tw_address) ad ON ((sh.tw_bill_to_address_id = ad.address_id))) JOIN product.basket b ON ((b.basket_id = sh.basket_id))) WHERE ((b.name = 'PARAGARD'::varchar(8)) AND (b.basket_type = 'product'::varchar(7)) AND (sh.specialty_pharmacy_data_source = 'Anda'::varchar(4))) GROUP BY sh.source_customer_id, NULL, sh.customer_name, coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1), sh.ship_to_city, sh.ship_to_state, sh.ship_to_zip, ad.address, ad.city, ad.state, ad.zip_code, CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END, CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END, CASE mod(sh.net_cost, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.net_cost)::int)::varchar ELSE rtrim((sh.net_cost)::varchar, '0'::varchar(1)) END, to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)), CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END, CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9))));

CREATE  VIEW outbound.axiom_patient_transaction AS
 SELECT specialty_pharmacy_patient_txn.patient_yob,
        specialty_pharmacy_patient_txn.patient_gender,
        specialty_pharmacy_patient_txn.ims_surrogate_patient_id,
        specialty_pharmacy_patient_txn.product_ndc,
        specialty_pharmacy_patient_txn.product_name,
        specialty_pharmacy_patient_txn.product_strength,
        specialty_pharmacy_patient_txn.unit_of_measure,
        specialty_pharmacy_patient_txn.extended_wac_price,
        specialty_pharmacy_patient_txn.transaction_id,
        specialty_pharmacy_patient_txn.patient_status_date,
        specialty_pharmacy_patient_txn.patient_status_,
        specialty_pharmacy_patient_txn.patient_sub_status,
        specialty_pharmacy_patient_txn.specialty_pharmacy_patient_or_case_id,
        specialty_pharmacy_patient_txn.primary_icd_9,
        specialty_pharmacy_patient_txn.primary_icd_10,
        specialty_pharmacy_patient_txn.script_receipt_date,
        specialty_pharmacy_patient_txn.primary_appeal_status,
        specialty_pharmacy_patient_txn.primary_copay_type,
        specialty_pharmacy_patient_txn.primary_deductible,
        specialty_pharmacy_patient_txn.primary_pa_required,
        specialty_pharmacy_patient_txn.primary_copay_amount,
        specialty_pharmacy_patient_txn.primary_payer_name,
        specialty_pharmacy_patient_txn.primary_plan_name,
        specialty_pharmacy_patient_txn.primary_payer_type,
        specialty_pharmacy_patient_txn.primary_plan_type,
        specialty_pharmacy_patient_txn.primary_payer_reject_reason_code,
        specialty_pharmacy_patient_txn.primary_reimbursement_status,
        specialty_pharmacy_patient_txn.primary_reimbursement_status_date,
        specialty_pharmacy_patient_txn.primary_step_therapy_required,
        specialty_pharmacy_patient_txn.secondary_copay_type,
        specialty_pharmacy_patient_txn.secondary_deductible,
        specialty_pharmacy_patient_txn.secondary_pa_required,
        specialty_pharmacy_patient_txn.secondary_copay_amount,
        specialty_pharmacy_patient_txn.secondary_payer_name,
        specialty_pharmacy_patient_txn.secondary_plan_name,
        specialty_pharmacy_patient_txn.secondary_payer_type,
        specialty_pharmacy_patient_txn.secondary_plan_type,
        specialty_pharmacy_patient_txn.secondary_payer_reject_reason_code,
        specialty_pharmacy_patient_txn.secondary_step_therapy_required,
        specialty_pharmacy_patient_txn.ncpdp_number,
        specialty_pharmacy_patient_txn.pharmacy_name,
        specialty_pharmacy_patient_txn.pharmacy_zip,
        specialty_pharmacy_patient_txn.prescribing_physician_first_name,
        specialty_pharmacy_patient_txn.prescribing_physician_last_name,
        specialty_pharmacy_patient_txn.prescribing_physician_middle_initial,
        specialty_pharmacy_patient_txn.prescribing_physician_dea_number,
        specialty_pharmacy_patient_txn.prescribing_physician_me_number,
        specialty_pharmacy_patient_txn.prescribing_physician_npi_number,
        specialty_pharmacy_patient_txn.prescribing_physician_address_1,
        specialty_pharmacy_patient_txn.prescribing_physician_address_2,
        specialty_pharmacy_patient_txn.prescribing_physician_city,
        specialty_pharmacy_patient_txn.prescribing_physician_state,
        specialty_pharmacy_patient_txn.prescribing_physician_zip,
        specialty_pharmacy_patient_txn.number_of_fills_prescribed,
        specialty_pharmacy_patient_txn.number_of_refills_remaining,
        specialty_pharmacy_patient_txn.fill_type,
        specialty_pharmacy_patient_txn.rx_date,
        specialty_pharmacy_patient_txn.rx_number,
        specialty_pharmacy_patient_txn.carrier,
        specialty_pharmacy_patient_txn.date_of_drug_receipt,
        specialty_pharmacy_patient_txn.initial_ship_date,
        specialty_pharmacy_patient_txn.quantity_shipped,
        specialty_pharmacy_patient_txn.out_of_pocket_cost,
        specialty_pharmacy_patient_txn.shipment_date,
        specialty_pharmacy_patient_txn.product_lot_number,
        specialty_pharmacy_patient_txn.program_dispense_type,
        specialty_pharmacy_patient_txn.days_supply_dispensed,
        specialty_pharmacy_patient_txn.primary_payer_pa_outcome,
        specialty_pharmacy_patient_txn.secondary_payer_pa_outcome,
        specialty_pharmacy_patient_txn.rx_communication_method,
        specialty_pharmacy_patient_txn.tertiary_icd_10,
        specialty_pharmacy_patient_txn.ims_file_id,
        specialty_pharmacy_patient_txn.ims_transaction_id,
        specialty_pharmacy_patient_txn.ims_cycle_date,
        specialty_pharmacy_patient_txn.ims_supplier_id,
        specialty_pharmacy_patient_txn.ims_supplier_name,
        specialty_pharmacy_patient_txn.ims_transaction_type_code,
        specialty_pharmacy_patient_txn.ims_duplicate_transaction,
        specialty_pharmacy_patient_txn.ims_prescriber_id,
        specialty_pharmacy_patient_txn.ims_phys_first_name,
        specialty_pharmacy_patient_txn.ims_phys_last_name,
        specialty_pharmacy_patient_txn.ims_phys_address,
        specialty_pharmacy_patient_txn.ims_phys_city,
        specialty_pharmacy_patient_txn.ims_phys_state,
        specialty_pharmacy_patient_txn.ims_phys_zip,
        specialty_pharmacy_patient_txn.ims_phys_specialty,
        specialty_pharmacy_patient_txn.ims_product_id,
        specialty_pharmacy_patient_txn.ims_product_description,
        specialty_pharmacy_patient_txn.ims_outlet_id,
        specialty_pharmacy_patient_txn.ims_outlet_name,
        specialty_pharmacy_patient_txn.ims_outlet_address,
        specialty_pharmacy_patient_txn.ims_outlet_city,
        specialty_pharmacy_patient_txn.ims_outlet_state,
        specialty_pharmacy_patient_txn.ims_outlet_zip,
        specialty_pharmacy_patient_txn.ims_outlet_subcategory,
        specialty_pharmacy_patient_txn.ims_plan_id,
        specialty_pharmacy_patient_txn.ims_plan_name,
        specialty_pharmacy_patient_txn.ims_plan_model,
        specialty_pharmacy_patient_txn.primary_icd10_grouping,
        specialty_pharmacy_patient_txn.primary_icd10_grouping_reason_code,
        specialty_pharmacy_patient_txn.secondary_icd10_grouping,
        specialty_pharmacy_patient_txn.secondary_icd10_grouping_reason_code,
        specialty_pharmacy_patient_txn.ims_ndc_flag,
        specialty_pharmacy_patient_txn.ims_dispensed_date_flag,
        specialty_pharmacy_patient_txn.ims_dispensed_quantity_flag,
        specialty_pharmacy_patient_txn.ims_cost_flag,
        specialty_pharmacy_patient_txn.ims_overall_flag,
        specialty_pharmacy_patient_txn.patient_months,
        specialty_pharmacy_patient_txn.approved_indication,
        specialty_pharmacy_patient_txn.tvcmid,
        specialty_pharmacy_patient_txn.basket_id
 FROM datamart.specialty_pharmacy_patient_txn;

CREATE  VIEW outbound.tc_physician_univ AS
 SELECT dc.npi AS NPI,
        dc.dea_num AS DEA_NUM,
        upper(dc.last_name) AS LAST_NAME,
        upper(dc.first_name) AS FIRST_NAME,
        upper(dc.middle_name) AS MIDDLE_NAME,
        upper(((((dc.ptr_address_1 || ' '::varchar(1)) || dc.ptr_address_2) || ' '::varchar(1)) || dc.ptr_address_3)) AS ADDRESS,
        upper(dc.ptr_city) AS CITY,
        dc.ptr_state AS PTR_STATE,
        dc.ptr_zip AS PTR_ZIP
 FROM ( SELECT prescriber_combined_demographics.sales_force_id,
        prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.veeva_account_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.first_name,
        prescriber_combined_demographics.middle_name,
        prescriber_combined_demographics.last_name,
        prescriber_combined_demographics.ptr_veeva_address_id,
        prescriber_combined_demographics.ptr_address_1,
        prescriber_combined_demographics.ptr_city,
        prescriber_combined_demographics.ptr_state,
        prescriber_combined_demographics.ptr_zip,
        prescriber_combined_demographics.ptr_phone,
        prescriber_combined_demographics.ptr_territory_num,
        prescriber_combined_demographics.ptr_territory_type,
        prescriber_combined_demographics.ptr_address_source,
        prescriber_combined_demographics.ptr_mailable,
        prescriber_combined_demographics.dea_num,
        prescriber_combined_demographics.pdrp_flag,
        prescriber_combined_demographics.pdrp_date,
        prescriber_combined_demographics.np_pa_flag,
        prescriber_combined_demographics.no_spend,
        prescriber_combined_demographics.ama_no_contact_flag,
        prescriber_combined_demographics.email,
        prescriber_combined_demographics.degree,
        prescriber_combined_demographics.npi,
        prescriber_combined_demographics.tvcmid,
        prescriber_combined_demographics.ptr_address_2,
        prescriber_combined_demographics.ptr_address_3,
        row_number() OVER (PARTITION BY prescriber_combined_demographics.sales_force_id, prescriber_combined_demographics.npi ORDER BY prescriber_combined_demographics.ptr_territory_num) AS rnk
 FROM datamart.prescriber_combined_demographics) dc
 WHERE (((dc.ims_id IS NOT NULL) OR (dc.dea_num IS NOT NULL)) AND (dc.sales_force_id = 'TC'::varchar(2)) AND (dc.rnk = 1));

CREATE  VIEW outbound.zzz_cmop_station AS
 SELECT cmop_rx.visn AS VISN,
        cmop_rx.station_number AS STATION_NUMBER,
        cmop_rx.station AS STATION,
        NULL AS STATION_TYPE,
        NULL AS ADDRESS,
        NULL AS CITY,
        NULL AS STATE,
        cmop_rx.zip AS ZIP,
        NULL AS CMOP,
        NULL AS CMOP_DATE,
        to_char(max(cmop_rx.data_month), 'YYYY-MM-DD'::varchar(10)) AS CREATE_DATE,
        to_char((statement_timestamp())::date, 'YYYY-MM-DD'::varchar(10)) AS LAST_UPD_DATE,
        NULL AS STANDARD_ZIP
 FROM (datamart.cmop_rx JOIN ( SELECT cmop_rx.station_number,
        max(cmop_rx.data_month) AS maxmth
 FROM datamart.cmop_rx
 GROUP BY cmop_rx.station_number) ms ON (((ms.maxmth = cmop_rx.data_month) AND (ms.station_number = cmop_rx.station_number))))
 GROUP BY cmop_rx.visn,
          cmop_rx.station_number,
          cmop_rx.station,
          NULL,
          upper(cmop_rx.pharmacy),
          to_char((statement_timestamp())::date, 'YYYY-MM-DD'::varchar(10)),
          cmop_rx.zip;

CREATE  VIEW outbound.hcos_affiliation_type AS
 SELECT EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_ID,
        EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_CODE,
        EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_TYPE_DESC,
        EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_GROUP_CODE,
        EXT_HCOS_AFFILIATION_TYPE_src.AFFIL_GROUP_DESC
 FROM teva_ingestion.EXT_HCOS_AFFILIATION_TYPE_src
 WHERE (EXT_HCOS_AFFILIATION_TYPE_src.batch_id IN ( SELECT max(EXT_HCOS_AFFILIATION_TYPE_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_AFFILIATION_TYPE_src));

CREATE  VIEW outbound.zzz_hcos_business AS
 SELECT EXT_HCOS_BUSINESS_src.IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.BUSINESS_NAME,
        EXT_HCOS_BUSINESS_src.DBA_NAME,
        EXT_HCOS_BUSINESS_src.CARE_OF_LOCATION,
        EXT_HCOS_BUSINESS_src.ADDRESS_ID,
        EXT_HCOS_BUSINESS_src.STF_ID,
        EXT_HCOS_BUSINESS_src.PHYSICAL_ADDR_1,
        EXT_HCOS_BUSINESS_src.PHYSICAL_ADDR_2,
        EXT_HCOS_BUSINESS_src.PHYSICAL_CITY,
        EXT_HCOS_BUSINESS_src.PHYSICAL_STATE,
        EXT_HCOS_BUSINESS_src.PHYSICAL_ZIP,
        EXT_HCOS_BUSINESS_src.POSTAL_ADDR_1,
        EXT_HCOS_BUSINESS_src.POSTAL_ADDR_2,
        EXT_HCOS_BUSINESS_src.POSTAL_CITY,
        EXT_HCOS_BUSINESS_src.POSTAL_STATE,
        EXT_HCOS_BUSINESS_src.POSTAL_ZIP,
        EXT_HCOS_BUSINESS_src.PHONE,
        EXT_HCOS_BUSINESS_src.FAX,
        EXT_HCOS_BUSINESS_src.WEBSITE,
        EXT_HCOS_BUSINESS_src.LATITUDE,
        EXT_HCOS_BUSINESS_src.LONGITUDE,
        EXT_HCOS_BUSINESS_src.OWNER_STATUS,
        EXT_HCOS_BUSINESS_src.PROFIT_STATUS,
        EXT_HCOS_BUSINESS_src.CMI,
        EXT_HCOS_BUSINESS_src.PRIMARY_COT_ID,
        EXT_HCOS_BUSINESS_src.COT_CLASSIFICATION_ID,
        EXT_HCOS_BUSINESS_src.COT_CLASSIFICATION,
        EXT_HCOS_BUSINESS_src.COT_FACILITY_TYPE_ID,
        EXT_HCOS_BUSINESS_src.COT_FACILITY_TYPE,
        EXT_HCOS_BUSINESS_src.COT_SPECIALTY_ID,
        EXT_HCOS_BUSINESS_src.COT_SPECIALTY,
        EXT_HCOS_BUSINESS_src.RECORD_TYPE,
        EXT_HCOS_BUSINESS_src.BED_CLUSTER_ID,
        EXT_HCOS_BUSINESS_src.TTL_LICENSE_BEDS,
        EXT_HCOS_BUSINESS_src.TTL_CENSUS_BEDS,
        EXT_HCOS_BUSINESS_src.TTL_STAFFED_BEDS,
        EXT_HCOS_BUSINESS_src.TEACHING_HOSP,
        EXT_HCOS_BUSINESS_src.COMMHOSP,
        EXT_HCOS_BUSINESS_src.ALL_DDD,
        EXT_HCOS_BUSINESS_src.ALL_NPI,
        EXT_HCOS_BUSINESS_src.HIN,
        EXT_HCOS_BUSINESS_src.DEA,
        EXT_HCOS_BUSINESS_src.MPN,
        EXT_HCOS_BUSINESS_src.MPN_ORDER,
        EXT_HCOS_BUSINESS_src.MSA,
        EXT_HCOS_BUSINESS_src.FIPS_STATE,
        EXT_HCOS_BUSINESS_src.FIPS_COUNTY,
        EXT_HCOS_BUSINESS_src.NUM_OF_PROVIDERS,
        EXT_HCOS_BUSINESS_src.CORP_PARENT_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.CORP_PARENT_NAME,
        EXT_HCOS_BUSINESS_src.OWNER_SUB_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.OWNER_SUB_NAME,
        EXT_HCOS_BUSINESS_src.GPO_PHARMA_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.GPO_PHARMA_NAME,
        EXT_HCOS_BUSINESS_src.GPO_MEDSURG_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.GPO_MEDSURG_NAME,
        EXT_HCOS_BUSINESS_src.PHARMA_PROV_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.PHARMA_PROV_NAME,
        EXT_HCOS_BUSINESS_src.FORMULARY,
        EXT_HCOS_BUSINESS_src.ELECTRONIC_MED_REC,
        EXT_HCOS_BUSINESS_src.EPRESCRIBE,
        EXT_HCOS_BUSINESS_src.PAYPERFORM,
        EXT_HCOS_BUSINESS_src.GENFIRST,
        EXT_HCOS_BUSINESS_src.SREP_ACCESS,
        EXT_HCOS_BUSINESS_src.DEACTIVATION_REASON,
        EXT_HCOS_BUSINESS_src.REFERBACK_IMS_ORG_ID,
        EXT_HCOS_BUSINESS_src.STATUS_INDICATOR
 FROM teva_ingestion.EXT_HCOS_BUSINESS_src
 WHERE (EXT_HCOS_BUSINESS_src.batch_id IN ( SELECT max(EXT_HCOS_BUSINESS_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_BUSINESS_src));

CREATE  VIEW outbound.zzz_hcos_identifier_fact AS
 SELECT EXT_HCOS_IDENTIFIER_FACT_src.IMS_ORG_ID,
        EXT_HCOS_IDENTIFIER_FACT_src.HCE_ID_PRFSNL,
        EXT_HCOS_IDENTIFIER_FACT_src.PROFESSIONAL_ID,
        EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_ID,
        EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER,
        EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_ORDER,
        EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_CATEGORY,
        EXT_HCOS_IDENTIFIER_FACT_src.IDENTIFIER_STATE,
        EXT_HCOS_IDENTIFIER_FACT_src.SRC_STRT_DT,
        EXT_HCOS_IDENTIFIER_FACT_src.SRC_TRMTN_DT,
        EXT_HCOS_IDENTIFIER_FACT_src.SRC_TRMTN_CD
 FROM teva_ingestion.EXT_HCOS_IDENTIFIER_FACT_src
 WHERE (EXT_HCOS_IDENTIFIER_FACT_src.batch_id IN ( SELECT max(EXT_HCOS_IDENTIFIER_FACT_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_IDENTIFIER_FACT_src));

CREATE  VIEW outbound.zzz_hcos_professional AS
 SELECT EXT_HCOS_PROFESSIONAL_src.HCE_ID_PRFSNL,
        EXT_HCOS_PROFESSIONAL_src.PROFESSIONAL_ID,
        EXT_HCOS_PROFESSIONAL_src.FIRST_NAME,
        EXT_HCOS_PROFESSIONAL_src.MIDDLE_NAME,
        EXT_HCOS_PROFESSIONAL_src.LAST_NAME,
        EXT_HCOS_PROFESSIONAL_src.GEN_SUFFIX,
        EXT_HCOS_PROFESSIONAL_src.DESIGNATION,
        EXT_HCOS_PROFESSIONAL_src.GENDER,
        EXT_HCOS_PROFESSIONAL_src.ROLE,
        EXT_HCOS_PROFESSIONAL_src.PRIMARY_SPEC,
        EXT_HCOS_PROFESSIONAL_src.SECONDARY_SPEC,
        EXT_HCOS_PROFESSIONAL_src.TERTIARY_SPEC,
        EXT_HCOS_PROFESSIONAL_src.PRIMARY_PROF_CODE,
        EXT_HCOS_PROFESSIONAL_src.PRIMARY_PROF_DESC,
        EXT_HCOS_PROFESSIONAL_src.IMS_ID,
        EXT_HCOS_PROFESSIONAL_src.UPIN,
        EXT_HCOS_PROFESSIONAL_src.ME,
        EXT_HCOS_PROFESSIONAL_src.ALL_DEA,
        EXT_HCOS_PROFESSIONAL_src.NPI,
        EXT_HCOS_PROFESSIONAL_src.STATUS_DESC
 FROM teva_ingestion.EXT_HCOS_PROFESSIONAL_src
 WHERE (EXT_HCOS_PROFESSIONAL_src.batch_id IN ( SELECT max(EXT_HCOS_PROFESSIONAL_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_PROFESSIONAL_src));

CREATE  VIEW outbound.zzz_hcos_provider_affiliation_fact AS
 SELECT ext_hcos_provider_affiliation_fact_src.IMS_ORG_ID,
        ext_hcos_provider_affiliation_fact_src.HCE_ID_PRFSNL,
        ext_hcos_provider_affiliation_fact_src.PROFESSIONAL_ID,
        ext_hcos_provider_affiliation_fact_src.AFFIL_TYPE_ID,
        ext_hcos_provider_affiliation_fact_src.DEA,
        ext_hcos_provider_affiliation_fact_src.AFFIL_IND,
        ext_hcos_provider_affiliation_fact_src.AFFIL_RANK
 FROM teva_ingestion.ext_hcos_provider_affiliation_fact_src
 WHERE (ext_hcos_provider_affiliation_fact_src.batch_id IN ( SELECT max(ext_hcos_provider_affiliation_fact_src.batch_id) AS max
 FROM teva_ingestion.ext_hcos_provider_affiliation_fact_src));

CREATE  VIEW outbound.zzz_hcos_relationship_fact AS
 SELECT EXT_HCOS_RELATIONSHIP_FACT_src.IMS_ORG_ID_PARENT,
        EXT_HCOS_RELATIONSHIP_FACT_src.IMS_ORG_ID_CHILD,
        EXT_HCOS_RELATIONSHIP_FACT_src.REL_ID,
        EXT_HCOS_RELATIONSHIP_FACT_src.REL_ORDER
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_FACT_src
 WHERE (EXT_HCOS_RELATIONSHIP_FACT_src.batch_id IN ( SELECT max(EXT_HCOS_RELATIONSHIP_FACT_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_FACT_src));

CREATE  VIEW outbound.zzz_hcos_relationship_type AS
 SELECT EXT_HCOS_RELATIONSHIP_TYPE_src.REL_ID,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CODE,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_DESC,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_GROUP_CODE,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_GROUP_DESC,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CATEGORY_CODE,
        EXT_HCOS_RELATIONSHIP_TYPE_src.REL_CATEGORY_DESC
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_TYPE_src
 WHERE (EXT_HCOS_RELATIONSHIP_TYPE_src.batch_id IN ( SELECT max(EXT_HCOS_RELATIONSHIP_TYPE_src.batch_id) AS max
 FROM teva_ingestion.EXT_HCOS_RELATIONSHIP_TYPE_src));

CREATE  VIEW outbound.zzz_hcos_ddd_xfer AS
 SELECT ext_hcos_ddd_xfer_src.IMS_ORG_ID,
        ext_hcos_ddd_xfer_src.HCE_ID_PRFSNL,
        ext_hcos_ddd_xfer_src.PROFESSIONAL_ID,
        ext_hcos_ddd_xfer_src.IDENTIFIER_ID,
        ext_hcos_ddd_xfer_src.IDENTIFIER,
        ext_hcos_ddd_xfer_src.IDENTIFIER_ORDER,
        ext_hcos_ddd_xfer_src.IDENTIFIER_CATEGORY,
        ext_hcos_ddd_xfer_src.IDENTIFIER_STATE,
        ext_hcos_ddd_xfer_src.SRC_STRT_DT,
        ext_hcos_ddd_xfer_src.SRC_TRMTN_DT,
        ext_hcos_ddd_xfer_src.SRC_TRMTN_CD
 FROM teva_ingestion.ext_hcos_ddd_xfer_src
 WHERE (ext_hcos_ddd_xfer_src.batch_id IN ( SELECT max(ext_hcos_ddd_xfer_src.batch_id) AS max
 FROM teva_ingestion.ext_hcos_ddd_xfer_src));

CREATE  VIEW teva_ingestion.EXT_BING_ADS AS
 SELECT CASE WHEN (EXT_BING_ADS_src.gregorian_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_BING_ADS_src.gregorian_date))::date END AS gregorian_date,
        btrim(EXT_BING_ADS_src.account_name) AS account_name,
        btrim(EXT_BING_ADS_src.campaign_name) AS campaign_name,
        btrim(EXT_BING_ADS_src.ad_group) AS ad_group,
        btrim(EXT_BING_ADS_src.keyword) AS keyword,
        btrim(EXT_BING_ADS_src.bid_match_type) AS bid_match_type,
        btrim(EXT_BING_ADS_src.ad_distribution) AS ad_distribution,
        btrim(EXT_BING_ADS_src.current_maximum_cpc) AS current_maximum_cpc,
        btrim(EXT_BING_ADS_src.quality_score) AS quality_score,
        CASE WHEN (EXT_BING_ADS_src.impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.impressions))::int END AS impressions,
        CASE WHEN (EXT_BING_ADS_src.clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.clicks))::int END AS clicks,
        btrim(EXT_BING_ADS_src.ctr_percent) AS ctr_percent,
        btrim(EXT_BING_ADS_src.average_cpc) AS average_cpc,
        btrim(EXT_BING_ADS_src.spend) AS spend,
        btrim(EXT_BING_ADS_src.avg_position) AS avg_position,
        CASE WHEN (EXT_BING_ADS_src.conversions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.conversions))::int END AS conversions,
        btrim(EXT_BING_ADS_src.conversion_rate_percent) AS conversion_rate_percent,
        btrim(EXT_BING_ADS_src.cpa) AS cpa,
        CASE WHEN (EXT_BING_ADS_src.account_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.account_id))::int END AS account_id,
        btrim(EXT_BING_ADS_src.account_number) AS account_number,
        btrim(EXT_BING_ADS_src.account_status) AS account_status,
        CASE WHEN (EXT_BING_ADS_src.ad_group_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.ad_group_id))::int END AS ad_group_id,
        btrim(EXT_BING_ADS_src.ad_group_status) AS ad_group_status,
        CASE WHEN (EXT_BING_ADS_src.ad_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.ad_id))::int END AS ad_id,
        btrim(EXT_BING_ADS_src.landing_page_relevance) AS landing_page_relevance,
        btrim(EXT_BING_ADS_src.ad_type) AS ad_type,
        btrim(EXT_BING_ADS_src.final_app_url) AS final_app_url,
        btrim(EXT_BING_ADS_src.bid_strategy_type) AS bid_strategy_type,
        btrim(EXT_BING_ADS_src.business_category) AS business_category,
        CASE WHEN (EXT_BING_ADS_src.business_category_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.business_category_id))::int END AS business_category_id,
        btrim(EXT_BING_ADS_src.business_listing) AS business_listing,
        CASE WHEN (EXT_BING_ADS_src.business_listing_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.business_listing_id))::int END AS business_listing_id,
        CASE WHEN (EXT_BING_ADS_src.campaign_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.campaign_id))::int END AS campaign_id,
        btrim(EXT_BING_ADS_src.campaign_status) AS campaign_status,
        btrim(EXT_BING_ADS_src.currency_code) AS currency_code,
        btrim(EXT_BING_ADS_src.custom_parameters) AS custom_parameters,
        btrim(EXT_BING_ADS_src.customer) AS customer,
        btrim(EXT_BING_ADS_src.customer_name) AS customer_name,
        btrim(EXT_BING_ADS_src.delivered_match_type) AS delivered_match_type,
        btrim(EXT_BING_ADS_src.destination_url) AS destination_url,
        btrim(EXT_BING_ADS_src.device_os) AS device_os,
        btrim(EXT_BING_ADS_src.device_type) AS device_type,
        btrim(EXT_BING_ADS_src.keyword_relevance) AS keyword_relevance,
        btrim(EXT_BING_ADS_src.final_url) AS final_url,
        CASE WHEN (EXT_BING_ADS_src.keyword_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.keyword_id))::int END AS keyword_id,
        CASE WHEN (EXT_BING_ADS_src.keyword_match_type_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_BING_ADS_src.keyword_match_type_id))::int END AS keyword_match_type_id,
        btrim(EXT_BING_ADS_src.keyword_status) AS keyword_status,
        btrim(EXT_BING_ADS_src.landing_page_user_experience) AS landing_page_user_experience,
        btrim(EXT_BING_ADS_src.language) AS language,
        btrim(EXT_BING_ADS_src.final_mobile_url) AS final_mobile_url,
        btrim(EXT_BING_ADS_src.network) AS network,
        btrim(EXT_BING_ADS_src.pricing_method) AS pricing_method,
        btrim(EXT_BING_ADS_src.quality_impact) AS quality_impact,
        btrim(EXT_BING_ADS_src.top_vs_other) AS top_vs_other,
        btrim(EXT_BING_ADS_src.tracking_template) AS tracking_template,
        btrim(EXT_BING_ADS_src.historic_quality_score) AS historic_quality_score,
        btrim(EXT_BING_ADS_src.historic_keyword_relevance) AS historic_keyword_relevance,
        btrim(EXT_BING_ADS_src.historic_landing_page_relevance) AS historic_landing_page_relevance,
        btrim(EXT_BING_ADS_src.historic_landing_page_user_experience) AS historic_landing_page_user_experience,
        EXT_BING_ADS_src.batch_id,
        EXT_BING_ADS_src.row_id,
        EXT_BING_ADS_src.update_ts
 FROM teva_ingestion.EXT_BING_ADS_src;

CREATE  VIEW teva_ingestion.EXT_DA_BROADCAST_DATA AS
 SELECT CASE WHEN (EXT_DA_BROADCAST_DATA_src.date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_DA_BROADCAST_DATA_src.date))::date END AS date,
        CASE WHEN (EXT_DA_BROADCAST_DATA_src.week_of = ''::varchar) THEN NULL::date ELSE (btrim(EXT_DA_BROADCAST_DATA_src.week_of))::date END AS week_of,
        btrim(EXT_DA_BROADCAST_DATA_src.day) AS day,
        btrim(EXT_DA_BROADCAST_DATA_src.network) AS network,
        btrim(EXT_DA_BROADCAST_DATA_src."time") AS "time",
        btrim(EXT_DA_BROADCAST_DATA_src.program) AS program,
        btrim(EXT_DA_BROADCAST_DATA_src.length) AS length,
        btrim(EXT_DA_BROADCAST_DATA_src.isci_code) AS isci_code,
        CASE WHEN (EXT_DA_BROADCAST_DATA_src.net_dollars = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_DA_BROADCAST_DATA_src.net_dollars))::numeric(18,4) END AS net_dollars,
        btrim(EXT_DA_BROADCAST_DATA_src.wm1834_imps) AS wm1834_imps,
        btrim(EXT_DA_BROADCAST_DATA_src.wm1834_grps) AS wm1834_grps,
        CASE WHEN (EXT_DA_BROADCAST_DATA_src.national_tv_spend_acutalized = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_DA_BROADCAST_DATA_src.national_tv_spend_acutalized))::numeric(18,4) END AS national_tv_spend_acutalized,
        CASE WHEN (EXT_DA_BROADCAST_DATA_src.national_tv_spend_planned = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_DA_BROADCAST_DATA_src.national_tv_spend_planned))::numeric(18,4) END AS national_tv_spend_planned,
        CASE WHEN (EXT_DA_BROADCAST_DATA_src.radio_spend_total = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_DA_BROADCAST_DATA_src.radio_spend_total))::numeric(18,4) END AS radio_spend_total,
        EXT_DA_BROADCAST_DATA_src.batch_id,
        EXT_DA_BROADCAST_DATA_src.row_id,
        EXT_DA_BROADCAST_DATA_src.update_ts
 FROM teva_ingestion.EXT_DA_BROADCAST_DATA_src;

CREATE  VIEW teva_ingestion.EXT_DA_DIGITAL_SPEND_DATA AS
 SELECT btrim(EXT_DA_DIGITAL_SPEND_DATA_src.advertiser_code) AS advertiser_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_client) AS ad_server_client,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_client_name) AS ad_server_client_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_publisher_code) AS ad_server_publisher_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_publisher_name) AS ad_server_publisher_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.advertiser_business_key) AS advertiser_business_key,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.advertiser_name) AS advertiser_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.agency_location) AS agency_location,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.buy_category) AS buy_category,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.buy_type) AS buy_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.campaign_name) AS campaign_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.cost_method) AS cost_method,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.creative_type) AS creative_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.dimension) AS dimension,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.end_date) AS end_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.location) AS location,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.media_code) AS media_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.media_name) AS media_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.month_of_service) AS month_of_service,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.package_type) AS package_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_ad_server) AS placement_ad_server,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_ad_server_instance) AS placement_ad_server_instance,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_end_date) AS placement_end_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_name) AS placement_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_number) AS placement_number,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_positioning) AS placement_positioning,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.served_by) AS served_by,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_site_name) AS placement_site_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_start_date) AS placement_start_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_type) AS placement_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.placement_user) AS placement_user,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.product_business_key) AS product_business_key,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.product_code) AS product_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.product_name) AS product_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.public_id) AS public_id,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.rich_media_accepted) AS rich_media_accepted,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.rich_media_included_in_rate) AS rich_media_included_in_rate,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.supplier_business_key) AS supplier_business_key,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.start_date) AS start_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.supplier_code) AS supplier_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.supplier_name) AS supplier_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.unit_type) AS unit_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_campaign_id) AS ad_server_campaign_id,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ad_server_placement_id) AS ad_server_placement_id,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.package_group_id) AS package_group_id,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.package_group_name) AS package_group_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.estimate_business_key) AS estimate_business_key,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.estimate_code) AS estimate_code,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.estimate_name) AS estimate_name,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.estimate_end_date) AS estimate_end_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.estimate_start_date) AS estimate_start_date,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.third_party_actions) AS third_party_actions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.third_party_clicks) AS third_party_clicks,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.third_party_delivered_cost) AS third_party_delivered_cost,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.third_party_impressions) AS third_party_impressions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.third_party_delivered_units) AS third_party_delivered_units,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_actions) AS planned_actions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_amount) AS planned_amount,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_clicks) AS planned_clicks,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_impressions) AS planned_impressions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.rate) AS rate,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.measurable_impression) AS measurable_impression,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.viewable_impressions) AS viewable_impressions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.eligible_impressions) AS eligible_impressions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.first_party_impressions) AS first_party_impressions,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_units) AS planned_units,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.planned_units_2) AS planned_units_2,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.ordered) AS ordered,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.approved_amount) AS approved_amount,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.inventory_type) AS inventory_type,
        btrim(EXT_DA_DIGITAL_SPEND_DATA_src.order_id) AS order_id,
        EXT_DA_DIGITAL_SPEND_DATA_src.batch_id,
        EXT_DA_DIGITAL_SPEND_DATA_src.row_id,
        EXT_DA_DIGITAL_SPEND_DATA_src.update_ts
 FROM teva_ingestion.EXT_DA_DIGITAL_SPEND_DATA_src;

CREATE  VIEW teva_ingestion.EXT_DA_PRINT_SPEND_DATA AS
 SELECT btrim(EXT_DA_PRINT_SPEND_DATA_src.advertiser_name) AS advertiser_name,
        btrim(EXT_DA_PRINT_SPEND_DATA_src.brand_name) AS brand_name,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.media_billing_estimate = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.media_billing_estimate))::int END AS media_billing_estimate,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.media_type_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.media_type_code))::int END AS media_type_code,
        btrim(EXT_DA_PRINT_SPEND_DATA_src.publisher_identifier) AS publisher_identifier,
        btrim(EXT_DA_PRINT_SPEND_DATA_src.publisher_name) AS publisher_name,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.order_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.order_start_date))::date END AS order_start_date,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.order_close_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.order_close_date))::date END AS order_close_date,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.monthly_total_cost = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.monthly_total_cost))::numeric(18,4) END AS monthly_total_cost,
        CASE WHEN (EXT_DA_PRINT_SPEND_DATA_src.number_of_insertions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DA_PRINT_SPEND_DATA_src.number_of_insertions))::int END AS number_of_insertions,
        EXT_DA_PRINT_SPEND_DATA_src.batch_id,
        EXT_DA_PRINT_SPEND_DATA_src.row_id,
        EXT_DA_PRINT_SPEND_DATA_src.update_ts
 FROM teva_ingestion.EXT_DA_PRINT_SPEND_DATA_src;

CREATE  VIEW teva_ingestion.EXT_DOUBLECLICK_DCM AS
 SELECT btrim(EXT_DOUBLECLICK_DCM_src.advertiser_id) AS advertiser_id,
        btrim(EXT_DOUBLECLICK_DCM_src.advertiser_name) AS advertiser_name,
        btrim(EXT_DOUBLECLICK_DCM_src.brand) AS brand,
        btrim(EXT_DOUBLECLICK_DCM_src.target_audience) AS target_audience,
        btrim(EXT_DOUBLECLICK_DCM_src.campaign_id) AS campaign_id,
        btrim(EXT_DOUBLECLICK_DCM_src.campaign_name) AS campaign_name,
        btrim(EXT_DOUBLECLICK_DCM_src.session_date) AS session_date,
        btrim(EXT_DOUBLECLICK_DCM_src.partner_site_id) AS partner_site_id,
        btrim(EXT_DOUBLECLICK_DCM_src.partner_site_name) AS partner_site_name,
        btrim(EXT_DOUBLECLICK_DCM_src.package_id) AS package_id,
        btrim(EXT_DOUBLECLICK_DCM_src.package_name) AS package_name,
        btrim(EXT_DOUBLECLICK_DCM_src.placement_id) AS placement_id,
        btrim(EXT_DOUBLECLICK_DCM_src.placement_name) AS placement_name,
        btrim(EXT_DOUBLECLICK_DCM_src.placement_pixel_size) AS placement_pixel_size,
        btrim(EXT_DOUBLECLICK_DCM_src.placement_cost_structure) AS placement_cost_structure,
        btrim(EXT_DOUBLECLICK_DCM_src.ad_id) AS ad_id,
        btrim(EXT_DOUBLECLICK_DCM_src.ad_name) AS ad_name,
        btrim(EXT_DOUBLECLICK_DCM_src.ad_type) AS ad_type,
        btrim(EXT_DOUBLECLICK_DCM_src.creative_id) AS creative_id,
        btrim(EXT_DOUBLECLICK_DCM_src.creative_name) AS creative_name,
        btrim(EXT_DOUBLECLICK_DCM_src.creative_type) AS creative_type,
        btrim(EXT_DOUBLECLICK_DCM_src.device_type) AS device_type,
        btrim(EXT_DOUBLECLICK_DCM_src.device_browser) AS device_browser,
        btrim(EXT_DOUBLECLICK_DCM_src.click_thru_url) AS click_thru_url,
        btrim(EXT_DOUBLECLICK_DCM_src.activity_group_id) AS activity_group_id,
        btrim(EXT_DOUBLECLICK_DCM_src.activity_group_name) AS activity_group_name,
        btrim(EXT_DOUBLECLICK_DCM_src.activity_id) AS activity_id,
        btrim(EXT_DOUBLECLICK_DCM_src.activity_name) AS activity_name,
        btrim(EXT_DOUBLECLICK_DCM_src.impressions) AS impressions,
        btrim(EXT_DOUBLECLICK_DCM_src.clicks) AS clicks,
        btrim(EXT_DOUBLECLICK_DCM_src.media_cost) AS media_cost,
        btrim(EXT_DOUBLECLICK_DCM_src.total_conversions) AS total_conversions,
        btrim(EXT_DOUBLECLICK_DCM_src.click_thru_conversions) AS click_thru_conversions,
        btrim(EXT_DOUBLECLICK_DCM_src.view_thru_conversions) AS view_thru_conversions,
        CASE WHEN (EXT_DOUBLECLICK_DCM_src.conversion_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DCM_src.conversion_id))::int END AS conversion_id,
        CASE WHEN (EXT_DOUBLECLICK_DCM_src.keyword_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DCM_src.keyword_id))::int END AS keyword_id,
        CASE WHEN (EXT_DOUBLECLICK_DCM_src.user_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DCM_src.user_id))::int END AS user_id,
        btrim((EXT_DOUBLECLICK_DCM_src.country)::varchar(2)) AS country,
        btrim(EXT_DOUBLECLICK_DCM_src.state_region) AS state_region,
        CASE WHEN (EXT_DOUBLECLICK_DCM_src.city_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DCM_src.city_id))::int END AS city_id,
        EXT_DOUBLECLICK_DCM_src.batch_id,
        EXT_DOUBLECLICK_DCM_src.row_id,
        EXT_DOUBLECLICK_DCM_src.update_ts
 FROM teva_ingestion.EXT_DOUBLECLICK_DCM_src;

CREATE  VIEW teva_ingestion.EXT_DOUBLECLICK_DS_ADS AS
 SELECT btrim(EXT_DOUBLECLICK_DS_ADS_src.session_date) AS session_date,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.brand) AS brand,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.target_audience) AS target_audience,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.search_engine) AS search_engine,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.campaign_id) AS campaign_id,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.campaign_name) AS campaign_name,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.placement_id) AS placement_id,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.placement_name) AS placement_name,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_id) AS keyword_id,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_name) AS keyword_name,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_match_type) AS keyword_match_type,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.url_landing_page) AS url_landing_page,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.device_type) AS device_type,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.impressions) AS impressions,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.clicks) AS clicks,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.media_cost) AS media_cost,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_position) AS keyword_position,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.average_cpc) AS average_cpc,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.average_cpm) AS average_cpm,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.adwords_conversions) AS adwords_conversions,
        CASE WHEN (EXT_DOUBLECLICK_DS_ADS_src.keyword_engine_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_engine_id))::int END AS keyword_engine_id,
        btrim(EXT_DOUBLECLICK_DS_ADS_src.keyword_engine_status) AS keyword_engine_status,
        EXT_DOUBLECLICK_DS_ADS_src.batch_id,
        EXT_DOUBLECLICK_DS_ADS_src.row_id,
        EXT_DOUBLECLICK_DS_ADS_src.update_ts
 FROM teva_ingestion.EXT_DOUBLECLICK_DS_ADS_src;

CREATE  VIEW teva_ingestion.EXT_DOUBLECLICK_DS_CONVERSIONS AS
 SELECT btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.brand) AS brand,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.target_audience) AS target_audience,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.search_engine) AS search_engine,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.campaign_id) AS campaign_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.campaign_name) AS campaign_name,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.placement_id) AS placement_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.placement_name) AS placement_name,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.keyword_id) AS keyword_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.keyword_name) AS keyword_name,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.keyword_match_type) AS keyword_match_type,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.device_type) AS device_type,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.activity_group_id) AS activity_group_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.activity_group_name) AS activity_group_name,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.activity_id) AS activity_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.activity_name) AS activity_name,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.total_conversions) AS total_conversions,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.conversion_date) AS conversion_date,
        CASE WHEN (EXT_DOUBLECLICK_DS_CONVERSIONS_src.visit_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.visit_id))::int END AS visit_id,
        CASE WHEN (EXT_DOUBLECLICK_DS_CONVERSIONS_src.conversion_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.conversion_id))::int END AS conversion_id,
        btrim(EXT_DOUBLECLICK_DS_CONVERSIONS_src.gclid) AS gclid,
        EXT_DOUBLECLICK_DS_CONVERSIONS_src.batch_id,
        EXT_DOUBLECLICK_DS_CONVERSIONS_src.row_id,
        EXT_DOUBLECLICK_DS_CONVERSIONS_src.update_ts
 FROM teva_ingestion.EXT_DOUBLECLICK_DS_CONVERSIONS_src;

CREATE  VIEW teva_ingestion.EXT_GOOGLE_ANALYTICS_360 AS
 SELECT CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.dataset_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.dataset_id))::int END AS dataset_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.full_visitor_id = ''::varchar) THEN NULL::numeric(38,0) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.full_visitor_id))::numeric(38,0) END AS full_visitor_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.visitor_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.visitor_id))::int END AS visitor_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.user_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.user_id))::int END AS user_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.visit_number = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.visit_number))::int END AS visit_number,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.visit_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.visit_id))::int END AS visit_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.visit_start_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.visit_start_time))::int END AS visit_start_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.date))::date END AS date,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_visits = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_visits))::int END AS totals_visits,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_hits = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_hits))::int END AS totals_hits,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_page_views = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_page_views))::int END AS totals_page_views,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_time_on_site = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_time_on_site))::int END AS totals_time_on_site,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_bounces = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_bounces))::int END AS totals_bounces,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_transactions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_transactions))::int END AS totals_transactions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_transaction_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_transaction_revenue))::numeric(18,4) END AS totals_transaction_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_new_visits = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_new_visits))::int END AS totals_new_visits,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_screen_views = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_screen_views))::int END AS totals_screen_views,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_unique_screen_views = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_unique_screen_views))::int END AS totals_unique_screen_views,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_time_on_screen = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_time_on_screen))::int END AS totals_time_on_screen,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.totals_total_transaction_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.totals_total_transaction_revenue))::numeric(18,4) END AS totals_total_transaction_revenue,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_referral_path) AS traffic_source_referral_path,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_campaign) AS traffic_source_campaign,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_source) AS traffic_source_source,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_medium) AS traffic_source_medium,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_keyword) AS traffic_source_keyword,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_ad_content) AS traffic_source_ad_content,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.channel_grouping) AS channel_grouping,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.social_engagement_type) AS social_engagement_type,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_campaign_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_campaign_id))::int END AS traffic_source_adwords_click_info_campaign_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_ad_group_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_ad_group_id))::int END AS traffic_source_adwords_click_info_ad_group_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_creative_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_creative_id))::int END AS traffic_source_adwords_click_info_creative_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_criteria_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_criteria_id))::int END AS traffic_source_adwords_click_info_criteria_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_page = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_page))::int END AS traffic_source_adwords_click_info_page,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_slot) AS traffic_source_adwords_click_info_slot,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_criteria_parameters) AS traffic_source_adwords_click_info_criteria_parameters,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_gcl_id) AS traffic_source_adwords_click_info_gcl_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_customer_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_customer_id))::int END AS traffic_source_adwords_click_info_customer_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_ad_network_type) AS traffic_source_adwords_click_info_ad_network_type,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_targeting_criteria_boom_user_list_id) AS traffic_source_adwords_click_info_targeting_criteria_boom_user_list_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_is_video_ad = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_adwords_click_info_is_video_ad))::boolean END AS traffic_source_adwords_click_info_is_video_ad,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.traffic_source_is_true_direct = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_is_true_direct))::boolean END AS traffic_source_is_true_direct,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.traffic_source_campaign_code) AS traffic_source_campaign_code,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_browser) AS device_browser,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_browser_version) AS device_browser_version,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_browser_size) AS device_browser_size,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_operating_system) AS device_operating_system,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_operating_system_version) AS device_operating_system_version,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.device_is_mobile = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.device_is_mobile))::boolean END AS device_is_mobile,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_mobile_device_branding) AS device_mobile_device_branding,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_mobile_device_model) AS device_mobile_device_model,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_mobile_input_selector) AS device_mobile_input_selector,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_mobile_device_info) AS device_mobile_device_info,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_mobile_device_marketing_name) AS device_mobile_device_marketing_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_flash_version) AS device_flash_version,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.device_java_enabled = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.device_java_enabled))::boolean END AS device_java_enabled,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_language) AS device_language,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_screen_colors) AS device_screen_colors,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_screen_resolution) AS device_screen_resolution,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.device_device_category) AS device_device_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_continent) AS geonetwork_continent,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_subcontinent) AS geonetwork_subcontinent,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_country) AS geonetwork_country,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_region) AS geonetwork_region,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_metro) AS geonetwork_metro,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_city) AS geonetwork_city,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_city_id) AS geonetwork_city_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_network_domain) AS geonetwork_network_domain,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_latitude) AS geonetwork_latitude,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_longitude) AS geonetwork_longitude,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.geonetwork_network_location) AS geonetwork_network_location,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.custom_dimensions_index = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.custom_dimensions_index))::int END AS custom_dimensions_index,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.custom_dimensions_value) AS custom_dimensions_value,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_hit_number = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_hit_number))::int END AS hits_hit_number,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_time))::int END AS hits_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_hour = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_hour))::int END AS hits_hour,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_minute = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_minute))::int END AS hits_minute,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_is_secure = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_is_secure))::boolean END AS hits_is_secure,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_is_interaction = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_is_interaction))::boolean END AS hits_is_interaction,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_is_entrance = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_is_entrance))::boolean END AS hits_is_entrance,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_is_exit = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_is_exit))::boolean END AS hits_is_exit,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_referer) AS hits_referer,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_path) AS hits_page_page_path,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_host_name) AS hits_page_host_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_title) AS hits_page_page_title,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_search_keyword) AS hits_page_search_keyword,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_search_category) AS hits_page_search_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_path_level_one) AS hits_page_page_path_level_one,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_path_level_two) AS hits_page_page_path_level_two,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_path_level_three) AS hits_page_page_path_level_three,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_page_page_path_level_four) AS hits_page_page_path_level_four,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_id) AS hits_transaction_transaction_id,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_revenue))::numeric(18,4) END AS hits_transaction_transaction_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_tax = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_tax))::numeric(18,4) END AS hits_transaction_transaction_tax,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_shipping = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_shipping))::numeric(18,4) END AS hits_transaction_transaction_shipping,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_affiliation) AS hits_transaction_affiliation,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_currency_code) AS hits_transaction_currency_code,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_revenue))::numeric(18,4) END AS hits_transaction_local_transaction_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_tax = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_tax))::numeric(18,4) END AS hits_transaction_local_transaction_tax,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_shipping = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_local_transaction_shipping))::numeric(18,4) END AS hits_transaction_local_transaction_shipping,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_transaction_transaction_coupon) AS hits_transaction_transaction_coupon,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_transaction_id) AS hits_item_transaction_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_product_name) AS hits_item_product_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_product_category) AS hits_item_product_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_product_sku) AS hits_item_product_sku,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_item_item_quantity = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_item_quantity))::int END AS hits_item_item_quantity,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_item_item_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_item_revenue))::numeric(18,4) END AS hits_item_item_revenue,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_currency_code) AS hits_item_currency_code,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_item_local_item_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_item_local_item_revenue))::numeric(18,4) END AS hits_item_local_item_revenue,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_info_content_description) AS hits_content_info_content_description,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_name) AS hits_app_info_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_version) AS hits_app_info_version,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_id) AS hits_app_info_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_installer_id) AS hits_app_info_installer_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_app_installer_id) AS hits_app_info_app_installer_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_app_name) AS hits_app_info_app_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_app_version) AS hits_app_info_app_version,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_app_id) AS hits_app_info_app_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_screen_name) AS hits_app_info_screen_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_landing_screen_name) AS hits_app_info_landing_screen_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_exit_screen_name) AS hits_app_info_exit_screen_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_app_info_screen_depth) AS hits_app_info_screen_depth,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_description) AS hits_exception_info_description,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_is_fatal = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_is_fatal))::boolean END AS hits_exception_info_is_fatal,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_exceptions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_exceptions))::int END AS hits_exception_info_exceptions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_fatal_exceptions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_exception_info_fatal_exceptions))::int END AS hits_exception_info_fatal_exceptions,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_event_info_event_category) AS hits_event_info_event_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_event_info_event_action) AS hits_event_info_event_action,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_event_info_event_label) AS hits_event_info_event_label,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_event_info_event_value = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_event_info_event_value))::int END AS hits_event_info_event_value,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_sku) AS hits_product_product_sku,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_v_two_product_name) AS hits_product_v_two_product_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_v_two_product_category) AS hits_product_v_two_product_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_variant) AS hits_product_product_variant,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_brand) AS hits_product_product_brand,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_revenue))::numeric(18,4) END AS hits_product_product_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_revenue))::numeric(18,4) END AS hits_product_local_product_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_price = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_price))::numeric(18,4) END AS hits_product_product_price,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_price = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_price))::numeric(18,4) END AS hits_product_local_product_price,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_quantity = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_quantity))::int END AS hits_product_product_quantity,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_refund_amount = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_refund_amount))::numeric(18,4) END AS hits_product_product_refund_amount,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_refund_amount = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_local_product_refund_amount))::numeric(18,4) END AS hits_product_local_product_refund_amount,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_is_impression = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_is_impression))::boolean END AS hits_product_is_impression,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_is_click = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_is_click))::boolean END AS hits_product_is_click,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_list_name) AS hits_product_product_list_name,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_list_position = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_product_product_list_position))::int END AS hits_product_product_list_position,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_promo_id) AS hits_promotion_promo_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_promo_name) AS hits_promotion_promo_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_promo_creative) AS hits_promotion_promo_creative,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_promo_position) AS hits_promotion_promo_position,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_action_info_promo_is_view = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_action_info_promo_is_view))::boolean END AS hits_promotion_action_info_promo_is_view,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_action_info_promo_is_click = ''::varchar) THEN NULL::boolean ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_promotion_action_info_promo_is_click))::boolean END AS hits_promotion_action_info_promo_is_click,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_refund_refund_amount = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_refund_refund_amount))::numeric(18,4) END AS hits_refund_refund_amount,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_refund_local_refund_amount = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_refund_local_refund_amount))::numeric(18,4) END AS hits_refund_local_refund_amount,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_ecommerce_action_action_type) AS hits_ecommerce_action_action_type,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_ecommerce_action_step = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_ecommerce_action_step))::int END AS hits_ecommerce_action_step,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_ecommerce_action_option) AS hits_ecommerce_action_option,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_experiment_experiment_id) AS hits_experiment_experiment_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_experiment_experiment_variant) AS hits_experiment_experiment_variant,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_clicks))::int END AS hits_publisher_dfp_clicks,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_impressions))::int END AS hits_publisher_dfp_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_matched_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_matched_queries))::int END AS hits_publisher_dfp_matched_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_measurable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_measurable_impressions))::int END AS hits_publisher_dfp_measurable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_queries))::int END AS hits_publisher_dfp_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_revenue_cpm = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_revenue_cpm))::int END AS hits_publisher_dfp_revenue_cpm,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_revenue_cpc = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_revenue_cpc))::int END AS hits_publisher_dfp_revenue_cpc,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_viewable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_viewable_impressions))::int END AS hits_publisher_dfp_viewable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_pages_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_pages_viewed))::int END AS hits_publisher_dfp_pages_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_clicks))::int END AS hits_publisher_ad_sense_backfill_dfp_clicks,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_impressions))::int END AS hits_publisher_ad_sense_backfill_dfp_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_matched_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_matched_queries))::int END AS hits_publisher_ad_sense_backfill_dfp_matched_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_measurable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_measurable_impressions))::int END AS hits_publisher_ad_sense_backfill_dfp_measurable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_queries))::int END AS hits_publisher_ad_sense_backfill_dfp_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_revenue_cpm = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_revenue_cpm))::int END AS hits_publisher_ad_sense_backfill_dfp_revenue_cpm,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_revenue_cpc = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_revenue_cpc))::int END AS hits_publisher_ad_sense_backfill_dfp_revenue_cpc,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_viewable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_viewable_impressions))::int END AS hits_publisher_ad_sense_backfill_dfp_viewable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_pages_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ad_sense_backfill_dfp_pages_viewed))::int END AS hits_publisher_ad_sense_backfill_dfp_pages_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_clicks))::int END AS hits_publisher_adx_backfill_dfp_clicks,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_impressions))::int END AS hits_publisher_adx_backfill_dfp_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_matched_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_matched_queries))::int END AS hits_publisher_adx_backfill_dfp_matched_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_measurable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_measurable_impressions))::int END AS hits_publisher_adx_backfill_dfp_measurable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_queries))::int END AS hits_publisher_adx_backfill_dfp_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_revenue_cpm = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_revenue_cpm))::int END AS hits_publisher_adx_backfill_dfp_revenue_cpm,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_revenue_cpc = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_revenue_cpc))::int END AS hits_publisher_adx_backfill_dfp_revenue_cpc,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_viewable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_viewable_impressions))::int END AS hits_publisher_adx_backfill_dfp_viewable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_pages_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_backfill_dfp_pages_viewed))::int END AS hits_publisher_adx_backfill_dfp_pages_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_clicks))::int END AS hits_publisher_adx_clicks,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_impressions))::int END AS hits_publisher_adx_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_matched_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_matched_queries))::int END AS hits_publisher_adx_matched_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_measurable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_measurable_impressions))::int END AS hits_publisher_adx_measurable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_queries = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_queries))::int END AS hits_publisher_adx_queries,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_revenue))::numeric(18,4) END AS hits_publisher_adx_revenue,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_viewable_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_viewable_impressions))::int END AS hits_publisher_adx_viewable_impressions,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_pages_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_adx_pages_viewed))::int END AS hits_publisher_adx_pages_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_viewed))::int END AS hits_publisher_ads_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_units_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_units_viewed))::int END AS hits_publisher_ads_units_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_units_matched = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_units_matched))::int END AS hits_publisher_ads_units_matched,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_viewable_ads_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_viewable_ads_viewed))::int END AS hits_publisher_viewable_ads_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_measurable_ads_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_measurable_ads_viewed))::int END AS hits_publisher_measurable_ads_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_pages_viewed = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_pages_viewed))::int END AS hits_publisher_ads_pages_viewed,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_clicked = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_clicked))::int END AS hits_publisher_ads_clicked,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_revenue = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_ads_revenue))::numeric(18,4) END AS hits_publisher_ads_revenue,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_ad_group) AS hits_publisher_dfp_ad_group,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_ad_units) AS hits_publisher_dfp_ad_units,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_publisher_dfp_network_id) AS hits_publisher_dfp_network_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_variables_index) AS hits_custom_variables_index,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_variables_custom_var_name) AS hits_custom_variables_custom_var_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_variables_custom_var_value) AS hits_custom_variables_custom_var_value,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_custom_dimensions_index = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_dimensions_index))::int END AS hits_custom_dimensions_index,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_dimensions_value) AS hits_custom_dimensions_value,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_custom_metrics_index = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_metrics_index))::int END AS hits_custom_metrics_index,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_custom_metrics_value) AS hits_custom_metrics_value,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_type) AS hits_type,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interaction_network) AS hits_social_social_interaction_network,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interaction_action) AS hits_social_social_interaction_action,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interactions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interactions))::int END AS hits_social_social_interactions,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interaction_target) AS hits_social_social_interaction_target,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_network) AS hits_social_social_network,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_social_unique_social_interactions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_unique_social_interactions))::int END AS hits_social_unique_social_interactions,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_has_social_source_referral) AS hits_social_has_social_source_referral,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_social_social_interaction_network_action) AS hits_social_social_interaction_network_action,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pageload_sample = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pageload_sample))::int END AS hits_latency_tracking_pageload_sample,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pageload_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pageload_time))::int END AS hits_latency_tracking_pageload_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pagedown_load_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_pagedown_load_time))::int END AS hits_latency_tracking_pagedown_load_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_redirection_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_redirection_time))::int END AS hits_latency_tracking_redirection_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_speed_metrics_sample = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_speed_metrics_sample))::int END AS hits_latency_tracking_speed_metrics_sample,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_domain_lookup_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_domain_lookup_time))::int END AS hits_latency_tracking_domain_lookup_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_server_connection_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_server_connection_time))::int END AS hits_latency_tracking_server_connection_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_server_response_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_server_response_time))::int END AS hits_latency_tracking_server_response_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_latency_metric_ssample = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_latency_metric_ssample))::int END AS hits_latency_tracking_dom_latency_metric_ssample,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_interactive_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_interactive_time))::int END AS hits_latency_tracking_dom_interactive_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_content_loaded_time = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_dom_content_loaded_time))::int END AS hits_latency_tracking_dom_content_loaded_time,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_value = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_value))::int END AS hits_latency_tracking_user_timing_value,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_sample = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_sample))::int END AS hits_latency_tracking_user_timing_sample,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_variable) AS hits_latency_tracking_user_timing_variable,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_category) AS hits_latency_tracking_user_timing_category,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_latency_tracking_user_timing_label) AS hits_latency_tracking_user_timing_label,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_source_propertyinfo_source_property_display_name) AS hits_source_propertyinfo_source_property_display_name,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_source_propertyinfo_source_property_tracking_id) AS hits_source_propertyinfo_source_property_tracking_id,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_one) AS hits_content_group_content_group_one,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_two) AS hits_content_group_content_group_two,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_three) AS hits_content_group_content_group_three,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_four) AS hits_content_group_content_group_four,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_five) AS hits_content_group_content_group_five,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_previous_content_group_one) AS hits_content_group_previous_content_group_one,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_previous_content_group_two) AS hits_content_group_previous_content_group_two,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_previous_content_group_three) AS hits_content_group_previous_content_group_three,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_previous_content_group_four) AS hits_content_group_previous_content_group_four,
        btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_previous_content_group_five) AS hits_content_group_previous_content_group_five,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_one = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_one))::int END AS hits_content_group_content_group_unique_views_one,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_two = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_two))::int END AS hits_content_group_content_group_unique_views_two,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_three = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_three))::int END AS hits_content_group_content_group_unique_views_three,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_four = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_four))::int END AS hits_content_group_content_group_unique_views_four,
        CASE WHEN (EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_five = ''::varchar) THEN NULL::int ELSE (btrim(EXT_GOOGLE_ANALYTICS_360_src.hits_content_group_content_group_unique_views_five))::int END AS hits_content_group_content_group_unique_views_five,
        EXT_GOOGLE_ANALYTICS_360_src.batch_id,
        EXT_GOOGLE_ANALYTICS_360_src.row_id,
        EXT_GOOGLE_ANALYTICS_360_src.update_ts
 FROM teva_ingestion.EXT_GOOGLE_ANALYTICS_360_src;

CREATE  VIEW teva_ingestion.EXT_INNOVID_DELIVERY AS
 SELECT CASE WHEN (EXT_INNOVID_DELIVERY_src.date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_INNOVID_DELIVERY_src.date))::date END AS date,
        btrim(EXT_INNOVID_DELIVERY_src.advertiser_name) AS advertiser_name,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.advertiser_id = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.advertiser_id))::numeric(37,15) END AS advertiser_id,
        btrim(EXT_INNOVID_DELIVERY_src.campaign_name) AS campaign_name,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.campaign_id = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.campaign_id))::numeric(37,15) END AS campaign_id,
        btrim(EXT_INNOVID_DELIVERY_src.publisher) AS publisher,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.publisher_id = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.publisher_id))::numeric(37,15) END AS publisher_id,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.video_id = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.video_id))::numeric(37,15) END AS video_id,
        btrim(EXT_INNOVID_DELIVERY_src.video_name) AS video_name,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.duration = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.duration))::numeric(37,15) END AS duration,
        btrim(EXT_INNOVID_DELIVERY_src.placement_name) AS placement_name,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.impressions = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.impressions))::numeric(37,15) END AS impressions,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.click_thrus = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.click_thrus))::numeric(37,15) END AS click_thrus,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.awareness = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.awareness))::numeric(37,15) END AS awareness,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.engagement_events = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.engagement_events))::numeric(37,15) END AS engagement_events,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.twenty_five_percent_completion = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.twenty_five_percent_completion))::numeric(37,15) END AS twenty_five_percent_completion,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.fifty_percent_completion = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.fifty_percent_completion))::numeric(37,15) END AS fifty_percent_completion,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.seventy_five_percent_completion = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.seventy_five_percent_completion))::numeric(37,15) END AS seventy_five_percent_completion,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.hundred_perent_completion = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.hundred_perent_completion))::numeric(37,15) END AS hundred_perent_completion,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.companion_impressions = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.companion_impressions))::numeric(37,15) END AS companion_impressions,
        CASE WHEN (EXT_INNOVID_DELIVERY_src.companion_clicks = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INNOVID_DELIVERY_src.companion_clicks))::numeric(37,15) END AS companion_clicks,
        EXT_INNOVID_DELIVERY_src.batch_id,
        EXT_INNOVID_DELIVERY_src.row_id,
        EXT_INNOVID_DELIVERY_src.update_ts
 FROM teva_ingestion.EXT_INNOVID_DELIVERY_src;

CREATE  VIEW teva_ingestion.EXT_INNOVID_VIEWABILITY AS
 SELECT CASE WHEN (EXT_INNOVID_VIEWABILITY_src.date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.date))::date END AS date,
        btrim(EXT_INNOVID_VIEWABILITY_src.advertiser_name) AS advertiser_name,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.advertiser_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.advertiser_id))::int END AS advertiser_id,
        btrim(EXT_INNOVID_VIEWABILITY_src.campaign_name) AS campaign_name,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.campaign_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.campaign_id))::int END AS campaign_id,
        btrim(EXT_INNOVID_VIEWABILITY_src.publisher) AS publisher,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.publisher_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.publisher_id))::int END AS publisher_id,
        btrim(EXT_INNOVID_VIEWABILITY_src.format_type) AS format_type,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.video_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.video_id))::int END AS video_id,
        btrim(EXT_INNOVID_VIEWABILITY_src.video_name) AS video_name,
        btrim(EXT_INNOVID_VIEWABILITY_src.placement_name) AS placement_name,
        btrim(EXT_INNOVID_VIEWABILITY_src.platform_name) AS platform_name,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.impressions))::int END AS impressions,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.click_thrus = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.click_thrus))::int END AS click_thrus,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.awareness = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.awareness))::int END AS awareness,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.engagement_events = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.engagement_events))::int END AS engagement_events,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.twenty_five_percent_completion = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.twenty_five_percent_completion))::int END AS twenty_five_percent_completion,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.fifty_percent_completion = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.fifty_percent_completion))::int END AS fifty_percent_completion,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.seventy_five_percent_completion = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.seventy_five_percent_completion))::int END AS seventy_five_percent_completion,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.hundred_perent_completion = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.hundred_perent_completion))::int END AS hundred_perent_completion,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.companion_impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.companion_impressions))::int END AS companion_impressions,
        CASE WHEN (EXT_INNOVID_VIEWABILITY_src.companion_clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_INNOVID_VIEWABILITY_src.companion_clicks))::int END AS companion_clicks,
        EXT_INNOVID_VIEWABILITY_src.batch_id,
        EXT_INNOVID_VIEWABILITY_src.row_id,
        EXT_INNOVID_VIEWABILITY_src.update_ts
 FROM teva_ingestion.EXT_INNOVID_VIEWABILITY_src;

CREATE  VIEW teva_ingestion.EXT_INTEGRAL_AD_SCIENCE AS
 SELECT btrim(EXT_INTEGRAL_AD_SCIENCE_src.an_id) AS an_id,
        btrim(EXT_INTEGRAL_AD_SCIENCE_src.ext_advertiser_id) AS ext_advertiser_id,
        btrim(EXT_INTEGRAL_AD_SCIENCE_src.ext_campaign_id) AS ext_campaign_id,
        btrim(EXT_INTEGRAL_AD_SCIENCE_src.ext_placement_id) AS ext_placement_id,
        btrim(EXT_INTEGRAL_AD_SCIENCE_src.ext_publisher_id) AS ext_publisher_id,
        CASE WHEN (EXT_INTEGRAL_AD_SCIENCE_src.in_view_one_second = ''::varchar) THEN NULL::numeric(37,15) ELSE (btrim(EXT_INTEGRAL_AD_SCIENCE_src.in_view_one_second))::numeric(37,15) END AS in_view_one_second,
        btrim(EXT_INTEGRAL_AD_SCIENCE_src.in_viewability_sample) AS in_viewability_sample,
        EXT_INTEGRAL_AD_SCIENCE_src.batch_id,
        EXT_INTEGRAL_AD_SCIENCE_src.row_id,
        EXT_INTEGRAL_AD_SCIENCE_src.update_ts
 FROM teva_ingestion.EXT_INTEGRAL_AD_SCIENCE_src;

CREATE  VIEW teva_ingestion.EXT_YAHOO_GEMINI AS
 SELECT CASE WHEN (EXT_YAHOO_GEMINI_src.advertiser_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.advertiser_id))::int END AS advertiser_id,
        CASE WHEN (EXT_YAHOO_GEMINI_src.keyword_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.keyword_id))::int END AS keyword_id,
        CASE WHEN (EXT_YAHOO_GEMINI_src.day = ''::varchar) THEN NULL::date ELSE (btrim(EXT_YAHOO_GEMINI_src.day))::date END AS day,
        btrim(EXT_YAHOO_GEMINI_src.advertiser_name) AS advertiser_name,
        btrim(EXT_YAHOO_GEMINI_src.advertiser_timezone) AS advertiser_timezone,
        btrim(EXT_YAHOO_GEMINI_src.advertiser_currency) AS advertiser_currency,
        CASE WHEN (EXT_YAHOO_GEMINI_src.campaign_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.campaign_id))::int END AS campaign_id,
        btrim(EXT_YAHOO_GEMINI_src.campaign_name) AS campaign_name,
        CASE WHEN (EXT_YAHOO_GEMINI_src.campaign_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_YAHOO_GEMINI_src.campaign_start_date))::date END AS campaign_start_date,
        CASE WHEN (EXT_YAHOO_GEMINI_src.campaign_end_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_YAHOO_GEMINI_src.campaign_end_date))::date END AS campaign_end_date,
        btrim(EXT_YAHOO_GEMINI_src.campaign_status) AS campaign_status,
        btrim(EXT_YAHOO_GEMINI_src.campaign_objective) AS campaign_objective,
        btrim(EXT_YAHOO_GEMINI_src.budget) AS budget,
        btrim(EXT_YAHOO_GEMINI_src.budget_type) AS budget_type,
        CASE WHEN (EXT_YAHOO_GEMINI_src.ad_group_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.ad_group_id))::int END AS ad_group_id,
        CASE WHEN (EXT_YAHOO_GEMINI_src.ad_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.ad_id))::int END AS ad_id,
        btrim(EXT_YAHOO_GEMINI_src.keyword_value) AS keyword_value,
        btrim(EXT_YAHOO_GEMINI_src.keyword_status) AS keyword_status,
        btrim(EXT_YAHOO_GEMINI_src.keyword_match_type) AS keyword_match_type,
        CASE WHEN (EXT_YAHOO_GEMINI_src.impressions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.impressions))::int END AS impressions,
        CASE WHEN (EXT_YAHOO_GEMINI_src.clicks = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.clicks))::int END AS clicks,
        CASE WHEN (EXT_YAHOO_GEMINI_src.ctr = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.ctr))::numeric(18,4) END AS ctr,
        CASE WHEN (EXT_YAHOO_GEMINI_src.conversions = ''::varchar) THEN NULL::int ELSE (btrim(EXT_YAHOO_GEMINI_src.conversions))::int END AS conversions,
        CASE WHEN (EXT_YAHOO_GEMINI_src.spend = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.spend))::numeric(18,4) END AS spend,
        CASE WHEN (EXT_YAHOO_GEMINI_src.average_cpc = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.average_cpc))::numeric(18,4) END AS average_cpc,
        CASE WHEN (EXT_YAHOO_GEMINI_src.average_cost_per_install = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.average_cost_per_install))::numeric(18,4) END AS average_cost_per_install,
        CASE WHEN (EXT_YAHOO_GEMINI_src.average_cpm = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.average_cpm))::numeric(18,4) END AS average_cpm,
        btrim(EXT_YAHOO_GEMINI_src.pricing_type) AS pricing_type,
        btrim(EXT_YAHOO_GEMINI_src.source) AS source,
        btrim(EXT_YAHOO_GEMINI_src.average_position) AS average_position,
        CASE WHEN (EXT_YAHOO_GEMINI_src.max_bid = ''::varchar) THEN NULL::numeric(18,4) ELSE (btrim(EXT_YAHOO_GEMINI_src.max_bid))::numeric(18,4) END AS max_bid,
        EXT_YAHOO_GEMINI_src.batch_id,
        EXT_YAHOO_GEMINI_src.row_id,
        EXT_YAHOO_GEMINI_src.update_ts
 FROM teva_ingestion.EXT_YAHOO_GEMINI_src;

CREATE  VIEW raw.ext_doubleclick_dcm AS
 SELECT src.advertiser_id,
        src.advertiser_name,
        src.brand,
        src.target_audience,
        src.campaign_id,
        src.campaign_name,
        src.session_date,
        src.partner_site_id,
        src.partner_site_name,
        src.package_id,
        src.package_name,
        src.placement_id,
        src.placement_name,
        src.placement_pixel_size,
        src.placement_cost_structure,
        src.ad_id,
        src.ad_name,
        src.ad_type,
        src.creative_id,
        src.creative_name,
        src.creative_type,
        src.device_type,
        src.device_browser,
        src.click_thru_url,
        src.activity_group_id,
        src.activity_group_name,
        src.activity_id,
        src.activity_name,
        src.impressions,
        src.clicks,
        src.media_cost,
        src.total_conversions,
        src.click_thru_conversions,
        src.view_thru_conversions,
        src.conversion_id,
        src.keyword_id,
        src.user_id,
        src.country,
        src.state_region,
        src.city_id,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DOUBLECLICK_DCM_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'DOUBLECLICK_DCM'::varchar(15)))));

CREATE  VIEW raw.ext_doubleclick_ds_ads AS
 SELECT src.session_date,
        src.brand,
        src.target_audience,
        src.search_engine,
        src.campaign_id,
        src.campaign_name,
        src.placement_id,
        src.placement_name,
        src.keyword_id,
        src.keyword_name,
        src.keyword_match_type,
        src.url_landing_page,
        src.device_type,
        src.impressions,
        src.clicks,
        src.media_cost,
        src.keyword_position,
        src.average_cpc,
        src.average_cpm,
        src.adwords_conversions,
        src.keyword_engine_id,
        src.keyword_engine_status,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DOUBLECLICK_DS_ADS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'DOUBLECLICK_DS_ADS'::varchar(18)))));

CREATE  VIEW raw.ext_doubleclick_ds_conversions AS
 SELECT src.brand,
        src.target_audience,
        src.search_engine,
        src.campaign_id,
        src.campaign_name,
        src.placement_id,
        src.placement_name,
        src.keyword_id,
        src.keyword_name,
        src.keyword_match_type,
        src.device_type,
        src.activity_group_id,
        src.activity_group_name,
        src.activity_id,
        src.activity_name,
        src.total_conversions,
        src.conversion_date,
        src.visit_id,
        src.conversion_id,
        src.gclid,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DOUBLECLICK_DS_CONVERSIONS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'DOUBLECLICK_DS_CONVERSIONS'::varchar(26)))));

CREATE  VIEW raw.ext_bing_ads AS
 SELECT src.gregorian_date,
        src.account_name,
        src.campaign_name,
        src.ad_group,
        src.keyword,
        src.bid_match_type,
        src.ad_distribution,
        src.current_maximum_cpc,
        src.quality_score,
        src.impressions,
        src.clicks,
        src.ctr_percent,
        src.average_cpc,
        src.spend,
        src.avg_position,
        src.conversions,
        src.conversion_rate_percent,
        src.cpa,
        src.account_id,
        src.account_number,
        src.account_status,
        src.ad_group_id,
        src.ad_group_status,
        src.ad_id,
        src.landing_page_relevance,
        src.ad_type,
        src.final_app_url,
        src.bid_strategy_type,
        src.business_category,
        src.business_category_id,
        src.business_listing,
        src.business_listing_id,
        src.campaign_id,
        src.campaign_status,
        src.currency_code,
        src.custom_parameters,
        src.customer,
        src.customer_name,
        src.delivered_match_type,
        src.destination_url,
        src.device_os,
        src.device_type,
        src.keyword_relevance,
        src.final_url,
        src.keyword_id,
        src.keyword_match_type_id,
        src.keyword_status,
        src.landing_page_user_experience,
        src.language,
        src.final_mobile_url,
        src.network,
        src.pricing_method,
        src.quality_impact,
        src.top_vs_other,
        src.tracking_template,
        src.historic_quality_score,
        src.historic_keyword_relevance,
        src.historic_landing_page_relevance,
        src.historic_landing_page_user_experience,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_BING_ADS_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_BING_ADS'::varchar(12)))));

CREATE  VIEW raw.ext_da_broadcast_data AS
 SELECT src.date,
        src.week_of,
        src.day,
        src.network,
        src."time",
        src.program,
        src.length,
        src.isci_code,
        src.net_dollars,
        src.wm1834_imps,
        src.wm1834_grps,
        src.national_tv_spend_acutalized,
        src.national_tv_spend_planned,
        src.radio_spend_total,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DA_BROADCAST_DATA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DA_BROADCAST_DATA'::varchar(21)))));

CREATE  VIEW raw.ext_da_digital_spend_data AS
 SELECT src.advertiser_code,
        src.ad_server_client,
        src.ad_server_client_name,
        src.ad_server_publisher_code,
        src.ad_server_publisher_name,
        src.advertiser_business_key,
        src.advertiser_name,
        src.agency_location,
        src.buy_category,
        src.buy_type,
        src.campaign_name,
        src.cost_method,
        src.creative_type,
        src.dimension,
        src.end_date,
        src.location,
        src.media_code,
        src.media_name,
        src.month_of_service,
        src.package_type,
        src.placement_ad_server,
        src.placement_ad_server_instance,
        src.placement_end_date,
        src.placement_name,
        src.placement_number,
        src.placement_positioning,
        src.served_by,
        src.placement_site_name,
        src.placement_start_date,
        src.placement_type,
        src.placement_user,
        src.product_business_key,
        src.product_code,
        src.product_name,
        src.public_id,
        src.rich_media_accepted,
        src.rich_media_included_in_rate,
        src.supplier_business_key,
        src.start_date,
        src.supplier_code,
        src.supplier_name,
        src.unit_type,
        src.ad_server_campaign_id,
        src.ad_server_placement_id,
        src.package_group_id,
        src.package_group_name,
        src.estimate_business_key,
        src.estimate_code,
        src.estimate_name,
        src.estimate_end_date,
        src.estimate_start_date,
        src.third_party_actions,
        src.third_party_clicks,
        src.third_party_delivered_cost,
        src.third_party_impressions,
        src.third_party_delivered_units,
        src.planned_actions,
        src.planned_amount,
        src.planned_clicks,
        src.planned_impressions,
        src.rate,
        src.measurable_impression,
        src.viewable_impressions,
        src.eligible_impressions,
        src.first_party_impressions,
        src.planned_units,
        src.planned_units_2,
        src.ordered,
        src.approved_amount,
        src.inventory_type,
        src.order_id,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DA_DIGITAL_SPEND_DATA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DA_DIGITAL_SPEND_DATA'::varchar(25)))));

CREATE  VIEW raw.ext_da_print_spend_data AS
 SELECT src.advertiser_name,
        src.brand_name,
        src.media_billing_estimate,
        src.media_type_code,
        src.publisher_identifier,
        src.publisher_name,
        src.order_start_date,
        src.order_close_date,
        src.monthly_total_cost,
        src.number_of_insertions,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_DA_PRINT_SPEND_DATA_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_DA_PRINT_SPEND_DATA'::varchar(23)))));

CREATE  VIEW raw.ext_google_analytics_360 AS
 SELECT src.dataset_id,
        src.full_visitor_id,
        src.visitor_id,
        src.user_id,
        src.visit_number,
        src.visit_id,
        src.visit_start_time,
        src.date,
        src.totals_visits,
        src.totals_hits,
        src.totals_page_views,
        src.totals_time_on_site,
        src.totals_bounces,
        src.totals_transactions,
        src.totals_transaction_revenue,
        src.totals_new_visits,
        src.totals_screen_views,
        src.totals_unique_screen_views,
        src.totals_time_on_screen,
        src.totals_total_transaction_revenue,
        src.traffic_source_referral_path,
        src.traffic_source_campaign,
        src.traffic_source_source,
        src.traffic_source_medium,
        src.traffic_source_keyword,
        src.traffic_source_ad_content,
        src.channel_grouping,
        src.social_engagement_type,
        src.traffic_source_adwords_click_info_campaign_id,
        src.traffic_source_adwords_click_info_ad_group_id,
        src.traffic_source_adwords_click_info_creative_id,
        src.traffic_source_adwords_click_info_criteria_id,
        src.traffic_source_adwords_click_info_page,
        src.traffic_source_adwords_click_info_slot,
        src.traffic_source_adwords_click_info_criteria_parameters,
        src.traffic_source_adwords_click_info_gcl_id,
        src.traffic_source_adwords_click_info_customer_id,
        src.traffic_source_adwords_click_info_ad_network_type,
        src.traffic_source_adwords_click_info_targeting_criteria_boom_user_list_id,
        src.traffic_source_adwords_click_info_is_video_ad,
        src.traffic_source_is_true_direct,
        src.traffic_source_campaign_code,
        src.device_browser,
        src.device_browser_version,
        src.device_browser_size,
        src.device_operating_system,
        src.device_operating_system_version,
        src.device_is_mobile,
        src.device_mobile_device_branding,
        src.device_mobile_device_model,
        src.device_mobile_input_selector,
        src.device_mobile_device_info,
        src.device_mobile_device_marketing_name,
        src.device_flash_version,
        src.device_java_enabled,
        src.device_language,
        src.device_screen_colors,
        src.device_screen_resolution,
        src.device_device_category,
        src.geonetwork_continent,
        src.geonetwork_subcontinent,
        src.geonetwork_country,
        src.geonetwork_region,
        src.geonetwork_metro,
        src.geonetwork_city,
        src.geonetwork_city_id,
        src.geonetwork_network_domain,
        src.geonetwork_latitude,
        src.geonetwork_longitude,
        src.geonetwork_network_location,
        src.custom_dimensions_index,
        src.custom_dimensions_value,
        src.hits_hit_number,
        src.hits_time,
        src.hits_hour,
        src.hits_minute,
        src.hits_is_secure,
        src.hits_is_interaction,
        src.hits_is_entrance,
        src.hits_is_exit,
        src.hits_referer,
        src.hits_page_page_path,
        src.hits_page_host_name,
        src.hits_page_page_title,
        src.hits_page_search_keyword,
        src.hits_page_search_category,
        src.hits_page_page_path_level_one,
        src.hits_page_page_path_level_two,
        src.hits_page_page_path_level_three,
        src.hits_page_page_path_level_four,
        src.hits_transaction_transaction_id,
        src.hits_transaction_transaction_revenue,
        src.hits_transaction_transaction_tax,
        src.hits_transaction_transaction_shipping,
        src.hits_transaction_affiliation,
        src.hits_transaction_currency_code,
        src.hits_transaction_local_transaction_revenue,
        src.hits_transaction_local_transaction_tax,
        src.hits_transaction_local_transaction_shipping,
        src.hits_transaction_transaction_coupon,
        src.hits_item_transaction_id,
        src.hits_item_product_name,
        src.hits_item_product_category,
        src.hits_item_product_sku,
        src.hits_item_item_quantity,
        src.hits_item_item_revenue,
        src.hits_item_currency_code,
        src.hits_item_local_item_revenue,
        src.hits_content_info_content_description,
        src.hits_app_info_name,
        src.hits_app_info_version,
        src.hits_app_info_id,
        src.hits_app_info_installer_id,
        src.hits_app_info_app_installer_id,
        src.hits_app_info_app_name,
        src.hits_app_info_app_version,
        src.hits_app_info_app_id,
        src.hits_app_info_screen_name,
        src.hits_app_info_landing_screen_name,
        src.hits_app_info_exit_screen_name,
        src.hits_app_info_screen_depth,
        src.hits_exception_info_description,
        src.hits_exception_info_is_fatal,
        src.hits_exception_info_exceptions,
        src.hits_exception_info_fatal_exceptions,
        src.hits_event_info_event_category,
        src.hits_event_info_event_action,
        src.hits_event_info_event_label,
        src.hits_event_info_event_value,
        src.hits_product_product_sku,
        src.hits_product_v_two_product_name,
        src.hits_product_v_two_product_category,
        src.hits_product_product_variant,
        src.hits_product_product_brand,
        src.hits_product_product_revenue,
        src.hits_product_local_product_revenue,
        src.hits_product_product_price,
        src.hits_product_local_product_price,
        src.hits_product_product_quantity,
        src.hits_product_product_refund_amount,
        src.hits_product_local_product_refund_amount,
        src.hits_product_is_impression,
        src.hits_product_is_click,
        src.hits_product_product_list_name,
        src.hits_product_product_list_position,
        src.hits_promotion_promo_id,
        src.hits_promotion_promo_name,
        src.hits_promotion_promo_creative,
        src.hits_promotion_promo_position,
        src.hits_promotion_action_info_promo_is_view,
        src.hits_promotion_action_info_promo_is_click,
        src.hits_refund_refund_amount,
        src.hits_refund_local_refund_amount,
        src.hits_ecommerce_action_action_type,
        src.hits_ecommerce_action_step,
        src.hits_ecommerce_action_option,
        src.hits_experiment_experiment_id,
        src.hits_experiment_experiment_variant,
        src.hits_publisher_dfp_clicks,
        src.hits_publisher_dfp_impressions,
        src.hits_publisher_dfp_matched_queries,
        src.hits_publisher_dfp_measurable_impressions,
        src.hits_publisher_dfp_queries,
        src.hits_publisher_dfp_revenue_cpm,
        src.hits_publisher_dfp_revenue_cpc,
        src.hits_publisher_dfp_viewable_impressions,
        src.hits_publisher_dfp_pages_viewed,
        src.hits_publisher_ad_sense_backfill_dfp_clicks,
        src.hits_publisher_ad_sense_backfill_dfp_impressions,
        src.hits_publisher_ad_sense_backfill_dfp_matched_queries,
        src.hits_publisher_ad_sense_backfill_dfp_measurable_impressions,
        src.hits_publisher_ad_sense_backfill_dfp_queries,
        src.hits_publisher_ad_sense_backfill_dfp_revenue_cpm,
        src.hits_publisher_ad_sense_backfill_dfp_revenue_cpc,
        src.hits_publisher_ad_sense_backfill_dfp_viewable_impressions,
        src.hits_publisher_ad_sense_backfill_dfp_pages_viewed,
        src.hits_publisher_adx_backfill_dfp_clicks,
        src.hits_publisher_adx_backfill_dfp_impressions,
        src.hits_publisher_adx_backfill_dfp_matched_queries,
        src.hits_publisher_adx_backfill_dfp_measurable_impressions,
        src.hits_publisher_adx_backfill_dfp_queries,
        src.hits_publisher_adx_backfill_dfp_revenue_cpm,
        src.hits_publisher_adx_backfill_dfp_revenue_cpc,
        src.hits_publisher_adx_backfill_dfp_viewable_impressions,
        src.hits_publisher_adx_backfill_dfp_pages_viewed,
        src.hits_publisher_adx_clicks,
        src.hits_publisher_adx_impressions,
        src.hits_publisher_adx_matched_queries,
        src.hits_publisher_adx_measurable_impressions,
        src.hits_publisher_adx_queries,
        src.hits_publisher_adx_revenue,
        src.hits_publisher_adx_viewable_impressions,
        src.hits_publisher_adx_pages_viewed,
        src.hits_publisher_ads_viewed,
        src.hits_publisher_ads_units_viewed,
        src.hits_publisher_ads_units_matched,
        src.hits_publisher_viewable_ads_viewed,
        src.hits_publisher_measurable_ads_viewed,
        src.hits_publisher_ads_pages_viewed,
        src.hits_publisher_ads_clicked,
        src.hits_publisher_ads_revenue,
        src.hits_publisher_dfp_ad_group,
        src.hits_publisher_dfp_ad_units,
        src.hits_publisher_dfp_network_id,
        src.hits_custom_variables_index,
        src.hits_custom_variables_custom_var_name,
        src.hits_custom_variables_custom_var_value,
        src.hits_custom_dimensions_index,
        src.hits_custom_dimensions_value,
        src.hits_custom_metrics_index,
        src.hits_custom_metrics_value,
        src.hits_type,
        src.hits_social_social_interaction_network,
        src.hits_social_social_interaction_action,
        src.hits_social_social_interactions,
        src.hits_social_social_interaction_target,
        src.hits_social_social_network,
        src.hits_social_unique_social_interactions,
        src.hits_social_has_social_source_referral,
        src.hits_social_social_interaction_network_action,
        src.hits_latency_tracking_pageload_sample,
        src.hits_latency_tracking_pageload_time,
        src.hits_latency_tracking_pagedown_load_time,
        src.hits_latency_tracking_redirection_time,
        src.hits_latency_tracking_speed_metrics_sample,
        src.hits_latency_tracking_domain_lookup_time,
        src.hits_latency_tracking_server_connection_time,
        src.hits_latency_tracking_server_response_time,
        src.hits_latency_tracking_dom_latency_metric_ssample,
        src.hits_latency_tracking_dom_interactive_time,
        src.hits_latency_tracking_dom_content_loaded_time,
        src.hits_latency_tracking_user_timing_value,
        src.hits_latency_tracking_user_timing_sample,
        src.hits_latency_tracking_user_timing_variable,
        src.hits_latency_tracking_user_timing_category,
        src.hits_latency_tracking_user_timing_label,
        src.hits_source_propertyinfo_source_property_display_name,
        src.hits_source_propertyinfo_source_property_tracking_id,
        src.hits_content_group_content_group_one,
        src.hits_content_group_content_group_two,
        src.hits_content_group_content_group_three,
        src.hits_content_group_content_group_four,
        src.hits_content_group_content_group_five,
        src.hits_content_group_previous_content_group_one,
        src.hits_content_group_previous_content_group_two,
        src.hits_content_group_previous_content_group_three,
        src.hits_content_group_previous_content_group_four,
        src.hits_content_group_previous_content_group_five,
        src.hits_content_group_content_group_unique_views_one,
        src.hits_content_group_content_group_unique_views_two,
        src.hits_content_group_content_group_unique_views_three,
        src.hits_content_group_content_group_unique_views_four,
        src.hits_content_group_content_group_unique_views_five,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_GOOGLE_ANALYTICS_360_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'GOOGLE_ANALYTICS_360'::varchar(20)))));

CREATE  VIEW raw.ext_innovid_delivery AS
 SELECT src.date,
        src.advertiser_name,
        src.advertiser_id,
        src.campaign_name,
        src.campaign_id,
        src.publisher,
        src.publisher_id,
        src.video_id,
        src.video_name,
        src.duration,
        src.placement_name,
        src.impressions,
        src.click_thrus,
        src.awareness,
        src.engagement_events,
        src.twenty_five_percent_completion,
        src.fifty_percent_completion,
        src.seventy_five_percent_completion,
        src.hundred_perent_completion,
        src.companion_impressions,
        src.companion_clicks,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_INNOVID_DELIVERY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'INNOVID_DELIVERY'::varchar(16)))));

CREATE  VIEW raw.ext_innovid_viewability AS
 SELECT src.date,
        src.advertiser_name,
        src.advertiser_id,
        src.campaign_name,
        src.campaign_id,
        src.publisher,
        src.publisher_id,
        src.format_type,
        src.video_id,
        src.video_name,
        src.placement_name,
        src.platform_name,
        src.impressions,
        src.click_thrus,
        src.awareness,
        src.engagement_events,
        src.twenty_five_percent_completion,
        src.fifty_percent_completion,
        src.seventy_five_percent_completion,
        src.hundred_perent_completion,
        src.companion_impressions,
        src.companion_clicks,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_INNOVID_VIEWABILITY_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'INNOVID_VIEWABILITY'::varchar(19)))));

CREATE  VIEW raw.ext_integral_ad_science AS
 SELECT src.an_id,
        src.ext_advertiser_id,
        src.ext_campaign_id,
        src.ext_placement_id,
        src.ext_publisher_id,
        src.in_view_one_second,
        src.in_viewability_sample,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_INTEGRAL_AD_SCIENCE_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'INTERGRAL_AD_SCIENCE'::varchar(20)))));

CREATE  VIEW raw.ext_yahoo_gemini AS
 SELECT src.advertiser_id,
        src.keyword_id,
        src.day,
        src.advertiser_name,
        src.advertiser_timezone,
        src.advertiser_currency,
        src.campaign_id,
        src.campaign_name,
        src.campaign_start_date,
        src.campaign_end_date,
        src.campaign_status,
        src.campaign_objective,
        src.budget,
        src.budget_type,
        src.ad_group_id,
        src.ad_id,
        src.keyword_value,
        src.keyword_status,
        src.keyword_match_type,
        src.impressions,
        src.clicks,
        src.ctr,
        src.conversions,
        src.spend,
        src.average_cpc,
        src.average_cost_per_install,
        src.average_cpm,
        src.pricing_type,
        src.source,
        src.average_position,
        src.max_bid,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_YAHOO_GEMINI_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'YAHOO_GEMINI'::varchar(12)))));

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_rx AS
 SELECT rx.ims_id AS IMS_ID,
        rx.payment_method AS MOP,
        b.teva_product_code AS PRODUCT_CODE,
        b.name AS PRODUCT_NAME,
        to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS MONTH_ENDING,
        sum(rx.nrx_quantity) AS NRX_QTY,
        sum(rx.trx_quantity) AS TRX_QTY,
        sum(rx.nrx_count) AS NRX_CNT,
        sum(rx.trx_count) AS TRX_CNT
 FROM ((datamart.prescriber_rx rx JOIN reference.ims_report_cnt_qty_mapping m ON (((rx.ims_client_number = m.ims_client_number) AND (rx.ims_report_number_cnt <=> m.ims_report_number_cnt) AND (rx.ims_report_number_qty <=> m.ims_report_number_qty) AND (m.active_flag = 'Y'::char(1))))) JOIN product.basket b ON ((rx.basket_id = b.basket_id)))
 WHERE ((rx.basket_id = ANY (ARRAY[39, 38, 2, 72, 290, 575, 574])) AND (rx.rollup_month >= (last_day(add_months((statement_timestamp())::timestamp, (-26))) + 1)) AND (rx.rollup_month <= last_day(add_months((statement_timestamp())::timestamp, (-2)))) AND (length(rx.ims_id) = 7))
 GROUP BY rx.ims_id,
          rx.payment_method,
          b.teva_product_code,
          b.name,
          rx.rollup_month
 ORDER BY rx.rollup_month DESC;

CREATE  VIEW outbound.zzz_dim_sfa_csf_demo AS
 SELECT "substring"(btrim(acc.me__c), 1, 10) AS me_num,
        acc.id_vod__c AS ims_id,
        acc.npi_vod__c AS npi,
        CASE WHEN (acc.no_contact_tva__c = 'false'::varchar(5)) THEN 'N'::varchar(1) WHEN (acc.no_contact_tva__c = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE NULL END AS no_contact,
        CASE WHEN (acc.account_archived_tva__c = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS archive_flag,
        substr(tsf.territory_vod__c, 1, 2) AS sales_force_id
 FROM (veeva.v_account acc JOIN ( SELECT x.id,
        x.isdeleted,
        x.name,
        x.recordtypeid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.mayedit,
        x.islocked,
        x.account_vod__c,
        x.address_vod__c,
        x.last_activity_date_vod__c,
        x.my_target_vod__c,
        x.route_vod__c,
        x.mobile_id_vod__c,
        x.external_id_vod__c,
        x.territory_vod__c,
        x.ytd_activity_vod__c,
        x.preferred_account_vod__c,
        x.allowed_products_vod__c,
        x.territory_status_tva__c,
        x.territory_specialty_tva__c,
        x.treats_es_osa_tva__c,
        x.osa_patients_tva__c,
        x.account_status_tva__c,
        x.dea_number_tva__c,
        x.synribo_target_tva__c,
        x.treanda_sbo_tva__c,
        x.trisenox_sbo_tva__c,
        x.appt_index_tva__c,
        x.merged_mvn__c,
        x.call_plan_designation_tva__c,
        x.campaign_tva__c,
        x.rnk
 FROM ( SELECT x.id,
        x.isdeleted,
        x.name,
        x.recordtypeid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.mayedit,
        x.islocked,
        x.account_vod__c,
        x.address_vod__c,
        x.last_activity_date_vod__c,
        x.my_target_vod__c,
        x.route_vod__c,
        x.mobile_id_vod__c,
        x.external_id_vod__c,
        x.territory_vod__c,
        x.ytd_activity_vod__c,
        x.preferred_account_vod__c,
        x.allowed_products_vod__c,
        x.territory_status_tva__c,
        x.territory_specialty_tva__c,
        x.treats_es_osa_tva__c,
        x.osa_patients_tva__c,
        x.account_status_tva__c,
        x.dea_number_tva__c,
        x.synribo_target_tva__c,
        x.treanda_sbo_tva__c,
        x.trisenox_sbo_tva__c,
        x.appt_index_tva__c,
        x.merged_mvn__c,
        x.call_plan_designation_tva__c,
        x.campaign_tva__c,
        row_number() OVER (PARTITION BY x.account_vod__c, x.territory_vod__c ORDER BY x.createddate, x.lastmodifieddate, x.systemmodstamp, x.address_vod__c) AS rnk
 FROM veeva.v_tsf x) x
 WHERE (x.rnk = 1)) tsf ON ((tsf.account_vod__c = acc.id)));

CREATE  VIEW outbound.zs_calls_oncology_treanda AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TO'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, d.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6
 FROM ((( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'TREANDA'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num))));

CREATE  VIEW outbound.zs_calls_oncology_synribo AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TO'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, d.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6
 FROM ((( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'SYNRIBO'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num))));

CREATE  VIEW outbound.zs_calls_oncology_granix AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TO'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, d.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6
 FROM ((( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'GRANIX'::varchar(6)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num))));

CREATE  VIEW outbound.zs_calls_oncology_bendeka AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TO'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, d.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6
 FROM ((( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'BENDEKA'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num))));

CREATE  VIEW outbound.zs_monitor_no_contact AS
 SELECT a.sales_force_id,
        b.me__c,
        a.ims_id,
        a.npi
 FROM (datamart.sfa_demographics a JOIN veeva.account b ON ((a.veeva_account_id = b.id)))
 WHERE ((b.no_contact_tva__c IS NOT NULL) AND (b.me__c IS NOT NULL) AND (b.me__c <> '0000000000'::varchar(10)) AND (a.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'TO'::varchar(2)])))
 GROUP BY a.sales_force_id,
          b.me__c,
          a.ims_id,
          a.npi
 ORDER BY b.me__c;

CREATE  VIEW outbound.zs_call_plan_semester_ts_cinqair AS
 SELECT 'TEVA'::varchar(4) AS company,
        'TS'::varchar(2) AS sales_force,
        to_char(m.m01, 'yyyymm'::varchar(6)) AS month_ending,
        coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM,
        d.npi,
        d.ims_id,
        d.VEEVA_ACCOUNT_ID AS veeva_account_id,
        d.tvcmid,
        d.prim_specialty,
        d.ZIP AS zip,
        c.p1_calls_mth1,
        c.p2_calls_mth1,
        c.p3_calls_mth1,
        c.p4_calls_mth1,
        c.p1_calls_mth2,
        c.p2_calls_mth2,
        c.p3_calls_mth2,
        c.p4_calls_mth2,
        c.p1_calls_mth3,
        c.p2_calls_mth3,
        c.p3_calls_mth3,
        c.p4_calls_mth3,
        c.p1_calls_mth4,
        c.p2_calls_mth4,
        c.p3_calls_mth4,
        c.p4_calls_mth4,
        c.p1_calls_mth5,
        c.p2_calls_mth5,
        c.p3_calls_mth5,
        c.p4_calls_mth5,
        c.p1_calls_mth6,
        c.p2_calls_mth6,
        c.p3_calls_mth6,
        c.p4_calls_mth6,
        cp.p1_plan_calls,
        cp.p2_plan_calls,
        cp.p3_plan_calls
 FROM ((((( SELECT calls.veeva_account_id,
        calls.territory_num
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'CINQAIR'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) calls UNION  SELECT call_plan.veeva_account_id,
        call_plan.territory_num
 FROM ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'CINQAIR'::varchar(7)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) call_plan) u JOIN ( SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID,
        sfa_demographics.ims_id,
        sfa_demographics.npi,
        sfa_demographics.tvcmid,
        sfa_demographics.territory_number AS territory_num,
        sfa_demographics.prim_specialty,
        sfa_demographics.zip AS ZIP
 FROM datamart.sfa_demographics
 WHERE ((sfa_demographics.sales_force_id = 'TS'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL))
 GROUP BY sfa_demographics.veeva_account_id,
          sfa_demographics.ims_id,
          sfa_demographics.npi,
          sfa_demographics.tvcmid,
          sfa_demographics.territory_number,
          sfa_demographics.prim_specialty,
          sfa_demographics.zip) d ON (((u.veeva_account_id = d.VEEVA_ACCOUNT_ID) AND (u.territory_num = d.territory_num)))) JOIN ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m ON (true)) LEFT  JOIN ( SELECT c.veeva_account_id,
        c.territory_num,
        c.rep_id,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m01) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth1,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m02) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth2,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m03) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth3,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m04) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth4,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m05) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth5,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.sec_calls ELSE 0 END) AS p2_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.ter_calls ELSE 0 END) AS p3_calls_mth6,
        sum(CASE WHEN (c.call_date = m.m06) THEN c.quad_calls ELSE 0 END) AS p4_calls_mth6
 FROM ( SELECT c.veeva_account_id,
        c.territory_number AS territory_num,
        c.rep_id,
        trunc(c.call_date, 'MON'::varchar(3)) AS call_date,
        sum(CASE WHEN (d.detail_position = 1) THEN 1 ELSE 0 END) AS pri_calls,
        sum(CASE WHEN (d.detail_position = 2) THEN 1 ELSE 0 END) AS sec_calls,
        sum(CASE WHEN (d.detail_position = 3) THEN 1 ELSE 0 END) AS ter_calls,
        sum(CASE WHEN (d.detail_position = 4) THEN 1 ELSE 0 END) AS quad_calls
 FROM datamart.sfa_call c, datamart.sfa_call_detail d, outbound.zs_monitor_sales_force_product z, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (d.sales_force_id = z.sales_force_id) AND (d.basket_name = z.basket_name) AND (c.sales_force_id = 'TS'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (d.product = 'CINQAIR'::varchar(7)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)))
 GROUP BY c.veeva_account_id,
          c.territory_number,
          c.rep_id,
          trunc(c.call_date, 'MON'::varchar(3))) c, ( SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01,
        trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02,
        trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03,
        trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04,
        trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05,
        trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06,
        trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07,
        trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08,
        trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09,
        trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10,
        trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11,
        trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12
 FROM v_catalog.dual) m
 GROUP BY c.veeva_account_id,
          c.territory_num,
          c.rep_id) c ON (((u.veeva_account_id = c.veeva_account_id) AND (u.territory_num = c.territory_num)))) LEFT  JOIN ( SELECT cp.veeva_account_id,
        cp.territory_number AS territory_num,
        sum(cp.p1) AS p1_plan_calls,
        sum(cp.p2) AS p2_plan_calls,
        sum(cp.p3) AS p3_plan_calls
 FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.basket_name = zs.basket_name) AND (cp.period = zs.semester))))
 WHERE ((cp.basket_name = 'CINQAIR'::varchar(7)) AND (cp.sales_force_id = 'TS'::varchar(2)))
 GROUP BY cp.veeva_account_id,
          cp.territory_number) cp ON (((u.veeva_account_id = cp.veeva_account_id) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zzz_asi_rx_by_market_hd AS
SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, CASE WHEN (opn.basket_id IS NOT NULL) THEN opn.outbound_prod_name ELSE btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) END AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, coalesce(replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.indication) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (mth.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((datamart.prescriber_rx rx JOIN (SELECT ims_week_buckets.month_ending, ims_week_buckets.month_bucket FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_ending, ims_week_buckets.month_bucket) mth ON ((rx.rollup_month = mth.month_ending))) JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number <=> axd.ims_client_number) AND (rx.ims_report_number_cnt <=> axd.ims_report_number) AND (rx.ims_id <=> axd.ims_id) AND (rx.ims_product_group <=> axd.ims_product_group) AND (rx.ims_specialty <=> axd.ims_specialty) AND (rx.ims_zip_other <=> axd.ims_zip_other)))) LEFT JOIN reference.outbound_product_name opn ON (((rx.basket_id = opn.basket_id) AND (opn.transform_name = 'ASI_IMS_OBM'::varchar(11))))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '8'::varchar(1))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, CASE WHEN (opn.basket_id IS NOT NULL) THEN opn.outbound_prod_name ELSE btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) END, rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, coalesce(replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.indication), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.knipper_merge AS
 SELECT merges.current_tvcmid AS TVCMIDWinner,
        merges.previous_tvcmid AS TVCMIDLoser,
        to_char((now())::date, 'MM/DD/YYYY'::varchar(10)) AS TVCMIDMergeEffectiveDate
 FROM mdm.merges
 WHERE (merges.file_id = ( SELECT max(merges.file_id) AS MAX
 FROM mdm.merges))
 GROUP BY merges.current_tvcmid,
          merges.previous_tvcmid,
          to_char((now())::date, 'MM/DD/YYYY'::varchar(10));

CREATE  VIEW outbound.knipper_supplemental AS
 SELECT a.tvcmid AS TVCMID,
        CASE WHEN (a.medical_suffix IS NULL) THEN ''::varchar ELSE a.medical_suffix END AS ProfDesig,
        a.first_name AS FName,
        a.last_name AS Lname,
        CASE WHEN (a.middle_name IS NULL) THEN ''::varchar ELSE a.middle_name END AS MI,
        CASE WHEN (a.personal_suffix IS NULL) THEN ''::varchar ELSE a.personal_suffix END AS Suffix,
        CASE WHEN (a.hce_status_desc IS NULL) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'ACTIVE'::varchar(6)) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'INACTIVE'::varchar(8)) THEN 'I'::varchar(1) ELSE 'D'::varchar(1) END AS Status,
        CASE WHEN (a.hce_status_desc = 'PRESUMED DEAD'::varchar(13)) THEN 'D'::varchar(1) WHEN (a.hce_status_desc = 'SEMI-RETIRED'::varchar(12)) THEN 'O'::varchar(1) WHEN (a.hce_status_desc = 'RETIRED'::varchar(7)) THEN 'R'::varchar(1) ELSE ''::varchar END AS DeleteReason,
        CASE WHEN ((a.hce_status_desc IS NULL) OR (a.hce_status_desc <> ALL (ARRAY['ACTIVE'::varchar(8), 'INACTIVE'::varchar(8)]))) THEN to_char(e.last_update_date, 'MM/DD/YYYY'::varchar(10)) ELSE ''::varchar END AS DeleteDate,
        CASE WHEN (a.primary_specialty IS NULL) THEN 'US'::varchar(2) ELSE a.primary_specialty END AS Specialty,
        CASE WHEN (a.address_line1 IS NULL) THEN ''::varchar ELSE a.address_line1 END AS Address1,
        CASE WHEN (a.address_line2 IS NULL) THEN ''::varchar ELSE a.address_line2 END AS Address2,
        ''::varchar AS Address3,
        CASE WHEN (a.city IS NULL) THEN ''::varchar ELSE a.city END AS City,
        CASE WHEN (a.state IS NULL) THEN ''::varchar ELSE a.state END AS State,
        CASE WHEN (a.zip IS NULL) THEN ''::varchar ELSE a.zip END AS Zip,
        CASE WHEN (b.sln IS NULL) THEN ''::varchar ELSE b.sln END AS SLN,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE CASE WHEN (b.sln_status_code = 'A'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END END AS SLNActiveFlag,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE to_char(b.sln_expiration_date, 'MM/DD/YYYY'::varchar(10)) END AS SLNExpirationDate,
        CASE WHEN (c.flag_value = 'Y'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNCWakeFlag,
        CASE WHEN (d.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP
 FROM (((((( SELECT prescriber_rx.tvcmid
 FROM datamart.prescriber_rx
 GROUP BY prescriber_rx.tvcmid) exp JOIN ( SELECT hcp_demo.tvcmid,
        hcp_demo.ims_id,
        hcp_demo.npi,
        hcp_demo.last_name,
        hcp_demo.first_name,
        hcp_demo.middle_name,
        hcp_demo.personal_suffix,
        hcp_demo.medical_suffix,
        hcp_demo.primary_specialty,
        hcp_demo.address_line1,
        hcp_demo.address_line2,
        hcp_demo.city,
        hcp_demo.state_code AS state,
        hcp_demo.zip,
        hcp_demo.business_phone,
        hcp_demo.business_email,
        hcp_demo.hce_status_desc,
        hcp_demo.file_id,
        hcp_demo.record_id,
        hcp_demo.np_pa_flag
 FROM datamart.customer_hcp_demographics hcp_demo
 WHERE (hcp_demo.file_id = ( SELECT max(customer_hcp_demographics.file_id) AS MAX
 FROM datamart.customer_hcp_demographics))) a ON ((exp.tvcmid = a.tvcmid))) JOIN ( SELECT sample_eligibility.sln,
        sample_eligibility.sln_state,
        sample_eligibility.sln_expiration_date,
        sample_eligibility.sln_status_code,
        sample_eligibility.tvcmid
 FROM mdm.sample_eligibility
 WHERE (sample_eligibility.file_id = ( SELECT max(sample_eligibility.file_id) AS MAX
 FROM mdm.sample_eligibility))) b ON (((a.tvcmid = b.tvcmid) AND (a.state = b.sln_state)))) LEFT  JOIN ( SELECT ims_flag.tvcmid,
        ims_flag.flag_type,
        ims_flag.flag_value
 FROM mdm.ims_flag
 WHERE ((ims_flag.file_id = ( SELECT max(ims_flag.file_id) AS MAX
 FROM mdm.ims_flag)) AND (ims_flag.flag_type = 'AMADNC'::varchar(6)))) c ON ((a.tvcmid = c.tvcmid))) LEFT  JOIN datamart.do_not_promote d ON ((a.tvcmid = d.tvcmid))) LEFT  JOIN ( SELECT hcp.updated_date AS last_update_date,
        hcp.tvcmid
 FROM mdm.hcp
 WHERE (hcp.file_id = ( SELECT max(hcp.file_id) AS MAX
 FROM mdm.hcp))) e ON ((a.tvcmid = e.tvcmid)));

CREATE  VIEW outbound.zzz_asi_market_access_hd AS
SELECT coalesce(chd.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(chd.state_code, o.state, pcd.ptr_state, csz.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, coalesce(CASE WHEN (rx.indication IS NOT NULL) THEN b.teva_product_code ELSE rx.ims_product_group END, rx.ims_product_group) AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE 0::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE 0::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE 0::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE 0::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE 0::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE 0::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE 0::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE 0::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE 0::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE 0::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE 0::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE 0::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE 0::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE 0::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE 0::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE 0::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE 0::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE 0::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE 0::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE 0::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE 0::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE 0::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE 0::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE 0::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS trx_024 FROM (((((((datamart.prescriber_rx rx JOIN product.basket b ON ((rx.basket_id = b.basket_id))) JOIN (SELECT ims_week_buckets.month_bucket, ims_week_buckets.month_ending FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_bucket, ims_week_buckets.month_ending) iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN reference.outbound_product_name opn ON (((rx.basket_id = opn.basket_id) AND (opn.transform_name = 'ASI_MKT_ACCESS_OBM'::varchar(18))))) LEFT JOIN datamart.customer_hcp_demographics chd ON ((rx.ims_id = chd.ims_id))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) LEFT JOIN reference.city_state_zip csz ON ((coalesce(chd.zip, o.zip, pcd.ptr_zip) = csz.zip))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '8'::varchar(1))) GROUP BY coalesce(chd.zip, o.zip, pcd.ptr_zip), coalesce(chd.state_code, o.state, pcd.ptr_state, csz.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, coalesce(CASE WHEN (rx.indication IS NOT NULL) THEN b.teva_product_code ELSE rx.ims_product_group END, rx.ims_product_group), to_char(rx.data_date, 'MM/YYYY'::varchar(7));

CREATE  VIEW outbound.zzz_asi_market_access_hd_tot AS
SELECT asi_market_access_hd.report_num, asi_market_access_hd.ims_product_group_num AS product_num, asi_market_access_hd.data_month, sum(asi_market_access_hd.nrx_001) AS total_nrx_01, sum(asi_market_access_hd.nrx_002) AS total_nrx_02, sum(asi_market_access_hd.nrx_003) AS total_nrx_03, sum(asi_market_access_hd.nrx_004) AS total_nrx_04, sum(asi_market_access_hd.nrx_005) AS total_nrx_05, sum(asi_market_access_hd.nrx_006) AS total_nrx_06, sum(asi_market_access_hd.nrx_007) AS total_nrx_07, sum(asi_market_access_hd.nrx_008) AS total_nrx_08, sum(asi_market_access_hd.nrx_009) AS total_nrx_09, sum(asi_market_access_hd.nrx_010) AS total_nrx_10, sum(asi_market_access_hd.nrx_011) AS total_nrx_11, sum(asi_market_access_hd.nrx_012) AS total_nrx_12, sum(asi_market_access_hd.nrx_013) AS total_nrx_13, sum(asi_market_access_hd.nrx_014) AS total_nrx_14, sum(asi_market_access_hd.nrx_015) AS total_nrx_15, sum(asi_market_access_hd.nrx_016) AS total_nrx_16, sum(asi_market_access_hd.nrx_017) AS total_nrx_17, sum(asi_market_access_hd.nrx_018) AS total_nrx_18, sum(asi_market_access_hd.nrx_019) AS total_nrx_19, sum(asi_market_access_hd.nrx_020) AS total_nrx_20, sum(asi_market_access_hd.nrx_021) AS total_nrx_21, sum(asi_market_access_hd.nrx_022) AS total_nrx_22, sum(asi_market_access_hd.nrx_023) AS total_nrx_23, sum(asi_market_access_hd.nrx_024) AS total_nrx_24, sum(asi_market_access_hd.trx_001) AS total_trx_01, sum(asi_market_access_hd.trx_002) AS total_trx_02, sum(asi_market_access_hd.trx_003) AS total_trx_03, sum(asi_market_access_hd.trx_004) AS total_trx_04, sum(asi_market_access_hd.trx_005) AS total_trx_05, sum(asi_market_access_hd.trx_006) AS total_trx_06, sum(asi_market_access_hd.trx_007) AS total_trx_07, sum(asi_market_access_hd.trx_008) AS total_trx_08, sum(asi_market_access_hd.trx_009) AS total_trx_09, sum(asi_market_access_hd.trx_010) AS total_trx_10, sum(asi_market_access_hd.trx_011) AS total_trx_11, sum(asi_market_access_hd.trx_012) AS total_trx_12, sum(asi_market_access_hd.trx_013) AS total_trx_13, sum(asi_market_access_hd.trx_014) AS total_trx_14, sum(asi_market_access_hd.trx_015) AS total_trx_15, sum(asi_market_access_hd.trx_016) AS total_trx_16, sum(asi_market_access_hd.trx_017) AS total_trx_17, sum(asi_market_access_hd.trx_018) AS total_trx_18, sum(asi_market_access_hd.trx_019) AS total_trx_19, sum(asi_market_access_hd.trx_020) AS total_trx_20, sum(asi_market_access_hd.trx_021) AS total_trx_21, sum(asi_market_access_hd.trx_022) AS total_trx_22, sum(asi_market_access_hd.trx_023) AS total_trx_23, sum(asi_market_access_hd.trx_024) AS total_trx_24 FROM outbound.asi_market_access_hd GROUP BY asi_market_access_hd.report_num, asi_market_access_hd.ims_product_group_num, asi_market_access_hd.data_month;

CREATE  VIEW outbound.zzz_ddd_subcategory AS
 SELECT ddd_subcategory.subcategory_code AS SUBCATEGORY_CODE,
        ddd_subcategory.category_code AS CATEGORY_CODE,
        ddd_subcategory.cot_code AS COT_CODE,
        ddd_subcategory.mailorder_flag AS MAILORDER_FLAG,
        ddd_subcategory.nonretail_flag AS NONRETAIL_FLAG,
        ddd_subcategory.outlet_example AS OUTLET_EXAMPLE,
        ddd_subcategory.outlet_description AS OUTLET_DESC,
        ddd_subcategory.outlet_definition AS OUTLET_DEFN,
        ddd_subcategory.mdm_flag AS MDM_FLAG,
        ddd_subcategory.adm_flag AS ADM_FLAG,
        ddd_subcategory.onc_subcat_group AS ONC_SUBCAT_GROUP
 FROM reference.ddd_subcategory;

CREATE  VIEW outbound.activity_centris_speaker_event AS
 SELECT cmid.id_num AS federation_id,
        e.locationtype AS contact,
        'Centris'::varchar(7) AS source,
        to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (b.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Speaker_Program'::varchar(15) AS type,
        'Speaker_Program'::varchar(15) AS native_type,
        ((concat((('Speaker Program-'::varchar(16) || e.product1name) || ','::varchar(1)), (e.totalestimatedparticipantcount)::varchar) || ' Attendees,'::varchar(11)) || CASE WHEN (ea.attended = 1::float) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((datamart.ahm_participant ea JOIN ( SELECT ints.file_id,
        dm.feed_version,
        dm.feed_id,
        ints.interactioncode,
        ints.interactionname,
        ints.interactionstartdate,
        ints.product1id,
        ints.product1name,
        ints.totalestimatedparticipantcount,
        ints.locationtype
 FROM (datamart.ahm_interactions ints JOIN metadata.data_file_metadata dm ON ((dm.file_id = ints.file_id)))
 WHERE (ints.interactionstartdate >= add_months((now())::date, (-6)))
 GROUP BY ints.file_id,
          dm.feed_version,
          dm.feed_id,
          ints.interactioncode,
          ints.interactionname,
          ints.interactionstartdate,
          ints.product1id,
          ints.product1name,
          ints.totalestimatedparticipantcount,
          ints.locationtype) e ON ((ea.interactioncode = e.interactioncode))) JOIN datamart.tvcmid_xref cmid ON (((ea.clientcustomerid = cmid.tvcmid) AND (regexp_count(ea.clientcustomerid, '^[0-9.-]+$'::varchar(10), 1, ''::varchar) = 1) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.source_product sp ON (((upper(e.product1id) = upper(sp.source_product_code)) AND (e.feed_id = sp.feed_id) AND (e.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE (ea.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_PARTICIPANT'::varchar(19)))), 0))
 GROUP BY cmid.id_num,
          e.locationtype,
          'Centris'::varchar(7),
          to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar),
          NULL,
          (b.basket_id)::varchar(20),
          'HCP'::varchar(3),
          'Speaker_Program'::varchar(15),
          ((concat((('Speaker Program-'::varchar(16) || e.product1name) || ','::varchar(1)), (e.totalestimatedparticipantcount)::varchar) || ' Attendees,'::varchar(11)) || CASE WHEN (ea.attended = 1::float) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) EXCEPT  SELECT cmid.id_num AS federation_id,
        e.locationtype AS contact,
        'Centris'::varchar(7) AS source,
        to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (b.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Speaker_Program'::varchar(15) AS type,
        'Speaker_Program'::varchar(15) AS native_type,
        ((concat((('Speaker Program-'::varchar(16) || e.product1name) || ','::varchar(1)), (e.totalestimatedparticipantcount)::varchar) || ' Attendees,'::varchar(11)) || CASE WHEN (ea.attended = 1::float) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((datamart.ahm_participant ea JOIN ( SELECT ints.file_id,
        dm.feed_version,
        dm.feed_id,
        ints.interactioncode,
        ints.interactionname,
        ints.interactionstartdate,
        ints.product1id,
        ints.product1name,
        ints.totalestimatedparticipantcount,
        ints.locationtype
 FROM (datamart.ahm_interactions ints JOIN metadata.data_file_metadata dm ON ((dm.file_id = ints.file_id)))
 WHERE (ints.interactionstartdate >= add_months((now())::date, (-6)))
 GROUP BY ints.file_id,
          dm.feed_version,
          dm.feed_id,
          ints.interactioncode,
          ints.interactionname,
          ints.interactionstartdate,
          ints.product1id,
          ints.product1name,
          ints.totalestimatedparticipantcount,
          ints.locationtype) e ON ((ea.interactioncode = e.interactioncode))) JOIN datamart.tvcmid_xref cmid ON (((ea.clientcustomerid = cmid.tvcmid) AND (regexp_count(ea.clientcustomerid, '^[0-9.-]+$'::varchar(10), 1, ''::varchar) = 1) AND (cmid.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.source_product sp ON (((upper(e.product1id) = upper(sp.source_product_code)) AND (e.feed_id = sp.feed_id) AND (e.feed_version = sp.feed_version)))) LEFT  JOIN product.basket b ON ((sp.entity_id = b.basket_id)))
 WHERE (ea.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_AHM_PARTICIPANT'::varchar(19)))), 0))
 GROUP BY cmid.id_num,
          e.locationtype,
          'Centris'::varchar(7),
          to_char(e.interactionstartdate, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)),
          concat(((concat((e.interactionname || '-'::varchar(1)), (cmid.tvcmid)::varchar) || '-'::varchar(1)) || ea.attended), (e.interactionstartdate)::varchar),
          NULL,
          (b.basket_id)::varchar(20),
          'HCP'::varchar(3),
          'Speaker_Program'::varchar(15),
          ((concat((('Speaker Program-'::varchar(16) || e.product1name) || ','::varchar(1)), (e.totalestimatedparticipantcount)::varchar) || ' Attendees,'::varchar(11)) || CASE WHEN (ea.attended = 1::float) THEN 'Attended'::varchar(8) ELSE 'Invited'::varchar(7) END),
          to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23));

CREATE  VIEW outbound.v_activity_line_item AS
( SELECT activity_line_item_speaker_event.activity,
        activity_line_item_speaker_event."datetime",
        activity_line_item_speaker_event.trackback_id,
        activity_line_item_speaker_event.previous_line_item,
        activity_line_item_speaker_event.level_master_id,
        activity_line_item_speaker_event.type,
        activity_line_item_speaker_event.native_type,
        activity_line_item_speaker_event.details,
        activity_line_item_speaker_event.created,
        activity_line_item_speaker_event.modified
 FROM outbound.activity_line_item_speaker_event UNION ALL  SELECT activity_line_item_non_npp_sample_orders.activity,
        activity_line_item_non_npp_sample_orders."datetime",
        activity_line_item_non_npp_sample_orders.trackback_id,
        activity_line_item_non_npp_sample_orders.previous_line_item,
        activity_line_item_non_npp_sample_orders.level_master_id,
        activity_line_item_non_npp_sample_orders.type,
        activity_line_item_non_npp_sample_orders.native_type,
        activity_line_item_non_npp_sample_orders.details,
        activity_line_item_non_npp_sample_orders.created,
        activity_line_item_non_npp_sample_orders.modified
 FROM outbound.activity_line_item_non_npp_sample_orders) UNION ALL  SELECT activity_line_item_centris_speaker_event.activity,
        activity_line_item_centris_speaker_event."datetime",
        activity_line_item_centris_speaker_event.trackback_id,
        activity_line_item_centris_speaker_event.previous_line_item,
        activity_line_item_centris_speaker_event.level_master_id,
        activity_line_item_centris_speaker_event.type,
        activity_line_item_centris_speaker_event.native_type,
        activity_line_item_centris_speaker_event.details,
        activity_line_item_centris_speaker_event.created,
        activity_line_item_centris_speaker_event.modified
 FROM outbound.activity_line_item_centris_speaker_event;

CREATE  VIEW outbound.zzz_alphascrip_roster AS
 SELECT rep.territory_number AS TerritoryID,
        rep.territory_name AS TerritoryName,
        CASE WHEN (rep.rep_type = 'REP'::varchar(3)) THEN 'Territory'::varchar(9) WHEN (rep.rep_type = 'MGR'::varchar(3)) THEN 'Region'::varchar(6) WHEN (rep.rep_type = 'DIR'::varchar(3)) THEN 'Area'::varchar(4) WHEN (rep.rep_type = 'VP'::varchar(2)) THEN 'National'::varchar(8) ELSE NULL END AS Territorytype,
        rep.last_name AS Territoryincumbentlastname,
        rep.first_name AS Territoryincumbentfirstname,
        rep.email AS Territoryincumbentbusinessemailaddress
 FROM datamart.roster rep
 WHERE ((rep.employee_id IS NOT NULL) AND (rep.hr_status = 'Active'::varchar(6)) AND (rep.sales_force_id = 'TP'::varchar(2)))
 GROUP BY rep.territory_number,
          rep.territory_name,
          CASE WHEN (rep.rep_type = 'REP'::varchar(3)) THEN 'Territory'::varchar(9) WHEN (rep.rep_type = 'MGR'::varchar(3)) THEN 'Region'::varchar(6) WHEN (rep.rep_type = 'DIR'::varchar(3)) THEN 'Area'::varchar(4) WHEN (rep.rep_type = 'VP'::varchar(2)) THEN 'National'::varchar(8) ELSE NULL END,
          rep.last_name,
          rep.first_name,
          rep.email;

CREATE  VIEW outbound.zzz_zs_access_monito_calls_by_specialty_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_call_data_cns AS
SELECT 'TEVA'::varchar(4) AS company, d.sales_force_id AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, cp.plan_calls AS total_calls, to_char(m.m04, 'yyyymm'::varchar(6)) AS start_month, to_char(m.m01, 'yyyymm'::varchar(6)) AS end_month, '4'::varchar(1) AS duration, CASE WHEN (cp.tvcmid IS NULL) THEN '0'::varchar(1) ELSE '1'::varchar(1) END AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_call_data_oncology AS
SELECT 'TEVA'::varchar(4) AS company, 'TO'::varchar(2) AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, NULL AS total_calls, NULL AS start_month, NULL AS end_month, '4'::varchar(1) AS duration, '1'::varchar(1) AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.period = zs.semester)))) WHERE (cp.sales_force_id = 'TO'::varchar(2)) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.period = zs.semester)))) WHERE (cp.sales_force_id = 'TO'::varchar(2)) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_call_data_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, d.sales_force_id AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, cp.plan_calls AS total_calls, to_char(m.m04, 'yyyymm'::varchar(6)) AS start_month, to_char(m.m01, 'yyyymm'::varchar(6)) AS end_month, '4'::varchar(1) AS duration, CASE WHEN (cp.tvcmid IS NULL) THEN '0'::varchar(1) ELSE '1'::varchar(1) END AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_oncology AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_no_contact_cns AS
 SELECT a.sales_force_id,
        b.me__c AS me_number,
        a.npi,
        b.id AS veeva_id,
        a.tvcmid,
        a.ims_id
 FROM (datamart.sfa_demographics a JOIN veeva.account b ON ((a.veeva_account_id = b.id)))
 WHERE ((b.no_contact_tva__c IS NOT NULL) AND (a.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])))
 GROUP BY a.sales_force_id,
          b.me__c,
          a.npi,
          b.id,
          a.tvcmid,
          a.ims_id
 ORDER BY b.me__c;

CREATE  VIEW outbound.zs_access_monitor_no_contact_oncology AS
 SELECT a.sales_force_id,
        b.me__c AS me_number,
        a.npi,
        b.id AS veeva_id,
        a.tvcmid,
        a.ims_id
 FROM (datamart.sfa_demographics a JOIN veeva.account b ON ((a.veeva_account_id = b.id)))
 WHERE ((b.no_contact_tva__c IS NOT NULL) AND (a.sales_force_id = 'TO'::varchar(2)))
 GROUP BY a.sales_force_id,
          b.me__c,
          a.npi,
          b.id,
          a.tvcmid,
          a.ims_id
 ORDER BY b.me__c;

CREATE  VIEW outbound.activity_copay AS
 SELECT fed.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        (((c.file_id)::varchar || '-'::varchar(1)) || (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (brand.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((((('Voucher/Coupon Redemption - '::varchar(28) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cvp.program_description, ''::varchar)) || ','::varchar(1)) || c.redemption_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) JOIN datamart.tvcmid_xref fed ON (((c.physician_tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_id)))
 WHERE ((c.file_id > coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (c.fill_date >= add_months((now())::date, (-6)))) EXCEPT  SELECT fed.id_num AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        (((c.file_id)::varchar || '-'::varchar(1)) || (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (brand.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((((('Voucher/Coupon Redemption - '::varchar(28) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cvp.program_description, ''::varchar)) || ','::varchar(1)) || c.redemption_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS modified
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) JOIN datamart.tvcmid_xref fed ON (((c.physician_tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_id)))
 WHERE ((c.file_id <= coalesce(( SELECT max(teva_transform_control.batch_id) AS max
 FROM teva_transform.teva_transform_control
 WHERE ((teva_transform_control.transform_name = 'ACTIVITY_HUB_OB'::varchar(15)) AND (teva_transform_control.file_class_name = 'EXT_ASI_COPAY_DETAIL_WKLY'::varchar(25)))), 0)) AND (c.fill_date >= add_months((now())::date, (-6))));

CREATE  VIEW sandbox.ics_mop AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.model,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) w ON ((rx.rollup_month = w.month_ending))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.model,
          rx_vertical.basket_name;

CREATE  VIEW outbound.zzz_asi_rx_by_market_saba AS
 SELECT rx.market_name,
        rx.ims_client_number AS ims_client_num,
        rx.ims_report_number_cnt AS ims_report_num,
        rx.ims_zip_other AS zip_other,
        CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id,
        rx.ims_specialty AS specialty,
        rx.payer_plan_number AS plan_id,
        btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category,
        rx.ims_rx_type AS rx_type,
        btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num,
        NULL AS filler_01,
        axd.ims_me_num AS me_num,
        rx.prescriber_last_name AS last_name,
        rx.prescriber_first_name AS first_name,
        axd.ims_middle_name AS middle_name,
        replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address,
        axd.ims_city AS city,
        axd.ims_state AS state,
        axd.ims_zip AS zip,
        replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data,
        rx.plan_name,
        to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date,
        48 AS bucket_count,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023,
        sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024
 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other))))
 WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '14'::varchar(2)) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.market_name,
          rx.ims_client_number,
          rx.ims_report_number_cnt,
          rx.ims_zip_other,
          CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END,
          rx.ims_specialty,
          axd.ims_me_num,
          rx.payer_plan_number,
          btrim(to_char(rx.sales_category, '00'::varchar(2))),
          rx.ims_rx_type,
          btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))),
          rx.prescriber_last_name,
          rx.prescriber_first_name,
          axd.ims_middle_name,
          replace(axd.ims_address, ','::varchar(1), ''::varchar),
          axd.ims_city,
          axd.ims_state,
          axd.ims_zip,
          replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar),
          rx.plan_name,
          to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zzz_bullseye_prescriber_demographics AS
 SELECT d.ims_id,
        d.tvcmid,
        d.npi,
        rxd.decile_name,
        rxd.decile_trx_count_6_mo,
        rxd.decile_trx_count_12_mo,
        d.last_name,
        d.first_name,
        d.degree AS medical_suffix,
        d.specialty AS primary_specialty,
        d.ptr_address_1 AS address_line1,
        d.ptr_address_2 AS address_line2,
        d.ptr_city AS city,
        d.ptr_state AS state,
        d.ptr_zip AS zip,
        d.np_pa_flag,
        sfa.last_call_date,
        d.pdrp_flag
 FROM ((datamart.prescriber_combined_demographics d JOIN datamart.rx_deciles rxd ON ((d.tvcmid = rxd.tvcmid))) LEFT  JOIN ( SELECT sfa_demographics.sales_force_id,
        sfa_demographics.tvcmid,
        max(sfa_demographics.last_call_date) AS last_call_date
 FROM datamart.sfa_demographics
 WHERE (sfa_demographics.tvcmid IS NOT NULL)
 GROUP BY sfa_demographics.sales_force_id,
          sfa_demographics.tvcmid) sfa ON (((d.tvcmid = sfa.tvcmid) AND (d.sales_force_id = sfa.sales_force_id))))
 WHERE ((d.sales_force_id = 'TR'::varchar(2)) AND (rxd.decile_name = 'ICS MARKET TOTAL'::varchar(16)));

CREATE  VIEW teva_ingestion.cdw_license_audits AS
 SELECT license_audits.database_size_bytes,
        license_audits.license_size_bytes,
        license_audits.usage_percent,
        license_audits.audit_start_timestamp,
        license_audits.audit_end_timestamp,
        license_audits.confidence_level_percent,
        license_audits.error_tolerance_percent,
        license_audits.used_sampling,
        license_audits.confidence_interval_lower_bound_bytes,
        license_audits.confidence_interval_upper_bound_bytes,
        license_audits.sample_count,
        license_audits.cell_count,
        license_audits.audited_data
 FROM v_catalog.license_audits;

CREATE  VIEW outbound.sharepoint_roster_tr_ts AS
 SELECT sr.title,
        sr.territory
 FROM ( SELECT lower(r.username) AS title,
        r.territory_number AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = ANY (ARRAY['TR'::varchar(2), 'TS'::varchar(2)]))) UNION  SELECT lower(r.username) AS title,
        (r.employee_id || '_'::varchar(1)) AS territory
 FROM datamart.roster r
 WHERE ((r.username IS NOT NULL) AND (r.sales_force_id = ANY (ARRAY['TR'::varchar(2), 'TS'::varchar(2)])))) sr
 GROUP BY sr.title,
          sr.territory
 ORDER BY sr.title;

CREATE  VIEW outbound.mcm_customer_level_flags AS
 SELECT clf.tvcmid,
        ai.alternate_id_value AS federation_id,
        clf.basket_id,
        clf.basket_name,
        clf.territory_number,
        clf.sales_force_id,
        clf.flag_type,
        clf.flag_value,
        clf.flag_effective_start_date,
        clf.flag_effective_end_date
 FROM (datamart.customer_level_flags clf JOIN mdm.alternate_id ai ON ((clf.tvcmid = ai.tvcmid)))
 WHERE ((ai.status_name = 'ACTIVE'::varchar(6)) AND (ai.alternate_id_type = 'FED_ID'::varchar(6)));

CREATE  VIEW outbound.zs_ajovy_activity_sample_shipment AS
 SELECT sample_shipment.veeva_id,
        sample_shipment.tvcmid,
        sample_shipment.ims_id,
        sample_shipment.first_name,
        sample_shipment.middle_name,
        sample_shipment.last_name,
        sample_shipment.designation,
        sample_shipment.state_license_number,
        sample_shipment.address_line_1,
        sample_shipment.address_line_2,
        sample_shipment.address_line_3,
        sample_shipment.city,
        sample_shipment.state,
        sample_shipment.zip,
        sample_shipment.dea_license_number,
        sample_shipment.order_id,
        sample_shipment.ndc,
        sample_shipment.basket_id,
        sample_shipment.basket_name,
        sample_shipment.order_job_code,
        sample_shipment.order_job_description,
        sample_shipment.ship_qty,
        sample_shipment.ship_date
 FROM datamart.sample_shipment
 WHERE (sample_shipment.basket_name ~~ 'AJOVY%'::varchar(6))
 ORDER BY sample_shipment.ship_date;

CREATE  VIEW outbound.connectiverx_ajovy_zip_to_territory AS
 SELECT current_alignment.sales_force_id,
        current_alignment.zip_code,
        current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.region_number,
        current_alignment.region_name AS area_number,
        current_alignment.area_name
 FROM datamart.current_alignment
 WHERE (current_alignment.sales_force_id = ANY (ARRAY['TE'::varchar(2), 'TN'::varchar(2), 'TR'::varchar(2)]))
 ORDER BY current_alignment.zip_code,
          current_alignment.territory_number;

CREATE  VIEW outbound.zs_xpd_switch_details AS
SELECT xpd_switch_details.ims_client_number, xpd_switch_details.ims_report_number, xpd_switch_details.channel_indicator, xpd_switch_details.ims_id, xpd_switch_details.tvcmid, xpd_switch_details.specialty, xpd_switch_details.switch_from_product_group_num, xpd_switch_details.switch_from_basket_id, xpd_switch_details.switch_from_basket_name, xpd_switch_details.switch_to_product_group_num, xpd_switch_details.switch_to_basket_id, xpd_switch_details.switch_to_basket_name, xpd_switch_details.rollup_month, xpd_switch_details.rx FROM datamart.xpd_switch_details;

CREATE  VIEW outbound.connectiverx_ajovy_pdrp AS
 SELECT f.tvcmid,
        nx.npi,
        ix.ims_id,
        f.flag_value AS pdrp_flag
 FROM ((datamart.customer_level_flags f LEFT  JOIN ( SELECT x.tvcmid,
        x.npi
 FROM ( SELECT tvcmid_xref.tvcmid,
        tvcmid_xref.id_num AS npi,
        row_number() OVER (PARTITION BY tvcmid_xref.tvcmid ORDER BY tvcmid_xref.id_num) AS rnk
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'NPI'::varchar(3))) x
 WHERE (x.rnk = 1)) nx ON ((nx.tvcmid = f.tvcmid))) LEFT  JOIN ( SELECT x.tvcmid,
        x.ims_id
 FROM ( SELECT tvcmid_xref.tvcmid,
        tvcmid_xref.id_num AS ims_id,
        row_number() OVER (PARTITION BY tvcmid_xref.tvcmid ORDER BY tvcmid_xref.id_num) AS rnk
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'IMS_ID'::varchar(6))) x
 WHERE (x.rnk = 1)) ix ON ((ix.tvcmid = f.tvcmid)))
 WHERE ((f.flag_type = 'PDRP'::varchar(4)) AND (f.flag_value = 'Y'::varchar(1)));

CREATE  VIEW outbound.mdm_communication AS
 SELECT NULL AS dsp_id,
        NULL AS dsp_hce_id,
        NULL AS dsp_addr_id,
        NULL AS communication_type,
        NULL AS communication_value,
        NULL AS communication_status,
        NULL AS communication_effective_date,
        NULL AS dsp_address_line_1,
        NULL AS dsp_address_line_2,
        NULL AS dsp_city,
        NULL AS dsp_state,
        NULL AS dsp_postal_code,
        NULL AS dsp_postal_extn_code,
        NULL AS dsp_country_code
 FROM v_catalog.dual
 LIMIT 0;

CREATE  VIEW outbound.wrb_roster AS
 SELECT r."Territory ID",
        r."First Name",
        r."Middle Name",
        r."Last Name",
        r.Title,
        r.Email,
        r."Office Phone",
        r."Superior's Territory ID",
        r."Brand Business Unit"
 FROM ( SELECT roster.territory_number AS "Territory ID",
        roster.first_name AS "First Name",
        roster.middle_name AS "Middle Name",
        roster.last_name AS "Last Name",
        roster.title AS Title,
        roster.email AS Email,
        roster.business_phone AS "Office Phone",
        roster.parent_territory_number AS "Superior's Territory ID",
        roster.sales_force_id AS "Brand Business Unit"
 FROM datamart.roster
 WHERE ((roster.last_name <> 'Vacant'::varchar(6)) AND (roster.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TE'::varchar(2), 'TX'::varchar(2), 'TZ'::varchar(2), 'TH'::varchar(2), 'TM'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)]))) UNION  SELECT axtria_territory_hierarchy.territory_number__c AS "Territory ID",
        'VACANT'::varchar(6) AS "First Name",
        ''::varchar AS "Middle Name",
        axtria_territory_hierarchy.territory_number__c AS "Last Name",
        CASE axtria_territory_hierarchy.territory_level__c WHEN 'REP'::varchar(3) THEN 'Sales Specialist'::varchar(16) WHEN 'MGR'::varchar(3) THEN 'Area Manager'::varchar(12) WHEN 'DIR'::varchar(3) THEN 'Regional Director'::varchar(17) ELSE axtria_territory_hierarchy.territory_level__c END AS Title,
        (axtria_territory_hierarchy.territory_number__c || '@tevapharm.com'::varchar(14)) AS Email,
        ''::varchar AS "Office Phone",
        axtria_territory_hierarchy.parent_territory_number__c AS "Superior's Territory ID",
        axtria_territory_hierarchy.business_unit_code__c AS "Brand Business Unit"
 FROM cleansed.axtria_territory_hierarchy
 WHERE (axtria_territory_hierarchy.territory_number__c IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE ((roster.last_name = 'Vacant'::varchar(6)) AND (roster.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TE'::varchar(2), 'TX'::varchar(2), 'TZ'::varchar(2), 'TH'::varchar(2), 'TM'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])))))) r
 ORDER BY r."Territory ID";

CREATE  VIEW outbound.fingertip_roster AS
 SELECT roster.email,
        roster.first_name,
        roster.last_name,
        NULL AS password,
        CASE WHEN (roster.rep_type = 'REP'::varchar(3)) THEN 'Sales Representative'::varchar(20) WHEN (roster.rep_type = 'AD'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) WHEN (roster.rep_type = 'RM'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) ELSE NULL END AS rep_desc,
        roster.rep_type,
        roster.territory_number
 FROM datamart.roster
 WHERE ((roster.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'TE'::varchar(2)])) AND (roster.last_name <> 'Vacant'::varchar(6)) AND (roster.rep_type IS NOT NULL));

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_FACT_V2 AS
 SELECT CASE WHEN (EXT_IMS_FIA_FACT_V2_src.claim_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.claim_id))::int END AS claim_id,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.patient_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.patient_id))::int END AS patient_id,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.sequence_number = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.sequence_number))::int END AS sequence_number,
        btrim(EXT_IMS_FIA_FACT_V2_src.product_id) AS product_id,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.fill_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.fill_date))::date END AS fill_date,
        btrim(EXT_IMS_FIA_FACT_V2_src.claim_type) AS claim_type,
        btrim(EXT_IMS_FIA_FACT_V2_src.reject_code) AS reject_code,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.days_supply = ''::varchar) THEN NULL::numeric(10,6) ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.days_supply))::numeric(10,6) END AS days_supply,
        btrim(EXT_IMS_FIA_FACT_V2_src.quantity) AS quantity,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.refill_code = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.refill_code))::int END AS refill_code,
        btrim(EXT_IMS_FIA_FACT_V2_src.plantrak_id) AS plantrak_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.opc_ask) AS opc_ask,
        btrim(EXT_IMS_FIA_FACT_V2_src.sec_plantrak_id) AS sec_plantrak_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.buy_down) AS buy_down,
        btrim(EXT_IMS_FIA_FACT_V2_src.opc_paid) AS opc_paid,
        btrim(EXT_IMS_FIA_FACT_V2_src.prescriber_id) AS prescriber_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.sob) AS sob,
        btrim(EXT_IMS_FIA_FACT_V2_src.sub_product_id) AS sub_product_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.sub_opc) AS sub_opc,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.initial_claim_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.initial_claim_id))::int END AS initial_claim_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.prev_product_id) AS prev_product_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.daw_code) AS daw_code,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.wrt_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.wrt_date))::date END AS wrt_date,
        btrim(EXT_IMS_FIA_FACT_V2_src.claim_status) AS claim_status,
        btrim(EXT_IMS_FIA_FACT_V2_src.copay_card_flg) AS copay_card_flg,
        btrim(EXT_IMS_FIA_FACT_V2_src.zip_code) AS zip_code,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.ecoup_flag = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.ecoup_flag))::int END AS ecoup_flag,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.ecoup_offset_amt = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.ecoup_offset_amt))::numeric(10,2) END AS ecoup_offset_amt,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.standard_copay = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.standard_copay))::numeric(10,2) END AS standard_copay,
        btrim(EXT_IMS_FIA_FACT_V2_src.standard_copay_yn) AS standard_copay_yn,
        CASE WHEN (EXT_IMS_FIA_FACT_V2_src.market_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_FACT_V2_src.market_id))::int END AS market_id,
        btrim(EXT_IMS_FIA_FACT_V2_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_FACT_V2_src.flexible_fld_2_char) AS flexible_fld_2_char,
        btrim(EXT_IMS_FIA_FACT_V2_src.flexible_fld_3_char) AS flexible_fld_3_char,
        btrim(EXT_IMS_FIA_FACT_V2_src.flexible_fld_4_char) AS flexible_fld_4_char,
        EXT_IMS_FIA_FACT_V2_src.batch_id,
        EXT_IMS_FIA_FACT_V2_src.row_id,
        EXT_IMS_FIA_FACT_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_FACT_V2_src;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_GEOGRAPHY_V2 AS
 SELECT btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.zip_code) AS zip_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.cbsa_code) AS cbsa_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.cbsa_description) AS cbsa_description,
        btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.state_code) AS state_code,
        btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_GEOGRAPHY_V2_src.flexible_fld_2_char) AS flexible_fld_2_char,
        EXT_IMS_FIA_GEOGRAPHY_V2_src.batch_id,
        EXT_IMS_FIA_GEOGRAPHY_V2_src.row_id,
        EXT_IMS_FIA_GEOGRAPHY_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_GEOGRAPHY_V2_src;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_PLAN_V2 AS
 SELECT btrim(EXT_IMS_FIA_PLAN_V2_src.plantrak_id) AS plantrak_id,
        btrim(EXT_IMS_FIA_PLAN_V2_src.payer_name) AS payer_name,
        btrim(EXT_IMS_FIA_PLAN_V2_src.plan_name) AS plan_name,
        btrim(EXT_IMS_FIA_PLAN_V2_src.pbm_name) AS pbm_name,
        btrim(EXT_IMS_FIA_PLAN_V2_src.pbm_id) AS pbm_id,
        btrim(EXT_IMS_FIA_PLAN_V2_src.method_of_payment) AS method_of_payment,
        btrim(EXT_IMS_FIA_PLAN_V2_src.model_type) AS model_type,
        btrim(EXT_IMS_FIA_PLAN_V2_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_PLAN_V2_src.flexible_fld_2_char) AS flexible_fld_2_char,
        EXT_IMS_FIA_PLAN_V2_src.batch_id,
        EXT_IMS_FIA_PLAN_V2_src.row_id,
        EXT_IMS_FIA_PLAN_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_PLAN_V2_src;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_PRODUCT_V2 AS
 SELECT btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_id) AS product_id,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_group) AS product_group,
        CASE WHEN (EXT_IMS_FIA_PRODUCT_V2_src.product_group_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_group_id))::int END AS product_group_id,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_name) AS product_name,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.generic_name) AS generic_name,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.brand_generic_flag) AS brand_generic_flag,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_form) AS product_form,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.product_strength) AS product_strength,
        CASE WHEN (EXT_IMS_FIA_PRODUCT_V2_src.package_size = ''::varchar) THEN NULL::numeric(10,2) ELSE (btrim(EXT_IMS_FIA_PRODUCT_V2_src.package_size))::numeric(10,2) END AS package_size,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.manufacturer) AS manufacturer,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.cmf10) AS cmf10,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.usc_code) AS usc_code,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.fia_market_id) AS fia_market_id,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.fia_market_desc) AS fia_market_desc,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.flexible_fld_2_char) AS flexible_fld_2_char,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.flexible_fld_3_char) AS flexible_fld_3_char,
        btrim(EXT_IMS_FIA_PRODUCT_V2_src.flexible_fld_4_char) AS flexible_fld_4_char,
        EXT_IMS_FIA_PRODUCT_V2_src.batch_id,
        EXT_IMS_FIA_PRODUCT_V2_src.row_id,
        EXT_IMS_FIA_PRODUCT_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_PRODUCT_V2_src;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_REJECT_V2 AS
 SELECT btrim(EXT_IMS_FIA_REJECT_V2_src.reject_code) AS reject_code,
        btrim(EXT_IMS_FIA_REJECT_V2_src.reject_reason) AS reject_reason,
        btrim(EXT_IMS_FIA_REJECT_V2_src.reject_group) AS reject_group,
        btrim(EXT_IMS_FIA_REJECT_V2_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_REJECT_V2_src.flexible_fld_2_char) AS flexible_fld_2_char,
        EXT_IMS_FIA_REJECT_V2_src.batch_id,
        EXT_IMS_FIA_REJECT_V2_src.row_id,
        EXT_IMS_FIA_REJECT_V2_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_REJECT_V2_src;

CREATE  VIEW raw.ext_ims_fia_fact_v2 AS
 SELECT src.claim_id,
        src.patient_id,
        src.sequence_number,
        src.product_id,
        src.fill_date,
        src.claim_type,
        src.reject_code,
        src.days_supply,
        src.quantity,
        src.refill_code,
        src.plantrak_id,
        src.opc_ask,
        src.sec_plantrak_id,
        src.buy_down,
        src.opc_paid,
        src.prescriber_id,
        src.sob,
        src.sub_product_id,
        src.sub_opc,
        src.initial_claim_id,
        src.prev_product_id,
        src.daw_code,
        src.wrt_date,
        src.claim_status,
        src.copay_card_flg,
        src.zip_code,
        src.ecoup_flag,
        src.ecoup_offset_amt,
        src.standard_copay,
        src.standard_copay_yn,
        src.market_id,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.flexible_fld_3_char,
        src.flexible_fld_4_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_FACT_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_FACT_V2'::varchar(19)))));

CREATE  VIEW raw.ext_ims_fia_geography_v2 AS
 SELECT src.zip_code,
        src.cbsa_code,
        src.cbsa_description,
        src.state_code,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_GEOGRAPHY_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_GEOGRAPHY_V2'::varchar(24)))));

CREATE  VIEW raw.ext_ims_fia_plan_v2 AS
 SELECT src.plantrak_id,
        src.payer_name,
        src.plan_name,
        src.pbm_name,
        src.pbm_id,
        src.method_of_payment,
        src.model_type,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_PLAN_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_PLAN_V2'::varchar(19)))));

CREATE  VIEW raw.ext_ims_fia_product_v2 AS
 SELECT src.product_id,
        src.product_group,
        src.product_group_id,
        src.product_name,
        src.generic_name,
        src.brand_generic_flag,
        src.product_form,
        src.product_strength,
        src.package_size,
        src.manufacturer,
        src.cmf10,
        src.usc_code,
        src.fia_market_id,
        src.fia_market_desc,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.flexible_fld_3_char,
        src.flexible_fld_4_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_PRODUCT_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_PRODUCT_V2'::varchar(22)))));

CREATE  VIEW raw.ext_ims_fia_reject_v2 AS
 SELECT src.reject_code,
        src.reject_reason,
        src.reject_group,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_REJECT_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_REJECT_V2'::varchar(21)))));

CREATE  VIEW outbound.zs_austedo_activity_call_detail AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position
 FROM (datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id)))
 WHERE ((cd.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (c.call_date >= '2018-01-01'::date) AND (c.call_date < trunc(now(), 'MONTH'::varchar(5))))
 ORDER BY c.call_date;

CREATE  VIEW outbound.zs_austedo_activity_sample_request AS
 SELECT sfa_sample.sample_id,
        sfa_sample.call_id,
        sfa_sample.veeva_account_id,
        sfa_sample.ims_id,
        sfa_sample.call_date,
        sfa_sample.sales_force_id,
        sfa_sample.territory_number,
        sfa_sample.call_type,
        sfa_sample.attendee_type,
        sfa_sample.customer_type,
        sfa_sample.sample_type,
        sfa_sample.product_name,
        sfa_sample.sample_name,
        sfa_sample.sample_ndc,
        sfa_sample.basket_id,
        sfa_sample.basket_name,
        sfa_sample.qty,
        sfa_sample.zip_on_call,
        sfa_sample.employee_number,
        sfa_sample.tvcmid
 FROM datamart.sfa_sample
 WHERE ((sfa_sample.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (sfa_sample.sample_type = 'REQUEST'::varchar(7)) AND (sfa_sample.call_date >= '2018-01-01'::date) AND (sfa_sample.call_date < trunc(now(), 'MONTH'::varchar(5))))
 ORDER BY sfa_sample.call_date;

CREATE  VIEW teva_ingestion.EXT_CONNECTIVERX_COUPON_V2 AS
 SELECT btrim(EXT_CONNECTIVERX_COUPON_V2_src.redemption_type) AS redemption_type,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.transaction_type) AS transaction_type,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.claim_authorization_number) AS claim_authorization_number,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.original_claim_authorization_number) AS original_claim_authorization_number,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.date_of_fill) AS date_of_fill,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.date_written) AS date_written,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.day_supply) AS day_supply,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.ndc) AS ndc,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.daw) AS daw,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.drug_title) AS drug_title,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.drug_strength_and_form) AS drug_strength_and_form,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.new_refill_code) AS new_refill_code,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.quantity) AS quantity,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.number_of_refills) AS number_of_refills,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.other_coverage_code) AS other_coverage_code,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.group_num) AS group_num,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.member_id) AS member_id,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_gender) AS patient_gender,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.age) AS age,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.date_processed) AS date_processed,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.nabp) AS nabp,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_chain) AS pharmacy_chain,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_npi) AS pharmacy_npi,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.rx_num) AS rx_num,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_name) AS pharmacy_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_address_1) AS pharmacy_address_1,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_address_2) AS pharmacy_address_2,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_city) AS pharmacy_city,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_state) AS pharmacy_state,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_zip) AS pharmacy_zip,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_phone) AS pharmacy_phone,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_npi) AS hcp_npi,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_first_name) AS hcp_first_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_middle_name) AS hcp_middle_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_last_name) AS hcp_last_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_suffix) AS hcp_suffix,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_designation) AS hcp_designation,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_specialty_1) AS hcp_specialty_1,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_specialty_2) AS hcp_specialty_2,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_address_1) AS hcp_address_1,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_address_2) AS hcp_address_2,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_city) AS hcp_city,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_state) AS hcp_state,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.hcp_zip) AS hcp_zip,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.submission_method) AS submission_method,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.previous_payer_id) AS previous_payer_id,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_expense) AS patient_expense,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_benefit) AS patient_benefit,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_copay) AS patient_copay,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_oop) AS patient_oop,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.pharmacy_fee) AS pharmacy_fee,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.amount_due) AS amount_due,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.create_date) AS create_date,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.occ_payment_type) AS occ_payment_type,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.calc_awp) AS calc_awp,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_npi) AS admin_hcp_npi,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_name) AS admin_hcp_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_address) AS admin_hcp_address,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_address2) AS admin_hcp_address2,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_city) AS admin_hcp_city,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_state) AS admin_hcp_state,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.admin_hcp_zip) AS admin_hcp_zip,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.claim_type) AS claim_type,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.administration_flag) AS administration_flag,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_name) AS soc_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_phone) AS soc_phone,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_fax) AS soc_fax,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_address) AS soc_address,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_city) AS soc_city,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_state) AS soc_state,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_zip) AS soc_zip,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_id) AS soc_id,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.soc_npi) AS soc_npi,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.payer_name) AS payer_name,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.cpt_code) AS cpt_code,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.patient_type) AS patient_type,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.primary_bin) AS primary_bin,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.primary_bin_description) AS primary_bin_description,
        btrim(EXT_CONNECTIVERX_COUPON_V2_src.reject_code) AS reject_code,
        EXT_CONNECTIVERX_COUPON_V2_src.batch_id,
        EXT_CONNECTIVERX_COUPON_V2_src.row_id,
        EXT_CONNECTIVERX_COUPON_V2_src.update_ts
 FROM teva_ingestion.EXT_CONNECTIVERX_COUPON_V2_src;

CREATE  VIEW raw.ext_connectiverx_coupon_v2 AS
 SELECT src.redemption_type,
        src.transaction_type,
        src.claim_authorization_number,
        src.original_claim_authorization_number,
        src.date_of_fill,
        src.date_written,
        src.day_supply,
        src.ndc,
        src.daw,
        src.drug_title,
        src.drug_strength_and_form,
        src.new_refill_code,
        src.quantity,
        src.number_of_refills,
        src.other_coverage_code,
        src.group_num,
        src.member_id,
        src.patient_gender,
        src.age,
        src.date_processed,
        src.nabp,
        src.pharmacy_chain,
        src.pharmacy_npi,
        src.rx_num,
        src.pharmacy_name,
        src.pharmacy_address_1,
        src.pharmacy_address_2,
        src.pharmacy_city,
        src.pharmacy_state,
        src.pharmacy_zip,
        src.pharmacy_phone,
        src.hcp_npi,
        src.hcp_first_name,
        src.hcp_middle_name,
        src.hcp_last_name,
        src.hcp_suffix,
        src.hcp_designation,
        src.hcp_specialty_1,
        src.hcp_specialty_2,
        src.hcp_address_1,
        src.hcp_address_2,
        src.hcp_city,
        src.hcp_state,
        src.hcp_zip,
        src.submission_method,
        src.previous_payer_id,
        src.patient_expense,
        src.patient_benefit,
        src.patient_copay,
        src.patient_oop,
        src.pharmacy_fee,
        src.amount_due,
        src.create_date,
        src.occ_payment_type,
        src.calc_awp,
        src.admin_hcp_npi,
        src.admin_hcp_name,
        src.admin_hcp_address,
        src.admin_hcp_address2,
        src.admin_hcp_city,
        src.admin_hcp_state,
        src.admin_hcp_zip,
        src.claim_type,
        src.administration_flag,
        src.soc_name,
        src.soc_phone,
        src.soc_fax,
        src.soc_address,
        src.soc_city,
        src.soc_state,
        src.soc_zip,
        src.soc_id,
        src.soc_npi,
        src.payer_name,
        src.cpt_code,
        src.patient_type,
        src.primary_bin,
        src.primary_bin_description,
        src.reject_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_CONNECTIVERX_COUPON_V2_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_CONNECTIVERX_COUPON_V2'::varchar(26)))));

CREATE  VIEW teva_ingestion.EXT_REFERENCE_INCLUDE_DDD_SUBCAT AS
 SELECT btrim(EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src.subcategory_code) AS subcategory_code,
        EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src.batch_id,
        EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src.row_id,
        EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src.update_ts
 FROM teva_ingestion.EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src;

CREATE  VIEW raw.ext_reference_include_ddd_subcat AS
 SELECT src.subcategory_code,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REFERENCE_INCLUDE_DDD_SUBCAT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REFERENCE_INCLUDE_DDD_SUBCAT'::varchar(32)))));

CREATE  VIEW teva_ingestion.EXT_REFERENCE_INCLUDE_867_COT AS
 SELECT btrim(EXT_REFERENCE_INCLUDE_867_COT_src.class_of_trade) AS class_of_trade,
        EXT_REFERENCE_INCLUDE_867_COT_src.batch_id,
        EXT_REFERENCE_INCLUDE_867_COT_src.row_id,
        EXT_REFERENCE_INCLUDE_867_COT_src.update_ts
 FROM teva_ingestion.EXT_REFERENCE_INCLUDE_867_COT_src;

CREATE  VIEW raw.ext_reference_include_867_cot AS
 SELECT src.class_of_trade,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REFERENCE_INCLUDE_867_COT_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REFERENCE_INCLUDE_867_COT'::varchar(29)))));

CREATE  VIEW teva_ingestion.EXT_REFERENCE_COPAY_VOUCHER_PROGRAM AS
 SELECT btrim(EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.redemption_type) AS redemption_type,
        btrim(EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.program_number) AS program_number,
        btrim(EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.program_description) AS program_description,
        btrim(EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.create_date) AS create_date,
        EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.batch_id,
        EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.row_id,
        EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src.update_ts
 FROM teva_ingestion.EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src;

CREATE  VIEW raw.ext_reference_copay_voucher_program AS
 SELECT src.redemption_type,
        src.program_number,
        src.program_description,
        src.create_date,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_REFERENCE_COPAY_VOUCHER_PROGRAM_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_REFERENCE_COPAY_VOUCHER_PROGRAM'::varchar(35)))));

CREATE  VIEW outbound.zs_ajovy_activity_copay AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.nabp,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.occ_payment_type,
        copay.auth_refills,
        copay.claim_type,
        copay.administration_flag,
        copay.payer_name,
        copay.trans_type,
        copay.previous_payer_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.source_name,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay
 WHERE (copay.basket_name ~~ 'AJOVY%'::varchar(6))
 ORDER BY copay.fill_date;

CREATE  VIEW teva_ingestion.EXT_IMS_FIA_MPD AS
 SELECT CASE WHEN (EXT_IMS_FIA_MPD_src.patient_id = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_MPD_src.patient_id))::int END AS patient_id,
        CASE WHEN (EXT_IMS_FIA_MPD_src.mpd_year = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_MPD_src.mpd_year))::int END AS mpd_year,
        btrim(EXT_IMS_FIA_MPD_src.mpd_eligibility_class) AS mpd_eligibility_class,
        CASE WHEN (EXT_IMS_FIA_MPD_src.deductible_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_MPD_src.deductible_start_date))::date END AS deductible_start_date,
        CASE WHEN (EXT_IMS_FIA_MPD_src.copay_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_MPD_src.copay_start_date))::date END AS copay_start_date,
        CASE WHEN (EXT_IMS_FIA_MPD_src.gap_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_MPD_src.gap_start_date))::date END AS gap_start_date,
        CASE WHEN (EXT_IMS_FIA_MPD_src.catastrophic_start_date = ''::varchar) THEN NULL::date ELSE (btrim(EXT_IMS_FIA_MPD_src.catastrophic_start_date))::date END AS catastrophic_start_date,
        CASE WHEN (EXT_IMS_FIA_MPD_src.mpd_panel_patient = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_FIA_MPD_src.mpd_panel_patient))::int END AS mpd_panel_patient,
        btrim(EXT_IMS_FIA_MPD_src.flexible_fld_1_char) AS flexible_fld_1_char,
        btrim(EXT_IMS_FIA_MPD_src.flexible_fld_2_char) AS flexible_fld_2_char,
        EXT_IMS_FIA_MPD_src.batch_id,
        EXT_IMS_FIA_MPD_src.row_id,
        EXT_IMS_FIA_MPD_src.update_ts
 FROM teva_ingestion.EXT_IMS_FIA_MPD_src;

CREATE  VIEW raw.ext_ims_fia_mpd AS
 SELECT src.patient_id,
        src.mpd_year,
        src.mpd_eligibility_class,
        src.deductible_start_date,
        src.copay_start_date,
        src.gap_start_date,
        src.catastrophic_start_date,
        src.mpd_panel_patient,
        src.flexible_fld_1_char,
        src.flexible_fld_2_char,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_IMS_FIA_MPD_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_IMS_FIA_MPD'::varchar(15)))));

CREATE  VIEW metadata.workflow_log_trend AS
 SELECT steps.process_id,
        steps.command_step,
        steps.file_name,
        max(steps.log_date) AS most_recent_run,
        max(CASE WHEN (steps.rnk = 1) THEN steps.elapsed_time ELSE 0::float END) AS day_01,
        max(CASE WHEN (steps.rnk = 2) THEN steps.elapsed_time ELSE 0::float END) AS day_02,
        max(CASE WHEN (steps.rnk = 3) THEN steps.elapsed_time ELSE 0::float END) AS day_03,
        max(CASE WHEN (steps.rnk = 4) THEN steps.elapsed_time ELSE 0::float END) AS day_04,
        max(CASE WHEN (steps.rnk = 5) THEN steps.elapsed_time ELSE 0::float END) AS day_05,
        max(CASE WHEN (steps.rnk = 6) THEN steps.elapsed_time ELSE 0::float END) AS day_06,
        max(CASE WHEN (steps.rnk = 7) THEN steps.elapsed_time ELSE 0::float END) AS day_07,
        max(CASE WHEN (steps.rnk = 8) THEN steps.elapsed_time ELSE 0::float END) AS day_08,
        max(CASE WHEN (steps.rnk = 9) THEN steps.elapsed_time ELSE 0::float END) AS day_09,
        max(CASE WHEN (steps.rnk = 10) THEN steps.elapsed_time ELSE 0::float END) AS day_10,
        max(CASE WHEN (steps.rnk = 11) THEN steps.elapsed_time ELSE 0::float END) AS day_11,
        max(CASE WHEN (steps.rnk = 12) THEN steps.elapsed_time ELSE 0::float END) AS day_12,
        max(CASE WHEN (steps.rnk = 13) THEN steps.elapsed_time ELSE 0::float END) AS day_13,
        max(CASE WHEN (steps.rnk = 14) THEN steps.elapsed_time ELSE 0::float END) AS day_14,
        max(CASE WHEN (steps.rnk = 15) THEN steps.elapsed_time ELSE 0::float END) AS day_15,
        max(CASE WHEN (steps.rnk = 16) THEN steps.elapsed_time ELSE 0::float END) AS day_16,
        max(CASE WHEN (steps.rnk = 17) THEN steps.elapsed_time ELSE 0::float END) AS day_17,
        max(CASE WHEN (steps.rnk = 18) THEN steps.elapsed_time ELSE 0::float END) AS day_18,
        max(CASE WHEN (steps.rnk = 19) THEN steps.elapsed_time ELSE 0::float END) AS day_19,
        max(CASE WHEN (steps.rnk = 20) THEN steps.elapsed_time ELSE 0::float END) AS day_20,
        max(CASE WHEN (steps.rnk = 21) THEN steps.elapsed_time ELSE 0::float END) AS day_21,
        max(CASE WHEN (steps.rnk = 22) THEN steps.elapsed_time ELSE 0::float END) AS day_22,
        max(CASE WHEN (steps.rnk = 23) THEN steps.elapsed_time ELSE 0::float END) AS day_23,
        max(CASE WHEN (steps.rnk = 24) THEN steps.elapsed_time ELSE 0::float END) AS day_24,
        max(CASE WHEN (steps.rnk = 25) THEN steps.elapsed_time ELSE 0::float END) AS day_25,
        max(CASE WHEN (steps.rnk = 26) THEN steps.elapsed_time ELSE 0::float END) AS day_26,
        max(CASE WHEN (steps.rnk = 27) THEN steps.elapsed_time ELSE 0::float END) AS day_27,
        max(CASE WHEN (steps.rnk = 28) THEN steps.elapsed_time ELSE 0::float END) AS day_28
 FROM ( SELECT (workflow_log.logged_at)::date AS log_date,
        workflow_log.process_id,
        workflow_log.command_step,
        regexp_substr(workflow_log.full_path, E'[^\\/]+$'::varchar(7), 1, 1, ''::varchar, 0) AS file_name,
        workflow_log.elapsed_time,
        workflow_log.lock_uuid,
        dense_rank() OVER (PARTITION BY workflow_log.process_id, workflow_log.command_step ORDER BY workflow_log.logged_at DESC) AS rnk
 FROM metadata.workflow_log
 WHERE ((workflow_log.type = 'FILE'::varchar(4)) AND (workflow_log.message = 'END SQL FILE'::varchar(12)) AND (workflow_log.logged_at >= (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) + '-28'::interval)))) steps
 GROUP BY steps.process_id,
          steps.command_step,
          steps.file_name
 ORDER BY steps.file_name,
          steps.process_id,
          steps.command_step;

CREATE  VIEW outbound.zs_xpd_switch_details_antimigraine_monthly AS
 SELECT xpd_switch_details_antimigraine.ims_client_number,
        xpd_switch_details_antimigraine.ims_report_number,
        xpd_switch_details_antimigraine.channel_indicator,
        xpd_switch_details_antimigraine.ims_id,
        xpd_switch_details_antimigraine.tvcmid,
        xpd_switch_details_antimigraine.specialty,
        xpd_switch_details_antimigraine.switch_from_product_group_num,
        xpd_switch_details_antimigraine.switch_from_basket_id,
        xpd_switch_details_antimigraine.switch_from_basket_name,
        xpd_switch_details_antimigraine.switch_to_product_group_num,
        xpd_switch_details_antimigraine.switch_to_basket_id,
        xpd_switch_details_antimigraine.switch_to_basket_name,
        xpd_switch_details_antimigraine.rollup_period,
        xpd_switch_details_antimigraine.rx,
        xpd_switch_details_antimigraine.report_frequency
 FROM datamart.xpd_switch_details_antimigraine
 WHERE (xpd_switch_details_antimigraine.report_frequency = 'MONTH'::varchar(5));

CREATE  VIEW outbound.zs_xpd_switch_details_antimigraine_weekly AS
 SELECT xpd_switch_details_antimigraine.ims_client_number,
        xpd_switch_details_antimigraine.ims_report_number,
        xpd_switch_details_antimigraine.channel_indicator,
        xpd_switch_details_antimigraine.ims_id,
        xpd_switch_details_antimigraine.tvcmid,
        xpd_switch_details_antimigraine.specialty,
        xpd_switch_details_antimigraine.switch_from_product_group_num,
        xpd_switch_details_antimigraine.switch_from_basket_id,
        xpd_switch_details_antimigraine.switch_from_basket_name,
        xpd_switch_details_antimigraine.switch_to_product_group_num,
        xpd_switch_details_antimigraine.switch_to_basket_id,
        xpd_switch_details_antimigraine.switch_to_basket_name,
        xpd_switch_details_antimigraine.rollup_period,
        xpd_switch_details_antimigraine.rx,
        xpd_switch_details_antimigraine.report_frequency
 FROM datamart.xpd_switch_details_antimigraine
 WHERE (xpd_switch_details_antimigraine.report_frequency = 'WEEK'::varchar(4));

CREATE  VIEW outbound.zs_xpd_demographics_antimigraine_weekly AS
 SELECT xpd_demographics_antimigraine.ims_client_number,
        xpd_demographics_antimigraine.ims_report_number,
        xpd_demographics_antimigraine.ims_id,
        xpd_demographics_antimigraine.tvcmid,
        xpd_demographics_antimigraine.last_name,
        xpd_demographics_antimigraine.first_name,
        xpd_demographics_antimigraine.middle_name,
        xpd_demographics_antimigraine.address_1,
        xpd_demographics_antimigraine.address_2,
        xpd_demographics_antimigraine.city,
        xpd_demographics_antimigraine.state,
        xpd_demographics_antimigraine.zip,
        xpd_demographics_antimigraine.specialty,
        xpd_demographics_antimigraine.specialty_description,
        xpd_demographics_antimigraine.trx_decile_retail,
        xpd_demographics_antimigraine.nrx_decile_retail,
        xpd_demographics_antimigraine.nbrx_decile_retail,
        xpd_demographics_antimigraine.trx_decile_mail,
        xpd_demographics_antimigraine.nrx_decile_mail,
        xpd_demographics_antimigraine.nbrx_decile_mail,
        xpd_demographics_antimigraine.market_prescriber_reliability_retail,
        xpd_demographics_antimigraine.market_prescriber_reliability_mail,
        xpd_demographics_antimigraine.report_frequency
 FROM datamart.xpd_demographics_antimigraine
 WHERE (xpd_demographics_antimigraine.report_frequency = 'WEEK'::varchar(4));

CREATE  VIEW outbound.zs_xpd_core_metrics_antimigraine_weekly AS
 SELECT xpd_core_metrics_antimigraine.ims_client_number,
        xpd_core_metrics_antimigraine.ims_report_number,
        xpd_core_metrics_antimigraine.channel_indicator,
        xpd_core_metrics_antimigraine.ims_id,
        xpd_core_metrics_antimigraine.tvcmid,
        xpd_core_metrics_antimigraine.specialty,
        xpd_core_metrics_antimigraine.ims_product_group,
        xpd_core_metrics_antimigraine.basket_id,
        xpd_core_metrics_antimigraine.basket_name,
        xpd_core_metrics_antimigraine.rollup_period,
        xpd_core_metrics_antimigraine.xpo_nrx,
        xpd_core_metrics_antimigraine.xpo_trx,
        xpd_core_metrics_antimigraine.unknown_nrx,
        xpd_core_metrics_antimigraine.unknown_trx,
        xpd_core_metrics_antimigraine.new_therapy_starts,
        xpd_core_metrics_antimigraine.continued_new,
        xpd_core_metrics_antimigraine.switch_to,
        xpd_core_metrics_antimigraine.add_on,
        xpd_core_metrics_antimigraine.restart_same_new,
        xpd_core_metrics_antimigraine.restart_different,
        xpd_core_metrics_antimigraine.continued_refill,
        xpd_core_metrics_antimigraine.restart_same_refill,
        xpd_core_metrics_antimigraine.switch_from,
        xpd_core_metrics_antimigraine.restart_different_from,
        xpd_core_metrics_antimigraine.add_to,
        xpd_core_metrics_antimigraine.market_new_to_brand_rx,
        xpd_core_metrics_antimigraine.dynamic_capture_rx,
        xpd_core_metrics_antimigraine.report_frequency
 FROM datamart.xpd_core_metrics_antimigraine
 WHERE (xpd_core_metrics_antimigraine.report_frequency = 'WEEK'::varchar(4));

CREATE  VIEW outbound.ics_mop_yearly AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.payment_method,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.payment_method,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT row_number() OVER (ORDER BY z.rollup_month DESC) AS month_bucket,
        z.rollup_month
 FROM ( SELECT prescriber_rx.rollup_month
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY prescriber_rx.rollup_month) z) w ON ((rx.rollup_month = w.rollup_month))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.payment_method,
          rx_vertical.basket_name;

CREATE  VIEW outbound.iqvia_zs_total_acute_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.rollup_month,
        prescriber_rx.sales_category,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        sum(prescriber_rx.nrx_count) AS nrx_count,
        sum(prescriber_rx.trx_count) AS trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)) AND (prescriber_rx.basket_name = 'TOTAL ACUTE MIGRAINE'::varchar(20)))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.rollup_month,
          prescriber_rx.sales_category,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method;

CREATE  VIEW reporting.ajovy_activity_plan AS
 SELECT ap.sales_force_id,
        ap.territory_id,
        ap.customer_id,
        ap.tvcmid,
        p.market_id,
        ap.target_status_flag
 FROM (reporting.activity_plan ap JOIN reporting.product p ON (((ap.product_id = p.product_id) AND (upper(p.product_name) ~~ 'AJOVY%'::varchar(6)))))
 WHERE (ap.customer_id IS NOT NULL)
 GROUP BY ap.sales_force_id,
          ap.territory_id,
          ap.customer_id,
          ap.tvcmid,
          p.market_id,
          ap.target_status_flag;

CREATE  VIEW outbound.CobbsCreek_austedo_xpo_rx_weekly AS
 SELECT DISTINCT prescriber_combined_demographics.tvcmid,
        prescriber_combined_demographics.npi,
        prescriber_combined_demographics.ims_id,
        prescriber_rx.market_name,
        prescriber_rx.basket_name,
        prescriber_rx.basket_id,
        prescriber_rx.rollup_week,
        prescriber_rx.date,
        sum(prescriber_rx.nrx_count) AS Sum_nrx_count,
        sum(prescriber_rx.trx_count) AS Sum_trx_count,
        sum(prescriber_rx.nrx_quantity) AS Sum_nrx_quantity,
        sum(prescriber_rx.trx_quantity) AS Sum_trx_quantity,
        sum(prescriber_rx.unnormalized_nrx_count) AS Sum_unnormalized_nrx_count,
        sum(prescriber_rx.unnormalized_trx_count) AS Sum_unnormalized_trx_count,
        prescriber_rx.indication,
        prescriber_rx.sales_category,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.rollup_flag,
        prescriber_combined_demographics.first_name,
        prescriber_combined_demographics.middle_name,
        prescriber_combined_demographics.last_name,
        prescriber_combined_demographics.ptr_address_1,
        prescriber_combined_demographics.ptr_address_2,
        prescriber_combined_demographics.ptr_city,
        prescriber_combined_demographics.ptr_state,
        prescriber_combined_demographics.ptr_zip,
        prescriber_combined_demographics.ptr_phone,
        prescriber_combined_demographics.email,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.secondary_specialty,
        prescriber_combined_demographics.pdrp_flag,
        prescriber_combined_demographics.pdrp_date,
        prescriber_combined_demographics.np_pa_flag,
        prescriber_combined_demographics.ama_no_contact_flag,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payer_name,
        prescriber_rx.plan_name,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.payment_method,
        prescriber_rx.data_date
 FROM (datamart.prescriber_rx prescriber_rx LEFT  JOIN datamart.prescriber_combined_demographics prescriber_combined_demographics ON ((prescriber_rx.ims_id = prescriber_combined_demographics.ims_id)))
 WHERE ((prescriber_rx.market_name = 'MOVEMENT DISORDER MARKET'::varchar(24)) AND (prescriber_rx.basket_type = 'product'::varchar(7)) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.market_name = 'MOVEMENT DISORDER MARKET'::varchar(24)) AND (prescriber_rx.basket_type = 'product'::varchar(7)) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY prescriber_combined_demographics.tvcmid,
          prescriber_combined_demographics.npi,
          prescriber_combined_demographics.ims_id,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_type,
          prescriber_rx.report_frequency,
          prescriber_rx.rollup_week,
          prescriber_rx.date,
          prescriber_rx.sales_category,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.rollup_flag,
          prescriber_combined_demographics.first_name,
          prescriber_combined_demographics.middle_name,
          prescriber_combined_demographics.last_name,
          prescriber_combined_demographics.ptr_address_1,
          prescriber_combined_demographics.ptr_address_2,
          prescriber_combined_demographics.ptr_city,
          prescriber_combined_demographics.ptr_state,
          prescriber_combined_demographics.ptr_zip,
          prescriber_combined_demographics.ptr_phone,
          prescriber_combined_demographics.email,
          prescriber_combined_demographics.specialty,
          prescriber_combined_demographics.secondary_specialty,
          prescriber_combined_demographics.pdrp_flag,
          prescriber_combined_demographics.pdrp_date,
          prescriber_combined_demographics.np_pa_flag,
          prescriber_combined_demographics.ama_no_contact_flag,
          prescriber_rx.data_date,
          prescriber_rx.indication,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_parent_name
 ORDER BY prescriber_combined_demographics.ims_id,
          prescriber_combined_demographics.tvcmid,
          prescriber_combined_demographics.npi,
          prescriber_rx.market_name,
          prescriber_rx.basket_name,
          prescriber_rx.basket_id,
          prescriber_rx.rollup_week,
          prescriber_rx.date,
          sum(prescriber_rx.nrx_count),
          sum(prescriber_rx.trx_count),
          sum(prescriber_rx.nrx_quantity),
          sum(prescriber_rx.trx_quantity),
          sum(prescriber_rx.unnormalized_nrx_count),
          sum(prescriber_rx.unnormalized_trx_count),
          prescriber_rx.indication,
          prescriber_rx.sales_category,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.rollup_flag,
          prescriber_combined_demographics.first_name,
          prescriber_combined_demographics.middle_name,
          prescriber_combined_demographics.last_name,
          prescriber_combined_demographics.ptr_address_1,
          prescriber_combined_demographics.ptr_address_2,
          prescriber_combined_demographics.ptr_city,
          prescriber_combined_demographics.ptr_state,
          prescriber_combined_demographics.ptr_zip,
          prescriber_combined_demographics.ptr_phone,
          prescriber_combined_demographics.email,
          prescriber_combined_demographics.specialty,
          prescriber_combined_demographics.secondary_specialty,
          prescriber_combined_demographics.pdrp_flag,
          prescriber_combined_demographics.pdrp_date,
          prescriber_combined_demographics.np_pa_flag,
          prescriber_combined_demographics.ama_no_contact_flag,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payer_name,
          prescriber_rx.plan_name,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.payment_method,
          prescriber_rx.data_date;

CREATE  VIEW teva_ingestion.EXT_VV_REMOTE_MEETING_VOD__C AS
 SELECT btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Id) AS Id,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.OwnerId) AS OwnerId,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Name) AS Name,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.RecordTypeId) AS RecordTypeId,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.CreatedDate) AS CreatedDate,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.CreatedById) AS CreatedById,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.LastModifiedDate) AS LastModifiedDate,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.LastModifiedById) AS LastModifiedById,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.SystemModstamp) AS SystemModstamp,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.MayEdit) AS MayEdit,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.IsLocked) AS IsLocked,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Meeting_Id_vod__c) AS Meeting_Id_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Meeting_Name_vod__c) AS Meeting_Name_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Mobile_ID_vod__c) AS Mobile_ID_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Scheduled_DateTime_vod__c) AS Scheduled_DateTime_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Scheduled_vod__c) AS Scheduled_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Attendance_Report_Process_Status_vod__c) AS Attendance_Report_Process_Status_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Latest_Meeting_Start_Datetime_vod__c) AS Latest_Meeting_Start_Datetime_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Meeting_Password_vod__c) AS Meeting_Password_vod__c,
        btrim(EXT_VV_REMOTE_MEETING_VOD__C_src.Meeting_Outcome_Status_vod__c) AS Meeting_Outcome_Status_vod__c,
        EXT_VV_REMOTE_MEETING_VOD__C_src.batch_id,
        EXT_VV_REMOTE_MEETING_VOD__C_src.row_id,
        EXT_VV_REMOTE_MEETING_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_REMOTE_MEETING_VOD__C_src;

CREATE  VIEW raw.ext_vv_remote_meeting_vod__c AS
 SELECT src.Id,
        src.OwnerId,
        src.IsDeleted,
        src.Name,
        src.RecordTypeId,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.SystemModstamp,
        src.MayEdit,
        src.IsLocked,
        src.Meeting_Id_vod__c,
        src.Meeting_Name_vod__c,
        src.Mobile_ID_vod__c,
        src.Scheduled_DateTime_vod__c,
        src.Scheduled_vod__c,
        src.Attendance_Report_Process_Status_vod__c,
        src.Latest_Meeting_Start_Datetime_vod__c,
        src.Meeting_Password_vod__c,
        src.Meeting_Outcome_Status_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_REMOTE_MEETING_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_REMOTE_MEETING_VOD__C'::varchar(28)))));

CREATE  VIEW outbound.zs_austedo_activity_call_detail_weekly AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position
 FROM (datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id)))
 WHERE ((cd.basket_name ~~ 'AUSTEDO%'::varchar(8)) AND (c.call_date >= trunc((now() + '-15'::interval day), 'day'::varchar(3))))
 ORDER BY c.call_date;

CREATE  VIEW teva_ingestion.EXT_VV_EMAIL_ACTIVITY_VOD__C AS
 SELECT btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Id) AS ID,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.CreatedDate) AS CreatedDate,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.CreatedById) AS CreatedById,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.LastModifiedDate) AS LastModifiedDate,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.LastModifiedById) AS LastModifiedById,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.RecordTypeId) AS RecordTypeId,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.SystemModstamp) AS SystemModstamp,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Name) AS Name,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Event_type_vod__c) AS Event_type_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Activity_DateTime_vod__c) AS Activity_DateTime_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Event_Msg_vod__c) AS Event_Msg_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Approved_Document_vod__c) AS Approved_Document_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.City_vod__c) AS City_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Click_URL_vod__c) AS Click_URL_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Client_Name_vod__c) AS Client_Name_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Client_OS_vod__c) AS Client_OS_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Client_Type_vod__c) AS Client_Type_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Country_vod__c) AS Country_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Device_Type_vod__c) AS Device_Type_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Doc_ID_vod__c) AS Vault_Doc_ID_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Doc_Name_vod__c) AS Vault_Doc_Name_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Document_Number_vod__c) AS Vault_Document_Number_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Document_Title_vod__c) AS Vault_Document_Title_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.IP_Address_vod__c) AS IP_Address_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Link_Name_vod__c) AS Link_Name_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Document_Major_Version_vod__c) AS Vault_Document_Major_Version_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Document_Minor_Version_vod__c) AS Vault_Document_Minor_Version_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Preference_Modification_vod__c) AS Preference_Modification_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Region_vod__c) AS Region_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Sent_Email_vod__c) AS Sent_Email_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.User_Agent_vod__c) AS User_Agent_vod__c,
        btrim(EXT_VV_EMAIL_ACTIVITY_VOD__C_src.Vault_Instance_ID_vod__c) AS Vault_Instance_ID_vod__c,
        EXT_VV_EMAIL_ACTIVITY_VOD__C_src.batch_id,
        EXT_VV_EMAIL_ACTIVITY_VOD__C_src.row_id,
        EXT_VV_EMAIL_ACTIVITY_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_EMAIL_ACTIVITY_VOD__C_src;

CREATE  VIEW raw.EXT_VV_EMAIL_ACTIVITY_VOD__C AS
 SELECT src.Id,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.RecordTypeId,
        src.IsDeleted,
        src.SystemModstamp,
        src.Name,
        src.Event_type_vod__c,
        src.Activity_DateTime_vod__c,
        src.Event_Msg_vod__c,
        src.Approved_Document_vod__c,
        src.City_vod__c,
        src.Click_URL_vod__c,
        src.Client_Name_vod__c,
        src.Client_OS_vod__c,
        src.Client_Type_vod__c,
        src.Country_vod__c,
        src.Device_Type_vod__c,
        src.Vault_Doc_ID_vod__c,
        src.Vault_Doc_Name_vod__c,
        src.Vault_Document_Number_vod__c,
        src.Vault_Document_Title_vod__c,
        src.IP_Address_vod__c,
        src.Link_Name_vod__c,
        src.Vault_Document_Major_Version_vod__c,
        src.Vault_Document_Minor_Version_vod__c,
        src.Preference_Modification_vod__c,
        src.Region_vod__c,
        src.Sent_Email_vod__c,
        src.User_Agent_vod__c,
        src.Vault_Instance_ID_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_EMAIL_ACTIVITY_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_EMAIL_ACTIVITY_VOD__C'::varchar(28)))));

CREATE  VIEW outbound.concur_hcp_delta AS
 SELECT (trunc(hcp.tvcmid))::int AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 1))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.ADDRESS_TYPE = 2::float) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 1))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 1))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY (trunc(hcp.tvcmid))::int,
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp) EXCEPT  SELECT (trunc(hcp.tvcmid))::int AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 2))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.ADDRESS_TYPE = 2::float) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 2))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 2))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY (trunc(hcp.tvcmid))::int,
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp);

CREATE  VIEW outbound.asrs_event AS
 SELECT a.event_id,
        a.event_date,
        a.event_level_2,
        a.event_level_3,
        a.event_level_4,
        a.event_location_name,
        a.event_location_type,
        a.event_location_add_line1,
        a.event_location_add_line2,
        a.event_location_add_line3,
        a.event_location_add_line4,
        a.event_city,
        a.event_state,
        a.event_zip_code,
        a.attendee_count,
        a.employee_count,
        a.source_system_Desc,
        a.reqtr_id,
        a.reqtr_name,
        a.territory_id,
        a.territory_num,
        a.rec_create_Date,
        a.rec_last_update_date,
        a.record_delete_date
 FROM (((( SELECT a.call_id AS event_id,
        to_char(a.call_date, 'yyyy-mm-dd'::varchar(10)) AS event_date,
        NULL AS event_level_2,
        NULL AS event_level_3,
        NULL AS event_level_4,
        NULL AS event_location_name,
        'Other'::varchar(5) AS event_location_type,
        b.address_line_1_vod__c AS event_location_add_line1,
        b.address_line_2_vod__c AS event_location_add_line2,
        NULL AS event_location_add_line3,
        NULL AS event_location_add_line4,
        b.city_vod__c AS event_city,
        b.state_vod__c AS event_state,
        b.zip_vod__c AS event_zip_code,
        1 AS attendee_count,
        0 AS employee_count,
        'VEEVA'::varchar(5) AS source_system_Desc,
        a.rep_id AS reqtr_id,
        (a.rep_first_name || a.rep_last_name) AS reqtr_name,
        NULL AS territory_id,
        b.territory_vod__c AS territory_num,
        to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)) AS rec_create_Date,
        NULL AS rec_last_update_date,
        NULL AS record_delete_date,
        a.veeva_account_id AS account_id
 FROM (datamart.sfa_call a LEFT  JOIN veeva.call b ON (((a.call_id = b.id) AND (b.status_vod__c = 'Submitted_vod'::varchar(13)))))
 WHERE ((a.call_date >= to_date('01/01/2018'::varchar(10), 'mm/dd/yyyy'::varchar(10))) AND (a.call_id IS NOT NULL))
 GROUP BY a.call_id,
          to_char(a.call_date, 'yyyy-mm-dd'::varchar(10)),
          NULL,
          'Other'::varchar(5),
          b.address_line_1_vod__c,
          b.address_line_2_vod__c,
          b.city_vod__c,
          b.state_vod__c,
          b.zip_vod__c,
          'VEEVA'::varchar(5),
          a.rep_id,
          (a.rep_first_name || a.rep_last_name),
          b.territory_vod__c,
          to_char((statement_timestamp())::timestamp, 'yyyy-mm-dd'::varchar(10)),
          a.veeva_account_id) a JOIN ( SELECT sfa_reprints.call_id AS event_id,
        sfa_reprints.reprint_id AS product_id
 FROM datamart.sfa_reprints) b ON ((a.event_id = b.event_id))) JOIN ( SELECT v_product.external_id_vod__c AS product_id
 FROM veeva.v_product
 WHERE (v_product.cost_vod__c IS NOT NULL)) c ON ((b.product_id = c.product_id))) JOIN ( SELECT v_account.id AS account_id
 FROM veeva.v_account
 WHERE (v_account.recordtypeid = '012E0000000a8X9IAI'::varchar(18))) d ON ((d.account_id = a.account_id)))
 GROUP BY a.event_id,
          a.event_date,
          a.event_level_2,
          a.event_level_3,
          a.event_level_4,
          a.event_location_name,
          a.event_location_type,
          a.event_location_add_line1,
          a.event_location_add_line2,
          a.event_location_add_line3,
          a.event_location_add_line4,
          a.event_city,
          a.event_state,
          a.event_zip_code,
          a.attendee_count,
          a.employee_count,
          a.source_system_Desc,
          a.reqtr_id,
          a.reqtr_name,
          a.territory_id,
          a.territory_num,
          a.rec_create_Date,
          a.rec_last_update_date,
          a.record_delete_date;

CREATE  VIEW veeva.v_dedup_ids_call AS
 SELECT vc.id AS call_id,
        vc.account_vod__c AS veeva_account_id,
        vc.call_type_vod__c AS call_type,
        va.recordtypeid,
        vu.employeenumber AS rep_id,
        CASE WHEN (vc.created_by_timezone_tva__c IS NOT NULL) THEN "timezone"(vc.created_by_timezone_tva__c, vc.call_datetime_vod__c) WHEN (tz.zip IS NOT NULL) THEN "timezone"(tz.timezone_name, vc.call_datetime_vod__c) ELSE "timezone"(vu.timezonesidkey, vc.call_datetime_vod__c) END AS call_datetime,
        vc.how_executed_tva__c AS how_executed,
        CASE WHEN (vc.how_executed_tva__c = 'Engage Meeting'::varchar(14)) THEN 1 WHEN (vc.how_executed_tva__c = 'Face to Face'::varchar(12)) THEN 2 WHEN (vc.how_executed_tva__c = 'Phone  with Brand website'::varchar(28)) THEN 3 WHEN (vc.how_executed_tva__c = 'Phone'::varchar(5)) THEN 4 WHEN (vc.how_executed_tva__c = 'Phone - HCP'::varchar(11)) THEN 6 WHEN (vc.how_executed_tva__c = 'Phone - Staff'::varchar(13)) THEN 7 WHEN (vc.how_executed_tva__c = 'Approved Email'::varchar(14)) THEN 8 ELSE 100 END AS he_id
 FROM veeva.v_account va, (((veeva.call vc JOIN ( SELECT v_veeva_user.id,
        v_veeva_user.username,
        v_veeva_user.lastname,
        v_veeva_user.firstname,
        v_veeva_user.name,
        v_veeva_user.companyname,
        v_veeva_user.division,
        v_veeva_user.department,
        v_veeva_user.title,
        v_veeva_user.street,
        v_veeva_user.city,
        v_veeva_user.state,
        v_veeva_user.postalcode,
        v_veeva_user.country,
        v_veeva_user.latitude,
        v_veeva_user.longitude,
        v_veeva_user.email,
        v_veeva_user.emailpreferencesautobcc,
        v_veeva_user.emailpreferencesautobccstayint,
        v_veeva_user.emailpreferencesstayintouchrem,
        v_veeva_user.senderemail,
        v_veeva_user.sendername,
        v_veeva_user.signature,
        v_veeva_user.stayintouchsubject,
        v_veeva_user.stayintouchsignature,
        v_veeva_user.stayintouchnote,
        v_veeva_user.phone,
        v_veeva_user.fax,
        v_veeva_user.mobilephone,
        v_veeva_user.alias,
        v_veeva_user.communitynickname,
        v_veeva_user.isactive,
        v_veeva_user.timezonesidkey,
        v_veeva_user.userroleid,
        v_veeva_user.localesidkey,
        v_veeva_user.receivesinfoemails,
        v_veeva_user.receivesadmininfoemails,
        v_veeva_user.emailencodingkey,
        v_veeva_user.usertype,
        v_veeva_user.languagelocalekey,
        v_veeva_user.employeenumber,
        v_veeva_user.delegatedapproverid,
        v_veeva_user.managerid,
        v_veeva_user.lastlogindate,
        v_veeva_user.createddate,
        v_veeva_user.createdbyid,
        v_veeva_user.lastmodifieddate,
        v_veeva_user.lastmodifiedbyid,
        v_veeva_user.systemmodstamp,
        v_veeva_user.offlinetrialexpirationdate,
        v_veeva_user.offlinepdatrialexpirationdate,
        v_veeva_user.userpermissionsmarketinguser,
        v_veeva_user.userpermissionsofflineuser,
        v_veeva_user.userpermissionswirelessuser,
        v_veeva_user.userpermissionsavantgouser,
        v_veeva_user.userpermscallcenterautologin,
        v_veeva_user.userpermissionsmobileuser,
        v_veeva_user.userpermissionssfcontentuser,
        v_veeva_user.userpermissionsinteractionuser,
        v_veeva_user.userpermschatteranswersuser,
        v_veeva_user.forecastenabled,
        v_veeva_user.userprefsactivityreminderspopu,
        v_veeva_user.userprefseventreminderscheckbo,
        v_veeva_user.userprefstaskreminderscheckbox,
        v_veeva_user.userprefsremindersoundoff,
        v_veeva_user.userprefshidecsngetchattermobi,
        v_veeva_user.userprefshidecsndesktoptask,
        v_veeva_user.userpreferencesoptoutoftouch,
        v_veeva_user.userprefsshowtitletoexternalus,
        v_veeva_user.userprefsshowmanagertoexternal,
        v_veeva_user.userprefsshowemailtoexternalus,
        v_veeva_user.userprefsshowworkphonetoextern,
        v_veeva_user.userprefsshowmobilephonetoexte,
        v_veeva_user.userprefsshowfaxtoexternaluser,
        v_veeva_user.userprefsshowstreetaddresstoex,
        v_veeva_user.userprefsshowcitytoexternaluse,
        v_veeva_user.userprefsshowstatetoexternalus,
        v_veeva_user.userprefsshowpostalcodetoexter,
        v_veeva_user.userprefsshowcountrytoexternal,
        v_veeva_user.userprefsshowprofilepictoguest,
        v_veeva_user.userprefsshowtitletoguestusers,
        v_veeva_user.userprefsshowcitytoguestusers,
        v_veeva_user.userprefsshowstatetoguestusers,
        v_veeva_user.userprefsshowpostalcodetoguest,
        v_veeva_user.userprefsshowcountrytoguestuse,
        v_veeva_user.contactid,
        v_veeva_user.accountid,
        v_veeva_user.callcenterid,
        v_veeva_user.extension,
        v_veeva_user.federationidentifier,
        v_veeva_user.lastvieweddate,
        v_veeva_user.lastreferenceddate,
        v_veeva_user.last_mobile_connect_vod__c,
        v_veeva_user.last_tablet_connect_vod__c,
        v_veeva_user.last_mobile_connect_version,
        v_veeva_user.last_tablet_connect_version,
        v_veeva_user.last_mobile_sync_vod__c,
        v_veeva_user.last_tablet_sync_vod__c,
        v_veeva_user.raiselogginglevel_vod__c,
        v_veeva_user.senddetailedlog_vod__c,
        v_veeva_user.last_blackberry_connect_vod__c,
        v_veeva_user.last_blackberry_connect_versio,
        v_veeva_user.last_blackberry_sync_vod__c,
        v_veeva_user.force_full_refresh_vod__c,
        v_veeva_user.override_systemmodstamp_timest,
        v_veeva_user.facetime_email_vod__c,
        v_veeva_user.facetime_phone_vod__c,
        v_veeva_user.product_expertise_vod__c,
        v_veeva_user.available_vod__c,
        v_veeva_user.available_last_update_vod__c,
        v_veeva_user.last_ipad_connect_version,
        v_veeva_user.last_ipad_connect_vod__c,
        v_veeva_user.last_ipad_sync_vod__c,
        v_veeva_user.inventory_order_allocation_gro,
        v_veeva_user.concur_user_id_vod__c,
        v_veeva_user.external_id_tva__c,
        v_veeva_user.last_ipad_ios_version_vod__c,
        v_veeva_user.veeva_id__c,
        v_veeva_user.login_id_tva__c,
        v_veeva_user.primary_territory_vod__c,
        v_veeva_user.analytics_admin_vod__c,
        v_veeva_user.content_admin_vod__c,
        v_veeva_user.upload_vtrans_vod__c,
        v_veeva_user.can_sample_tva__c,
        v_veeva_user.do_not_modify_tva__c,
        v_veeva_user.profile_name_vod__c,
        v_veeva_user.file_id,
        v_veeva_user.record_id
 FROM veeva.v_veeva_user
 WHERE (length(v_veeva_user.lastname) <= 50)) vu ON ((vc.ownerid = vu.id))) LEFT  JOIN reference.zipcode_timezone tz ON ((vc.zip_vod__c = tz.zip))) LEFT  JOIN reference.how_executed he ON ((vc.how_executed_tva__c = he.how_executed)))
 WHERE ((va.id = vc.account_vod__c) AND (vc.id IN ( SELECT v_ids_call.id
 FROM veeva.v_ids_call)))
 GROUP BY vc.id,
          vc.account_vod__c,
          vc.call_type_vod__c,
          va.recordtypeid,
          vu.employeenumber,
          CASE WHEN (vc.created_by_timezone_tva__c IS NOT NULL) THEN "timezone"(vc.created_by_timezone_tva__c, vc.call_datetime_vod__c) WHEN (tz.zip IS NOT NULL) THEN "timezone"(tz.timezone_name, vc.call_datetime_vod__c) ELSE "timezone"(vu.timezonesidkey, vc.call_datetime_vod__c) END,
          vc.how_executed_tva__c,
          CASE WHEN (vc.how_executed_tva__c = 'Engage Meeting'::varchar(14)) THEN 1 WHEN (vc.how_executed_tva__c = 'Face to Face'::varchar(12)) THEN 2 WHEN (vc.how_executed_tva__c = 'Phone  with Brand website'::varchar(28)) THEN 3 WHEN (vc.how_executed_tva__c = 'Phone'::varchar(5)) THEN 4 WHEN (vc.how_executed_tva__c = 'Phone - HCP'::varchar(11)) THEN 6 WHEN (vc.how_executed_tva__c = 'Phone - Staff'::varchar(13)) THEN 7 WHEN (vc.how_executed_tva__c = 'Approved Email'::varchar(14)) THEN 8 ELSE 100 END;

CREATE  VIEW outbound.zs_laba_weekly AS
 SELECT rx.ims_id,
        rx.tvcmid,
        rx.market_name,
        rx.basket_id,
        rx.basket_name,
        rx.basket_type,
        rx.rollup_week,
        rx.rollup_month,
        rx.sales_category,
        rx.payer_plan_number,
        rx.payer_name,
        rx.plan_name,
        rx.pbm_name,
        rx.pbm_parent_name,
        rx.model,
        rx.payment_method,
        rx.report_frequency,
        rx.rollup_flag,
        pcd.specialty,
        xref.specialty_group,
        sum(rx.nrx_count) AS nrx_count,
        sum(rx.trx_count) AS trx_count
 FROM ((datamart.prescriber_rx rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE ((rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (rx.market_name = 'LABA MARKET TOTAL'::varchar(17)) AND (rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))
 GROUP BY rx.ims_id,
          rx.tvcmid,
          rx.market_name,
          rx.basket_id,
          rx.basket_name,
          rx.basket_type,
          rx.rollup_week,
          rx.rollup_month,
          rx.sales_category,
          rx.payer_plan_number,
          rx.payer_name,
          rx.plan_name,
          rx.pbm_name,
          rx.pbm_parent_name,
          rx.model,
          rx.payment_method,
          rx.report_frequency,
          rx.rollup_flag,
          pcd.specialty,
          xref.specialty_group;

CREATE  VIEW outbound.zs_saba_weekly AS
 SELECT rx.ims_id,
        rx.tvcmid,
        rx.market_name,
        rx.basket_id,
        rx.basket_name,
        rx.basket_type,
        rx.rollup_week,
        rx.rollup_month,
        rx.sales_category,
        rx.payer_plan_number,
        rx.payer_name,
        rx.plan_name,
        rx.pbm_name,
        rx.pbm_parent_name,
        rx.model,
        rx.payment_method,
        rx.report_frequency,
        rx.rollup_flag,
        pcd.specialty,
        xref.specialty_group,
        sum(rx.nrx_count) AS nrx_count,
        sum(rx.trx_count) AS trx_count
 FROM ((datamart.prescriber_rx rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE ((rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (rx.market_name = 'SABA MARKET TOTAL'::varchar(17)) AND (rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))))
 GROUP BY rx.ims_id,
          rx.tvcmid,
          rx.market_name,
          rx.basket_id,
          rx.basket_name,
          rx.basket_type,
          rx.rollup_week,
          rx.rollup_month,
          rx.sales_category,
          rx.payer_plan_number,
          rx.payer_name,
          rx.plan_name,
          rx.pbm_name,
          rx.pbm_parent_name,
          rx.model,
          rx.payment_method,
          rx.report_frequency,
          rx.rollup_flag,
          pcd.specialty,
          xref.specialty_group;

CREATE  VIEW outbound.zs_ics_market_monthly AS
 SELECT rx.ims_id,
        rx.tvcmid,
        rx.market_name,
        rx.basket_id,
        rx.basket_name,
        rx.basket_type,
        rx.rollup_week,
        rx.rollup_month,
        rx.sales_category,
        rx.nrx_count,
        rx.trx_count,
        rx.payer_plan_number,
        rx.payer_name,
        rx.plan_name,
        rx.pbm_name,
        rx.pbm_parent_name,
        rx.model,
        rx.payment_method,
        rx.report_frequency,
        rx.rollup_flag,
        pcd.specialty,
        xref.specialty_group
 FROM ((datamart.prescriber_rx rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))) AND (rx.report_frequency = 'MONTH'::varchar(5)))
 GROUP BY rx.ims_id,
          rx.tvcmid,
          rx.market_name,
          rx.basket_id,
          rx.basket_name,
          rx.basket_type,
          rx.rollup_week,
          rx.rollup_month,
          rx.sales_category,
          rx.nrx_count,
          rx.trx_count,
          rx.payer_plan_number,
          rx.payer_name,
          rx.plan_name,
          rx.pbm_name,
          rx.pbm_parent_name,
          rx.model,
          rx.payment_method,
          rx.report_frequency,
          rx.rollup_flag,
          pcd.specialty,
          xref.specialty_group UNION  SELECT rx.ims_id,
        rx.tvcmid,
        rx.market_name,
        rx.basket_id,
        rx.basket_name,
        rx.basket_type,
        rx.rollup_week,
        rx.rollup_month,
        rx.sales_category,
        rx.nrx_count,
        rx.trx_count,
        rx.payer_plan_number,
        rx.payer_name,
        rx.plan_name,
        rx.pbm_name,
        rx.pbm_parent_name,
        rx.model,
        rx.payment_method,
        rx.report_frequency,
        rx.rollup_flag,
        pcd.specialty,
        xref.specialty_group
 FROM ((datamart.prescriber_rx rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.data_date >= '2020-01-30'::date) AND (rx.rollup_month >= trunc((now() + '-24'::interval month), 'month'::varchar(5))) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (rx.basket_name ~~* 'ARMO%%'::varchar(6)))
 GROUP BY rx.ims_id,
          rx.tvcmid,
          rx.market_name,
          rx.basket_id,
          rx.basket_name,
          rx.basket_type,
          rx.rollup_week,
          rx.rollup_month,
          rx.sales_category,
          rx.nrx_count,
          rx.trx_count,
          rx.payer_plan_number,
          rx.payer_name,
          rx.plan_name,
          rx.pbm_name,
          rx.pbm_parent_name,
          rx.model,
          rx.payment_method,
          rx.report_frequency,
          rx.rollup_flag,
          pcd.specialty,
          xref.specialty_group;

CREATE  VIEW outbound.zs_addon_details_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.addon_from_product_group_num,
        rx.addon_from_basket_id,
        rx.addon_from_basket_name,
        rx.addon_to_product_group_num,
        rx.addon_to_basket_id,
        rx.addon_to_basket_name,
        rx.rollup_period AS addon_rx,
        rx.report_frequency
 FROM ((datamart.xpd_add_on_details rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.addon_from_product_group_num,
          rx.addon_from_basket_id,
          rx.addon_from_basket_name,
          rx.addon_to_product_group_num,
          rx.addon_to_basket_id,
          rx.addon_to_basket_name,
          rx.rollup_period,
          rx.report_frequency;

CREATE  VIEW outbound.zs_restart_diff_details_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.restart_from_product_group_num,
        rx.restart_from_basket_id,
        rx.restart_from_basket_name,
        rx.restart_to_product_group_num,
        rx.restart_to_basket_id,
        rx.restart_to_basket_name,
        rx.rollup_period,
        rx.restart_diff_rx,
        rx.report_frequency
 FROM ((datamart.xpd_restart_diff_details rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TS'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.restart_from_product_group_num,
          rx.restart_from_basket_id,
          rx.restart_from_basket_name,
          rx.restart_to_product_group_num,
          rx.restart_to_basket_id,
          rx.restart_to_basket_name,
          rx.rollup_period,
          rx.restart_diff_rx,
          rx.report_frequency;

CREATE  VIEW outbound.zs_digihaler_activity_sample_shipment AS
 SELECT sample_shipment.veeva_id,
        sample_shipment.tvcmid,
        sample_shipment.ims_id,
        sample_shipment.first_name,
        sample_shipment.middle_name,
        sample_shipment.last_name,
        sample_shipment.designation,
        sample_shipment.state_license_number,
        sample_shipment.address_line_1,
        sample_shipment.address_line_2,
        sample_shipment.address_line_3,
        sample_shipment.city,
        sample_shipment.state,
        sample_shipment.zip,
        sample_shipment.dea_license_number,
        sample_shipment.order_id,
        sample_shipment.ndc,
        sample_shipment.basket_id,
        sample_shipment.basket_name,
        sample_shipment.order_job_code,
        sample_shipment.order_job_description,
        sample_shipment.ship_qty,
        sample_shipment.ship_date
 FROM datamart.sample_shipment
 WHERE ((sample_shipment.basket_name ~~* '%DIGIHALER%'::varchar(11)) AND (sample_shipment.ship_date >= '2020-01-01'::date))
 ORDER BY sample_shipment.ship_date;

CREATE  VIEW outbound.respiratory_fia_monthly AS
 SELECT fia.basket_id,
        fia.basket_name,
        fia.claim_id,
        fia.patient_id,
        fia.sequence_number,
        fia.product_id,
        fia.fill_date,
        fia.claim_type,
        fia.reject_code,
        fia.days_supply,
        fia.quantity,
        fia.refill_code,
        fia.payer_plan_id,
        fia.opc_ask,
        fia.sec_payer_plan_id,
        fia.buy_down,
        fia.opc_paid,
        fia.prescriber_id,
        fia.sob,
        fia.sub_product_id,
        fia.sub_opc,
        fia.initial_claim_id,
        fia.prev_product_id,
        fia.daw_code,
        fia.wrt_date,
        fia.claim_status,
        fia.copay_card_flg,
        fia.zip_code,
        fia.ecoup_flag,
        fia.ecoup_offset_amt,
        fia.standard_copay,
        fia.standard_copay_yn,
        fia.market_id,
        fia.flexible_fld_1_char,
        fia.flexible_fld_2_char,
        fia.flexible_fld_3_char,
        fia.flexible_fld_4_char,
        fia.file_id,
        fia.record_id,
        fia.cbsa_code,
        fia.cbsa_description,
        fia.state_code,
        fia.payer_name,
        fia.plan_name,
        fia.pbm_name,
        fia.pbm_id,
        fia.method_of_payment,
        fia.model_type,
        fia.product_group,
        fia.product_group_id,
        fia.product_name,
        fia.generic_name,
        fia.brand_generic_flag,
        fia.product_form,
        fia.product_strength,
        fia.package_size,
        fia.manufacturer,
        fia.cmf10,
        fia.usc_code,
        fia.fia_market_desc,
        fia.reject_reason,
        fia.reject_group,
        fia.mpd_year,
        fia.mpd_eligibility_class,
        fia.deductible_start_date,
        fia.copay_start_date,
        fia.gap_start_date,
        fia.catastrophic_start_date,
        fia.mpd_panel_patient,
        fia.PROVIDER_TYPE,
        fia.IQVIA_RXER_ID,
        fia.PRIMARY_SPECIALTY_CODE,
        fia.PRIMARY_SPECIALTY_DESC,
        fia.FIRST_NAME,
        fia.LAST_NAME,
        fia.ORG_NM,
        fia.ADDRESS,
        fia.CITY,
        fia.PVR_ZIP_CODE,
        fia.PVR_STATE_CODE,
        fia.PHONE_NUMBER
 FROM datamart.fia fia
 WHERE ((fia.fill_date >= '2020-01-01'::date) AND (fia.basket_id IN ( SELECT source_product.entity_id
 FROM product.source_product
 WHERE (source_product.source_file_code = 'A67.F12158'::varchar(10)))));

CREATE  VIEW outbound.zs_copay_weekly AS
 SELECT copay.redemption_type,
        copay.physician_tvcmid,
        copay.pharmacy_tvcmid,
        copay.basket_id,
        copay.basket_name,
        copay.asi_txn_id,
        copay.orig_asi_txn_id,
        copay.rx_num,
        copay.fill_date,
        copay.date_written,
        copay.days_supply,
        copay.ndc_code,
        copay.daw,
        copay.new_refill,
        copay.quantity,
        copay.refills,
        copay.other_coverage_code,
        copay.program_number,
        copay.copay_card_number,
        copay.sex,
        copay.age_at_redemption,
        copay.pharmacy_process_date,
        copay.nabp,
        copay.pharmacy_chain_number,
        copay.pharmacy_chain,
        copay.pharmacy_name,
        copay.pharmacy_address,
        copay.pharmacy_address2,
        copay.pharmacy_city,
        copay.pharmacy_state,
        copay.pharmacy_zip,
        copay.pharmacy_phone,
        copay.pharmacy_npi_num,
        copay.principle_physician_dea,
        copay.physician_npi,
        copay.physician_ims_id,
        copay.physician_veeva_id,
        copay.physician_name,
        copay.physician_address1,
        copay.physician_address2,
        copay.physician_city,
        copay.physician_state,
        copay.physician_zip,
        copay.rebate_amount,
        copay.member_cash_expense,
        copay.submitted_cost,
        copay.pharmacy_fee,
        copay.total_amount_due,
        copay.calc_awp,
        copay.occ_payment_type,
        copay.auth_refills,
        copay.claim_type,
        copay.administration_flag,
        copay.payer_name,
        copay.trans_type,
        copay.previous_payer_id,
        copay.benefit_amount,
        copay.patient_expense,
        copay.submission_method,
        copay.source_name,
        copay.patient_type,
        copay.primary_bin,
        copay.primary_bin_description,
        copay.reject_code
 FROM datamart.copay
 WHERE ((copay.basket_name ~~* '%AJOVY%'::varchar(7)) OR (copay.basket_name ~~* '%AUSTEDO%'::varchar(9)) OR (copay.basket_name ~~* '%DIGIHALER%'::varchar(11)))
 GROUP BY copay.redemption_type,
          copay.physician_tvcmid,
          copay.pharmacy_tvcmid,
          copay.basket_id,
          copay.basket_name,
          copay.asi_txn_id,
          copay.orig_asi_txn_id,
          copay.rx_num,
          copay.fill_date,
          copay.date_written,
          copay.days_supply,
          copay.ndc_code,
          copay.daw,
          copay.new_refill,
          copay.quantity,
          copay.refills,
          copay.other_coverage_code,
          copay.program_number,
          copay.copay_card_number,
          copay.sex,
          copay.age_at_redemption,
          copay.pharmacy_process_date,
          copay.nabp,
          copay.pharmacy_chain_number,
          copay.pharmacy_chain,
          copay.pharmacy_name,
          copay.pharmacy_address,
          copay.pharmacy_address2,
          copay.pharmacy_city,
          copay.pharmacy_state,
          copay.pharmacy_zip,
          copay.pharmacy_phone,
          copay.pharmacy_npi_num,
          copay.principle_physician_dea,
          copay.physician_npi,
          copay.physician_ims_id,
          copay.physician_veeva_id,
          copay.physician_name,
          copay.physician_address1,
          copay.physician_address2,
          copay.physician_city,
          copay.physician_state,
          copay.physician_zip,
          copay.rebate_amount,
          copay.member_cash_expense,
          copay.submitted_cost,
          copay.pharmacy_fee,
          copay.total_amount_due,
          copay.calc_awp,
          copay.occ_payment_type,
          copay.auth_refills,
          copay.claim_type,
          copay.administration_flag,
          copay.payer_name,
          copay.trans_type,
          copay.previous_payer_id,
          copay.benefit_amount,
          copay.patient_expense,
          copay.submission_method,
          copay.source_name,
          copay.patient_type,
          copay.primary_bin,
          copay.primary_bin_description,
          copay.reject_code;

CREATE  VIEW outbound.zs_specialty_group_adhoc AS
( SELECT CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END AS sales_force_id,
        msf.market_basket_id,
        msf.market_name,
        sgx.specialty_code,
        sgx.specialty_group,
        msf.specialty_group_name
 FROM reference.reporting_market_sales_force msf, reference.specialty_group_xref sgx
 WHERE (sgx.category_name = msf.specialty_group_name)
 GROUP BY CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END,
          msf.market_basket_id,
          msf.market_name,
          sgx.specialty_code,
          sgx.specialty_group,
          msf.specialty_group_name UNION  SELECT CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END AS sales_force_id,
        msf.market_basket_id,
        msf.market_name,
        sgx.specialty_code,
        sgx.specialty_group,
        msf.specialty_group_name
 FROM reference.ref_rptng_mrkt_sales_force_05132020 msf, reference.specialty_group_xref sgx
 WHERE ((sgx.category_name = msf.specialty_group_name) AND (sgx.category_name = ANY (ARRAY['QVAR'::varchar(7), 'CINQAIR'::varchar(7)])))
 GROUP BY CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END,
          msf.market_basket_id,
          msf.market_name,
          sgx.specialty_code,
          sgx.specialty_group,
          msf.specialty_group_name) UNION  SELECT CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END AS sales_force_id,
        msf.market_basket_id,
        msf.market_name,
        sgx.specialty_code,
        CASE WHEN (sgx.specialty_code = ANY (ARRAY['MFM'::varchar(3), 'WMN'::varchar(3), 'GYN'::varchar(3), 'OBG'::varchar(3), 'REN'::varchar(3), 'OBS'::varchar(3), 'WH'::varchar(2)])) THEN 'OBG'::varchar(3) ELSE sgx.specialty_group END AS specialty_group,
        'AJOVY WITH OBG'::varchar(14) AS specialty_group_name
 FROM reference.reporting_market_sales_force msf, reference.specialty_group_xref sgx
 WHERE ((sgx.category_name = msf.specialty_group_name) AND (sgx.category_name = 'AJOVY'::varchar(5)))
 GROUP BY CASE WHEN (msf.sales_force_id = 'SA'::varchar(2)) THEN 'TS'::varchar(2) WHEN (msf.sales_force_id = 'NS'::varchar(2)) THEN 'TN'::varchar(2) WHEN (msf.sales_force_id = 'SP'::varchar(2)) THEN 'TR'::varchar(2) WHEN (msf.sales_force_id = 'MA'::varchar(2)) THEN 'MA'::varchar(2) WHEN (msf.sales_force_id = 'ON'::varchar(2)) THEN 'TO'::varchar(2) WHEN (msf.sales_force_id = 'NP'::varchar(2)) THEN 'TP'::varchar(2) ELSE msf.sales_force_id END,
          msf.market_basket_id,
          msf.market_name,
          sgx.specialty_code,
          CASE WHEN (sgx.specialty_code = ANY (ARRAY['MFM'::varchar(3), 'WMN'::varchar(3), 'GYN'::varchar(3), 'OBG'::varchar(3), 'REN'::varchar(3), 'OBS'::varchar(3), 'WH'::varchar(2)])) THEN 'OBG'::varchar(3) ELSE sgx.specialty_group END,
          'AJOVY WITH OBG'::varchar(14);

CREATE  VIEW outbound.zs_zip_terr AS
 SELECT current_alignment.sales_force_id,
        current_alignment.zip_code,
        current_alignment.city,
        current_alignment.state_code,
        current_alignment.territory_number,
        current_alignment.territory_name,
        current_alignment.area_number,
        current_alignment.area_name,
        current_alignment.region_number,
        current_alignment.region_name,
        current_alignment.mirror_flag,
        CASE WHEN (current_alignment.mirror_territory_number = 'NULL'::varchar(4)) THEN NULL ELSE current_alignment.mirror_territory_number END AS mirror_territory_number
 FROM datamart.current_alignment
 WHERE (current_alignment.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)]));

CREATE  VIEW outbound.saba_laba_mop_digihaler_temp AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.payment_method,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.payment_method,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT row_number() OVER (ORDER BY z.rollup_month DESC) AS month_bucket,
        z.rollup_month
 FROM ( SELECT prescriber_rx.rollup_month
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.market_name = 'SABA MARKET TOTAL'::varchar(17)) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.rollup_week >= prescriber_rx.rollup_month))
 GROUP BY prescriber_rx.rollup_month) z) w ON ((rx.rollup_month = w.rollup_month))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = 'SABA MARKET TOTAL'::varchar(17)) AND (rx.basket_name ~~* '%PRO%DIGIHA%'::varchar(12)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.payment_method,
          rx_vertical.basket_name;

CREATE  VIEW teva_ingestion.EXT_VV_SENT_EMAIL_VOD__C AS
 SELECT btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Id) AS ID,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.CreatedDate) AS CreatedDate,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.CreatedById) AS CreatedById,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.LastModifiedDate) AS LastModifiedDate,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.LastModifiedById) AS LastModifiedById,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.OwnerId) AS OwnerId,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.RecordTypeId) AS RecordTypeId,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.IsDeleted) AS IsDeleted,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.SystemModstamp) AS SystemModstamp,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Name) AS Name,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Account_vod__c) AS Account_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Activity_Tracking_Mode_vod__c) AS Activity_Tracking_Mode_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.EM_Attendee_vod__c) AS EM_Attendee_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Bcc_vod__c) AS Bcc_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Call2_vod__c) AS Call2_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Capture_Datetime_vod__c) AS Capture_Datetime_vod__c,
        CASE WHEN (EXT_VV_SENT_EMAIL_VOD__C_src.Clicked_vod__c = ''::varchar) THEN NULL::float ELSE (btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Clicked_vod__c))::float END AS Clicked_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Content_Type_vod__c) AS Content_Type_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Detail_Group_vod__c) AS Detail_Group_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Approved_Document_Views_vod__c) AS Approved_Document_Views_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Entity_Reference_Id_vod__c) AS Entity_Reference_Id_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Event_vod__c) AS Event_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Event_Attendee_vod__c) AS Event_Attendee_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Event_Attendee_Mobile_Id_vod__c) AS Event_Attendee_Mobile_Id_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Event_Mobile_Id_vod__c) AS Event_Mobile_Id_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Events_Management_Subtype_vod__c) AS Events_Management_Subtype_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.EM_Event_Speaker_vod__c) AS EM_Event_Speaker_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.EM_Event_Team_Member_vod__c) AS EM_Event_Team_Member_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Sender_Email_vod__c) AS Sender_Email_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Key_Message_vod__c) AS Key_Message_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Last_Click_Date_vod__c) AS Last_Click_Date_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Last_Device_vod__c) AS Last_Device_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Last_Activity_Date_vod__c) AS Last_Activity_Date_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Last_Open_Date_vod__c) AS Last_Open_Date_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.MC_Capture_Datetime_vod__c) AS MC_Capture_Datetime_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Medical_Event_vod__c) AS Medical_Event_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Medical_Inquiry_vod__c) AS Medical_Inquiry_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Mobile_ID_vod__c) AS Mobile_ID_vod__c,
        CASE WHEN (EXT_VV_SENT_EMAIL_VOD__C_src.Opened_vod__c = ''::varchar) THEN NULL::float ELSE (btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Opened_vod__c))::float END AS Opened_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Parent_Email_vod__c) AS Parent_Email_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Product_vod__c) AS Product_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Product_Display_vod__c) AS Product_Display_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Receipt_Entity_Type_vod__c) AS Receipt_Entity_Type_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Receipt_Record_Id_vod__c) AS Receipt_Record_Id_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Related_Transaction_ID_vod__c) AS Related_Transaction_ID_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Scheduled_Send_Datetime_vod__c) AS Scheduled_Send_Datetime_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Email_Sent_Date_vod__c) AS Email_Sent_Date_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Status_vod__c) AS Status_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Failure_Msg_vod__c) AS Failure_Msg_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Suggestion_vod__c) AS Suggestion_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Territory_vod__c) AS Territory_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Account_Email_vod__c) AS Account_Email_vod__c,
        CASE WHEN (EXT_VV_SENT_EMAIL_VOD__C_src.Click_Count_vod__c = ''::varchar) THEN NULL::float ELSE (btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Click_Count_vod__c))::float END AS Click_Count_vod__c,
        CASE WHEN (EXT_VV_SENT_EMAIL_VOD__C_src.Open_Count_vod__c = ''::varchar) THEN NULL::float ELSE (btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Open_Count_vod__c))::float END AS Open_Count_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.User_vod__c) AS User_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Valid_Consent_Exists_vod__c) AS Valid_Consent_Exists_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.VExternal_Id_vod__c) AS VExternal_Id_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.Approved_Email_Template_vod__c) AS Approved_Email_Template_vod__c,
        btrim(EXT_VV_SENT_EMAIL_VOD__C_src.subject) AS subject,
        EXT_VV_SENT_EMAIL_VOD__C_src.batch_id,
        EXT_VV_SENT_EMAIL_VOD__C_src.row_id,
        EXT_VV_SENT_EMAIL_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_SENT_EMAIL_VOD__C_src;

CREATE  VIEW raw.EXT_VV_SENT_EMAIL_VOD__C AS
 SELECT src.Id,
        src.CreatedDate,
        src.CreatedById,
        src.LastModifiedDate,
        src.LastModifiedById,
        src.OwnerId,
        src.RecordTypeId,
        src.IsDeleted,
        src.SystemModstamp,
        src.Name,
        src.Account_vod__c,
        src.Activity_Tracking_Mode_vod__c,
        src.EM_Attendee_vod__c,
        src.Bcc_vod__c,
        src.Call2_vod__c,
        src.Capture_Datetime_vod__c,
        src.Clicked_vod__c,
        src.Content_Type_vod__c,
        src.Detail_Group_vod__c,
        src.Approved_Document_Views_vod__c,
        src.Entity_Reference_Id_vod__c,
        src.Event_vod__c,
        src.Event_Attendee_vod__c,
        src.Event_Attendee_Mobile_Id_vod__c,
        src.Event_Mobile_Id_vod__c,
        src.Events_Management_Subtype_vod__c,
        src.EM_Event_Speaker_vod__c,
        src.EM_Event_Team_Member_vod__c,
        src.Sender_Email_vod__c,
        src.Key_Message_vod__c,
        src.Last_Click_Date_vod__c,
        src.Last_Device_vod__c,
        src.Last_Activity_Date_vod__c,
        src.Last_Open_Date_vod__c,
        src.MC_Capture_Datetime_vod__c,
        src.Medical_Event_vod__c,
        src.Medical_Inquiry_vod__c,
        src.Mobile_ID_vod__c,
        src.Opened_vod__c,
        src.Parent_Email_vod__c,
        src.Product_vod__c,
        src.Product_Display_vod__c,
        src.Receipt_Entity_Type_vod__c,
        src.Receipt_Record_Id_vod__c,
        src.Related_Transaction_ID_vod__c,
        src.Scheduled_Send_Datetime_vod__c,
        src.Email_Sent_Date_vod__c,
        src.Status_vod__c,
        src.Failure_Msg_vod__c,
        src.Suggestion_vod__c,
        src.Territory_vod__c,
        src.Account_Email_vod__c,
        src.Click_Count_vod__c,
        src.Open_Count_vod__c,
        src.User_vod__c,
        src.Valid_Consent_Exists_vod__c,
        src.VExternal_Id_vod__c,
        src.Approved_Email_Template_vod__c,
        src.subject,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SENT_EMAIL_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SENT_EMAIL_VOD__C'::varchar(24)))));

CREATE  VIEW WSMP_ADMIN_ORA.Syneos_Cinqair_dddmd AS
 SELECT ca.sales_force_id,
        ca.territory_number,
        dddmd.onc_account_demo_id,
        dddmd.outlet_name,
        demo.outlet_address,
        demo.outlet_city,
        demo.outlet_state,
        demo.outlet_zip,
        dddmd.outlet_code,
        dddmd.tvcmid,
        dddmd.subcategory_code,
        dddmd.basket_name,
        dddmd.data_date,
        dddmd.date,
        dddmd.rollup_month,
        dddmd.quantity,
        dddmd.dollars,
        dddmd.rollup_week
 FROM datamart.ddd_md dddmd, datamart.dddmd_demographics demo, datamart.current_alignment ca
 WHERE ((demo.outlet_zip = ca.zip_code) AND (dddmd.outlet_code = demo.outlet_code) AND (ca.territory_number = ANY (ARRAY['TSATCZ48'::varchar(8), 'TSATNZ43'::varchar(8), 'TSATGZ45'::varchar(8), 'TSATGZ47'::varchar(8), 'TSATGZ50'::varchar(8), 'TSATNZ44'::varchar(8), 'TSATNZ49'::varchar(8), 'TSATCZ43'::varchar(8), 'TSATWZ49'::varchar(8), 'TSATNZ41'::varchar(8), 'TSATSZ42'::varchar(8), 'TSATSZ48'::varchar(8)])) AND (dddmd.basket_name ~~* '%CINQ%'::varchar(6)) AND (dddmd.rollup_month > '2019-12-31'::date))
 GROUP BY ca.sales_force_id,
          ca.territory_number,
          dddmd.onc_account_demo_id,
          dddmd.outlet_name,
          demo.outlet_address,
          demo.outlet_city,
          demo.outlet_state,
          demo.outlet_zip,
          dddmd.outlet_code,
          dddmd.tvcmid,
          dddmd.subcategory_code,
          dddmd.basket_name,
          dddmd.data_date,
          dddmd.date,
          dddmd.rollup_month,
          dddmd.quantity,
          dddmd.dollars,
          dddmd.rollup_week;

CREATE  VIEW outbound.zs_normalization_factor AS
 SELECT b.basket_id,
        b.name AS basket_name,
        b.basket_type,
        nf.divisor,
        nf.multiplier,
        nf.start_date,
        nf.end_date
 FROM product.normalization_factor nf, product.basket b
 WHERE ((nf.entity_id = b.basket_id) AND (nf.end_date > ((statement_timestamp())::timestamp + (-1)::float)));

CREATE  VIEW veeva.v_rep_roster AS
 SELECT rep_roster.Id AS ID,
        rep_roster.CreatedDate,
        rep_roster.CreatedById,
        rep_roster.LastModifiedDate,
        rep_roster.LastModifiedById,
        rep_roster.OwnerId,
        rep_roster.IsDeleted,
        rep_roster.Name,
        rep_roster.SystemModstamp,
        rep_roster.MayEdit,
        rep_roster.IsLocked,
        rep_roster.Territory_vod__c AS Territory,
        rep_roster.Address_line_1_vod__c AS Address_line_1,
        rep_roster.Address_line_2_vod__c AS Address_line_2,
        rep_roster.Address_line_3_tva__c AS Address_line_3,
        rep_roster.City_vod__c AS City,
        rep_roster.State_vod__c AS State,
        rep_roster.ZIP_vod__c AS ZIP,
        rep_roster.Computer_Asset_Tag__c AS Computer_Asset_Tag,
        rep_roster.Fax_Number__c AS Fax_Number,
        rep_roster.Home_Phone__c AS Home_Phone,
        rep_roster.Mobile_Number__c AS Mobile_Number,
        rep_roster.Organization_Id__c AS Organization_Id,
        rep_roster.Rep_Type_TVA__c AS Rep_Type,
        rep_roster.SampleFlag_TVA__c AS SampleFlag,
        rep_roster.Ship_Addr1_TVA__c AS Ship_Addr1,
        rep_roster.Ship_Addr2_TVA__c AS Ship_Addr2,
        rep_roster.Ship_Addr3_TVA__c AS Ship_Addr3,
        rep_roster.Ship_City_TVA__c AS Ship_City,
        rep_roster.Ship_State_TVA__C AS Ship_State,
        rep_roster.Ship_Zip_TVA__c AS Ship_Zip,
        rep_roster.Store_Addr1_TVA__c AS Store_Addr1,
        rep_roster.Store_Addr2_TVA__c AS Store_Addr2,
        rep_roster.Store_Addr3_TVA__c AS Store_Addr3,
        rep_roster.Store_City_TVA__c AS Store_City,
        rep_roster.Store_State_TVA__C AS Store_State,
        rep_roster.Store_Zip_TVA__c AS Store_Zip,
        rep_roster.Username_External_Id_vod__c AS Username_External_Id,
        rep_roster.VIN__c AS VIN,
        rep_roster.LastViewedDate,
        rep_roster.lastReferencedDate,
        rep_roster.record_id,
        rep_roster.file_id
 FROM veeva.rep_roster
 WHERE (rep_roster.file_id = ( SELECT max(rep_roster.file_id) AS MAX
 FROM veeva.rep_roster));

CREATE  VIEW outbound.saba_laba_mop_digihaler AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.payment_method,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_qty ELSE 0::numeric(18,0) END) AS trx_qty_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.payment_method,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count,
        rx.trx_quantity AS trx_qty
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT row_number() OVER (ORDER BY z.rollup_month DESC) AS month_bucket,
        z.rollup_month
 FROM ( SELECT prescriber_rx.rollup_month
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.market_name = ANY (ARRAY['SABA MARKET TOTAL'::varchar(17), 'LABA MARKET TOTAL'::varchar(17), 'ICS MARKET TOTAL'::varchar(16)])) AND (prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)))
 GROUP BY prescriber_rx.rollup_month) z) w ON ((rx.rollup_month = w.rollup_month))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = ANY (ARRAY['SABA MARKET TOTAL'::varchar(17), 'LABA MARKET TOTAL'::varchar(17), 'ICS MARKET TOTAL'::varchar(16)])) AND (rx.basket_name ~~* '%%DIGIHA%'::varchar(9)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.payment_method,
          rx_vertical.basket_name;

CREATE  VIEW outbound.austedo_fia_monthly AS
 SELECT fia.basket_id,
        fia.basket_name,
        fia.claim_id,
        fia.patient_id,
        fia.sequence_number,
        fia.product_id,
        fia.fill_date,
        fia.claim_type,
        fia.reject_code,
        fia.days_supply,
        fia.quantity,
        fia.refill_code,
        fia.payer_plan_id,
        fia.opc_ask,
        fia.sec_payer_plan_id,
        fia.buy_down,
        fia.opc_paid,
        fia.prescriber_id,
        fia.sob,
        fia.sub_product_id,
        fia.sub_opc,
        fia.initial_claim_id,
        fia.prev_product_id,
        fia.daw_code,
        fia.wrt_date,
        fia.claim_status,
        fia.copay_card_flg,
        fia.zip_code,
        fia.ecoup_flag,
        fia.ecoup_offset_amt,
        fia.standard_copay,
        fia.standard_copay_yn,
        fia.market_id,
        fia.flexible_fld_1_char,
        fia.flexible_fld_2_char,
        fia.flexible_fld_3_char,
        fia.flexible_fld_4_char,
        fia.file_id,
        fia.record_id,
        fia.cbsa_code,
        fia.cbsa_description,
        fia.state_code,
        fia.payer_name,
        fia.plan_name,
        fia.pbm_name,
        fia.pbm_id,
        fia.method_of_payment,
        fia.model_type,
        fia.product_group,
        fia.product_group_id,
        fia.product_name,
        fia.generic_name,
        fia.brand_generic_flag,
        fia.product_form,
        fia.product_strength,
        fia.package_size,
        fia.manufacturer,
        fia.cmf10,
        fia.usc_code,
        fia.fia_market_desc,
        fia.reject_reason,
        fia.reject_group,
        fia.mpd_year,
        fia.mpd_eligibility_class,
        fia.deductible_start_date,
        fia.copay_start_date,
        fia.gap_start_date,
        fia.catastrophic_start_date,
        fia.mpd_panel_patient,
        fia.PROVIDER_TYPE,
        fia.IQVIA_RXER_ID,
        fia.PRIMARY_SPECIALTY_CODE,
        fia.PRIMARY_SPECIALTY_DESC,
        fia.FIRST_NAME,
        fia.LAST_NAME,
        fia.ORG_NM,
        fia.ADDRESS,
        fia.CITY,
        fia.PVR_ZIP_CODE,
        fia.PVR_STATE_CODE,
        fia.PHONE_NUMBER
 FROM datamart.fia fia
 WHERE ((fia.fill_date >= '2020-01-01'::date) AND (fia.basket_id IN ( SELECT source_product.entity_id
 FROM product.source_product
 WHERE (source_product.source_file_code = 'A67.F12045'::varchar(10)))));

CREATE  VIEW outbound.zs_spec_pharm_shipment_monthly AS
 SELECT specialty_pharmacy_shipment.specialty_pharmacy_data_source,
        specialty_pharmacy_shipment.ims_id,
        specialty_pharmacy_shipment.tw_ship_to_address_id,
        specialty_pharmacy_shipment.tw_bill_to_address_id,
        specialty_pharmacy_shipment.source_customer_id,
        specialty_pharmacy_shipment.customer_name,
        specialty_pharmacy_shipment.physician_first_name,
        specialty_pharmacy_shipment.physician_last_name,
        specialty_pharmacy_shipment.ship_to_address_line_1,
        specialty_pharmacy_shipment.ship_to_address_line_2,
        specialty_pharmacy_shipment.ship_to_city,
        specialty_pharmacy_shipment.ship_to_state,
        specialty_pharmacy_shipment.ship_to_zip,
        specialty_pharmacy_shipment.source_transaction_id,
        specialty_pharmacy_shipment.invoice_date,
        specialty_pharmacy_shipment.ship_date,
        specialty_pharmacy_shipment.source_product_code,
        specialty_pharmacy_shipment.basket_id,
        specialty_pharmacy_shipment.quantity,
        specialty_pharmacy_shipment.invoice_unit_price,
        specialty_pharmacy_shipment.invoice_amount,
        specialty_pharmacy_shipment.invoice_discount,
        specialty_pharmacy_shipment.order_type,
        specialty_pharmacy_shipment.customer_type,
        specialty_pharmacy_shipment.source_parent_customer_id,
        specialty_pharmacy_shipment.parent_customer_name,
        specialty_pharmacy_shipment.lob_code_desc,
        specialty_pharmacy_shipment.order_type_desc,
        specialty_pharmacy_shipment.price_matrix_def,
        specialty_pharmacy_shipment.whse_code,
        specialty_pharmacy_shipment.order_no,
        specialty_pharmacy_shipment.package_size,
        specialty_pharmacy_shipment.tvcmid,
        specialty_pharmacy_shipment.trx_cnt,
        specialty_pharmacy_shipment.net_sales_amt,
        specialty_pharmacy_shipment.adj_invoice_unit_price,
        specialty_pharmacy_shipment.adj_invoice_amount,
        specialty_pharmacy_shipment.net_cost,
        specialty_pharmacy_shipment.payer_flag,
        specialty_pharmacy_shipment.optum_briova_flag AS briova_flag,
        specialty_pharmacy_shipment.physician_middle_name,
        specialty_pharmacy_shipment.rollup_flag,
        specialty_pharmacy_shipment.basket_type,
        specialty_pharmacy_shipment.unnormalized_trx_count,
        specialty_pharmacy_shipment.basket_name,
        specialty_pharmacy_shipment.comp_month,
        specialty_pharmacy_shipment.days_supplied,
        specialty_pharmacy_shipment.SPP_Physician_ID,
        specialty_pharmacy_shipment.Primary_Payer_BIN,
        specialty_pharmacy_shipment.Primary_Payer_PCN,
        specialty_pharmacy_shipment.Primary_Group_Num,
        specialty_pharmacy_shipment.Primary_Payer_Name,
        specialty_pharmacy_shipment.Primary_Payer_Type,
        specialty_pharmacy_shipment.Primary_Copay_Amount,
        specialty_pharmacy_shipment.NPI,
        specialty_pharmacy_shipment.state_license_number
 FROM datamart.specialty_pharmacy_shipment
 WHERE ((specialty_pharmacy_shipment.ship_date >= '2018-02-01'::date) AND (specialty_pharmacy_shipment.basket_type = 'product'::varchar(7)) AND (specialty_pharmacy_shipment.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(10), 'RelianceRx'::varchar(10)])))
 GROUP BY specialty_pharmacy_shipment.specialty_pharmacy_data_source,
          specialty_pharmacy_shipment.ims_id,
          specialty_pharmacy_shipment.tw_ship_to_address_id,
          specialty_pharmacy_shipment.tw_bill_to_address_id,
          specialty_pharmacy_shipment.source_customer_id,
          specialty_pharmacy_shipment.customer_name,
          specialty_pharmacy_shipment.physician_first_name,
          specialty_pharmacy_shipment.physician_last_name,
          specialty_pharmacy_shipment.ship_to_address_line_1,
          specialty_pharmacy_shipment.ship_to_address_line_2,
          specialty_pharmacy_shipment.ship_to_city,
          specialty_pharmacy_shipment.ship_to_state,
          specialty_pharmacy_shipment.ship_to_zip,
          specialty_pharmacy_shipment.source_transaction_id,
          specialty_pharmacy_shipment.invoice_date,
          specialty_pharmacy_shipment.ship_date,
          specialty_pharmacy_shipment.source_product_code,
          specialty_pharmacy_shipment.basket_id,
          specialty_pharmacy_shipment.quantity,
          specialty_pharmacy_shipment.invoice_unit_price,
          specialty_pharmacy_shipment.invoice_amount,
          specialty_pharmacy_shipment.invoice_discount,
          specialty_pharmacy_shipment.order_type,
          specialty_pharmacy_shipment.customer_type,
          specialty_pharmacy_shipment.source_parent_customer_id,
          specialty_pharmacy_shipment.parent_customer_name,
          specialty_pharmacy_shipment.lob_code_desc,
          specialty_pharmacy_shipment.order_type_desc,
          specialty_pharmacy_shipment.price_matrix_def,
          specialty_pharmacy_shipment.whse_code,
          specialty_pharmacy_shipment.order_no,
          specialty_pharmacy_shipment.package_size,
          specialty_pharmacy_shipment.tvcmid,
          specialty_pharmacy_shipment.trx_cnt,
          specialty_pharmacy_shipment.net_sales_amt,
          specialty_pharmacy_shipment.adj_invoice_unit_price,
          specialty_pharmacy_shipment.adj_invoice_amount,
          specialty_pharmacy_shipment.net_cost,
          specialty_pharmacy_shipment.payer_flag,
          specialty_pharmacy_shipment.optum_briova_flag,
          specialty_pharmacy_shipment.physician_middle_name,
          specialty_pharmacy_shipment.rollup_flag,
          specialty_pharmacy_shipment.basket_type,
          specialty_pharmacy_shipment.unnormalized_trx_count,
          specialty_pharmacy_shipment.basket_name,
          specialty_pharmacy_shipment.comp_month,
          specialty_pharmacy_shipment.days_supplied,
          specialty_pharmacy_shipment.SPP_Physician_ID,
          specialty_pharmacy_shipment.Primary_Payer_BIN,
          specialty_pharmacy_shipment.Primary_Payer_PCN,
          specialty_pharmacy_shipment.Primary_Group_Num,
          specialty_pharmacy_shipment.Primary_Payer_Name,
          specialty_pharmacy_shipment.Primary_Payer_Type,
          specialty_pharmacy_shipment.Primary_Copay_Amount,
          specialty_pharmacy_shipment.NPI,
          specialty_pharmacy_shipment.state_license_number;

CREATE  VIEW outbound.zs_tr_ims_zip_xref AS
 SELECT CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END AS ims_id,
        prescriber_combined_demographics.ptr_zip AS zip
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))
 GROUP BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip
 ORDER BY CASE WHEN (length(prescriber_combined_demographics.ims_id) = 8) THEN ('XX'::varchar(2) || substr(prescriber_combined_demographics.ims_id, ((length(prescriber_combined_demographics.ims_id) - 5) + 1), 5)) ELSE prescriber_combined_demographics.ims_id END,
          prescriber_combined_demographics.ptr_zip;

CREATE  VIEW outbound.zs_xpo_xpopt_AM_MD_ICS_LABA_weekly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.rollup_week >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name <> ALL (ARRAY['ALLERGY MARKET TOTAL'::varchar(20), 'SABA MARKET TOTAL'::varchar(17)])))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.sales_category,
          prescriber_rx.market_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.model,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.indication,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.rollup_flag,
          prescriber_rx.rollup_week,
          prescriber_rx.rollup_month,
          prescriber_rx.report_frequency,
          prescriber_rx.plan_name,
          prescriber_rx.payer_name,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count;

CREATE  VIEW outbound.zs_xpo_xpopt_SABA_weekly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (prescriber_rx.rollup_week >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name = 'SABA MARKET TOTAL'::varchar(17)))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.sales_category,
          prescriber_rx.market_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.model,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.indication,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.rollup_flag,
          prescriber_rx.rollup_week,
          prescriber_rx.rollup_month,
          prescriber_rx.report_frequency,
          prescriber_rx.plan_name,
          prescriber_rx.payer_name,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count;

CREATE  VIEW veeva.v_user_territory AS
 SELECT userterritory2association.Id AS id,
        userterritory2association.UserId AS Userid,
        userterritory2association.Territory2Id AS territory2Id,
        userterritory2association.IsActive AS isActive,
        userterritory2association.RoleInTerritory2 AS roleInTerritory2,
        userterritory2association.LastModifiedDate AS lastModifiedDate,
        userterritory2association.LastModifiedById AS lastModifiedById,
        userterritory2association.SystemModstamp AS systemModstamp,
        userterritory2association.record_id,
        userterritory2association.file_id
 FROM veeva.userterritory2association
 WHERE (userterritory2association.file_id = ( SELECT max(userterritory2association.file_id) AS MAX
 FROM veeva.userterritory2association));

CREATE  VIEW veeva.v_territory AS
 SELECT territory2.Id AS territory2Id,
        territory2.Name AS name,
        territory2.Territory2TypeId AS territory2TypeId,
        territory2.Territory2ModelId AS territory2ModelId,
        territory2.ParentTerritory2Id AS parentTerritoryId,
        territory2.Description,
        territory2.AccountAccessLevel AS accountAccessLevel,
        territory2.OpportunityAccessLevel AS opportunityAccessLevel,
        territory2.CaseAccessLevel AS caseAccessLevel,
        territory2.ContactAccessLevel AS contactAccessLevel,
        territory2.LastModifiedDate AS lastModifiedDate,
        territory2.LastModifiedById AS lastModifiedById,
        territory2.SystemModstamp AS systemModstamp,
        territory2.DeveloperName AS developerName,
        territory2.ParentTerritory1Id__c AS parentTerritory1Id__c,
        territory2.Territory1Id__c AS Id,
        territory2.record_id,
        territory2.file_id
 FROM veeva.territory2
 WHERE (territory2.file_id = ( SELECT max(territory2.file_id) AS MAX
 FROM veeva.territory2));

CREATE  VIEW outbound.zs_revo_demographics_monthly AS
 SELECT d.sales_force_id,
        d.ims_id,
        d.npi,
        d.tvcmid,
        d.veeva_account_id,
        d.specialty,
        d.secondary_specialty,
        d.first_name,
        d.middle_name,
        d.last_name,
        d.ptr_address_1,
        d.ptr_address_2,
        d.ptr_address_3,
        d.ptr_city,
        d.ptr_state,
        d.ptr_zip,
        d.ptr_phone,
        d.ptr_territory_num,
        d.dea_num,
        d.pdrp_flag,
        d.pdrp_date,
        d.np_pa_flag,
        d.no_spend,
        d.ama_no_contact_flag,
        d.email,
        d.degree,
        CASE WHEN (dnp.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS dnp_flag,
        x.hce_status_desc AS cm_status_flag,
        xref.id_num AS ME_Num
 FROM (((datamart.prescriber_combined_demographics d LEFT  JOIN ( SELECT customer_level_flags.tvcmid
 FROM datamart.customer_level_flags
 WHERE ((customer_level_flags.flag_type = ANY (ARRAY['OIG'::varchar(6), 'FDA'::varchar(6), 'DEA'::varchar(6), 'PERPRM'::varchar(6)])) AND (customer_level_flags.flag_value = 'Y'::varchar(1)))
 GROUP BY customer_level_flags.tvcmid) dnp ON ((d.tvcmid = dnp.tvcmid))) LEFT  JOIN ( SELECT customer_hcp_demographics.tvcmid,
        customer_hcp_demographics.hce_status_desc
 FROM datamart.customer_hcp_demographics) x ON ((d.tvcmid = x.tvcmid))) LEFT  JOIN ( SELECT tvcmid_xref.tvcmid,
        tvcmid_xref.id_num
 FROM datamart.tvcmid_xref
 WHERE (tvcmid_xref.id_type = 'AMA'::varchar(3))
 GROUP BY tvcmid_xref.tvcmid,
          tvcmid_xref.id_num) xref ON ((d.tvcmid = xref.tvcmid)))
 WHERE (d.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'TO'::varchar(2), 'MA'::varchar(2)]))
 GROUP BY d.sales_force_id,
          d.ims_id,
          d.npi,
          d.tvcmid,
          d.veeva_account_id,
          d.specialty,
          d.secondary_specialty,
          d.first_name,
          d.middle_name,
          d.last_name,
          d.ptr_address_1,
          d.ptr_address_2,
          d.ptr_address_3,
          d.ptr_city,
          d.ptr_state,
          d.ptr_zip,
          d.ptr_phone,
          d.ptr_territory_num,
          d.dea_num,
          d.pdrp_flag,
          d.pdrp_date,
          d.np_pa_flag,
          d.no_spend,
          d.ama_no_contact_flag,
          d.email,
          d.degree,
          CASE WHEN (dnp.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END,
          x.hce_status_desc,
          xref.id_num;

CREATE  VIEW outbound.zs_revo_call_key_messages AS
 SELECT call_key_messages.veeva_account_id,
        call_key_messages.tvcmid,
        call_key_messages.call_id,
        call_key_messages.call_record_type,
        call_key_messages.product,
        call_key_messages.key_message,
        call_key_messages.call_date,
        call_key_messages.duration,
        call_key_messages.display_order,
        call_key_messages.call_status,
        call_key_messages.territory,
        call_key_messages.call_type,
        call_key_messages.hcp_name
 FROM reporting.call_key_messages
 WHERE ((call_key_messages.product <> ALL (ARRAY['Blink Health  AJOVY'::varchar(24), 'Blink Health  AUSTEDO'::varchar(24), 'Unassociated'::varchar(24)])) AND (call_key_messages.call_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))));

CREATE  VIEW sandbox.call AS
 SELECT a.id,
        a.ownerid,
        a.isdeleted,
        a.name,
        a.recordtypeid,
        a.createddate,
        a.createdbyid,
        a.lastmodifieddate,
        a.lastmodifiedbyid,
        a.systemmodstamp,
        a.lastactivitydate,
        a.mayedit,
        a.islocked,
        a.lastvieweddate,
        a.lastreferenceddate,
        a.sample_card_vod__c,
        a.add_detail_vod__c,
        a.property_vod__c,
        a.account_vod__c,
        a.zvod_product_discussion_vod__c,
        a.status_vod__c,
        a.parent_address_vod__c,
        a.account_plan_vod__c,
        a.zvod_savenew_vod__c,
        a.next_call_notes_vod__c,
        a.mobile_id_vod__c,
        a.zvod_account_credentials_vod_c,
        a.zvod_account_preferred_name_vo,
        a.zvod_account_sample_status_vod,
        a.zvod_attendees_vod__c,
        a.zvod_key_messages_vod__c,
        a.zvod_detailing_vod__c,
        a.zvod_expenses_vod__c,
        a.zvod_followup_vod__c,
        a.zvod_samples_vod__c,
        a.zvod_save_vod__c,
        a.zvod_submit_vod__c,
        a.zvod_delete_vod__c,
        a.activity_type__c,
        a.significant_event__c,
        a.location_vod__c,
        a.subject_vod__c,
        a.call_datetime_vod__c,
        a.disbursed_to_vod__c,
        a.request_receipt_vod__c,
        a.signature_date_vod__c,
        a.territory_vod__c,
        a.submitted_by_mobile_vod__c,
        a.call_type_vod__c,
        a.add_key_message_vod__c,
        a.address_vod__c,
        a.attendees_vod__c,
        a.attendee_type_vod__c,
        a.call_date_vod__c,
        a.detailed_products_vod__c,
        a.no_disbursement_vod__c,
        a.parent_call_vod__c,
        a.user_vod__c,
        a.contact_vod__c,
        a.zvod_entity_vod__c,
        a.medical_event_vod__c,
        a.mobile_created_datetime_vod__c,
        a.mobile_last_modified_datetime,
        a.license_vod__c,
        a.is_parent_call_vod__c,
        a.entity_display_name_vod__c,
        a.last_device_vod__c,
        a.ship_address_line_1_vod__c,
        a.ship_address_line_2_vod__c,
        a.ship_city_vod__c,
        a.ship_country_vod__c,
        a.ship_license_expiration_date,
        a.ship_license_status_vod__c,
        a.ship_license_vod__c,
        a.ship_state_vod__c,
        a.ship_to_address_vod__c,
        a.ship_zip_vod__c,
        a.ship_to_address_text_vod__c,
        a.clm_vod__c,
        a.zvod_clmdetails_vod__c,
        a.is_sampled_call_vod__c,
        a.zvod_surveys_vod__c,
        a.presentations_vod__c,
        a.entity_reference_id_vod__c,
        a.error_reference_call_vod__c,
        a.duration_vod__c,
        a.color_vod__c,
        a.allowed_products_vod__c,
        a.zvod_attachments_vod__c,
        a.sample_card_reason_vod__c,
        a.assmca_vod__c,
        a.address_line_1_vod__c,
        a.address_line_2_vod__c,
        a.city_vod__c,
        a.dea_address_line_1_vod__c,
        a.dea_address_line_2_vod__c,
        a.dea_address_vod__c,
        a.dea_city_vod__c,
        a.dea_expiration_date_vod__c,
        a.dea_state_vod__c,
        a.dea_zip_4_vod__c,
        a.dea_zip_vod__c,
        a.dea_vod__c,
        a.ship_zip_4_vod__c,
        a.state_vod__c,
        a.zip_4_vod__c,
        a.zip_vod__c,
        a.sample_send_card_vod__c,
        a.zvod_address_vod_c_dea_status_,
        a.signature_page_image_vod__c,
        a.credentials_vod__c,
        a.salutation_vod__c,
        a.zvod_account_call_reminder_vod,
        a.sales_org_tva__c,
        a.zvod_business_account_vod__c,
        a.product_priority_1_vod__c,
        a.product_priority_2_vod__c,
        a.product_priority_3_vod__c,
        a.product_priority_4_vod__c,
        a.product_priority_5_vod__c,
        a.zvod_more_actions_vod__c,
        a.zvod_call_conflict_status,
        a.signature_timestamp_vod__c,
        a.expense_amount_vod__c,
        a.total_expense_attendees_count,
        a.attendee_list_vod__c,
        a.expense_post_status_vod__c,
        a.attendee_post_status_vod__c,
        a.expense_system_external_id,
        a.incurred_expense_vod__c,
        a.assigner_vod__c,
        a.assignment_datetime_vod__c,
        a.zvod_call_objective_vod__c,
        a.signature_location_longitude,
        a.signature_location_latitude,
        a.location_services_status,
        a.created_by_timezone_tva__c,
        a.license_expiration_date_vod__c,
        a.license_status_vod__c,
        a.ship_assmca_vod__c,
        a.ship_dea_expiration_date,
        a.ship_dea_vod__c,
        a.call_method_tva__c,
        a.bendeka_indication_tva__c,
        a.file_id,
        a.record_id,
        a.austedo_indication_tva__c,
        a.call_duration_tva__c,
        a.how_executed_tva__c,
        a.Remote_Meeting_vod__c,
        a.Veeva_Remote_Meeting_Id_vod__c,
        a.Cobrowse_URL_Participant_vod__c,
        a.Signature_Captured_Remotely_vod__c,
        a.Remote_Signature_Attendee_Name_vod__c,
        a.rowrank
 FROM ( SELECT c.id,
        c.ownerid,
        c.isdeleted,
        c.name,
        c.recordtypeid,
        c.createddate,
        c.createdbyid,
        c.lastmodifieddate,
        c.lastmodifiedbyid,
        c.systemmodstamp,
        c.lastactivitydate,
        c.mayedit,
        c.islocked,
        c.lastvieweddate,
        c.lastreferenceddate,
        c.sample_card_vod__c,
        c.add_detail_vod__c,
        c.property_vod__c,
        c.account_vod__c,
        c.zvod_product_discussion_vod__c,
        c.status_vod__c,
        c.parent_address_vod__c,
        c.account_plan_vod__c,
        c.zvod_savenew_vod__c,
        c.next_call_notes_vod__c,
        c.mobile_id_vod__c,
        c.zvod_account_credentials_vod_c,
        c.zvod_account_preferred_name_vo,
        c.zvod_account_sample_status_vod,
        c.zvod_attendees_vod__c,
        c.zvod_key_messages_vod__c,
        c.zvod_detailing_vod__c,
        c.zvod_expenses_vod__c,
        c.zvod_followup_vod__c,
        c.zvod_samples_vod__c,
        c.zvod_save_vod__c,
        c.zvod_submit_vod__c,
        c.zvod_delete_vod__c,
        c.activity_type__c,
        c.significant_event__c,
        c.location_vod__c,
        c.subject_vod__c,
        c.call_datetime_vod__c,
        c.disbursed_to_vod__c,
        c.request_receipt_vod__c,
        c.signature_date_vod__c,
        c.territory_vod__c,
        c.submitted_by_mobile_vod__c,
        c.call_type_vod__c,
        c.add_key_message_vod__c,
        c.address_vod__c,
        c.attendees_vod__c,
        c.attendee_type_vod__c,
        c.call_date_vod__c,
        c.detailed_products_vod__c,
        c.no_disbursement_vod__c,
        c.parent_call_vod__c,
        c.user_vod__c,
        c.contact_vod__c,
        c.zvod_entity_vod__c,
        c.medical_event_vod__c,
        c.mobile_created_datetime_vod__c,
        c.mobile_last_modified_datetime,
        c.license_vod__c,
        c.is_parent_call_vod__c,
        c.entity_display_name_vod__c,
        c.last_device_vod__c,
        c.ship_address_line_1_vod__c,
        c.ship_address_line_2_vod__c,
        c.ship_city_vod__c,
        c.ship_country_vod__c,
        c.ship_license_expiration_date,
        c.ship_license_status_vod__c,
        c.ship_license_vod__c,
        c.ship_state_vod__c,
        c.ship_to_address_vod__c,
        c.ship_zip_vod__c,
        c.ship_to_address_text_vod__c,
        c.clm_vod__c,
        c.zvod_clmdetails_vod__c,
        c.is_sampled_call_vod__c,
        c.zvod_surveys_vod__c,
        c.presentations_vod__c,
        c.entity_reference_id_vod__c,
        c.error_reference_call_vod__c,
        c.duration_vod__c,
        c.color_vod__c,
        c.allowed_products_vod__c,
        c.zvod_attachments_vod__c,
        c.sample_card_reason_vod__c,
        c.assmca_vod__c,
        c.address_line_1_vod__c,
        c.address_line_2_vod__c,
        c.city_vod__c,
        c.dea_address_line_1_vod__c,
        c.dea_address_line_2_vod__c,
        c.dea_address_vod__c,
        c.dea_city_vod__c,
        c.dea_expiration_date_vod__c,
        c.dea_state_vod__c,
        c.dea_zip_4_vod__c,
        c.dea_zip_vod__c,
        c.dea_vod__c,
        c.ship_zip_4_vod__c,
        c.state_vod__c,
        c.zip_4_vod__c,
        c.zip_vod__c,
        c.sample_send_card_vod__c,
        c.zvod_address_vod_c_dea_status_,
        c.signature_page_image_vod__c,
        c.credentials_vod__c,
        c.salutation_vod__c,
        c.zvod_account_call_reminder_vod,
        c.sales_org_tva__c,
        c.zvod_business_account_vod__c,
        c.product_priority_1_vod__c,
        c.product_priority_2_vod__c,
        c.product_priority_3_vod__c,
        c.product_priority_4_vod__c,
        c.product_priority_5_vod__c,
        c.zvod_more_actions_vod__c,
        c.zvod_call_conflict_status,
        c.signature_timestamp_vod__c,
        c.expense_amount_vod__c,
        c.total_expense_attendees_count,
        c.attendee_list_vod__c,
        c.expense_post_status_vod__c,
        c.attendee_post_status_vod__c,
        c.expense_system_external_id,
        c.incurred_expense_vod__c,
        c.assigner_vod__c,
        c.assignment_datetime_vod__c,
        c.zvod_call_objective_vod__c,
        c.signature_location_longitude,
        c.signature_location_latitude,
        c.location_services_status,
        c.created_by_timezone_tva__c,
        c.license_expiration_date_vod__c,
        c.license_status_vod__c,
        c.ship_assmca_vod__c,
        c.ship_dea_expiration_date,
        c.ship_dea_vod__c,
        c.call_method_tva__c,
        c.bendeka_indication_tva__c,
        c.file_id,
        c.record_id,
        c.austedo_indication_tva__c,
        c.call_duration_tva__c,
        c.how_executed_tva__c,
        c.Remote_Meeting_vod__c,
        c.Veeva_Remote_Meeting_Id_vod__c,
        c.Cobrowse_URL_Participant_vod__c,
        c.Signature_Captured_Remotely_vod__c,
        c.Remote_Signature_Attendee_Name_vod__c,
        rank() OVER (PARTITION BY c.id ORDER BY c.file_id DESC) AS rowrank
 FROM veeva.call c
 WHERE (c.call_date_vod__c >= add_months((statement_timestamp())::timestamp, (-24)))) a
 WHERE (a.rowrank = 1);

CREATE  VIEW outbound.zs_call_details AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position,
        c.call_recordtype,
        c.how_executed,
        c.ims_outlet_id,
        c.first_name,
        c.last_name,
        c.rep_first_name,
        c.rep_last_name,
        c.area_number,
        c.region_number,
        c.call_duration,
        c.call_timezone,
        c.remote_meeting_id,
        c.call_datetime,
        cd.indication
 FROM ((datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id))) JOIN reference.zs_revo_products zrp ON (((cd.basket_id = zrp.basket_id) AND (zrp.entity = 'call activity'::varchar(13)))))
 WHERE ((c.call_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'TO'::varchar(2), 'MA'::varchar(2)])));

CREATE  VIEW outbound.blink_call_details AS
 SELECT c.sales_force_id,
        c.call_id,
        c.veeva_account_id,
        c.ims_id,
        d.npi,
        c.customer_type,
        c.call_type,
        c.rep_id,
        c.territory_number,
        c.zip_on_call,
        c.call_date,
        c.submit_date,
        c.attendees,
        c.attendee_type,
        c.tvcmid,
        cd.product,
        cd.basket_id,
        cd.basket_name,
        cd.detail_position,
        c.call_recordtype,
        c.how_executed,
        c.ims_outlet_id,
        c.first_name,
        c.last_name,
        c.rep_first_name,
        c.rep_last_name,
        c.area_number,
        c.region_number,
        c.call_duration,
        c.call_timezone,
        c.remote_meeting_id
 FROM ((datamart.sfa_call c JOIN datamart.sfa_call_detail cd ON ((c.call_id = cd.call_id))) LEFT  JOIN datamart.customer_hcp_demographics d ON ((d.tvcmid = c.tvcmid)))
 WHERE ((c.call_date >= '2021-02-01'::date) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'TO'::varchar(2), 'MA'::varchar(2)])) AND (cd.product ~~* 'Blink%'::varchar(6)));

CREATE  VIEW outbound.zs_xpo_xpopt_MD_ICS_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = ANY (ARRAY['ICS MARKET TOTAL'::varchar(24), 'MOVEMENT DISORDER MARKET'::varchar(24)])))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.sales_category,
          prescriber_rx.market_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.model,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.indication,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.rollup_flag,
          prescriber_rx.rollup_week,
          prescriber_rx.rollup_month,
          prescriber_rx.report_frequency,
          prescriber_rx.plan_name,
          prescriber_rx.payer_name,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count;

CREATE  VIEW outbound.zs_sample_request AS
 SELECT sfa_sample.sample_id,
        sfa_sample.call_id,
        sfa_sample.veeva_account_id,
        sfa_sample.ims_id,
        sfa_sample.call_date,
        sfa_sample.sales_force_id,
        sfa_sample.territory_number,
        sfa_sample.call_type,
        sfa_sample.attendee_type,
        sfa_sample.customer_type,
        sfa_sample.sample_type,
        sfa_sample.product_name,
        sfa_sample.sample_name,
        sfa_sample.sample_ndc,
        sfa_sample.basket_id,
        sfa_sample.basket_name,
        sfa_sample.qty,
        sfa_sample.zip_on_call,
        sfa_sample.employee_number,
        sfa_sample.tvcmid,
        sfa_sample.how_executed
 FROM datamart.sfa_sample
 WHERE ((sfa_sample.sample_type = 'REQUEST'::varchar(7)) AND (sfa_sample.basket_name <> 'QNASL'::varchar(5)) AND (sfa_sample.call_date >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies AS
 SELECT btrim(ftf_formularies.health_plan_id) AS health_plan_id,
        btrim(ftf_formularies.drug_id) AS drug_id,
        btrim(ftf_formularies.tier_code) AS tier_code,
        btrim(ftf_formularies.restrictions) AS restrictions,
        btrim(ftf_formularies.reason_code) AS reason_code,
        btrim(ftf_formularies.reason_code_description) AS btrim,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans AS
 SELECT btrim(ftf_health_plans.formularyf_id) AS formularyf_id,
        btrim(ftf_health_plans.provider_id) AS provider_id,
        btrim(ftf_health_plans.provider) AS provider,
        btrim(ftf_health_plans.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plans.health_plan) AS health_plan,
        btrim(ftf_health_plans.parent_id) AS parent_id,
        btrim(ftf_health_plans.parent) AS parent,
        ftf_health_plans.national_lives_count,
        btrim(ftf_health_plans.plan_type_name) AS plan_type_name,
        ftf_health_plans.preferred_brand_tier,
        ftf_health_plans.file_id,
        ftf_health_plans.record_id
 FROM cleansed.ftf_health_plans
 WHERE (ftf_health_plans.file_id IN ( SELECT max(ftf_health_plans.file_id) AS max
 FROM cleansed.ftf_health_plans));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography AS
 SELECT btrim(ftf_health_plan_geography.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plan_geography.operating_state) AS operating_state,
        ftf_health_plan_geography.lives_coverage,
        ftf_health_plan_geography.file_id,
        ftf_health_plan_geography.record_id
 FROM cleansed.ftf_health_plan_geography
 WHERE (ftf_health_plan_geography.file_id IN ( SELECT max(ftf_health_plan_geography.file_id) AS max
 FROM cleansed.ftf_health_plan_geography));

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms AS
 SELECT btrim(ftf_pbms.health_plan_id) AS health_plan_id,
        btrim(ftf_pbms.pbm_id) AS pbm_id,
        btrim(ftf_pbms.pbm) AS pbm,
        btrim(ftf_pbms.pbm_function_id) AS pbm_function_id,
        btrim(ftf_pbms.pbm_function) AS pbm_function,
        ftf_pbms.file_id,
        ftf_pbms.record_id
 FROM cleansed.ftf_pbms
 WHERE (ftf_pbms.file_id IN ( SELECT max(ftf_pbms.file_id) AS max
 FROM cleansed.ftf_pbms));

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions AS
 SELECT btrim(ftf_restrictions_v2.health_plan_id) AS health_plan_id,
        btrim(ftf_restrictions_v2.drug_id) AS drug_id,
        btrim(ftf_restrictions_v2.restriction_code) AS restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        btrim(ftf_restrictions_v2.restriction_detail_text) AS restriction_detail_text,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_1) AS restriction_addtnl_information_1,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_2) AS restriction_addtnl_information_2,
        btrim(ftf_restrictions_v2.step_count) AS step_count,
        btrim(ftf_restrictions_v2.pa_form) AS pa_form,
        btrim(ftf_restrictions_v2.indication) AS indication,
        btrim(ftf_restrictions_v2.grouped_restriction_level) AS grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 WHERE (ftf_restrictions_v2.file_id IN ( SELECT max(ftf_restrictions_v2.file_id) AS max
 FROM cleansed.ftf_restrictions_v2));

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref AS
 SELECT btrim(ims_plan_xref.payer_num) AS payer_num,
        btrim(ims_plan_xref.payer_name) AS payer_name,
        btrim(ims_plan_xref.plan_num) AS plan_num,
        btrim(ims_plan_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_plan_xref.plan_name) AS plan_name,
        btrim(ims_plan_xref.model) AS model,
        btrim(ims_plan_xref.city) AS city,
        btrim(ims_plan_xref.hq_state) AS hq_state,
        btrim(ims_plan_xref.operating_state) AS operating_state,
        ims_plan_xref.months_with_data,
        ims_plan_xref.file_id,
        ims_plan_xref.record_id
 FROM cleansed.ims_plan_xref
 WHERE (ims_plan_xref.file_id IN ( SELECT max(ims_plan_xref.file_id) AS max
 FROM cleansed.ims_plan_xref));

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref AS
 SELECT btrim(ims_pbm_xref.pbm_name) AS pbm_name,
        btrim(ims_pbm_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_pbm_xref.xref_to_payer_plan_num) AS xref_to_payer_plan_num,
        btrim(ims_pbm_xref.ipd_id) AS ipd_id,
        btrim(ims_pbm_xref.ipd_type) AS ipd_type,
        btrim(ims_pbm_xref.plan_name) AS plan_name,
        ims_pbm_xref.pbm_num,
        ims_pbm_xref.ims_processor_num,
        ims_pbm_xref.file_id,
        ims_pbm_xref.record_id
 FROM cleansed.ims_pbm_xref
 WHERE (ims_pbm_xref.file_id IN ( SELECT max(ims_pbm_xref.file_id) AS max
 FROM cleansed.ims_pbm_xref));

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge AS
 SELECT btrim(ftf_ims_bridge.payer_name) AS payer_name,
        btrim(ftf_ims_bridge.code) AS code,
        btrim(ftf_ims_bridge.name) AS name,
        btrim(ftf_ims_bridge.state) AS state,
        btrim(ftf_ims_bridge.comments) AS comments,
        ftf_ims_bridge.plan_id,
        btrim(ftf_ims_bridge.plan_name) AS plan_name,
        btrim(ftf_ims_bridge.provider_name) AS provider_name,
        btrim(ftf_ims_bridge.plan_type_name) AS plan_type_name,
        ftf_ims_bridge.file_id,
        ftf_ims_bridge.record_id
 FROM cleansed.ftf_ims_bridge
 WHERE (ftf_ims_bridge.file_id IN ( SELECT max(ftf_ims_bridge.file_id) AS max
 FROM cleansed.ftf_ims_bridge));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies AS
 SELECT btrim(ftf_formularies.health_plan_id) AS health_plan_id,
        btrim(ftf_formularies.drug_id) AS drug_id,
        btrim(ftf_formularies.tier_code) AS tier_code,
        btrim(ftf_formularies.restrictions) AS restrictions,
        btrim(ftf_formularies.reason_code) AS reason_code,
        btrim(ftf_formularies.reason_code_description) AS btrim,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_formularies.file_id
 FROM cleansed.ftf_formularies
 GROUP BY ftf_formularies.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plans AS
 SELECT btrim(ftf_health_plans.formularyf_id) AS formularyf_id,
        btrim(ftf_health_plans.provider_id) AS provider_id,
        btrim(ftf_health_plans.provider) AS provider,
        btrim(ftf_health_plans.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plans.health_plan) AS health_plan,
        btrim(ftf_health_plans.parent_id) AS parent_id,
        btrim(ftf_health_plans.parent) AS parent,
        ftf_health_plans.national_lives_count,
        btrim(ftf_health_plans.plan_type_name) AS plan_type_name,
        ftf_health_plans.preferred_brand_tier,
        ftf_health_plans.file_id,
        ftf_health_plans.record_id
 FROM cleansed.ftf_health_plans
 WHERE (ftf_health_plans.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_health_plans.file_id
 FROM cleansed.ftf_health_plans
 GROUP BY ftf_health_plans.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plan_geography AS
 SELECT btrim(ftf_health_plan_geography.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plan_geography.operating_state) AS operating_state,
        ftf_health_plan_geography.lives_coverage,
        ftf_health_plan_geography.file_id,
        ftf_health_plan_geography.record_id
 FROM cleansed.ftf_health_plan_geography
 WHERE (ftf_health_plan_geography.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_health_plan_geography.file_id
 FROM cleansed.ftf_health_plan_geography
 GROUP BY ftf_health_plan_geography.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_pbms AS
 SELECT btrim(ftf_pbms.health_plan_id) AS health_plan_id,
        btrim(ftf_pbms.pbm_id) AS pbm_id,
        btrim(ftf_pbms.pbm) AS pbm,
        btrim(ftf_pbms.pbm_function_id) AS pbm_function_id,
        btrim(ftf_pbms.pbm_function) AS pbm_function,
        ftf_pbms.file_id,
        ftf_pbms.record_id
 FROM cleansed.ftf_pbms
 WHERE (ftf_pbms.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_pbms.file_id
 FROM cleansed.ftf_pbms
 GROUP BY ftf_pbms.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions AS
 SELECT btrim(ftf_restrictions_v2.health_plan_id) AS health_plan_id,
        btrim(ftf_restrictions_v2.drug_id) AS drug_id,
        btrim(ftf_restrictions_v2.restriction_code) AS restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        btrim(ftf_restrictions_v2.restriction_detail_text) AS restriction_detail_text,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_1) AS restriction_addtnl_information_1,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_2) AS restriction_addtnl_information_2,
        btrim(ftf_restrictions_v2.step_count) AS step_count,
        btrim(ftf_restrictions_v2.pa_form) AS pa_form,
        btrim(ftf_restrictions_v2.indication) AS indication,
        btrim(ftf_restrictions_v2.grouped_restriction_level) AS grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 WHERE (ftf_restrictions_v2.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 GROUP BY ftf_restrictions_v2.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_plan_xref AS
 SELECT btrim(ims_plan_xref.payer_num) AS payer_num,
        btrim(ims_plan_xref.payer_name) AS payer_name,
        btrim(ims_plan_xref.plan_num) AS plan_num,
        btrim(ims_plan_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_plan_xref.plan_name) AS plan_name,
        btrim(ims_plan_xref.model) AS model,
        btrim(ims_plan_xref.city) AS city,
        btrim(ims_plan_xref.hq_state) AS hq_state,
        btrim(ims_plan_xref.operating_state) AS operating_state,
        ims_plan_xref.months_with_data,
        ims_plan_xref.file_id,
        ims_plan_xref.record_id
 FROM cleansed.ims_plan_xref
 WHERE (ims_plan_xref.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ims_plan_xref.file_id
 FROM cleansed.ims_plan_xref
 GROUP BY ims_plan_xref.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_pbm_xref AS
 SELECT btrim(ims_pbm_xref.pbm_name) AS pbm_name,
        btrim(ims_pbm_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_pbm_xref.xref_to_payer_plan_num) AS xref_to_payer_plan_num,
        btrim(ims_pbm_xref.ipd_id) AS ipd_id,
        btrim(ims_pbm_xref.ipd_type) AS ipd_type,
        btrim(ims_pbm_xref.plan_name) AS plan_name,
        ims_pbm_xref.pbm_num,
        ims_pbm_xref.ims_processor_num,
        ims_pbm_xref.file_id,
        ims_pbm_xref.record_id
 FROM cleansed.ims_pbm_xref
 WHERE (ims_pbm_xref.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ims_pbm_xref.file_id
 FROM cleansed.ims_pbm_xref
 GROUP BY ims_pbm_xref.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_ims_bridge AS
 SELECT btrim(ftf_ims_bridge.payer_name) AS payer_name,
        btrim(ftf_ims_bridge.code) AS code,
        btrim(ftf_ims_bridge.name) AS name,
        btrim(ftf_ims_bridge.state) AS state,
        btrim(ftf_ims_bridge.comments) AS comments,
        ftf_ims_bridge.plan_id,
        btrim(ftf_ims_bridge.plan_name) AS plan_name,
        btrim(ftf_ims_bridge.provider_name) AS provider_name,
        btrim(ftf_ims_bridge.plan_type_name) AS plan_type_name,
        ftf_ims_bridge.file_id,
        ftf_ims_bridge.record_id
 FROM cleansed.ftf_ims_bridge
 WHERE (ftf_ims_bridge.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_ims_bridge.file_id
 FROM cleansed.ftf_ims_bridge
 GROUP BY ftf_ims_bridge.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_qc_uniq_iqvia_model_plan_count AS
 SELECT iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.model;

CREATE  VIEW sandbox.vw_qc_uniq_paytype_plan_count AS
 SELECT iqvia_plan_preprocessed.paytype,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_uniq_payer_plan_count AS
 SELECT iqvia_plan_preprocessed.iqvia_payer_name,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_payer_name;

CREATE  VIEW sandbox.vw_qc_uniq_pbm_plan_count AS
 SELECT iqvia_plan_preprocessed.iqvia_pbm,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_pbm;

CREATE  VIEW sandbox.vw_qc_uniq_plan_model_codes AS
 SELECT iqvia_plan_preprocessed.iqvia_payer_name,
        iqvia_plan_preprocessed.paytype,
        iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_code) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_payer_name,
          iqvia_plan_preprocessed.paytype,
          iqvia_plan_preprocessed.model
 ORDER BY iqvia_plan_preprocessed.iqvia_payer_name,
          iqvia_plan_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_uniq_paytype_model_plan_count AS
 SELECT iqvia_plan_preprocessed.paytype,
        iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS plan_counts
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.paytype,
          iqvia_plan_preprocessed.model;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_paytype_plan_count AS
 SELECT ftf_health_plans_preprocessed.paytype,
        count(DISTINCT ftf_health_plans_preprocessed.ftf_health_plan_name) AS plan_count
 FROM sandbox.ftf_health_plans_preprocessed
 WHERE (ftf_health_plans_preprocessed.cycle_id IN ( SELECT max(ftf_health_plans_preprocessed.cycle_id) AS max
 FROM sandbox.ftf_health_plans_preprocessed))
 GROUP BY ftf_health_plans_preprocessed.paytype
 ORDER BY ftf_health_plans_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_paytype_plantype_plan_count AS
 SELECT ftf_health_plans_preprocessed.paytype,
        ftf_health_plans_preprocessed.ftf_health_plan_type,
        count(DISTINCT ftf_health_plans_preprocessed.ftf_health_plan_name) AS plan_count
 FROM sandbox.ftf_health_plans_preprocessed
 WHERE (ftf_health_plans_preprocessed.cycle_id IN ( SELECT max(ftf_health_plans_preprocessed.cycle_id) AS max
 FROM sandbox.ftf_health_plans_preprocessed))
 GROUP BY ftf_health_plans_preprocessed.paytype,
          ftf_health_plans_preprocessed.ftf_health_plan_type
 ORDER BY ftf_health_plans_preprocessed.paytype,
          ftf_health_plans_preprocessed.ftf_health_plan_type;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_restriction_group_plan_count AS
 SELECT ftf_restrictions_preprocessed_v1.grouped_restriction_level,
        count(DISTINCT ftf_restrictions_preprocessed_v1.ftf_health_plan_fid) AS plan_count
 FROM sandbox.ftf_restrictions_preprocessed_v1
 GROUP BY ftf_restrictions_preprocessed_v1.grouped_restriction_level
 ORDER BY ftf_restrictions_preprocessed_v1.grouped_restriction_level;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_restriction_detail_plan_count AS
 SELECT ftf_restrictions_preprocessed_v1.restriction_detail_text,
        count(DISTINCT ftf_restrictions_preprocessed_v1.ftf_health_plan_fid) AS plan_count
 FROM sandbox.ftf_restrictions_preprocessed_v1
 GROUP BY ftf_restrictions_preprocessed_v1.restriction_detail_text
 ORDER BY ftf_restrictions_preprocessed_v1.restriction_detail_text;

CREATE  VIEW raw.EXT_VV_SUGGESTION_FEEDBACK_VOD__C AS
 SELECT src.id,
        src.isdeleted,
        src.name,
        src.recordtypeid,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.suggestion_vod__c,
        src.account_vod__c,
        src.activity_execution_type_vod__c,
        src.call2_vod__c,
        src.dismissfeedback1_vod__c,
        src.dismissfeedback2_vod__c,
        src.dismissfeedback3_vod__c,
        src.dismissfeedback4_vod__c,
        src.mobile_id_vod__c,
        src.sent_email_vod__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_SUGGESTION_FEEDBACK_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_SUGGESTION_FEEDBACK'::varchar(26)))));

CREATE  VIEW outbound.zs_dddmd_demographics_weekly AS
 SELECT dddmd_demographics.account_demo_id,
        dddmd_demographics.outlet_code,
        dddmd_demographics.ims_facility_number,
        dddmd_demographics.ims_prescriber_number,
        dddmd_demographics.category_code,
        dddmd_demographics.subcategory_code,
        dddmd_demographics.alignment_zip,
        dddmd_demographics.outlet_name,
        dddmd_demographics.outlet_address,
        dddmd_demographics.outlet_city,
        dddmd_demographics.outlet_state,
        dddmd_demographics.outlet_zip,
        dddmd_demographics.facility_name,
        dddmd_demographics.facility_address1,
        dddmd_demographics.facility_address2,
        dddmd_demographics.facility_address3,
        dddmd_demographics.facility_address4,
        dddmd_demographics.facility_city,
        dddmd_demographics.facility_state,
        dddmd_demographics.facility_zip,
        dddmd_demographics.prescriber_name,
        dddmd_demographics.prescriber_address1,
        dddmd_demographics.prescriber_address2,
        dddmd_demographics.prescriber_address3,
        dddmd_demographics.prescriber_address4,
        dddmd_demographics.prescriber_city,
        dddmd_demographics.prescriber_state,
        dddmd_demographics.prescriber_zip,
        dddmd_demographics.account_status,
        dddmd_demographics.tvcmid,
        dddmd_demographics.sales_force_id,
        dddmd_demographics.outlet_tvcmid,
        dddmd_demographics.facility_tvcmid,
        dddmd_demographics.prescriber_tvcmid,
        dddmd_demographics.tvcmid_assignment_rule
 FROM datamart.dddmd_demographics
 GROUP BY dddmd_demographics.account_demo_id,
          dddmd_demographics.outlet_code,
          dddmd_demographics.ims_facility_number,
          dddmd_demographics.ims_prescriber_number,
          dddmd_demographics.category_code,
          dddmd_demographics.subcategory_code,
          dddmd_demographics.alignment_zip,
          dddmd_demographics.outlet_name,
          dddmd_demographics.outlet_address,
          dddmd_demographics.outlet_city,
          dddmd_demographics.outlet_state,
          dddmd_demographics.outlet_zip,
          dddmd_demographics.facility_name,
          dddmd_demographics.facility_address1,
          dddmd_demographics.facility_address2,
          dddmd_demographics.facility_address3,
          dddmd_demographics.facility_address4,
          dddmd_demographics.facility_city,
          dddmd_demographics.facility_state,
          dddmd_demographics.facility_zip,
          dddmd_demographics.prescriber_name,
          dddmd_demographics.prescriber_address1,
          dddmd_demographics.prescriber_address2,
          dddmd_demographics.prescriber_address3,
          dddmd_demographics.prescriber_address4,
          dddmd_demographics.prescriber_city,
          dddmd_demographics.prescriber_state,
          dddmd_demographics.prescriber_zip,
          dddmd_demographics.account_status,
          dddmd_demographics.tvcmid,
          dddmd_demographics.sales_force_id,
          dddmd_demographics.outlet_tvcmid,
          dddmd_demographics.facility_tvcmid,
          dddmd_demographics.prescriber_tvcmid,
          dddmd_demographics.tvcmid_assignment_rule;

CREATE  VIEW outbound.zs_dddmd_demographics_detail_weekly AS
 SELECT dddmd_demographics_detail.account_demo_id,
        dddmd_demographics_detail.outlet_code,
        dddmd_demographics_detail.ims_facility_number,
        dddmd_demographics_detail.ims_prescriber_number,
        dddmd_demographics_detail.category_code,
        dddmd_demographics_detail.subcategory_code,
        dddmd_demographics_detail.alignment_zip,
        dddmd_demographics_detail.outlet_name,
        dddmd_demographics_detail.outlet_address,
        dddmd_demographics_detail.outlet_city,
        dddmd_demographics_detail.outlet_state,
        dddmd_demographics_detail.outlet_zip,
        dddmd_demographics_detail.facility_name,
        dddmd_demographics_detail.facility_address1,
        dddmd_demographics_detail.facility_address2,
        dddmd_demographics_detail.facility_address3,
        dddmd_demographics_detail.facility_address4,
        dddmd_demographics_detail.facility_city,
        dddmd_demographics_detail.facility_state,
        dddmd_demographics_detail.facility_zip,
        dddmd_demographics_detail.prescriber_name,
        dddmd_demographics_detail.prescriber_address1,
        dddmd_demographics_detail.prescriber_address2,
        dddmd_demographics_detail.prescriber_address3,
        dddmd_demographics_detail.prescriber_address4,
        dddmd_demographics_detail.prescriber_city,
        dddmd_demographics_detail.prescriber_state,
        dddmd_demographics_detail.prescriber_zip,
        dddmd_demographics_detail.account_status,
        dddmd_demographics_detail.tvcmid,
        dddmd_demographics_detail.sales_force_id,
        dddmd_demographics_detail.outlet_tvcmid,
        dddmd_demographics_detail.facility_tvcmid,
        dddmd_demographics_detail.prescriber_tvcmid,
        dddmd_demographics_detail.tvcmid_assignment_rule
 FROM datamart.dddmd_demographics_detail
 GROUP BY dddmd_demographics_detail.account_demo_id,
          dddmd_demographics_detail.outlet_code,
          dddmd_demographics_detail.ims_facility_number,
          dddmd_demographics_detail.ims_prescriber_number,
          dddmd_demographics_detail.category_code,
          dddmd_demographics_detail.subcategory_code,
          dddmd_demographics_detail.alignment_zip,
          dddmd_demographics_detail.outlet_name,
          dddmd_demographics_detail.outlet_address,
          dddmd_demographics_detail.outlet_city,
          dddmd_demographics_detail.outlet_state,
          dddmd_demographics_detail.outlet_zip,
          dddmd_demographics_detail.facility_name,
          dddmd_demographics_detail.facility_address1,
          dddmd_demographics_detail.facility_address2,
          dddmd_demographics_detail.facility_address3,
          dddmd_demographics_detail.facility_address4,
          dddmd_demographics_detail.facility_city,
          dddmd_demographics_detail.facility_state,
          dddmd_demographics_detail.facility_zip,
          dddmd_demographics_detail.prescriber_name,
          dddmd_demographics_detail.prescriber_address1,
          dddmd_demographics_detail.prescriber_address2,
          dddmd_demographics_detail.prescriber_address3,
          dddmd_demographics_detail.prescriber_address4,
          dddmd_demographics_detail.prescriber_city,
          dddmd_demographics_detail.prescriber_state,
          dddmd_demographics_detail.prescriber_zip,
          dddmd_demographics_detail.account_status,
          dddmd_demographics_detail.tvcmid,
          dddmd_demographics_detail.sales_force_id,
          dddmd_demographics_detail.outlet_tvcmid,
          dddmd_demographics_detail.facility_tvcmid,
          dddmd_demographics_detail.prescriber_tvcmid,
          dddmd_demographics_detail.tvcmid_assignment_rule;

CREATE  VIEW outbound.zs_dddmd_weekly AS
 SELECT ddd_md.onc_account_demo_id,
        ddd_md.alt_seq_num,
        ddd_md.outlet_name,
        ddd_md.outlet_code,
        ddd_md.subcategory_code,
        ddd_md.outlet_zip,
        ddd_md.report_frequency,
        ddd_md.basket_id,
        ddd_md.basket_name,
        ddd_md.data_date,
        ddd_md.date,
        ddd_md.rollup_week,
        ddd_md.rollup_month,
        ddd_md.comp_month,
        ddd_md.quantity,
        ddd_md.dollars,
        ddd_md.sales_force_id,
        ddd_md.rollup_445_month,
        ddd_md.tvcmid,
        ddd_md.ims_facility_number,
        ddd_md.ims_prescriber_number,
        ddd_md.facility_tvcmid,
        ddd_md.prescriber_tvcmid,
        ddd_md.outlet_tvcmid
 FROM datamart.ddd_md
 WHERE (ddd_md.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5)))
 GROUP BY ddd_md.onc_account_demo_id,
          ddd_md.alt_seq_num,
          ddd_md.outlet_name,
          ddd_md.outlet_code,
          ddd_md.subcategory_code,
          ddd_md.outlet_zip,
          ddd_md.report_frequency,
          ddd_md.basket_id,
          ddd_md.basket_name,
          ddd_md.data_date,
          ddd_md.date,
          ddd_md.rollup_week,
          ddd_md.rollup_month,
          ddd_md.comp_month,
          ddd_md.quantity,
          ddd_md.dollars,
          ddd_md.sales_force_id,
          ddd_md.rollup_445_month,
          ddd_md.tvcmid,
          ddd_md.ims_facility_number,
          ddd_md.ims_prescriber_number,
          ddd_md.facility_tvcmid,
          ddd_md.prescriber_tvcmid,
          ddd_md.outlet_tvcmid;

CREATE  VIEW outbound.wheels_roster AS
 SELECT replace(rep.employee_id, 'A'::varchar(1), ''::varchar) AS UniqueIdentifier,
        mgr.full_name AS ReportsToName,
        mgr.email AS ReportsToEmailAddress,
        rep.team AS EmployeeOrganization,
        rep.last_name AS LastName,
        rep.first_name AS FirstName,
        rep.middle_name AS MiddleName,
        rep.suffix AS Generation,
        rep.preferred_name AS PreferredName,
        rep.hire_date AS HireDate,
        rep.address_line1 AS Address1,
        rep.address_line2 AS Address2,
        rep.address_line3 AS Address3,
        rep.city AS City,
        rep.state AS StateProvince,
        rep.zip AS ZipPostalCode,
        rep.home_phone AS HomePhone,
        rep.business_phone AS WorkPhone,
        rep.email AS EmailWork,
        coalesce(rep.hr_status, 'Active'::varchar(6)) AS Status,
        rep.territory_number AS TerrID,
        rep.territory_name AS TerrName,
        ''::varchar AS TermDate,
        CASE WHEN (rep.sales_force_id ~~ 'CA%'::varchar(3)) THEN (rep.oracle_string || '.6040008'::varchar(8)) ELSE (rep.oracle_string || '.7040006'::varchar(8)) END AS ADPJobCode,
        rep.title AS PositionName
 FROM (datamart.roster rep LEFT  JOIN datamart.roster mgr ON ((rep.supervisor_global_employee_id = mgr.global_employee_id)))
 WHERE ((rep.employee_id IS NOT NULL) AND (rep.sales_force_id = ANY (ARRAY['TM'::varchar(2), 'MA'::varchar(2), 'TE'::varchar(2), 'TS'::varchar(2), 'TR'::varchar(2), 'TO'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2), 'CG'::varchar(2), 'CA'::varchar(2), 'CM'::varchar(2), 'CS'::varchar(2)])) AND (rep.fleet_eligible = 'Y'::varchar(1)))
 ORDER BY substr(rep.territory_number, 1, 2),
          rep.last_name,
          rep.first_name;

CREATE  VIEW outbound.hcp_affiliation AS
 SELECT hco.tvcmid AS hco_tvcmid,
        hco.business_name,
        sa.role AS affiliation_role,
        vf.influence_vod__c AS affiliation_influence,
        ((hcp.last_name || ', '::varchar(2)) || hcp.first_name) AS hcp_name,
        hcp.tvcmid AS hcp_tvcmid
 FROM (((datamart.customer_hco_demographics hco JOIN datamart.sfa_affiliations sa ON ((sa.affiliated_to_tvcmid = hco.tvcmid))) JOIN datamart.customer_hcp_demographics hcp ON ((hcp.tvcmid = sa.affiliated_from_tvcmid))) LEFT  JOIN veeva.v_affiliation vf ON ((vf.to_account_vod__c = sa.affiliated_to_id)))
 WHERE ((hco.cot_classification = 'OUTPATIENT CENTER'::varchar(17)) AND (hco.cot_facility_type = 'MEDICAL GROUP'::varchar(13)) AND (hco.cot_specialty = ANY (ARRAY['NEUROLOGY'::varchar(15), 'PAIN MANAGEMENT'::varchar(15)])) AND (hcp.hce_status_desc = 'ACTIVE'::varchar(6)))
 GROUP BY hco.tvcmid,
          hco.business_name,
          sa.role,
          vf.influence_vod__c,
          ((hcp.last_name || ', '::varchar(2)) || hcp.first_name),
          hcp.tvcmid;

CREATE  VIEW outbound.zs_xpd_demographics_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.ims_id,
        rx.tvcmid,
        rx.last_name,
        rx.first_name,
        rx.middle_name,
        rx.address_1,
        rx.address_2,
        rx.city,
        rx.state,
        rx.zip,
        pcd.specialty,
        xref.specialty_group,
        rx.trx_decile_retail,
        rx.nrx_decile_retail,
        rx.nbrx_decile_retail,
        rx.trx_decile_mail,
        rx.nrx_decile_mail,
        rx.nbrx_decile_mail,
        rx.market_prescriber_reliability_retail,
        rx.market_prescriber_reliability_mail,
        rx.report_frequency
 FROM ((datamart.xpd_demographics_respiratory rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.ims_id,
          rx.tvcmid,
          rx.last_name,
          rx.first_name,
          rx.middle_name,
          rx.address_1,
          rx.address_2,
          rx.city,
          rx.state,
          rx.zip,
          pcd.specialty,
          xref.specialty_group,
          rx.trx_decile_retail,
          rx.nrx_decile_retail,
          rx.nbrx_decile_retail,
          rx.trx_decile_mail,
          rx.nrx_decile_mail,
          rx.nbrx_decile_mail,
          rx.market_prescriber_reliability_retail,
          rx.market_prescriber_reliability_mail,
          rx.report_frequency;

CREATE  VIEW outbound.zs_xpd_core_metrics_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.ims_product_group,
        rx.basket_id,
        rx.basket_name,
        rx.rollup_period,
        rx.xpo_nrx,
        rx.xpo_trx,
        rx.unknown_nrx,
        rx.unknown_trx,
        rx.new_therapy_starts,
        rx.continued_new,
        rx.switch_to,
        rx.add_on,
        rx.restart_same_new,
        rx.restart_different,
        rx.continued_refill,
        rx.restart_same_refill,
        rx.switch_from,
        rx.restart_different_from,
        rx.add_to,
        rx.market_new_to_brand_rx,
        rx.dynamic_capture_rx,
        rx.report_frequency
 FROM ((datamart.xpd_core_metrics_respiratory rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.ims_product_group,
          rx.basket_id,
          rx.basket_name,
          rx.rollup_period,
          rx.xpo_nrx,
          rx.xpo_trx,
          rx.unknown_nrx,
          rx.unknown_trx,
          rx.new_therapy_starts,
          rx.continued_new,
          rx.switch_to,
          rx.add_on,
          rx.restart_same_new,
          rx.restart_different,
          rx.continued_refill,
          rx.restart_same_refill,
          rx.switch_from,
          rx.restart_different_from,
          rx.add_to,
          rx.market_new_to_brand_rx,
          rx.dynamic_capture_rx,
          rx.report_frequency;

CREATE  VIEW outbound.zs_xpd_switch_details_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.switch_from_product_group_num,
        rx.switch_from_basket_id,
        rx.switch_from_basket_name,
        rx.switch_to_product_group_num,
        rx.switch_to_basket_id,
        rx.switch_to_basket_name,
        rx.rollup_period,
        rx.rx,
        rx.report_frequency
 FROM ((datamart.xpd_switch_details_respiratory rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.switch_from_product_group_num,
          rx.switch_from_basket_id,
          rx.switch_from_basket_name,
          rx.switch_to_product_group_num,
          rx.switch_to_basket_id,
          rx.switch_to_basket_name,
          rx.rollup_period,
          rx.rx,
          rx.report_frequency;

CREATE  VIEW outbound.zs_xpd_restart_diff_details_respiratory_monthly AS
 SELECT rx.ims_client_number,
        rx.ims_report_number,
        rx.channel_indicator,
        rx.ims_id,
        rx.tvcmid,
        pcd.specialty,
        xref.specialty_group,
        rx.restart_from_product_group_num,
        rx.restart_from_basket_id,
        rx.restart_from_basket_name,
        rx.restart_to_product_group_num,
        rx.restart_to_basket_id,
        rx.restart_to_basket_name,
        rx.rollup_period,
        rx.restart_diff_rx,
        rx.report_frequency
 FROM ((datamart.xpd_restart_diff_details rx LEFT  JOIN ( SELECT prescriber_combined_demographics.ims_id,
        prescriber_combined_demographics.specialty,
        prescriber_combined_demographics.sales_force_id
 FROM datamart.prescriber_combined_demographics
 WHERE (prescriber_combined_demographics.sales_force_id = 'TR'::varchar(2))) pcd ON ((rx.ims_id = pcd.ims_id))) LEFT  JOIN ( SELECT specialty_group_xref.category_name,
        specialty_group_xref.specialty_code,
        specialty_group_xref.specialty_group
 FROM reference.specialty_group_xref
 WHERE (specialty_group_xref.category_name = 'CINQAIR'::varchar(7))) xref ON ((pcd.specialty = xref.specialty_code)))
 WHERE (rx.report_frequency = 'MONTH'::varchar(5))
 GROUP BY rx.ims_client_number,
          rx.ims_report_number,
          rx.channel_indicator,
          rx.ims_id,
          rx.tvcmid,
          pcd.specialty,
          xref.specialty_group,
          rx.restart_from_product_group_num,
          rx.restart_from_basket_id,
          rx.restart_from_basket_name,
          rx.restart_to_product_group_num,
          rx.restart_to_basket_id,
          rx.restart_to_basket_name,
          rx.rollup_period,
          rx.restart_diff_rx,
          rx.report_frequency;

CREATE  VIEW outbound.zs_cmop_monthly AS
 SELECT cmop_rx.data_month,
        cmop_rx.comp_month,
        cmop_rx.pharmacy,
        cmop_rx.visn,
        cmop_rx.station_number,
        cmop_rx.station,
        cmop_rx.va_product,
        cmop_rx.basket_id,
        cmop_rx.basket_name,
        cmop_rx.cmop_rxs_raw,
        cmop_rx.cmop_rxs_normalized,
        cmop_rx.total_quantity,
        cmop_rx.cmop_quantity,
        cmop_rx.rxs_30_days,
        cmop_rx.zip,
        cmop_rx.id,
        cmop_rx.rollup_flag,
        cmop_rx.basket_type,
        cmop_rx.total_rxs_normalized
 FROM datamart.cmop_rx
 WHERE (cmop_rx.comp_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5)))
 GROUP BY cmop_rx.data_month,
          cmop_rx.comp_month,
          cmop_rx.pharmacy,
          cmop_rx.visn,
          cmop_rx.station_number,
          cmop_rx.station,
          cmop_rx.va_product,
          cmop_rx.basket_id,
          cmop_rx.basket_name,
          cmop_rx.cmop_rxs_raw,
          cmop_rx.cmop_rxs_normalized,
          cmop_rx.total_quantity,
          cmop_rx.cmop_quantity,
          cmop_rx.rxs_30_days,
          cmop_rx.zip,
          cmop_rx.id,
          cmop_rx.rollup_flag,
          cmop_rx.basket_type,
          cmop_rx.total_rxs_normalized;

CREATE  VIEW outbound.knipper_roster AS
 SELECT roster.rep_type AS Title,
        roster.territory_number AS "Territory ID",
        roster.first_name AS "First Name",
        roster.last_name AS "Last Name",
        NULL AS "Cell Number",
        NULL AS "Home Number",
        NULL AS "Home Address",
        NULL AS "Home Address 2",
        NULL AS "Home City",
        NULL AS "Home State",
        NULL AS "Home Zip",
        roster.business_address_line1 AS "Mailing Address",
        roster.business_address_line2 AS "Mailing Address 2",
        roster.business_city AS "Mailing City",
        roster.business_state AS "Mailing State",
        roster.business_zip AS "Mailing Zip",
        roster.email AS Email,
        roster.employee_id AS "Employee#",
        roster.hire_date AS "Start Date",
        NULL AS "Personal Email",
        CASE WHEN (roster.hr_status = 'LOA'::varchar(3)) THEN 'Y'::varchar(1) WHEN (roster.hr_status = 'Active'::varchar(6)) THEN 'N'::varchar(1) ELSE roster.hr_status END AS "On LOA"
 FROM datamart.roster
 WHERE ((roster.hr_status IS NOT NULL) AND (roster.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2)])));

CREATE  VIEW outbound.knipper_zip_terr AS
 SELECT current_alignment.zip_code AS Zip,
        current_alignment.city AS City,
        current_alignment.state_code AS State,
        current_alignment.territory_number AS "Territory ID",
        current_alignment.territory_name AS "Territory Name",
        current_alignment.region_number AS "Regional ID",
        current_alignment.region_name AS "Region Name",
        current_alignment.area_number AS "Area ID",
        current_alignment.area_name AS "Area Name"
 FROM datamart.current_alignment
 WHERE (current_alignment.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2)]))
 GROUP BY current_alignment.zip_code,
          current_alignment.city,
          current_alignment.state_code,
          current_alignment.territory_number,
          current_alignment.territory_name,
          current_alignment.region_number,
          current_alignment.region_name,
          current_alignment.area_number,
          current_alignment.area_name;

CREATE  VIEW outbound.zs_tvcmid_xref_monthly AS
 SELECT xref.tvcmid,
        xref.id_num,
        xref.id_type,
        xref.state,
        xref.file_id,
        xref.record_id,
        xref.status
 FROM (datamart.tvcmid_xref xref JOIN datamart.customer_hco_demographics hco ON ((hco.tvcmid = xref.tvcmid)))
 WHERE (xref.file_id IN ( SELECT data_file_metadata.file_id
 FROM metadata.data_file_metadata
 WHERE (data_file_metadata.raw_table ~~* '%mdm_alternate_id%'::varchar(18))))
 GROUP BY xref.tvcmid,
          xref.id_num,
          xref.id_type,
          xref.state,
          xref.file_id,
          xref.record_id,
          xref.status;

CREATE  VIEW outbound.zs_revo_hco_demographics_monthly AS
 SELECT hco.tvcmid,
        hco.ims_org_id,
        hco.npi,
        hco.hin,
        hco.outlet_code,
        hco.business_name,
        hco.address_line1,
        hco.address_line2,
        hco.city,
        hco.state_code,
        hco.zip,
        hco.cot_classification,
        hco.cot_facility_type,
        hco.cot_specialty,
        mc.communication_value AS phone,
        xref.id_num AS dea,
        mdm.status_indicator_name AS hco_status,
        mdm.updated_date
 FROM (((datamart.customer_hco_demographics hco LEFT  JOIN mdm.communication mc ON (((hco.tvcmid = mc.tvcmid) AND (hco.address_id = mc.address_id) AND (mc.communication_type_name = 'PHONE'::varchar(5))))) LEFT  JOIN datamart.tvcmid_xref xref ON (((hco.tvcmid = xref.tvcmid) AND (xref.id_type = 'DEA_NUM'::varchar(7)) AND (xref.status <> 'I'::varchar(1))))) LEFT  JOIN mdm.hco mdm ON ((hco.tvcmid = mdm.tvcmid)))
 GROUP BY hco.tvcmid,
          hco.ims_org_id,
          hco.npi,
          hco.hin,
          hco.outlet_code,
          hco.business_name,
          hco.address_line1,
          hco.address_line2,
          hco.city,
          hco.state_code,
          hco.zip,
          hco.cot_classification,
          hco.cot_facility_type,
          hco.cot_specialty,
          mc.communication_value,
          xref.id_num,
          mdm.status_indicator_name,
          mdm.updated_date;

CREATE  VIEW outbound.MCM_roster AS
 SELECT r.sales_force_id,
        r.employee_id,
        r.territory_number,
        t.Name AS covered_territory,
        r.territory_name,
        coalesce(vu.id, ('vacant-'::varchar(7) || r.territory_number)) AS veeva_user_id,
        r.full_name,
        r.first_name,
        r.middle_name,
        r.last_name,
        r.email,
        r.title,
        r.rep_type,
        mgr.territory_number AS mgr_territory,
        mgr.full_name AS mgr_name,
        mgr.email AS mgr_email,
        CASE WHEN ((r.full_name ~~* '%vacant%'::varchar(8)) AND (eas.assignment_end_date__c <> '2099-12-31'::varchar(10))) THEN substr((((trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) - to_date(substr(eas.assignment_end_date__c, 1, 10), 'yyyy-mm-dd'::varchar(10)))))::varchar, ((length((((trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) - to_date(substr(eas.assignment_end_date__c, 1, 10), 'yyyy-mm-dd'::varchar(10)))))::varchar) - 5) + 1), 5) ELSE NULL END AS num_days_vacant
 FROM (((((datamart.roster r LEFT  JOIN veeva.veeva_user vu ON ((vu.employeenumber = r.employee_id))) LEFT  JOIN veeva.userterritory2association uta ON ((vu.id = uta.UserId))) LEFT  JOIN veeva.territory2 t ON ((uta.Territory2Id = t.Id))) JOIN datamart.roster mgr ON ((r.parent_territory_number = mgr.territory_number))) LEFT  JOIN cleansed.axtria_employee_assignment_status_v2 eas ON (((r.territory_number = eas.rms_territory_number__c) AND (eas.assignment_status__c = 'Active'::varchar(6)))))
 WHERE ((r.sales_force_id = ANY (ARRAY['TR'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) AND (r.rep_type = 'REP'::varchar(3)) AND (eas.file_id = ( SELECT max(axtria_employee_assignment_status_v2.file_id) AS max
 FROM cleansed.axtria_employee_assignment_status_v2)))
 GROUP BY r.sales_force_id,
          r.employee_id,
          r.territory_number,
          t.Name,
          r.territory_name,
          coalesce(vu.id, ('vacant-'::varchar(7) || r.territory_number)),
          r.full_name,
          r.first_name,
          r.middle_name,
          r.last_name,
          r.email,
          r.title,
          r.rep_type,
          mgr.territory_number,
          mgr.full_name,
          mgr.email,
          CASE WHEN ((r.full_name ~~* '%vacant%'::varchar(8)) AND (eas.assignment_end_date__c <> '2099-12-31'::varchar(10))) THEN substr((((trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) - to_date(substr(eas.assignment_end_date__c, 1, 10), 'yyyy-mm-dd'::varchar(10)))))::varchar, ((length((((trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) - to_date(substr(eas.assignment_end_date__c, 1, 10), 'yyyy-mm-dd'::varchar(10)))))::varchar) - 5) + 1), 5) ELSE NULL END;

CREATE  VIEW outbound.zs_xpo_xpopt_AM_product_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.rollup_month >= trunc((now() + '-24'::interval month), 'MONTH'::varchar(5))) AND (prescriber_rx.market_name = 'ANTI-MIGRAINE MARKET'::varchar(20)) AND (prescriber_rx.basket_type = 'product'::varchar(7)));

CREATE  VIEW sandbox.vw_curr_iqvia_plans_discard_v1 AS
 SELECT btrim(iqvia_plans_discard_v1.payer_id) AS payer_id,
        btrim(iqvia_plans_discard_v1.notes) AS notes,
        iqvia_plans_discard_v1.file_id,
        iqvia_plans_discard_v1.record_id
 FROM sandbox.iqvia_plans_discard_v1
 WHERE (iqvia_plans_discard_v1.file_id IN ( SELECT max(iqvia_plans_discard_v1.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v1));

CREATE  VIEW sandbox.vw_curr_model_paytype_map_v1 AS
 SELECT btrim(model_paytype_map_v1.model) AS model,
        btrim(model_paytype_map_v1.paytype) AS paytype,
        btrim(model_paytype_map_v1.notes) AS notes,
        model_paytype_map_v1.file_id,
        model_paytype_map_v1.record_id
 FROM sandbox.model_paytype_map_v1
 WHERE (model_paytype_map_v1.file_id IN ( SELECT max(model_paytype_map_v1.file_id) AS max
 FROM sandbox.model_paytype_map_v1));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_paytype_override_v1 AS
 SELECT btrim(iqvia_payer_paytype_override_v1.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v1.paytype) AS paytype,
        iqvia_payer_paytype_override_v1.file_id,
        iqvia_payer_paytype_override_v1.record_id
 FROM sandbox.iqvia_payer_paytype_override_v1
 WHERE (iqvia_payer_paytype_override_v1.file_id IN ( SELECT max(iqvia_payer_paytype_override_v1.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v1));

CREATE  VIEW sandbox.vw_curr_iqvia_paytypeindex_v1 AS
 SELECT btrim(iqvia_paytypeindex_v1.paytype_index) AS paytype_index,
        btrim(iqvia_paytypeindex_v1.paytype) AS paytype,
        iqvia_paytypeindex_v1.file_id,
        iqvia_paytypeindex_v1.record_id
 FROM sandbox.iqvia_paytypeindex_v1
 WHERE (iqvia_paytypeindex_v1.file_id IN ( SELECT max(iqvia_paytypeindex_v1.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_drug_assignments_v1 AS
 SELECT drug_assignments_v1.drug_id,
        drug_assignments_v1.drug_seq,
        btrim(drug_assignments_v1.product) AS product,
        drug_assignments_v1.file_id,
        drug_assignments_v1.record_id
 FROM sandbox.drug_assignments_v1
 WHERE (drug_assignments_v1.file_id IN ( SELECT max(drug_assignments_v1.file_id) AS max
 FROM sandbox.drug_assignments_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans_v1 AS
 SELECT replace(replace(btrim(raw_ftf_health_plans.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS formularyf_id,
        replace(replace(btrim(raw_ftf_health_plans.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        replace(replace(btrim(raw_ftf_health_plans.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        replace(replace(btrim(raw_ftf_health_plans.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        raw_ftf_health_plans.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans;

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography_v1 AS
 SELECT replace(replace(btrim(raw_ftf_health_plan_geography.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography;

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms_v1 AS
 SELECT replace(replace(btrim(raw_ftf_pbms.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_pbms.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        replace(replace(btrim(raw_ftf_pbms.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms;

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_v1 AS
 SELECT replace(replace(btrim(raw_ftf_restrictions.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_restrictions.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions;

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref_v1 AS
 SELECT replace(replace(btrim(raw_iqvia_plan.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_num,
        replace(replace(btrim(raw_iqvia_plan.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        replace(replace(btrim(raw_iqvia_plan.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_num,
        replace(replace(btrim(raw_iqvia_plan.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan.months_with_data
 FROM sandbox.raw_iqvia_plan;

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref_v1 AS
 SELECT replace(replace(btrim(raw_iqvia_pbm.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        replace(replace(btrim(raw_iqvia_pbm.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm.pbm_num,
        raw_iqvia_pbm.ims_processor_num
 FROM sandbox.raw_iqvia_pbm;

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge_v1 AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        replace(replace(btrim(raw_teva_ims_bridge.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS code,
        replace(replace(btrim(raw_teva_ims_bridge.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        raw_teva_ims_bridge.plan_id,
        replace(replace(btrim(raw_teva_ims_bridge.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge;

CREATE  VIEW sandbox.vw_curr_ftf_plans_paytypeindex_v1 AS
 SELECT btrim(ftf_plans_paytypeindex_v1.ftf_health_plantype) AS ftf_health_plantype,
        ftf_plans_paytypeindex_v1.paytype_index,
        ftf_plans_paytypeindex_v1.file_id,
        ftf_plans_paytypeindex_v1.record_id
 FROM sandbox.ftf_plans_paytypeindex_v1
 WHERE (ftf_plans_paytypeindex_v1.file_id IN ( SELECT max(ftf_plans_paytypeindex_v1.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_v1 AS
 SELECT replace(replace(btrim(raw_ftf_formularies.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_formularies.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS drug_id,
        replace(replace(btrim(raw_ftf_formularies.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies;

CREATE  VIEW sandbox.vw_curr_ftf_pbm_functions_v1 AS
 SELECT ftf_pbm_functions_v1.pbm_function_id,
        btrim(ftf_pbm_functions_v1.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v1.notes) AS notes,
        ftf_pbm_functions_v1.used,
        ftf_pbm_functions_v1.file_id,
        ftf_pbm_functions_v1.record_id
 FROM sandbox.ftf_pbm_functions_v1
 WHERE (ftf_pbm_functions_v1.file_id IN ( SELECT max(ftf_pbm_functions_v1.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v1));

CREATE  VIEW sandbox.vw_override_bridge_ftf_plan_types_v1 AS
 SELECT btrim(override_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v1.override_precedence,
        override_bridge_ftf_plan_types_v1.file_id,
        override_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v1
 WHERE (override_bridge_ftf_plan_types_v1.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v1.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v1));

CREATE  VIEW sandbox.vw_delete_bridge_ftf_plan_types_v1 AS
 SELECT btrim(delete_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.delete_flag) AS delete_flag,
        delete_bridge_ftf_plan_types_v1.file_id,
        delete_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v1
 WHERE (delete_bridge_ftf_plan_types_v1.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v1.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plans_cdw.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS formularyf_id,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans_cdw.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        (raw_ftf_health_plans_cdw.preferred_brand_tier)::int AS preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_cdw
 WHERE (raw_ftf_health_plans_cdw.file_id IN ( SELECT max(raw_ftf_health_plans_cdw.file_id) AS max
 FROM sandbox.raw_ftf_health_plans_cdw));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_xref_cdw_v1 AS
 SELECT ftf_iqvia_xref_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.paytype,
        ftf_iqvia_xref_cdw_v1.model,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_cdw_v1.payer_pbm,
        ftf_iqvia_xref_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.key_pbm,
        ftf_iqvia_xref_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_cdw_v1.cycle_id,
        ftf_iqvia_xref_cdw_v1.modified_time,
        ftf_iqvia_xref_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_xref_cdw_v1
 WHERE (ftf_iqvia_xref_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_xref_cdw_v1'::varchar(21)))))));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_xref_v2_cdw_v1 AS
 SELECT ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_payer_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_pbm,
        ftf_iqvia_xref_v2_cdw_v1.payment_type,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_model,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_v2_cdw_v1.payer_pbm,
        ftf_iqvia_xref_v2_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_v2_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.key_pbm,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_v2_cdw_v1.cycle_id,
        ftf_iqvia_xref_v2_cdw_v1.modified_time,
        ftf_iqvia_xref_v2_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_xref_v2_cdw_v1
 WHERE (ftf_iqvia_xref_v2_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_xref_v2_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1 AS
 SELECT comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.payment_type,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_payment_type,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.change_payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_payer,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_in_lives,
        comparison_iqvia_fid_plans_cdw_v1.month_flag,
        comparison_iqvia_fid_plans_cdw_v1.status,
        comparison_iqvia_fid_plans_cdw_v1.cycle_id,
        comparison_iqvia_fid_plans_cdw_v1.modified_time,
        comparison_iqvia_fid_plans_cdw_v1.modified_by
 FROM sandbox.comparison_iqvia_fid_plans_cdw_v1
 WHERE (comparison_iqvia_fid_plans_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_iqvia_fid_plans_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1 AS
 SELECT iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
 WHERE (iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_code_ftf_hp_id_cdw_v1'::varchar(32)))))));

CREATE  VIEW sandbox.vw_prev_month_iqvia_plan_code_ftf_hp_id_cdw_v1 AS
 SELECT iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
 WHERE (iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_code_ftf_hp_id_cdw_v1'::varchar(32)))))));

CREATE  VIEW sandbox.vw_curr_ftf_plan_master_file_op_cdw_v1 AS
 SELECT ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_op_cdw_v1.product,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_op_cdw_v1.coverage_category,
        ftf_plan_master_file_op_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_op_cdw_v1.paytype,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_op_cdw_v1.plan_lives,
        ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_op_cdw_v1.key_controlling_account,
        ftf_plan_master_file_op_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_op_cdw_v1.payer_pbm,
        ftf_plan_master_file_op_cdw_v1.key_pbm,
        ftf_plan_master_file_op_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_op_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_op_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_op_cdw_v1.pharmacy_status,
        ftf_plan_master_file_op_cdw_v1.ftf_tier,
        ftf_plan_master_file_op_cdw_v1.restrictions,
        ftf_plan_master_file_op_cdw_v1.copay_tier,
        ftf_plan_master_file_op_cdw_v1.restriction_category,
        ftf_plan_master_file_op_cdw_v1.step,
        ftf_plan_master_file_op_cdw_v1.botox,
        ftf_plan_master_file_op_cdw_v1.prescriber_pa,
        ftf_plan_master_file_op_cdw_v1.patient_pa,
        ftf_plan_master_file_op_cdw_v1.medical_records,
        ftf_plan_master_file_op_cdw_v1.criteria_unspec,
        ftf_plan_master_file_op_cdw_v1.cycle_id,
        ftf_plan_master_file_op_cdw_v1.modified_time,
        ftf_plan_master_file_op_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_op_cdw_v1
 WHERE (ftf_plan_master_file_op_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_plan_master_file_op_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_key_ctl_account_summary_cdw_v1 AS
 SELECT key_ctl_account_summary_cdw_v1.paytype,
        key_ctl_account_summary_cdw_v1.ftf_health_plan_type,
        key_ctl_account_summary_cdw_v1.key_controlling_account,
        key_ctl_account_summary_cdw_v1.current_month_lives,
        key_ctl_account_summary_cdw_v1.previous_month_lives,
        key_ctl_account_summary_cdw_v1.cycle_id,
        key_ctl_account_summary_cdw_v1.modified_time,
        key_ctl_account_summary_cdw_v1.modified_by
 FROM sandbox.key_ctl_account_summary_cdw_v1
 WHERE (key_ctl_account_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_ctl_account_summary_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_key_pbm_summary_cdw_v1 AS
 SELECT key_pbm_summary_cdw_v1.paytype,
        key_pbm_summary_cdw_v1.ftf_health_plan_type,
        key_pbm_summary_cdw_v1.key_pbm,
        key_pbm_summary_cdw_v1.current_month_lives,
        key_pbm_summary_cdw_v1.previous_month_lives,
        key_pbm_summary_cdw_v1.cycle_id,
        key_pbm_summary_cdw_v1.modified_time,
        key_pbm_summary_cdw_v1.modified_by
 FROM sandbox.key_pbm_summary_cdw_v1
 WHERE (key_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_pbm_summary_cdw_v1'::varchar(22)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_name_summary_cdw_v1 AS
 SELECT iqvia_payer_name_summary_cdw_v1.paytype,
        iqvia_payer_name_summary_cdw_v1.iqvia_payer_name,
        iqvia_payer_name_summary_cdw_v1.current_month_lives,
        iqvia_payer_name_summary_cdw_v1.previous_month_lives,
        iqvia_payer_name_summary_cdw_v1.cycle_id,
        iqvia_payer_name_summary_cdw_v1.modified_time,
        iqvia_payer_name_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_payer_name_summary_cdw_v1
 WHERE (iqvia_payer_name_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_payer_name_summary_cdw_v1'::varchar(31)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formulary_management_pbm_summary_cdw_v1 AS
 SELECT ftf_formulary_management_pbm_summary_cdw_v1.paytype,
        ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm,
        ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_management_pbm_summary_cdw_v1
 WHERE (ftf_formulary_management_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formulary_management_pbm_summary_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1 AS
 SELECT ftf_formulary_influencer_pbm_summary_cdw_v1.paytype,
        ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_influencer_pbm_summary_cdw_v1
 WHERE (ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formulary_influencer_pbm_summary_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_ftf_claims_processing_pbm_summary_cdw_v1 AS
 SELECT ftf_claims_processing_pbm_summary_cdw_v1.paytype,
        ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm,
        ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.cycle_id,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_time,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_claims_processing_pbm_summary_cdw_v1
 WHERE (ftf_claims_processing_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_claims_processing_pbm_summary_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_st_lives_summary_cdw_v1 AS
 SELECT st_lives_summary_cdw_v1.ftf_health_plan_fid,
        st_lives_summary_cdw_v1.ftf_health_plan_name,
        st_lives_summary_cdw_v1.ftf_provider_name,
        st_lives_summary_cdw_v1.ftf_parent_name,
        st_lives_summary_cdw_v1.paytype,
        st_lives_summary_cdw_v1.ftf_health_plan_type,
        st_lives_summary_cdw_v1.key_controlling_account,
        st_lives_summary_cdw_v1.key_controlling_plan_formulary,
        st_lives_summary_cdw_v1.key_controlling_parent,
        st_lives_summary_cdw_v1.payer_pbm,
        st_lives_summary_cdw_v1.key_pbm,
        st_lives_summary_cdw_v1.iqvia_payer_name,
        st_lives_summary_cdw_v1.iqvia_pbm,
        st_lives_summary_cdw_v1.state,
        st_lives_summary_cdw_v1.ftf_state_hp_lives,
        st_lives_summary_cdw_v1.pref_brand_tier,
        st_lives_summary_cdw_v1.ajovy_formulary,
        st_lives_summary_cdw_v1.aimovig_formulary,
        st_lives_summary_cdw_v1.emgality_formulary,
        st_lives_summary_cdw_v1.cycle_id,
        st_lives_summary_cdw_v1.modified_time,
        st_lives_summary_cdw_v1.modified_by
 FROM sandbox.st_lives_summary_cdw_v1
 WHERE (st_lives_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'st_lives_summary_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hp_id_key_controlling_account_cdw_v1 AS
 SELECT ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_controlling_account_cdw_v1.payment_type,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent,
        ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.key_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.cycle_id,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_time,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_controlling_account_cdw_v1
 WHERE (ftf_hp_id_key_controlling_account_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hp_id_key_controlling_account_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hp_id_key_pbm_cdw_v1 AS
 SELECT ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_pbm_cdw_v1.payment_type,
        ftf_hp_id_key_pbm_cdw_v1.key_pbm,
        ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm,
        ftf_hp_id_key_pbm_cdw_v1.cycle_id,
        ftf_hp_id_key_pbm_cdw_v1.modified_time,
        ftf_hp_id_key_pbm_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_pbm_cdw_v1
 WHERE (ftf_hp_id_key_pbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hp_id_key_pbm_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_coverage_category_cdw_v1 AS
 SELECT paytype_product_coverage_category_cdw_v1.paytype,
        paytype_product_coverage_category_cdw_v1.product,
        paytype_product_coverage_category_cdw_v1.metric,
        paytype_product_coverage_category_cdw_v1.lives,
        paytype_product_coverage_category_cdw_v1.cycle_id,
        paytype_product_coverage_category_cdw_v1.modified_time,
        paytype_product_coverage_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_coverage_category_cdw_v1
 WHERE (paytype_product_coverage_category_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_coverage_category_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_copay_tier_cdw_v1 AS
 SELECT paytype_product_copay_tier_cdw_v1.paytype,
        paytype_product_copay_tier_cdw_v1.product,
        paytype_product_copay_tier_cdw_v1.metric,
        paytype_product_copay_tier_cdw_v1.lives,
        paytype_product_copay_tier_cdw_v1.cycle_id,
        paytype_product_copay_tier_cdw_v1.modified_time,
        paytype_product_copay_tier_cdw_v1.modified_by
 FROM sandbox.paytype_product_copay_tier_cdw_v1
 WHERE (paytype_product_copay_tier_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_copay_tier_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_step_category_cdw_v1 AS
 SELECT paytype_product_step_category_cdw_v1.paytype,
        paytype_product_step_category_cdw_v1.product,
        paytype_product_step_category_cdw_v1.metric,
        paytype_product_step_category_cdw_v1.lives,
        paytype_product_step_category_cdw_v1.cycle_id,
        paytype_product_step_category_cdw_v1.modified_time,
        paytype_product_step_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_step_category_cdw_v1
 WHERE (paytype_product_step_category_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_step_category_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_patient_pa_cdw_v1 AS
 SELECT paytype_product_patient_pa_cdw_v1.paytype,
        paytype_product_patient_pa_cdw_v1.product,
        paytype_product_patient_pa_cdw_v1.metric,
        paytype_product_patient_pa_cdw_v1.lives,
        paytype_product_patient_pa_cdw_v1.cycle_id,
        paytype_product_patient_pa_cdw_v1.modified_time,
        paytype_product_patient_pa_cdw_v1.modified_by
 FROM sandbox.paytype_product_patient_pa_cdw_v1
 WHERE (paytype_product_patient_pa_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_patient_pa_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1 AS
 SELECT key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account,
        key_controlling_account_product_cov_category_paytype_cdw_v1.paytype,
        key_controlling_account_product_cov_category_paytype_cdw_v1.product,
        key_controlling_account_product_cov_category_paytype_cdw_v1.metric,
        key_controlling_account_product_cov_category_paytype_cdw_v1.lives,
        key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_time,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_controlling_account_product_cov_category_paytype_cdw_v1
 WHERE (key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_controlling_account_product_cov_category_paytype_cdw_v1'::varchar(59)))))));

CREATE  VIEW sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1 AS
 SELECT key_pbm_product_cov_category_paytype_cdw_v1.key_pbm,
        key_pbm_product_cov_category_paytype_cdw_v1.paytype,
        key_pbm_product_cov_category_paytype_cdw_v1.product,
        key_pbm_product_cov_category_paytype_cdw_v1.metric,
        key_pbm_product_cov_category_paytype_cdw_v1.lives,
        key_pbm_product_cov_category_paytype_cdw_v1.cycle_id,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_time,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_pbm_product_cov_category_paytype_cdw_v1
 WHERE (key_pbm_product_cov_category_paytype_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_pbm_product_cov_category_paytype_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_pbm_summary_cdw_v1 AS
 SELECT iqvia_pbm_summary_cdw_v1.paytype,
        iqvia_pbm_summary_cdw_v1.iqvia_pbm,
        iqvia_pbm_summary_cdw_v1.current_month_lives,
        iqvia_pbm_summary_cdw_v1.previous_month_lives,
        iqvia_pbm_summary_cdw_v1.cycle_id,
        iqvia_pbm_summary_cdw_v1.modified_time,
        iqvia_pbm_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_summary_cdw_v1
 WHERE (iqvia_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_pbm_summary_cdw_v1'::varchar(24)))))));

CREATE  VIEW outbound.zs_xpo_xpopt_SABA_LABA_monthly AS
 SELECT prescriber_rx.ims_id,
        prescriber_rx.tvcmid,
        prescriber_rx.prescriber_first_name,
        prescriber_rx.prescriber_last_name,
        prescriber_rx.sales_category,
        prescriber_rx.market_name,
        prescriber_rx.basket_id,
        prescriber_rx.basket_name,
        prescriber_rx.basket_type,
        prescriber_rx.model,
        prescriber_rx.ims_rx_type,
        prescriber_rx.ims_supplemental_data,
        prescriber_rx.ims_zip_other,
        prescriber_rx.indication,
        prescriber_rx.data_date,
        prescriber_rx.date,
        prescriber_rx.rollup_flag,
        prescriber_rx.rollup_week,
        prescriber_rx.rollup_month,
        prescriber_rx.report_frequency,
        prescriber_rx.plan_name,
        prescriber_rx.payer_name,
        prescriber_rx.payer_plan_number,
        prescriber_rx.payment_method,
        prescriber_rx.pbm_name,
        prescriber_rx.pbm_parent_name,
        prescriber_rx.nrx_count,
        prescriber_rx.trx_count,
        prescriber_rx.nrx_quantity,
        prescriber_rx.trx_quantity,
        prescriber_rx.unnormalized_nrx_count,
        prescriber_rx.unnormalized_trx_count
 FROM datamart.prescriber_rx
 WHERE ((prescriber_rx.report_frequency = 'MONTH'::varchar(5)) AND (prescriber_rx.market_name = ANY (ARRAY['SABA MARKET TOTAL'::varchar(17), 'LABA MARKET TOTAL'::varchar(17)])))
 GROUP BY prescriber_rx.ims_id,
          prescriber_rx.tvcmid,
          prescriber_rx.prescriber_first_name,
          prescriber_rx.prescriber_last_name,
          prescriber_rx.sales_category,
          prescriber_rx.market_name,
          prescriber_rx.basket_id,
          prescriber_rx.basket_name,
          prescriber_rx.basket_type,
          prescriber_rx.model,
          prescriber_rx.ims_rx_type,
          prescriber_rx.ims_supplemental_data,
          prescriber_rx.ims_zip_other,
          prescriber_rx.indication,
          prescriber_rx.data_date,
          prescriber_rx.date,
          prescriber_rx.rollup_flag,
          prescriber_rx.rollup_week,
          prescriber_rx.rollup_month,
          prescriber_rx.report_frequency,
          prescriber_rx.plan_name,
          prescriber_rx.payer_name,
          prescriber_rx.payer_plan_number,
          prescriber_rx.payment_method,
          prescriber_rx.pbm_name,
          prescriber_rx.pbm_parent_name,
          prescriber_rx.nrx_count,
          prescriber_rx.trx_count,
          prescriber_rx.nrx_quantity,
          prescriber_rx.trx_quantity,
          prescriber_rx.unnormalized_nrx_count,
          prescriber_rx.unnormalized_trx_count;

CREATE  VIEW sandbox.vw_ftf_delta_report AS
 SELECT a.ftf_health_plan_fid AS "FTF Health Plan FID",
        a.ftf_health_plan_name AS "FTF Health Plan Name",
        a.ftf_provider_fid AS "FTF Provider FID",
        a.ftf_provider_name AS "FTF Provider Name",
        a.ftf_parent_name AS "FTF Parent Name",
        a.paytype AS "Pay Type",
        a.ftf_health_plan_type AS "FTF Health Plan Type",
        a.key_controlling_account AS "Key Controlling Account",
        a.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        a.key_controlling_parent AS "Key Controlling Parent",
        a.payer_pbm AS "Payer/PBM",
        a.key_pbm AS "Key PBM",
        a.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        a.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        a.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        a.lives_mn AS Lives,
        a.iqvia_payer_name AS "IQVIA Payer Name best matched to FTF Plan",
        a.iqvia_pbm AS "IQVIA PBM best matched to FTF Plan",
        a.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        a.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        a.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        a.pref_brand_tier AS "Pref Brand Tier",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan FID Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider FID Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Parent Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pay Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payer/PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Management PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Influencer PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Claims Processing PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Lives Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name best matched to FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM best matched to FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Ajovy Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Aimovig Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Emgality Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pref Brand Tier Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        a.month_flag AS "Month Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        a.change_in_lives AS "Change in Lives",
        tbl_lvl_audit.date_run,
        (to_timestamptz((a.cycle_id)::float))::timestamp AS modified_time
 FROM (sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1 a LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_ftf_health_plan_fid_cdw_v1'::varchar(37))))
 GROUP BY a.ftf_health_plan_fid,
          a.ftf_health_plan_name,
          a.ftf_provider_fid,
          a.ftf_provider_name,
          a.ftf_parent_name,
          a.paytype,
          a.ftf_health_plan_type,
          a.key_controlling_account,
          a.key_controlling_plan_formulary,
          a.key_controlling_parent,
          a.payer_pbm,
          a.key_pbm,
          a.ftf_formulary_management_pbm,
          a.ftf_formulary_influencer_pbm,
          a.ftf_claims_processing_pbm,
          a.lives_mn,
          a.iqvia_payer_name,
          a.iqvia_pbm,
          a.Coverage_Category_Ajovy,
          a.Coverage_Category_Aimovig,
          a.Coverage_Category_Emgality,
          a.pref_brand_tier,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END,
          a.month_flag,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END,
          a.change_in_lives,
          tbl_lvl_audit.date_run,
          (to_timestamptz((a.cycle_id)::float))::timestamp
 ORDER BY a.ftf_health_plan_fid;

CREATE  VIEW sandbox.vw_curr_payer_spine25_plan_teva_brands_cdw_v1 AS
 SELECT payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_plan_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.payment_type,
        payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_plan_teva_brands_cdw_v1.saba_trx
 FROM sandbox.payer_spine25_plan_teva_brands_cdw_v1
 WHERE (payer_spine25_plan_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_plan_teva_brands_cdw_v1'::varchar(37)))))));

CREATE  VIEW sandbox.access_granularity_ftf AS
 SELECT vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        count(DISTINCT vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid) AS "FTF Health Plan FID",
        vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_pivot_plan_prod_master_cdw_v1.paytype AS "Pay Type",
        sum(vw_curr_pivot_plan_prod_master_cdw_v1.lives_mn) AS Lives
 FROM sandbox.vw_curr_pivot_plan_prod_master_cdw_v1
 GROUP BY vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality,
          vw_curr_pivot_plan_prod_master_cdw_v1.paytype,
          vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_type,
          vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_account;

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.restriction_code,
        a.restriction_detail_id,
        a.restriction_detail_text,
        a.restriction_addtnl_information_1,
        a.restriction_addtnl_information_2,
        a.step_count,
        a.pa_form,
        a.indication,
        a.grouped_restriction_level
 FROM (sandbox.vw_curr_month_ftf_restrictions_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.restriction_code,
        a.restriction_detail_id,
        a.restriction_detail_text,
        a.restriction_addtnl_information_1,
        a.restriction_addtnl_information_2,
        a.step_count,
        a.pa_form,
        a.indication,
        a.grouped_restriction_level
 FROM (sandbox.vw_prev_month_ftf_restrictions_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.tier_code,
        a.restrictions,
        a.reason_code,
        a.reason_code_description,
        a.pharmacy_status
 FROM (sandbox.vw_curr_month_ftf_formularies_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.tier_code,
        a.restrictions,
        a.reason_code,
        a.reason_code_description,
        a.pharmacy_status
 FROM (sandbox.vw_prev_month_ftf_formularies_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW payerspine.vw_final_extract_key_controlling_account_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_key_controlling_account_product_coverage_category_commercial AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW payerspine.vw_final_extract_key_pbm_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_key_pbm_product_coverage_category_commercial AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW payerspine.vw_final_extract_pay_type_product_copay_tier AS
 SELECT vw_curr_paytype_product_copay_tier_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_copay_tier_cdw_v1.product AS Product,
        vw_curr_paytype_product_copay_tier_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_copay_tier_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_copay_tier_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_pay_type_product_coverage_category AS
 SELECT vw_curr_paytype_product_coverage_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_coverage_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_coverage_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_coverage_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_coverage_category_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_pay_type_product_patient_pa AS
 SELECT vw_curr_paytype_product_patient_pa_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_patient_pa_cdw_v1.product AS Product,
        vw_curr_paytype_product_patient_pa_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_patient_pa_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_patient_pa_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_pay_type_product_step_edit_type AS
 SELECT vw_curr_paytype_product_step_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_step_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_step_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_step_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_step_category_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ftf_hp_id_key_controlling_plan_account AS
 SELECT lpad((vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm AS "Payer/PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_controlling_account_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ftf_hp_id_key_pbm AS
 SELECT lpad((vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm AS "Assigned IQVIA PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_pbm_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_iqvia_plan_code_ftf_hp_id AS
 SELECT lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type AS "Payment Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model AS "IQVIA Model",
        lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan AS "Ajovy Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan AS "Aimovig Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan AS "Emgality Access For FTF Plan",
        (vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan)::varchar AS "Total Lives For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm AS "Key PBM"
 FROM sandbox.vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1 UNION  SELECT '0000010001'::varchar(10) AS "IQVIA Plan Code",
        'CASH'::varchar(4) AS "IQVIA Plan Name",
        'CASH'::varchar(4) AS "IQVIA Payer Name",
        ''::varchar AS "IQVIA PBM",
        'CASH'::varchar(4) AS "Payment Type",
        ''::varchar AS "IQVIA Model",
        ''::varchar AS "FTF Health Plan FID",
        ''::varchar AS "FTF Health Plan Name",
        ''::varchar AS "FTF Health Plan Type",
        ''::varchar AS "Key Controlling Plan Formulary",
        ''::varchar AS "Key Controlling Account",
        ''::varchar AS "Key Controlling Parent",
        ''::varchar AS "Payer/PBM",
        ''::varchar AS "Ajovy Access For FTF Plan",
        ''::varchar AS "Aimovig Access For FTF Plan",
        ''::varchar AS "Emgality Access For FTF Plan",
        ''::varchar AS "Total Lives For FTF Plan",
        ''::varchar AS "Key PBM"
 FROM v_catalog.dual;

CREATE  VIEW payerspine.vw_final_extract_ftf_plan_master_file AS
 SELECT lpad((vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_plan_master_file_op_cdw_v1.product AS Product,
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.coverage_category AS "Coverage Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.plan_lives AS "Plan Lives",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_plan_master_file_op_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pharmacy_status AS "Pharmacy Status",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_tier AS "FTF Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restrictions AS Restrictions,
        vw_curr_ftf_plan_master_file_op_cdw_v1.copay_tier AS "Tier Cat",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restriction_category AS "Restriction Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.step AS Step,
        vw_curr_ftf_plan_master_file_op_cdw_v1.botox AS Botox,
        vw_curr_ftf_plan_master_file_op_cdw_v1.prescriber_pa AS "Prescriber PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.patient_pa AS "Patient PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.medical_records AS "Medical Records",
        vw_curr_ftf_plan_master_file_op_cdw_v1.criteria_unspec AS "Criteria Unspec"
 FROM sandbox.vw_curr_ftf_plan_master_file_op_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_key_controlling_account_summary AS
 SELECT vw_curr_key_ctl_account_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_ctl_account_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_ctl_account_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_ctl_account_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_ctl_account_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_ctl_account_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_key_pbm_summary AS
 SELECT vw_curr_key_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_pbm_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_pbm_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_iqvia_player_summary AS
 SELECT vw_curr_iqvia_payer_name_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_payer_name_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_iqvia_payer_name_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_payer_name_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_payer_name_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_iqvia_pbm_summary AS
 SELECT vw_curr_iqvia_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_pbm_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_iqvia_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_pbm_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_mgt_summary AS
 SELECT vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_management_pbm_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_infl_summary AS
 SELECT vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_ftf_pbm_claims_proc_summary AS
 SELECT vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_claims_processing_pbm_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_ftf_health_plan_detail AS
 SELECT lpad((vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_ajovy AS "Coverage Category Ajovy",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_aimovig AS "Coverage Category Aimovig",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_emgality AS "Coverage Category Emgality",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_access_master_bridge_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_access_master_bridge_cdw_v1.paytype AS "Payment Type",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_access_master_bridge_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_access_master_bridge_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_access_master_bridge_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_match_iqvia AS "FTF Match IQVIA",
        vw_curr_access_master_bridge_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_access_master_bridge_cdw_v1.previous_lives AS "Previous Month Lives",
        vw_curr_access_master_bridge_cdw_v1.current_lives AS "Current Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_access_master_bridge_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_cm_state_lives_formular_status AS
 SELECT lpad((vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_st_lives_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_st_lives_summary_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_st_lives_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_st_lives_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.state AS State,
        vw_curr_st_lives_summary_cdw_v1.ftf_state_hp_lives AS "FTF State HP Lives",
        vw_curr_st_lives_summary_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_st_lives_summary_cdw_v1.ajovy_formulary AS "Ajovy Formulary",
        vw_curr_st_lives_summary_cdw_v1.aimovig_formulary AS "Aimovig Formulary",
        vw_curr_st_lives_summary_cdw_v1.emgality_formulary AS "Emgality Formulary"
 FROM sandbox.vw_curr_st_lives_summary_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_ajovy_migraine_market_all_changes AS
 SELECT lpad((vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy AS "Coverage Category Ajovy",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig AS "Coverage Category Aimovig",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality AS "Coverage Category Emgality",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.paytype AS "Payment Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.lives_mn AS Lives,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.month_flag AS "Month Flag",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.status AS Status,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.change_in_lives AS "Change in Lives"
 FROM sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_payer_spine25_detailed_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_detailed_teva_brands_cdw_v1;

CREATE  VIEW payerspine.vw_final_extract_payer_spine25_plan_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_plan_teva_brands_cdw_v1;

CREATE  VIEW reporting.fcr_summary AS
 SELECT a.rsm_name,
        a.rsm_title,
        a.region_number,
        a.rsm_email,
        a.sales_rep_name,
        a.sales_rep_title,
        a.territory_number,
        a.sales_rep_email,
        a.fcr_date,
        a.report_status_vod__c
 FROM ( SELECT CASE WHEN (u.isactive = 'false'::varchar(5)) THEN (u.name || ' (inactive)'::varchar(11)) ELSE u.name END AS rsm_name,
        u.title AS rsm_title,
        t21.Name AS region_number,
        u.email AS rsm_email,
        CASE WHEN (a.isactive = 'false'::varchar(5)) THEN (a.name || ' (inactive)'::varchar(11)) ELSE a.name END AS sales_rep_name,
        a.title AS sales_rep_title,
        CASE WHEN (t22.Name IS NULL) THEN 'NA'::varchar(2) ELSE t22.Name END AS territory_number,
        a.email AS sales_rep_email,
        st.review_date_vod__c AS fcr_date,
        st.report_status_vod__c
 FROM (((((((veeva.v_survey s JOIN ( SELECT x.id,
        x.lastmodifieddate,
        x.survey_vod__c,
        x.employee_vod__c,
        x.coach_vod__c,
        x.review_date_vod__c,
        x.report_status_vod__c
 FROM ( SELECT v_survey_target.id,
        v_survey_target.lastmodifieddate,
        v_survey_target.survey_vod__c,
        v_survey_target.Employee_vod__c AS employee_vod__c,
        v_survey_target.coach_vod__c,
        v_survey_target.Review_date_vod__c AS review_date_vod__c,
        v_survey_target.report_status_vod__c,
        rank() OVER (PARTITION BY v_survey_target.Employee_vod__c, v_survey_target.Review_date_vod__c ORDER BY v_survey_target.lastmodifieddate DESC) AS ranker
 FROM veeva.v_survey_target) x
 WHERE (x.ranker = 1)) st ON ((s.id = st.survey_vod__c))) JOIN veeva.v_veeva_user a ON ((st.employee_vod__c = a.id))) JOIN veeva.v_veeva_user u ON ((st.coach_vod__c = u.id))) JOIN veeva.userterritory2association uta1 ON ((st.coach_vod__c = uta1.UserId))) JOIN veeva.territory2 t21 ON ((uta1.Territory2Id = t21.Id))) LEFT  JOIN veeva.userterritory2association uta2 ON (((st.employee_vod__c = uta2.UserId) AND (uta1.file_id = uta2.file_id)))) LEFT  JOIN veeva.territory2 t22 ON (((uta2.Territory2Id = t22.Id) AND (t21.file_id = t22.file_id))))
 WHERE ((s.name = 'Field Coaching Report'::varchar(21)) AND (uta1.file_id IN ( SELECT max(userterritory2association.file_id) AS max
 FROM veeva.userterritory2association)) AND (t21.file_id IN ( SELECT max(territory2.file_id) AS max
 FROM veeva.territory2)) AND (st.review_date_vod__c >= '2021-01-01'::date) AND (substr(t21.Name, 1, 2) = ANY (ARRAY['TR'::varchar(2), 'TP'::varchar(2), 'TN'::varchar(2)])))) a
 WHERE (substr(a.territory_number, 7, 2) <> '99'::varchar(2))
 GROUP BY a.rsm_name,
          a.rsm_title,
          a.region_number,
          a.rsm_email,
          a.sales_rep_name,
          a.sales_rep_title,
          a.territory_number,
          a.sales_rep_email,
          a.fcr_date,
          a.report_status_vod__c;

CREATE  VIEW outbound.v_ob_ahm_employee_assignments AS
 SELECT r.employee_id AS EmployeeId,
        r.territory_number AS OrganizationUnitId,
        'Primary'::varchar(7) AS AssignmentPosition,
        CASE WHEN (r.sales_force_id = 'TE'::varchar(2)) THEN 'TPS'::varchar(3) ELSE r.sales_force_id END AS ProductCatalogId,
        coalesce(th.start_date, NULL::date) AS EffectiveDate,
        CASE WHEN (th.end_date = '2099-12-31'::date) THEN '2040-12-31'::date ELSE coalesce(th.end_date, NULL::date) END AS EndDate,
        CASE WHEN (th.end_date = '2099-12-31'::date) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END AS Status
 FROM (datamart.roster r LEFT  JOIN datamart.territory_history th ON (((r.employee_id = th.employee_id) AND (th.source_id IS NOT NULL))))
 WHERE ((r.employee_id IS NOT NULL) AND (r.rep_type <> 'VP'::varchar(2)) AND (r.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND ((th.end_date = '2099-12-31'::date) OR (th.end_date IS NULL)))
 GROUP BY r.employee_id,
          r.territory_number,
          'Primary'::varchar(7),
          CASE WHEN (r.sales_force_id = 'TE'::varchar(2)) THEN 'TPS'::varchar(3) ELSE r.sales_force_id END,
          coalesce(th.start_date, NULL::date),
          CASE WHEN (th.end_date = '2099-12-31'::date) THEN '2040-12-31'::date ELSE coalesce(th.end_date, NULL::date) END,
          CASE WHEN (th.end_date = '2099-12-31'::date) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END UNION  SELECT r.employee_id AS EmployeeId,
        r.territory_number AS OrganizationUnitId,
        'Primary'::varchar(7) AS AssignmentPosition,
        CASE WHEN (r.sales_force_id = 'TE'::varchar(2)) THEN 'TPS'::varchar(3) ELSE r.sales_force_id END AS ProductCatalogId,
        coalesce(th.start_date, NULL::date) AS EffectiveDate,
        CASE WHEN (th.end_date = '2099-12-31'::date) THEN '2040-12-31'::date ELSE coalesce(th.end_date, NULL::date) END AS EndDate,
        CASE WHEN (th.end_date = '2099-12-31'::date) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END AS Status
 FROM (datamart.roster r LEFT  JOIN datamart.territory_history th ON (((r.employee_id = th.employee_id) AND (th.source_id IS NOT NULL))))
 WHERE ((r.territory_number = 'TRZZZZ00'::varchar(8)) AND ((th.end_date = '2099-12-31'::date) OR (th.end_date IS NULL)))
 GROUP BY r.employee_id,
          r.territory_number,
          'Primary'::varchar(7),
          CASE WHEN (r.sales_force_id = 'TE'::varchar(2)) THEN 'TPS'::varchar(3) ELSE r.sales_force_id END,
          coalesce(th.start_date, NULL::date),
          CASE WHEN (th.end_date = '2099-12-31'::date) THEN '2040-12-31'::date ELSE coalesce(th.end_date, NULL::date) END,
          CASE WHEN (th.end_date = '2099-12-31'::date) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END;

CREATE  VIEW public.session_ratios AS
 SELECT sum(s_ratios.max_sessions) AS mx,
        sum(s_ratios.total_sessions) AS ts,
        sum(s_ratios.dead_sessions) AS ds,
        ((sum(s_ratios.dead_sessions) / sum(s_ratios.total_sessions)))::numeric(18,4) AS dead_ratio,
        ((sum(s_ratios.total_sessions) / sum(s_ratios.max_sessions)))::numeric(18,4) AS max_ratio
 FROM (( SELECT (configuration_parameters.current_value)::int AS max_sessions,
        0 AS total_sessions,
        0 AS dead_sessions
 FROM v_monitor.configuration_parameters
 WHERE (configuration_parameters.parameter_name = 'MaxClientSessions'::varchar(17)) UNION  SELECT 0 AS max_sessions,
        count(*) AS total_sessions,
        0 AS dead_sessions
 FROM v_monitor.sessions) UNION  SELECT 0,
        0 AS "?column?2",
        count(*) AS dead_sessions
 FROM v_monitor.sessions
 WHERE ((sessions.statement_id IS NULL) AND ((((statement_timestamp())::timestamp - sessions.transaction_start)) > '02:00'::interval))) s_ratios;

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw_v2 AS
 SELECT (replace(replace(btrim(ftf_formularies.health_plan_id), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(ftf_formularies.drug_id), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(ftf_formularies.tier_code), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(ftf_formularies.restrictions), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(ftf_formularies.reason_code), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(ftf_formularies.reason_code_description), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(ftf_formularies.pharmacy_status), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS pharmacy_status,
        ftf_formularies.Market_Access_Coverage
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW teva_ingestion.EXT_VV_REP_ROSTER_VOD__C AS
 SELECT btrim(EXT_VV_REP_ROSTER_VOD__C_src.id) AS id,
        CASE WHEN (EXT_VV_REP_ROSTER_VOD__C_src.createddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_REP_ROSTER_VOD__C_src.createddate))::timestamp END AS createddate,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.createdbyid) AS createdbyid,
        CASE WHEN (EXT_VV_REP_ROSTER_VOD__C_src.lastmodifieddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_REP_ROSTER_VOD__C_src.lastmodifieddate))::timestamp END AS lastmodifieddate,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.lastmodifiedbyid) AS lastmodifiedbyid,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ownerid) AS ownerid,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.isdeleted) AS isdeleted,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.name) AS name,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.systemmodstamp) AS systemmodstamp,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.mayedit) AS mayedit,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.islocked) AS islocked,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.territory_vod__c) AS territory_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.address_line_1_vod__c) AS address_line_1_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.address_line_2_vod__c) AS address_line_2_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.address_line_3_tva__c) AS address_line_3_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.city_vod__c) AS city_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.state_vod__c) AS state_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.zip_vod__c) AS zip_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.computer_asset_tag__c) AS computer_asset_tag__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.fax_number__c) AS fax_number__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.home_phone__c) AS home_phone__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.mobile_number__c) AS mobile_number__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.organization_id__c) AS organization_id__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.rep_type_tva__c) AS rep_type_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.sampleflag_tva__c) AS sampleflag_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_addr1_tva__c) AS ship_addr1_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_addr2_tva__c) AS ship_addr2_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_addr3_tva__c) AS ship_addr3_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_city_tva__c) AS ship_city_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_state_tva__c) AS ship_state_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.ship_zip_tva__c) AS ship_zip_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_addr1_tva__c) AS store_addr1_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_addr2_tva__c) AS store_addr2_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_addr3_tva__c) AS store_addr3_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_city_tva__c) AS store_city_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_state_tva__c) AS store_state_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.store_zip_tva__c) AS store_zip_tva__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.username_external_id_vod__c) AS username_external_id_vod__c,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.vin__c) AS vin__c,
        CASE WHEN (EXT_VV_REP_ROSTER_VOD__C_src.lastvieweddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_REP_ROSTER_VOD__C_src.lastvieweddate))::timestamp END AS lastvieweddate,
        CASE WHEN (EXT_VV_REP_ROSTER_VOD__C_src.lastreferenceddate = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_VV_REP_ROSTER_VOD__C_src.lastreferenceddate))::timestamp END AS lastreferenceddate,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.useremail) AS useremail,
        btrim(EXT_VV_REP_ROSTER_VOD__C_src.local_employee_id__c) AS local_employee_id__c,
        EXT_VV_REP_ROSTER_VOD__C_src.batch_id,
        EXT_VV_REP_ROSTER_VOD__C_src.row_id,
        EXT_VV_REP_ROSTER_VOD__C_src.update_ts
 FROM teva_ingestion.EXT_VV_REP_ROSTER_VOD__C_src;

CREATE  VIEW raw.EXT_VV_REP_ROSTER_VOD__C AS
 SELECT src.id,
        src.createddate,
        src.createdbyid,
        src.lastmodifieddate,
        src.lastmodifiedbyid,
        src.ownerid,
        src.isdeleted,
        src.name,
        src.systemmodstamp,
        src.mayedit,
        src.islocked,
        src.territory_vod__c,
        src.address_line_1_vod__c,
        src.address_line_2_vod__c,
        src.address_line_3_tva__c,
        src.city_vod__c,
        src.state_vod__c,
        src.zip_vod__c,
        src.computer_asset_tag__c,
        src.fax_number__c,
        src.home_phone__c,
        src.mobile_number__c,
        src.organization_id__c,
        src.rep_type_tva__c,
        src.sampleflag_tva__c,
        src.ship_addr1_tva__c,
        src.ship_addr2_tva__c,
        src.ship_addr3_tva__c,
        src.ship_city_tva__c,
        src.ship_state_tva__c,
        src.ship_zip_tva__c,
        src.store_addr1_tva__c,
        src.store_addr2_tva__c,
        src.store_addr3_tva__c,
        src.store_city_tva__c,
        src.store_state_tva__c,
        src.store_zip_tva__c,
        src.username_external_id_vod__c,
        src.vin__c,
        src.lastvieweddate,
        src.lastreferenceddate,
        src.useremail,
        src.local_employee_id__c,
        src.row_id AS record_id,
        ctl.unique_file_id AS file_id
 FROM (teva_ingestion.EXT_VV_REP_ROSTER_VOD__C_src src JOIN teva_ingestion.teva_ingestion_control ctl ON (((ctl.batch_id = src.batch_id) AND (ctl.file_class = 'EXT_VV_REP_ROSTER_VOD__C'::varchar(24)))));

CREATE  VIEW WSMP_ADMIN_ORA.ext_asi_copay_detail_wkly AS
( SELECT EXT_ASI_COPAY_DETAIL_WKLY.TRANS_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY.ORIG_ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY.RX_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.RX_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY.DATE_WRITTEN,
        EXT_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY,
        EXT_ASI_COPAY_DETAIL_WKLY.NDC_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY.DAW,
        EXT_ASI_COPAY_DETAIL_WKLY.DRUG_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY.DRUG_DESC,
        EXT_ASI_COPAY_DETAIL_WKLY.NEW_REFILL,
        EXT_ASI_COPAY_DETAIL_WKLY.QUANTITY,
        EXT_ASI_COPAY_DETAIL_WKLY.REFILLS,
        EXT_ASI_COPAY_DETAIL_WKLY.OTHER_COVERAGE_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY.GROUP_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.COUPON_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.SEX,
        EXT_ASI_COPAY_DETAIL_WKLY.AGE_AT_REDEMPTION,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_PROCESS_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.NABP,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_PHONE,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_DEA_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY.PHYS_NPI,
        EXT_ASI_COPAY_DETAIL_WKLY.PHYSICIAN_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS1,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT,
        EXT_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE,
        EXT_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST,
        EXT_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE,
        EXT_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE,
        EXT_ASI_COPAY_DETAIL_WKLY.CALC_AWP,
        EXT_ASI_COPAY_DETAIL_WKLY.CREATE_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY.OCC_PAYMENT_TYPE
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY UNION ALL  SELECT EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.TRANS_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ORIG_ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.RX_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.RX_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.DATE_WRITTEN,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.DAYS_SUPPLY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.NDC_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.DAW,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.DRUG_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.DRUG_DESC,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.NEW_REFILL,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.QUANTITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.REFILLS,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.OTHER_COVERAGE_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.GROUP_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.COUPON_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.SEX,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.AGE_AT_REDEMPTION,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_PROCESS_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_CHAIN_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.NABP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_CHAIN,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_ADDRESS,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_PHONE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_NPI_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PRINCIPLE_PHYS_DEA_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHYS_NPI,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHYSICIAN_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_PHYS_ADDRESS1,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_PHYS_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_PHYS_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_PHYS_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.ASI_PHYS_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.REBATE_AMOUNT,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.MEMBER_CASH_EXPENSE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.SUBMITTED_COST,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.PHARMACY_FEE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.TOTAL_AMOUNT_DUE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.CALC_AWP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.CREATE_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2.OCC_PAYMENT_TYPE
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_2) UNION ALL  SELECT EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.TRANS_TYPE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ORIG_ASI_TXN_ID,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.RX_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.RX_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.DATE_WRITTEN,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.DAYS_SUPPLY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.NDC_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.DAW,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.DRUG_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.DRUG_DESC,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.NEW_REFILL,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.QUANTITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.REFILLS,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.OTHER_COVERAGE_CODE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.GROUP_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.COUPON_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.SEX,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.AGE_AT_REDEMPTION,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_PROCESS_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_CHAIN_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.NABP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_CHAIN,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_ADDRESS,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_PHONE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_NPI_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PRINCIPLE_PHYS_DEA_NUM,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHYS_NPI,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHYSICIAN_NAME,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_PHYS_ADDRESS1,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_PHYS_ADDRESS2,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_PHYS_CITY,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_PHYS_STATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.ASI_PHYS_ZIP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.REBATE_AMOUNT,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.MEMBER_CASH_EXPENSE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.SUBMITTED_COST,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.PHARMACY_FEE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.TOTAL_AMOUNT_DUE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.CALC_AWP,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.CREATE_DATE,
        EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3.OCC_PAYMENT_TYPE
 FROM teva_ingestion.EXT_ASI_COPAY_DETAIL_WKLY_COMBO_3;

CREATE  VIEW WSMP_ADMIN_ORA.ims_pdrp AS
 SELECT d.IMS_PRESCRIBER_ID AS ims_id,
        d.LAST_NAME AS last_name,
        d.FIRST_NAME AS first_name,
        d.MIDDLE_NAME AS middle_name,
        d.SUFFIX AS suffix,
        f.EFFECTIVE_DATE AS pdrp_date
 FROM (teva_ingestion.C_BO_IMS_FLAG f JOIN teva_ingestion.C_BO_HCP_DETAIL d ON ((f.HCP_DETAIL_ID = d.ROWID_OBJECT)))
 WHERE ((f.FLAG_TYPE = 'PDRP'::varchar(4)) AND (f.FLAG_VALUE = 'Y'::varchar(1)) AND (d.HUB_STATE_IND = 1) AND (d.CONSOLIDATION_IND = 2));

CREATE  VIEW WSMP_ADMIN_ORA.ims_ama_no_contact AS
 SELECT d.IMS_PRESCRIBER_ID AS ims_id,
        d.LAST_NAME AS last_name,
        d.FIRST_NAME AS first_name,
        d.MIDDLE_NAME AS middle_name,
        d.SUFFIX AS suffix,
        f.EFFECTIVE_DATE AS effective_date
 FROM (teva_ingestion.C_BO_IMS_FLAG f JOIN teva_ingestion.C_BO_HCP_DETAIL d ON ((f.HCP_DETAIL_ID = d.ROWID_OBJECT)))
 WHERE ((f.FLAG_TYPE = 'AMADNC'::varchar(6)) AND (f.FLAG_VALUE = 'Y'::varchar(1)) AND (d.HUB_STATE_IND = 1) AND (d.CONSOLIDATION_IND = 2));

CREATE  VIEW sfa_history.v_siebel_calls AS
 SELECT rep_p.X_SALES_FORCE AS sales_force_id,
        ea.PAR_EVT_ID AS par_evt_id,
        ea.ROW_ID AS csf_call_id,
        ea.TARGET_PER_ID AS csf_demo_id,
        'PROF'::varchar(4) AS legacy_call_type,
        ea.NAME AS name_on_call,
        ea.ZIPCODE AS zip_on_call,
        ea.SUBTYPE_CD AS subtype_cd,
        ea.TODO_CD AS todo_cd,
        ea.INTEGRATION_ID AS integration_id,
        ea.ROW_ID AS sfa_history_evt_act_row_id,
        ea.TARGET_PER_ID AS siebel_target_per_id,
        d.ims_id,
        d.cm_id,
        d.me_num,
        ca.DEA_NUM AS dea_num,
        emp.CSN AS rep_id,
        rep_p.NAME AS territory_num,
        trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date,
        details.first_detailed_product_id,
        details.first_detailed_product,
        details.second_detailed_product_id,
        details.second_detailed_product,
        details.third_detailed_product_id,
        details.third_detailed_product,
        details.fourth_detailed_product_id,
        details.fourth_detailed_product,
        details.fifth_detailed_product_id,
        details.fifth_detailed_product,
        details.sixth_detailed_product_id,
        details.sixth_detailed_product,
        CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id
 FROM (((((((sfa_history.s_evt_act ea JOIN sfa_history.s_contact c ON ((c.ROW_ID = ea.TARGET_PER_ID))) LEFT  JOIN sfa_history.s_contact_x x ON ((x.ROW_ID = c.ROW_ID))) JOIN sfa_history.s_postn rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT  JOIN sfa_history.s_contact emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT  JOIN ( SELECT iq.ims_id,
        iq.cm_id,
        iq.me_num,
        iq.sfa_history_contact_row_id,
        iq.rnk
 FROM ( SELECT v_siebel_demo.ims_id,
        v_siebel_demo.cm_id,
        v_siebel_demo.me_num,
        v_siebel_demo.sfa_history_contact_row_id,
        row_number() OVER (PARTITION BY v_siebel_demo.sfa_history_contact_row_id ORDER BY v_siebel_demo.veeva_account_id, v_siebel_demo.sales_force_id) AS rnk
 FROM sfa_history.v_siebel_demo) iq
 WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.sfa_history_contact_row_id))) LEFT  JOIN ( SELECT iq2.ROW_ID,
        iq2.CREATED,
        iq2.CREATED_BY,
        iq2.LAST_UPD,
        iq2.LAST_UPD_BY,
        iq2.MODIFICATION_NUM,
        iq2.CONFLICT_ID,
        iq2.ACTIVE_FLG,
        iq2.ADDR_PER_ID,
        iq2.BL_ADDR_FLG,
        iq2.FRAUD_FLG,
        iq2.MAIN_ADDR_FLG,
        iq2.RELATION_TYPE_CD,
        iq2.SHIP_ADDR_FLG,
        iq2.DEA_EXPR_DT,
        iq2.END_DT,
        iq2.FRI_1ST_CLOSE_TM,
        iq2.FRI_1ST_OPEN_TM,
        iq2.FRI_2ND_CLOSE_TM,
        iq2.FRI_2ND_OPEN_TM,
        iq2.MON_1ST_CLOSE_TM,
        iq2.MON_1ST_OPEN_TM,
        iq2.MON_2ND_CLOSE_TM,
        iq2.MON_2ND_OPEN_TM,
        iq2.NUM_MONTHS_AT_ADDR,
        iq2.SAT_1ST_CLOSE_TM,
        iq2.SAT_1ST_OPEN_TM,
        iq2.SAT_2ND_CLOSE_TM,
        iq2.SAT_2ND_OPEN_TM,
        iq2.START_DT,
        iq2.SUN_1ST_CLOSE_TM,
        iq2.SUN_1ST_OPEN_TM,
        iq2.SUN_2ND_CLOSE_TM,
        iq2.SUN_2ND_OPEN_TM,
        iq2.THU_1ST_CLOSE_TM,
        iq2.THU_1ST_OPEN_TM,
        iq2.THU_2ND_CLOSE_TM,
        iq2.THU_2ND_OPEN_TM,
        iq2.TUE_1ST_CLOSE_TM,
        iq2.TUE_1ST_OPEN_TM,
        iq2.TUE_2ND_CLOSE_TM,
        iq2.TUE_2ND_OPEN_TM,
        iq2.WED_1ST_CLOSE_TM,
        iq2.WED_1ST_OPEN_TM,
        iq2.WED_2ND_CLOSE_TM,
        iq2.WED_2ND_OPEN_TM,
        iq2.ACCNT_ID,
        iq2.ADDR_MAIL_CD,
        iq2.ADDR_TYPE_CD,
        iq2.BRICK_ID,
        iq2.BU_ID,
        iq2.CONTACT_ID,
        iq2.DEA_NUM,
        iq2.DFLT_SHIP_PRIO_CD,
        iq2.EMAIL_ADDR,
        iq2.FAX_PH_NUM,
        iq2.MAIL_TYPE_CD,
        iq2.OCCUPANCY_CD,
        iq2.ORG_GROUP_ID,
        iq2.PH_NUM,
        iq2.TRNSPRT_ZONE_CD,
        iq2.X_ATTRIB_01,
        iq2.X_ATTRIB_02,
        iq2.X_ATTRIB_03,
        iq2.X_ATTRIB_04,
        iq2.X_ATTRIB_05,
        iq2.X_ATTRIB_06,
        iq2.X_ATTRIB_07,
        iq2.X_OK_TO_SAMPLE,
        iq2.ADDRESSEE,
        iq2.ALIGNMENT_FLG,
        iq2.DB_LAST_UPD,
        iq2.DB_LAST_UPD_SRC,
        iq2.YEARLY_END_DT,
        iq2.YEARLY_START_DT,
        iq2.X_SRC_LAST_UPD,
        iq2.rnk
 FROM ( SELECT ca.ROW_ID,
        ca.CREATED,
        ca.CREATED_BY,
        ca.LAST_UPD,
        ca.LAST_UPD_BY,
        ca.MODIFICATION_NUM,
        ca.CONFLICT_ID,
        ca.ACTIVE_FLG,
        ca.ADDR_PER_ID,
        ca.BL_ADDR_FLG,
        ca.FRAUD_FLG,
        ca.MAIN_ADDR_FLG,
        ca.RELATION_TYPE_CD,
        ca.SHIP_ADDR_FLG,
        ca.DEA_EXPR_DT,
        ca.END_DT,
        ca.FRI_1ST_CLOSE_TM,
        ca.FRI_1ST_OPEN_TM,
        ca.FRI_2ND_CLOSE_TM,
        ca.FRI_2ND_OPEN_TM,
        ca.MON_1ST_CLOSE_TM,
        ca.MON_1ST_OPEN_TM,
        ca.MON_2ND_CLOSE_TM,
        ca.MON_2ND_OPEN_TM,
        ca.NUM_MONTHS_AT_ADDR,
        ca.SAT_1ST_CLOSE_TM,
        ca.SAT_1ST_OPEN_TM,
        ca.SAT_2ND_CLOSE_TM,
        ca.SAT_2ND_OPEN_TM,
        ca.START_DT,
        ca.SUN_1ST_CLOSE_TM,
        ca.SUN_1ST_OPEN_TM,
        ca.SUN_2ND_CLOSE_TM,
        ca.SUN_2ND_OPEN_TM,
        ca.THU_1ST_CLOSE_TM,
        ca.THU_1ST_OPEN_TM,
        ca.THU_2ND_CLOSE_TM,
        ca.THU_2ND_OPEN_TM,
        ca.TUE_1ST_CLOSE_TM,
        ca.TUE_1ST_OPEN_TM,
        ca.TUE_2ND_CLOSE_TM,
        ca.TUE_2ND_OPEN_TM,
        ca.WED_1ST_CLOSE_TM,
        ca.WED_1ST_OPEN_TM,
        ca.WED_2ND_CLOSE_TM,
        ca.WED_2ND_OPEN_TM,
        ca.ACCNT_ID,
        ca.ADDR_MAIL_CD,
        ca.ADDR_TYPE_CD,
        ca.BRICK_ID,
        ca.BU_ID,
        ca.CONTACT_ID,
        ca.DEA_NUM,
        ca.DFLT_SHIP_PRIO_CD,
        ca.EMAIL_ADDR,
        ca.FAX_PH_NUM,
        ca.MAIL_TYPE_CD,
        ca.OCCUPANCY_CD,
        ca.ORG_GROUP_ID,
        ca.PH_NUM,
        ca.TRNSPRT_ZONE_CD,
        ca.X_ATTRIB_01,
        ca.X_ATTRIB_02,
        ca.X_ATTRIB_03,
        ca.X_ATTRIB_04,
        ca.X_ATTRIB_05,
        ca.X_ATTRIB_06,
        ca.X_ATTRIB_07,
        ca.X_OK_TO_SAMPLE,
        ca.ADDRESSEE,
        ca.ALIGNMENT_FLG,
        ca.DB_LAST_UPD,
        ca.DB_LAST_UPD_SRC,
        ca.YEARLY_END_DT,
        ca.YEARLY_START_DT,
        ca.X_SRC_LAST_UPD,
        row_number() OVER (PARTITION BY ca.CONTACT_ID, ca.ADDR_PER_ID ORDER BY ca.LAST_UPD DESC, ca.CREATED DESC) AS rnk
 FROM sfa_history.s_con_addr ca) iq2
 WHERE (iq2.rnk = 1)) ca ON (((ca.ADDR_PER_ID = ea.TARGET_PER_ADDR_ID) AND (ca.CONTACT_ID = ea.TARGET_PER_ID)))) LEFT  JOIN ( SELECT d.activity_id,
        max(CASE WHEN (d.priority = 1) THEN d.product_id ELSE NULL END) AS first_detailed_product_id,
        max(CASE WHEN (d.priority = 1) THEN d.product_name ELSE NULL END) AS first_detailed_product,
        max(CASE WHEN (d.priority = 2) THEN d.product_id ELSE NULL END) AS second_detailed_product_id,
        max(CASE WHEN (d.priority = 2) THEN d.product_name ELSE NULL END) AS second_detailed_product,
        max(CASE WHEN (d.priority = 3) THEN d.product_id ELSE NULL END) AS third_detailed_product_id,
        max(CASE WHEN (d.priority = 3) THEN d.product_name ELSE NULL END) AS third_detailed_product,
        max(CASE WHEN (d.priority = 4) THEN d.product_id ELSE NULL END) AS fourth_detailed_product_id,
        max(CASE WHEN (d.priority = 4) THEN d.product_name ELSE NULL END) AS fourth_detailed_product,
        max(CASE WHEN (d.priority = 5) THEN d.product_id ELSE NULL END) AS fifth_detailed_product_id,
        max(CASE WHEN (d.priority = 5) THEN d.product_name ELSE NULL END) AS fifth_detailed_product,
        max(CASE WHEN (d.priority = 6) THEN d.product_id ELSE NULL END) AS sixth_detailed_product_id,
        max(CASE WHEN (d.priority = 6) THEN d.product_name ELSE NULL END) AS sixth_detailed_product
 FROM ( SELECT appl.ACTIVITY_ID AS activity_id,
        spi.PRODUCT_ID AS product_id,
        upper(spi.NAME) AS product_name,
        row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority
 FROM (sfa_history.s_act_prod_appl appl LEFT  JOIN sfa_history.s_prod_int spi ON ((appl.PRDINT_ID = spi.ROW_ID)))
 WHERE (appl.CONFLICT_ID = '0'::varchar(1))) d
 GROUP BY d.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID)))
 WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (((ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TN'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)]))) OR ((ea.APPT_START_DT >= '2012-03-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TC'::varchar(2), 'TP'::varchar(2)])))) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = ANY (ARRAY['Contact Call'::varchar(13), 'Attendee Call'::varchar(13)])) AND ((ea.TODO_CD ~~ '%Detail%'::varchar(8)) OR (ea.TODO_CD ~~ '%Call%'::varchar(6))));

CREATE  VIEW outbound.territory_bag_product AS
 SELECT i_bag_territory_product.territory_number AS territory_num,
        i_bag_territory_product.bag_name,
        i_bag_territory_product."position",
        i_bag_territory_product.basket_name AS product_name
 FROM outbound.i_bag_territory_product
 WHERE (i_bag_territory_product.bag_name !~~ '%MGR'::varchar(4))
 ORDER BY i_bag_territory_product.territory_number,
          i_bag_territory_product."position";

CREATE  VIEW outbound.zzz_product_target_segment AS
 SELECT coalesce(vv.veeva_account_id, cmid.id_num) AS hcp_id,
        NULL AS territory_code,
        b.name AS product,
        clf.flag_value AS target_segment
 FROM (((datamart.customer_level_flags clf JOIN product.basket b ON ((clf.basket_id = b.basket_id))) LEFT  JOIN datamart.tvcmid_xref cmid ON (((clf.tvcmid = cmid.tvcmid) AND (cmid.id_type = 'IMS_ID'::varchar(6))))) LEFT  JOIN ( SELECT v_account.id AS veeva_account_id,
        v_account.id_vod__c AS ims_id
 FROM veeva.v_account
 WHERE (v_account.id_vod__c IS NOT NULL)) vv ON ((cmid.id_num = vv.ims_id)))
 WHERE (((statement_timestamp())::timestamp >= clf.flag_effective_start_date) AND ((statement_timestamp())::timestamp <= clf.flag_effective_end_date) AND (clf.flag_type = 'ABC_TARGET'::varchar(10)));

CREATE  VIEW outbound.zzz_zs_tr_demographics AS
 SELECT acct.id AS VEEVA_ACCOUNT_ID,
        acct.id_vod__c AS IMS_ID,
        g.developername AS TERRITORY_NUM,
        acct.firstname AS FIRST_NAME,
        acct.lastname AS LAST_NAME,
        addr.name AS ADDRESS1,
        addr.address_line_2_vod__c AS ADDRESS2,
        addr.city_vod__c AS CITY,
        addr.state_vod__c AS STATE,
        addr.zip_vod__c AS ZIP,
        cg.call_goal AS CALL_GOAL,
        cg.committed_p1 AS COMMITTED_P1,
        cg.committed_p2 AS COMMITTED_P2,
        cg.committed_p3 AS COMMITTED_P3,
        acct.account_status_tva__c AS ACCOUNT_STATUS_TVA__C
 FROM ((((((( SELECT a.id,
        a.isdeleted,
        a.masterrecordid,
        a.name,
        a.lastname,
        a.firstname,
        a.salutation,
        a.type,
        a.recordtypeid,
        a.phone,
        a.fax,
        a.website,
        a.numberofemployees,
        a.ownership,
        a.ownerid,
        a.createddate,
        a.createdbyid,
        a.lastmodifieddate,
        a.lastmodifiedbyid,
        a.systemmodstamp,
        a.lastactivitydate,
        a.mayedit,
        a.islocked,
        a.lastvieweddate,
        a.lastreferenceddate,
        a.isexcludedfromrealign,
        a.personcontactid,
        a.ispersonaccount,
        a.personmailingstreet,
        a.personmailingcity,
        a.personmailingstate,
        a.personmailingpostalcode,
        a.personmailingcountry,
        a.personmailinglatitude,
        a.personmailinglongitude,
        a.personotherstreet,
        a.personothercity,
        a.personotherstate,
        a.personotherpostalcode,
        a.personothercountry,
        a.personotherlatitude,
        a.personotherlongitude,
        a.personmobilephone,
        a.personhomephone,
        a.personotherphone,
        a.personassistantphone,
        a.personemail,
        a.persontitle,
        a.persondepartment,
        a.personassistantname,
        a.personbirthdate,
        a.personhasoptedoutofemail,
        a.personhasoptedoutoffax,
        a.persondonotcall,
        a.personlastcurequestdate,
        a.personlastcuupdatedate,
        a.personemailbouncedreason,
        a.personemailbounceddate,
        a.jigsaw,
        a.jigsawcompanyid,
        a.accountsource,
        a.sicdesc,
        a.external_id_vod__c,
        a.credentials_vod__c,
        a.exclude_from_zip_to_terr_proce,
        a.group_specialty_1_vod__c,
        a.group_specialty_2_vod__c,
        a.specialty_1_vod__c,
        a.specialty_2_vod__c,
        a.formatted_name_vod__c,
        a.territory_test_vod__c,
        a.mobile_id_vod__c,
        a.gender_vod__c,
        a.id_vod__c,
        a.do_not_sync_sales_data_vod__c,
        a.id2_vod__c,
        a.preferred_name_vod__c,
        a.sample_default_vod__c,
        a.segmentations_vod__c,
        a.restricted_products_vod__c,
        a.payer_id_vod__c,
        a.account_status_tva__c,
        a.do_not_call_vod__c,
        a.beds__c,
        a.spend_amount__c,
        a.pdrp_opt_out_vod__c,
        a.spend_status_value_vod__c,
        a.pdrp_opt_out_date_vod__c,
        a.spend_status_vod__c,
        a.enable_restricted_products,
        a.call_reminder_vod__c,
        a.account_group_vod__c,
        a.primary_parent_vod__c,
        a.color_vod__c,
        a.middle_vod__c,
        a.suffix_vod__c,
        a.account_location_tva__c,
        a.no_orders_vod__c,
        a.account_master_id_tva__c,
        a.account_email_tva__c,
        a.account_search_firstlast,
        a.account_search_lastfirst,
        a.person_preferred_name_tva__c,
        a.practice_at_hospital_vod__c,
        a.practice_near_hospital_vod__c,
        a.do_not_create_child_account,
        a.total_mds_dos__c,
        a.aha__c,
        a.order_type_vod__c,
        a.npi_vod__c,
        a.me__c,
        a.speaker__c,
        a.investigator_vod__c,
        a.default_order_type_vod__c,
        a.person_degree_tva__c,
        a.tax_status__c,
        a.model__c,
        a.offerings__c,
        a.departments__c,
        a.account_type__c,
        a.account_search_business_vod__c,
        a.business_professional_person,
        a.no_spend_tva__c,
        a.hospital_type_vod__c,
        a.account_class_vod__c,
        a.furigana_vod__c,
        a.tirf_rems_tva__c,
        a.fentora_app_tva__c,
        a.total_revenue_000__c,
        a.net_income_loss_000__c,
        a.pmpm_income_loss_000__c,
        a.commercial_premiums_pmpm__c,
        a.medical_loss_ratio__c,
        a.medical_expenses_pmpm__c,
        a.commercial_patient_days_1000,
        a.hmo_market_shr__c,
        a.hmo__c,
        a.hmo_pos__c,
        a.ppo__c,
        a.ppo_pos__c,
        a.medicare__c,
        a.medicaid__c,
        a.nuvigil_app_tva__c,
        a.mds_status_tva__c,
        a.lis_status_tva__c,
        a.dnc_pcs_tva__c,
        a.dnc_cns_tva__c,
        a.suffix_tva__c,
        a.tysabri_status_tva__c,
        a.business_description__c,
        a.regional_strategy__c,
        a.contracts_process__c,
        a.cml_profiled_tva__c,
        a.cell_phone_tva__c,
        a.no_contact_tva__c,
        a.outlet_id_tva__c,
        a.pmo_gpo_account_affiliations,
        a.territory_status_tva__c,
        a.zdea_number_tva__c,
        a.veeva_id_tva__c,
        a.treanda_lq_tgt_tva__c,
        a.tbo_filgrastim_target_tva__c,
        a.sln_rescrub_tva__c,
        a.account_identifier_vod__c,
        a.target__c,
        a.kol_vod__c,
        a.rems_expiration_date_teva__c,
        a.account_demo_id_tva__c,
        a.total_lives__c,
        a.total_physicians_enrolled__c,
        a.tirf_rems_eff_date_tva__c,
        a.business_associate_agreement,
        a.do_not_promote_tva__c,
        a.account_dea_tva__c,
        a.bp_number__c,
        a.paragard_segmentation_tva__c,
        a.telesales_activity_tva__c,
        a.designation_tva__c,
        a.total_pharmacists__c,
        a.comp_pricing_tva__c,
        a.formulary_tva__c,
        a.gln_tva__c,
        a.gpo_contracts_tva__c,
        a.hin_tva__c,
        a.max_id_tva__c,
        a.oncology_services_tva__c,
        a.pcp_program_tva__c,
        a.pharmacy_location_tva__c,
        a.primary_credential_tva__c,
        a.primary_wholesaler_tva__c,
        a.rep_credentialing_tva__c,
        a.secondary_credential_tva__c,
        a.sign_in_location_tva__c,
        a.special_tva__c,
        a.sub_type_id_tva__c,
        a.sub_type_tva__c,
        a.teva_contracts_tva__c,
        a.ims_org_id_tva__c,
        a.year_of_birth_tva__c,
        a.teaching_hospital_tva__c,
        a.account_archived_tva__c,
        a.mobile_id_vod__pc,
        a.file_id,
        a.record_id,
        a.cm_id_tva__c,
        a.rnk
 FROM ( SELECT account.id,
        account.isdeleted,
        account.masterrecordid,
        account.name,
        account.lastname,
        account.firstname,
        account.salutation,
        account.type,
        account.recordtypeid,
        account.phone,
        account.fax,
        account.website,
        account.numberofemployees,
        account.ownership,
        account.ownerid,
        account.createddate,
        account.createdbyid,
        account.lastmodifieddate,
        account.lastmodifiedbyid,
        account.systemmodstamp,
        account.lastactivitydate,
        account.mayedit,
        account.islocked,
        account.lastvieweddate,
        account.lastreferenceddate,
        account.isexcludedfromrealign,
        account.personcontactid,
        account.ispersonaccount,
        account.personmailingstreet,
        account.personmailingcity,
        account.personmailingstate,
        account.personmailingpostalcode,
        account.personmailingcountry,
        account.personmailinglatitude,
        account.personmailinglongitude,
        account.personotherstreet,
        account.personothercity,
        account.personotherstate,
        account.personotherpostalcode,
        account.personothercountry,
        account.personotherlatitude,
        account.personotherlongitude,
        account.personmobilephone,
        account.personhomephone,
        account.personotherphone,
        account.personassistantphone,
        account.personemail,
        account.persontitle,
        account.persondepartment,
        account.personassistantname,
        account.personbirthdate,
        account.personhasoptedoutofemail,
        account.personhasoptedoutoffax,
        account.persondonotcall,
        account.personlastcurequestdate,
        account.personlastcuupdatedate,
        account.personemailbouncedreason,
        account.personemailbounceddate,
        account.jigsaw,
        account.jigsawcompanyid,
        account.accountsource,
        account.sicdesc,
        account.external_id_vod__c,
        account.credentials_vod__c,
        account.exclude_from_zip_to_terr_proce,
        account.group_specialty_1_vod__c,
        account.group_specialty_2_vod__c,
        account.specialty_1_vod__c,
        account.specialty_2_vod__c,
        account.formatted_name_vod__c,
        account.territory_test_vod__c,
        account.mobile_id_vod__c,
        account.gender_vod__c,
        account.id_vod__c,
        account.do_not_sync_sales_data_vod__c,
        account.id2_vod__c,
        account.preferred_name_vod__c,
        account.sample_default_vod__c,
        account.segmentations_vod__c,
        account.restricted_products_vod__c,
        account.payer_id_vod__c,
        account.account_status_tva__c,
        account.do_not_call_vod__c,
        account.beds__c,
        account.spend_amount__c,
        account.pdrp_opt_out_vod__c,
        account.spend_status_value_vod__c,
        account.pdrp_opt_out_date_vod__c,
        account.spend_status_vod__c,
        account.enable_restricted_products,
        account.call_reminder_vod__c,
        account.account_group_vod__c,
        account.primary_parent_vod__c,
        account.color_vod__c,
        account.middle_vod__c,
        account.suffix_vod__c,
        account.account_location_tva__c,
        account.no_orders_vod__c,
        account.account_master_id_tva__c,
        account.account_email_tva__c,
        account.account_search_firstlast,
        account.account_search_lastfirst,
        account.person_preferred_name_tva__c,
        account.practice_at_hospital_vod__c,
        account.practice_near_hospital_vod__c,
        account.do_not_create_child_account,
        account.total_mds_dos__c,
        account.aha__c,
        account.order_type_vod__c,
        account.npi_vod__c,
        account.me__c,
        account.speaker__c,
        account.investigator_vod__c,
        account.default_order_type_vod__c,
        account.person_degree_tva__c,
        account.tax_status__c,
        account.model__c,
        account.offerings__c,
        account.departments__c,
        account.account_type__c,
        account.account_search_business_vod__c,
        account.business_professional_person,
        account.no_spend_tva__c,
        account.hospital_type_vod__c,
        account.account_class_vod__c,
        account.furigana_vod__c,
        account.tirf_rems_tva__c,
        account.fentora_app_tva__c,
        account.total_revenue_000__c,
        account.net_income_loss_000__c,
        account.pmpm_income_loss_000__c,
        account.commercial_premiums_pmpm__c,
        account.medical_loss_ratio__c,
        account.medical_expenses_pmpm__c,
        account.commercial_patient_days_1000,
        account.hmo_market_shr__c,
        account.hmo__c,
        account.hmo_pos__c,
        account.ppo__c,
        account.ppo_pos__c,
        account.medicare__c,
        account.medicaid__c,
        account.nuvigil_app_tva__c,
        account.mds_status_tva__c,
        account.lis_status_tva__c,
        account.dnc_pcs_tva__c,
        account.dnc_cns_tva__c,
        account.suffix_tva__c,
        account.tysabri_status_tva__c,
        account.business_description__c,
        account.regional_strategy__c,
        account.contracts_process__c,
        account.cml_profiled_tva__c,
        account.cell_phone_tva__c,
        account.no_contact_tva__c,
        account.outlet_id_tva__c,
        account.pmo_gpo_account_affiliations,
        account.territory_status_tva__c,
        account.zdea_number_tva__c,
        account.veeva_id_tva__c,
        account.treanda_lq_tgt_tva__c,
        account.tbo_filgrastim_target_tva__c,
        account.sln_rescrub_tva__c,
        account.account_identifier_vod__c,
        account.target__c,
        account.kol_vod__c,
        account.rems_expiration_date_teva__c,
        account.account_demo_id_tva__c,
        account.total_lives__c,
        account.total_physicians_enrolled__c,
        account.tirf_rems_eff_date_tva__c,
        account.business_associate_agreement,
        account.do_not_promote_tva__c,
        account.account_dea_tva__c,
        account.bp_number__c,
        account.paragard_segmentation_tva__c,
        account.telesales_activity_tva__c,
        account.designation_tva__c,
        account.total_pharmacists__c,
        account.comp_pricing_tva__c,
        account.formulary_tva__c,
        account.gln_tva__c,
        account.gpo_contracts_tva__c,
        account.hin_tva__c,
        account.max_id_tva__c,
        account.oncology_services_tva__c,
        account.pcp_program_tva__c,
        account.pharmacy_location_tva__c,
        account.primary_credential_tva__c,
        account.primary_wholesaler_tva__c,
        account.rep_credentialing_tva__c,
        account.secondary_credential_tva__c,
        account.sign_in_location_tva__c,
        account.special_tva__c,
        account.sub_type_id_tva__c,
        account.sub_type_tva__c,
        account.teva_contracts_tva__c,
        account.ims_org_id_tva__c,
        account.year_of_birth_tva__c,
        account.teaching_hospital_tva__c,
        account.account_archived_tva__c,
        account.mobile_id_vod__pc,
        account.file_id,
        account.record_id,
        account.cm_id_tva__c,
        row_number() OVER (PARTITION BY account.id ORDER BY account.file_id DESC) AS rnk
 FROM veeva.account) a
 WHERE (a.rnk = 1)) acct JOIN ( SELECT r.businessprocessid,
        r.createdbyid,
        r.createddate,
        r.description,
        r.developername,
        r.id,
        r.isactive,
        r.ispersontype,
        r.lastmodifiedbyid,
        r.lastmodifieddate,
        r.name,
        r.namespaceprefix,
        r.sobjecttype,
        r.systemmodstamp,
        r.file_id,
        r.record_id,
        r.rnk
 FROM ( SELECT recordtype.businessprocessid,
        recordtype.createdbyid,
        recordtype.createddate,
        recordtype.description,
        recordtype.developername,
        recordtype.id,
        recordtype.isactive,
        recordtype.ispersontype,
        recordtype.lastmodifiedbyid,
        recordtype.lastmodifieddate,
        recordtype.name,
        recordtype.namespaceprefix,
        recordtype.sobjecttype,
        recordtype.systemmodstamp,
        recordtype.file_id,
        recordtype.record_id,
        row_number() OVER (PARTITION BY recordtype.id ORDER BY recordtype.file_id DESC) AS rnk
 FROM veeva.recordtype) r
 WHERE (r.rnk = 1)) rta ON ((acct.recordtypeid = rta.id))) JOIN ( SELECT a.accountaccesslevel,
        a.accountid,
        a.caseaccesslevel,
        a.contactaccesslevel,
        a.id,
        a.isdeleted,
        a.lastmodifiedbyid,
        a.lastmodifieddate,
        a.opportunityaccesslevel,
        a.rowcause,
        a.userorgroupid,
        a.file_id,
        a.record_id,
        a.rnk
 FROM ( SELECT accountshare.accountaccesslevel,
        accountshare.accountid,
        accountshare.caseaccesslevel,
        accountshare.contactaccesslevel,
        accountshare.id,
        accountshare.isdeleted,
        accountshare.lastmodifiedbyid,
        accountshare.lastmodifieddate,
        accountshare.opportunityaccesslevel,
        accountshare.rowcause,
        accountshare.userorgroupid,
        accountshare.file_id,
        accountshare.record_id,
        row_number() OVER (PARTITION BY accountshare.id ORDER BY accountshare.file_id DESC) AS rnk
 FROM veeva.accountshare) a
 WHERE (a.rnk = 1)) acctshr ON (((acct.id = acctshr.accountid) AND (acctshr.rowcause = 'TerritoryManual'::varchar(15))))) JOIN ( SELECT g.createdbyid,
        g.createddate,
        g.developername,
        g.doesincludebosses,
        g.doessendemailtomembers,
        g.email,
        g.id,
        g.lastmodifiedbyid,
        g.lastmodifieddate,
        g.name,
        g.ownerid,
        g.relatedid,
        g.systemmodstamp,
        g.type,
        g.file_id,
        g.record_id,
        g.rnk
 FROM ( SELECT "group".createdbyid,
        "group".createddate,
        "group".developername,
        "group".doesincludebosses,
        "group".doessendemailtomembers,
        "group".email,
        "group".id,
        "group".lastmodifiedbyid,
        "group".lastmodifieddate,
        "group".name,
        "group".ownerid,
        "group".relatedid,
        "group".systemmodstamp,
        "group".type,
        "group".file_id,
        "group".record_id,
        row_number() OVER (PARTITION BY "group".id ORDER BY "group".file_id DESC) AS rnk
 FROM veeva."group") g
 WHERE (g.rnk = 1)) g ON ((acctshr.userorgroupid = g.id))) JOIN ( SELECT tsf.id,
        tsf.isdeleted,
        tsf.name,
        tsf.recordtypeid,
        tsf.createddate,
        tsf.createdbyid,
        tsf.lastmodifieddate,
        tsf.lastmodifiedbyid,
        tsf.systemmodstamp,
        tsf.mayedit,
        tsf.islocked,
        tsf.account_vod__c,
        tsf.address_vod__c,
        tsf.last_activity_date_vod__c,
        tsf.my_target_vod__c,
        tsf.route_vod__c,
        tsf.mobile_id_vod__c,
        tsf.external_id_vod__c,
        tsf.territory_vod__c,
        tsf.ytd_activity_vod__c,
        tsf.preferred_account_vod__c,
        tsf.allowed_products_vod__c,
        tsf.territory_status_tva__c,
        tsf.territory_specialty_tva__c,
        tsf.treats_es_osa_tva__c,
        tsf.osa_patients_tva__c,
        tsf.account_status_tva__c,
        tsf.dea_number_tva__c,
        tsf.synribo_target_tva__c,
        tsf.treanda_sbo_tva__c,
        tsf.trisenox_sbo_tva__c,
        tsf.appt_index_tva__c,
        tsf.merged_mvn__c,
        tsf.call_plan_designation_tva__c,
        tsf.campaign_tva__c,
        tsf.file_id,
        tsf.record_id,
        tsf.rnk
 FROM ( SELECT tsf.id,
        tsf.isdeleted,
        tsf.name,
        tsf.recordtypeid,
        tsf.createddate,
        tsf.createdbyid,
        tsf.lastmodifieddate,
        tsf.lastmodifiedbyid,
        tsf.systemmodstamp,
        tsf.mayedit,
        tsf.islocked,
        tsf.account_vod__c,
        tsf.address_vod__c,
        tsf.last_activity_date_vod__c,
        tsf.my_target_vod__c,
        tsf.route_vod__c,
        tsf.mobile_id_vod__c,
        tsf.external_id_vod__c,
        tsf.territory_vod__c,
        tsf.ytd_activity_vod__c,
        tsf.preferred_account_vod__c,
        tsf.allowed_products_vod__c,
        tsf.territory_status_tva__c,
        tsf.territory_specialty_tva__c,
        tsf.treats_es_osa_tva__c,
        tsf.osa_patients_tva__c,
        tsf.account_status_tva__c,
        tsf.dea_number_tva__c,
        tsf.synribo_target_tva__c,
        tsf.treanda_sbo_tva__c,
        tsf.trisenox_sbo_tva__c,
        tsf.appt_index_tva__c,
        tsf.merged_mvn__c,
        tsf.call_plan_designation_tva__c,
        tsf.campaign_tva__c,
        tsf.file_id,
        tsf.record_id,
        row_number() OVER (PARTITION BY tsf.id ORDER BY tsf.file_id DESC) AS rnk
 FROM veeva.tsf) tsf
 WHERE (tsf.rnk = 1)) tsf ON (((tsf.account_vod__c = acct.id) AND (tsf.territory_vod__c = g.developername)))) JOIN ( SELECT a.id,
        a.isdeleted,
        a.name,
        a.recordtypeid,
        a.createddate,
        a.createdbyid,
        a.lastmodifieddate,
        a.lastmodifiedbyid,
        a.systemmodstamp,
        a.mayedit,
        a.islocked,
        a.account_vod__c,
        a.address_line_2_vod__c,
        a.city_vod__c,
        a.external_id_vod__c,
        a.dea_vod__c,
        a.dea_expiration_date_vod__c,
        a.dea_license_address_vod__c,
        a.phone_vod__c,
        a.fax_vod__c,
        a.map_vod__c,
        a.shipping_vod__c,
        a.primary_vod__c,
        a.license_vod__c,
        a.license_expiration_date_vod__c,
        a.staff_notes_vod__c,
        a.appt_required_vod__c,
        a.office_notes_vod__c,
        a.license_status_vod__c,
        a.zip_4_vod__c,
        a.phone_2_vod__c,
        a.fax_2_vod__c,
        a.license_valid_to_sample_vod__c,
        a.sample_status_vod__c,
        a.include_territory_assignment,
        a.mobile_id_vod__c,
        a.inactive_vod__c,
        a.lock_vod__c,
        a.country_vod__c,
        a.latitude_vod__c,
        a.zip_vod__c,
        a.best_times_vod__c,
        a.source_vod__c,
        a.brick_vod__c,
        a.assmca_vod__c,
        a.dea_address_vod__c,
        a.dea_schedule_vod__c,
        a.business_vod__c,
        a.billing_vod__c,
        a.home_vod__c,
        a.mailing_vod__c,
        a.state_vod__c,
        a.longitude_vod__c,
        a.dea_status_vod__c,
        a.entity_reference_id_vod__c,
        a.controlling_address_vod__c,
        a.controlled_address_vod__c,
        a.no_address_copy_vod__c,
        a.address_line_3_tva__c,
        a.county_tva__c,
        a.external_sln_tva__c,
        a.license_expiration_date_tva__c,
        a.rep_entered_sln_tva__c,
        a.dea_contact_tva__c,
        a.mark_for_deletion_tva__c,
        a.license_valid_date_tva__c,
        a.license_valid_num_tva__c,
        a.file_id,
        a.record_id,
        a.cm_id_tva__c,
        a.rnk
 FROM ( SELECT address.id,
        address.isdeleted,
        address.name,
        address.recordtypeid,
        address.createddate,
        address.createdbyid,
        address.lastmodifieddate,
        address.lastmodifiedbyid,
        address.systemmodstamp,
        address.mayedit,
        address.islocked,
        address.account_vod__c,
        address.address_line_2_vod__c,
        address.city_vod__c,
        address.external_id_vod__c,
        address.dea_vod__c,
        address.dea_expiration_date_vod__c,
        address.dea_license_address_vod__c,
        address.phone_vod__c,
        address.fax_vod__c,
        address.map_vod__c,
        address.shipping_vod__c,
        address.primary_vod__c,
        address.license_vod__c,
        address.license_expiration_date_vod__c,
        address.staff_notes_vod__c,
        address.appt_required_vod__c,
        address.office_notes_vod__c,
        address.license_status_vod__c,
        address.zip_4_vod__c,
        address.phone_2_vod__c,
        address.fax_2_vod__c,
        address.license_valid_to_sample_vod__c,
        address.sample_status_vod__c,
        address.include_territory_assignment,
        address.mobile_id_vod__c,
        address.inactive_vod__c,
        address.lock_vod__c,
        address.country_vod__c,
        address.latitude_vod__c,
        address.zip_vod__c,
        address.best_times_vod__c,
        address.source_vod__c,
        address.brick_vod__c,
        address.assmca_vod__c,
        address.dea_address_vod__c,
        address.dea_schedule_vod__c,
        address.business_vod__c,
        address.billing_vod__c,
        address.home_vod__c,
        address.mailing_vod__c,
        address.state_vod__c,
        address.longitude_vod__c,
        address.dea_status_vod__c,
        address.entity_reference_id_vod__c,
        address.controlling_address_vod__c,
        address.controlled_address_vod__c,
        address.no_address_copy_vod__c,
        address.address_line_3_tva__c,
        address.county_tva__c,
        address.external_sln_tva__c,
        address.license_expiration_date_tva__c,
        address.rep_entered_sln_tva__c,
        address.dea_contact_tva__c,
        address.mark_for_deletion_tva__c,
        address.license_valid_date_tva__c,
        address.license_valid_num_tva__c,
        address.file_id,
        address.record_id,
        address.cm_id_tva__c,
        row_number() OVER (PARTITION BY address.id ORDER BY address.file_id DESC) AS rnk
 FROM veeva.address) a
 WHERE (a.rnk = 1)) addr ON (((addr.account_vod__c = acct.id) AND (tsf.address_vod__c = addr.id)))) LEFT  JOIN ( SELECT cg.account_tva__c,
        cg.territory_tva__c,
        sum(CASE WHEN (cg.priority_tva__c = 1::numeric(18,0)) THEN cg.goal_tva__c ELSE 0::numeric(18,0) END) AS call_goal,
        min(CASE WHEN (cg.priority_tva__c = 1::numeric(18,0)) THEN p.name ELSE NULL END) AS committed_p1,
        min(CASE WHEN (cg.priority_tva__c = 2::numeric(18,0)) THEN p.name ELSE NULL END) AS committed_p2,
        min(CASE WHEN (cg.priority_tva__c = 3::numeric(18,0)) THEN p.name ELSE NULL END) AS committed_p3
 FROM (veeva.call_goal cg JOIN veeva.v_product p ON ((cg.product_catalog_tva__c = p.id)))
 WHERE ((cg.territory_tva__c ~~ 'TR%'::varchar(3)) AND (cg.file_id = ( SELECT max(call_goal.file_id) AS max
 FROM veeva.call_goal)))
 GROUP BY cg.account_tva__c,
          cg.territory_tva__c) cg ON (((cg.account_tva__c = acct.id) AND (cg.territory_tva__c = g.developername))))
 WHERE ((g.developername ~~ 'TR%'::varchar(3)) AND (acct.ispersonaccount = 'true'::varchar(4)) AND (acct.id IN ( SELECT call.account_vod__c AS veeva_account_id
 FROM veeva.call
 WHERE (call.call_date_vod__c > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)))))
 GROUP BY acct.id,
          acct.id_vod__c,
          g.developername,
          acct.firstname,
          acct.lastname,
          addr.name,
          addr.address_line_2_vod__c,
          addr.city_vod__c,
          addr.state_vod__c,
          addr.zip_vod__c,
          cg.call_goal,
          cg.committed_p1,
          cg.committed_p2,
          cg.committed_p3,
          acct.account_status_tva__c;

CREATE  VIEW outbound.aptus_roster_ajovy AS
 SELECT r.territory_number AS unique_individual_id,
        NULL AS name_prefix,
        r.first_name,
        r.middle_name,
        r.last_name,
        NULL AS name_suffix,
        NULL AS address_line1,
        NULL AS address_line2,
        NULL AS city,
        NULL AS state,
        NULL AS zip,
        NULL AS country,
        NULL AS phone_number,
        NULL AS phone_extension,
        NULL AS fax_number,
        NULL AS voice_mail_number,
        r.email,
        r.territory_number,
        CASE WHEN (h.territory_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || h.territory_name) || '"'::varchar(1)) ELSE h.territory_name END AS territory_name,
        h.region_number,
        CASE WHEN (h.region_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || h.region_name) || '"'::varchar(1)) ELSE h.region_name END AS region_name,
        h.area_number,
        CASE WHEN (h.area_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || h.area_name) || '"'::varchar(1)) ELSE h.area_name END AS area_name,
        CASE WHEN (r.rep_type = 'RM'::varchar(2)) THEN 1 ELSE 0 END AS dm_flag,
        CASE WHEN (r.rep_type = 'AD'::varchar(2)) THEN 1 ELSE 0 END AS rm_flag,
        r.rep_type
 FROM (datamart.roster r LEFT  JOIN datamart.territory_region_area_hierarchy h ON ((r.territory_number = h.territory_number)))
 WHERE ((r.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TR'::varchar(2)])) AND (r.rep_type = 'REP'::varchar(3)))
 ORDER BY r.territory_number;

CREATE  VIEW outbound.asrs_count AS
 SELECT event.event_count,
        fact.fact_count,
        attendee.attendee_count,
        product.product_count,
        amount.total_expense_amount,
        total_attendee_count.total_attendee_count
 FROM ( SELECT count(*) AS event_count
 FROM outbound.asrs_event) event, ( SELECT count(*) AS fact_count
 FROM outbound.asrs_fact) fact, ( SELECT count(*) AS attendee_count
 FROM outbound.asrs_attendee) attendee, ( SELECT count(*) AS product_count
 FROM outbound.asrs_product) product, ( SELECT sum(asrs_fact.total_expense_amount) AS total_expense_amount
 FROM outbound.asrs_fact) amount, ( SELECT sum(asrs_event.attendee_count) AS total_attendee_count
 FROM outbound.asrs_event) total_attendee_count;

CREATE  VIEW outbound.connectiverx_ajovy_roster AS
 SELECT r.rep_type,
        r.sales_force_id,
        r.territory_number,
        r.territory_name,
        h.region_number,
        h.region_name,
        h.area_number,
        h.area_name,
        r.employee_id,
        r.full_name AS rep_name,
        r.email AS rep_email,
        r2.full_name AS mgr_name,
        r2.email AS mgr_email,
        r3.full_name AS ad_name,
        r3.email AS ad_email
 FROM (((datamart.roster r LEFT  JOIN datamart.territory_region_area_hierarchy h ON ((r.territory_number = h.territory_number))) LEFT  JOIN datamart.roster r2 ON ((r2.territory_number = h.region_number))) LEFT  JOIN datamart.roster r3 ON ((r3.territory_number = h.area_number)))
 WHERE ((r.rep_type = ANY (ARRAY['REP'::varchar(3), 'CNE'::varchar(3)])) AND (r.sales_force_id = ANY (ARRAY['TE'::varchar(2), 'TN'::varchar(2), 'TR'::varchar(2)])))
 ORDER BY r.territory_number;

CREATE  VIEW sandbox.vw_concur_hcp_delta_0928 AS
 SELECT concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar) AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 1))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 1))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 1))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar),
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp) EXCEPT  SELECT concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar) AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 2))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 2))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 2))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar),
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp);

CREATE  VIEW outbound.fourth_down_roster AS
 SELECT CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN ('VACANT'::varchar(6) || t.geography_number) ELSE rep.employee_id END AS TevaID,
        coalesce(t.geography_number, rep.territory_number) AS Terr_id,
        coalesce(t.geography_name, rep.territory_name) AS TerritoryName,
        CASE WHEN (rep.rep_type = 'REP'::varchar(3)) THEN 'Territory'::varchar(9) WHEN (rep.rep_type = 'MSL'::varchar(3)) THEN 'Territory'::varchar(9) WHEN (rep.rep_type = 'CNE'::varchar(3)) THEN 'Territory'::varchar(9) WHEN (rep.rep_type = 'MGR'::varchar(3)) THEN 'Region'::varchar(6) WHEN (rep.rep_type = 'DIR'::varchar(3)) THEN 'Area'::varchar(4) WHEN (rep.rep_type = 'VP'::varchar(2)) THEN 'National'::varchar(8) ELSE NULL END AS TerritoryType,
        coalesce(t.sales_force_id, rep.sales_force_id) AS SalesForceID,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN 'VACANT'::varchar(6) ELSE rep.first_name END AS FirstName,
        rep.middle_name AS MiddleName,
        rep.preferred_name AS PreferredName,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN t.geography_number ELSE rep.last_name END AS LastName,
        ''::varchar AS Title,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN 'OPEN'::varchar(4) ELSE rep.hr_status END AS RepStatus,
        CASE WHEN (upper(rep.reg_contract) = 'EX'::varchar(2)) THEN 'Contract'::varchar(8) ELSE upper(coalesce(rep.rep_type, t.employee_type)) END AS RepType,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN ('VACANT'::varchar(6) || t.geography_number) ELSE rep.username END AS LogonID,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN (t.geography_number || '@tevapharm.com'::varchar(14)) ELSE rep.email END AS Email,
        mgr.employee_id AS ManagerID,
        coalesce(CASE WHEN (rep.sample_eligibility_flag = ''::varchar) THEN NULL ELSE rep.sample_eligibility_flag END, 'N'::varchar(1)) AS SampleAuthorization,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN 'OPEN TERR'::varchar(9) ELSE rep.team END AS CompanyName,
        rep.sales_force_id AS CompanyAbbr,
        ''::varchar AS CompanyID,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN 'OPEN TERR'::varchar(9) ELSE rep.business_unit_name END AS Department,
        CASE WHEN ((rep.first_name IS NULL) AND (rep.last_name = 'Vacant'::varchar(6))) THEN 'OPEN TERR'::varchar(9) ELSE rep.business_unit_name END AS Division,
        rep.business_address_line1 AS BusinessAddress1,
        rep.business_address_line2 AS BusinessAddress2,
        ''::varchar AS BusinessAddress3,
        rep.business_city AS BusinessAddressCity,
        rep.business_state AS BusinessAddressState,
        rep.business_zip AS BusinessZip,
        rep.business_country AS BusinessAddressCtry,
        'Active'::varchar(6) AS BusinessAddressStatus,
        rep.shipping_address_line1 AS ShippingAddress1,
        rep.shipping_address_line2 AS ShippingAddress2,
        ''::varchar AS ShippingAddress3,
        rep.shipping_city AS ShippingAddressCity,
        rep.shipping_state AS ShippingAddressState,
        rep.shipping_zip AS ShippingZip,
        rep.shipping_country AS "  ShippingAddressCtry",
        'Active'::varchar(6) AS ShippingAddressStatus,
        rep.samplestorage_address_line1 AS SampleStorageAddress1,
        rep.samplestorage_address_line2 AS SampleStorageAddress2,
        rep.samplestorage_address_line3 AS SampleStorageAddress3,
        rep.samplestorage_city AS SampleStorageAddressCity,
        rep.samplestorage_state AS SampleStorageAddressState,
        rep.samplestorage_zip AS SampleStorageAddressZip,
        rep.samplestorage_country AS SampleStorageAddressCtry,
        'Active'::varchar(6) AS SampleStorageAddressStatus,
        rep.samplestorage_address_line1 AS SampleShippingAddress1,
        rep.samplestorage_address_line2 AS SampleShippingAddress2,
        rep.samplestorage_address_line3 AS SampleShippingAddress3,
        rep.samplestorage_city AS SampleShippingAddressCity,
        rep.samplestorage_state AS SampleShippingAddressState,
        rep.samplestorage_zip AS SampleShippingAddressZip,
        rep.samplestorage_country AS SampleShippingAddressCtry,
        'Active'::varchar(6) AS SampleShippingAddressStatus,
        rep.business_phone AS BusinessPhone,
        rep.fax AS FaxPhone,
        rep.mobile_phone AS VoiceMailPhone,
        rep.voice_mail_extension AS VoiceMailExt,
        rep.hire_date AS HireDate,
        ''::varchar AS BirthDate,
        ''::varchar AS TerminationDate,
        coalesce(P1.basket_name, ''::varchar) AS Prod1,
        coalesce(P2.basket_name, ''::varchar) AS Prod2,
        coalesce(P3.basket_name, ''::varchar) AS Prod3,
        coalesce(P4.basket_name, ''::varchar) AS Prod4,
        coalesce(P5.basket_name, ''::varchar) AS Prod5,
        coalesce(P6.basket_name, ''::varchar) AS Prod6,
        ''::varchar AS Prod7,
        ''::varchar AS Prod8,
        ''::varchar AS Prod9,
        ''::varchar AS Prod10,
        ''::varchar AS Prod11,
        ''::varchar AS Prod12,
        ''::varchar AS Prod13,
        ''::varchar AS Prod14,
        ''::varchar AS Prod15,
        ''::varchar AS Prod16,
        ''::varchar AS Prod17,
        ''::varchar AS Prod18,
        ''::varchar AS Prod19,
        ''::varchar AS Prod20,
        ''::varchar AS Prod21,
        ''::varchar AS Prod22,
        ''::varchar AS Prod23,
        ''::varchar AS Prod24,
        ''::varchar AS Prod25,
        ''::varchar AS Prod26,
        ''::varchar AS Prod27,
        ''::varchar AS Prod28,
        ''::varchar AS Prod29,
        ''::varchar AS Prod30,
        CASE WHEN (CFT.Teva_ID IS NOT NULL) THEN 'CFT'::varchar(3) ELSE ''::varchar END AS Role1,
        CASE WHEN (CFT.Teva_ID IS NOT NULL) THEN '2'::varchar(1) ELSE ''::varchar END AS Role2,
        ''::varchar AS Role3,
        ''::varchar AS Role4,
        ''::varchar AS Role5,
        ''::varchar AS Role6,
        ''::varchar AS Role7,
        ''::varchar AS Role8,
        ''::varchar AS Role9,
        ''::varchar AS Role10,
        ''::varchar AS Role11,
        ''::varchar AS Role12,
        ''::varchar AS Role13,
        ''::varchar AS Role14,
        ''::varchar AS Role15,
        ''::varchar AS Role16,
        ''::varchar AS Role17,
        ''::varchar AS Role18,
        ''::varchar AS Role19,
        ''::varchar AS Role20,
        ''::varchar AS Attrib1,
        ''::varchar AS Attrib2,
        ''::varchar AS Attrib3,
        ''::varchar AS Attrib4,
        ''::varchar AS Attrib5,
        ''::varchar AS Attrib6,
        ''::varchar AS Attrib7,
        ''::varchar AS Attrib8,
        ''::varchar AS Attrib9,
        ''::varchar AS Attrib10
 FROM (((((((((datamart.sales_geography t FULL  JOIN datamart.roster rep ON ((t.geography_number = rep.territory_number))) LEFT  JOIN datamart.roster mgr ON ((mgr.global_employee_id = rep.supervisor_global_employee_id))) LEFT  JOIN outbound.i_bag_territory_product P1 ON (((coalesce(t.geography_number, rep.territory_number) = P1.territory_number) AND (P1.bag_name IS NOT NULL) AND (P1."position" = 1::float)))) LEFT  JOIN outbound.i_bag_territory_product P2 ON (((coalesce(t.geography_number, rep.territory_number) = P2.territory_number) AND (P2.bag_name IS NOT NULL) AND (P2."position" = 2::float)))) LEFT  JOIN outbound.i_bag_territory_product P3 ON (((coalesce(t.geography_number, rep.territory_number) = P3.territory_number) AND (P3.bag_name IS NOT NULL) AND (P3."position" = 2::float)))) LEFT  JOIN outbound.i_bag_territory_product P4 ON (((coalesce(t.geography_number, rep.territory_number) = P4.territory_number) AND (P4.bag_name IS NOT NULL) AND (P4."position" = 4::float)))) LEFT  JOIN outbound.i_bag_territory_product P5 ON (((coalesce(t.geography_number, rep.territory_number) = P5.territory_number) AND (P4.bag_name IS NOT NULL) AND (P4."position" = 5::float)))) LEFT  JOIN outbound.i_bag_territory_product P6 ON (((coalesce(t.geography_number, rep.territory_number) = P6.territory_number) AND (P6.bag_name IS NOT NULL) AND (P6."position" = 6::float)))) LEFT  JOIN reference.CERTIFIED_FIELD_TRAINER_XREF CFT ON ((rep.employee_id = CFT.Teva_ID)))
 WHERE (rep.sales_force_id = ANY (ARRAY['MA'::varchar(2), 'TE'::varchar(2), 'TM'::varchar(2), 'TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2), 'CG'::varchar(2), 'CM'::varchar(2), 'CS'::varchar(2), 'TX'::varchar(2), 'TZ'::varchar(2)]));

CREATE  VIEW outbound.Syneos_copay AS
 SELECT demo.ptr_territory_num,
        cw.redemption_type,
        cw.physician_tvcmid,
        cw.pharmacy_tvcmid,
        cw.basket_id,
        cw.basket_name,
        cw.asi_txn_id,
        cw.orig_asi_txn_id,
        cw.rx_num,
        cw.fill_date,
        cw.date_written,
        cw.days_supply,
        cw.ndc_code,
        cw.daw,
        cw.new_refill,
        cw.quantity,
        cw.refills,
        cw.other_coverage_code,
        cw.program_number,
        cw.copay_card_number,
        cw.sex,
        cw.age_at_redemption,
        cw.pharmacy_process_date,
        cw.nabp,
        cw.pharmacy_chain_number,
        cw.pharmacy_chain,
        cw.pharmacy_name,
        cw.pharmacy_address,
        cw.pharmacy_address2,
        cw.pharmacy_city,
        cw.pharmacy_state,
        cw.pharmacy_zip,
        cw.pharmacy_phone,
        cw.pharmacy_npi_num,
        cw.principle_physician_dea,
        cw.physician_npi,
        cw.physician_ims_id,
        cw.physician_veeva_id,
        cw.physician_name,
        cw.physician_address1,
        cw.physician_address2,
        cw.physician_city,
        cw.physician_state,
        cw.physician_zip,
        cw.rebate_amount,
        cw.member_cash_expense,
        cw.submitted_cost,
        cw.pharmacy_fee,
        cw.total_amount_due,
        cw.calc_awp,
        cw.occ_payment_type,
        cw.auth_refills,
        cw.claim_type,
        cw.administration_flag,
        cw.payer_name,
        cw.trans_type,
        cw.previous_payer_id,
        cw.benefit_amount,
        cw.patient_expense,
        cw.submission_method,
        cw.source_name,
        cw.patient_type,
        cw.primary_bin,
        cw.primary_bin_description,
        cw.reject_code
 FROM outbound.zs_copay_weekly cw, datamart.prescriber_combined_demo_frozen demo, datamart.current_alignment ca
 WHERE ((ca.zip_code = coalesce(cw.physician_zip, cw.pharmacy_zip)) AND (demo.ptr_zip = ca.zip_code) AND (demo.sales_force_id = ca.sales_force_id) AND (demo.ptr_territory_num IN ( SELECT roster.territory_number
 FROM datamart.roster
 WHERE (((roster.employee_id ~~* '%CWKU%'::varchar(6)) OR (roster.employee_id = ANY (ARRAY['A061823'::varchar(7), 'A805771'::varchar(7)])) OR (roster.employee_id = ANY (ARRAY['061823'::varchar(6), '805771'::varchar(6)]))) AND (roster.sales_force_id = 'TR'::varchar(2))))) AND (cw.basket_name ~~* '%digihaler%'::varchar(11)) AND (cw.fill_date > '2019-12-31'::date))
 GROUP BY demo.ptr_territory_num,
          cw.redemption_type,
          cw.physician_tvcmid,
          cw.pharmacy_tvcmid,
          cw.basket_id,
          cw.basket_name,
          cw.asi_txn_id,
          cw.orig_asi_txn_id,
          cw.rx_num,
          cw.fill_date,
          cw.date_written,
          cw.days_supply,
          cw.ndc_code,
          cw.daw,
          cw.new_refill,
          cw.quantity,
          cw.refills,
          cw.other_coverage_code,
          cw.program_number,
          cw.copay_card_number,
          cw.sex,
          cw.age_at_redemption,
          cw.pharmacy_process_date,
          cw.nabp,
          cw.pharmacy_chain_number,
          cw.pharmacy_chain,
          cw.pharmacy_name,
          cw.pharmacy_address,
          cw.pharmacy_address2,
          cw.pharmacy_city,
          cw.pharmacy_state,
          cw.pharmacy_zip,
          cw.pharmacy_phone,
          cw.pharmacy_npi_num,
          cw.principle_physician_dea,
          cw.physician_npi,
          cw.physician_ims_id,
          cw.physician_veeva_id,
          cw.physician_name,
          cw.physician_address1,
          cw.physician_address2,
          cw.physician_city,
          cw.physician_state,
          cw.physician_zip,
          cw.rebate_amount,
          cw.member_cash_expense,
          cw.submitted_cost,
          cw.pharmacy_fee,
          cw.total_amount_due,
          cw.calc_awp,
          cw.occ_payment_type,
          cw.auth_refills,
          cw.claim_type,
          cw.administration_flag,
          cw.payer_name,
          cw.trans_type,
          cw.previous_payer_id,
          cw.benefit_amount,
          cw.patient_expense,
          cw.submission_method,
          cw.source_name,
          cw.patient_type,
          cw.primary_bin,
          cw.primary_bin_description,
          cw.reject_code;

CREATE  VIEW sandbox.vw_comparison_iqvia_fid_delta_report AS
 SELECT a.iqvia_plan_code AS "IQVIA Plan Code",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_code = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Code Flag",
        a.iqvia_plan_name AS "IQVIA Plan Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Name Flag",
        a.iqvia_payer_name AS "IQVIA Payer Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name Flag",
        a.iqvia_pbm AS "IQVIA PBM",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM Flag",
        a.payment_type AS "Payment Type",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payment_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payment Type Flag",
        a.iqvia_model AS "IQVIA Model ",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_model = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Model  Flag",
        a.ftf_health_plan_fid AS "FTF Plan ID",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Plan ID Flag",
        a.ftf_health_plan_name AS "FTF Plan Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Plan Name Flag",
        a.ftf_health_plan_type AS "FTF Health Plan Type",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        a.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        a.key_controlling_account AS "Key Controlling Account",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        a.key_controlling_parent AS "Key Controlling Parent",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        a.payer_pbm AS "PBM/Payer",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "PBM/Payer Flag",
        a.ajovy_access_for_ftf_plan AS "Ajovy Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ajovy_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Ajovy Access for FTF Plan Flag",
        a.aimovig_access_for_ftf_plan AS "Aimovig Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_aimovig_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Aimovig Access for FTF Plan Flag",
        a.emgality_access_for_ftf_plan AS "Emgality Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_emgality_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Emgality Access for FTF Plan Flag",
        a.total_lives_for_ftf_plan AS "Total Lives for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_total_lives_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Total Lives for FTF Plan Flag",
        a.key_pbm AS "Key PBM",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        a.change_in_lives AS "Change in Lives",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        round((a.total_lives_for_ftf_plan / b.ck), 0) AS "Apportioned Lives for FTF/IQVIA Plan",
        a.month_flag,
        tbl_lvl_audit.date_run,
        (to_timestamptz((a.cycle_id)::float))::timestamp AS modified_time
 FROM ((sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1 a LEFT  JOIN ( SELECT vw_curr_comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid,
        count(*) AS ck
 FROM sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1
 GROUP BY vw_curr_comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid) b ON ((a.ftf_health_plan_fid = b.ftf_health_plan_fid))) LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_iqvia_fid_plans_cdw_v1'::varchar(33))))
 ORDER BY a.iqvia_plan_code,
          a.ftf_health_plan_fid,
          a.month_flag;

CREATE  VIEW sandbox.vw_teva_iqvia_bridge_mismatch_analysis AS
 SELECT bridge_dt.iqvia_payer_name AS "IQVIA Payer Name",
        bridge_dt.iqvia_plan_code AS IQVIA_Plan_Code,
        bridge_dt.iqvia_plan_name AS IQVIA_Plan_Name,
        bridge_dt.ftf_health_plan_fid AS "FTF Health Plan FID",
        bridge_dt.ftf_health_plan_name AS "FTF Health Plan Name",
        ftf_health_plans_preprocessed.ftf_provider_fid AS "FTF Provider FID",
        bridge_dt.ftf_provider_name AS "FTF Provider Name",
        bridge_dt.ftf_health_plan_type AS "FTF Health Plan Type",
        bridge_dt.paytype_index AS PayTypeIndex,
        bridge_dt.paytype AS "Pay Type",
        bridge_dt.hp_type AS "HP Type",
        bridge_dt.iqvia_paytype AS "IQVIA Pay Type",
        bridge_dt.model AS Model,
        bridge_dt.check_pay_types AS "Check Pay Types",
        bridge_dt.check_hp_types AS "Check HP Types",
        bridge_dt.iqvia_pbm AS "IQVIA PBM",
        bridge_dt.old_ftf_health_plan_type AS "Old_FTF Health Plan Type",
        (to_timestamptz((bridge_dt.cycle_id)::float))::timestamp AS modified_time,
        process_audit_tbl.date_run
 FROM ((sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 bridge_dt LEFT  JOIN sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 ftf_health_plans_preprocessed ON ((bridge_dt.ftf_health_plan_fid = ftf_health_plans_preprocessed.ftf_health_plan_fid))) LEFT  JOIN sandbox.process_audit_tbl process_audit_tbl ON (((bridge_dt.cycle_id = process_audit_tbl.cycle_id) AND (process_audit_tbl.process_id = 1) AND (process_audit_tbl.status = 'COMPLETED'::varchar(9)))))
 WHERE (coalesce(bridge_dt.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW sandbox.vw_ftf_formularies_pharmacy_status_check AS
 SELECT vw_curr_ftf_formularies_preprocessed_cdw_v1.drug_seq AS "Drug Seq",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid AS "FTF Health Plan FID",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.drug_id AS "Drug Id",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.tier_code AS "Tier Code",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.restrictions AS Restrictions,
        vw_curr_ftf_formularies_preprocessed_cdw_v1.reason_code AS "Reason Code",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.reason_code_description AS "Reason Code Description",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.pharmacy_status AS "Pharmacy Status",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.plan_lives AS "Plan Lives",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat AS "Check Pharmacy Status"
 FROM sandbox.vw_curr_ftf_formularies_preprocessed_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_controlling_account_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_controlling_account_product_coverage_category_commercial AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW sandbox.vw_final_extract_key_pbm_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_pbm_product_coverage_category_commercial AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_copay_tier AS
 SELECT vw_curr_paytype_product_copay_tier_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_copay_tier_cdw_v1.product AS Product,
        vw_curr_paytype_product_copay_tier_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_copay_tier_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_copay_tier_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_coverage_category AS
 SELECT vw_curr_paytype_product_coverage_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_coverage_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_coverage_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_coverage_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_coverage_category_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_patient_pa AS
 SELECT vw_curr_paytype_product_patient_pa_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_patient_pa_cdw_v1.product AS Product,
        vw_curr_paytype_product_patient_pa_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_patient_pa_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_patient_pa_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_step_edit_type AS
 SELECT vw_curr_paytype_product_step_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_step_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_step_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_step_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_step_category_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ftf_hp_id_key_controlling_plan_account AS
 SELECT lpad((vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm AS "Payer/PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_controlling_account_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ftf_hp_id_key_pbm AS
 SELECT lpad((vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm AS "Assigned IQVIA PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_pbm_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_iqvia_plan_code_ftf_hp_id AS
 SELECT lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type AS "Payment Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model AS "IQVIA Model",
        lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan AS "Ajovy Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan AS "Aimovig Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan AS "Emgality Access For FTF Plan",
        (vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan)::varchar AS "Total Lives For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm AS "Key PBM"
 FROM sandbox.vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1 UNION  SELECT '0000010001'::varchar(10) AS "IQVIA Plan Code",
        'CASH'::varchar(4) AS "IQVIA Plan Name",
        'CASH'::varchar(4) AS "IQVIA Payer Name",
        ''::varchar AS "IQVIA PBM",
        'CASH'::varchar(4) AS "Payment Type",
        ''::varchar AS "IQVIA Model",
        ''::varchar AS "FTF Health Plan FID",
        ''::varchar AS "FTF Health Plan Name",
        ''::varchar AS "FTF Health Plan Type",
        ''::varchar AS "Key Controlling Plan Formulary",
        ''::varchar AS "Key Controlling Account",
        ''::varchar AS "Key Controlling Parent",
        ''::varchar AS "Payer/PBM",
        ''::varchar AS "Ajovy Access For FTF Plan",
        ''::varchar AS "Aimovig Access For FTF Plan",
        ''::varchar AS "Emgality Access For FTF Plan",
        ''::varchar AS "Total Lives For FTF Plan",
        ''::varchar AS "Key PBM"
 FROM v_catalog.dual;

CREATE  VIEW sandbox.vw_final_extract_ftf_plan_master_file AS
 SELECT lpad((vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_plan_master_file_op_cdw_v1.product AS Product,
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.coverage_category AS "Coverage Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.plan_lives AS "Plan Lives",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_plan_master_file_op_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pharmacy_status AS "Pharmacy Status",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_tier AS "FTF Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restrictions AS Restrictions,
        vw_curr_ftf_plan_master_file_op_cdw_v1.copay_tier AS "Tier Cat",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restriction_category AS "Restriction Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.step AS Step,
        vw_curr_ftf_plan_master_file_op_cdw_v1.botox AS Botox,
        vw_curr_ftf_plan_master_file_op_cdw_v1.prescriber_pa AS "Prescriber PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.patient_pa AS "Patient PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.medical_records AS "Medical Records",
        vw_curr_ftf_plan_master_file_op_cdw_v1.criteria_unspec AS "Criteria Unspec"
 FROM sandbox.vw_curr_ftf_plan_master_file_op_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_key_controlling_account_summary AS
 SELECT vw_curr_key_ctl_account_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_ctl_account_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_ctl_account_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_ctl_account_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_ctl_account_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_ctl_account_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_key_pbm_summary AS
 SELECT vw_curr_key_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_pbm_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_iqvia_player_summary AS
 SELECT vw_curr_iqvia_payer_name_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_payer_name_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_iqvia_payer_name_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_payer_name_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_payer_name_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_iqvia_pbm_summary AS
 SELECT vw_curr_iqvia_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_pbm_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_iqvia_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_mgt_summary AS
 SELECT vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_management_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_infl_summary AS
 SELECT vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_claims_proc_summary AS
 SELECT vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_claims_processing_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_health_plan_detail AS
 SELECT lpad((vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_ajovy AS "Coverage Category Ajovy",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_aimovig AS "Coverage Category Aimovig",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_emgality AS "Coverage Category Emgality",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_access_master_bridge_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_access_master_bridge_cdw_v1.paytype AS "Payment Type",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_access_master_bridge_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_access_master_bridge_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_access_master_bridge_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_match_iqvia AS "FTF Match IQVIA",
        vw_curr_access_master_bridge_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_access_master_bridge_cdw_v1.previous_lives AS "Previous Month Lives",
        vw_curr_access_master_bridge_cdw_v1.current_lives AS "Current Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_access_master_bridge_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_cm_state_lives_formular_status AS
 SELECT lpad((vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_st_lives_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_st_lives_summary_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_st_lives_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_st_lives_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.state AS State,
        vw_curr_st_lives_summary_cdw_v1.ftf_state_hp_lives AS "FTF State HP Lives",
        vw_curr_st_lives_summary_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_st_lives_summary_cdw_v1.ajovy_formulary AS "Ajovy Formulary",
        vw_curr_st_lives_summary_cdw_v1.aimovig_formulary AS "Aimovig Formulary",
        vw_curr_st_lives_summary_cdw_v1.emgality_formulary AS "Emgality Formulary"
 FROM sandbox.vw_curr_st_lives_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_all_changes AS
 SELECT lpad((vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy AS "Coverage Category Ajovy",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig AS "Coverage Category Aimovig",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality AS "Coverage Category Emgality",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.paytype AS "Payment Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.lives_mn AS Lives,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.month_flag AS "Month Flag",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.status AS Status,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.change_in_lives AS "Change in Lives"
 FROM sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_payer_spine25_detailed_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_detailed_teva_brands_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_payer_spine25_plan_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_plan_teva_brands_cdw_v1;

CREATE  VIEW sandbox.vw_ftf_plan_change AS
 SELECT a.entity AS "Change Type",
        a.id AS ID,
        a.name AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM ((((((( SELECT 'Plan'::varchar(4) AS entity,
        curr_month_ftf_health_plans.formularyf_id AS id,
        curr_month_ftf_health_plans.health_plan AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ANTI  JOIN sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ON ((curr_month_ftf_health_plans.formularyf_id = prev_month_ftf_health_plans.formularyf_id))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        prev_month_ftf_health_plans.formularyf_id AS ftf_health_plan_fid,
        prev_month_ftf_health_plans.health_plan AS ftf_health_plan_name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ANTI  JOIN sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ON ((curr_month_ftf_health_plans.formularyf_id = prev_month_ftf_health_plans.formularyf_id)))) UNION  SELECT 'Provider'::varchar(8) AS entity,
        curr_month_ftf_health_plans.provider_id AS ftf_provider_fid,
        curr_month_ftf_health_plans.provider AS ftf_provider_name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ANTI  JOIN sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ON ((curr_month_ftf_health_plans.provider_id = prev_month_ftf_health_plans.provider_id)))) UNION  SELECT 'Provider'::varchar(8) AS entity,
        prev_month_ftf_health_plans.provider_id AS ftf_provider_fid,
        prev_month_ftf_health_plans.provider AS ftf_provider_name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ANTI  JOIN sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ON ((curr_month_ftf_health_plans.provider_id = prev_month_ftf_health_plans.provider_id)))) UNION  SELECT 'Pharmacy Status'::varchar(15) AS entity,
        NULL AS id,
        b.pharmacy_status,
        'Added'::varchar(5) AS status
 FROM ( SELECT curr_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs curr_month_ftf_formularies
 GROUP BY curr_month_ftf_formularies.pharmacy_status EXCEPT  SELECT prev_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs prev_month_ftf_formularies
 GROUP BY prev_month_ftf_formularies.pharmacy_status) b) UNION  SELECT 'Pharmacy Status'::varchar(15) AS entity,
        NULL AS id,
        b.pharmacy_status,
        'Added'::varchar(5) AS status
 FROM ( SELECT prev_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs prev_month_ftf_formularies
 GROUP BY prev_month_ftf_formularies.pharmacy_status EXCEPT  SELECT curr_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs curr_month_ftf_formularies
 GROUP BY curr_month_ftf_formularies.pharmacy_status) b) UNION  SELECT 'Health Plan Type'::varchar(16) AS entity,
        NULL AS id,
        b.plan_type_name,
        'Added'::varchar(5) AS status
 FROM ( SELECT curr_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans
 GROUP BY curr_month_ftf_health_plans.plan_type_name EXCEPT  SELECT prev_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans
 GROUP BY prev_month_ftf_health_plans.plan_type_name) b) UNION  SELECT 'Health Plan Type'::varchar(16) AS entity,
        NULL AS id,
        b.plan_type_name,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT prev_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans
 GROUP BY prev_month_ftf_health_plans.plan_type_name EXCEPT  SELECT curr_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans
 GROUP BY curr_month_ftf_health_plans.plan_type_name) b) a
 ORDER BY a.entity,
          a.status,
          a.id,
          a.name;

CREATE  VIEW sandbox.vw_bridge_mismatch_detailed_report AS
 SELECT bridge_dt.iqvia_payer_name AS "IQVIA Payer Name",
        bridge_dt.iqvia_plan_code AS "IQVIA Plan Code",
        bridge_dt.iqvia_plan_name AS "IQVIA Plan Name",
        bridge_dt.comments AS Comments,
        bridge_dt.ftf_health_plan_fid AS "FTF Health Plan FID",
        bridge_dt.ftf_health_plan_name AS "FTF Health Plan Name",
        ftf_health_plans_preprocessed.ftf_provider_fid AS "FTF Provider FID",
        bridge_dt.ftf_provider_name AS "FTF Provider Name",
        bridge_dt.ftf_health_plan_type AS "FTF Health Plan Type",
        bridge_dt.hp_type AS "HP Type",
        bridge_dt.overriden_ftf_plan_type AS "Overriden FTF Plan Type",
        bridge_dt.model AS Model,
        bridge_dt.iqvia_pbm AS "IQVIA PBM",
        bridge_dt.iqvia_paytype AS "IQVIA Paytype",
        bridge_dt.check_delete AS "Delete Flag",
        bridge_dt.paytype_index AS "Paytype Index",
        bridge_dt.paytype AS Paytype,
        bridge_dt.check_pay_types AS "Check Paytypes",
        bridge_dt.check_hp_types AS "Check HP Types",
        bridge_dt.old_ftf_health_plan_type AS "Old FTF health Plan Type"
 FROM ((sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 bridge_dt LEFT  JOIN sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 ftf_health_plans_preprocessed ON ((bridge_dt.ftf_health_plan_fid = ftf_health_plans_preprocessed.ftf_health_plan_fid))) LEFT  JOIN sandbox.process_audit_tbl process_audit_tbl ON (((bridge_dt.cycle_id = process_audit_tbl.cycle_id) AND (process_audit_tbl.process_id = 1) AND (process_audit_tbl.status = 'COMPLETED'::varchar(9)))))
 WHERE (coalesce(bridge_dt.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_product AS
SELECT v.VA_PRODUCT AS va_product, v.WK_PROD_CODE AS prod_code, upper(v.CEPH_PROD_DESC) AS prod_name, coalesce(p.brand_code, v.WK_PROD_CODE) AS brand_code, coalesce(p.brand_name, upper(v.CEPH_PROD_DESC)) AS brand_name, coalesce(p.market_code, v.WK_PROD_CODE) AS market_code, CASE WHEN (v.WK_PROD_CODE = 'TR0900'::varchar(6)) THEN 'RESPIRATORY'::varchar(11) ELSE CASE WHEN (v.WK_PROD_CODE = 'TW0900'::varchar(6)) THEN 'WOMENS HEALTH'::varchar(13) ELSE p.market_name END END AS market_name FROM (CUSTOMER.DIM_VA_PRODUCT_XREF v LEFT JOIN CUSTOMER.dim_product p ON ((v.WK_PROD_CODE = p.product_code))) WHERE (v.WK_PROD_CODE <> ALL (ARRAY['200102'::varchar(6), '200104'::varchar(6), '200112'::varchar(6), '200116'::varchar(6), 'V00100'::varchar(6)]));

CREATE  VIEW WSMP_ADMIN_ORA.ext_asi_voucher_detail_wkly AS
 SELECT EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.TRANS_TYPE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_TXN_ID,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ORIG_ASI_TXN_ID,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.RX_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.RX_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.DATE_WRITTEN,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.DAYS_SUPPLY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.NDC_CODE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.DAW,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.DRUG_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.DRUG_DESC,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.NEW_REFILL,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.QUANTITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.REFILLS,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.OTHER_COVERAGE_CODE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.GROUP_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.COUPON_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.SEX,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.AGE_AT_REDEMPTION,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_PROCESS_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_CHAIN_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.NABP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_CHAIN,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_ADDRESS,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_ADDRESS2,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_CITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_STATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_ZIP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_PHONE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_NPI_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PRINCIPLE_PHYS_DEA_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHYS_NPI,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHYSICIAN_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_PHYS_ADDRESS1,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_PHYS_ADDRESS2,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_PHYS_CITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_PHYS_STATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.ASI_PHYS_ZIP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.REBATE_AMOUNT,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.MEMBER_CASH_EXPENSE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.SUBMITTED_COST,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.PHARMACY_FEE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.TOTAL_AMOUNT_DUE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.CALC_AWP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.CREATE_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER.OCC_PAYMENT_TYPE
 FROM teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_VOUCHER UNION ALL  SELECT EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.TRANS_TYPE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_TXN_ID,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ORIG_ASI_TXN_ID,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.RX_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.RX_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.DATE_WRITTEN,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.DAYS_SUPPLY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.NDC_CODE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.DAW,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.DRUG_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.DRUG_DESC,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.NEW_REFILL,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.QUANTITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.REFILLS,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.OTHER_COVERAGE_CODE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.GROUP_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.COUPON_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.SEX,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.AGE_AT_REDEMPTION,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_PROCESS_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_CHAIN_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.NABP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_CHAIN,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_ADDRESS,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_ADDRESS2,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_CITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_STATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_ZIP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_PHONE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_NPI_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PRINCIPLE_PHYS_DEA_NUM,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHYS_NPI,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHYSICIAN_NAME,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_PHYS_ADDRESS1,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_PHYS_ADDRESS2,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_PHYS_CITY,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_PHYS_STATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.ASI_PHYS_ZIP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.REBATE_AMOUNT,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.MEMBER_CASH_EXPENSE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.SUBMITTED_COST,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.PHARMACY_FEE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.TOTAL_AMOUNT_DUE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.CALC_AWP,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.CREATE_DATE,
        EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1.OCC_PAYMENT_TYPE
 FROM teva_ingestion.EXT_ASI_VOUCHER_DETAIL_WKLY_COMBO_1;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_mm_ram_to_rsm AS
SELECT x.MM_RAM, x.RSM FROM (SELECT a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2)) AS RSM FROM (teva_ingestion.EXT_MM_RAM_TO_STATE a JOIN WSMP_ADMIN.KC_ZIP_TO_TERRITORY b ON ((a.STATE = b.STATE))) WHERE ((substr(b.TERRITORY_NUM, 5, 2) <> 'ZZ'::varchar(2)) AND (b.TERRITORY_NAME IS NOT NULL)) GROUP BY a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2))) x;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_rems_account_backup AS
SELECT stg.ASI_ACCOUNT_ID AS HCP_ID, align.TERRITORY_NUM AS territory_num, stg.SITE_NAME AS ACCOUNT_NAME, stg.ADDRESS_1 AS ADDRESS1, stg.ADDRESS_2 AS ADDRESS2, NULL AS ADDRESS3, stg.CITY, stg.STATE, stg.ZIP_CODE AS ZIP, 'Y'::varchar(1) AS PRIMARY_ADDRESS, stg.PHONE_NUMBER, fact.IMS_ORG_ID AS EXTERNAL_ID, 'HOSPITAL'::varchar(8) AS CUSTOMER_TYPE, NULL AS BPNUMBER, NULL AS SUBTYPE FROM ((WSMP_ADMIN.STG_REMS_FACILITY stg LEFT JOIN (SELECT ext_kc_zip_to_territory.ZIP, ext_kc_zip_to_territory.CITY, ext_kc_zip_to_territory.STATE, ext_kc_zip_to_territory.TERRITORY_NUM, ext_kc_zip_to_territory.TERRITORY_NAME, ext_kc_zip_to_territory.AREA_NAME, ext_kc_zip_to_territory.REGION_NAME, ext_kc_zip_to_territory.SALES_FORCE_ID, ext_kc_zip_to_territory.ORGANIZATION_CODE, ext_kc_zip_to_territory.INACTIVE_FLAG, ext_kc_zip_to_territory.COMMENTS, ext_kc_zip_to_territory.MIRROR_FLAG, ext_kc_zip_to_territory.MIRROR_TERRITORY_NUM, ext_kc_zip_to_territory.batch_id, ext_kc_zip_to_territory.row_id, ext_kc_zip_to_territory.update_ts FROM teva_ingestion.ext_kc_zip_to_territory WHERE (ext_kc_zip_to_territory.SALES_FORCE_ID = 'TB'::varchar(2))) align ON ((substr(stg.ZIP_CODE, 1, 5) = align.ZIP))) LEFT JOIN WSMP_ADMIN.HCOS_IDENTIFIER_FACT fact ON (((fact.IDENTIFIER_ID = 15::numeric(18,0)) AND (fact.IDENTIFIER = stg.NPI)))) WHERE (stg.VEEVA_ACCOUNT_ID IS NULL);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Fentora_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx, CUSTOMER.dim_product p WHERE ((rx.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.product_code = p.product_code)) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_roster AS
SELECT r.TERRITORY_NUM AS territory_num, r.LAST_NAME AS last_name, r.FIRST_NAME AS first_name, r.SHIP_ADDRESS_LINE1 AS ship_address_line1, r.SHIP_ADDRESS_LINE2 AS ship_address_line2, r.SHIP_CITY AS ship_city, r.SHIP_STATE AS ship_state, r.SHIP_ZIP AS ship_zip, coalesce(r.BUSINESS_PHONE, r.CELL_PHONE, r.HOME_PHONE) AS phone, r.EMAIL AS email, CASE WHEN (r.REP_TYPE = 'REP'::varchar(3)) THEN p.m_territory_num WHEN (r.REP_TYPE = 'RM'::varchar(2)) THEN r.TERRITORY_NUM ELSE NULL END AS district, CASE WHEN (r.REP_TYPE = 'REP'::varchar(3)) THEN p.d_territory_num WHEN (r.REP_TYPE = 'RM'::varchar(2)) THEN r.PARENT_TERRITORY_NUM WHEN (r.REP_TYPE = 'AD'::varchar(2)) THEN r.TERRITORY_NUM ELSE NULL END AS region FROM (WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA r LEFT JOIN WSMP_ADMIN.v_roster_teva_rep_mgr_dir p ON (((r.TERRITORY_NUM = p.rep_territory_num) AND (r.EMPLOYEE_ID = p.rep_emp_id)))) WHERE ((r.SALES_FORCE_ID = ANY (ARRAY['TO'::varchar(2), 'TN'::varchar(2)])) AND (r.LAST_NAME <> 'Vacant'::varchar(6)) AND (r.REP_TYPE = ANY (ARRAY['REP'::varchar(3), 'RM'::varchar(2), 'AD'::varchar(2)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tw AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TW'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tr AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TR'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tc_tn_tp AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tb AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TB'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.stg_ims_npi AS
SELECT y.ims_id, y.npi FROM (SELECT x.ims_id, x.npi, row_number() OVER (PARTITION BY x.ims_id ORDER BY x.rnk, x.npi) AS rnk FROM (SELECT x1.ID_NUM AS ims_id, x2.ID_NUM AS npi, 1 AS rnk FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID))) WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'NPI'::varchar(3))) UNION SELECT hcos_professional.IMS_ID AS ims_id, hcos_professional.NPI AS npi, 2 AS rnk FROM WSMP_ADMIN.HCOS_PROFESSIONAL WHERE ((hcos_professional.IMS_ID IS NOT NULL) AND (hcos_professional.NPI IS NOT NULL))) x) y WHERE (y.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_do_not_promote_with_veevaid AS
(((SELECT d.SALES_FORCE_ID AS sales_force_id, acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, d.PRODUCT_NAME AS product_name, d.SPECIALTY_GROUP AS specialty_group, 'N'::varchar(1) AS app, CASE WHEN (d.DEBARRED = 'Y'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP FROM (((WSMP_ADMIN.DIM_DNC d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (d.SALES_FORCE_ID = sln.sales_force_id)))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) UNION SELECT 'TC'::varchar(2), acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7), d.SPECIALTY_PRIMARY_CODE AS specialty_primary_code, 'N'::varchar(1) AS APP, 'Y'::varchar(1) AS DNP FROM (((WSMP_ADMIN.DEBARRED d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (sln.sales_force_id = 'TC'::varchar(2))))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) WHERE (d.CURRENT_IND = 'Y'::varchar(1)) GROUP BY 'TC'::varchar(2), acct.ID, sln.state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7), d.SPECIALTY_PRIMARY_CODE, 'N'::varchar(1), 'Y'::varchar(1)) UNION SELECT 'TP'::varchar(2), acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, 'FENTORA'::varchar(7), d.SPECIALTY_PRIMARY_CODE AS specialty_primary_code, 'N'::varchar(1) AS APP, 'Y'::varchar(1) AS DNP FROM (((WSMP_ADMIN.DEBARRED d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (sln.sales_force_id = 'TP'::varchar(2))))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) WHERE (d.CURRENT_IND = 'Y'::varchar(1)) GROUP BY 'TP'::varchar(2), acct.ID, sln.state_license_number, dea.dea_num, 'FENTORA'::varchar(7), d.SPECIALTY_PRIMARY_CODE, 'N'::varchar(1), 'Y'::varchar(1)) UNION SELECT 'TC'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app, 'N'::varchar(1) AS DNP FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.stg_ims_dea dea ON ((acct.ID_VOD__C = dea.ims_id))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.NUVIGIL_APP_TVA__C = 'true'::varchar(4))) UNION SELECT 'TP'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.dea_num, 'FENTORA'::varchar(7) AS product_name, SSX.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app, 'N'::varchar(1) AS DNP FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.stg_ims_dea dea ON ((acct.ID_VOD__C = dea.ims_id))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF SSX ON ((acct.SPECIALTY_1_VOD__C = SSX.SPECIALTY_DESCRIPTION))) WHERE (acct.FENTORA_APP_TVA__C = 'true'::varchar(4));

CREATE  VIEW metadata.raw_view_counts_by_file_id AS
 SELECT A.raw_view,
        A.file_id,
        A.counts
 FROM ((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((( SELECT 'raw.addresses'::varchar(13) AS raw_view,
        addresses.file_id,
        count(*) AS counts
 FROM raw.addresses
 GROUP BY 'raw.addresses'::varchar(13),
          addresses.file_id UNION ALL  SELECT 'raw.associates'::varchar(14) AS raw_view,
        associates.file_id,
        count(*) AS counts
 FROM raw.associates
 GROUP BY 'raw.associates'::varchar(14),
          associates.file_id) UNION ALL  SELECT 'raw.aud_associates'::varchar(18) AS raw_view,
        aud_associates.file_id,
        count(*) AS counts
 FROM raw.aud_associates
 GROUP BY 'raw.aud_associates'::varchar(18),
          aud_associates.file_id) UNION ALL  SELECT 'raw.c_bo_hce_alt_identifier'::varchar(27) AS raw_view,
        c_bo_hce_alt_identifier.file_id,
        count(*) AS counts
 FROM raw.c_bo_hce_alt_identifier
 GROUP BY 'raw.c_bo_hce_alt_identifier'::varchar(27),
          c_bo_hce_alt_identifier.file_id) UNION ALL  SELECT 'raw.c_bo_hce_raw_dea'::varchar(20) AS raw_view,
        c_bo_hce_raw_dea.file_id,
        count(*) AS counts
 FROM raw.c_bo_hce_raw_dea
 GROUP BY 'raw.c_bo_hce_raw_dea'::varchar(20),
          c_bo_hce_raw_dea.file_id) UNION ALL  SELECT 'raw.c_bo_hcp_detail'::varchar(19) AS raw_view,
        c_bo_hcp_detail.file_id,
        count(*) AS counts
 FROM raw.c_bo_hcp_detail
 GROUP BY 'raw.c_bo_hcp_detail'::varchar(19),
          c_bo_hcp_detail.file_id) UNION ALL  SELECT 'raw.c_bo_ims_flag'::varchar(17) AS raw_view,
        c_bo_ims_flag.file_id,
        count(*) AS counts
 FROM raw.c_bo_ims_flag
 GROUP BY 'raw.c_bo_ims_flag'::varchar(17),
          c_bo_ims_flag.file_id) UNION ALL  SELECT 'raw.c_bo_teva_flag'::varchar(18) AS raw_view,
        c_bo_teva_flag.file_id,
        count(*) AS counts
 FROM raw.c_bo_teva_flag
 GROUP BY 'raw.c_bo_teva_flag'::varchar(18),
          c_bo_teva_flag.file_id) UNION ALL  SELECT 'raw.c_bo_teva_sample_elig'::varchar(25) AS raw_view,
        c_bo_teva_sample_elig.file_id,
        count(*) AS counts
 FROM raw.c_bo_teva_sample_elig
 GROUP BY 'raw.c_bo_teva_sample_elig'::varchar(25),
          c_bo_teva_sample_elig.file_id) UNION ALL  SELECT 'raw.ext_ahm_event'::varchar(17) AS raw_view,
        ext_ahm_event.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event
 GROUP BY 'raw.ext_ahm_event'::varchar(17),
          ext_ahm_event.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_attendee'::varchar(26) AS raw_view,
        ext_ahm_event_attendee.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_attendee
 GROUP BY 'raw.ext_ahm_event_attendee'::varchar(26),
          ext_ahm_event_attendee.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_count'::varchar(23) AS raw_view,
        ext_ahm_event_count.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_count
 GROUP BY 'raw.ext_ahm_event_count'::varchar(23),
          ext_ahm_event_count.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_expense'::varchar(25) AS raw_view,
        ext_ahm_event_expense.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_expense
 GROUP BY 'raw.ext_ahm_event_expense'::varchar(25),
          ext_ahm_event_expense.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_host'::varchar(22) AS raw_view,
        ext_ahm_event_host.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_host
 GROUP BY 'raw.ext_ahm_event_host'::varchar(22),
          ext_ahm_event_host.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_product'::varchar(25) AS raw_view,
        ext_ahm_event_product.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_product
 GROUP BY 'raw.ext_ahm_event_product'::varchar(25),
          ext_ahm_event_product.file_id) UNION ALL  SELECT 'raw.ext_ahm_event_speaker'::varchar(25) AS raw_view,
        ext_ahm_event_speaker.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_event_speaker
 GROUP BY 'raw.ext_ahm_event_speaker'::varchar(25),
          ext_ahm_event_speaker.file_id) UNION ALL  SELECT 'raw.ext_ahm_organization'::varchar(24) AS raw_view,
        ext_ahm_organization.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_organization
 GROUP BY 'raw.ext_ahm_organization'::varchar(24),
          ext_ahm_organization.file_id) UNION ALL  SELECT 'raw.ext_ahm_speaker_contract'::varchar(28) AS raw_view,
        ext_ahm_speaker_contract.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_speaker_contract
 GROUP BY 'raw.ext_ahm_speaker_contract'::varchar(28),
          ext_ahm_speaker_contract.file_id) UNION ALL  SELECT 'raw.ext_ahm_speaker_license'::varchar(27) AS raw_view,
        ext_ahm_speaker_license.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_speaker_license
 GROUP BY 'raw.ext_ahm_speaker_license'::varchar(27),
          ext_ahm_speaker_license.file_id) UNION ALL  SELECT 'raw.ext_ahm_speaker_profile'::varchar(27) AS raw_view,
        ext_ahm_speaker_profile.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_speaker_profile
 GROUP BY 'raw.ext_ahm_speaker_profile'::varchar(27),
          ext_ahm_speaker_profile.file_id) UNION ALL  SELECT 'raw.ext_ahm_speaker_training'::varchar(28) AS raw_view,
        ext_ahm_speaker_training.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_speaker_training
 GROUP BY 'raw.ext_ahm_speaker_training'::varchar(28),
          ext_ahm_speaker_training.file_id) UNION ALL  SELECT 'raw.ext_ahm_topic_product'::varchar(25) AS raw_view,
        ext_ahm_topic_product.file_id,
        count(*) AS counts
 FROM raw.ext_ahm_topic_product
 GROUP BY 'raw.ext_ahm_topic_product'::varchar(25),
          ext_ahm_topic_product.file_id) UNION ALL  SELECT 'raw.ext_anda_sales'::varchar(18) AS raw_view,
        ext_anda_sales.file_id,
        count(*) AS counts
 FROM raw.ext_anda_sales
 GROUP BY 'raw.ext_anda_sales'::varchar(18),
          ext_anda_sales.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_detail_wkly'::varchar(29) AS raw_view,
        ext_asi_copay_detail_wkly.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_detail_wkly
 GROUP BY 'raw.ext_asi_copay_detail_wkly'::varchar(29),
          ext_asi_copay_detail_wkly.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_detail_wkly_cgd'::varchar(33) AS raw_view,
        ext_asi_copay_detail_wkly_cgd.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_detail_wkly_cgd
 GROUP BY 'raw.ext_asi_copay_detail_wkly_cgd'::varchar(33),
          ext_asi_copay_detail_wkly_cgd.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_detail_wkly_combo_2'::varchar(37) AS raw_view,
        ext_asi_copay_detail_wkly_combo_2.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_detail_wkly_combo_2
 GROUP BY 'raw.ext_asi_copay_detail_wkly_combo_2'::varchar(37),
          ext_asi_copay_detail_wkly_combo_2.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_detail_wkly_combo_3'::varchar(37) AS raw_view,
        ext_asi_copay_detail_wkly_combo_3.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_detail_wkly_combo_3
 GROUP BY 'raw.ext_asi_copay_detail_wkly_combo_3'::varchar(37),
          ext_asi_copay_detail_wkly_combo_3.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_detail_wkly_pskw'::varchar(34) AS raw_view,
        ext_asi_copay_detail_wkly_pskw.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_detail_wkly_pskw
 GROUP BY 'raw.ext_asi_copay_detail_wkly_pskw'::varchar(34),
          ext_asi_copay_detail_wkly_pskw.file_id) UNION ALL  SELECT 'raw.ext_asi_copay_redemptions'::varchar(29) AS raw_view,
        ext_asi_copay_redemptions.file_id,
        count(*) AS counts
 FROM raw.ext_asi_copay_redemptions
 GROUP BY 'raw.ext_asi_copay_redemptions'::varchar(29),
          ext_asi_copay_redemptions.file_id) UNION ALL  SELECT 'raw.ext_asi_redemptions'::varchar(23) AS raw_view,
        ext_asi_redemptions.file_id,
        count(*) AS counts
 FROM raw.ext_asi_redemptions
 GROUP BY 'raw.ext_asi_redemptions'::varchar(23),
          ext_asi_redemptions.file_id) UNION ALL  SELECT 'raw.ext_asi_voucher_detail_wkly_combo_1'::varchar(39) AS raw_view,
        ext_asi_voucher_detail_wkly_combo_1.file_id,
        count(*) AS counts
 FROM raw.ext_asi_voucher_detail_wkly_combo_1
 GROUP BY 'raw.ext_asi_voucher_detail_wkly_combo_1'::varchar(39),
          ext_asi_voucher_detail_wkly_combo_1.file_id) UNION ALL  SELECT 'raw.ext_asi_voucher_detail_wkly_voucher'::varchar(39) AS raw_view,
        ext_asi_voucher_detail_wkly_voucher.file_id,
        count(*) AS counts
 FROM raw.ext_asi_voucher_detail_wkly_voucher
 GROUP BY 'raw.ext_asi_voucher_detail_wkly_voucher'::varchar(39),
          ext_asi_voucher_detail_wkly_voucher.file_id) UNION ALL  SELECT 'raw.ext_call_goals_kc'::varchar(21) AS raw_view,
        ext_call_goals_kc.file_id,
        count(*) AS counts
 FROM raw.ext_call_goals_kc
 GROUP BY 'raw.ext_call_goals_kc'::varchar(21),
          ext_call_goals_kc.file_id) UNION ALL  SELECT 'raw.ext_caremark_rx2_aob'::varchar(24) AS raw_view,
        ext_caremark_rx2_aob.file_id,
        count(*) AS counts
 FROM raw.ext_caremark_rx2_aob
 GROUP BY 'raw.ext_caremark_rx2_aob'::varchar(24),
          ext_caremark_rx2_aob.file_id) UNION ALL  SELECT 'raw.ext_caremark_rx2_medicare'::varchar(29) AS raw_view,
        ext_caremark_rx2_medicare.file_id,
        count(*) AS counts
 FROM raw.ext_caremark_rx2_medicare
 GROUP BY 'raw.ext_caremark_rx2_medicare'::varchar(29),
          ext_caremark_rx2_medicare.file_id) UNION ALL  SELECT 'raw.ext_clm_presentation_slide_vc'::varchar(33) AS raw_view,
        ext_clm_presentation_slide_vc.file_id,
        count(*) AS counts
 FROM raw.ext_clm_presentation_slide_vc
 GROUP BY 'raw.ext_clm_presentation_slide_vc'::varchar(33),
          ext_clm_presentation_slide_vc.file_id) UNION ALL  SELECT 'raw.ext_clm_presentation_vod__c'::varchar(31) AS raw_view,
        ext_clm_presentation_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_clm_presentation_vod__c
 GROUP BY 'raw.ext_clm_presentation_vod__c'::varchar(31),
          ext_clm_presentation_vod__c.file_id) UNION ALL  SELECT 'raw.ext_clozapine_unit_ap'::varchar(25) AS raw_view,
        ext_clozapine_unit_ap.file_id,
        count(*) AS counts
 FROM raw.ext_clozapine_unit_ap
 GROUP BY 'raw.ext_clozapine_unit_ap'::varchar(25),
          ext_clozapine_unit_ap.file_id) UNION ALL  SELECT 'raw.ext_cmop_rx_data_teva'::varchar(25) AS raw_view,
        ext_cmop_rx_data_teva.file_id,
        count(*) AS counts
 FROM raw.ext_cmop_rx_data_teva
 GROUP BY 'raw.ext_cmop_rx_data_teva'::varchar(25),
          ext_cmop_rx_data_teva.file_id) UNION ALL  SELECT 'raw.ext_customer_flags'::varchar(22) AS raw_view,
        ext_customer_flags.file_id,
        count(*) AS counts
 FROM raw.ext_customer_flags
 GROUP BY 'raw.ext_customer_flags'::varchar(22),
          ext_customer_flags.file_id) UNION ALL  SELECT 'raw.ext_ddd_dod_qty'::varchar(19) AS raw_view,
        ext_ddd_dod_qty.file_id,
        count(*) AS counts
 FROM raw.ext_ddd_dod_qty
 GROUP BY 'raw.ext_ddd_dod_qty'::varchar(19),
          ext_ddd_dod_qty.file_id) UNION ALL  SELECT 'raw.ext_ddd_dod_sales_ms'::varchar(24) AS raw_view,
        ext_ddd_dod_sales_ms.file_id,
        count(*) AS counts
 FROM raw.ext_ddd_dod_sales_ms
 GROUP BY 'raw.ext_ddd_dod_sales_ms'::varchar(24),
          ext_ddd_dod_sales_ms.file_id) UNION ALL  SELECT 'raw.ext_ddd_dod_sales_pd'::varchar(24) AS raw_view,
        ext_ddd_dod_sales_pd.file_id,
        count(*) AS counts
 FROM raw.ext_ddd_dod_sales_pd
 GROUP BY 'raw.ext_ddd_dod_sales_pd'::varchar(24),
          ext_ddd_dod_sales_pd.file_id) UNION ALL  SELECT 'raw.ext_diplomat_enrollment'::varchar(27) AS raw_view,
        ext_diplomat_enrollment.file_id,
        count(*) AS counts
 FROM raw.ext_diplomat_enrollment
 GROUP BY 'raw.ext_diplomat_enrollment'::varchar(27),
          ext_diplomat_enrollment.file_id) UNION ALL  SELECT 'raw.ext_diplomat_rx'::varchar(19) AS raw_view,
        ext_diplomat_rx.file_id,
        count(*) AS counts
 FROM raw.ext_diplomat_rx
 GROUP BY 'raw.ext_diplomat_rx'::varchar(19),
          ext_diplomat_rx.file_id) UNION ALL  SELECT 'raw.ext_f60q'::varchar(12) AS raw_view,
        ext_f60q.file_id,
        count(*) AS counts
 FROM raw.ext_f60q
 GROUP BY 'raw.ext_f60q'::varchar(12),
          ext_f60q.file_id) UNION ALL  SELECT 'raw.ext_factory_sales_852'::varchar(25) AS raw_view,
        ext_factory_sales_852.file_id,
        count(*) AS counts
 FROM raw.ext_factory_sales_852
 GROUP BY 'raw.ext_factory_sales_852'::varchar(25),
          ext_factory_sales_852.file_id) UNION ALL  SELECT 'raw.ext_ftf_accounts'::varchar(20) AS raw_view,
        ext_ftf_accounts.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_accounts
 GROUP BY 'raw.ext_ftf_accounts'::varchar(20),
          ext_ftf_accounts.file_id) UNION ALL  SELECT 'raw.ext_ftf_control'::varchar(19) AS raw_view,
        ext_ftf_control.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_control
 GROUP BY 'raw.ext_ftf_control'::varchar(19),
          ext_ftf_control.file_id) UNION ALL  SELECT 'raw.ext_ftf_copays'::varchar(18) AS raw_view,
        ext_ftf_copays.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_copays
 GROUP BY 'raw.ext_ftf_copays'::varchar(18),
          ext_ftf_copays.file_id) UNION ALL  SELECT 'raw.ext_ftf_drug_class_thrptc_area'::varchar(34) AS raw_view,
        ext_ftf_drug_class_thrptc_area.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_drug_class_thrptc_area
 GROUP BY 'raw.ext_ftf_drug_class_thrptc_area'::varchar(34),
          ext_ftf_drug_class_thrptc_area.file_id) UNION ALL  SELECT 'raw.ext_ftf_drugs'::varchar(17) AS raw_view,
        ext_ftf_drugs.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_drugs
 GROUP BY 'raw.ext_ftf_drugs'::varchar(17),
          ext_ftf_drugs.file_id) UNION ALL  SELECT 'raw.ext_ftf_formularies'::varchar(23) AS raw_view,
        ext_ftf_formularies.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_formularies
 GROUP BY 'raw.ext_ftf_formularies'::varchar(23),
          ext_ftf_formularies.file_id) UNION ALL  SELECT 'raw.ext_ftf_health_plan_geography'::varchar(33) AS raw_view,
        ext_ftf_health_plan_geography.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_health_plan_geography
 GROUP BY 'raw.ext_ftf_health_plan_geography'::varchar(33),
          ext_ftf_health_plan_geography.file_id) UNION ALL  SELECT 'raw.ext_ftf_health_plans'::varchar(24) AS raw_view,
        ext_ftf_health_plans.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_health_plans
 GROUP BY 'raw.ext_ftf_health_plans'::varchar(24),
          ext_ftf_health_plans.file_id) UNION ALL  SELECT 'raw.ext_ftf_ims_bridge'::varchar(22) AS raw_view,
        ext_ftf_ims_bridge.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_ims_bridge
 GROUP BY 'raw.ext_ftf_ims_bridge'::varchar(22),
          ext_ftf_ims_bridge.file_id) UNION ALL  SELECT 'raw.ext_ftf_pbms'::varchar(16) AS raw_view,
        ext_ftf_pbms.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_pbms
 GROUP BY 'raw.ext_ftf_pbms'::varchar(16),
          ext_ftf_pbms.file_id) UNION ALL  SELECT 'raw.ext_ftf_restrictions'::varchar(24) AS raw_view,
        ext_ftf_restrictions.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_restrictions
 GROUP BY 'raw.ext_ftf_restrictions'::varchar(24),
          ext_ftf_restrictions.file_id) UNION ALL  SELECT 'raw.ext_ftf_teva_wk_bridge'::varchar(26) AS raw_view,
        ext_ftf_teva_wk_bridge.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_teva_wk_bridge
 GROUP BY 'raw.ext_ftf_teva_wk_bridge'::varchar(26),
          ext_ftf_teva_wk_bridge.file_id) UNION ALL  SELECT 'raw.ext_ftf_tiers'::varchar(17) AS raw_view,
        ext_ftf_tiers.file_id,
        count(*) AS counts
 FROM raw.ext_ftf_tiers
 GROUP BY 'raw.ext_ftf_tiers'::varchar(17),
          ext_ftf_tiers.file_id) UNION ALL  SELECT 'raw.ext_hcos_aco_detail'::varchar(23) AS raw_view,
        ext_hcos_aco_detail.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_aco_detail
 GROUP BY 'raw.ext_hcos_aco_detail'::varchar(23),
          ext_hcos_aco_detail.file_id) UNION ALL  SELECT 'raw.ext_hcos_aco_detail_fact'::varchar(28) AS raw_view,
        ext_hcos_aco_detail_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_aco_detail_fact
 GROUP BY 'raw.ext_hcos_aco_detail_fact'::varchar(28),
          ext_hcos_aco_detail_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_aco_org_fact'::varchar(25) AS raw_view,
        ext_hcos_aco_org_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_aco_org_fact
 GROUP BY 'raw.ext_hcos_aco_org_fact'::varchar(25),
          ext_hcos_aco_org_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_aco_professional_rstr'::varchar(34) AS raw_view,
        ext_hcos_aco_professional_rstr.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_aco_professional_rstr
 GROUP BY 'raw.ext_hcos_aco_professional_rstr'::varchar(34),
          ext_hcos_aco_professional_rstr.file_id) UNION ALL  SELECT 'raw.ext_hcos_aco_type'::varchar(21) AS raw_view,
        ext_hcos_aco_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_aco_type
 GROUP BY 'raw.ext_hcos_aco_type'::varchar(21),
          ext_hcos_aco_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_affiliation_type'::varchar(29) AS raw_view,
        ext_hcos_affiliation_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_affiliation_type
 GROUP BY 'raw.ext_hcos_affiliation_type'::varchar(29),
          ext_hcos_affiliation_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_bed_cluster_type'::varchar(29) AS raw_view,
        ext_hcos_bed_cluster_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_bed_cluster_type
 GROUP BY 'raw.ext_hcos_bed_cluster_type'::varchar(29),
          ext_hcos_bed_cluster_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_bed_fact'::varchar(21) AS raw_view,
        ext_hcos_bed_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_bed_fact
 GROUP BY 'raw.ext_hcos_bed_fact'::varchar(21),
          ext_hcos_bed_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_bed_type'::varchar(21) AS raw_view,
        ext_hcos_bed_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_bed_type
 GROUP BY 'raw.ext_hcos_bed_type'::varchar(21),
          ext_hcos_bed_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_business'::varchar(21) AS raw_view,
        ext_hcos_business.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_business
 GROUP BY 'raw.ext_hcos_business'::varchar(21),
          ext_hcos_business.file_id) UNION ALL  SELECT 'raw.ext_hcos_business_detail'::varchar(28) AS raw_view,
        ext_hcos_business_detail.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_business_detail
 GROUP BY 'raw.ext_hcos_business_detail'::varchar(28),
          ext_hcos_business_detail.file_id) UNION ALL  SELECT 'raw.ext_hcos_business_detail_fact'::varchar(33) AS raw_view,
        ext_hcos_business_detail_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_business_detail_fact
 GROUP BY 'raw.ext_hcos_business_detail_fact'::varchar(33),
          ext_hcos_business_detail_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_class_of_trade'::varchar(27) AS raw_view,
        ext_hcos_class_of_trade.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_class_of_trade
 GROUP BY 'raw.ext_hcos_class_of_trade'::varchar(27),
          ext_hcos_class_of_trade.file_id) UNION ALL  SELECT 'raw.ext_hcos_clinical_code'::varchar(26) AS raw_view,
        ext_hcos_clinical_code.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_clinical_code
 GROUP BY 'raw.ext_hcos_clinical_code'::varchar(26),
          ext_hcos_clinical_code.file_id) UNION ALL  SELECT 'raw.ext_hcos_clinical_fact'::varchar(26) AS raw_view,
        ext_hcos_clinical_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_clinical_fact
 GROUP BY 'raw.ext_hcos_clinical_fact'::varchar(26),
          ext_hcos_clinical_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_clinical_fact_national'::varchar(35) AS raw_view,
        ext_hcos_clinical_fact_national.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_clinical_fact_national
 GROUP BY 'raw.ext_hcos_clinical_fact_national'::varchar(35),
          ext_hcos_clinical_fact_national.file_id) UNION ALL  SELECT 'raw.ext_hcos_clinical_fact_state'::varchar(32) AS raw_view,
        ext_hcos_clinical_fact_state.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_clinical_fact_state
 GROUP BY 'raw.ext_hcos_clinical_fact_state'::varchar(32),
          ext_hcos_clinical_fact_state.file_id) UNION ALL  SELECT 'raw.ext_hcos_contact_affiltn_fact'::varchar(33) AS raw_view,
        ext_hcos_contact_affiltn_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_contact_affiltn_fact
 GROUP BY 'raw.ext_hcos_contact_affiltn_fact'::varchar(33),
          ext_hcos_contact_affiltn_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_cot_fact'::varchar(21) AS raw_view,
        ext_hcos_cot_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_cot_fact
 GROUP BY 'raw.ext_hcos_cot_fact'::varchar(21),
          ext_hcos_cot_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_financial_fact'::varchar(27) AS raw_view,
        ext_hcos_financial_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_financial_fact
 GROUP BY 'raw.ext_hcos_financial_fact'::varchar(27),
          ext_hcos_financial_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_identifier_fact'::varchar(28) AS raw_view,
        ext_hcos_identifier_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_identifier_fact
 GROUP BY 'raw.ext_hcos_identifier_fact'::varchar(28),
          ext_hcos_identifier_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_identifier_type'::varchar(28) AS raw_view,
        ext_hcos_identifier_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_identifier_type
 GROUP BY 'raw.ext_hcos_identifier_type'::varchar(28),
          ext_hcos_identifier_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_indentifier_cat_type'::varchar(33) AS raw_view,
        ext_hcos_indentifier_cat_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_indentifier_cat_type
 GROUP BY 'raw.ext_hcos_indentifier_cat_type'::varchar(33),
          ext_hcos_indentifier_cat_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_indentifier_term_type'::varchar(34) AS raw_view,
        ext_hcos_indentifier_term_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_indentifier_term_type
 GROUP BY 'raw.ext_hcos_indentifier_term_type'::varchar(34),
          ext_hcos_indentifier_term_type.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional'::varchar(25) AS raw_view,
        ext_hcos_professional.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional
 GROUP BY 'raw.ext_hcos_professional'::varchar(25),
          ext_hcos_professional.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional_detail'::varchar(32) AS raw_view,
        ext_hcos_professional_detail.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional_detail
 GROUP BY 'raw.ext_hcos_professional_detail'::varchar(32),
          ext_hcos_professional_detail.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional_detail_fact'::varchar(37) AS raw_view,
        ext_hcos_professional_detail_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional_detail_fact
 GROUP BY 'raw.ext_hcos_professional_detail_fact'::varchar(37),
          ext_hcos_professional_detail_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional_spec_fact'::varchar(35) AS raw_view,
        ext_hcos_professional_spec_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional_spec_fact
 GROUP BY 'raw.ext_hcos_professional_spec_fact'::varchar(35),
          ext_hcos_professional_spec_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional_specialty'::varchar(35) AS raw_view,
        ext_hcos_professional_specialty.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional_specialty
 GROUP BY 'raw.ext_hcos_professional_specialty'::varchar(35),
          ext_hcos_professional_specialty.file_id) UNION ALL  SELECT 'raw.ext_hcos_professional_title'::varchar(31) AS raw_view,
        ext_hcos_professional_title.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_professional_title
 GROUP BY 'raw.ext_hcos_professional_title'::varchar(31),
          ext_hcos_professional_title.file_id) UNION ALL  SELECT 'raw.ext_hcos_provider_affiliation_fact'::varchar(38) AS raw_view,
        ext_hcos_provider_affiliation_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_provider_affiliation_fact
 GROUP BY 'raw.ext_hcos_provider_affiliation_fact'::varchar(38),
          ext_hcos_provider_affiliation_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_relationship_fact'::varchar(30) AS raw_view,
        ext_hcos_relationship_fact.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_relationship_fact
 GROUP BY 'raw.ext_hcos_relationship_fact'::varchar(30),
          ext_hcos_relationship_fact.file_id) UNION ALL  SELECT 'raw.ext_hcos_relationship_type'::varchar(30) AS raw_view,
        ext_hcos_relationship_type.file_id,
        count(*) AS counts
 FROM raw.ext_hcos_relationship_type
 GROUP BY 'raw.ext_hcos_relationship_type'::varchar(30),
          ext_hcos_relationship_type.file_id) UNION ALL  SELECT 'raw.ext_i3_by_strength_rx'::varchar(25) AS raw_view,
        ext_i3_by_strength_rx.file_id,
        count(*) AS counts
 FROM raw.ext_i3_by_strength_rx
 GROUP BY 'raw.ext_i3_by_strength_rx'::varchar(25),
          ext_i3_by_strength_rx.file_id) UNION ALL  SELECT 'raw.ext_i3_rx'::varchar(13) AS raw_view,
        ext_i3_rx.file_id,
        count(*) AS counts
 FROM raw.ext_i3_rx
 GROUP BY 'raw.ext_i3_rx'::varchar(13),
          ext_i3_rx.file_id) UNION ALL  SELECT 'raw.ext_i3_tysabri_rx'::varchar(21) AS raw_view,
        ext_i3_tysabri_rx.file_id,
        count(*) AS counts
 FROM raw.ext_i3_tysabri_rx
 GROUP BY 'raw.ext_i3_tysabri_rx'::varchar(21),
          ext_i3_tysabri_rx.file_id) UNION ALL  SELECT 'raw.ext_ids_call2_detail_vod__c'::varchar(31) AS raw_view,
        ext_ids_call2_detail_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_ids_call2_detail_vod__c
 GROUP BY 'raw.ext_ids_call2_detail_vod__c'::varchar(31),
          ext_ids_call2_detail_vod__c.file_id) UNION ALL  SELECT 'raw.ext_ids_call2_vod__c'::varchar(24) AS raw_view,
        ext_ids_call2_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_ids_call2_vod__c
 GROUP BY 'raw.ext_ids_call2_vod__c'::varchar(24),
          ext_ids_call2_vod__c.file_id) UNION ALL  SELECT 'raw.ext_ims_drm45_m'::varchar(19) AS raw_view,
        ext_ims_drm45_m.file_id,
        count(*) AS counts
 FROM raw.ext_ims_drm45_m
 GROUP BY 'raw.ext_ims_drm45_m'::varchar(19),
          ext_ims_drm45_m.file_id) UNION ALL  SELECT 'raw.ext_ims_drm45_w'::varchar(19) AS raw_view,
        ext_ims_drm45_w.file_id,
        count(*) AS counts
 FROM raw.ext_ims_drm45_w
 GROUP BY 'raw.ext_ims_drm45_w'::varchar(19),
          ext_ims_drm45_w.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_cnt_m'::varchar(21) AS raw_view,
        ext_ims_mhj_cnt_m.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_cnt_m
 GROUP BY 'raw.ext_ims_mhj_cnt_m'::varchar(21),
          ext_ims_mhj_cnt_m.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_cnt_w'::varchar(21) AS raw_view,
        ext_ims_mhj_cnt_w.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_cnt_w
 GROUP BY 'raw.ext_ims_mhj_cnt_w'::varchar(21),
          ext_ims_mhj_cnt_w.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_control_m'::varchar(25) AS raw_view,
        ext_ims_mhj_control_m.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_control_m
 GROUP BY 'raw.ext_ims_mhj_control_m'::varchar(25),
          ext_ims_mhj_control_m.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_control_w'::varchar(25) AS raw_view,
        ext_ims_mhj_control_w.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_control_w
 GROUP BY 'raw.ext_ims_mhj_control_w'::varchar(25),
          ext_ims_mhj_control_w.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_qty_m'::varchar(21) AS raw_view,
        ext_ims_mhj_qty_m.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_qty_m
 GROUP BY 'raw.ext_ims_mhj_qty_m'::varchar(21),
          ext_ims_mhj_qty_m.file_id) UNION ALL  SELECT 'raw.ext_ims_mhj_qty_w'::varchar(21) AS raw_view,
        ext_ims_mhj_qty_w.file_id,
        count(*) AS counts
 FROM raw.ext_ims_mhj_qty_w
 GROUP BY 'raw.ext_ims_mhj_qty_w'::varchar(21),
          ext_ims_mhj_qty_w.file_id) UNION ALL  SELECT 'raw.ext_ims_pbm_xref'::varchar(20) AS raw_view,
        ext_ims_pbm_xref.file_id,
        count(*) AS counts
 FROM raw.ext_ims_pbm_xref
 GROUP BY 'raw.ext_ims_pbm_xref'::varchar(20),
          ext_ims_pbm_xref.file_id) UNION ALL  SELECT 'raw.ext_ims_plan_xref'::varchar(21) AS raw_view,
        ext_ims_plan_xref.file_id,
        count(*) AS counts
 FROM raw.ext_ims_plan_xref
 GROUP BY 'raw.ext_ims_plan_xref'::varchar(21),
          ext_ims_plan_xref.file_id) UNION ALL  SELECT 'raw.ext_ims_plan_xref_accelerated'::varchar(33) AS raw_view,
        ext_ims_plan_xref_accelerated.file_id,
        count(*) AS counts
 FROM raw.ext_ims_plan_xref_accelerated
 GROUP BY 'raw.ext_ims_plan_xref_accelerated'::varchar(33),
          ext_ims_plan_xref_accelerated.file_id) UNION ALL  SELECT 'raw.ext_kc_zip_to_territory'::varchar(27) AS raw_view,
        ext_kc_zip_to_territory.file_id,
        count(*) AS counts
 FROM raw.ext_kc_zip_to_territory
 GROUP BY 'raw.ext_kc_zip_to_territory'::varchar(27),
          ext_kc_zip_to_territory.file_id) UNION ALL  SELECT 'raw.ext_knipper_samples_shipped'::varchar(31) AS raw_view,
        ext_knipper_samples_shipped.file_id,
        count(*) AS counts
 FROM raw.ext_knipper_samples_shipped
 GROUP BY 'raw.ext_knipper_samples_shipped'::varchar(31),
          ext_knipper_samples_shipped.file_id) UNION ALL  SELECT 'raw.ext_mm_ram_to_state'::varchar(23) AS raw_view,
        ext_mm_ram_to_state.file_id,
        count(*) AS counts
 FROM raw.ext_mm_ram_to_state
 GROUP BY 'raw.ext_mm_ram_to_state'::varchar(23),
          ext_mm_ram_to_state.file_id) UNION ALL  SELECT 'raw.ext_omnicare_sales'::varchar(22) AS raw_view,
        ext_omnicare_sales.file_id,
        count(*) AS counts
 FROM raw.ext_omnicare_sales
 GROUP BY 'raw.ext_omnicare_sales'::varchar(22),
          ext_omnicare_sales.file_id) UNION ALL  SELECT 'raw.ext_onc_account_targets'::varchar(27) AS raw_view,
        ext_onc_account_targets.file_id,
        count(*) AS counts
 FROM raw.ext_onc_account_targets
 GROUP BY 'raw.ext_onc_account_targets'::varchar(27),
          ext_onc_account_targets.file_id) UNION ALL  SELECT 'raw.ext_onc_call_detail_goals'::varchar(29) AS raw_view,
        ext_onc_call_detail_goals.file_id,
        count(*) AS counts
 FROM raw.ext_onc_call_detail_goals
 GROUP BY 'raw.ext_onc_call_detail_goals'::varchar(29),
          ext_onc_call_detail_goals.file_id) UNION ALL  SELECT 'raw.ext_onc_ddd_monthly_retail'::varchar(30) AS raw_view,
        ext_onc_ddd_monthly_retail.file_id,
        count(*) AS counts
 FROM raw.ext_onc_ddd_monthly_retail
 GROUP BY 'raw.ext_onc_ddd_monthly_retail'::varchar(30),
          ext_onc_ddd_monthly_retail.file_id) UNION ALL  SELECT 'raw.ext_onc_ddd_weekly_retail'::varchar(29) AS raw_view,
        ext_onc_ddd_weekly_retail.file_id,
        count(*) AS counts
 FROM raw.ext_onc_ddd_weekly_retail
 GROUP BY 'raw.ext_onc_ddd_weekly_retail'::varchar(29),
          ext_onc_ddd_weekly_retail.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_monthly_demo_dol'::varchar(32) AS raw_view,
        ext_onc_dmd_monthly_demo_dol.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_monthly_demo_dol
 GROUP BY 'raw.ext_onc_dmd_monthly_demo_dol'::varchar(32),
          ext_onc_dmd_monthly_demo_dol.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_monthly_demo_qty'::varchar(32) AS raw_view,
        ext_onc_dmd_monthly_demo_qty.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_monthly_demo_qty
 GROUP BY 'raw.ext_onc_dmd_monthly_demo_qty'::varchar(32),
          ext_onc_dmd_monthly_demo_qty.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_monthly_dollars'::varchar(31) AS raw_view,
        ext_onc_dmd_monthly_dollars.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_monthly_dollars
 GROUP BY 'raw.ext_onc_dmd_monthly_dollars'::varchar(31),
          ext_onc_dmd_monthly_dollars.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_monthly_quantity'::varchar(32) AS raw_view,
        ext_onc_dmd_monthly_quantity.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_monthly_quantity
 GROUP BY 'raw.ext_onc_dmd_monthly_quantity'::varchar(32),
          ext_onc_dmd_monthly_quantity.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_weekly_demo'::varchar(27) AS raw_view,
        ext_onc_dmd_weekly_demo.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_weekly_demo
 GROUP BY 'raw.ext_onc_dmd_weekly_demo'::varchar(27),
          ext_onc_dmd_weekly_demo.file_id) UNION ALL  SELECT 'raw.ext_onc_dmd_weekly_sales'::varchar(28) AS raw_view,
        ext_onc_dmd_weekly_sales.file_id,
        count(*) AS counts
 FROM raw.ext_onc_dmd_weekly_sales
 GROUP BY 'raw.ext_onc_dmd_weekly_sales'::varchar(28),
          ext_onc_dmd_weekly_sales.file_id) UNION ALL  SELECT 'raw.ext_onc_manual_fcrs'::varchar(23) AS raw_view,
        ext_onc_manual_fcrs.file_id,
        count(*) AS counts
 FROM raw.ext_onc_manual_fcrs
 GROUP BY 'raw.ext_onc_manual_fcrs'::varchar(23),
          ext_onc_manual_fcrs.file_id) UNION ALL  SELECT 'raw.ext_onc_sales_quotas'::varchar(24) AS raw_view,
        ext_onc_sales_quotas.file_id,
        count(*) AS counts
 FROM raw.ext_onc_sales_quotas
 GROUP BY 'raw.ext_onc_sales_quotas'::varchar(24),
          ext_onc_sales_quotas.file_id) UNION ALL  SELECT 'raw.ext_pcs_ddd_nonretail'::varchar(25) AS raw_view,
        ext_pcs_ddd_nonretail.file_id,
        count(*) AS counts
 FROM raw.ext_pcs_ddd_nonretail
 GROUP BY 'raw.ext_pcs_ddd_nonretail'::varchar(25),
          ext_pcs_ddd_nonretail.file_id) UNION ALL  SELECT 'raw.ext_pcs_ddd_retail'::varchar(22) AS raw_view,
        ext_pcs_ddd_retail.file_id,
        count(*) AS counts
 FROM raw.ext_pcs_ddd_retail
 GROUP BY 'raw.ext_pcs_ddd_retail'::varchar(22),
          ext_pcs_ddd_retail.file_id) UNION ALL  SELECT 'raw.ext_prime_rx'::varchar(16) AS raw_view,
        ext_prime_rx.file_id,
        count(*) AS counts
 FROM raw.ext_prime_rx
 GROUP BY 'raw.ext_prime_rx'::varchar(16),
          ext_prime_rx.file_id) UNION ALL  SELECT 'raw.ext_rems_facility'::varchar(21) AS raw_view,
        ext_rems_facility.file_id,
        count(*) AS counts
 FROM raw.ext_rems_facility
 GROUP BY 'raw.ext_rems_facility'::varchar(21),
          ext_rems_facility.file_id) UNION ALL  SELECT 'raw.ext_rems_pharmacy'::varchar(21) AS raw_view,
        ext_rems_pharmacy.file_id,
        count(*) AS counts
 FROM raw.ext_rems_pharmacy
 GROUP BY 'raw.ext_rems_pharmacy'::varchar(21),
          ext_rems_pharmacy.file_id) UNION ALL  SELECT 'raw.ext_rems_prescriber'::varchar(23) AS raw_view,
        ext_rems_prescriber.file_id,
        count(*) AS counts
 FROM raw.ext_rems_prescriber
 GROUP BY 'raw.ext_rems_prescriber'::varchar(23),
          ext_rems_prescriber.file_id) UNION ALL  SELECT 'raw.ext_specialty_pharmacy_cm_lkup'::varchar(34) AS raw_view,
        ext_specialty_pharmacy_cm_lkup.file_id,
        count(*) AS counts
 FROM raw.ext_specialty_pharmacy_cm_lkup
 GROUP BY 'raw.ext_specialty_pharmacy_cm_lkup'::varchar(34),
          ext_specialty_pharmacy_cm_lkup.file_id) UNION ALL  SELECT 'raw.ext_specialty_pharmacy_lookups'::varchar(34) AS raw_view,
        ext_specialty_pharmacy_lookups.file_id,
        count(*) AS counts
 FROM raw.ext_specialty_pharmacy_lookups
 GROUP BY 'raw.ext_specialty_pharmacy_lookups'::varchar(34),
          ext_specialty_pharmacy_lookups.file_id) UNION ALL  SELECT 'raw.ext_tb_cb_accounts'::varchar(22) AS raw_view,
        ext_tb_cb_accounts.file_id,
        count(*) AS counts
 FROM raw.ext_tb_cb_accounts
 GROUP BY 'raw.ext_tb_cb_accounts'::varchar(22),
          ext_tb_cb_accounts.file_id) UNION ALL  SELECT 'raw.ext_tb_cb_transactions'::varchar(26) AS raw_view,
        ext_tb_cb_transactions.file_id,
        count(*) AS counts
 FROM raw.ext_tb_cb_transactions
 GROUP BY 'raw.ext_tb_cb_transactions'::varchar(26),
          ext_tb_cb_transactions.file_id) UNION ALL  SELECT 'raw.ext_tb_ds_accounts'::varchar(22) AS raw_view,
        ext_tb_ds_accounts.file_id,
        count(*) AS counts
 FROM raw.ext_tb_ds_accounts
 GROUP BY 'raw.ext_tb_ds_accounts'::varchar(22),
          ext_tb_ds_accounts.file_id) UNION ALL  SELECT 'raw.ext_tb_ds_transactions'::varchar(26) AS raw_view,
        ext_tb_ds_transactions.file_id,
        count(*) AS counts
 FROM raw.ext_tb_ds_transactions
 GROUP BY 'raw.ext_tb_ds_transactions'::varchar(26),
          ext_tb_ds_transactions.file_id) UNION ALL  SELECT 'raw.ext_time_off_territory_kc_veev'::varchar(34) AS raw_view,
        ext_time_off_territory_kc_veev.file_id,
        count(*) AS counts
 FROM raw.ext_time_off_territory_kc_veev
 GROUP BY 'raw.ext_time_off_territory_kc_veev'::varchar(34),
          ext_time_off_territory_kc_veev.file_id) UNION ALL  SELECT 'raw.ext_time_off_territory_vod__c'::varchar(33) AS raw_view,
        ext_time_off_territory_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_time_off_territory_vod__c
 GROUP BY 'raw.ext_time_off_territory_vod__c'::varchar(33),
          ext_time_off_territory_vod__c.file_id) UNION ALL  SELECT 'raw.ext_touchpoint_call'::varchar(23) AS raw_view,
        ext_touchpoint_call.file_id,
        count(*) AS counts
 FROM raw.ext_touchpoint_call
 GROUP BY 'raw.ext_touchpoint_call'::varchar(23),
          ext_touchpoint_call.file_id) UNION ALL  SELECT 'raw.ext_touchpoint_presentation'::varchar(31) AS raw_view,
        ext_touchpoint_presentation.file_id,
        count(*) AS counts
 FROM raw.ext_touchpoint_presentation
 GROUP BY 'raw.ext_touchpoint_presentation'::varchar(31),
          ext_touchpoint_presentation.file_id) UNION ALL  SELECT 'raw.ext_tw_anda_sales'::varchar(21) AS raw_view,
        ext_tw_anda_sales.file_id,
        count(*) AS counts
 FROM raw.ext_tw_anda_sales
 GROUP BY 'raw.ext_tw_anda_sales'::varchar(21),
          ext_tw_anda_sales.file_id) UNION ALL  SELECT 'raw.ext_tw_biologics_sales'::varchar(26) AS raw_view,
        ext_tw_biologics_sales.file_id,
        count(*) AS counts
 FROM raw.ext_tw_biologics_sales
 GROUP BY 'raw.ext_tw_biologics_sales'::varchar(26),
          ext_tw_biologics_sales.file_id) UNION ALL  SELECT 'raw.ext_tw_hd_smith_sales'::varchar(25) AS raw_view,
        ext_tw_hd_smith_sales.file_id,
        count(*) AS counts
 FROM raw.ext_tw_hd_smith_sales
 GROUP BY 'raw.ext_tw_hd_smith_sales'::varchar(25),
          ext_tw_hd_smith_sales.file_id) UNION ALL  SELECT 'raw.ext_tw_ics_account'::varchar(22) AS raw_view,
        ext_tw_ics_account.file_id,
        count(*) AS counts
 FROM raw.ext_tw_ics_account
 GROUP BY 'raw.ext_tw_ics_account'::varchar(22),
          ext_tw_ics_account.file_id) UNION ALL  SELECT 'raw.ext_tw_ics_sales'::varchar(20) AS raw_view,
        ext_tw_ics_sales.file_id,
        count(*) AS counts
 FROM raw.ext_tw_ics_sales
 GROUP BY 'raw.ext_tw_ics_sales'::varchar(20),
          ext_tw_ics_sales.file_id) UNION ALL  SELECT 'raw.ext_vv_account'::varchar(18) AS raw_view,
        ext_vv_account.file_id,
        count(*) AS counts
 FROM raw.ext_vv_account
 GROUP BY 'raw.ext_vv_account'::varchar(18),
          ext_vv_account.file_id) UNION ALL  SELECT 'raw.ext_vv_accountshare'::varchar(23) AS raw_view,
        ext_vv_accountshare.file_id,
        count(*) AS counts
 FROM raw.ext_vv_accountshare
 GROUP BY 'raw.ext_vv_accountshare'::varchar(23),
          ext_vv_accountshare.file_id) UNION ALL  SELECT 'raw.ext_vv_acct_merge_history_vod'::varchar(33) AS raw_view,
        ext_vv_acct_merge_history_vod.file_id,
        count(*) AS counts
 FROM raw.ext_vv_acct_merge_history_vod
 GROUP BY 'raw.ext_vv_acct_merge_history_vod'::varchar(33),
          ext_vv_acct_merge_history_vod.file_id) UNION ALL  SELECT 'raw.ext_vv_address_vod__c'::varchar(25) AS raw_view,
        ext_vv_address_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_address_vod__c
 GROUP BY 'raw.ext_vv_address_vod__c'::varchar(25),
          ext_vv_address_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_affiliation_vod__c'::varchar(29) AS raw_view,
        ext_vv_affiliation_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_affiliation_vod__c
 GROUP BY 'raw.ext_vv_affiliation_vod__c'::varchar(29),
          ext_vv_affiliation_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_assessment__c'::varchar(24) AS raw_view,
        ext_vv_assessment__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_assessment__c
 GROUP BY 'raw.ext_vv_assessment__c'::varchar(24),
          ext_vv_assessment__c.file_id) UNION ALL  SELECT 'raw.ext_vv_call_goal_tva__c'::varchar(27) AS raw_view,
        ext_vv_call_goal_tva__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_call_goal_tva__c
 GROUP BY 'raw.ext_vv_call_goal_tva__c'::varchar(27),
          ext_vv_call_goal_tva__c.file_id) UNION ALL  SELECT 'raw.ext_vv_call2_detail_vod__c'::varchar(30) AS raw_view,
        ext_vv_call2_detail_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_call2_detail_vod__c
 GROUP BY 'raw.ext_vv_call2_detail_vod__c'::varchar(30),
          ext_vv_call2_detail_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_call2_key_message_vod'::varchar(32) AS raw_view,
        ext_vv_call2_key_message_vod.file_id,
        count(*) AS counts
 FROM raw.ext_vv_call2_key_message_vod
 GROUP BY 'raw.ext_vv_call2_key_message_vod'::varchar(32),
          ext_vv_call2_key_message_vod.file_id) UNION ALL  SELECT 'raw.ext_vv_call2_sample_vod__c'::varchar(30) AS raw_view,
        ext_vv_call2_sample_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_call2_sample_vod__c
 GROUP BY 'raw.ext_vv_call2_sample_vod__c'::varchar(30),
          ext_vv_call2_sample_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_call2_vod__c'::varchar(23) AS raw_view,
        ext_vv_call2_vod__c.file_id,
        count(*) AS counts
 FROM raw.EXT_VV_CALL2_VOD__C
 GROUP BY 'raw.ext_vv_call2_vod__c'::varchar(23),
          ext_vv_call2_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_call2_vod__history'::varchar(29) AS raw_view,
        ext_vv_call2_vod__history.file_id,
        count(*) AS counts
 FROM raw.ext_vv_call2_vod__history
 GROUP BY 'raw.ext_vv_call2_vod__history'::varchar(29),
          ext_vv_call2_vod__history.file_id) UNION ALL  SELECT 'raw.ext_vv_deciles_tva__c'::varchar(25) AS raw_view,
        ext_vv_deciles_tva__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_deciles_tva__c
 GROUP BY 'raw.ext_vv_deciles_tva__c'::varchar(25),
          ext_vv_deciles_tva__c.file_id) UNION ALL  SELECT 'raw.ext_vv_group'::varchar(16) AS raw_view,
        ext_vv_group.file_id,
        count(*) AS counts
 FROM raw.ext_vv_group
 GROUP BY 'raw.ext_vv_group'::varchar(16),
          ext_vv_group.file_id) UNION ALL  SELECT 'raw.ext_vv_key_message_vod__c'::varchar(29) AS raw_view,
        ext_vv_key_message_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_key_message_vod__c
 GROUP BY 'raw.ext_vv_key_message_vod__c'::varchar(29),
          ext_vv_key_message_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_medical_inquiry_vod__c'::varchar(33) AS raw_view,
        ext_vv_medical_inquiry_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_medical_inquiry_vod__c
 GROUP BY 'raw.ext_vv_medical_inquiry_vod__c'::varchar(33),
          ext_vv_medical_inquiry_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_product_metrics_vod__c'::varchar(33) AS raw_view,
        ext_vv_product_metrics_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_product_metrics_vod__c
 GROUP BY 'raw.ext_vv_product_metrics_vod__c'::varchar(33),
          ext_vv_product_metrics_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_product_vod__c'::varchar(25) AS raw_view,
        ext_vv_product_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_product_vod__c
 GROUP BY 'raw.ext_vv_product_vod__c'::varchar(25),
          ext_vv_product_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_question_response_vod'::varchar(32) AS raw_view,
        ext_vv_question_response_vod.file_id,
        count(*) AS counts
 FROM raw.ext_vv_question_response_vod
 GROUP BY 'raw.ext_vv_question_response_vod'::varchar(32),
          ext_vv_question_response_vod.file_id) UNION ALL  SELECT 'raw.ext_vv_recordtype'::varchar(21) AS raw_view,
        ext_vv_recordtype.file_id,
        count(*) AS counts
 FROM raw.ext_vv_recordtype
 GROUP BY 'raw.ext_vv_recordtype'::varchar(21),
          ext_vv_recordtype.file_id) UNION ALL  SELECT 'raw.ext_vv_survey_question_vod__c'::varchar(33) AS raw_view,
        ext_vv_survey_question_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_survey_question_vod__c
 GROUP BY 'raw.ext_vv_survey_question_vod__c'::varchar(33),
          ext_vv_survey_question_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_survey_target_vod__c'::varchar(31) AS raw_view,
        ext_vv_survey_target_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_survey_target_vod__c
 GROUP BY 'raw.ext_vv_survey_target_vod__c'::varchar(31),
          ext_vv_survey_target_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_survey_vod__c'::varchar(24) AS raw_view,
        ext_vv_survey_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_survey_vod__c
 GROUP BY 'raw.ext_vv_survey_vod__c'::varchar(24),
          ext_vv_survey_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_sync_tracking_vod__c'::varchar(31) AS raw_view,
        ext_vv_sync_tracking_vod__c.file_id,
        count(*) AS counts
 FROM raw.ext_vv_sync_tracking_vod__c
 GROUP BY 'raw.ext_vv_sync_tracking_vod__c'::varchar(31),
          ext_vv_sync_tracking_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_territory'::varchar(20) AS raw_view,
        ext_vv_territory.file_id,
        count(*) AS counts
 FROM raw.ext_vv_territory
 GROUP BY 'raw.ext_vv_territory'::varchar(20),
          ext_vv_territory.file_id) UNION ALL  SELECT 'raw.ext_vv_tsf_vod__c'::varchar(21) AS raw_view,
        ext_vv_tsf_vod__c.file_id,
        count(*) AS counts
 FROM raw.EXT_VV_TSF_VOD__C
 GROUP BY 'raw.ext_vv_tsf_vod__c'::varchar(21),
          ext_vv_tsf_vod__c.file_id) UNION ALL  SELECT 'raw.ext_vv_user'::varchar(15) AS raw_view,
        ext_vv_user.file_id,
        count(*) AS counts
 FROM raw.ext_vv_user
 GROUP BY 'raw.ext_vv_user'::varchar(15),
          ext_vv_user.file_id) UNION ALL  SELECT 'raw.ext_vv_userrole'::varchar(19) AS raw_view,
        ext_vv_userrole.file_id,
        count(*) AS counts
 FROM raw.ext_vv_userrole
 GROUP BY 'raw.ext_vv_userrole'::varchar(19),
          ext_vv_userrole.file_id) UNION ALL  SELECT 'raw.ext_vv_userterritory'::varchar(24) AS raw_view,
        ext_vv_userterritory.file_id,
        count(*) AS counts
 FROM raw.ext_vv_userterritory
 GROUP BY 'raw.ext_vv_userterritory'::varchar(24),
          ext_vv_userterritory.file_id) UNION ALL  SELECT 'raw.ext_wholesale_867'::varchar(21) AS raw_view,
        ext_wholesale_867.file_id,
        count(*) AS counts
 FROM raw.ext_wholesale_867
 GROUP BY 'raw.ext_wholesale_867'::varchar(21),
          ext_wholesale_867.file_id) UNION ALL  SELECT 'raw.ext_zs_call_plan_tc'::varchar(23) AS raw_view,
        ext_zs_call_plan_tc.file_id,
        count(*) AS counts
 FROM raw.ext_zs_call_plan_tc
 GROUP BY 'raw.ext_zs_call_plan_tc'::varchar(23),
          ext_zs_call_plan_tc.file_id) UNION ALL  SELECT 'raw.ext_zs_call_plan_tn'::varchar(23) AS raw_view,
        ext_zs_call_plan_tn.file_id,
        count(*) AS counts
 FROM raw.ext_zs_call_plan_tn
 GROUP BY 'raw.ext_zs_call_plan_tn'::varchar(23),
          ext_zs_call_plan_tn.file_id) UNION ALL  SELECT 'raw.ext_zs_call_plan_tp'::varchar(23) AS raw_view,
        ext_zs_call_plan_tp.file_id,
        count(*) AS counts
 FROM raw.ext_zs_call_plan_tp
 GROUP BY 'raw.ext_zs_call_plan_tp'::varchar(23),
          ext_zs_call_plan_tp.file_id) UNION ALL  SELECT 'raw.ext_zs_call_plan_tr'::varchar(23) AS raw_view,
        ext_zs_call_plan_tr.file_id,
        count(*) AS counts
 FROM raw.ext_zs_call_plan_tr
 GROUP BY 'raw.ext_zs_call_plan_tr'::varchar(23),
          ext_zs_call_plan_tr.file_id) UNION ALL  SELECT 'raw.ext_zs_call_plan_tw'::varchar(23) AS raw_view,
        ext_zs_call_plan_tw.file_id,
        count(*) AS counts
 FROM raw.ext_zs_call_plan_tw
 GROUP BY 'raw.ext_zs_call_plan_tw'::varchar(23),
          ext_zs_call_plan_tw.file_id) UNION ALL  SELECT 'raw.job_title_defs'::varchar(18) AS raw_view,
        job_title_defs.file_id,
        count(*) AS counts
 FROM raw.job_title_defs
 GROUP BY 'raw.job_title_defs'::varchar(18),
          job_title_defs.file_id) UNION ALL  SELECT 'raw.people'::varchar(10) AS raw_view,
        people.file_id,
        count(*) AS counts
 FROM raw.people
 GROUP BY 'raw.people'::varchar(10),
          people.file_id) UNION ALL  SELECT 'raw.people_addresses'::varchar(20) AS raw_view,
        people_addresses.file_id,
        count(*) AS counts
 FROM raw.people_addresses
 GROUP BY 'raw.people_addresses'::varchar(20),
          people_addresses.file_id) UNION ALL  SELECT 'raw.people_phones'::varchar(17) AS raw_view,
        people_phones.file_id,
        count(*) AS counts
 FROM raw.people_phones
 GROUP BY 'raw.people_phones'::varchar(17),
          people_phones.file_id) UNION ALL  SELECT 'raw.phones'::varchar(10) AS raw_view,
        phones.file_id,
        count(*) AS counts
 FROM raw.phones
 GROUP BY 'raw.phones'::varchar(10),
          phones.file_id) UNION ALL  SELECT 'raw.territories'::varchar(15) AS raw_view,
        territories.file_id,
        count(*) AS counts
 FROM raw.territories
 GROUP BY 'raw.territories'::varchar(15),
          territories.file_id) UNION ALL  SELECT 'raw.tvcmid_hco_demo'::varchar(19) AS raw_view,
        tvcmid_hco_demo.file_id,
        count(*) AS counts
 FROM raw.tvcmid_hco_demo
 GROUP BY 'raw.tvcmid_hco_demo'::varchar(19),
          tvcmid_hco_demo.file_id) UNION ALL  SELECT 'raw.tvcmid_hcp_demo'::varchar(19) AS raw_view,
        tvcmid_hcp_demo.file_id,
        count(*) AS counts
 FROM raw.tvcmid_hcp_demo
 GROUP BY 'raw.tvcmid_hcp_demo'::varchar(19),
          tvcmid_hcp_demo.file_id) UNION ALL  SELECT 'raw.tvcmid_merges'::varchar(17) AS raw_view,
        tvcmid_merges.file_id,
        count(*) AS counts
 FROM raw.tvcmid_merges
 GROUP BY 'raw.tvcmid_merges'::varchar(17),
          tvcmid_merges.file_id) UNION ALL  SELECT 'raw.tvcmid_xref'::varchar(15) AS raw_view,
        tvcmid_xref.file_id,
        count(*) AS counts
 FROM raw.tvcmid_xref
 GROUP BY 'raw.tvcmid_xref'::varchar(15),
          tvcmid_xref.file_id) UNION ALL  SELECT 'raw.xx_sales_loa_mv'::varchar(19) AS raw_view,
        xx_sales_loa_mv.file_id,
        count(*) AS counts
 FROM raw.xx_sales_loa_mv
 GROUP BY 'raw.xx_sales_loa_mv'::varchar(19),
          xx_sales_loa_mv.file_id) UNION ALL  SELECT 'raw.xx_sales_mv'::varchar(15) AS raw_view,
        xx_sales_mv.file_id,
        count(*) AS counts
 FROM raw.xx_sales_mv
 GROUP BY 'raw.xx_sales_mv'::varchar(15),
          xx_sales_mv.file_id) UNION ALL  SELECT 'raw.xx_terr_id_change_v'::varchar(23) AS raw_view,
        xx_terr_id_change_v.file_id,
        count(*) AS counts
 FROM raw.xx_terr_id_change_v
 GROUP BY 'raw.xx_terr_id_change_v'::varchar(23),
          xx_terr_id_change_v.file_id) A
 ORDER BY A.raw_view,
          A.file_id;

CREATE  VIEW outbound.i_bag_product_metrics AS
 SELECT i_bag_territory_product.territory_number,
        i_bag_territory_product.bag_name,
        i_bag_territory_product."position",
        i_bag_territory_product.basket_name,
        'Y'::varchar(1) AS detailable
 FROM outbound.i_bag_territory_product
 WHERE (i_bag_territory_product.bag_name IS NOT NULL) UNION ALL  SELECT terrs.territory_number,
        NULL AS bag_name,
        (90 + row_number() OVER (PARTITION BY terrs.territory_number ORDER BY sfpm.PRODUCT_NAME)) AS "position",
        sfpm.PRODUCT_NAME AS product_name,
        'N'::varchar(1) AS detailable
 FROM (reference.sales_force_product_metrics sfpm JOIN ( SELECT i_bag_territory_product.territory_number
 FROM outbound.i_bag_territory_product
 GROUP BY i_bag_territory_product.territory_number) terrs ON ((terrs.territory_number ~~ (sfpm.SALES_FORCE_ID || '%'::varchar(1)))));

CREATE  VIEW outbound.zs_austedo_activity_demographics AS
 SELECT d.sales_force_id,
        d.ptr_territory_num AS territory_number,
        d.tvcmid,
        d.ims_id,
        d.specialty,
        d.last_name,
        d.first_name,
        d.middle_name,
        d.ptr_address_1 AS address_1,
        d.ptr_address_2 AS address_2,
        d.ptr_address_3 AS address_3,
        d.ptr_city AS city,
        d.ptr_state AS state,
        d.ptr_zip AS zip,
        d.pdrp_flag,
        d.ptr_address_source AS address_source,
        CASE WHEN (dnp.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS dnp_flag,
        x.hce_status_desc AS cm_status_flag
 FROM ((((((( SELECT zs_austedo_activity_call_detail.tvcmid
 FROM outbound.zs_austedo_activity_call_detail UNION  SELECT zs_austedo_activity_copay.physician_tvcmid
 FROM outbound.zs_austedo_activity_copay) UNION  SELECT zs_austedo_activity_sample_request.tvcmid
 FROM outbound.zs_austedo_activity_sample_request) UNION  SELECT zs_austedo_activity_sample_shipment.tvcmid
 FROM outbound.zs_austedo_activity_sample_shipment) UNION  SELECT zs_austedo_activity_ahm_participant.clientcustomerid
 FROM outbound.zs_austedo_activity_ahm_participant) ids JOIN datamart.prescriber_combined_demographics d ON ((d.tvcmid = ids.tvcmid))) LEFT  JOIN ( SELECT customer_level_flags.tvcmid
 FROM datamart.customer_level_flags
 WHERE ((customer_level_flags.flag_type = ANY (ARRAY['OIG'::varchar(6), 'FDA'::varchar(6), 'DEA'::varchar(6), 'PERPRM'::varchar(6)])) AND (customer_level_flags.flag_value = 'Y'::varchar(1)))
 GROUP BY customer_level_flags.tvcmid) dnp ON ((d.tvcmid = dnp.tvcmid))) LEFT  JOIN ( SELECT customer_hcp_demographics.tvcmid,
        customer_hcp_demographics.hce_status_desc
 FROM datamart.customer_hcp_demographics) x ON ((d.tvcmid = x.tvcmid)))
 WHERE (d.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)]))
 ORDER BY d.tvcmid,
          d.ptr_territory_num;

CREATE  VIEW sandbox.vw_ftf_restriction_change AS
 SELECT a.entity AS "Change Type",
        a.category_value AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM (((( SELECT 'Group Restriction'::varchar(17) AS entity,
        b.category_value,
        'No Change'::varchar(9) AS status
 FROM (( SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level) a JOIN ( SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level) b ON ((a.category_value = b.category_value))) UNION  SELECT 'Group Restriction'::varchar(17) AS entity,
        vw_curr_month_ftf_restrictions.category_value,
        'Added'::varchar(5) AS status
 FROM ( SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level EXCEPT  SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level) vw_curr_month_ftf_restrictions) UNION  SELECT 'Group Restriction'::varchar(17) AS entity,
        vw_prev_month_ftf_restrictions_cdw.category_value,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level EXCEPT  SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level) vw_prev_month_ftf_restrictions_cdw) UNION  SELECT 'Restriction Detail'::varchar(18) AS entity,
        vw_curr_month_ftf_restrictions.category_value,
        'Added'::varchar(5) AS status
 FROM ( SELECT vw_curr_month_ftf_restrictions.restriction_detail_text AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.restriction_detail_text EXCEPT  SELECT vw_prev_month_ftf_restrictions_cdw.restriction_detail_text AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.restriction_detail_text) vw_curr_month_ftf_restrictions) UNION  SELECT 'Restriction Detail'::varchar(18) AS entity,
        vw_prev_month_ftf_restrictions_cdw.category_value,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT vw_prev_month_ftf_restrictions_cdw.restriction_detail_text AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.restriction_detail_text EXCEPT  SELECT vw_curr_month_ftf_restrictions.restriction_detail_text AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.restriction_detail_text) vw_prev_month_ftf_restrictions_cdw) a
 WHERE (coalesce(a.category_value, ''::varchar) <> ''::varchar)
 GROUP BY a.entity,
          a.category_value,
          a.status,
          CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END
 ORDER BY a.entity,
          a.status,
          a.category_value;

CREATE  VIEW WSMP_ADMIN_ORA.v_adasuve_survey AS
SELECT t.ACCOUNT_VOD__C AS veeva_account_id, demo.last_name AS account_name, demo.npi, acc.ACCOUNT_DEA_TVA__C AS dea, acc.IMS_ORG_ID_TVA__C AS ims_org_id, acc.ADASUVE_ACCOUNT_INDICATOR AS adasuve_account_indicator, demo.address1, demo.address2, demo.address3, demo.city, demo.state, demo.zip, q.LASTMODIFIEDDATE AS updated_date, s.NAME AS survey, q.ORDER_VOD__C AS question_order, q.QUESTION_TEXT_VOD__C AS question, CASE ty.NAME WHEN NULLSEQUAL 'date_vod'::varchar(8) THEN to_char(q.DATE_VOD__C, 'yyyy-mm-dd'::varchar(10)) WHEN NULLSEQUAL 'text_vod'::varchar(8) THEN q.TEXT_VOD__C ELSE q.RESPONSE_VOD__C END AS answer, rep.LAST_NAME AS rep_last_name, rep.FIRST_NAME AS rep_first_name, hier.rep_territory_name, hier.m_territory_num AS region_territory_num, hier.m_territory_name AS region_territory_name, hier.d_territory_num AS area_territory_num, hier.d_territory_name AS area_territory_name FROM (((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C t ON ((s.ID = t.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C q ON ((t.ID = q.SURVEY_TARGET_VOD__C))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((q.TYPE_VOD__C = ty.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT acc ON ((t.ACCOUNT_VOD__C = acc.ID))) JOIN WSMP_ADMIN.v_veeva_demo demo ON ((t.ACCOUNT_VOD__C = demo.veeva_account_id))) LEFT JOIN (SELECT dim_csf_sales_roster_teva.EMPLOYEE_ID, dim_csf_sales_roster_teva.TERRITORY_NUM, dim_csf_sales_roster_teva.TERRITORY_NAME, dim_csf_sales_roster_teva.SALES_FORCE_ID, dim_csf_sales_roster_teva.FULL_NAME, dim_csf_sales_roster_teva.LAST_NAME, dim_csf_sales_roster_teva.FIRST_NAME, dim_csf_sales_roster_teva.MIDDLE_NAME, dim_csf_sales_roster_teva.ADDRESS_LINE1, dim_csf_sales_roster_teva.ADDRESS_LINE2, dim_csf_sales_roster_teva.CITY, dim_csf_sales_roster_teva.STATE, dim_csf_sales_roster_teva.ZIP, dim_csf_sales_roster_teva.BUS_ADDRESS_LINE1, dim_csf_sales_roster_teva.BUS_ADDRESS_LINE2, dim_csf_sales_roster_teva.BUS_CITY, dim_csf_sales_roster_teva.BUS_STATE, dim_csf_sales_roster_teva.BUS_ZIP, dim_csf_sales_roster_teva.SHIP_ADDRESS_LINE1, dim_csf_sales_roster_teva.SHIP_ADDRESS_LINE2, dim_csf_sales_roster_teva.SHIP_CITY, dim_csf_sales_roster_teva.SHIP_STATE, dim_csf_sales_roster_teva.SHIP_ZIP, dim_csf_sales_roster_teva.BUSINESS_PHONE, dim_csf_sales_roster_teva.HOME_PHONE, dim_csf_sales_roster_teva.CELL_PHONE, dim_csf_sales_roster_teva.FAX, dim_csf_sales_roster_teva.VOICE_MAIL_EXT, dim_csf_sales_roster_teva.EMAIL, dim_csf_sales_roster_teva.HIRE_DATE, dim_csf_sales_roster_teva.BIRTHDAY, dim_csf_sales_roster_teva.TITLE, dim_csf_sales_roster_teva.REP_TYPE, dim_csf_sales_roster_teva.AREA_TRAINER, dim_csf_sales_roster_teva.USERNAME, dim_csf_sales_roster_teva.OUT_OF_TERRITORY, dim_csf_sales_roster_teva.PARENT_TERRITORY_NUM, dim_csf_sales_roster_teva.LAST_BUILD_DATE, dim_csf_sales_roster_teva.COMPANY_CD, dim_csf_sales_roster_teva.ORIG_HIRE_DATE FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TB'::varchar(2)) AND (dim_csf_sales_roster_teva.REP_TYPE = 'REP'::varchar(3)))) rep ON ((demo.territory_num = rep.TERRITORY_NUM))) LEFT JOIN (SELECT v_territory_rep_mgr_dir.sales_force_id, v_territory_rep_mgr_dir.rep_territory_num, v_territory_rep_mgr_dir.rep_territory_name, v_territory_rep_mgr_dir.m_territory_num, v_territory_rep_mgr_dir.m_territory_name, v_territory_rep_mgr_dir.d_territory_num, v_territory_rep_mgr_dir.d_territory_name, v_territory_rep_mgr_dir.h_territory_num, v_territory_rep_mgr_dir.h_territory_name FROM WSMP_ADMIN.v_territory_rep_mgr_dir WHERE (v_territory_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) hier ON ((demo.territory_num = hier.rep_territory_num))) WHERE ((s.NAME = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])) AND (demo.sales_force_id = 'TB'::varchar(2))) ORDER BY t.ACCOUNT_VOD__C, s.NAME, q.QUESTION_TEXT_VOD__C;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_agile_mktg_copay_redemptions AS
SELECT CASE mod(npi.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((npi.tvcmid)::int)::varchar ELSE rtrim((npi.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, npi.ims_id, cd.VEEVA_ACCOUNT_ID AS veeva_account_id, p.ASI_PROGRAM_NUM AS asi_program_num, p.PROGRAM_DESC AS program_desc, cd.COPAY_CARD_NUM AS copay_card_num, coalesce(cd.ASI_PHYS_ZIP, cd.PHARMACY_ZIP) AS zip_code, to_char(cd.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, cd.BRAND_NAME AS brand_name, cd.DRUG_DESC AS drug_desc, (cd.QTY)::int AS qty FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY cd, WSMP_ADMIN.DIM_ASI_PROGRAM p, (SELECT tvcmid_hcp_demo.TVCMID AS tvcmid, tvcmid_hcp_demo.NPI AS npi, tvcmid_hcp_demo.IMS_ID AS ims_id FROM teva_ingestion.tvcmid_hcp_demo WHERE (tvcmid_hcp_demo.NPI IS NOT NULL) GROUP BY tvcmid_hcp_demo.TVCMID, tvcmid_hcp_demo.NPI, tvcmid_hcp_demo.IMS_ID) npi WHERE ((cd.IMS_ID = npi.ims_id) AND (cd.BRAND_NAME = 'NUVIGIL'::varchar(7)) AND (cd.PROGRAM_NUM = p.ASI_PROGRAM_NUM) AND (cd.FILL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (cd.FILL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.REDEMPTION_TYPE = p.REDEMPTION_TYPE));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Voucher_Redemptions AS
SELECT CASE mod(v.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((v.tvcmid)::int)::varchar ELSE rtrim((v.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, x.ims_id, x.veeva_account_id, v.asi_program_num, v.program_desc, v.voucher_num, v.zip_code, to_char(v.fill_date, 'YYYY-MM-DD'::varchar(10)) AS fill_date, v.product_name, v.drug_desc, CASE mod(v.qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((v.qty)::int)::varchar ELSE rtrim((v.qty)::varchar, '0'::varchar(1)) END AS qty FROM ((SELECT v.tvcmid, v.ims_id, v.asi_program_num, v.program_desc, v.voucher_num, v.zip_code, v.fill_date, v.product_name, v.drug_desc, v.qty FROM (SELECT npi.tvcmid, npi.ims_id, p.ASI_PROGRAM_NUM AS asi_program_num, p.PROGRAM_DESC AS program_desc, vd.VOUCHER_NUM AS voucher_num, coalesce(vd.PROVIDER_ZIP, vd.PHARMACY_ZIP) AS zip_code, vd.FILL_DATE AS fill_date, vd.PRODUCT_NAME AS product_name, vd.DRUG_DESC AS drug_desc, vd.QTY AS qty FROM ((WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY vd JOIN WSMP_ADMIN.DIM_ASI_PROGRAM p ON (((vd.PROGRAM_NUM = p.ASI_PROGRAM_NUM) AND (vd.REDEMPTION_TYPE = p.REDEMPTION_TYPE)))) LEFT JOIN (SELECT tvcmid_hcp_demo.TVCMID AS tvcmid, tvcmid_hcp_demo.NPI AS npi, tvcmid_hcp_demo.IMS_ID AS ims_id FROM teva_ingestion.tvcmid_hcp_demo WHERE (tvcmid_hcp_demo.NPI IS NOT NULL) GROUP BY tvcmid_hcp_demo.TVCMID, tvcmid_hcp_demo.NPI, tvcmid_hcp_demo.IMS_ID) npi ON ((vd.NPI = npi.npi))) WHERE ((vd.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (vd.FILL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (vd.FILL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))))) v) v LEFT JOIN (SELECT demo_combined.ims_id, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.ims_id, demo_combined.veeva_account_id) x ON ((v.ims_id = x.ims_id)));

CREATE  VIEW outbound.v_activity AS
(( SELECT activity_speaker_event.federation_id,
        activity_speaker_event.contact,
        activity_speaker_event.source,
        activity_speaker_event."datetime",
        activity_speaker_event.trackback_id,
        activity_speaker_event.previous_activity,
        activity_speaker_event.level_master_id,
        activity_speaker_event.activity_role,
        activity_speaker_event.type,
        activity_speaker_event.native_type,
        activity_speaker_event.details,
        activity_speaker_event.created,
        activity_speaker_event.modified
 FROM outbound.activity_speaker_event UNION ALL  SELECT activity_copay.federation_id,
        activity_copay.contact,
        activity_copay.source,
        activity_copay."datetime",
        activity_copay.trackback_id,
        activity_copay.previous_activity,
        activity_copay.level_master_id,
        activity_copay.activity_role,
        activity_copay.type,
        activity_copay.native_type,
        activity_copay.details,
        activity_copay.created,
        activity_copay.modified
 FROM outbound.activity_copay) UNION ALL  SELECT activity_npp_sample_orders.federation_id,
        activity_npp_sample_orders.contact,
        activity_npp_sample_orders.source,
        activity_npp_sample_orders."datetime",
        activity_npp_sample_orders.trackback_id,
        activity_npp_sample_orders.previous_activity,
        activity_npp_sample_orders.level_master_id,
        activity_npp_sample_orders.activity_role,
        activity_npp_sample_orders.type,
        activity_npp_sample_orders.native_type,
        activity_npp_sample_orders.details,
        activity_npp_sample_orders.created,
        activity_npp_sample_orders.modified
 FROM outbound.activity_npp_sample_orders) UNION ALL  SELECT activity_centris_speaker_event.federation_id,
        activity_centris_speaker_event.contact,
        activity_centris_speaker_event.source,
        activity_centris_speaker_event."datetime",
        activity_centris_speaker_event.trackback_id,
        activity_centris_speaker_event.previous_activity,
        activity_centris_speaker_event.level_master_id,
        activity_centris_speaker_event.activity_role,
        activity_centris_speaker_event.type,
        activity_centris_speaker_event.native_type,
        activity_centris_speaker_event.details,
        activity_centris_speaker_event.created,
        activity_centris_speaker_event.modified
 FROM outbound.activity_centris_speaker_event;

CREATE FUNCTION public.isOrContains(map Long Varchar, val Varchar)
RETURN boolean AS
BEGIN
RETURN CASE WHEN (public.MapSize(map) <> (-1)) THEN public.MapContainsValue(map, val) ELSE (map = (val)) END;
END;

CREATE FUNCTION public.weighted_oracle_task(key_value Varchar, points Integer)
RETURN float AS
BEGIN
RETURN (CASE key_value WHEN 'select' THEN (points * 0.3) WHEN 'merge' THEN (points * 5) WHEN 'declare' THEN (points * 4) WHEN 'begin' THEN (points * 4) WHEN 'cursor' THEN (points * 25) WHEN 'loop' THEN (points * 25) WHEN 'rowid' THEN (points * 10) WHEN 'rownum' THEN (points * 5) WHEN 'oracle_join_syntax' THEN (points * 3) ELSE points END)::float;
END;

SELECT MARK_DESIGN_KSAFE(1);
