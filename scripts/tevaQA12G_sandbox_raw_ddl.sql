CREATE SCHEMA sandbox;

CREATE SEQUENCE sandbox.austedo  CACHE      20  CYCLE ;

CREATE TABLE sandbox.ic_target
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    row_create_date date DEFAULT "sysdate"()
);


CREATE TABLE sandbox.ic_goal_setting
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1) DEFAULT 'N',
    dnp_flag char(1) DEFAULT 'N',
    market_rolling_6 float,
    product_rolling_6 float,
    market_rolling_12 float,
    market_baseline float,
    product_baseline float,
    target_market_rolling_6 float,
    target_product_rolling_6 float,
    target_market_rolling_12 float,
    target_market_baseline float,
    target_product_baseline float,
    include_in_nation_rollup char(1) DEFAULT 'Y',
    include_in_area_rollup char(1) DEFAULT 'Y',
    include_in_region_rollup char(1) DEFAULT 'Y',
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date DEFAULT "sysdate"()
);


CREATE TABLE sandbox.call_plan_decile
(
    hcp_id varchar(50),
    market varchar(50),
    decile_value varchar(50),
    veeva_id varchar(50)
);


CREATE TEMPORARY TABLE sandbox.tmp_file_id_purge
(
    file_id int,
    feed_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_file_id
(
    file_id int,
    feed_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_445_1_md
(
    bucket_date date,
    start_date date,
    end_date date,
    bucket_type varchar(10),
    rollup_445 date
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_445_2_md
(
    bucket_date date,
    start_date date,
    end_date date,
    bucket_type varchar(10),
    rollup_445 date
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_445_md
(
    bucket_date date,
    start_date date,
    end_date date,
    bucket_type varchar(10),
    rollup_445 date
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ddd_md
(
    onc_account_demo_id int,
    alt_seq_num varchar(10),
    outlet_name varchar(100),
    outlet_code varchar(10),
    ims_facility_number varchar(11),
    ims_prescriber_number varchar(7),
    subcategory_code varchar(10),
    outlet_zip varchar(5),
    ims_client_num varchar(3),
    ims_report_num varchar(2),
    report_frequency varchar(10),
    ims_product_code varchar(9),
    basket_id int,
    basket_name varchar(300),
    data_date date,
    date date,
    rollup_week date,
    rollup_month date,
    rollup_445 date,
    comp_month date,
    quantity numeric(37,15),
    dollars numeric(37,15),
    sales_force_id varchar(2),
    file_id int,
    record_id int,
    tvcmid int,
    outlet_tvcmid int,
    facility_tvcmid int,
    prescriber_tvcmid int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_qty_file_id_adhoc1_ad
(
    file_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_cnt_file_id_adhoc1_ad
(
    file_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.scd_roster
(
    scd_status varchar(10) DEFAULT 'Current',
    scd_effective_date date DEFAULT trunc("sysdate"()),
    scd_expiration_date date DEFAULT '2099-12-31'::date,
    employee_id varchar(100),
    territory_number varchar(100),
    territory_name varchar(255),
    sales_force_id varchar(100),
    full_name varchar(100),
    first_name varchar(100),
    middle_name varchar(100),
    last_name varchar(100),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(100),
    country varchar(100),
    business_address_line1 varchar(100),
    business_address_line2 varchar(100),
    business_address_line3 varchar(100),
    business_city varchar(100),
    business_state varchar(2),
    business_zip varchar(100),
    business_country varchar(100),
    shipping_address_line1 varchar(100),
    shipping_address_line2 varchar(100),
    shipping_address_line3 varchar(100),
    shipping_city varchar(100),
    shipping_state varchar(2),
    shipping_zip varchar(100),
    shipping_country varchar(100),
    business_phone varchar(100),
    home_phone varchar(100),
    mobile_phone varchar(100),
    fax varchar(100),
    voice_mail_extension varchar(100),
    email varchar(255),
    hire_date date,
    title varchar(100),
    rep_type varchar(10),
    username varchar(100),
    out_of_territory varchar(5),
    parent_territory_number varchar(100),
    company_code varchar(100),
    original_hire_date date,
    team varchar(100),
    salutation varchar(15),
    suffix varchar(15),
    cost_center varchar(30),
    sample_eligibility_flag varchar(10),
    samplestorage_address_line1 varchar(100),
    samplestorage_address_line2 varchar(100),
    samplestorage_address_line3 varchar(100),
    samplestorage_city varchar(100),
    samplestorage_zip varchar(100),
    samplestorage_state varchar(2),
    samplestorage_country varchar(100),
    hr_status varchar(100),
    reg_contract varchar(100),
    preferred_name varchar(100),
    business_unit_cd varchar(10),
    business_unit_name varchar(100),
    veeva_user_id varchar(100),
    mngr_employee_id varchar(100),
    birth_month_day varchar(5),
    calculated_rep_type varchar(20),
    job_code varchar(10),
    oracle_string varchar(50),
    global_employee_id varchar(35),
    supervisor_global_employee_id varchar(35),
    separation_date date,
    separation_reason varchar(100)
);


CREATE TABLE sandbox.scd_sales_geography
(
    scd_status varchar(10) DEFAULT 'Current',
    scd_effective_date date DEFAULT trunc("sysdate"()),
    scd_expiration_date date DEFAULT '2099-12-31'::date,
    sales_force_id varchar(4),
    geography_number varchar(15),
    geography_name varchar(100),
    geography_desc varchar(100),
    geography_type varchar(15),
    employee_type varchar(10),
    sales_team varchar(100),
    parent_geography_number varchar(15),
    fleet_eligible_flag varchar(1)
);


CREATE TABLE sandbox.onc_osm_targets
(
    tvcmid int,
    target_value varchar(50)
);


CREATE TABLE sandbox.speaker_bureau_results_09192018
(
    tvcmid int,
    npi int,
    last_name varchar(50),
    first_name varchar(50),
    middle_name varchar(50),
    address varchar(63),
    city varchar(50),
    state varchar(50),
    zip int,
    speaker_affiliation varchar(77),
    authorization_number varchar(50),
    sln_state varchar(50),
    license_expiration_date timestamp,
    license_type_name varchar(69),
    license_status_description varchar(50),
    license_certification_name varchar(50),
    oig_flag varchar(20),
    fda_flag varchar(20),
    dea_flag varchar(20),
    "promotional speaker flag" varchar(20),
    "personal promotion flag" varchar(20),
    "non-personal promotion flag" varchar(20),
    "advisor/ consultant flag" varchar(20)
);


CREATE TABLE sandbox.QVAR_Missing_SLN_10152018
(
    "Client ID" int,
    "First Name" varchar(50),
    "Last Name" varchar(50),
    "Middle Name" varchar(20),
    Suffix varchar(20),
    "Address 1" varchar(63),
    "Address 2" varchar(50),
    "Address 3" varchar(20),
    City varchar(50),
    State varchar(50),
    Zip int
);


CREATE TABLE sandbox."KNIPPER QVARs IDs1033"
(
    TVCMID int,
    ims_id int
);


CREATE TABLE sandbox.TJR_DRM45
(
    AUDIT_CODE varchar(10),
    CLIENT_GROUP_DESCRIPTION varchar(100),
    CLIENT_NBR varchar(3),
    FILE_CODE varchar(2),
    PRODUCT_GROUP_NBR varchar(8),
    PRODUCT_GROUP_NAME varchar(100),
    PRODUCT_CODE varchar(8),
    PACK_CODE varchar(3),
    PROD_DESC varchar(255),
    WHOLESALE_PRICE varchar(50),
    MFR_DESC varchar(100),
    MFR_CODE varchar(5),
    SPEC_REPACK_IND varchar(5),
    USC_CODE varchar(10)
);


CREATE TABLE sandbox.QNASL_IMSID_04112019
(
    IMSID int
);


CREATE TABLE sandbox.ingestion_databurst_updt
(
    table_name varchar(128)
);


CREATE TABLE sandbox.grants_teva_ingestion
(
    grant_id int,
    grantor_id int,
    grantor varchar(128),
    privileges_description varchar(8192),
    object_schema varchar(128),
    object_name varchar(128),
    object_id int,
    object_type varchar(8192),
    grantee_id int,
    grantee varchar(128)
);


CREATE TABLE sandbox.ZS_AM_SUBMRKT_PRODLIST_10162019
(
    basket_id int,
    basket_name varchar(60),
    basket_type varchar(50),
    parent_basket_name varchar(56)
);


CREATE TABLE sandbox.ZS_AM_SUBMRKT_PRODLIST_10232019
(
    basket_id int,
    basket_name varchar(60),
    basket_type varchar(50),
    parent_basket_name varchar(56),
    Sub_Mrkt varchar(52)
);


CREATE TABLE sandbox.austedo_firstrx_callinfo_1212
(
    ims_id_original varchar(10),
    call_date date,
    ims_id varchar(10),
    first_rx_date date
);


CREATE TABLE sandbox.austedo_callfrequency_data_12121
(
    ims_id_original varchar(10),
    first_rx_date date,
    total_calls_before_firstrx int
);


CREATE TABLE sandbox.austedo_callfrequency_data_1212
(
    ims_id_original varchar(10),
    first_rx_date date,
    total_calls_before_firstrx int
);


CREATE TABLE sandbox.J_CHUNG_DEA_IDs
(
    "Physician DEA#" varchar(50)
);


CREATE TABLE sandbox.mb_customer
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    ims_outlet_code varchar(10),
    ims_facility_number varchar(11),
    federation_id varchar(200),
    customer_type varchar(15),
    prescriber_type varchar(25),
    network_name varchar(100),
    account_name varchar(100),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    credential varchar(100),
    subcat_group varchar(100),
    subcat_code varchar(2),
    pdrp_flag varchar(1),
    pri_specialty_code varchar(10),
    pri_specialty_desc varchar(100),
    sec_specialty_code varchar(10),
    sec_specialty_desc varchar(100),
    cm_status_flag varchar(15),
    gpo varchar(100),
    dnp_flag varchar(1),
    product_1_dnc_flag varchar(1),
    product_2_dnc_flag varchar(1),
    a_specialty_group varchar(10),
    b_specialty_group varchar(10),
    c_specialty_group varchar(10),
    formulary_control varchar(20)
);


CREATE TABLE sandbox.test_con_curr
(
    cust_id float,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.mb_ic_demo_tn
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.mb_ic_rx_tn
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.mb_ic_rx_tr
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.mb_ic_demo_tr
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.PhysicianInfo_Dustin_0518
(
    "Prescribing Physician FN" varchar(50),
    "Prescribing Physician LN" varchar(50),
    "Prescribing Physician NPI" int,
    "Prescribing Physician Zip Code" int
);


CREATE TABLE sandbox.test_concur_curr_kg
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.concur_hcp_curr
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.concur_hcp_delta
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.prescriber_rx_ics_splitweek_08252020
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count numeric(18,3),
    trx_count numeric(18,3),
    nrx_quantity numeric(18,3),
    trx_quantity numeric(18,3),
    unnormalized_nrx_count numeric(18,3),
    unnormalized_trx_count numeric(18,3),
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20),
    pbm_parent_name varchar(100)
);


CREATE TABLE sandbox.idl_just_best_address
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.test_wprefix_as
(
    cust_id varchar(23),
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.TV46K_LAI
(
    "IMS ID" int,
    TRx_Count_APD numeric(28,10),
    Decile_APD int,
    TRx_Count_LAI numeric(28,10),
    Decile_LAI int,
    "Specialty Code" varchar(50),
    "Specialty Group" varchar(50)
);


CREATE TABLE sandbox."SYNEOS TARGET FILE"
(
    ims_id int,
    tvcmid int,
    basket_id int,
    basket_name varchar(50),
    territory_number varchar(50),
    sales_force_id varchar(50),
    flag_type varchar(50),
    flag_value varchar(50),
    flag_effective_start_date timestamp,
    flag_effective_end_date timestamp
);


CREATE TABLE sandbox."IMS ID ISSUE_AUSTEDO_10262020"
(
    "IMS ID" varchar(50)
);


CREATE TABLE sandbox.pgk_my_sandbox
(
    "IMS ID" int,
    Decile int,
    TVCMID int,
    "First Name" varchar(50),
    "Last Name" varchar(50),
    "Middle Name" varchar(50),
    Suffix varchar(50),
    "Address 1" varchar(79),
    "Address 2" varchar(75),
    "Address 3" varchar(50),
    City varchar(50),
    State varchar(50),
    Zip int,
    "SLN 1" varchar(20),
    "SLN 1 Expiration Date" varchar(20),
    "SLN 2" varchar(20),
    "SLN 2 State" varchar(20),
    "SLN 2 Expiration Date" varchar(20),
    Specialty varchar(50),
    "Specialty Description" varchar(66),
    "Specialty Group" varchar(50),
    "IMS ID_1" int,
    NPI varchar(50),
    DEA varchar(20),
    Designation varchar(50),
    Decile_1 int,
    "Email Rented?" varchar(73),
    "Dup IMS ID" varchar(20)
);


CREATE TEMPORARY TABLE sandbox.tmp_demo_rank1
(
    veeva_account_id varchar(32),
    territory_number varchar(8),
    demo_rank int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_demo_rank2
(
    veeva_account_id varchar(32),
    territory_number varchar(8),
    demo_rank int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_lat_lon_sfa
(
    address_id int,
    tvcmid int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    veeva_address_id varchar(20),
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.TVCMID
(
    tvcmid int,
    State varchar(10)
);


CREATE TABLE sandbox.ic_rx_jan2021
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_jan2021
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.mb_to_weekly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int
);


CREATE TABLE sandbox.ic_rx_feb2021
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_feb2021
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.ic_rx_apr2021
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_apr2021
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.payer_demo
(
    payer_id int,
    payer_name varchar(80)
);


CREATE TABLE sandbox.ftf_formularies
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ftf_health_plans
(
    formularyf_id varchar(6),
    provider_id varchar(6),
    provider varchar(250),
    health_plan_id varchar(6),
    health_plan varchar(100),
    parent_id varchar(6),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(64),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ftf_pbms
(
    health_plan_id varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ims_pbm_xref
(
    pbm_name varchar(100),
    payer_plan_num varchar(10),
    xref_to_payer_plan_num varchar(10),
    ipd_id varchar(10),
    ipd_type varchar(10),
    plan_name varchar(100),
    pbm_num varchar(6),
    ims_processor_num varchar(10),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ftf_ims_bridge
(
    payer_name varchar(200),
    code varchar(50),
    name varchar(250),
    state varchar(2),
    comments varchar(250),
    plan_id varchar(100),
    plan_name varchar(250),
    provider_name varchar(250),
    plan_type_name varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.iqvia_paytypeindex
(
    paytype_index varchar(64),
    paytype varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_paytypeindex.file_id);


CREATE TABLE sandbox.ftf_paytype_paytypeindex
(
    payType_index varchar(64),
    paytype varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_paytype_paytypeindex.file_id);


CREATE TABLE sandbox.step_restriction
(
    code int,
    restriction_group varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (step_restriction.file_id);


CREATE TABLE sandbox.medical_rec_restriction
(
    code int,
    restriction_detail_id varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (medical_rec_restriction.file_id);


CREATE TABLE sandbox.unspecified_rec_restriction
(
    code int,
    restriction_detail_id varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (unspecified_rec_restriction.file_id);


CREATE TABLE sandbox.raw_ftf_restrictions_2
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(250),
    restriction_addtnl_information_1 varchar(4000),
    restriction_addtnl_information_2 varchar(4000),
    step_count varchar(50),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255)
);


CREATE TABLE sandbox.raw_ftf_restrictions
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(500),
    restriction_addtnl_information_1 varchar(4000),
    restriction_addtnl_information_2 varchar(4000),
    step_count varchar(50),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255)
);


CREATE TABLE sandbox.raw_ftf_health_plan_geography
(
    health_plan_id varchar(6),
    county_fips_id int,
    county_id int,
    county_name varchar(50),
    state_id int,
    state_name varchar(10),
    county_lives numeric(14,2)
);


CREATE TABLE sandbox.raw_access_master_bridge
(
    ftf_health_plan_fid varchar(64),
    ftf_health_plan_name varchar(200),
    ajovy_coverage_category varchar(100),
    aimovid_coverage_category varchar(100),
    emgality_coverage_category varchar(100),
    ftf_provider_fid varchar(64),
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    pay_type_index varchar(64),
    pay_type varchar(64),
    ftf_health_plan_type varchar(64),
    key_controlling_plan_formulary varchar(100),
    key_controlling_account varchar(100),
    key_pbm varchar(100),
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(100),
    ftf_formulary_influencer_pbm varchar(100),
    ftf_claims_processing_pbm varchar(100),
    pref_brand_tier varchar(64),
    ftf_match_iqvia int,
    lives_m1 int,
    lives_m2 int,
    lives_m3 int,
    lives_m4 int,
    lives_m5 int,
    lives_m6 int,
    lives_m7 int,
    lives_m8 int,
    lives_m9 int,
    lives_m10 int,
    lives_m11 int,
    lives_m12 int,
    lives_m13 int,
    lives_m14 int,
    lives_m15 int,
    lives_m16 int,
    lives_m17 int
);


CREATE TABLE sandbox.access_monitor_s121
(
    client_id varchar(4),
    client_physician_id varchar(25),
    me_number varchar(11),
    npi varchar(11),
    valid_menum_flag numeric(5,2),
    valid_npi_flag numeric(5,2),
    am_no_see_rating numeric(5,2),
    teams_no_see_rating varchar(25),
    annual_call_freq_perc_25 numeric(5,2),
    annual_call_freq_perc_50 numeric(5,2),
    annual_call_freq_perc_75 numeric(5,2),
    teams_call_freq varchar(25),
    industry_attainment numeric(5,2),
    teams_attainment varchar(25),
    attn_perc_25 numeric(5,2),
    attn_perc_50 numeric(5,2),
    attn_perc_75 numeric(5,2),
    teams_attn_perc varchar(25),
    am_specialty_grouping varchar(50),
    teams_spec varchar(25),
    am_zip varchar(15),
    teams_zip varchar(25),
    reach_type varchar(25),
    annual_f2f_call_freq_perc_25 numeric(5,2),
    annual_f2f_call_freq_perc_50 numeric(5,2),
    annual_f2f_call_freq_perc_75 numeric(5,2),
    teams_call_freq_f2f varchar(25),
    annual_remote_call_freq_perc_25 numeric(5,2),
    annual_remote_call_freq_perc_50 numeric(5,2),
    annual_remote_call_freq_perc_75 numeric(5,2),
    teams_call_freq_remote varchar(25)
);


CREATE TABLE sandbox.Enrollment
(
    Prescriber_Name varchar(150),
    State varchar(50),
    Zip varchar(10),
    NPI varchar(15)
);


CREATE TABLE sandbox.ic_rx_may2021
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_may2021
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.PGKMediCal
(
    "<NullColumn 0>" varchar(50),
    "<NullColumn 1>" varchar(53),
    "<NullColumn 2>" varchar(50),
    "<NullColumn 3>" varchar(50),
    "<NullColumn 4>" varchar(50),
    "<NullColumn 5>" varchar(50),
    "<NullColumn 6>" varchar(50),
    "<NullColumn 7>" varchar(66),
    "<NullColumn 8>" varchar(50),
    "<NullColumn 9>" numeric(28,10),
    "<NullColumn 10>" numeric(28,10),
    "<NullColumn 11>" numeric(28,10),
    "<NullColumn 12>" numeric(28,10)
);


CREATE TABLE sandbox.PSS_ARX_HCP_LIST
(
    "Prescribing Physician FN" varchar(50),
    "Prescribing Physician LN" varchar(50),
    "Prescribing Physician NPI" int
);


CREATE TABLE sandbox.comparison_payer_spine_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    payment_type varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    lives_plan_kcf_lvl int,
    lives_plan_lvl int,
    apportionment_factor numeric(37,15),
    saba_trx numeric(37,15),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_payment_type int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_lives_plan_kcf_lvl int,
    change_lives_plan_lvl int,
    change_apportionment_factor int,
    change_saba_trx int,
    change int,
    month_flag varchar(200),
    status varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (comparison_payer_spine_cdw_v1.cycle_id);


CREATE TABLE sandbox.tmp_weekly_total_calls
(
    sales_force_id varchar(8),
    call_id varchar(80),
    customer_id varchar(20),
    geography_level varchar(9),
    geography_id varchar(10),
    geography varchar(100),
    rep_name varchar(1),
    user_id varchar(1),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(11),
    time_period varchar(6),
    period_type varchar(5),
    period varchar(63),
    week_bucket int,
    date_sent timestamptz,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(3),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int
);


CREATE TABLE sandbox.temp_sp
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    geography_level varchar(9),
    geography_id varchar(10),
    geography varchar(100),
    rep_name varchar(1),
    user_id varchar(1),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(6),
    period_type varchar(5),
    period date,
    week_bucket int,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(15),
    call_recordtype varchar(80),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int,
    prsc_reach int
);


CREATE TABLE sandbox.test_cumm_count
(
    period varchar(80),
    customer_id varchar(80)
);


CREATE TABLE sandbox.coverage_category_derivation_config_vOct
(
    tier_regex varchar(200),
    pharmacy_status_regex varchar(200),
    paytype_regex varchar(200),
    haspa_regex varchar(200),
    hasst_regex varchar(200),
    haspast_regex varchar(200),
    rest_groupstep_regex varchar(200),
    coverage_category varchar(200),
    record_id int,
    file_id int
)
PARTITION BY (coverage_category_derivation_config_vOct.file_id);


CREATE TABLE sandbox.ftf_restriction_id_group_mapping
(
    restriction_detail_id int,
    restriction_detail_text varchar(15000),
    grouped_restriction_level varchar(3000),
    coverage_category varchar(1000),
    used_flag int,
    notes varchar(1000),
    file_id int,
    record_id int
)
PARTITION BY (ftf_restriction_id_group_mapping.file_id);


CREATE TEMPORARY TABLE sandbox.tmp_file_id_ddd_md
(
    file_id int,
    feed_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.ts_monthly_new_prescriber
(
    customer_id varchar(200),
    brand_id int,
    month_ending date,
    month_bucket int,
    curr_trx float,
    prev_trx float
);


CREATE TABLE sandbox.ts_monthly_prescriber_sales
(
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    product_id int,
    payer_plan_id varchar(200),
    month_ending date,
    month_bucket int,
    data_source varchar(200),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx float,
    nrx float,
    trx_units float,
    nrx_units float,
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE sandbox.ts_monthly_prescriber_sales_summary
(
    sales_force_id varchar(200),
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    period_type varchar(200),
    period varchar(200),
    month_ending date,
    month_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(200),
    payer_plan_id varchar(200),
    method_of_payment varchar(200),
    hcp_restriction_flag varchar(200),
    segment varchar(200),
    decile varchar(200),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(37,15),
    prev_prod_vol_trx_count numeric(37,15),
    product_vol_nrx_count numeric(37,15),
    prev_prod_vol_nrx_count numeric(37,15),
    market_vol_trx_count numeric(37,15),
    prev_market_vol_trx_count numeric(37,15),
    market_vol_nrx_count numeric(37,15),
    prev_market_vol_nrx_count numeric(37,15),
    samples numeric(37,15),
    details_p1 numeric(37,15),
    details_p2 numeric(37,15),
    details_p3 numeric(37,15)
);


CREATE TABLE sandbox.ts_monthly_prescriber_summary
(
    sales_force_id varchar(200),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(200),
    period varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(200),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(200),
    prescriber_name varchar(102),
    new_prescriber varchar(1),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    target_status_flag varchar(1),
    partner_target_status_flag varchar(1),
    method_of_payment varchar(200),
    specialty varchar(25),
    segment varchar(200),
    decile varchar(200),
    market_volume_indicator int,
    product_vol_trx_count numeric(37,15),
    market_vol_trx_count numeric(37,15),
    prev_prod_vol_trx_count numeric(37,15),
    prev_market_vol_trx_count numeric(37,15),
    product_vol_nrx_count numeric(37,15),
    market_vol_nrx_count numeric(37,15),
    prev_prod_vol_nrx_count numeric(37,15),
    prev_market_vol_nrx_count numeric(37,15),
    samples numeric(37,15),
    details_p1 numeric(37,15),
    details_p2 numeric(37,15),
    details_p3 numeric(37,15)
);


CREATE TABLE sandbox.ts_monthly_payer_prescriber_summary
(
    sales_force_id varchar(200),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE sandbox.ts_monthly_geography_summary
(
    sales_force_id varchar(200),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE sandbox.ts_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE sandbox.ts_weekly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    week_ending date,
    week_bucket int,
    data_source varchar(7),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE sandbox.ts_weekly_new_prescriber
(
    customer_id varchar(25),
    brand_id int,
    week_ending date,
    week_bucket int,
    curr_trx numeric(21,3),
    prev_trx numeric(21,3)
);


CREATE TABLE sandbox.ts_weekly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    week_ending date,
    week_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE sandbox.ts_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    partner_target_status_flag varchar(5),
    target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE sandbox.ts_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE sandbox.ts_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    rep_type varchar(100),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TEMPORARY TABLE sandbox.tmp_call_hist_c_new
(
    id varchar(18),
    isdeleted varchar(5),
    parentid varchar(18),
    createdbyid varchar(18),
    createddate timestamptz,
    field varchar(255),
    oldvalue varchar(255),
    newvalue varchar(255),
    file_id int,
    record_id int,
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.sales_force_headcounts
(
    sales_force_id varchar(5),
    month date,
    headcount int,
    products int,
    rep_type varchar(100)
);


CREATE TABLE sandbox.reporting_markets
(
    basket_id int,
    basket_name varchar(300),
    basket_type varchar(100),
    status varchar(1),
    geo_summary_include varchar(1),
    presc_summary_include varchar(1),
    market_share_market_id int,
    market_share_brand_id int,
    rptg_decile_attribute_type varchar(100),
    rptg_decile_attribute_prod_id int,
    rptg_segment_attribute_type varchar(100),
    rptg_segment_attribute_prod_id int
);


CREATE TABLE sandbox.tmp_monthly_hcp_activity
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    territory_id varchar(10),
    product_id int,
    month_ending date,
    month_bucket int,
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(20,2)
);


CREATE TABLE sandbox.tmp_monthly_hcp_trend_v2
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    geography_level varchar(10),
    nation_id varchar(10),
    nation_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(7),
    period_type varchar(5),
    period date,
    month_bucket int,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(20,2)
);


CREATE TABLE sandbox.par_rnf_test
(
    sales_force_id varchar(5),
    geography_level varchar(9),
    geography_id varchar(10),
    geography varchar(100),
    rep_name varchar(1),
    user_id varchar(1),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(7),
    period_type varchar(5),
    period date,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(20,2),
    prescriber_count_calls int,
    prescriber_count_samples int,
    prescriber_reached_calls int,
    prescriber_reached_samples int
);


CREATE TABLE sandbox.ts_weekly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    decile varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_units numeric(18,3),
    market_vol_units numeric(18,3),
    prev_prod_vol_units numeric(18,3),
    prev_market_vol_units numeric(18,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE sandbox.ts_weekly_account_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    segment varchar(100),
    decile varchar(100),
    target varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    channel varchar(50),
    market_volume_indicator int,
    new_accounts int,
    accounts_ordering int,
    avg_sales_per_account numeric(18,2),
    prev_accounts_ordering int,
    product_vol_units numeric(18,3),
    market_vol_units numeric(18,3),
    prev_prod_vol_units numeric(18,3),
    prev_market_vol_units numeric(18,3),
    accounts_detailed_count int,
    total_accounts_count int
);


CREATE TABLE sandbox.tmp_monthly_hcp_trend
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    geography_level varchar(10),
    nation_id varchar(10),
    nation_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(7),
    period_type varchar(5),
    period date,
    month_bucket int,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(38,20)
);


CREATE TABLE sandbox.par_rnf_ho
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(15),
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(25),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int,
    prescriber_count_calls int,
    prescriber_count_samples int,
    prescriber_reached_calls int,
    prescriber_reached_samples int,
    how_executed varchar(40),
    call_recordtype varchar(80)
);


CREATE TABLE sandbox.uzedy_reverse_geo_payer_weekly
(
    ts_nation_id varchar(10),
    ts_nation varchar(10),
    ts_area_id varchar(10),
    ts_area varchar(100),
    ts_region_id varchar(10),
    ts_region varchar(100),
    ts_territory_id varchar(10),
    ts_territory varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(100),
    zip varchar(10),
    key_controlling_parent varchar(100),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    gpo varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3)
);


CREATE TABLE sandbox.tmp_weekly_hcp_activity_1
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    territory_id varchar(10),
    product_id int,
    week_ending date,
    week_bucket int,
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(38,20)
);


CREATE TABLE sandbox.tmp_weekly_rte_trend
(
    sales_force_id varchar(8),
    call_id varchar(80),
    customer_id varchar(20),
    geography_level varchar(6),
    geography_id varchar(8),
    geography varchar(6),
    rep_name varchar(1),
    user_id varchar(1),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(2600),
    time_period varchar(6),
    period_type varchar(5),
    period date,
    week_bucket int,
    date_sent timestamptz,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(3),
    call_recordtype varchar(1),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int
);


CREATE TABLE sandbox.tmp_monthly_rte_trend
(
    sales_force_id varchar(8),
    call_id varchar(80),
    customer_id varchar(20),
    geography_level varchar(6),
    geography_id varchar(8),
    geography varchar(6),
    rep_name varchar(1),
    user_id varchar(1),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(2600),
    time_period varchar(7),
    period_type varchar(5),
    period date,
    month_bucket int,
    date_sent timestamptz,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(3),
    call_recordtype varchar(1),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int
);


CREATE TABLE sandbox.tmp_monthly_rte_agg
(
    customer_id varchar(20),
    sales_force_id varchar(8),
    geography_level varchar(6),
    geography_id varchar(8),
    geography varchar(6),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(2600),
    time_period varchar(7),
    period_type varchar(10),
    period varchar(11),
    date_sent timestamptz,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(3),
    call_recordtype varchar(1),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int
);


CREATE TABLE sandbox.ajovy_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    ns_nation_id varchar(8),
    ns_nation varchar(200),
    ns_area_id varchar(8),
    ns_area varchar(200),
    ns_region_id varchar(8),
    ns_region varchar(200),
    ns_territory_id varchar(8),
    ns_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    lives_covered int,
    key_controlling_parent varchar(100),
    gpo varchar(100)
);


CREATE TABLE sandbox.austedo_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    np_nation_id varchar(8),
    np_nation varchar(200),
    np_area_id varchar(8),
    np_area varchar(200),
    np_region_id varchar(8),
    np_region varchar(200),
    np_territory_id varchar(8),
    np_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    key_controlling_parent varchar(100),
    gpo varchar(100)
);


CREATE TABLE sandbox.digihaler_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    rs_nation_id varchar(8),
    rs_nation varchar(200),
    rs_area_id varchar(8),
    rs_area varchar(200),
    rs_region_id varchar(8),
    rs_region varchar(200),
    rs_territory_id varchar(8),
    rs_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    key_controlling_parent varchar(100),
    gpo varchar(100)
);


CREATE TABLE sandbox.tp_anti_psych_weekly_new_prescriber
(
    customer_id varchar(25),
    brand_id int,
    week_ending date,
    week_bucket int,
    curr_trx numeric(21,3),
    prev_trx numeric(21,3)
);


CREATE TABLE sandbox.tp_anti_psych_weekly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    week_ending date,
    week_bucket int,
    data_source varchar(7),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE sandbox.tp_anti_psych_weekly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    week_ending date,
    week_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE sandbox.tp_anti_psych_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE sandbox.tmp_weekly_hcp_activity
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    territory_id varchar(10),
    product_id int,
    week_ending date,
    week_bucket int,
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(38,20)
);


CREATE TABLE sandbox.tmp_weekly_hcp_trend
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    geography_level varchar(10),
    nation_id varchar(10),
    nation_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(6),
    period_type varchar(5),
    period date,
    week_bucket int,
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(38,20)
);


CREATE TABLE sandbox.tmp_weekly_hcp_agg
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    geography_level varchar(10),
    nation_id varchar(10),
    nation_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(6),
    period_type varchar(10),
    period varchar(10),
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(100),
    how_executed varchar(40),
    call_recordtype varchar(80),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2),
    total_details numeric(20,2),
    samples numeric(38,20)
);


CREATE TABLE sandbox.tmp_hcp_universe
(
    customer_id varchar(25),
    sales_force_id varchar(5),
    current_geography_id varchar(10),
    product_id int,
    target_status varchar(1),
    period_ending date,
    week_bucket int
);


CREATE TABLE sandbox.oncology_sales_deciles
(
    account_demo_id int,
    outlet_name varchar(100),
    outlet_zip varchar(5),
    decile_name varchar(75),
    basket_id int,
    basket_name varchar(300),
    decile_reported_dollars_6_mo int,
    decile_reported_dollars_12_mo int,
    reported_dollars_6_mo float,
    reported_dollars_12_mo float,
    reported_dollars_24_mo float,
    tvcmid int
);


CREATE TABLE sandbox.ic_ms_market_decile_201701
(
    ims_id varchar(10),
    category varchar(100),
    decile_name varchar(50),
    trx_cnt_01_06 int,
    trx_cnt_01_12 int
);


CREATE TABLE sandbox.STG_LAAD_DIAGNOSIS
(
    CLAIM_ID numeric(19,0),
    PATIENT_ID numeric(19,0),
    SERVICE_DATE date,
    DIAGNOSIS_CODE varchar(20),
    RENDERING_PRESCRIBER_ID numeric(19,0),
    REFERRING_PRESCRIBER_ID numeric(19,0)
);


CREATE TABLE sandbox.STG_LAAD_DIAGNOSIS_CODE
(
    DIAGNOSIS_CODE varchar(20),
    DIAGNOSIS_DESCRIPTION varchar(300)
);


CREATE TABLE sandbox.STG_LAAD_PATIENT
(
    PATIENT_ID numeric(19,0),
    PATIENT_BIRTH_YEAR numeric(4,0),
    PATIENT_GENDER varchar(1)
);


CREATE TABLE sandbox.STG_LAAD_PLAN
(
    PLAN_ID varchar(10),
    PAYER_NAME varchar(50),
    PLAN_NAME varchar(50),
    PBM_NAME varchar(50),
    METHOD_OF_PAYMENT varchar(50),
    MODEL_TYPE varchar(50)
);


CREATE TABLE sandbox.STG_LAAD_PRESCRIBER
(
    PRESCRIBER_ID varchar(10),
    FIRST_NAME varchar(100),
    LAST_NAME varchar(100),
    ADDRESS varchar(100),
    CITY varchar(100),
    STATE varchar(2),
    ZIP varchar(5),
    SPECIALTY_CODE varchar(10),
    SPECIALTY_DESC varchar(300),
    ME_NUM varchar(20),
    NPI varchar(20)
);


CREATE TABLE sandbox.STG_LAAD_PROCEDURE
(
    CLAIM_ID numeric(19,0),
    CLAIM_SERVICE_NUMBER numeric(19,0),
    PATIENT_ID numeric(19,0),
    SERVICE_DATE date,
    PROCEDURE_CODE varchar(20),
    RENDERING_PRESCRIBER_ID numeric(19,0),
    REFERRING_PRESCRIBER_ID numeric(19,0)
);


CREATE TABLE sandbox.STG_LAAD_PROCEDURE_CODE
(
    PROCEDURE_CODE varchar(20),
    PROCEDURE_DESCRIPTION varchar(100)
);


CREATE TABLE sandbox.STG_LAAD_PRODUCT
(
    NATL_DRUG_CODE varchar(11),
    BRAND_NAME varchar(100),
    GENERIC_NAME varchar(100),
    BRAND_GENERIC_FLAG varchar(1),
    DRUG_FORM varchar(100),
    DRUG_STRENGTH varchar(100),
    PACKAGE_SIZE numeric(10,2),
    MANUFACTURER varchar(100),
    USC_CODE varchar(5),
    USC_DESCRIPTION varchar(50)
);


CREATE TABLE sandbox.create_paragard_specialty_rx1
(
    "BP #" varchar(50),
    "Ortho E" varchar(1),
    "BP Name" varchar(100),
    "Ship-to Street" varchar(100),
    "Ship-to City" varchar(50),
    "Ship-to State" varchar(2),
    "Ship-to ZipCd" varchar(20),
    "Ship-to Ctry" varchar(1),
    "Ship-to Phone" varchar(1),
    "Ship-to Fax" varchar(1),
    "Ship-to Email" varchar(1),
    "Bill-to Street" varchar(100),
    "Bill-to City" varchar(50),
    "Bill-to State" varchar(20),
    "Bill-to ZipCd" varchar(10),
    "Bill-to Ctry" varchar(1),
    "Bill-to Phone" varchar(1),
    "Bill-to Fax" varchar(1),
    "Bill-to Email" varchar(1),
    "Class of Trade" varchar(20),
    "Invoice #" varchar(50),
    "Del Amt" varchar(42),
    "Inv Date" varchar(110),
    "24237" varchar(22),
    "24238" varchar(1),
    "24800" varchar(1),
    "33223" varchar(1),
    Packs varchar(20),
    UnitPrice varchar(1),
    Territory varchar(1),
    "Order Type Cd" varchar(1),
    "Order Type Desc" varchar(1),
    LOBCdDesc varchar(1),
    PriceMatrixDef varchar(1),
    ParentBPCd varchar(110),
    ParentBPCdDesc varchar(1),
    GrandParentBPCdDesc varchar(1),
    "PO#" varchar(1),
    "UPS#" varchar(1),
    OrdNbr varchar(50),
    OrdLnNbr varchar(1),
    DiscAmt varchar(1),
    WhseCd varchar(1),
    Data_Source varchar(4),
    NDC11_CODE varchar(11)
);


CREATE TABLE sandbox.load_bag_territory
(
    territory_number varchar(8),
    bag_name varchar(100)
);


CREATE TABLE sandbox.ic_rx_factor
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    rollup_month date,
    multiplier float,
    approved_trx_count float,
    total_trx_count float
);


CREATE TEMPORARY TABLE sandbox.tmp_file_id_test
(
    file_id int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ims_data_w_test
(
    sales_force_id varchar(5),
    ims_id varchar(22),
    me_num varchar(10),
    specialty varchar(8),
    specialty_source varchar(8),
    last_name varchar(25),
    first_name varchar(25),
    middle_name varchar(2),
    address varchar(30),
    city varchar(25),
    state varchar(2),
    zip varchar(10),
    data_date date,
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ims_data_m_test
(
    sales_force_id varchar(5),
    ims_id varchar(22),
    me_num varchar(10),
    specialty varchar(8),
    specialty_source varchar(8),
    last_name varchar(25),
    first_name varchar(25),
    middle_name varchar(2),
    address varchar(30),
    city varchar(25),
    state varchar(2),
    zip varchar(10),
    data_date date,
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ims_data_final_test
(
    sales_force_id varchar(5),
    ims_id varchar(22),
    me_num varchar(10),
    specialty varchar(8),
    last_name varchar(25),
    first_name varchar(25),
    middle_name varchar(2),
    address varchar(30),
    city varchar(25),
    state varchar(2),
    zip varchar(10)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tn_align_test
(
    veeva_account_id varchar(32),
    ims_id varchar(10),
    veeva_address_id varchar(20),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    phone varchar(1),
    territory_number varchar(8),
    territory_type varchar(10),
    address_source varchar(11),
    sfa_create_date date,
    sfa_align_date date,
    last_call_date date,
    last_call_this_sales_force date,
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tn_calls_test
(
    sales_force_id varchar(5),
    ims_id varchar(10),
    veeva_account_id varchar(32),
    org varchar(255),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    veeva_address_id varchar(20),
    phone varchar(1),
    territory_number varchar(8),
    address_source varchar(11),
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tp_align_test
(
    veeva_account_id varchar(32),
    ims_id varchar(10),
    veeva_address_id varchar(20),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    phone varchar(1),
    territory_number varchar(8),
    territory_type varchar(10),
    address_source varchar(11),
    sfa_create_date date,
    sfa_align_date date,
    last_call_date date,
    last_call_this_sales_force date,
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tp_calls_test
(
    sales_force_id varchar(5),
    ims_id varchar(10),
    veeva_account_id varchar(32),
    org varchar(255),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    veeva_address_id varchar(20),
    phone varchar(1),
    territory_number varchar(8),
    address_source varchar(11),
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tr_align_test
(
    veeva_account_id varchar(32),
    ims_id varchar(10),
    veeva_address_id varchar(20),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    phone varchar(1),
    territory_number varchar(8),
    territory_type varchar(10),
    address_source varchar(11),
    sfa_create_date date,
    sfa_align_date date,
    last_call_date date,
    last_call_this_sales_force date,
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tr_calls_test
(
    sales_force_id varchar(5),
    ims_id varchar(10),
    veeva_account_id varchar(32),
    org varchar(255),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    veeva_address_id varchar(20),
    phone varchar(1),
    territory_number varchar(8),
    address_source varchar(11),
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tw_calls_test
(
    sales_force_id varchar(5),
    ims_id varchar(10),
    veeva_account_id varchar(32),
    org varchar(255),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    veeva_address_id varchar(20),
    phone varchar(1),
    territory_number varchar(8),
    address_source varchar(11),
    rnk int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_territory_test
(
    sales_force_id varchar(20),
    ims_id varchar(10),
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(30),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(10),
    npi varchar(10),
    tvcmid int,
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    territory_number varchar(8),
    territory_type varchar(6)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_veeva_id_test
(
    tvcmid int,
    veeva_account_id varchar(100)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_dup_tvcmid
(
    tvcmid int,
    sales_force_id varchar(2),
    count int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_dup_outlet
(
    tvcmid int,
    outlet_code varchar(10),
    ims_facility_number varchar(11),
    ims_prescriber_number varchar(7),
    sales_force_id varchar(2)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ddd_qty
(
    tvcmid int,
    outlet_code varchar(10),
    ims_facility_number varchar(11),
    ims_prescriber_number varchar(7),
    sales_force_id varchar(2),
    quantity float
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_ddd_md_qty
(
    tvcmid int,
    outlet_code varchar(10),
    ims_prescriber_number varchar(7),
    ims_facility_number varchar(11),
    sales_force_id varchar(2),
    quantity float
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tvcmid_combine
(
    outlet_code varchar(10),
    ims_prescriber_number varchar(7),
    ims_facility_number varchar(11),
    sales_force_id varchar(2),
    tvcmid int,
    quantity float
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_tvcmid_combine_final
(
    outlet_code varchar(10),
    ims_prescriber_number varchar(7),
    ims_facility_number varchar(11),
    sales_force_id varchar(2),
    tvcmid int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_remaining_dup_tvcmid_no_sales
(
    tvcmid int,
    sales_force_id varchar(2)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_no_sales_data
(
    account_demo_id int,
    outlet_code varchar(10),
    ims_facility_number varchar(11),
    ims_prescriber_number varchar(7),
    category_code varchar(10),
    subcategory_code varchar(2),
    alignment_zip varchar(5),
    outlet_name varchar(100),
    outlet_address varchar(120),
    outlet_city varchar(40),
    outlet_state varchar(2),
    outlet_zip varchar(5),
    facility_name varchar(100),
    facility_address1 varchar(60),
    facility_address2 varchar(60),
    facility_address3 varchar(60),
    facility_address4 varchar(60),
    facility_city varchar(40),
    facility_state varchar(2),
    facility_zip varchar(5),
    prescriber_name varchar(100),
    prescriber_address1 varchar(60),
    prescriber_address2 varchar(60),
    prescriber_address3 varchar(60),
    prescriber_address4 varchar(60),
    prescriber_city varchar(40),
    prescriber_state varchar(2),
    prescriber_zip varchar(5),
    account_status varchar(1),
    tvcmid int,
    sales_force_id varchar(2),
    outlet_tvcmid int,
    facility_tvcmid int,
    prescriber_tvcmid int,
    tvcmid_assignment_rule varchar(25),
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_roster
(
    employee_id varchar(7),
    territory_num varchar(225),
    territory_name varchar(255),
    team varchar(50),
    hire_dt_rnk int,
    sales_force_id varchar(8),
    full_name varchar(152),
    last_name varchar(50),
    first_name varchar(50),
    middle_name varchar(50),
    person_title varchar(15),
    name_suffix varchar(15),
    address_line1 varchar(50),
    address_line2 varchar(50),
    city varchar(50),
    state varchar(2),
    zip varchar(20),
    bus_address_line1 varchar(50),
    bus_address_line2 varchar(50),
    bus_city varchar(50),
    bus_state varchar(2),
    bus_zip varchar(20),
    ship_address_line1 varchar(50),
    ship_address_line2 varchar(50),
    ship_city varchar(50),
    ship_state varchar(2),
    ship_zip varchar(20),
    business_phone varchar(69),
    home_phone varchar(69),
    cell_phone varchar(69),
    fax varchar(69),
    voice_mail_ext varchar(69),
    email varchar(255),
    hire_date date,
    title varchar(50),
    stat_code varchar(2),
    payroll_cost_ctr varchar(30),
    rep_type varchar(3),
    area_trainer varchar(1),
    username varchar(15),
    out_of_territory varchar(1),
    parent_territory_num varchar(26)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_roster2
(
    employee_id varchar(7),
    orig_hire_dt date,
    rehire_dt date
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.qc_table_stats
(
    log_date date NOT NULL,
    table_schema varchar(128) NOT NULL,
    table_name varchar(128) NOT NULL,
    row_count int,
    used_bytes int,
    null_tvcmid_count int,
    null_basket_id_count int,
    unique_file_ids int,
    max_file_id int,
    CONSTRAINT C_PRIMARY PRIMARY KEY (log_date, table_schema, table_name) DISABLED
);


CREATE TABLE sandbox.oncology_detail_goals
(
    territory_number varchar(8),
    bendeka_quota int,
    granix_quota int
);


CREATE TABLE sandbox.onc_sales_adjustment_load
(
    adj_code varchar(10),
    adj_time_period varchar(10),
    tvcmid int,
    basket_id int,
    adj_factor numeric(10,2)
);


CREATE TABLE sandbox.customer_flags_nr
(
    hcp_id varchar(50),
    flag_type varchar(50),
    flag_value varchar(50)
);


CREATE TABLE sandbox.tmp_mil_roster
(
    SALES_FORCE_ID varchar(100),
    REP_TYPE varchar(10),
    TERRITORY_NUM varchar(100),
    LAST_NAME varchar(100),
    FIRST_NAME varchar(100),
    SHIP_ADDRESS_LINE1 varchar(100),
    SHIP_ADDRESS_LINE2 varchar(100),
    SHIP_CITY varchar(100),
    SHIP_STATE varchar(2),
    SHIP_ZIP varchar(100),
    PHONE varchar(100),
    EMAIL varchar(255),
    DISTRICT varchar(100),
    REGION varchar(100)
);


CREATE TABLE sandbox.data_feed_metadata_bkp
(
    feed_id int,
    short_name varchar(255),
    subject_area varchar(255),
    source_name varchar(255),
    description varchar(255),
    frequency varchar(255),
    incremental boolean,
    process_cleanse boolean,
    process_intg boolean,
    source_id int
);


CREATE TABLE sandbox.scd_sfa_demographics
(
    scd_status varchar(10) DEFAULT 'Current',
    scd_effective_date date DEFAULT trunc("sysdate"()),
    scd_expiration_date date DEFAULT '2099-12-31'::date,
    veeva_account_id varchar(32),
    sales_force_id varchar(5),
    customer_type varchar(50),
    ims_id varchar(10),
    npi varchar(10),
    ims_outlet_code varchar(12),
    territory_number varchar(8),
    territory_type varchar(10),
    territory_status varchar(30),
    last_name varchar(80),
    first_name varchar(50),
    middle_name varchar(50),
    suffix_name varchar(10),
    credentials varchar(50),
    organization_name varchar(255),
    veeva_address_id varchar(20),
    address_line1 varchar(100),
    address_line2 varchar(100),
    address_line3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    address_status varchar(20),
    phone varchar(50),
    phone_ext varchar(12),
    fax varchar(50),
    mobile varchar(50),
    email varchar(200),
    prim_specialty varchar(255),
    specialty_code varchar(5),
    sfa_create_date date,
    bp_code varchar(20),
    sfa_align_date date,
    account_demo_id varchar(30),
    pdrp_flag varchar(5),
    designation varchar(255),
    business_type varchar(40),
    area_number varchar(8),
    region_number varchar(8),
    tvcmid int,
    address_id int
);


CREATE TABLE sandbox.QVAR_IDs_From_Knipper
(
    "Client ID" int,
    "IMS ID" int
);


CREATE TABLE sandbox.compliance_speaker_list_adhoc
(
    tvcmid int,
    npi int,
    last_name varchar(50),
    first_name varchar(50),
    middle_name varchar(20),
    address varchar(61),
    city varchar(50),
    state varchar(50),
    zip int,
    speaker_affiliation varchar(50)
);


CREATE TABLE sandbox.compliance_speaker_list_adhoc_2
(
    "Teva CMID" int,
    NPI int,
    LastName varchar(50),
    FirstName varchar(50),
    MiddleIntial varchar(50),
    Address varchar(52),
    City varchar(50),
    State varchar(50),
    Zip int,
    "Speaker Affiliation" varchar(50)
);


CREATE TABLE sandbox.ic_copay
(
    ic_data_month date,
    basket_name varchar(300),
    ims_id varchar(10),
    tvcmid int,
    fill_date date,
    txn_id varchar(20),
    rollup_month date,
    month_bucket int,
    days_supply int,
    quantity numeric(9,2),
    join_key varchar(10),
    row_source varchar(100),
    benefit_amount numeric(9,2)
);


CREATE TABLE sandbox.ftf_ims_monthly_market_obm
(
    "PLAN ID" varchar(4),
    "PLAN NAME" varchar(100),
    "PAYER ID" varchar(6),
    "PAYER NAME" varchar(100),
    "MARKET NAME" varchar(300),
    "PRODUCT NAME" varchar(300),
    zip varchar(5),
    DATE varchar(110),
    TRX numeric(36,21),
    NRX numeric(36,21)
);


CREATE TABLE sandbox.QVAR_NPP_08302018
(
    ims_id int,
    ims_id1 int,
    tvcmid int,
    npi int,
    last_name varchar(50),
    first_name varchar(50),
    middle_name varchar(50),
    medical_suffix varchar(50),
    primary_specialty varchar(50),
    address_line1 varchar(66),
    address_line2 varchar(50),
    city varchar(50),
    state_code varchar(50),
    zip int,
    business_email varchar(50),
    np_pa_flag varchar(50),
    tvcmid1 int,
    sln varchar(50),
    sln_expiration_date timestamp,
    sln_state varchar(50),
    hce_status_desc varchar(50),
    "ICS TRx MARKET DECILE (6 Months)" int,
    ims_id_1 int,
    Specialty varchar(50),
    "QVAR TRx Oct 2015" int,
    Nov int,
    Dec int,
    "1/16/2017 12:00:00 AM" int,
    Feb int,
    Mar int,
    Apr int,
    May int,
    Jun int,
    Jul int,
    Aug int,
    Sep int,
    Oct int,
    Nov_1 int,
    Dec_1 int,
    "1/17/2017 12:00:00 AM" int,
    Feb_1 int,
    Mar_1 int,
    Apr_1 int,
    May_1 int,
    Jun_1 int,
    Jul_1 int,
    Aug_1 int,
    Sep_1 int,
    "Year 1" int,
    "Year 2" int,
    "Difference Yr2-Yr1" int,
    TREND varchar(50)
);


CREATE TABLE sandbox."QNASL_MRKT IMSID_ALL"
(
    ims_id int
);


CREATE TABLE sandbox.tjr_ftf_iqvia_plan_xref
(
    health_plan_id varchar(6),
    health_plan_name varchar(100),
    ajovy_restrictions varchar(250),
    aimovig_restrictions varchar(250),
    emgality_restrictions varchar(250),
    provider_id varchar(6),
    provider_name varchar(250),
    parent_name varchar(250),
    payment_type varchar(250),
    health_plan_type varchar(250),
    masterbridge_key_payer varchar(250),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(100),
    iqvia_payer_name varchar(100),
    masterbridge_payer_name varchar(100),
    formulary_mgmt_pbm varchar(100),
    claims_processing_pbm varchar(100),
    pref_tier int
);


CREATE TABLE sandbox.tjr_model_mop_xref
(
    model varchar(100),
    model_name varchar(100),
    industry_mop varchar(250),
    iqvia_mop varchar(250),
    current_teva_mop varchar(250),
    proposed_teva_mop varchar(250)
);


CREATE TABLE sandbox.tables_to_keep
(
    table_name varchar(100)
);


CREATE TABLE sandbox."Returns_IQVIA "
(
    IMSID int,
    NPI int,
    tvcmid int
);


CREATE TABLE sandbox.QVAR_Address_Update_
(
    IMSID int,
    NPI int,
    tvcmid int
);


CREATE TABLE sandbox.test_con_diff
(
    cust_id float,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.mb_ic_rx_tp
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox."TN Mising HCPS for TN IC"
(
    "IMS ID" varchar(50),
    "NS Territory ID" varchar(50)
);


CREATE TABLE sandbox.test_concur_prev_kg
(
    cust_id float,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.test_concur_diff_kg
(
    cust_id float,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox."MA Missing STATE"
(
    Zip int,
    State varchar(20),
    Territory_1_ID varchar(50),
    Territory_Name varchar(63),
    Area_Name varchar(50),
    Region_Name varchar(20),
    Mirror_Flag varchar(20),
    Territory_2_ID varchar(20)
);


CREATE TEMPORARY TABLE sandbox.tmp_call_hist_c
(
    id varchar(18),
    isdeleted varchar(5),
    parentid varchar(18),
    createdbyid varchar(18),
    createddate timestamptz,
    field varchar(255),
    oldvalue varchar(255),
    newvalue varchar(255),
    file_id int,
    record_id int,
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.sfa_all_call
(
    sales_force_id varchar(8),
    call_id varchar(18),
    veeva_account_id varchar(18),
    ims_id varchar(10),
    ims_outlet_id varchar(100),
    tvcmid int,
    customer_type varchar(80),
    first_name varchar(40),
    last_name varchar(80),
    call_type varchar(255),
    legacy_call_type varchar(255),
    ceph_id varchar(1),
    dea_num varchar(9),
    rep_id varchar(20),
    rep_first_name varchar(40),
    rep_last_name varchar(80),
    territory_number varchar(8),
    zip_on_call varchar(20),
    call_date timestamp,
    submit_date timestamp,
    attendees float,
    attendee_type varchar(255),
    call_recordtype varchar(80),
    call_duration_tva__c numeric(3,0),
    call_datetime timestamp,
    call_timezone varchar(120),
    how_executed varchar(40),
    call_status varchar(255),
    remote_meeting_vod__c varchar(100)
);


CREATE TEMPORARY TABLE sandbox.tmp_sfa_call
(
    sales_force_id varchar(8),
    call_id varchar(18),
    veeva_account_id varchar(18),
    ims_id varchar(10),
    ims_outlet_id varchar(100),
    tvcmid int,
    customer_type varchar(80),
    first_name varchar(40),
    last_name varchar(80),
    call_type varchar(255),
    legacy_call_type varchar(255),
    ceph_id varchar(1),
    dea_num varchar(9),
    rep_id varchar(20),
    rep_first_name varchar(40),
    rep_last_name varchar(80),
    territory_number varchar(8),
    region_number varchar(8),
    area_number varchar(8),
    zip_on_call varchar(20),
    call_date timestamp,
    submit_date timestamp,
    attendees float,
    attendee_type varchar(255),
    call_recordtype varchar(80),
    call_duration_tva__c numeric(3,0),
    call_datetime timestamp,
    call_timezone varchar(120),
    how_executed varchar(40),
    call_status varchar(255),
    remote_meeting_vod__c varchar(100)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_region_area_c
(
    territory_number varchar(8),
    area_number varchar(8),
    region_number varchar(8)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_call_detail_cd
(
    sales_force_id varchar(8),
    id varchar(18),
    call2_vod__c varchar(18),
    detail_priority_vod__c varchar(64),
    product_vod__c varchar(18),
    bendeka_indication_tva__c varchar(5000),
    austedo_indication_tva__c varchar(5000),
    row_num int
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TEMPORARY TABLE sandbox.tmp_sfa_call_detail
(
    sales_force_id varchar(8),
    call_id varchar(18),
    product varchar(80),
    basket_id int,
    basket_name varchar(300),
    detail_position float,
    indication varchar(5000)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.sent_email_template_id
(
    Sent_Email_vod__c varchar(36),
    Approved_Email_Template_vod__c varchar(36)
);


CREATE TABLE sandbox.veeva_sent_email_07102020
(
    Id varchar(36),
    CreatedDate timestamptz,
    CreatedById varchar(36),
    LastModifiedDate timestamptz,
    LastModifiedById varchar(36),
    OwnerId varchar(36),
    RecordTypeId varchar(36),
    IsDeleted varchar(5),
    SystemModstamp timestamptz,
    Name varchar(160),
    Account_vod__c varchar(36),
    Activity_Tracking_Mode_vod__c varchar(510),
    EM_Attendee_vod__c varchar(36),
    Bcc_vod__c varchar(510),
    Call2_vod__c varchar(36),
    Capture_Datetime_vod__c timestamptz,
    Clicked_vod__c float,
    Content_Type_vod__c varchar(36),
    Detail_Group_vod__c varchar(36),
    Approved_Document_Views_vod__c float,
    Entity_Reference_Id_vod__c varchar(200),
    Event_vod__c varchar(36),
    Event_Attendee_vod__c varchar(36),
    Event_Attendee_Mobile_Id_vod__c varchar(200),
    Event_Mobile_Id_vod__c varchar(200),
    Events_Management_Subtype_vod__c varchar(2600),
    EM_Event_Speaker_vod__c varchar(36),
    EM_Event_Team_Member_vod__c varchar(36),
    Sender_Email_vod__c varchar(160),
    Key_Message_vod__c varchar(36),
    Last_Click_Date_vod__c timestamptz,
    Last_Device_vod__c varchar(510),
    Last_Activity_Date_vod__c timestamptz,
    Last_Open_Date_vod__c timestamptz,
    MC_Capture_Datetime_vod__c timestamptz,
    Medical_Event_vod__c varchar(36),
    Medical_Inquiry_vod__c varchar(36),
    Mobile_ID_vod__c varchar(200),
    Opened_vod__c float,
    Parent_Email_vod__c varchar(36),
    Product_vod__c varchar(36),
    Product_Display_vod__c varchar(2600),
    Receipt_Entity_Type_vod__c varchar(510),
    Receipt_Record_Id_vod__c varchar(200),
    Related_Transaction_ID_vod__c varchar(510),
    Scheduled_Send_Datetime_vod__c timestamptz,
    Email_Sent_Date_vod__c timestamptz,
    Status_vod__c varchar(510),
    Failure_Msg_vod__c varchar(510),
    Suggestion_vod__c varchar(36),
    Territory_vod__c varchar(200),
    Account_Email_vod__c varchar(160),
    Click_Count_vod__c float,
    Open_Count_vod__c float,
    User_vod__c varchar(36),
    Valid_Consent_Exists_vod__c varchar(5),
    VExternal_Id_vod__c varchar(100),
    record_id int,
    file_id int,
    Approved_Email_Template_vod__c varchar(36)
);


CREATE TABLE sandbox.concur_hcp_delta_07212020
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.Optum_calendar_conversion
(
    "RELIANCE Data" timestamp,
    Month_RollUP timestamp
);


CREATE TABLE sandbox.rs_wkly_geo_summ
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int
);


CREATE TABLE sandbox."SYNEOS MISSING IMSIDs"
(
    "Digihaler_rx_20210215 (JAN)" int
);


CREATE TABLE sandbox.tmp_teva_transform_lock
(
    transform_lock_id int,
    transform_name varchar(255),
    transform_lock_time timestamp
);


CREATE TABLE sandbox.datamart_activity_hub
(
    activity_id varchar(64),
    federation_id varchar(200),
    contact varchar(200),
    source_name varchar(100),
    "datetime" timestamp,
    trackback_id varchar(200),
    previous_activity varchar(64),
    level_name varchar(64),
    activity_role_name varchar(100),
    type_name varchar(100),
    native_type varchar(200),
    details varchar(200),
    line_item_id varchar(64),
    brand_name varchar(200),
    activity varchar(200),
    line_item_datetime timestamp,
    line_item_previous_line_item varchar(200),
    line_item_trackback_id varchar(200),
    line_item_details varchar(200),
    line_item_type_name varchar(100),
    line_item_native_type varchar(200),
    basket_id varchar(64),
    web_url varchar(5000)
);


CREATE TABLE sandbox.ajovy_cust_level_flags
(
    tvcmid int,
    basket_name varchar(300),
    sales_force_id varchar(2),
    territory_number varchar(8),
    flag_type varchar(50),
    flag_value varchar(50),
    flag_effective_start_date timestamp,
    flag_effective_end_date timestamp
);


CREATE TABLE sandbox.ps_payer_plan_table_01
(
    IQVIA_Payer_Name varchar(100),
    IQVIA_Plan_Code varchar(10),
    IQVIA_Plan_Name varchar(100),
    Model varchar(10),
    PayTypeIndex int,
    PayType varchar(50),
    IQVIA_PBM varchar(100)
);


CREATE TABLE sandbox.hdsa_coe_affiliations_0420
(
    hdsa_coe_id int,
    hdsa_coe_name varchar(85),
    ims_id int,
    tvcmid int,
    npi int,
    last_name varchar(50),
    first_name varchar(50),
    middle_name varchar(50),
    primary_specialty varchar(50),
    address_line1 varchar(61),
    address_line2 varchar(50),
    city varchar(50),
    state_code varchar(50),
    zip int,
    specialty_group varchar(50)
);


CREATE TABLE sandbox.ausedto_0528
(
    ims_id varchar(10)
);


CREATE TABLE sandbox.austedo_0528
(
    ims_id varchar(10)
);


CREATE TABLE sandbox.iqvia_plan_preprocessed_v1
(
    iqvia_payer_id varchar(6),
    iqvia_payer_name varchar(100),
    iqvia_plan_id varchar(4),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(100),
    model varchar(10),
    iqvia_pbm varchar(100),
    paytype varchar(128),
    paytype_index varchar(64),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.iqvia_pbm_preprocessed_v1
(
    iqvia_plan_code varchar(10),
    iqvia_pbm varchar(100),
    xref_to varchar(10),
    iqvia_plan_name varchar(100),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_health_plans_preprocessed_v1
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(100),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(250),
    parent_id varchar(6),
    ftf_parent_name varchar(250),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    plan_lives int,
    paytype varchar(64),
    paytype_index varchar(64),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_formularies_preprocessed_v1
(
    drug_seq int,
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    pharmacy_status varchar(20),
    plan_lives int,
    check_blank_pharmstat varchar(20),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_pbms_preprocessed_v1
(
    ftf_health_plan_fid varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_v01
(
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(500),
    grouped_restriction_level varchar(255),
    drug_seq int,
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_v02
(
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    drug_seq int,
    restriction_detail_id varchar(6),
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_iqvia_bridge_preprocessed_v11
(
    iqvia_payer_name varchar(50),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(50),
    comments varchar(50),
    ftf_health_plan_fid varchar(10),
    ftf_health_plan_name varchar(100),
    ftf_provider_name varchar(100),
    ftf_health_plan_type varchar(100),
    hp_type varchar(250),
    overriden_ftf_plan_type int,
    model varchar(10),
    iqvia_pbm varchar(100),
    iqvia_paytype varchar(128),
    check_delete varchar(100),
    paytype_index int,
    paytype varchar(64),
    check_pay_types int,
    check_hp_types int,
    old_ftf_health_plan_type varchar(20),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.process_info
(
    sub_process_id int,
    sub_process_name varchar(50),
    parent_process_id int,
    parent_process_name varchar(50),
    insert_time timestamp DEFAULT (now())::timestamptz(6),
    inserted_by varchar(20)
);


CREATE TABLE sandbox.tbl_lvl_audit
(
    process_id int,
    tbl_id varchar(20),
    cycle_id int,
    date_run date,
    inserted_time timestamp DEFAULT (now())::timestamptz(6),
    inserted_by varchar(50)
);


CREATE TABLE sandbox.process_audit_tbl
(
    process_id int,
    cycle_id int,
    date_run date,
    status varchar(30),
    insert_time timestamp DEFAULT (now())::timestamptz(6),
    inserted_by varchar(50),
    modified_time varchar(50),
    modified_by varchar(100)
);


CREATE TABLE sandbox.process_dependency_master
(
    process_id int,
    process_name varchar(50),
    tbl_id int,
    table_name varchar(100),
    table_type varchar(30),
    insert_time timestamp DEFAULT (now())::timestamptz(6),
    inserted_by varchar(20)
);


CREATE TABLE sandbox.tbl_info
(
    tbl_id int,
    tbl_name varchar(100),
    insert_time timestamp DEFAULT (now())::timestamptz(6),
    inserted_by varchar(20)
);


CREATE TABLE sandbox.mb_may
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(100),
    coverage_category_ajovy varchar(100),
    coverage_category_aimovig varchar(100),
    coverage_category_emgality varchar(100),
    ftf_provider_fid int,
    ftf_provider_name varchar(100),
    ftf_parent_name varchar(100),
    paytype_index int,
    paytype varchar(50),
    ftf_health_plan_type varchar(50),
    pref_brand_tier int,
    key_controlling_plan_formulary varchar(100),
    key_controlling_account varchar(100),
    key_pbm varchar(50),
    payer_pbm varchar(50),
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(50),
    ftf_formulary_management_pbm varchar(100),
    ftf_formulary_influencer_pbm varchar(100),
    ftf_claims_processing_pbm varchar(100),
    key_controlling_parent varchar(50),
    prev_month_lives_mx int,
    lives_mx int,
    cycle_id int
)
PARTITION BY (mb_may.cycle_id);


CREATE TABLE sandbox.iqvia_payer_paytype_override_v2
(
    iqvia_payer_name varchar(200),
    iqvia_plan_name_regex varchar(200),
    paytype varchar(128),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_payer_paytype_override_v2.file_id);


CREATE TABLE sandbox.mb_may_v2
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    coverage_category_ajovy varchar(100),
    coverage_category_aimovig varchar(100),
    coverage_category_emgality varchar(100),
    ftf_provider_fid int,
    ftf_provider_name varchar(100),
    ftf_parent_name varchar(100),
    paytype_index int,
    paytype varchar(100),
    ftf_health_plan_type varchar(100),
    pref_brand_tier int,
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_pbm varchar(200),
    payer_pbm varchar(50),
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(50),
    ftf_formulary_management_pbm varchar(200),
    ftf_formulary_influencer_pbm varchar(200),
    ftf_claims_processing_pbm varchar(200),
    key_controlling_parent varchar(200),
    prev_month_lives_mx int,
    lives_mx int,
    cycle_id int
)
PARTITION BY (mb_may_v2.cycle_id);


CREATE TABLE sandbox.copay_tier_derivation_config_v1
(
    pharmacy_status_regex varchar(100),
    tier_cat varchar(100),
    tier_regex varchar(100),
    pref_brand_tier_regex varchar(100),
    ftf_health_plan_type_regex varchar(100),
    copay_tier varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (copay_tier_derivation_config_v1.file_id);


CREATE TABLE sandbox.tier_cat_description_mapping_v1
(
    tier_cat varchar(100),
    description varchar(100),
    notes varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (tier_cat_description_mapping_v1.file_id);


CREATE TABLE sandbox.restriction_category_derivation_config_v1
(
    tier_regex varchar(100),
    has_pa_has_st_regex varchar(100),
    unspec_regex varchar(100),
    step_regex varchar(100),
    botox_regex varchar(100),
    prespa_regex varchar(100),
    tier_cat_regex varchar(100),
    medrecs_regex varchar(100),
    restcat int,
    restriction_category varchar(100),
    meaning varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (restriction_category_derivation_config_v1.file_id);


CREATE TABLE sandbox.ftf_iqvia_bridge_preprocessed_v1
(
    iqvia_payer_name varchar(50),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(50),
    comments varchar(50),
    ftf_health_plan_fid varchar(10),
    ftf_health_plan_name varchar(100),
    ftf_provider_name varchar(100),
    ftf_health_plan_type varchar(100),
    hp_type varchar(250),
    overriden_ftf_plan_type int,
    model varchar(10),
    iqvia_pbm varchar(100),
    iqvia_paytype varchar(128),
    check_delete varchar(100),
    paytype_index int,
    paytype varchar(64),
    check_pay_types int,
    check_hp_types int,
    old_ftf_health_plan_type varchar(20),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.restriction_cat_description_mapping_v1
(
    rest_cat varchar(100),
    description varchar(100),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (restriction_cat_description_mapping_v1.file_id);


CREATE TABLE sandbox.coverage_category_derivation_config_v1
(
    paytype_regex varchar(100),
    pharmacy_status_regex varchar(100),
    coverage_cat_code varchar(100),
    coverage_category varchar(100),
    restriction_cat_code_regex varchar(100),
    meaning varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (coverage_category_derivation_config_v1.file_id);


CREATE TABLE sandbox.coverage_cat_description_mapping_v1
(
    coverage_cat varchar(100),
    description varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (coverage_cat_description_mapping_v1.file_id);


CREATE TABLE sandbox.iqvia_plancode_fid_xref
(
    iqvia_payer_name varchar(50),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(50),
    comments varchar(50),
    ftf_health_plan_fid varchar(10),
    ftf_health_plan_name varchar(100),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(100),
    ftf_parent_name varchar(250),
    ftf_health_plan_type varchar(100),
    paytype_index int,
    paytype varchar(64),
    iqvia_pbm varchar(100),
    hp_type varchar(250),
    iqvia_paytype varchar(128),
    pref_brand_tier varchar(64),
    lives int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.fid_best_iqviapayer
(
    ftf_health_plan_fid varchar(10),
    ftf_health_plan_name varchar(100),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(100),
    iqvia_payer_name varchar(50),
    frequency int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.fid_best_iqviapbm
(
    ftf_health_plan_fid varchar(10),
    ftf_health_plan_name varchar(100),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(100),
    iqvia_pbm varchar(100),
    frequency int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.amb4_iqvia_payer
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.amb4_iqvia_pbm
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.amb7
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    calculated_pbm_value varchar(250),
    key_pbm varchar(254),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_hpid_keypbm
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(250),
    paytype varchar(100),
    iqvia_pbm varchar(100),
    key_pbm varchar(254),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.formulary_derivation_config_v1
(
    pharmacy_status_regex varchar(100),
    has_pa_regex varchar(100),
    has_st_regex varchar(100),
    formulary varchar(100),
    tier_regex varchar(100),
    pref_brand_tier_regex varchar(100),
    ftf_health_plan_type_regex varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (formulary_derivation_config_v1.file_id);


CREATE TABLE sandbox.mb_may_v3
(
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    coverage_category_for_ajovy varchar(200),
    coverage_category_for_aimovig varchar(200),
    coverage_category_for_emgality varchar(200),
    ftfproviderfid varchar(200),
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytypeindex varchar(200),
    pay_type varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    key_pbm varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(200),
    ftf_formulary_influencer_pbm varchar(200),
    ftf_claims_processing_pbm varchar(200),
    pref_brand_tier int,
    ftf_match_iqvia int,
    lives_mx int,
    cycle_id int
);


CREATE TABLE sandbox.mb_may_v4
(
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    coverage_category_for_ajovy varchar(200),
    coverage_category_for_aimovig varchar(200),
    coverage_category_for_emgality varchar(200),
    ftfproviderfid varchar(200),
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytypeindex varchar(200),
    pay_type varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    key_pbm varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(200),
    ftf_formulary_influencer_pbm varchar(200),
    ftf_claims_processing_pbm varchar(200),
    pref_brand_tier int,
    ftf_match_iqvia int,
    lives_mx int,
    cycle_id int
);


CREATE TABLE sandbox.amb4
(
    ftf_health_plan_fid varchar(20),
    ftf_health_plan_name varchar(200),
    old_coverage_category_ajovy varchar(100),
    old_coverage_category_aimovig varchar(100),
    old_coverage_category_emgality varchar(100),
    old_ftf_provider_fid int,
    old_ftf_provider_name varchar(100),
    old_ftf_parent_name varchar(100),
    old_paytype_index int,
    old_paytype varchar(100),
    old_ftf_health_plan_type varchar(100),
    old_pref_brand_tier int,
    old_key_controlling_plan_formulary varchar(200),
    old_key_controlling_account varchar(200),
    old_key_pbm varchar(200),
    old_payer_pbm varchar(50),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    old_iqvia_payer_name varchar(100),
    old_iqvia_pbm varchar(50),
    old_ftf_formulary_management_pbm varchar(200),
    old_ftf_formulary_influencer_pbm varchar(200),
    old_ftf_claims_processing_pbm varchar(200),
    lives_mx int,
    new_ftf_health_plan_fid varchar(6),
    old_ftf_health_plan_fid varchar(20),
    new_ftf_health_plan_name varchar(100),
    old_ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(64),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    lives_mn int,
    iqvia_payer_name varchar(50),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250)
);


CREATE TABLE sandbox.step_restriction_description_v1
(
    step int,
    description varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (step_restriction_description_v1.file_id);


CREATE TABLE sandbox.pres_pa_restriction_description_v1
(
    prespa int,
    description varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (pres_pa_restriction_description_v1.file_id);


CREATE TABLE sandbox.pat_pa_restriction_description_v1
(
    patpa int,
    description varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (pat_pa_restriction_description_v1.file_id);


CREATE TABLE sandbox.plan_prod_master_v1
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    calculated_pbm_value varchar(250),
    key_pbm varchar(254),
    drug_id int,
    drug_seq int,
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    pharmacy_status varchar(20),
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    tier varchar(2),
    has_pa int,
    has_st int,
    formulary varchar(100),
    copay_tier varchar(100),
    tier_cat varchar(100),
    restcat int,
    restriction_category varchar(100),
    coverage_cat_code varchar(100),
    coverage_category varchar(100),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_plan_master_file
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    calculated_pbm_value varchar(250),
    key_pbm varchar(254),
    drug_id int,
    drug_seq int,
    product varchar(64),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    pharmacy_status varchar(20),
    botox int,
    botox_step_flag varchar(100),
    step int,
    step_category varchar(200),
    pres_pa int,
    prescriber_prior_authorization_category varchar(200),
    pat_pa int,
    med_rec int,
    unspec int,
    patient_prior_authorization_category varchar(200),
    medical_records_submission_required_flag varchar(100),
    unspecified_restriction_flag varchar(100),
    FTF_Tier varchar(2),
    has_pa int,
    has_st int,
    formulary varchar(100),
    Copay_Tier varchar(100),
    tier_cat varchar(100),
    restcat int,
    Restriction_Category varchar(100),
    coverage_cat_code varchar(100),
    Coverage_Category varchar(100),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_override_plan_v1
(
    ftf_health_plan_fid int,
    paytype_index int,
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_override_plan_v1.file_id);


CREATE TABLE sandbox.ftf_override_provider_v1
(
    ftf_provider_fid int,
    paytype_index int,
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_override_provider_v1.file_id);


CREATE TABLE sandbox.ftf_paytype_paytypeindex_v1
(
    paytype_index int,
    paytype varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_paytype_paytypeindex_v1.file_id);


CREATE TABLE sandbox.ftf_iqvia_xref
(
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(50),
    xref_iqvia_payer_name varchar(50),
    best_matched_iqvia_payer_name varchar(100),
    xref_iqvia_pbm varchar(100),
    best_matched_iqvia_pbm varchar(100),
    paytype varchar(100),
    model varchar(10),
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_health_plan_type varchar(250),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(100),
    aimovig_access_for_ftf_plan varchar(100),
    emgality_access_for_ftf_plan varchar(100),
    ftf_pref_brand_tier varchar(64),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    check_iq_payer int,
    check_iq_pbm int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_iqvia_xref_v2
(
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(50),
    iqvia_payer_name varchar(50),
    iqvia_pbm varchar(100),
    payment_type varchar(100),
    iqvia_model varchar(10),
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_health_plan_type varchar(250),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(100),
    aimovig_access_for_ftf_plan varchar(100),
    emgality_access_for_ftf_plan varchar(100),
    ftf_pref_brand_tier varchar(64),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    check_iq_payer int,
    check_iq_pbm int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.tt1
(
    iqvia_plan_code varchar(200),
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    iqvia_payer_name varchar(50),
    iqvia_pbm varchar(100),
    payment_type varchar(100),
    iqvia_model varchar(10),
    ftf_health_plan_type varchar(250),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(100),
    aimovig_access_for_ftf_plan varchar(100),
    emgality_access_for_ftf_plan varchar(100),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_payment_type int,
    change_iqvia_model int,
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_health_plan_type int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_total_lives_for_ftf_plan int,
    change_key_pbm int,
    change int,
    check_iq_payer int,
    check_iq_pbm int,
    month_flag varchar(13),
    status varchar(9)
);


CREATE TABLE sandbox.tt2
(
    iqvia_plan_code varchar(200),
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(200),
    aimovig_access_for_ftf_plan varchar(200),
    emgality_access_for_ftf_plan varchar(200),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_payment_type int,
    change_iqvia_model int,
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_health_plan_type int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_total_lives_for_ftf_plan int,
    change_key_pbm int,
    change int,
    check_iq_payer varchar(1),
    check_iq_pbm varchar(1),
    month_flag varchar(14),
    status varchar(11)
);


CREATE TABLE sandbox.tt3
(
    iqvia_plan_code varchar(200),
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(200),
    aimovig_access_for_ftf_plan varchar(200),
    emgality_access_for_ftf_plan varchar(200),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_payment_type int,
    change_iqvia_model int,
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_health_plan_type int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_total_lives_for_ftf_plan int,
    change_key_pbm int,
    change int,
    check_iq_payer int,
    check_iq_pbm int,
    month_flag varchar(14),
    status varchar(11),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.comparison_ftf_health_plan_fid
(
    ftf_health_plan_fid varchar(20),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_controlling_account varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    pref_brand_tier varchar(64),
    Coverage_Category_Ajovy varchar(100),
    Coverage_Category_Aimovig varchar(100),
    Coverage_Category_Emgality varchar(100),
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_provider_fid int,
    change_ftf_provider_name int,
    change_ftf_parent_name int,
    change_paytype int,
    change_ftf_health_plan_type int,
    change_key_controlling_account int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_key_pbm int,
    change_ftf_formulary_management_pbm int,
    change_ftf_formulary_influencer_pbm int,
    change_ftf_claims_processing_pbm int,
    change_lives_mn int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_pref_brand_tier int,
    change_Coverage_Category_Ajovy int,
    change_Coverage_Category_Aimovig int,
    change_Coverage_Category_Emgality int,
    change int,
    month_flag varchar(14),
    status varchar(12),
    change_in_lives numeric(54,18),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.override_fid_iqvia_key_controller_list
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (override_fid_iqvia_key_controller_list.file_id);


CREATE TABLE sandbox.pivot_plan_prod_master_v1_temp
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    pref_brand_tier varchar(64),
    Coverage_Category_Ajovy varchar(100),
    Coverage_Category_Aimovig varchar(100),
    Coverage_Category_Emgality varchar(100),
    prev_lives int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.pivot_plan_prod_master_v1
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype varchar(100),
    paytype_index varchar(64),
    ftf_health_plan_type varchar(250),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    lives_mn int,
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    pref_brand_tier varchar(64),
    Coverage_Category_Ajovy varchar(100),
    Coverage_Category_Aimovig varchar(100),
    Coverage_Category_Emgality varchar(100),
    prev_lives int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.override_fid_iqvia_key_controller_list_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.iqvia_plans_discard_v01
(
    payer_id int,
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (iqvia_plans_discard_v01.file_id);


CREATE TABLE sandbox.model_paytype_map_v01
(
    model varchar(100),
    paytype varchar(100),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (model_paytype_map_v01.file_id);


CREATE TABLE sandbox.iqvia_paytypeindex_v01
(
    paytype_index int,
    paytype varchar(100),
    file_id int,
    record_id int
)
PARTITION BY (iqvia_paytypeindex_v01.file_id);


CREATE TABLE sandbox.iqvia_payer_paytype_override_v01
(
    iqvia_payer_name varchar(200),
    iqvia_plan_name_regex varchar(200),
    paytype varchar(120),
    file_id int,
    record_id int
)
PARTITION BY (iqvia_payer_paytype_override_v01.file_id);


CREATE TABLE sandbox.ftf_plans_paytypeindex_v01
(
    ftf_health_plan_type varchar(100),
    paytype_index int,
    file_id int,
    record_id int
)
PARTITION BY (ftf_plans_paytypeindex_v01.file_id);


CREATE TABLE sandbox.ftf_paytype_paytypeindex_v01
(
    paytype_index int,
    paytype varchar(100),
    file_id int,
    record_id int
)
PARTITION BY (ftf_paytype_paytypeindex_v01.file_id);


CREATE TABLE sandbox.ftf_override_provider_v01
(
    provider_fid int,
    paytype_index int,
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (ftf_override_provider_v01.file_id);


CREATE TABLE sandbox.ftf_override_plan_v01
(
    ftf_health_plan_fid int,
    paytype_index int,
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (ftf_override_plan_v01.file_id);


CREATE TABLE sandbox.drug_assignments_v01
(
    drug_id int,
    drug_seq int,
    product varchar(100),
    file_id int,
    record_id int
)
PARTITION BY (drug_assignments_v01.file_id);


CREATE TABLE sandbox.ftf_pbm_functions_v01
(
    pbm_function_id int,
    pbm_function varchar(100),
    notes varchar(200),
    used int,
    file_id int,
    record_id int
)
PARTITION BY (ftf_pbm_functions_v01.file_id);


CREATE TABLE sandbox.botox_step_restriction_v01
(
    code int,
    botox_step_flag varchar(100),
    restriction_group varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (botox_step_restriction_v01.file_id);


CREATE TABLE sandbox.step_restrictio0n
(
    code int,
    step_category varchar(100),
    restriction_group varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (step_restrictio0n.file_id);


CREATE TABLE sandbox.pa_restriction_v01
(
    code int,
    prescriber_prior_authorization_category varchar(200),
    restriction_detail_id varchar(100),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (pa_restriction_v01.file_id);


CREATE TABLE sandbox.patient_pa_restriction_v01
(
    code int,
    patient_prior_authorization_category varchar(200),
    restriction_detail_id varchar(100),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (patient_pa_restriction_v01.file_id);


CREATE TABLE sandbox.medical_rec_restriction_v01
(
    code int,
    medical_records_submission_required_flag varchar(100),
    restriction_detail_id varchar(100),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (medical_rec_restriction_v01.file_id);


CREATE TABLE sandbox.unspecified_rec_restriction_v01
(
    code int,
    unspecified_restriction_flag varchar(100),
    restriction_detail_id varchar(100),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (unspecified_rec_restriction_v01.file_id);


CREATE TABLE sandbox.override_bridge_ftf_plan_types_v01
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(200),
    iqvia_plan_name_regex varchar(200),
    override_ftf_health_plan_type varchar(200),
    override_precedence int,
    file_id int,
    record_id int
)
PARTITION BY (override_bridge_ftf_plan_types_v01.file_id);


CREATE TABLE sandbox.delete_bridge_ftf_plan_types_v01
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(200),
    iqvia_plan_name_regex varchar(200),
    delete_flag varchar(100),
    file_id int,
    record_id int
)
PARTITION BY (delete_bridge_ftf_plan_types_v01.file_id);


CREATE TABLE sandbox.provider_override_default_v01
(
    provider_id int,
    paytype_regex varchar(200),
    provider_name varchar(200),
    fill_in_iqvia_payer_name_if_no_bridge varchar(200),
    override_best_iqvia_payer varchar(200),
    fill_in_iqvia_pbm_if_no_bridge varchar(200),
    override_best_iqvia_pbm varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (provider_override_default_v01.file_id);


CREATE TABLE sandbox.key_controller_list_v01
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_account varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(100),
    file_id int,
    record_id int
)
PARTITION BY (key_controller_list_v01.file_id);


CREATE TABLE sandbox.calculated_pbm_config_v01
(
    ftf_formulary_management_pbm_regex varchar(200),
    ftf_formulary_influencer_pbm_regex varchar(200),
    ftf_claims_processing_pbm_regex varchar(200),
    calculated_pbm_column varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (calculated_pbm_config_v01.file_id);


CREATE TABLE sandbox.calc_pbm_key_pbm_mapping_v01
(
    calculated_pbm varchar(200),
    key_pbm varchar(200),
    added_by varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (calc_pbm_key_pbm_mapping_v01.file_id);


CREATE TABLE sandbox.has_pa_mapping_v01
(
    has_pa int,
    pa_regex varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (has_pa_mapping_v01.file_id);


CREATE TABLE sandbox.has_st_mapping_v01
(
    has_st int,
    st_regex varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (has_st_mapping_v01.file_id);


CREATE TABLE sandbox.formulary_derivation_config_v01
(
    pharmacy_status_regex varchar(200),
    has_pa_regex varchar(200),
    has_st_regex varchar(200),
    formulary varchar(200),
    tier_regex varchar(200),
    pref_brand_tier_regex varchar(200),
    ftf_health_plan_type_regex varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (formulary_derivation_config_v01.file_id);


CREATE TABLE sandbox.restriction_category_derivation_config_v01
(
    tier_regex varchar(200),
    has_pa_has_st_regex varchar(200),
    unspec_regex varchar(200),
    step_regex varchar(200),
    botox_regex varchar(200),
    prespa_regex varchar(200),
    tier_cat_regex varchar(200),
    medrecs_regex varchar(200),
    restcat int,
    restriction_category varchar(200),
    meaning varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (restriction_category_derivation_config_v01.file_id);


CREATE TABLE sandbox.restriction_cat_description_mapping_v01
(
    rest_cat varchar(200),
    description varchar(500),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (restriction_cat_description_mapping_v01.file_id);


CREATE TABLE sandbox.coverage_cat_description_mapping_v01
(
    coverage_cat varchar(200),
    description varchar(500),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (coverage_cat_description_mapping_v01.file_id);


CREATE TABLE sandbox.step_restriction_description_v01
(
    step int,
    description varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (step_restriction_description_v01.file_id);


CREATE TABLE sandbox.pres_pa_restriction_description_v01
(
    prespa int,
    description varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (pres_pa_restriction_description_v01.file_id);


CREATE TABLE sandbox.pat_pa_restriction_description_v01
(
    patpa int,
    description varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (pat_pa_restriction_description_v01.file_id);


CREATE TABLE sandbox.override_fid_iqvia_key_controller_list_v01
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (override_fid_iqvia_key_controller_list_v01.file_id);


CREATE TABLE sandbox.step_restriction_v01
(
    code int,
    step_category varchar(100),
    restriction_group varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (step_restriction_v01.file_id);


CREATE TABLE sandbox.raw_ftf_formularies_cdw
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    pharmacy_status varchar(20),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_ftf_health_plans_cdw
(
    formularyf_id varchar(6),
    provider_id varchar(6),
    provider varchar(250),
    health_plan_id varchar(6),
    health_plan varchar(100),
    parent_id varchar(6),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(64),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_ftf_health_plan_geography_cdw
(
    health_plan_id varchar(6),
    county_fips_id int,
    county_id int,
    county_name varchar(50),
    state_id int,
    state_name varchar(10),
    county_lives numeric(14,2),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_ftf_pbms_cdw
(
    health_plan_id varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_iqvia_plan_cdw
(
    payer_num varchar(6),
    payer_name varchar(100),
    plan_num varchar(4),
    payer_plan_num varchar(10),
    plan_name varchar(100),
    model varchar(10),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_iqvia_pbm_cdw
(
    pbm_name varchar(100),
    payer_plan_num varchar(10),
    xref_to_payer_plan_num varchar(10),
    ipd_id varchar(10),
    ipd_type varchar(10),
    plan_name varchar(100),
    pbm_num varchar(6),
    ims_processor_num varchar(10),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_teva_ims_bridge_cdw
(
    payer_name varchar(50),
    code varchar(10),
    name varchar(50),
    state varchar(5),
    comments varchar(50),
    plan_id varchar(10),
    plan_name varchar(100),
    provider_name varchar(100),
    plan_type_name varchar(20),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.has_st_mapping
(
    has_st int,
    st_regex varchar(100),
    notes varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (has_st_mapping.file_id);


CREATE TABLE sandbox.has_pa_mapping
(
    has_pa int,
    pa_regex varchar(100),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (has_pa_mapping.file_id);


CREATE TABLE sandbox.calc_pbm_key_pbm_mapping
(
    calculated_pbm varchar(100),
    key_pbm varchar(100),
    added_by varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (calc_pbm_key_pbm_mapping.file_id);


CREATE TABLE sandbox.calculated_pbm_config
(
    ftf_formulary_management_pbm_regex varchar(100),
    ftf_formulary_influencer_pbm_regex varchar(100),
    ftf_claims_processing_pbm_regex varchar(100),
    calculated_pbm_column varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (calculated_pbm_config.file_id);


CREATE TABLE sandbox.raw_ftf_restrictions_cdw
(
    health_plan_id varchar(100),
    drug_id varchar(100),
    restriction_code varchar(200),
    restriction_detail_id varchar(200),
    restriction_detail_text varchar(5000),
    restriction_addtnl_information_1 varchar(10000),
    restriction_addtnl_information_2 varchar(10000),
    step_count varchar(200),
    pa_form varchar(500),
    indication varchar(500),
    grouped_restriction_level varchar(500),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.data_file_metadata_cdw
(
    processed_date timestamp,
    file_id int
);


CREATE TABLE sandbox.parent_process_execution
(
    parent_process_id int,
    parent_process_name varchar(200),
    date_run date,
    insert_time timestamp,
    inserted_by varchar(100)
);


CREATE TABLE sandbox.iqvia_plan_preprocessed_cdw_v1
(
    iqvia_payer_id int,
    iqvia_payer_name varchar(200),
    iqvia_plan_id int,
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    model varchar(100),
    iqvia_pbm varchar(200),
    paytype varchar(100),
    paytype_index int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (iqvia_plan_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.iqvia_pbm_preprocessed_cdw_v1
(
    iqvia_plan_code int,
    iqvia_pbm varchar(200),
    xref_to varchar(200),
    iqvia_plan_name varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (iqvia_pbm_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_formularies_preprocessed_cdw_v1
(
    drug_seq int,
    ftf_health_plan_fid int,
    drug_id int,
    tier_code varchar(200),
    restrictions varchar(1000),
    reason_code varchar(1000),
    reason_code_description varchar(1000),
    pharmacy_status varchar(500),
    plan_lives int,
    check_blank_pharmstat varchar(100),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_formularies_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_pbms_preprocessed_cdw_v1
(
    ftf_health_plan_fid int,
    pbm_id int,
    pbm varchar(500),
    pbm_function_id int,
    pbm_function varchar(500),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_pbms_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_cdw_v1
(
    ftf_health_plan_fid int,
    drug_id int,
    restriction_code varchar(1000),
    restriction_detail_id varchar(1000),
    restriction_detail_text varchar(1000),
    grouped_restriction_level varchar(1000),
    drug_seq int,
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_restrictions_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_cdw_v2
(
    ftf_health_plan_fid int,
    drug_id int,
    drug_seq int,
    restriction_detail_id varchar(1000),
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_restrictions_preprocessed_cdw_v2.cycle_id);


CREATE TABLE sandbox.ftf_iqvia_bridge_preprocessed_cdw_v1
(
    iqvia_payer_name varchar(200),
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    comments varchar(1000),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(200),
    ftf_health_plan_type varchar(200),
    hp_type varchar(200),
    overriden_ftf_plan_type int,
    model varchar(200),
    iqvia_pbm varchar(200),
    iqvia_paytype varchar(200),
    check_delete varchar(200),
    paytype_index int,
    paytype varchar(100),
    check_pay_types int,
    check_hp_types int,
    old_ftf_health_plan_type varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.comparison_iqvia_fid_plans
(
    iqvia_plan_code varchar(200),
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_type varchar(250),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(200),
    aimovig_access_for_ftf_plan varchar(200),
    emgality_access_for_ftf_plan varchar(200),
    total_lives_for_ftf_plan int,
    key_pbm varchar(254),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_payment_type int,
    change_iqvia_model int,
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_health_plan_type int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_total_lives_for_ftf_plan int,
    change_key_pbm int,
    change int,
    check_iq_payer int,
    check_iq_pbm int,
    change_in_lives numeric(54,18),
    month_flag varchar(14),
    status varchar(12),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.key_ctl_account_summary
(
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_controlling_account varchar(100),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.key_pbm_summary
(
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_pbm varchar(254),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.iqvia_payer_name_summary
(
    paytype varchar(100),
    iqvia_payer_name varchar(100),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.iqvia_pbm_summary
(
    paytype varchar(100),
    iqvia_pbm varchar(100),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.ftf_formulary_management_pbm_summary
(
    paytype varchar(100),
    ftf_formulary_management_pbm varchar(250),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.ftf_formulary_influencer_pbm_summary
(
    paytype varchar(100),
    ftf_formulary_influencer_pbm varchar(250),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.ftf_claims_processing_pbm_summary
(
    paytype varchar(100),
    ftf_claims_processing_pbm varchar(250),
    current_month_lives int,
    previous_month_lives int
);


CREATE TABLE sandbox.st_lives_summary
(
    ftf_health_plan_fid varchar(24),
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    state varchar(10),
    ftf_state_hp_lives numeric(14,2),
    pref_brand_tier varchar(64)
);


CREATE TABLE sandbox.access_master_bridge
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(200),
    Coverage_Category_Ajovy varchar(100),
    Coverage_Category_Aimovig varchar(100),
    Coverage_Category_Emgality varchar(100),
    ftf_provider_fid varchar(20),
    ftf_provider_name varchar(250),
    ftf_parent_name varchar(250),
    paytype_index varchar(64),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    key_controlling_plan_formulary varchar(100),
    key_controlling_account varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    pref_brand_tier varchar(64),
    ftf_match_iqvia int,
    previous_lives int,
    current_lives int
);


CREATE TABLE sandbox.iqvia_plan_code_ftf_hp_id
(
    iqvia_plan_code varchar(40),
    iqvia_plan_name varchar(50),
    iqvia_payer_name varchar(50),
    iqvia_pbm varchar(100),
    payment_type varchar(100),
    iqvia_model varchar(10),
    ftf_health_plan_fid varchar(24),
    ftf_health_plan_name varchar(200),
    ftf_health_plan_type varchar(250),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    Ajovy_access_for_ftf_plan varchar(100),
    Aimovig_access_for_ftf_plan varchar(100),
    Emgality_access_for_ftf_plan varchar(100),
    total_lives_for_ftf_plan varchar(20),
    key_pbm varchar(254),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_hp_id_key_controlling_account
(
    ftf_health_plan_fid varchar(24),
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(250),
    payment_type varchar(100),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_hp_id_key_pbm
(
    ftf_health_plan_fid varchar(24),
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(250),
    payment_type varchar(100),
    key_pbm varchar(254),
    assigned_iqvia_pbm varchar(100),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_plan_master_file_op
(
    ftf_health_plan_fid varchar(6),
    product varchar(64),
    ftf_health_plan_name varchar(200),
    coverage_category varchar(100),
    ftf_provider_name varchar(250),
    paytype varchar(100),
    ftf_health_plan_type varchar(250),
    plan_lives int,
    key_controlling_plan_formulary varchar(100),
    key_controlling_account varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    key_pbm varchar(254),
    iqvia_payer_name varchar(100),
    iqvia_pbm varchar(100),
    ftf_formulary_management_pbm varchar(250),
    ftf_formulary_influencer_pbm varchar(250),
    ftf_claims_processing_pbm varchar(250),
    pref_brand_tier varchar(64),
    pharmacy_status varchar(20),
    FTF_Tier varchar(2),
    restrictions varchar(20),
    Copay_Tier varchar(100),
    restriction_category varchar(100),
    step varchar(200),
    botox varchar(100),
    prescriber_pa varchar(200),
    patient_pa varchar(200),
    medical_records varchar(100),
    criteria_unspec varchar(100),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.paytype_product_coverage_category
(
    paytype varchar(100),
    product varchar(64),
    metric varchar(100),
    lives int
);


CREATE TABLE sandbox.paytype_product_copay_tier
(
    paytype varchar(100),
    product varchar(64),
    metric varchar(100),
    lives int
);


CREATE TABLE sandbox.paytype_product_step_category
(
    paytype varchar(100),
    product varchar(64),
    metric varchar(200),
    lives int
);


CREATE TABLE sandbox.paytype_product_patient_pa
(
    paytype varchar(100),
    product varchar(64),
    metric varchar(200),
    lives int
);


CREATE TABLE sandbox.key_controlling_account_product_cov_category_paytype
(
    key_controlling_account varchar(100),
    paytype varchar(100),
    product varchar(64),
    metric varchar(100),
    lives int
);


CREATE TABLE sandbox.key_pbm_product_cov_category_paytype
(
    key_pbm varchar(254),
    paytype varchar(100),
    product varchar(64),
    metric varchar(100),
    lives int
);


CREATE TABLE sandbox.fid_best_iqviapayer_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    iqvia_payer_name varchar(200),
    frequency int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (fid_best_iqviapayer_cdw_v1.cycle_id);


CREATE TABLE sandbox.fid_best_iqviapbm_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    iqvia_pbm varchar(200),
    frequency int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (fid_best_iqviapbm_cdw_v1.cycle_id);


CREATE TABLE sandbox.amb4_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    old_coverage_category_ajovy varchar(200),
    old_coverage_category_aimovig varchar(200),
    old_coverage_category_emgality varchar(200),
    old_ftf_provider_fid int,
    old_ftf_provider_name varchar(200),
    old_ftf_parent_name varchar(200),
    old_paytype_index int,
    old_paytype varchar(200),
    old_ftf_health_plan_type varchar(200),
    old_pref_brand_tier int,
    old_key_controlling_plan_formulary varchar(300),
    old_key_controlling_account varchar(300),
    old_key_pbm varchar(300),
    old_payer_pbm varchar(200),
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    old_iqvia_payer_name varchar(200),
    old_iqvia_pbm varchar(200),
    old_ftf_formulary_management_pbm varchar(300),
    old_ftf_formulary_influencer_pbm varchar(300),
    old_ftf_claims_processing_pbm varchar(300),
    lives_mx int,
    new_ftf_health_plan_fid int,
    old_ftf_health_plan_fid int,
    new_ftf_health_plan_name varchar(200),
    old_ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    lives_mn int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100),
    old_coverage_category_nurtec varchar(200),
    old_coverage_category_qulitpa varchar(200),
    old_coverage_category_austedo_hd varchar(200),
    old_coverage_category_austedo_td varchar(200),
    old_coverage_category_ingrezza_td varchar(200)
)
PARTITION BY (amb4_cdw_v1.cycle_id);


CREATE TABLE sandbox.amb4_iqvia_payer_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (amb4_iqvia_payer_cdw_v1.cycle_id);


CREATE TABLE sandbox.amb4_iqvia_pbm_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (amb4_iqvia_pbm_cdw_v1.cycle_id);


CREATE TABLE sandbox.amb7_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    calculated_pbm_value varchar(300),
    key_pbm varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (amb7_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_hpid_keypbm_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_name varchar(200),
    paytype varchar(200),
    iqvia_pbm varchar(200),
    key_pbm varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_hpid_keypbm_cdw_v1.cycle_id);


CREATE TABLE sandbox.plan_prod_master_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    calculated_pbm_value varchar(300),
    key_pbm varchar(300),
    drug_id int,
    drug_seq int,
    tier_code varchar(300),
    restrictions varchar(300),
    reason_code varchar(300),
    pharmacy_status varchar(300),
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    tier varchar(200),
    has_pa int,
    has_st int,
    formulary varchar(200),
    copay_tier varchar(200),
    tier_cat int,
    restcat int,
    restriction_category varchar(200),
    coverage_cat_code int,
    coverage_category varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (plan_prod_master_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_plan_master_file_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    calculated_pbm_value varchar(300),
    key_pbm varchar(300),
    drug_id int,
    drug_seq int,
    product varchar(200),
    tier_code varchar(200),
    restrictions varchar(200),
    reason_code varchar(200),
    pharmacy_status varchar(200),
    botox int,
    botox_step_flag varchar(200),
    step int,
    step_category varchar(200),
    pres_pa int,
    prescriber_prior_authorization_category varchar(200),
    pat_pa int,
    med_rec int,
    unspec int,
    patient_prior_authorization_category varchar(200),
    medical_records_submission_required_flag varchar(100),
    unspecified_restriction_flag varchar(100),
    ftf_tier varchar(100),
    has_pa int,
    has_st int,
    formulary varchar(200),
    copay_Tier varchar(200),
    tier_cat int,
    restcat int,
    restriction_category varchar(200),
    coverage_cat_code int,
    coverage_category varchar(200),
    key_controlling_account varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_plan_master_file_cdw_v1.cycle_id);


CREATE TABLE sandbox.pivot_plan_prod_master_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype varchar(200),
    paytype_index int,
    ftf_health_plan_type varchar(200),
    key_controlling_account varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(200),
    key_pbm varchar(300),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    pref_brand_tier int,
    Coverage_Category_Ajovy varchar(200),
    Coverage_Category_Aimovig varchar(200),
    Coverage_Category_Emgality varchar(200),
    prev_lives int,
    ftf_match_iqvia int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100),
    Coverage_Category_Nurtec varchar(200),
    Coverage_Category_Qulipta varchar(200),
    Coverage_Category_Austedo_HD varchar(200),
    Coverage_Category_Austedo_TD varchar(200),
    Coverage_Category_Ingrezza_TD varchar(200)
)
PARTITION BY (pivot_plan_prod_master_cdw_v1.cycle_id);


CREATE TABLE sandbox.comparison_ftf_health_plan_fid_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_account varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(200),
    key_pbm varchar(300),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    pref_brand_tier int,
    Coverage_Category_Ajovy varchar(200),
    Coverage_Category_Aimovig varchar(200),
    Coverage_Category_Emgality varchar(200),
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_provider_fid int,
    change_ftf_provider_name int,
    change_ftf_parent_name int,
    change_paytype int,
    change_ftf_health_plan_type int,
    change_key_controlling_account int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_key_pbm int,
    change_ftf_formulary_management_pbm int,
    change_ftf_formulary_influencer_pbm int,
    change_ftf_claims_processing_pbm int,
    change_lives_mn int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_pref_brand_tier int,
    change_Coverage_Category_Ajovy int,
    change_Coverage_Category_Aimovig int,
    change_Coverage_Category_Emgality int,
    change int,
    month_flag varchar(200),
    status varchar(200),
    change_in_lives numeric(37,15),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100),
    Coverage_Category_Nurtec varchar(200),
    Coverage_Category_Qulipta varchar(200),
    change_Coverage_Category_Nurtec int,
    change_Coverage_Category_Qulipta int
)
PARTITION BY (comparison_ftf_health_plan_fid_cdw_v1.cycle_id);


CREATE TABLE sandbox.access_master_bridge_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    coverage_category_ajovy varchar(200),
    coverage_category_aimovig varchar(200),
    coverage_category_emgality varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(200),
    key_pbm varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    pref_brand_tier int,
    ftf_match_iqvia int,
    previous_lives int,
    current_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200),
    coverage_category_nurtec varchar(200),
    coverage_category_qulitpa varchar(200),
    coverage_category_austedo_hd varchar(200),
    coverage_category_austedo_td varchar(200),
    coverage_category_ingrezza_td varchar(200)
)
PARTITION BY (access_master_bridge_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_health_plans_preprocessed_cdw_v1_temp
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    parent_id int,
    ftf_parent_name varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    plan_lives int,
    paytype varchar(100),
    paytype_index int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
);


CREATE TABLE sandbox.ftf_health_plans_preprocessed_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    parent_id int,
    ftf_parent_name varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    plan_lives int,
    paytype varchar(100),
    paytype_index int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_health_plans_preprocessed_cdw_v1.cycle_id);


CREATE TABLE sandbox.iqvia_plancode_fid_xref_cdw_v1
(
    iqvia_payer_name varchar(200),
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    comments varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    ftf_health_plan_type varchar(200),
    paytype_index int,
    paytype varchar(200),
    iqvia_pbm varchar(200),
    hp_type varchar(200),
    iqvia_paytype varchar(200),
    pref_brand_tier int,
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (iqvia_plancode_fid_xref_cdw_v1.cycle_id);


CREATE TABLE sandbox.copay_tier_derivation_config_v01_tmp
(
    pharmacy_status_regex varchar(200),
    tier_cat int,
    tier_regex varchar(200),
    pref_brand_tier_regex varchar(200),
    ftf_health_plan_type_regex varchar(200),
    copay_tier varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (copay_tier_derivation_config_v01_tmp.file_id);


CREATE TABLE sandbox.tier_cat_description_mapping_v01_tmp
(
    tier_cat int,
    description varchar(500),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (tier_cat_description_mapping_v01_tmp.file_id);


CREATE TABLE sandbox.coverage_category_derivation_config_v01_tmp
(
    paytype_regex varchar(200),
    pharmacy_status_regex varchar(200),
    coverage_cat_code int,
    coverage_category varchar(200),
    restriction_cat_code_regex varchar(200),
    meaning varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (coverage_category_derivation_config_v01_tmp.file_id);


CREATE TABLE sandbox.copay_tier_derivation_config_v01
(
    pharmacy_status_regex varchar(200),
    tier_cat int,
    tier_regex varchar(200),
    pref_brand_tier_regex varchar(200),
    ftf_health_plan_type_regex varchar(200),
    copay_tier varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (copay_tier_derivation_config_v01.file_id);


CREATE TABLE sandbox.tier_cat_description_mapping_v01
(
    tier_cat int,
    description varchar(500),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (tier_cat_description_mapping_v01.file_id);


CREATE TABLE sandbox.coverage_category_derivation_config_v01
(
    paytype_regex varchar(200),
    pharmacy_status_regex varchar(200),
    coverage_cat_code int,
    coverage_category varchar(200),
    restriction_cat_code_regex varchar(200),
    meaning varchar(500),
    file_id int,
    record_id int
)
PARTITION BY (coverage_category_derivation_config_v01.file_id);


CREATE TABLE sandbox.key_controller_list_v01_temp
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_account varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.raw_ftf_formularies_v5
(
    health_plan_id varchar(100),
    drug_id varchar(100),
    tier_code varchar(100),
    restrictions varchar(100),
    reason_code varchar(200),
    reason_code_description varchar(200),
    pharmacy_status varchar(100)
);


CREATE TABLE sandbox.raw_ftf_health_plans_v5
(
    formularyf_id varchar(100),
    provider_id varchar(100),
    provider varchar(250),
    health_plan_id varchar(100),
    health_plan varchar(200),
    parent_id varchar(100),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(100)
);


CREATE TABLE sandbox.raw_ftf_pbms_v5
(
    health_plan_id varchar(100),
    pbm_id varchar(100),
    pbm varchar(250),
    pbm_function_id varchar(100),
    pbm_function varchar(250)
);


CREATE TABLE sandbox.raw_ftf_restrictions_v5
(
    health_plan_id varchar(100),
    drug_id varchar(100),
    restriction_code varchar(500),
    restriction_details_id varchar(200),
    restriction_details_text varchar(1000),
    restriction_details_information_1 varchar(8000),
    restriction_details_information_2 varchar(8000),
    step_count varchar(100),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255)
);


CREATE TABLE sandbox.raw_iqvia_plan_v5
(
    payer_id varchar(100),
    payer_name varchar(200),
    plan_id varchar(100),
    payer_plan_id varchar(100),
    plan_name varchar(100),
    model varchar(100),
    city varchar(100),
    hq_state varchar(100),
    operating_state varchar(100),
    months_with_data varchar(100)
);


CREATE TABLE sandbox.raw_iqvia_pbm_v5
(
    pbm_name varchar(200),
    payer_plan_id varchar(200),
    xref_to_payer_plan_id varchar(200),
    ipd_id varchar(200),
    ipd_type varchar(200),
    plan_name varchar(200),
    pbm_id varchar(200),
    ims_processor_number varchar(200)
);


CREATE TABLE sandbox.raw_teva_ims_bridge_v5
(
    payer_name varchar(100),
    code varchar(100),
    name varchar(100),
    state varchar(100),
    comments varchar(100),
    plan_id varchar(100),
    plan_name varchar(200),
    provider_name varchar(200),
    plan_type_name varchar(100)
);


CREATE TABLE sandbox.raw_ftf_health_plan_geography_v5
(
    health_plan_id varchar(100),
    county_fips_id int,
    county_id int,
    county_name varchar(100),
    state_id int,
    state_name varchar(100),
    county_lives numeric(14,2)
);


CREATE TABLE sandbox.sh_sol_enrollment
(
    basket_name varchar(255),
    referral_date date,
    prescribing_physician_npi varchar(10),
    first_ship_date date,
    tvcmid int
);


CREATE TABLE sandbox.tn_pre_calls_anti_psych
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100),
    AssistRx_flag varchar(5),
    ShSol_flag varchar(5)
);


CREATE TABLE sandbox.austedo_titration_dosage
(
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    zip varchar(10),
    sales_force_id varchar(200),
    territory_id varchar(10),
    territory_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    product_name varchar(50),
    data_type varchar(50),
    Avg_TD_Daily_Dose_New_Patient numeric(10,3),
    Avg_TD_Daily_Dose_Cont_Patient numeric(10,3),
    Data_Ending_Month date
);


CREATE TABLE sandbox.ic_rx
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1) DEFAULT 'N',
    dnp_flag char(1) DEFAULT 'N',
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1) DEFAULT 'Y',
    include_in_area_rollup char(1) DEFAULT 'Y',
    include_in_region_rollup char(1) DEFAULT 'Y',
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date DEFAULT "sysdate"(),
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_ms_market_decile_201601
(
    ims_id varchar(10),
    category varchar(100),
    decile_name varchar(50),
    trx_cnt_01_06 int,
    trx_cnt_01_12 int
);


CREATE TABLE sandbox.ic_demo
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1) DEFAULT 'N',
    pdrp_date date,
    np_pa_flag char(1) DEFAULT 'N',
    no_spend char(1) DEFAULT 'N',
    ama_no_contact_flag char(1) DEFAULT 'N',
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date DEFAULT "sysdate"(),
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.qims_td_target_univ
(
    PRESCRIBER_ID varchar(50),
    ME_NBR varchar(20),
    IMS_ID varchar(7),
    NPI varchar(20),
    PRIMARY_SPECIALTY varchar(59),
    SECONDARY_SPECIALTY varchar(68),
    PRIMARY_SPECIALTY_GROUP varchar(50),
    SECONDARY_SPECIALTY_GROUP varchar(50),
    GENDER_CD varchar(50),
    FIRST_NAME varchar(50),
    LAST_NAME varchar(50),
    MID_NAME varchar(50),
    ADDRESS_1 varchar(63),
    ADDRESS_2 varchar(50),
    CITY varchar(50),
    STATE varchar(50),
    ZIP varchar(10),
    AMA_NO_CONTACT_INDICATOR varchar(15),
    AMA_PDRP_IND varchar(50),
    PROVIDER_TYP_DESC varchar(50),
    TARGET_Y_N varchar(50),
    ADOPTION_CATEGORY varchar(50),
    CMHC_AFFILIATION_Y_N varchar(50),
    INFLUENCER varchar(50),
    INFLUENCER_MVT_DIS_LEADER varchar(50),
    INFLUENCER_BHVR_HLTH_LEADER varchar(50),
    PRIORITY_FLAG_Y_N varchar(50),
    DIAGNOSED_TD_PAT_CNT numeric(28,10),
    OVERALL_DIAGNOSED_TD_PAT_CNT numeric(28,10),
    OVERALL_UNIQUE_DIAG_TD_PAT_CNT numeric(28,10),
    PREDICTED_TD_PAT_CNT_HIGH numeric(28,10),
    PREDICTED_TD_PAT_CNT_UNIQUE_HIGH numeric(28,10),
    SUM_OF_SCORES_PREDICTED_PAT_CNT_HIGH numeric(28,10),
    SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_HIGH numeric(28,10),
    TOTAL_OPPORTUNITY_HIGH numeric(28,10),
    PREDICTED_TD_PAT_CNT_MEDIUM numeric(28,10),
    PREDICTED_TD_PAT_CNT_UNIQUE_MEDIUM numeric(28,10),
    SUM_OF_SCORES_PREDICTED_PAT_CNT_MEDIUM numeric(28,10),
    SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_DIAG_HIGH_MEDIUM numeric(28,10),
    RANK numeric(28,10),
    DECILE_PAT_CNT numeric(28,10),
    DECILE_SUM_OF_SCORES numeric(28,10),
    DECILE_SUM_OF_SCORES_UNIQUE numeric(28,10),
    DECILE_OLD numeric(28,10),
    APD_PAT_CNT numeric(28,10),
    APD_PAT_CNT_TD_HIGH numeric(28,10),
    APD_PAT_CNT_TD_MEDIUM numeric(28,10),
    DIAGN_TD_MDD_BPD_SCZ_PAT_CNT numeric(28,10),
    OVERALL_DIAG_TD_MDD_BPD_SCZ_PT numeric(28,10),
    PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_HIGH numeric(28,10),
    TOTAL_OPPORTUNITY_MDD_BPD_SCZ_HIGH numeric(28,10),
    PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_MDD_BPD_SCZ_MEDIUM numeric(28,10),
    DIAGNOSED_TD_MDD_PAT_CNT numeric(28,10),
    OVERALL_DIAGNOSED_TD_MDD_PAT numeric(28,10),
    PREDICTED_TD_MDD_PAT_CNT_HIGH numeric(28,10),
    TOTAL_OPPORTUNITY_MDD_HIGH numeric(28,10),
    PREDICTED_TD_MDD_PAT_CNT_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_MDD_MEDIUM numeric(28,10),
    DIAGNOSED_TD_BPD_PAT_CNT numeric(28,10),
    OVERALL_DIAGNOSED_TD_BPD_PAT_CNT numeric(28,10),
    PREDICTED_TD_BPD_PAT_CNT_HIGH numeric(28,10),
    TOTAL_OPPORTUNITY_BPD_HIGH numeric(28,10),
    PREDICTED_TD_BPD_PAT_CNT_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_BPD_MEDIUM numeric(28,10),
    DIAGNOSED_TD_SCZ_PAT_CNT numeric(28,10),
    OVERALL_DIAGNOSED_TD_SCZ_PAT_CNT numeric(28,10),
    PREDICTED_TD_SCZ_PAT_CNT_HIGH numeric(28,10),
    TOTAL_OPPORTUNITY_SCZ_HIGH numeric(28,10),
    PREDICTED_TD_SCZ_PAT_CNT_MEDIUM numeric(28,10),
    TOTAL_OPPORTUNITY_SCZ_MEDIUM numeric(28,10),
    APD_CLM_CNT numeric(28,10),
    APD_CLM_CNT_TD_HIGH numeric(28,10),
    APD_CLM_CNT_TD_MEDIUM numeric(28,10),
    DIAGNOSED_TD_CLM_CNT numeric(28,10),
    METO_CLM_CNT numeric(28,10),
    ARIPIPRAZOLE_CLM_CNT numeric(28,10),
    ASENAPINE_CLM_CNT numeric(28,10),
    BREXPIPRAZOLE_CLM_CNT numeric(28,10),
    CARIPRAZINE_CLM_CNT numeric(28,10),
    CHLORPROMAZINE_CLM_CNT numeric(28,10),
    CLOZAPINE_CLM_CNT numeric(28,10),
    DROPERIDOL_CLM_CNT numeric(28,10),
    FLUPHENAZINE_CLM_CNT numeric(28,10),
    HALOPERIDOL_CLM_CNT numeric(28,10),
    ILOPERIDONE_CLM_CNT numeric(28,10),
    LOXAPINE_CLM_CNT numeric(28,10),
    LURASIDONE_CLM_CNT numeric(28,10),
    MOLINDONE_CLM_CNT numeric(28,10),
    OLANZAPINE_CLM_CNT numeric(28,10),
    PALIPERIDONE_CLM_CNT numeric(28,10),
    PERPHENAZINE_CLM_CNT numeric(28,10),
    PIMAVANSERIN_CLM_CNT numeric(28,10),
    PIMOZIDE_CLM_CNT numeric(28,10),
    PROCHLORPERAZINE_CLM_CNT numeric(28,10),
    QUETIAPINE_CLM_CNT numeric(28,10),
    RISPERIDONE_CLM_CNT numeric(28,10),
    THIORIDAZINE_CLM_CNT numeric(28,10),
    THIOTHIXENE_CLM_CNT numeric(28,10),
    TRIFLUOPERAZINE_CLM_CNT numeric(28,10),
    ZIPRASIDONE_CLM_CNT numeric(28,10),
    ABILIFY_LTC_TRX numeric(28,10),
    ABILIFY_DISCMELT_LTC_TRX numeric(28,10),
    ABILIFY_MAINTENA_LTC_TRX numeric(28,10),
    ARIPIPRAZOLE_LTC_TRX numeric(28,10),
    ARIPIPRAZOLE_ODT_LTC_TRX numeric(28,10),
    ARISTADA_LTC_TRX numeric(28,10),
    CHLORPROMAZINE_HCL_LTC_TRX numeric(28,15),
    CLOZAPINE_LTC_TRX numeric(28,10),
    CLOZAPINE_ODT_LTC_TRX numeric(28,10),
    CLOZARIL_LTC_TRX numeric(28,10),
    COMPRO_LTC_TRX numeric(28,10),
    FANAPT_LTC_TRX numeric(28,10),
    FANAPT_TITRATION_PACK_LTC_TRX numeric(28,10),
    FAZACLO_LTC_TRX numeric(28,10),
    FLUPHENAZINE_DECANOATE_LTC_TRX numeric(28,14),
    FLUPHENAZINE_HCL_LTC_TRX numeric(28,13),
    GEODON_LTC_TRX numeric(28,10),
    HALDOL_LTC_TRX numeric(28,10),
    HALDOL_DECANOATE_100_LTC_TRX numeric(28,10),
    HALDOL_DECANOATE_50_LTC_TRX numeric(28,10),
    HALOPERIDOL_LTC_TRX numeric(28,13),
    HALOPERIDOL_DECANOATE_LTC_TRX numeric(28,14),
    HALOPERIDOL_LACTATE_LTC_TRX numeric(28,13),
    INVEGA_LTC_TRX numeric(28,10),
    INVEGA_SUSTENNA_LTC_TRX numeric(28,10),
    INVEGA_TRINZA_LTC_TRX numeric(28,10),
    LATUDA_LTC_TRX numeric(28,14),
    LOXAPINE_LTC_TRX numeric(28,10),
    LOXAPINE_SUCCINATE_LTC_TRX numeric(28,10),
    MOLINDONE_HYDROCHLOR_LTC_TRX numeric(28,10),
    NUPLAZID_LTC_TRX numeric(28,10),
    OLANZAPINE_LTC_TRX numeric(28,14),
    OLANZAPINE_ODT_LTC_TRX numeric(28,10),
    OLANZAPINE_FLUOXETINE_LTC_TRX numeric(28,10),
    ORAP_LTC_TRX numeric(28,10),
    PALIPERIDONE_ER_LTC_TRX numeric(28,10),
    PERPHENAZINE_LTC_TRX numeric(28,10),
    PERPHENAZINE_AMITRIPTY_LTC_TRX numeric(28,10),
    PIMOZIDE_LTC_TRX numeric(28,10),
    PROCHLORPERAZINE_LTC_TRX numeric(28,10),
    PROCHLORPERAZINE_EDISY_LTC_TRX numeric(28,10),
    PROCHLORPERAZINE_MALEA_LTC_TRX numeric(28,10),
    QUETIAPINE_FUMARATE_LTC_TRX numeric(28,13),
    QUETIAPINE_FUMARATE_ER_LTC_TRX numeric(28,10),
    REXULTI_LTC_TRX numeric(28,10),
    RISPERDAL_LTC_TRX numeric(28,10),
    RISPERDAL_CONSTA_LTC_TRX numeric(28,10),
    RISPERDAL_M_TAB_LTC_TRX numeric(28,10),
    RISPERIDONE_LTC_TRX numeric(28,13),
    RISPERIDONE_M_TAB_LTC_TRX numeric(28,10),
    RISPERIDONE_ODT_LTC_TRX numeric(28,10),
    SAPHRIS_LTC_TRX numeric(28,14),
    SEROQUEL_LTC_TRX numeric(28,10),
    SEROQUEL_XR_LTC_TRX numeric(28,10),
    SYMBYAX_LTC_TRX numeric(28,10),
    THIORIDAZINE_HCL_LTC_TRX numeric(28,10),
    THIOTHIXENE_LTC_TRX numeric(28,10),
    TRIFLUOPERAZINE_HCL_LTC_TRX numeric(28,10),
    VERSACLOZ_LTC_TRX numeric(28,10),
    VRAYLAR_LTC_TRX numeric(28,10),
    ZIPRASIDONE_HCL_LTC_TRX numeric(28,14),
    ZYPREXA_LTC_TRX numeric(28,10),
    ZYPREXA_RELPREVV_LTC_TRX numeric(28,10),
    ZYPREXA_ZYDIS_LTC_TRX numeric(28,10),
    FACILITY_TYPE varchar(61)
);


CREATE TABLE sandbox.compliance_speaker_list
(
    tvcmid int,
    npi varchar(50),
    Last_Name varchar(50),
    First_Name varchar(50),
    Middle_Initial varchar(1),
    Address varchar(65),
    City varchar(50),
    State varchar(50),
    Zip varchar(10),
    speaker_affiliation varchar(100)
);


CREATE TABLE sandbox.ic_ms_market_decile_201801
(
    ims_id varchar(10),
    tvcmid int,
    category varchar(2),
    decile_name varchar(300),
    trx_cnt_01_06 int,
    trx_cnt_01_12 int
);


CREATE TABLE sandbox.call_plan_decile_nr
(
    hcp_id varchar(50),
    market varchar(50),
    decile_value varchar(50),
    veeva_id varchar(50)
);


CREATE TABLE sandbox.ic_decile
(
    ic_data_month date,
    ims_id varchar(10),
    tvcmid int,
    decile_name varchar(300),
    decile_value int,
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date DEFAULT "sysdate"()
);


CREATE TABLE sandbox.scd_prescriber_combined_demographics
(
    scd_status varchar(10) DEFAULT 'Current',
    scd_effective_date date DEFAULT trunc("sysdate"()),
    scd_expiration_date date DEFAULT '2099-12-31'::date,
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100)
);


CREATE TABLE sandbox.Q2_2018_TP_NO_VEEVAID
(
    HCP_ID int,
    Territory varchar(50),
    Program varchar(50),
    Campaign varchar(50),
    "Rank Value" varchar(50)
);


CREATE TABLE sandbox.call_sample_product_value
(
    Id varchar(18),
    product_value_vod__c varchar(20)
);


CREATE TABLE sandbox.HEADACHE_CENTER_LIST
(
    "IMS ID" varchar(50)
);


CREATE TABLE sandbox.qvar_knipper_test2_09202018
(
    tvcmid int,
    tvcmid1 int,
    tvcmid2 int,
    ims_id int,
    npi int,
    last_name varchar(164),
    first_name varchar(164),
    middle_name varchar(164),
    personal_suffix varchar(50),
    medical_suffix varchar(50),
    primary_specialty varchar(50),
    address_line1 varchar(324),
    address_line2 varchar(324),
    city varchar(164),
    state_code varchar(50),
    zip int,
    np_pa_flag varchar(50),
    authorization_number varchar(104),
    profession_code int,
    state varchar(50),
    license_expiration_date timestamp,
    license_status_description varchar(164)
);


CREATE TABLE sandbox.views_to_keep
(
    view_name varchar(255)
);


CREATE TABLE sandbox.HeadacheCenter
(
    IMS_ID varchar(50),
    TVCMID int,
    First_Name varchar(50),
    Middle_Name varchar(50),
    Last_Name varchar(50),
    Cred varchar(59),
    Location varchar(112),
    Address_1 varchar(76),
    Address_2 varchar(51),
    City varchar(50),
    State_Code varchar(50),
    Zip_Code varchar(50),
    Zip_Extension varchar(50),
    Telephone varchar(50),
    Alternative_Telephone varchar(50)
);


CREATE TABLE sandbox.QVAR_08202019
(
    "IMSID 2,868" int
);


CREATE TABLE sandbox.a_mktdef
(
    market_name varchar(20),
    market_id float,
    brand_form_strength varchar(38),
    bfs_id float,
    brand varchar(1),
    teva_prod varchar(1),
    prod_group varchar(16),
    F8 varchar(1)
);


CREATE TABLE sandbox.QVAR_HCPs_09272019
(
    IMSID varchar(12),
    NPI varchar(12)
);


CREATE TABLE sandbox.ZS_austedodeciling_1105
(
    IMSID int,
    "Alignment Decile" int
);


CREATE TABLE sandbox.controls_newprescriber_1114
(
    ims_id int
);


CREATE TABLE sandbox.J_Chung_NPI_IDs
(
    "Physician NPI #" int
);


CREATE TABLE sandbox."J_CHUNG_HCP DEA-2"
(
    "Physician DEA#" varchar(50),
    tvcmid int
);


CREATE TABLE sandbox.zs_acute_migraine
(
    market_name varchar(50),
    market_id int,
    brand_form_strength varchar(69),
    bfs_id int,
    teva_prod varchar(50),
    prod_group varchar(50)
);


CREATE TABLE sandbox.M_D_PRODUCTS
(
    MOVEMENT_DISORDER_PRODUCTS varchar(50)
);


CREATE TABLE sandbox.AUSTEDO_BASKET_BRAND
(
    MOVEMENT_DISORDER_PRODUCTS varchar(50)
);


CREATE TABLE sandbox.ONC_Basket_IDs_for_QA
(
    BRAND varchar(50),
    basket_id int
);


CREATE TABLE sandbox.PGK_Q12020Call_Plan
(
    "Sales Team" varchar(50),
    specialty varchar(50),
    "Specialty Group" varchar(50),
    decile int,
    "Decile Group" varchar(50),
    veeva_account_id varchar(50),
    tvcmid int,
    ims_id varchar(50),
    first_name varchar(50),
    last_name varchar(50),
    terr varchar(50),
    address1 varchar(70),
    city varchar(50),
    state varchar(50),
    zip int
);


CREATE TABLE sandbox.customer_mb
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    ims_outlet_code varchar(10),
    ims_facility_number varchar(11),
    federation_id varchar(200),
    customer_type varchar(15),
    prescriber_type varchar(25),
    network_name varchar(100),
    account_name varchar(100),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    credential varchar(100),
    subcat_group varchar(100),
    subcat_code varchar(2),
    pdrp_flag varchar(1),
    pri_specialty_code varchar(10),
    pri_specialty_desc varchar(100),
    sec_specialty_code varchar(10),
    sec_specialty_desc varchar(100),
    cm_status_flag varchar(15),
    gpo varchar(100),
    dnp_flag varchar(1),
    product_1_dnc_flag varchar(1),
    product_2_dnc_flag varchar(1),
    a_specialty_group varchar(10),
    b_specialty_group varchar(10),
    c_specialty_group varchar(10),
    formulary_control varchar(20)
);


CREATE TABLE sandbox.test_con_prev
(
    cust_id float,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.mb_ic_demo_tp
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.concur_hcp_prev
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10)
);


CREATE TABLE sandbox.IC_QA_062020_NEWWRITERS
(
    "New HCPs for Apr" int,
    "HCP Status" varchar(50)
);


CREATE TABLE sandbox.zs_teva_payer_master
(
    plan_code varchar(15),
    Final_Key_Controlling_Account varchar(100),
    Key_Parent_Account varchar(100),
    PBM varchar(100),
    Payer varchar(100),
    Plan varchar(100),
    State_Code varchar(50),
    AJOVY_TRx numeric(10,4),
    Aimovig_TRx numeric(10,4),
    Emgality_TRx numeric(10,4),
    aCGRP_TRx numeric(10,4),
    AJOVY_Share_Percent numeric(28,16),
    Aimovig_Share_Percent numeric(28,16),
    Emgality_Share_Percent numeric(28,16),
    Latest_Mth_AJOVY_TRx numeric(10,4),
    Latest_Mth_AJOVY_Share_Percent numeric(28,16),
    Lives_Covered_Total int,
    Ajovy_Formulary_Status varchar(100),
    Aimovig_Formulary_Status varchar(100),
    Emgality_Formulary_Status varchar(100),
    Plan_Payment_Type varchar(100),
    Priority_Account_flag varchar(100),
    Justification varchar(100),
    Plan_Mapping varchar(50)
);


CREATE TABLE sandbox.idl_best_address_2
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.idl_best_address_non2
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.TN_UNIVRS_AUG2020
(
    sales_force_id varchar(50),
    freeze_reason varchar(50),
    freeze_date timestamp,
    start_date timestamp,
    end_date timestamp,
    ims_id int,
    tvcmid int
);


CREATE TABLE sandbox.test_woprefix
(
    cust_id int,
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.test_wprefix
(
    cust_id varchar(23),
    organization_name varchar(1),
    contact_type varchar(3),
    first_name varchar(80),
    middle_name varchar(80),
    last_name varchar(80),
    suffix varchar(10),
    npi varchar(100),
    address_line_1 varchar(160),
    address_line_2 varchar(160),
    city varchar(80),
    state varchar(2),
    zipcode varchar(5),
    sln varchar(25),
    sln_state varchar(2),
    dea varchar(18),
    affiliation varchar(1),
    credential varchar(10),
    healthcare_professional_status_code varchar(10),
    create_date date
);


CREATE TABLE sandbox.prescriber_rx_adhoc_06282021
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    unnormalized_nrx_count float,
    unnormalized_trx_count float,
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20)
);


CREATE TABLE sandbox."IMS ID ISSUES_AJOVY10262020"
(
    "IMS ID" varchar(50)
);


CREATE TABLE sandbox."IQVIA OPTUM OUTLETS11032020"
(
    "Outlet #" int,
    Active varchar(50),
    PRE int,
    Name varchar(53),
    "10/2/2020 12:00:00 AM" varchar(50)
);


CREATE TABLE sandbox.RELIANCE_PRODUCT_MODEL
(
    Market varchar(50),
    "Source Name" varchar(50),
    "Product Name" varchar(63),
    "Product Description" varchar(107),
    "Manufacturer Name" varchar(50)
);


CREATE TABLE sandbox.prescriber_rx_adhoc_12022020
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    unnormalized_nrx_count float,
    unnormalized_trx_count float,
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20)
);


CREATE TABLE sandbox.pgk_my_sample_closet
(
    "IMS ID" int,
    Decile int,
    TVCMID int,
    "First Name" varchar(50),
    "Last Name" varchar(50),
    "Middle Name" varchar(50),
    Suffix varchar(50),
    "Address 1" varchar(79),
    "Address 2" varchar(75),
    "Address 3" varchar(50),
    City varchar(50),
    State varchar(50),
    Zip int,
    "SLN 1" varchar(20),
    "SLN 1 Expiration Date" varchar(20),
    "SLN 2" varchar(20),
    "SLN 2 State" varchar(20),
    "SLN 2 Expiration Date" varchar(20),
    Specialty varchar(50),
    "Specialty Description" varchar(66),
    "Specialty Group" varchar(50),
    "IMS ID_1" int,
    NPI varchar(50),
    DEA varchar(20),
    Designation varchar(50),
    Decile_1 int,
    "Email Rented?" varchar(73),
    "Dup IMS ID" varchar(20)
);


CREATE TABLE sandbox.ref_rptng_mrkts
(
    basket_id int,
    basket_name varchar(300),
    basket_type varchar(100),
    status varchar(1),
    geo_summary_include varchar(1),
    presc_summary_include varchar(1),
    market_share_market_id int,
    market_share_brand_id int,
    rptg_decile_attribute_type varchar(100),
    rptg_decile_attribute_prod_id int,
    rptg_segment_attribute_type varchar(100),
    rptg_segment_attribute_prod_id int
);


CREATE TABLE sandbox.archer_zip_terr
(
    zip_code varchar(5),
    city varchar(50),
    state_code varchar(2),
    territory_number varchar(10),
    territory_name varchar(100),
    area_name varchar(50),
    region_name varchar(50),
    mirror_flag varchar(5),
    sales_force_id varchar(5),
    region_number varchar(8),
    area_number varchar(8)
);


CREATE TABLE sandbox.archer_target_data
(
    territory varchar(10),
    geography varchar(100),
    region varchar(10),
    tvcmid int,
    ims_id varchar(10),
    npi varchar(20),
    decile varchar(5),
    vmat2_12_mth varchar(10),
    pdrp_flag varchar(5),
    last_name varchar(50),
    first_name varchar(50),
    specialty varchar(10),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5)
);


CREATE TABLE sandbox."SYNEOS TERRs MISSING IMS IDs"
(
    "SYNEOS TERR" varchar(50),
    "Count of Missing IMS IDs" int
);


CREATE TABLE sandbox.veeva_call
(
    id varchar(18),
    ownerid varchar(18),
    isdeleted varchar(5),
    name varchar(80),
    recordtypeid varchar(18),
    createddate timestamptz,
    createdbyid varchar(18),
    lastmodifieddate timestamptz,
    lastmodifiedbyid varchar(18),
    systemmodstamp timestamptz,
    lastactivitydate date,
    mayedit varchar(5),
    islocked varchar(5),
    lastvieweddate timestamptz,
    lastreferenceddate timestamptz,
    sample_card_vod__c varchar(15),
    add_detail_vod__c varchar(1000),
    property_vod__c varchar(64),
    account_vod__c varchar(18),
    zvod_product_discussion_vod__c varchar(5),
    status_vod__c varchar(255),
    parent_address_vod__c varchar(18),
    account_plan_vod__c varchar(18),
    zvod_savenew_vod__c varchar(5),
    next_call_notes_vod__c varchar(255),
    mobile_id_vod__c varchar(100),
    zvod_account_credentials_vod_c varchar(5),
    zvod_account_preferred_name_vo varchar(5),
    zvod_account_sample_status_vod varchar(5),
    zvod_attendees_vod__c varchar(5),
    zvod_key_messages_vod__c varchar(5),
    zvod_detailing_vod__c varchar(5),
    zvod_expenses_vod__c varchar(5),
    zvod_followup_vod__c varchar(5),
    zvod_samples_vod__c varchar(5),
    zvod_save_vod__c varchar(5),
    zvod_submit_vod__c varchar(5),
    zvod_delete_vod__c varchar(5),
    activity_type__c varchar(255),
    significant_event__c varchar(5),
    location_vod__c varchar(128),
    subject_vod__c varchar(128),
    call_datetime_vod__c timestamptz,
    disbursed_to_vod__c varchar(255),
    request_receipt_vod__c varchar(5),
    signature_date_vod__c timestamptz,
    territory_vod__c varchar(100),
    submitted_by_mobile_vod__c varchar(5),
    call_type_vod__c varchar(255),
    add_key_message_vod__c varchar(4000),
    address_vod__c varchar(500),
    attendees_vod__c varchar(64),
    attendee_type_vod__c varchar(255),
    call_date_vod__c date,
    detailed_products_vod__c varchar(255),
    no_disbursement_vod__c varchar(5),
    parent_call_vod__c varchar(18),
    user_vod__c varchar(18),
    contact_vod__c varchar(18),
    zvod_entity_vod__c varchar(5),
    medical_event_vod__c varchar(18),
    mobile_created_datetime_vod__c timestamptz,
    mobile_last_modified_datetime timestamptz,
    license_vod__c varchar(25),
    is_parent_call_vod__c varchar(64),
    entity_display_name_vod__c varchar(1300),
    last_device_vod__c varchar(255),
    ship_address_line_1_vod__c varchar(80),
    ship_address_line_2_vod__c varchar(100),
    ship_city_vod__c varchar(40),
    ship_country_vod__c varchar(20),
    ship_license_expiration_date date,
    ship_license_status_vod__c varchar(25),
    ship_license_vod__c varchar(25),
    ship_state_vod__c varchar(30),
    ship_to_address_vod__c varchar(18),
    ship_zip_vod__c varchar(20),
    ship_to_address_text_vod__c varchar(1300),
    clm_vod__c varchar(5),
    zvod_clmdetails_vod__c varchar(5),
    is_sampled_call_vod__c varchar(5),
    zvod_surveys_vod__c varchar(5),
    presentations_vod__c varchar(500),
    entity_reference_id_vod__c varchar(100),
    error_reference_call_vod__c varchar(18),
    duration_vod__c varchar(64),
    color_vod__c varchar(255),
    allowed_products_vod__c varchar(1000),
    zvod_attachments_vod__c varchar(5),
    sample_card_reason_vod__c varchar(255),
    assmca_vod__c varchar(100),
    address_line_1_vod__c varchar(80),
    address_line_2_vod__c varchar(100),
    city_vod__c varchar(40),
    dea_address_line_1_vod__c varchar(80),
    dea_address_line_2_vod__c varchar(100),
    dea_address_vod__c varchar(18),
    dea_city_vod__c varchar(40),
    dea_expiration_date_vod__c date,
    dea_state_vod__c varchar(10),
    dea_zip_4_vod__c varchar(4),
    dea_zip_vod__c varchar(20),
    dea_vod__c varchar(9),
    ship_zip_4_vod__c varchar(4),
    state_vod__c varchar(10),
    zip_4_vod__c varchar(4),
    zip_vod__c varchar(20),
    sample_send_card_vod__c varchar(15),
    zvod_address_vod_c_dea_status_ varchar(5),
    signature_page_image_vod__c varchar(255),
    credentials_vod__c varchar(255),
    salutation_vod__c varchar(255),
    zvod_account_call_reminder_vod varchar(5),
    sales_org_tva__c varchar(1300),
    zvod_business_account_vod__c varchar(5),
    product_priority_1_vod__c varchar(18),
    product_priority_2_vod__c varchar(18),
    product_priority_3_vod__c varchar(18),
    product_priority_4_vod__c varchar(18),
    product_priority_5_vod__c varchar(18),
    zvod_more_actions_vod__c varchar(5),
    zvod_call_conflict_status varchar(5),
    signature_timestamp_vod__c varchar(64),
    expense_amount_vod__c varchar(64),
    total_expense_attendees_count varchar(64),
    attendee_list_vod__c varchar(4000),
    expense_post_status_vod__c varchar(10),
    attendee_post_status_vod__c varchar(10),
    expense_system_external_id varchar(255),
    incurred_expense_vod__c varchar(5),
    assigner_vod__c varchar(18),
    assignment_datetime_vod__c timestamptz,
    zvod_call_objective_vod__c varchar(5),
    signature_location_longitude varchar(64),
    signature_location_latitude varchar(64),
    location_services_status varchar(255),
    created_by_timezone_tva__c varchar(120),
    license_expiration_date_vod__c date,
    license_status_vod__c varchar(255),
    ship_assmca_vod__c varchar(100),
    ship_dea_expiration_date date,
    ship_dea_vod__c varchar(9),
    call_method_tva__c varchar(255),
    bendeka_indication_tva__c varchar(5000),
    file_id int,
    record_id int,
    austedo_indication_tva__c varchar(5000),
    call_duration_tva__c numeric(3,0),
    how_executed_tva__c varchar(40),
    Remote_Meeting_vod__c varchar(100),
    Veeva_Remote_Meeting_Id_vod__c varchar(20),
    Cobrowse_URL_Participant_vod__c varchar(255),
    Signature_Captured_Remotely_vod__c varchar(150),
    Remote_Signature_Attendee_Name_vod__c varchar(5),
    rowrank int
);


CREATE TABLE sandbox.newman_products
(
    sfa varchar(5),
    cne varchar(5),
    hcp varchar(5),
    consumer varchar(10),
    item_id varchar(25),
    product_line varchar(20),
    product_name varchar(100),
    Organization varchar(20),
    Description varchar(1000),
    expiration_date date,
    deleted_date date,
    status varchar(15),
    approval_number varchar(10),
    available_qty int,
    category varchar(50),
    cost numeric(10,2)
);


CREATE TABLE sandbox.ic_rx_bkp
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.pay_type_xref
(
    model varchar(50),
    pay_type varchar(50),
    standard_teva_assignments varchar(74),
    pay_type_index int
);


CREATE TABLE sandbox.pay_type_overrides
(
    iqvia_payer_name varchar(62),
    iqvia_plan_name_substr varchar(62),
    override_model varchar(50)
);


CREATE TABLE sandbox.plantrak_oldview
(
    "Payer ID" int,
    "Payer Name" varchar(50),
    "Plan ID" int,
    "Payer/Plan ID" int,
    "Plan Name" varchar(62),
    Model varchar(50),
    "Payment Method" varchar(50),
    "Xref To" varchar(50),
    "Xref Date" varchar(50),
    City varchar(50),
    "HQ State" varchar(50),
    "Operating State" varchar(50),
    Months varchar(50)
);


CREATE TABLE sandbox.rptng_approv_email_05022021
(
    veeva_sent_email_id varchar(36),
    sent_email_id varchar(160),
    product varchar(2600),
    date_sent timestamptz,
    status varchar(9),
    failure_message varchar(510),
    veeva_account_id varchar(36),
    tvcmid int,
    veeva_call_id varchar(36),
    call_id varchar(80),
    sender_email varchar(160),
    territory varchar(200),
    recipient_email varchar(160),
    click_count float,
    open_count float,
    last_open_date timestamptz,
    valid_consent varchar(5),
    delivered varchar(1),
    opened varchar(1),
    dropped varchar(1),
    clicked varchar(1),
    downloaded varchar(1),
    viewed varchar(1),
    template_id varchar(36),
    template_name varchar(80),
    event_msg_vod__c varchar(65000),
    click_url_vod__c varchar(510),
    subject varchar(255)
);


CREATE TABLE sandbox.ic_rx_mar2021
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_mar2021
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.fcr_summary
(
    rsm_name varchar(121),
    rsm_title varchar(80),
    region_number varchar(26),
    rsm_email varchar(128),
    sales_rep_name varchar(121),
    sales_rep_title varchar(80),
    territory_number varchar(50),
    sales_rep_email varchar(128),
    fcr_date date
);


CREATE TABLE sandbox.payer_test1
(
    activity_id varchar(64),
    federation_id varchar(200),
    contact varchar(200),
    source_name varchar(100),
    "datetime" timestamp,
    trackback_id varchar(200),
    previous_activity varchar(64),
    level_name varchar(64),
    activity_role_name varchar(100),
    type_name varchar(100),
    native_type varchar(200),
    details varchar(200),
    line_item_id varchar(64),
    brand_name varchar(200),
    activity varchar(200),
    line_item_datetime timestamp,
    line_item_previous_line_item varchar(200),
    line_item_trackback_id varchar(200),
    line_item_details varchar(200),
    line_item_type_name varchar(100),
    line_item_native_type varchar(200),
    basket_id varchar(64),
    web_url varchar(5000)
);


CREATE TABLE sandbox.ftf_health_plan_geography
(
    health_plan_id varchar(6),
    operating_state varchar(2),
    lives_coverage int,
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ftf_restrictions
(
    health_plan_id varchar(64),
    drug_id varchar(64),
    restriction_detail_id varchar(64),
    restriction_code varchar(64),
    formulary_entry_restriction_id varchar(64),
    restriction_detail_text varchar(250),
    restriction_addtnl_information_1 varchar(1000),
    restriction_addtnl_information_2 varchar(1000),
    record_id int,
    file_id int
);


CREATE TABLE sandbox.ims_plan_xref
(
    payer_num varchar(6),
    payer_name varchar(100),
    plan_num varchar(4),
    payer_plan_num varchar(10),
    plan_name varchar(100),
    model varchar(10),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.iqvia_plans_discard
(
    payer_id varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_plans_discard.file_id);


CREATE TABLE sandbox.ftf_plans_paytypeindex
(
    ftf_health_plantype varchar(64),
    paytype_index int,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_plans_paytypeindex.file_id);


CREATE TABLE sandbox.ftf_override_provider
(
    provider_id varchar(64),
    paytype_index varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_override_provider.file_id);


CREATE TABLE sandbox.ftf_override_plan
(
    ftf_health_planid varchar(64),
    paytype_index varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_override_plan.file_id);


CREATE TABLE sandbox.pa_restriction
(
    code int,
    restriction_detail_id varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (pa_restriction.file_id);


CREATE TABLE sandbox.a_prodgrp1
(
    market_name varchar(20),
    market_id float,
    product_desc varchar(39),
    basket_id float,
    prod_group varchar(16)
);


CREATE TABLE sandbox.a_jrtest
(
    ims_id varchar(10),
    prod_group varchar(16),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    trx numeric(21,3)
);


CREATE TABLE sandbox.addr
(
    tvcmid int,
    address_id int,
    address_type varchar(10),
    address_type_name varchar(50),
    address_line_1 varchar(80),
    address_line_2 varchar(80),
    county varchar(40),
    city varchar(40),
    state varchar(2),
    state_name varchar(50),
    country_code varchar(3),
    country_name varchar(50),
    zip5_postal_code varchar(5),
    zip4_postal_extension_code varchar(4),
    address_status varchar(10),
    address_status_name varchar(50),
    address_effective_date timestamp,
    msa_cbsa varchar(5),
    fips_state_code varchar(2),
    fips_state_description varchar(50),
    fips_county_code varchar(3),
    fips_county_description varchar(50),
    deliverability_confidence varchar(10),
    address_setting_type_code varchar(10),
    address_setting_type_description varchar(50),
    address_category_code varchar(10),
    address_category_description varchar(50),
    address_latitude varchar(20),
    address_longitude varchar(20),
    postal_barcode varchar(10),
    single_address_indicator varchar(1),
    practice_location_confidence_indicator varchar(10),
    practice_location_rank varchar(10),
    validation_message varchar(100),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE sandbox.ps_process_run_tbl
(
    process_id int,
    process_name varchar(64),
    date_run date
);


CREATE TABLE sandbox.ps_process_audit_tbl
(
    process_id int NOT NULL,
    cycle_id int,
    date_run date,
    insert_time timestamp,
    inserted_by varchar(64),
    modified_time timestamp,
    modified_by varchar(64)
)
PARTITION BY (ps_process_audit_tbl.process_id);


CREATE TABLE sandbox.iqvia_payer_paytype_override
(
    iqvia_payer_name varchar(128),
    iqvia_plan_name_regex varchar(128),
    paytype varchar(128),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_payer_paytype_override.file_id);


CREATE TABLE sandbox.iqvia_plan_preprocessed
(
    iqvia_payer_id varchar(6),
    iqvia_payer_name varchar(100),
    iqvia_plan_id varchar(4),
    iqvia_plan_code varchar(10),
    iqvia_plan_name varchar(100),
    model varchar(10),
    iqvia_pbm varchar(100),
    paytype varchar(128),
    paytype_index varchar(64),
    cycle_id int
);


CREATE TABLE sandbox.iqvia_pbm_preprocessed
(
    iqvia_plan_code varchar(10),
    iqvia_pbm varchar(100),
    xref_to varchar(10),
    iqvia_plan_name varchar(100),
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_health_plans_preprocessed
(
    ftf_health_plan_fid varchar(6),
    ftf_health_plan_name varchar(100),
    ftf_provider_fid varchar(6),
    ftf_provider_name varchar(250),
    parent_id varchar(6),
    ftf_parent_name varchar(250),
    ftf_health_plan_type varchar(250),
    pref_brand_tier varchar(64),
    plan_lives int,
    paytype varchar(64),
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_formularies_preprocessed
(
    drug_seq int,
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    pharmacy_status varchar(80),
    check_blank_pharmstat varchar(80),
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_pbm_functions
(
    pbm_function_id int,
    pbm_function varchar(64),
    notes varchar(128),
    used int,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_pbm_functions.file_id);


CREATE TABLE sandbox.ftf_pbms_preprocessed
(
    ftf_health_plan_fid varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250),
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_v1
(
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(250),
    grouped_restriction_level varchar(255),
    drug_seq int,
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_v2
(
    ftf_health_plan_fid varchar(6),
    drug_id varchar(6),
    drug_seq int,
    MAX varchar(6),
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id int,
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.Ajovy_Dispense
(
    file_date timestamp,
    rx_received_date timestamp,
    order_created_date timestamp,
    shipping_date timestamp,
    prescriber_npi varchar(50),
    prescriber_full_name varchar(60),
    prescriber_first_name varchar(50),
    prescriber_middle_name varchar(50),
    prescriber_last_name varchar(50),
    prescriber_address varchar(60),
    prescriber_city varchar(50),
    prescriber_state varchar(50),
    prescriber_zip varchar(50),
    pharmacy_npi varchar(50),
    pharmacy_ncpdp_provider_id int,
    pharmacy_name varchar(50),
    pharmacy_address varchar(56),
    pharmacy_city varchar(50),
    pharmacy_state varchar(50),
    pharmacy_zip varchar(50),
    unique_patient_id varchar(70),
    product_ndc varchar(50),
    dispense_quantity numeric(28,10),
    dispense_number int,
    refills_remaining int,
    script_type varchar(50),
    coverage_code varchar(50),
    primary_payer_name varchar(68),
    primary_bin_number int,
    primary_payment_type varchar(50),
    primary_benefit_type varchar(50),
    patient_purchase_price numeric(28,10),
    patient_initial_cost varchar(50),
    patient_benefit numeric(28,14),
    payer_cost numeric(28,13),
    copay_assistance_applied varchar(50),
    patient_state varchar(50)
);


CREATE TABLE sandbox.raw_ftf_formularies
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    pharmacy_status varchar(20)
);


CREATE TABLE sandbox.raw_ftf_health_plans
(
    formularyf_id varchar(6),
    provider_id varchar(6),
    provider varchar(250),
    health_plan_id varchar(6),
    health_plan varchar(100),
    parent_id varchar(6),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(64)
);


CREATE TABLE sandbox.raw_ftf_pbms
(
    health_plan_id varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250)
);


CREATE TABLE sandbox.raw_iqvia_plan
(
    payer_num varchar(6),
    payer_name varchar(100),
    plan_num varchar(4),
    payer_plan_num varchar(10),
    plan_name varchar(100),
    model varchar(10),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4)
);


CREATE TABLE sandbox.raw_iqvia_pbm
(
    pbm_name varchar(100),
    payer_plan_num varchar(10),
    xref_to_payer_plan_num varchar(10),
    ipd_id varchar(10),
    ipd_type varchar(10),
    plan_name varchar(100),
    pbm_num varchar(6),
    ims_processor_num varchar(10)
);


CREATE TABLE sandbox.raw_teva_ims_bridge
(
    payer_name varchar(50),
    code varchar(10),
    name varchar(50),
    state varchar(5),
    comments varchar(50),
    plan_id varchar(10),
    plan_name varchar(100),
    provider_name varchar(100),
    plan_type_name varchar(20)
);


CREATE TABLE sandbox.suggestions_targets
(
    veeva_account_id varchar(18),
    territory_number varchar(8),
    product varchar(9)
);


CREATE TABLE sandbox.ddd_exc_or
(
    outlet_code varchar(50),
    outlet_name varchar(50),
    sub_cat varchar(50)
);


CREATE TABLE sandbox.afm_cycle1_teva_hcp_report
(
    npi varchar(10),
    zs_spec_desc_md varchar(25),
    specialty_name varchar(100),
    specialty_group varchar(25),
    pff_ctt_vol varchar(15),
    pff_en varchar(10),
    pff_en_quintile varchar(15),
    pff_affinity varchar(15),
    pr_ctt_vol varchar(15),
    pr_en varchar(10),
    pr_en_quintile varchar(15),
    pr_affinity varchar(15),
    pi_ctt_vol varchar(15),
    pi_en varchar(10),
    pi_en_quintile varchar(15),
    pi_affinity varchar(15),
    dph_ctt_vol varchar(15),
    dph_en varchar(10),
    dph_en_quintile varchar(15),
    dph_affinity varchar(15),
    dpl_ctt_vol varchar(15),
    dpl_en varchar(10),
    dpl_en_quintile varchar(15),
    dpl_affinity varchar(15),
    drt_ctt_vol varchar(15),
    drt_en varchar(10),
    drt_en_quintile varchar(15),
    drt_affinity varchar(15),
    top_channels varchar(15),
    pp_access_rating varchar(20),
    npp_access_rating varchar(20),
    peer_offer_en varchar(15),
    copay_offer_en varchar(15),
    sample_offer_en varchar(15),
    voucher_offer_en varchar(20)
);


CREATE TABLE sandbox.sample_table
(
    a int
);


CREATE TABLE sandbox.a_prodgrp_a
(
    mkt_name varchar(100),
    mkt_id numeric(8,0),
    mkt_rpt_flag varchar(1),
    bfs_name varchar(100),
    bfs_id numeric(8,0),
    brand varchar(50),
    teva_prod varchar(1),
    mkt_basket varchar(1),
    prod_grp varchar(50)
);


CREATE TABLE sandbox.a_prodgrp
(
    mkt_name varchar(100),
    mkt_id numeric(9,0),
    mkt_rpt_flag varchar(1),
    bfs_name varchar(100),
    bfs_id numeric(9,0),
    brand varchar(50),
    teva_prod varchar(1),
    mkt_basket varchar(1),
    prod_grp varchar(50)
);


CREATE TABLE sandbox.a_roster_denorm
(
    sales_force_id varchar(5),
    terr varchar(8),
    terr_name varchar(50),
    reg varchar(8),
    reg_name varchar(50),
    area varchar(8),
    area_name varchar(50),
    nation varchar(4),
    nation_name varchar(6)
);


CREATE TABLE sandbox.a_roster_norm
(
    sales_force_id varchar(5),
    sorg_lvl varchar(1),
    sorg varchar(8),
    sorg_name varchar(50),
    terr varchar(8),
    terr_name varchar(50),
    reg varchar(8),
    reg_name varchar(50),
    area varchar(8),
    area_name varchar(50),
    nation varchar(4),
    nation_name varchar(6)
);


CREATE TABLE sandbox.a_payer_Migrane_Market
(
    ims_id varchar(10),
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkt_id numeric(9,0),
    prod_grp varchar(50),
    teva_prod varchar(1),
    SubGroup varchar(1),
    trx_c1 numeric(21,3),
    trx_p1 numeric(21,3),
    trx_c3 numeric(21,3),
    trx_p3 numeric(21,3)
);


CREATE TABLE sandbox.a_align_payer_rollup
(
    ims_id varchar(10),
    sorg_lvl varchar(1),
    sorg varchar(8)
);


CREATE TABLE sandbox.a_payer_rollup_temp
(
    ims_id varchar(10),
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkt_id varchar(4),
    prod_grp varchar(9),
    teva_prod varchar(1),
    SubGroup varchar(1),
    trx_c1 float,
    trx_p1 float,
    trx_c3 float,
    trx_p3 float
);


CREATE TABLE sandbox.a_payer_rollup
(
    ims_id varchar(10),
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkt_id varchar(4),
    prod_grp varchar(9),
    teva_prod varchar(1),
    SubGroup varchar(1),
    trx_c1 float,
    trx_p1 float,
    trx_c3 float,
    trx_p3 float
);


CREATE TABLE sandbox.a_tmp_a
(
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkttrx_c3 float,
    mkttrx_p3 float,
    mkttrx_A_c3 float,
    mkttrx_A_p3 float
);


CREATE TABLE sandbox.a_tmp_b
(
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkttrx_c3 float,
    mkttrx_p3 float,
    mkttrx_A_c3 float,
    mkttrx_A_p3 float,
    Total float,
    RunningTotal float
);


CREATE TABLE sandbox.a_top_plans_rollup
(
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkttrx_c3 float,
    mkttrx_p3 float,
    mkttrx_A_c3 float,
    mkttrx_A_p3 float,
    Total float,
    RunningTotal float
);


CREATE TABLE sandbox.a_plans_by_geo
(
    sorg_lvl varchar(1),
    sorg varchar(8),
    payment_method varchar(250),
    pbm_name varchar(100),
    payer_name varchar(100),
    plan_name varchar(100),
    mkt_id varchar(4),
    prod_grp varchar(9),
    teva_prod varchar(1),
    mkttrx_c3 float,
    Total float,
    mkttrx_p3 float,
    mkttrx_A_c3 float,
    mkttrx_A_p3 float,
    trx_c1 float,
    trx_p1 float,
    trx_c3 float,
    trx_p3 float
);


CREATE TABLE sandbox.override_bridge_ftf_plan_types
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(100),
    iqvia_plan_name_regex varchar(200),
    override_ftf_health_plan_type varchar(100),
    override_precedence int NOT NULL,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (override_bridge_ftf_plan_types.file_id);


CREATE TABLE sandbox.delete_bridge_ftf_plan_types
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(100),
    iqvia_plan_name_regex varchar(200),
    delete_flag varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (delete_bridge_ftf_plan_types.file_id);


CREATE TABLE sandbox.provider_override_default
(
    provider_id varchar(10),
    paytype_regex varchar(100),
    provider_name varchar(100),
    fill_in_iqvia_payer_name_if_no_bridge varchar(100),
    override_best_iqvia_payer varchar(100),
    fill_in_iqvia_pbm_if_no_bridge varchar(100),
    override_best_iqvia_pbm varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (provider_override_default.file_id);


CREATE TABLE sandbox.key_controller_list
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (key_controller_list.file_id);


CREATE TABLE sandbox.presr_rx_resp_07172021
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count numeric(18,3),
    trx_count numeric(18,3),
    nrx_quantity numeric(18,3),
    trx_quantity numeric(18,3),
    unnormalized_nrx_count numeric(18,3),
    unnormalized_trx_count numeric(18,3),
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20),
    pbm_parent_name varchar(100)
);


CREATE TABLE sandbox.sample_table1
(
    a int
);


CREATE TABLE sandbox.vid_npi
(
    vid varchar(25),
    npi_num varchar(15)
);


CREATE TABLE sandbox.key_controller_list_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    key_controlling_parent varchar(100),
    payer_pbm varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (key_controller_list_v1.file_id);


CREATE TABLE sandbox.provider_override_default_v1
(
    provider_id varchar(10),
    paytype_regex varchar(100),
    provider_name varchar(100),
    fill_in_iqvia_payer_name_if_no_bridge varchar(100),
    override_best_iqvia_payer varchar(100),
    fill_in_iqvia_pbm_if_no_bridge varchar(100),
    override_best_iqvia_pbm varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (provider_override_default_v1.file_id);


CREATE TABLE sandbox.teva_iqvia_bridge_v1
(
    iqvia_payer_name varchar(100),
    iqvia_plan_code int,
    iqvia_plan_name varchar(100),
    comments varchar(100),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(100),
    ftf_provider_name varchar(100),
    ftf_health_plan_type varchar(100),
    hp_type varchar(100),
    model varchar(100),
    iqvia_pbm varchar(100),
    iqvia_paytype varchar(50),
    paytype_index varchar(50),
    paytype varchar(50),
    check_pay_types varchar(50),
    check_hp_types varchar(50),
    old_ftf_health_plan_type varchar(50),
    cycle_id int
);


CREATE TABLE sandbox.iqvia_mb_may_v3
(
    iqvia_plan_code varchar(200),
    iqvia_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_fid varchar(200),
    ftf_health_plan_name varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    ajovy_access_for_ftf_plan varchar(200),
    aimovig_access_for_ftf_plan varchar(200),
    emgality_access_for_ftf_plan varchar(200),
    total_lives_for_ftf_plan int,
    key_pbm varchar(200),
    cycle_id int
);


CREATE TABLE sandbox.ftf_restriction_id_group_mapping_v2
(
    restriction_detail_id int,
    restriction_detail_text varchar(15000),
    row_count int,
    restriction_group varchar(15000),
    coverage_cat varchar(1000),
    other_pmf_metrics varchar(1000)
);


CREATE TABLE sandbox.past_mapping_changes
(
    Restrictions varchar(3000),
    Manual_update varchar(3000),
    restrictions_up varchar(3000),
    has_pa int,
    has_st int,
    hasPAST int
);


CREATE TABLE sandbox."digital-affinity"
(
    vid__v int,
    id varchar(50),
    entity_type varchar(50),
    id_type varchar(50)
);


CREATE TABLE sandbox.activity_line_level
(
    activityid varchar(100),
    level varchar(100),
    basket_name varchar(50)
);


CREATE TABLE sandbox.activity_line_item_level
(
    activityid varchar(600),
    level varchar(100)
);


CREATE TABLE sandbox.ic_rx_Feb21
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20),
    outlet_dea varchar(15),
    payer_plan_number varchar(10),
    payment_method varchar(250)
);


CREATE TABLE sandbox.ic_demo_Feb21
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    outlet_dea varchar(15),
    secondary_specialty varchar(255)
);


CREATE TABLE sandbox.act_hub_CSD1015
(
    npi varchar(255),
    activity_id varchar(64),
    federation_id varchar(200),
    contact varchar(200),
    source_name varchar(100),
    "datetime" timestamp,
    trackback_id varchar(200),
    previous_activity varchar(64),
    level_name varchar(64),
    activity_role_name varchar(100),
    type_name varchar(100),
    native_type varchar(200),
    details varchar(200),
    line_item_id varchar(64),
    brand_name varchar(200),
    activity varchar(200),
    line_item_datetime timestamp,
    line_item_previous_line_item varchar(200),
    line_item_trackback_id varchar(200),
    line_item_details varchar(200),
    line_item_type_name varchar(100),
    line_item_native_type varchar(200),
    basket_id varchar(64),
    web_url varchar(5000)
);


CREATE TABLE sandbox.mb_to_monthly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int
);


CREATE TABLE sandbox.health_plan_geography
(
    health_plan_id varchar(10),
    Country_fips_id varchar(10),
    country_id varchar(5),
    country_name varchar(50),
    state_id varchar(2),
    state_name varchar(2),
    country_lives numeric(18,2)
);


CREATE TABLE sandbox.act_hub_CSD1015_nonAustedo
(
    npi varchar(255),
    activity_id varchar(64),
    federation_id varchar(200),
    contact varchar(200),
    source_name varchar(100),
    "datetime" timestamp,
    trackback_id varchar(200),
    previous_activity varchar(64),
    level_name varchar(64),
    activity_role_name varchar(100),
    type_name varchar(100),
    native_type varchar(200),
    details varchar(200),
    line_item_id varchar(64),
    brand_name varchar(200),
    activity varchar(200),
    line_item_datetime timestamp,
    line_item_previous_line_item varchar(200),
    line_item_trackback_id varchar(200),
    line_item_details varchar(200),
    line_item_type_name varchar(100),
    line_item_native_type varchar(200),
    basket_id varchar(64),
    web_url varchar(5000)
);


CREATE TABLE sandbox.Austedo_Enroll
(
    First_name varchar(50),
    Last_name varchar(50),
    NPI varchar(50)
);


CREATE TABLE sandbox.zip_states
(
    ZIP_CODE varchar(10),
    STATE varchar(10)
);


CREATE TABLE sandbox.fcr_summ_0622
(
    rsm_name varchar(121),
    rsm_title varchar(80),
    region_number varchar(26),
    rsm_email varchar(128),
    sales_rep_name varchar(121),
    sales_rep_title varchar(80),
    territory_number varchar(50),
    sales_rep_email varchar(128),
    fcr_date date
);


CREATE TABLE sandbox.payer_test
(
    IMS_ID varchar(50),
    TVCMID int,
    First_Name varchar(50),
    Middle_Name varchar(50),
    Last_Name varchar(50),
    Cred varchar(59),
    Location varchar(112),
    Address_1 varchar(76),
    Address_2 varchar(51),
    City varchar(50),
    State_Code varchar(50),
    Zip_Code varchar(50),
    Zip_Extension varchar(50),
    Telephone varchar(50),
    Alternative_Telephone varchar(50)
);


CREATE TABLE sandbox.ftf_restrictions_v2
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(250),
    restriction_addtnl_information_1 varchar(4000),
    restriction_addtnl_information_2 varchar(4000),
    step_count varchar(50),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255),
    record_id int,
    file_id int
);


CREATE TABLE sandbox.model_paytype_map
(
    model varchar(64),
    paytype varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (model_paytype_map.file_id);


CREATE TABLE sandbox.drug_assignments
(
    drug_id int,
    drug_seq int,
    product varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (drug_assignments.file_id);


CREATE TABLE sandbox.botox_step_restriction
(
    code int,
    restriction_group varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (botox_step_restriction.file_id);


CREATE TABLE sandbox.patient_pa_restriction
(
    code int,
    restriction_detail_id varchar(64),
    notes varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (patient_pa_restriction.file_id);


CREATE TABLE sandbox.Ajovy_Status
(
    file_date timestamp,
    rx_received_date timestamp,
    order_created_date timestamp,
    unique_patient_id varchar(70),
    status varchar(50),
    is_refill varchar(50),
    script_type varchar(50),
    refills_remaining int,
    patient_age int,
    inventory_item_name varchar(60),
    prescriber_npi varchar(50),
    prescriber_full_name varchar(60),
    prescriber_first_name varchar(50),
    prescriber_middle_name varchar(50),
    prescriber_last_name varchar(50),
    prescriber_address varchar(61),
    prescriber_city varchar(50),
    prescriber_state varchar(50),
    prescriber_zip varchar(50),
    primary_payer_name varchar(68),
    primary_payment_type varchar(50),
    primary_benefit_type varchar(50),
    purchase_status varchar(50)
);


CREATE TABLE sandbox.veeva_suggestions
(
    account_priority_score_vod__c int,
    account_vod__c varchar(55),
    display_dismiss_vod__c varchar(10),
    display_mark_as_complete_vod__c varchar(10),
    display_score_vod__c varchar(10),
    email_template_id_vod__c varchar(255),
    email_template_vault_id_vod__c varchar(255),
    email_template_vod__c varchar(10),
    expiration_date_vod__c date,
    marked_as_complete_vod__c varchar(10),
    mark_complete_count_vod__c int,
    name varchar(255),
    ownerid varchar(255),
    posted_date date,
    priority_vod__c varchar(255),
    reason_vod__c varchar(255),
    record_type_name_vod__c varchar(255),
    suppress_reason_vod__c varchar(10),
    title_vod__c varchar(255),
    business_rule_name varchar(255),
    product varchar(255),
    combined_owner_account_key varchar(255),
    days_since_last_call int
);


CREATE TABLE sandbox.fcr_summary_0714
(
    rsm_name varchar(132),
    rsm_title varchar(80),
    region_number varchar(26),
    rsm_email varchar(128),
    sales_rep_name varchar(132),
    sales_rep_title varchar(80),
    territory_number varchar(80),
    sales_rep_email varchar(128),
    fcr_date date
);


CREATE TABLE sandbox."MediCal HCPs"
(
    Region_ID varchar(50),
    Region_Name varchar(53),
    Territory_ID varchar(50),
    Territory_Name varchar(50),
    IMS_ID varchar(50),
    First_Name varchar(50),
    Last_Name varchar(50),
    Specialty_Name varchar(66),
    Specialty_Group varchar(50),
    ACUTE_MIGRAINE numeric(28,10),
    PREVENT_MIGRAINE numeric(28,10),
    "ANTI-CGRP" numeric(28,10),
    AJOVY numeric(28,10)
);


CREATE TABLE sandbox.presr_rx_for_June_ic_07192021
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count numeric(18,3),
    trx_count numeric(18,3),
    nrx_quantity numeric(18,3),
    trx_quantity numeric(18,3),
    unnormalized_nrx_count numeric(18,3),
    unnormalized_trx_count numeric(18,3),
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20),
    pbm_parent_name varchar(100)
);


CREATE TABLE sandbox.license_audits
(
    database_size_bytes int,
    license_size_bytes varchar(20),
    usage_percent float,
    audit_start_timestamp timestamptz,
    audit_end_timestamp timestamptz,
    confidence_level_percent float,
    error_tolerance_percent float,
    used_sampling boolean,
    confidence_interval_lower_bound_bytes int,
    confidence_interval_upper_bound_bytes int,
    sample_count int,
    cell_count int,
    audited_data varchar(128)
);


CREATE TABLE sandbox.query_profiles
(
    session_id varchar(128),
    transaction_id int,
    statement_id int,
    identifier varchar(128),
    node_name varchar(128),
    query varchar(64000),
    query_search_path varchar(64000),
    schema_name varchar(128),
    table_name varchar(128),
    query_duration_us numeric(36,6),
    query_start_epoch int,
    query_start varchar(63),
    query_type varchar(128),
    error_code int,
    user_name varchar(128),
    processed_row_count int,
    reserved_extra_memory_b int,
    is_executing boolean
);


CREATE TABLE sandbox.sessions
(
    node_name varchar(128),
    user_name varchar(128),
    client_hostname varchar(128),
    client_pid int,
    login_timestamp timestamptz,
    session_id varchar(80),
    idle_session_timeout interval,
    grace_period interval,
    client_label varchar(256),
    transaction_start timestamptz,
    transaction_id int,
    transaction_description varchar(8192),
    statement_start timestamptz,
    statement_id int,
    last_statement_duration_us int,
    runtime_priority varchar(8192),
    current_statement varchar(8192),
    last_statement varchar(8192),
    ssl_state varchar(80),
    authentication_method varchar(80),
    client_type varchar(128),
    client_version varchar(128),
    client_os varchar(128),
    client_os_user_name varchar(128),
    client_authentication_name varchar(128),
    client_authentication int,
    requested_protocol varchar(128),
    effective_protocol varchar(128),
    external_memory_kb int
);


CREATE TABLE sandbox.test
(
    tmp varchar(5)
);


CREATE TABLE sandbox.iqvia_payer_paytype_override_v1
(
    iqvia_payer_name varchar(200),
    iqvia_plan_name_regex varchar(200),
    paytype varchar(128),
    file_id int,
    record_id int
);


CREATE TABLE sandbox.iqvia_paytypeindex_v1
(
    paytype_index varchar(64),
    paytype varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_paytypeindex_v1.file_id);


CREATE TABLE sandbox.model_paytype_map_v1
(
    model varchar(64),
    paytype varchar(64),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (model_paytype_map_v1.file_id);


CREATE TABLE sandbox.iqvia_plans_discard_v1
(
    payer_id varchar(64),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (iqvia_plans_discard_v1.file_id);


CREATE TABLE sandbox.ftf_plans_paytypeindex_v1
(
    ftf_health_plantype varchar(64),
    paytype_index int,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_plans_paytypeindex_v1.file_id);


CREATE TABLE sandbox.drug_assignments_v1
(
    drug_id int,
    drug_seq int,
    product varchar(64),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (drug_assignments_v1.file_id);


CREATE TABLE sandbox.botox_step_restriction_v1
(
    code int,
    botox_step_flag varchar(100),
    restriction_group varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (botox_step_restriction_v1.file_id);


CREATE TABLE sandbox.pa_restriction_v1
(
    code int,
    prescriber_prior_authorization_category varchar(100),
    restriction_detail_id varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (pa_restriction_v1.file_id);


CREATE TABLE sandbox.step_restriction_v1
(
    code int,
    step_category varchar(100),
    restriction_group varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (step_restriction_v1.file_id);


CREATE TABLE sandbox.patient_pa_restriction_v1
(
    code int,
    patient_prior_authorization_category varchar(100),
    restriction_detail_id varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (patient_pa_restriction_v1.file_id);


CREATE TABLE sandbox.medical_rec_restriction_v1
(
    code int,
    medical_records_submission_required_flag varchar(100),
    restriction_detail_id varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (medical_rec_restriction_v1.file_id);


CREATE TABLE sandbox.unspecified_rec_restriction_v1
(
    code int,
    unspecified_restriction_flag varchar(100),
    restriction_detail_id varchar(200),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (unspecified_rec_restriction_v1.file_id);


CREATE TABLE sandbox.override_bridge_ftf_plan_types_v1
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(100),
    iqvia_plan_name_regex varchar(200),
    override_ftf_health_plan_type varchar(100),
    override_precedence int NOT NULL,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (override_bridge_ftf_plan_types_v1.file_id);


CREATE TABLE sandbox.delete_bridge_ftf_plan_types_v1
(
    ftf_health_plan_name_regex varchar(200),
    iqvia_payer_name_regex varchar(100),
    iqvia_plan_name_regex varchar(200),
    delete_flag varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (delete_bridge_ftf_plan_types_v1.file_id);


CREATE TABLE sandbox.ftf_pbm_functions_v1
(
    pbm_function_id int,
    pbm_function varchar(100),
    notes varchar(200),
    used int,
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (ftf_pbm_functions_v1.file_id);


CREATE TABLE sandbox.has_st_mapping_v1
(
    has_st int,
    st_regex varchar(100),
    notes varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (has_st_mapping_v1.file_id);


CREATE TABLE sandbox.has_pa_mapping_v1
(
    has_pa int,
    pa_regex varchar(100),
    notes varchar(200),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (has_pa_mapping_v1.file_id);


CREATE TABLE sandbox.calc_pbm_key_pbm_mapping_v1
(
    calculated_pbm varchar(100),
    key_pbm varchar(100),
    added_by varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (calc_pbm_key_pbm_mapping_v1.file_id);


CREATE TABLE sandbox.calculated_pbm_config_v1
(
    ftf_formulary_management_pbm_regex varchar(100),
    ftf_formulary_influencer_pbm_regex varchar(100),
    ftf_claims_processing_pbm_regex varchar(100),
    calculated_pbm_column varchar(100),
    file_id int NOT NULL,
    record_id int
)
PARTITION BY (calculated_pbm_config_v1.file_id);


CREATE TABLE sandbox.raw_ftf_formularies_v2
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    pharmacy_status varchar(20)
);


CREATE TABLE sandbox.raw_ftf_health_plans_v2
(
    formularyf_id varchar(6),
    provider_id varchar(6),
    provider varchar(250),
    health_plan_id varchar(6),
    health_plan varchar(100),
    parent_id varchar(6),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(64)
);


CREATE TABLE sandbox.raw_ftf_health_plan_geography_v2
(
    health_plan_id varchar(6),
    county_fips_id int,
    county_id int,
    county_name varchar(50),
    state_id int,
    state_name varchar(10),
    county_lives numeric(14,2)
);


CREATE TABLE sandbox.raw_ftf_pbms_v2
(
    health_plan_id varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250)
);


CREATE TABLE sandbox.raw_ftf_restrictions_v2
(
    health_plan_id varchar(6),
    drug_id varchar(7),
    restriction_code varchar(20),
    restriction_details_id varchar(6),
    restriction_details_text varchar(500),
    restriction_details_information_1 varchar(4000),
    restriction_details_information_2 varchar(8000),
    step_count varchar(50),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255)
);


CREATE TABLE sandbox.raw_iqvia_plan_v2
(
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(7),
    payer_plan_id varchar(10),
    plan_name varchar(35),
    model varchar(10),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4)
);


CREATE TABLE sandbox.raw_iqvia_pbm_v2
(
    pbm_name varchar(100),
    payer_plan_id varchar(10),
    xref_to_payer_plan_id varchar(10),
    ipd_id varchar(10),
    ipd_type varchar(10),
    plan_name varchar(100),
    pbm_id varchar(10),
    ims_processor_number varchar(10)
);


CREATE TABLE sandbox.raw_teva_ims_bridge_v2
(
    payer_name varchar(200),
    code varchar(10),
    name varchar(50),
    state varchar(5),
    comments varchar(50),
    plan_id varchar(10),
    plan_name varchar(100),
    provider_name varchar(100),
    plan_type_name varchar(20)
);


CREATE TABLE sandbox.payer_spine_iqvia_kcf_level_may
(
    iqvia_plan_code numeric(37,15),
    iqvia_plan_name varchar(500),
    iqvia_payer_name varchar(500),
    iqvia_pbm varchar(500),
    payment_type varchar(500),
    key_controlling_plan_formulary varchar(500),
    key_controlling_account varchar(500),
    ajovy_access_for_ftf_plan varchar(500),
    aimovig_access_for_ftf_plan varchar(500),
    emgality_access_for_ftf_plan varchar(500),
    apportionment_factor numeric(37,15),
    trx numeric(37,15)
);


CREATE TABLE sandbox.saba_mkt_ajovy_payer_spine_prod_list
(
    product_name varchar(200),
    notes varchar(200),
    file_id int,
    record_id int
)
PARTITION BY (saba_mkt_ajovy_payer_spine_prod_list.file_id);


CREATE TABLE sandbox.payer_spine25_detailed_teva_brands
(
    iqvia_plan_code varchar(40),
    iqvia_plan_name varchar(50),
    iqvia_payer_name varchar(50),
    iqvia_pbm varchar(100),
    key_controlling_plan_formulary varchar(200),
    key_controlling_account varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    payment_type varchar(100),
    Ajovy_access_for_ftf_plan varchar(100),
    Aimovig_access_for_ftf_plan varchar(100),
    Emgality_access_for_ftf_plan varchar(100),
    lives_plan_kcf_lvl int,
    lives_plan_lvl int,
    apportionment_factor numeric(36,18),
    saba_trx int,
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.comparison_payer_spine_detailed_kcf
(
    iqvia_plan_code varchar(42),
    iqvia_plan_name varchar(500),
    key_controlling_plan_formulary varchar(500),
    iqvia_payer_name varchar(500),
    iqvia_pbm varchar(500),
    key_controlling_account varchar(500),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    payment_type varchar(500),
    ajovy_access_for_ftf_plan varchar(500),
    aimovig_access_for_ftf_plan varchar(500),
    emgality_access_for_ftf_plan varchar(500),
    apportionment_factor numeric(40,18),
    saba_trx numeric(37,15),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_payment_type int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_apportionment_factor int,
    change_saba_trx int,
    change int,
    month_flag varchar(14),
    status varchar(12),
    cycle_id numeric(18,6),
    modified_time timestamptz(6),
    modified_by varchar(3)
);


CREATE TABLE sandbox.ftf_iqvia_xref_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    xref_iqvia_payer_name varchar(200),
    best_matched_iqvia_payer_name varchar(200),
    xref_iqvia_pbm varchar(200),
    best_matched_iqvia_pbm varchar(200),
    paytype varchar(200),
    model varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(300),
    ftf_health_plan_type varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    ftf_pref_brand_tier int,
    total_lives_for_ftf_plan int,
    key_pbm varchar(300),
    check_iq_payer int,
    check_iq_pbm int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200),
    nurtec_access_for_ftf_plan varchar(300),
    qulipta_access_for_ftf_plan varchar(300),
    austedo_hd_access_for_ftf_plan varchar(200),
    austedo_td_access_for_ftf_plan varchar(200),
    ingrezza_td_access_for_ftf_plan varchar(200)
)
PARTITION BY (ftf_iqvia_xref_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_iqvia_xref_v2_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_health_plan_type varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    ftf_pref_brand_tier int,
    total_lives_for_ftf_plan int,
    key_pbm varchar(300),
    check_iq_payer int,
    check_iq_pbm int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200),
    nurtec_access_for_ftf_plan varchar(300),
    qulipta_access_for_ftf_plan varchar(300),
    austedo_hd_access_for_ftf_plan varchar(200),
    austedo_td_access_for_ftf_plan varchar(200),
    ingrezza_td_access_for_ftf_plan varchar(200)
)
PARTITION BY (ftf_iqvia_xref_v2_cdw_v1.cycle_id);


CREATE TABLE sandbox.comparison_iqvia_fid_plans_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    total_lives_for_ftf_plan int,
    key_pbm varchar(300),
    change_iqvia_plan_code int,
    change_iqvia_plan_name int,
    change_iqvia_payer_name int,
    change_iqvia_pbm int,
    change_payment_type int,
    change_iqvia_model int,
    change_ftf_health_plan_fid int,
    change_ftf_health_plan_name int,
    change_ftf_health_plan_type int,
    change_key_controlling_plan_formulary int,
    change_key_controlling_account int,
    change_key_controlling_parent int,
    change_payer_pbm int,
    change_ajovy_access_for_ftf_plan int,
    change_aimovig_access_for_ftf_plan int,
    change_emgality_access_for_ftf_plan int,
    change_total_lives_for_ftf_plan int,
    change_key_pbm int,
    change int,
    check_iq_payer int,
    check_iq_pbm int,
    change_in_lives numeric(37,15),
    month_flag varchar(200),
    status varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200),
    nurtec_access_for_ftf_plan varchar(300),
    qulipta_access_for_ftf_plan varchar(300),
    change_nurtec_access_for_ftf_plan int,
    change_qulipta_access_for_ftf_plan int
)
PARTITION BY (comparison_iqvia_fid_plans_cdw_v1.cycle_id);


CREATE TABLE sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    payment_type varchar(200),
    iqvia_model varchar(200),
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(300),
    ftf_health_plan_type varchar(200),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    total_lives_for_ftf_plan int,
    key_pbm varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200),
    nurtec_access_for_ftf_plan varchar(300),
    qulipta_access_for_ftf_plan varchar(300),
    austedo_hd_access_for_ftf_plan varchar(200),
    austedo_td_access_for_ftf_plan varchar(200),
    ingrezza_td_access_for_ftf_plan varchar(200)
);


CREATE TABLE sandbox.key_ctl_account_summary_cdw_v1
(
    paytype varchar(200),
    ftf_health_plan_type varchar(300),
    key_controlling_account varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (key_ctl_account_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.key_pbm_summary_cdw_v1
(
    paytype varchar(200),
    ftf_health_plan_type varchar(300),
    key_pbm varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (key_pbm_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.iqvia_payer_name_summary_cdw_v1
(
    paytype varchar(300),
    iqvia_payer_name varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (iqvia_payer_name_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.iqvia_pbm_summary_cdw_v1
(
    paytype varchar(300),
    iqvia_pbm varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (iqvia_pbm_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_formulary_management_pbm_summary_cdw_v1
(
    paytype varchar(300),
    ftf_formulary_management_pbm varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_formulary_management_pbm_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_formulary_influencer_pbm_summary_cdw_v1
(
    paytype varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_claims_processing_pbm_summary_cdw_v1
(
    paytype varchar(300),
    ftf_claims_processing_pbm varchar(300),
    current_month_lives int,
    previous_month_lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_claims_processing_pbm_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_hp_id_key_controlling_account_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(300),
    ftf_provider_name varchar(300),
    payment_type varchar(300),
    key_controlling_account varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    key_pbm varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_hp_id_key_controlling_account_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_hp_id_key_pbm_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(300),
    ftf_provider_name varchar(300),
    payment_type varchar(300),
    key_pbm varchar(300),
    assigned_iqvia_pbm varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_hp_id_key_pbm_cdw_v1.cycle_id);


CREATE TABLE sandbox.ftf_plan_master_file_op_cdw_v1
(
    ftf_health_plan_fid int,
    product varchar(200),
    ftf_health_plan_name varchar(300),
    coverage_category varchar(300),
    ftf_provider_name varchar(300),
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    plan_lives int,
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    key_pbm varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    pref_brand_tier int,
    pharmacy_status varchar(300),
    ftf_tier varchar(300),
    restrictions varchar(300),
    copay_tier varchar(300),
    restriction_category varchar(300),
    step varchar(300),
    botox varchar(300),
    prescriber_pa varchar(300),
    patient_pa varchar(300),
    medical_records varchar(300),
    criteria_unspec varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (ftf_plan_master_file_op_cdw_v1.cycle_id);


CREATE TABLE sandbox.st_lives_summary_cdw_v1
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(300),
    ftf_provider_name varchar(300),
    ftf_parent_name varchar(300),
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    key_controlling_account varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    key_pbm varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    state varchar(200),
    ftf_state_hp_lives int,
    pref_brand_tier int,
    ajovy_formulary varchar(300),
    aimovig_formulary varchar(300),
    emgality_formulary varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (st_lives_summary_cdw_v1.cycle_id);


CREATE TABLE sandbox.paytype_product_coverage_category_cdw_v1
(
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (paytype_product_coverage_category_cdw_v1.cycle_id);


CREATE TABLE sandbox.paytype_product_copay_tier_cdw_v1
(
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (paytype_product_copay_tier_cdw_v1.cycle_id);


CREATE TABLE sandbox.paytype_product_step_category_cdw_v1
(
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (paytype_product_step_category_cdw_v1.cycle_id);


CREATE TABLE sandbox.paytype_product_patient_pa_cdw_v1
(
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (paytype_product_patient_pa_cdw_v1.cycle_id);


CREATE TABLE sandbox.key_controlling_account_product_cov_category_paytype_cdw_v1
(
    key_controlling_account varchar(300),
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id);


CREATE TABLE sandbox.key_pbm_product_cov_category_paytype_cdw_v1
(
    key_pbm varchar(300),
    paytype varchar(300),
    product varchar(300),
    metric varchar(300),
    lives int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (key_pbm_product_cov_category_paytype_cdw_v1.cycle_id);


CREATE TABLE sandbox.payer_spine25_detailed_teva_brands_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    payment_type varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    lives_plan_kcf_lvl int,
    lives_plan_lvl int,
    apportionment_factor numeric(37,15),
    saba_trx numeric(37,15),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (payer_spine25_detailed_teva_brands_cdw_v1.cycle_id);


CREATE TABLE sandbox.payer_spine25_plan_teva_brands_cdw_v1
(
    iqvia_plan_code int,
    iqvia_plan_name varchar(300),
    iqvia_payer_name varchar(300),
    iqvia_pbm varchar(300),
    key_controlling_plan_formulary varchar(300),
    key_controlling_account varchar(300),
    key_controlling_parent varchar(300),
    payer_pbm varchar(300),
    payment_type varchar(300),
    ajovy_access_for_ftf_plan varchar(300),
    aimovig_access_for_ftf_plan varchar(300),
    emgality_access_for_ftf_plan varchar(300),
    lives_plan_kcf_lvl int,
    lives_plan_lvl int,
    apportionment_factor numeric(37,15),
    saba_trx numeric(37,15),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(200)
)
PARTITION BY (payer_spine25_plan_teva_brands_cdw_v1.cycle_id);


CREATE TABLE sandbox.tp_pre_calls_anti_psych
(
    sales_force_id varchar(2),
    nation_id varchar(10),
    area_id varchar(10),
    region_id varchar(10),
    territory_id varchar(10),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(75),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank varchar(1),
    prescriber_name varchar(102),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(100),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    target_status_flag varchar(1),
    partner_target_status_flag varchar(1),
    method_of_payment varchar(250),
    pri_specialty_code varchar(10),
    segment varchar(1),
    decile varchar(1),
    market_volume_indicator varchar(1),
    product_vol_trx_count float,
    market_vol_trx_count float,
    prev_prod_vol_trx_count float,
    prev_market_vol_trx_count float,
    product_vol_nrx_count float,
    market_vol_nrx_count float,
    prev_prod_vol_nrx_count float,
    prev_market_vol_nrx_count float,
    samples varchar(1),
    details_p1 varchar(1),
    details_p2 varchar(1),
    details_p3 varchar(1),
    focus_target varchar(1)
);


CREATE TEMPORARY TABLE sandbox.tmp_region_area_c_new
(
    territory_number varchar(8),
    area_number varchar(8),
    region_number varchar(8)
) ON COMMIT PRESERVE ROWS NO PROJECTION;


CREATE TABLE sandbox.grouped_restid_mapping_control
(
    restriction_detail_id int,
    restriction_detail_text varchar(15000),
    row_count int,
    restriction_group varchar(15000),
    coverage_cat varchar(3000),
    other_pmf_metrics varchar(3000)
);


CREATE TABLE sandbox.grouped_rest_ranking_control
(
    restriction_group varchar(5000),
    rank_rest_grp int
);


CREATE TABLE sandbox.ftf_formularies_preprocessed_cdw_v3
(
    drug_seq int,
    ftf_health_plan_fid int,
    drug_id int,
    tier_code varchar(200),
    restrictions varchar(500),
    reason_code varchar(200),
    reason_code_description varchar(5000),
    pharmacy_status varchar(500),
    Market_Access_Coverage varchar(500),
    has_pa int,
    has_st int,
    hasPAST int,
    plan_lives int,
    check_blank_pharmstat varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_formularies_preprocessed_cdw_v3.cycle_id);


CREATE TABLE sandbox.ftf_restrictions_preprocessed_cdw_v4
(
    health_plan_id int,
    drug_id int,
    drug_seq int,
    restriction_code varchar(500),
    restriction_detail_id varchar(500),
    restriction_detail_text varchar(30000),
    restriction_group varchar(12000),
    coverage_cat varchar(500),
    other_pmf_metrics varchar(500),
    rank_rest_grp int,
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
)
PARTITION BY (ftf_restrictions_preprocessed_cdw_v4.cycle_id);


CREATE TABLE sandbox.plan_prod_master_cdw_v2
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    calculated_pbm_value varchar(300),
    key_pbm varchar(300),
    drug_id int,
    drug_seq int,
    tier_code varchar(300),
    restrictions varchar(300),
    reason_code varchar(300),
    pharmacy_status varchar(300),
    Market_Access_Coverage varchar(300),
    has_pa int,
    has_st int,
    hasPAST int,
    botox int,
    step int,
    pres_pa int,
    pat_pa int,
    med_rec int,
    unspec int,
    restriction_code varchar(500),
    restriction_detail_id varchar(500),
    restriction_detail_text varchar(30000),
    restriction_group varchar(12000),
    ref_coverage_cat varchar(500),
    other_pmf_metrics varchar(500),
    calc_coverage_cat varchar(300),
    copay_tier varchar(200),
    tier_cat int,
    restcat int,
    restriction_category varchar(200),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
);


CREATE TABLE sandbox.ftf_plan_master_file_cdw_v2
(
    ftf_health_plan_fid int,
    ftf_health_plan_name varchar(200),
    ftf_provider_fid int,
    ftf_provider_name varchar(200),
    ftf_parent_name varchar(200),
    paytype_index int,
    paytype varchar(200),
    ftf_health_plan_type varchar(200),
    pref_brand_tier int,
    fillIn_blank_iqpayer int,
    fillIn_blank_iqpbm int,
    ftf_match_iqvia int,
    iqvia_payer_name varchar(200),
    iqvia_pbm varchar(200),
    ftf_formulary_management_pbm varchar(300),
    ftf_formulary_influencer_pbm varchar(300),
    ftf_claims_processing_pbm varchar(300),
    lives_mn int,
    calculated_pbm_value varchar(300),
    key_pbm varchar(300),
    drug_id int,
    drug_seq int,
    product varchar(200),
    tier_code varchar(200),
    restrictions varchar(200),
    reason_code varchar(200),
    pharmacy_status varchar(200),
    Market_Access_Coverage varchar(300),
    has_pa int,
    has_st int,
    hasPAST int,
    botox int,
    botox_step_flag varchar(200),
    step int,
    step_category varchar(200),
    pres_pa int,
    prescriber_prior_authorization_category varchar(200),
    pat_pa int,
    patient_prior_authorization_category varchar(200),
    med_rec int,
    medical_records_submission_required_flag varchar(100),
    unspec int,
    unspecified_restriction_flag varchar(100),
    copay_Tier varchar(200),
    restriction_code varchar(500),
    restriction_detail_id varchar(500),
    restriction_detail_text varchar(30000),
    restriction_group varchar(12000),
    ref_coverage_cat varchar(500),
    other_pmf_metrics varchar(500),
    calc_coverage_cat varchar(300),
    restriction_category varchar(200),
    tier_cat int,
    restcat int,
    key_controlling_account varchar(200),
    key_controlling_plan_formulary varchar(200),
    key_controlling_parent varchar(200),
    payer_pbm varchar(200),
    market_access_cvg_w_overides varchar(300),
    calc_coverage_cat_w_overrides varchar(300),
    cycle_id int,
    modified_time timestamp,
    modified_by varchar(100)
);


CREATE TABLE sandbox.LAI_monthly_prescriber_summary
(
    sales_force_id varchar(200),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(200),
    period varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(200),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(200),
    prescriber_name varchar(102),
    new_prescriber varchar(1),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    target_status_flag varchar(1),
    partner_target_status_flag varchar(1),
    method_of_payment varchar(200),
    specialty varchar(25),
    segment varchar(200),
    decile varchar(200),
    market_volume_indicator int,
    product_vol_trx_count numeric(37,15),
    market_vol_trx_count numeric(37,15),
    prev_prod_vol_trx_count numeric(37,15),
    prev_market_vol_trx_count numeric(37,15),
    product_vol_nrx_count numeric(37,15),
    market_vol_nrx_count numeric(37,15),
    prev_prod_vol_nrx_count numeric(37,15),
    prev_market_vol_nrx_count numeric(37,15),
    samples numeric(37,15),
    details_p1 numeric(37,15),
    details_p2 numeric(37,15),
    details_p3 numeric(37,15),
    GPO varchar(100),
    GPO_1 varchar(100),
    refresh_month varchar(100)
);


CREATE TABLE sandbox.tmp_trend_rows_combined
(
    customer_id varchar(25)
);


CREATE TABLE sandbox.call_check
(
    id varchar(18),
    ownerid varchar(18),
    isdeleted varchar(5),
    name varchar(80),
    recordtypeid varchar(18),
    createddate timestamptz,
    createdbyid varchar(18),
    lastmodifieddate timestamptz,
    lastmodifiedbyid varchar(18),
    systemmodstamp timestamptz,
    lastactivitydate date,
    mayedit varchar(5),
    islocked varchar(5),
    lastvieweddate timestamptz,
    lastreferenceddate timestamptz,
    sample_card_vod__c varchar(15),
    add_detail_vod__c varchar(1000),
    property_vod__c varchar(64),
    account_vod__c varchar(18),
    zvod_product_discussion_vod__c varchar(5),
    status_vod__c varchar(255),
    parent_address_vod__c varchar(18),
    account_plan_vod__c varchar(18),
    zvod_savenew_vod__c varchar(5),
    next_call_notes_vod__c varchar(255),
    mobile_id_vod__c varchar(100),
    zvod_account_credentials_vod_c varchar(5),
    zvod_account_preferred_name_vo varchar(5),
    zvod_account_sample_status_vod varchar(5),
    zvod_attendees_vod__c varchar(5),
    zvod_key_messages_vod__c varchar(5),
    zvod_detailing_vod__c varchar(5),
    zvod_expenses_vod__c varchar(5),
    zvod_followup_vod__c varchar(5),
    zvod_samples_vod__c varchar(5),
    zvod_save_vod__c varchar(5),
    zvod_submit_vod__c varchar(5),
    zvod_delete_vod__c varchar(5),
    activity_type__c varchar(255),
    significant_event__c varchar(5),
    location_vod__c varchar(128),
    subject_vod__c varchar(128),
    call_datetime_vod__c timestamptz,
    disbursed_to_vod__c varchar(255),
    request_receipt_vod__c varchar(5),
    signature_date_vod__c timestamptz,
    territory_vod__c varchar(100),
    submitted_by_mobile_vod__c varchar(5),
    call_type_vod__c varchar(255),
    add_key_message_vod__c varchar(4000),
    address_vod__c varchar(500),
    attendees_vod__c varchar(64),
    attendee_type_vod__c varchar(255),
    call_date_vod__c date,
    detailed_products_vod__c varchar(255),
    no_disbursement_vod__c varchar(5),
    parent_call_vod__c varchar(18),
    user_vod__c varchar(18),
    contact_vod__c varchar(18),
    zvod_entity_vod__c varchar(5),
    medical_event_vod__c varchar(18),
    mobile_created_datetime_vod__c timestamptz,
    mobile_last_modified_datetime timestamptz,
    license_vod__c varchar(25),
    is_parent_call_vod__c varchar(64),
    entity_display_name_vod__c varchar(1300),
    last_device_vod__c varchar(255),
    ship_address_line_1_vod__c varchar(80),
    ship_address_line_2_vod__c varchar(100),
    ship_city_vod__c varchar(40),
    ship_country_vod__c varchar(20),
    ship_license_expiration_date date,
    ship_license_status_vod__c varchar(25),
    ship_license_vod__c varchar(25),
    ship_state_vod__c varchar(30),
    ship_to_address_vod__c varchar(18),
    ship_zip_vod__c varchar(20),
    ship_to_address_text_vod__c varchar(1300),
    clm_vod__c varchar(5),
    zvod_clmdetails_vod__c varchar(5),
    is_sampled_call_vod__c varchar(5),
    zvod_surveys_vod__c varchar(5),
    presentations_vod__c varchar(500),
    entity_reference_id_vod__c varchar(100),
    error_reference_call_vod__c varchar(18),
    duration_vod__c varchar(64),
    color_vod__c varchar(255),
    allowed_products_vod__c varchar(1000),
    zvod_attachments_vod__c varchar(5),
    sample_card_reason_vod__c varchar(255),
    assmca_vod__c varchar(100),
    address_line_1_vod__c varchar(80),
    address_line_2_vod__c varchar(100),
    city_vod__c varchar(40),
    dea_address_line_1_vod__c varchar(80),
    dea_address_line_2_vod__c varchar(100),
    dea_address_vod__c varchar(18),
    dea_city_vod__c varchar(40),
    dea_expiration_date_vod__c date,
    dea_state_vod__c varchar(10),
    dea_zip_4_vod__c varchar(4),
    dea_zip_vod__c varchar(20),
    dea_vod__c varchar(9),
    ship_zip_4_vod__c varchar(4),
    state_vod__c varchar(10),
    zip_4_vod__c varchar(4),
    zip_vod__c varchar(20),
    sample_send_card_vod__c varchar(15),
    zvod_address_vod_c_dea_status_ varchar(5),
    signature_page_image_vod__c varchar(255),
    credentials_vod__c varchar(255),
    salutation_vod__c varchar(255),
    zvod_account_call_reminder_vod varchar(5),
    sales_org_tva__c varchar(1300),
    zvod_business_account_vod__c varchar(5),
    product_priority_1_vod__c varchar(18),
    product_priority_2_vod__c varchar(18),
    product_priority_3_vod__c varchar(18),
    product_priority_4_vod__c varchar(18),
    product_priority_5_vod__c varchar(18),
    zvod_more_actions_vod__c varchar(5),
    zvod_call_conflict_status varchar(5),
    signature_timestamp_vod__c varchar(64),
    expense_amount_vod__c varchar(64),
    total_expense_attendees_count varchar(64),
    attendee_list_vod__c varchar(4000),
    expense_post_status_vod__c varchar(10),
    attendee_post_status_vod__c varchar(10),
    expense_system_external_id varchar(255),
    incurred_expense_vod__c varchar(5),
    assigner_vod__c varchar(18),
    assignment_datetime_vod__c timestamptz,
    zvod_call_objective_vod__c varchar(5),
    signature_location_longitude varchar(64),
    signature_location_latitude varchar(64),
    location_services_status varchar(255),
    created_by_timezone_tva__c varchar(120),
    license_expiration_date_vod__c date,
    license_status_vod__c varchar(255),
    ship_assmca_vod__c varchar(100),
    ship_dea_expiration_date date,
    ship_dea_vod__c varchar(9),
    call_method_tva__c varchar(255),
    bendeka_indication_tva__c varchar(5000),
    file_id int,
    record_id int,
    austedo_indication_tva__c varchar(5000),
    call_duration_tva__c numeric(3,0),
    how_executed_tva__c varchar(40),
    Remote_Meeting_vod__c varchar(100),
    Veeva_Remote_Meeting_Id_vod__c varchar(20),
    Cobrowse_URL_Participant_vod__c varchar(255),
    Signature_Captured_Remotely_vod__c varchar(150),
    Remote_Signature_Attendee_Name_vod__c varchar(5),
    t21s10_austedo_indication_tva__c varchar(255),
    row_num int
);


CREATE PROJECTION sandbox.ic_target_b0 /*+basename(ic_target),createtype(L)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 row_create_date
)
AS
 SELECT ic_target.ic_data_month,
        ic_target.basket_name,
        ic_target.sales_force_id,
        ic_target.area_number,
        ic_target.region_number,
        ic_target.territory_number,
        ic_target.ims_id,
        ic_target.tvcmid,
        ic_target.row_create_date
 FROM sandbox.ic_target
 ORDER BY ic_target.ims_id,
          ic_target.tvcmid,
          ic_target.territory_number
SEGMENTED BY hash(ic_target.ims_id, ic_target.tvcmid, ic_target.territory_number) ALL NODES;

CREATE PROJECTION sandbox.ic_goal_setting_b0 /*+basename(ic_goal_setting),createtype(L)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 market_rolling_6,
 product_rolling_6,
 market_rolling_12,
 market_baseline,
 product_baseline,
 target_market_rolling_6,
 target_product_rolling_6,
 target_market_rolling_12,
 target_market_baseline,
 target_product_baseline,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_goal_setting.ic_data_month,
        ic_goal_setting.basket_name,
        ic_goal_setting.sales_force_id,
        ic_goal_setting.area_number,
        ic_goal_setting.region_number,
        ic_goal_setting.territory_number,
        ic_goal_setting.ims_id,
        ic_goal_setting.tvcmid,
        ic_goal_setting.outlet_code,
        ic_goal_setting.va_station_number,
        ic_goal_setting.dnc_flag,
        ic_goal_setting.dnp_flag,
        ic_goal_setting.market_rolling_6,
        ic_goal_setting.product_rolling_6,
        ic_goal_setting.market_rolling_12,
        ic_goal_setting.market_baseline,
        ic_goal_setting.product_baseline,
        ic_goal_setting.target_market_rolling_6,
        ic_goal_setting.target_product_rolling_6,
        ic_goal_setting.target_market_rolling_12,
        ic_goal_setting.target_market_baseline,
        ic_goal_setting.target_product_baseline,
        ic_goal_setting.include_in_nation_rollup,
        ic_goal_setting.include_in_area_rollup,
        ic_goal_setting.include_in_region_rollup,
        ic_goal_setting.join_key,
        ic_goal_setting.row_source,
        ic_goal_setting.row_create_date
 FROM sandbox.ic_goal_setting
 ORDER BY ic_goal_setting.ic_data_month,
          ic_goal_setting.sales_force_id,
          ic_goal_setting.area_number,
          ic_goal_setting.region_number,
          ic_goal_setting.territory_number,
          ic_goal_setting.ims_id,
          ic_goal_setting.tvcmid,
          ic_goal_setting.outlet_code,
          ic_goal_setting.va_station_number,
          ic_goal_setting.dnp_flag,
          ic_goal_setting.join_key,
          ic_goal_setting.row_source
SEGMENTED BY hash(ic_goal_setting.ic_data_month, ic_goal_setting.sales_force_id, ic_goal_setting.area_number, ic_goal_setting.region_number, ic_goal_setting.territory_number, ic_goal_setting.ims_id, ic_goal_setting.tvcmid, ic_goal_setting.outlet_code, ic_goal_setting.va_station_number, ic_goal_setting.dnp_flag, ic_goal_setting.join_key, ic_goal_setting.row_source) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_DIAGNOSIS_b0 /*+basename(STG_LAAD_DIAGNOSIS),createtype(L)*/ 
(
 CLAIM_ID,
 PATIENT_ID,
 SERVICE_DATE,
 DIAGNOSIS_CODE,
 RENDERING_PRESCRIBER_ID,
 REFERRING_PRESCRIBER_ID
)
AS
 SELECT STG_LAAD_DIAGNOSIS.CLAIM_ID,
        STG_LAAD_DIAGNOSIS.PATIENT_ID,
        STG_LAAD_DIAGNOSIS.SERVICE_DATE,
        STG_LAAD_DIAGNOSIS.DIAGNOSIS_CODE,
        STG_LAAD_DIAGNOSIS.RENDERING_PRESCRIBER_ID,
        STG_LAAD_DIAGNOSIS.REFERRING_PRESCRIBER_ID
 FROM sandbox.STG_LAAD_DIAGNOSIS
 ORDER BY STG_LAAD_DIAGNOSIS.CLAIM_ID,
          STG_LAAD_DIAGNOSIS.PATIENT_ID,
          STG_LAAD_DIAGNOSIS.SERVICE_DATE,
          STG_LAAD_DIAGNOSIS.DIAGNOSIS_CODE,
          STG_LAAD_DIAGNOSIS.RENDERING_PRESCRIBER_ID,
          STG_LAAD_DIAGNOSIS.REFERRING_PRESCRIBER_ID
SEGMENTED BY hash(STG_LAAD_DIAGNOSIS.SERVICE_DATE, STG_LAAD_DIAGNOSIS.CLAIM_ID, STG_LAAD_DIAGNOSIS.PATIENT_ID, STG_LAAD_DIAGNOSIS.RENDERING_PRESCRIBER_ID, STG_LAAD_DIAGNOSIS.REFERRING_PRESCRIBER_ID, STG_LAAD_DIAGNOSIS.DIAGNOSIS_CODE) ALL NODES;

CREATE PROJECTION sandbox.load_bag_territory_b0 /*+basename(load_bag_territory),createtype(L)*/ 
(
 territory_number,
 bag_name
)
AS
 SELECT load_bag_territory.territory_number,
        load_bag_territory.bag_name
 FROM sandbox.load_bag_territory
 ORDER BY load_bag_territory.territory_number,
          load_bag_territory.bag_name
SEGMENTED BY hash(load_bag_territory.territory_number, load_bag_territory.bag_name) ALL NODES;

CREATE PROJECTION sandbox.call_plan_decile_b0 /*+basename(call_plan_decile),createtype(L)*/ 
(
 hcp_id,
 market,
 decile_value,
 veeva_id
)
AS
 SELECT call_plan_decile.hcp_id,
        call_plan_decile.market,
        call_plan_decile.decile_value,
        call_plan_decile.veeva_id
 FROM sandbox.call_plan_decile
 ORDER BY call_plan_decile.hcp_id,
          call_plan_decile.market,
          call_plan_decile.decile_value
SEGMENTED BY hash(call_plan_decile.hcp_id, call_plan_decile.market, call_plan_decile.decile_value) ALL NODES;

CREATE PROJECTION sandbox.tmp_file_id_purge_b0 /*+basename(tmp_file_id_purge),createtype(A)*/ 
(
 file_id,
 feed_id
)
AS
 SELECT tmp_file_id_purge.file_id,
        tmp_file_id_purge.feed_id
 FROM sandbox.tmp_file_id_purge
 ORDER BY tmp_file_id_purge.file_id,
          tmp_file_id_purge.feed_id
SEGMENTED BY hash(tmp_file_id_purge.file_id, tmp_file_id_purge.feed_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_file_id_b0 /*+basename(tmp_file_id),createtype(A)*/ 
(
 file_id,
 feed_id
)
AS
 SELECT tmp_file_id.file_id,
        tmp_file_id.feed_id
 FROM sandbox.tmp_file_id
 ORDER BY tmp_file_id.file_id,
          tmp_file_id.feed_id
SEGMENTED BY hash(tmp_file_id.file_id, tmp_file_id.feed_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_445_1_md_b0 /*+basename(tmp_445_1_md),createtype(A)*/ 
(
 bucket_date,
 start_date,
 end_date,
 bucket_type,
 rollup_445
)
AS
 SELECT tmp_445_1_md.bucket_date,
        tmp_445_1_md.start_date,
        tmp_445_1_md.end_date,
        tmp_445_1_md.bucket_type,
        tmp_445_1_md.rollup_445
 FROM sandbox.tmp_445_1_md
 ORDER BY tmp_445_1_md.bucket_date,
          tmp_445_1_md.start_date,
          tmp_445_1_md.end_date,
          tmp_445_1_md.bucket_type,
          tmp_445_1_md.rollup_445
SEGMENTED BY hash(tmp_445_1_md.bucket_date, tmp_445_1_md.start_date, tmp_445_1_md.end_date, tmp_445_1_md.bucket_type, tmp_445_1_md.rollup_445) ALL NODES;

CREATE PROJECTION sandbox.tmp_445_2_md_b0 /*+basename(tmp_445_2_md),createtype(A)*/ 
(
 bucket_date,
 start_date,
 end_date,
 bucket_type,
 rollup_445
)
AS
 SELECT tmp_445_2_md.bucket_date,
        tmp_445_2_md.start_date,
        tmp_445_2_md.end_date,
        tmp_445_2_md.bucket_type,
        tmp_445_2_md.rollup_445
 FROM sandbox.tmp_445_2_md
 ORDER BY tmp_445_2_md.bucket_date,
          tmp_445_2_md.start_date,
          tmp_445_2_md.end_date,
          tmp_445_2_md.bucket_type,
          tmp_445_2_md.rollup_445
SEGMENTED BY hash(tmp_445_2_md.bucket_date, tmp_445_2_md.start_date, tmp_445_2_md.end_date, tmp_445_2_md.bucket_type, tmp_445_2_md.rollup_445) ALL NODES;

CREATE PROJECTION sandbox.tmp_445_md_b0 /*+basename(tmp_445_md),createtype(A)*/ 
(
 bucket_date,
 start_date,
 end_date,
 bucket_type,
 rollup_445
)
AS
 SELECT tmp_445_md.bucket_date,
        tmp_445_md.start_date,
        tmp_445_md.end_date,
        tmp_445_md.bucket_type,
        tmp_445_md.rollup_445
 FROM sandbox.tmp_445_md
 ORDER BY tmp_445_md.bucket_date,
          tmp_445_md.start_date,
          tmp_445_md.end_date,
          tmp_445_md.bucket_type,
          tmp_445_md.rollup_445
SEGMENTED BY hash(tmp_445_md.bucket_date, tmp_445_md.start_date, tmp_445_md.end_date, tmp_445_md.bucket_type, tmp_445_md.rollup_445) ALL NODES;

CREATE PROJECTION sandbox.tmp_ddd_md_b0 /*+basename(tmp_ddd_md),createtype(A)*/ 
(
 onc_account_demo_id,
 alt_seq_num,
 outlet_name,
 outlet_code,
 ims_facility_number,
 ims_prescriber_number,
 subcategory_code,
 outlet_zip,
 ims_client_num,
 ims_report_num,
 report_frequency,
 ims_product_code,
 basket_id,
 basket_name,
 data_date,
 date,
 rollup_week,
 rollup_month,
 rollup_445,
 comp_month,
 quantity,
 dollars,
 sales_force_id,
 file_id,
 record_id,
 tvcmid,
 outlet_tvcmid,
 facility_tvcmid,
 prescriber_tvcmid
)
AS
 SELECT tmp_ddd_md.onc_account_demo_id,
        tmp_ddd_md.alt_seq_num,
        tmp_ddd_md.outlet_name,
        tmp_ddd_md.outlet_code,
        tmp_ddd_md.ims_facility_number,
        tmp_ddd_md.ims_prescriber_number,
        tmp_ddd_md.subcategory_code,
        tmp_ddd_md.outlet_zip,
        tmp_ddd_md.ims_client_num,
        tmp_ddd_md.ims_report_num,
        tmp_ddd_md.report_frequency,
        tmp_ddd_md.ims_product_code,
        tmp_ddd_md.basket_id,
        tmp_ddd_md.basket_name,
        tmp_ddd_md.data_date,
        tmp_ddd_md.date,
        tmp_ddd_md.rollup_week,
        tmp_ddd_md.rollup_month,
        tmp_ddd_md.rollup_445,
        tmp_ddd_md.comp_month,
        tmp_ddd_md.quantity,
        tmp_ddd_md.dollars,
        tmp_ddd_md.sales_force_id,
        tmp_ddd_md.file_id,
        tmp_ddd_md.record_id,
        tmp_ddd_md.tvcmid,
        tmp_ddd_md.outlet_tvcmid,
        tmp_ddd_md.facility_tvcmid,
        tmp_ddd_md.prescriber_tvcmid
 FROM sandbox.tmp_ddd_md
 ORDER BY tmp_ddd_md.onc_account_demo_id,
          tmp_ddd_md.alt_seq_num,
          tmp_ddd_md.outlet_name,
          tmp_ddd_md.outlet_code,
          tmp_ddd_md.ims_facility_number,
          tmp_ddd_md.ims_prescriber_number,
          tmp_ddd_md.subcategory_code,
          tmp_ddd_md.outlet_zip,
          tmp_ddd_md.ims_client_num,
          tmp_ddd_md.ims_report_num,
          tmp_ddd_md.report_frequency,
          tmp_ddd_md.ims_product_code,
          tmp_ddd_md.basket_id,
          tmp_ddd_md.basket_name,
          tmp_ddd_md.data_date,
          tmp_ddd_md.date,
          tmp_ddd_md.rollup_week,
          tmp_ddd_md.rollup_month,
          tmp_ddd_md.rollup_445,
          tmp_ddd_md.comp_month,
          tmp_ddd_md.quantity,
          tmp_ddd_md.dollars,
          tmp_ddd_md.sales_force_id,
          tmp_ddd_md.file_id,
          tmp_ddd_md.record_id,
          tmp_ddd_md.tvcmid,
          tmp_ddd_md.outlet_tvcmid,
          tmp_ddd_md.facility_tvcmid,
          tmp_ddd_md.prescriber_tvcmid
SEGMENTED BY hash(tmp_ddd_md.record_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_qty_file_id_adhoc1_ad_b0 /*+basename(tmp_qty_file_id_adhoc1_ad),createtype(A)*/ 
(
 file_id
)
AS
 SELECT tmp_qty_file_id_adhoc1_ad.file_id
 FROM sandbox.tmp_qty_file_id_adhoc1_ad
 ORDER BY tmp_qty_file_id_adhoc1_ad.file_id
SEGMENTED BY hash(tmp_qty_file_id_adhoc1_ad.file_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_cnt_file_id_adhoc1_ad_b0 /*+basename(tmp_cnt_file_id_adhoc1_ad),createtype(A)*/ 
(
 file_id
)
AS
 SELECT tmp_cnt_file_id_adhoc1_ad.file_id
 FROM sandbox.tmp_cnt_file_id_adhoc1_ad
 ORDER BY tmp_cnt_file_id_adhoc1_ad.file_id
SEGMENTED BY hash(tmp_cnt_file_id_adhoc1_ad.file_id) ALL NODES;

CREATE PROJECTION sandbox.oncology_detail_goals_b0 /*+basename(oncology_detail_goals),createtype(L)*/ 
(
 territory_number,
 bendeka_quota,
 granix_quota
)
AS
 SELECT oncology_detail_goals.territory_number,
        oncology_detail_goals.bendeka_quota,
        oncology_detail_goals.granix_quota
 FROM sandbox.oncology_detail_goals
 ORDER BY oncology_detail_goals.territory_number,
          oncology_detail_goals.bendeka_quota,
          oncology_detail_goals.granix_quota
SEGMENTED BY hash(oncology_detail_goals.territory_number, oncology_detail_goals.bendeka_quota, oncology_detail_goals.granix_quota) ALL NODES;

CREATE PROJECTION sandbox.ic_decile_b0 /*+basename(ic_decile),createtype(L)*/ 
(
 ic_data_month,
 ims_id,
 tvcmid,
 decile_name,
 decile_value,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_decile.ic_data_month,
        ic_decile.ims_id,
        ic_decile.tvcmid,
        ic_decile.decile_name,
        ic_decile.decile_value,
        ic_decile.join_key,
        ic_decile.row_source,
        ic_decile.row_create_date
 FROM sandbox.ic_decile
 ORDER BY ic_decile.ims_id
SEGMENTED BY hash(ic_decile.ic_data_month, ic_decile.tvcmid, ic_decile.decile_value, ic_decile.row_create_date, ic_decile.ims_id, ic_decile.join_key, ic_decile.row_source, ic_decile.decile_name) ALL NODES;

CREATE PROJECTION sandbox.scd_sfa_demographics_b0 /*+basename(scd_sfa_demographics),createtype(L)*/ 
(
 scd_status,
 scd_effective_date,
 scd_expiration_date,
 veeva_account_id,
 sales_force_id,
 customer_type,
 ims_id,
 npi,
 ims_outlet_code,
 territory_number,
 territory_type,
 territory_status,
 last_name,
 first_name,
 middle_name,
 suffix_name,
 credentials,
 organization_name,
 veeva_address_id,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 address_status,
 phone,
 phone_ext,
 fax,
 mobile,
 email,
 prim_specialty,
 specialty_code,
 sfa_create_date,
 bp_code,
 sfa_align_date,
 account_demo_id,
 pdrp_flag,
 designation,
 business_type,
 area_number,
 region_number,
 tvcmid,
 address_id
)
AS
 SELECT scd_sfa_demographics.scd_status,
        scd_sfa_demographics.scd_effective_date,
        scd_sfa_demographics.scd_expiration_date,
        scd_sfa_demographics.veeva_account_id,
        scd_sfa_demographics.sales_force_id,
        scd_sfa_demographics.customer_type,
        scd_sfa_demographics.ims_id,
        scd_sfa_demographics.npi,
        scd_sfa_demographics.ims_outlet_code,
        scd_sfa_demographics.territory_number,
        scd_sfa_demographics.territory_type,
        scd_sfa_demographics.territory_status,
        scd_sfa_demographics.last_name,
        scd_sfa_demographics.first_name,
        scd_sfa_demographics.middle_name,
        scd_sfa_demographics.suffix_name,
        scd_sfa_demographics.credentials,
        scd_sfa_demographics.organization_name,
        scd_sfa_demographics.veeva_address_id,
        scd_sfa_demographics.address_line1,
        scd_sfa_demographics.address_line2,
        scd_sfa_demographics.address_line3,
        scd_sfa_demographics.city,
        scd_sfa_demographics.state,
        scd_sfa_demographics.zip,
        scd_sfa_demographics.address_status,
        scd_sfa_demographics.phone,
        scd_sfa_demographics.phone_ext,
        scd_sfa_demographics.fax,
        scd_sfa_demographics.mobile,
        scd_sfa_demographics.email,
        scd_sfa_demographics.prim_specialty,
        scd_sfa_demographics.specialty_code,
        scd_sfa_demographics.sfa_create_date,
        scd_sfa_demographics.bp_code,
        scd_sfa_demographics.sfa_align_date,
        scd_sfa_demographics.account_demo_id,
        scd_sfa_demographics.pdrp_flag,
        scd_sfa_demographics.designation,
        scd_sfa_demographics.business_type,
        scd_sfa_demographics.area_number,
        scd_sfa_demographics.region_number,
        scd_sfa_demographics.tvcmid,
        scd_sfa_demographics.address_id
 FROM sandbox.scd_sfa_demographics
 ORDER BY scd_sfa_demographics.veeva_account_id
SEGMENTED BY hash(scd_sfa_demographics.veeva_account_id) ALL NODES;

CREATE PROJECTION sandbox.scd_roster_b0 /*+basename(scd_roster),createtype(L)*/ 
(
 scd_status,
 scd_effective_date,
 scd_expiration_date,
 employee_id,
 territory_number,
 territory_name,
 sales_force_id,
 full_name,
 first_name,
 middle_name,
 last_name,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 country,
 business_address_line1,
 business_address_line2,
 business_address_line3,
 business_city,
 business_state,
 business_zip,
 business_country,
 shipping_address_line1,
 shipping_address_line2,
 shipping_address_line3,
 shipping_city,
 shipping_state,
 shipping_zip,
 shipping_country,
 business_phone,
 home_phone,
 mobile_phone,
 fax,
 voice_mail_extension,
 email,
 hire_date,
 title,
 rep_type,
 username,
 out_of_territory,
 parent_territory_number,
 company_code,
 original_hire_date,
 team,
 salutation,
 suffix,
 cost_center,
 sample_eligibility_flag,
 samplestorage_address_line1,
 samplestorage_address_line2,
 samplestorage_address_line3,
 samplestorage_city,
 samplestorage_zip,
 samplestorage_state,
 samplestorage_country,
 hr_status,
 reg_contract,
 preferred_name,
 business_unit_cd,
 business_unit_name,
 veeva_user_id,
 mngr_employee_id,
 birth_month_day,
 calculated_rep_type,
 job_code,
 oracle_string,
 global_employee_id,
 supervisor_global_employee_id,
 separation_date,
 separation_reason
)
AS
 SELECT scd_roster.scd_status,
        scd_roster.scd_effective_date,
        scd_roster.scd_expiration_date,
        scd_roster.employee_id,
        scd_roster.territory_number,
        scd_roster.territory_name,
        scd_roster.sales_force_id,
        scd_roster.full_name,
        scd_roster.first_name,
        scd_roster.middle_name,
        scd_roster.last_name,
        scd_roster.address_line1,
        scd_roster.address_line2,
        scd_roster.address_line3,
        scd_roster.city,
        scd_roster.state,
        scd_roster.zip,
        scd_roster.country,
        scd_roster.business_address_line1,
        scd_roster.business_address_line2,
        scd_roster.business_address_line3,
        scd_roster.business_city,
        scd_roster.business_state,
        scd_roster.business_zip,
        scd_roster.business_country,
        scd_roster.shipping_address_line1,
        scd_roster.shipping_address_line2,
        scd_roster.shipping_address_line3,
        scd_roster.shipping_city,
        scd_roster.shipping_state,
        scd_roster.shipping_zip,
        scd_roster.shipping_country,
        scd_roster.business_phone,
        scd_roster.home_phone,
        scd_roster.mobile_phone,
        scd_roster.fax,
        scd_roster.voice_mail_extension,
        scd_roster.email,
        scd_roster.hire_date,
        scd_roster.title,
        scd_roster.rep_type,
        scd_roster.username,
        scd_roster.out_of_territory,
        scd_roster.parent_territory_number,
        scd_roster.company_code,
        scd_roster.original_hire_date,
        scd_roster.team,
        scd_roster.salutation,
        scd_roster.suffix,
        scd_roster.cost_center,
        scd_roster.sample_eligibility_flag,
        scd_roster.samplestorage_address_line1,
        scd_roster.samplestorage_address_line2,
        scd_roster.samplestorage_address_line3,
        scd_roster.samplestorage_city,
        scd_roster.samplestorage_zip,
        scd_roster.samplestorage_state,
        scd_roster.samplestorage_country,
        scd_roster.hr_status,
        scd_roster.reg_contract,
        scd_roster.preferred_name,
        scd_roster.business_unit_cd,
        scd_roster.business_unit_name,
        scd_roster.veeva_user_id,
        scd_roster.mngr_employee_id,
        scd_roster.birth_month_day,
        scd_roster.calculated_rep_type,
        scd_roster.job_code,
        scd_roster.oracle_string,
        scd_roster.global_employee_id,
        scd_roster.supervisor_global_employee_id,
        scd_roster.separation_date,
        scd_roster.separation_reason
 FROM sandbox.scd_roster
 ORDER BY scd_roster.employee_id,
          scd_roster.territory_number,
          scd_roster.territory_name,
          scd_roster.sales_force_id,
          scd_roster.full_name,
          scd_roster.first_name,
          scd_roster.middle_name,
          scd_roster.last_name,
          scd_roster.address_line1,
          scd_roster.address_line2,
          scd_roster.address_line3,
          scd_roster.city,
          scd_roster.state,
          scd_roster.zip,
          scd_roster.country,
          scd_roster.business_address_line1,
          scd_roster.business_address_line2,
          scd_roster.business_address_line3,
          scd_roster.business_city,
          scd_roster.business_state,
          scd_roster.business_zip,
          scd_roster.business_country,
          scd_roster.shipping_address_line1,
          scd_roster.shipping_address_line2,
          scd_roster.shipping_address_line3,
          scd_roster.shipping_city,
          scd_roster.shipping_state,
          scd_roster.shipping_zip,
          scd_roster.shipping_country,
          scd_roster.business_phone,
          scd_roster.home_phone,
          scd_roster.mobile_phone,
          scd_roster.fax,
          scd_roster.voice_mail_extension,
          scd_roster.email,
          scd_roster.hire_date,
          scd_roster.title,
          scd_roster.rep_type,
          scd_roster.username,
          scd_roster.out_of_territory,
          scd_roster.parent_territory_number,
          scd_roster.company_code,
          scd_roster.original_hire_date,
          scd_roster.team,
          scd_roster.salutation,
          scd_roster.suffix,
          scd_roster.cost_center,
          scd_roster.sample_eligibility_flag,
          scd_roster.samplestorage_address_line1,
          scd_roster.samplestorage_address_line2,
          scd_roster.samplestorage_address_line3,
          scd_roster.samplestorage_city,
          scd_roster.samplestorage_zip,
          scd_roster.samplestorage_state,
          scd_roster.samplestorage_country,
          scd_roster.hr_status,
          scd_roster.reg_contract,
          scd_roster.preferred_name,
          scd_roster.business_unit_cd,
          scd_roster.business_unit_name,
          scd_roster.veeva_user_id,
          scd_roster.mngr_employee_id,
          scd_roster.birth_month_day,
          scd_roster.calculated_rep_type,
          scd_roster.job_code,
          scd_roster.oracle_string,
          scd_roster.global_employee_id,
          scd_roster.supervisor_global_employee_id
SEGMENTED BY hash(scd_roster.scd_effective_date, scd_roster.scd_expiration_date, scd_roster.business_state, scd_roster.shipping_state, scd_roster.hire_date, scd_roster.out_of_territory, scd_roster.original_hire_date, scd_roster.samplestorage_state, scd_roster.birth_month_day, scd_roster.separation_date, scd_roster.scd_status, scd_roster.rep_type, scd_roster.sample_eligibility_flag, scd_roster.business_unit_cd, scd_roster.job_code, scd_roster.salutation, scd_roster.suffix, scd_roster.calculated_rep_type, scd_roster.cost_center, scd_roster.global_employee_id, scd_roster.supervisor_global_employee_id, scd_roster.oracle_string, scd_roster.employee_id, scd_roster.territory_number, scd_roster.sales_force_id, scd_roster.full_name, scd_roster.first_name, scd_roster.middle_name, scd_roster.last_name, scd_roster.address_line1, scd_roster.address_line2, scd_roster.address_line3) ALL NODES;

CREATE PROJECTION sandbox.scd_sales_geography_b0 /*+basename(scd_sales_geography),createtype(L)*/ 
(
 scd_status,
 scd_effective_date,
 scd_expiration_date,
 sales_force_id,
 geography_number,
 geography_name,
 geography_desc,
 geography_type,
 employee_type,
 sales_team,
 parent_geography_number,
 fleet_eligible_flag
)
AS
 SELECT scd_sales_geography.scd_status,
        scd_sales_geography.scd_effective_date,
        scd_sales_geography.scd_expiration_date,
        scd_sales_geography.sales_force_id,
        scd_sales_geography.geography_number,
        scd_sales_geography.geography_name,
        scd_sales_geography.geography_desc,
        scd_sales_geography.geography_type,
        scd_sales_geography.employee_type,
        scd_sales_geography.sales_team,
        scd_sales_geography.parent_geography_number,
        scd_sales_geography.fleet_eligible_flag
 FROM sandbox.scd_sales_geography
 ORDER BY scd_sales_geography.sales_force_id,
          scd_sales_geography.geography_number,
          scd_sales_geography.geography_name,
          scd_sales_geography.geography_desc,
          scd_sales_geography.geography_type,
          scd_sales_geography.employee_type,
          scd_sales_geography.sales_team,
          scd_sales_geography.parent_geography_number
SEGMENTED BY hash(scd_sales_geography.sales_force_id, scd_sales_geography.employee_type, scd_sales_geography.geography_number, scd_sales_geography.geography_type, scd_sales_geography.parent_geography_number, scd_sales_geography.geography_name, scd_sales_geography.geography_desc, scd_sales_geography.sales_team) ALL NODES;

CREATE PROJECTION sandbox.onc_osm_targets_b0 /*+basename(onc_osm_targets),createtype(L)*/ 
(
 tvcmid,
 target_value
)
AS
 SELECT onc_osm_targets.tvcmid,
        onc_osm_targets.target_value
 FROM sandbox.onc_osm_targets
 ORDER BY onc_osm_targets.tvcmid,
          onc_osm_targets.target_value
SEGMENTED BY hash(onc_osm_targets.tvcmid, onc_osm_targets.target_value) ALL NODES;

CREATE PROJECTION sandbox.call_sample_product_value_b0 /*+basename(call_sample_product_value),createtype(L)*/ 
(
 Id,
 product_value_vod__c
)
AS
 SELECT call_sample_product_value.Id,
        call_sample_product_value.product_value_vod__c
 FROM sandbox.call_sample_product_value
 ORDER BY call_sample_product_value.Id,
          call_sample_product_value.product_value_vod__c
SEGMENTED BY hash(call_sample_product_value.Id, call_sample_product_value.product_value_vod__c) ALL NODES;

CREATE PROJECTION sandbox.speaker_bureau_results_09192018_b0 /*+basename(speaker_bureau_results_09192018),createtype(L)*/ 
(
 tvcmid,
 npi,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 speaker_affiliation,
 authorization_number,
 sln_state,
 license_expiration_date,
 license_type_name,
 license_status_description,
 license_certification_name,
 oig_flag,
 fda_flag,
 dea_flag,
 "promotional speaker flag",
 "personal promotion flag",
 "non-personal promotion flag",
 "advisor/ consultant flag"
)
AS
 SELECT speaker_bureau_results_09192018.tvcmid,
        speaker_bureau_results_09192018.npi,
        speaker_bureau_results_09192018.last_name,
        speaker_bureau_results_09192018.first_name,
        speaker_bureau_results_09192018.middle_name,
        speaker_bureau_results_09192018.address,
        speaker_bureau_results_09192018.city,
        speaker_bureau_results_09192018.state,
        speaker_bureau_results_09192018.zip,
        speaker_bureau_results_09192018.speaker_affiliation,
        speaker_bureau_results_09192018.authorization_number,
        speaker_bureau_results_09192018.sln_state,
        speaker_bureau_results_09192018.license_expiration_date,
        speaker_bureau_results_09192018.license_type_name,
        speaker_bureau_results_09192018.license_status_description,
        speaker_bureau_results_09192018.license_certification_name,
        speaker_bureau_results_09192018.oig_flag,
        speaker_bureau_results_09192018.fda_flag,
        speaker_bureau_results_09192018.dea_flag,
        speaker_bureau_results_09192018."promotional speaker flag",
        speaker_bureau_results_09192018."personal promotion flag",
        speaker_bureau_results_09192018."non-personal promotion flag",
        speaker_bureau_results_09192018."advisor/ consultant flag"
 FROM sandbox.speaker_bureau_results_09192018
 ORDER BY speaker_bureau_results_09192018.tvcmid,
          speaker_bureau_results_09192018.npi,
          speaker_bureau_results_09192018.last_name,
          speaker_bureau_results_09192018.first_name,
          speaker_bureau_results_09192018.middle_name,
          speaker_bureau_results_09192018.address,
          speaker_bureau_results_09192018.city,
          speaker_bureau_results_09192018.state,
          speaker_bureau_results_09192018.zip,
          speaker_bureau_results_09192018.speaker_affiliation,
          speaker_bureau_results_09192018.authorization_number,
          speaker_bureau_results_09192018.sln_state,
          speaker_bureau_results_09192018.license_expiration_date,
          speaker_bureau_results_09192018.license_type_name,
          speaker_bureau_results_09192018.license_status_description,
          speaker_bureau_results_09192018.license_certification_name,
          speaker_bureau_results_09192018.oig_flag,
          speaker_bureau_results_09192018.fda_flag,
          speaker_bureau_results_09192018.dea_flag,
          speaker_bureau_results_09192018."promotional speaker flag",
          speaker_bureau_results_09192018."personal promotion flag",
          speaker_bureau_results_09192018."non-personal promotion flag",
          speaker_bureau_results_09192018."advisor/ consultant flag"
SEGMENTED BY hash(speaker_bureau_results_09192018.tvcmid, speaker_bureau_results_09192018.npi, speaker_bureau_results_09192018.zip, speaker_bureau_results_09192018.license_expiration_date, speaker_bureau_results_09192018.oig_flag, speaker_bureau_results_09192018.fda_flag, speaker_bureau_results_09192018.dea_flag, speaker_bureau_results_09192018."promotional speaker flag", speaker_bureau_results_09192018."personal promotion flag", speaker_bureau_results_09192018."non-personal promotion flag", speaker_bureau_results_09192018."advisor/ consultant flag", speaker_bureau_results_09192018.last_name, speaker_bureau_results_09192018.first_name, speaker_bureau_results_09192018.middle_name, speaker_bureau_results_09192018.city, speaker_bureau_results_09192018.state, speaker_bureau_results_09192018.authorization_number, speaker_bureau_results_09192018.sln_state, speaker_bureau_results_09192018.license_status_description, speaker_bureau_results_09192018.license_certification_name, speaker_bureau_results_09192018.address, speaker_bureau_results_09192018.license_type_name, speaker_bureau_results_09192018.speaker_affiliation) ALL NODES;

CREATE PROJECTION sandbox.QVAR_Missing_SLN_10152018_b0 /*+basename(QVAR_Missing_SLN_10152018),createtype(L)*/ 
(
 "Client ID",
 "First Name",
 "Last Name",
 "Middle Name",
 Suffix,
 "Address 1",
 "Address 2",
 "Address 3",
 City,
 State,
 Zip
)
AS
 SELECT QVAR_Missing_SLN_10152018."Client ID",
        QVAR_Missing_SLN_10152018."First Name",
        QVAR_Missing_SLN_10152018."Last Name",
        QVAR_Missing_SLN_10152018."Middle Name",
        QVAR_Missing_SLN_10152018.Suffix,
        QVAR_Missing_SLN_10152018."Address 1",
        QVAR_Missing_SLN_10152018."Address 2",
        QVAR_Missing_SLN_10152018."Address 3",
        QVAR_Missing_SLN_10152018.City,
        QVAR_Missing_SLN_10152018.State,
        QVAR_Missing_SLN_10152018.Zip
 FROM sandbox.QVAR_Missing_SLN_10152018
 ORDER BY QVAR_Missing_SLN_10152018."Client ID",
          QVAR_Missing_SLN_10152018."First Name",
          QVAR_Missing_SLN_10152018."Last Name",
          QVAR_Missing_SLN_10152018."Middle Name",
          QVAR_Missing_SLN_10152018.Suffix,
          QVAR_Missing_SLN_10152018."Address 1",
          QVAR_Missing_SLN_10152018."Address 2",
          QVAR_Missing_SLN_10152018."Address 3",
          QVAR_Missing_SLN_10152018.City,
          QVAR_Missing_SLN_10152018.State,
          QVAR_Missing_SLN_10152018.Zip
SEGMENTED BY hash(QVAR_Missing_SLN_10152018."Client ID", QVAR_Missing_SLN_10152018.Zip, QVAR_Missing_SLN_10152018."Middle Name", QVAR_Missing_SLN_10152018.Suffix, QVAR_Missing_SLN_10152018."Address 3", QVAR_Missing_SLN_10152018."First Name", QVAR_Missing_SLN_10152018."Last Name", QVAR_Missing_SLN_10152018."Address 2", QVAR_Missing_SLN_10152018.City, QVAR_Missing_SLN_10152018.State, QVAR_Missing_SLN_10152018."Address 1") ALL NODES;

CREATE PROJECTION sandbox.views_to_keep_b0 /*+basename(views_to_keep),createtype(L)*/ 
(
 view_name
)
AS
 SELECT views_to_keep.view_name
 FROM sandbox.views_to_keep
 ORDER BY views_to_keep.view_name
SEGMENTED BY hash(views_to_keep.view_name) ALL NODES;

CREATE PROJECTION sandbox."KNIPPER QVARs IDs1033_b0" /*+basename(KNIPPER QVARs IDs1033),createtype(L)*/ 
(
 TVCMID,
 ims_id
)
AS
 SELECT "KNIPPER QVARs IDs1033".TVCMID,
        "KNIPPER QVARs IDs1033".ims_id
 FROM sandbox."KNIPPER QVARs IDs1033"
 ORDER BY "KNIPPER QVARs IDs1033".TVCMID,
          "KNIPPER QVARs IDs1033".ims_id
SEGMENTED BY hash("KNIPPER QVARs IDs1033".TVCMID, "KNIPPER QVARs IDs1033".ims_id) ALL NODES;

CREATE PROJECTION sandbox.QNASL_IMSID_04112019_b0 /*+basename(QNASL_IMSID_04112019),createtype(L)*/ 
(
 IMSID
)
AS
 SELECT QNASL_IMSID_04112019.IMSID
 FROM sandbox.QNASL_IMSID_04112019
 ORDER BY QNASL_IMSID_04112019.IMSID
SEGMENTED BY hash(QNASL_IMSID_04112019.IMSID) ALL NODES;

CREATE PROJECTION sandbox.ingestion_databurst_updt_b0 /*+basename(ingestion_databurst_updt),createtype(A)*/ 
(
 table_name
)
AS
 SELECT ingestion_databurst_updt.table_name
 FROM sandbox.ingestion_databurst_updt
 ORDER BY ingestion_databurst_updt.table_name
SEGMENTED BY hash(ingestion_databurst_updt.table_name) ALL NODES;

CREATE PROJECTION sandbox.grants_teva_ingestion_b0 /*+basename(grants_teva_ingestion),createtype(A)*/ 
(
 grant_id,
 grantor_id,
 grantor,
 privileges_description,
 object_schema,
 object_name,
 object_id,
 object_type,
 grantee_id,
 grantee
)
AS
 SELECT grants_teva_ingestion.grant_id,
        grants_teva_ingestion.grantor_id,
        grants_teva_ingestion.grantor,
        grants_teva_ingestion.privileges_description,
        grants_teva_ingestion.object_schema,
        grants_teva_ingestion.object_name,
        grants_teva_ingestion.object_id,
        grants_teva_ingestion.object_type,
        grants_teva_ingestion.grantee_id,
        grants_teva_ingestion.grantee
 FROM sandbox.grants_teva_ingestion
 ORDER BY grants_teva_ingestion.grant_id
SEGMENTED BY hash(grants_teva_ingestion.grant_id, grants_teva_ingestion.grantor_id, grants_teva_ingestion.object_id, grants_teva_ingestion.grantee_id, grants_teva_ingestion.grantor, grants_teva_ingestion.object_schema, grants_teva_ingestion.object_name, grants_teva_ingestion.grantee) ALL NODES;

CREATE PROJECTION sandbox.ZS_AM_SUBMRKT_PRODLIST_10162019_b0 /*+basename(ZS_AM_SUBMRKT_PRODLIST_10162019),createtype(L)*/ 
(
 basket_id,
 basket_name,
 basket_type,
 parent_basket_name
)
AS
 SELECT ZS_AM_SUBMRKT_PRODLIST_10162019.basket_id,
        ZS_AM_SUBMRKT_PRODLIST_10162019.basket_name,
        ZS_AM_SUBMRKT_PRODLIST_10162019.basket_type,
        ZS_AM_SUBMRKT_PRODLIST_10162019.parent_basket_name
 FROM sandbox.ZS_AM_SUBMRKT_PRODLIST_10162019
 ORDER BY ZS_AM_SUBMRKT_PRODLIST_10162019.basket_id,
          ZS_AM_SUBMRKT_PRODLIST_10162019.basket_name,
          ZS_AM_SUBMRKT_PRODLIST_10162019.basket_type,
          ZS_AM_SUBMRKT_PRODLIST_10162019.parent_basket_name
SEGMENTED BY hash(ZS_AM_SUBMRKT_PRODLIST_10162019.basket_id, ZS_AM_SUBMRKT_PRODLIST_10162019.basket_type, ZS_AM_SUBMRKT_PRODLIST_10162019.parent_basket_name, ZS_AM_SUBMRKT_PRODLIST_10162019.basket_name) ALL NODES;

CREATE PROJECTION sandbox.ZS_AM_SUBMRKT_PRODLIST_10232019_b0 /*+basename(ZS_AM_SUBMRKT_PRODLIST_10232019),createtype(L)*/ 
(
 basket_id,
 basket_name,
 basket_type,
 parent_basket_name,
 Sub_Mrkt
)
AS
 SELECT ZS_AM_SUBMRKT_PRODLIST_10232019.basket_id,
        ZS_AM_SUBMRKT_PRODLIST_10232019.basket_name,
        ZS_AM_SUBMRKT_PRODLIST_10232019.basket_type,
        ZS_AM_SUBMRKT_PRODLIST_10232019.parent_basket_name,
        ZS_AM_SUBMRKT_PRODLIST_10232019.Sub_Mrkt
 FROM sandbox.ZS_AM_SUBMRKT_PRODLIST_10232019
 ORDER BY ZS_AM_SUBMRKT_PRODLIST_10232019.basket_id,
          ZS_AM_SUBMRKT_PRODLIST_10232019.basket_name,
          ZS_AM_SUBMRKT_PRODLIST_10232019.basket_type,
          ZS_AM_SUBMRKT_PRODLIST_10232019.parent_basket_name,
          ZS_AM_SUBMRKT_PRODLIST_10232019.Sub_Mrkt
SEGMENTED BY hash(ZS_AM_SUBMRKT_PRODLIST_10232019.basket_id, ZS_AM_SUBMRKT_PRODLIST_10232019.basket_type, ZS_AM_SUBMRKT_PRODLIST_10232019.Sub_Mrkt, ZS_AM_SUBMRKT_PRODLIST_10232019.parent_basket_name, ZS_AM_SUBMRKT_PRODLIST_10232019.basket_name) ALL NODES;

CREATE PROJECTION sandbox.austedo_firstrx_callinfo_1212_b0 /*+basename(austedo_firstrx_callinfo_1212),createtype(A)*/ 
(
 ims_id_original,
 call_date,
 ims_id,
 first_rx_date
)
AS
 SELECT austedo_firstrx_callinfo_1212.ims_id_original,
        austedo_firstrx_callinfo_1212.call_date,
        austedo_firstrx_callinfo_1212.ims_id,
        austedo_firstrx_callinfo_1212.first_rx_date
 FROM sandbox.austedo_firstrx_callinfo_1212
 ORDER BY austedo_firstrx_callinfo_1212.ims_id_original,
          austedo_firstrx_callinfo_1212.ims_id,
          austedo_firstrx_callinfo_1212.call_date,
          austedo_firstrx_callinfo_1212.first_rx_date
SEGMENTED BY hash(austedo_firstrx_callinfo_1212.ims_id_original, austedo_firstrx_callinfo_1212.ims_id, austedo_firstrx_callinfo_1212.call_date, austedo_firstrx_callinfo_1212.first_rx_date) ALL NODES;

CREATE PROJECTION sandbox.austedo_callfrequency_data_12121_b0 /*+basename(austedo_callfrequency_data_12121),createtype(A)*/ 
(
 ims_id_original,
 first_rx_date,
 total_calls_before_firstrx
)
AS
 SELECT austedo_callfrequency_data_12121.ims_id_original,
        austedo_callfrequency_data_12121.first_rx_date,
        austedo_callfrequency_data_12121.total_calls_before_firstrx
 FROM sandbox.austedo_callfrequency_data_12121
 ORDER BY austedo_callfrequency_data_12121.ims_id_original,
          austedo_callfrequency_data_12121.first_rx_date,
          austedo_callfrequency_data_12121.total_calls_before_firstrx
SEGMENTED BY hash(austedo_callfrequency_data_12121.first_rx_date, austedo_callfrequency_data_12121.total_calls_before_firstrx, austedo_callfrequency_data_12121.ims_id_original) ALL NODES;

CREATE PROJECTION sandbox.austedo_callfrequency_data_1212_b0 /*+basename(austedo_callfrequency_data_1212),createtype(A)*/ 
(
 ims_id_original,
 first_rx_date,
 total_calls_before_firstrx
)
AS
 SELECT austedo_callfrequency_data_1212.ims_id_original,
        austedo_callfrequency_data_1212.first_rx_date,
        austedo_callfrequency_data_1212.total_calls_before_firstrx
 FROM sandbox.austedo_callfrequency_data_1212
 ORDER BY austedo_callfrequency_data_1212.ims_id_original,
          austedo_callfrequency_data_1212.first_rx_date,
          austedo_callfrequency_data_1212.total_calls_before_firstrx
SEGMENTED BY hash(austedo_callfrequency_data_1212.first_rx_date, austedo_callfrequency_data_1212.total_calls_before_firstrx, austedo_callfrequency_data_1212.ims_id_original) ALL NODES;

CREATE PROJECTION sandbox.J_CHUNG_DEA_IDs_b0 /*+basename(J_CHUNG_DEA_IDs),createtype(L)*/ 
(
 "Physician DEA#"
)
AS
 SELECT J_CHUNG_DEA_IDs."Physician DEA#"
 FROM sandbox.J_CHUNG_DEA_IDs
 ORDER BY J_CHUNG_DEA_IDs."Physician DEA#"
SEGMENTED BY hash(J_CHUNG_DEA_IDs."Physician DEA#") ALL NODES;

CREATE PROJECTION sandbox.mb_customer_b0 /*+basename(mb_customer),createtype(A)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 ims_outlet_code,
 ims_facility_number,
 federation_id,
 customer_type,
 prescriber_type,
 network_name,
 account_name,
 physician_first_name,
 physician_last_name,
 credential,
 subcat_group,
 subcat_code,
 pdrp_flag,
 pri_specialty_code,
 pri_specialty_desc,
 sec_specialty_code,
 sec_specialty_desc,
 cm_status_flag,
 gpo,
 dnp_flag,
 product_1_dnc_flag,
 product_2_dnc_flag,
 a_specialty_group,
 b_specialty_group,
 c_specialty_group,
 formulary_control
)
AS
 SELECT mb_customer.customer_id,
        mb_customer.tvcmid,
        mb_customer.ims_id,
        mb_customer.ims_outlet_code,
        mb_customer.ims_facility_number,
        mb_customer.federation_id,
        mb_customer.customer_type,
        mb_customer.prescriber_type,
        mb_customer.network_name,
        mb_customer.account_name,
        mb_customer.physician_first_name,
        mb_customer.physician_last_name,
        mb_customer.credential,
        mb_customer.subcat_group,
        mb_customer.subcat_code,
        mb_customer.pdrp_flag,
        mb_customer.pri_specialty_code,
        mb_customer.pri_specialty_desc,
        mb_customer.sec_specialty_code,
        mb_customer.sec_specialty_desc,
        mb_customer.cm_status_flag,
        mb_customer.gpo,
        mb_customer.dnp_flag,
        mb_customer.product_1_dnc_flag,
        mb_customer.product_2_dnc_flag,
        mb_customer.a_specialty_group,
        mb_customer.b_specialty_group,
        mb_customer.c_specialty_group,
        mb_customer.formulary_control
 FROM sandbox.mb_customer
 ORDER BY mb_customer.customer_id,
          mb_customer.tvcmid,
          mb_customer.ims_id,
          mb_customer.ims_outlet_code,
          mb_customer.ims_facility_number,
          mb_customer.federation_id,
          mb_customer.customer_type,
          mb_customer.prescriber_type
SEGMENTED BY hash(mb_customer.tvcmid, mb_customer.subcat_code, mb_customer.pdrp_flag, mb_customer.dnp_flag, mb_customer.product_1_dnc_flag, mb_customer.product_2_dnc_flag, mb_customer.ims_id, mb_customer.ims_outlet_code) ALL NODES;

CREATE PROJECTION sandbox.test_concur_curr_b0 /*+basename(test_concur_curr),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_con_curr.cust_id,
        test_con_curr.organization_name,
        test_con_curr.contact_type,
        test_con_curr.first_name,
        test_con_curr.middle_name,
        test_con_curr.last_name,
        test_con_curr.suffix,
        test_con_curr.npi,
        test_con_curr.address_line_1,
        test_con_curr.address_line_2,
        test_con_curr.city,
        test_con_curr.state,
        test_con_curr.zipcode,
        test_con_curr.sln,
        test_con_curr.sln_state,
        test_con_curr.dea,
        test_con_curr.affiliation,
        test_con_curr.credential,
        test_con_curr.healthcare_professional_status_code
 FROM sandbox.test_con_curr
 ORDER BY test_con_curr.cust_id,
          test_con_curr.first_name,
          test_con_curr.middle_name,
          test_con_curr.last_name,
          test_con_curr.suffix,
          test_con_curr.npi,
          test_con_curr.address_line_1,
          test_con_curr.address_line_2,
          test_con_curr.city,
          test_con_curr.state,
          test_con_curr.zipcode,
          test_con_curr.sln,
          test_con_curr.sln_state,
          test_con_curr.dea,
          test_con_curr.credential,
          test_con_curr.healthcare_professional_status_code
SEGMENTED BY hash(test_con_curr.cust_id, test_con_curr.first_name, test_con_curr.middle_name, test_con_curr.last_name, test_con_curr.suffix, test_con_curr.npi, test_con_curr.address_line_1, test_con_curr.address_line_2, test_con_curr.city, test_con_curr.state, test_con_curr.zipcode, test_con_curr.sln, test_con_curr.sln_state, test_con_curr.dea, test_con_curr.credential, test_con_curr.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_demo_tn_b0 /*+basename(mb_ic_demo_tn),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT mb_ic_demo_tn.ic_data_month,
        mb_ic_demo_tn.sales_force_id,
        mb_ic_demo_tn.area_number,
        mb_ic_demo_tn.region_number,
        mb_ic_demo_tn.territory_number,
        mb_ic_demo_tn.ims_id,
        mb_ic_demo_tn.tvcmid,
        mb_ic_demo_tn.outlet_code,
        mb_ic_demo_tn.va_station_number,
        mb_ic_demo_tn.specialty,
        mb_ic_demo_tn.last_name,
        mb_ic_demo_tn.first_name,
        mb_ic_demo_tn.mid_name,
        mb_ic_demo_tn.address_1,
        mb_ic_demo_tn.address_2,
        mb_ic_demo_tn.address_3,
        mb_ic_demo_tn.city,
        mb_ic_demo_tn.state,
        mb_ic_demo_tn.zip,
        mb_ic_demo_tn.address_source,
        mb_ic_demo_tn.pdrp_flag,
        mb_ic_demo_tn.pdrp_date,
        mb_ic_demo_tn.np_pa_flag,
        mb_ic_demo_tn.no_spend,
        mb_ic_demo_tn.ama_no_contact_flag,
        mb_ic_demo_tn.join_key,
        mb_ic_demo_tn.row_source,
        mb_ic_demo_tn.row_create_date,
        mb_ic_demo_tn.outlet_dea,
        mb_ic_demo_tn.secondary_specialty
 FROM sandbox.mb_ic_demo_tn
 ORDER BY mb_ic_demo_tn.ic_data_month,
          mb_ic_demo_tn.sales_force_id,
          mb_ic_demo_tn.area_number,
          mb_ic_demo_tn.region_number,
          mb_ic_demo_tn.territory_number,
          mb_ic_demo_tn.ims_id,
          mb_ic_demo_tn.tvcmid,
          mb_ic_demo_tn.outlet_code
SEGMENTED BY hash(mb_ic_demo_tn.ic_data_month, mb_ic_demo_tn.tvcmid, mb_ic_demo_tn.outlet_code, mb_ic_demo_tn.mid_name, mb_ic_demo_tn.state, mb_ic_demo_tn.zip, mb_ic_demo_tn.pdrp_flag, mb_ic_demo_tn.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_rx_tn_b0 /*+basename(mb_ic_rx_tn),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT mb_ic_rx_tn.ic_data_month,
        mb_ic_rx_tn.basket_name,
        mb_ic_rx_tn.sales_force_id,
        mb_ic_rx_tn.area_number,
        mb_ic_rx_tn.region_number,
        mb_ic_rx_tn.territory_number,
        mb_ic_rx_tn.ims_id,
        mb_ic_rx_tn.tvcmid,
        mb_ic_rx_tn.outlet_code,
        mb_ic_rx_tn.va_station_number,
        mb_ic_rx_tn.dnc_flag,
        mb_ic_rx_tn.dnp_flag,
        mb_ic_rx_tn.rollup_month,
        mb_ic_rx_tn.month_bucket,
        mb_ic_rx_tn.nrx_count,
        mb_ic_rx_tn.trx_count,
        mb_ic_rx_tn.nrx_quantity,
        mb_ic_rx_tn.trx_quantity,
        mb_ic_rx_tn.include_in_nation_rollup,
        mb_ic_rx_tn.include_in_area_rollup,
        mb_ic_rx_tn.include_in_region_rollup,
        mb_ic_rx_tn.join_key,
        mb_ic_rx_tn.row_source,
        mb_ic_rx_tn.row_create_date,
        mb_ic_rx_tn.indication,
        mb_ic_rx_tn.outlet_dea,
        mb_ic_rx_tn.payer_plan_number,
        mb_ic_rx_tn.payment_method
 FROM sandbox.mb_ic_rx_tn
 ORDER BY mb_ic_rx_tn.ic_data_month,
          mb_ic_rx_tn.basket_name,
          mb_ic_rx_tn.sales_force_id,
          mb_ic_rx_tn.area_number,
          mb_ic_rx_tn.region_number,
          mb_ic_rx_tn.territory_number,
          mb_ic_rx_tn.ims_id,
          mb_ic_rx_tn.tvcmid
SEGMENTED BY hash(mb_ic_rx_tn.ic_data_month, mb_ic_rx_tn.tvcmid, mb_ic_rx_tn.outlet_code, mb_ic_rx_tn.dnc_flag, mb_ic_rx_tn.dnp_flag, mb_ic_rx_tn.rollup_month, mb_ic_rx_tn.month_bucket, mb_ic_rx_tn.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_rx_tr_b0 /*+basename(mb_ic_rx_tr),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT mb_ic_rx_tr.ic_data_month,
        mb_ic_rx_tr.basket_name,
        mb_ic_rx_tr.sales_force_id,
        mb_ic_rx_tr.area_number,
        mb_ic_rx_tr.region_number,
        mb_ic_rx_tr.territory_number,
        mb_ic_rx_tr.ims_id,
        mb_ic_rx_tr.tvcmid,
        mb_ic_rx_tr.outlet_code,
        mb_ic_rx_tr.va_station_number,
        mb_ic_rx_tr.dnc_flag,
        mb_ic_rx_tr.dnp_flag,
        mb_ic_rx_tr.rollup_month,
        mb_ic_rx_tr.month_bucket,
        mb_ic_rx_tr.nrx_count,
        mb_ic_rx_tr.trx_count,
        mb_ic_rx_tr.nrx_quantity,
        mb_ic_rx_tr.trx_quantity,
        mb_ic_rx_tr.include_in_nation_rollup,
        mb_ic_rx_tr.include_in_area_rollup,
        mb_ic_rx_tr.include_in_region_rollup,
        mb_ic_rx_tr.join_key,
        mb_ic_rx_tr.row_source,
        mb_ic_rx_tr.row_create_date,
        mb_ic_rx_tr.indication,
        mb_ic_rx_tr.outlet_dea,
        mb_ic_rx_tr.payer_plan_number,
        mb_ic_rx_tr.payment_method
 FROM sandbox.mb_ic_rx_tr
 ORDER BY mb_ic_rx_tr.ic_data_month,
          mb_ic_rx_tr.basket_name,
          mb_ic_rx_tr.sales_force_id,
          mb_ic_rx_tr.area_number,
          mb_ic_rx_tr.region_number,
          mb_ic_rx_tr.territory_number,
          mb_ic_rx_tr.ims_id,
          mb_ic_rx_tr.tvcmid
SEGMENTED BY hash(mb_ic_rx_tr.ic_data_month, mb_ic_rx_tr.tvcmid, mb_ic_rx_tr.outlet_code, mb_ic_rx_tr.dnc_flag, mb_ic_rx_tr.dnp_flag, mb_ic_rx_tr.rollup_month, mb_ic_rx_tr.month_bucket, mb_ic_rx_tr.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_demo_tr_b0 /*+basename(mb_ic_demo_tr),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT mb_ic_demo_tr.ic_data_month,
        mb_ic_demo_tr.sales_force_id,
        mb_ic_demo_tr.area_number,
        mb_ic_demo_tr.region_number,
        mb_ic_demo_tr.territory_number,
        mb_ic_demo_tr.ims_id,
        mb_ic_demo_tr.tvcmid,
        mb_ic_demo_tr.outlet_code,
        mb_ic_demo_tr.va_station_number,
        mb_ic_demo_tr.specialty,
        mb_ic_demo_tr.last_name,
        mb_ic_demo_tr.first_name,
        mb_ic_demo_tr.mid_name,
        mb_ic_demo_tr.address_1,
        mb_ic_demo_tr.address_2,
        mb_ic_demo_tr.address_3,
        mb_ic_demo_tr.city,
        mb_ic_demo_tr.state,
        mb_ic_demo_tr.zip,
        mb_ic_demo_tr.address_source,
        mb_ic_demo_tr.pdrp_flag,
        mb_ic_demo_tr.pdrp_date,
        mb_ic_demo_tr.np_pa_flag,
        mb_ic_demo_tr.no_spend,
        mb_ic_demo_tr.ama_no_contact_flag,
        mb_ic_demo_tr.join_key,
        mb_ic_demo_tr.row_source,
        mb_ic_demo_tr.row_create_date,
        mb_ic_demo_tr.outlet_dea,
        mb_ic_demo_tr.secondary_specialty
 FROM sandbox.mb_ic_demo_tr
 ORDER BY mb_ic_demo_tr.ic_data_month,
          mb_ic_demo_tr.sales_force_id,
          mb_ic_demo_tr.area_number,
          mb_ic_demo_tr.region_number,
          mb_ic_demo_tr.territory_number,
          mb_ic_demo_tr.ims_id,
          mb_ic_demo_tr.tvcmid,
          mb_ic_demo_tr.outlet_code
SEGMENTED BY hash(mb_ic_demo_tr.ic_data_month, mb_ic_demo_tr.tvcmid, mb_ic_demo_tr.outlet_code, mb_ic_demo_tr.mid_name, mb_ic_demo_tr.state, mb_ic_demo_tr.zip, mb_ic_demo_tr.pdrp_flag, mb_ic_demo_tr.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.PhysicianInfo_Dustin_0518_b0 /*+basename(PhysicianInfo_Dustin_0518),createtype(L)*/ 
(
 "Prescribing Physician FN",
 "Prescribing Physician LN",
 "Prescribing Physician NPI",
 "Prescribing Physician Zip Code"
)
AS
 SELECT PhysicianInfo_Dustin_0518."Prescribing Physician FN",
        PhysicianInfo_Dustin_0518."Prescribing Physician LN",
        PhysicianInfo_Dustin_0518."Prescribing Physician NPI",
        PhysicianInfo_Dustin_0518."Prescribing Physician Zip Code"
 FROM sandbox.PhysicianInfo_Dustin_0518
 ORDER BY PhysicianInfo_Dustin_0518."Prescribing Physician FN",
          PhysicianInfo_Dustin_0518."Prescribing Physician LN",
          PhysicianInfo_Dustin_0518."Prescribing Physician NPI",
          PhysicianInfo_Dustin_0518."Prescribing Physician Zip Code"
SEGMENTED BY hash(PhysicianInfo_Dustin_0518."Prescribing Physician NPI", PhysicianInfo_Dustin_0518."Prescribing Physician Zip Code", PhysicianInfo_Dustin_0518."Prescribing Physician FN", PhysicianInfo_Dustin_0518."Prescribing Physician LN") ALL NODES;

CREATE PROJECTION sandbox.test_concur_curr_kg_b0 /*+basename(test_concur_curr_kg),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_concur_curr_kg.cust_id,
        test_concur_curr_kg.organization_name,
        test_concur_curr_kg.contact_type,
        test_concur_curr_kg.first_name,
        test_concur_curr_kg.middle_name,
        test_concur_curr_kg.last_name,
        test_concur_curr_kg.suffix,
        test_concur_curr_kg.npi,
        test_concur_curr_kg.address_line_1,
        test_concur_curr_kg.address_line_2,
        test_concur_curr_kg.city,
        test_concur_curr_kg.state,
        test_concur_curr_kg.zipcode,
        test_concur_curr_kg.sln,
        test_concur_curr_kg.sln_state,
        test_concur_curr_kg.dea,
        test_concur_curr_kg.affiliation,
        test_concur_curr_kg.credential,
        test_concur_curr_kg.healthcare_professional_status_code
 FROM sandbox.test_concur_curr_kg
 ORDER BY test_concur_curr_kg.cust_id,
          test_concur_curr_kg.first_name,
          test_concur_curr_kg.middle_name,
          test_concur_curr_kg.last_name,
          test_concur_curr_kg.suffix,
          test_concur_curr_kg.npi,
          test_concur_curr_kg.address_line_1,
          test_concur_curr_kg.address_line_2,
          test_concur_curr_kg.city,
          test_concur_curr_kg.state,
          test_concur_curr_kg.zipcode,
          test_concur_curr_kg.sln,
          test_concur_curr_kg.sln_state,
          test_concur_curr_kg.dea,
          test_concur_curr_kg.credential,
          test_concur_curr_kg.healthcare_professional_status_code
SEGMENTED BY hash(test_concur_curr_kg.cust_id, test_concur_curr_kg.first_name, test_concur_curr_kg.middle_name, test_concur_curr_kg.last_name, test_concur_curr_kg.suffix, test_concur_curr_kg.npi, test_concur_curr_kg.address_line_1, test_concur_curr_kg.address_line_2, test_concur_curr_kg.city, test_concur_curr_kg.state, test_concur_curr_kg.zipcode, test_concur_curr_kg.sln, test_concur_curr_kg.sln_state, test_concur_curr_kg.dea, test_concur_curr_kg.credential, test_concur_curr_kg.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.concur_hcp_curr_b0 /*+basename(concur_hcp_curr),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT concur_hcp_curr.cust_id,
        concur_hcp_curr.organization_name,
        concur_hcp_curr.contact_type,
        concur_hcp_curr.first_name,
        concur_hcp_curr.middle_name,
        concur_hcp_curr.last_name,
        concur_hcp_curr.suffix,
        concur_hcp_curr.npi,
        concur_hcp_curr.address_line_1,
        concur_hcp_curr.address_line_2,
        concur_hcp_curr.city,
        concur_hcp_curr.state,
        concur_hcp_curr.zipcode,
        concur_hcp_curr.sln,
        concur_hcp_curr.sln_state,
        concur_hcp_curr.dea,
        concur_hcp_curr.affiliation,
        concur_hcp_curr.credential,
        concur_hcp_curr.healthcare_professional_status_code,
        concur_hcp_curr.create_date
 FROM sandbox.concur_hcp_curr
 ORDER BY concur_hcp_curr.cust_id,
          concur_hcp_curr.first_name,
          concur_hcp_curr.middle_name,
          concur_hcp_curr.last_name,
          concur_hcp_curr.suffix,
          concur_hcp_curr.npi,
          concur_hcp_curr.address_line_1,
          concur_hcp_curr.address_line_2,
          concur_hcp_curr.city,
          concur_hcp_curr.state,
          concur_hcp_curr.zipcode,
          concur_hcp_curr.sln,
          concur_hcp_curr.sln_state,
          concur_hcp_curr.dea,
          concur_hcp_curr.credential,
          concur_hcp_curr.healthcare_professional_status_code
SEGMENTED BY hash(concur_hcp_curr.cust_id, concur_hcp_curr.first_name, concur_hcp_curr.middle_name, concur_hcp_curr.last_name, concur_hcp_curr.suffix, concur_hcp_curr.npi, concur_hcp_curr.address_line_1, concur_hcp_curr.address_line_2, concur_hcp_curr.city, concur_hcp_curr.state, concur_hcp_curr.zipcode, concur_hcp_curr.sln, concur_hcp_curr.sln_state, concur_hcp_curr.dea, concur_hcp_curr.credential, concur_hcp_curr.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.concur_hcp_delta_b0 /*+basename(concur_hcp_delta),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT concur_hcp_delta.cust_id,
        concur_hcp_delta.organization_name,
        concur_hcp_delta.contact_type,
        concur_hcp_delta.first_name,
        concur_hcp_delta.middle_name,
        concur_hcp_delta.last_name,
        concur_hcp_delta.suffix,
        concur_hcp_delta.npi,
        concur_hcp_delta.address_line_1,
        concur_hcp_delta.address_line_2,
        concur_hcp_delta.city,
        concur_hcp_delta.state,
        concur_hcp_delta.zipcode,
        concur_hcp_delta.sln,
        concur_hcp_delta.sln_state,
        concur_hcp_delta.dea,
        concur_hcp_delta.affiliation,
        concur_hcp_delta.credential,
        concur_hcp_delta.healthcare_professional_status_code,
        concur_hcp_delta.create_date
 FROM sandbox.concur_hcp_delta
 ORDER BY concur_hcp_delta.cust_id
SEGMENTED BY hash(concur_hcp_delta.cust_id, concur_hcp_delta.first_name, concur_hcp_delta.middle_name, concur_hcp_delta.last_name, concur_hcp_delta.suffix, concur_hcp_delta.npi, concur_hcp_delta.address_line_1, concur_hcp_delta.address_line_2, concur_hcp_delta.city, concur_hcp_delta.state, concur_hcp_delta.zipcode, concur_hcp_delta.sln, concur_hcp_delta.sln_state, concur_hcp_delta.dea, concur_hcp_delta.credential, concur_hcp_delta.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.prescriber_rx_ics_splitweek_08252020_b0 /*+basename(prescriber_rx_ics_splitweek_08252020),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication,
 pbm_parent_name
)
AS
 SELECT prescriber_rx_ics_splitweek_08252020.ims_id,
        prescriber_rx_ics_splitweek_08252020.payer_plan_number,
        prescriber_rx_ics_splitweek_08252020.ims_client_number,
        prescriber_rx_ics_splitweek_08252020.report_frequency,
        prescriber_rx_ics_splitweek_08252020.ims_product_group,
        prescriber_rx_ics_splitweek_08252020.basket_id,
        prescriber_rx_ics_splitweek_08252020.data_date,
        prescriber_rx_ics_splitweek_08252020.date,
        prescriber_rx_ics_splitweek_08252020.sales_category,
        prescriber_rx_ics_splitweek_08252020.tvcmid,
        prescriber_rx_ics_splitweek_08252020.prescriber_first_name,
        prescriber_rx_ics_splitweek_08252020.prescriber_last_name,
        prescriber_rx_ics_splitweek_08252020.basket_name,
        prescriber_rx_ics_splitweek_08252020.basket_type,
        prescriber_rx_ics_splitweek_08252020.rollup_week,
        prescriber_rx_ics_splitweek_08252020.rollup_month,
        prescriber_rx_ics_splitweek_08252020.nrx_count,
        prescriber_rx_ics_splitweek_08252020.trx_count,
        prescriber_rx_ics_splitweek_08252020.nrx_quantity,
        prescriber_rx_ics_splitweek_08252020.trx_quantity,
        prescriber_rx_ics_splitweek_08252020.unnormalized_nrx_count,
        prescriber_rx_ics_splitweek_08252020.unnormalized_trx_count,
        prescriber_rx_ics_splitweek_08252020.market_name,
        prescriber_rx_ics_splitweek_08252020.payer_name,
        prescriber_rx_ics_splitweek_08252020.plan_name,
        prescriber_rx_ics_splitweek_08252020.pbm_name,
        prescriber_rx_ics_splitweek_08252020.model,
        prescriber_rx_ics_splitweek_08252020.payment_method,
        prescriber_rx_ics_splitweek_08252020.ims_specialty,
        prescriber_rx_ics_splitweek_08252020.ims_rx_type,
        prescriber_rx_ics_splitweek_08252020.ims_supplemental_data,
        prescriber_rx_ics_splitweek_08252020.ims_zip_other,
        prescriber_rx_ics_splitweek_08252020.ims_report_number_cnt,
        prescriber_rx_ics_splitweek_08252020.cnt_file_id,
        prescriber_rx_ics_splitweek_08252020.cnt_record_id,
        prescriber_rx_ics_splitweek_08252020.ims_report_number_qty,
        prescriber_rx_ics_splitweek_08252020.qty_file_id,
        prescriber_rx_ics_splitweek_08252020.qty_record_id,
        prescriber_rx_ics_splitweek_08252020.rollup_flag,
        prescriber_rx_ics_splitweek_08252020.indication,
        prescriber_rx_ics_splitweek_08252020.pbm_parent_name
 FROM sandbox.prescriber_rx_ics_splitweek_08252020
 ORDER BY prescriber_rx_ics_splitweek_08252020.rollup_flag,
          prescriber_rx_ics_splitweek_08252020.ims_rx_type,
          prescriber_rx_ics_splitweek_08252020.basket_type,
          prescriber_rx_ics_splitweek_08252020.ims_client_number,
          prescriber_rx_ics_splitweek_08252020.indication,
          prescriber_rx_ics_splitweek_08252020.market_name,
          prescriber_rx_ics_splitweek_08252020.ims_product_group,
          prescriber_rx_ics_splitweek_08252020.basket_id,
          prescriber_rx_ics_splitweek_08252020.ims_specialty,
          prescriber_rx_ics_splitweek_08252020.ims_zip_other,
          prescriber_rx_ics_splitweek_08252020.ims_report_number_qty,
          prescriber_rx_ics_splitweek_08252020.ims_report_number_cnt,
          prescriber_rx_ics_splitweek_08252020.tvcmid,
          prescriber_rx_ics_splitweek_08252020.payment_method,
          prescriber_rx_ics_splitweek_08252020.payer_plan_number,
          prescriber_rx_ics_splitweek_08252020.rollup_month,
          prescriber_rx_ics_splitweek_08252020.rollup_week,
          prescriber_rx_ics_splitweek_08252020.nrx_quantity,
          prescriber_rx_ics_splitweek_08252020.trx_quantity,
          prescriber_rx_ics_splitweek_08252020.nrx_count,
          prescriber_rx_ics_splitweek_08252020.trx_count,
          prescriber_rx_ics_splitweek_08252020.sales_category,
          prescriber_rx_ics_splitweek_08252020.ims_id
SEGMENTED BY hash(prescriber_rx_ics_splitweek_08252020.ims_id) ALL NODES;

CREATE PROJECTION sandbox.zs_teva_payer_master_b0 /*+basename(zs_teva_payer_master),createtype(L)*/ 
(
 plan_code,
 Final_Key_Controlling_Account,
 Key_Parent_Account,
 PBM,
 Payer,
 Plan,
 State_Code,
 AJOVY_TRx,
 Aimovig_TRx,
 Emgality_TRx,
 aCGRP_TRx,
 AJOVY_Share_Percent,
 Aimovig_Share_Percent,
 Emgality_Share_Percent,
 Latest_Mth_AJOVY_TRx,
 Latest_Mth_AJOVY_Share_Percent,
 Lives_Covered_Total,
 Ajovy_Formulary_Status,
 Aimovig_Formulary_Status,
 Emgality_Formulary_Status,
 Plan_Payment_Type,
 Priority_Account_flag,
 Justification,
 Plan_Mapping
)
AS
 SELECT zs_teva_payer_master.plan_code,
        zs_teva_payer_master.Final_Key_Controlling_Account,
        zs_teva_payer_master.Key_Parent_Account,
        zs_teva_payer_master.PBM,
        zs_teva_payer_master.Payer,
        zs_teva_payer_master.Plan,
        zs_teva_payer_master.State_Code,
        zs_teva_payer_master.AJOVY_TRx,
        zs_teva_payer_master.Aimovig_TRx,
        zs_teva_payer_master.Emgality_TRx,
        zs_teva_payer_master.aCGRP_TRx,
        zs_teva_payer_master.AJOVY_Share_Percent,
        zs_teva_payer_master.Aimovig_Share_Percent,
        zs_teva_payer_master.Emgality_Share_Percent,
        zs_teva_payer_master.Latest_Mth_AJOVY_TRx,
        zs_teva_payer_master.Latest_Mth_AJOVY_Share_Percent,
        zs_teva_payer_master.Lives_Covered_Total,
        zs_teva_payer_master.Ajovy_Formulary_Status,
        zs_teva_payer_master.Aimovig_Formulary_Status,
        zs_teva_payer_master.Emgality_Formulary_Status,
        zs_teva_payer_master.Plan_Payment_Type,
        zs_teva_payer_master.Priority_Account_flag,
        zs_teva_payer_master.Justification,
        zs_teva_payer_master.Plan_Mapping
 FROM sandbox.zs_teva_payer_master
 ORDER BY zs_teva_payer_master.plan_code,
          zs_teva_payer_master.Final_Key_Controlling_Account,
          zs_teva_payer_master.Key_Parent_Account,
          zs_teva_payer_master.PBM,
          zs_teva_payer_master.Payer,
          zs_teva_payer_master.Plan,
          zs_teva_payer_master.State_Code,
          zs_teva_payer_master.AJOVY_TRx
SEGMENTED BY hash(zs_teva_payer_master.AJOVY_TRx, zs_teva_payer_master.Aimovig_TRx, zs_teva_payer_master.Emgality_TRx, zs_teva_payer_master.aCGRP_TRx, zs_teva_payer_master.Latest_Mth_AJOVY_TRx, zs_teva_payer_master.Lives_Covered_Total, zs_teva_payer_master.plan_code, zs_teva_payer_master.AJOVY_Share_Percent) ALL NODES;

CREATE PROJECTION sandbox.idl_just_best_address_b0 /*+basename(idl_just_best_address),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT idl_just_best_address.cust_id,
        idl_just_best_address.organization_name,
        idl_just_best_address.contact_type,
        idl_just_best_address.first_name,
        idl_just_best_address.middle_name,
        idl_just_best_address.last_name,
        idl_just_best_address.suffix,
        idl_just_best_address.npi,
        idl_just_best_address.address_line_1,
        idl_just_best_address.address_line_2,
        idl_just_best_address.city,
        idl_just_best_address.state,
        idl_just_best_address.zipcode,
        idl_just_best_address.sln,
        idl_just_best_address.sln_state,
        idl_just_best_address.dea,
        idl_just_best_address.affiliation,
        idl_just_best_address.credential,
        idl_just_best_address.healthcare_professional_status_code,
        idl_just_best_address.create_date
 FROM sandbox.idl_just_best_address
 ORDER BY idl_just_best_address.cust_id,
          idl_just_best_address.first_name,
          idl_just_best_address.middle_name,
          idl_just_best_address.last_name,
          idl_just_best_address.suffix,
          idl_just_best_address.npi,
          idl_just_best_address.address_line_1,
          idl_just_best_address.address_line_2,
          idl_just_best_address.city,
          idl_just_best_address.state,
          idl_just_best_address.zipcode,
          idl_just_best_address.sln,
          idl_just_best_address.sln_state,
          idl_just_best_address.dea,
          idl_just_best_address.credential,
          idl_just_best_address.healthcare_professional_status_code
SEGMENTED BY hash(idl_just_best_address.cust_id, idl_just_best_address.first_name, idl_just_best_address.middle_name, idl_just_best_address.last_name, idl_just_best_address.suffix, idl_just_best_address.npi, idl_just_best_address.address_line_1, idl_just_best_address.address_line_2, idl_just_best_address.city, idl_just_best_address.state, idl_just_best_address.zipcode, idl_just_best_address.sln, idl_just_best_address.sln_state, idl_just_best_address.dea, idl_just_best_address.credential, idl_just_best_address.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.test_wprefix_as_b0 /*+basename(test_wprefix_as),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT test_wprefix_as.cust_id,
        test_wprefix_as.organization_name,
        test_wprefix_as.contact_type,
        test_wprefix_as.first_name,
        test_wprefix_as.middle_name,
        test_wprefix_as.last_name,
        test_wprefix_as.suffix,
        test_wprefix_as.npi,
        test_wprefix_as.address_line_1,
        test_wprefix_as.address_line_2,
        test_wprefix_as.city,
        test_wprefix_as.state,
        test_wprefix_as.zipcode,
        test_wprefix_as.sln,
        test_wprefix_as.sln_state,
        test_wprefix_as.dea,
        test_wprefix_as.affiliation,
        test_wprefix_as.credential,
        test_wprefix_as.healthcare_professional_status_code,
        test_wprefix_as.create_date
 FROM sandbox.test_wprefix_as
 ORDER BY test_wprefix_as.cust_id,
          test_wprefix_as.first_name,
          test_wprefix_as.middle_name,
          test_wprefix_as.last_name,
          test_wprefix_as.suffix,
          test_wprefix_as.npi,
          test_wprefix_as.address_line_1,
          test_wprefix_as.address_line_2,
          test_wprefix_as.city,
          test_wprefix_as.state,
          test_wprefix_as.zipcode,
          test_wprefix_as.sln,
          test_wprefix_as.sln_state,
          test_wprefix_as.dea,
          test_wprefix_as.credential,
          test_wprefix_as.healthcare_professional_status_code
SEGMENTED BY hash(test_wprefix_as.cust_id, test_wprefix_as.first_name, test_wprefix_as.middle_name, test_wprefix_as.last_name, test_wprefix_as.suffix, test_wprefix_as.npi, test_wprefix_as.address_line_1, test_wprefix_as.address_line_2, test_wprefix_as.city, test_wprefix_as.state, test_wprefix_as.zipcode, test_wprefix_as.sln, test_wprefix_as.sln_state, test_wprefix_as.dea, test_wprefix_as.credential, test_wprefix_as.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.TV46K_LAI_b0 /*+basename(TV46K_LAI),createtype(L)*/ 
(
 "IMS ID",
 TRx_Count_APD,
 Decile_APD,
 TRx_Count_LAI,
 Decile_LAI,
 "Specialty Code",
 "Specialty Group"
)
AS
 SELECT TV46K_LAI."IMS ID",
        TV46K_LAI.TRx_Count_APD,
        TV46K_LAI.Decile_APD,
        TV46K_LAI.TRx_Count_LAI,
        TV46K_LAI.Decile_LAI,
        TV46K_LAI."Specialty Code",
        TV46K_LAI."Specialty Group"
 FROM sandbox.TV46K_LAI
 ORDER BY TV46K_LAI."IMS ID",
          TV46K_LAI.TRx_Count_APD,
          TV46K_LAI.Decile_APD,
          TV46K_LAI.TRx_Count_LAI,
          TV46K_LAI.Decile_LAI,
          TV46K_LAI."Specialty Code",
          TV46K_LAI."Specialty Group"
SEGMENTED BY hash(TV46K_LAI."IMS ID", TV46K_LAI.Decile_APD, TV46K_LAI.Decile_LAI, TV46K_LAI.TRx_Count_APD, TV46K_LAI.TRx_Count_LAI, TV46K_LAI."Specialty Code", TV46K_LAI."Specialty Group") ALL NODES;

CREATE PROJECTION sandbox."SYNEOS TARGET FILE_b0" /*+basename(SYNEOS TARGET FILE),createtype(L)*/ 
(
 ims_id,
 tvcmid,
 basket_id,
 basket_name,
 territory_number,
 sales_force_id,
 flag_type,
 flag_value,
 flag_effective_start_date,
 flag_effective_end_date
)
AS
 SELECT "SYNEOS TARGET FILE".ims_id,
        "SYNEOS TARGET FILE".tvcmid,
        "SYNEOS TARGET FILE".basket_id,
        "SYNEOS TARGET FILE".basket_name,
        "SYNEOS TARGET FILE".territory_number,
        "SYNEOS TARGET FILE".sales_force_id,
        "SYNEOS TARGET FILE".flag_type,
        "SYNEOS TARGET FILE".flag_value,
        "SYNEOS TARGET FILE".flag_effective_start_date,
        "SYNEOS TARGET FILE".flag_effective_end_date
 FROM sandbox."SYNEOS TARGET FILE"
 ORDER BY "SYNEOS TARGET FILE".ims_id,
          "SYNEOS TARGET FILE".tvcmid,
          "SYNEOS TARGET FILE".basket_id,
          "SYNEOS TARGET FILE".basket_name,
          "SYNEOS TARGET FILE".territory_number,
          "SYNEOS TARGET FILE".sales_force_id,
          "SYNEOS TARGET FILE".flag_type,
          "SYNEOS TARGET FILE".flag_value
SEGMENTED BY hash("SYNEOS TARGET FILE".ims_id, "SYNEOS TARGET FILE".tvcmid, "SYNEOS TARGET FILE".basket_id, "SYNEOS TARGET FILE".flag_effective_start_date, "SYNEOS TARGET FILE".flag_effective_end_date, "SYNEOS TARGET FILE".basket_name, "SYNEOS TARGET FILE".territory_number, "SYNEOS TARGET FILE".sales_force_id) ALL NODES;

CREATE PROJECTION sandbox."IMS ID ISSUE_AUSTEDO_10262020_b0" /*+basename(IMS ID ISSUE_AUSTEDO_10262020),createtype(L)*/ 
(
 "IMS ID"
)
AS
 SELECT "IMS ID ISSUE_AUSTEDO_10262020"."IMS ID"
 FROM sandbox."IMS ID ISSUE_AUSTEDO_10262020"
 ORDER BY "IMS ID ISSUE_AUSTEDO_10262020"."IMS ID"
SEGMENTED BY hash("IMS ID ISSUE_AUSTEDO_10262020"."IMS ID") ALL NODES;

CREATE PROJECTION sandbox.pgk_my_sandbox_b0 /*+basename(pgk_my_sandbox),createtype(L)*/ 
(
 "IMS ID",
 Decile,
 TVCMID,
 "First Name",
 "Last Name",
 "Middle Name",
 Suffix,
 "Address 1",
 "Address 2",
 "Address 3",
 City,
 State,
 Zip,
 "SLN 1",
 "SLN 1 Expiration Date",
 "SLN 2",
 "SLN 2 State",
 "SLN 2 Expiration Date",
 Specialty,
 "Specialty Description",
 "Specialty Group",
 "IMS ID_1",
 NPI,
 DEA,
 Designation,
 Decile_1,
 "Email Rented?",
 "Dup IMS ID"
)
AS
 SELECT pgk_my_sandbox."IMS ID",
        pgk_my_sandbox.Decile,
        pgk_my_sandbox.TVCMID,
        pgk_my_sandbox."First Name",
        pgk_my_sandbox."Last Name",
        pgk_my_sandbox."Middle Name",
        pgk_my_sandbox.Suffix,
        pgk_my_sandbox."Address 1",
        pgk_my_sandbox."Address 2",
        pgk_my_sandbox."Address 3",
        pgk_my_sandbox.City,
        pgk_my_sandbox.State,
        pgk_my_sandbox.Zip,
        pgk_my_sandbox."SLN 1",
        pgk_my_sandbox."SLN 1 Expiration Date",
        pgk_my_sandbox."SLN 2",
        pgk_my_sandbox."SLN 2 State",
        pgk_my_sandbox."SLN 2 Expiration Date",
        pgk_my_sandbox.Specialty,
        pgk_my_sandbox."Specialty Description",
        pgk_my_sandbox."Specialty Group",
        pgk_my_sandbox."IMS ID_1",
        pgk_my_sandbox.NPI,
        pgk_my_sandbox.DEA,
        pgk_my_sandbox.Designation,
        pgk_my_sandbox.Decile_1,
        pgk_my_sandbox."Email Rented?",
        pgk_my_sandbox."Dup IMS ID"
 FROM sandbox.pgk_my_sandbox
 ORDER BY pgk_my_sandbox."IMS ID",
          pgk_my_sandbox.Decile,
          pgk_my_sandbox.TVCMID,
          pgk_my_sandbox."First Name",
          pgk_my_sandbox."Last Name",
          pgk_my_sandbox."Middle Name",
          pgk_my_sandbox.Suffix,
          pgk_my_sandbox."Address 1"
SEGMENTED BY hash(pgk_my_sandbox."IMS ID", pgk_my_sandbox.Decile, pgk_my_sandbox.TVCMID, pgk_my_sandbox.Zip, pgk_my_sandbox."IMS ID_1", pgk_my_sandbox.Decile_1, pgk_my_sandbox."SLN 1", pgk_my_sandbox."SLN 1 Expiration Date") ALL NODES;

CREATE PROJECTION sandbox.tmp_demo_rank1_b0 /*+basename(tmp_demo_rank1),createtype(A)*/ 
(
 veeva_account_id,
 territory_number,
 demo_rank
)
AS
 SELECT tmp_demo_rank1.veeva_account_id,
        tmp_demo_rank1.territory_number,
        tmp_demo_rank1.demo_rank
 FROM sandbox.tmp_demo_rank1
 ORDER BY tmp_demo_rank1.veeva_account_id,
          tmp_demo_rank1.territory_number,
          tmp_demo_rank1.demo_rank
SEGMENTED BY hash(tmp_demo_rank1.territory_number, tmp_demo_rank1.demo_rank, tmp_demo_rank1.veeva_account_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_demo_rank2_b0 /*+basename(tmp_demo_rank2),createtype(A)*/ 
(
 veeva_account_id,
 territory_number,
 demo_rank
)
AS
 SELECT tmp_demo_rank2.veeva_account_id,
        tmp_demo_rank2.territory_number,
        tmp_demo_rank2.demo_rank
 FROM sandbox.tmp_demo_rank2
 ORDER BY tmp_demo_rank2.territory_number
SEGMENTED BY hash(tmp_demo_rank2.territory_number, tmp_demo_rank2.demo_rank, tmp_demo_rank2.veeva_account_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_lat_lon_sfa_b0 /*+basename(tmp_lat_lon_sfa),createtype(A)*/ 
(
 address_id,
 tvcmid,
 address_latitude,
 address_longitude,
 veeva_address_id,
 rnk
)
AS
 SELECT tmp_lat_lon_sfa.address_id,
        tmp_lat_lon_sfa.tvcmid,
        tmp_lat_lon_sfa.address_latitude,
        tmp_lat_lon_sfa.address_longitude,
        tmp_lat_lon_sfa.veeva_address_id,
        tmp_lat_lon_sfa.rnk
 FROM sandbox.tmp_lat_lon_sfa
 ORDER BY tmp_lat_lon_sfa.tvcmid
SEGMENTED BY hash(tmp_lat_lon_sfa.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_jan2020_b0 /*+basename(ic_rx_jan2020),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_jan2021.ic_data_month,
        ic_rx_jan2021.basket_name,
        ic_rx_jan2021.sales_force_id,
        ic_rx_jan2021.area_number,
        ic_rx_jan2021.region_number,
        ic_rx_jan2021.territory_number,
        ic_rx_jan2021.ims_id,
        ic_rx_jan2021.tvcmid,
        ic_rx_jan2021.outlet_code,
        ic_rx_jan2021.va_station_number,
        ic_rx_jan2021.dnc_flag,
        ic_rx_jan2021.dnp_flag,
        ic_rx_jan2021.rollup_month,
        ic_rx_jan2021.month_bucket,
        ic_rx_jan2021.nrx_count,
        ic_rx_jan2021.trx_count,
        ic_rx_jan2021.nrx_quantity,
        ic_rx_jan2021.trx_quantity,
        ic_rx_jan2021.include_in_nation_rollup,
        ic_rx_jan2021.include_in_area_rollup,
        ic_rx_jan2021.include_in_region_rollup,
        ic_rx_jan2021.join_key,
        ic_rx_jan2021.row_source,
        ic_rx_jan2021.row_create_date,
        ic_rx_jan2021.indication,
        ic_rx_jan2021.outlet_dea,
        ic_rx_jan2021.payer_plan_number,
        ic_rx_jan2021.payment_method
 FROM sandbox.ic_rx_jan2021
 ORDER BY ic_rx_jan2021.ic_data_month,
          ic_rx_jan2021.basket_name,
          ic_rx_jan2021.sales_force_id,
          ic_rx_jan2021.area_number,
          ic_rx_jan2021.region_number,
          ic_rx_jan2021.territory_number,
          ic_rx_jan2021.ims_id,
          ic_rx_jan2021.tvcmid
SEGMENTED BY hash(ic_rx_jan2021.ic_data_month, ic_rx_jan2021.tvcmid, ic_rx_jan2021.outlet_code, ic_rx_jan2021.dnc_flag, ic_rx_jan2021.dnp_flag, ic_rx_jan2021.rollup_month, ic_rx_jan2021.month_bucket, ic_rx_jan2021.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_jan2020_b0 /*+basename(ic_demo_jan2020),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_jan2021.ic_data_month,
        ic_demo_jan2021.sales_force_id,
        ic_demo_jan2021.area_number,
        ic_demo_jan2021.region_number,
        ic_demo_jan2021.territory_number,
        ic_demo_jan2021.ims_id,
        ic_demo_jan2021.tvcmid,
        ic_demo_jan2021.outlet_code,
        ic_demo_jan2021.va_station_number,
        ic_demo_jan2021.specialty,
        ic_demo_jan2021.last_name,
        ic_demo_jan2021.first_name,
        ic_demo_jan2021.mid_name,
        ic_demo_jan2021.address_1,
        ic_demo_jan2021.address_2,
        ic_demo_jan2021.address_3,
        ic_demo_jan2021.city,
        ic_demo_jan2021.state,
        ic_demo_jan2021.zip,
        ic_demo_jan2021.address_source,
        ic_demo_jan2021.pdrp_flag,
        ic_demo_jan2021.pdrp_date,
        ic_demo_jan2021.np_pa_flag,
        ic_demo_jan2021.no_spend,
        ic_demo_jan2021.ama_no_contact_flag,
        ic_demo_jan2021.join_key,
        ic_demo_jan2021.row_source,
        ic_demo_jan2021.row_create_date,
        ic_demo_jan2021.outlet_dea,
        ic_demo_jan2021.secondary_specialty
 FROM sandbox.ic_demo_jan2021
 ORDER BY ic_demo_jan2021.ic_data_month,
          ic_demo_jan2021.sales_force_id,
          ic_demo_jan2021.area_number,
          ic_demo_jan2021.region_number,
          ic_demo_jan2021.territory_number,
          ic_demo_jan2021.ims_id,
          ic_demo_jan2021.tvcmid,
          ic_demo_jan2021.outlet_code
SEGMENTED BY hash(ic_demo_jan2021.ic_data_month, ic_demo_jan2021.tvcmid, ic_demo_jan2021.outlet_code, ic_demo_jan2021.mid_name, ic_demo_jan2021.state, ic_demo_jan2021.zip, ic_demo_jan2021.pdrp_flag, ic_demo_jan2021.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.mb_to_weekly_account_summary_b0 /*+basename(mb_to_weekly_account_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 target,
 new_account,
 market_volume_indicator,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg
)
AS
 SELECT mb_to_weekly_account_summary.sales_force_id,
        mb_to_weekly_account_summary.nation_id,
        mb_to_weekly_account_summary.nation,
        mb_to_weekly_account_summary.area_id,
        mb_to_weekly_account_summary.area,
        mb_to_weekly_account_summary.region_id,
        mb_to_weekly_account_summary.region,
        mb_to_weekly_account_summary.territory_id,
        mb_to_weekly_account_summary.territory,
        mb_to_weekly_account_summary.rep_name,
        mb_to_weekly_account_summary.user_id,
        mb_to_weekly_account_summary.time_period,
        mb_to_weekly_account_summary.period_type,
        mb_to_weekly_account_summary.period,
        mb_to_weekly_account_summary.market_id,
        mb_to_weekly_account_summary.market_name,
        mb_to_weekly_account_summary.brand_id,
        mb_to_weekly_account_summary.brand_name,
        mb_to_weekly_account_summary.teva_product_flag,
        mb_to_weekly_account_summary.customer_id,
        mb_to_weekly_account_summary.tvcmid,
        mb_to_weekly_account_summary.network_name,
        mb_to_weekly_account_summary.account_name,
        mb_to_weekly_account_summary.channel,
        mb_to_weekly_account_summary.address,
        mb_to_weekly_account_summary.city,
        mb_to_weekly_account_summary.state,
        mb_to_weekly_account_summary.zip,
        mb_to_weekly_account_summary.formulary_control,
        mb_to_weekly_account_summary.gpo,
        mb_to_weekly_account_summary.target,
        mb_to_weekly_account_summary.new_account,
        mb_to_weekly_account_summary.market_volume_indicator,
        mb_to_weekly_account_summary.product_vol_dollars,
        mb_to_weekly_account_summary.product_vol_mg,
        mb_to_weekly_account_summary.product_vol_mcg,
        mb_to_weekly_account_summary.market_vol_dollars,
        mb_to_weekly_account_summary.market_vol_mg,
        mb_to_weekly_account_summary.market_vol_mcg,
        mb_to_weekly_account_summary.prev_prod_vol_dollars,
        mb_to_weekly_account_summary.prev_prod_vol_mg,
        mb_to_weekly_account_summary.prev_prod_vol_mcg,
        mb_to_weekly_account_summary.prev_market_vol_dollars,
        mb_to_weekly_account_summary.prev_market_vol_mg,
        mb_to_weekly_account_summary.prev_market_vol_mcg
 FROM sandbox.mb_to_weekly_account_summary
 ORDER BY mb_to_weekly_account_summary.sales_force_id,
          mb_to_weekly_account_summary.nation_id,
          mb_to_weekly_account_summary.nation,
          mb_to_weekly_account_summary.area_id,
          mb_to_weekly_account_summary.area,
          mb_to_weekly_account_summary.region_id,
          mb_to_weekly_account_summary.region,
          mb_to_weekly_account_summary.territory_id
SEGMENTED BY hash(mb_to_weekly_account_summary.sales_force_id, mb_to_weekly_account_summary.market_id, mb_to_weekly_account_summary.brand_id, mb_to_weekly_account_summary.teva_product_flag, mb_to_weekly_account_summary.tvcmid, mb_to_weekly_account_summary.state, mb_to_weekly_account_summary.zip, mb_to_weekly_account_summary.new_account) ALL NODES;

CREATE PROJECTION sandbox.newman_products_b0 /*+basename(newman_products),createtype(L)*/ 
(
 sfa,
 cne,
 hcp,
 consumer,
 item_id,
 product_line,
 product_name,
 Organization,
 Description,
 expiration_date,
 deleted_date,
 status,
 approval_number,
 available_qty,
 category,
 cost
)
AS
 SELECT newman_products.sfa,
        newman_products.cne,
        newman_products.hcp,
        newman_products.consumer,
        newman_products.item_id,
        newman_products.product_line,
        newman_products.product_name,
        newman_products.Organization,
        newman_products.Description,
        newman_products.expiration_date,
        newman_products.deleted_date,
        newman_products.status,
        newman_products.approval_number,
        newman_products.available_qty,
        newman_products.category,
        newman_products.cost
 FROM sandbox.newman_products
 ORDER BY newman_products.sfa,
          newman_products.cne,
          newman_products.hcp,
          newman_products.consumer,
          newman_products.item_id,
          newman_products.product_line,
          newman_products.product_name,
          newman_products.Organization
SEGMENTED BY hash(newman_products.sfa, newman_products.cne, newman_products.hcp, newman_products.expiration_date, newman_products.deleted_date, newman_products.available_qty, newman_products.cost, newman_products.consumer) ALL NODES;

CREATE PROJECTION sandbox.activity_line_level_b0 /*+basename(activity_line_level),createtype(L)*/ 
(
 activityid,
 level,
 basket_name
)
AS
 SELECT activity_line_level.activityid,
        activity_line_level.level,
        activity_line_level.basket_name
 FROM sandbox.activity_line_level
 ORDER BY activity_line_level.activityid,
          activity_line_level.level
SEGMENTED BY hash(activity_line_level.activityid, activity_line_level.level) ALL NODES;

CREATE PROJECTION sandbox.activity_line_item_level_b0 /*+basename(activity_line_item_level),createtype(L)*/ 
(
 activityid,
 level
)
AS
 SELECT activity_line_item_level.activityid,
        activity_line_item_level.level
 FROM sandbox.activity_line_item_level
 ORDER BY activity_line_item_level.activityid,
          activity_line_item_level.level
SEGMENTED BY hash(activity_line_item_level.level, activity_line_item_level.activityid) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_feb2021_b0 /*+basename(ic_rx_feb2021),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_feb2021.ic_data_month,
        ic_rx_feb2021.basket_name,
        ic_rx_feb2021.sales_force_id,
        ic_rx_feb2021.area_number,
        ic_rx_feb2021.region_number,
        ic_rx_feb2021.territory_number,
        ic_rx_feb2021.ims_id,
        ic_rx_feb2021.tvcmid,
        ic_rx_feb2021.outlet_code,
        ic_rx_feb2021.va_station_number,
        ic_rx_feb2021.dnc_flag,
        ic_rx_feb2021.dnp_flag,
        ic_rx_feb2021.rollup_month,
        ic_rx_feb2021.month_bucket,
        ic_rx_feb2021.nrx_count,
        ic_rx_feb2021.trx_count,
        ic_rx_feb2021.nrx_quantity,
        ic_rx_feb2021.trx_quantity,
        ic_rx_feb2021.include_in_nation_rollup,
        ic_rx_feb2021.include_in_area_rollup,
        ic_rx_feb2021.include_in_region_rollup,
        ic_rx_feb2021.join_key,
        ic_rx_feb2021.row_source,
        ic_rx_feb2021.row_create_date,
        ic_rx_feb2021.indication,
        ic_rx_feb2021.outlet_dea,
        ic_rx_feb2021.payer_plan_number,
        ic_rx_feb2021.payment_method
 FROM sandbox.ic_rx_feb2021
 ORDER BY ic_rx_feb2021.ic_data_month,
          ic_rx_feb2021.basket_name,
          ic_rx_feb2021.sales_force_id,
          ic_rx_feb2021.area_number,
          ic_rx_feb2021.region_number,
          ic_rx_feb2021.territory_number,
          ic_rx_feb2021.ims_id,
          ic_rx_feb2021.tvcmid
SEGMENTED BY hash(ic_rx_feb2021.ic_data_month, ic_rx_feb2021.tvcmid, ic_rx_feb2021.outlet_code, ic_rx_feb2021.dnc_flag, ic_rx_feb2021.dnp_flag, ic_rx_feb2021.rollup_month, ic_rx_feb2021.month_bucket, ic_rx_feb2021.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_feb2021_b0 /*+basename(ic_demo_feb2021),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_feb2021.ic_data_month,
        ic_demo_feb2021.sales_force_id,
        ic_demo_feb2021.area_number,
        ic_demo_feb2021.region_number,
        ic_demo_feb2021.territory_number,
        ic_demo_feb2021.ims_id,
        ic_demo_feb2021.tvcmid,
        ic_demo_feb2021.outlet_code,
        ic_demo_feb2021.va_station_number,
        ic_demo_feb2021.specialty,
        ic_demo_feb2021.last_name,
        ic_demo_feb2021.first_name,
        ic_demo_feb2021.mid_name,
        ic_demo_feb2021.address_1,
        ic_demo_feb2021.address_2,
        ic_demo_feb2021.address_3,
        ic_demo_feb2021.city,
        ic_demo_feb2021.state,
        ic_demo_feb2021.zip,
        ic_demo_feb2021.address_source,
        ic_demo_feb2021.pdrp_flag,
        ic_demo_feb2021.pdrp_date,
        ic_demo_feb2021.np_pa_flag,
        ic_demo_feb2021.no_spend,
        ic_demo_feb2021.ama_no_contact_flag,
        ic_demo_feb2021.join_key,
        ic_demo_feb2021.row_source,
        ic_demo_feb2021.row_create_date,
        ic_demo_feb2021.outlet_dea,
        ic_demo_feb2021.secondary_specialty
 FROM sandbox.ic_demo_feb2021
 ORDER BY ic_demo_feb2021.ic_data_month,
          ic_demo_feb2021.sales_force_id,
          ic_demo_feb2021.area_number,
          ic_demo_feb2021.region_number,
          ic_demo_feb2021.territory_number,
          ic_demo_feb2021.ims_id,
          ic_demo_feb2021.tvcmid,
          ic_demo_feb2021.outlet_code
SEGMENTED BY hash(ic_demo_feb2021.ic_data_month, ic_demo_feb2021.tvcmid, ic_demo_feb2021.outlet_code, ic_demo_feb2021.mid_name, ic_demo_feb2021.state, ic_demo_feb2021.zip, ic_demo_feb2021.pdrp_flag, ic_demo_feb2021.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_apr2021_b0 /*+basename(ic_rx_apr2021),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_apr2021.ic_data_month,
        ic_rx_apr2021.basket_name,
        ic_rx_apr2021.sales_force_id,
        ic_rx_apr2021.area_number,
        ic_rx_apr2021.region_number,
        ic_rx_apr2021.territory_number,
        ic_rx_apr2021.ims_id,
        ic_rx_apr2021.tvcmid,
        ic_rx_apr2021.outlet_code,
        ic_rx_apr2021.va_station_number,
        ic_rx_apr2021.dnc_flag,
        ic_rx_apr2021.dnp_flag,
        ic_rx_apr2021.rollup_month,
        ic_rx_apr2021.month_bucket,
        ic_rx_apr2021.nrx_count,
        ic_rx_apr2021.trx_count,
        ic_rx_apr2021.nrx_quantity,
        ic_rx_apr2021.trx_quantity,
        ic_rx_apr2021.include_in_nation_rollup,
        ic_rx_apr2021.include_in_area_rollup,
        ic_rx_apr2021.include_in_region_rollup,
        ic_rx_apr2021.join_key,
        ic_rx_apr2021.row_source,
        ic_rx_apr2021.row_create_date,
        ic_rx_apr2021.indication,
        ic_rx_apr2021.outlet_dea,
        ic_rx_apr2021.payer_plan_number,
        ic_rx_apr2021.payment_method
 FROM sandbox.ic_rx_apr2021
 ORDER BY ic_rx_apr2021.ic_data_month,
          ic_rx_apr2021.basket_name,
          ic_rx_apr2021.sales_force_id,
          ic_rx_apr2021.area_number,
          ic_rx_apr2021.region_number,
          ic_rx_apr2021.territory_number,
          ic_rx_apr2021.ims_id,
          ic_rx_apr2021.tvcmid
SEGMENTED BY hash(ic_rx_apr2021.ic_data_month, ic_rx_apr2021.tvcmid, ic_rx_apr2021.outlet_code, ic_rx_apr2021.dnc_flag, ic_rx_apr2021.dnp_flag, ic_rx_apr2021.rollup_month, ic_rx_apr2021.month_bucket, ic_rx_apr2021.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_apr2021_b0 /*+basename(ic_demo_apr2021),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_apr2021.ic_data_month,
        ic_demo_apr2021.sales_force_id,
        ic_demo_apr2021.area_number,
        ic_demo_apr2021.region_number,
        ic_demo_apr2021.territory_number,
        ic_demo_apr2021.ims_id,
        ic_demo_apr2021.tvcmid,
        ic_demo_apr2021.outlet_code,
        ic_demo_apr2021.va_station_number,
        ic_demo_apr2021.specialty,
        ic_demo_apr2021.last_name,
        ic_demo_apr2021.first_name,
        ic_demo_apr2021.mid_name,
        ic_demo_apr2021.address_1,
        ic_demo_apr2021.address_2,
        ic_demo_apr2021.address_3,
        ic_demo_apr2021.city,
        ic_demo_apr2021.state,
        ic_demo_apr2021.zip,
        ic_demo_apr2021.address_source,
        ic_demo_apr2021.pdrp_flag,
        ic_demo_apr2021.pdrp_date,
        ic_demo_apr2021.np_pa_flag,
        ic_demo_apr2021.no_spend,
        ic_demo_apr2021.ama_no_contact_flag,
        ic_demo_apr2021.join_key,
        ic_demo_apr2021.row_source,
        ic_demo_apr2021.row_create_date,
        ic_demo_apr2021.outlet_dea,
        ic_demo_apr2021.secondary_specialty
 FROM sandbox.ic_demo_apr2021
 ORDER BY ic_demo_apr2021.ic_data_month,
          ic_demo_apr2021.sales_force_id,
          ic_demo_apr2021.area_number,
          ic_demo_apr2021.region_number,
          ic_demo_apr2021.territory_number,
          ic_demo_apr2021.ims_id,
          ic_demo_apr2021.tvcmid,
          ic_demo_apr2021.outlet_code
SEGMENTED BY hash(ic_demo_apr2021.ic_data_month, ic_demo_apr2021.tvcmid, ic_demo_apr2021.outlet_code, ic_demo_apr2021.mid_name, ic_demo_apr2021.state, ic_demo_apr2021.zip, ic_demo_apr2021.pdrp_flag, ic_demo_apr2021.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.payer_demo_b0 /*+basename(payer_demo),createtype(L)*/ 
(
 payer_id,
 payer_name
)
AS
 SELECT payer_demo.payer_id,
        payer_demo.payer_name
 FROM sandbox.payer_demo
 ORDER BY payer_demo.payer_id,
          payer_demo.payer_name
SEGMENTED BY hash(payer_demo.payer_id, payer_demo.payer_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_formularies_b0 /*+basename(ftf_formularies),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 file_id,
 record_id
)
AS
 SELECT ftf_formularies.health_plan_id,
        ftf_formularies.drug_id,
        ftf_formularies.tier_code,
        ftf_formularies.restrictions,
        ftf_formularies.reason_code,
        ftf_formularies.reason_code_description,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM sandbox.ftf_formularies
 ORDER BY ftf_formularies.health_plan_id,
          ftf_formularies.drug_id,
          ftf_formularies.tier_code,
          ftf_formularies.restrictions,
          ftf_formularies.reason_code,
          ftf_formularies.reason_code_description,
          ftf_formularies.file_id,
          ftf_formularies.record_id
SEGMENTED BY hash(ftf_formularies.record_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plans_b0 /*+basename(ftf_health_plans),createtype(A)*/ 
(
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier,
 file_id,
 record_id
)
AS
 SELECT ftf_health_plans.formularyf_id,
        ftf_health_plans.provider_id,
        ftf_health_plans.provider,
        ftf_health_plans.health_plan_id,
        ftf_health_plans.health_plan,
        ftf_health_plans.parent_id,
        ftf_health_plans.parent,
        ftf_health_plans.national_lives_count,
        ftf_health_plans.plan_type_name,
        ftf_health_plans.preferred_brand_tier,
        ftf_health_plans.file_id,
        ftf_health_plans.record_id
 FROM sandbox.ftf_health_plans
 ORDER BY ftf_health_plans.formularyf_id,
          ftf_health_plans.provider_id,
          ftf_health_plans.provider,
          ftf_health_plans.health_plan_id,
          ftf_health_plans.health_plan,
          ftf_health_plans.parent_id,
          ftf_health_plans.parent,
          ftf_health_plans.national_lives_count,
          ftf_health_plans.plan_type_name,
          ftf_health_plans.preferred_brand_tier,
          ftf_health_plans.file_id,
          ftf_health_plans.record_id
SEGMENTED BY hash(ftf_health_plans.record_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbms_b0 /*+basename(ftf_pbms),createtype(A)*/ 
(
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 file_id,
 record_id
)
AS
 SELECT ftf_pbms.health_plan_id,
        ftf_pbms.pbm_id,
        ftf_pbms.pbm,
        ftf_pbms.pbm_function_id,
        ftf_pbms.pbm_function,
        ftf_pbms.file_id,
        ftf_pbms.record_id
 FROM sandbox.ftf_pbms
 ORDER BY ftf_pbms.health_plan_id,
          ftf_pbms.pbm_id,
          ftf_pbms.pbm,
          ftf_pbms.pbm_function_id,
          ftf_pbms.pbm_function,
          ftf_pbms.file_id,
          ftf_pbms.record_id
SEGMENTED BY hash(ftf_pbms.record_id) ALL NODES;

CREATE PROJECTION sandbox.ims_pbm_xref_b0 /*+basename(ims_pbm_xref),createtype(A)*/ 
(
 pbm_name,
 payer_plan_num,
 xref_to_payer_plan_num,
 ipd_id,
 ipd_type,
 plan_name,
 pbm_num,
 ims_processor_num,
 file_id,
 record_id
)
AS
 SELECT ims_pbm_xref.pbm_name,
        ims_pbm_xref.payer_plan_num,
        ims_pbm_xref.xref_to_payer_plan_num,
        ims_pbm_xref.ipd_id,
        ims_pbm_xref.ipd_type,
        ims_pbm_xref.plan_name,
        ims_pbm_xref.pbm_num,
        ims_pbm_xref.ims_processor_num,
        ims_pbm_xref.file_id,
        ims_pbm_xref.record_id
 FROM sandbox.ims_pbm_xref
 ORDER BY ims_pbm_xref.pbm_name,
          ims_pbm_xref.payer_plan_num,
          ims_pbm_xref.xref_to_payer_plan_num,
          ims_pbm_xref.ipd_id,
          ims_pbm_xref.ipd_type,
          ims_pbm_xref.plan_name,
          ims_pbm_xref.pbm_num,
          ims_pbm_xref.ims_processor_num
SEGMENTED BY hash(ims_pbm_xref.pbm_num, ims_pbm_xref.file_id, ims_pbm_xref.record_id, ims_pbm_xref.payer_plan_num, ims_pbm_xref.xref_to_payer_plan_num, ims_pbm_xref.ipd_id, ims_pbm_xref.ipd_type, ims_pbm_xref.ims_processor_num, ims_pbm_xref.pbm_name, ims_pbm_xref.plan_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_ims_bridge_b0 /*+basename(ftf_ims_bridge),createtype(A)*/ 
(
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name,
 file_id,
 record_id
)
AS
 SELECT ftf_ims_bridge.payer_name,
        ftf_ims_bridge.code,
        ftf_ims_bridge.name,
        ftf_ims_bridge.state,
        ftf_ims_bridge.comments,
        ftf_ims_bridge.plan_id,
        ftf_ims_bridge.plan_name,
        ftf_ims_bridge.provider_name,
        ftf_ims_bridge.plan_type_name,
        ftf_ims_bridge.file_id,
        ftf_ims_bridge.record_id
 FROM sandbox.ftf_ims_bridge
 ORDER BY ftf_ims_bridge.payer_name,
          ftf_ims_bridge.code,
          ftf_ims_bridge.name,
          ftf_ims_bridge.state,
          ftf_ims_bridge.comments,
          ftf_ims_bridge.plan_id,
          ftf_ims_bridge.plan_name,
          ftf_ims_bridge.provider_name,
          ftf_ims_bridge.plan_type_name,
          ftf_ims_bridge.file_id,
          ftf_ims_bridge.record_id
SEGMENTED BY hash(ftf_ims_bridge.record_id) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_restrictions_2_b0 /*+basename(raw_ftf_restrictions_2),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level
)
AS
 SELECT raw_ftf_restrictions_2.health_plan_id,
        raw_ftf_restrictions_2.drug_id,
        raw_ftf_restrictions_2.restriction_code,
        raw_ftf_restrictions_2.restriction_detail_id,
        raw_ftf_restrictions_2.restriction_detail_text,
        raw_ftf_restrictions_2.restriction_addtnl_information_1,
        raw_ftf_restrictions_2.restriction_addtnl_information_2,
        raw_ftf_restrictions_2.step_count,
        raw_ftf_restrictions_2.pa_form,
        raw_ftf_restrictions_2.indication,
        raw_ftf_restrictions_2.grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_2
 ORDER BY raw_ftf_restrictions_2.health_plan_id,
          raw_ftf_restrictions_2.drug_id,
          raw_ftf_restrictions_2.restriction_code,
          raw_ftf_restrictions_2.restriction_detail_id,
          raw_ftf_restrictions_2.restriction_detail_text,
          raw_ftf_restrictions_2.restriction_addtnl_information_1,
          raw_ftf_restrictions_2.restriction_addtnl_information_2,
          raw_ftf_restrictions_2.step_count
SEGMENTED BY hash(raw_ftf_restrictions_2.health_plan_id, raw_ftf_restrictions_2.drug_id, raw_ftf_restrictions_2.restriction_code, raw_ftf_restrictions_2.restriction_detail_id, raw_ftf_restrictions_2.step_count, raw_ftf_restrictions_2.restriction_detail_text, raw_ftf_restrictions_2.indication, raw_ftf_restrictions_2.grouped_restriction_level) ALL NODES;

CREATE PROJECTION sandbox.raw_access_master_bridge_b0 /*+basename(raw_access_master_bridge),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ajovy_coverage_category,
 aimovid_coverage_category,
 emgality_coverage_category,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 pay_type_index,
 pay_type,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 ftf_match_iqvia,
 lives_m1,
 lives_m2,
 lives_m3,
 lives_m4,
 lives_m5,
 lives_m6,
 lives_m7,
 lives_m8,
 lives_m9,
 lives_m10,
 lives_m11,
 lives_m12,
 lives_m13,
 lives_m14,
 lives_m15,
 lives_m16,
 lives_m17
)
AS
 SELECT raw_access_master_bridge.ftf_health_plan_fid,
        raw_access_master_bridge.ftf_health_plan_name,
        raw_access_master_bridge.ajovy_coverage_category,
        raw_access_master_bridge.aimovid_coverage_category,
        raw_access_master_bridge.emgality_coverage_category,
        raw_access_master_bridge.ftf_provider_fid,
        raw_access_master_bridge.ftf_provider_name,
        raw_access_master_bridge.ftf_parent_name,
        raw_access_master_bridge.pay_type_index,
        raw_access_master_bridge.pay_type,
        raw_access_master_bridge.ftf_health_plan_type,
        raw_access_master_bridge.key_controlling_plan_formulary,
        raw_access_master_bridge.key_controlling_account,
        raw_access_master_bridge.key_pbm,
        raw_access_master_bridge.iqvia_payer_name,
        raw_access_master_bridge.iqvia_pbm,
        raw_access_master_bridge.ftf_formulary_management_pbm,
        raw_access_master_bridge.ftf_formulary_influencer_pbm,
        raw_access_master_bridge.ftf_claims_processing_pbm,
        raw_access_master_bridge.pref_brand_tier,
        raw_access_master_bridge.ftf_match_iqvia,
        raw_access_master_bridge.lives_m1,
        raw_access_master_bridge.lives_m2,
        raw_access_master_bridge.lives_m3,
        raw_access_master_bridge.lives_m4,
        raw_access_master_bridge.lives_m5,
        raw_access_master_bridge.lives_m6,
        raw_access_master_bridge.lives_m7,
        raw_access_master_bridge.lives_m8,
        raw_access_master_bridge.lives_m9,
        raw_access_master_bridge.lives_m10,
        raw_access_master_bridge.lives_m11,
        raw_access_master_bridge.lives_m12,
        raw_access_master_bridge.lives_m13,
        raw_access_master_bridge.lives_m14,
        raw_access_master_bridge.lives_m15,
        raw_access_master_bridge.lives_m16,
        raw_access_master_bridge.lives_m17
 FROM sandbox.raw_access_master_bridge
 ORDER BY raw_access_master_bridge.ftf_health_plan_fid,
          raw_access_master_bridge.ftf_health_plan_name,
          raw_access_master_bridge.ajovy_coverage_category,
          raw_access_master_bridge.aimovid_coverage_category,
          raw_access_master_bridge.emgality_coverage_category,
          raw_access_master_bridge.ftf_provider_fid,
          raw_access_master_bridge.ftf_provider_name,
          raw_access_master_bridge.ftf_parent_name
SEGMENTED BY hash(raw_access_master_bridge.ftf_match_iqvia, raw_access_master_bridge.lives_m1, raw_access_master_bridge.lives_m2, raw_access_master_bridge.lives_m3, raw_access_master_bridge.lives_m4, raw_access_master_bridge.lives_m5, raw_access_master_bridge.lives_m6, raw_access_master_bridge.lives_m7) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_may2021_b0 /*+basename(ic_rx_may2021),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_may2021.ic_data_month,
        ic_rx_may2021.basket_name,
        ic_rx_may2021.sales_force_id,
        ic_rx_may2021.area_number,
        ic_rx_may2021.region_number,
        ic_rx_may2021.territory_number,
        ic_rx_may2021.ims_id,
        ic_rx_may2021.tvcmid,
        ic_rx_may2021.outlet_code,
        ic_rx_may2021.va_station_number,
        ic_rx_may2021.dnc_flag,
        ic_rx_may2021.dnp_flag,
        ic_rx_may2021.rollup_month,
        ic_rx_may2021.month_bucket,
        ic_rx_may2021.nrx_count,
        ic_rx_may2021.trx_count,
        ic_rx_may2021.nrx_quantity,
        ic_rx_may2021.trx_quantity,
        ic_rx_may2021.include_in_nation_rollup,
        ic_rx_may2021.include_in_area_rollup,
        ic_rx_may2021.include_in_region_rollup,
        ic_rx_may2021.join_key,
        ic_rx_may2021.row_source,
        ic_rx_may2021.row_create_date,
        ic_rx_may2021.indication,
        ic_rx_may2021.outlet_dea,
        ic_rx_may2021.payer_plan_number,
        ic_rx_may2021.payment_method
 FROM sandbox.ic_rx_may2021
 ORDER BY ic_rx_may2021.ic_data_month,
          ic_rx_may2021.basket_name,
          ic_rx_may2021.sales_force_id,
          ic_rx_may2021.area_number,
          ic_rx_may2021.region_number,
          ic_rx_may2021.territory_number,
          ic_rx_may2021.ims_id,
          ic_rx_may2021.tvcmid
SEGMENTED BY hash(ic_rx_may2021.ic_data_month, ic_rx_may2021.tvcmid, ic_rx_may2021.outlet_code, ic_rx_may2021.dnc_flag, ic_rx_may2021.dnp_flag, ic_rx_may2021.rollup_month, ic_rx_may2021.month_bucket, ic_rx_may2021.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_may2021_b0 /*+basename(ic_demo_may2021),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_may2021.ic_data_month,
        ic_demo_may2021.sales_force_id,
        ic_demo_may2021.area_number,
        ic_demo_may2021.region_number,
        ic_demo_may2021.territory_number,
        ic_demo_may2021.ims_id,
        ic_demo_may2021.tvcmid,
        ic_demo_may2021.outlet_code,
        ic_demo_may2021.va_station_number,
        ic_demo_may2021.specialty,
        ic_demo_may2021.last_name,
        ic_demo_may2021.first_name,
        ic_demo_may2021.mid_name,
        ic_demo_may2021.address_1,
        ic_demo_may2021.address_2,
        ic_demo_may2021.address_3,
        ic_demo_may2021.city,
        ic_demo_may2021.state,
        ic_demo_may2021.zip,
        ic_demo_may2021.address_source,
        ic_demo_may2021.pdrp_flag,
        ic_demo_may2021.pdrp_date,
        ic_demo_may2021.np_pa_flag,
        ic_demo_may2021.no_spend,
        ic_demo_may2021.ama_no_contact_flag,
        ic_demo_may2021.join_key,
        ic_demo_may2021.row_source,
        ic_demo_may2021.row_create_date,
        ic_demo_may2021.outlet_dea,
        ic_demo_may2021.secondary_specialty
 FROM sandbox.ic_demo_may2021
 ORDER BY ic_demo_may2021.ic_data_month,
          ic_demo_may2021.sales_force_id,
          ic_demo_may2021.area_number,
          ic_demo_may2021.region_number,
          ic_demo_may2021.territory_number,
          ic_demo_may2021.ims_id,
          ic_demo_may2021.tvcmid,
          ic_demo_may2021.outlet_code
SEGMENTED BY hash(ic_demo_may2021.ic_data_month, ic_demo_may2021.tvcmid, ic_demo_may2021.outlet_code, ic_demo_may2021.mid_name, ic_demo_may2021.state, ic_demo_may2021.zip, ic_demo_may2021.pdrp_flag, ic_demo_may2021.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.PGKMediCal_b0 /*+basename(PGKMediCal),createtype(L)*/ 
(
 "<NullColumn 0>",
 "<NullColumn 1>",
 "<NullColumn 2>",
 "<NullColumn 3>",
 "<NullColumn 4>",
 "<NullColumn 5>",
 "<NullColumn 6>",
 "<NullColumn 7>",
 "<NullColumn 8>",
 "<NullColumn 9>",
 "<NullColumn 10>",
 "<NullColumn 11>",
 "<NullColumn 12>"
)
AS
 SELECT PGKMediCal."<NullColumn 0>",
        PGKMediCal."<NullColumn 1>",
        PGKMediCal."<NullColumn 2>",
        PGKMediCal."<NullColumn 3>",
        PGKMediCal."<NullColumn 4>",
        PGKMediCal."<NullColumn 5>",
        PGKMediCal."<NullColumn 6>",
        PGKMediCal."<NullColumn 7>",
        PGKMediCal."<NullColumn 8>",
        PGKMediCal."<NullColumn 9>",
        PGKMediCal."<NullColumn 10>",
        PGKMediCal."<NullColumn 11>",
        PGKMediCal."<NullColumn 12>"
 FROM sandbox.PGKMediCal
 ORDER BY PGKMediCal."<NullColumn 0>",
          PGKMediCal."<NullColumn 1>",
          PGKMediCal."<NullColumn 2>",
          PGKMediCal."<NullColumn 3>",
          PGKMediCal."<NullColumn 4>",
          PGKMediCal."<NullColumn 5>",
          PGKMediCal."<NullColumn 6>",
          PGKMediCal."<NullColumn 7>"
SEGMENTED BY hash(PGKMediCal."<NullColumn 9>", PGKMediCal."<NullColumn 10>", PGKMediCal."<NullColumn 11>", PGKMediCal."<NullColumn 12>", PGKMediCal."<NullColumn 0>", PGKMediCal."<NullColumn 2>", PGKMediCal."<NullColumn 3>", PGKMediCal."<NullColumn 4>") ALL NODES;

CREATE PROJECTION sandbox.vid_npi_b0 /*+basename(vid_npi),createtype(L)*/ 
(
 vid,
 npi_num
)
AS
 SELECT vid_npi.vid,
        vid_npi.npi_num
 FROM sandbox.vid_npi
 ORDER BY vid_npi.vid,
          vid_npi.npi_num
SEGMENTED BY hash(vid_npi.npi_num, vid_npi.vid) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_formularies_v2_b0 /*+basename(raw_ftf_formularies_v2),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status
)
AS
 SELECT raw_ftf_formularies_v2.health_plan_id,
        raw_ftf_formularies_v2.drug_id,
        raw_ftf_formularies_v2.tier_code,
        raw_ftf_formularies_v2.restrictions,
        raw_ftf_formularies_v2.reason_code,
        raw_ftf_formularies_v2.reason_code_description,
        raw_ftf_formularies_v2.pharmacy_status
 FROM sandbox.raw_ftf_formularies_v2
 ORDER BY raw_ftf_formularies_v2.health_plan_id,
          raw_ftf_formularies_v2.drug_id,
          raw_ftf_formularies_v2.tier_code,
          raw_ftf_formularies_v2.restrictions,
          raw_ftf_formularies_v2.reason_code,
          raw_ftf_formularies_v2.reason_code_description,
          raw_ftf_formularies_v2.pharmacy_status
SEGMENTED BY hash(raw_ftf_formularies_v2.health_plan_id, raw_ftf_formularies_v2.drug_id, raw_ftf_formularies_v2.tier_code, raw_ftf_formularies_v2.restrictions, raw_ftf_formularies_v2.pharmacy_status, raw_ftf_formularies_v2.reason_code, raw_ftf_formularies_v2.reason_code_description) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plans_v2_b0 /*+basename(raw_ftf_health_plans_v2),createtype(L)*/ 
(
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier
)
AS
 SELECT raw_ftf_health_plans_v2.formularyf_id,
        raw_ftf_health_plans_v2.provider_id,
        raw_ftf_health_plans_v2.provider,
        raw_ftf_health_plans_v2.health_plan_id,
        raw_ftf_health_plans_v2.health_plan,
        raw_ftf_health_plans_v2.parent_id,
        raw_ftf_health_plans_v2.parent,
        raw_ftf_health_plans_v2.national_lives_count,
        raw_ftf_health_plans_v2.plan_type_name,
        raw_ftf_health_plans_v2.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_v2
 ORDER BY raw_ftf_health_plans_v2.formularyf_id,
          raw_ftf_health_plans_v2.provider_id,
          raw_ftf_health_plans_v2.provider,
          raw_ftf_health_plans_v2.health_plan_id,
          raw_ftf_health_plans_v2.health_plan,
          raw_ftf_health_plans_v2.parent_id,
          raw_ftf_health_plans_v2.parent,
          raw_ftf_health_plans_v2.national_lives_count
SEGMENTED BY hash(raw_ftf_health_plans_v2.formularyf_id, raw_ftf_health_plans_v2.provider_id, raw_ftf_health_plans_v2.health_plan_id, raw_ftf_health_plans_v2.parent_id, raw_ftf_health_plans_v2.national_lives_count, raw_ftf_health_plans_v2.preferred_brand_tier, raw_ftf_health_plans_v2.health_plan, raw_ftf_health_plans_v2.provider) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plan_geography_v2_b0 /*+basename(raw_ftf_health_plan_geography_v2),createtype(L)*/ 
(
 health_plan_id,
 county_fips_id,
 county_id,
 county_name,
 state_id,
 state_name,
 county_lives
)
AS
 SELECT raw_ftf_health_plan_geography_v2.health_plan_id,
        raw_ftf_health_plan_geography_v2.county_fips_id,
        raw_ftf_health_plan_geography_v2.county_id,
        raw_ftf_health_plan_geography_v2.county_name,
        raw_ftf_health_plan_geography_v2.state_id,
        raw_ftf_health_plan_geography_v2.state_name,
        raw_ftf_health_plan_geography_v2.county_lives
 FROM sandbox.raw_ftf_health_plan_geography_v2
 ORDER BY raw_ftf_health_plan_geography_v2.health_plan_id,
          raw_ftf_health_plan_geography_v2.county_fips_id,
          raw_ftf_health_plan_geography_v2.county_id,
          raw_ftf_health_plan_geography_v2.county_name,
          raw_ftf_health_plan_geography_v2.state_id,
          raw_ftf_health_plan_geography_v2.state_name,
          raw_ftf_health_plan_geography_v2.county_lives
SEGMENTED BY hash(raw_ftf_health_plan_geography_v2.health_plan_id, raw_ftf_health_plan_geography_v2.county_fips_id, raw_ftf_health_plan_geography_v2.county_id, raw_ftf_health_plan_geography_v2.state_id, raw_ftf_health_plan_geography_v2.county_lives, raw_ftf_health_plan_geography_v2.state_name, raw_ftf_health_plan_geography_v2.county_name) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_pbms_v2_b0 /*+basename(raw_ftf_pbms_v2),createtype(L)*/ 
(
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function
)
AS
 SELECT raw_ftf_pbms_v2.health_plan_id,
        raw_ftf_pbms_v2.pbm_id,
        raw_ftf_pbms_v2.pbm,
        raw_ftf_pbms_v2.pbm_function_id,
        raw_ftf_pbms_v2.pbm_function
 FROM sandbox.raw_ftf_pbms_v2
 ORDER BY raw_ftf_pbms_v2.health_plan_id,
          raw_ftf_pbms_v2.pbm_id,
          raw_ftf_pbms_v2.pbm,
          raw_ftf_pbms_v2.pbm_function_id,
          raw_ftf_pbms_v2.pbm_function
SEGMENTED BY hash(raw_ftf_pbms_v2.health_plan_id, raw_ftf_pbms_v2.pbm_id, raw_ftf_pbms_v2.pbm_function_id, raw_ftf_pbms_v2.pbm, raw_ftf_pbms_v2.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_restrictions_v2_b0 /*+basename(raw_ftf_restrictions_v2),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_details_id,
 restriction_details_text,
 restriction_details_information_1,
 restriction_details_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level
)
AS
 SELECT raw_ftf_restrictions_v2.health_plan_id,
        raw_ftf_restrictions_v2.drug_id,
        raw_ftf_restrictions_v2.restriction_code,
        raw_ftf_restrictions_v2.restriction_details_id,
        raw_ftf_restrictions_v2.restriction_details_text,
        raw_ftf_restrictions_v2.restriction_details_information_1,
        raw_ftf_restrictions_v2.restriction_details_information_2,
        raw_ftf_restrictions_v2.step_count,
        raw_ftf_restrictions_v2.pa_form,
        raw_ftf_restrictions_v2.indication,
        raw_ftf_restrictions_v2.grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_v2
 ORDER BY raw_ftf_restrictions_v2.health_plan_id,
          raw_ftf_restrictions_v2.drug_id,
          raw_ftf_restrictions_v2.restriction_code,
          raw_ftf_restrictions_v2.restriction_details_id,
          raw_ftf_restrictions_v2.restriction_details_text,
          raw_ftf_restrictions_v2.restriction_details_information_1,
          raw_ftf_restrictions_v2.restriction_details_information_2,
          raw_ftf_restrictions_v2.step_count
SEGMENTED BY hash(raw_ftf_restrictions_v2.health_plan_id, raw_ftf_restrictions_v2.drug_id, raw_ftf_restrictions_v2.restriction_details_id, raw_ftf_restrictions_v2.restriction_code, raw_ftf_restrictions_v2.step_count, raw_ftf_restrictions_v2.indication, raw_ftf_restrictions_v2.grouped_restriction_level, raw_ftf_restrictions_v2.restriction_details_text) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_plan_v2_b0 /*+basename(raw_iqvia_plan_v2),createtype(L)*/ 
(
 payer_id,
 payer_name,
 plan_id,
 payer_plan_id,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data
)
AS
 SELECT raw_iqvia_plan_v2.payer_id,
        raw_iqvia_plan_v2.payer_name,
        raw_iqvia_plan_v2.plan_id,
        raw_iqvia_plan_v2.payer_plan_id,
        raw_iqvia_plan_v2.plan_name,
        raw_iqvia_plan_v2.model,
        raw_iqvia_plan_v2.city,
        raw_iqvia_plan_v2.hq_state,
        raw_iqvia_plan_v2.operating_state,
        raw_iqvia_plan_v2.months_with_data
 FROM sandbox.raw_iqvia_plan_v2
 ORDER BY raw_iqvia_plan_v2.payer_id,
          raw_iqvia_plan_v2.payer_name,
          raw_iqvia_plan_v2.plan_id,
          raw_iqvia_plan_v2.payer_plan_id,
          raw_iqvia_plan_v2.plan_name,
          raw_iqvia_plan_v2.model,
          raw_iqvia_plan_v2.city,
          raw_iqvia_plan_v2.hq_state
SEGMENTED BY hash(raw_iqvia_plan_v2.payer_id, raw_iqvia_plan_v2.plan_id, raw_iqvia_plan_v2.hq_state, raw_iqvia_plan_v2.operating_state, raw_iqvia_plan_v2.months_with_data, raw_iqvia_plan_v2.payer_plan_id, raw_iqvia_plan_v2.model, raw_iqvia_plan_v2.city) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_pbm_v2_b0 /*+basename(raw_iqvia_pbm_v2),createtype(L)*/ 
(
 pbm_name,
 payer_plan_id,
 xref_to_payer_plan_id,
 ipd_id,
 ipd_type,
 plan_name,
 pbm_id,
 ims_processor_number
)
AS
 SELECT raw_iqvia_pbm_v2.pbm_name,
        raw_iqvia_pbm_v2.payer_plan_id,
        raw_iqvia_pbm_v2.xref_to_payer_plan_id,
        raw_iqvia_pbm_v2.ipd_id,
        raw_iqvia_pbm_v2.ipd_type,
        raw_iqvia_pbm_v2.plan_name,
        raw_iqvia_pbm_v2.pbm_id,
        raw_iqvia_pbm_v2.ims_processor_number
 FROM sandbox.raw_iqvia_pbm_v2
 ORDER BY raw_iqvia_pbm_v2.pbm_name,
          raw_iqvia_pbm_v2.payer_plan_id,
          raw_iqvia_pbm_v2.xref_to_payer_plan_id,
          raw_iqvia_pbm_v2.ipd_id,
          raw_iqvia_pbm_v2.ipd_type,
          raw_iqvia_pbm_v2.plan_name,
          raw_iqvia_pbm_v2.pbm_id,
          raw_iqvia_pbm_v2.ims_processor_number
SEGMENTED BY hash(raw_iqvia_pbm_v2.payer_plan_id, raw_iqvia_pbm_v2.xref_to_payer_plan_id, raw_iqvia_pbm_v2.ipd_id, raw_iqvia_pbm_v2.ipd_type, raw_iqvia_pbm_v2.pbm_id, raw_iqvia_pbm_v2.ims_processor_number, raw_iqvia_pbm_v2.pbm_name, raw_iqvia_pbm_v2.plan_name) ALL NODES;

CREATE PROJECTION sandbox.raw_teva_ims_bridge_v2_b0 /*+basename(raw_teva_ims_bridge_v2),createtype(L)*/ 
(
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name
)
AS
 SELECT raw_teva_ims_bridge_v2.payer_name,
        raw_teva_ims_bridge_v2.code,
        raw_teva_ims_bridge_v2.name,
        raw_teva_ims_bridge_v2.state,
        raw_teva_ims_bridge_v2.comments,
        raw_teva_ims_bridge_v2.plan_id,
        raw_teva_ims_bridge_v2.plan_name,
        raw_teva_ims_bridge_v2.provider_name,
        raw_teva_ims_bridge_v2.plan_type_name
 FROM sandbox.raw_teva_ims_bridge_v2
 ORDER BY raw_teva_ims_bridge_v2.payer_name,
          raw_teva_ims_bridge_v2.code,
          raw_teva_ims_bridge_v2.name,
          raw_teva_ims_bridge_v2.state,
          raw_teva_ims_bridge_v2.comments,
          raw_teva_ims_bridge_v2.plan_id,
          raw_teva_ims_bridge_v2.plan_name,
          raw_teva_ims_bridge_v2.provider_name
SEGMENTED BY hash(raw_teva_ims_bridge_v2.state, raw_teva_ims_bridge_v2.code, raw_teva_ims_bridge_v2.plan_id, raw_teva_ims_bridge_v2.plan_type_name, raw_teva_ims_bridge_v2.name, raw_teva_ims_bridge_v2.comments, raw_teva_ims_bridge_v2.plan_name, raw_teva_ims_bridge_v2.provider_name) ALL NODES;

CREATE PROJECTION sandbox.comparison_payer_spine_cdw_v1_b0 /*+basename(comparison_payer_spine_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 payment_type,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 lives_plan_kcf_lvl,
 lives_plan_lvl,
 apportionment_factor,
 saba_trx,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_payment_type,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_lives_plan_kcf_lvl,
 change_lives_plan_lvl,
 change_apportionment_factor,
 change_saba_trx,
 change,
 month_flag,
 status,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT comparison_payer_spine_cdw_v1.iqvia_plan_code,
        comparison_payer_spine_cdw_v1.iqvia_plan_name,
        comparison_payer_spine_cdw_v1.iqvia_payer_name,
        comparison_payer_spine_cdw_v1.iqvia_pbm,
        comparison_payer_spine_cdw_v1.key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.key_controlling_account,
        comparison_payer_spine_cdw_v1.key_controlling_parent,
        comparison_payer_spine_cdw_v1.payer_pbm,
        comparison_payer_spine_cdw_v1.payment_type,
        comparison_payer_spine_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.lives_plan_lvl,
        comparison_payer_spine_cdw_v1.apportionment_factor,
        comparison_payer_spine_cdw_v1.saba_trx,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_code,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_name,
        comparison_payer_spine_cdw_v1.change_iqvia_payer_name,
        comparison_payer_spine_cdw_v1.change_iqvia_pbm,
        comparison_payer_spine_cdw_v1.change_key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.change_key_controlling_account,
        comparison_payer_spine_cdw_v1.change_key_controlling_parent,
        comparison_payer_spine_cdw_v1.change_payer_pbm,
        comparison_payer_spine_cdw_v1.change_payment_type,
        comparison_payer_spine_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.change_lives_plan_lvl,
        comparison_payer_spine_cdw_v1.change_apportionment_factor,
        comparison_payer_spine_cdw_v1.change_saba_trx,
        comparison_payer_spine_cdw_v1.change,
        comparison_payer_spine_cdw_v1.month_flag,
        comparison_payer_spine_cdw_v1.status,
        comparison_payer_spine_cdw_v1.cycle_id,
        comparison_payer_spine_cdw_v1.modified_time,
        comparison_payer_spine_cdw_v1.modified_by
 FROM sandbox.comparison_payer_spine_cdw_v1
 ORDER BY comparison_payer_spine_cdw_v1.iqvia_plan_code,
          comparison_payer_spine_cdw_v1.iqvia_plan_name,
          comparison_payer_spine_cdw_v1.iqvia_payer_name,
          comparison_payer_spine_cdw_v1.iqvia_pbm,
          comparison_payer_spine_cdw_v1.key_controlling_plan_formulary,
          comparison_payer_spine_cdw_v1.key_controlling_account,
          comparison_payer_spine_cdw_v1.key_controlling_parent,
          comparison_payer_spine_cdw_v1.payer_pbm,
          comparison_payer_spine_cdw_v1.payment_type,
          comparison_payer_spine_cdw_v1.ajovy_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.aimovig_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.emgality_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.lives_plan_kcf_lvl,
          comparison_payer_spine_cdw_v1.lives_plan_lvl,
          comparison_payer_spine_cdw_v1.apportionment_factor,
          comparison_payer_spine_cdw_v1.saba_trx,
          comparison_payer_spine_cdw_v1.change_iqvia_plan_code,
          comparison_payer_spine_cdw_v1.change_iqvia_plan_name,
          comparison_payer_spine_cdw_v1.change_iqvia_payer_name,
          comparison_payer_spine_cdw_v1.change_iqvia_pbm,
          comparison_payer_spine_cdw_v1.change_key_controlling_plan_formulary,
          comparison_payer_spine_cdw_v1.change_key_controlling_account,
          comparison_payer_spine_cdw_v1.change_key_controlling_parent,
          comparison_payer_spine_cdw_v1.change_payer_pbm,
          comparison_payer_spine_cdw_v1.change_payment_type,
          comparison_payer_spine_cdw_v1.change_ajovy_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.change_aimovig_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.change_emgality_access_for_ftf_plan,
          comparison_payer_spine_cdw_v1.change_lives_plan_kcf_lvl,
          comparison_payer_spine_cdw_v1.change_lives_plan_lvl,
          comparison_payer_spine_cdw_v1.change_apportionment_factor,
          comparison_payer_spine_cdw_v1.change_saba_trx,
          comparison_payer_spine_cdw_v1.change
SEGMENTED BY hash(comparison_payer_spine_cdw_v1.iqvia_plan_code, comparison_payer_spine_cdw_v1.lives_plan_kcf_lvl, comparison_payer_spine_cdw_v1.lives_plan_lvl, comparison_payer_spine_cdw_v1.change_iqvia_plan_code, comparison_payer_spine_cdw_v1.change_iqvia_plan_name, comparison_payer_spine_cdw_v1.change_iqvia_payer_name, comparison_payer_spine_cdw_v1.change_iqvia_pbm, comparison_payer_spine_cdw_v1.change_key_controlling_plan_formulary) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_total_calls_b0 /*+basename(tmp_weekly_total_calls),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 customer_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 week_bucket,
 date_sent,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_total_calls.sales_force_id,
        tmp_weekly_total_calls.call_id,
        tmp_weekly_total_calls.customer_id,
        tmp_weekly_total_calls.geography_level,
        tmp_weekly_total_calls.geography_id,
        tmp_weekly_total_calls.geography,
        tmp_weekly_total_calls.rep_name,
        tmp_weekly_total_calls.user_id,
        tmp_weekly_total_calls.market_id,
        tmp_weekly_total_calls.market_name,
        tmp_weekly_total_calls.brand_id,
        tmp_weekly_total_calls.brand_name,
        tmp_weekly_total_calls.time_period,
        tmp_weekly_total_calls.period_type,
        tmp_weekly_total_calls.period,
        tmp_weekly_total_calls.week_bucket,
        tmp_weekly_total_calls.date_sent,
        tmp_weekly_total_calls.decile,
        tmp_weekly_total_calls.segment,
        tmp_weekly_total_calls.specialty,
        tmp_weekly_total_calls.target_status,
        tmp_weekly_total_calls.how_executed,
        tmp_weekly_total_calls.details_p1,
        tmp_weekly_total_calls.details_p2,
        tmp_weekly_total_calls.details_p3,
        tmp_weekly_total_calls.total_details,
        tmp_weekly_total_calls.samples
 FROM sandbox.tmp_weekly_total_calls
 ORDER BY tmp_weekly_total_calls.sales_force_id,
          tmp_weekly_total_calls.call_id,
          tmp_weekly_total_calls.customer_id,
          tmp_weekly_total_calls.geography_level,
          tmp_weekly_total_calls.geography_id,
          tmp_weekly_total_calls.geography
SEGMENTED BY hash(tmp_weekly_total_calls.sales_force_id, tmp_weekly_total_calls.rep_name, tmp_weekly_total_calls.user_id, tmp_weekly_total_calls.market_id, tmp_weekly_total_calls.brand_id, tmp_weekly_total_calls.time_period, tmp_weekly_total_calls.period_type, tmp_weekly_total_calls.week_bucket) ALL NODES;

CREATE PROJECTION sandbox.temp_sp_b0 /*+basename(temp_sp),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 week_bucket,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prsc_reach
)
AS
 SELECT temp_sp.customer_id,
        temp_sp.sales_force_id,
        temp_sp.geography_level,
        temp_sp.geography_id,
        temp_sp.geography,
        temp_sp.rep_name,
        temp_sp.user_id,
        temp_sp.market_id,
        temp_sp.market_name,
        temp_sp.brand_id,
        temp_sp.brand_name,
        temp_sp.time_period,
        temp_sp.period_type,
        temp_sp.period,
        temp_sp.week_bucket,
        temp_sp.decile,
        temp_sp.segment,
        temp_sp.specialty,
        temp_sp.target_status,
        temp_sp.how_executed,
        temp_sp.call_recordtype,
        temp_sp.details_p1,
        temp_sp.details_p2,
        temp_sp.details_p3,
        temp_sp.total_details,
        temp_sp.samples,
        temp_sp.prsc_reach
 FROM sandbox.temp_sp
 ORDER BY temp_sp.customer_id,
          temp_sp.sales_force_id,
          temp_sp.geography_level,
          temp_sp.geography,
          temp_sp.market_id,
          temp_sp.market_name,
          temp_sp.brand_id,
          temp_sp.brand_name,
          temp_sp.period,
          temp_sp.week_bucket,
          temp_sp.decile,
          temp_sp.segment,
          temp_sp.specialty,
          temp_sp.target_status,
          temp_sp.how_executed,
          temp_sp.call_recordtype
SEGMENTED BY hash(temp_sp.customer_id, temp_sp.sales_force_id, temp_sp.geography_level, temp_sp.geography_id, temp_sp.geography, temp_sp.market_id, temp_sp.market_name, temp_sp.brand_id, temp_sp.brand_name, temp_sp.period, temp_sp.week_bucket, temp_sp.decile, temp_sp.segment, temp_sp.specialty, temp_sp.target_status, temp_sp.how_executed, temp_sp.call_recordtype) ALL NODES;

CREATE PROJECTION sandbox.test_cumm_count_b0 /*+basename(test_cumm_count),createtype(L)*/ 
(
 period,
 customer_id
)
AS
 SELECT test_cumm_count.period,
        test_cumm_count.customer_id
 FROM sandbox.test_cumm_count
 ORDER BY test_cumm_count.period,
          test_cumm_count.customer_id
SEGMENTED BY hash(test_cumm_count.period, test_cumm_count.customer_id) ALL NODES;

CREATE PROJECTION sandbox.coverage_category_derivation_config_vOct_b0 /*+basename(coverage_category_derivation_config_vOct),createtype(L)*/ 
(
 tier_regex,
 pharmacy_status_regex,
 paytype_regex,
 haspa_regex,
 hasst_regex,
 haspast_regex,
 rest_groupstep_regex,
 coverage_category,
 record_id,
 file_id
)
AS
 SELECT coverage_category_derivation_config_vOct.tier_regex,
        coverage_category_derivation_config_vOct.pharmacy_status_regex,
        coverage_category_derivation_config_vOct.paytype_regex,
        coverage_category_derivation_config_vOct.haspa_regex,
        coverage_category_derivation_config_vOct.hasst_regex,
        coverage_category_derivation_config_vOct.haspast_regex,
        coverage_category_derivation_config_vOct.rest_groupstep_regex,
        coverage_category_derivation_config_vOct.coverage_category,
        coverage_category_derivation_config_vOct.record_id,
        coverage_category_derivation_config_vOct.file_id
 FROM sandbox.coverage_category_derivation_config_vOct
 ORDER BY coverage_category_derivation_config_vOct.tier_regex,
          coverage_category_derivation_config_vOct.pharmacy_status_regex,
          coverage_category_derivation_config_vOct.paytype_regex,
          coverage_category_derivation_config_vOct.haspa_regex,
          coverage_category_derivation_config_vOct.hasst_regex,
          coverage_category_derivation_config_vOct.haspast_regex,
          coverage_category_derivation_config_vOct.rest_groupstep_regex,
          coverage_category_derivation_config_vOct.coverage_category
SEGMENTED BY hash(coverage_category_derivation_config_vOct.record_id, coverage_category_derivation_config_vOct.file_id, coverage_category_derivation_config_vOct.tier_regex, coverage_category_derivation_config_vOct.pharmacy_status_regex, coverage_category_derivation_config_vOct.paytype_regex, coverage_category_derivation_config_vOct.haspa_regex, coverage_category_derivation_config_vOct.hasst_regex, coverage_category_derivation_config_vOct.haspast_regex) ALL NODES;

CREATE PROJECTION sandbox.ftf_restriction_id_group_mapping_b0 /*+basename(ftf_restriction_id_group_mapping),createtype(L)*/ 
(
 restriction_detail_id,
 restriction_detail_text,
 grouped_restriction_level,
 coverage_category,
 used_flag,
 notes,
 file_id,
 record_id
)
AS
 SELECT ftf_restriction_id_group_mapping.restriction_detail_id,
        ftf_restriction_id_group_mapping.restriction_detail_text,
        ftf_restriction_id_group_mapping.grouped_restriction_level,
        ftf_restriction_id_group_mapping.coverage_category,
        ftf_restriction_id_group_mapping.used_flag,
        ftf_restriction_id_group_mapping.notes,
        ftf_restriction_id_group_mapping.file_id,
        ftf_restriction_id_group_mapping.record_id
 FROM sandbox.ftf_restriction_id_group_mapping
 ORDER BY ftf_restriction_id_group_mapping.restriction_detail_id,
          ftf_restriction_id_group_mapping.restriction_detail_text,
          ftf_restriction_id_group_mapping.grouped_restriction_level,
          ftf_restriction_id_group_mapping.coverage_category,
          ftf_restriction_id_group_mapping.used_flag,
          ftf_restriction_id_group_mapping.notes,
          ftf_restriction_id_group_mapping.file_id,
          ftf_restriction_id_group_mapping.record_id
SEGMENTED BY hash(ftf_restriction_id_group_mapping.restriction_detail_id, ftf_restriction_id_group_mapping.used_flag, ftf_restriction_id_group_mapping.file_id, ftf_restriction_id_group_mapping.record_id, ftf_restriction_id_group_mapping.coverage_category, ftf_restriction_id_group_mapping.notes, ftf_restriction_id_group_mapping.grouped_restriction_level, ftf_restriction_id_group_mapping.restriction_detail_text) ALL NODES;

CREATE PROJECTION sandbox.tmp_file_id_ddd_md_b0 /*+basename(tmp_file_id_ddd_md),createtype(A)*/ 
(
 file_id,
 feed_id
)
AS
 SELECT tmp_file_id_ddd_md.file_id,
        tmp_file_id_ddd_md.feed_id
 FROM sandbox.tmp_file_id_ddd_md
 ORDER BY tmp_file_id_ddd_md.file_id,
          tmp_file_id_ddd_md.feed_id
SEGMENTED BY hash(tmp_file_id_ddd_md.file_id, tmp_file_id_ddd_md.feed_id) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_geography_summary_b0 /*+basename(ts_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 rep_type,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT ts_weekly_geography_summary.sales_force_id,
        ts_weekly_geography_summary.geography_level,
        ts_weekly_geography_summary.geography_id,
        ts_weekly_geography_summary.geography,
        ts_weekly_geography_summary.rep_name,
        ts_weekly_geography_summary.user_id,
        ts_weekly_geography_summary.time_period,
        ts_weekly_geography_summary.period_type,
        ts_weekly_geography_summary.period,
        ts_weekly_geography_summary.market_id,
        ts_weekly_geography_summary.market_name,
        ts_weekly_geography_summary.brand_id,
        ts_weekly_geography_summary.brand_name,
        ts_weekly_geography_summary.teva_product_flag,
        ts_weekly_geography_summary.target_status_flag,
        ts_weekly_geography_summary.method_of_payment,
        ts_weekly_geography_summary.rep_type,
        ts_weekly_geography_summary.specialty,
        ts_weekly_geography_summary.segment,
        ts_weekly_geography_summary.market_volume_indicator,
        ts_weekly_geography_summary.product_vol_trx_count,
        ts_weekly_geography_summary.product_vol_new_pres_trx_count,
        ts_weekly_geography_summary.market_vol_trx_count,
        ts_weekly_geography_summary.prev_prod_vol_trx_count,
        ts_weekly_geography_summary.prev_market_vol_trx_count,
        ts_weekly_geography_summary.product_vol_nrx_count,
        ts_weekly_geography_summary.product_vol_new_pres_nrx_count,
        ts_weekly_geography_summary.market_vol_nrx_count,
        ts_weekly_geography_summary.prev_prod_vol_nrx_count,
        ts_weekly_geography_summary.prev_market_vol_nrx_count,
        ts_weekly_geography_summary.prescribers_count,
        ts_weekly_geography_summary.new_prescribers_count,
        ts_weekly_geography_summary.decile
 FROM sandbox.ts_weekly_geography_summary
 ORDER BY ts_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(ts_weekly_geography_summary.sales_force_id, ts_weekly_geography_summary.market_id, ts_weekly_geography_summary.brand_id, ts_weekly_geography_summary.teva_product_flag, ts_weekly_geography_summary.target_status_flag, ts_weekly_geography_summary.market_volume_indicator, ts_weekly_geography_summary.prescribers_count, ts_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_new_prescriber_b0 /*+basename(ts_monthly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 month_ending,
 month_bucket,
 curr_trx,
 prev_trx
)
AS
 SELECT ts_monthly_new_prescriber.customer_id,
        ts_monthly_new_prescriber.brand_id,
        ts_monthly_new_prescriber.month_ending,
        ts_monthly_new_prescriber.month_bucket,
        ts_monthly_new_prescriber.curr_trx,
        ts_monthly_new_prescriber.prev_trx
 FROM sandbox.ts_monthly_new_prescriber
 ORDER BY ts_monthly_new_prescriber.customer_id,
          ts_monthly_new_prescriber.brand_id,
          ts_monthly_new_prescriber.month_ending,
          ts_monthly_new_prescriber.month_bucket,
          ts_monthly_new_prescriber.curr_trx,
          ts_monthly_new_prescriber.prev_trx
SEGMENTED BY hash(ts_monthly_new_prescriber.brand_id, ts_monthly_new_prescriber.month_ending, ts_monthly_new_prescriber.month_bucket, ts_monthly_new_prescriber.curr_trx, ts_monthly_new_prescriber.prev_trx, ts_monthly_new_prescriber.customer_id) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_prescriber_sales_b0 /*+basename(ts_monthly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 month_ending,
 month_bucket,
 data_source,
 channel,
 pbm_name,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT ts_monthly_prescriber_sales.customer_id,
        ts_monthly_prescriber_sales.tvcmid,
        ts_monthly_prescriber_sales.ims_id,
        ts_monthly_prescriber_sales.product_id,
        ts_monthly_prescriber_sales.payer_plan_id,
        ts_monthly_prescriber_sales.month_ending,
        ts_monthly_prescriber_sales.month_bucket,
        ts_monthly_prescriber_sales.data_source,
        ts_monthly_prescriber_sales.channel,
        ts_monthly_prescriber_sales.pbm_name,
        ts_monthly_prescriber_sales.method_of_payment,
        ts_monthly_prescriber_sales.trx,
        ts_monthly_prescriber_sales.nrx,
        ts_monthly_prescriber_sales.trx_units,
        ts_monthly_prescriber_sales.nrx_units,
        ts_monthly_prescriber_sales.trx_dollars,
        ts_monthly_prescriber_sales.nrx_dollars,
        ts_monthly_prescriber_sales.new_prescriber
 FROM sandbox.ts_monthly_prescriber_sales
 ORDER BY ts_monthly_prescriber_sales.customer_id,
          ts_monthly_prescriber_sales.tvcmid,
          ts_monthly_prescriber_sales.ims_id,
          ts_monthly_prescriber_sales.product_id,
          ts_monthly_prescriber_sales.payer_plan_id,
          ts_monthly_prescriber_sales.month_ending,
          ts_monthly_prescriber_sales.month_bucket,
          ts_monthly_prescriber_sales.data_source
SEGMENTED BY hash(ts_monthly_prescriber_sales.tvcmid, ts_monthly_prescriber_sales.product_id, ts_monthly_prescriber_sales.month_ending, ts_monthly_prescriber_sales.month_bucket, ts_monthly_prescriber_sales.trx, ts_monthly_prescriber_sales.nrx, ts_monthly_prescriber_sales.trx_units, ts_monthly_prescriber_sales.nrx_units) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_payer_prescriber_summary_b0 /*+basename(ts_monthly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT ts_monthly_payer_prescriber_summary.sales_force_id,
        ts_monthly_payer_prescriber_summary.nation_id,
        ts_monthly_payer_prescriber_summary.nation,
        ts_monthly_payer_prescriber_summary.area_id,
        ts_monthly_payer_prescriber_summary.area,
        ts_monthly_payer_prescriber_summary.region_id,
        ts_monthly_payer_prescriber_summary.region,
        ts_monthly_payer_prescriber_summary.territory_id,
        ts_monthly_payer_prescriber_summary.territory,
        ts_monthly_payer_prescriber_summary.rep_name,
        ts_monthly_payer_prescriber_summary.user_id,
        ts_monthly_payer_prescriber_summary.time_period,
        ts_monthly_payer_prescriber_summary.period_type,
        ts_monthly_payer_prescriber_summary.period,
        ts_monthly_payer_prescriber_summary.market_id,
        ts_monthly_payer_prescriber_summary.market_name,
        ts_monthly_payer_prescriber_summary.brand_id,
        ts_monthly_payer_prescriber_summary.brand_name,
        ts_monthly_payer_prescriber_summary.teva_product_flag,
        ts_monthly_payer_prescriber_summary.payer_id,
        ts_monthly_payer_prescriber_summary.payer_name,
        ts_monthly_payer_prescriber_summary.plan_id,
        ts_monthly_payer_prescriber_summary.plan_name,
        ts_monthly_payer_prescriber_summary.payer_plan_id,
        ts_monthly_payer_prescriber_summary.customer_id,
        ts_monthly_payer_prescriber_summary.tvcmid,
        ts_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        ts_monthly_payer_prescriber_summary.prescriber_name,
        ts_monthly_payer_prescriber_summary.pdrp_flag,
        ts_monthly_payer_prescriber_summary.hcp_restriction_flag,
        ts_monthly_payer_prescriber_summary.address,
        ts_monthly_payer_prescriber_summary.city,
        ts_monthly_payer_prescriber_summary.state,
        ts_monthly_payer_prescriber_summary.zip,
        ts_monthly_payer_prescriber_summary.target_status_flag,
        ts_monthly_payer_prescriber_summary.partner_target_status_flag,
        ts_monthly_payer_prescriber_summary.method_of_payment,
        ts_monthly_payer_prescriber_summary.specialty,
        ts_monthly_payer_prescriber_summary.segment,
        ts_monthly_payer_prescriber_summary.decile,
        ts_monthly_payer_prescriber_summary.rep_type,
        ts_monthly_payer_prescriber_summary.market_volume_indicator,
        ts_monthly_payer_prescriber_summary.product_vol_trx_count,
        ts_monthly_payer_prescriber_summary.market_vol_trx_count,
        ts_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        ts_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        ts_monthly_payer_prescriber_summary.product_vol_nrx_count,
        ts_monthly_payer_prescriber_summary.market_vol_nrx_count,
        ts_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        ts_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        ts_monthly_payer_prescriber_summary.samples,
        ts_monthly_payer_prescriber_summary.details_p1,
        ts_monthly_payer_prescriber_summary.details_p2,
        ts_monthly_payer_prescriber_summary.details_p3,
        ts_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        ts_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        ts_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        ts_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        ts_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        ts_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        ts_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        ts_monthly_payer_prescriber_summary.focus_target
 FROM sandbox.ts_monthly_payer_prescriber_summary
 ORDER BY ts_monthly_payer_prescriber_summary.sales_force_id,
          ts_monthly_payer_prescriber_summary.nation_id,
          ts_monthly_payer_prescriber_summary.nation,
          ts_monthly_payer_prescriber_summary.area_id,
          ts_monthly_payer_prescriber_summary.area,
          ts_monthly_payer_prescriber_summary.region_id,
          ts_monthly_payer_prescriber_summary.region,
          ts_monthly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(ts_monthly_payer_prescriber_summary.market_id, ts_monthly_payer_prescriber_summary.brand_id, ts_monthly_payer_prescriber_summary.teva_product_flag, ts_monthly_payer_prescriber_summary.payer_id, ts_monthly_payer_prescriber_summary.plan_id, ts_monthly_payer_prescriber_summary.tvcmid, ts_monthly_payer_prescriber_summary.hcp_plan_vol_rank, ts_monthly_payer_prescriber_summary.pdrp_flag) ALL NODES;

CREATE PROJECTION sandbox.tmp_call_hist_c_new_b0 /*+basename(tmp_call_hist_c_new),createtype(A)*/ 
(
 id,
 isdeleted,
 parentid,
 createdbyid,
 createddate,
 field,
 oldvalue,
 newvalue,
 file_id,
 record_id,
 row_num
)
AS
 SELECT tmp_call_hist_c_new.id,
        tmp_call_hist_c_new.isdeleted,
        tmp_call_hist_c_new.parentid,
        tmp_call_hist_c_new.createdbyid,
        tmp_call_hist_c_new.createddate,
        tmp_call_hist_c_new.field,
        tmp_call_hist_c_new.oldvalue,
        tmp_call_hist_c_new.newvalue,
        tmp_call_hist_c_new.file_id,
        tmp_call_hist_c_new.record_id,
        tmp_call_hist_c_new.row_num
 FROM sandbox.tmp_call_hist_c_new
 ORDER BY tmp_call_hist_c_new.id
SEGMENTED BY hash(tmp_call_hist_c_new.id) ALL NODES;

CREATE PROJECTION sandbox.sales_force_headcounts_b0 /*+basename(sales_force_headcounts),createtype(A)*/ 
(
 sales_force_id,
 month,
 headcount,
 products,
 rep_type
)
AS
 SELECT sales_force_headcounts.sales_force_id,
        sales_force_headcounts.month,
        sales_force_headcounts.headcount,
        sales_force_headcounts.products,
        sales_force_headcounts.rep_type
 FROM sandbox.sales_force_headcounts
 ORDER BY sales_force_headcounts.sales_force_id,
          sales_force_headcounts.month,
          sales_force_headcounts.headcount,
          sales_force_headcounts.products
SEGMENTED BY hash(sales_force_headcounts.sales_force_id, sales_force_headcounts.month, sales_force_headcounts.headcount, sales_force_headcounts.products) ALL NODES;

CREATE PROJECTION sandbox.reporting_markets_b0 /*+basename(reporting_markets),createtype(A)*/ 
(
 basket_id,
 basket_name,
 basket_type,
 status,
 geo_summary_include,
 presc_summary_include,
 market_share_market_id,
 market_share_brand_id,
 rptg_decile_attribute_type,
 rptg_decile_attribute_prod_id,
 rptg_segment_attribute_type,
 rptg_segment_attribute_prod_id
)
AS
 SELECT reporting_markets.basket_id,
        reporting_markets.basket_name,
        reporting_markets.basket_type,
        reporting_markets.status,
        reporting_markets.geo_summary_include,
        reporting_markets.presc_summary_include,
        reporting_markets.market_share_market_id,
        reporting_markets.market_share_brand_id,
        reporting_markets.rptg_decile_attribute_type,
        reporting_markets.rptg_decile_attribute_prod_id,
        reporting_markets.rptg_segment_attribute_type,
        reporting_markets.rptg_segment_attribute_prod_id
 FROM sandbox.reporting_markets
 ORDER BY reporting_markets.basket_id,
          reporting_markets.basket_name,
          reporting_markets.basket_type,
          reporting_markets.status,
          reporting_markets.geo_summary_include,
          reporting_markets.presc_summary_include,
          reporting_markets.market_share_market_id,
          reporting_markets.market_share_brand_id
SEGMENTED BY hash(reporting_markets.basket_id, reporting_markets.status, reporting_markets.geo_summary_include, reporting_markets.presc_summary_include, reporting_markets.market_share_market_id, reporting_markets.market_share_brand_id, reporting_markets.rptg_decile_attribute_prod_id, reporting_markets.rptg_segment_attribute_prod_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_monthly_hcp_activity_b0 /*+basename(tmp_monthly_hcp_activity),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 territory_id,
 product_id,
 month_ending,
 month_bucket,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_monthly_hcp_activity.customer_id,
        tmp_monthly_hcp_activity.sales_force_id,
        tmp_monthly_hcp_activity.territory_id,
        tmp_monthly_hcp_activity.product_id,
        tmp_monthly_hcp_activity.month_ending,
        tmp_monthly_hcp_activity.month_bucket,
        tmp_monthly_hcp_activity.target_status,
        tmp_monthly_hcp_activity.how_executed,
        tmp_monthly_hcp_activity.call_recordtype,
        tmp_monthly_hcp_activity.details_p1,
        tmp_monthly_hcp_activity.details_p2,
        tmp_monthly_hcp_activity.details_p3,
        tmp_monthly_hcp_activity.total_details,
        tmp_monthly_hcp_activity.samples
 FROM sandbox.tmp_monthly_hcp_activity
 ORDER BY tmp_monthly_hcp_activity.customer_id,
          tmp_monthly_hcp_activity.sales_force_id,
          tmp_monthly_hcp_activity.territory_id,
          tmp_monthly_hcp_activity.product_id,
          tmp_monthly_hcp_activity.month_ending,
          tmp_monthly_hcp_activity.month_bucket,
          tmp_monthly_hcp_activity.target_status,
          tmp_monthly_hcp_activity.how_executed,
          tmp_monthly_hcp_activity.call_recordtype
SEGMENTED BY hash(tmp_monthly_hcp_activity.customer_id, tmp_monthly_hcp_activity.territory_id, tmp_monthly_hcp_activity.product_id, tmp_monthly_hcp_activity.month_bucket) ALL NODES;

CREATE PROJECTION sandbox.tmp_monthly_hcp_trend_v2_b0 /*+basename(tmp_monthly_hcp_trend_v2),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 nation_id,
 nation_name,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 month_bucket,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_monthly_hcp_trend_v2.customer_id,
        tmp_monthly_hcp_trend_v2.sales_force_id,
        tmp_monthly_hcp_trend_v2.geography_level,
        tmp_monthly_hcp_trend_v2.nation_id,
        tmp_monthly_hcp_trend_v2.nation_name,
        tmp_monthly_hcp_trend_v2.area_id,
        tmp_monthly_hcp_trend_v2.area_name,
        tmp_monthly_hcp_trend_v2.region_id,
        tmp_monthly_hcp_trend_v2.region_name,
        tmp_monthly_hcp_trend_v2.territory_id,
        tmp_monthly_hcp_trend_v2.territory_name,
        tmp_monthly_hcp_trend_v2.market_id,
        tmp_monthly_hcp_trend_v2.market_name,
        tmp_monthly_hcp_trend_v2.brand_id,
        tmp_monthly_hcp_trend_v2.brand_name,
        tmp_monthly_hcp_trend_v2.time_period,
        tmp_monthly_hcp_trend_v2.period_type,
        tmp_monthly_hcp_trend_v2.period,
        tmp_monthly_hcp_trend_v2.month_bucket,
        tmp_monthly_hcp_trend_v2.decile,
        tmp_monthly_hcp_trend_v2.segment,
        tmp_monthly_hcp_trend_v2.specialty,
        tmp_monthly_hcp_trend_v2.target_status,
        tmp_monthly_hcp_trend_v2.how_executed,
        tmp_monthly_hcp_trend_v2.call_recordtype,
        tmp_monthly_hcp_trend_v2.details_p1,
        tmp_monthly_hcp_trend_v2.details_p2,
        tmp_monthly_hcp_trend_v2.details_p3,
        tmp_monthly_hcp_trend_v2.total_details,
        tmp_monthly_hcp_trend_v2.samples
 FROM sandbox.tmp_monthly_hcp_trend_v2
 ORDER BY tmp_monthly_hcp_trend_v2.customer_id,
          tmp_monthly_hcp_trend_v2.sales_force_id,
          tmp_monthly_hcp_trend_v2.geography_level,
          tmp_monthly_hcp_trend_v2.nation_id,
          tmp_monthly_hcp_trend_v2.nation_name,
          tmp_monthly_hcp_trend_v2.area_id,
          tmp_monthly_hcp_trend_v2.area_name,
          tmp_monthly_hcp_trend_v2.region_id,
          tmp_monthly_hcp_trend_v2.region_name,
          tmp_monthly_hcp_trend_v2.territory_id,
          tmp_monthly_hcp_trend_v2.territory_name,
          tmp_monthly_hcp_trend_v2.market_id,
          tmp_monthly_hcp_trend_v2.market_name,
          tmp_monthly_hcp_trend_v2.brand_id,
          tmp_monthly_hcp_trend_v2.brand_name,
          tmp_monthly_hcp_trend_v2.period,
          tmp_monthly_hcp_trend_v2.month_bucket,
          tmp_monthly_hcp_trend_v2.decile,
          tmp_monthly_hcp_trend_v2.segment,
          tmp_monthly_hcp_trend_v2.specialty,
          tmp_monthly_hcp_trend_v2.target_status,
          tmp_monthly_hcp_trend_v2.how_executed,
          tmp_monthly_hcp_trend_v2.call_recordtype
SEGMENTED BY hash(tmp_monthly_hcp_trend_v2.customer_id, tmp_monthly_hcp_trend_v2.sales_force_id, tmp_monthly_hcp_trend_v2.geography_level, tmp_monthly_hcp_trend_v2.nation_id, tmp_monthly_hcp_trend_v2.nation_name, tmp_monthly_hcp_trend_v2.area_id, tmp_monthly_hcp_trend_v2.area_name, tmp_monthly_hcp_trend_v2.region_id, tmp_monthly_hcp_trend_v2.region_name, tmp_monthly_hcp_trend_v2.territory_id, tmp_monthly_hcp_trend_v2.territory_name, tmp_monthly_hcp_trend_v2.market_id, tmp_monthly_hcp_trend_v2.market_name, tmp_monthly_hcp_trend_v2.brand_id, tmp_monthly_hcp_trend_v2.brand_name, tmp_monthly_hcp_trend_v2.period, tmp_monthly_hcp_trend_v2.month_bucket, tmp_monthly_hcp_trend_v2.decile, tmp_monthly_hcp_trend_v2.segment, tmp_monthly_hcp_trend_v2.specialty, tmp_monthly_hcp_trend_v2.target_status, tmp_monthly_hcp_trend_v2.how_executed, tmp_monthly_hcp_trend_v2.call_recordtype) ALL NODES;

CREATE PROJECTION sandbox.par_rnf_test_b0 /*+basename(par_rnf_test),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prescriber_count_calls,
 prescriber_count_samples,
 prescriber_reached_calls,
 prescriber_reached_samples
)
AS
 SELECT par_rnf_test.sales_force_id,
        par_rnf_test.geography_level,
        par_rnf_test.geography_id,
        par_rnf_test.geography,
        par_rnf_test.rep_name,
        par_rnf_test.user_id,
        par_rnf_test.market_id,
        par_rnf_test.market_name,
        par_rnf_test.brand_id,
        par_rnf_test.brand_name,
        par_rnf_test.time_period,
        par_rnf_test.period_type,
        par_rnf_test.period,
        par_rnf_test.decile,
        par_rnf_test.segment,
        par_rnf_test.specialty,
        par_rnf_test.target_status,
        par_rnf_test.how_executed,
        par_rnf_test.call_recordtype,
        par_rnf_test.details_p1,
        par_rnf_test.details_p2,
        par_rnf_test.details_p3,
        par_rnf_test.total_details,
        par_rnf_test.samples,
        par_rnf_test.prescriber_count_calls,
        par_rnf_test.prescriber_count_samples,
        par_rnf_test.prescriber_reached_calls,
        par_rnf_test.prescriber_reached_samples
 FROM sandbox.par_rnf_test
 ORDER BY par_rnf_test.sales_force_id,
          par_rnf_test.geography_level,
          par_rnf_test.geography_id,
          par_rnf_test.geography,
          par_rnf_test.rep_name,
          par_rnf_test.user_id,
          par_rnf_test.market_id,
          par_rnf_test.market_name
SEGMENTED BY hash(par_rnf_test.sales_force_id, par_rnf_test.geography_level, par_rnf_test.geography_id, par_rnf_test.geography, par_rnf_test.time_period, par_rnf_test.period_type, par_rnf_test.period, par_rnf_test.decile, par_rnf_test.segment, par_rnf_test.specialty, par_rnf_test.target_status) ALL NODES;

CREATE PROJECTION sandbox.tmp_monthly_hcp_trend_b0 /*+basename(tmp_monthly_hcp_trend),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 nation_id,
 nation_name,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 month_bucket,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_monthly_hcp_trend.customer_id,
        tmp_monthly_hcp_trend.sales_force_id,
        tmp_monthly_hcp_trend.geography_level,
        tmp_monthly_hcp_trend.nation_id,
        tmp_monthly_hcp_trend.nation_name,
        tmp_monthly_hcp_trend.area_id,
        tmp_monthly_hcp_trend.area_name,
        tmp_monthly_hcp_trend.region_id,
        tmp_monthly_hcp_trend.region_name,
        tmp_monthly_hcp_trend.territory_id,
        tmp_monthly_hcp_trend.territory_name,
        tmp_monthly_hcp_trend.market_id,
        tmp_monthly_hcp_trend.market_name,
        tmp_monthly_hcp_trend.brand_id,
        tmp_monthly_hcp_trend.brand_name,
        tmp_monthly_hcp_trend.time_period,
        tmp_monthly_hcp_trend.period_type,
        tmp_monthly_hcp_trend.period,
        tmp_monthly_hcp_trend.month_bucket,
        tmp_monthly_hcp_trend.decile,
        tmp_monthly_hcp_trend.segment,
        tmp_monthly_hcp_trend.specialty,
        tmp_monthly_hcp_trend.target_status,
        tmp_monthly_hcp_trend.how_executed,
        tmp_monthly_hcp_trend.call_recordtype,
        tmp_monthly_hcp_trend.details_p1,
        tmp_monthly_hcp_trend.details_p2,
        tmp_monthly_hcp_trend.details_p3,
        tmp_monthly_hcp_trend.total_details,
        tmp_monthly_hcp_trend.samples
 FROM sandbox.tmp_monthly_hcp_trend
 ORDER BY tmp_monthly_hcp_trend.customer_id,
          tmp_monthly_hcp_trend.sales_force_id,
          tmp_monthly_hcp_trend.geography_level,
          tmp_monthly_hcp_trend.nation_id,
          tmp_monthly_hcp_trend.nation_name,
          tmp_monthly_hcp_trend.area_id,
          tmp_monthly_hcp_trend.area_name,
          tmp_monthly_hcp_trend.region_id,
          tmp_monthly_hcp_trend.region_name,
          tmp_monthly_hcp_trend.territory_id,
          tmp_monthly_hcp_trend.territory_name,
          tmp_monthly_hcp_trend.market_id,
          tmp_monthly_hcp_trend.market_name,
          tmp_monthly_hcp_trend.brand_id,
          tmp_monthly_hcp_trend.brand_name,
          tmp_monthly_hcp_trend.period,
          tmp_monthly_hcp_trend.month_bucket,
          tmp_monthly_hcp_trend.decile,
          tmp_monthly_hcp_trend.segment,
          tmp_monthly_hcp_trend.specialty,
          tmp_monthly_hcp_trend.target_status,
          tmp_monthly_hcp_trend.how_executed,
          tmp_monthly_hcp_trend.call_recordtype
SEGMENTED BY hash(tmp_monthly_hcp_trend.customer_id, tmp_monthly_hcp_trend.sales_force_id, tmp_monthly_hcp_trend.geography_level, tmp_monthly_hcp_trend.nation_id, tmp_monthly_hcp_trend.nation_name, tmp_monthly_hcp_trend.area_id, tmp_monthly_hcp_trend.area_name, tmp_monthly_hcp_trend.region_id, tmp_monthly_hcp_trend.region_name, tmp_monthly_hcp_trend.territory_id, tmp_monthly_hcp_trend.territory_name, tmp_monthly_hcp_trend.market_id, tmp_monthly_hcp_trend.market_name, tmp_monthly_hcp_trend.brand_id, tmp_monthly_hcp_trend.brand_name, tmp_monthly_hcp_trend.period, tmp_monthly_hcp_trend.month_bucket, tmp_monthly_hcp_trend.decile, tmp_monthly_hcp_trend.segment, tmp_monthly_hcp_trend.specialty, tmp_monthly_hcp_trend.target_status, tmp_monthly_hcp_trend.how_executed, tmp_monthly_hcp_trend.call_recordtype) ALL NODES;

CREATE PROJECTION sandbox.par_rnf_ho_b0 /*+basename(par_rnf_ho),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prescriber_count_calls,
 prescriber_count_samples,
 prescriber_reached_calls,
 prescriber_reached_samples,
 how_executed,
 call_recordtype
)
AS
 SELECT par_rnf_ho.sales_force_id,
        par_rnf_ho.geography_level,
        par_rnf_ho.geography_id,
        par_rnf_ho.geography,
        par_rnf_ho.rep_name,
        par_rnf_ho.user_id,
        par_rnf_ho.market_id,
        par_rnf_ho.market_name,
        par_rnf_ho.brand_id,
        par_rnf_ho.brand_name,
        par_rnf_ho.time_period,
        par_rnf_ho.period_type,
        par_rnf_ho.period,
        par_rnf_ho.decile,
        par_rnf_ho.segment,
        par_rnf_ho.specialty,
        par_rnf_ho.target_status,
        par_rnf_ho.details_p1,
        par_rnf_ho.details_p2,
        par_rnf_ho.details_p3,
        par_rnf_ho.total_details,
        par_rnf_ho.samples,
        par_rnf_ho.prescriber_count_calls,
        par_rnf_ho.prescriber_count_samples,
        par_rnf_ho.prescriber_reached_calls,
        par_rnf_ho.prescriber_reached_samples,
        par_rnf_ho.how_executed,
        par_rnf_ho.call_recordtype
 FROM sandbox.par_rnf_ho
 ORDER BY par_rnf_ho.sales_force_id,
          par_rnf_ho.geography_level,
          par_rnf_ho.geography_id,
          par_rnf_ho.geography,
          par_rnf_ho.rep_name,
          par_rnf_ho.user_id,
          par_rnf_ho.market_id,
          par_rnf_ho.market_name
SEGMENTED BY hash(par_rnf_ho.sales_force_id, par_rnf_ho.market_id, par_rnf_ho.brand_id, par_rnf_ho.details_p1, par_rnf_ho.details_p2, par_rnf_ho.details_p3, par_rnf_ho.total_details, par_rnf_ho.samples) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_hcp_activity_1_b0 /*+basename(tmp_weekly_hcp_activity_1),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 territory_id,
 product_id,
 week_ending,
 week_bucket,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_hcp_activity_1.customer_id,
        tmp_weekly_hcp_activity_1.sales_force_id,
        tmp_weekly_hcp_activity_1.territory_id,
        tmp_weekly_hcp_activity_1.product_id,
        tmp_weekly_hcp_activity_1.week_ending,
        tmp_weekly_hcp_activity_1.week_bucket,
        tmp_weekly_hcp_activity_1.target_status,
        tmp_weekly_hcp_activity_1.how_executed,
        tmp_weekly_hcp_activity_1.call_recordtype,
        tmp_weekly_hcp_activity_1.details_p1,
        tmp_weekly_hcp_activity_1.details_p2,
        tmp_weekly_hcp_activity_1.details_p3,
        tmp_weekly_hcp_activity_1.total_details,
        tmp_weekly_hcp_activity_1.samples
 FROM sandbox.tmp_weekly_hcp_activity_1
 ORDER BY tmp_weekly_hcp_activity_1.customer_id,
          tmp_weekly_hcp_activity_1.sales_force_id,
          tmp_weekly_hcp_activity_1.territory_id,
          tmp_weekly_hcp_activity_1.product_id,
          tmp_weekly_hcp_activity_1.week_ending,
          tmp_weekly_hcp_activity_1.week_bucket,
          tmp_weekly_hcp_activity_1.target_status,
          tmp_weekly_hcp_activity_1.how_executed,
          tmp_weekly_hcp_activity_1.call_recordtype
SEGMENTED BY hash(tmp_weekly_hcp_activity_1.customer_id, tmp_weekly_hcp_activity_1.territory_id, tmp_weekly_hcp_activity_1.product_id, tmp_weekly_hcp_activity_1.week_bucket) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_rte_trend_b0 /*+basename(tmp_weekly_rte_trend),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 customer_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 week_bucket,
 date_sent,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_rte_trend.sales_force_id,
        tmp_weekly_rte_trend.call_id,
        tmp_weekly_rte_trend.customer_id,
        tmp_weekly_rte_trend.geography_level,
        tmp_weekly_rte_trend.geography_id,
        tmp_weekly_rte_trend.geography,
        tmp_weekly_rte_trend.rep_name,
        tmp_weekly_rte_trend.user_id,
        tmp_weekly_rte_trend.market_id,
        tmp_weekly_rte_trend.market_name,
        tmp_weekly_rte_trend.brand_id,
        tmp_weekly_rte_trend.brand_name,
        tmp_weekly_rte_trend.time_period,
        tmp_weekly_rte_trend.period_type,
        tmp_weekly_rte_trend.period,
        tmp_weekly_rte_trend.week_bucket,
        tmp_weekly_rte_trend.date_sent,
        tmp_weekly_rte_trend.decile,
        tmp_weekly_rte_trend.segment,
        tmp_weekly_rte_trend.specialty,
        tmp_weekly_rte_trend.target_status,
        tmp_weekly_rte_trend.how_executed,
        tmp_weekly_rte_trend.call_recordtype,
        tmp_weekly_rte_trend.details_p1,
        tmp_weekly_rte_trend.details_p2,
        tmp_weekly_rte_trend.details_p3,
        tmp_weekly_rte_trend.total_details,
        tmp_weekly_rte_trend.samples
 FROM sandbox.tmp_weekly_rte_trend
 ORDER BY tmp_weekly_rte_trend.sales_force_id,
          tmp_weekly_rte_trend.call_id,
          tmp_weekly_rte_trend.customer_id,
          tmp_weekly_rte_trend.geography_level,
          tmp_weekly_rte_trend.geography_id,
          tmp_weekly_rte_trend.geography
SEGMENTED BY hash(tmp_weekly_rte_trend.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_monthly_rte_trend_b0 /*+basename(tmp_monthly_rte_trend),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 customer_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 month_bucket,
 date_sent,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_monthly_rte_trend.sales_force_id,
        tmp_monthly_rte_trend.call_id,
        tmp_monthly_rte_trend.customer_id,
        tmp_monthly_rte_trend.geography_level,
        tmp_monthly_rte_trend.geography_id,
        tmp_monthly_rte_trend.geography,
        tmp_monthly_rte_trend.rep_name,
        tmp_monthly_rte_trend.user_id,
        tmp_monthly_rte_trend.market_id,
        tmp_monthly_rte_trend.market_name,
        tmp_monthly_rte_trend.brand_id,
        tmp_monthly_rte_trend.brand_name,
        tmp_monthly_rte_trend.time_period,
        tmp_monthly_rte_trend.period_type,
        tmp_monthly_rte_trend.period,
        tmp_monthly_rte_trend.month_bucket,
        tmp_monthly_rte_trend.date_sent,
        tmp_monthly_rte_trend.decile,
        tmp_monthly_rte_trend.segment,
        tmp_monthly_rte_trend.specialty,
        tmp_monthly_rte_trend.target_status,
        tmp_monthly_rte_trend.how_executed,
        tmp_monthly_rte_trend.call_recordtype,
        tmp_monthly_rte_trend.details_p1,
        tmp_monthly_rte_trend.details_p2,
        tmp_monthly_rte_trend.details_p3,
        tmp_monthly_rte_trend.total_details,
        tmp_monthly_rte_trend.samples
 FROM sandbox.tmp_monthly_rte_trend
 ORDER BY tmp_monthly_rte_trend.sales_force_id,
          tmp_monthly_rte_trend.call_id,
          tmp_monthly_rte_trend.customer_id,
          tmp_monthly_rte_trend.geography_level,
          tmp_monthly_rte_trend.geography_id,
          tmp_monthly_rte_trend.geography
SEGMENTED BY hash(tmp_monthly_rte_trend.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_monthly_rte_agg_b0 /*+basename(tmp_monthly_rte_agg),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 date_sent,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_monthly_rte_agg.customer_id,
        tmp_monthly_rte_agg.sales_force_id,
        tmp_monthly_rte_agg.geography_level,
        tmp_monthly_rte_agg.geography_id,
        tmp_monthly_rte_agg.geography,
        tmp_monthly_rte_agg.market_id,
        tmp_monthly_rte_agg.market_name,
        tmp_monthly_rte_agg.brand_id,
        tmp_monthly_rte_agg.brand_name,
        tmp_monthly_rte_agg.time_period,
        tmp_monthly_rte_agg.period_type,
        tmp_monthly_rte_agg.period,
        tmp_monthly_rte_agg.date_sent,
        tmp_monthly_rte_agg.decile,
        tmp_monthly_rte_agg.segment,
        tmp_monthly_rte_agg.specialty,
        tmp_monthly_rte_agg.target_status,
        tmp_monthly_rte_agg.how_executed,
        tmp_monthly_rte_agg.call_recordtype,
        tmp_monthly_rte_agg.details_p1,
        tmp_monthly_rte_agg.details_p2,
        tmp_monthly_rte_agg.details_p3,
        tmp_monthly_rte_agg.total_details,
        tmp_monthly_rte_agg.samples
 FROM sandbox.tmp_monthly_rte_agg
 ORDER BY tmp_monthly_rte_agg.customer_id,
          tmp_monthly_rte_agg.sales_force_id,
          tmp_monthly_rte_agg.geography_level,
          tmp_monthly_rte_agg.geography_id,
          tmp_monthly_rte_agg.geography,
          tmp_monthly_rte_agg.market_id,
          tmp_monthly_rte_agg.market_name,
          tmp_monthly_rte_agg.brand_id,
          tmp_monthly_rte_agg.brand_name,
          tmp_monthly_rte_agg.time_period,
          tmp_monthly_rte_agg.period_type,
          tmp_monthly_rte_agg.period,
          tmp_monthly_rte_agg.date_sent,
          tmp_monthly_rte_agg.decile,
          tmp_monthly_rte_agg.segment,
          tmp_monthly_rte_agg.specialty,
          tmp_monthly_rte_agg.target_status,
          tmp_monthly_rte_agg.how_executed,
          tmp_monthly_rte_agg.call_recordtype
SEGMENTED BY hash(tmp_monthly_rte_agg.customer_id, tmp_monthly_rte_agg.sales_force_id, tmp_monthly_rte_agg.geography_level, tmp_monthly_rte_agg.geography_id, tmp_monthly_rte_agg.geography, tmp_monthly_rte_agg.market_id, tmp_monthly_rte_agg.market_name, tmp_monthly_rte_agg.brand_id, tmp_monthly_rte_agg.brand_name, tmp_monthly_rte_agg.date_sent, tmp_monthly_rte_agg.decile, tmp_monthly_rte_agg.segment, tmp_monthly_rte_agg.specialty, tmp_monthly_rte_agg.target_status, tmp_monthly_rte_agg.how_executed, tmp_monthly_rte_agg.call_recordtype) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_hcp_activity_b0 /*+basename(tmp_weekly_hcp_activity),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 territory_id,
 product_id,
 week_ending,
 week_bucket,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_hcp_activity.customer_id,
        tmp_weekly_hcp_activity.sales_force_id,
        tmp_weekly_hcp_activity.territory_id,
        tmp_weekly_hcp_activity.product_id,
        tmp_weekly_hcp_activity.week_ending,
        tmp_weekly_hcp_activity.week_bucket,
        tmp_weekly_hcp_activity.target_status,
        tmp_weekly_hcp_activity.how_executed,
        tmp_weekly_hcp_activity.call_recordtype,
        tmp_weekly_hcp_activity.details_p1,
        tmp_weekly_hcp_activity.details_p2,
        tmp_weekly_hcp_activity.details_p3,
        tmp_weekly_hcp_activity.total_details,
        tmp_weekly_hcp_activity.samples
 FROM sandbox.tmp_weekly_hcp_activity
 ORDER BY tmp_weekly_hcp_activity.customer_id,
          tmp_weekly_hcp_activity.sales_force_id,
          tmp_weekly_hcp_activity.territory_id,
          tmp_weekly_hcp_activity.product_id,
          tmp_weekly_hcp_activity.week_ending,
          tmp_weekly_hcp_activity.week_bucket,
          tmp_weekly_hcp_activity.target_status,
          tmp_weekly_hcp_activity.how_executed,
          tmp_weekly_hcp_activity.call_recordtype
SEGMENTED BY hash(tmp_weekly_hcp_activity.customer_id, tmp_weekly_hcp_activity.territory_id, tmp_weekly_hcp_activity.product_id, tmp_weekly_hcp_activity.week_bucket) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_hcp_trend_b0 /*+basename(tmp_weekly_hcp_trend),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 nation_id,
 nation_name,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 week_bucket,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_hcp_trend.customer_id,
        tmp_weekly_hcp_trend.sales_force_id,
        tmp_weekly_hcp_trend.geography_level,
        tmp_weekly_hcp_trend.nation_id,
        tmp_weekly_hcp_trend.nation_name,
        tmp_weekly_hcp_trend.area_id,
        tmp_weekly_hcp_trend.area_name,
        tmp_weekly_hcp_trend.region_id,
        tmp_weekly_hcp_trend.region_name,
        tmp_weekly_hcp_trend.territory_id,
        tmp_weekly_hcp_trend.territory_name,
        tmp_weekly_hcp_trend.market_id,
        tmp_weekly_hcp_trend.market_name,
        tmp_weekly_hcp_trend.brand_id,
        tmp_weekly_hcp_trend.brand_name,
        tmp_weekly_hcp_trend.time_period,
        tmp_weekly_hcp_trend.period_type,
        tmp_weekly_hcp_trend.period,
        tmp_weekly_hcp_trend.week_bucket,
        tmp_weekly_hcp_trend.decile,
        tmp_weekly_hcp_trend.segment,
        tmp_weekly_hcp_trend.specialty,
        tmp_weekly_hcp_trend.target_status,
        tmp_weekly_hcp_trend.how_executed,
        tmp_weekly_hcp_trend.call_recordtype,
        tmp_weekly_hcp_trend.details_p1,
        tmp_weekly_hcp_trend.details_p2,
        tmp_weekly_hcp_trend.details_p3,
        tmp_weekly_hcp_trend.total_details,
        tmp_weekly_hcp_trend.samples
 FROM sandbox.tmp_weekly_hcp_trend
 ORDER BY tmp_weekly_hcp_trend.customer_id,
          tmp_weekly_hcp_trend.sales_force_id,
          tmp_weekly_hcp_trend.geography_level,
          tmp_weekly_hcp_trend.nation_id,
          tmp_weekly_hcp_trend.nation_name,
          tmp_weekly_hcp_trend.area_id,
          tmp_weekly_hcp_trend.area_name,
          tmp_weekly_hcp_trend.region_id,
          tmp_weekly_hcp_trend.region_name,
          tmp_weekly_hcp_trend.territory_id,
          tmp_weekly_hcp_trend.territory_name,
          tmp_weekly_hcp_trend.market_id,
          tmp_weekly_hcp_trend.market_name,
          tmp_weekly_hcp_trend.brand_id,
          tmp_weekly_hcp_trend.brand_name,
          tmp_weekly_hcp_trend.period,
          tmp_weekly_hcp_trend.week_bucket,
          tmp_weekly_hcp_trend.decile,
          tmp_weekly_hcp_trend.segment,
          tmp_weekly_hcp_trend.specialty,
          tmp_weekly_hcp_trend.target_status,
          tmp_weekly_hcp_trend.how_executed,
          tmp_weekly_hcp_trend.call_recordtype
SEGMENTED BY hash(tmp_weekly_hcp_trend.customer_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_weekly_hcp_agg_b0 /*+basename(tmp_weekly_hcp_agg),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 geography_level,
 nation_id,
 nation_name,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 how_executed,
 call_recordtype,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples
)
AS
 SELECT tmp_weekly_hcp_agg.customer_id,
        tmp_weekly_hcp_agg.sales_force_id,
        tmp_weekly_hcp_agg.geography_level,
        tmp_weekly_hcp_agg.nation_id,
        tmp_weekly_hcp_agg.nation_name,
        tmp_weekly_hcp_agg.area_id,
        tmp_weekly_hcp_agg.area_name,
        tmp_weekly_hcp_agg.region_id,
        tmp_weekly_hcp_agg.region_name,
        tmp_weekly_hcp_agg.territory_id,
        tmp_weekly_hcp_agg.territory_name,
        tmp_weekly_hcp_agg.market_id,
        tmp_weekly_hcp_agg.market_name,
        tmp_weekly_hcp_agg.brand_id,
        tmp_weekly_hcp_agg.brand_name,
        tmp_weekly_hcp_agg.time_period,
        tmp_weekly_hcp_agg.period_type,
        tmp_weekly_hcp_agg.period,
        tmp_weekly_hcp_agg.decile,
        tmp_weekly_hcp_agg.segment,
        tmp_weekly_hcp_agg.specialty,
        tmp_weekly_hcp_agg.target_status,
        tmp_weekly_hcp_agg.how_executed,
        tmp_weekly_hcp_agg.call_recordtype,
        tmp_weekly_hcp_agg.details_p1,
        tmp_weekly_hcp_agg.details_p2,
        tmp_weekly_hcp_agg.details_p3,
        tmp_weekly_hcp_agg.total_details,
        tmp_weekly_hcp_agg.samples
 FROM sandbox.tmp_weekly_hcp_agg
 ORDER BY tmp_weekly_hcp_agg.customer_id,
          tmp_weekly_hcp_agg.sales_force_id,
          tmp_weekly_hcp_agg.geography_level,
          tmp_weekly_hcp_agg.nation_id,
          tmp_weekly_hcp_agg.nation_name,
          tmp_weekly_hcp_agg.area_id,
          tmp_weekly_hcp_agg.area_name,
          tmp_weekly_hcp_agg.region_id,
          tmp_weekly_hcp_agg.region_name,
          tmp_weekly_hcp_agg.territory_id,
          tmp_weekly_hcp_agg.territory_name,
          tmp_weekly_hcp_agg.market_id,
          tmp_weekly_hcp_agg.market_name,
          tmp_weekly_hcp_agg.brand_id,
          tmp_weekly_hcp_agg.brand_name,
          tmp_weekly_hcp_agg.time_period,
          tmp_weekly_hcp_agg.period_type,
          tmp_weekly_hcp_agg.period,
          tmp_weekly_hcp_agg.decile,
          tmp_weekly_hcp_agg.segment,
          tmp_weekly_hcp_agg.specialty,
          tmp_weekly_hcp_agg.target_status,
          tmp_weekly_hcp_agg.how_executed,
          tmp_weekly_hcp_agg.call_recordtype
SEGMENTED BY hash(tmp_weekly_hcp_agg.customer_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_hcp_universe_b0 /*+basename(tmp_hcp_universe),createtype(A)*/ 
(
 customer_id,
 sales_force_id,
 current_geography_id,
 product_id,
 target_status,
 period_ending,
 week_bucket
)
AS
 SELECT tmp_hcp_universe.customer_id,
        tmp_hcp_universe.sales_force_id,
        tmp_hcp_universe.current_geography_id,
        tmp_hcp_universe.product_id,
        tmp_hcp_universe.target_status,
        tmp_hcp_universe.period_ending,
        tmp_hcp_universe.week_bucket
 FROM sandbox.tmp_hcp_universe
 ORDER BY tmp_hcp_universe.customer_id,
          tmp_hcp_universe.sales_force_id,
          tmp_hcp_universe.current_geography_id,
          tmp_hcp_universe.product_id,
          tmp_hcp_universe.target_status,
          tmp_hcp_universe.period_ending,
          tmp_hcp_universe.week_bucket
SEGMENTED BY hash(tmp_hcp_universe.customer_id, tmp_hcp_universe.product_id, tmp_hcp_universe.current_geography_id) ALL NODES;

CREATE PROJECTION sandbox.oncology_sales_deciles_b0 /*+basename(oncology_sales_deciles),createtype(A)*/ 
(
 account_demo_id,
 outlet_name,
 outlet_zip,
 decile_name,
 basket_id,
 basket_name,
 decile_reported_dollars_6_mo,
 decile_reported_dollars_12_mo,
 reported_dollars_6_mo,
 reported_dollars_12_mo,
 reported_dollars_24_mo,
 tvcmid
)
AS
 SELECT oncology_sales_deciles.account_demo_id,
        oncology_sales_deciles.outlet_name,
        oncology_sales_deciles.outlet_zip,
        oncology_sales_deciles.decile_name,
        oncology_sales_deciles.basket_id,
        oncology_sales_deciles.basket_name,
        oncology_sales_deciles.decile_reported_dollars_6_mo,
        oncology_sales_deciles.decile_reported_dollars_12_mo,
        oncology_sales_deciles.reported_dollars_6_mo,
        oncology_sales_deciles.reported_dollars_12_mo,
        oncology_sales_deciles.reported_dollars_24_mo,
        oncology_sales_deciles.tvcmid
 FROM sandbox.oncology_sales_deciles
 ORDER BY oncology_sales_deciles.account_demo_id
SEGMENTED BY hash(oncology_sales_deciles.basket_id) ALL NODES;

CREATE PROJECTION sandbox.ic_ms_market_decile_201601_b0 /*+basename(ic_ms_market_decile_201601),createtype(L)*/ 
(
 ims_id,
 category,
 decile_name,
 trx_cnt_01_06,
 trx_cnt_01_12
)
AS
 SELECT ic_ms_market_decile_201601.ims_id,
        ic_ms_market_decile_201601.category,
        ic_ms_market_decile_201601.decile_name,
        ic_ms_market_decile_201601.trx_cnt_01_06,
        ic_ms_market_decile_201601.trx_cnt_01_12
 FROM sandbox.ic_ms_market_decile_201601
 ORDER BY ic_ms_market_decile_201601.ims_id,
          ic_ms_market_decile_201601.category,
          ic_ms_market_decile_201601.decile_name,
          ic_ms_market_decile_201601.trx_cnt_01_06,
          ic_ms_market_decile_201601.trx_cnt_01_12
SEGMENTED BY hash(ic_ms_market_decile_201601.trx_cnt_01_06, ic_ms_market_decile_201601.trx_cnt_01_12, ic_ms_market_decile_201601.ims_id, ic_ms_market_decile_201601.decile_name, ic_ms_market_decile_201601.category) ALL NODES;

CREATE PROJECTION sandbox.ic_ms_market_decile_201701_b0 /*+basename(ic_ms_market_decile_201701),createtype(A)*/ 
(
 ims_id,
 category,
 decile_name,
 trx_cnt_01_06,
 trx_cnt_01_12
)
AS
 SELECT ic_ms_market_decile_201701.ims_id,
        ic_ms_market_decile_201701.category,
        ic_ms_market_decile_201701.decile_name,
        ic_ms_market_decile_201701.trx_cnt_01_06,
        ic_ms_market_decile_201701.trx_cnt_01_12
 FROM sandbox.ic_ms_market_decile_201701
 ORDER BY ic_ms_market_decile_201701.ims_id,
          ic_ms_market_decile_201701.category,
          ic_ms_market_decile_201701.decile_name,
          ic_ms_market_decile_201701.trx_cnt_01_06,
          ic_ms_market_decile_201701.trx_cnt_01_12
SEGMENTED BY hash(ic_ms_market_decile_201701.trx_cnt_01_06, ic_ms_market_decile_201701.trx_cnt_01_12, ic_ms_market_decile_201701.ims_id, ic_ms_market_decile_201701.decile_name, ic_ms_market_decile_201701.category) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_DIAGNOSIS_CODE_b0 /*+basename(STG_LAAD_DIAGNOSIS_CODE),createtype(L)*/ 
(
 DIAGNOSIS_CODE,
 DIAGNOSIS_DESCRIPTION
)
AS
 SELECT STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_CODE,
        STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_DESCRIPTION
 FROM sandbox.STG_LAAD_DIAGNOSIS_CODE
 ORDER BY STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_CODE,
          STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_DESCRIPTION
SEGMENTED BY hash(STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_CODE, STG_LAAD_DIAGNOSIS_CODE.DIAGNOSIS_DESCRIPTION) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PATIENT_b0 /*+basename(STG_LAAD_PATIENT),createtype(L)*/ 
(
 PATIENT_ID,
 PATIENT_BIRTH_YEAR,
 PATIENT_GENDER
)
AS
 SELECT STG_LAAD_PATIENT.PATIENT_ID,
        STG_LAAD_PATIENT.PATIENT_BIRTH_YEAR,
        STG_LAAD_PATIENT.PATIENT_GENDER
 FROM sandbox.STG_LAAD_PATIENT
 ORDER BY STG_LAAD_PATIENT.PATIENT_ID,
          STG_LAAD_PATIENT.PATIENT_BIRTH_YEAR,
          STG_LAAD_PATIENT.PATIENT_GENDER
SEGMENTED BY hash(STG_LAAD_PATIENT.PATIENT_BIRTH_YEAR, STG_LAAD_PATIENT.PATIENT_GENDER, STG_LAAD_PATIENT.PATIENT_ID) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PLAN_b0 /*+basename(STG_LAAD_PLAN),createtype(L)*/ 
(
 PLAN_ID,
 PAYER_NAME,
 PLAN_NAME,
 PBM_NAME,
 METHOD_OF_PAYMENT,
 MODEL_TYPE
)
AS
 SELECT STG_LAAD_PLAN.PLAN_ID,
        STG_LAAD_PLAN.PAYER_NAME,
        STG_LAAD_PLAN.PLAN_NAME,
        STG_LAAD_PLAN.PBM_NAME,
        STG_LAAD_PLAN.METHOD_OF_PAYMENT,
        STG_LAAD_PLAN.MODEL_TYPE
 FROM sandbox.STG_LAAD_PLAN
 ORDER BY STG_LAAD_PLAN.PLAN_ID,
          STG_LAAD_PLAN.PAYER_NAME,
          STG_LAAD_PLAN.PLAN_NAME,
          STG_LAAD_PLAN.PBM_NAME,
          STG_LAAD_PLAN.METHOD_OF_PAYMENT,
          STG_LAAD_PLAN.MODEL_TYPE
SEGMENTED BY hash(STG_LAAD_PLAN.PLAN_ID, STG_LAAD_PLAN.PAYER_NAME, STG_LAAD_PLAN.PLAN_NAME, STG_LAAD_PLAN.PBM_NAME, STG_LAAD_PLAN.METHOD_OF_PAYMENT, STG_LAAD_PLAN.MODEL_TYPE) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PRESCRIBER_b0 /*+basename(STG_LAAD_PRESCRIBER),createtype(L)*/ 
(
 PRESCRIBER_ID,
 FIRST_NAME,
 LAST_NAME,
 ADDRESS,
 CITY,
 STATE,
 ZIP,
 SPECIALTY_CODE,
 SPECIALTY_DESC,
 ME_NUM,
 NPI
)
AS
 SELECT STG_LAAD_PRESCRIBER.PRESCRIBER_ID,
        STG_LAAD_PRESCRIBER.FIRST_NAME,
        STG_LAAD_PRESCRIBER.LAST_NAME,
        STG_LAAD_PRESCRIBER.ADDRESS,
        STG_LAAD_PRESCRIBER.CITY,
        STG_LAAD_PRESCRIBER.STATE,
        STG_LAAD_PRESCRIBER.ZIP,
        STG_LAAD_PRESCRIBER.SPECIALTY_CODE,
        STG_LAAD_PRESCRIBER.SPECIALTY_DESC,
        STG_LAAD_PRESCRIBER.ME_NUM,
        STG_LAAD_PRESCRIBER.NPI
 FROM sandbox.STG_LAAD_PRESCRIBER
 ORDER BY STG_LAAD_PRESCRIBER.PRESCRIBER_ID,
          STG_LAAD_PRESCRIBER.FIRST_NAME,
          STG_LAAD_PRESCRIBER.LAST_NAME,
          STG_LAAD_PRESCRIBER.ADDRESS,
          STG_LAAD_PRESCRIBER.CITY,
          STG_LAAD_PRESCRIBER.STATE,
          STG_LAAD_PRESCRIBER.ZIP,
          STG_LAAD_PRESCRIBER.SPECIALTY_CODE,
          STG_LAAD_PRESCRIBER.SPECIALTY_DESC,
          STG_LAAD_PRESCRIBER.ME_NUM,
          STG_LAAD_PRESCRIBER.NPI
SEGMENTED BY hash(STG_LAAD_PRESCRIBER.STATE, STG_LAAD_PRESCRIBER.ZIP, STG_LAAD_PRESCRIBER.PRESCRIBER_ID, STG_LAAD_PRESCRIBER.SPECIALTY_CODE, STG_LAAD_PRESCRIBER.ME_NUM, STG_LAAD_PRESCRIBER.NPI, STG_LAAD_PRESCRIBER.FIRST_NAME, STG_LAAD_PRESCRIBER.LAST_NAME, STG_LAAD_PRESCRIBER.ADDRESS, STG_LAAD_PRESCRIBER.CITY, STG_LAAD_PRESCRIBER.SPECIALTY_DESC) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PROCEDURE_b0 /*+basename(STG_LAAD_PROCEDURE),createtype(L)*/ 
(
 CLAIM_ID,
 CLAIM_SERVICE_NUMBER,
 PATIENT_ID,
 SERVICE_DATE,
 PROCEDURE_CODE,
 RENDERING_PRESCRIBER_ID,
 REFERRING_PRESCRIBER_ID
)
AS
 SELECT STG_LAAD_PROCEDURE.CLAIM_ID,
        STG_LAAD_PROCEDURE.CLAIM_SERVICE_NUMBER,
        STG_LAAD_PROCEDURE.PATIENT_ID,
        STG_LAAD_PROCEDURE.SERVICE_DATE,
        STG_LAAD_PROCEDURE.PROCEDURE_CODE,
        STG_LAAD_PROCEDURE.RENDERING_PRESCRIBER_ID,
        STG_LAAD_PROCEDURE.REFERRING_PRESCRIBER_ID
 FROM sandbox.STG_LAAD_PROCEDURE
 ORDER BY STG_LAAD_PROCEDURE.CLAIM_ID,
          STG_LAAD_PROCEDURE.CLAIM_SERVICE_NUMBER,
          STG_LAAD_PROCEDURE.PATIENT_ID,
          STG_LAAD_PROCEDURE.SERVICE_DATE,
          STG_LAAD_PROCEDURE.PROCEDURE_CODE,
          STG_LAAD_PROCEDURE.RENDERING_PRESCRIBER_ID,
          STG_LAAD_PROCEDURE.REFERRING_PRESCRIBER_ID
SEGMENTED BY hash(STG_LAAD_PROCEDURE.SERVICE_DATE, STG_LAAD_PROCEDURE.CLAIM_ID, STG_LAAD_PROCEDURE.CLAIM_SERVICE_NUMBER, STG_LAAD_PROCEDURE.PATIENT_ID, STG_LAAD_PROCEDURE.RENDERING_PRESCRIBER_ID, STG_LAAD_PROCEDURE.REFERRING_PRESCRIBER_ID, STG_LAAD_PROCEDURE.PROCEDURE_CODE) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PROCEDURE_CODE_b0 /*+basename(STG_LAAD_PROCEDURE_CODE),createtype(L)*/ 
(
 PROCEDURE_CODE,
 PROCEDURE_DESCRIPTION
)
AS
 SELECT STG_LAAD_PROCEDURE_CODE.PROCEDURE_CODE,
        STG_LAAD_PROCEDURE_CODE.PROCEDURE_DESCRIPTION
 FROM sandbox.STG_LAAD_PROCEDURE_CODE
 ORDER BY STG_LAAD_PROCEDURE_CODE.PROCEDURE_CODE,
          STG_LAAD_PROCEDURE_CODE.PROCEDURE_DESCRIPTION
SEGMENTED BY hash(STG_LAAD_PROCEDURE_CODE.PROCEDURE_CODE, STG_LAAD_PROCEDURE_CODE.PROCEDURE_DESCRIPTION) ALL NODES;

CREATE PROJECTION sandbox.STG_LAAD_PRODUCT_b0 /*+basename(STG_LAAD_PRODUCT),createtype(L)*/ 
(
 NATL_DRUG_CODE,
 BRAND_NAME,
 GENERIC_NAME,
 BRAND_GENERIC_FLAG,
 DRUG_FORM,
 DRUG_STRENGTH,
 PACKAGE_SIZE,
 MANUFACTURER,
 USC_CODE,
 USC_DESCRIPTION
)
AS
 SELECT STG_LAAD_PRODUCT.NATL_DRUG_CODE,
        STG_LAAD_PRODUCT.BRAND_NAME,
        STG_LAAD_PRODUCT.GENERIC_NAME,
        STG_LAAD_PRODUCT.BRAND_GENERIC_FLAG,
        STG_LAAD_PRODUCT.DRUG_FORM,
        STG_LAAD_PRODUCT.DRUG_STRENGTH,
        STG_LAAD_PRODUCT.PACKAGE_SIZE,
        STG_LAAD_PRODUCT.MANUFACTURER,
        STG_LAAD_PRODUCT.USC_CODE,
        STG_LAAD_PRODUCT.USC_DESCRIPTION
 FROM sandbox.STG_LAAD_PRODUCT
 ORDER BY STG_LAAD_PRODUCT.NATL_DRUG_CODE,
          STG_LAAD_PRODUCT.BRAND_NAME,
          STG_LAAD_PRODUCT.GENERIC_NAME,
          STG_LAAD_PRODUCT.BRAND_GENERIC_FLAG,
          STG_LAAD_PRODUCT.DRUG_FORM,
          STG_LAAD_PRODUCT.DRUG_STRENGTH,
          STG_LAAD_PRODUCT.PACKAGE_SIZE,
          STG_LAAD_PRODUCT.MANUFACTURER,
          STG_LAAD_PRODUCT.USC_CODE,
          STG_LAAD_PRODUCT.USC_DESCRIPTION
SEGMENTED BY hash(STG_LAAD_PRODUCT.BRAND_GENERIC_FLAG, STG_LAAD_PRODUCT.PACKAGE_SIZE, STG_LAAD_PRODUCT.USC_CODE, STG_LAAD_PRODUCT.NATL_DRUG_CODE, STG_LAAD_PRODUCT.USC_DESCRIPTION, STG_LAAD_PRODUCT.BRAND_NAME, STG_LAAD_PRODUCT.GENERIC_NAME, STG_LAAD_PRODUCT.DRUG_FORM, STG_LAAD_PRODUCT.DRUG_STRENGTH, STG_LAAD_PRODUCT.MANUFACTURER) ALL NODES;

CREATE PROJECTION sandbox.create_paragard_specialty_rx1_b0 /*+basename(create_paragard_specialty_rx1),createtype(A)*/ 
(
 "BP #",
 "Ortho E",
 "BP Name",
 "Ship-to Street",
 "Ship-to City",
 "Ship-to State",
 "Ship-to ZipCd",
 "Ship-to Ctry",
 "Ship-to Phone",
 "Ship-to Fax",
 "Ship-to Email",
 "Bill-to Street",
 "Bill-to City",
 "Bill-to State",
 "Bill-to ZipCd",
 "Bill-to Ctry",
 "Bill-to Phone",
 "Bill-to Fax",
 "Bill-to Email",
 "Class of Trade",
 "Invoice #",
 "Del Amt",
 "Inv Date",
 "24237",
 "24238",
 "24800",
 "33223",
 Packs,
 UnitPrice,
 Territory,
 "Order Type Cd",
 "Order Type Desc",
 LOBCdDesc,
 PriceMatrixDef,
 ParentBPCd,
 ParentBPCdDesc,
 GrandParentBPCdDesc,
 "PO#",
 "UPS#",
 OrdNbr,
 OrdLnNbr,
 DiscAmt,
 WhseCd,
 Data_Source,
 NDC11_CODE
)
AS
 SELECT create_paragard_specialty_rx1."BP #",
        create_paragard_specialty_rx1."Ortho E",
        create_paragard_specialty_rx1."BP Name",
        create_paragard_specialty_rx1."Ship-to Street",
        create_paragard_specialty_rx1."Ship-to City",
        create_paragard_specialty_rx1."Ship-to State",
        create_paragard_specialty_rx1."Ship-to ZipCd",
        create_paragard_specialty_rx1."Ship-to Ctry",
        create_paragard_specialty_rx1."Ship-to Phone",
        create_paragard_specialty_rx1."Ship-to Fax",
        create_paragard_specialty_rx1."Ship-to Email",
        create_paragard_specialty_rx1."Bill-to Street",
        create_paragard_specialty_rx1."Bill-to City",
        create_paragard_specialty_rx1."Bill-to State",
        create_paragard_specialty_rx1."Bill-to ZipCd",
        create_paragard_specialty_rx1."Bill-to Ctry",
        create_paragard_specialty_rx1."Bill-to Phone",
        create_paragard_specialty_rx1."Bill-to Fax",
        create_paragard_specialty_rx1."Bill-to Email",
        create_paragard_specialty_rx1."Class of Trade",
        create_paragard_specialty_rx1."Invoice #",
        create_paragard_specialty_rx1."Del Amt",
        create_paragard_specialty_rx1."Inv Date",
        create_paragard_specialty_rx1."24237",
        create_paragard_specialty_rx1."24238",
        create_paragard_specialty_rx1."24800",
        create_paragard_specialty_rx1."33223",
        create_paragard_specialty_rx1.Packs,
        create_paragard_specialty_rx1.UnitPrice,
        create_paragard_specialty_rx1.Territory,
        create_paragard_specialty_rx1."Order Type Cd",
        create_paragard_specialty_rx1."Order Type Desc",
        create_paragard_specialty_rx1.LOBCdDesc,
        create_paragard_specialty_rx1.PriceMatrixDef,
        create_paragard_specialty_rx1.ParentBPCd,
        create_paragard_specialty_rx1.ParentBPCdDesc,
        create_paragard_specialty_rx1.GrandParentBPCdDesc,
        create_paragard_specialty_rx1."PO#",
        create_paragard_specialty_rx1."UPS#",
        create_paragard_specialty_rx1.OrdNbr,
        create_paragard_specialty_rx1.OrdLnNbr,
        create_paragard_specialty_rx1.DiscAmt,
        create_paragard_specialty_rx1.WhseCd,
        create_paragard_specialty_rx1.Data_Source,
        create_paragard_specialty_rx1.NDC11_CODE
 FROM sandbox.create_paragard_specialty_rx1
 ORDER BY create_paragard_specialty_rx1."BP #",
          create_paragard_specialty_rx1."BP Name",
          create_paragard_specialty_rx1."Ship-to Street",
          create_paragard_specialty_rx1."Ship-to City",
          create_paragard_specialty_rx1."Ship-to State",
          create_paragard_specialty_rx1."Ship-to ZipCd",
          create_paragard_specialty_rx1."Bill-to Street",
          create_paragard_specialty_rx1."Bill-to City",
          create_paragard_specialty_rx1."Bill-to State",
          create_paragard_specialty_rx1."Bill-to ZipCd",
          create_paragard_specialty_rx1."Class of Trade",
          create_paragard_specialty_rx1."Invoice #",
          create_paragard_specialty_rx1."Del Amt",
          create_paragard_specialty_rx1."Inv Date",
          create_paragard_specialty_rx1."24237",
          create_paragard_specialty_rx1.Packs,
          create_paragard_specialty_rx1.ParentBPCd
SEGMENTED BY hash(create_paragard_specialty_rx1."BP #", create_paragard_specialty_rx1."BP Name", create_paragard_specialty_rx1."Ship-to Street", create_paragard_specialty_rx1."Ship-to City", create_paragard_specialty_rx1."Ship-to State", create_paragard_specialty_rx1."Ship-to ZipCd", create_paragard_specialty_rx1."Bill-to Street", create_paragard_specialty_rx1."Bill-to City", create_paragard_specialty_rx1."Bill-to State", create_paragard_specialty_rx1."Bill-to ZipCd", create_paragard_specialty_rx1."Class of Trade", create_paragard_specialty_rx1."Invoice #", create_paragard_specialty_rx1."Del Amt", create_paragard_specialty_rx1."Inv Date", create_paragard_specialty_rx1."24237", create_paragard_specialty_rx1.Packs, create_paragard_specialty_rx1.ParentBPCd) ALL NODES;

CREATE PROJECTION sandbox.tmp_file_id_test_b0 /*+basename(tmp_file_id_test),createtype(A)*/ 
(
 file_id
)
AS
 SELECT tmp_file_id_test.file_id
 FROM sandbox.tmp_file_id_test
 ORDER BY tmp_file_id_test.file_id
SEGMENTED BY hash(tmp_file_id_test.file_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_ims_data_w_test_b0 /*+basename(tmp_ims_data_w_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 me_num,
 specialty,
 specialty_source,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 data_date,
 row_num
)
AS
 SELECT tmp_ims_data_w_test.sales_force_id,
        tmp_ims_data_w_test.ims_id,
        tmp_ims_data_w_test.me_num,
        tmp_ims_data_w_test.specialty,
        tmp_ims_data_w_test.specialty_source,
        tmp_ims_data_w_test.last_name,
        tmp_ims_data_w_test.first_name,
        tmp_ims_data_w_test.middle_name,
        tmp_ims_data_w_test.address,
        tmp_ims_data_w_test.city,
        tmp_ims_data_w_test.state,
        tmp_ims_data_w_test.zip,
        tmp_ims_data_w_test.data_date,
        tmp_ims_data_w_test.row_num
 FROM sandbox.tmp_ims_data_w_test
 ORDER BY tmp_ims_data_w_test.sales_force_id,
          tmp_ims_data_w_test.ims_id
SEGMENTED BY hash(tmp_ims_data_w_test.sales_force_id, tmp_ims_data_w_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_ims_data_m_test_b0 /*+basename(tmp_ims_data_m_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 me_num,
 specialty,
 specialty_source,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 data_date,
 row_num
)
AS
 SELECT tmp_ims_data_m_test.sales_force_id,
        tmp_ims_data_m_test.ims_id,
        tmp_ims_data_m_test.me_num,
        tmp_ims_data_m_test.specialty,
        tmp_ims_data_m_test.specialty_source,
        tmp_ims_data_m_test.last_name,
        tmp_ims_data_m_test.first_name,
        tmp_ims_data_m_test.middle_name,
        tmp_ims_data_m_test.address,
        tmp_ims_data_m_test.city,
        tmp_ims_data_m_test.state,
        tmp_ims_data_m_test.zip,
        tmp_ims_data_m_test.data_date,
        tmp_ims_data_m_test.row_num
 FROM sandbox.tmp_ims_data_m_test
 ORDER BY tmp_ims_data_m_test.sales_force_id,
          tmp_ims_data_m_test.ims_id
SEGMENTED BY hash(tmp_ims_data_m_test.sales_force_id, tmp_ims_data_m_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_ims_data_final_test_b0 /*+basename(tmp_ims_data_final_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 me_num,
 specialty,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip
)
AS
 SELECT tmp_ims_data_final_test.sales_force_id,
        tmp_ims_data_final_test.ims_id,
        tmp_ims_data_final_test.me_num,
        tmp_ims_data_final_test.specialty,
        tmp_ims_data_final_test.last_name,
        tmp_ims_data_final_test.first_name,
        tmp_ims_data_final_test.middle_name,
        tmp_ims_data_final_test.address,
        tmp_ims_data_final_test.city,
        tmp_ims_data_final_test.state,
        tmp_ims_data_final_test.zip
 FROM sandbox.tmp_ims_data_final_test
 ORDER BY tmp_ims_data_final_test.sales_force_id,
          tmp_ims_data_final_test.ims_id,
          tmp_ims_data_final_test.me_num,
          tmp_ims_data_final_test.specialty,
          tmp_ims_data_final_test.last_name,
          tmp_ims_data_final_test.first_name,
          tmp_ims_data_final_test.middle_name,
          tmp_ims_data_final_test.address,
          tmp_ims_data_final_test.city,
          tmp_ims_data_final_test.state,
          tmp_ims_data_final_test.zip
SEGMENTED BY hash(tmp_ims_data_final_test.sales_force_id, tmp_ims_data_final_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tn_align_test_b0 /*+basename(tmp_tn_align_test),createtype(A)*/ 
(
 veeva_account_id,
 ims_id,
 veeva_address_id,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 phone,
 territory_number,
 territory_type,
 address_source,
 sfa_create_date,
 sfa_align_date,
 last_call_date,
 last_call_this_sales_force,
 rnk
)
AS
 SELECT tmp_tn_align_test.veeva_account_id,
        tmp_tn_align_test.ims_id,
        tmp_tn_align_test.veeva_address_id,
        tmp_tn_align_test.address_line1,
        tmp_tn_align_test.address_line2,
        tmp_tn_align_test.address_line3,
        tmp_tn_align_test.city,
        tmp_tn_align_test.state,
        tmp_tn_align_test.zip,
        tmp_tn_align_test.phone,
        tmp_tn_align_test.territory_number,
        tmp_tn_align_test.territory_type,
        tmp_tn_align_test.address_source,
        tmp_tn_align_test.sfa_create_date,
        tmp_tn_align_test.sfa_align_date,
        tmp_tn_align_test.last_call_date,
        tmp_tn_align_test.last_call_this_sales_force,
        tmp_tn_align_test.rnk
 FROM sandbox.tmp_tn_align_test
 ORDER BY tmp_tn_align_test.ims_id
SEGMENTED BY hash(tmp_tn_align_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tn_calls_test_b0 /*+basename(tmp_tn_calls_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 org,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 veeva_address_id,
 phone,
 territory_number,
 address_source,
 rnk
)
AS
 SELECT tmp_tn_calls_test.sales_force_id,
        tmp_tn_calls_test.ims_id,
        tmp_tn_calls_test.veeva_account_id,
        tmp_tn_calls_test.org,
        tmp_tn_calls_test.address_line1,
        tmp_tn_calls_test.address_line2,
        tmp_tn_calls_test.address_line3,
        tmp_tn_calls_test.city,
        tmp_tn_calls_test.state,
        tmp_tn_calls_test.zip,
        tmp_tn_calls_test.veeva_address_id,
        tmp_tn_calls_test.phone,
        tmp_tn_calls_test.territory_number,
        tmp_tn_calls_test.address_source,
        tmp_tn_calls_test.rnk
 FROM sandbox.tmp_tn_calls_test
 ORDER BY tmp_tn_calls_test.ims_id
SEGMENTED BY hash(tmp_tn_calls_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tp_align_test_b0 /*+basename(tmp_tp_align_test),createtype(A)*/ 
(
 veeva_account_id,
 ims_id,
 veeva_address_id,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 phone,
 territory_number,
 territory_type,
 address_source,
 sfa_create_date,
 sfa_align_date,
 last_call_date,
 last_call_this_sales_force,
 rnk
)
AS
 SELECT tmp_tp_align_test.veeva_account_id,
        tmp_tp_align_test.ims_id,
        tmp_tp_align_test.veeva_address_id,
        tmp_tp_align_test.address_line1,
        tmp_tp_align_test.address_line2,
        tmp_tp_align_test.address_line3,
        tmp_tp_align_test.city,
        tmp_tp_align_test.state,
        tmp_tp_align_test.zip,
        tmp_tp_align_test.phone,
        tmp_tp_align_test.territory_number,
        tmp_tp_align_test.territory_type,
        tmp_tp_align_test.address_source,
        tmp_tp_align_test.sfa_create_date,
        tmp_tp_align_test.sfa_align_date,
        tmp_tp_align_test.last_call_date,
        tmp_tp_align_test.last_call_this_sales_force,
        tmp_tp_align_test.rnk
 FROM sandbox.tmp_tp_align_test
 ORDER BY tmp_tp_align_test.ims_id
SEGMENTED BY hash(tmp_tp_align_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tp_calls_test_b0 /*+basename(tmp_tp_calls_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 org,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 veeva_address_id,
 phone,
 territory_number,
 address_source,
 rnk
)
AS
 SELECT tmp_tp_calls_test.sales_force_id,
        tmp_tp_calls_test.ims_id,
        tmp_tp_calls_test.veeva_account_id,
        tmp_tp_calls_test.org,
        tmp_tp_calls_test.address_line1,
        tmp_tp_calls_test.address_line2,
        tmp_tp_calls_test.address_line3,
        tmp_tp_calls_test.city,
        tmp_tp_calls_test.state,
        tmp_tp_calls_test.zip,
        tmp_tp_calls_test.veeva_address_id,
        tmp_tp_calls_test.phone,
        tmp_tp_calls_test.territory_number,
        tmp_tp_calls_test.address_source,
        tmp_tp_calls_test.rnk
 FROM sandbox.tmp_tp_calls_test
 ORDER BY tmp_tp_calls_test.ims_id
SEGMENTED BY hash(tmp_tp_calls_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tr_align_test_b0 /*+basename(tmp_tr_align_test),createtype(A)*/ 
(
 veeva_account_id,
 ims_id,
 veeva_address_id,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 phone,
 territory_number,
 territory_type,
 address_source,
 sfa_create_date,
 sfa_align_date,
 last_call_date,
 last_call_this_sales_force,
 rnk
)
AS
 SELECT tmp_tr_align_test.veeva_account_id,
        tmp_tr_align_test.ims_id,
        tmp_tr_align_test.veeva_address_id,
        tmp_tr_align_test.address_line1,
        tmp_tr_align_test.address_line2,
        tmp_tr_align_test.address_line3,
        tmp_tr_align_test.city,
        tmp_tr_align_test.state,
        tmp_tr_align_test.zip,
        tmp_tr_align_test.phone,
        tmp_tr_align_test.territory_number,
        tmp_tr_align_test.territory_type,
        tmp_tr_align_test.address_source,
        tmp_tr_align_test.sfa_create_date,
        tmp_tr_align_test.sfa_align_date,
        tmp_tr_align_test.last_call_date,
        tmp_tr_align_test.last_call_this_sales_force,
        tmp_tr_align_test.rnk
 FROM sandbox.tmp_tr_align_test
 ORDER BY tmp_tr_align_test.ims_id
SEGMENTED BY hash(tmp_tr_align_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tr_calls_test_b0 /*+basename(tmp_tr_calls_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 org,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 veeva_address_id,
 phone,
 territory_number,
 address_source,
 rnk
)
AS
 SELECT tmp_tr_calls_test.sales_force_id,
        tmp_tr_calls_test.ims_id,
        tmp_tr_calls_test.veeva_account_id,
        tmp_tr_calls_test.org,
        tmp_tr_calls_test.address_line1,
        tmp_tr_calls_test.address_line2,
        tmp_tr_calls_test.address_line3,
        tmp_tr_calls_test.city,
        tmp_tr_calls_test.state,
        tmp_tr_calls_test.zip,
        tmp_tr_calls_test.veeva_address_id,
        tmp_tr_calls_test.phone,
        tmp_tr_calls_test.territory_number,
        tmp_tr_calls_test.address_source,
        tmp_tr_calls_test.rnk
 FROM sandbox.tmp_tr_calls_test
 ORDER BY tmp_tr_calls_test.ims_id
SEGMENTED BY hash(tmp_tr_calls_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tw_calls_test_b0 /*+basename(tmp_tw_calls_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 org,
 address_line1,
 address_line2,
 address_line3,
 city,
 state,
 zip,
 veeva_address_id,
 phone,
 territory_number,
 address_source,
 rnk
)
AS
 SELECT tmp_tw_calls_test.sales_force_id,
        tmp_tw_calls_test.ims_id,
        tmp_tw_calls_test.veeva_account_id,
        tmp_tw_calls_test.org,
        tmp_tw_calls_test.address_line1,
        tmp_tw_calls_test.address_line2,
        tmp_tw_calls_test.address_line3,
        tmp_tw_calls_test.city,
        tmp_tw_calls_test.state,
        tmp_tw_calls_test.zip,
        tmp_tw_calls_test.veeva_address_id,
        tmp_tw_calls_test.phone,
        tmp_tw_calls_test.territory_number,
        tmp_tw_calls_test.address_source,
        tmp_tw_calls_test.rnk
 FROM sandbox.tmp_tw_calls_test
 ORDER BY tmp_tw_calls_test.ims_id
SEGMENTED BY hash(tmp_tw_calls_test.ims_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_territory_test_b0 /*+basename(tmp_territory_test),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 npi,
 tvcmid,
 ptr_address_2,
 ptr_address_3,
 territory_number,
 territory_type
)
AS
 SELECT tmp_territory_test.sales_force_id,
        tmp_territory_test.ims_id,
        tmp_territory_test.veeva_account_id,
        tmp_territory_test.specialty,
        tmp_territory_test.first_name,
        tmp_territory_test.middle_name,
        tmp_territory_test.last_name,
        tmp_territory_test.ptr_veeva_address_id,
        tmp_territory_test.ptr_address_1,
        tmp_territory_test.ptr_city,
        tmp_territory_test.ptr_state,
        tmp_territory_test.ptr_zip,
        tmp_territory_test.ptr_phone,
        tmp_territory_test.ptr_territory_num,
        tmp_territory_test.ptr_territory_type,
        tmp_territory_test.ptr_address_source,
        tmp_territory_test.ptr_mailable,
        tmp_territory_test.dea_num,
        tmp_territory_test.pdrp_flag,
        tmp_territory_test.pdrp_date,
        tmp_territory_test.np_pa_flag,
        tmp_territory_test.no_spend,
        tmp_territory_test.ama_no_contact_flag,
        tmp_territory_test.email,
        tmp_territory_test.degree,
        tmp_territory_test.npi,
        tmp_territory_test.tvcmid,
        tmp_territory_test.ptr_address_2,
        tmp_territory_test.ptr_address_3,
        tmp_territory_test.territory_number,
        tmp_territory_test.territory_type
 FROM sandbox.tmp_territory_test
 ORDER BY tmp_territory_test.sales_force_id,
          tmp_territory_test.ims_id,
          tmp_territory_test.veeva_account_id,
          tmp_territory_test.specialty,
          tmp_territory_test.first_name,
          tmp_territory_test.middle_name,
          tmp_territory_test.last_name,
          tmp_territory_test.ptr_veeva_address_id,
          tmp_territory_test.ptr_address_1,
          tmp_territory_test.ptr_city,
          tmp_territory_test.ptr_state,
          tmp_territory_test.ptr_zip,
          tmp_territory_test.ptr_phone,
          tmp_territory_test.ptr_territory_num,
          tmp_territory_test.ptr_territory_type,
          tmp_territory_test.ptr_address_source,
          tmp_territory_test.ptr_mailable,
          tmp_territory_test.dea_num,
          tmp_territory_test.pdrp_flag,
          tmp_territory_test.pdrp_date,
          tmp_territory_test.np_pa_flag,
          tmp_territory_test.no_spend,
          tmp_territory_test.ama_no_contact_flag,
          tmp_territory_test.email,
          tmp_territory_test.degree,
          tmp_territory_test.npi,
          tmp_territory_test.tvcmid,
          tmp_territory_test.ptr_address_2,
          tmp_territory_test.ptr_address_3,
          tmp_territory_test.territory_number,
          tmp_territory_test.territory_type
SEGMENTED BY hash(tmp_territory_test.ptr_state, tmp_territory_test.ptr_zip, tmp_territory_test.ptr_mailable, tmp_territory_test.pdrp_flag, tmp_territory_test.pdrp_date, tmp_territory_test.np_pa_flag, tmp_territory_test.no_spend, tmp_territory_test.ama_no_contact_flag, tmp_territory_test.tvcmid, tmp_territory_test.ims_id, tmp_territory_test.dea_num, tmp_territory_test.degree, tmp_territory_test.npi, tmp_territory_test.ptr_territory_num, tmp_territory_test.sales_force_id, tmp_territory_test.veeva_account_id, tmp_territory_test.ptr_veeva_address_id, tmp_territory_test.ptr_territory_type, tmp_territory_test.ptr_address_source, tmp_territory_test.ptr_phone, tmp_territory_test.first_name, tmp_territory_test.middle_name, tmp_territory_test.last_name, tmp_territory_test.ptr_city, tmp_territory_test.ptr_address_1, tmp_territory_test.email, tmp_territory_test.ptr_address_2, tmp_territory_test.ptr_address_3, tmp_territory_test.specialty) ALL NODES;

CREATE PROJECTION sandbox.tmp_veeva_id_test_b0 /*+basename(tmp_veeva_id_test),createtype(A)*/ 
(
 tvcmid,
 veeva_account_id
)
AS
 SELECT tmp_veeva_id_test.tvcmid,
        tmp_veeva_id_test.veeva_account_id
 FROM sandbox.tmp_veeva_id_test
 ORDER BY tmp_veeva_id_test.tvcmid
SEGMENTED BY hash(tmp_veeva_id_test.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.tmp_dup_tvcmid_b0 /*+basename(tmp_dup_tvcmid),createtype(A)*/ 
(
 tvcmid,
 sales_force_id,
 count
)
AS
 SELECT tmp_dup_tvcmid.tvcmid,
        tmp_dup_tvcmid.sales_force_id,
        tmp_dup_tvcmid.count
 FROM sandbox.tmp_dup_tvcmid
 ORDER BY tmp_dup_tvcmid.tvcmid,
          tmp_dup_tvcmid.sales_force_id
SEGMENTED BY hash(tmp_dup_tvcmid.tvcmid, tmp_dup_tvcmid.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_dup_outlet_b0 /*+basename(tmp_dup_outlet),createtype(A)*/ 
(
 tvcmid,
 outlet_code,
 ims_facility_number,
 ims_prescriber_number,
 sales_force_id
)
AS
 SELECT tmp_dup_outlet.tvcmid,
        tmp_dup_outlet.outlet_code,
        tmp_dup_outlet.ims_facility_number,
        tmp_dup_outlet.ims_prescriber_number,
        tmp_dup_outlet.sales_force_id
 FROM sandbox.tmp_dup_outlet
 ORDER BY tmp_dup_outlet.tvcmid,
          tmp_dup_outlet.outlet_code,
          tmp_dup_outlet.ims_facility_number,
          tmp_dup_outlet.ims_prescriber_number,
          tmp_dup_outlet.sales_force_id
SEGMENTED BY hash(tmp_dup_outlet.tvcmid, tmp_dup_outlet.ims_prescriber_number, tmp_dup_outlet.sales_force_id, tmp_dup_outlet.outlet_code, tmp_dup_outlet.ims_facility_number) ALL NODES;

CREATE PROJECTION sandbox.tmp_ddd_qty_b0 /*+basename(tmp_ddd_qty),createtype(A)*/ 
(
 tvcmid,
 outlet_code,
 ims_facility_number,
 ims_prescriber_number,
 sales_force_id,
 quantity
)
AS
 SELECT tmp_ddd_qty.tvcmid,
        tmp_ddd_qty.outlet_code,
        tmp_ddd_qty.ims_facility_number,
        tmp_ddd_qty.ims_prescriber_number,
        tmp_ddd_qty.sales_force_id,
        tmp_ddd_qty.quantity
 FROM sandbox.tmp_ddd_qty
 ORDER BY tmp_ddd_qty.tvcmid,
          tmp_ddd_qty.outlet_code,
          tmp_ddd_qty.ims_facility_number,
          tmp_ddd_qty.ims_prescriber_number,
          tmp_ddd_qty.sales_force_id
SEGMENTED BY hash(tmp_ddd_qty.tvcmid, tmp_ddd_qty.outlet_code, tmp_ddd_qty.ims_facility_number, tmp_ddd_qty.ims_prescriber_number, tmp_ddd_qty.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_ddd_md_qty_b0 /*+basename(tmp_ddd_md_qty),createtype(A)*/ 
(
 tvcmid,
 outlet_code,
 ims_prescriber_number,
 ims_facility_number,
 sales_force_id,
 quantity
)
AS
 SELECT tmp_ddd_md_qty.tvcmid,
        tmp_ddd_md_qty.outlet_code,
        tmp_ddd_md_qty.ims_prescriber_number,
        tmp_ddd_md_qty.ims_facility_number,
        tmp_ddd_md_qty.sales_force_id,
        tmp_ddd_md_qty.quantity
 FROM sandbox.tmp_ddd_md_qty
 ORDER BY tmp_ddd_md_qty.tvcmid,
          tmp_ddd_md_qty.outlet_code,
          tmp_ddd_md_qty.ims_facility_number,
          tmp_ddd_md_qty.ims_prescriber_number,
          tmp_ddd_md_qty.sales_force_id
SEGMENTED BY hash(tmp_ddd_md_qty.tvcmid, tmp_ddd_md_qty.outlet_code, tmp_ddd_md_qty.ims_facility_number, tmp_ddd_md_qty.ims_prescriber_number, tmp_ddd_md_qty.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tvcmid_combine_b0 /*+basename(tmp_tvcmid_combine),createtype(A)*/ 
(
 outlet_code,
 ims_prescriber_number,
 ims_facility_number,
 sales_force_id,
 tvcmid,
 quantity
)
AS
 SELECT tmp_tvcmid_combine.outlet_code,
        tmp_tvcmid_combine.ims_prescriber_number,
        tmp_tvcmid_combine.ims_facility_number,
        tmp_tvcmid_combine.sales_force_id,
        tmp_tvcmid_combine.tvcmid,
        tmp_tvcmid_combine.quantity
 FROM sandbox.tmp_tvcmid_combine
 ORDER BY tmp_tvcmid_combine.outlet_code,
          tmp_tvcmid_combine.tvcmid,
          tmp_tvcmid_combine.ims_prescriber_number,
          tmp_tvcmid_combine.ims_facility_number,
          tmp_tvcmid_combine.sales_force_id
SEGMENTED BY hash(tmp_tvcmid_combine.tvcmid, tmp_tvcmid_combine.outlet_code, tmp_tvcmid_combine.ims_facility_number, tmp_tvcmid_combine.ims_prescriber_number, tmp_tvcmid_combine.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_tvcmid_combine_final_b0 /*+basename(tmp_tvcmid_combine_final),createtype(A)*/ 
(
 outlet_code,
 ims_prescriber_number,
 ims_facility_number,
 sales_force_id,
 tvcmid
)
AS
 SELECT tmp_tvcmid_combine_final.outlet_code,
        tmp_tvcmid_combine_final.ims_prescriber_number,
        tmp_tvcmid_combine_final.ims_facility_number,
        tmp_tvcmid_combine_final.sales_force_id,
        tmp_tvcmid_combine_final.tvcmid
 FROM sandbox.tmp_tvcmid_combine_final
 ORDER BY tmp_tvcmid_combine_final.tvcmid
SEGMENTED BY hash(tmp_tvcmid_combine_final.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.tmp_remaining_dup_tvcmid_no_sales_b0 /*+basename(tmp_remaining_dup_tvcmid_no_sales),createtype(A)*/ 
(
 tvcmid,
 sales_force_id
)
AS
 SELECT tmp_remaining_dup_tvcmid_no_sales.tvcmid,
        tmp_remaining_dup_tvcmid_no_sales.sales_force_id
 FROM sandbox.tmp_remaining_dup_tvcmid_no_sales
 ORDER BY tmp_remaining_dup_tvcmid_no_sales.tvcmid,
          tmp_remaining_dup_tvcmid_no_sales.sales_force_id
SEGMENTED BY hash(tmp_remaining_dup_tvcmid_no_sales.tvcmid, tmp_remaining_dup_tvcmid_no_sales.sales_force_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_no_sales_data_b0 /*+basename(tmp_no_sales_data),createtype(A)*/ 
(
 account_demo_id,
 outlet_code,
 ims_facility_number,
 ims_prescriber_number,
 category_code,
 subcategory_code,
 alignment_zip,
 outlet_name,
 outlet_address,
 outlet_city,
 outlet_state,
 outlet_zip,
 facility_name,
 facility_address1,
 facility_address2,
 facility_address3,
 facility_address4,
 facility_city,
 facility_state,
 facility_zip,
 prescriber_name,
 prescriber_address1,
 prescriber_address2,
 prescriber_address3,
 prescriber_address4,
 prescriber_city,
 prescriber_state,
 prescriber_zip,
 account_status,
 tvcmid,
 sales_force_id,
 outlet_tvcmid,
 facility_tvcmid,
 prescriber_tvcmid,
 tvcmid_assignment_rule,
 row_num
)
AS
 SELECT tmp_no_sales_data.account_demo_id,
        tmp_no_sales_data.outlet_code,
        tmp_no_sales_data.ims_facility_number,
        tmp_no_sales_data.ims_prescriber_number,
        tmp_no_sales_data.category_code,
        tmp_no_sales_data.subcategory_code,
        tmp_no_sales_data.alignment_zip,
        tmp_no_sales_data.outlet_name,
        tmp_no_sales_data.outlet_address,
        tmp_no_sales_data.outlet_city,
        tmp_no_sales_data.outlet_state,
        tmp_no_sales_data.outlet_zip,
        tmp_no_sales_data.facility_name,
        tmp_no_sales_data.facility_address1,
        tmp_no_sales_data.facility_address2,
        tmp_no_sales_data.facility_address3,
        tmp_no_sales_data.facility_address4,
        tmp_no_sales_data.facility_city,
        tmp_no_sales_data.facility_state,
        tmp_no_sales_data.facility_zip,
        tmp_no_sales_data.prescriber_name,
        tmp_no_sales_data.prescriber_address1,
        tmp_no_sales_data.prescriber_address2,
        tmp_no_sales_data.prescriber_address3,
        tmp_no_sales_data.prescriber_address4,
        tmp_no_sales_data.prescriber_city,
        tmp_no_sales_data.prescriber_state,
        tmp_no_sales_data.prescriber_zip,
        tmp_no_sales_data.account_status,
        tmp_no_sales_data.tvcmid,
        tmp_no_sales_data.sales_force_id,
        tmp_no_sales_data.outlet_tvcmid,
        tmp_no_sales_data.facility_tvcmid,
        tmp_no_sales_data.prescriber_tvcmid,
        tmp_no_sales_data.tvcmid_assignment_rule,
        tmp_no_sales_data.row_num
 FROM sandbox.tmp_no_sales_data
 ORDER BY tmp_no_sales_data.tvcmid,
          tmp_no_sales_data.outlet_code,
          tmp_no_sales_data.row_num
SEGMENTED BY hash(tmp_no_sales_data.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.tmp_roster_b0 /*+basename(tmp_roster),createtype(A)*/ 
(
 employee_id,
 territory_num,
 territory_name,
 team,
 hire_dt_rnk,
 sales_force_id,
 full_name,
 last_name,
 first_name,
 middle_name,
 person_title,
 name_suffix,
 address_line1,
 address_line2,
 city,
 state,
 zip,
 bus_address_line1,
 bus_address_line2,
 bus_city,
 bus_state,
 bus_zip,
 ship_address_line1,
 ship_address_line2,
 ship_city,
 ship_state,
 ship_zip,
 business_phone,
 home_phone,
 cell_phone,
 fax,
 voice_mail_ext,
 email,
 hire_date,
 title,
 stat_code,
 payroll_cost_ctr,
 rep_type,
 area_trainer,
 username,
 out_of_territory,
 parent_territory_num
)
AS
 SELECT tmp_roster.employee_id,
        tmp_roster.territory_num,
        tmp_roster.territory_name,
        tmp_roster.team,
        tmp_roster.hire_dt_rnk,
        tmp_roster.sales_force_id,
        tmp_roster.full_name,
        tmp_roster.last_name,
        tmp_roster.first_name,
        tmp_roster.middle_name,
        tmp_roster.person_title,
        tmp_roster.name_suffix,
        tmp_roster.address_line1,
        tmp_roster.address_line2,
        tmp_roster.city,
        tmp_roster.state,
        tmp_roster.zip,
        tmp_roster.bus_address_line1,
        tmp_roster.bus_address_line2,
        tmp_roster.bus_city,
        tmp_roster.bus_state,
        tmp_roster.bus_zip,
        tmp_roster.ship_address_line1,
        tmp_roster.ship_address_line2,
        tmp_roster.ship_city,
        tmp_roster.ship_state,
        tmp_roster.ship_zip,
        tmp_roster.business_phone,
        tmp_roster.home_phone,
        tmp_roster.cell_phone,
        tmp_roster.fax,
        tmp_roster.voice_mail_ext,
        tmp_roster.email,
        tmp_roster.hire_date,
        tmp_roster.title,
        tmp_roster.stat_code,
        tmp_roster.payroll_cost_ctr,
        tmp_roster.rep_type,
        tmp_roster.area_trainer,
        tmp_roster.username,
        tmp_roster.out_of_territory,
        tmp_roster.parent_territory_num
 FROM sandbox.tmp_roster
 ORDER BY tmp_roster.territory_num,
          tmp_roster.hire_date,
          tmp_roster.hire_dt_rnk
SEGMENTED BY hash(tmp_roster.territory_num) ALL NODES;

CREATE PROJECTION sandbox.tmp_roster2_b0 /*+basename(tmp_roster2),createtype(A)*/ 
(
 employee_id,
 orig_hire_dt,
 rehire_dt
)
AS
 SELECT tmp_roster2.employee_id,
        tmp_roster2.orig_hire_dt,
        tmp_roster2.rehire_dt
 FROM sandbox.tmp_roster2
 ORDER BY tmp_roster2.employee_id,
          tmp_roster2.orig_hire_dt,
          tmp_roster2.rehire_dt
SEGMENTED BY hash(tmp_roster2.employee_id, tmp_roster2.orig_hire_dt, tmp_roster2.rehire_dt) ALL NODES;

CREATE PROJECTION sandbox.qc_table_stats_b0 /*+basename(qc_table_stats),createtype(L)*/ 
(
 log_date,
 table_schema,
 table_name,
 row_count,
 used_bytes,
 null_tvcmid_count,
 null_basket_id_count,
 unique_file_ids,
 max_file_id
)
AS
 SELECT qc_table_stats.log_date,
        qc_table_stats.table_schema,
        qc_table_stats.table_name,
        qc_table_stats.row_count,
        qc_table_stats.used_bytes,
        qc_table_stats.null_tvcmid_count,
        qc_table_stats.null_basket_id_count,
        qc_table_stats.unique_file_ids,
        qc_table_stats.max_file_id
 FROM sandbox.qc_table_stats
 ORDER BY qc_table_stats.table_schema,
          qc_table_stats.table_name
SEGMENTED BY hash(qc_table_stats.log_date, qc_table_stats.table_schema, qc_table_stats.table_name) ALL NODES;

CREATE PROJECTION sandbox.compliance_speaker_list_b0 /*+basename(compliance_speaker_list),createtype(L)*/ 
(
 tvcmid,
 npi,
 Last_Name,
 First_Name,
 Middle_Initial,
 Address,
 City,
 State,
 Zip,
 speaker_affiliation
)
AS
 SELECT compliance_speaker_list.tvcmid,
        compliance_speaker_list.npi,
        compliance_speaker_list.Last_Name,
        compliance_speaker_list.First_Name,
        compliance_speaker_list.Middle_Initial,
        compliance_speaker_list.Address,
        compliance_speaker_list.City,
        compliance_speaker_list.State,
        compliance_speaker_list.Zip,
        compliance_speaker_list.speaker_affiliation
 FROM sandbox.compliance_speaker_list
 ORDER BY compliance_speaker_list.tvcmid,
          compliance_speaker_list.npi,
          compliance_speaker_list.Last_Name,
          compliance_speaker_list.First_Name,
          compliance_speaker_list.Middle_Initial,
          compliance_speaker_list.Address,
          compliance_speaker_list.City,
          compliance_speaker_list.State,
          compliance_speaker_list.Zip,
          compliance_speaker_list.speaker_affiliation
SEGMENTED BY hash(compliance_speaker_list.tvcmid, compliance_speaker_list.Middle_Initial, compliance_speaker_list.Zip, compliance_speaker_list.npi, compliance_speaker_list.Last_Name, compliance_speaker_list.First_Name, compliance_speaker_list.City, compliance_speaker_list.State, compliance_speaker_list.Address, compliance_speaker_list.speaker_affiliation) ALL NODES;

CREATE PROJECTION sandbox.tmp_mil_roster_b0 /*+basename(tmp_mil_roster),createtype(A)*/ 
(
 SALES_FORCE_ID,
 REP_TYPE,
 TERRITORY_NUM,
 LAST_NAME,
 FIRST_NAME,
 SHIP_ADDRESS_LINE1,
 SHIP_ADDRESS_LINE2,
 SHIP_CITY,
 SHIP_STATE,
 SHIP_ZIP,
 PHONE,
 EMAIL,
 DISTRICT,
 REGION
)
AS
 SELECT tmp_mil_roster.SALES_FORCE_ID,
        tmp_mil_roster.REP_TYPE,
        tmp_mil_roster.TERRITORY_NUM,
        tmp_mil_roster.LAST_NAME,
        tmp_mil_roster.FIRST_NAME,
        tmp_mil_roster.SHIP_ADDRESS_LINE1,
        tmp_mil_roster.SHIP_ADDRESS_LINE2,
        tmp_mil_roster.SHIP_CITY,
        tmp_mil_roster.SHIP_STATE,
        tmp_mil_roster.SHIP_ZIP,
        tmp_mil_roster.PHONE,
        tmp_mil_roster.EMAIL,
        tmp_mil_roster.DISTRICT,
        tmp_mil_roster.REGION
 FROM sandbox.tmp_mil_roster
 ORDER BY tmp_mil_roster.LAST_NAME
SEGMENTED BY hash(tmp_mil_roster.SALES_FORCE_ID, tmp_mil_roster.REP_TYPE, tmp_mil_roster.TERRITORY_NUM, tmp_mil_roster.LAST_NAME, tmp_mil_roster.FIRST_NAME, tmp_mil_roster.SHIP_ADDRESS_LINE1, tmp_mil_roster.SHIP_ADDRESS_LINE2, tmp_mil_roster.SHIP_CITY, tmp_mil_roster.SHIP_STATE, tmp_mil_roster.SHIP_ZIP, tmp_mil_roster.PHONE, tmp_mil_roster.EMAIL, tmp_mil_roster.DISTRICT, tmp_mil_roster.REGION) ALL NODES;

CREATE PROJECTION sandbox.data_feed_metadata_bkp_b0 /*+basename(data_feed_metadata_bkp),createtype(A)*/ 
(
 feed_id,
 short_name,
 subject_area,
 source_name,
 description,
 frequency,
 incremental,
 process_cleanse,
 process_intg,
 source_id
)
AS
 SELECT data_feed_metadata_bkp.feed_id,
        data_feed_metadata_bkp.short_name,
        data_feed_metadata_bkp.subject_area,
        data_feed_metadata_bkp.source_name,
        data_feed_metadata_bkp.description,
        data_feed_metadata_bkp.frequency,
        data_feed_metadata_bkp.incremental,
        data_feed_metadata_bkp.process_cleanse,
        data_feed_metadata_bkp.process_intg,
        data_feed_metadata_bkp.source_id
 FROM sandbox.data_feed_metadata_bkp
 ORDER BY data_feed_metadata_bkp.feed_id,
          data_feed_metadata_bkp.short_name,
          data_feed_metadata_bkp.subject_area,
          data_feed_metadata_bkp.source_name,
          data_feed_metadata_bkp.description,
          data_feed_metadata_bkp.frequency,
          data_feed_metadata_bkp.incremental,
          data_feed_metadata_bkp.process_cleanse,
          data_feed_metadata_bkp.process_intg
SEGMENTED BY hash(data_feed_metadata_bkp.feed_id, data_feed_metadata_bkp.incremental, data_feed_metadata_bkp.process_cleanse, data_feed_metadata_bkp.process_intg, data_feed_metadata_bkp.short_name, data_feed_metadata_bkp.subject_area, data_feed_metadata_bkp.source_name, data_feed_metadata_bkp.description, data_feed_metadata_bkp.frequency) ALL NODES;

CREATE PROJECTION sandbox.scd_prescriber_combined_demographics_b0 /*+basename(scd_prescriber_combined_demographics),createtype(L)*/ 
(
 scd_status,
 scd_effective_date,
 scd_expiration_date,
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source
)
AS
 SELECT scd_prescriber_combined_demographics.scd_status,
        scd_prescriber_combined_demographics.scd_effective_date,
        scd_prescriber_combined_demographics.scd_expiration_date,
        scd_prescriber_combined_demographics.sales_force_id,
        scd_prescriber_combined_demographics.ims_id,
        scd_prescriber_combined_demographics.npi,
        scd_prescriber_combined_demographics.tvcmid,
        scd_prescriber_combined_demographics.veeva_account_id,
        scd_prescriber_combined_demographics.specialty,
        scd_prescriber_combined_demographics.first_name,
        scd_prescriber_combined_demographics.middle_name,
        scd_prescriber_combined_demographics.last_name,
        scd_prescriber_combined_demographics.ptr_veeva_address_id,
        scd_prescriber_combined_demographics.ptr_address_1,
        scd_prescriber_combined_demographics.ptr_address_2,
        scd_prescriber_combined_demographics.ptr_address_3,
        scd_prescriber_combined_demographics.ptr_city,
        scd_prescriber_combined_demographics.ptr_state,
        scd_prescriber_combined_demographics.ptr_zip,
        scd_prescriber_combined_demographics.ptr_phone,
        scd_prescriber_combined_demographics.ptr_territory_num,
        scd_prescriber_combined_demographics.ptr_territory_type,
        scd_prescriber_combined_demographics.ptr_address_source,
        scd_prescriber_combined_demographics.ptr_mailable,
        scd_prescriber_combined_demographics.dea_num,
        scd_prescriber_combined_demographics.pdrp_flag,
        scd_prescriber_combined_demographics.pdrp_date,
        scd_prescriber_combined_demographics.np_pa_flag,
        scd_prescriber_combined_demographics.no_spend,
        scd_prescriber_combined_demographics.ama_no_contact_flag,
        scd_prescriber_combined_demographics.email,
        scd_prescriber_combined_demographics.degree,
        scd_prescriber_combined_demographics.address_id,
        scd_prescriber_combined_demographics.address_latitude,
        scd_prescriber_combined_demographics.address_longitude,
        scd_prescriber_combined_demographics.row_source
 FROM sandbox.scd_prescriber_combined_demographics
 ORDER BY scd_prescriber_combined_demographics.sales_force_id,
          scd_prescriber_combined_demographics.ims_id,
          scd_prescriber_combined_demographics.npi,
          scd_prescriber_combined_demographics.tvcmid,
          scd_prescriber_combined_demographics.veeva_account_id,
          scd_prescriber_combined_demographics.specialty,
          scd_prescriber_combined_demographics.first_name,
          scd_prescriber_combined_demographics.middle_name,
          scd_prescriber_combined_demographics.last_name,
          scd_prescriber_combined_demographics.ptr_veeva_address_id,
          scd_prescriber_combined_demographics.ptr_address_1,
          scd_prescriber_combined_demographics.ptr_address_2,
          scd_prescriber_combined_demographics.ptr_address_3,
          scd_prescriber_combined_demographics.ptr_city,
          scd_prescriber_combined_demographics.ptr_state,
          scd_prescriber_combined_demographics.ptr_zip,
          scd_prescriber_combined_demographics.ptr_phone,
          scd_prescriber_combined_demographics.ptr_territory_num,
          scd_prescriber_combined_demographics.ptr_territory_type,
          scd_prescriber_combined_demographics.ptr_address_source,
          scd_prescriber_combined_demographics.ptr_mailable,
          scd_prescriber_combined_demographics.dea_num,
          scd_prescriber_combined_demographics.pdrp_flag,
          scd_prescriber_combined_demographics.pdrp_date,
          scd_prescriber_combined_demographics.np_pa_flag,
          scd_prescriber_combined_demographics.no_spend,
          scd_prescriber_combined_demographics.ama_no_contact_flag,
          scd_prescriber_combined_demographics.email,
          scd_prescriber_combined_demographics.degree,
          scd_prescriber_combined_demographics.address_id,
          scd_prescriber_combined_demographics.address_latitude,
          scd_prescriber_combined_demographics.address_longitude,
          scd_prescriber_combined_demographics.row_source
SEGMENTED BY hash(scd_prescriber_combined_demographics.tvcmid, scd_prescriber_combined_demographics.ptr_state, scd_prescriber_combined_demographics.ptr_zip, scd_prescriber_combined_demographics.ptr_mailable, scd_prescriber_combined_demographics.pdrp_flag, scd_prescriber_combined_demographics.pdrp_date, scd_prescriber_combined_demographics.np_pa_flag, scd_prescriber_combined_demographics.no_spend, scd_prescriber_combined_demographics.ama_no_contact_flag, scd_prescriber_combined_demographics.address_id, scd_prescriber_combined_demographics.ims_id, scd_prescriber_combined_demographics.npi, scd_prescriber_combined_demographics.dea_num, scd_prescriber_combined_demographics.ptr_territory_num, scd_prescriber_combined_demographics.sales_force_id, scd_prescriber_combined_demographics.veeva_account_id, scd_prescriber_combined_demographics.ptr_veeva_address_id, scd_prescriber_combined_demographics.address_latitude, scd_prescriber_combined_demographics.address_longitude, scd_prescriber_combined_demographics.ptr_territory_type, scd_prescriber_combined_demographics.ptr_phone, scd_prescriber_combined_demographics.first_name, scd_prescriber_combined_demographics.middle_name, scd_prescriber_combined_demographics.last_name, scd_prescriber_combined_demographics.ptr_city, scd_prescriber_combined_demographics.ptr_address_source, scd_prescriber_combined_demographics.ptr_address_1, scd_prescriber_combined_demographics.ptr_address_2, scd_prescriber_combined_demographics.ptr_address_3, scd_prescriber_combined_demographics.email, scd_prescriber_combined_demographics.degree, scd_prescriber_combined_demographics.row_source) ALL NODES;

CREATE PROJECTION sandbox.QVAR_IDs_From_Knipper_b0 /*+basename(QVAR_IDs_From_Knipper),createtype(L)*/ 
(
 "Client ID",
 "IMS ID"
)
AS
 SELECT QVAR_IDs_From_Knipper."Client ID",
        QVAR_IDs_From_Knipper."IMS ID"
 FROM sandbox.QVAR_IDs_From_Knipper
 ORDER BY QVAR_IDs_From_Knipper."Client ID",
          QVAR_IDs_From_Knipper."IMS ID"
SEGMENTED BY hash(QVAR_IDs_From_Knipper."Client ID", QVAR_IDs_From_Knipper."IMS ID") ALL NODES;

CREATE PROJECTION sandbox.compliance_speaker_list_adhoc_b0 /*+basename(compliance_speaker_list_adhoc),createtype(L)*/ 
(
 tvcmid,
 npi,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 speaker_affiliation
)
AS
 SELECT compliance_speaker_list_adhoc.tvcmid,
        compliance_speaker_list_adhoc.npi,
        compliance_speaker_list_adhoc.last_name,
        compliance_speaker_list_adhoc.first_name,
        compliance_speaker_list_adhoc.middle_name,
        compliance_speaker_list_adhoc.address,
        compliance_speaker_list_adhoc.city,
        compliance_speaker_list_adhoc.state,
        compliance_speaker_list_adhoc.zip,
        compliance_speaker_list_adhoc.speaker_affiliation
 FROM sandbox.compliance_speaker_list_adhoc
 ORDER BY compliance_speaker_list_adhoc.tvcmid,
          compliance_speaker_list_adhoc.npi,
          compliance_speaker_list_adhoc.last_name,
          compliance_speaker_list_adhoc.first_name,
          compliance_speaker_list_adhoc.middle_name,
          compliance_speaker_list_adhoc.address,
          compliance_speaker_list_adhoc.city,
          compliance_speaker_list_adhoc.state,
          compliance_speaker_list_adhoc.zip,
          compliance_speaker_list_adhoc.speaker_affiliation
SEGMENTED BY hash(compliance_speaker_list_adhoc.tvcmid, compliance_speaker_list_adhoc.npi, compliance_speaker_list_adhoc.zip, compliance_speaker_list_adhoc.middle_name, compliance_speaker_list_adhoc.last_name, compliance_speaker_list_adhoc.first_name, compliance_speaker_list_adhoc.city, compliance_speaker_list_adhoc.state, compliance_speaker_list_adhoc.speaker_affiliation, compliance_speaker_list_adhoc.address) ALL NODES;

CREATE PROJECTION sandbox.compliance_speaker_list_adhoc_2_b0 /*+basename(compliance_speaker_list_adhoc_2),createtype(L)*/ 
(
 "Teva CMID",
 NPI,
 LastName,
 FirstName,
 MiddleIntial,
 Address,
 City,
 State,
 Zip,
 "Speaker Affiliation"
)
AS
 SELECT compliance_speaker_list_adhoc_2."Teva CMID",
        compliance_speaker_list_adhoc_2.NPI,
        compliance_speaker_list_adhoc_2.LastName,
        compliance_speaker_list_adhoc_2.FirstName,
        compliance_speaker_list_adhoc_2.MiddleIntial,
        compliance_speaker_list_adhoc_2.Address,
        compliance_speaker_list_adhoc_2.City,
        compliance_speaker_list_adhoc_2.State,
        compliance_speaker_list_adhoc_2.Zip,
        compliance_speaker_list_adhoc_2."Speaker Affiliation"
 FROM sandbox.compliance_speaker_list_adhoc_2
 ORDER BY compliance_speaker_list_adhoc_2."Teva CMID",
          compliance_speaker_list_adhoc_2.NPI,
          compliance_speaker_list_adhoc_2.LastName,
          compliance_speaker_list_adhoc_2.FirstName,
          compliance_speaker_list_adhoc_2.MiddleIntial,
          compliance_speaker_list_adhoc_2.Address,
          compliance_speaker_list_adhoc_2.City,
          compliance_speaker_list_adhoc_2.State,
          compliance_speaker_list_adhoc_2.Zip,
          compliance_speaker_list_adhoc_2."Speaker Affiliation"
SEGMENTED BY hash(compliance_speaker_list_adhoc_2."Teva CMID", compliance_speaker_list_adhoc_2.NPI, compliance_speaker_list_adhoc_2.Zip, compliance_speaker_list_adhoc_2.LastName, compliance_speaker_list_adhoc_2.FirstName, compliance_speaker_list_adhoc_2.MiddleIntial, compliance_speaker_list_adhoc_2.City, compliance_speaker_list_adhoc_2.State, compliance_speaker_list_adhoc_2."Speaker Affiliation", compliance_speaker_list_adhoc_2.Address) ALL NODES;

CREATE PROJECTION sandbox.ic_copay_b0 /*+basename(ic_copay),createtype(L)*/ 
(
 ic_data_month,
 basket_name,
 ims_id,
 tvcmid,
 fill_date,
 txn_id,
 rollup_month,
 month_bucket,
 days_supply,
 quantity,
 join_key,
 row_source,
 benefit_amount
)
AS
 SELECT ic_copay.ic_data_month,
        ic_copay.basket_name,
        ic_copay.ims_id,
        ic_copay.tvcmid,
        ic_copay.fill_date,
        ic_copay.txn_id,
        ic_copay.rollup_month,
        ic_copay.month_bucket,
        ic_copay.days_supply,
        ic_copay.quantity,
        ic_copay.join_key,
        ic_copay.row_source,
        ic_copay.benefit_amount
 FROM sandbox.ic_copay
 ORDER BY ic_copay.ims_id,
          ic_copay.tvcmid,
          ic_copay.txn_id
SEGMENTED BY hash(ic_copay.ic_data_month, ic_copay.tvcmid, ic_copay.fill_date, ic_copay.rollup_month, ic_copay.month_bucket, ic_copay.days_supply, ic_copay.quantity, ic_copay.ims_id, ic_copay.join_key, ic_copay.txn_id, ic_copay.row_source, ic_copay.basket_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_ims_monthly_market_obm_b0 /*+basename(ftf_ims_monthly_market_obm),createtype(A)*/ 
(
 "PLAN ID",
 "PLAN NAME",
 "PAYER ID",
 "PAYER NAME",
 "MARKET NAME",
 "PRODUCT NAME",
 zip,
 DATE,
 TRX,
 NRX
)
AS
 SELECT ftf_ims_monthly_market_obm."PLAN ID",
        ftf_ims_monthly_market_obm."PLAN NAME",
        ftf_ims_monthly_market_obm."PAYER ID",
        ftf_ims_monthly_market_obm."PAYER NAME",
        ftf_ims_monthly_market_obm."MARKET NAME",
        ftf_ims_monthly_market_obm."PRODUCT NAME",
        ftf_ims_monthly_market_obm.zip,
        ftf_ims_monthly_market_obm.DATE,
        ftf_ims_monthly_market_obm.TRX,
        ftf_ims_monthly_market_obm.NRX
 FROM sandbox.ftf_ims_monthly_market_obm
 ORDER BY ftf_ims_monthly_market_obm."PLAN ID",
          ftf_ims_monthly_market_obm."PLAN NAME",
          ftf_ims_monthly_market_obm."PAYER ID",
          ftf_ims_monthly_market_obm."PAYER NAME",
          ftf_ims_monthly_market_obm."MARKET NAME",
          ftf_ims_monthly_market_obm."PRODUCT NAME",
          ftf_ims_monthly_market_obm.zip,
          ftf_ims_monthly_market_obm.DATE,
          ftf_ims_monthly_market_obm.TRX,
          ftf_ims_monthly_market_obm.NRX
SEGMENTED BY hash(ftf_ims_monthly_market_obm."PLAN ID", ftf_ims_monthly_market_obm."PLAN NAME", ftf_ims_monthly_market_obm."PAYER ID", ftf_ims_monthly_market_obm."PAYER NAME", ftf_ims_monthly_market_obm."MARKET NAME", ftf_ims_monthly_market_obm."PRODUCT NAME", ftf_ims_monthly_market_obm.zip, ftf_ims_monthly_market_obm.DATE, ftf_ims_monthly_market_obm.TRX, ftf_ims_monthly_market_obm.NRX) ALL NODES;

CREATE PROJECTION sandbox.QVAR_NPP_08302018_b0 /*+basename(QVAR_NPP_08302018),createtype(L)*/ 
(
 ims_id,
 ims_id1,
 tvcmid,
 npi,
 last_name,
 first_name,
 middle_name,
 medical_suffix,
 primary_specialty,
 address_line1,
 address_line2,
 city,
 state_code,
 zip,
 business_email,
 np_pa_flag,
 tvcmid1,
 sln,
 sln_expiration_date,
 sln_state,
 hce_status_desc,
 "ICS TRx MARKET DECILE (6 Months)",
 ims_id_1,
 Specialty,
 "QVAR TRx Oct 2015",
 Nov,
 Dec,
 "1/16/2017 12:00:00 AM",
 Feb,
 Mar,
 Apr,
 May,
 Jun,
 Jul,
 Aug,
 Sep,
 Oct,
 Nov_1,
 Dec_1,
 "1/17/2017 12:00:00 AM",
 Feb_1,
 Mar_1,
 Apr_1,
 May_1,
 Jun_1,
 Jul_1,
 Aug_1,
 Sep_1,
 "Year 1",
 "Year 2",
 "Difference Yr2-Yr1",
 TREND
)
AS
 SELECT QVAR_NPP_08302018.ims_id,
        QVAR_NPP_08302018.ims_id1,
        QVAR_NPP_08302018.tvcmid,
        QVAR_NPP_08302018.npi,
        QVAR_NPP_08302018.last_name,
        QVAR_NPP_08302018.first_name,
        QVAR_NPP_08302018.middle_name,
        QVAR_NPP_08302018.medical_suffix,
        QVAR_NPP_08302018.primary_specialty,
        QVAR_NPP_08302018.address_line1,
        QVAR_NPP_08302018.address_line2,
        QVAR_NPP_08302018.city,
        QVAR_NPP_08302018.state_code,
        QVAR_NPP_08302018.zip,
        QVAR_NPP_08302018.business_email,
        QVAR_NPP_08302018.np_pa_flag,
        QVAR_NPP_08302018.tvcmid1,
        QVAR_NPP_08302018.sln,
        QVAR_NPP_08302018.sln_expiration_date,
        QVAR_NPP_08302018.sln_state,
        QVAR_NPP_08302018.hce_status_desc,
        QVAR_NPP_08302018."ICS TRx MARKET DECILE (6 Months)",
        QVAR_NPP_08302018.ims_id_1,
        QVAR_NPP_08302018.Specialty,
        QVAR_NPP_08302018."QVAR TRx Oct 2015",
        QVAR_NPP_08302018.Nov,
        QVAR_NPP_08302018.Dec,
        QVAR_NPP_08302018."1/16/2017 12:00:00 AM",
        QVAR_NPP_08302018.Feb,
        QVAR_NPP_08302018.Mar,
        QVAR_NPP_08302018.Apr,
        QVAR_NPP_08302018.May,
        QVAR_NPP_08302018.Jun,
        QVAR_NPP_08302018.Jul,
        QVAR_NPP_08302018.Aug,
        QVAR_NPP_08302018.Sep,
        QVAR_NPP_08302018.Oct,
        QVAR_NPP_08302018.Nov_1,
        QVAR_NPP_08302018.Dec_1,
        QVAR_NPP_08302018."1/17/2017 12:00:00 AM",
        QVAR_NPP_08302018.Feb_1,
        QVAR_NPP_08302018.Mar_1,
        QVAR_NPP_08302018.Apr_1,
        QVAR_NPP_08302018.May_1,
        QVAR_NPP_08302018.Jun_1,
        QVAR_NPP_08302018.Jul_1,
        QVAR_NPP_08302018.Aug_1,
        QVAR_NPP_08302018.Sep_1,
        QVAR_NPP_08302018."Year 1",
        QVAR_NPP_08302018."Year 2",
        QVAR_NPP_08302018."Difference Yr2-Yr1",
        QVAR_NPP_08302018.TREND
 FROM sandbox.QVAR_NPP_08302018
 ORDER BY QVAR_NPP_08302018.ims_id,
          QVAR_NPP_08302018.ims_id1,
          QVAR_NPP_08302018.tvcmid,
          QVAR_NPP_08302018.npi,
          QVAR_NPP_08302018.last_name,
          QVAR_NPP_08302018.first_name,
          QVAR_NPP_08302018.middle_name,
          QVAR_NPP_08302018.medical_suffix,
          QVAR_NPP_08302018.primary_specialty,
          QVAR_NPP_08302018.address_line1,
          QVAR_NPP_08302018.address_line2,
          QVAR_NPP_08302018.city,
          QVAR_NPP_08302018.state_code,
          QVAR_NPP_08302018.zip,
          QVAR_NPP_08302018.business_email,
          QVAR_NPP_08302018.np_pa_flag,
          QVAR_NPP_08302018.tvcmid1,
          QVAR_NPP_08302018.sln,
          QVAR_NPP_08302018.sln_expiration_date,
          QVAR_NPP_08302018.sln_state,
          QVAR_NPP_08302018.hce_status_desc,
          QVAR_NPP_08302018."ICS TRx MARKET DECILE (6 Months)",
          QVAR_NPP_08302018.ims_id_1,
          QVAR_NPP_08302018.Specialty,
          QVAR_NPP_08302018."QVAR TRx Oct 2015",
          QVAR_NPP_08302018.Nov,
          QVAR_NPP_08302018.Dec,
          QVAR_NPP_08302018."1/16/2017 12:00:00 AM",
          QVAR_NPP_08302018.Feb,
          QVAR_NPP_08302018.Mar,
          QVAR_NPP_08302018.Apr,
          QVAR_NPP_08302018.May,
          QVAR_NPP_08302018.Jun,
          QVAR_NPP_08302018.Jul,
          QVAR_NPP_08302018.Aug,
          QVAR_NPP_08302018.Sep,
          QVAR_NPP_08302018.Oct,
          QVAR_NPP_08302018.Nov_1,
          QVAR_NPP_08302018.Dec_1,
          QVAR_NPP_08302018."1/17/2017 12:00:00 AM",
          QVAR_NPP_08302018.Feb_1,
          QVAR_NPP_08302018.Mar_1,
          QVAR_NPP_08302018.Apr_1,
          QVAR_NPP_08302018.May_1,
          QVAR_NPP_08302018.Jun_1,
          QVAR_NPP_08302018.Jul_1,
          QVAR_NPP_08302018.Aug_1,
          QVAR_NPP_08302018.Sep_1,
          QVAR_NPP_08302018."Year 1",
          QVAR_NPP_08302018."Year 2",
          QVAR_NPP_08302018."Difference Yr2-Yr1",
          QVAR_NPP_08302018.TREND
SEGMENTED BY hash(QVAR_NPP_08302018.ims_id, QVAR_NPP_08302018.ims_id1, QVAR_NPP_08302018.tvcmid, QVAR_NPP_08302018.npi, QVAR_NPP_08302018.zip, QVAR_NPP_08302018.tvcmid1, QVAR_NPP_08302018.sln_expiration_date, QVAR_NPP_08302018."ICS TRx MARKET DECILE (6 Months)", QVAR_NPP_08302018.ims_id_1, QVAR_NPP_08302018."QVAR TRx Oct 2015", QVAR_NPP_08302018.Nov, QVAR_NPP_08302018.Dec, QVAR_NPP_08302018."1/16/2017 12:00:00 AM", QVAR_NPP_08302018.Feb, QVAR_NPP_08302018.Mar, QVAR_NPP_08302018.Apr, QVAR_NPP_08302018.May, QVAR_NPP_08302018.Jun, QVAR_NPP_08302018.Jul, QVAR_NPP_08302018.Aug, QVAR_NPP_08302018.Sep, QVAR_NPP_08302018.Oct, QVAR_NPP_08302018.Nov_1, QVAR_NPP_08302018.Dec_1, QVAR_NPP_08302018."1/17/2017 12:00:00 AM", QVAR_NPP_08302018.Feb_1, QVAR_NPP_08302018.Mar_1, QVAR_NPP_08302018.Apr_1, QVAR_NPP_08302018.May_1, QVAR_NPP_08302018.Jun_1, QVAR_NPP_08302018.Jul_1, QVAR_NPP_08302018.Aug_1) ALL NODES;

CREATE PROJECTION sandbox.HeadacheCenter_b0 /*+basename(HeadacheCenter),createtype(L)*/ 
(
 IMS_ID,
 TVCMID,
 First_Name,
 Middle_Name,
 Last_Name,
 Cred,
 Location,
 Address_1,
 Address_2,
 City,
 State_Code,
 Zip_Code,
 Zip_Extension,
 Telephone,
 Alternative_Telephone
)
AS
 SELECT HeadacheCenter.IMS_ID,
        HeadacheCenter.TVCMID,
        HeadacheCenter.First_Name,
        HeadacheCenter.Middle_Name,
        HeadacheCenter.Last_Name,
        HeadacheCenter.Cred,
        HeadacheCenter.Location,
        HeadacheCenter.Address_1,
        HeadacheCenter.Address_2,
        HeadacheCenter.City,
        HeadacheCenter.State_Code,
        HeadacheCenter.Zip_Code,
        HeadacheCenter.Zip_Extension,
        HeadacheCenter.Telephone,
        HeadacheCenter.Alternative_Telephone
 FROM sandbox.HeadacheCenter
 ORDER BY HeadacheCenter.IMS_ID,
          HeadacheCenter.TVCMID,
          HeadacheCenter.First_Name,
          HeadacheCenter.Middle_Name,
          HeadacheCenter.Last_Name,
          HeadacheCenter.Cred,
          HeadacheCenter.Location,
          HeadacheCenter.Address_1
SEGMENTED BY hash(HeadacheCenter.TVCMID, HeadacheCenter.IMS_ID, HeadacheCenter.First_Name, HeadacheCenter.Middle_Name, HeadacheCenter.Last_Name, HeadacheCenter.City, HeadacheCenter.State_Code, HeadacheCenter.Zip_Code) ALL NODES;

CREATE PROJECTION sandbox."QNASL_MRKT IMSID_ALL_b0" /*+basename(QNASL_MRKT IMSID_ALL),createtype(L)*/ 
(
 ims_id
)
AS
 SELECT "QNASL_MRKT IMSID_ALL".ims_id
 FROM sandbox."QNASL_MRKT IMSID_ALL"
 ORDER BY "QNASL_MRKT IMSID_ALL".ims_id
SEGMENTED BY hash("QNASL_MRKT IMSID_ALL".ims_id) ALL NODES;

CREATE PROJECTION sandbox.TJR_DRM45_b0 /*+basename(TJR_DRM45),createtype(L)*/ 
(
 AUDIT_CODE,
 CLIENT_GROUP_DESCRIPTION,
 CLIENT_NBR,
 FILE_CODE,
 PRODUCT_GROUP_NBR,
 PRODUCT_GROUP_NAME,
 PRODUCT_CODE,
 PACK_CODE,
 PROD_DESC,
 WHOLESALE_PRICE,
 MFR_DESC,
 MFR_CODE,
 SPEC_REPACK_IND,
 USC_CODE
)
AS
 SELECT TJR_DRM45.AUDIT_CODE,
        TJR_DRM45.CLIENT_GROUP_DESCRIPTION,
        TJR_DRM45.CLIENT_NBR,
        TJR_DRM45.FILE_CODE,
        TJR_DRM45.PRODUCT_GROUP_NBR,
        TJR_DRM45.PRODUCT_GROUP_NAME,
        TJR_DRM45.PRODUCT_CODE,
        TJR_DRM45.PACK_CODE,
        TJR_DRM45.PROD_DESC,
        TJR_DRM45.WHOLESALE_PRICE,
        TJR_DRM45.MFR_DESC,
        TJR_DRM45.MFR_CODE,
        TJR_DRM45.SPEC_REPACK_IND,
        TJR_DRM45.USC_CODE
 FROM sandbox.TJR_DRM45
 ORDER BY TJR_DRM45.AUDIT_CODE,
          TJR_DRM45.CLIENT_GROUP_DESCRIPTION,
          TJR_DRM45.CLIENT_NBR,
          TJR_DRM45.FILE_CODE,
          TJR_DRM45.PRODUCT_GROUP_NBR,
          TJR_DRM45.PRODUCT_GROUP_NAME,
          TJR_DRM45.PRODUCT_CODE,
          TJR_DRM45.PACK_CODE
SEGMENTED BY hash(TJR_DRM45.CLIENT_NBR, TJR_DRM45.FILE_CODE, TJR_DRM45.PRODUCT_GROUP_NBR, TJR_DRM45.PRODUCT_CODE, TJR_DRM45.PACK_CODE, TJR_DRM45.MFR_CODE, TJR_DRM45.SPEC_REPACK_IND, TJR_DRM45.AUDIT_CODE) ALL NODES;

CREATE PROJECTION sandbox.tjr_ftf_iqvia_plan_xref_b0 /*+basename(tjr_ftf_iqvia_plan_xref),createtype(L)*/ 
(
 health_plan_id,
 health_plan_name,
 ajovy_restrictions,
 aimovig_restrictions,
 emgality_restrictions,
 provider_id,
 provider_name,
 parent_name,
 payment_type,
 health_plan_type,
 masterbridge_key_payer,
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 masterbridge_payer_name,
 formulary_mgmt_pbm,
 claims_processing_pbm,
 pref_tier
)
AS
 SELECT tjr_ftf_iqvia_plan_xref.health_plan_id,
        tjr_ftf_iqvia_plan_xref.health_plan_name,
        tjr_ftf_iqvia_plan_xref.ajovy_restrictions,
        tjr_ftf_iqvia_plan_xref.aimovig_restrictions,
        tjr_ftf_iqvia_plan_xref.emgality_restrictions,
        tjr_ftf_iqvia_plan_xref.provider_id,
        tjr_ftf_iqvia_plan_xref.provider_name,
        tjr_ftf_iqvia_plan_xref.parent_name,
        tjr_ftf_iqvia_plan_xref.payment_type,
        tjr_ftf_iqvia_plan_xref.health_plan_type,
        tjr_ftf_iqvia_plan_xref.masterbridge_key_payer,
        tjr_ftf_iqvia_plan_xref.iqvia_plan_code,
        tjr_ftf_iqvia_plan_xref.iqvia_plan_name,
        tjr_ftf_iqvia_plan_xref.iqvia_payer_name,
        tjr_ftf_iqvia_plan_xref.masterbridge_payer_name,
        tjr_ftf_iqvia_plan_xref.formulary_mgmt_pbm,
        tjr_ftf_iqvia_plan_xref.claims_processing_pbm,
        tjr_ftf_iqvia_plan_xref.pref_tier
 FROM sandbox.tjr_ftf_iqvia_plan_xref
 ORDER BY tjr_ftf_iqvia_plan_xref.health_plan_id,
          tjr_ftf_iqvia_plan_xref.health_plan_name,
          tjr_ftf_iqvia_plan_xref.ajovy_restrictions,
          tjr_ftf_iqvia_plan_xref.aimovig_restrictions,
          tjr_ftf_iqvia_plan_xref.emgality_restrictions,
          tjr_ftf_iqvia_plan_xref.provider_id,
          tjr_ftf_iqvia_plan_xref.provider_name,
          tjr_ftf_iqvia_plan_xref.parent_name
SEGMENTED BY hash(tjr_ftf_iqvia_plan_xref.health_plan_id, tjr_ftf_iqvia_plan_xref.provider_id, tjr_ftf_iqvia_plan_xref.pref_tier, tjr_ftf_iqvia_plan_xref.iqvia_plan_code, tjr_ftf_iqvia_plan_xref.health_plan_name, tjr_ftf_iqvia_plan_xref.iqvia_plan_name, tjr_ftf_iqvia_plan_xref.iqvia_payer_name, tjr_ftf_iqvia_plan_xref.masterbridge_payer_name) ALL NODES;

CREATE PROJECTION sandbox."Returns_IQVIA _b0" /*+basename(Returns_IQVIA ),createtype(L)*/ 
(
 IMSID,
 NPI,
 tvcmid
)
AS
 SELECT "Returns_IQVIA ".IMSID,
        "Returns_IQVIA ".NPI,
        "Returns_IQVIA ".tvcmid
 FROM sandbox."Returns_IQVIA "
 ORDER BY "Returns_IQVIA ".IMSID,
          "Returns_IQVIA ".NPI,
          "Returns_IQVIA ".tvcmid
SEGMENTED BY hash("Returns_IQVIA ".IMSID, "Returns_IQVIA ".NPI, "Returns_IQVIA ".tvcmid) ALL NODES;

CREATE PROJECTION sandbox.QVAR_Address_Update__b0 /*+basename(QVAR_Address_Update_),createtype(L)*/ 
(
 IMSID,
 NPI,
 tvcmid
)
AS
 SELECT QVAR_Address_Update_.IMSID,
        QVAR_Address_Update_.NPI,
        QVAR_Address_Update_.tvcmid
 FROM sandbox.QVAR_Address_Update_
 ORDER BY QVAR_Address_Update_.IMSID,
          QVAR_Address_Update_.NPI,
          QVAR_Address_Update_.tvcmid
SEGMENTED BY hash(QVAR_Address_Update_.IMSID, QVAR_Address_Update_.NPI, QVAR_Address_Update_.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.test_concur_diff_b0 /*+basename(test_concur_diff),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_con_diff.cust_id,
        test_con_diff.organization_name,
        test_con_diff.contact_type,
        test_con_diff.first_name,
        test_con_diff.middle_name,
        test_con_diff.last_name,
        test_con_diff.suffix,
        test_con_diff.npi,
        test_con_diff.address_line_1,
        test_con_diff.address_line_2,
        test_con_diff.city,
        test_con_diff.state,
        test_con_diff.zipcode,
        test_con_diff.sln,
        test_con_diff.sln_state,
        test_con_diff.dea,
        test_con_diff.affiliation,
        test_con_diff.credential,
        test_con_diff.healthcare_professional_status_code
 FROM sandbox.test_con_diff
 ORDER BY test_con_diff.cust_id
SEGMENTED BY hash(test_con_diff.cust_id, test_con_diff.first_name, test_con_diff.middle_name, test_con_diff.last_name, test_con_diff.suffix, test_con_diff.npi, test_con_diff.address_line_1, test_con_diff.address_line_2, test_con_diff.city, test_con_diff.state, test_con_diff.zipcode, test_con_diff.sln, test_con_diff.sln_state, test_con_diff.dea, test_con_diff.credential, test_con_diff.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_rx_tp_b0 /*+basename(mb_ic_rx_tp),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT mb_ic_rx_tp.ic_data_month,
        mb_ic_rx_tp.basket_name,
        mb_ic_rx_tp.sales_force_id,
        mb_ic_rx_tp.area_number,
        mb_ic_rx_tp.region_number,
        mb_ic_rx_tp.territory_number,
        mb_ic_rx_tp.ims_id,
        mb_ic_rx_tp.tvcmid,
        mb_ic_rx_tp.outlet_code,
        mb_ic_rx_tp.va_station_number,
        mb_ic_rx_tp.dnc_flag,
        mb_ic_rx_tp.dnp_flag,
        mb_ic_rx_tp.rollup_month,
        mb_ic_rx_tp.month_bucket,
        mb_ic_rx_tp.nrx_count,
        mb_ic_rx_tp.trx_count,
        mb_ic_rx_tp.nrx_quantity,
        mb_ic_rx_tp.trx_quantity,
        mb_ic_rx_tp.include_in_nation_rollup,
        mb_ic_rx_tp.include_in_area_rollup,
        mb_ic_rx_tp.include_in_region_rollup,
        mb_ic_rx_tp.join_key,
        mb_ic_rx_tp.row_source,
        mb_ic_rx_tp.row_create_date,
        mb_ic_rx_tp.indication,
        mb_ic_rx_tp.outlet_dea,
        mb_ic_rx_tp.payer_plan_number,
        mb_ic_rx_tp.payment_method
 FROM sandbox.mb_ic_rx_tp
 ORDER BY mb_ic_rx_tp.area_number,
          mb_ic_rx_tp.region_number,
          mb_ic_rx_tp.territory_number,
          mb_ic_rx_tp.ims_id,
          mb_ic_rx_tp.tvcmid
SEGMENTED BY hash(mb_ic_rx_tp.ic_data_month, mb_ic_rx_tp.tvcmid, mb_ic_rx_tp.outlet_code, mb_ic_rx_tp.dnc_flag, mb_ic_rx_tp.dnp_flag, mb_ic_rx_tp.rollup_month, mb_ic_rx_tp.month_bucket, mb_ic_rx_tp.nrx_count, mb_ic_rx_tp.trx_count, mb_ic_rx_tp.nrx_quantity, mb_ic_rx_tp.trx_quantity, mb_ic_rx_tp.include_in_nation_rollup, mb_ic_rx_tp.include_in_area_rollup, mb_ic_rx_tp.include_in_region_rollup, mb_ic_rx_tp.row_create_date, mb_ic_rx_tp.ims_id, mb_ic_rx_tp.va_station_number, mb_ic_rx_tp.join_key, mb_ic_rx_tp.area_number, mb_ic_rx_tp.region_number, mb_ic_rx_tp.territory_number, mb_ic_rx_tp.sales_force_id, mb_ic_rx_tp.row_source, mb_ic_rx_tp.basket_name) ALL NODES;

CREATE PROJECTION sandbox."TN Mising HCPS for TN IC_b0" /*+basename(TN Mising HCPS for TN IC),createtype(L)*/ 
(
 "IMS ID",
 "NS Territory ID"
)
AS
 SELECT "TN Mising HCPS for TN IC"."IMS ID",
        "TN Mising HCPS for TN IC"."NS Territory ID"
 FROM sandbox."TN Mising HCPS for TN IC"
 ORDER BY "TN Mising HCPS for TN IC"."IMS ID",
          "TN Mising HCPS for TN IC"."NS Territory ID"
SEGMENTED BY hash("TN Mising HCPS for TN IC"."IMS ID", "TN Mising HCPS for TN IC"."NS Territory ID") ALL NODES;

CREATE PROJECTION sandbox.test_concur_prev_kg_b0 /*+basename(test_concur_prev_kg),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_concur_prev_kg.cust_id,
        test_concur_prev_kg.organization_name,
        test_concur_prev_kg.contact_type,
        test_concur_prev_kg.first_name,
        test_concur_prev_kg.middle_name,
        test_concur_prev_kg.last_name,
        test_concur_prev_kg.suffix,
        test_concur_prev_kg.npi,
        test_concur_prev_kg.address_line_1,
        test_concur_prev_kg.address_line_2,
        test_concur_prev_kg.city,
        test_concur_prev_kg.state,
        test_concur_prev_kg.zipcode,
        test_concur_prev_kg.sln,
        test_concur_prev_kg.sln_state,
        test_concur_prev_kg.dea,
        test_concur_prev_kg.affiliation,
        test_concur_prev_kg.credential,
        test_concur_prev_kg.healthcare_professional_status_code
 FROM sandbox.test_concur_prev_kg
 ORDER BY test_concur_prev_kg.cust_id,
          test_concur_prev_kg.first_name,
          test_concur_prev_kg.middle_name,
          test_concur_prev_kg.last_name,
          test_concur_prev_kg.suffix,
          test_concur_prev_kg.npi,
          test_concur_prev_kg.address_line_1,
          test_concur_prev_kg.address_line_2,
          test_concur_prev_kg.city,
          test_concur_prev_kg.state,
          test_concur_prev_kg.zipcode,
          test_concur_prev_kg.sln,
          test_concur_prev_kg.sln_state,
          test_concur_prev_kg.dea,
          test_concur_prev_kg.credential,
          test_concur_prev_kg.healthcare_professional_status_code
SEGMENTED BY hash(test_concur_prev_kg.cust_id, test_concur_prev_kg.first_name, test_concur_prev_kg.middle_name, test_concur_prev_kg.last_name, test_concur_prev_kg.suffix, test_concur_prev_kg.npi, test_concur_prev_kg.address_line_1, test_concur_prev_kg.address_line_2, test_concur_prev_kg.city, test_concur_prev_kg.state, test_concur_prev_kg.zipcode, test_concur_prev_kg.sln, test_concur_prev_kg.sln_state, test_concur_prev_kg.dea, test_concur_prev_kg.credential, test_concur_prev_kg.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.test_concur_diff_kg_b0 /*+basename(test_concur_diff_kg),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_concur_diff_kg.cust_id,
        test_concur_diff_kg.organization_name,
        test_concur_diff_kg.contact_type,
        test_concur_diff_kg.first_name,
        test_concur_diff_kg.middle_name,
        test_concur_diff_kg.last_name,
        test_concur_diff_kg.suffix,
        test_concur_diff_kg.npi,
        test_concur_diff_kg.address_line_1,
        test_concur_diff_kg.address_line_2,
        test_concur_diff_kg.city,
        test_concur_diff_kg.state,
        test_concur_diff_kg.zipcode,
        test_concur_diff_kg.sln,
        test_concur_diff_kg.sln_state,
        test_concur_diff_kg.dea,
        test_concur_diff_kg.affiliation,
        test_concur_diff_kg.credential,
        test_concur_diff_kg.healthcare_professional_status_code
 FROM sandbox.test_concur_diff_kg
 ORDER BY test_concur_diff_kg.cust_id
SEGMENTED BY hash(test_concur_diff_kg.cust_id, test_concur_diff_kg.first_name, test_concur_diff_kg.middle_name, test_concur_diff_kg.last_name, test_concur_diff_kg.suffix, test_concur_diff_kg.npi, test_concur_diff_kg.address_line_1, test_concur_diff_kg.address_line_2, test_concur_diff_kg.city, test_concur_diff_kg.state, test_concur_diff_kg.zipcode, test_concur_diff_kg.sln, test_concur_diff_kg.sln_state, test_concur_diff_kg.dea, test_concur_diff_kg.credential, test_concur_diff_kg.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox."MA Missing STATE_b0" /*+basename(MA Missing STATE),createtype(L)*/ 
(
 Zip,
 State,
 Territory_1_ID,
 Territory_Name,
 Area_Name,
 Region_Name,
 Mirror_Flag,
 Territory_2_ID
)
AS
 SELECT "MA Missing STATE".Zip,
        "MA Missing STATE".State,
        "MA Missing STATE".Territory_1_ID,
        "MA Missing STATE".Territory_Name,
        "MA Missing STATE".Area_Name,
        "MA Missing STATE".Region_Name,
        "MA Missing STATE".Mirror_Flag,
        "MA Missing STATE".Territory_2_ID
 FROM sandbox."MA Missing STATE"
 ORDER BY "MA Missing STATE".Zip,
          "MA Missing STATE".State,
          "MA Missing STATE".Territory_1_ID,
          "MA Missing STATE".Territory_Name,
          "MA Missing STATE".Area_Name,
          "MA Missing STATE".Region_Name,
          "MA Missing STATE".Mirror_Flag,
          "MA Missing STATE".Territory_2_ID
SEGMENTED BY hash("MA Missing STATE".Zip, "MA Missing STATE".State, "MA Missing STATE".Region_Name, "MA Missing STATE".Mirror_Flag, "MA Missing STATE".Territory_2_ID, "MA Missing STATE".Territory_1_ID, "MA Missing STATE".Area_Name, "MA Missing STATE".Territory_Name) ALL NODES;

CREATE PROJECTION sandbox.tmp_call_hist_c_b0 /*+basename(tmp_call_hist_c),createtype(A)*/ 
(
 id,
 isdeleted,
 parentid,
 createdbyid,
 createddate,
 field,
 oldvalue,
 newvalue,
 file_id,
 record_id,
 row_num
)
AS
 SELECT tmp_call_hist_c.id,
        tmp_call_hist_c.isdeleted,
        tmp_call_hist_c.parentid,
        tmp_call_hist_c.createdbyid,
        tmp_call_hist_c.createddate,
        tmp_call_hist_c.field,
        tmp_call_hist_c.oldvalue,
        tmp_call_hist_c.newvalue,
        tmp_call_hist_c.file_id,
        tmp_call_hist_c.record_id,
        tmp_call_hist_c.row_num
 FROM sandbox.tmp_call_hist_c
 ORDER BY tmp_call_hist_c.id
SEGMENTED BY hash(tmp_call_hist_c.id) ALL NODES;

CREATE PROJECTION sandbox.sfa_all_call_b0 /*+basename(sfa_all_call),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 veeva_account_id,
 ims_id,
 ims_outlet_id,
 tvcmid,
 customer_type,
 first_name,
 last_name,
 call_type,
 legacy_call_type,
 ceph_id,
 dea_num,
 rep_id,
 rep_first_name,
 rep_last_name,
 territory_number,
 zip_on_call,
 call_date,
 submit_date,
 attendees,
 attendee_type,
 call_recordtype,
 call_duration_tva__c,
 call_datetime,
 call_timezone,
 how_executed,
 call_status,
 remote_meeting_vod__c
)
AS
 SELECT sfa_all_call.sales_force_id,
        sfa_all_call.call_id,
        sfa_all_call.veeva_account_id,
        sfa_all_call.ims_id,
        sfa_all_call.ims_outlet_id,
        sfa_all_call.tvcmid,
        sfa_all_call.customer_type,
        sfa_all_call.first_name,
        sfa_all_call.last_name,
        sfa_all_call.call_type,
        sfa_all_call.legacy_call_type,
        sfa_all_call.ceph_id,
        sfa_all_call.dea_num,
        sfa_all_call.rep_id,
        sfa_all_call.rep_first_name,
        sfa_all_call.rep_last_name,
        sfa_all_call.territory_number,
        sfa_all_call.zip_on_call,
        sfa_all_call.call_date,
        sfa_all_call.submit_date,
        sfa_all_call.attendees,
        sfa_all_call.attendee_type,
        sfa_all_call.call_recordtype,
        sfa_all_call.call_duration_tva__c,
        sfa_all_call.call_datetime,
        sfa_all_call.call_timezone,
        sfa_all_call.how_executed,
        sfa_all_call.call_status,
        sfa_all_call.remote_meeting_vod__c
 FROM sandbox.sfa_all_call
 ORDER BY sfa_all_call.sales_force_id,
          sfa_all_call.call_id,
          sfa_all_call.veeva_account_id,
          sfa_all_call.ims_id,
          sfa_all_call.ims_outlet_id,
          sfa_all_call.tvcmid,
          sfa_all_call.customer_type,
          sfa_all_call.first_name,
          sfa_all_call.last_name,
          sfa_all_call.call_type,
          sfa_all_call.dea_num,
          sfa_all_call.rep_id,
          sfa_all_call.rep_first_name,
          sfa_all_call.rep_last_name,
          sfa_all_call.territory_number,
          sfa_all_call.zip_on_call,
          sfa_all_call.call_date,
          sfa_all_call.submit_date,
          sfa_all_call.attendees,
          sfa_all_call.attendee_type,
          sfa_all_call.call_recordtype,
          sfa_all_call.call_duration_tva__c,
          sfa_all_call.call_timezone,
          sfa_all_call.how_executed,
          sfa_all_call.call_status,
          sfa_all_call.remote_meeting_vod__c
SEGMENTED BY hash(sfa_all_call.call_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_sfa_call_b0 /*+basename(tmp_sfa_call),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 veeva_account_id,
 ims_id,
 ims_outlet_id,
 tvcmid,
 customer_type,
 first_name,
 last_name,
 call_type,
 legacy_call_type,
 ceph_id,
 dea_num,
 rep_id,
 rep_first_name,
 rep_last_name,
 territory_number,
 region_number,
 area_number,
 zip_on_call,
 call_date,
 submit_date,
 attendees,
 attendee_type,
 call_recordtype,
 call_duration_tva__c,
 call_datetime,
 call_timezone,
 how_executed,
 call_status,
 remote_meeting_vod__c
)
AS
 SELECT tmp_sfa_call.sales_force_id,
        tmp_sfa_call.call_id,
        tmp_sfa_call.veeva_account_id,
        tmp_sfa_call.ims_id,
        tmp_sfa_call.ims_outlet_id,
        tmp_sfa_call.tvcmid,
        tmp_sfa_call.customer_type,
        tmp_sfa_call.first_name,
        tmp_sfa_call.last_name,
        tmp_sfa_call.call_type,
        tmp_sfa_call.legacy_call_type,
        tmp_sfa_call.ceph_id,
        tmp_sfa_call.dea_num,
        tmp_sfa_call.rep_id,
        tmp_sfa_call.rep_first_name,
        tmp_sfa_call.rep_last_name,
        tmp_sfa_call.territory_number,
        tmp_sfa_call.region_number,
        tmp_sfa_call.area_number,
        tmp_sfa_call.zip_on_call,
        tmp_sfa_call.call_date,
        tmp_sfa_call.submit_date,
        tmp_sfa_call.attendees,
        tmp_sfa_call.attendee_type,
        tmp_sfa_call.call_recordtype,
        tmp_sfa_call.call_duration_tva__c,
        tmp_sfa_call.call_datetime,
        tmp_sfa_call.call_timezone,
        tmp_sfa_call.how_executed,
        tmp_sfa_call.call_status,
        tmp_sfa_call.remote_meeting_vod__c
 FROM sandbox.tmp_sfa_call
 ORDER BY tmp_sfa_call.sales_force_id,
          tmp_sfa_call.call_id,
          tmp_sfa_call.veeva_account_id,
          tmp_sfa_call.ims_id,
          tmp_sfa_call.ims_outlet_id,
          tmp_sfa_call.tvcmid,
          tmp_sfa_call.customer_type,
          tmp_sfa_call.first_name,
          tmp_sfa_call.last_name,
          tmp_sfa_call.call_type,
          tmp_sfa_call.dea_num,
          tmp_sfa_call.rep_id,
          tmp_sfa_call.rep_first_name,
          tmp_sfa_call.rep_last_name,
          tmp_sfa_call.territory_number,
          tmp_sfa_call.zip_on_call,
          tmp_sfa_call.call_date,
          tmp_sfa_call.submit_date,
          tmp_sfa_call.attendees,
          tmp_sfa_call.attendee_type,
          tmp_sfa_call.call_recordtype,
          tmp_sfa_call.call_duration_tva__c,
          tmp_sfa_call.call_timezone,
          tmp_sfa_call.how_executed,
          tmp_sfa_call.call_status,
          tmp_sfa_call.remote_meeting_vod__c
SEGMENTED BY hash(tmp_sfa_call.call_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_region_area_c_b0 /*+basename(tmp_region_area_c),createtype(A)*/ 
(
 territory_number,
 area_number,
 region_number
)
AS
 SELECT tmp_region_area_c.territory_number,
        tmp_region_area_c.area_number,
        tmp_region_area_c.region_number
 FROM sandbox.tmp_region_area_c
 ORDER BY tmp_region_area_c.territory_number,
          tmp_region_area_c.area_number,
          tmp_region_area_c.region_number
SEGMENTED BY hash(tmp_region_area_c.territory_number, tmp_region_area_c.area_number, tmp_region_area_c.region_number) ALL NODES;

CREATE PROJECTION sandbox.tmp_call_detail_cd_b0 /*+basename(tmp_call_detail_cd),createtype(A)*/ 
(
 sales_force_id,
 id,
 call2_vod__c,
 detail_priority_vod__c,
 product_vod__c,
 bendeka_indication_tva__c,
 austedo_indication_tva__c,
 row_num
)
AS
 SELECT tmp_call_detail_cd.sales_force_id,
        tmp_call_detail_cd.id,
        tmp_call_detail_cd.call2_vod__c,
        tmp_call_detail_cd.detail_priority_vod__c,
        tmp_call_detail_cd.product_vod__c,
        tmp_call_detail_cd.bendeka_indication_tva__c,
        tmp_call_detail_cd.austedo_indication_tva__c,
        tmp_call_detail_cd.row_num
 FROM sandbox.tmp_call_detail_cd
 ORDER BY tmp_call_detail_cd.id
SEGMENTED BY hash(tmp_call_detail_cd.id) ALL NODES;

CREATE PROJECTION sandbox.tmp_sfa_call_detail_b0 /*+basename(tmp_sfa_call_detail),createtype(A)*/ 
(
 sales_force_id,
 call_id,
 product,
 basket_id,
 basket_name,
 detail_position,
 indication
)
AS
 SELECT tmp_sfa_call_detail.sales_force_id,
        tmp_sfa_call_detail.call_id,
        tmp_sfa_call_detail.product,
        tmp_sfa_call_detail.basket_id,
        tmp_sfa_call_detail.basket_name,
        tmp_sfa_call_detail.detail_position,
        tmp_sfa_call_detail.indication
 FROM sandbox.tmp_sfa_call_detail
 ORDER BY tmp_sfa_call_detail.sales_force_id,
          tmp_sfa_call_detail.call_id,
          tmp_sfa_call_detail.product,
          tmp_sfa_call_detail.basket_id,
          tmp_sfa_call_detail.basket_name,
          tmp_sfa_call_detail.detail_position,
          tmp_sfa_call_detail.indication
SEGMENTED BY hash(tmp_sfa_call_detail.sales_force_id, tmp_sfa_call_detail.call_id, tmp_sfa_call_detail.product, tmp_sfa_call_detail.basket_id, tmp_sfa_call_detail.basket_name, tmp_sfa_call_detail.detail_position, tmp_sfa_call_detail.indication) ALL NODES;

CREATE PROJECTION sandbox.sent_email_template_id_b0 /*+basename(sent_email_template_id),createtype(A)*/ 
(
 Sent_Email_vod__c,
 Approved_Email_Template_vod__c
)
AS
 SELECT sent_email_template_id.Sent_Email_vod__c,
        sent_email_template_id.Approved_Email_Template_vod__c
 FROM sandbox.sent_email_template_id
 ORDER BY sent_email_template_id.Sent_Email_vod__c,
          sent_email_template_id.Approved_Email_Template_vod__c
SEGMENTED BY hash(sent_email_template_id.Sent_Email_vod__c, sent_email_template_id.Approved_Email_Template_vod__c) ALL NODES;

CREATE PROJECTION sandbox.veeva_sent_email_07102020_b0 /*+basename(veeva_sent_email_07102020),createtype(A)*/ 
(
 Id,
 CreatedDate,
 CreatedById,
 LastModifiedDate,
 LastModifiedById,
 OwnerId,
 RecordTypeId,
 IsDeleted,
 SystemModstamp,
 Name,
 Account_vod__c,
 Activity_Tracking_Mode_vod__c,
 EM_Attendee_vod__c,
 Bcc_vod__c,
 Call2_vod__c,
 Capture_Datetime_vod__c,
 Clicked_vod__c,
 Content_Type_vod__c,
 Detail_Group_vod__c,
 Approved_Document_Views_vod__c,
 Entity_Reference_Id_vod__c,
 Event_vod__c,
 Event_Attendee_vod__c,
 Event_Attendee_Mobile_Id_vod__c,
 Event_Mobile_Id_vod__c,
 Events_Management_Subtype_vod__c,
 EM_Event_Speaker_vod__c,
 EM_Event_Team_Member_vod__c,
 Sender_Email_vod__c,
 Key_Message_vod__c,
 Last_Click_Date_vod__c,
 Last_Device_vod__c,
 Last_Activity_Date_vod__c,
 Last_Open_Date_vod__c,
 MC_Capture_Datetime_vod__c,
 Medical_Event_vod__c,
 Medical_Inquiry_vod__c,
 Mobile_ID_vod__c,
 Opened_vod__c,
 Parent_Email_vod__c,
 Product_vod__c,
 Product_Display_vod__c,
 Receipt_Entity_Type_vod__c,
 Receipt_Record_Id_vod__c,
 Related_Transaction_ID_vod__c,
 Scheduled_Send_Datetime_vod__c,
 Email_Sent_Date_vod__c,
 Status_vod__c,
 Failure_Msg_vod__c,
 Suggestion_vod__c,
 Territory_vod__c,
 Account_Email_vod__c,
 Click_Count_vod__c,
 Open_Count_vod__c,
 User_vod__c,
 Valid_Consent_Exists_vod__c,
 VExternal_Id_vod__c,
 record_id,
 file_id,
 Approved_Email_Template_vod__c
)
AS
 SELECT veeva_sent_email_07102020.Id,
        veeva_sent_email_07102020.CreatedDate,
        veeva_sent_email_07102020.CreatedById,
        veeva_sent_email_07102020.LastModifiedDate,
        veeva_sent_email_07102020.LastModifiedById,
        veeva_sent_email_07102020.OwnerId,
        veeva_sent_email_07102020.RecordTypeId,
        veeva_sent_email_07102020.IsDeleted,
        veeva_sent_email_07102020.SystemModstamp,
        veeva_sent_email_07102020.Name,
        veeva_sent_email_07102020.Account_vod__c,
        veeva_sent_email_07102020.Activity_Tracking_Mode_vod__c,
        veeva_sent_email_07102020.EM_Attendee_vod__c,
        veeva_sent_email_07102020.Bcc_vod__c,
        veeva_sent_email_07102020.Call2_vod__c,
        veeva_sent_email_07102020.Capture_Datetime_vod__c,
        veeva_sent_email_07102020.Clicked_vod__c,
        veeva_sent_email_07102020.Content_Type_vod__c,
        veeva_sent_email_07102020.Detail_Group_vod__c,
        veeva_sent_email_07102020.Approved_Document_Views_vod__c,
        veeva_sent_email_07102020.Entity_Reference_Id_vod__c,
        veeva_sent_email_07102020.Event_vod__c,
        veeva_sent_email_07102020.Event_Attendee_vod__c,
        veeva_sent_email_07102020.Event_Attendee_Mobile_Id_vod__c,
        veeva_sent_email_07102020.Event_Mobile_Id_vod__c,
        veeva_sent_email_07102020.Events_Management_Subtype_vod__c,
        veeva_sent_email_07102020.EM_Event_Speaker_vod__c,
        veeva_sent_email_07102020.EM_Event_Team_Member_vod__c,
        veeva_sent_email_07102020.Sender_Email_vod__c,
        veeva_sent_email_07102020.Key_Message_vod__c,
        veeva_sent_email_07102020.Last_Click_Date_vod__c,
        veeva_sent_email_07102020.Last_Device_vod__c,
        veeva_sent_email_07102020.Last_Activity_Date_vod__c,
        veeva_sent_email_07102020.Last_Open_Date_vod__c,
        veeva_sent_email_07102020.MC_Capture_Datetime_vod__c,
        veeva_sent_email_07102020.Medical_Event_vod__c,
        veeva_sent_email_07102020.Medical_Inquiry_vod__c,
        veeva_sent_email_07102020.Mobile_ID_vod__c,
        veeva_sent_email_07102020.Opened_vod__c,
        veeva_sent_email_07102020.Parent_Email_vod__c,
        veeva_sent_email_07102020.Product_vod__c,
        veeva_sent_email_07102020.Product_Display_vod__c,
        veeva_sent_email_07102020.Receipt_Entity_Type_vod__c,
        veeva_sent_email_07102020.Receipt_Record_Id_vod__c,
        veeva_sent_email_07102020.Related_Transaction_ID_vod__c,
        veeva_sent_email_07102020.Scheduled_Send_Datetime_vod__c,
        veeva_sent_email_07102020.Email_Sent_Date_vod__c,
        veeva_sent_email_07102020.Status_vod__c,
        veeva_sent_email_07102020.Failure_Msg_vod__c,
        veeva_sent_email_07102020.Suggestion_vod__c,
        veeva_sent_email_07102020.Territory_vod__c,
        veeva_sent_email_07102020.Account_Email_vod__c,
        veeva_sent_email_07102020.Click_Count_vod__c,
        veeva_sent_email_07102020.Open_Count_vod__c,
        veeva_sent_email_07102020.User_vod__c,
        veeva_sent_email_07102020.Valid_Consent_Exists_vod__c,
        veeva_sent_email_07102020.VExternal_Id_vod__c,
        veeva_sent_email_07102020.record_id,
        veeva_sent_email_07102020.file_id,
        veeva_sent_email_07102020.Approved_Email_Template_vod__c
 FROM sandbox.veeva_sent_email_07102020
 ORDER BY veeva_sent_email_07102020.Id,
          veeva_sent_email_07102020.CreatedDate,
          veeva_sent_email_07102020.CreatedById,
          veeva_sent_email_07102020.LastModifiedDate,
          veeva_sent_email_07102020.LastModifiedById,
          veeva_sent_email_07102020.OwnerId,
          veeva_sent_email_07102020.RecordTypeId,
          veeva_sent_email_07102020.IsDeleted
SEGMENTED BY hash(veeva_sent_email_07102020.record_id) ALL NODES;

CREATE PROJECTION sandbox.concur_hcp_delta_07212020_b0 /*+basename(concur_hcp_delta_07212020),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT concur_hcp_delta_07212020.cust_id,
        concur_hcp_delta_07212020.organization_name,
        concur_hcp_delta_07212020.contact_type,
        concur_hcp_delta_07212020.first_name,
        concur_hcp_delta_07212020.middle_name,
        concur_hcp_delta_07212020.last_name,
        concur_hcp_delta_07212020.suffix,
        concur_hcp_delta_07212020.npi,
        concur_hcp_delta_07212020.address_line_1,
        concur_hcp_delta_07212020.address_line_2,
        concur_hcp_delta_07212020.city,
        concur_hcp_delta_07212020.state,
        concur_hcp_delta_07212020.zipcode,
        concur_hcp_delta_07212020.sln,
        concur_hcp_delta_07212020.sln_state,
        concur_hcp_delta_07212020.dea,
        concur_hcp_delta_07212020.affiliation,
        concur_hcp_delta_07212020.credential,
        concur_hcp_delta_07212020.healthcare_professional_status_code,
        concur_hcp_delta_07212020.create_date
 FROM sandbox.concur_hcp_delta_07212020
 ORDER BY concur_hcp_delta_07212020.cust_id
SEGMENTED BY hash(concur_hcp_delta_07212020.cust_id, concur_hcp_delta_07212020.first_name, concur_hcp_delta_07212020.middle_name, concur_hcp_delta_07212020.last_name, concur_hcp_delta_07212020.suffix, concur_hcp_delta_07212020.npi, concur_hcp_delta_07212020.address_line_1, concur_hcp_delta_07212020.address_line_2, concur_hcp_delta_07212020.city, concur_hcp_delta_07212020.state, concur_hcp_delta_07212020.zipcode, concur_hcp_delta_07212020.sln, concur_hcp_delta_07212020.sln_state, concur_hcp_delta_07212020.dea, concur_hcp_delta_07212020.credential, concur_hcp_delta_07212020.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.Optum_calendar_conversion_b0 /*+basename(Optum_calendar_conversion),createtype(L)*/ 
(
 "RELIANCE Data",
 Month_RollUP
)
AS
 SELECT Optum_calendar_conversion."RELIANCE Data",
        Optum_calendar_conversion.Month_RollUP
 FROM sandbox.Optum_calendar_conversion
 ORDER BY Optum_calendar_conversion."RELIANCE Data",
          Optum_calendar_conversion.Month_RollUP
SEGMENTED BY hash(Optum_calendar_conversion."RELIANCE Data", Optum_calendar_conversion.Month_RollUP) ALL NODES;

CREATE PROJECTION sandbox.rs_wkly_geo_summ_b0 /*+basename(rs_wkly_geo_summ),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count
)
AS
 SELECT rs_wkly_geo_summ.sales_force_id,
        rs_wkly_geo_summ.geography_level,
        rs_wkly_geo_summ.geography_id,
        rs_wkly_geo_summ.geography,
        rs_wkly_geo_summ.rep_name,
        rs_wkly_geo_summ.user_id,
        rs_wkly_geo_summ.time_period,
        rs_wkly_geo_summ.period_type,
        rs_wkly_geo_summ.period,
        rs_wkly_geo_summ.market_id,
        rs_wkly_geo_summ.market_name,
        rs_wkly_geo_summ.brand_id,
        rs_wkly_geo_summ.brand_name,
        rs_wkly_geo_summ.teva_product_flag,
        rs_wkly_geo_summ.target_status_flag,
        rs_wkly_geo_summ.method_of_payment,
        rs_wkly_geo_summ.specialty,
        rs_wkly_geo_summ.segment,
        rs_wkly_geo_summ.market_volume_indicator,
        rs_wkly_geo_summ.product_vol_trx_count,
        rs_wkly_geo_summ.product_vol_new_pres_trx_count,
        rs_wkly_geo_summ.market_vol_trx_count,
        rs_wkly_geo_summ.prev_prod_vol_trx_count,
        rs_wkly_geo_summ.prev_market_vol_trx_count,
        rs_wkly_geo_summ.product_vol_nrx_count,
        rs_wkly_geo_summ.product_vol_new_pres_nrx_count,
        rs_wkly_geo_summ.market_vol_nrx_count,
        rs_wkly_geo_summ.prev_prod_vol_nrx_count,
        rs_wkly_geo_summ.prev_market_vol_nrx_count,
        rs_wkly_geo_summ.prescribers_count,
        rs_wkly_geo_summ.new_prescribers_count
 FROM sandbox.rs_wkly_geo_summ
 ORDER BY rs_wkly_geo_summ.sales_force_id,
          rs_wkly_geo_summ.geography_level,
          rs_wkly_geo_summ.geography_id,
          rs_wkly_geo_summ.geography,
          rs_wkly_geo_summ.rep_name,
          rs_wkly_geo_summ.user_id,
          rs_wkly_geo_summ.time_period,
          rs_wkly_geo_summ.period_type
SEGMENTED BY hash(rs_wkly_geo_summ.sales_force_id, rs_wkly_geo_summ.market_id, rs_wkly_geo_summ.brand_id, rs_wkly_geo_summ.teva_product_flag, rs_wkly_geo_summ.target_status_flag, rs_wkly_geo_summ.market_volume_indicator, rs_wkly_geo_summ.prescribers_count, rs_wkly_geo_summ.new_prescribers_count) ALL NODES;

CREATE PROJECTION sandbox."SYNEOS MISSING IMSIDs_b0" /*+basename(SYNEOS MISSING IMSIDs),createtype(L)*/ 
(
 "Digihaler_rx_20210215 (JAN)"
)
AS
 SELECT "SYNEOS MISSING IMSIDs"."Digihaler_rx_20210215 (JAN)"
 FROM sandbox."SYNEOS MISSING IMSIDs"
 ORDER BY "SYNEOS MISSING IMSIDs"."Digihaler_rx_20210215 (JAN)"
SEGMENTED BY hash("SYNEOS MISSING IMSIDs"."Digihaler_rx_20210215 (JAN)") ALL NODES;

CREATE PROJECTION sandbox.tmp_teva_transform_lock_b0 /*+basename(tmp_teva_transform_lock),createtype(A)*/ 
(
 transform_lock_id,
 transform_name,
 transform_lock_time
)
AS
 SELECT tmp_teva_transform_lock.transform_lock_id,
        tmp_teva_transform_lock.transform_name,
        tmp_teva_transform_lock.transform_lock_time
 FROM sandbox.tmp_teva_transform_lock
 ORDER BY tmp_teva_transform_lock.transform_name
SEGMENTED BY hash(tmp_teva_transform_lock.transform_name) ALL NODES;

CREATE PROJECTION sandbox.datamart_activity_hub_b0 /*+basename(datamart_activity_hub),createtype(A)*/ 
(
 activity_id,
 federation_id,
 contact,
 source_name,
 "datetime",
 trackback_id,
 previous_activity,
 level_name,
 activity_role_name,
 type_name,
 native_type,
 details,
 line_item_id,
 brand_name,
 activity,
 line_item_datetime,
 line_item_previous_line_item,
 line_item_trackback_id,
 line_item_details,
 line_item_type_name,
 line_item_native_type,
 basket_id,
 web_url
)
AS
 SELECT datamart_activity_hub.activity_id,
        datamart_activity_hub.federation_id,
        datamart_activity_hub.contact,
        datamart_activity_hub.source_name,
        datamart_activity_hub."datetime",
        datamart_activity_hub.trackback_id,
        datamart_activity_hub.previous_activity,
        datamart_activity_hub.level_name,
        datamart_activity_hub.activity_role_name,
        datamart_activity_hub.type_name,
        datamart_activity_hub.native_type,
        datamart_activity_hub.details,
        datamart_activity_hub.line_item_id,
        datamart_activity_hub.brand_name,
        datamart_activity_hub.activity,
        datamart_activity_hub.line_item_datetime,
        datamart_activity_hub.line_item_previous_line_item,
        datamart_activity_hub.line_item_trackback_id,
        datamart_activity_hub.line_item_details,
        datamart_activity_hub.line_item_type_name,
        datamart_activity_hub.line_item_native_type,
        datamart_activity_hub.basket_id,
        datamart_activity_hub.web_url
 FROM sandbox.datamart_activity_hub
 ORDER BY datamart_activity_hub.activity_id
SEGMENTED BY hash(datamart_activity_hub.activity_id) ALL NODES;

CREATE PROJECTION sandbox.ajovy_cust_level_flags_b0 /*+basename(ajovy_cust_level_flags),createtype(A)*/ 
(
 tvcmid,
 basket_name,
 sales_force_id,
 territory_number,
 flag_type,
 flag_value,
 flag_effective_start_date,
 flag_effective_end_date
)
AS
 SELECT ajovy_cust_level_flags.tvcmid,
        ajovy_cust_level_flags.basket_name,
        ajovy_cust_level_flags.sales_force_id,
        ajovy_cust_level_flags.territory_number,
        ajovy_cust_level_flags.flag_type,
        ajovy_cust_level_flags.flag_value,
        ajovy_cust_level_flags.flag_effective_start_date,
        ajovy_cust_level_flags.flag_effective_end_date
 FROM sandbox.ajovy_cust_level_flags
 ORDER BY ajovy_cust_level_flags.tvcmid,
          ajovy_cust_level_flags.basket_name,
          ajovy_cust_level_flags.sales_force_id,
          ajovy_cust_level_flags.territory_number,
          ajovy_cust_level_flags.flag_type,
          ajovy_cust_level_flags.flag_value,
          ajovy_cust_level_flags.flag_effective_start_date,
          ajovy_cust_level_flags.flag_effective_end_date
SEGMENTED BY hash(ajovy_cust_level_flags.tvcmid, ajovy_cust_level_flags.sales_force_id, ajovy_cust_level_flags.territory_number, ajovy_cust_level_flags.flag_effective_start_date, ajovy_cust_level_flags.flag_effective_end_date, ajovy_cust_level_flags.flag_type, ajovy_cust_level_flags.flag_value, ajovy_cust_level_flags.basket_name) ALL NODES;

CREATE PROJECTION sandbox.health_plan_geography_b0 /*+basename(health_plan_geography),createtype(L)*/ 
(
 health_plan_id,
 Country_fips_id,
 country_id,
 country_name,
 state_id,
 state_name,
 country_lives
)
AS
 SELECT health_plan_geography.health_plan_id,
        health_plan_geography.Country_fips_id,
        health_plan_geography.country_id,
        health_plan_geography.country_name,
        health_plan_geography.state_id,
        health_plan_geography.state_name,
        health_plan_geography.country_lives
 FROM sandbox.health_plan_geography
 ORDER BY health_plan_geography.health_plan_id,
          health_plan_geography.Country_fips_id,
          health_plan_geography.country_id,
          health_plan_geography.country_name,
          health_plan_geography.state_id,
          health_plan_geography.state_name,
          health_plan_geography.country_lives
SEGMENTED BY hash(health_plan_geography.country_id, health_plan_geography.state_id, health_plan_geography.state_name, health_plan_geography.country_lives, health_plan_geography.health_plan_id, health_plan_geography.Country_fips_id, health_plan_geography.country_name) ALL NODES;

CREATE PROJECTION sandbox.ps_payer_plan_table_01_b0 /*+basename(ps_payer_plan_table_01),createtype(A)*/ 
(
 IQVIA_Payer_Name,
 IQVIA_Plan_Code,
 IQVIA_Plan_Name,
 Model,
 PayTypeIndex,
 PayType,
 IQVIA_PBM
)
AS
 SELECT ps_payer_plan_table_01.IQVIA_Payer_Name,
        ps_payer_plan_table_01.IQVIA_Plan_Code,
        ps_payer_plan_table_01.IQVIA_Plan_Name,
        ps_payer_plan_table_01.Model,
        ps_payer_plan_table_01.PayTypeIndex,
        ps_payer_plan_table_01.PayType,
        ps_payer_plan_table_01.IQVIA_PBM
 FROM sandbox.ps_payer_plan_table_01
 ORDER BY ps_payer_plan_table_01.IQVIA_Payer_Name,
          ps_payer_plan_table_01.IQVIA_Plan_Name
SEGMENTED BY hash(ps_payer_plan_table_01.IQVIA_Payer_Name, ps_payer_plan_table_01.IQVIA_Plan_Name) ALL NODES;

CREATE PROJECTION sandbox.hdsa_coe_affiliations_0420_b0 /*+basename(hdsa_coe_affiliations_0420),createtype(L)*/ 
(
 hdsa_coe_id,
 hdsa_coe_name,
 ims_id,
 tvcmid,
 npi,
 last_name,
 first_name,
 middle_name,
 primary_specialty,
 address_line1,
 address_line2,
 city,
 state_code,
 zip,
 specialty_group
)
AS
 SELECT hdsa_coe_affiliations_0420.hdsa_coe_id,
        hdsa_coe_affiliations_0420.hdsa_coe_name,
        hdsa_coe_affiliations_0420.ims_id,
        hdsa_coe_affiliations_0420.tvcmid,
        hdsa_coe_affiliations_0420.npi,
        hdsa_coe_affiliations_0420.last_name,
        hdsa_coe_affiliations_0420.first_name,
        hdsa_coe_affiliations_0420.middle_name,
        hdsa_coe_affiliations_0420.primary_specialty,
        hdsa_coe_affiliations_0420.address_line1,
        hdsa_coe_affiliations_0420.address_line2,
        hdsa_coe_affiliations_0420.city,
        hdsa_coe_affiliations_0420.state_code,
        hdsa_coe_affiliations_0420.zip,
        hdsa_coe_affiliations_0420.specialty_group
 FROM sandbox.hdsa_coe_affiliations_0420
 ORDER BY hdsa_coe_affiliations_0420.hdsa_coe_id,
          hdsa_coe_affiliations_0420.hdsa_coe_name,
          hdsa_coe_affiliations_0420.ims_id,
          hdsa_coe_affiliations_0420.tvcmid,
          hdsa_coe_affiliations_0420.npi,
          hdsa_coe_affiliations_0420.last_name,
          hdsa_coe_affiliations_0420.first_name,
          hdsa_coe_affiliations_0420.middle_name
SEGMENTED BY hash(hdsa_coe_affiliations_0420.hdsa_coe_id, hdsa_coe_affiliations_0420.ims_id, hdsa_coe_affiliations_0420.tvcmid, hdsa_coe_affiliations_0420.npi, hdsa_coe_affiliations_0420.zip, hdsa_coe_affiliations_0420.last_name, hdsa_coe_affiliations_0420.first_name, hdsa_coe_affiliations_0420.middle_name) ALL NODES;

CREATE PROJECTION sandbox.ausedto_0528_b0 /*+basename(ausedto_0528),createtype(A)*/ 
(
 ims_id
)
AS
 SELECT ausedto_0528.ims_id
 FROM sandbox.ausedto_0528
 ORDER BY ausedto_0528.ims_id
SEGMENTED BY hash(ausedto_0528.ims_id) ALL NODES;

CREATE PROJECTION sandbox.austedo_0528_b0 /*+basename(austedo_0528),createtype(A)*/ 
(
 ims_id
)
AS
 SELECT austedo_0528.ims_id
 FROM sandbox.austedo_0528
 ORDER BY austedo_0528.ims_id
SEGMENTED BY hash(austedo_0528.ims_id) ALL NODES;

CREATE PROJECTION sandbox.teva_iqvia_bridge_v1_b0 /*+basename(teva_iqvia_bridge_v1),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_health_plan_type,
 hp_type,
 model,
 iqvia_pbm,
 iqvia_paytype,
 paytype_index,
 paytype,
 check_pay_types,
 check_hp_types,
 old_ftf_health_plan_type,
 cycle_id
)
AS
 SELECT teva_iqvia_bridge_v1.iqvia_payer_name,
        teva_iqvia_bridge_v1.iqvia_plan_code,
        teva_iqvia_bridge_v1.iqvia_plan_name,
        teva_iqvia_bridge_v1.comments,
        teva_iqvia_bridge_v1.ftf_health_plan_fid,
        teva_iqvia_bridge_v1.ftf_health_plan_name,
        teva_iqvia_bridge_v1.ftf_provider_name,
        teva_iqvia_bridge_v1.ftf_health_plan_type,
        teva_iqvia_bridge_v1.hp_type,
        teva_iqvia_bridge_v1.model,
        teva_iqvia_bridge_v1.iqvia_pbm,
        teva_iqvia_bridge_v1.iqvia_paytype,
        teva_iqvia_bridge_v1.paytype_index,
        teva_iqvia_bridge_v1.paytype,
        teva_iqvia_bridge_v1.check_pay_types,
        teva_iqvia_bridge_v1.check_hp_types,
        teva_iqvia_bridge_v1.old_ftf_health_plan_type,
        teva_iqvia_bridge_v1.cycle_id
 FROM sandbox.teva_iqvia_bridge_v1
 ORDER BY teva_iqvia_bridge_v1.iqvia_payer_name,
          teva_iqvia_bridge_v1.iqvia_plan_code,
          teva_iqvia_bridge_v1.iqvia_plan_name,
          teva_iqvia_bridge_v1.comments,
          teva_iqvia_bridge_v1.ftf_health_plan_fid,
          teva_iqvia_bridge_v1.ftf_health_plan_name,
          teva_iqvia_bridge_v1.ftf_provider_name,
          teva_iqvia_bridge_v1.ftf_health_plan_type
SEGMENTED BY hash(teva_iqvia_bridge_v1.iqvia_plan_code, teva_iqvia_bridge_v1.ftf_health_plan_fid, teva_iqvia_bridge_v1.cycle_id, teva_iqvia_bridge_v1.iqvia_paytype, teva_iqvia_bridge_v1.paytype_index, teva_iqvia_bridge_v1.paytype, teva_iqvia_bridge_v1.check_pay_types, teva_iqvia_bridge_v1.check_hp_types) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plan_preprocessed_v1_b0 /*+basename(iqvia_plan_preprocessed_v1),createtype(A)*/ 
(
 iqvia_payer_id,
 iqvia_payer_name,
 iqvia_plan_id,
 iqvia_plan_code,
 iqvia_plan_name,
 model,
 iqvia_pbm,
 paytype,
 paytype_index,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_plan_preprocessed_v1.iqvia_payer_id,
        iqvia_plan_preprocessed_v1.iqvia_payer_name,
        iqvia_plan_preprocessed_v1.iqvia_plan_id,
        iqvia_plan_preprocessed_v1.iqvia_plan_code,
        iqvia_plan_preprocessed_v1.iqvia_plan_name,
        iqvia_plan_preprocessed_v1.model,
        iqvia_plan_preprocessed_v1.iqvia_pbm,
        iqvia_plan_preprocessed_v1.paytype,
        iqvia_plan_preprocessed_v1.paytype_index,
        iqvia_plan_preprocessed_v1.cycle_id,
        iqvia_plan_preprocessed_v1.modified_time,
        iqvia_plan_preprocessed_v1.modified_by
 FROM sandbox.iqvia_plan_preprocessed_v1
 ORDER BY iqvia_plan_preprocessed_v1.iqvia_payer_name,
          iqvia_plan_preprocessed_v1.iqvia_plan_name
SEGMENTED BY hash(iqvia_plan_preprocessed_v1.iqvia_plan_name, iqvia_plan_preprocessed_v1.iqvia_payer_name) ALL NODES;

CREATE PROJECTION sandbox.iqvia_pbm_preprocessed_v1_b0 /*+basename(iqvia_pbm_preprocessed_v1),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_pbm,
 xref_to,
 iqvia_plan_name,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_pbm_preprocessed_v1.iqvia_plan_code,
        iqvia_pbm_preprocessed_v1.iqvia_pbm,
        iqvia_pbm_preprocessed_v1.xref_to,
        iqvia_pbm_preprocessed_v1.iqvia_plan_name,
        iqvia_pbm_preprocessed_v1.cycle_id,
        iqvia_pbm_preprocessed_v1.modified_time,
        iqvia_pbm_preprocessed_v1.modified_by
 FROM sandbox.iqvia_pbm_preprocessed_v1
 ORDER BY iqvia_pbm_preprocessed_v1.iqvia_plan_code,
          iqvia_pbm_preprocessed_v1.iqvia_pbm,
          iqvia_pbm_preprocessed_v1.xref_to,
          iqvia_pbm_preprocessed_v1.iqvia_plan_name
SEGMENTED BY hash(iqvia_pbm_preprocessed_v1.iqvia_plan_code, iqvia_pbm_preprocessed_v1.iqvia_pbm, iqvia_pbm_preprocessed_v1.xref_to, iqvia_pbm_preprocessed_v1.iqvia_plan_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plans_preprocessed_v1_b0 /*+basename(ftf_health_plans_preprocessed_v1),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 parent_id,
 ftf_parent_name,
 ftf_health_plan_type,
 pref_brand_tier,
 plan_lives,
 paytype,
 paytype_index,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_health_plans_preprocessed_v1.ftf_health_plan_fid,
        ftf_health_plans_preprocessed_v1.ftf_health_plan_name,
        ftf_health_plans_preprocessed_v1.ftf_provider_fid,
        ftf_health_plans_preprocessed_v1.ftf_provider_name,
        ftf_health_plans_preprocessed_v1.parent_id,
        ftf_health_plans_preprocessed_v1.ftf_parent_name,
        ftf_health_plans_preprocessed_v1.ftf_health_plan_type,
        ftf_health_plans_preprocessed_v1.pref_brand_tier,
        ftf_health_plans_preprocessed_v1.plan_lives,
        ftf_health_plans_preprocessed_v1.paytype,
        ftf_health_plans_preprocessed_v1.paytype_index,
        ftf_health_plans_preprocessed_v1.cycle_id,
        ftf_health_plans_preprocessed_v1.modified_time,
        ftf_health_plans_preprocessed_v1.modified_by
 FROM sandbox.ftf_health_plans_preprocessed_v1
 ORDER BY ftf_health_plans_preprocessed_v1.ftf_health_plan_fid,
          ftf_health_plans_preprocessed_v1.ftf_health_plan_name,
          ftf_health_plans_preprocessed_v1.ftf_provider_fid,
          ftf_health_plans_preprocessed_v1.ftf_provider_name,
          ftf_health_plans_preprocessed_v1.parent_id,
          ftf_health_plans_preprocessed_v1.ftf_parent_name,
          ftf_health_plans_preprocessed_v1.ftf_health_plan_type,
          ftf_health_plans_preprocessed_v1.pref_brand_tier
SEGMENTED BY hash(ftf_health_plans_preprocessed_v1.ftf_health_plan_fid, ftf_health_plans_preprocessed_v1.ftf_provider_fid, ftf_health_plans_preprocessed_v1.parent_id, ftf_health_plans_preprocessed_v1.plan_lives, ftf_health_plans_preprocessed_v1.cycle_id, ftf_health_plans_preprocessed_v1.modified_time, ftf_health_plans_preprocessed_v1.modified_by, ftf_health_plans_preprocessed_v1.pref_brand_tier) ALL NODES;

CREATE PROJECTION sandbox.ftf_formularies_preprocessed_v1_b0 /*+basename(ftf_formularies_preprocessed_v1),createtype(A)*/ 
(
 drug_seq,
 ftf_health_plan_fid,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status,
 plan_lives,
 check_blank_pharmstat,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formularies_preprocessed_v1.drug_seq,
        ftf_formularies_preprocessed_v1.ftf_health_plan_fid,
        ftf_formularies_preprocessed_v1.drug_id,
        ftf_formularies_preprocessed_v1.tier_code,
        ftf_formularies_preprocessed_v1.restrictions,
        ftf_formularies_preprocessed_v1.reason_code,
        ftf_formularies_preprocessed_v1.reason_code_description,
        ftf_formularies_preprocessed_v1.pharmacy_status,
        ftf_formularies_preprocessed_v1.plan_lives,
        ftf_formularies_preprocessed_v1.check_blank_pharmstat,
        ftf_formularies_preprocessed_v1.cycle_id,
        ftf_formularies_preprocessed_v1.modified_time,
        ftf_formularies_preprocessed_v1.modified_by
 FROM sandbox.ftf_formularies_preprocessed_v1
 ORDER BY ftf_formularies_preprocessed_v1.drug_seq,
          ftf_formularies_preprocessed_v1.ftf_health_plan_fid
SEGMENTED BY hash(ftf_formularies_preprocessed_v1.drug_seq, ftf_formularies_preprocessed_v1.ftf_health_plan_fid, ftf_formularies_preprocessed_v1.drug_id, ftf_formularies_preprocessed_v1.tier_code, ftf_formularies_preprocessed_v1.plan_lives, ftf_formularies_preprocessed_v1.cycle_id, ftf_formularies_preprocessed_v1.modified_time, ftf_formularies_preprocessed_v1.modified_by) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbms_preprocessed_v1_b0 /*+basename(ftf_pbms_preprocessed_v1),createtype(A)*/ 
(
 ftf_health_plan_fid,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_pbms_preprocessed_v1.ftf_health_plan_fid,
        ftf_pbms_preprocessed_v1.pbm_id,
        ftf_pbms_preprocessed_v1.pbm,
        ftf_pbms_preprocessed_v1.pbm_function_id,
        ftf_pbms_preprocessed_v1.pbm_function,
        ftf_pbms_preprocessed_v1.cycle_id,
        ftf_pbms_preprocessed_v1.modified_time,
        ftf_pbms_preprocessed_v1.modified_by
 FROM sandbox.ftf_pbms_preprocessed_v1
 ORDER BY ftf_pbms_preprocessed_v1.ftf_health_plan_fid,
          ftf_pbms_preprocessed_v1.pbm_id,
          ftf_pbms_preprocessed_v1.pbm,
          ftf_pbms_preprocessed_v1.pbm_function_id,
          ftf_pbms_preprocessed_v1.pbm_function,
          ftf_pbms_preprocessed_v1.cycle_id,
          ftf_pbms_preprocessed_v1.modified_time,
          ftf_pbms_preprocessed_v1.modified_by
SEGMENTED BY hash(ftf_pbms_preprocessed_v1.ftf_health_plan_fid, ftf_pbms_preprocessed_v1.pbm_id, ftf_pbms_preprocessed_v1.pbm_function_id, ftf_pbms_preprocessed_v1.cycle_id, ftf_pbms_preprocessed_v1.modified_time, ftf_pbms_preprocessed_v1.modified_by, ftf_pbms_preprocessed_v1.pbm, ftf_pbms_preprocessed_v1.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_v01_b0 /*+basename(ftf_restrictions_preprocessed_v01),createtype(A)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 grouped_restriction_level,
 drug_seq,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_v01.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_v01.drug_id,
        ftf_restrictions_preprocessed_v01.restriction_code,
        ftf_restrictions_preprocessed_v01.restriction_detail_id,
        ftf_restrictions_preprocessed_v01.restriction_detail_text,
        ftf_restrictions_preprocessed_v01.grouped_restriction_level,
        ftf_restrictions_preprocessed_v01.drug_seq,
        ftf_restrictions_preprocessed_v01.botox,
        ftf_restrictions_preprocessed_v01.step,
        ftf_restrictions_preprocessed_v01.pres_pa,
        ftf_restrictions_preprocessed_v01.pat_pa,
        ftf_restrictions_preprocessed_v01.med_rec,
        ftf_restrictions_preprocessed_v01.unspec,
        ftf_restrictions_preprocessed_v01.cycle_id,
        ftf_restrictions_preprocessed_v01.modified_time,
        ftf_restrictions_preprocessed_v01.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_v01
 ORDER BY ftf_restrictions_preprocessed_v01.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_v01.drug_id,
          ftf_restrictions_preprocessed_v01.restriction_code,
          ftf_restrictions_preprocessed_v01.restriction_detail_id,
          ftf_restrictions_preprocessed_v01.restriction_detail_text,
          ftf_restrictions_preprocessed_v01.grouped_restriction_level,
          ftf_restrictions_preprocessed_v01.drug_seq,
          ftf_restrictions_preprocessed_v01.botox
SEGMENTED BY hash(ftf_restrictions_preprocessed_v01.ftf_health_plan_fid, ftf_restrictions_preprocessed_v01.drug_id, ftf_restrictions_preprocessed_v01.restriction_code, ftf_restrictions_preprocessed_v01.restriction_detail_id, ftf_restrictions_preprocessed_v01.drug_seq, ftf_restrictions_preprocessed_v01.botox, ftf_restrictions_preprocessed_v01.step, ftf_restrictions_preprocessed_v01.pres_pa) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_v02_b0 /*+basename(ftf_restrictions_preprocessed_v02),createtype(A)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 drug_seq,
 restriction_detail_id,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_v02.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_v02.drug_id,
        ftf_restrictions_preprocessed_v02.drug_seq,
        ftf_restrictions_preprocessed_v02.restriction_detail_id,
        ftf_restrictions_preprocessed_v02.botox,
        ftf_restrictions_preprocessed_v02.step,
        ftf_restrictions_preprocessed_v02.pres_pa,
        ftf_restrictions_preprocessed_v02.pat_pa,
        ftf_restrictions_preprocessed_v02.med_rec,
        ftf_restrictions_preprocessed_v02.unspec,
        ftf_restrictions_preprocessed_v02.cycle_id,
        ftf_restrictions_preprocessed_v02.modified_time,
        ftf_restrictions_preprocessed_v02.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_v02
 ORDER BY ftf_restrictions_preprocessed_v02.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_v02.drug_id,
          ftf_restrictions_preprocessed_v02.drug_seq
SEGMENTED BY hash(ftf_restrictions_preprocessed_v02.ftf_health_plan_fid, ftf_restrictions_preprocessed_v02.drug_id, ftf_restrictions_preprocessed_v02.drug_seq) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_bridge_preprocessed_v11_b0 /*+basename(ftf_iqvia_bridge_preprocessed_v11),createtype(A)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_health_plan_type,
 hp_type,
 overriden_ftf_plan_type,
 model,
 iqvia_pbm,
 iqvia_paytype,
 check_delete,
 paytype_index,
 paytype,
 check_pay_types,
 check_hp_types,
 old_ftf_health_plan_type,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_iqvia_bridge_preprocessed_v11.iqvia_payer_name,
        ftf_iqvia_bridge_preprocessed_v11.iqvia_plan_code,
        ftf_iqvia_bridge_preprocessed_v11.iqvia_plan_name,
        ftf_iqvia_bridge_preprocessed_v11.comments,
        ftf_iqvia_bridge_preprocessed_v11.ftf_health_plan_fid,
        ftf_iqvia_bridge_preprocessed_v11.ftf_health_plan_name,
        ftf_iqvia_bridge_preprocessed_v11.ftf_provider_name,
        ftf_iqvia_bridge_preprocessed_v11.ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_v11.hp_type,
        ftf_iqvia_bridge_preprocessed_v11.overriden_ftf_plan_type,
        ftf_iqvia_bridge_preprocessed_v11.model,
        ftf_iqvia_bridge_preprocessed_v11.iqvia_pbm,
        ftf_iqvia_bridge_preprocessed_v11.iqvia_paytype,
        ftf_iqvia_bridge_preprocessed_v11.check_delete,
        ftf_iqvia_bridge_preprocessed_v11.paytype_index,
        ftf_iqvia_bridge_preprocessed_v11.paytype,
        ftf_iqvia_bridge_preprocessed_v11.check_pay_types,
        ftf_iqvia_bridge_preprocessed_v11.check_hp_types,
        ftf_iqvia_bridge_preprocessed_v11.old_ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_v11.cycle_id,
        ftf_iqvia_bridge_preprocessed_v11.modified_time,
        ftf_iqvia_bridge_preprocessed_v11.modified_by
 FROM sandbox.ftf_iqvia_bridge_preprocessed_v11
 ORDER BY ftf_iqvia_bridge_preprocessed_v11.iqvia_payer_name,
          ftf_iqvia_bridge_preprocessed_v11.iqvia_plan_name,
          ftf_iqvia_bridge_preprocessed_v11.ftf_health_plan_name
SEGMENTED BY hash(ftf_iqvia_bridge_preprocessed_v11.iqvia_payer_name, ftf_iqvia_bridge_preprocessed_v11.iqvia_plan_name, ftf_iqvia_bridge_preprocessed_v11.ftf_health_plan_name) ALL NODES;

CREATE PROJECTION sandbox.process_info_b0 /*+basename(process_info),createtype(L)*/ 
(
 sub_process_id,
 sub_process_name,
 parent_process_id,
 parent_process_name,
 insert_time,
 inserted_by
)
AS
 SELECT process_info.sub_process_id,
        process_info.sub_process_name,
        process_info.parent_process_id,
        process_info.parent_process_name,
        process_info.insert_time,
        process_info.inserted_by
 FROM sandbox.process_info
 ORDER BY process_info.sub_process_id,
          process_info.sub_process_name,
          process_info.parent_process_id,
          process_info.parent_process_name,
          process_info.insert_time,
          process_info.inserted_by
SEGMENTED BY hash(process_info.sub_process_id, process_info.parent_process_id, process_info.insert_time, process_info.inserted_by, process_info.sub_process_name, process_info.parent_process_name) ALL NODES;

CREATE PROJECTION sandbox.process_dependency_master_b0 /*+basename(process_dependency_master),createtype(L)*/ 
(
 process_id,
 process_name,
 tbl_id,
 table_name,
 table_type,
 insert_time,
 inserted_by
)
AS
 SELECT process_dependency_master.process_id,
        process_dependency_master.process_name,
        process_dependency_master.tbl_id,
        process_dependency_master.table_name,
        process_dependency_master.table_type,
        process_dependency_master.insert_time,
        process_dependency_master.inserted_by
 FROM sandbox.process_dependency_master
 ORDER BY process_dependency_master.process_id,
          process_dependency_master.process_name,
          process_dependency_master.tbl_id,
          process_dependency_master.table_name,
          process_dependency_master.table_type,
          process_dependency_master.insert_time,
          process_dependency_master.inserted_by
SEGMENTED BY hash(process_dependency_master.process_id, process_dependency_master.tbl_id, process_dependency_master.insert_time, process_dependency_master.inserted_by, process_dependency_master.table_type, process_dependency_master.process_name, process_dependency_master.table_name) ALL NODES;

CREATE PROJECTION sandbox.tbl_info_b0 /*+basename(tbl_info),createtype(L)*/ 
(
 tbl_id,
 tbl_name,
 insert_time,
 inserted_by
)
AS
 SELECT tbl_info.tbl_id,
        tbl_info.tbl_name,
        tbl_info.insert_time,
        tbl_info.inserted_by
 FROM sandbox.tbl_info
 ORDER BY tbl_info.tbl_id,
          tbl_info.tbl_name,
          tbl_info.insert_time,
          tbl_info.inserted_by
SEGMENTED BY hash(tbl_info.tbl_id, tbl_info.insert_time, tbl_info.inserted_by, tbl_info.tbl_name) ALL NODES;

CREATE PROJECTION sandbox.mb_may_b0 /*+basename(mb_may),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 coverage_category_ajovy,
 coverage_category_aimovig,
 coverage_category_emgality,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_pbm,
 payer_pbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 key_controlling_parent,
 prev_month_lives_mx,
 lives_mx,
 cycle_id
)
AS
 SELECT mb_may.ftf_health_plan_fid,
        mb_may.ftf_health_plan_name,
        mb_may.coverage_category_ajovy,
        mb_may.coverage_category_aimovig,
        mb_may.coverage_category_emgality,
        mb_may.ftf_provider_fid,
        mb_may.ftf_provider_name,
        mb_may.ftf_parent_name,
        mb_may.paytype_index,
        mb_may.paytype,
        mb_may.ftf_health_plan_type,
        mb_may.pref_brand_tier,
        mb_may.key_controlling_plan_formulary,
        mb_may.key_controlling_account,
        mb_may.key_pbm,
        mb_may.payer_pbm,
        mb_may.ftf_match_iqvia,
        mb_may.iqvia_payer_name,
        mb_may.iqvia_pbm,
        mb_may.ftf_formulary_management_pbm,
        mb_may.ftf_formulary_influencer_pbm,
        mb_may.ftf_claims_processing_pbm,
        mb_may.key_controlling_parent,
        mb_may.prev_month_lives_mx,
        mb_may.lives_mx,
        mb_may.cycle_id
 FROM sandbox.mb_may
 ORDER BY mb_may.ftf_health_plan_fid,
          mb_may.ftf_health_plan_name,
          mb_may.coverage_category_ajovy,
          mb_may.coverage_category_aimovig,
          mb_may.coverage_category_emgality,
          mb_may.ftf_provider_fid,
          mb_may.ftf_provider_name,
          mb_may.ftf_parent_name
SEGMENTED BY hash(mb_may.ftf_health_plan_fid, mb_may.ftf_provider_fid, mb_may.paytype_index, mb_may.pref_brand_tier, mb_may.ftf_match_iqvia, mb_may.prev_month_lives_mx, mb_may.lives_mx, mb_may.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.iqvia_payer_paytype_override_v2_b0 /*+basename(iqvia_payer_paytype_override_v2),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_name_regex,
 paytype,
 file_id,
 record_id
)
AS
 SELECT iqvia_payer_paytype_override_v2.iqvia_payer_name,
        iqvia_payer_paytype_override_v2.iqvia_plan_name_regex,
        iqvia_payer_paytype_override_v2.paytype,
        iqvia_payer_paytype_override_v2.file_id,
        iqvia_payer_paytype_override_v2.record_id
 FROM sandbox.iqvia_payer_paytype_override_v2
 ORDER BY iqvia_payer_paytype_override_v2.iqvia_payer_name,
          iqvia_payer_paytype_override_v2.iqvia_plan_name_regex,
          iqvia_payer_paytype_override_v2.paytype,
          iqvia_payer_paytype_override_v2.file_id,
          iqvia_payer_paytype_override_v2.record_id
SEGMENTED BY hash(iqvia_payer_paytype_override_v2.file_id, iqvia_payer_paytype_override_v2.record_id, iqvia_payer_paytype_override_v2.paytype, iqvia_payer_paytype_override_v2.iqvia_payer_name, iqvia_payer_paytype_override_v2.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.mb_may_v2_b0 /*+basename(mb_may_v2),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 coverage_category_ajovy,
 coverage_category_aimovig,
 coverage_category_emgality,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_pbm,
 payer_pbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 key_controlling_parent,
 prev_month_lives_mx,
 lives_mx,
 cycle_id
)
AS
 SELECT mb_may_v2.ftf_health_plan_fid,
        mb_may_v2.ftf_health_plan_name,
        mb_may_v2.coverage_category_ajovy,
        mb_may_v2.coverage_category_aimovig,
        mb_may_v2.coverage_category_emgality,
        mb_may_v2.ftf_provider_fid,
        mb_may_v2.ftf_provider_name,
        mb_may_v2.ftf_parent_name,
        mb_may_v2.paytype_index,
        mb_may_v2.paytype,
        mb_may_v2.ftf_health_plan_type,
        mb_may_v2.pref_brand_tier,
        mb_may_v2.key_controlling_plan_formulary,
        mb_may_v2.key_controlling_account,
        mb_may_v2.key_pbm,
        mb_may_v2.payer_pbm,
        mb_may_v2.ftf_match_iqvia,
        mb_may_v2.iqvia_payer_name,
        mb_may_v2.iqvia_pbm,
        mb_may_v2.ftf_formulary_management_pbm,
        mb_may_v2.ftf_formulary_influencer_pbm,
        mb_may_v2.ftf_claims_processing_pbm,
        mb_may_v2.key_controlling_parent,
        mb_may_v2.prev_month_lives_mx,
        mb_may_v2.lives_mx,
        mb_may_v2.cycle_id
 FROM sandbox.mb_may_v2
 ORDER BY mb_may_v2.ftf_health_plan_fid
SEGMENTED BY hash(mb_may_v2.ftf_health_plan_fid, mb_may_v2.ftf_provider_fid, mb_may_v2.paytype_index, mb_may_v2.pref_brand_tier, mb_may_v2.ftf_match_iqvia, mb_may_v2.prev_month_lives_mx, mb_may_v2.lives_mx, mb_may_v2.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.copay_tier_derivation_config_v1_b0 /*+basename(copay_tier_derivation_config_v1),createtype(L)*/ 
(
 pharmacy_status_regex,
 tier_cat,
 tier_regex,
 pref_brand_tier_regex,
 ftf_health_plan_type_regex,
 copay_tier,
 file_id,
 record_id
)
AS
 SELECT copay_tier_derivation_config_v1.pharmacy_status_regex,
        copay_tier_derivation_config_v1.tier_cat,
        copay_tier_derivation_config_v1.tier_regex,
        copay_tier_derivation_config_v1.pref_brand_tier_regex,
        copay_tier_derivation_config_v1.ftf_health_plan_type_regex,
        copay_tier_derivation_config_v1.copay_tier,
        copay_tier_derivation_config_v1.file_id,
        copay_tier_derivation_config_v1.record_id
 FROM sandbox.copay_tier_derivation_config_v1
 ORDER BY copay_tier_derivation_config_v1.pharmacy_status_regex,
          copay_tier_derivation_config_v1.tier_cat,
          copay_tier_derivation_config_v1.tier_regex,
          copay_tier_derivation_config_v1.pref_brand_tier_regex,
          copay_tier_derivation_config_v1.ftf_health_plan_type_regex,
          copay_tier_derivation_config_v1.copay_tier,
          copay_tier_derivation_config_v1.file_id,
          copay_tier_derivation_config_v1.record_id
SEGMENTED BY hash(copay_tier_derivation_config_v1.file_id, copay_tier_derivation_config_v1.record_id, copay_tier_derivation_config_v1.pharmacy_status_regex, copay_tier_derivation_config_v1.tier_cat, copay_tier_derivation_config_v1.tier_regex, copay_tier_derivation_config_v1.pref_brand_tier_regex, copay_tier_derivation_config_v1.ftf_health_plan_type_regex, copay_tier_derivation_config_v1.copay_tier) ALL NODES;

CREATE PROJECTION sandbox.tier_cat_description_mapping_v1_b0 /*+basename(tier_cat_description_mapping_v1),createtype(L)*/ 
(
 tier_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT tier_cat_description_mapping_v1.tier_cat,
        tier_cat_description_mapping_v1.description,
        tier_cat_description_mapping_v1.notes,
        tier_cat_description_mapping_v1.file_id,
        tier_cat_description_mapping_v1.record_id
 FROM sandbox.tier_cat_description_mapping_v1
 ORDER BY tier_cat_description_mapping_v1.tier_cat,
          tier_cat_description_mapping_v1.description,
          tier_cat_description_mapping_v1.notes,
          tier_cat_description_mapping_v1.file_id,
          tier_cat_description_mapping_v1.record_id
SEGMENTED BY hash(tier_cat_description_mapping_v1.file_id, tier_cat_description_mapping_v1.record_id, tier_cat_description_mapping_v1.tier_cat, tier_cat_description_mapping_v1.description, tier_cat_description_mapping_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_bridge_preprocessed_v1_b0 /*+basename(ftf_iqvia_bridge_preprocessed_v1),createtype(A)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_health_plan_type,
 hp_type,
 overriden_ftf_plan_type,
 model,
 iqvia_pbm,
 iqvia_paytype,
 check_delete,
 paytype_index,
 paytype,
 check_pay_types,
 check_hp_types,
 old_ftf_health_plan_type,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_iqvia_bridge_preprocessed_v1.iqvia_payer_name,
        ftf_iqvia_bridge_preprocessed_v1.iqvia_plan_code,
        ftf_iqvia_bridge_preprocessed_v1.iqvia_plan_name,
        ftf_iqvia_bridge_preprocessed_v1.comments,
        ftf_iqvia_bridge_preprocessed_v1.ftf_health_plan_fid,
        ftf_iqvia_bridge_preprocessed_v1.ftf_health_plan_name,
        ftf_iqvia_bridge_preprocessed_v1.ftf_provider_name,
        ftf_iqvia_bridge_preprocessed_v1.ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_v1.hp_type,
        ftf_iqvia_bridge_preprocessed_v1.overriden_ftf_plan_type,
        ftf_iqvia_bridge_preprocessed_v1.model,
        ftf_iqvia_bridge_preprocessed_v1.iqvia_pbm,
        ftf_iqvia_bridge_preprocessed_v1.iqvia_paytype,
        ftf_iqvia_bridge_preprocessed_v1.check_delete,
        ftf_iqvia_bridge_preprocessed_v1.paytype_index,
        ftf_iqvia_bridge_preprocessed_v1.paytype,
        ftf_iqvia_bridge_preprocessed_v1.check_pay_types,
        ftf_iqvia_bridge_preprocessed_v1.check_hp_types,
        ftf_iqvia_bridge_preprocessed_v1.old_ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_v1.cycle_id,
        ftf_iqvia_bridge_preprocessed_v1.modified_time,
        ftf_iqvia_bridge_preprocessed_v1.modified_by
 FROM sandbox.ftf_iqvia_bridge_preprocessed_v1
 ORDER BY ftf_iqvia_bridge_preprocessed_v1.iqvia_payer_name,
          ftf_iqvia_bridge_preprocessed_v1.iqvia_plan_name,
          ftf_iqvia_bridge_preprocessed_v1.ftf_health_plan_name
SEGMENTED BY hash(ftf_iqvia_bridge_preprocessed_v1.iqvia_payer_name, ftf_iqvia_bridge_preprocessed_v1.iqvia_plan_name, ftf_iqvia_bridge_preprocessed_v1.ftf_health_plan_name) ALL NODES;

CREATE PROJECTION sandbox.restriction_category_derivation_config_v1_b0 /*+basename(restriction_category_derivation_config_v1),createtype(L)*/ 
(
 tier_regex,
 has_pa_has_st_regex,
 unspec_regex,
 step_regex,
 botox_regex,
 prespa_regex,
 tier_cat_regex,
 medrecs_regex,
 restcat,
 restriction_category,
 meaning,
 file_id,
 record_id
)
AS
 SELECT restriction_category_derivation_config_v1.tier_regex,
        restriction_category_derivation_config_v1.has_pa_has_st_regex,
        restriction_category_derivation_config_v1.unspec_regex,
        restriction_category_derivation_config_v1.step_regex,
        restriction_category_derivation_config_v1.botox_regex,
        restriction_category_derivation_config_v1.prespa_regex,
        restriction_category_derivation_config_v1.tier_cat_regex,
        restriction_category_derivation_config_v1.medrecs_regex,
        restriction_category_derivation_config_v1.restcat,
        restriction_category_derivation_config_v1.restriction_category,
        restriction_category_derivation_config_v1.meaning,
        restriction_category_derivation_config_v1.file_id,
        restriction_category_derivation_config_v1.record_id
 FROM sandbox.restriction_category_derivation_config_v1
 ORDER BY restriction_category_derivation_config_v1.tier_regex,
          restriction_category_derivation_config_v1.has_pa_has_st_regex,
          restriction_category_derivation_config_v1.unspec_regex,
          restriction_category_derivation_config_v1.step_regex,
          restriction_category_derivation_config_v1.botox_regex,
          restriction_category_derivation_config_v1.prespa_regex,
          restriction_category_derivation_config_v1.tier_cat_regex,
          restriction_category_derivation_config_v1.medrecs_regex
SEGMENTED BY hash(restriction_category_derivation_config_v1.restcat, restriction_category_derivation_config_v1.file_id, restriction_category_derivation_config_v1.record_id, restriction_category_derivation_config_v1.tier_regex, restriction_category_derivation_config_v1.has_pa_has_st_regex, restriction_category_derivation_config_v1.unspec_regex, restriction_category_derivation_config_v1.step_regex, restriction_category_derivation_config_v1.botox_regex) ALL NODES;

CREATE PROJECTION sandbox.restriction_cat_description_mapping_v1_b0 /*+basename(restriction_cat_description_mapping_v1),createtype(L)*/ 
(
 rest_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT restriction_cat_description_mapping_v1.rest_cat,
        restriction_cat_description_mapping_v1.description,
        restriction_cat_description_mapping_v1.notes,
        restriction_cat_description_mapping_v1.file_id,
        restriction_cat_description_mapping_v1.record_id
 FROM sandbox.restriction_cat_description_mapping_v1
 ORDER BY restriction_cat_description_mapping_v1.rest_cat,
          restriction_cat_description_mapping_v1.description,
          restriction_cat_description_mapping_v1.notes,
          restriction_cat_description_mapping_v1.file_id,
          restriction_cat_description_mapping_v1.record_id
SEGMENTED BY hash(restriction_cat_description_mapping_v1.file_id, restriction_cat_description_mapping_v1.record_id, restriction_cat_description_mapping_v1.rest_cat, restriction_cat_description_mapping_v1.description, restriction_cat_description_mapping_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.coverage_category_derivation_config_v1_b0 /*+basename(coverage_category_derivation_config_v1),createtype(L)*/ 
(
 paytype_regex,
 pharmacy_status_regex,
 coverage_cat_code,
 coverage_category,
 restriction_cat_code_regex,
 meaning,
 file_id,
 record_id
)
AS
 SELECT coverage_category_derivation_config_v1.paytype_regex,
        coverage_category_derivation_config_v1.pharmacy_status_regex,
        coverage_category_derivation_config_v1.coverage_cat_code,
        coverage_category_derivation_config_v1.coverage_category,
        coverage_category_derivation_config_v1.restriction_cat_code_regex,
        coverage_category_derivation_config_v1.meaning,
        coverage_category_derivation_config_v1.file_id,
        coverage_category_derivation_config_v1.record_id
 FROM sandbox.coverage_category_derivation_config_v1
 ORDER BY coverage_category_derivation_config_v1.paytype_regex,
          coverage_category_derivation_config_v1.pharmacy_status_regex,
          coverage_category_derivation_config_v1.coverage_cat_code,
          coverage_category_derivation_config_v1.coverage_category,
          coverage_category_derivation_config_v1.restriction_cat_code_regex,
          coverage_category_derivation_config_v1.meaning,
          coverage_category_derivation_config_v1.file_id,
          coverage_category_derivation_config_v1.record_id
SEGMENTED BY hash(coverage_category_derivation_config_v1.file_id, coverage_category_derivation_config_v1.record_id, coverage_category_derivation_config_v1.paytype_regex, coverage_category_derivation_config_v1.pharmacy_status_regex, coverage_category_derivation_config_v1.coverage_cat_code, coverage_category_derivation_config_v1.coverage_category, coverage_category_derivation_config_v1.restriction_cat_code_regex, coverage_category_derivation_config_v1.meaning) ALL NODES;

CREATE PROJECTION sandbox.coverage_cat_description_mapping_v1_b0 /*+basename(coverage_cat_description_mapping_v1),createtype(L)*/ 
(
 coverage_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT coverage_cat_description_mapping_v1.coverage_cat,
        coverage_cat_description_mapping_v1.description,
        coverage_cat_description_mapping_v1.notes,
        coverage_cat_description_mapping_v1.file_id,
        coverage_cat_description_mapping_v1.record_id
 FROM sandbox.coverage_cat_description_mapping_v1
 ORDER BY coverage_cat_description_mapping_v1.coverage_cat,
          coverage_cat_description_mapping_v1.description,
          coverage_cat_description_mapping_v1.notes,
          coverage_cat_description_mapping_v1.file_id,
          coverage_cat_description_mapping_v1.record_id
SEGMENTED BY hash(coverage_cat_description_mapping_v1.file_id, coverage_cat_description_mapping_v1.record_id, coverage_cat_description_mapping_v1.coverage_cat, coverage_cat_description_mapping_v1.description, coverage_cat_description_mapping_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plancode_fid_xref_b0 /*+basename(iqvia_plancode_fid_xref),createtype(A)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 ftf_health_plan_type,
 paytype_index,
 paytype,
 iqvia_pbm,
 hp_type,
 iqvia_paytype,
 pref_brand_tier,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_plancode_fid_xref.iqvia_payer_name,
        iqvia_plancode_fid_xref.iqvia_plan_code,
        iqvia_plancode_fid_xref.iqvia_plan_name,
        iqvia_plancode_fid_xref.comments,
        iqvia_plancode_fid_xref.ftf_health_plan_fid,
        iqvia_plancode_fid_xref.ftf_health_plan_name,
        iqvia_plancode_fid_xref.ftf_provider_fid,
        iqvia_plancode_fid_xref.ftf_provider_name,
        iqvia_plancode_fid_xref.ftf_parent_name,
        iqvia_plancode_fid_xref.ftf_health_plan_type,
        iqvia_plancode_fid_xref.paytype_index,
        iqvia_plancode_fid_xref.paytype,
        iqvia_plancode_fid_xref.iqvia_pbm,
        iqvia_plancode_fid_xref.hp_type,
        iqvia_plancode_fid_xref.iqvia_paytype,
        iqvia_plancode_fid_xref.pref_brand_tier,
        iqvia_plancode_fid_xref.lives,
        iqvia_plancode_fid_xref.cycle_id,
        iqvia_plancode_fid_xref.modified_time,
        iqvia_plancode_fid_xref.modified_by
 FROM sandbox.iqvia_plancode_fid_xref
 ORDER BY iqvia_plancode_fid_xref.ftf_health_plan_fid,
          iqvia_plancode_fid_xref.iqvia_payer_name,
          iqvia_plancode_fid_xref.iqvia_plan_code
SEGMENTED BY hash(iqvia_plancode_fid_xref.iqvia_payer_name, iqvia_plancode_fid_xref.iqvia_plan_name, iqvia_plancode_fid_xref.ftf_health_plan_name) ALL NODES;

CREATE PROJECTION sandbox.fid_best_iqviapayer_b0 /*+basename(fid_best_iqviapayer),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 iqvia_payer_name,
 frequency,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT fid_best_iqviapayer.ftf_health_plan_fid,
        fid_best_iqviapayer.ftf_health_plan_name,
        fid_best_iqviapayer.ftf_provider_fid,
        fid_best_iqviapayer.ftf_provider_name,
        fid_best_iqviapayer.iqvia_payer_name,
        fid_best_iqviapayer.frequency,
        fid_best_iqviapayer.cycle_id,
        fid_best_iqviapayer.modified_time,
        fid_best_iqviapayer.modified_by
 FROM sandbox.fid_best_iqviapayer
 ORDER BY fid_best_iqviapayer.ftf_health_plan_fid,
          fid_best_iqviapayer.ftf_health_plan_name,
          fid_best_iqviapayer.ftf_provider_fid,
          fid_best_iqviapayer.ftf_provider_name,
          fid_best_iqviapayer.iqvia_payer_name
SEGMENTED BY hash(fid_best_iqviapayer.ftf_health_plan_fid, fid_best_iqviapayer.ftf_health_plan_name, fid_best_iqviapayer.ftf_provider_fid, fid_best_iqviapayer.ftf_provider_name, fid_best_iqviapayer.iqvia_payer_name) ALL NODES;

CREATE PROJECTION sandbox.fid_best_iqviapbm_b0 /*+basename(fid_best_iqviapbm),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 iqvia_pbm,
 frequency,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT fid_best_iqviapbm.ftf_health_plan_fid,
        fid_best_iqviapbm.ftf_health_plan_name,
        fid_best_iqviapbm.ftf_provider_fid,
        fid_best_iqviapbm.ftf_provider_name,
        fid_best_iqviapbm.iqvia_pbm,
        fid_best_iqviapbm.frequency,
        fid_best_iqviapbm.cycle_id,
        fid_best_iqviapbm.modified_time,
        fid_best_iqviapbm.modified_by
 FROM sandbox.fid_best_iqviapbm
 ORDER BY fid_best_iqviapbm.ftf_health_plan_fid,
          fid_best_iqviapbm.ftf_health_plan_name,
          fid_best_iqviapbm.ftf_provider_fid,
          fid_best_iqviapbm.ftf_provider_name,
          fid_best_iqviapbm.iqvia_pbm
SEGMENTED BY hash(fid_best_iqviapbm.ftf_health_plan_fid, fid_best_iqviapbm.ftf_health_plan_name, fid_best_iqviapbm.ftf_provider_fid, fid_best_iqviapbm.ftf_provider_name, fid_best_iqviapbm.iqvia_pbm) ALL NODES;

CREATE PROJECTION sandbox.amb4_iqvia_payer_b0 /*+basename(amb4_iqvia_payer),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb4_iqvia_payer.ftf_health_plan_fid,
        amb4_iqvia_payer.ftf_health_plan_name,
        amb4_iqvia_payer.ftf_provider_fid,
        amb4_iqvia_payer.ftf_provider_name,
        amb4_iqvia_payer.ftf_parent_name,
        amb4_iqvia_payer.paytype_index,
        amb4_iqvia_payer.paytype,
        amb4_iqvia_payer.ftf_health_plan_type,
        amb4_iqvia_payer.pref_brand_tier,
        amb4_iqvia_payer.fillIn_blank_iqpayer,
        amb4_iqvia_payer.fillIn_blank_iqpbm,
        amb4_iqvia_payer.ftf_match_iqvia,
        amb4_iqvia_payer.iqvia_payer_name,
        amb4_iqvia_payer.iqvia_pbm,
        amb4_iqvia_payer.ftf_formulary_management_pbm,
        amb4_iqvia_payer.ftf_formulary_influencer_pbm,
        amb4_iqvia_payer.ftf_claims_processing_pbm,
        amb4_iqvia_payer.lives_mn,
        amb4_iqvia_payer.cycle_id,
        amb4_iqvia_payer.modified_time,
        amb4_iqvia_payer.modified_by
 FROM sandbox.amb4_iqvia_payer
 ORDER BY amb4_iqvia_payer.ftf_health_plan_fid,
          amb4_iqvia_payer.ftf_health_plan_name,
          amb4_iqvia_payer.ftf_provider_fid,
          amb4_iqvia_payer.ftf_provider_name,
          amb4_iqvia_payer.ftf_parent_name,
          amb4_iqvia_payer.paytype_index,
          amb4_iqvia_payer.paytype,
          amb4_iqvia_payer.ftf_health_plan_type,
          amb4_iqvia_payer.pref_brand_tier,
          amb4_iqvia_payer.fillIn_blank_iqpayer,
          amb4_iqvia_payer.fillIn_blank_iqpbm,
          amb4_iqvia_payer.ftf_match_iqvia,
          amb4_iqvia_payer.iqvia_payer_name,
          amb4_iqvia_payer.iqvia_pbm,
          amb4_iqvia_payer.ftf_formulary_management_pbm,
          amb4_iqvia_payer.ftf_formulary_influencer_pbm,
          amb4_iqvia_payer.ftf_claims_processing_pbm,
          amb4_iqvia_payer.lives_mn
SEGMENTED BY hash(amb4_iqvia_payer.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.amb4_iqvia_pbm_b0 /*+basename(amb4_iqvia_pbm),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb4_iqvia_pbm.ftf_health_plan_fid,
        amb4_iqvia_pbm.ftf_health_plan_name,
        amb4_iqvia_pbm.ftf_provider_fid,
        amb4_iqvia_pbm.ftf_provider_name,
        amb4_iqvia_pbm.ftf_parent_name,
        amb4_iqvia_pbm.paytype_index,
        amb4_iqvia_pbm.paytype,
        amb4_iqvia_pbm.ftf_health_plan_type,
        amb4_iqvia_pbm.pref_brand_tier,
        amb4_iqvia_pbm.fillIn_blank_iqpayer,
        amb4_iqvia_pbm.fillIn_blank_iqpbm,
        amb4_iqvia_pbm.ftf_match_iqvia,
        amb4_iqvia_pbm.iqvia_payer_name,
        amb4_iqvia_pbm.iqvia_pbm,
        amb4_iqvia_pbm.ftf_formulary_management_pbm,
        amb4_iqvia_pbm.ftf_formulary_influencer_pbm,
        amb4_iqvia_pbm.ftf_claims_processing_pbm,
        amb4_iqvia_pbm.lives_mn,
        amb4_iqvia_pbm.cycle_id,
        amb4_iqvia_pbm.modified_time,
        amb4_iqvia_pbm.modified_by
 FROM sandbox.amb4_iqvia_pbm
 ORDER BY amb4_iqvia_pbm.ftf_health_plan_fid,
          amb4_iqvia_pbm.ftf_health_plan_name,
          amb4_iqvia_pbm.ftf_provider_fid,
          amb4_iqvia_pbm.ftf_provider_name,
          amb4_iqvia_pbm.ftf_parent_name,
          amb4_iqvia_pbm.paytype_index,
          amb4_iqvia_pbm.paytype,
          amb4_iqvia_pbm.ftf_health_plan_type,
          amb4_iqvia_pbm.pref_brand_tier,
          amb4_iqvia_pbm.fillIn_blank_iqpayer,
          amb4_iqvia_pbm.fillIn_blank_iqpbm,
          amb4_iqvia_pbm.ftf_match_iqvia,
          amb4_iqvia_pbm.iqvia_payer_name,
          amb4_iqvia_pbm.iqvia_pbm,
          amb4_iqvia_pbm.ftf_formulary_management_pbm,
          amb4_iqvia_pbm.ftf_formulary_influencer_pbm,
          amb4_iqvia_pbm.ftf_claims_processing_pbm,
          amb4_iqvia_pbm.lives_mn
SEGMENTED BY hash(amb4_iqvia_pbm.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.amb7_b0 /*+basename(amb7),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb7.ftf_health_plan_fid,
        amb7.ftf_health_plan_name,
        amb7.ftf_provider_fid,
        amb7.ftf_provider_name,
        amb7.ftf_parent_name,
        amb7.paytype_index,
        amb7.paytype,
        amb7.ftf_health_plan_type,
        amb7.pref_brand_tier,
        amb7.fillIn_blank_iqpayer,
        amb7.fillIn_blank_iqpbm,
        amb7.ftf_match_iqvia,
        amb7.iqvia_payer_name,
        amb7.iqvia_pbm,
        amb7.ftf_formulary_management_pbm,
        amb7.ftf_formulary_influencer_pbm,
        amb7.ftf_claims_processing_pbm,
        amb7.lives_mn,
        amb7.calculated_pbm_value,
        amb7.key_pbm,
        amb7.cycle_id,
        amb7.modified_time,
        amb7.modified_by
 FROM sandbox.amb7
 ORDER BY amb7.ftf_health_plan_fid,
          amb7.ftf_health_plan_name,
          amb7.ftf_provider_fid,
          amb7.ftf_provider_name,
          amb7.ftf_parent_name,
          amb7.paytype_index,
          amb7.paytype,
          amb7.ftf_health_plan_type,
          amb7.pref_brand_tier,
          amb7.fillIn_blank_iqpayer,
          amb7.fillIn_blank_iqpbm,
          amb7.ftf_match_iqvia,
          amb7.iqvia_payer_name,
          amb7.iqvia_pbm,
          amb7.ftf_formulary_management_pbm,
          amb7.ftf_formulary_influencer_pbm,
          amb7.ftf_claims_processing_pbm,
          amb7.lives_mn
SEGMENTED BY hash(amb7.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_hpid_keypbm_b0 /*+basename(ftf_hpid_keypbm),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 paytype,
 iqvia_pbm,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hpid_keypbm.ftf_health_plan_fid,
        ftf_hpid_keypbm.ftf_health_plan_name,
        ftf_hpid_keypbm.ftf_provider_name,
        ftf_hpid_keypbm.paytype,
        ftf_hpid_keypbm.iqvia_pbm,
        ftf_hpid_keypbm.key_pbm,
        ftf_hpid_keypbm.cycle_id,
        ftf_hpid_keypbm.modified_time,
        ftf_hpid_keypbm.modified_by
 FROM sandbox.ftf_hpid_keypbm
 ORDER BY ftf_hpid_keypbm.ftf_health_plan_fid,
          ftf_hpid_keypbm.ftf_health_plan_name,
          ftf_hpid_keypbm.ftf_provider_name,
          ftf_hpid_keypbm.paytype,
          ftf_hpid_keypbm.iqvia_pbm,
          ftf_hpid_keypbm.key_pbm
SEGMENTED BY hash(ftf_hpid_keypbm.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.formulary_derivation_config_v1_b0 /*+basename(formulary_derivation_config_v1),createtype(L)*/ 
(
 pharmacy_status_regex,
 has_pa_regex,
 has_st_regex,
 formulary,
 tier_regex,
 pref_brand_tier_regex,
 ftf_health_plan_type_regex,
 file_id,
 record_id
)
AS
 SELECT formulary_derivation_config_v1.pharmacy_status_regex,
        formulary_derivation_config_v1.has_pa_regex,
        formulary_derivation_config_v1.has_st_regex,
        formulary_derivation_config_v1.formulary,
        formulary_derivation_config_v1.tier_regex,
        formulary_derivation_config_v1.pref_brand_tier_regex,
        formulary_derivation_config_v1.ftf_health_plan_type_regex,
        formulary_derivation_config_v1.file_id,
        formulary_derivation_config_v1.record_id
 FROM sandbox.formulary_derivation_config_v1
 ORDER BY formulary_derivation_config_v1.pharmacy_status_regex,
          formulary_derivation_config_v1.has_pa_regex,
          formulary_derivation_config_v1.has_st_regex,
          formulary_derivation_config_v1.formulary,
          formulary_derivation_config_v1.tier_regex,
          formulary_derivation_config_v1.pref_brand_tier_regex,
          formulary_derivation_config_v1.ftf_health_plan_type_regex,
          formulary_derivation_config_v1.file_id
SEGMENTED BY hash(formulary_derivation_config_v1.file_id, formulary_derivation_config_v1.record_id, formulary_derivation_config_v1.pharmacy_status_regex, formulary_derivation_config_v1.has_pa_regex, formulary_derivation_config_v1.has_st_regex, formulary_derivation_config_v1.formulary, formulary_derivation_config_v1.tier_regex, formulary_derivation_config_v1.pref_brand_tier_regex) ALL NODES;

CREATE PROJECTION sandbox.mb_may_v3_b0 /*+basename(mb_may_v3),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 coverage_category_for_ajovy,
 coverage_category_for_aimovig,
 coverage_category_for_emgality,
 ftfproviderfid,
 ftf_provider_name,
 ftf_parent_name,
 paytypeindex,
 pay_type,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 ftf_match_iqvia,
 lives_mx,
 cycle_id
)
AS
 SELECT mb_may_v3.ftf_health_plan_fid,
        mb_may_v3.ftf_health_plan_name,
        mb_may_v3.coverage_category_for_ajovy,
        mb_may_v3.coverage_category_for_aimovig,
        mb_may_v3.coverage_category_for_emgality,
        mb_may_v3.ftfproviderfid,
        mb_may_v3.ftf_provider_name,
        mb_may_v3.ftf_parent_name,
        mb_may_v3.paytypeindex,
        mb_may_v3.pay_type,
        mb_may_v3.ftf_health_plan_type,
        mb_may_v3.key_controlling_plan_formulary,
        mb_may_v3.key_controlling_account,
        mb_may_v3.key_controlling_parent,
        mb_may_v3.payer_pbm,
        mb_may_v3.key_pbm,
        mb_may_v3.iqvia_payer_name,
        mb_may_v3.iqvia_pbm,
        mb_may_v3.ftf_formulary_management_pbm,
        mb_may_v3.ftf_formulary_influencer_pbm,
        mb_may_v3.ftf_claims_processing_pbm,
        mb_may_v3.pref_brand_tier,
        mb_may_v3.ftf_match_iqvia,
        mb_may_v3.lives_mx,
        mb_may_v3.cycle_id
 FROM sandbox.mb_may_v3
 ORDER BY mb_may_v3.ftf_health_plan_fid,
          mb_may_v3.ftf_health_plan_name,
          mb_may_v3.coverage_category_for_ajovy,
          mb_may_v3.coverage_category_for_aimovig,
          mb_may_v3.coverage_category_for_emgality,
          mb_may_v3.ftfproviderfid,
          mb_may_v3.ftf_provider_name,
          mb_may_v3.ftf_parent_name
SEGMENTED BY hash(mb_may_v3.pref_brand_tier, mb_may_v3.ftf_match_iqvia, mb_may_v3.lives_mx, mb_may_v3.cycle_id, mb_may_v3.ftf_health_plan_fid, mb_may_v3.ftf_health_plan_name, mb_may_v3.coverage_category_for_ajovy, mb_may_v3.coverage_category_for_aimovig) ALL NODES;

CREATE PROJECTION sandbox.amb4_b0 /*+basename(amb4),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 old_coverage_category_ajovy,
 old_coverage_category_aimovig,
 old_coverage_category_emgality,
 old_ftf_provider_fid,
 old_ftf_provider_name,
 old_ftf_parent_name,
 old_paytype_index,
 old_paytype,
 old_ftf_health_plan_type,
 old_pref_brand_tier,
 old_key_controlling_plan_formulary,
 old_key_controlling_account,
 old_key_pbm,
 old_payer_pbm,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 old_iqvia_payer_name,
 old_iqvia_pbm,
 old_ftf_formulary_management_pbm,
 old_ftf_formulary_influencer_pbm,
 old_ftf_claims_processing_pbm,
 lives_mx,
 new_ftf_health_plan_fid,
 old_ftf_health_plan_fid,
 new_ftf_health_plan_name,
 old_ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm
)
AS
 SELECT amb4.ftf_health_plan_fid,
        amb4.ftf_health_plan_name,
        amb4.old_coverage_category_ajovy,
        amb4.old_coverage_category_aimovig,
        amb4.old_coverage_category_emgality,
        amb4.old_ftf_provider_fid,
        amb4.old_ftf_provider_name,
        amb4.old_ftf_parent_name,
        amb4.old_paytype_index,
        amb4.old_paytype,
        amb4.old_ftf_health_plan_type,
        amb4.old_pref_brand_tier,
        amb4.old_key_controlling_plan_formulary,
        amb4.old_key_controlling_account,
        amb4.old_key_pbm,
        amb4.old_payer_pbm,
        amb4.fillIn_blank_iqpayer,
        amb4.fillIn_blank_iqpbm,
        amb4.ftf_match_iqvia,
        amb4.old_iqvia_payer_name,
        amb4.old_iqvia_pbm,
        amb4.old_ftf_formulary_management_pbm,
        amb4.old_ftf_formulary_influencer_pbm,
        amb4.old_ftf_claims_processing_pbm,
        amb4.lives_mx,
        amb4.new_ftf_health_plan_fid,
        amb4.old_ftf_health_plan_fid,
        amb4.new_ftf_health_plan_name,
        amb4.old_ftf_health_plan_name,
        amb4.ftf_provider_fid,
        amb4.ftf_provider_name,
        amb4.ftf_parent_name,
        amb4.paytype_index,
        amb4.paytype,
        amb4.ftf_health_plan_type,
        amb4.pref_brand_tier,
        amb4.lives_mn,
        amb4.iqvia_payer_name,
        amb4.iqvia_pbm,
        amb4.ftf_formulary_management_pbm,
        amb4.ftf_formulary_influencer_pbm,
        amb4.ftf_claims_processing_pbm
 FROM sandbox.amb4
 ORDER BY amb4.ftf_health_plan_fid,
          amb4.ftf_health_plan_name,
          amb4.old_coverage_category_ajovy,
          amb4.old_coverage_category_aimovig,
          amb4.old_coverage_category_emgality,
          amb4.old_ftf_provider_fid,
          amb4.old_ftf_provider_name,
          amb4.old_ftf_parent_name
SEGMENTED BY hash(amb4.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.step_restriction_description_v1_b0 /*+basename(step_restriction_description_v1),createtype(L)*/ 
(
 step,
 description,
 file_id,
 record_id
)
AS
 SELECT step_restriction_description_v1.step,
        step_restriction_description_v1.description,
        step_restriction_description_v1.file_id,
        step_restriction_description_v1.record_id
 FROM sandbox.step_restriction_description_v1
 ORDER BY step_restriction_description_v1.step,
          step_restriction_description_v1.description,
          step_restriction_description_v1.file_id,
          step_restriction_description_v1.record_id
SEGMENTED BY hash(step_restriction_description_v1.step, step_restriction_description_v1.file_id, step_restriction_description_v1.record_id, step_restriction_description_v1.description) ALL NODES;

CREATE PROJECTION sandbox.pres_pa_restriction_description_v1_b0 /*+basename(pres_pa_restriction_description_v1),createtype(L)*/ 
(
 prespa,
 description,
 file_id,
 record_id
)
AS
 SELECT pres_pa_restriction_description_v1.prespa,
        pres_pa_restriction_description_v1.description,
        pres_pa_restriction_description_v1.file_id,
        pres_pa_restriction_description_v1.record_id
 FROM sandbox.pres_pa_restriction_description_v1
 ORDER BY pres_pa_restriction_description_v1.prespa,
          pres_pa_restriction_description_v1.description,
          pres_pa_restriction_description_v1.file_id,
          pres_pa_restriction_description_v1.record_id
SEGMENTED BY hash(pres_pa_restriction_description_v1.prespa, pres_pa_restriction_description_v1.file_id, pres_pa_restriction_description_v1.record_id, pres_pa_restriction_description_v1.description) ALL NODES;

CREATE PROJECTION sandbox.pat_pa_restriction_description_v1_b0 /*+basename(pat_pa_restriction_description_v1),createtype(L)*/ 
(
 patpa,
 description,
 file_id,
 record_id
)
AS
 SELECT pat_pa_restriction_description_v1.patpa,
        pat_pa_restriction_description_v1.description,
        pat_pa_restriction_description_v1.file_id,
        pat_pa_restriction_description_v1.record_id
 FROM sandbox.pat_pa_restriction_description_v1
 ORDER BY pat_pa_restriction_description_v1.patpa,
          pat_pa_restriction_description_v1.description,
          pat_pa_restriction_description_v1.file_id,
          pat_pa_restriction_description_v1.record_id
SEGMENTED BY hash(pat_pa_restriction_description_v1.patpa, pat_pa_restriction_description_v1.file_id, pat_pa_restriction_description_v1.record_id, pat_pa_restriction_description_v1.description) ALL NODES;

CREATE PROJECTION sandbox.plan_prod_master_v1_b0 /*+basename(plan_prod_master_v1),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 tier,
 has_pa,
 has_st,
 formulary,
 copay_tier,
 tier_cat,
 restcat,
 restriction_category,
 coverage_cat_code,
 coverage_category,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT plan_prod_master_v1.ftf_health_plan_fid,
        plan_prod_master_v1.ftf_health_plan_name,
        plan_prod_master_v1.ftf_provider_fid,
        plan_prod_master_v1.ftf_provider_name,
        plan_prod_master_v1.ftf_parent_name,
        plan_prod_master_v1.paytype_index,
        plan_prod_master_v1.paytype,
        plan_prod_master_v1.ftf_health_plan_type,
        plan_prod_master_v1.pref_brand_tier,
        plan_prod_master_v1.fillIn_blank_iqpayer,
        plan_prod_master_v1.fillIn_blank_iqpbm,
        plan_prod_master_v1.ftf_match_iqvia,
        plan_prod_master_v1.iqvia_payer_name,
        plan_prod_master_v1.iqvia_pbm,
        plan_prod_master_v1.ftf_formulary_management_pbm,
        plan_prod_master_v1.ftf_formulary_influencer_pbm,
        plan_prod_master_v1.ftf_claims_processing_pbm,
        plan_prod_master_v1.lives_mn,
        plan_prod_master_v1.calculated_pbm_value,
        plan_prod_master_v1.key_pbm,
        plan_prod_master_v1.drug_id,
        plan_prod_master_v1.drug_seq,
        plan_prod_master_v1.tier_code,
        plan_prod_master_v1.restrictions,
        plan_prod_master_v1.reason_code,
        plan_prod_master_v1.pharmacy_status,
        plan_prod_master_v1.botox,
        plan_prod_master_v1.step,
        plan_prod_master_v1.pres_pa,
        plan_prod_master_v1.pat_pa,
        plan_prod_master_v1.med_rec,
        plan_prod_master_v1.unspec,
        plan_prod_master_v1.tier,
        plan_prod_master_v1.has_pa,
        plan_prod_master_v1.has_st,
        plan_prod_master_v1.formulary,
        plan_prod_master_v1.copay_tier,
        plan_prod_master_v1.tier_cat,
        plan_prod_master_v1.restcat,
        plan_prod_master_v1.restriction_category,
        plan_prod_master_v1.coverage_cat_code,
        plan_prod_master_v1.coverage_category,
        plan_prod_master_v1.cycle_id,
        plan_prod_master_v1.modified_time,
        plan_prod_master_v1.modified_by
 FROM sandbox.plan_prod_master_v1
 ORDER BY plan_prod_master_v1.ftf_health_plan_fid,
          plan_prod_master_v1.drug_seq
SEGMENTED BY hash(plan_prod_master_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_plan_master_file_b0 /*+basename(ftf_plan_master_file),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 product,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 botox,
 botox_step_flag,
 step,
 step_category,
 pres_pa,
 prescriber_prior_authorization_category,
 pat_pa,
 med_rec,
 unspec,
 patient_prior_authorization_category,
 medical_records_submission_required_flag,
 unspecified_restriction_flag,
 FTF_Tier,
 has_pa,
 has_st,
 formulary,
 Copay_Tier,
 tier_cat,
 restcat,
 Restriction_Category,
 coverage_cat_code,
 Coverage_Category,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_plan_master_file.ftf_health_plan_fid,
        ftf_plan_master_file.ftf_health_plan_name,
        ftf_plan_master_file.ftf_provider_fid,
        ftf_plan_master_file.ftf_provider_name,
        ftf_plan_master_file.ftf_parent_name,
        ftf_plan_master_file.paytype_index,
        ftf_plan_master_file.paytype,
        ftf_plan_master_file.ftf_health_plan_type,
        ftf_plan_master_file.pref_brand_tier,
        ftf_plan_master_file.fillIn_blank_iqpayer,
        ftf_plan_master_file.fillIn_blank_iqpbm,
        ftf_plan_master_file.ftf_match_iqvia,
        ftf_plan_master_file.iqvia_payer_name,
        ftf_plan_master_file.iqvia_pbm,
        ftf_plan_master_file.ftf_formulary_management_pbm,
        ftf_plan_master_file.ftf_formulary_influencer_pbm,
        ftf_plan_master_file.ftf_claims_processing_pbm,
        ftf_plan_master_file.lives_mn,
        ftf_plan_master_file.calculated_pbm_value,
        ftf_plan_master_file.key_pbm,
        ftf_plan_master_file.drug_id,
        ftf_plan_master_file.drug_seq,
        ftf_plan_master_file.product,
        ftf_plan_master_file.tier_code,
        ftf_plan_master_file.restrictions,
        ftf_plan_master_file.reason_code,
        ftf_plan_master_file.pharmacy_status,
        ftf_plan_master_file.botox,
        ftf_plan_master_file.botox_step_flag,
        ftf_plan_master_file.step,
        ftf_plan_master_file.step_category,
        ftf_plan_master_file.pres_pa,
        ftf_plan_master_file.prescriber_prior_authorization_category,
        ftf_plan_master_file.pat_pa,
        ftf_plan_master_file.med_rec,
        ftf_plan_master_file.unspec,
        ftf_plan_master_file.patient_prior_authorization_category,
        ftf_plan_master_file.medical_records_submission_required_flag,
        ftf_plan_master_file.unspecified_restriction_flag,
        ftf_plan_master_file.FTF_Tier,
        ftf_plan_master_file.has_pa,
        ftf_plan_master_file.has_st,
        ftf_plan_master_file.formulary,
        ftf_plan_master_file.Copay_Tier,
        ftf_plan_master_file.tier_cat,
        ftf_plan_master_file.restcat,
        ftf_plan_master_file.Restriction_Category,
        ftf_plan_master_file.coverage_cat_code,
        ftf_plan_master_file.Coverage_Category,
        ftf_plan_master_file.key_controlling_account,
        ftf_plan_master_file.key_controlling_plan_formulary,
        ftf_plan_master_file.key_controlling_parent,
        ftf_plan_master_file.payer_pbm,
        ftf_plan_master_file.cycle_id,
        ftf_plan_master_file.modified_time,
        ftf_plan_master_file.modified_by
 FROM sandbox.ftf_plan_master_file
 ORDER BY ftf_plan_master_file.ftf_health_plan_fid,
          ftf_plan_master_file.ftf_health_plan_name,
          ftf_plan_master_file.ftf_provider_fid,
          ftf_plan_master_file.ftf_provider_name,
          ftf_plan_master_file.ftf_parent_name,
          ftf_plan_master_file.paytype_index,
          ftf_plan_master_file.paytype,
          ftf_plan_master_file.ftf_health_plan_type,
          ftf_plan_master_file.pref_brand_tier,
          ftf_plan_master_file.fillIn_blank_iqpayer,
          ftf_plan_master_file.fillIn_blank_iqpbm,
          ftf_plan_master_file.ftf_match_iqvia,
          ftf_plan_master_file.iqvia_payer_name,
          ftf_plan_master_file.iqvia_pbm,
          ftf_plan_master_file.ftf_formulary_management_pbm,
          ftf_plan_master_file.ftf_formulary_influencer_pbm,
          ftf_plan_master_file.ftf_claims_processing_pbm,
          ftf_plan_master_file.lives_mn,
          ftf_plan_master_file.calculated_pbm_value,
          ftf_plan_master_file.key_pbm,
          ftf_plan_master_file.drug_id,
          ftf_plan_master_file.drug_seq,
          ftf_plan_master_file.product,
          ftf_plan_master_file.tier_code,
          ftf_plan_master_file.restrictions,
          ftf_plan_master_file.reason_code,
          ftf_plan_master_file.pharmacy_status,
          ftf_plan_master_file.botox,
          ftf_plan_master_file.botox_step_flag,
          ftf_plan_master_file.step,
          ftf_plan_master_file.step_category,
          ftf_plan_master_file.pres_pa,
          ftf_plan_master_file.prescriber_prior_authorization_category,
          ftf_plan_master_file.pat_pa,
          ftf_plan_master_file.med_rec,
          ftf_plan_master_file.unspec,
          ftf_plan_master_file.patient_prior_authorization_category,
          ftf_plan_master_file.medical_records_submission_required_flag,
          ftf_plan_master_file.unspecified_restriction_flag,
          ftf_plan_master_file.FTF_Tier,
          ftf_plan_master_file.has_pa,
          ftf_plan_master_file.has_st,
          ftf_plan_master_file.formulary,
          ftf_plan_master_file.Copay_Tier,
          ftf_plan_master_file.tier_cat,
          ftf_plan_master_file.restcat,
          ftf_plan_master_file.Restriction_Category,
          ftf_plan_master_file.coverage_cat_code,
          ftf_plan_master_file.Coverage_Category,
          ftf_plan_master_file.key_controlling_account,
          ftf_plan_master_file.key_controlling_plan_formulary,
          ftf_plan_master_file.key_controlling_parent,
          ftf_plan_master_file.payer_pbm,
          ftf_plan_master_file.cycle_id,
          ftf_plan_master_file.modified_time,
          ftf_plan_master_file.modified_by
SEGMENTED BY hash(ftf_plan_master_file.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_override_plan_v1_b0 /*+basename(ftf_override_plan_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 paytype_index,
 notes,
 file_id,
 record_id
)
AS
 SELECT ftf_override_plan_v1.ftf_health_plan_fid,
        ftf_override_plan_v1.paytype_index,
        ftf_override_plan_v1.notes,
        ftf_override_plan_v1.file_id,
        ftf_override_plan_v1.record_id
 FROM sandbox.ftf_override_plan_v1
 ORDER BY ftf_override_plan_v1.ftf_health_plan_fid,
          ftf_override_plan_v1.paytype_index,
          ftf_override_plan_v1.notes,
          ftf_override_plan_v1.file_id,
          ftf_override_plan_v1.record_id
SEGMENTED BY hash(ftf_override_plan_v1.ftf_health_plan_fid, ftf_override_plan_v1.paytype_index, ftf_override_plan_v1.file_id, ftf_override_plan_v1.record_id, ftf_override_plan_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.ftf_override_provider_v1_b0 /*+basename(ftf_override_provider_v1),createtype(L)*/ 
(
 ftf_provider_fid,
 paytype_index,
 notes,
 file_id,
 record_id
)
AS
 SELECT ftf_override_provider_v1.ftf_provider_fid,
        ftf_override_provider_v1.paytype_index,
        ftf_override_provider_v1.notes,
        ftf_override_provider_v1.file_id,
        ftf_override_provider_v1.record_id
 FROM sandbox.ftf_override_provider_v1
 ORDER BY ftf_override_provider_v1.ftf_provider_fid,
          ftf_override_provider_v1.paytype_index,
          ftf_override_provider_v1.notes,
          ftf_override_provider_v1.file_id,
          ftf_override_provider_v1.record_id
SEGMENTED BY hash(ftf_override_provider_v1.ftf_provider_fid, ftf_override_provider_v1.paytype_index, ftf_override_provider_v1.file_id, ftf_override_provider_v1.record_id, ftf_override_provider_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.ftf_paytype_paytypeindex_v1_b0 /*+basename(ftf_paytype_paytypeindex_v1),createtype(L)*/ 
(
 paytype_index,
 paytype,
 file_id,
 record_id
)
AS
 SELECT ftf_paytype_paytypeindex_v1.paytype_index,
        ftf_paytype_paytypeindex_v1.paytype,
        ftf_paytype_paytypeindex_v1.file_id,
        ftf_paytype_paytypeindex_v1.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v1
 ORDER BY ftf_paytype_paytypeindex_v1.paytype_index,
          ftf_paytype_paytypeindex_v1.paytype,
          ftf_paytype_paytypeindex_v1.file_id,
          ftf_paytype_paytypeindex_v1.record_id
SEGMENTED BY hash(ftf_paytype_paytypeindex_v1.paytype_index, ftf_paytype_paytypeindex_v1.file_id, ftf_paytype_paytypeindex_v1.record_id, ftf_paytype_paytypeindex_v1.paytype) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_xref_b0 /*+basename(ftf_iqvia_xref),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 xref_iqvia_payer_name,
 best_matched_iqvia_payer_name,
 xref_iqvia_pbm,
 best_matched_iqvia_pbm,
 paytype,
 model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 ftf_pref_brand_tier,
 total_lives_for_ftf_plan,
 key_pbm,
 check_iq_payer,
 check_iq_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_iqvia_xref.iqvia_plan_code,
        ftf_iqvia_xref.iqvia_plan_name,
        ftf_iqvia_xref.xref_iqvia_payer_name,
        ftf_iqvia_xref.best_matched_iqvia_payer_name,
        ftf_iqvia_xref.xref_iqvia_pbm,
        ftf_iqvia_xref.best_matched_iqvia_pbm,
        ftf_iqvia_xref.paytype,
        ftf_iqvia_xref.model,
        ftf_iqvia_xref.ftf_health_plan_fid,
        ftf_iqvia_xref.ftf_health_plan_name,
        ftf_iqvia_xref.ftf_health_plan_type,
        ftf_iqvia_xref.ftf_provider_fid,
        ftf_iqvia_xref.ftf_provider_name,
        ftf_iqvia_xref.ftf_parent_name,
        ftf_iqvia_xref.key_controlling_plan_formulary,
        ftf_iqvia_xref.key_controlling_account,
        ftf_iqvia_xref.key_controlling_parent,
        ftf_iqvia_xref.payer_pbm,
        ftf_iqvia_xref.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref.emgality_access_for_ftf_plan,
        ftf_iqvia_xref.ftf_pref_brand_tier,
        ftf_iqvia_xref.total_lives_for_ftf_plan,
        ftf_iqvia_xref.key_pbm,
        ftf_iqvia_xref.check_iq_payer,
        ftf_iqvia_xref.check_iq_pbm,
        ftf_iqvia_xref.cycle_id,
        ftf_iqvia_xref.modified_time,
        ftf_iqvia_xref.modified_by
 FROM sandbox.ftf_iqvia_xref
 ORDER BY ftf_iqvia_xref.ftf_health_plan_fid,
          ftf_iqvia_xref.ftf_health_plan_name,
          ftf_iqvia_xref.ftf_provider_fid,
          ftf_iqvia_xref.ftf_provider_name,
          ftf_iqvia_xref.ftf_parent_name,
          ftf_iqvia_xref.paytype,
          ftf_iqvia_xref.ftf_health_plan_type
SEGMENTED BY hash(ftf_iqvia_xref.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_xref_v2_b0 /*+basename(ftf_iqvia_xref_v2),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 ftf_pref_brand_tier,
 total_lives_for_ftf_plan,
 key_pbm,
 check_iq_payer,
 check_iq_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_iqvia_xref_v2.iqvia_plan_code,
        ftf_iqvia_xref_v2.iqvia_plan_name,
        ftf_iqvia_xref_v2.iqvia_payer_name,
        ftf_iqvia_xref_v2.iqvia_pbm,
        ftf_iqvia_xref_v2.payment_type,
        ftf_iqvia_xref_v2.iqvia_model,
        ftf_iqvia_xref_v2.ftf_health_plan_fid,
        ftf_iqvia_xref_v2.ftf_health_plan_name,
        ftf_iqvia_xref_v2.ftf_health_plan_type,
        ftf_iqvia_xref_v2.ftf_provider_fid,
        ftf_iqvia_xref_v2.ftf_provider_name,
        ftf_iqvia_xref_v2.ftf_parent_name,
        ftf_iqvia_xref_v2.key_controlling_plan_formulary,
        ftf_iqvia_xref_v2.key_controlling_account,
        ftf_iqvia_xref_v2.key_controlling_parent,
        ftf_iqvia_xref_v2.payer_pbm,
        ftf_iqvia_xref_v2.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_v2.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_v2.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_v2.ftf_pref_brand_tier,
        ftf_iqvia_xref_v2.total_lives_for_ftf_plan,
        ftf_iqvia_xref_v2.key_pbm,
        ftf_iqvia_xref_v2.check_iq_payer,
        ftf_iqvia_xref_v2.check_iq_pbm,
        ftf_iqvia_xref_v2.cycle_id,
        ftf_iqvia_xref_v2.modified_time,
        ftf_iqvia_xref_v2.modified_by
 FROM sandbox.ftf_iqvia_xref_v2
 ORDER BY ftf_iqvia_xref_v2.ftf_health_plan_fid,
          ftf_iqvia_xref_v2.ftf_health_plan_name,
          ftf_iqvia_xref_v2.ftf_provider_fid,
          ftf_iqvia_xref_v2.ftf_provider_name,
          ftf_iqvia_xref_v2.ftf_parent_name,
          ftf_iqvia_xref_v2.payment_type,
          ftf_iqvia_xref_v2.ftf_health_plan_type
SEGMENTED BY hash(ftf_iqvia_xref_v2.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.tt1_b0 /*+basename(tt1),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_payment_type,
 change_iqvia_model,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_health_plan_type,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_total_lives_for_ftf_plan,
 change_key_pbm,
 change,
 check_iq_payer,
 check_iq_pbm,
 month_flag,
 status
)
AS
 SELECT tt1.iqvia_plan_code,
        tt1.iqvia_plan_name,
        tt1.ftf_health_plan_fid,
        tt1.ftf_health_plan_name,
        tt1.iqvia_payer_name,
        tt1.iqvia_pbm,
        tt1.payment_type,
        tt1.iqvia_model,
        tt1.ftf_health_plan_type,
        tt1.key_controlling_plan_formulary,
        tt1.key_controlling_account,
        tt1.key_controlling_parent,
        tt1.payer_pbm,
        tt1.ajovy_access_for_ftf_plan,
        tt1.aimovig_access_for_ftf_plan,
        tt1.emgality_access_for_ftf_plan,
        tt1.total_lives_for_ftf_plan,
        tt1.key_pbm,
        tt1.change_iqvia_plan_code,
        tt1.change_iqvia_plan_name,
        tt1.change_iqvia_payer_name,
        tt1.change_iqvia_pbm,
        tt1.change_payment_type,
        tt1.change_iqvia_model,
        tt1.change_ftf_health_plan_fid,
        tt1.change_ftf_health_plan_name,
        tt1.change_ftf_health_plan_type,
        tt1.change_key_controlling_plan_formulary,
        tt1.change_key_controlling_account,
        tt1.change_key_controlling_parent,
        tt1.change_payer_pbm,
        tt1.change_ajovy_access_for_ftf_plan,
        tt1.change_aimovig_access_for_ftf_plan,
        tt1.change_emgality_access_for_ftf_plan,
        tt1.change_total_lives_for_ftf_plan,
        tt1.change_key_pbm,
        tt1.change,
        tt1.check_iq_payer,
        tt1.check_iq_pbm,
        tt1.month_flag,
        tt1.status
 FROM sandbox.tt1
 ORDER BY tt1.iqvia_plan_code,
          tt1.iqvia_plan_name,
          tt1.ftf_health_plan_fid,
          tt1.ftf_health_plan_name,
          tt1.iqvia_payer_name,
          tt1.iqvia_pbm,
          tt1.payment_type,
          tt1.iqvia_model
SEGMENTED BY hash(tt1.total_lives_for_ftf_plan, tt1.change_iqvia_plan_code, tt1.change_iqvia_plan_name, tt1.change_iqvia_payer_name, tt1.change_iqvia_pbm, tt1.change_payment_type, tt1.change_iqvia_model, tt1.change_ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.tt2_b0 /*+basename(tt2),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_payment_type,
 change_iqvia_model,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_health_plan_type,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_total_lives_for_ftf_plan,
 change_key_pbm,
 change,
 check_iq_payer,
 check_iq_pbm,
 month_flag,
 status
)
AS
 SELECT tt2.iqvia_plan_code,
        tt2.iqvia_plan_name,
        tt2.ftf_health_plan_fid,
        tt2.ftf_health_plan_name,
        tt2.iqvia_payer_name,
        tt2.iqvia_pbm,
        tt2.payment_type,
        tt2.iqvia_model,
        tt2.ftf_health_plan_type,
        tt2.key_controlling_plan_formulary,
        tt2.key_controlling_account,
        tt2.key_controlling_parent,
        tt2.payer_pbm,
        tt2.ajovy_access_for_ftf_plan,
        tt2.aimovig_access_for_ftf_plan,
        tt2.emgality_access_for_ftf_plan,
        tt2.total_lives_for_ftf_plan,
        tt2.key_pbm,
        tt2.change_iqvia_plan_code,
        tt2.change_iqvia_plan_name,
        tt2.change_iqvia_payer_name,
        tt2.change_iqvia_pbm,
        tt2.change_payment_type,
        tt2.change_iqvia_model,
        tt2.change_ftf_health_plan_fid,
        tt2.change_ftf_health_plan_name,
        tt2.change_ftf_health_plan_type,
        tt2.change_key_controlling_plan_formulary,
        tt2.change_key_controlling_account,
        tt2.change_key_controlling_parent,
        tt2.change_payer_pbm,
        tt2.change_ajovy_access_for_ftf_plan,
        tt2.change_aimovig_access_for_ftf_plan,
        tt2.change_emgality_access_for_ftf_plan,
        tt2.change_total_lives_for_ftf_plan,
        tt2.change_key_pbm,
        tt2.change,
        tt2.check_iq_payer,
        tt2.check_iq_pbm,
        tt2.month_flag,
        tt2.status
 FROM sandbox.tt2
 ORDER BY tt2.iqvia_plan_code,
          tt2.iqvia_plan_name,
          tt2.ftf_health_plan_fid,
          tt2.ftf_health_plan_name,
          tt2.iqvia_payer_name,
          tt2.iqvia_pbm,
          tt2.payment_type,
          tt2.iqvia_model
SEGMENTED BY hash(tt2.total_lives_for_ftf_plan, tt2.change_iqvia_plan_code, tt2.change_iqvia_plan_name, tt2.change_iqvia_payer_name, tt2.change_iqvia_pbm, tt2.change_payment_type, tt2.change_iqvia_model, tt2.change_ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.tt3_b0 /*+basename(tt3),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_payment_type,
 change_iqvia_model,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_health_plan_type,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_total_lives_for_ftf_plan,
 change_key_pbm,
 change,
 check_iq_payer,
 check_iq_pbm,
 month_flag,
 status,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT tt3.iqvia_plan_code,
        tt3.iqvia_plan_name,
        tt3.ftf_health_plan_fid,
        tt3.ftf_health_plan_name,
        tt3.iqvia_payer_name,
        tt3.iqvia_pbm,
        tt3.payment_type,
        tt3.iqvia_model,
        tt3.ftf_health_plan_type,
        tt3.key_controlling_plan_formulary,
        tt3.key_controlling_account,
        tt3.key_controlling_parent,
        tt3.payer_pbm,
        tt3.ajovy_access_for_ftf_plan,
        tt3.aimovig_access_for_ftf_plan,
        tt3.emgality_access_for_ftf_plan,
        tt3.total_lives_for_ftf_plan,
        tt3.key_pbm,
        tt3.change_iqvia_plan_code,
        tt3.change_iqvia_plan_name,
        tt3.change_iqvia_payer_name,
        tt3.change_iqvia_pbm,
        tt3.change_payment_type,
        tt3.change_iqvia_model,
        tt3.change_ftf_health_plan_fid,
        tt3.change_ftf_health_plan_name,
        tt3.change_ftf_health_plan_type,
        tt3.change_key_controlling_plan_formulary,
        tt3.change_key_controlling_account,
        tt3.change_key_controlling_parent,
        tt3.change_payer_pbm,
        tt3.change_ajovy_access_for_ftf_plan,
        tt3.change_aimovig_access_for_ftf_plan,
        tt3.change_emgality_access_for_ftf_plan,
        tt3.change_total_lives_for_ftf_plan,
        tt3.change_key_pbm,
        tt3.change,
        tt3.check_iq_payer,
        tt3.check_iq_pbm,
        tt3.month_flag,
        tt3.status,
        tt3.cycle_id,
        tt3.modified_time,
        tt3.modified_by
 FROM sandbox.tt3
 ORDER BY tt3.iqvia_plan_code,
          tt3.iqvia_plan_name,
          tt3.ftf_health_plan_fid,
          tt3.ftf_health_plan_name,
          tt3.iqvia_payer_name,
          tt3.iqvia_pbm,
          tt3.payment_type,
          tt3.iqvia_model,
          tt3.ftf_health_plan_type,
          tt3.key_controlling_plan_formulary,
          tt3.key_controlling_account,
          tt3.key_controlling_parent,
          tt3.payer_pbm,
          tt3.ajovy_access_for_ftf_plan,
          tt3.aimovig_access_for_ftf_plan,
          tt3.emgality_access_for_ftf_plan,
          tt3.total_lives_for_ftf_plan,
          tt3.key_pbm,
          tt3.change_iqvia_plan_code,
          tt3.change_iqvia_plan_name,
          tt3.change_iqvia_payer_name,
          tt3.change_iqvia_pbm,
          tt3.change_payment_type,
          tt3.change_iqvia_model,
          tt3.change_ftf_health_plan_fid,
          tt3.change_ftf_health_plan_name,
          tt3.change_ftf_health_plan_type,
          tt3.change_key_controlling_plan_formulary,
          tt3.change_key_controlling_account,
          tt3.change_key_controlling_parent,
          tt3.change_payer_pbm,
          tt3.change_ajovy_access_for_ftf_plan,
          tt3.change_aimovig_access_for_ftf_plan,
          tt3.change_emgality_access_for_ftf_plan,
          tt3.change_total_lives_for_ftf_plan,
          tt3.change_key_pbm,
          tt3.change,
          tt3.check_iq_payer,
          tt3.check_iq_pbm,
          tt3.month_flag,
          tt3.status
SEGMENTED BY hash(tt3.total_lives_for_ftf_plan, tt3.change_iqvia_plan_code, tt3.change_iqvia_plan_name, tt3.change_iqvia_payer_name, tt3.change_iqvia_pbm, tt3.change_payment_type, tt3.change_iqvia_model, tt3.change_ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.comparison_ftf_health_plan_fid_b0 /*+basename(comparison_ftf_health_plan_fid),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 pref_brand_tier,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_provider_fid,
 change_ftf_provider_name,
 change_ftf_parent_name,
 change_paytype,
 change_ftf_health_plan_type,
 change_key_controlling_account,
 change_key_controlling_plan_formulary,
 change_key_controlling_parent,
 change_payer_pbm,
 change_key_pbm,
 change_ftf_formulary_management_pbm,
 change_ftf_formulary_influencer_pbm,
 change_ftf_claims_processing_pbm,
 change_lives_mn,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_pref_brand_tier,
 change_Coverage_Category_Ajovy,
 change_Coverage_Category_Aimovig,
 change_Coverage_Category_Emgality,
 change,
 month_flag,
 status,
 change_in_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT comparison_ftf_health_plan_fid.ftf_health_plan_fid,
        comparison_ftf_health_plan_fid.ftf_health_plan_name,
        comparison_ftf_health_plan_fid.ftf_provider_fid,
        comparison_ftf_health_plan_fid.ftf_provider_name,
        comparison_ftf_health_plan_fid.ftf_parent_name,
        comparison_ftf_health_plan_fid.paytype,
        comparison_ftf_health_plan_fid.ftf_health_plan_type,
        comparison_ftf_health_plan_fid.key_controlling_account,
        comparison_ftf_health_plan_fid.key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid.key_controlling_parent,
        comparison_ftf_health_plan_fid.payer_pbm,
        comparison_ftf_health_plan_fid.key_pbm,
        comparison_ftf_health_plan_fid.ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid.ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid.ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid.lives_mn,
        comparison_ftf_health_plan_fid.iqvia_payer_name,
        comparison_ftf_health_plan_fid.iqvia_pbm,
        comparison_ftf_health_plan_fid.pref_brand_tier,
        comparison_ftf_health_plan_fid.Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid.Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid.Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid.change_ftf_health_plan_fid,
        comparison_ftf_health_plan_fid.change_ftf_health_plan_name,
        comparison_ftf_health_plan_fid.change_ftf_provider_fid,
        comparison_ftf_health_plan_fid.change_ftf_provider_name,
        comparison_ftf_health_plan_fid.change_ftf_parent_name,
        comparison_ftf_health_plan_fid.change_paytype,
        comparison_ftf_health_plan_fid.change_ftf_health_plan_type,
        comparison_ftf_health_plan_fid.change_key_controlling_account,
        comparison_ftf_health_plan_fid.change_key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid.change_key_controlling_parent,
        comparison_ftf_health_plan_fid.change_payer_pbm,
        comparison_ftf_health_plan_fid.change_key_pbm,
        comparison_ftf_health_plan_fid.change_ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid.change_ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid.change_ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid.change_lives_mn,
        comparison_ftf_health_plan_fid.change_iqvia_payer_name,
        comparison_ftf_health_plan_fid.change_iqvia_pbm,
        comparison_ftf_health_plan_fid.change_pref_brand_tier,
        comparison_ftf_health_plan_fid.change_Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid.change_Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid.change_Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid.change,
        comparison_ftf_health_plan_fid.month_flag,
        comparison_ftf_health_plan_fid.status,
        comparison_ftf_health_plan_fid.change_in_lives,
        comparison_ftf_health_plan_fid.cycle_id,
        comparison_ftf_health_plan_fid.modified_time,
        comparison_ftf_health_plan_fid.modified_by
 FROM sandbox.comparison_ftf_health_plan_fid
 ORDER BY comparison_ftf_health_plan_fid.ftf_health_plan_fid,
          comparison_ftf_health_plan_fid.ftf_health_plan_name,
          comparison_ftf_health_plan_fid.month_flag
SEGMENTED BY hash(comparison_ftf_health_plan_fid.lives_mn, comparison_ftf_health_plan_fid.change_ftf_health_plan_fid, comparison_ftf_health_plan_fid.change_ftf_health_plan_name, comparison_ftf_health_plan_fid.change_ftf_provider_fid, comparison_ftf_health_plan_fid.change_ftf_provider_name, comparison_ftf_health_plan_fid.change_ftf_parent_name, comparison_ftf_health_plan_fid.change_paytype, comparison_ftf_health_plan_fid.change_ftf_health_plan_type) ALL NODES;

CREATE PROJECTION sandbox.pivot_plan_prod_master_v1_temp_b0 /*+basename(pivot_plan_prod_master_v1_temp),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 pref_brand_tier,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 prev_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT pivot_plan_prod_master_v1_temp.ftf_health_plan_fid,
        pivot_plan_prod_master_v1_temp.ftf_health_plan_name,
        pivot_plan_prod_master_v1_temp.ftf_provider_fid,
        pivot_plan_prod_master_v1_temp.ftf_provider_name,
        pivot_plan_prod_master_v1_temp.ftf_parent_name,
        pivot_plan_prod_master_v1_temp.paytype,
        pivot_plan_prod_master_v1_temp.ftf_health_plan_type,
        pivot_plan_prod_master_v1_temp.key_controlling_account,
        pivot_plan_prod_master_v1_temp.key_controlling_plan_formulary,
        pivot_plan_prod_master_v1_temp.key_controlling_parent,
        pivot_plan_prod_master_v1_temp.payer_pbm,
        pivot_plan_prod_master_v1_temp.key_pbm,
        pivot_plan_prod_master_v1_temp.ftf_formulary_management_pbm,
        pivot_plan_prod_master_v1_temp.ftf_formulary_influencer_pbm,
        pivot_plan_prod_master_v1_temp.ftf_claims_processing_pbm,
        pivot_plan_prod_master_v1_temp.lives_mn,
        pivot_plan_prod_master_v1_temp.iqvia_payer_name,
        pivot_plan_prod_master_v1_temp.iqvia_pbm,
        pivot_plan_prod_master_v1_temp.pref_brand_tier,
        pivot_plan_prod_master_v1_temp.Coverage_Category_Ajovy,
        pivot_plan_prod_master_v1_temp.Coverage_Category_Aimovig,
        pivot_plan_prod_master_v1_temp.Coverage_Category_Emgality,
        pivot_plan_prod_master_v1_temp.prev_lives,
        pivot_plan_prod_master_v1_temp.cycle_id,
        pivot_plan_prod_master_v1_temp.modified_time,
        pivot_plan_prod_master_v1_temp.modified_by
 FROM sandbox.pivot_plan_prod_master_v1_temp
 ORDER BY pivot_plan_prod_master_v1_temp.ftf_health_plan_fid,
          pivot_plan_prod_master_v1_temp.ftf_health_plan_name,
          pivot_plan_prod_master_v1_temp.ftf_provider_fid,
          pivot_plan_prod_master_v1_temp.ftf_provider_name,
          pivot_plan_prod_master_v1_temp.ftf_parent_name,
          pivot_plan_prod_master_v1_temp.paytype,
          pivot_plan_prod_master_v1_temp.ftf_health_plan_type,
          pivot_plan_prod_master_v1_temp.key_controlling_account,
          pivot_plan_prod_master_v1_temp.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1_temp.key_controlling_parent,
          pivot_plan_prod_master_v1_temp.payer_pbm,
          pivot_plan_prod_master_v1_temp.key_pbm,
          pivot_plan_prod_master_v1_temp.ftf_formulary_management_pbm,
          pivot_plan_prod_master_v1_temp.ftf_formulary_influencer_pbm,
          pivot_plan_prod_master_v1_temp.ftf_claims_processing_pbm,
          pivot_plan_prod_master_v1_temp.lives_mn,
          pivot_plan_prod_master_v1_temp.iqvia_payer_name,
          pivot_plan_prod_master_v1_temp.iqvia_pbm,
          pivot_plan_prod_master_v1_temp.pref_brand_tier
SEGMENTED BY hash(pivot_plan_prod_master_v1_temp.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.pivot_plan_prod_master_v1_b0 /*+basename(pivot_plan_prod_master_v1),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 paytype_index,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 pref_brand_tier,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 prev_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT pivot_plan_prod_master_v1.ftf_health_plan_fid,
        pivot_plan_prod_master_v1.ftf_health_plan_name,
        pivot_plan_prod_master_v1.ftf_provider_fid,
        pivot_plan_prod_master_v1.ftf_provider_name,
        pivot_plan_prod_master_v1.ftf_parent_name,
        pivot_plan_prod_master_v1.paytype,
        pivot_plan_prod_master_v1.paytype_index,
        pivot_plan_prod_master_v1.ftf_health_plan_type,
        pivot_plan_prod_master_v1.key_controlling_account,
        pivot_plan_prod_master_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_v1.key_controlling_parent,
        pivot_plan_prod_master_v1.payer_pbm,
        pivot_plan_prod_master_v1.key_pbm,
        pivot_plan_prod_master_v1.ftf_formulary_management_pbm,
        pivot_plan_prod_master_v1.ftf_formulary_influencer_pbm,
        pivot_plan_prod_master_v1.ftf_claims_processing_pbm,
        pivot_plan_prod_master_v1.lives_mn,
        pivot_plan_prod_master_v1.iqvia_payer_name,
        pivot_plan_prod_master_v1.iqvia_pbm,
        pivot_plan_prod_master_v1.pref_brand_tier,
        pivot_plan_prod_master_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_v1.Coverage_Category_Emgality,
        pivot_plan_prod_master_v1.prev_lives,
        pivot_plan_prod_master_v1.cycle_id,
        pivot_plan_prod_master_v1.modified_time,
        pivot_plan_prod_master_v1.modified_by
 FROM sandbox.pivot_plan_prod_master_v1
 ORDER BY pivot_plan_prod_master_v1.ftf_health_plan_fid,
          pivot_plan_prod_master_v1.ftf_health_plan_name,
          pivot_plan_prod_master_v1.ftf_provider_fid,
          pivot_plan_prod_master_v1.ftf_provider_name,
          pivot_plan_prod_master_v1.ftf_parent_name,
          pivot_plan_prod_master_v1.paytype,
          pivot_plan_prod_master_v1.paytype_index,
          pivot_plan_prod_master_v1.ftf_health_plan_type,
          pivot_plan_prod_master_v1.key_controlling_account,
          pivot_plan_prod_master_v1.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1.key_controlling_parent,
          pivot_plan_prod_master_v1.payer_pbm,
          pivot_plan_prod_master_v1.key_pbm,
          pivot_plan_prod_master_v1.ftf_formulary_management_pbm,
          pivot_plan_prod_master_v1.ftf_formulary_influencer_pbm,
          pivot_plan_prod_master_v1.ftf_claims_processing_pbm,
          pivot_plan_prod_master_v1.lives_mn,
          pivot_plan_prod_master_v1.iqvia_payer_name,
          pivot_plan_prod_master_v1.iqvia_pbm,
          pivot_plan_prod_master_v1.pref_brand_tier
SEGMENTED BY hash(pivot_plan_prod_master_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.override_fid_iqvia_key_controller_list_v1_b0 /*+basename(override_fid_iqvia_key_controller_list_v1),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT override_fid_iqvia_key_controller_list_v1.iqvia_plan_code,
        override_fid_iqvia_key_controller_list_v1.iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v1.ftf_health_plan_fid,
        override_fid_iqvia_key_controller_list_v1.ftf_health_plan_name,
        override_fid_iqvia_key_controller_list_v1.key_controlling_plan_formulary,
        override_fid_iqvia_key_controller_list_v1.key_controlling_account,
        override_fid_iqvia_key_controller_list_v1.key_controlling_parent,
        override_fid_iqvia_key_controller_list_v1.payer_pbm,
        override_fid_iqvia_key_controller_list_v1.file_id,
        override_fid_iqvia_key_controller_list_v1.record_id
 FROM sandbox.override_fid_iqvia_key_controller_list_v1
 ORDER BY override_fid_iqvia_key_controller_list_v1.iqvia_plan_code,
          override_fid_iqvia_key_controller_list_v1.iqvia_plan_name,
          override_fid_iqvia_key_controller_list_v1.ftf_health_plan_fid,
          override_fid_iqvia_key_controller_list_v1.ftf_health_plan_name,
          override_fid_iqvia_key_controller_list_v1.key_controlling_plan_formulary,
          override_fid_iqvia_key_controller_list_v1.key_controlling_account,
          override_fid_iqvia_key_controller_list_v1.key_controlling_parent,
          override_fid_iqvia_key_controller_list_v1.payer_pbm
SEGMENTED BY hash(override_fid_iqvia_key_controller_list_v1.iqvia_plan_code, override_fid_iqvia_key_controller_list_v1.ftf_health_plan_fid, override_fid_iqvia_key_controller_list_v1.file_id, override_fid_iqvia_key_controller_list_v1.record_id, override_fid_iqvia_key_controller_list_v1.iqvia_plan_name, override_fid_iqvia_key_controller_list_v1.ftf_health_plan_name, override_fid_iqvia_key_controller_list_v1.key_controlling_plan_formulary, override_fid_iqvia_key_controller_list_v1.key_controlling_account) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plans_discard_v01_b0 /*+basename(iqvia_plans_discard_v01),createtype(L)*/ 
(
 payer_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT iqvia_plans_discard_v01.payer_id,
        iqvia_plans_discard_v01.notes,
        iqvia_plans_discard_v01.file_id,
        iqvia_plans_discard_v01.record_id
 FROM sandbox.iqvia_plans_discard_v01
 ORDER BY iqvia_plans_discard_v01.payer_id,
          iqvia_plans_discard_v01.notes,
          iqvia_plans_discard_v01.file_id,
          iqvia_plans_discard_v01.record_id
SEGMENTED BY hash(iqvia_plans_discard_v01.payer_id, iqvia_plans_discard_v01.file_id, iqvia_plans_discard_v01.record_id, iqvia_plans_discard_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.model_paytype_map_v01_b0 /*+basename(model_paytype_map_v01),createtype(L)*/ 
(
 model,
 paytype,
 notes,
 file_id,
 record_id
)
AS
 SELECT model_paytype_map_v01.model,
        model_paytype_map_v01.paytype,
        model_paytype_map_v01.notes,
        model_paytype_map_v01.file_id,
        model_paytype_map_v01.record_id
 FROM sandbox.model_paytype_map_v01
 ORDER BY model_paytype_map_v01.model,
          model_paytype_map_v01.paytype,
          model_paytype_map_v01.notes,
          model_paytype_map_v01.file_id,
          model_paytype_map_v01.record_id
SEGMENTED BY hash(model_paytype_map_v01.file_id, model_paytype_map_v01.record_id, model_paytype_map_v01.model, model_paytype_map_v01.paytype, model_paytype_map_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.iqvia_paytypeindex_v01_b0 /*+basename(iqvia_paytypeindex_v01),createtype(L)*/ 
(
 paytype_index,
 paytype,
 file_id,
 record_id
)
AS
 SELECT iqvia_paytypeindex_v01.paytype_index,
        iqvia_paytypeindex_v01.paytype,
        iqvia_paytypeindex_v01.file_id,
        iqvia_paytypeindex_v01.record_id
 FROM sandbox.iqvia_paytypeindex_v01
 ORDER BY iqvia_paytypeindex_v01.paytype_index,
          iqvia_paytypeindex_v01.paytype,
          iqvia_paytypeindex_v01.file_id,
          iqvia_paytypeindex_v01.record_id
SEGMENTED BY hash(iqvia_paytypeindex_v01.paytype_index, iqvia_paytypeindex_v01.file_id, iqvia_paytypeindex_v01.record_id, iqvia_paytypeindex_v01.paytype) ALL NODES;

CREATE PROJECTION sandbox.iqvia_payer_paytype_override_v01_b0 /*+basename(iqvia_payer_paytype_override_v01),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_name_regex,
 paytype,
 file_id,
 record_id
)
AS
 SELECT iqvia_payer_paytype_override_v01.iqvia_payer_name,
        iqvia_payer_paytype_override_v01.iqvia_plan_name_regex,
        iqvia_payer_paytype_override_v01.paytype,
        iqvia_payer_paytype_override_v01.file_id,
        iqvia_payer_paytype_override_v01.record_id
 FROM sandbox.iqvia_payer_paytype_override_v01
 ORDER BY iqvia_payer_paytype_override_v01.iqvia_payer_name,
          iqvia_payer_paytype_override_v01.iqvia_plan_name_regex
SEGMENTED BY hash(iqvia_payer_paytype_override_v01.file_id, iqvia_payer_paytype_override_v01.record_id, iqvia_payer_paytype_override_v01.paytype, iqvia_payer_paytype_override_v01.iqvia_payer_name, iqvia_payer_paytype_override_v01.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.ftf_plans_paytypeindex_v01_b0 /*+basename(ftf_plans_paytypeindex_v01),createtype(L)*/ 
(
 ftf_health_plan_type,
 paytype_index,
 file_id,
 record_id
)
AS
 SELECT ftf_plans_paytypeindex_v01.ftf_health_plan_type,
        ftf_plans_paytypeindex_v01.paytype_index,
        ftf_plans_paytypeindex_v01.file_id,
        ftf_plans_paytypeindex_v01.record_id
 FROM sandbox.ftf_plans_paytypeindex_v01
 ORDER BY ftf_plans_paytypeindex_v01.ftf_health_plan_type,
          ftf_plans_paytypeindex_v01.paytype_index,
          ftf_plans_paytypeindex_v01.file_id,
          ftf_plans_paytypeindex_v01.record_id
SEGMENTED BY hash(ftf_plans_paytypeindex_v01.paytype_index, ftf_plans_paytypeindex_v01.file_id, ftf_plans_paytypeindex_v01.record_id, ftf_plans_paytypeindex_v01.ftf_health_plan_type) ALL NODES;

CREATE PROJECTION sandbox.ftf_paytype_paytypeindex_v01_b0 /*+basename(ftf_paytype_paytypeindex_v01),createtype(L)*/ 
(
 paytype_index,
 paytype,
 file_id,
 record_id
)
AS
 SELECT ftf_paytype_paytypeindex_v01.paytype_index,
        ftf_paytype_paytypeindex_v01.paytype,
        ftf_paytype_paytypeindex_v01.file_id,
        ftf_paytype_paytypeindex_v01.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v01
 ORDER BY ftf_paytype_paytypeindex_v01.paytype_index,
          ftf_paytype_paytypeindex_v01.paytype,
          ftf_paytype_paytypeindex_v01.file_id,
          ftf_paytype_paytypeindex_v01.record_id
SEGMENTED BY hash(ftf_paytype_paytypeindex_v01.paytype_index, ftf_paytype_paytypeindex_v01.file_id, ftf_paytype_paytypeindex_v01.record_id, ftf_paytype_paytypeindex_v01.paytype) ALL NODES;

CREATE PROJECTION sandbox.ftf_override_provider_v01_b0 /*+basename(ftf_override_provider_v01),createtype(L)*/ 
(
 provider_fid,
 paytype_index,
 notes,
 file_id,
 record_id
)
AS
 SELECT ftf_override_provider_v01.provider_fid,
        ftf_override_provider_v01.paytype_index,
        ftf_override_provider_v01.notes,
        ftf_override_provider_v01.file_id,
        ftf_override_provider_v01.record_id
 FROM sandbox.ftf_override_provider_v01
 ORDER BY ftf_override_provider_v01.provider_fid,
          ftf_override_provider_v01.paytype_index,
          ftf_override_provider_v01.notes,
          ftf_override_provider_v01.file_id,
          ftf_override_provider_v01.record_id
SEGMENTED BY hash(ftf_override_provider_v01.provider_fid, ftf_override_provider_v01.paytype_index, ftf_override_provider_v01.file_id, ftf_override_provider_v01.record_id, ftf_override_provider_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.ftf_override_plan_v01_b0 /*+basename(ftf_override_plan_v01),createtype(L)*/ 
(
 ftf_health_plan_fid,
 paytype_index,
 notes,
 file_id,
 record_id
)
AS
 SELECT ftf_override_plan_v01.ftf_health_plan_fid,
        ftf_override_plan_v01.paytype_index,
        ftf_override_plan_v01.notes,
        ftf_override_plan_v01.file_id,
        ftf_override_plan_v01.record_id
 FROM sandbox.ftf_override_plan_v01
 ORDER BY ftf_override_plan_v01.ftf_health_plan_fid,
          ftf_override_plan_v01.paytype_index,
          ftf_override_plan_v01.notes,
          ftf_override_plan_v01.file_id,
          ftf_override_plan_v01.record_id
SEGMENTED BY hash(ftf_override_plan_v01.ftf_health_plan_fid, ftf_override_plan_v01.paytype_index, ftf_override_plan_v01.file_id, ftf_override_plan_v01.record_id, ftf_override_plan_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.drug_assignments_v01_b0 /*+basename(drug_assignments_v01),createtype(L)*/ 
(
 drug_id,
 drug_seq,
 product,
 file_id,
 record_id
)
AS
 SELECT drug_assignments_v01.drug_id,
        drug_assignments_v01.drug_seq,
        drug_assignments_v01.product,
        drug_assignments_v01.file_id,
        drug_assignments_v01.record_id
 FROM sandbox.drug_assignments_v01
 ORDER BY drug_assignments_v01.drug_id,
          drug_assignments_v01.drug_seq
SEGMENTED BY hash(drug_assignments_v01.drug_id, drug_assignments_v01.drug_seq, drug_assignments_v01.file_id, drug_assignments_v01.record_id, drug_assignments_v01.product) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbm_functions_v01_b0 /*+basename(ftf_pbm_functions_v01),createtype(L)*/ 
(
 pbm_function_id,
 pbm_function,
 notes,
 used,
 file_id,
 record_id
)
AS
 SELECT ftf_pbm_functions_v01.pbm_function_id,
        ftf_pbm_functions_v01.pbm_function,
        ftf_pbm_functions_v01.notes,
        ftf_pbm_functions_v01.used,
        ftf_pbm_functions_v01.file_id,
        ftf_pbm_functions_v01.record_id
 FROM sandbox.ftf_pbm_functions_v01
 ORDER BY ftf_pbm_functions_v01.pbm_function_id,
          ftf_pbm_functions_v01.pbm_function,
          ftf_pbm_functions_v01.notes,
          ftf_pbm_functions_v01.used,
          ftf_pbm_functions_v01.file_id,
          ftf_pbm_functions_v01.record_id
SEGMENTED BY hash(ftf_pbm_functions_v01.pbm_function_id, ftf_pbm_functions_v01.used, ftf_pbm_functions_v01.file_id, ftf_pbm_functions_v01.record_id, ftf_pbm_functions_v01.pbm_function, ftf_pbm_functions_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.botox_step_restriction_v01_b0 /*+basename(botox_step_restriction_v01),createtype(L)*/ 
(
 code,
 botox_step_flag,
 restriction_group,
 notes,
 file_id,
 record_id
)
AS
 SELECT botox_step_restriction_v01.code,
        botox_step_restriction_v01.botox_step_flag,
        botox_step_restriction_v01.restriction_group,
        botox_step_restriction_v01.notes,
        botox_step_restriction_v01.file_id,
        botox_step_restriction_v01.record_id
 FROM sandbox.botox_step_restriction_v01
 ORDER BY botox_step_restriction_v01.code,
          botox_step_restriction_v01.botox_step_flag,
          botox_step_restriction_v01.restriction_group,
          botox_step_restriction_v01.notes,
          botox_step_restriction_v01.file_id,
          botox_step_restriction_v01.record_id
SEGMENTED BY hash(botox_step_restriction_v01.code, botox_step_restriction_v01.file_id, botox_step_restriction_v01.record_id, botox_step_restriction_v01.botox_step_flag, botox_step_restriction_v01.restriction_group, botox_step_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.step_restriction_v01_b0 /*+basename(step_restriction_v01),createtype(L)*/ 
(
 code,
 step_category,
 restriction_group,
 notes,
 file_id,
 record_id
)
AS
 SELECT step_restriction_v01.code,
        step_restriction_v01.step_category,
        step_restriction_v01.restriction_group,
        step_restriction_v01.notes,
        step_restriction_v01.file_id,
        step_restriction_v01.record_id
 FROM sandbox.step_restriction_v01
 ORDER BY step_restriction_v01.code,
          step_restriction_v01.step_category,
          step_restriction_v01.restriction_group,
          step_restriction_v01.notes,
          step_restriction_v01.file_id,
          step_restriction_v01.record_id
SEGMENTED BY hash(step_restriction_v01.code, step_restriction_v01.file_id, step_restriction_v01.record_id, step_restriction_v01.step_category, step_restriction_v01.restriction_group, step_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.pa_restriction_v01_b0 /*+basename(pa_restriction_v01),createtype(L)*/ 
(
 code,
 prescriber_prior_authorization_category,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT pa_restriction_v01.code,
        pa_restriction_v01.prescriber_prior_authorization_category,
        pa_restriction_v01.restriction_detail_id,
        pa_restriction_v01.notes,
        pa_restriction_v01.file_id,
        pa_restriction_v01.record_id
 FROM sandbox.pa_restriction_v01
 ORDER BY pa_restriction_v01.code
SEGMENTED BY hash(pa_restriction_v01.code, pa_restriction_v01.file_id, pa_restriction_v01.record_id, pa_restriction_v01.restriction_detail_id, pa_restriction_v01.prescriber_prior_authorization_category, pa_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.patient_pa_restriction_v01_b0 /*+basename(patient_pa_restriction_v01),createtype(L)*/ 
(
 code,
 patient_prior_authorization_category,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT patient_pa_restriction_v01.code,
        patient_pa_restriction_v01.patient_prior_authorization_category,
        patient_pa_restriction_v01.restriction_detail_id,
        patient_pa_restriction_v01.notes,
        patient_pa_restriction_v01.file_id,
        patient_pa_restriction_v01.record_id
 FROM sandbox.patient_pa_restriction_v01
 ORDER BY patient_pa_restriction_v01.code
SEGMENTED BY hash(patient_pa_restriction_v01.code, patient_pa_restriction_v01.file_id, patient_pa_restriction_v01.record_id, patient_pa_restriction_v01.restriction_detail_id, patient_pa_restriction_v01.patient_prior_authorization_category, patient_pa_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.medical_rec_restriction_v01_b0 /*+basename(medical_rec_restriction_v01),createtype(L)*/ 
(
 code,
 medical_records_submission_required_flag,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT medical_rec_restriction_v01.code,
        medical_rec_restriction_v01.medical_records_submission_required_flag,
        medical_rec_restriction_v01.restriction_detail_id,
        medical_rec_restriction_v01.notes,
        medical_rec_restriction_v01.file_id,
        medical_rec_restriction_v01.record_id
 FROM sandbox.medical_rec_restriction_v01
 ORDER BY medical_rec_restriction_v01.code,
          medical_rec_restriction_v01.medical_records_submission_required_flag
SEGMENTED BY hash(medical_rec_restriction_v01.code, medical_rec_restriction_v01.file_id, medical_rec_restriction_v01.record_id, medical_rec_restriction_v01.medical_records_submission_required_flag, medical_rec_restriction_v01.restriction_detail_id, medical_rec_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.unspecified_rec_restriction_v01_b0 /*+basename(unspecified_rec_restriction_v01),createtype(L)*/ 
(
 code,
 unspecified_restriction_flag,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT unspecified_rec_restriction_v01.code,
        unspecified_rec_restriction_v01.unspecified_restriction_flag,
        unspecified_rec_restriction_v01.restriction_detail_id,
        unspecified_rec_restriction_v01.notes,
        unspecified_rec_restriction_v01.file_id,
        unspecified_rec_restriction_v01.record_id
 FROM sandbox.unspecified_rec_restriction_v01
 ORDER BY unspecified_rec_restriction_v01.code,
          unspecified_rec_restriction_v01.unspecified_restriction_flag
SEGMENTED BY hash(unspecified_rec_restriction_v01.code, unspecified_rec_restriction_v01.file_id, unspecified_rec_restriction_v01.record_id, unspecified_rec_restriction_v01.unspecified_restriction_flag, unspecified_rec_restriction_v01.restriction_detail_id, unspecified_rec_restriction_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.override_bridge_ftf_plan_types_v01_b0 /*+basename(override_bridge_ftf_plan_types_v01),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 override_ftf_health_plan_type,
 override_precedence,
 file_id,
 record_id
)
AS
 SELECT override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex,
        override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex,
        override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex,
        override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v01.override_precedence,
        override_bridge_ftf_plan_types_v01.file_id,
        override_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v01
 ORDER BY override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex
SEGMENTED BY hash(override_bridge_ftf_plan_types_v01.override_precedence, override_bridge_ftf_plan_types_v01.file_id, override_bridge_ftf_plan_types_v01.record_id, override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex, override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex, override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex, override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type) ALL NODES;

CREATE PROJECTION sandbox.delete_bridge_ftf_plan_types_v01_b0 /*+basename(delete_bridge_ftf_plan_types_v01),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 delete_flag,
 file_id,
 record_id
)
AS
 SELECT delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex,
        delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex,
        delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex,
        delete_bridge_ftf_plan_types_v01.delete_flag,
        delete_bridge_ftf_plan_types_v01.file_id,
        delete_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v01
 ORDER BY delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex
SEGMENTED BY hash(delete_bridge_ftf_plan_types_v01.file_id, delete_bridge_ftf_plan_types_v01.record_id, delete_bridge_ftf_plan_types_v01.delete_flag, delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex, delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex, delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.provider_override_default_v01_b0 /*+basename(provider_override_default_v01),createtype(L)*/ 
(
 provider_id,
 paytype_regex,
 provider_name,
 fill_in_iqvia_payer_name_if_no_bridge,
 override_best_iqvia_payer,
 fill_in_iqvia_pbm_if_no_bridge,
 override_best_iqvia_pbm,
 file_id,
 record_id
)
AS
 SELECT provider_override_default_v01.provider_id,
        provider_override_default_v01.paytype_regex,
        provider_override_default_v01.provider_name,
        provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge,
        provider_override_default_v01.override_best_iqvia_payer,
        provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge,
        provider_override_default_v01.override_best_iqvia_pbm,
        provider_override_default_v01.file_id,
        provider_override_default_v01.record_id
 FROM sandbox.provider_override_default_v01
 ORDER BY provider_override_default_v01.provider_id,
          provider_override_default_v01.paytype_regex,
          provider_override_default_v01.provider_name,
          provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge,
          provider_override_default_v01.override_best_iqvia_payer,
          provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge,
          provider_override_default_v01.override_best_iqvia_pbm,
          provider_override_default_v01.file_id
SEGMENTED BY hash(provider_override_default_v01.provider_id, provider_override_default_v01.file_id, provider_override_default_v01.record_id, provider_override_default_v01.paytype_regex, provider_override_default_v01.provider_name, provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge, provider_override_default_v01.override_best_iqvia_payer, provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge) ALL NODES;

CREATE PROJECTION sandbox.key_controller_list_v01_b0 /*+basename(key_controller_list_v01),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT key_controller_list_v01.ftf_health_plan_fid,
        key_controller_list_v01.ftf_health_plan_name,
        key_controller_list_v01.key_controlling_account,
        key_controller_list_v01.key_controlling_plan_formulary,
        key_controller_list_v01.key_controlling_parent,
        key_controller_list_v01.payer_pbm,
        key_controller_list_v01.file_id,
        key_controller_list_v01.record_id
 FROM sandbox.key_controller_list_v01
 ORDER BY key_controller_list_v01.ftf_health_plan_fid,
          key_controller_list_v01.ftf_health_plan_name
SEGMENTED BY hash(key_controller_list_v01.ftf_health_plan_fid, key_controller_list_v01.file_id, key_controller_list_v01.record_id, key_controller_list_v01.payer_pbm, key_controller_list_v01.ftf_health_plan_name, key_controller_list_v01.key_controlling_account, key_controller_list_v01.key_controlling_plan_formulary, key_controller_list_v01.key_controlling_parent) ALL NODES;

CREATE PROJECTION sandbox.calculated_pbm_config_v01_b0 /*+basename(calculated_pbm_config_v01),createtype(L)*/ 
(
 ftf_formulary_management_pbm_regex,
 ftf_formulary_influencer_pbm_regex,
 ftf_claims_processing_pbm_regex,
 calculated_pbm_column,
 file_id,
 record_id
)
AS
 SELECT calculated_pbm_config_v01.ftf_formulary_management_pbm_regex,
        calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex,
        calculated_pbm_config_v01.ftf_claims_processing_pbm_regex,
        calculated_pbm_config_v01.calculated_pbm_column,
        calculated_pbm_config_v01.file_id,
        calculated_pbm_config_v01.record_id
 FROM sandbox.calculated_pbm_config_v01
 ORDER BY calculated_pbm_config_v01.ftf_formulary_management_pbm_regex,
          calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex,
          calculated_pbm_config_v01.ftf_claims_processing_pbm_regex,
          calculated_pbm_config_v01.calculated_pbm_column,
          calculated_pbm_config_v01.file_id,
          calculated_pbm_config_v01.record_id
SEGMENTED BY hash(calculated_pbm_config_v01.file_id, calculated_pbm_config_v01.record_id, calculated_pbm_config_v01.ftf_formulary_management_pbm_regex, calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex, calculated_pbm_config_v01.ftf_claims_processing_pbm_regex, calculated_pbm_config_v01.calculated_pbm_column) ALL NODES;

CREATE PROJECTION sandbox.calc_pbm_key_pbm_mapping_v01_b0 /*+basename(calc_pbm_key_pbm_mapping_v01),createtype(L)*/ 
(
 calculated_pbm,
 key_pbm,
 added_by,
 file_id,
 record_id
)
AS
 SELECT calc_pbm_key_pbm_mapping_v01.calculated_pbm,
        calc_pbm_key_pbm_mapping_v01.key_pbm,
        calc_pbm_key_pbm_mapping_v01.added_by,
        calc_pbm_key_pbm_mapping_v01.file_id,
        calc_pbm_key_pbm_mapping_v01.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v01
 ORDER BY calc_pbm_key_pbm_mapping_v01.calculated_pbm,
          calc_pbm_key_pbm_mapping_v01.key_pbm,
          calc_pbm_key_pbm_mapping_v01.added_by,
          calc_pbm_key_pbm_mapping_v01.file_id,
          calc_pbm_key_pbm_mapping_v01.record_id
SEGMENTED BY hash(calc_pbm_key_pbm_mapping_v01.file_id, calc_pbm_key_pbm_mapping_v01.record_id, calc_pbm_key_pbm_mapping_v01.calculated_pbm, calc_pbm_key_pbm_mapping_v01.key_pbm, calc_pbm_key_pbm_mapping_v01.added_by) ALL NODES;

CREATE PROJECTION sandbox.has_pa_mapping_v01_b0 /*+basename(has_pa_mapping_v01),createtype(L)*/ 
(
 has_pa,
 pa_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_pa_mapping_v01.has_pa,
        has_pa_mapping_v01.pa_regex,
        has_pa_mapping_v01.notes,
        has_pa_mapping_v01.file_id,
        has_pa_mapping_v01.record_id
 FROM sandbox.has_pa_mapping_v01
 ORDER BY has_pa_mapping_v01.has_pa
SEGMENTED BY hash(has_pa_mapping_v01.has_pa, has_pa_mapping_v01.file_id, has_pa_mapping_v01.record_id, has_pa_mapping_v01.pa_regex, has_pa_mapping_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.has_st_mapping_v01_b0 /*+basename(has_st_mapping_v01),createtype(L)*/ 
(
 has_st,
 st_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_st_mapping_v01.has_st,
        has_st_mapping_v01.st_regex,
        has_st_mapping_v01.notes,
        has_st_mapping_v01.file_id,
        has_st_mapping_v01.record_id
 FROM sandbox.has_st_mapping_v01
 ORDER BY has_st_mapping_v01.has_st
SEGMENTED BY hash(has_st_mapping_v01.has_st, has_st_mapping_v01.file_id, has_st_mapping_v01.record_id, has_st_mapping_v01.st_regex, has_st_mapping_v01.notes) ALL NODES;

CREATE PROJECTION sandbox.formulary_derivation_config_v01_b0 /*+basename(formulary_derivation_config_v01),createtype(L)*/ 
(
 pharmacy_status_regex,
 has_pa_regex,
 has_st_regex,
 formulary,
 tier_regex,
 pref_brand_tier_regex,
 ftf_health_plan_type_regex,
 file_id,
 record_id
)
AS
 SELECT formulary_derivation_config_v01.pharmacy_status_regex,
        formulary_derivation_config_v01.has_pa_regex,
        formulary_derivation_config_v01.has_st_regex,
        formulary_derivation_config_v01.formulary,
        formulary_derivation_config_v01.tier_regex,
        formulary_derivation_config_v01.pref_brand_tier_regex,
        formulary_derivation_config_v01.ftf_health_plan_type_regex,
        formulary_derivation_config_v01.file_id,
        formulary_derivation_config_v01.record_id
 FROM sandbox.formulary_derivation_config_v01
 ORDER BY formulary_derivation_config_v01.pharmacy_status_regex,
          formulary_derivation_config_v01.has_pa_regex,
          formulary_derivation_config_v01.has_st_regex,
          formulary_derivation_config_v01.formulary,
          formulary_derivation_config_v01.tier_regex,
          formulary_derivation_config_v01.pref_brand_tier_regex,
          formulary_derivation_config_v01.ftf_health_plan_type_regex,
          formulary_derivation_config_v01.file_id
SEGMENTED BY hash(formulary_derivation_config_v01.file_id, formulary_derivation_config_v01.record_id, formulary_derivation_config_v01.pharmacy_status_regex, formulary_derivation_config_v01.has_pa_regex, formulary_derivation_config_v01.has_st_regex, formulary_derivation_config_v01.formulary, formulary_derivation_config_v01.tier_regex, formulary_derivation_config_v01.pref_brand_tier_regex) ALL NODES;

CREATE PROJECTION sandbox.restriction_category_derivation_config_v01_b0 /*+basename(restriction_category_derivation_config_v01),createtype(L)*/ 
(
 tier_regex,
 has_pa_has_st_regex,
 unspec_regex,
 step_regex,
 botox_regex,
 prespa_regex,
 tier_cat_regex,
 medrecs_regex,
 restcat,
 restriction_category,
 meaning,
 file_id,
 record_id
)
AS
 SELECT restriction_category_derivation_config_v01.tier_regex,
        restriction_category_derivation_config_v01.has_pa_has_st_regex,
        restriction_category_derivation_config_v01.unspec_regex,
        restriction_category_derivation_config_v01.step_regex,
        restriction_category_derivation_config_v01.botox_regex,
        restriction_category_derivation_config_v01.prespa_regex,
        restriction_category_derivation_config_v01.tier_cat_regex,
        restriction_category_derivation_config_v01.medrecs_regex,
        restriction_category_derivation_config_v01.restcat,
        restriction_category_derivation_config_v01.restriction_category,
        restriction_category_derivation_config_v01.meaning,
        restriction_category_derivation_config_v01.file_id,
        restriction_category_derivation_config_v01.record_id
 FROM sandbox.restriction_category_derivation_config_v01
 ORDER BY restriction_category_derivation_config_v01.tier_regex,
          restriction_category_derivation_config_v01.has_pa_has_st_regex,
          restriction_category_derivation_config_v01.unspec_regex,
          restriction_category_derivation_config_v01.step_regex,
          restriction_category_derivation_config_v01.botox_regex,
          restriction_category_derivation_config_v01.prespa_regex,
          restriction_category_derivation_config_v01.tier_cat_regex,
          restriction_category_derivation_config_v01.medrecs_regex
SEGMENTED BY hash(restriction_category_derivation_config_v01.restcat, restriction_category_derivation_config_v01.file_id, restriction_category_derivation_config_v01.record_id, restriction_category_derivation_config_v01.tier_regex, restriction_category_derivation_config_v01.has_pa_has_st_regex, restriction_category_derivation_config_v01.unspec_regex, restriction_category_derivation_config_v01.step_regex, restriction_category_derivation_config_v01.botox_regex) ALL NODES;

CREATE PROJECTION sandbox.restriction_cat_description_mapping_v01_b0 /*+basename(restriction_cat_description_mapping_v01),createtype(L)*/ 
(
 rest_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT restriction_cat_description_mapping_v01.rest_cat,
        restriction_cat_description_mapping_v01.description,
        restriction_cat_description_mapping_v01.notes,
        restriction_cat_description_mapping_v01.file_id,
        restriction_cat_description_mapping_v01.record_id
 FROM sandbox.restriction_cat_description_mapping_v01
 ORDER BY restriction_cat_description_mapping_v01.rest_cat,
          restriction_cat_description_mapping_v01.description,
          restriction_cat_description_mapping_v01.notes,
          restriction_cat_description_mapping_v01.file_id,
          restriction_cat_description_mapping_v01.record_id
SEGMENTED BY hash(restriction_cat_description_mapping_v01.file_id, restriction_cat_description_mapping_v01.record_id, restriction_cat_description_mapping_v01.rest_cat, restriction_cat_description_mapping_v01.notes, restriction_cat_description_mapping_v01.description) ALL NODES;

CREATE PROJECTION sandbox.coverage_cat_description_mapping_v01_b0 /*+basename(coverage_cat_description_mapping_v01),createtype(L)*/ 
(
 coverage_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT coverage_cat_description_mapping_v01.coverage_cat,
        coverage_cat_description_mapping_v01.description,
        coverage_cat_description_mapping_v01.notes,
        coverage_cat_description_mapping_v01.file_id,
        coverage_cat_description_mapping_v01.record_id
 FROM sandbox.coverage_cat_description_mapping_v01
 ORDER BY coverage_cat_description_mapping_v01.coverage_cat,
          coverage_cat_description_mapping_v01.description,
          coverage_cat_description_mapping_v01.notes,
          coverage_cat_description_mapping_v01.file_id,
          coverage_cat_description_mapping_v01.record_id
SEGMENTED BY hash(coverage_cat_description_mapping_v01.file_id, coverage_cat_description_mapping_v01.record_id, coverage_cat_description_mapping_v01.coverage_cat, coverage_cat_description_mapping_v01.notes, coverage_cat_description_mapping_v01.description) ALL NODES;

CREATE PROJECTION sandbox.step_restriction_description_v01_b0 /*+basename(step_restriction_description_v01),createtype(L)*/ 
(
 step,
 description,
 file_id,
 record_id
)
AS
 SELECT step_restriction_description_v01.step,
        step_restriction_description_v01.description,
        step_restriction_description_v01.file_id,
        step_restriction_description_v01.record_id
 FROM sandbox.step_restriction_description_v01
 ORDER BY step_restriction_description_v01.step
SEGMENTED BY hash(step_restriction_description_v01.step, step_restriction_description_v01.file_id, step_restriction_description_v01.record_id, step_restriction_description_v01.description) ALL NODES;

CREATE PROJECTION sandbox.pres_pa_restriction_description_v01_b0 /*+basename(pres_pa_restriction_description_v01),createtype(L)*/ 
(
 prespa,
 description,
 file_id,
 record_id
)
AS
 SELECT pres_pa_restriction_description_v01.prespa,
        pres_pa_restriction_description_v01.description,
        pres_pa_restriction_description_v01.file_id,
        pres_pa_restriction_description_v01.record_id
 FROM sandbox.pres_pa_restriction_description_v01
 ORDER BY pres_pa_restriction_description_v01.prespa
SEGMENTED BY hash(pres_pa_restriction_description_v01.prespa, pres_pa_restriction_description_v01.file_id, pres_pa_restriction_description_v01.record_id, pres_pa_restriction_description_v01.description) ALL NODES;

CREATE PROJECTION sandbox.pat_pa_restriction_description_v01_b0 /*+basename(pat_pa_restriction_description_v01),createtype(L)*/ 
(
 patpa,
 description,
 file_id,
 record_id
)
AS
 SELECT pat_pa_restriction_description_v01.patpa,
        pat_pa_restriction_description_v01.description,
        pat_pa_restriction_description_v01.file_id,
        pat_pa_restriction_description_v01.record_id
 FROM sandbox.pat_pa_restriction_description_v01
 ORDER BY pat_pa_restriction_description_v01.patpa
SEGMENTED BY hash(pat_pa_restriction_description_v01.patpa, pat_pa_restriction_description_v01.file_id, pat_pa_restriction_description_v01.record_id, pat_pa_restriction_description_v01.description) ALL NODES;

CREATE PROJECTION sandbox.override_fid_iqvia_key_controller_list_v01_b0 /*+basename(override_fid_iqvia_key_controller_list_v01),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
        override_fid_iqvia_key_controller_list_v01.iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name,
        override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary,
        override_fid_iqvia_key_controller_list_v01.key_controlling_account,
        override_fid_iqvia_key_controller_list_v01.key_controlling_parent,
        override_fid_iqvia_key_controller_list_v01.payer_pbm,
        override_fid_iqvia_key_controller_list_v01.file_id,
        override_fid_iqvia_key_controller_list_v01.record_id
 FROM sandbox.override_fid_iqvia_key_controller_list_v01
 ORDER BY override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
          override_fid_iqvia_key_controller_list_v01.iqvia_plan_name,
          override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
          override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name,
          override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary,
          override_fid_iqvia_key_controller_list_v01.key_controlling_account,
          override_fid_iqvia_key_controller_list_v01.key_controlling_parent,
          override_fid_iqvia_key_controller_list_v01.payer_pbm
SEGMENTED BY hash(override_fid_iqvia_key_controller_list_v01.iqvia_plan_code, override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid, override_fid_iqvia_key_controller_list_v01.file_id, override_fid_iqvia_key_controller_list_v01.record_id, override_fid_iqvia_key_controller_list_v01.iqvia_plan_name, override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name, override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary, override_fid_iqvia_key_controller_list_v01.key_controlling_account) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_formularies_cdw_b0 /*+basename(raw_ftf_formularies_cdw),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status,
 file_id,
 record_id
)
AS
 SELECT raw_ftf_formularies_cdw.health_plan_id,
        raw_ftf_formularies_cdw.drug_id,
        raw_ftf_formularies_cdw.tier_code,
        raw_ftf_formularies_cdw.restrictions,
        raw_ftf_formularies_cdw.reason_code,
        raw_ftf_formularies_cdw.reason_code_description,
        raw_ftf_formularies_cdw.pharmacy_status,
        raw_ftf_formularies_cdw.file_id,
        raw_ftf_formularies_cdw.record_id
 FROM sandbox.raw_ftf_formularies_cdw
 ORDER BY raw_ftf_formularies_cdw.health_plan_id,
          raw_ftf_formularies_cdw.drug_id,
          raw_ftf_formularies_cdw.tier_code,
          raw_ftf_formularies_cdw.restrictions,
          raw_ftf_formularies_cdw.reason_code,
          raw_ftf_formularies_cdw.reason_code_description
SEGMENTED BY hash(raw_ftf_formularies_cdw.health_plan_id, raw_ftf_formularies_cdw.drug_id, raw_ftf_formularies_cdw.tier_code, raw_ftf_formularies_cdw.file_id, raw_ftf_formularies_cdw.record_id, raw_ftf_formularies_cdw.restrictions, raw_ftf_formularies_cdw.pharmacy_status, raw_ftf_formularies_cdw.reason_code) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plans_cdw_b0 /*+basename(raw_ftf_health_plans_cdw),createtype(A)*/ 
(
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier,
 file_id,
 record_id
)
AS
 SELECT raw_ftf_health_plans_cdw.formularyf_id,
        raw_ftf_health_plans_cdw.provider_id,
        raw_ftf_health_plans_cdw.provider,
        raw_ftf_health_plans_cdw.health_plan_id,
        raw_ftf_health_plans_cdw.health_plan,
        raw_ftf_health_plans_cdw.parent_id,
        raw_ftf_health_plans_cdw.parent,
        raw_ftf_health_plans_cdw.national_lives_count,
        raw_ftf_health_plans_cdw.plan_type_name,
        raw_ftf_health_plans_cdw.preferred_brand_tier,
        raw_ftf_health_plans_cdw.file_id,
        raw_ftf_health_plans_cdw.record_id
 FROM sandbox.raw_ftf_health_plans_cdw
 ORDER BY raw_ftf_health_plans_cdw.formularyf_id,
          raw_ftf_health_plans_cdw.provider_id,
          raw_ftf_health_plans_cdw.provider,
          raw_ftf_health_plans_cdw.health_plan_id,
          raw_ftf_health_plans_cdw.health_plan,
          raw_ftf_health_plans_cdw.parent_id,
          raw_ftf_health_plans_cdw.parent,
          raw_ftf_health_plans_cdw.national_lives_count
SEGMENTED BY hash(raw_ftf_health_plans_cdw.formularyf_id, raw_ftf_health_plans_cdw.provider_id, raw_ftf_health_plans_cdw.health_plan_id, raw_ftf_health_plans_cdw.parent_id, raw_ftf_health_plans_cdw.national_lives_count, raw_ftf_health_plans_cdw.file_id, raw_ftf_health_plans_cdw.record_id, raw_ftf_health_plans_cdw.preferred_brand_tier) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plan_geography_cdw_b0 /*+basename(raw_ftf_health_plan_geography_cdw),createtype(A)*/ 
(
 health_plan_id,
 county_fips_id,
 county_id,
 county_name,
 state_id,
 state_name,
 county_lives,
 file_id,
 record_id
)
AS
 SELECT raw_ftf_health_plan_geography_cdw.health_plan_id,
        raw_ftf_health_plan_geography_cdw.county_fips_id,
        raw_ftf_health_plan_geography_cdw.county_id,
        raw_ftf_health_plan_geography_cdw.county_name,
        raw_ftf_health_plan_geography_cdw.state_id,
        raw_ftf_health_plan_geography_cdw.state_name,
        raw_ftf_health_plan_geography_cdw.county_lives,
        raw_ftf_health_plan_geography_cdw.file_id,
        raw_ftf_health_plan_geography_cdw.record_id
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 ORDER BY raw_ftf_health_plan_geography_cdw.health_plan_id,
          raw_ftf_health_plan_geography_cdw.county_fips_id,
          raw_ftf_health_plan_geography_cdw.county_id,
          raw_ftf_health_plan_geography_cdw.county_name,
          raw_ftf_health_plan_geography_cdw.state_id,
          raw_ftf_health_plan_geography_cdw.state_name,
          raw_ftf_health_plan_geography_cdw.county_lives
SEGMENTED BY hash(raw_ftf_health_plan_geography_cdw.health_plan_id, raw_ftf_health_plan_geography_cdw.county_fips_id, raw_ftf_health_plan_geography_cdw.county_id, raw_ftf_health_plan_geography_cdw.state_id, raw_ftf_health_plan_geography_cdw.county_lives, raw_ftf_health_plan_geography_cdw.file_id, raw_ftf_health_plan_geography_cdw.record_id, raw_ftf_health_plan_geography_cdw.state_name) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_pbms_cdw_b0 /*+basename(raw_ftf_pbms_cdw),createtype(A)*/ 
(
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 file_id,
 record_id
)
AS
 SELECT raw_ftf_pbms_cdw.health_plan_id,
        raw_ftf_pbms_cdw.pbm_id,
        raw_ftf_pbms_cdw.pbm,
        raw_ftf_pbms_cdw.pbm_function_id,
        raw_ftf_pbms_cdw.pbm_function,
        raw_ftf_pbms_cdw.file_id,
        raw_ftf_pbms_cdw.record_id
 FROM sandbox.raw_ftf_pbms_cdw
 ORDER BY raw_ftf_pbms_cdw.health_plan_id,
          raw_ftf_pbms_cdw.pbm_id,
          raw_ftf_pbms_cdw.pbm,
          raw_ftf_pbms_cdw.pbm_function_id,
          raw_ftf_pbms_cdw.pbm_function
SEGMENTED BY hash(raw_ftf_pbms_cdw.health_plan_id, raw_ftf_pbms_cdw.pbm_id, raw_ftf_pbms_cdw.pbm_function_id, raw_ftf_pbms_cdw.file_id, raw_ftf_pbms_cdw.record_id, raw_ftf_pbms_cdw.pbm, raw_ftf_pbms_cdw.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_plan_cdw_b0 /*+basename(raw_iqvia_plan_cdw),createtype(A)*/ 
(
 payer_num,
 payer_name,
 plan_num,
 payer_plan_num,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data,
 file_id,
 record_id
)
AS
 SELECT raw_iqvia_plan_cdw.payer_num,
        raw_iqvia_plan_cdw.payer_name,
        raw_iqvia_plan_cdw.plan_num,
        raw_iqvia_plan_cdw.payer_plan_num,
        raw_iqvia_plan_cdw.plan_name,
        raw_iqvia_plan_cdw.model,
        raw_iqvia_plan_cdw.city,
        raw_iqvia_plan_cdw.hq_state,
        raw_iqvia_plan_cdw.operating_state,
        raw_iqvia_plan_cdw.months_with_data,
        raw_iqvia_plan_cdw.file_id,
        raw_iqvia_plan_cdw.record_id
 FROM sandbox.raw_iqvia_plan_cdw
 ORDER BY raw_iqvia_plan_cdw.payer_num,
          raw_iqvia_plan_cdw.payer_name,
          raw_iqvia_plan_cdw.plan_num,
          raw_iqvia_plan_cdw.payer_plan_num,
          raw_iqvia_plan_cdw.plan_name,
          raw_iqvia_plan_cdw.model,
          raw_iqvia_plan_cdw.city,
          raw_iqvia_plan_cdw.hq_state
SEGMENTED BY hash(raw_iqvia_plan_cdw.payer_num, raw_iqvia_plan_cdw.plan_num, raw_iqvia_plan_cdw.hq_state, raw_iqvia_plan_cdw.operating_state, raw_iqvia_plan_cdw.months_with_data, raw_iqvia_plan_cdw.file_id, raw_iqvia_plan_cdw.record_id, raw_iqvia_plan_cdw.payer_plan_num) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_pbm_cdw_b0 /*+basename(raw_iqvia_pbm_cdw),createtype(A)*/ 
(
 pbm_name,
 payer_plan_num,
 xref_to_payer_plan_num,
 ipd_id,
 ipd_type,
 plan_name,
 pbm_num,
 ims_processor_num,
 file_id,
 record_id
)
AS
 SELECT raw_iqvia_pbm_cdw.pbm_name,
        raw_iqvia_pbm_cdw.payer_plan_num,
        raw_iqvia_pbm_cdw.xref_to_payer_plan_num,
        raw_iqvia_pbm_cdw.ipd_id,
        raw_iqvia_pbm_cdw.ipd_type,
        raw_iqvia_pbm_cdw.plan_name,
        raw_iqvia_pbm_cdw.pbm_num,
        raw_iqvia_pbm_cdw.ims_processor_num,
        raw_iqvia_pbm_cdw.file_id,
        raw_iqvia_pbm_cdw.record_id
 FROM sandbox.raw_iqvia_pbm_cdw
 ORDER BY raw_iqvia_pbm_cdw.pbm_name,
          raw_iqvia_pbm_cdw.payer_plan_num,
          raw_iqvia_pbm_cdw.xref_to_payer_plan_num,
          raw_iqvia_pbm_cdw.ipd_id,
          raw_iqvia_pbm_cdw.ipd_type,
          raw_iqvia_pbm_cdw.plan_name,
          raw_iqvia_pbm_cdw.pbm_num,
          raw_iqvia_pbm_cdw.ims_processor_num
SEGMENTED BY hash(raw_iqvia_pbm_cdw.pbm_num, raw_iqvia_pbm_cdw.file_id, raw_iqvia_pbm_cdw.record_id, raw_iqvia_pbm_cdw.payer_plan_num, raw_iqvia_pbm_cdw.xref_to_payer_plan_num, raw_iqvia_pbm_cdw.ipd_id, raw_iqvia_pbm_cdw.ipd_type, raw_iqvia_pbm_cdw.ims_processor_num) ALL NODES;

CREATE PROJECTION sandbox.raw_teva_ims_bridge_cdw_b0 /*+basename(raw_teva_ims_bridge_cdw),createtype(A)*/ 
(
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name,
 file_id,
 record_id
)
AS
 SELECT raw_teva_ims_bridge_cdw.payer_name,
        raw_teva_ims_bridge_cdw.code,
        raw_teva_ims_bridge_cdw.name,
        raw_teva_ims_bridge_cdw.state,
        raw_teva_ims_bridge_cdw.comments,
        raw_teva_ims_bridge_cdw.plan_id,
        raw_teva_ims_bridge_cdw.plan_name,
        raw_teva_ims_bridge_cdw.provider_name,
        raw_teva_ims_bridge_cdw.plan_type_name,
        raw_teva_ims_bridge_cdw.file_id,
        raw_teva_ims_bridge_cdw.record_id
 FROM sandbox.raw_teva_ims_bridge_cdw
 ORDER BY raw_teva_ims_bridge_cdw.payer_name,
          raw_teva_ims_bridge_cdw.code,
          raw_teva_ims_bridge_cdw.name,
          raw_teva_ims_bridge_cdw.state,
          raw_teva_ims_bridge_cdw.comments,
          raw_teva_ims_bridge_cdw.plan_id,
          raw_teva_ims_bridge_cdw.plan_name,
          raw_teva_ims_bridge_cdw.provider_name
SEGMENTED BY hash(raw_teva_ims_bridge_cdw.state, raw_teva_ims_bridge_cdw.file_id, raw_teva_ims_bridge_cdw.record_id, raw_teva_ims_bridge_cdw.code, raw_teva_ims_bridge_cdw.plan_id, raw_teva_ims_bridge_cdw.plan_type_name, raw_teva_ims_bridge_cdw.payer_name, raw_teva_ims_bridge_cdw.name) ALL NODES;

CREATE PROJECTION sandbox.has_st_mapping_b0 /*+basename(has_st_mapping),createtype(L)*/ 
(
 has_st,
 st_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_st_mapping.has_st,
        has_st_mapping.st_regex,
        has_st_mapping.notes,
        has_st_mapping.file_id,
        has_st_mapping.record_id
 FROM sandbox.has_st_mapping
 ORDER BY has_st_mapping.has_st,
          has_st_mapping.st_regex,
          has_st_mapping.notes,
          has_st_mapping.file_id,
          has_st_mapping.record_id
SEGMENTED BY hash(has_st_mapping.has_st, has_st_mapping.file_id, has_st_mapping.record_id, has_st_mapping.st_regex, has_st_mapping.notes) ALL NODES;

CREATE PROJECTION sandbox.has_pa_mapping_b0 /*+basename(has_pa_mapping),createtype(L)*/ 
(
 has_pa,
 pa_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_pa_mapping.has_pa,
        has_pa_mapping.pa_regex,
        has_pa_mapping.notes,
        has_pa_mapping.file_id,
        has_pa_mapping.record_id
 FROM sandbox.has_pa_mapping
 ORDER BY has_pa_mapping.has_pa,
          has_pa_mapping.pa_regex,
          has_pa_mapping.notes,
          has_pa_mapping.file_id,
          has_pa_mapping.record_id
SEGMENTED BY hash(has_pa_mapping.has_pa, has_pa_mapping.file_id, has_pa_mapping.record_id, has_pa_mapping.pa_regex, has_pa_mapping.notes) ALL NODES;

CREATE PROJECTION sandbox.calc_pbm_key_pbm_mapping_b0 /*+basename(calc_pbm_key_pbm_mapping),createtype(L)*/ 
(
 calculated_pbm,
 key_pbm,
 added_by,
 file_id,
 record_id
)
AS
 SELECT calc_pbm_key_pbm_mapping.calculated_pbm,
        calc_pbm_key_pbm_mapping.key_pbm,
        calc_pbm_key_pbm_mapping.added_by,
        calc_pbm_key_pbm_mapping.file_id,
        calc_pbm_key_pbm_mapping.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping
 ORDER BY calc_pbm_key_pbm_mapping.calculated_pbm,
          calc_pbm_key_pbm_mapping.key_pbm,
          calc_pbm_key_pbm_mapping.added_by,
          calc_pbm_key_pbm_mapping.file_id,
          calc_pbm_key_pbm_mapping.record_id
SEGMENTED BY hash(calc_pbm_key_pbm_mapping.file_id, calc_pbm_key_pbm_mapping.record_id, calc_pbm_key_pbm_mapping.calculated_pbm, calc_pbm_key_pbm_mapping.key_pbm, calc_pbm_key_pbm_mapping.added_by) ALL NODES;

CREATE PROJECTION sandbox.calculated_pbm_config_b0 /*+basename(calculated_pbm_config),createtype(L)*/ 
(
 ftf_formulary_management_pbm_regex,
 ftf_formulary_influencer_pbm_regex,
 ftf_claims_processing_pbm_regex,
 calculated_pbm_column,
 file_id,
 record_id
)
AS
 SELECT calculated_pbm_config.ftf_formulary_management_pbm_regex,
        calculated_pbm_config.ftf_formulary_influencer_pbm_regex,
        calculated_pbm_config.ftf_claims_processing_pbm_regex,
        calculated_pbm_config.calculated_pbm_column,
        calculated_pbm_config.file_id,
        calculated_pbm_config.record_id
 FROM sandbox.calculated_pbm_config
 ORDER BY calculated_pbm_config.ftf_formulary_management_pbm_regex,
          calculated_pbm_config.ftf_formulary_influencer_pbm_regex,
          calculated_pbm_config.ftf_claims_processing_pbm_regex,
          calculated_pbm_config.calculated_pbm_column,
          calculated_pbm_config.file_id,
          calculated_pbm_config.record_id
SEGMENTED BY hash(calculated_pbm_config.file_id, calculated_pbm_config.record_id, calculated_pbm_config.ftf_formulary_management_pbm_regex, calculated_pbm_config.ftf_formulary_influencer_pbm_regex, calculated_pbm_config.ftf_claims_processing_pbm_regex, calculated_pbm_config.calculated_pbm_column) ALL NODES;

CREATE PROJECTION sandbox.key_controller_list_b0 /*+basename(key_controller_list),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT key_controller_list.ftf_health_plan_fid,
        key_controller_list.ftf_health_plan_name,
        key_controller_list.key_controlling_account,
        key_controller_list.key_controlling_plan_formulary,
        key_controller_list.key_controlling_parent,
        key_controller_list.payer_pbm,
        key_controller_list.file_id,
        key_controller_list.record_id
 FROM sandbox.key_controller_list
 ORDER BY key_controller_list.ftf_health_plan_fid,
          key_controller_list.ftf_health_plan_name,
          key_controller_list.key_controlling_account,
          key_controller_list.key_controlling_plan_formulary,
          key_controller_list.key_controlling_parent,
          key_controller_list.payer_pbm,
          key_controller_list.file_id,
          key_controller_list.record_id
SEGMENTED BY hash(key_controller_list.ftf_health_plan_fid, key_controller_list.file_id, key_controller_list.record_id, key_controller_list.key_controlling_account, key_controller_list.key_controlling_plan_formulary, key_controller_list.key_controlling_parent, key_controller_list.payer_pbm, key_controller_list.ftf_health_plan_name) ALL NODES;

CREATE PROJECTION sandbox.provider_override_default_b0 /*+basename(provider_override_default),createtype(L)*/ 
(
 provider_id,
 paytype_regex,
 provider_name,
 fill_in_iqvia_payer_name_if_no_bridge,
 override_best_iqvia_payer,
 fill_in_iqvia_pbm_if_no_bridge,
 override_best_iqvia_pbm,
 file_id,
 record_id
)
AS
 SELECT provider_override_default.provider_id,
        provider_override_default.paytype_regex,
        provider_override_default.provider_name,
        provider_override_default.fill_in_iqvia_payer_name_if_no_bridge,
        provider_override_default.override_best_iqvia_payer,
        provider_override_default.fill_in_iqvia_pbm_if_no_bridge,
        provider_override_default.override_best_iqvia_pbm,
        provider_override_default.file_id,
        provider_override_default.record_id
 FROM sandbox.provider_override_default
 ORDER BY provider_override_default.provider_id,
          provider_override_default.paytype_regex,
          provider_override_default.provider_name,
          provider_override_default.fill_in_iqvia_payer_name_if_no_bridge,
          provider_override_default.override_best_iqvia_payer,
          provider_override_default.fill_in_iqvia_pbm_if_no_bridge,
          provider_override_default.override_best_iqvia_pbm,
          provider_override_default.file_id
SEGMENTED BY hash(provider_override_default.file_id, provider_override_default.record_id, provider_override_default.provider_id, provider_override_default.paytype_regex, provider_override_default.provider_name, provider_override_default.fill_in_iqvia_payer_name_if_no_bridge, provider_override_default.override_best_iqvia_payer, provider_override_default.fill_in_iqvia_pbm_if_no_bridge) ALL NODES;

CREATE PROJECTION sandbox.delete_bridge_ftf_plan_types_b0 /*+basename(delete_bridge_ftf_plan_types),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 delete_flag,
 file_id,
 record_id
)
AS
 SELECT delete_bridge_ftf_plan_types.ftf_health_plan_name_regex,
        delete_bridge_ftf_plan_types.iqvia_payer_name_regex,
        delete_bridge_ftf_plan_types.iqvia_plan_name_regex,
        delete_bridge_ftf_plan_types.delete_flag,
        delete_bridge_ftf_plan_types.file_id,
        delete_bridge_ftf_plan_types.record_id
 FROM sandbox.delete_bridge_ftf_plan_types
 ORDER BY delete_bridge_ftf_plan_types.ftf_health_plan_name_regex,
          delete_bridge_ftf_plan_types.iqvia_payer_name_regex,
          delete_bridge_ftf_plan_types.iqvia_plan_name_regex,
          delete_bridge_ftf_plan_types.delete_flag,
          delete_bridge_ftf_plan_types.file_id,
          delete_bridge_ftf_plan_types.record_id
SEGMENTED BY hash(delete_bridge_ftf_plan_types.file_id, delete_bridge_ftf_plan_types.record_id, delete_bridge_ftf_plan_types.iqvia_payer_name_regex, delete_bridge_ftf_plan_types.delete_flag, delete_bridge_ftf_plan_types.ftf_health_plan_name_regex, delete_bridge_ftf_plan_types.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.override_bridge_ftf_plan_types_b0 /*+basename(override_bridge_ftf_plan_types),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 override_ftf_health_plan_type,
 override_precedence,
 file_id,
 record_id
)
AS
 SELECT override_bridge_ftf_plan_types.ftf_health_plan_name_regex,
        override_bridge_ftf_plan_types.iqvia_payer_name_regex,
        override_bridge_ftf_plan_types.iqvia_plan_name_regex,
        override_bridge_ftf_plan_types.override_ftf_health_plan_type,
        override_bridge_ftf_plan_types.override_precedence,
        override_bridge_ftf_plan_types.file_id,
        override_bridge_ftf_plan_types.record_id
 FROM sandbox.override_bridge_ftf_plan_types
 ORDER BY override_bridge_ftf_plan_types.ftf_health_plan_name_regex,
          override_bridge_ftf_plan_types.iqvia_payer_name_regex,
          override_bridge_ftf_plan_types.iqvia_plan_name_regex,
          override_bridge_ftf_plan_types.override_ftf_health_plan_type,
          override_bridge_ftf_plan_types.override_precedence,
          override_bridge_ftf_plan_types.file_id,
          override_bridge_ftf_plan_types.record_id
SEGMENTED BY hash(override_bridge_ftf_plan_types.override_precedence, override_bridge_ftf_plan_types.file_id, override_bridge_ftf_plan_types.record_id, override_bridge_ftf_plan_types.iqvia_payer_name_regex, override_bridge_ftf_plan_types.override_ftf_health_plan_type, override_bridge_ftf_plan_types.ftf_health_plan_name_regex, override_bridge_ftf_plan_types.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_restrictions_cdw_b0 /*+basename(raw_ftf_restrictions_cdw),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level,
 file_id,
 record_id
)
AS
 SELECT raw_ftf_restrictions_cdw.health_plan_id,
        raw_ftf_restrictions_cdw.drug_id,
        raw_ftf_restrictions_cdw.restriction_code,
        raw_ftf_restrictions_cdw.restriction_detail_id,
        raw_ftf_restrictions_cdw.restriction_detail_text,
        raw_ftf_restrictions_cdw.restriction_addtnl_information_1,
        raw_ftf_restrictions_cdw.restriction_addtnl_information_2,
        raw_ftf_restrictions_cdw.step_count,
        raw_ftf_restrictions_cdw.pa_form,
        raw_ftf_restrictions_cdw.indication,
        raw_ftf_restrictions_cdw.grouped_restriction_level,
        raw_ftf_restrictions_cdw.file_id,
        raw_ftf_restrictions_cdw.record_id
 FROM sandbox.raw_ftf_restrictions_cdw
 ORDER BY raw_ftf_restrictions_cdw.health_plan_id,
          raw_ftf_restrictions_cdw.drug_id,
          raw_ftf_restrictions_cdw.restriction_code,
          raw_ftf_restrictions_cdw.restriction_detail_id,
          raw_ftf_restrictions_cdw.restriction_detail_text,
          raw_ftf_restrictions_cdw.restriction_addtnl_information_1,
          raw_ftf_restrictions_cdw.restriction_addtnl_information_2,
          raw_ftf_restrictions_cdw.step_count
SEGMENTED BY hash(raw_ftf_restrictions_cdw.file_id, raw_ftf_restrictions_cdw.record_id, raw_ftf_restrictions_cdw.health_plan_id, raw_ftf_restrictions_cdw.drug_id, raw_ftf_restrictions_cdw.restriction_code, raw_ftf_restrictions_cdw.restriction_detail_id, raw_ftf_restrictions_cdw.step_count, raw_ftf_restrictions_cdw.pa_form) ALL NODES;

CREATE PROJECTION sandbox.data_file_metadata_cdw_b0 /*+basename(data_file_metadata_cdw),createtype(L)*/ 
(
 processed_date,
 file_id
)
AS
 SELECT data_file_metadata_cdw.processed_date,
        data_file_metadata_cdw.file_id
 FROM sandbox.data_file_metadata_cdw
 ORDER BY data_file_metadata_cdw.processed_date,
          data_file_metadata_cdw.file_id
SEGMENTED BY hash(data_file_metadata_cdw.processed_date, data_file_metadata_cdw.file_id) ALL NODES;

CREATE PROJECTION sandbox.parent_process_execution_b0 /*+basename(parent_process_execution),createtype(L)*/ 
(
 parent_process_id,
 parent_process_name,
 date_run,
 insert_time,
 inserted_by
)
AS
 SELECT parent_process_execution.parent_process_id,
        parent_process_execution.parent_process_name,
        parent_process_execution.date_run,
        parent_process_execution.insert_time,
        parent_process_execution.inserted_by
 FROM sandbox.parent_process_execution
 ORDER BY parent_process_execution.parent_process_id,
          parent_process_execution.parent_process_name,
          parent_process_execution.date_run,
          parent_process_execution.insert_time,
          parent_process_execution.inserted_by
SEGMENTED BY hash(parent_process_execution.parent_process_id, parent_process_execution.date_run, parent_process_execution.insert_time, parent_process_execution.inserted_by, parent_process_execution.parent_process_name) ALL NODES;

CREATE PROJECTION sandbox.process_audit_tbl_b0 /*+basename(process_audit_tbl),createtype(L)*/ 
(
 process_id,
 cycle_id,
 date_run,
 status,
 insert_time,
 inserted_by,
 modified_time,
 modified_by
)
AS
 SELECT process_audit_tbl.process_id,
        process_audit_tbl.cycle_id,
        process_audit_tbl.date_run,
        process_audit_tbl.status,
        process_audit_tbl.insert_time,
        process_audit_tbl.inserted_by,
        process_audit_tbl.modified_time,
        process_audit_tbl.modified_by
 FROM sandbox.process_audit_tbl
 ORDER BY process_audit_tbl.process_id,
          process_audit_tbl.cycle_id,
          process_audit_tbl.date_run,
          process_audit_tbl.status,
          process_audit_tbl.insert_time,
          process_audit_tbl.inserted_by,
          process_audit_tbl.modified_time,
          process_audit_tbl.modified_by
SEGMENTED BY hash(process_audit_tbl.process_id, process_audit_tbl.cycle_id, process_audit_tbl.date_run, process_audit_tbl.insert_time, process_audit_tbl.status, process_audit_tbl.inserted_by, process_audit_tbl.modified_time, process_audit_tbl.modified_by) ALL NODES;

CREATE PROJECTION sandbox.tbl_lvl_audit_b0 /*+basename(tbl_lvl_audit),createtype(L)*/ 
(
 process_id,
 tbl_id,
 cycle_id,
 date_run,
 inserted_time,
 inserted_by
)
AS
 SELECT tbl_lvl_audit.process_id,
        tbl_lvl_audit.tbl_id,
        tbl_lvl_audit.cycle_id,
        tbl_lvl_audit.date_run,
        tbl_lvl_audit.inserted_time,
        tbl_lvl_audit.inserted_by
 FROM sandbox.tbl_lvl_audit
 ORDER BY tbl_lvl_audit.cycle_id,
          tbl_lvl_audit.date_run
SEGMENTED BY hash(tbl_lvl_audit.process_id, tbl_lvl_audit.cycle_id, tbl_lvl_audit.date_run, tbl_lvl_audit.inserted_time, tbl_lvl_audit.tbl_id, tbl_lvl_audit.inserted_by) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plan_preprocessed_cdw_v1_b0 /*+basename(iqvia_plan_preprocessed_cdw_v1),createtype(L)*/ 
(
 iqvia_payer_id,
 iqvia_payer_name,
 iqvia_plan_id,
 iqvia_plan_code,
 iqvia_plan_name,
 model,
 iqvia_pbm,
 paytype,
 paytype_index,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_plan_preprocessed_cdw_v1.iqvia_payer_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_payer_name,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_plan_preprocessed_cdw_v1.model,
        iqvia_plan_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_plan_preprocessed_cdw_v1.paytype,
        iqvia_plan_preprocessed_cdw_v1.paytype_index,
        iqvia_plan_preprocessed_cdw_v1.cycle_id,
        iqvia_plan_preprocessed_cdw_v1.modified_time,
        iqvia_plan_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_preprocessed_cdw_v1
 ORDER BY iqvia_plan_preprocessed_cdw_v1.iqvia_payer_id,
          iqvia_plan_preprocessed_cdw_v1.iqvia_payer_name,
          iqvia_plan_preprocessed_cdw_v1.iqvia_plan_id,
          iqvia_plan_preprocessed_cdw_v1.iqvia_plan_code,
          iqvia_plan_preprocessed_cdw_v1.iqvia_plan_name,
          iqvia_plan_preprocessed_cdw_v1.model,
          iqvia_plan_preprocessed_cdw_v1.iqvia_pbm,
          iqvia_plan_preprocessed_cdw_v1.paytype
SEGMENTED BY hash(iqvia_plan_preprocessed_cdw_v1.iqvia_payer_id, iqvia_plan_preprocessed_cdw_v1.iqvia_plan_id, iqvia_plan_preprocessed_cdw_v1.iqvia_plan_code, iqvia_plan_preprocessed_cdw_v1.paytype_index, iqvia_plan_preprocessed_cdw_v1.cycle_id, iqvia_plan_preprocessed_cdw_v1.modified_time, iqvia_plan_preprocessed_cdw_v1.model, iqvia_plan_preprocessed_cdw_v1.paytype) ALL NODES;

CREATE PROJECTION sandbox.iqvia_pbm_preprocessed_cdw_v1_b0 /*+basename(iqvia_pbm_preprocessed_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_pbm,
 xref_to,
 iqvia_plan_name,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_pbm_preprocessed_cdw_v1.xref_to,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_pbm_preprocessed_cdw_v1.cycle_id,
        iqvia_pbm_preprocessed_cdw_v1.modified_time,
        iqvia_pbm_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_preprocessed_cdw_v1
 ORDER BY iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_code
SEGMENTED BY hash(iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_code, iqvia_pbm_preprocessed_cdw_v1.cycle_id, iqvia_pbm_preprocessed_cdw_v1.modified_time, iqvia_pbm_preprocessed_cdw_v1.modified_by, iqvia_pbm_preprocessed_cdw_v1.iqvia_pbm, iqvia_pbm_preprocessed_cdw_v1.xref_to, iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_formularies_preprocessed_cdw_v1_b0 /*+basename(ftf_formularies_preprocessed_cdw_v1),createtype(L)*/ 
(
 drug_seq,
 ftf_health_plan_fid,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status,
 plan_lives,
 check_blank_pharmstat,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formularies_preprocessed_cdw_v1.drug_seq,
        ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_formularies_preprocessed_cdw_v1.drug_id,
        ftf_formularies_preprocessed_cdw_v1.tier_code,
        ftf_formularies_preprocessed_cdw_v1.restrictions,
        ftf_formularies_preprocessed_cdw_v1.reason_code,
        ftf_formularies_preprocessed_cdw_v1.reason_code_description,
        ftf_formularies_preprocessed_cdw_v1.pharmacy_status,
        ftf_formularies_preprocessed_cdw_v1.plan_lives,
        ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat,
        ftf_formularies_preprocessed_cdw_v1.cycle_id,
        ftf_formularies_preprocessed_cdw_v1.modified_time,
        ftf_formularies_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_formularies_preprocessed_cdw_v1
 ORDER BY ftf_formularies_preprocessed_cdw_v1.drug_seq,
          ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid
SEGMENTED BY hash(ftf_formularies_preprocessed_cdw_v1.drug_seq, ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid, ftf_formularies_preprocessed_cdw_v1.drug_id, ftf_formularies_preprocessed_cdw_v1.plan_lives, ftf_formularies_preprocessed_cdw_v1.cycle_id, ftf_formularies_preprocessed_cdw_v1.modified_time, ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat, ftf_formularies_preprocessed_cdw_v1.modified_by) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbms_preprocessed_cdw_v1_b0 /*+basename(ftf_pbms_preprocessed_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_pbms_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_pbms_preprocessed_cdw_v1.pbm_id,
        ftf_pbms_preprocessed_cdw_v1.pbm,
        ftf_pbms_preprocessed_cdw_v1.pbm_function_id,
        ftf_pbms_preprocessed_cdw_v1.pbm_function,
        ftf_pbms_preprocessed_cdw_v1.cycle_id,
        ftf_pbms_preprocessed_cdw_v1.modified_time,
        ftf_pbms_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_pbms_preprocessed_cdw_v1
 ORDER BY ftf_pbms_preprocessed_cdw_v1.ftf_health_plan_fid,
          ftf_pbms_preprocessed_cdw_v1.pbm_id,
          ftf_pbms_preprocessed_cdw_v1.pbm,
          ftf_pbms_preprocessed_cdw_v1.pbm_function_id,
          ftf_pbms_preprocessed_cdw_v1.pbm_function,
          ftf_pbms_preprocessed_cdw_v1.cycle_id,
          ftf_pbms_preprocessed_cdw_v1.modified_time,
          ftf_pbms_preprocessed_cdw_v1.modified_by
SEGMENTED BY hash(ftf_pbms_preprocessed_cdw_v1.ftf_health_plan_fid, ftf_pbms_preprocessed_cdw_v1.pbm_id, ftf_pbms_preprocessed_cdw_v1.pbm_function_id, ftf_pbms_preprocessed_cdw_v1.cycle_id, ftf_pbms_preprocessed_cdw_v1.modified_time, ftf_pbms_preprocessed_cdw_v1.modified_by, ftf_pbms_preprocessed_cdw_v1.pbm, ftf_pbms_preprocessed_cdw_v1.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_cdw_v1_b0 /*+basename(ftf_restrictions_preprocessed_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 grouped_restriction_level,
 drug_seq,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v1.drug_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_code,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_text,
        ftf_restrictions_preprocessed_cdw_v1.grouped_restriction_level,
        ftf_restrictions_preprocessed_cdw_v1.drug_seq,
        ftf_restrictions_preprocessed_cdw_v1.botox,
        ftf_restrictions_preprocessed_cdw_v1.step,
        ftf_restrictions_preprocessed_cdw_v1.pres_pa,
        ftf_restrictions_preprocessed_cdw_v1.pat_pa,
        ftf_restrictions_preprocessed_cdw_v1.med_rec,
        ftf_restrictions_preprocessed_cdw_v1.unspec,
        ftf_restrictions_preprocessed_cdw_v1.cycle_id,
        ftf_restrictions_preprocessed_cdw_v1.modified_time,
        ftf_restrictions_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v1
 ORDER BY ftf_restrictions_preprocessed_cdw_v1.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_cdw_v1.drug_id,
          ftf_restrictions_preprocessed_cdw_v1.restriction_code,
          ftf_restrictions_preprocessed_cdw_v1.restriction_detail_id,
          ftf_restrictions_preprocessed_cdw_v1.restriction_detail_text,
          ftf_restrictions_preprocessed_cdw_v1.grouped_restriction_level,
          ftf_restrictions_preprocessed_cdw_v1.drug_seq,
          ftf_restrictions_preprocessed_cdw_v1.botox
SEGMENTED BY hash(ftf_restrictions_preprocessed_cdw_v1.ftf_health_plan_fid, ftf_restrictions_preprocessed_cdw_v1.drug_id, ftf_restrictions_preprocessed_cdw_v1.drug_seq, ftf_restrictions_preprocessed_cdw_v1.botox, ftf_restrictions_preprocessed_cdw_v1.step, ftf_restrictions_preprocessed_cdw_v1.pres_pa, ftf_restrictions_preprocessed_cdw_v1.pat_pa, ftf_restrictions_preprocessed_cdw_v1.med_rec) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_cdw_v2_b0 /*+basename(ftf_restrictions_preprocessed_cdw_v2),createtype(L)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 drug_seq,
 restriction_detail_id,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_cdw_v2.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v2.drug_id,
        ftf_restrictions_preprocessed_cdw_v2.drug_seq,
        ftf_restrictions_preprocessed_cdw_v2.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v2.botox,
        ftf_restrictions_preprocessed_cdw_v2.step,
        ftf_restrictions_preprocessed_cdw_v2.pres_pa,
        ftf_restrictions_preprocessed_cdw_v2.pat_pa,
        ftf_restrictions_preprocessed_cdw_v2.med_rec,
        ftf_restrictions_preprocessed_cdw_v2.unspec,
        ftf_restrictions_preprocessed_cdw_v2.cycle_id,
        ftf_restrictions_preprocessed_cdw_v2.modified_time,
        ftf_restrictions_preprocessed_cdw_v2.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v2
 ORDER BY ftf_restrictions_preprocessed_cdw_v2.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_cdw_v2.drug_id,
          ftf_restrictions_preprocessed_cdw_v2.drug_seq,
          ftf_restrictions_preprocessed_cdw_v2.restriction_detail_id,
          ftf_restrictions_preprocessed_cdw_v2.botox,
          ftf_restrictions_preprocessed_cdw_v2.step,
          ftf_restrictions_preprocessed_cdw_v2.pres_pa,
          ftf_restrictions_preprocessed_cdw_v2.pat_pa,
          ftf_restrictions_preprocessed_cdw_v2.med_rec,
          ftf_restrictions_preprocessed_cdw_v2.unspec,
          ftf_restrictions_preprocessed_cdw_v2.cycle_id
SEGMENTED BY hash(ftf_restrictions_preprocessed_cdw_v2.ftf_health_plan_fid, ftf_restrictions_preprocessed_cdw_v2.drug_id, ftf_restrictions_preprocessed_cdw_v2.drug_seq) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_bridge_preprocessed_cdw_v1_b0 /*+basename(ftf_iqvia_bridge_preprocessed_cdw_v1),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_health_plan_type,
 hp_type,
 overriden_ftf_plan_type,
 model,
 iqvia_pbm,
 iqvia_paytype,
 check_delete,
 paytype_index,
 paytype,
 check_pay_types,
 check_hp_types,
 old_ftf_health_plan_type,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_payer_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.comments,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_provider_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.hp_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.overriden_ftf_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.model,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_pbm,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_delete,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.old_ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_bridge_preprocessed_cdw_v1
 ORDER BY ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id
SEGMENTED BY hash(ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code, ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid, ftf_iqvia_bridge_preprocessed_cdw_v1.overriden_ftf_plan_type, ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index, ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types, ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types, ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id, ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time) ALL NODES;

CREATE PROJECTION sandbox.comparison_iqvia_fid_plans_b0 /*+basename(comparison_iqvia_fid_plans),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_payment_type,
 change_iqvia_model,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_health_plan_type,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_total_lives_for_ftf_plan,
 change_key_pbm,
 change,
 check_iq_payer,
 check_iq_pbm,
 change_in_lives,
 month_flag,
 status,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT comparison_iqvia_fid_plans.iqvia_plan_code,
        comparison_iqvia_fid_plans.iqvia_plan_name,
        comparison_iqvia_fid_plans.ftf_health_plan_fid,
        comparison_iqvia_fid_plans.ftf_health_plan_name,
        comparison_iqvia_fid_plans.iqvia_payer_name,
        comparison_iqvia_fid_plans.iqvia_pbm,
        comparison_iqvia_fid_plans.payment_type,
        comparison_iqvia_fid_plans.iqvia_model,
        comparison_iqvia_fid_plans.ftf_health_plan_type,
        comparison_iqvia_fid_plans.key_controlling_plan_formulary,
        comparison_iqvia_fid_plans.key_controlling_account,
        comparison_iqvia_fid_plans.key_controlling_parent,
        comparison_iqvia_fid_plans.payer_pbm,
        comparison_iqvia_fid_plans.ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans.aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans.emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans.total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans.key_pbm,
        comparison_iqvia_fid_plans.change_iqvia_plan_code,
        comparison_iqvia_fid_plans.change_iqvia_plan_name,
        comparison_iqvia_fid_plans.change_iqvia_payer_name,
        comparison_iqvia_fid_plans.change_iqvia_pbm,
        comparison_iqvia_fid_plans.change_payment_type,
        comparison_iqvia_fid_plans.change_iqvia_model,
        comparison_iqvia_fid_plans.change_ftf_health_plan_fid,
        comparison_iqvia_fid_plans.change_ftf_health_plan_name,
        comparison_iqvia_fid_plans.change_ftf_health_plan_type,
        comparison_iqvia_fid_plans.change_key_controlling_plan_formulary,
        comparison_iqvia_fid_plans.change_key_controlling_account,
        comparison_iqvia_fid_plans.change_key_controlling_parent,
        comparison_iqvia_fid_plans.change_payer_pbm,
        comparison_iqvia_fid_plans.change_ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans.change_aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans.change_emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans.change_total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans.change_key_pbm,
        comparison_iqvia_fid_plans.change,
        comparison_iqvia_fid_plans.check_iq_payer,
        comparison_iqvia_fid_plans.check_iq_pbm,
        comparison_iqvia_fid_plans.change_in_lives,
        comparison_iqvia_fid_plans.month_flag,
        comparison_iqvia_fid_plans.status,
        comparison_iqvia_fid_plans.cycle_id,
        comparison_iqvia_fid_plans.modified_time,
        comparison_iqvia_fid_plans.modified_by
 FROM sandbox.comparison_iqvia_fid_plans
 ORDER BY comparison_iqvia_fid_plans.iqvia_plan_code,
          comparison_iqvia_fid_plans.iqvia_plan_name,
          comparison_iqvia_fid_plans.ftf_health_plan_fid,
          comparison_iqvia_fid_plans.ftf_health_plan_name,
          comparison_iqvia_fid_plans.iqvia_payer_name,
          comparison_iqvia_fid_plans.iqvia_pbm,
          comparison_iqvia_fid_plans.payment_type,
          comparison_iqvia_fid_plans.iqvia_model,
          comparison_iqvia_fid_plans.ftf_health_plan_type,
          comparison_iqvia_fid_plans.key_controlling_plan_formulary,
          comparison_iqvia_fid_plans.key_controlling_account,
          comparison_iqvia_fid_plans.key_controlling_parent,
          comparison_iqvia_fid_plans.payer_pbm,
          comparison_iqvia_fid_plans.ajovy_access_for_ftf_plan,
          comparison_iqvia_fid_plans.aimovig_access_for_ftf_plan,
          comparison_iqvia_fid_plans.emgality_access_for_ftf_plan,
          comparison_iqvia_fid_plans.total_lives_for_ftf_plan,
          comparison_iqvia_fid_plans.key_pbm,
          comparison_iqvia_fid_plans.change_iqvia_plan_code,
          comparison_iqvia_fid_plans.change_iqvia_plan_name,
          comparison_iqvia_fid_plans.change_iqvia_payer_name,
          comparison_iqvia_fid_plans.change_iqvia_pbm,
          comparison_iqvia_fid_plans.change_payment_type,
          comparison_iqvia_fid_plans.change_iqvia_model,
          comparison_iqvia_fid_plans.change_ftf_health_plan_fid,
          comparison_iqvia_fid_plans.change_ftf_health_plan_name,
          comparison_iqvia_fid_plans.change_ftf_health_plan_type,
          comparison_iqvia_fid_plans.change_key_controlling_plan_formulary,
          comparison_iqvia_fid_plans.change_key_controlling_account,
          comparison_iqvia_fid_plans.change_key_controlling_parent,
          comparison_iqvia_fid_plans.change_payer_pbm,
          comparison_iqvia_fid_plans.change_ajovy_access_for_ftf_plan,
          comparison_iqvia_fid_plans.change_aimovig_access_for_ftf_plan,
          comparison_iqvia_fid_plans.change_emgality_access_for_ftf_plan,
          comparison_iqvia_fid_plans.change_total_lives_for_ftf_plan,
          comparison_iqvia_fid_plans.change_key_pbm,
          comparison_iqvia_fid_plans.change,
          comparison_iqvia_fid_plans.check_iq_payer,
          comparison_iqvia_fid_plans.check_iq_pbm,
          comparison_iqvia_fid_plans.change_in_lives,
          comparison_iqvia_fid_plans.month_flag,
          comparison_iqvia_fid_plans.status
SEGMENTED BY hash(comparison_iqvia_fid_plans.total_lives_for_ftf_plan, comparison_iqvia_fid_plans.change_iqvia_plan_code, comparison_iqvia_fid_plans.change_iqvia_plan_name, comparison_iqvia_fid_plans.change_iqvia_payer_name, comparison_iqvia_fid_plans.change_iqvia_pbm, comparison_iqvia_fid_plans.change_payment_type, comparison_iqvia_fid_plans.change_iqvia_model, comparison_iqvia_fid_plans.change_ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.key_ctl_account_summary_b0 /*+basename(key_ctl_account_summary),createtype(A)*/ 
(
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT key_ctl_account_summary.paytype,
        key_ctl_account_summary.ftf_health_plan_type,
        key_ctl_account_summary.key_controlling_account,
        key_ctl_account_summary.current_month_lives,
        key_ctl_account_summary.previous_month_lives
 FROM sandbox.key_ctl_account_summary
 ORDER BY key_ctl_account_summary.paytype,
          key_ctl_account_summary.ftf_health_plan_type,
          key_ctl_account_summary.key_controlling_account,
          key_ctl_account_summary.current_month_lives,
          key_ctl_account_summary.previous_month_lives
SEGMENTED BY hash(key_ctl_account_summary.paytype, key_ctl_account_summary.ftf_health_plan_type, key_ctl_account_summary.key_controlling_account, key_ctl_account_summary.current_month_lives, key_ctl_account_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.key_pbm_summary_b0 /*+basename(key_pbm_summary),createtype(A)*/ 
(
 paytype,
 ftf_health_plan_type,
 key_pbm,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT key_pbm_summary.paytype,
        key_pbm_summary.ftf_health_plan_type,
        key_pbm_summary.key_pbm,
        key_pbm_summary.current_month_lives,
        key_pbm_summary.previous_month_lives
 FROM sandbox.key_pbm_summary
 ORDER BY key_pbm_summary.paytype,
          key_pbm_summary.ftf_health_plan_type,
          key_pbm_summary.key_pbm,
          key_pbm_summary.current_month_lives,
          key_pbm_summary.previous_month_lives
SEGMENTED BY hash(key_pbm_summary.paytype, key_pbm_summary.ftf_health_plan_type, key_pbm_summary.key_pbm, key_pbm_summary.current_month_lives, key_pbm_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.iqvia_payer_name_summary_b0 /*+basename(iqvia_payer_name_summary),createtype(A)*/ 
(
 paytype,
 iqvia_payer_name,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT iqvia_payer_name_summary.paytype,
        iqvia_payer_name_summary.iqvia_payer_name,
        iqvia_payer_name_summary.current_month_lives,
        iqvia_payer_name_summary.previous_month_lives
 FROM sandbox.iqvia_payer_name_summary
 ORDER BY iqvia_payer_name_summary.paytype,
          iqvia_payer_name_summary.iqvia_payer_name,
          iqvia_payer_name_summary.current_month_lives,
          iqvia_payer_name_summary.previous_month_lives
SEGMENTED BY hash(iqvia_payer_name_summary.paytype, iqvia_payer_name_summary.iqvia_payer_name, iqvia_payer_name_summary.current_month_lives, iqvia_payer_name_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.iqvia_pbm_summary_b0 /*+basename(iqvia_pbm_summary),createtype(A)*/ 
(
 paytype,
 iqvia_pbm,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT iqvia_pbm_summary.paytype,
        iqvia_pbm_summary.iqvia_pbm,
        iqvia_pbm_summary.current_month_lives,
        iqvia_pbm_summary.previous_month_lives
 FROM sandbox.iqvia_pbm_summary
 ORDER BY iqvia_pbm_summary.paytype,
          iqvia_pbm_summary.iqvia_pbm,
          iqvia_pbm_summary.current_month_lives,
          iqvia_pbm_summary.previous_month_lives
SEGMENTED BY hash(iqvia_pbm_summary.paytype, iqvia_pbm_summary.iqvia_pbm, iqvia_pbm_summary.current_month_lives, iqvia_pbm_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.ftf_formulary_management_pbm_summary_b0 /*+basename(ftf_formulary_management_pbm_summary),createtype(A)*/ 
(
 paytype,
 ftf_formulary_management_pbm,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT ftf_formulary_management_pbm_summary.paytype,
        ftf_formulary_management_pbm_summary.ftf_formulary_management_pbm,
        ftf_formulary_management_pbm_summary.current_month_lives,
        ftf_formulary_management_pbm_summary.previous_month_lives
 FROM sandbox.ftf_formulary_management_pbm_summary
 ORDER BY ftf_formulary_management_pbm_summary.paytype,
          ftf_formulary_management_pbm_summary.ftf_formulary_management_pbm,
          ftf_formulary_management_pbm_summary.current_month_lives,
          ftf_formulary_management_pbm_summary.previous_month_lives
SEGMENTED BY hash(ftf_formulary_management_pbm_summary.paytype, ftf_formulary_management_pbm_summary.ftf_formulary_management_pbm, ftf_formulary_management_pbm_summary.current_month_lives, ftf_formulary_management_pbm_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.ftf_formulary_influencer_pbm_summary_b0 /*+basename(ftf_formulary_influencer_pbm_summary),createtype(A)*/ 
(
 paytype,
 ftf_formulary_influencer_pbm,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT ftf_formulary_influencer_pbm_summary.paytype,
        ftf_formulary_influencer_pbm_summary.ftf_formulary_influencer_pbm,
        ftf_formulary_influencer_pbm_summary.current_month_lives,
        ftf_formulary_influencer_pbm_summary.previous_month_lives
 FROM sandbox.ftf_formulary_influencer_pbm_summary
 ORDER BY ftf_formulary_influencer_pbm_summary.paytype,
          ftf_formulary_influencer_pbm_summary.ftf_formulary_influencer_pbm,
          ftf_formulary_influencer_pbm_summary.current_month_lives,
          ftf_formulary_influencer_pbm_summary.previous_month_lives
SEGMENTED BY hash(ftf_formulary_influencer_pbm_summary.paytype, ftf_formulary_influencer_pbm_summary.ftf_formulary_influencer_pbm, ftf_formulary_influencer_pbm_summary.current_month_lives, ftf_formulary_influencer_pbm_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.ftf_claims_processing_pbm_summary_b0 /*+basename(ftf_claims_processing_pbm_summary),createtype(A)*/ 
(
 paytype,
 ftf_claims_processing_pbm,
 current_month_lives,
 previous_month_lives
)
AS
 SELECT ftf_claims_processing_pbm_summary.paytype,
        ftf_claims_processing_pbm_summary.ftf_claims_processing_pbm,
        ftf_claims_processing_pbm_summary.current_month_lives,
        ftf_claims_processing_pbm_summary.previous_month_lives
 FROM sandbox.ftf_claims_processing_pbm_summary
 ORDER BY ftf_claims_processing_pbm_summary.paytype,
          ftf_claims_processing_pbm_summary.ftf_claims_processing_pbm,
          ftf_claims_processing_pbm_summary.current_month_lives,
          ftf_claims_processing_pbm_summary.previous_month_lives
SEGMENTED BY hash(ftf_claims_processing_pbm_summary.paytype, ftf_claims_processing_pbm_summary.ftf_claims_processing_pbm, ftf_claims_processing_pbm_summary.current_month_lives, ftf_claims_processing_pbm_summary.previous_month_lives) ALL NODES;

CREATE PROJECTION sandbox.st_lives_summary_b0 /*+basename(st_lives_summary),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 state,
 ftf_state_hp_lives,
 pref_brand_tier
)
AS
 SELECT st_lives_summary.ftf_health_plan_fid,
        st_lives_summary.ftf_health_plan_name,
        st_lives_summary.ftf_provider_name,
        st_lives_summary.ftf_parent_name,
        st_lives_summary.paytype,
        st_lives_summary.ftf_health_plan_type,
        st_lives_summary.key_controlling_account,
        st_lives_summary.key_controlling_plan_formulary,
        st_lives_summary.key_controlling_parent,
        st_lives_summary.payer_pbm,
        st_lives_summary.key_pbm,
        st_lives_summary.iqvia_payer_name,
        st_lives_summary.iqvia_pbm,
        st_lives_summary.state,
        st_lives_summary.ftf_state_hp_lives,
        st_lives_summary.pref_brand_tier
 FROM sandbox.st_lives_summary
 ORDER BY st_lives_summary.ftf_health_plan_fid,
          st_lives_summary.ftf_health_plan_name,
          st_lives_summary.ftf_provider_name,
          st_lives_summary.ftf_parent_name,
          st_lives_summary.paytype,
          st_lives_summary.ftf_health_plan_type,
          st_lives_summary.key_controlling_account,
          st_lives_summary.key_controlling_plan_formulary
SEGMENTED BY hash(st_lives_summary.ftf_state_hp_lives, st_lives_summary.state, st_lives_summary.ftf_health_plan_fid, st_lives_summary.pref_brand_tier, st_lives_summary.paytype, st_lives_summary.key_controlling_account, st_lives_summary.key_controlling_plan_formulary, st_lives_summary.key_controlling_parent) ALL NODES;

CREATE PROJECTION sandbox.access_master_bridge_b0 /*+basename(access_master_bridge),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 ftf_match_iqvia,
 previous_lives,
 current_lives
)
AS
 SELECT access_master_bridge.ftf_health_plan_fid,
        access_master_bridge.ftf_health_plan_name,
        access_master_bridge.Coverage_Category_Ajovy,
        access_master_bridge.Coverage_Category_Aimovig,
        access_master_bridge.Coverage_Category_Emgality,
        access_master_bridge.ftf_provider_fid,
        access_master_bridge.ftf_provider_name,
        access_master_bridge.ftf_parent_name,
        access_master_bridge.paytype_index,
        access_master_bridge.paytype,
        access_master_bridge.ftf_health_plan_type,
        access_master_bridge.key_controlling_plan_formulary,
        access_master_bridge.key_controlling_account,
        access_master_bridge.key_controlling_parent,
        access_master_bridge.payer_pbm,
        access_master_bridge.key_pbm,
        access_master_bridge.iqvia_payer_name,
        access_master_bridge.iqvia_pbm,
        access_master_bridge.ftf_formulary_management_pbm,
        access_master_bridge.ftf_formulary_influencer_pbm,
        access_master_bridge.ftf_claims_processing_pbm,
        access_master_bridge.pref_brand_tier,
        access_master_bridge.ftf_match_iqvia,
        access_master_bridge.previous_lives,
        access_master_bridge.current_lives
 FROM sandbox.access_master_bridge
 ORDER BY access_master_bridge.ftf_health_plan_fid,
          access_master_bridge.ftf_health_plan_name,
          access_master_bridge.Coverage_Category_Ajovy,
          access_master_bridge.Coverage_Category_Aimovig,
          access_master_bridge.Coverage_Category_Emgality,
          access_master_bridge.ftf_provider_fid,
          access_master_bridge.ftf_provider_name,
          access_master_bridge.ftf_parent_name,
          access_master_bridge.paytype_index,
          access_master_bridge.paytype,
          access_master_bridge.ftf_health_plan_type,
          access_master_bridge.key_controlling_plan_formulary,
          access_master_bridge.key_controlling_account,
          access_master_bridge.key_controlling_parent,
          access_master_bridge.payer_pbm,
          access_master_bridge.key_pbm,
          access_master_bridge.iqvia_payer_name,
          access_master_bridge.iqvia_pbm,
          access_master_bridge.ftf_formulary_management_pbm,
          access_master_bridge.ftf_formulary_influencer_pbm,
          access_master_bridge.ftf_claims_processing_pbm,
          access_master_bridge.pref_brand_tier,
          access_master_bridge.previous_lives,
          access_master_bridge.current_lives
SEGMENTED BY hash(access_master_bridge.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plan_code_ftf_hp_id_b0 /*+basename(iqvia_plan_code_ftf_hp_id),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 Ajovy_access_for_ftf_plan,
 Aimovig_access_for_ftf_plan,
 Emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_plan_code_ftf_hp_id.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id.payment_type,
        iqvia_plan_code_ftf_hp_id.iqvia_model,
        iqvia_plan_code_ftf_hp_id.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id.key_controlling_account,
        iqvia_plan_code_ftf_hp_id.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id.payer_pbm,
        iqvia_plan_code_ftf_hp_id.Ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id.Aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id.Emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id.key_pbm,
        iqvia_plan_code_ftf_hp_id.cycle_id,
        iqvia_plan_code_ftf_hp_id.modified_time,
        iqvia_plan_code_ftf_hp_id.modified_by
 FROM sandbox.iqvia_plan_code_ftf_hp_id
 ORDER BY iqvia_plan_code_ftf_hp_id.iqvia_plan_code,
          iqvia_plan_code_ftf_hp_id.ftf_health_plan_fid
SEGMENTED BY hash(iqvia_plan_code_ftf_hp_id.iqvia_plan_code, iqvia_plan_code_ftf_hp_id.iqvia_plan_name, iqvia_plan_code_ftf_hp_id.iqvia_payer_name, iqvia_plan_code_ftf_hp_id.iqvia_pbm, iqvia_plan_code_ftf_hp_id.payment_type, iqvia_plan_code_ftf_hp_id.iqvia_model, iqvia_plan_code_ftf_hp_id.ftf_health_plan_fid, iqvia_plan_code_ftf_hp_id.ftf_health_plan_name, iqvia_plan_code_ftf_hp_id.ftf_health_plan_type, iqvia_plan_code_ftf_hp_id.key_controlling_plan_formulary, iqvia_plan_code_ftf_hp_id.key_controlling_account, iqvia_plan_code_ftf_hp_id.key_controlling_parent, iqvia_plan_code_ftf_hp_id.payer_pbm, iqvia_plan_code_ftf_hp_id.Ajovy_access_for_ftf_plan, iqvia_plan_code_ftf_hp_id.Aimovig_access_for_ftf_plan, iqvia_plan_code_ftf_hp_id.Emgality_access_for_ftf_plan, iqvia_plan_code_ftf_hp_id.total_lives_for_ftf_plan, iqvia_plan_code_ftf_hp_id.key_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_hp_id_key_controlling_account_b0 /*+basename(ftf_hp_id_key_controlling_account),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 payment_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hp_id_key_controlling_account.ftf_health_plan_fid,
        ftf_hp_id_key_controlling_account.ftf_health_plan_name,
        ftf_hp_id_key_controlling_account.ftf_provider_name,
        ftf_hp_id_key_controlling_account.payment_type,
        ftf_hp_id_key_controlling_account.key_controlling_account,
        ftf_hp_id_key_controlling_account.key_controlling_plan_formulary,
        ftf_hp_id_key_controlling_account.key_controlling_parent,
        ftf_hp_id_key_controlling_account.payer_pbm,
        ftf_hp_id_key_controlling_account.key_pbm,
        ftf_hp_id_key_controlling_account.cycle_id,
        ftf_hp_id_key_controlling_account.modified_time,
        ftf_hp_id_key_controlling_account.modified_by
 FROM sandbox.ftf_hp_id_key_controlling_account
 ORDER BY ftf_hp_id_key_controlling_account.ftf_health_plan_fid,
          ftf_hp_id_key_controlling_account.ftf_health_plan_name,
          ftf_hp_id_key_controlling_account.ftf_provider_name,
          ftf_hp_id_key_controlling_account.payment_type,
          ftf_hp_id_key_controlling_account.key_controlling_account,
          ftf_hp_id_key_controlling_account.key_controlling_plan_formulary,
          ftf_hp_id_key_controlling_account.key_controlling_parent,
          ftf_hp_id_key_controlling_account.payer_pbm,
          ftf_hp_id_key_controlling_account.key_pbm
SEGMENTED BY hash(ftf_hp_id_key_controlling_account.ftf_health_plan_fid, ftf_hp_id_key_controlling_account.ftf_health_plan_name, ftf_hp_id_key_controlling_account.ftf_provider_name, ftf_hp_id_key_controlling_account.payment_type, ftf_hp_id_key_controlling_account.key_controlling_account, ftf_hp_id_key_controlling_account.key_controlling_plan_formulary, ftf_hp_id_key_controlling_account.key_controlling_parent, ftf_hp_id_key_controlling_account.payer_pbm, ftf_hp_id_key_controlling_account.key_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_hp_id_key_pbm_b0 /*+basename(ftf_hp_id_key_pbm),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 payment_type,
 key_pbm,
 assigned_iqvia_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hp_id_key_pbm.ftf_health_plan_fid,
        ftf_hp_id_key_pbm.ftf_health_plan_name,
        ftf_hp_id_key_pbm.ftf_provider_name,
        ftf_hp_id_key_pbm.payment_type,
        ftf_hp_id_key_pbm.key_pbm,
        ftf_hp_id_key_pbm.assigned_iqvia_pbm,
        ftf_hp_id_key_pbm.cycle_id,
        ftf_hp_id_key_pbm.modified_time,
        ftf_hp_id_key_pbm.modified_by
 FROM sandbox.ftf_hp_id_key_pbm
 ORDER BY ftf_hp_id_key_pbm.ftf_health_plan_fid
SEGMENTED BY hash(ftf_hp_id_key_pbm.cycle_id, ftf_hp_id_key_pbm.modified_time, ftf_hp_id_key_pbm.modified_by, ftf_hp_id_key_pbm.ftf_health_plan_fid, ftf_hp_id_key_pbm.payment_type, ftf_hp_id_key_pbm.assigned_iqvia_pbm, ftf_hp_id_key_pbm.ftf_health_plan_name, ftf_hp_id_key_pbm.ftf_provider_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_plan_master_file_op_b0 /*+basename(ftf_plan_master_file_op),createtype(A)*/ 
(
 ftf_health_plan_fid,
 product,
 ftf_health_plan_name,
 coverage_category,
 ftf_provider_name,
 paytype,
 ftf_health_plan_type,
 plan_lives,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 pharmacy_status,
 FTF_Tier,
 restrictions,
 Copay_Tier,
 restriction_category,
 step,
 botox,
 prescriber_pa,
 patient_pa,
 medical_records,
 criteria_unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_plan_master_file_op.ftf_health_plan_fid,
        ftf_plan_master_file_op.product,
        ftf_plan_master_file_op.ftf_health_plan_name,
        ftf_plan_master_file_op.coverage_category,
        ftf_plan_master_file_op.ftf_provider_name,
        ftf_plan_master_file_op.paytype,
        ftf_plan_master_file_op.ftf_health_plan_type,
        ftf_plan_master_file_op.plan_lives,
        ftf_plan_master_file_op.key_controlling_plan_formulary,
        ftf_plan_master_file_op.key_controlling_account,
        ftf_plan_master_file_op.key_controlling_parent,
        ftf_plan_master_file_op.payer_pbm,
        ftf_plan_master_file_op.key_pbm,
        ftf_plan_master_file_op.iqvia_payer_name,
        ftf_plan_master_file_op.iqvia_pbm,
        ftf_plan_master_file_op.ftf_formulary_management_pbm,
        ftf_plan_master_file_op.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_op.ftf_claims_processing_pbm,
        ftf_plan_master_file_op.pref_brand_tier,
        ftf_plan_master_file_op.pharmacy_status,
        ftf_plan_master_file_op.FTF_Tier,
        ftf_plan_master_file_op.restrictions,
        ftf_plan_master_file_op.Copay_Tier,
        ftf_plan_master_file_op.restriction_category,
        ftf_plan_master_file_op.step,
        ftf_plan_master_file_op.botox,
        ftf_plan_master_file_op.prescriber_pa,
        ftf_plan_master_file_op.patient_pa,
        ftf_plan_master_file_op.medical_records,
        ftf_plan_master_file_op.criteria_unspec,
        ftf_plan_master_file_op.cycle_id,
        ftf_plan_master_file_op.modified_time,
        ftf_plan_master_file_op.modified_by
 FROM sandbox.ftf_plan_master_file_op
 ORDER BY ftf_plan_master_file_op.ftf_health_plan_fid,
          ftf_plan_master_file_op.ftf_health_plan_name
SEGMENTED BY hash(ftf_plan_master_file_op.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_coverage_category_b0 /*+basename(paytype_product_coverage_category),createtype(A)*/ 
(
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT paytype_product_coverage_category.paytype,
        paytype_product_coverage_category.product,
        paytype_product_coverage_category.metric,
        paytype_product_coverage_category.lives
 FROM sandbox.paytype_product_coverage_category
 ORDER BY paytype_product_coverage_category.paytype,
          paytype_product_coverage_category.product,
          paytype_product_coverage_category.metric,
          paytype_product_coverage_category.lives
SEGMENTED BY hash(paytype_product_coverage_category.paytype, paytype_product_coverage_category.product, paytype_product_coverage_category.metric, paytype_product_coverage_category.lives) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_copay_tier_b0 /*+basename(paytype_product_copay_tier),createtype(A)*/ 
(
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT paytype_product_copay_tier.paytype,
        paytype_product_copay_tier.product,
        paytype_product_copay_tier.metric,
        paytype_product_copay_tier.lives
 FROM sandbox.paytype_product_copay_tier
 ORDER BY paytype_product_copay_tier.paytype,
          paytype_product_copay_tier.product,
          paytype_product_copay_tier.metric,
          paytype_product_copay_tier.lives
SEGMENTED BY hash(paytype_product_copay_tier.paytype, paytype_product_copay_tier.product, paytype_product_copay_tier.metric, paytype_product_copay_tier.lives) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_step_category_b0 /*+basename(paytype_product_step_category),createtype(A)*/ 
(
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT paytype_product_step_category.paytype,
        paytype_product_step_category.product,
        paytype_product_step_category.metric,
        paytype_product_step_category.lives
 FROM sandbox.paytype_product_step_category
 ORDER BY paytype_product_step_category.paytype,
          paytype_product_step_category.product,
          paytype_product_step_category.metric,
          paytype_product_step_category.lives
SEGMENTED BY hash(paytype_product_step_category.paytype, paytype_product_step_category.product, paytype_product_step_category.metric, paytype_product_step_category.lives) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_patient_pa_b0 /*+basename(paytype_product_patient_pa),createtype(A)*/ 
(
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT paytype_product_patient_pa.paytype,
        paytype_product_patient_pa.product,
        paytype_product_patient_pa.metric,
        paytype_product_patient_pa.lives
 FROM sandbox.paytype_product_patient_pa
 ORDER BY paytype_product_patient_pa.paytype,
          paytype_product_patient_pa.product,
          paytype_product_patient_pa.metric,
          paytype_product_patient_pa.lives
SEGMENTED BY hash(paytype_product_patient_pa.paytype, paytype_product_patient_pa.product, paytype_product_patient_pa.metric, paytype_product_patient_pa.lives) ALL NODES;

CREATE PROJECTION sandbox.key_controlling_account_product_cov_category_paytype_b0 /*+basename(key_controlling_account_product_cov_category_paytype),createtype(A)*/ 
(
 key_controlling_account,
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT key_controlling_account_product_cov_category_paytype.key_controlling_account,
        key_controlling_account_product_cov_category_paytype.paytype,
        key_controlling_account_product_cov_category_paytype.product,
        key_controlling_account_product_cov_category_paytype.metric,
        key_controlling_account_product_cov_category_paytype.lives
 FROM sandbox.key_controlling_account_product_cov_category_paytype
 ORDER BY key_controlling_account_product_cov_category_paytype.key_controlling_account,
          key_controlling_account_product_cov_category_paytype.paytype,
          key_controlling_account_product_cov_category_paytype.product,
          key_controlling_account_product_cov_category_paytype.metric,
          key_controlling_account_product_cov_category_paytype.lives
SEGMENTED BY hash(key_controlling_account_product_cov_category_paytype.key_controlling_account, key_controlling_account_product_cov_category_paytype.paytype, key_controlling_account_product_cov_category_paytype.product, key_controlling_account_product_cov_category_paytype.metric, key_controlling_account_product_cov_category_paytype.lives) ALL NODES;

CREATE PROJECTION sandbox.key_pbm_product_cov_category_paytype_b0 /*+basename(key_pbm_product_cov_category_paytype),createtype(A)*/ 
(
 key_pbm,
 paytype,
 product,
 metric,
 lives
)
AS
 SELECT key_pbm_product_cov_category_paytype.key_pbm,
        key_pbm_product_cov_category_paytype.paytype,
        key_pbm_product_cov_category_paytype.product,
        key_pbm_product_cov_category_paytype.metric,
        key_pbm_product_cov_category_paytype.lives
 FROM sandbox.key_pbm_product_cov_category_paytype
 ORDER BY key_pbm_product_cov_category_paytype.key_pbm,
          key_pbm_product_cov_category_paytype.paytype,
          key_pbm_product_cov_category_paytype.product,
          key_pbm_product_cov_category_paytype.metric,
          key_pbm_product_cov_category_paytype.lives
SEGMENTED BY hash(key_pbm_product_cov_category_paytype.key_pbm, key_pbm_product_cov_category_paytype.paytype, key_pbm_product_cov_category_paytype.product, key_pbm_product_cov_category_paytype.metric, key_pbm_product_cov_category_paytype.lives) ALL NODES;

CREATE PROJECTION sandbox.access_master_bridge_cdw_v1_b0 /*+basename(access_master_bridge_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 coverage_category_ajovy,
 coverage_category_aimovig,
 coverage_category_emgality,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 ftf_match_iqvia,
 previous_lives,
 current_lives,
 cycle_id,
 modified_time,
 modified_by,
 coverage_category_nurtec,
 coverage_category_qulitpa,
 coverage_category_austedo_hd,
 coverage_category_austedo_td,
 coverage_category_ingrezza_td
)
AS
 SELECT access_master_bridge_cdw_v1.ftf_health_plan_fid,
        access_master_bridge_cdw_v1.ftf_health_plan_name,
        access_master_bridge_cdw_v1.coverage_category_ajovy,
        access_master_bridge_cdw_v1.coverage_category_aimovig,
        access_master_bridge_cdw_v1.coverage_category_emgality,
        access_master_bridge_cdw_v1.ftf_provider_fid,
        access_master_bridge_cdw_v1.ftf_provider_name,
        access_master_bridge_cdw_v1.ftf_parent_name,
        access_master_bridge_cdw_v1.paytype_index,
        access_master_bridge_cdw_v1.paytype,
        access_master_bridge_cdw_v1.ftf_health_plan_type,
        access_master_bridge_cdw_v1.key_controlling_plan_formulary,
        access_master_bridge_cdw_v1.key_controlling_account,
        access_master_bridge_cdw_v1.key_controlling_parent,
        access_master_bridge_cdw_v1.payer_pbm,
        access_master_bridge_cdw_v1.key_pbm,
        access_master_bridge_cdw_v1.iqvia_payer_name,
        access_master_bridge_cdw_v1.iqvia_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_management_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm,
        access_master_bridge_cdw_v1.ftf_claims_processing_pbm,
        access_master_bridge_cdw_v1.pref_brand_tier,
        access_master_bridge_cdw_v1.ftf_match_iqvia,
        access_master_bridge_cdw_v1.previous_lives,
        access_master_bridge_cdw_v1.current_lives,
        access_master_bridge_cdw_v1.cycle_id,
        access_master_bridge_cdw_v1.modified_time,
        access_master_bridge_cdw_v1.modified_by,
        access_master_bridge_cdw_v1.coverage_category_nurtec,
        access_master_bridge_cdw_v1.coverage_category_qulitpa,
        access_master_bridge_cdw_v1.coverage_category_austedo_hd,
        access_master_bridge_cdw_v1.coverage_category_austedo_td,
        access_master_bridge_cdw_v1.coverage_category_ingrezza_td
 FROM sandbox.access_master_bridge_cdw_v1
 ORDER BY access_master_bridge_cdw_v1.ftf_health_plan_fid,
          access_master_bridge_cdw_v1.ftf_health_plan_name,
          access_master_bridge_cdw_v1.coverage_category_ajovy,
          access_master_bridge_cdw_v1.coverage_category_aimovig,
          access_master_bridge_cdw_v1.coverage_category_emgality,
          access_master_bridge_cdw_v1.ftf_provider_fid,
          access_master_bridge_cdw_v1.ftf_provider_name,
          access_master_bridge_cdw_v1.ftf_parent_name
SEGMENTED BY hash(access_master_bridge_cdw_v1.ftf_health_plan_fid, access_master_bridge_cdw_v1.ftf_provider_fid, access_master_bridge_cdw_v1.paytype_index, access_master_bridge_cdw_v1.pref_brand_tier, access_master_bridge_cdw_v1.ftf_match_iqvia, access_master_bridge_cdw_v1.previous_lives, access_master_bridge_cdw_v1.current_lives, access_master_bridge_cdw_v1.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plans_preprocessed_cdw_v1_temp_b0 /*+basename(ftf_health_plans_preprocessed_cdw_v1_temp),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 parent_id,
 ftf_parent_name,
 ftf_health_plan_type,
 pref_brand_tier,
 plan_lives,
 paytype,
 paytype_index,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_health_plans_preprocessed_cdw_v1_temp.ftf_health_plan_fid,
        ftf_health_plans_preprocessed_cdw_v1_temp.ftf_health_plan_name,
        ftf_health_plans_preprocessed_cdw_v1_temp.ftf_provider_fid,
        ftf_health_plans_preprocessed_cdw_v1_temp.ftf_provider_name,
        ftf_health_plans_preprocessed_cdw_v1_temp.parent_id,
        ftf_health_plans_preprocessed_cdw_v1_temp.ftf_parent_name,
        ftf_health_plans_preprocessed_cdw_v1_temp.ftf_health_plan_type,
        ftf_health_plans_preprocessed_cdw_v1_temp.pref_brand_tier,
        ftf_health_plans_preprocessed_cdw_v1_temp.plan_lives,
        ftf_health_plans_preprocessed_cdw_v1_temp.paytype,
        ftf_health_plans_preprocessed_cdw_v1_temp.paytype_index,
        ftf_health_plans_preprocessed_cdw_v1_temp.cycle_id,
        ftf_health_plans_preprocessed_cdw_v1_temp.modified_time,
        ftf_health_plans_preprocessed_cdw_v1_temp.modified_by
 FROM sandbox.ftf_health_plans_preprocessed_cdw_v1_temp
 ORDER BY ftf_health_plans_preprocessed_cdw_v1_temp.cycle_id
SEGMENTED BY hash(ftf_health_plans_preprocessed_cdw_v1_temp.ftf_health_plan_fid, ftf_health_plans_preprocessed_cdw_v1_temp.ftf_provider_fid, ftf_health_plans_preprocessed_cdw_v1_temp.parent_id, ftf_health_plans_preprocessed_cdw_v1_temp.pref_brand_tier, ftf_health_plans_preprocessed_cdw_v1_temp.plan_lives, ftf_health_plans_preprocessed_cdw_v1_temp.paytype_index, ftf_health_plans_preprocessed_cdw_v1_temp.cycle_id, ftf_health_plans_preprocessed_cdw_v1_temp.modified_time) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plans_preprocessed_cdw_v1_b0 /*+basename(ftf_health_plans_preprocessed_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 parent_id,
 ftf_parent_name,
 ftf_health_plan_type,
 pref_brand_tier,
 plan_lives,
 paytype,
 paytype_index,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_name,
        ftf_health_plans_preprocessed_cdw_v1.parent_id,
        ftf_health_plans_preprocessed_cdw_v1.ftf_parent_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_health_plans_preprocessed_cdw_v1.pref_brand_tier,
        ftf_health_plans_preprocessed_cdw_v1.plan_lives,
        ftf_health_plans_preprocessed_cdw_v1.paytype,
        ftf_health_plans_preprocessed_cdw_v1.paytype_index,
        ftf_health_plans_preprocessed_cdw_v1.cycle_id,
        ftf_health_plans_preprocessed_cdw_v1.modified_time,
        ftf_health_plans_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_health_plans_preprocessed_cdw_v1
 ORDER BY ftf_health_plans_preprocessed_cdw_v1.cycle_id
SEGMENTED BY hash(ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_fid, ftf_health_plans_preprocessed_cdw_v1.ftf_provider_fid, ftf_health_plans_preprocessed_cdw_v1.parent_id, ftf_health_plans_preprocessed_cdw_v1.pref_brand_tier, ftf_health_plans_preprocessed_cdw_v1.plan_lives, ftf_health_plans_preprocessed_cdw_v1.paytype_index, ftf_health_plans_preprocessed_cdw_v1.cycle_id, ftf_health_plans_preprocessed_cdw_v1.modified_time) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plancode_fid_xref_cdw_v1_b0 /*+basename(iqvia_plancode_fid_xref_cdw_v1),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_code,
 iqvia_plan_name,
 comments,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 ftf_health_plan_type,
 paytype_index,
 paytype,
 iqvia_pbm,
 hp_type,
 iqvia_paytype,
 pref_brand_tier,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_plancode_fid_xref_cdw_v1.iqvia_payer_name,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_code,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.comments,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_parent_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_type,
        iqvia_plancode_fid_xref_cdw_v1.paytype_index,
        iqvia_plancode_fid_xref_cdw_v1.paytype,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_pbm,
        iqvia_plancode_fid_xref_cdw_v1.hp_type,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_paytype,
        iqvia_plancode_fid_xref_cdw_v1.pref_brand_tier,
        iqvia_plancode_fid_xref_cdw_v1.lives,
        iqvia_plancode_fid_xref_cdw_v1.cycle_id,
        iqvia_plancode_fid_xref_cdw_v1.modified_time,
        iqvia_plancode_fid_xref_cdw_v1.modified_by
 FROM sandbox.iqvia_plancode_fid_xref_cdw_v1
 ORDER BY iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_fid,
          iqvia_plancode_fid_xref_cdw_v1.iqvia_payer_name,
          iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_code
SEGMENTED BY hash(iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_code, iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_fid, iqvia_plancode_fid_xref_cdw_v1.ftf_provider_fid, iqvia_plancode_fid_xref_cdw_v1.paytype_index, iqvia_plancode_fid_xref_cdw_v1.pref_brand_tier, iqvia_plancode_fid_xref_cdw_v1.lives, iqvia_plancode_fid_xref_cdw_v1.cycle_id, iqvia_plancode_fid_xref_cdw_v1.modified_time) ALL NODES;

CREATE PROJECTION sandbox.fid_best_iqviapayer_cdw_v1_b0 /*+basename(fid_best_iqviapayer_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 iqvia_payer_name,
 frequency,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT fid_best_iqviapayer_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapayer_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapayer_cdw_v1.ftf_provider_fid,
        fid_best_iqviapayer_cdw_v1.ftf_provider_name,
        fid_best_iqviapayer_cdw_v1.iqvia_payer_name,
        fid_best_iqviapayer_cdw_v1.frequency,
        fid_best_iqviapayer_cdw_v1.cycle_id,
        fid_best_iqviapayer_cdw_v1.modified_time,
        fid_best_iqviapayer_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapayer_cdw_v1
 ORDER BY fid_best_iqviapayer_cdw_v1.cycle_id
SEGMENTED BY hash(fid_best_iqviapayer_cdw_v1.ftf_health_plan_fid, fid_best_iqviapayer_cdw_v1.ftf_health_plan_name, fid_best_iqviapayer_cdw_v1.ftf_provider_fid, fid_best_iqviapayer_cdw_v1.ftf_provider_name, fid_best_iqviapayer_cdw_v1.iqvia_payer_name, fid_best_iqviapayer_cdw_v1.frequency) ALL NODES;

CREATE PROJECTION sandbox.fid_best_iqviapbm_cdw_v1_b0 /*+basename(fid_best_iqviapbm_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 iqvia_pbm,
 frequency,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT fid_best_iqviapbm_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapbm_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapbm_cdw_v1.ftf_provider_fid,
        fid_best_iqviapbm_cdw_v1.ftf_provider_name,
        fid_best_iqviapbm_cdw_v1.iqvia_pbm,
        fid_best_iqviapbm_cdw_v1.frequency,
        fid_best_iqviapbm_cdw_v1.cycle_id,
        fid_best_iqviapbm_cdw_v1.modified_time,
        fid_best_iqviapbm_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapbm_cdw_v1
 ORDER BY fid_best_iqviapbm_cdw_v1.cycle_id
SEGMENTED BY hash(fid_best_iqviapbm_cdw_v1.ftf_health_plan_fid, fid_best_iqviapbm_cdw_v1.ftf_health_plan_name, fid_best_iqviapbm_cdw_v1.ftf_provider_fid, fid_best_iqviapbm_cdw_v1.ftf_provider_name, fid_best_iqviapbm_cdw_v1.iqvia_pbm, fid_best_iqviapbm_cdw_v1.frequency) ALL NODES;

CREATE PROJECTION sandbox.amb4_cdw_v1_b0 /*+basename(amb4_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 old_coverage_category_ajovy,
 old_coverage_category_aimovig,
 old_coverage_category_emgality,
 old_ftf_provider_fid,
 old_ftf_provider_name,
 old_ftf_parent_name,
 old_paytype_index,
 old_paytype,
 old_ftf_health_plan_type,
 old_pref_brand_tier,
 old_key_controlling_plan_formulary,
 old_key_controlling_account,
 old_key_pbm,
 old_payer_pbm,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 old_iqvia_payer_name,
 old_iqvia_pbm,
 old_ftf_formulary_management_pbm,
 old_ftf_formulary_influencer_pbm,
 old_ftf_claims_processing_pbm,
 lives_mx,
 new_ftf_health_plan_fid,
 old_ftf_health_plan_fid,
 new_ftf_health_plan_name,
 old_ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 cycle_id,
 modified_time,
 modified_by,
 old_coverage_category_nurtec,
 old_coverage_category_qulitpa,
 old_coverage_category_austedo_hd,
 old_coverage_category_austedo_td,
 old_coverage_category_ingrezza_td
)
AS
 SELECT amb4_cdw_v1.ftf_health_plan_fid,
        amb4_cdw_v1.ftf_health_plan_name,
        amb4_cdw_v1.old_coverage_category_ajovy,
        amb4_cdw_v1.old_coverage_category_aimovig,
        amb4_cdw_v1.old_coverage_category_emgality,
        amb4_cdw_v1.old_ftf_provider_fid,
        amb4_cdw_v1.old_ftf_provider_name,
        amb4_cdw_v1.old_ftf_parent_name,
        amb4_cdw_v1.old_paytype_index,
        amb4_cdw_v1.old_paytype,
        amb4_cdw_v1.old_ftf_health_plan_type,
        amb4_cdw_v1.old_pref_brand_tier,
        amb4_cdw_v1.old_key_controlling_plan_formulary,
        amb4_cdw_v1.old_key_controlling_account,
        amb4_cdw_v1.old_key_pbm,
        amb4_cdw_v1.old_payer_pbm,
        amb4_cdw_v1.fillIn_blank_iqpayer,
        amb4_cdw_v1.fillIn_blank_iqpbm,
        amb4_cdw_v1.ftf_match_iqvia,
        amb4_cdw_v1.old_iqvia_payer_name,
        amb4_cdw_v1.old_iqvia_pbm,
        amb4_cdw_v1.old_ftf_formulary_management_pbm,
        amb4_cdw_v1.old_ftf_formulary_influencer_pbm,
        amb4_cdw_v1.old_ftf_claims_processing_pbm,
        amb4_cdw_v1.lives_mx,
        amb4_cdw_v1.new_ftf_health_plan_fid,
        amb4_cdw_v1.old_ftf_health_plan_fid,
        amb4_cdw_v1.new_ftf_health_plan_name,
        amb4_cdw_v1.old_ftf_health_plan_name,
        amb4_cdw_v1.ftf_provider_fid,
        amb4_cdw_v1.ftf_provider_name,
        amb4_cdw_v1.ftf_parent_name,
        amb4_cdw_v1.paytype_index,
        amb4_cdw_v1.paytype,
        amb4_cdw_v1.ftf_health_plan_type,
        amb4_cdw_v1.pref_brand_tier,
        amb4_cdw_v1.lives_mn,
        amb4_cdw_v1.iqvia_payer_name,
        amb4_cdw_v1.iqvia_pbm,
        amb4_cdw_v1.ftf_formulary_management_pbm,
        amb4_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_cdw_v1.ftf_claims_processing_pbm,
        amb4_cdw_v1.cycle_id,
        amb4_cdw_v1.modified_time,
        amb4_cdw_v1.modified_by,
        amb4_cdw_v1.old_coverage_category_nurtec,
        amb4_cdw_v1.old_coverage_category_qulitpa,
        amb4_cdw_v1.old_coverage_category_austedo_hd,
        amb4_cdw_v1.old_coverage_category_austedo_td,
        amb4_cdw_v1.old_coverage_category_ingrezza_td
 FROM sandbox.amb4_cdw_v1
 ORDER BY amb4_cdw_v1.cycle_id
SEGMENTED BY hash(amb4_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.amb4_iqvia_payer_cdw_v1_b0 /*+basename(amb4_iqvia_payer_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb4_iqvia_payer_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_payer_cdw_v1.ftf_provider_fid,
        amb4_iqvia_payer_cdw_v1.ftf_provider_name,
        amb4_iqvia_payer_cdw_v1.ftf_parent_name,
        amb4_iqvia_payer_cdw_v1.paytype_index,
        amb4_iqvia_payer_cdw_v1.paytype,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_payer_cdw_v1.pref_brand_tier,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_payer_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_payer_cdw_v1.iqvia_payer_name,
        amb4_iqvia_payer_cdw_v1.iqvia_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_payer_cdw_v1.lives_mn,
        amb4_iqvia_payer_cdw_v1.cycle_id,
        amb4_iqvia_payer_cdw_v1.modified_time,
        amb4_iqvia_payer_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_payer_cdw_v1
 ORDER BY amb4_iqvia_payer_cdw_v1.cycle_id
SEGMENTED BY hash(amb4_iqvia_payer_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.amb4_iqvia_pbm_cdw_v1_b0 /*+basename(amb4_iqvia_pbm_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb4_iqvia_pbm_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_name,
        amb4_iqvia_pbm_cdw_v1.ftf_parent_name,
        amb4_iqvia_pbm_cdw_v1.paytype_index,
        amb4_iqvia_pbm_cdw_v1.paytype,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_pbm_cdw_v1.pref_brand_tier,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_pbm_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_pbm_cdw_v1.iqvia_payer_name,
        amb4_iqvia_pbm_cdw_v1.iqvia_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_pbm_cdw_v1.lives_mn,
        amb4_iqvia_pbm_cdw_v1.cycle_id,
        amb4_iqvia_pbm_cdw_v1.modified_time,
        amb4_iqvia_pbm_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_pbm_cdw_v1
 ORDER BY amb4_iqvia_pbm_cdw_v1.cycle_id
SEGMENTED BY hash(amb4_iqvia_pbm_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.amb7_cdw_v1_b0 /*+basename(amb7_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT amb7_cdw_v1.ftf_health_plan_fid,
        amb7_cdw_v1.ftf_health_plan_name,
        amb7_cdw_v1.ftf_provider_fid,
        amb7_cdw_v1.ftf_provider_name,
        amb7_cdw_v1.ftf_parent_name,
        amb7_cdw_v1.paytype_index,
        amb7_cdw_v1.paytype,
        amb7_cdw_v1.ftf_health_plan_type,
        amb7_cdw_v1.pref_brand_tier,
        amb7_cdw_v1.fillIn_blank_iqpayer,
        amb7_cdw_v1.fillIn_blank_iqpbm,
        amb7_cdw_v1.ftf_match_iqvia,
        amb7_cdw_v1.iqvia_payer_name,
        amb7_cdw_v1.iqvia_pbm,
        amb7_cdw_v1.ftf_formulary_management_pbm,
        amb7_cdw_v1.ftf_formulary_influencer_pbm,
        amb7_cdw_v1.ftf_claims_processing_pbm,
        amb7_cdw_v1.lives_mn,
        amb7_cdw_v1.calculated_pbm_value,
        amb7_cdw_v1.key_pbm,
        amb7_cdw_v1.cycle_id,
        amb7_cdw_v1.modified_time,
        amb7_cdw_v1.modified_by
 FROM sandbox.amb7_cdw_v1
 ORDER BY amb7_cdw_v1.cycle_id
SEGMENTED BY hash(amb7_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_hpid_keypbm_cdw_v1_b0 /*+basename(ftf_hpid_keypbm_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 paytype,
 iqvia_pbm,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hpid_keypbm_cdw_v1.ftf_health_plan_fid,
        ftf_hpid_keypbm_cdw_v1.ftf_health_plan_name,
        ftf_hpid_keypbm_cdw_v1.ftf_provider_name,
        ftf_hpid_keypbm_cdw_v1.paytype,
        ftf_hpid_keypbm_cdw_v1.iqvia_pbm,
        ftf_hpid_keypbm_cdw_v1.key_pbm,
        ftf_hpid_keypbm_cdw_v1.cycle_id,
        ftf_hpid_keypbm_cdw_v1.modified_time,
        ftf_hpid_keypbm_cdw_v1.modified_by
 FROM sandbox.ftf_hpid_keypbm_cdw_v1
 ORDER BY ftf_hpid_keypbm_cdw_v1.ftf_health_plan_fid,
          ftf_hpid_keypbm_cdw_v1.ftf_health_plan_name,
          ftf_hpid_keypbm_cdw_v1.ftf_provider_name,
          ftf_hpid_keypbm_cdw_v1.paytype,
          ftf_hpid_keypbm_cdw_v1.iqvia_pbm
SEGMENTED BY hash(ftf_hpid_keypbm_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.plan_prod_master_cdw_v1_b0 /*+basename(plan_prod_master_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 tier,
 has_pa,
 has_st,
 formulary,
 copay_tier,
 tier_cat,
 restcat,
 restriction_category,
 coverage_cat_code,
 coverage_category,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT plan_prod_master_cdw_v1.ftf_health_plan_fid,
        plan_prod_master_cdw_v1.ftf_health_plan_name,
        plan_prod_master_cdw_v1.ftf_provider_fid,
        plan_prod_master_cdw_v1.ftf_provider_name,
        plan_prod_master_cdw_v1.ftf_parent_name,
        plan_prod_master_cdw_v1.paytype_index,
        plan_prod_master_cdw_v1.paytype,
        plan_prod_master_cdw_v1.ftf_health_plan_type,
        plan_prod_master_cdw_v1.pref_brand_tier,
        plan_prod_master_cdw_v1.fillIn_blank_iqpayer,
        plan_prod_master_cdw_v1.fillIn_blank_iqpbm,
        plan_prod_master_cdw_v1.ftf_match_iqvia,
        plan_prod_master_cdw_v1.iqvia_payer_name,
        plan_prod_master_cdw_v1.iqvia_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        plan_prod_master_cdw_v1.lives_mn,
        plan_prod_master_cdw_v1.calculated_pbm_value,
        plan_prod_master_cdw_v1.key_pbm,
        plan_prod_master_cdw_v1.drug_id,
        plan_prod_master_cdw_v1.drug_seq,
        plan_prod_master_cdw_v1.tier_code,
        plan_prod_master_cdw_v1.restrictions,
        plan_prod_master_cdw_v1.reason_code,
        plan_prod_master_cdw_v1.pharmacy_status,
        plan_prod_master_cdw_v1.botox,
        plan_prod_master_cdw_v1.step,
        plan_prod_master_cdw_v1.pres_pa,
        plan_prod_master_cdw_v1.pat_pa,
        plan_prod_master_cdw_v1.med_rec,
        plan_prod_master_cdw_v1.unspec,
        plan_prod_master_cdw_v1.tier,
        plan_prod_master_cdw_v1.has_pa,
        plan_prod_master_cdw_v1.has_st,
        plan_prod_master_cdw_v1.formulary,
        plan_prod_master_cdw_v1.copay_tier,
        plan_prod_master_cdw_v1.tier_cat,
        plan_prod_master_cdw_v1.restcat,
        plan_prod_master_cdw_v1.restriction_category,
        plan_prod_master_cdw_v1.coverage_cat_code,
        plan_prod_master_cdw_v1.coverage_category,
        plan_prod_master_cdw_v1.cycle_id,
        plan_prod_master_cdw_v1.modified_time,
        plan_prod_master_cdw_v1.modified_by
 FROM sandbox.plan_prod_master_cdw_v1
 ORDER BY plan_prod_master_cdw_v1.ftf_health_plan_fid,
          plan_prod_master_cdw_v1.drug_seq
SEGMENTED BY hash(plan_prod_master_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_plan_master_file_cdw_v1_b0 /*+basename(ftf_plan_master_file_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 product,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 botox,
 botox_step_flag,
 step,
 step_category,
 pres_pa,
 prescriber_prior_authorization_category,
 pat_pa,
 med_rec,
 unspec,
 patient_prior_authorization_category,
 medical_records_submission_required_flag,
 unspecified_restriction_flag,
 ftf_tier,
 has_pa,
 has_st,
 formulary,
 copay_Tier,
 tier_cat,
 restcat,
 restriction_category,
 coverage_cat_code,
 coverage_category,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_plan_master_file_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_cdw_v1.ftf_provider_fid,
        ftf_plan_master_file_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_cdw_v1.ftf_parent_name,
        ftf_plan_master_file_cdw_v1.paytype_index,
        ftf_plan_master_file_cdw_v1.paytype,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpayer,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpbm,
        ftf_plan_master_file_cdw_v1.ftf_match_iqvia,
        ftf_plan_master_file_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_cdw_v1.lives_mn,
        ftf_plan_master_file_cdw_v1.calculated_pbm_value,
        ftf_plan_master_file_cdw_v1.key_pbm,
        ftf_plan_master_file_cdw_v1.drug_id,
        ftf_plan_master_file_cdw_v1.drug_seq,
        ftf_plan_master_file_cdw_v1.product,
        ftf_plan_master_file_cdw_v1.tier_code,
        ftf_plan_master_file_cdw_v1.restrictions,
        ftf_plan_master_file_cdw_v1.reason_code,
        ftf_plan_master_file_cdw_v1.pharmacy_status,
        ftf_plan_master_file_cdw_v1.botox,
        ftf_plan_master_file_cdw_v1.botox_step_flag,
        ftf_plan_master_file_cdw_v1.step,
        ftf_plan_master_file_cdw_v1.step_category,
        ftf_plan_master_file_cdw_v1.pres_pa,
        ftf_plan_master_file_cdw_v1.prescriber_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.pat_pa,
        ftf_plan_master_file_cdw_v1.med_rec,
        ftf_plan_master_file_cdw_v1.unspec,
        ftf_plan_master_file_cdw_v1.patient_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.medical_records_submission_required_flag,
        ftf_plan_master_file_cdw_v1.unspecified_restriction_flag,
        ftf_plan_master_file_cdw_v1.ftf_tier,
        ftf_plan_master_file_cdw_v1.has_pa,
        ftf_plan_master_file_cdw_v1.has_st,
        ftf_plan_master_file_cdw_v1.formulary,
        ftf_plan_master_file_cdw_v1.copay_Tier,
        ftf_plan_master_file_cdw_v1.tier_cat,
        ftf_plan_master_file_cdw_v1.restcat,
        ftf_plan_master_file_cdw_v1.restriction_category,
        ftf_plan_master_file_cdw_v1.coverage_cat_code,
        ftf_plan_master_file_cdw_v1.coverage_category,
        ftf_plan_master_file_cdw_v1.key_controlling_account,
        ftf_plan_master_file_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_cdw_v1.payer_pbm,
        ftf_plan_master_file_cdw_v1.cycle_id,
        ftf_plan_master_file_cdw_v1.modified_time,
        ftf_plan_master_file_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_cdw_v1
 ORDER BY ftf_plan_master_file_cdw_v1.ftf_health_plan_fid,
          ftf_plan_master_file_cdw_v1.ftf_health_plan_name,
          ftf_plan_master_file_cdw_v1.ftf_provider_fid,
          ftf_plan_master_file_cdw_v1.ftf_provider_name,
          ftf_plan_master_file_cdw_v1.ftf_parent_name,
          ftf_plan_master_file_cdw_v1.paytype_index,
          ftf_plan_master_file_cdw_v1.paytype,
          ftf_plan_master_file_cdw_v1.ftf_health_plan_type,
          ftf_plan_master_file_cdw_v1.pref_brand_tier,
          ftf_plan_master_file_cdw_v1.fillIn_blank_iqpayer,
          ftf_plan_master_file_cdw_v1.fillIn_blank_iqpbm,
          ftf_plan_master_file_cdw_v1.ftf_match_iqvia,
          ftf_plan_master_file_cdw_v1.iqvia_payer_name,
          ftf_plan_master_file_cdw_v1.iqvia_pbm,
          ftf_plan_master_file_cdw_v1.ftf_formulary_management_pbm,
          ftf_plan_master_file_cdw_v1.ftf_formulary_influencer_pbm,
          ftf_plan_master_file_cdw_v1.ftf_claims_processing_pbm,
          ftf_plan_master_file_cdw_v1.lives_mn,
          ftf_plan_master_file_cdw_v1.calculated_pbm_value,
          ftf_plan_master_file_cdw_v1.key_pbm,
          ftf_plan_master_file_cdw_v1.drug_id,
          ftf_plan_master_file_cdw_v1.drug_seq
SEGMENTED BY hash(ftf_plan_master_file_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.pivot_plan_prod_master_cdw_v1_b0 /*+basename(pivot_plan_prod_master_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 paytype_index,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 pref_brand_tier,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 prev_lives,
 ftf_match_iqvia,
 cycle_id,
 modified_time,
 modified_by,
 Coverage_Category_Nurtec,
 Coverage_Category_Qulipta,
 Coverage_Category_Austedo_HD,
 Coverage_Category_Austedo_TD,
 Coverage_Category_Ingrezza_TD
)
AS
 SELECT pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_name,
        pivot_plan_prod_master_cdw_v1.ftf_provider_fid,
        pivot_plan_prod_master_cdw_v1.ftf_provider_name,
        pivot_plan_prod_master_cdw_v1.ftf_parent_name,
        pivot_plan_prod_master_cdw_v1.paytype,
        pivot_plan_prod_master_cdw_v1.paytype_index,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_type,
        pivot_plan_prod_master_cdw_v1.key_controlling_account,
        pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_cdw_v1.key_controlling_parent,
        pivot_plan_prod_master_cdw_v1.payer_pbm,
        pivot_plan_prod_master_cdw_v1.key_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        pivot_plan_prod_master_cdw_v1.lives_mn,
        pivot_plan_prod_master_cdw_v1.iqvia_payer_name,
        pivot_plan_prod_master_cdw_v1.iqvia_pbm,
        pivot_plan_prod_master_cdw_v1.pref_brand_tier,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality,
        pivot_plan_prod_master_cdw_v1.prev_lives,
        pivot_plan_prod_master_cdw_v1.ftf_match_iqvia,
        pivot_plan_prod_master_cdw_v1.cycle_id,
        pivot_plan_prod_master_cdw_v1.modified_time,
        pivot_plan_prod_master_cdw_v1.modified_by,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Nurtec,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Qulipta,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Austedo_HD,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Austedo_TD,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Ingrezza_TD
 FROM sandbox.pivot_plan_prod_master_cdw_v1
 ORDER BY pivot_plan_prod_master_cdw_v1.cycle_id
SEGMENTED BY hash(pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.copay_tier_derivation_config_v01_tmp_b0 /*+basename(copay_tier_derivation_config_v01_tmp),createtype(L)*/ 
(
 pharmacy_status_regex,
 tier_cat,
 tier_regex,
 pref_brand_tier_regex,
 ftf_health_plan_type_regex,
 copay_tier,
 file_id,
 record_id
)
AS
 SELECT copay_tier_derivation_config_v01_tmp.pharmacy_status_regex,
        copay_tier_derivation_config_v01_tmp.tier_cat,
        copay_tier_derivation_config_v01_tmp.tier_regex,
        copay_tier_derivation_config_v01_tmp.pref_brand_tier_regex,
        copay_tier_derivation_config_v01_tmp.ftf_health_plan_type_regex,
        copay_tier_derivation_config_v01_tmp.copay_tier,
        copay_tier_derivation_config_v01_tmp.file_id,
        copay_tier_derivation_config_v01_tmp.record_id
 FROM sandbox.copay_tier_derivation_config_v01_tmp
 ORDER BY copay_tier_derivation_config_v01_tmp.pharmacy_status_regex
SEGMENTED BY hash(copay_tier_derivation_config_v01_tmp.pharmacy_status_regex) ALL NODES;

CREATE PROJECTION sandbox.tier_cat_description_mapping_v01_tmp_b0 /*+basename(tier_cat_description_mapping_v01_tmp),createtype(L)*/ 
(
 tier_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT tier_cat_description_mapping_v01_tmp.tier_cat,
        tier_cat_description_mapping_v01_tmp.description,
        tier_cat_description_mapping_v01_tmp.notes,
        tier_cat_description_mapping_v01_tmp.file_id,
        tier_cat_description_mapping_v01_tmp.record_id
 FROM sandbox.tier_cat_description_mapping_v01_tmp
 ORDER BY tier_cat_description_mapping_v01_tmp.tier_cat,
          tier_cat_description_mapping_v01_tmp.description,
          tier_cat_description_mapping_v01_tmp.notes,
          tier_cat_description_mapping_v01_tmp.file_id,
          tier_cat_description_mapping_v01_tmp.record_id
SEGMENTED BY hash(tier_cat_description_mapping_v01_tmp.tier_cat, tier_cat_description_mapping_v01_tmp.description, tier_cat_description_mapping_v01_tmp.notes, tier_cat_description_mapping_v01_tmp.file_id, tier_cat_description_mapping_v01_tmp.record_id) ALL NODES;

CREATE PROJECTION sandbox.coverage_category_derivation_config_v01_tmp_b0 /*+basename(coverage_category_derivation_config_v01_tmp),createtype(L)*/ 
(
 paytype_regex,
 pharmacy_status_regex,
 coverage_cat_code,
 coverage_category,
 restriction_cat_code_regex,
 meaning,
 file_id,
 record_id
)
AS
 SELECT coverage_category_derivation_config_v01_tmp.paytype_regex,
        coverage_category_derivation_config_v01_tmp.pharmacy_status_regex,
        coverage_category_derivation_config_v01_tmp.coverage_cat_code,
        coverage_category_derivation_config_v01_tmp.coverage_category,
        coverage_category_derivation_config_v01_tmp.restriction_cat_code_regex,
        coverage_category_derivation_config_v01_tmp.meaning,
        coverage_category_derivation_config_v01_tmp.file_id,
        coverage_category_derivation_config_v01_tmp.record_id
 FROM sandbox.coverage_category_derivation_config_v01_tmp
 ORDER BY coverage_category_derivation_config_v01_tmp.paytype_regex,
          coverage_category_derivation_config_v01_tmp.pharmacy_status_regex,
          coverage_category_derivation_config_v01_tmp.coverage_cat_code,
          coverage_category_derivation_config_v01_tmp.coverage_category,
          coverage_category_derivation_config_v01_tmp.restriction_cat_code_regex,
          coverage_category_derivation_config_v01_tmp.meaning,
          coverage_category_derivation_config_v01_tmp.file_id,
          coverage_category_derivation_config_v01_tmp.record_id
SEGMENTED BY hash(coverage_category_derivation_config_v01_tmp.coverage_cat_code, coverage_category_derivation_config_v01_tmp.file_id, coverage_category_derivation_config_v01_tmp.record_id, coverage_category_derivation_config_v01_tmp.paytype_regex, coverage_category_derivation_config_v01_tmp.pharmacy_status_regex, coverage_category_derivation_config_v01_tmp.coverage_category, coverage_category_derivation_config_v01_tmp.restriction_cat_code_regex, coverage_category_derivation_config_v01_tmp.meaning) ALL NODES;

CREATE PROJECTION sandbox.copay_tier_derivation_config_v01_b0 /*+basename(copay_tier_derivation_config_v01),createtype(L)*/ 
(
 pharmacy_status_regex,
 tier_cat,
 tier_regex,
 pref_brand_tier_regex,
 ftf_health_plan_type_regex,
 copay_tier,
 file_id,
 record_id
)
AS
 SELECT copay_tier_derivation_config_v01.pharmacy_status_regex,
        copay_tier_derivation_config_v01.tier_cat,
        copay_tier_derivation_config_v01.tier_regex,
        copay_tier_derivation_config_v01.pref_brand_tier_regex,
        copay_tier_derivation_config_v01.ftf_health_plan_type_regex,
        copay_tier_derivation_config_v01.copay_tier,
        copay_tier_derivation_config_v01.file_id,
        copay_tier_derivation_config_v01.record_id
 FROM sandbox.copay_tier_derivation_config_v01
 ORDER BY copay_tier_derivation_config_v01.pharmacy_status_regex
SEGMENTED BY hash(copay_tier_derivation_config_v01.pharmacy_status_regex) ALL NODES;

CREATE PROJECTION sandbox.tier_cat_description_mapping_v01_b0 /*+basename(tier_cat_description_mapping_v01),createtype(L)*/ 
(
 tier_cat,
 description,
 notes,
 file_id,
 record_id
)
AS
 SELECT tier_cat_description_mapping_v01.tier_cat,
        tier_cat_description_mapping_v01.description,
        tier_cat_description_mapping_v01.notes,
        tier_cat_description_mapping_v01.file_id,
        tier_cat_description_mapping_v01.record_id
 FROM sandbox.tier_cat_description_mapping_v01
 ORDER BY tier_cat_description_mapping_v01.tier_cat,
          tier_cat_description_mapping_v01.description,
          tier_cat_description_mapping_v01.notes,
          tier_cat_description_mapping_v01.file_id,
          tier_cat_description_mapping_v01.record_id
SEGMENTED BY hash(tier_cat_description_mapping_v01.tier_cat, tier_cat_description_mapping_v01.description, tier_cat_description_mapping_v01.notes, tier_cat_description_mapping_v01.file_id, tier_cat_description_mapping_v01.record_id) ALL NODES;

CREATE PROJECTION sandbox.coverage_category_derivation_config_v01_b0 /*+basename(coverage_category_derivation_config_v01),createtype(L)*/ 
(
 paytype_regex,
 pharmacy_status_regex,
 coverage_cat_code,
 coverage_category,
 restriction_cat_code_regex,
 meaning,
 file_id,
 record_id
)
AS
 SELECT coverage_category_derivation_config_v01.paytype_regex,
        coverage_category_derivation_config_v01.pharmacy_status_regex,
        coverage_category_derivation_config_v01.coverage_cat_code,
        coverage_category_derivation_config_v01.coverage_category,
        coverage_category_derivation_config_v01.restriction_cat_code_regex,
        coverage_category_derivation_config_v01.meaning,
        coverage_category_derivation_config_v01.file_id,
        coverage_category_derivation_config_v01.record_id
 FROM sandbox.coverage_category_derivation_config_v01
 ORDER BY coverage_category_derivation_config_v01.paytype_regex,
          coverage_category_derivation_config_v01.pharmacy_status_regex,
          coverage_category_derivation_config_v01.coverage_cat_code,
          coverage_category_derivation_config_v01.coverage_category,
          coverage_category_derivation_config_v01.restriction_cat_code_regex,
          coverage_category_derivation_config_v01.meaning,
          coverage_category_derivation_config_v01.file_id,
          coverage_category_derivation_config_v01.record_id
SEGMENTED BY hash(coverage_category_derivation_config_v01.coverage_cat_code, coverage_category_derivation_config_v01.file_id, coverage_category_derivation_config_v01.record_id, coverage_category_derivation_config_v01.paytype_regex, coverage_category_derivation_config_v01.pharmacy_status_regex, coverage_category_derivation_config_v01.coverage_category, coverage_category_derivation_config_v01.restriction_cat_code_regex, coverage_category_derivation_config_v01.meaning) ALL NODES;

CREATE PROJECTION sandbox.comparison_ftf_health_plan_fid_cdw_v1_b0 /*+basename(comparison_ftf_health_plan_fid_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 iqvia_payer_name,
 iqvia_pbm,
 pref_brand_tier,
 Coverage_Category_Ajovy,
 Coverage_Category_Aimovig,
 Coverage_Category_Emgality,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_provider_fid,
 change_ftf_provider_name,
 change_ftf_parent_name,
 change_paytype,
 change_ftf_health_plan_type,
 change_key_controlling_account,
 change_key_controlling_plan_formulary,
 change_key_controlling_parent,
 change_payer_pbm,
 change_key_pbm,
 change_ftf_formulary_management_pbm,
 change_ftf_formulary_influencer_pbm,
 change_ftf_claims_processing_pbm,
 change_lives_mn,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_pref_brand_tier,
 change_Coverage_Category_Ajovy,
 change_Coverage_Category_Aimovig,
 change_Coverage_Category_Emgality,
 change,
 month_flag,
 status,
 change_in_lives,
 cycle_id,
 modified_time,
 modified_by,
 Coverage_Category_Nurtec,
 Coverage_Category_Qulipta,
 change_Coverage_Category_Nurtec,
 change_Coverage_Category_Qulipta
)
AS
 SELECT comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.paytype,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_paytype,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.change_payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.change,
        comparison_ftf_health_plan_fid_cdw_v1.month_flag,
        comparison_ftf_health_plan_fid_cdw_v1.status,
        comparison_ftf_health_plan_fid_cdw_v1.change_in_lives,
        comparison_ftf_health_plan_fid_cdw_v1.cycle_id,
        comparison_ftf_health_plan_fid_cdw_v1.modified_time,
        comparison_ftf_health_plan_fid_cdw_v1.modified_by,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Nurtec,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Qulipta,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Nurtec,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Qulipta
 FROM sandbox.comparison_ftf_health_plan_fid_cdw_v1
 ORDER BY comparison_ftf_health_plan_fid_cdw_v1.cycle_id
SEGMENTED BY hash(comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid, comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid, comparison_ftf_health_plan_fid_cdw_v1.lives_mn, comparison_ftf_health_plan_fid_cdw_v1.pref_brand_tier, comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_fid, comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_name, comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_fid, comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_name) ALL NODES;

CREATE PROJECTION sandbox.key_controller_list_v01_temp_b0 /*+basename(key_controller_list_v01_temp),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT key_controller_list_v01_temp.ftf_health_plan_fid,
        key_controller_list_v01_temp.ftf_health_plan_name,
        key_controller_list_v01_temp.key_controlling_account,
        key_controller_list_v01_temp.key_controlling_plan_formulary,
        key_controller_list_v01_temp.key_controlling_parent,
        key_controller_list_v01_temp.payer_pbm,
        key_controller_list_v01_temp.file_id,
        key_controller_list_v01_temp.record_id
 FROM sandbox.key_controller_list_v01_temp
 ORDER BY key_controller_list_v01_temp.ftf_health_plan_fid,
          key_controller_list_v01_temp.ftf_health_plan_name
SEGMENTED BY hash(key_controller_list_v01_temp.ftf_health_plan_fid, key_controller_list_v01_temp.file_id, key_controller_list_v01_temp.record_id, key_controller_list_v01_temp.payer_pbm, key_controller_list_v01_temp.ftf_health_plan_name, key_controller_list_v01_temp.key_controlling_account, key_controller_list_v01_temp.key_controlling_plan_formulary, key_controller_list_v01_temp.key_controlling_parent) ALL NODES;

CREATE PROJECTION sandbox.sh_sol_enrollment_b0 /*+basename(sh_sol_enrollment),createtype(A)*/ 
(
 basket_name,
 referral_date,
 prescribing_physician_npi,
 first_ship_date,
 tvcmid
)
AS
 SELECT sh_sol_enrollment.basket_name,
        sh_sol_enrollment.referral_date,
        sh_sol_enrollment.prescribing_physician_npi,
        sh_sol_enrollment.first_ship_date,
        sh_sol_enrollment.tvcmid
 FROM sandbox.sh_sol_enrollment
 ORDER BY sh_sol_enrollment.basket_name,
          sh_sol_enrollment.referral_date,
          sh_sol_enrollment.prescribing_physician_npi,
          sh_sol_enrollment.first_ship_date,
          sh_sol_enrollment.tvcmid
SEGMENTED BY hash(sh_sol_enrollment.referral_date, sh_sol_enrollment.first_ship_date, sh_sol_enrollment.tvcmid, sh_sol_enrollment.prescribing_physician_npi, sh_sol_enrollment.basket_name) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_geography_summary_b0 /*+basename(ts_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT ts_monthly_geography_summary.sales_force_id,
        ts_monthly_geography_summary.geography_level,
        ts_monthly_geography_summary.geography_id,
        ts_monthly_geography_summary.geography,
        ts_monthly_geography_summary.rep_name,
        ts_monthly_geography_summary.user_id,
        ts_monthly_geography_summary.time_period,
        ts_monthly_geography_summary.period_type,
        ts_monthly_geography_summary.period,
        ts_monthly_geography_summary.market_id,
        ts_monthly_geography_summary.market_name,
        ts_monthly_geography_summary.brand_id,
        ts_monthly_geography_summary.brand_name,
        ts_monthly_geography_summary.teva_product_flag,
        ts_monthly_geography_summary.target_status_flag,
        ts_monthly_geography_summary.method_of_payment,
        ts_monthly_geography_summary.specialty,
        ts_monthly_geography_summary.segment,
        ts_monthly_geography_summary.rep_type,
        ts_monthly_geography_summary.market_volume_indicator,
        ts_monthly_geography_summary.product_vol_trx_count,
        ts_monthly_geography_summary.product_vol_new_pres_trx_count,
        ts_monthly_geography_summary.market_vol_trx_count,
        ts_monthly_geography_summary.prev_prod_vol_trx_count,
        ts_monthly_geography_summary.prev_market_vol_trx_count,
        ts_monthly_geography_summary.product_vol_nrx_count,
        ts_monthly_geography_summary.product_vol_new_pres_nrx_count,
        ts_monthly_geography_summary.market_vol_nrx_count,
        ts_monthly_geography_summary.prev_prod_vol_nrx_count,
        ts_monthly_geography_summary.prev_market_vol_nrx_count,
        ts_monthly_geography_summary.prescribers_count,
        ts_monthly_geography_summary.new_prescribers_count,
        ts_monthly_geography_summary.decile
 FROM sandbox.ts_monthly_geography_summary
 ORDER BY ts_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(ts_monthly_geography_summary.market_id, ts_monthly_geography_summary.brand_id, ts_monthly_geography_summary.teva_product_flag, ts_monthly_geography_summary.target_status_flag, ts_monthly_geography_summary.market_volume_indicator, ts_monthly_geography_summary.prescribers_count, ts_monthly_geography_summary.new_prescribers_count, ts_monthly_geography_summary.geography_level) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_b0 /*+basename(ic_rx),createtype(L)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx.ic_data_month,
        ic_rx.basket_name,
        ic_rx.sales_force_id,
        ic_rx.area_number,
        ic_rx.region_number,
        ic_rx.territory_number,
        ic_rx.ims_id,
        ic_rx.tvcmid,
        ic_rx.outlet_code,
        ic_rx.va_station_number,
        ic_rx.dnc_flag,
        ic_rx.dnp_flag,
        ic_rx.rollup_month,
        ic_rx.month_bucket,
        ic_rx.nrx_count,
        ic_rx.trx_count,
        ic_rx.nrx_quantity,
        ic_rx.trx_quantity,
        ic_rx.include_in_nation_rollup,
        ic_rx.include_in_area_rollup,
        ic_rx.include_in_region_rollup,
        ic_rx.join_key,
        ic_rx.row_source,
        ic_rx.row_create_date,
        ic_rx.indication,
        ic_rx.outlet_dea,
        ic_rx.payer_plan_number,
        ic_rx.payment_method
 FROM sandbox.ic_rx
 ORDER BY ic_rx.area_number,
          ic_rx.region_number,
          ic_rx.territory_number,
          ic_rx.ims_id,
          ic_rx.tvcmid
SEGMENTED BY hash(ic_rx.ic_data_month, ic_rx.tvcmid, ic_rx.outlet_code, ic_rx.dnc_flag, ic_rx.dnp_flag, ic_rx.rollup_month, ic_rx.month_bucket, ic_rx.nrx_count, ic_rx.trx_count, ic_rx.nrx_quantity, ic_rx.trx_quantity, ic_rx.include_in_nation_rollup, ic_rx.include_in_area_rollup, ic_rx.include_in_region_rollup, ic_rx.row_create_date, ic_rx.ims_id, ic_rx.va_station_number, ic_rx.join_key, ic_rx.area_number, ic_rx.region_number, ic_rx.territory_number, ic_rx.sales_force_id, ic_rx.row_source, ic_rx.basket_name) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_b0 /*+basename(ic_demo),createtype(L)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo.ic_data_month,
        ic_demo.sales_force_id,
        ic_demo.area_number,
        ic_demo.region_number,
        ic_demo.territory_number,
        ic_demo.ims_id,
        ic_demo.tvcmid,
        ic_demo.outlet_code,
        ic_demo.va_station_number,
        ic_demo.specialty,
        ic_demo.last_name,
        ic_demo.first_name,
        ic_demo.mid_name,
        ic_demo.address_1,
        ic_demo.address_2,
        ic_demo.address_3,
        ic_demo.city,
        ic_demo.state,
        ic_demo.zip,
        ic_demo.address_source,
        ic_demo.pdrp_flag,
        ic_demo.pdrp_date,
        ic_demo.np_pa_flag,
        ic_demo.no_spend,
        ic_demo.ama_no_contact_flag,
        ic_demo.join_key,
        ic_demo.row_source,
        ic_demo.row_create_date,
        ic_demo.outlet_dea,
        ic_demo.secondary_specialty
 FROM sandbox.ic_demo
 ORDER BY ic_demo.area_number,
          ic_demo.region_number,
          ic_demo.territory_number,
          ic_demo.ims_id,
          ic_demo.tvcmid
SEGMENTED BY hash(ic_demo.ic_data_month, ic_demo.tvcmid, ic_demo.outlet_code, ic_demo.mid_name, ic_demo.state, ic_demo.zip, ic_demo.pdrp_flag, ic_demo.pdrp_date, ic_demo.np_pa_flag, ic_demo.no_spend, ic_demo.ama_no_contact_flag, ic_demo.row_create_date, ic_demo.ims_id, ic_demo.va_station_number, ic_demo.specialty, ic_demo.join_key, ic_demo.area_number, ic_demo.region_number, ic_demo.territory_number, ic_demo.sales_force_id, ic_demo.first_name, ic_demo.city, ic_demo.address_source, ic_demo.last_name, ic_demo.address_1, ic_demo.address_2, ic_demo.address_3, ic_demo.row_source) ALL NODES;

CREATE PROJECTION sandbox.qims_td_target_univ_b0 /*+basename(qims_td_target_univ),createtype(L)*/ 
(
 PRESCRIBER_ID,
 ME_NBR,
 IMS_ID,
 NPI,
 PRIMARY_SPECIALTY,
 SECONDARY_SPECIALTY,
 PRIMARY_SPECIALTY_GROUP,
 SECONDARY_SPECIALTY_GROUP,
 GENDER_CD,
 FIRST_NAME,
 LAST_NAME,
 MID_NAME,
 ADDRESS_1,
 ADDRESS_2,
 CITY,
 STATE,
 ZIP,
 AMA_NO_CONTACT_INDICATOR,
 AMA_PDRP_IND,
 PROVIDER_TYP_DESC,
 TARGET_Y_N,
 ADOPTION_CATEGORY,
 CMHC_AFFILIATION_Y_N,
 INFLUENCER,
 INFLUENCER_MVT_DIS_LEADER,
 INFLUENCER_BHVR_HLTH_LEADER,
 PRIORITY_FLAG_Y_N,
 DIAGNOSED_TD_PAT_CNT,
 OVERALL_DIAGNOSED_TD_PAT_CNT,
 OVERALL_UNIQUE_DIAG_TD_PAT_CNT,
 PREDICTED_TD_PAT_CNT_HIGH,
 PREDICTED_TD_PAT_CNT_UNIQUE_HIGH,
 SUM_OF_SCORES_PREDICTED_PAT_CNT_HIGH,
 SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_HIGH,
 TOTAL_OPPORTUNITY_HIGH,
 PREDICTED_TD_PAT_CNT_MEDIUM,
 PREDICTED_TD_PAT_CNT_UNIQUE_MEDIUM,
 SUM_OF_SCORES_PREDICTED_PAT_CNT_MEDIUM,
 SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_MEDIUM,
 TOTAL_OPPORTUNITY_MEDIUM,
 TOTAL_OPPORTUNITY_DIAG_HIGH_MEDIUM,
 RANK,
 DECILE_PAT_CNT,
 DECILE_SUM_OF_SCORES,
 DECILE_SUM_OF_SCORES_UNIQUE,
 DECILE_OLD,
 APD_PAT_CNT,
 APD_PAT_CNT_TD_HIGH,
 APD_PAT_CNT_TD_MEDIUM,
 DIAGN_TD_MDD_BPD_SCZ_PAT_CNT,
 OVERALL_DIAG_TD_MDD_BPD_SCZ_PT,
 PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_HIGH,
 TOTAL_OPPORTUNITY_MDD_BPD_SCZ_HIGH,
 PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_MEDIUM,
 TOTAL_OPPORTUNITY_MDD_BPD_SCZ_MEDIUM,
 DIAGNOSED_TD_MDD_PAT_CNT,
 OVERALL_DIAGNOSED_TD_MDD_PAT,
 PREDICTED_TD_MDD_PAT_CNT_HIGH,
 TOTAL_OPPORTUNITY_MDD_HIGH,
 PREDICTED_TD_MDD_PAT_CNT_MEDIUM,
 TOTAL_OPPORTUNITY_MDD_MEDIUM,
 DIAGNOSED_TD_BPD_PAT_CNT,
 OVERALL_DIAGNOSED_TD_BPD_PAT_CNT,
 PREDICTED_TD_BPD_PAT_CNT_HIGH,
 TOTAL_OPPORTUNITY_BPD_HIGH,
 PREDICTED_TD_BPD_PAT_CNT_MEDIUM,
 TOTAL_OPPORTUNITY_BPD_MEDIUM,
 DIAGNOSED_TD_SCZ_PAT_CNT,
 OVERALL_DIAGNOSED_TD_SCZ_PAT_CNT,
 PREDICTED_TD_SCZ_PAT_CNT_HIGH,
 TOTAL_OPPORTUNITY_SCZ_HIGH,
 PREDICTED_TD_SCZ_PAT_CNT_MEDIUM,
 TOTAL_OPPORTUNITY_SCZ_MEDIUM,
 APD_CLM_CNT,
 APD_CLM_CNT_TD_HIGH,
 APD_CLM_CNT_TD_MEDIUM,
 DIAGNOSED_TD_CLM_CNT,
 METO_CLM_CNT,
 ARIPIPRAZOLE_CLM_CNT,
 ASENAPINE_CLM_CNT,
 BREXPIPRAZOLE_CLM_CNT,
 CARIPRAZINE_CLM_CNT,
 CHLORPROMAZINE_CLM_CNT,
 CLOZAPINE_CLM_CNT,
 DROPERIDOL_CLM_CNT,
 FLUPHENAZINE_CLM_CNT,
 HALOPERIDOL_CLM_CNT,
 ILOPERIDONE_CLM_CNT,
 LOXAPINE_CLM_CNT,
 LURASIDONE_CLM_CNT,
 MOLINDONE_CLM_CNT,
 OLANZAPINE_CLM_CNT,
 PALIPERIDONE_CLM_CNT,
 PERPHENAZINE_CLM_CNT,
 PIMAVANSERIN_CLM_CNT,
 PIMOZIDE_CLM_CNT,
 PROCHLORPERAZINE_CLM_CNT,
 QUETIAPINE_CLM_CNT,
 RISPERIDONE_CLM_CNT,
 THIORIDAZINE_CLM_CNT,
 THIOTHIXENE_CLM_CNT,
 TRIFLUOPERAZINE_CLM_CNT,
 ZIPRASIDONE_CLM_CNT,
 ABILIFY_LTC_TRX,
 ABILIFY_DISCMELT_LTC_TRX,
 ABILIFY_MAINTENA_LTC_TRX,
 ARIPIPRAZOLE_LTC_TRX,
 ARIPIPRAZOLE_ODT_LTC_TRX,
 ARISTADA_LTC_TRX,
 CHLORPROMAZINE_HCL_LTC_TRX,
 CLOZAPINE_LTC_TRX,
 CLOZAPINE_ODT_LTC_TRX,
 CLOZARIL_LTC_TRX,
 COMPRO_LTC_TRX,
 FANAPT_LTC_TRX,
 FANAPT_TITRATION_PACK_LTC_TRX,
 FAZACLO_LTC_TRX,
 FLUPHENAZINE_DECANOATE_LTC_TRX,
 FLUPHENAZINE_HCL_LTC_TRX,
 GEODON_LTC_TRX,
 HALDOL_LTC_TRX,
 HALDOL_DECANOATE_100_LTC_TRX,
 HALDOL_DECANOATE_50_LTC_TRX,
 HALOPERIDOL_LTC_TRX,
 HALOPERIDOL_DECANOATE_LTC_TRX,
 HALOPERIDOL_LACTATE_LTC_TRX,
 INVEGA_LTC_TRX,
 INVEGA_SUSTENNA_LTC_TRX,
 INVEGA_TRINZA_LTC_TRX,
 LATUDA_LTC_TRX,
 LOXAPINE_LTC_TRX,
 LOXAPINE_SUCCINATE_LTC_TRX,
 MOLINDONE_HYDROCHLOR_LTC_TRX,
 NUPLAZID_LTC_TRX,
 OLANZAPINE_LTC_TRX,
 OLANZAPINE_ODT_LTC_TRX,
 OLANZAPINE_FLUOXETINE_LTC_TRX,
 ORAP_LTC_TRX,
 PALIPERIDONE_ER_LTC_TRX,
 PERPHENAZINE_LTC_TRX,
 PERPHENAZINE_AMITRIPTY_LTC_TRX,
 PIMOZIDE_LTC_TRX,
 PROCHLORPERAZINE_LTC_TRX,
 PROCHLORPERAZINE_EDISY_LTC_TRX,
 PROCHLORPERAZINE_MALEA_LTC_TRX,
 QUETIAPINE_FUMARATE_LTC_TRX,
 QUETIAPINE_FUMARATE_ER_LTC_TRX,
 REXULTI_LTC_TRX,
 RISPERDAL_LTC_TRX,
 RISPERDAL_CONSTA_LTC_TRX,
 RISPERDAL_M_TAB_LTC_TRX,
 RISPERIDONE_LTC_TRX,
 RISPERIDONE_M_TAB_LTC_TRX,
 RISPERIDONE_ODT_LTC_TRX,
 SAPHRIS_LTC_TRX,
 SEROQUEL_LTC_TRX,
 SEROQUEL_XR_LTC_TRX,
 SYMBYAX_LTC_TRX,
 THIORIDAZINE_HCL_LTC_TRX,
 THIOTHIXENE_LTC_TRX,
 TRIFLUOPERAZINE_HCL_LTC_TRX,
 VERSACLOZ_LTC_TRX,
 VRAYLAR_LTC_TRX,
 ZIPRASIDONE_HCL_LTC_TRX,
 ZYPREXA_LTC_TRX,
 ZYPREXA_RELPREVV_LTC_TRX,
 ZYPREXA_ZYDIS_LTC_TRX,
 FACILITY_TYPE
)
AS
 SELECT qims_td_target_univ.PRESCRIBER_ID,
        qims_td_target_univ.ME_NBR,
        qims_td_target_univ.IMS_ID,
        qims_td_target_univ.NPI,
        qims_td_target_univ.PRIMARY_SPECIALTY,
        qims_td_target_univ.SECONDARY_SPECIALTY,
        qims_td_target_univ.PRIMARY_SPECIALTY_GROUP,
        qims_td_target_univ.SECONDARY_SPECIALTY_GROUP,
        qims_td_target_univ.GENDER_CD,
        qims_td_target_univ.FIRST_NAME,
        qims_td_target_univ.LAST_NAME,
        qims_td_target_univ.MID_NAME,
        qims_td_target_univ.ADDRESS_1,
        qims_td_target_univ.ADDRESS_2,
        qims_td_target_univ.CITY,
        qims_td_target_univ.STATE,
        qims_td_target_univ.ZIP,
        qims_td_target_univ.AMA_NO_CONTACT_INDICATOR,
        qims_td_target_univ.AMA_PDRP_IND,
        qims_td_target_univ.PROVIDER_TYP_DESC,
        qims_td_target_univ.TARGET_Y_N,
        qims_td_target_univ.ADOPTION_CATEGORY,
        qims_td_target_univ.CMHC_AFFILIATION_Y_N,
        qims_td_target_univ.INFLUENCER,
        qims_td_target_univ.INFLUENCER_MVT_DIS_LEADER,
        qims_td_target_univ.INFLUENCER_BHVR_HLTH_LEADER,
        qims_td_target_univ.PRIORITY_FLAG_Y_N,
        qims_td_target_univ.DIAGNOSED_TD_PAT_CNT,
        qims_td_target_univ.OVERALL_DIAGNOSED_TD_PAT_CNT,
        qims_td_target_univ.OVERALL_UNIQUE_DIAG_TD_PAT_CNT,
        qims_td_target_univ.PREDICTED_TD_PAT_CNT_HIGH,
        qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_HIGH,
        qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_HIGH,
        qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_HIGH,
        qims_td_target_univ.TOTAL_OPPORTUNITY_HIGH,
        qims_td_target_univ.PREDICTED_TD_PAT_CNT_MEDIUM,
        qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_MEDIUM,
        qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_MEDIUM,
        qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_DIAG_HIGH_MEDIUM,
        qims_td_target_univ.RANK,
        qims_td_target_univ.DECILE_PAT_CNT,
        qims_td_target_univ.DECILE_SUM_OF_SCORES,
        qims_td_target_univ.DECILE_SUM_OF_SCORES_UNIQUE,
        qims_td_target_univ.DECILE_OLD,
        qims_td_target_univ.APD_PAT_CNT,
        qims_td_target_univ.APD_PAT_CNT_TD_HIGH,
        qims_td_target_univ.APD_PAT_CNT_TD_MEDIUM,
        qims_td_target_univ.DIAGN_TD_MDD_BPD_SCZ_PAT_CNT,
        qims_td_target_univ.OVERALL_DIAG_TD_MDD_BPD_SCZ_PT,
        qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_HIGH,
        qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_HIGH,
        qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_MEDIUM,
        qims_td_target_univ.DIAGNOSED_TD_MDD_PAT_CNT,
        qims_td_target_univ.OVERALL_DIAGNOSED_TD_MDD_PAT,
        qims_td_target_univ.PREDICTED_TD_MDD_PAT_CNT_HIGH,
        qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_HIGH,
        qims_td_target_univ.PREDICTED_TD_MDD_PAT_CNT_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_MEDIUM,
        qims_td_target_univ.DIAGNOSED_TD_BPD_PAT_CNT,
        qims_td_target_univ.OVERALL_DIAGNOSED_TD_BPD_PAT_CNT,
        qims_td_target_univ.PREDICTED_TD_BPD_PAT_CNT_HIGH,
        qims_td_target_univ.TOTAL_OPPORTUNITY_BPD_HIGH,
        qims_td_target_univ.PREDICTED_TD_BPD_PAT_CNT_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_BPD_MEDIUM,
        qims_td_target_univ.DIAGNOSED_TD_SCZ_PAT_CNT,
        qims_td_target_univ.OVERALL_DIAGNOSED_TD_SCZ_PAT_CNT,
        qims_td_target_univ.PREDICTED_TD_SCZ_PAT_CNT_HIGH,
        qims_td_target_univ.TOTAL_OPPORTUNITY_SCZ_HIGH,
        qims_td_target_univ.PREDICTED_TD_SCZ_PAT_CNT_MEDIUM,
        qims_td_target_univ.TOTAL_OPPORTUNITY_SCZ_MEDIUM,
        qims_td_target_univ.APD_CLM_CNT,
        qims_td_target_univ.APD_CLM_CNT_TD_HIGH,
        qims_td_target_univ.APD_CLM_CNT_TD_MEDIUM,
        qims_td_target_univ.DIAGNOSED_TD_CLM_CNT,
        qims_td_target_univ.METO_CLM_CNT,
        qims_td_target_univ.ARIPIPRAZOLE_CLM_CNT,
        qims_td_target_univ.ASENAPINE_CLM_CNT,
        qims_td_target_univ.BREXPIPRAZOLE_CLM_CNT,
        qims_td_target_univ.CARIPRAZINE_CLM_CNT,
        qims_td_target_univ.CHLORPROMAZINE_CLM_CNT,
        qims_td_target_univ.CLOZAPINE_CLM_CNT,
        qims_td_target_univ.DROPERIDOL_CLM_CNT,
        qims_td_target_univ.FLUPHENAZINE_CLM_CNT,
        qims_td_target_univ.HALOPERIDOL_CLM_CNT,
        qims_td_target_univ.ILOPERIDONE_CLM_CNT,
        qims_td_target_univ.LOXAPINE_CLM_CNT,
        qims_td_target_univ.LURASIDONE_CLM_CNT,
        qims_td_target_univ.MOLINDONE_CLM_CNT,
        qims_td_target_univ.OLANZAPINE_CLM_CNT,
        qims_td_target_univ.PALIPERIDONE_CLM_CNT,
        qims_td_target_univ.PERPHENAZINE_CLM_CNT,
        qims_td_target_univ.PIMAVANSERIN_CLM_CNT,
        qims_td_target_univ.PIMOZIDE_CLM_CNT,
        qims_td_target_univ.PROCHLORPERAZINE_CLM_CNT,
        qims_td_target_univ.QUETIAPINE_CLM_CNT,
        qims_td_target_univ.RISPERIDONE_CLM_CNT,
        qims_td_target_univ.THIORIDAZINE_CLM_CNT,
        qims_td_target_univ.THIOTHIXENE_CLM_CNT,
        qims_td_target_univ.TRIFLUOPERAZINE_CLM_CNT,
        qims_td_target_univ.ZIPRASIDONE_CLM_CNT,
        qims_td_target_univ.ABILIFY_LTC_TRX,
        qims_td_target_univ.ABILIFY_DISCMELT_LTC_TRX,
        qims_td_target_univ.ABILIFY_MAINTENA_LTC_TRX,
        qims_td_target_univ.ARIPIPRAZOLE_LTC_TRX,
        qims_td_target_univ.ARIPIPRAZOLE_ODT_LTC_TRX,
        qims_td_target_univ.ARISTADA_LTC_TRX,
        qims_td_target_univ.CHLORPROMAZINE_HCL_LTC_TRX,
        qims_td_target_univ.CLOZAPINE_LTC_TRX,
        qims_td_target_univ.CLOZAPINE_ODT_LTC_TRX,
        qims_td_target_univ.CLOZARIL_LTC_TRX,
        qims_td_target_univ.COMPRO_LTC_TRX,
        qims_td_target_univ.FANAPT_LTC_TRX,
        qims_td_target_univ.FANAPT_TITRATION_PACK_LTC_TRX,
        qims_td_target_univ.FAZACLO_LTC_TRX,
        qims_td_target_univ.FLUPHENAZINE_DECANOATE_LTC_TRX,
        qims_td_target_univ.FLUPHENAZINE_HCL_LTC_TRX,
        qims_td_target_univ.GEODON_LTC_TRX,
        qims_td_target_univ.HALDOL_LTC_TRX,
        qims_td_target_univ.HALDOL_DECANOATE_100_LTC_TRX,
        qims_td_target_univ.HALDOL_DECANOATE_50_LTC_TRX,
        qims_td_target_univ.HALOPERIDOL_LTC_TRX,
        qims_td_target_univ.HALOPERIDOL_DECANOATE_LTC_TRX,
        qims_td_target_univ.HALOPERIDOL_LACTATE_LTC_TRX,
        qims_td_target_univ.INVEGA_LTC_TRX,
        qims_td_target_univ.INVEGA_SUSTENNA_LTC_TRX,
        qims_td_target_univ.INVEGA_TRINZA_LTC_TRX,
        qims_td_target_univ.LATUDA_LTC_TRX,
        qims_td_target_univ.LOXAPINE_LTC_TRX,
        qims_td_target_univ.LOXAPINE_SUCCINATE_LTC_TRX,
        qims_td_target_univ.MOLINDONE_HYDROCHLOR_LTC_TRX,
        qims_td_target_univ.NUPLAZID_LTC_TRX,
        qims_td_target_univ.OLANZAPINE_LTC_TRX,
        qims_td_target_univ.OLANZAPINE_ODT_LTC_TRX,
        qims_td_target_univ.OLANZAPINE_FLUOXETINE_LTC_TRX,
        qims_td_target_univ.ORAP_LTC_TRX,
        qims_td_target_univ.PALIPERIDONE_ER_LTC_TRX,
        qims_td_target_univ.PERPHENAZINE_LTC_TRX,
        qims_td_target_univ.PERPHENAZINE_AMITRIPTY_LTC_TRX,
        qims_td_target_univ.PIMOZIDE_LTC_TRX,
        qims_td_target_univ.PROCHLORPERAZINE_LTC_TRX,
        qims_td_target_univ.PROCHLORPERAZINE_EDISY_LTC_TRX,
        qims_td_target_univ.PROCHLORPERAZINE_MALEA_LTC_TRX,
        qims_td_target_univ.QUETIAPINE_FUMARATE_LTC_TRX,
        qims_td_target_univ.QUETIAPINE_FUMARATE_ER_LTC_TRX,
        qims_td_target_univ.REXULTI_LTC_TRX,
        qims_td_target_univ.RISPERDAL_LTC_TRX,
        qims_td_target_univ.RISPERDAL_CONSTA_LTC_TRX,
        qims_td_target_univ.RISPERDAL_M_TAB_LTC_TRX,
        qims_td_target_univ.RISPERIDONE_LTC_TRX,
        qims_td_target_univ.RISPERIDONE_M_TAB_LTC_TRX,
        qims_td_target_univ.RISPERIDONE_ODT_LTC_TRX,
        qims_td_target_univ.SAPHRIS_LTC_TRX,
        qims_td_target_univ.SEROQUEL_LTC_TRX,
        qims_td_target_univ.SEROQUEL_XR_LTC_TRX,
        qims_td_target_univ.SYMBYAX_LTC_TRX,
        qims_td_target_univ.THIORIDAZINE_HCL_LTC_TRX,
        qims_td_target_univ.THIOTHIXENE_LTC_TRX,
        qims_td_target_univ.TRIFLUOPERAZINE_HCL_LTC_TRX,
        qims_td_target_univ.VERSACLOZ_LTC_TRX,
        qims_td_target_univ.VRAYLAR_LTC_TRX,
        qims_td_target_univ.ZIPRASIDONE_HCL_LTC_TRX,
        qims_td_target_univ.ZYPREXA_LTC_TRX,
        qims_td_target_univ.ZYPREXA_RELPREVV_LTC_TRX,
        qims_td_target_univ.ZYPREXA_ZYDIS_LTC_TRX,
        qims_td_target_univ.FACILITY_TYPE
 FROM sandbox.qims_td_target_univ
 ORDER BY qims_td_target_univ.PRESCRIBER_ID,
          qims_td_target_univ.ME_NBR,
          qims_td_target_univ.IMS_ID,
          qims_td_target_univ.NPI,
          qims_td_target_univ.PRIMARY_SPECIALTY,
          qims_td_target_univ.SECONDARY_SPECIALTY,
          qims_td_target_univ.PRIMARY_SPECIALTY_GROUP,
          qims_td_target_univ.SECONDARY_SPECIALTY_GROUP,
          qims_td_target_univ.GENDER_CD,
          qims_td_target_univ.FIRST_NAME,
          qims_td_target_univ.LAST_NAME,
          qims_td_target_univ.MID_NAME,
          qims_td_target_univ.ADDRESS_1,
          qims_td_target_univ.ADDRESS_2,
          qims_td_target_univ.CITY,
          qims_td_target_univ.STATE,
          qims_td_target_univ.ZIP,
          qims_td_target_univ.AMA_NO_CONTACT_INDICATOR,
          qims_td_target_univ.AMA_PDRP_IND,
          qims_td_target_univ.PROVIDER_TYP_DESC,
          qims_td_target_univ.TARGET_Y_N,
          qims_td_target_univ.ADOPTION_CATEGORY,
          qims_td_target_univ.CMHC_AFFILIATION_Y_N,
          qims_td_target_univ.INFLUENCER,
          qims_td_target_univ.INFLUENCER_MVT_DIS_LEADER,
          qims_td_target_univ.INFLUENCER_BHVR_HLTH_LEADER,
          qims_td_target_univ.PRIORITY_FLAG_Y_N,
          qims_td_target_univ.DIAGNOSED_TD_PAT_CNT,
          qims_td_target_univ.OVERALL_DIAGNOSED_TD_PAT_CNT,
          qims_td_target_univ.OVERALL_UNIQUE_DIAG_TD_PAT_CNT,
          qims_td_target_univ.PREDICTED_TD_PAT_CNT_HIGH,
          qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_HIGH,
          qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_HIGH,
          qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_HIGH,
          qims_td_target_univ.TOTAL_OPPORTUNITY_HIGH,
          qims_td_target_univ.PREDICTED_TD_PAT_CNT_MEDIUM,
          qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_MEDIUM,
          qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_MEDIUM,
          qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_DIAG_HIGH_MEDIUM,
          qims_td_target_univ.RANK,
          qims_td_target_univ.DECILE_PAT_CNT,
          qims_td_target_univ.DECILE_SUM_OF_SCORES,
          qims_td_target_univ.DECILE_SUM_OF_SCORES_UNIQUE,
          qims_td_target_univ.DECILE_OLD,
          qims_td_target_univ.APD_PAT_CNT,
          qims_td_target_univ.APD_PAT_CNT_TD_HIGH,
          qims_td_target_univ.APD_PAT_CNT_TD_MEDIUM,
          qims_td_target_univ.DIAGN_TD_MDD_BPD_SCZ_PAT_CNT,
          qims_td_target_univ.OVERALL_DIAG_TD_MDD_BPD_SCZ_PT,
          qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_HIGH,
          qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_HIGH,
          qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_MEDIUM,
          qims_td_target_univ.DIAGNOSED_TD_MDD_PAT_CNT,
          qims_td_target_univ.OVERALL_DIAGNOSED_TD_MDD_PAT,
          qims_td_target_univ.PREDICTED_TD_MDD_PAT_CNT_HIGH,
          qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_HIGH,
          qims_td_target_univ.PREDICTED_TD_MDD_PAT_CNT_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_MEDIUM,
          qims_td_target_univ.DIAGNOSED_TD_BPD_PAT_CNT,
          qims_td_target_univ.OVERALL_DIAGNOSED_TD_BPD_PAT_CNT,
          qims_td_target_univ.PREDICTED_TD_BPD_PAT_CNT_HIGH,
          qims_td_target_univ.TOTAL_OPPORTUNITY_BPD_HIGH,
          qims_td_target_univ.PREDICTED_TD_BPD_PAT_CNT_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_BPD_MEDIUM,
          qims_td_target_univ.DIAGNOSED_TD_SCZ_PAT_CNT,
          qims_td_target_univ.OVERALL_DIAGNOSED_TD_SCZ_PAT_CNT,
          qims_td_target_univ.PREDICTED_TD_SCZ_PAT_CNT_HIGH,
          qims_td_target_univ.TOTAL_OPPORTUNITY_SCZ_HIGH,
          qims_td_target_univ.PREDICTED_TD_SCZ_PAT_CNT_MEDIUM,
          qims_td_target_univ.TOTAL_OPPORTUNITY_SCZ_MEDIUM,
          qims_td_target_univ.APD_CLM_CNT,
          qims_td_target_univ.APD_CLM_CNT_TD_HIGH,
          qims_td_target_univ.APD_CLM_CNT_TD_MEDIUM,
          qims_td_target_univ.DIAGNOSED_TD_CLM_CNT,
          qims_td_target_univ.METO_CLM_CNT,
          qims_td_target_univ.ARIPIPRAZOLE_CLM_CNT,
          qims_td_target_univ.ASENAPINE_CLM_CNT,
          qims_td_target_univ.BREXPIPRAZOLE_CLM_CNT,
          qims_td_target_univ.CARIPRAZINE_CLM_CNT,
          qims_td_target_univ.CHLORPROMAZINE_CLM_CNT,
          qims_td_target_univ.CLOZAPINE_CLM_CNT,
          qims_td_target_univ.DROPERIDOL_CLM_CNT,
          qims_td_target_univ.FLUPHENAZINE_CLM_CNT,
          qims_td_target_univ.HALOPERIDOL_CLM_CNT,
          qims_td_target_univ.ILOPERIDONE_CLM_CNT,
          qims_td_target_univ.LOXAPINE_CLM_CNT,
          qims_td_target_univ.LURASIDONE_CLM_CNT,
          qims_td_target_univ.MOLINDONE_CLM_CNT,
          qims_td_target_univ.OLANZAPINE_CLM_CNT,
          qims_td_target_univ.PALIPERIDONE_CLM_CNT,
          qims_td_target_univ.PERPHENAZINE_CLM_CNT,
          qims_td_target_univ.PIMAVANSERIN_CLM_CNT,
          qims_td_target_univ.PIMOZIDE_CLM_CNT,
          qims_td_target_univ.PROCHLORPERAZINE_CLM_CNT,
          qims_td_target_univ.QUETIAPINE_CLM_CNT,
          qims_td_target_univ.RISPERIDONE_CLM_CNT,
          qims_td_target_univ.THIORIDAZINE_CLM_CNT,
          qims_td_target_univ.THIOTHIXENE_CLM_CNT,
          qims_td_target_univ.TRIFLUOPERAZINE_CLM_CNT,
          qims_td_target_univ.ZIPRASIDONE_CLM_CNT,
          qims_td_target_univ.ABILIFY_LTC_TRX,
          qims_td_target_univ.ABILIFY_DISCMELT_LTC_TRX,
          qims_td_target_univ.ABILIFY_MAINTENA_LTC_TRX,
          qims_td_target_univ.ARIPIPRAZOLE_LTC_TRX,
          qims_td_target_univ.ARIPIPRAZOLE_ODT_LTC_TRX,
          qims_td_target_univ.ARISTADA_LTC_TRX,
          qims_td_target_univ.CHLORPROMAZINE_HCL_LTC_TRX,
          qims_td_target_univ.CLOZAPINE_LTC_TRX,
          qims_td_target_univ.CLOZAPINE_ODT_LTC_TRX,
          qims_td_target_univ.CLOZARIL_LTC_TRX,
          qims_td_target_univ.COMPRO_LTC_TRX,
          qims_td_target_univ.FANAPT_LTC_TRX,
          qims_td_target_univ.FANAPT_TITRATION_PACK_LTC_TRX,
          qims_td_target_univ.FAZACLO_LTC_TRX,
          qims_td_target_univ.FLUPHENAZINE_DECANOATE_LTC_TRX,
          qims_td_target_univ.FLUPHENAZINE_HCL_LTC_TRX,
          qims_td_target_univ.GEODON_LTC_TRX,
          qims_td_target_univ.HALDOL_LTC_TRX,
          qims_td_target_univ.HALDOL_DECANOATE_100_LTC_TRX,
          qims_td_target_univ.HALDOL_DECANOATE_50_LTC_TRX,
          qims_td_target_univ.HALOPERIDOL_LTC_TRX,
          qims_td_target_univ.HALOPERIDOL_DECANOATE_LTC_TRX,
          qims_td_target_univ.HALOPERIDOL_LACTATE_LTC_TRX,
          qims_td_target_univ.INVEGA_LTC_TRX,
          qims_td_target_univ.INVEGA_SUSTENNA_LTC_TRX,
          qims_td_target_univ.INVEGA_TRINZA_LTC_TRX,
          qims_td_target_univ.LATUDA_LTC_TRX,
          qims_td_target_univ.LOXAPINE_LTC_TRX,
          qims_td_target_univ.LOXAPINE_SUCCINATE_LTC_TRX,
          qims_td_target_univ.MOLINDONE_HYDROCHLOR_LTC_TRX,
          qims_td_target_univ.NUPLAZID_LTC_TRX,
          qims_td_target_univ.OLANZAPINE_LTC_TRX,
          qims_td_target_univ.OLANZAPINE_ODT_LTC_TRX,
          qims_td_target_univ.OLANZAPINE_FLUOXETINE_LTC_TRX,
          qims_td_target_univ.ORAP_LTC_TRX,
          qims_td_target_univ.PALIPERIDONE_ER_LTC_TRX,
          qims_td_target_univ.PERPHENAZINE_LTC_TRX,
          qims_td_target_univ.PERPHENAZINE_AMITRIPTY_LTC_TRX,
          qims_td_target_univ.PIMOZIDE_LTC_TRX,
          qims_td_target_univ.PROCHLORPERAZINE_LTC_TRX,
          qims_td_target_univ.PROCHLORPERAZINE_EDISY_LTC_TRX,
          qims_td_target_univ.PROCHLORPERAZINE_MALEA_LTC_TRX,
          qims_td_target_univ.QUETIAPINE_FUMARATE_LTC_TRX,
          qims_td_target_univ.QUETIAPINE_FUMARATE_ER_LTC_TRX,
          qims_td_target_univ.REXULTI_LTC_TRX,
          qims_td_target_univ.RISPERDAL_LTC_TRX,
          qims_td_target_univ.RISPERDAL_CONSTA_LTC_TRX,
          qims_td_target_univ.RISPERDAL_M_TAB_LTC_TRX,
          qims_td_target_univ.RISPERIDONE_LTC_TRX,
          qims_td_target_univ.RISPERIDONE_M_TAB_LTC_TRX,
          qims_td_target_univ.RISPERIDONE_ODT_LTC_TRX,
          qims_td_target_univ.SAPHRIS_LTC_TRX,
          qims_td_target_univ.SEROQUEL_LTC_TRX,
          qims_td_target_univ.SEROQUEL_XR_LTC_TRX,
          qims_td_target_univ.SYMBYAX_LTC_TRX,
          qims_td_target_univ.THIORIDAZINE_HCL_LTC_TRX,
          qims_td_target_univ.THIOTHIXENE_LTC_TRX,
          qims_td_target_univ.TRIFLUOPERAZINE_HCL_LTC_TRX,
          qims_td_target_univ.VERSACLOZ_LTC_TRX,
          qims_td_target_univ.VRAYLAR_LTC_TRX,
          qims_td_target_univ.ZIPRASIDONE_HCL_LTC_TRX,
          qims_td_target_univ.ZYPREXA_LTC_TRX,
          qims_td_target_univ.ZYPREXA_RELPREVV_LTC_TRX,
          qims_td_target_univ.ZYPREXA_ZYDIS_LTC_TRX,
          qims_td_target_univ.FACILITY_TYPE
SEGMENTED BY hash(qims_td_target_univ.IMS_ID, qims_td_target_univ.ZIP, qims_td_target_univ.AMA_NO_CONTACT_INDICATOR, qims_td_target_univ.DIAGNOSED_TD_PAT_CNT, qims_td_target_univ.OVERALL_DIAGNOSED_TD_PAT_CNT, qims_td_target_univ.OVERALL_UNIQUE_DIAG_TD_PAT_CNT, qims_td_target_univ.PREDICTED_TD_PAT_CNT_HIGH, qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_HIGH, qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_HIGH, qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_HIGH, qims_td_target_univ.TOTAL_OPPORTUNITY_HIGH, qims_td_target_univ.PREDICTED_TD_PAT_CNT_MEDIUM, qims_td_target_univ.PREDICTED_TD_PAT_CNT_UNIQUE_MEDIUM, qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_MEDIUM, qims_td_target_univ.SUM_OF_SCORES_PREDICTED_PAT_CNT_UNIQUE_MEDIUM, qims_td_target_univ.TOTAL_OPPORTUNITY_MEDIUM, qims_td_target_univ.TOTAL_OPPORTUNITY_DIAG_HIGH_MEDIUM, qims_td_target_univ.RANK, qims_td_target_univ.DECILE_PAT_CNT, qims_td_target_univ.DECILE_SUM_OF_SCORES, qims_td_target_univ.DECILE_SUM_OF_SCORES_UNIQUE, qims_td_target_univ.DECILE_OLD, qims_td_target_univ.APD_PAT_CNT, qims_td_target_univ.APD_PAT_CNT_TD_HIGH, qims_td_target_univ.APD_PAT_CNT_TD_MEDIUM, qims_td_target_univ.DIAGN_TD_MDD_BPD_SCZ_PAT_CNT, qims_td_target_univ.OVERALL_DIAG_TD_MDD_BPD_SCZ_PT, qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_HIGH, qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_HIGH, qims_td_target_univ.PREDICTED_TD_MDD_BPD_SCZ_PAT_CNT_MEDIUM, qims_td_target_univ.TOTAL_OPPORTUNITY_MDD_BPD_SCZ_MEDIUM, qims_td_target_univ.DIAGNOSED_TD_MDD_PAT_CNT) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_factor_b0 /*+basename(ic_rx_factor),createtype(L)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 rollup_month,
 multiplier,
 approved_trx_count,
 total_trx_count
)
AS
 SELECT ic_rx_factor.ic_data_month,
        ic_rx_factor.basket_name,
        ic_rx_factor.sales_force_id,
        ic_rx_factor.rollup_month,
        ic_rx_factor.multiplier,
        ic_rx_factor.approved_trx_count,
        ic_rx_factor.total_trx_count
 FROM sandbox.ic_rx_factor
 ORDER BY ic_rx_factor.ic_data_month,
          ic_rx_factor.basket_name,
          ic_rx_factor.rollup_month
SEGMENTED BY hash(ic_rx_factor.ic_data_month, ic_rx_factor.basket_name, ic_rx_factor.rollup_month) ALL NODES;

CREATE PROJECTION sandbox.onc_sales_adjustment_load_b0 /*+basename(onc_sales_adjustment_load),createtype(L)*/ 
(
 adj_code,
 adj_time_period,
 tvcmid,
 basket_id,
 adj_factor
)
AS
 SELECT onc_sales_adjustment_load.adj_code,
        onc_sales_adjustment_load.adj_time_period,
        onc_sales_adjustment_load.tvcmid,
        onc_sales_adjustment_load.basket_id,
        onc_sales_adjustment_load.adj_factor
 FROM sandbox.onc_sales_adjustment_load
 ORDER BY onc_sales_adjustment_load.adj_code,
          onc_sales_adjustment_load.adj_time_period,
          onc_sales_adjustment_load.tvcmid,
          onc_sales_adjustment_load.basket_id,
          onc_sales_adjustment_load.adj_factor
SEGMENTED BY hash(onc_sales_adjustment_load.tvcmid, onc_sales_adjustment_load.basket_id, onc_sales_adjustment_load.adj_factor, onc_sales_adjustment_load.adj_code, onc_sales_adjustment_load.adj_time_period) ALL NODES;

CREATE PROJECTION sandbox.ic_ms_market_decile_201801_b0 /*+basename(ic_ms_market_decile_201801),createtype(A)*/ 
(
 ims_id,
 tvcmid,
 category,
 decile_name,
 trx_cnt_01_06,
 trx_cnt_01_12
)
AS
 SELECT ic_ms_market_decile_201801.ims_id,
        ic_ms_market_decile_201801.tvcmid,
        ic_ms_market_decile_201801.category,
        ic_ms_market_decile_201801.decile_name,
        ic_ms_market_decile_201801.trx_cnt_01_06,
        ic_ms_market_decile_201801.trx_cnt_01_12
 FROM sandbox.ic_ms_market_decile_201801
 ORDER BY ic_ms_market_decile_201801.ims_id
SEGMENTED BY hash(ic_ms_market_decile_201801.ims_id) ALL NODES;

CREATE PROJECTION sandbox.call_plan_decile_nr_b0 /*+basename(call_plan_decile_nr),createtype(L)*/ 
(
 hcp_id,
 market,
 decile_value,
 veeva_id
)
AS
 SELECT call_plan_decile_nr.hcp_id,
        call_plan_decile_nr.market,
        call_plan_decile_nr.decile_value,
        call_plan_decile_nr.veeva_id
 FROM sandbox.call_plan_decile_nr
 ORDER BY call_plan_decile_nr.hcp_id,
          call_plan_decile_nr.market,
          call_plan_decile_nr.decile_value
SEGMENTED BY hash(call_plan_decile_nr.hcp_id, call_plan_decile_nr.market, call_plan_decile_nr.decile_value) ALL NODES;

CREATE PROJECTION sandbox.Q2_2018_TP_NO_VEEVAID_b0 /*+basename(Q2_2018_TP_NO_VEEVAID),createtype(L)*/ 
(
 HCP_ID,
 Territory,
 Program,
 Campaign,
 "Rank Value"
)
AS
 SELECT Q2_2018_TP_NO_VEEVAID.HCP_ID,
        Q2_2018_TP_NO_VEEVAID.Territory,
        Q2_2018_TP_NO_VEEVAID.Program,
        Q2_2018_TP_NO_VEEVAID.Campaign,
        Q2_2018_TP_NO_VEEVAID."Rank Value"
 FROM sandbox.Q2_2018_TP_NO_VEEVAID
 ORDER BY Q2_2018_TP_NO_VEEVAID.HCP_ID,
          Q2_2018_TP_NO_VEEVAID.Territory,
          Q2_2018_TP_NO_VEEVAID.Program,
          Q2_2018_TP_NO_VEEVAID.Campaign,
          Q2_2018_TP_NO_VEEVAID."Rank Value"
SEGMENTED BY hash(Q2_2018_TP_NO_VEEVAID.HCP_ID, Q2_2018_TP_NO_VEEVAID.Territory, Q2_2018_TP_NO_VEEVAID.Program, Q2_2018_TP_NO_VEEVAID.Campaign, Q2_2018_TP_NO_VEEVAID."Rank Value") ALL NODES;

CREATE PROJECTION sandbox.HEADACHE_CENTER_LIST_b0 /*+basename(HEADACHE_CENTER_LIST),createtype(L)*/ 
(
 "IMS ID"
)
AS
 SELECT HEADACHE_CENTER_LIST."IMS ID"
 FROM sandbox.HEADACHE_CENTER_LIST
 ORDER BY HEADACHE_CENTER_LIST."IMS ID"
SEGMENTED BY hash(HEADACHE_CENTER_LIST."IMS ID") ALL NODES;

CREATE PROJECTION sandbox.qvar_knipper_test2_09202018_b0 /*+basename(qvar_knipper_test2_09202018),createtype(L)*/ 
(
 tvcmid,
 tvcmid1,
 tvcmid2,
 ims_id,
 npi,
 last_name,
 first_name,
 middle_name,
 personal_suffix,
 medical_suffix,
 primary_specialty,
 address_line1,
 address_line2,
 city,
 state_code,
 zip,
 np_pa_flag,
 authorization_number,
 profession_code,
 state,
 license_expiration_date,
 license_status_description
)
AS
 SELECT qvar_knipper_test2_09202018.tvcmid,
        qvar_knipper_test2_09202018.tvcmid1,
        qvar_knipper_test2_09202018.tvcmid2,
        qvar_knipper_test2_09202018.ims_id,
        qvar_knipper_test2_09202018.npi,
        qvar_knipper_test2_09202018.last_name,
        qvar_knipper_test2_09202018.first_name,
        qvar_knipper_test2_09202018.middle_name,
        qvar_knipper_test2_09202018.personal_suffix,
        qvar_knipper_test2_09202018.medical_suffix,
        qvar_knipper_test2_09202018.primary_specialty,
        qvar_knipper_test2_09202018.address_line1,
        qvar_knipper_test2_09202018.address_line2,
        qvar_knipper_test2_09202018.city,
        qvar_knipper_test2_09202018.state_code,
        qvar_knipper_test2_09202018.zip,
        qvar_knipper_test2_09202018.np_pa_flag,
        qvar_knipper_test2_09202018.authorization_number,
        qvar_knipper_test2_09202018.profession_code,
        qvar_knipper_test2_09202018.state,
        qvar_knipper_test2_09202018.license_expiration_date,
        qvar_knipper_test2_09202018.license_status_description
 FROM sandbox.qvar_knipper_test2_09202018
 ORDER BY qvar_knipper_test2_09202018.tvcmid,
          qvar_knipper_test2_09202018.tvcmid1,
          qvar_knipper_test2_09202018.tvcmid2,
          qvar_knipper_test2_09202018.ims_id,
          qvar_knipper_test2_09202018.npi,
          qvar_knipper_test2_09202018.last_name,
          qvar_knipper_test2_09202018.first_name,
          qvar_knipper_test2_09202018.middle_name,
          qvar_knipper_test2_09202018.personal_suffix,
          qvar_knipper_test2_09202018.medical_suffix,
          qvar_knipper_test2_09202018.primary_specialty,
          qvar_knipper_test2_09202018.address_line1,
          qvar_knipper_test2_09202018.address_line2,
          qvar_knipper_test2_09202018.city,
          qvar_knipper_test2_09202018.state_code,
          qvar_knipper_test2_09202018.zip,
          qvar_knipper_test2_09202018.np_pa_flag,
          qvar_knipper_test2_09202018.authorization_number,
          qvar_knipper_test2_09202018.profession_code,
          qvar_knipper_test2_09202018.state,
          qvar_knipper_test2_09202018.license_expiration_date,
          qvar_knipper_test2_09202018.license_status_description
SEGMENTED BY hash(qvar_knipper_test2_09202018.tvcmid, qvar_knipper_test2_09202018.tvcmid1, qvar_knipper_test2_09202018.tvcmid2, qvar_knipper_test2_09202018.ims_id, qvar_knipper_test2_09202018.npi, qvar_knipper_test2_09202018.zip, qvar_knipper_test2_09202018.profession_code, qvar_knipper_test2_09202018.license_expiration_date, qvar_knipper_test2_09202018.personal_suffix, qvar_knipper_test2_09202018.medical_suffix, qvar_knipper_test2_09202018.primary_specialty, qvar_knipper_test2_09202018.state_code, qvar_knipper_test2_09202018.np_pa_flag, qvar_knipper_test2_09202018.state, qvar_knipper_test2_09202018.authorization_number, qvar_knipper_test2_09202018.last_name, qvar_knipper_test2_09202018.first_name, qvar_knipper_test2_09202018.middle_name, qvar_knipper_test2_09202018.city, qvar_knipper_test2_09202018.license_status_description, qvar_knipper_test2_09202018.address_line1, qvar_knipper_test2_09202018.address_line2) ALL NODES;

CREATE PROJECTION sandbox.QVAR_08202019_b0 /*+basename(QVAR_08202019),createtype(L)*/ 
(
 "IMSID 2,868"
)
AS
 SELECT QVAR_08202019."IMSID 2,868"
 FROM sandbox.QVAR_08202019
 ORDER BY QVAR_08202019."IMSID 2,868"
SEGMENTED BY hash(QVAR_08202019."IMSID 2,868") ALL NODES;

CREATE PROJECTION sandbox.a_mktdef_b0 /*+basename(a_mktdef),createtype(L)*/ 
(
 market_name,
 market_id,
 brand_form_strength,
 bfs_id,
 brand,
 teva_prod,
 prod_group,
 F8
)
AS
 SELECT a_mktdef.market_name,
        a_mktdef.market_id,
        a_mktdef.brand_form_strength,
        a_mktdef.bfs_id,
        a_mktdef.brand,
        a_mktdef.teva_prod,
        a_mktdef.prod_group,
        a_mktdef.F8
 FROM sandbox.a_mktdef
 ORDER BY a_mktdef.market_name,
          a_mktdef.market_id,
          a_mktdef.brand_form_strength,
          a_mktdef.bfs_id,
          a_mktdef.brand,
          a_mktdef.teva_prod,
          a_mktdef.prod_group,
          a_mktdef.F8
SEGMENTED BY hash(a_mktdef.market_id, a_mktdef.bfs_id, a_mktdef.brand, a_mktdef.teva_prod, a_mktdef.F8, a_mktdef.prod_group, a_mktdef.market_name, a_mktdef.brand_form_strength) ALL NODES;

CREATE PROJECTION sandbox.tjr_model_mop_xref_b0 /*+basename(tjr_model_mop_xref),createtype(L)*/ 
(
 model,
 model_name,
 industry_mop,
 iqvia_mop,
 current_teva_mop,
 proposed_teva_mop
)
AS
 SELECT tjr_model_mop_xref.model,
        tjr_model_mop_xref.model_name,
        tjr_model_mop_xref.industry_mop,
        tjr_model_mop_xref.iqvia_mop,
        tjr_model_mop_xref.current_teva_mop,
        tjr_model_mop_xref.proposed_teva_mop
 FROM sandbox.tjr_model_mop_xref
 ORDER BY tjr_model_mop_xref.model,
          tjr_model_mop_xref.model_name,
          tjr_model_mop_xref.industry_mop,
          tjr_model_mop_xref.iqvia_mop,
          tjr_model_mop_xref.current_teva_mop,
          tjr_model_mop_xref.proposed_teva_mop
SEGMENTED BY hash(tjr_model_mop_xref.model, tjr_model_mop_xref.model_name, tjr_model_mop_xref.industry_mop, tjr_model_mop_xref.iqvia_mop, tjr_model_mop_xref.current_teva_mop, tjr_model_mop_xref.proposed_teva_mop) ALL NODES;

CREATE PROJECTION sandbox.QVAR_HCPs_09272019_b0 /*+basename(QVAR_HCPs_09272019),createtype(L)*/ 
(
 IMSID,
 NPI
)
AS
 SELECT QVAR_HCPs_09272019.IMSID,
        QVAR_HCPs_09272019.NPI
 FROM sandbox.QVAR_HCPs_09272019
 ORDER BY QVAR_HCPs_09272019.IMSID,
          QVAR_HCPs_09272019.NPI
SEGMENTED BY hash(QVAR_HCPs_09272019.IMSID, QVAR_HCPs_09272019.NPI) ALL NODES;

CREATE PROJECTION sandbox.tables_to_keep_b0 /*+basename(tables_to_keep),createtype(L)*/ 
(
 table_name
)
AS
 SELECT tables_to_keep.table_name
 FROM sandbox.tables_to_keep
 ORDER BY tables_to_keep.table_name
SEGMENTED BY hash(tables_to_keep.table_name) ALL NODES;

CREATE PROJECTION sandbox.ZS_austedodeciling_1105_b0 /*+basename(ZS_austedodeciling_1105),createtype(L)*/ 
(
 IMSID,
 "Alignment Decile"
)
AS
 SELECT ZS_austedodeciling_1105.IMSID,
        ZS_austedodeciling_1105."Alignment Decile"
 FROM sandbox.ZS_austedodeciling_1105
 ORDER BY ZS_austedodeciling_1105.IMSID,
          ZS_austedodeciling_1105."Alignment Decile"
SEGMENTED BY hash(ZS_austedodeciling_1105.IMSID, ZS_austedodeciling_1105."Alignment Decile") ALL NODES;

CREATE PROJECTION sandbox.controls_newprescriber_1114_b0 /*+basename(controls_newprescriber_1114),createtype(L)*/ 
(
 ims_id
)
AS
 SELECT controls_newprescriber_1114.ims_id
 FROM sandbox.controls_newprescriber_1114
 ORDER BY controls_newprescriber_1114.ims_id
SEGMENTED BY hash(controls_newprescriber_1114.ims_id) ALL NODES;

CREATE PROJECTION sandbox.J_Chung_NPI_IDs_b0 /*+basename(J_Chung_NPI_IDs),createtype(L)*/ 
(
 "Physician NPI #"
)
AS
 SELECT J_Chung_NPI_IDs."Physician NPI #"
 FROM sandbox.J_Chung_NPI_IDs
 ORDER BY J_Chung_NPI_IDs."Physician NPI #"
SEGMENTED BY hash(J_Chung_NPI_IDs."Physician NPI #") ALL NODES;

CREATE PROJECTION sandbox."J_CHUNG_HCP DEA-2_b0" /*+basename(J_CHUNG_HCP DEA-2),createtype(L)*/ 
(
 "Physician DEA#",
 tvcmid
)
AS
 SELECT "J_CHUNG_HCP DEA-2"."Physician DEA#",
        "J_CHUNG_HCP DEA-2".tvcmid
 FROM sandbox."J_CHUNG_HCP DEA-2"
 ORDER BY "J_CHUNG_HCP DEA-2"."Physician DEA#",
          "J_CHUNG_HCP DEA-2".tvcmid
SEGMENTED BY hash("J_CHUNG_HCP DEA-2".tvcmid, "J_CHUNG_HCP DEA-2"."Physician DEA#") ALL NODES;

CREATE PROJECTION sandbox.zs_acute_migraine_b0 /*+basename(zs_acute_migraine),createtype(L)*/ 
(
 market_name,
 market_id,
 brand_form_strength,
 bfs_id,
 teva_prod,
 prod_group
)
AS
 SELECT zs_acute_migraine.market_name,
        zs_acute_migraine.market_id,
        zs_acute_migraine.brand_form_strength,
        zs_acute_migraine.bfs_id,
        zs_acute_migraine.teva_prod,
        zs_acute_migraine.prod_group
 FROM sandbox.zs_acute_migraine
 ORDER BY zs_acute_migraine.market_name,
          zs_acute_migraine.market_id,
          zs_acute_migraine.brand_form_strength,
          zs_acute_migraine.bfs_id,
          zs_acute_migraine.teva_prod,
          zs_acute_migraine.prod_group
SEGMENTED BY hash(zs_acute_migraine.market_id, zs_acute_migraine.bfs_id, zs_acute_migraine.market_name, zs_acute_migraine.teva_prod, zs_acute_migraine.prod_group, zs_acute_migraine.brand_form_strength) ALL NODES;

CREATE PROJECTION sandbox.M_D_PRODUCTS_b0 /*+basename(M_D_PRODUCTS),createtype(L)*/ 
(
 MOVEMENT_DISORDER_PRODUCTS
)
AS
 SELECT M_D_PRODUCTS.MOVEMENT_DISORDER_PRODUCTS
 FROM sandbox.M_D_PRODUCTS
 ORDER BY M_D_PRODUCTS.MOVEMENT_DISORDER_PRODUCTS
SEGMENTED BY hash(M_D_PRODUCTS.MOVEMENT_DISORDER_PRODUCTS) ALL NODES;

CREATE PROJECTION sandbox.AUSTEDO_BASKET_BRAND_b0 /*+basename(AUSTEDO_BASKET_BRAND),createtype(L)*/ 
(
 MOVEMENT_DISORDER_PRODUCTS
)
AS
 SELECT AUSTEDO_BASKET_BRAND.MOVEMENT_DISORDER_PRODUCTS
 FROM sandbox.AUSTEDO_BASKET_BRAND
 ORDER BY AUSTEDO_BASKET_BRAND.MOVEMENT_DISORDER_PRODUCTS
SEGMENTED BY hash(AUSTEDO_BASKET_BRAND.MOVEMENT_DISORDER_PRODUCTS) ALL NODES;

CREATE PROJECTION sandbox.ONC_Basket_IDs_for_QA_b0 /*+basename(ONC_Basket_IDs_for_QA),createtype(L)*/ 
(
 BRAND,
 basket_id
)
AS
 SELECT ONC_Basket_IDs_for_QA.BRAND,
        ONC_Basket_IDs_for_QA.basket_id
 FROM sandbox.ONC_Basket_IDs_for_QA
 ORDER BY ONC_Basket_IDs_for_QA.BRAND,
          ONC_Basket_IDs_for_QA.basket_id
SEGMENTED BY hash(ONC_Basket_IDs_for_QA.basket_id, ONC_Basket_IDs_for_QA.BRAND) ALL NODES;

CREATE PROJECTION sandbox.PGK_Q12020Call_Plan_b0 /*+basename(PGK_Q12020Call_Plan),createtype(L)*/ 
(
 "Sales Team",
 specialty,
 "Specialty Group",
 decile,
 "Decile Group",
 veeva_account_id,
 tvcmid,
 ims_id,
 first_name,
 last_name,
 terr,
 address1,
 city,
 state,
 zip
)
AS
 SELECT PGK_Q12020Call_Plan."Sales Team",
        PGK_Q12020Call_Plan.specialty,
        PGK_Q12020Call_Plan."Specialty Group",
        PGK_Q12020Call_Plan.decile,
        PGK_Q12020Call_Plan."Decile Group",
        PGK_Q12020Call_Plan.veeva_account_id,
        PGK_Q12020Call_Plan.tvcmid,
        PGK_Q12020Call_Plan.ims_id,
        PGK_Q12020Call_Plan.first_name,
        PGK_Q12020Call_Plan.last_name,
        PGK_Q12020Call_Plan.terr,
        PGK_Q12020Call_Plan.address1,
        PGK_Q12020Call_Plan.city,
        PGK_Q12020Call_Plan.state,
        PGK_Q12020Call_Plan.zip
 FROM sandbox.PGK_Q12020Call_Plan
 ORDER BY PGK_Q12020Call_Plan."Sales Team",
          PGK_Q12020Call_Plan.specialty,
          PGK_Q12020Call_Plan."Specialty Group",
          PGK_Q12020Call_Plan.decile,
          PGK_Q12020Call_Plan."Decile Group",
          PGK_Q12020Call_Plan.veeva_account_id,
          PGK_Q12020Call_Plan.tvcmid,
          PGK_Q12020Call_Plan.ims_id
SEGMENTED BY hash(PGK_Q12020Call_Plan.decile, PGK_Q12020Call_Plan.tvcmid, PGK_Q12020Call_Plan.zip, PGK_Q12020Call_Plan."Sales Team", PGK_Q12020Call_Plan.specialty, PGK_Q12020Call_Plan."Specialty Group", PGK_Q12020Call_Plan."Decile Group", PGK_Q12020Call_Plan.veeva_account_id) ALL NODES;

CREATE PROJECTION sandbox.customer_mb_b0 /*+basename(customer_mb),createtype(A)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 ims_outlet_code,
 ims_facility_number,
 federation_id,
 customer_type,
 prescriber_type,
 network_name,
 account_name,
 physician_first_name,
 physician_last_name,
 credential,
 subcat_group,
 subcat_code,
 pdrp_flag,
 pri_specialty_code,
 pri_specialty_desc,
 sec_specialty_code,
 sec_specialty_desc,
 cm_status_flag,
 gpo,
 dnp_flag,
 product_1_dnc_flag,
 product_2_dnc_flag,
 a_specialty_group,
 b_specialty_group,
 c_specialty_group,
 formulary_control
)
AS
 SELECT customer_mb.customer_id,
        customer_mb.tvcmid,
        customer_mb.ims_id,
        customer_mb.ims_outlet_code,
        customer_mb.ims_facility_number,
        customer_mb.federation_id,
        customer_mb.customer_type,
        customer_mb.prescriber_type,
        customer_mb.network_name,
        customer_mb.account_name,
        customer_mb.physician_first_name,
        customer_mb.physician_last_name,
        customer_mb.credential,
        customer_mb.subcat_group,
        customer_mb.subcat_code,
        customer_mb.pdrp_flag,
        customer_mb.pri_specialty_code,
        customer_mb.pri_specialty_desc,
        customer_mb.sec_specialty_code,
        customer_mb.sec_specialty_desc,
        customer_mb.cm_status_flag,
        customer_mb.gpo,
        customer_mb.dnp_flag,
        customer_mb.product_1_dnc_flag,
        customer_mb.product_2_dnc_flag,
        customer_mb.a_specialty_group,
        customer_mb.b_specialty_group,
        customer_mb.c_specialty_group,
        customer_mb.formulary_control
 FROM sandbox.customer_mb
 ORDER BY customer_mb.customer_id,
          customer_mb.tvcmid,
          customer_mb.ims_id,
          customer_mb.ims_outlet_code,
          customer_mb.ims_facility_number,
          customer_mb.federation_id,
          customer_mb.customer_type,
          customer_mb.prescriber_type
SEGMENTED BY hash(customer_mb.tvcmid, customer_mb.subcat_code, customer_mb.pdrp_flag, customer_mb.dnp_flag, customer_mb.product_1_dnc_flag, customer_mb.product_2_dnc_flag, customer_mb.ims_id, customer_mb.ims_outlet_code) ALL NODES;

CREATE PROJECTION sandbox.test_concur_prev_b0 /*+basename(test_concur_prev),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT test_con_prev.cust_id,
        test_con_prev.organization_name,
        test_con_prev.contact_type,
        test_con_prev.first_name,
        test_con_prev.middle_name,
        test_con_prev.last_name,
        test_con_prev.suffix,
        test_con_prev.npi,
        test_con_prev.address_line_1,
        test_con_prev.address_line_2,
        test_con_prev.city,
        test_con_prev.state,
        test_con_prev.zipcode,
        test_con_prev.sln,
        test_con_prev.sln_state,
        test_con_prev.dea,
        test_con_prev.affiliation,
        test_con_prev.credential,
        test_con_prev.healthcare_professional_status_code
 FROM sandbox.test_con_prev
 ORDER BY test_con_prev.cust_id,
          test_con_prev.first_name,
          test_con_prev.middle_name,
          test_con_prev.last_name,
          test_con_prev.suffix,
          test_con_prev.npi,
          test_con_prev.address_line_1,
          test_con_prev.address_line_2,
          test_con_prev.city,
          test_con_prev.state,
          test_con_prev.zipcode,
          test_con_prev.sln,
          test_con_prev.sln_state,
          test_con_prev.dea,
          test_con_prev.credential,
          test_con_prev.healthcare_professional_status_code
SEGMENTED BY hash(test_con_prev.cust_id, test_con_prev.first_name, test_con_prev.middle_name, test_con_prev.last_name, test_con_prev.suffix, test_con_prev.npi, test_con_prev.address_line_1, test_con_prev.address_line_2, test_con_prev.city, test_con_prev.state, test_con_prev.zipcode, test_con_prev.sln, test_con_prev.sln_state, test_con_prev.dea, test_con_prev.credential, test_con_prev.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.mb_ic_demo_tp_b0 /*+basename(mb_ic_demo_tp),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT mb_ic_demo_tp.ic_data_month,
        mb_ic_demo_tp.sales_force_id,
        mb_ic_demo_tp.area_number,
        mb_ic_demo_tp.region_number,
        mb_ic_demo_tp.territory_number,
        mb_ic_demo_tp.ims_id,
        mb_ic_demo_tp.tvcmid,
        mb_ic_demo_tp.outlet_code,
        mb_ic_demo_tp.va_station_number,
        mb_ic_demo_tp.specialty,
        mb_ic_demo_tp.last_name,
        mb_ic_demo_tp.first_name,
        mb_ic_demo_tp.mid_name,
        mb_ic_demo_tp.address_1,
        mb_ic_demo_tp.address_2,
        mb_ic_demo_tp.address_3,
        mb_ic_demo_tp.city,
        mb_ic_demo_tp.state,
        mb_ic_demo_tp.zip,
        mb_ic_demo_tp.address_source,
        mb_ic_demo_tp.pdrp_flag,
        mb_ic_demo_tp.pdrp_date,
        mb_ic_demo_tp.np_pa_flag,
        mb_ic_demo_tp.no_spend,
        mb_ic_demo_tp.ama_no_contact_flag,
        mb_ic_demo_tp.join_key,
        mb_ic_demo_tp.row_source,
        mb_ic_demo_tp.row_create_date,
        mb_ic_demo_tp.outlet_dea,
        mb_ic_demo_tp.secondary_specialty
 FROM sandbox.mb_ic_demo_tp
 ORDER BY mb_ic_demo_tp.ic_data_month,
          mb_ic_demo_tp.sales_force_id,
          mb_ic_demo_tp.area_number,
          mb_ic_demo_tp.region_number,
          mb_ic_demo_tp.territory_number,
          mb_ic_demo_tp.ims_id,
          mb_ic_demo_tp.tvcmid,
          mb_ic_demo_tp.outlet_code
SEGMENTED BY hash(mb_ic_demo_tp.ic_data_month, mb_ic_demo_tp.tvcmid, mb_ic_demo_tp.outlet_code, mb_ic_demo_tp.mid_name, mb_ic_demo_tp.state, mb_ic_demo_tp.zip, mb_ic_demo_tp.pdrp_flag, mb_ic_demo_tp.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.concur_hcp_prev_b0 /*+basename(concur_hcp_prev),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code
)
AS
 SELECT concur_hcp_prev.cust_id,
        concur_hcp_prev.organization_name,
        concur_hcp_prev.contact_type,
        concur_hcp_prev.first_name,
        concur_hcp_prev.middle_name,
        concur_hcp_prev.last_name,
        concur_hcp_prev.suffix,
        concur_hcp_prev.npi,
        concur_hcp_prev.address_line_1,
        concur_hcp_prev.address_line_2,
        concur_hcp_prev.city,
        concur_hcp_prev.state,
        concur_hcp_prev.zipcode,
        concur_hcp_prev.sln,
        concur_hcp_prev.sln_state,
        concur_hcp_prev.dea,
        concur_hcp_prev.affiliation,
        concur_hcp_prev.credential,
        concur_hcp_prev.healthcare_professional_status_code
 FROM sandbox.concur_hcp_prev
 ORDER BY concur_hcp_prev.cust_id,
          concur_hcp_prev.first_name,
          concur_hcp_prev.middle_name,
          concur_hcp_prev.last_name,
          concur_hcp_prev.suffix,
          concur_hcp_prev.npi,
          concur_hcp_prev.address_line_1,
          concur_hcp_prev.address_line_2,
          concur_hcp_prev.city,
          concur_hcp_prev.state,
          concur_hcp_prev.zipcode,
          concur_hcp_prev.sln,
          concur_hcp_prev.sln_state,
          concur_hcp_prev.dea,
          concur_hcp_prev.credential,
          concur_hcp_prev.healthcare_professional_status_code
SEGMENTED BY hash(concur_hcp_prev.cust_id, concur_hcp_prev.first_name, concur_hcp_prev.middle_name, concur_hcp_prev.last_name, concur_hcp_prev.suffix, concur_hcp_prev.npi, concur_hcp_prev.address_line_1, concur_hcp_prev.address_line_2, concur_hcp_prev.city, concur_hcp_prev.state, concur_hcp_prev.zipcode, concur_hcp_prev.sln, concur_hcp_prev.sln_state, concur_hcp_prev.dea, concur_hcp_prev.credential, concur_hcp_prev.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.IC_QA_062020_NEWWRITERS_b0 /*+basename(IC_QA_062020_NEWWRITERS),createtype(L)*/ 
(
 "New HCPs for Apr",
 "HCP Status"
)
AS
 SELECT IC_QA_062020_NEWWRITERS."New HCPs for Apr",
        IC_QA_062020_NEWWRITERS."HCP Status"
 FROM sandbox.IC_QA_062020_NEWWRITERS
 ORDER BY IC_QA_062020_NEWWRITERS."New HCPs for Apr",
          IC_QA_062020_NEWWRITERS."HCP Status"
SEGMENTED BY hash(IC_QA_062020_NEWWRITERS."New HCPs for Apr", IC_QA_062020_NEWWRITERS."HCP Status") ALL NODES;

CREATE PROJECTION sandbox.idl_best_address_2_b0 /*+basename(idl_best_address_2),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT idl_best_address_2.cust_id,
        idl_best_address_2.organization_name,
        idl_best_address_2.contact_type,
        idl_best_address_2.first_name,
        idl_best_address_2.middle_name,
        idl_best_address_2.last_name,
        idl_best_address_2.suffix,
        idl_best_address_2.npi,
        idl_best_address_2.address_line_1,
        idl_best_address_2.address_line_2,
        idl_best_address_2.city,
        idl_best_address_2.state,
        idl_best_address_2.zipcode,
        idl_best_address_2.sln,
        idl_best_address_2.sln_state,
        idl_best_address_2.dea,
        idl_best_address_2.affiliation,
        idl_best_address_2.credential,
        idl_best_address_2.healthcare_professional_status_code,
        idl_best_address_2.create_date
 FROM sandbox.idl_best_address_2
 ORDER BY idl_best_address_2.cust_id,
          idl_best_address_2.first_name,
          idl_best_address_2.middle_name,
          idl_best_address_2.last_name,
          idl_best_address_2.suffix,
          idl_best_address_2.npi,
          idl_best_address_2.address_line_1,
          idl_best_address_2.address_line_2,
          idl_best_address_2.city,
          idl_best_address_2.state,
          idl_best_address_2.zipcode,
          idl_best_address_2.sln,
          idl_best_address_2.sln_state,
          idl_best_address_2.dea,
          idl_best_address_2.credential,
          idl_best_address_2.healthcare_professional_status_code
SEGMENTED BY hash(idl_best_address_2.cust_id, idl_best_address_2.first_name, idl_best_address_2.middle_name, idl_best_address_2.last_name, idl_best_address_2.suffix, idl_best_address_2.npi, idl_best_address_2.address_line_1, idl_best_address_2.address_line_2, idl_best_address_2.city, idl_best_address_2.state, idl_best_address_2.zipcode, idl_best_address_2.sln, idl_best_address_2.sln_state, idl_best_address_2.dea, idl_best_address_2.credential, idl_best_address_2.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.idl_best_address_non2_b0 /*+basename(idl_best_address_non2),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT idl_best_address_non2.cust_id,
        idl_best_address_non2.organization_name,
        idl_best_address_non2.contact_type,
        idl_best_address_non2.first_name,
        idl_best_address_non2.middle_name,
        idl_best_address_non2.last_name,
        idl_best_address_non2.suffix,
        idl_best_address_non2.npi,
        idl_best_address_non2.address_line_1,
        idl_best_address_non2.address_line_2,
        idl_best_address_non2.city,
        idl_best_address_non2.state,
        idl_best_address_non2.zipcode,
        idl_best_address_non2.sln,
        idl_best_address_non2.sln_state,
        idl_best_address_non2.dea,
        idl_best_address_non2.affiliation,
        idl_best_address_non2.credential,
        idl_best_address_non2.healthcare_professional_status_code,
        idl_best_address_non2.create_date
 FROM sandbox.idl_best_address_non2
 ORDER BY idl_best_address_non2.cust_id,
          idl_best_address_non2.first_name,
          idl_best_address_non2.middle_name,
          idl_best_address_non2.last_name,
          idl_best_address_non2.suffix,
          idl_best_address_non2.npi,
          idl_best_address_non2.address_line_1,
          idl_best_address_non2.address_line_2,
          idl_best_address_non2.city,
          idl_best_address_non2.state,
          idl_best_address_non2.zipcode,
          idl_best_address_non2.sln,
          idl_best_address_non2.sln_state,
          idl_best_address_non2.dea,
          idl_best_address_non2.credential,
          idl_best_address_non2.healthcare_professional_status_code
SEGMENTED BY hash(idl_best_address_non2.cust_id, idl_best_address_non2.first_name, idl_best_address_non2.middle_name, idl_best_address_non2.last_name, idl_best_address_non2.suffix, idl_best_address_non2.npi, idl_best_address_non2.address_line_1, idl_best_address_non2.address_line_2, idl_best_address_non2.city, idl_best_address_non2.state, idl_best_address_non2.zipcode, idl_best_address_non2.sln, idl_best_address_non2.sln_state, idl_best_address_non2.dea, idl_best_address_non2.credential, idl_best_address_non2.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.TN_UNIVRS_AUG2020_b0 /*+basename(TN_UNIVRS_AUG2020),createtype(L)*/ 
(
 sales_force_id,
 freeze_reason,
 freeze_date,
 start_date,
 end_date,
 ims_id,
 tvcmid
)
AS
 SELECT TN_UNIVRS_AUG2020.sales_force_id,
        TN_UNIVRS_AUG2020.freeze_reason,
        TN_UNIVRS_AUG2020.freeze_date,
        TN_UNIVRS_AUG2020.start_date,
        TN_UNIVRS_AUG2020.end_date,
        TN_UNIVRS_AUG2020.ims_id,
        TN_UNIVRS_AUG2020.tvcmid
 FROM sandbox.TN_UNIVRS_AUG2020
 ORDER BY TN_UNIVRS_AUG2020.sales_force_id,
          TN_UNIVRS_AUG2020.freeze_reason,
          TN_UNIVRS_AUG2020.freeze_date,
          TN_UNIVRS_AUG2020.start_date,
          TN_UNIVRS_AUG2020.end_date,
          TN_UNIVRS_AUG2020.ims_id,
          TN_UNIVRS_AUG2020.tvcmid
SEGMENTED BY hash(TN_UNIVRS_AUG2020.freeze_date, TN_UNIVRS_AUG2020.start_date, TN_UNIVRS_AUG2020.end_date, TN_UNIVRS_AUG2020.ims_id, TN_UNIVRS_AUG2020.tvcmid, TN_UNIVRS_AUG2020.sales_force_id, TN_UNIVRS_AUG2020.freeze_reason) ALL NODES;

CREATE PROJECTION sandbox.test_woprefix_b0 /*+basename(test_woprefix),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT test_woprefix.cust_id,
        test_woprefix.organization_name,
        test_woprefix.contact_type,
        test_woprefix.first_name,
        test_woprefix.middle_name,
        test_woprefix.last_name,
        test_woprefix.suffix,
        test_woprefix.npi,
        test_woprefix.address_line_1,
        test_woprefix.address_line_2,
        test_woprefix.city,
        test_woprefix.state,
        test_woprefix.zipcode,
        test_woprefix.sln,
        test_woprefix.sln_state,
        test_woprefix.dea,
        test_woprefix.affiliation,
        test_woprefix.credential,
        test_woprefix.healthcare_professional_status_code,
        test_woprefix.create_date
 FROM sandbox.test_woprefix
 ORDER BY test_woprefix.cust_id,
          test_woprefix.first_name,
          test_woprefix.middle_name,
          test_woprefix.last_name,
          test_woprefix.suffix,
          test_woprefix.npi,
          test_woprefix.address_line_1,
          test_woprefix.address_line_2,
          test_woprefix.city,
          test_woprefix.state,
          test_woprefix.zipcode,
          test_woprefix.sln,
          test_woprefix.sln_state,
          test_woprefix.dea,
          test_woprefix.credential,
          test_woprefix.healthcare_professional_status_code
SEGMENTED BY hash(test_woprefix.cust_id, test_woprefix.first_name, test_woprefix.middle_name, test_woprefix.last_name, test_woprefix.suffix, test_woprefix.npi, test_woprefix.address_line_1, test_woprefix.address_line_2, test_woprefix.city, test_woprefix.state, test_woprefix.zipcode, test_woprefix.sln, test_woprefix.sln_state, test_woprefix.dea, test_woprefix.credential, test_woprefix.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.test_wprefix_b0 /*+basename(test_wprefix),createtype(A)*/ 
(
 cust_id,
 organization_name,
 contact_type,
 first_name,
 middle_name,
 last_name,
 suffix,
 npi,
 address_line_1,
 address_line_2,
 city,
 state,
 zipcode,
 sln,
 sln_state,
 dea,
 affiliation,
 credential,
 healthcare_professional_status_code,
 create_date
)
AS
 SELECT test_wprefix.cust_id,
        test_wprefix.organization_name,
        test_wprefix.contact_type,
        test_wprefix.first_name,
        test_wprefix.middle_name,
        test_wprefix.last_name,
        test_wprefix.suffix,
        test_wprefix.npi,
        test_wprefix.address_line_1,
        test_wprefix.address_line_2,
        test_wprefix.city,
        test_wprefix.state,
        test_wprefix.zipcode,
        test_wprefix.sln,
        test_wprefix.sln_state,
        test_wprefix.dea,
        test_wprefix.affiliation,
        test_wprefix.credential,
        test_wprefix.healthcare_professional_status_code,
        test_wprefix.create_date
 FROM sandbox.test_wprefix
 ORDER BY test_wprefix.cust_id,
          test_wprefix.first_name,
          test_wprefix.middle_name,
          test_wprefix.last_name,
          test_wprefix.suffix,
          test_wprefix.npi,
          test_wprefix.address_line_1,
          test_wprefix.address_line_2,
          test_wprefix.city,
          test_wprefix.state,
          test_wprefix.zipcode,
          test_wprefix.sln,
          test_wprefix.sln_state,
          test_wprefix.dea,
          test_wprefix.credential,
          test_wprefix.healthcare_professional_status_code
SEGMENTED BY hash(test_wprefix.cust_id, test_wprefix.first_name, test_wprefix.middle_name, test_wprefix.last_name, test_wprefix.suffix, test_wprefix.npi, test_wprefix.address_line_1, test_wprefix.address_line_2, test_wprefix.city, test_wprefix.state, test_wprefix.zipcode, test_wprefix.sln, test_wprefix.sln_state, test_wprefix.dea, test_wprefix.credential, test_wprefix.healthcare_professional_status_code) ALL NODES;

CREATE PROJECTION sandbox.prescriber_rx_adhoc_09252020_b0 /*+basename(prescriber_rx_adhoc_09252020),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication
)
AS
 SELECT prescriber_rx_adhoc_06282021.ims_id,
        prescriber_rx_adhoc_06282021.payer_plan_number,
        prescriber_rx_adhoc_06282021.ims_client_number,
        prescriber_rx_adhoc_06282021.report_frequency,
        prescriber_rx_adhoc_06282021.ims_product_group,
        prescriber_rx_adhoc_06282021.basket_id,
        prescriber_rx_adhoc_06282021.data_date,
        prescriber_rx_adhoc_06282021.date,
        prescriber_rx_adhoc_06282021.sales_category,
        prescriber_rx_adhoc_06282021.tvcmid,
        prescriber_rx_adhoc_06282021.prescriber_first_name,
        prescriber_rx_adhoc_06282021.prescriber_last_name,
        prescriber_rx_adhoc_06282021.basket_name,
        prescriber_rx_adhoc_06282021.basket_type,
        prescriber_rx_adhoc_06282021.rollup_week,
        prescriber_rx_adhoc_06282021.rollup_month,
        prescriber_rx_adhoc_06282021.nrx_count,
        prescriber_rx_adhoc_06282021.trx_count,
        prescriber_rx_adhoc_06282021.nrx_quantity,
        prescriber_rx_adhoc_06282021.trx_quantity,
        prescriber_rx_adhoc_06282021.unnormalized_nrx_count,
        prescriber_rx_adhoc_06282021.unnormalized_trx_count,
        prescriber_rx_adhoc_06282021.market_name,
        prescriber_rx_adhoc_06282021.payer_name,
        prescriber_rx_adhoc_06282021.plan_name,
        prescriber_rx_adhoc_06282021.pbm_name,
        prescriber_rx_adhoc_06282021.model,
        prescriber_rx_adhoc_06282021.payment_method,
        prescriber_rx_adhoc_06282021.ims_specialty,
        prescriber_rx_adhoc_06282021.ims_rx_type,
        prescriber_rx_adhoc_06282021.ims_supplemental_data,
        prescriber_rx_adhoc_06282021.ims_zip_other,
        prescriber_rx_adhoc_06282021.ims_report_number_cnt,
        prescriber_rx_adhoc_06282021.cnt_file_id,
        prescriber_rx_adhoc_06282021.cnt_record_id,
        prescriber_rx_adhoc_06282021.ims_report_number_qty,
        prescriber_rx_adhoc_06282021.qty_file_id,
        prescriber_rx_adhoc_06282021.qty_record_id,
        prescriber_rx_adhoc_06282021.rollup_flag,
        prescriber_rx_adhoc_06282021.indication
 FROM sandbox.prescriber_rx_adhoc_06282021
 ORDER BY prescriber_rx_adhoc_06282021.ims_id,
          prescriber_rx_adhoc_06282021.payer_plan_number,
          prescriber_rx_adhoc_06282021.ims_client_number,
          prescriber_rx_adhoc_06282021.report_frequency,
          prescriber_rx_adhoc_06282021.ims_product_group,
          prescriber_rx_adhoc_06282021.basket_id,
          prescriber_rx_adhoc_06282021.data_date,
          prescriber_rx_adhoc_06282021.date,
          prescriber_rx_adhoc_06282021.sales_category,
          prescriber_rx_adhoc_06282021.tvcmid,
          prescriber_rx_adhoc_06282021.prescriber_first_name,
          prescriber_rx_adhoc_06282021.prescriber_last_name,
          prescriber_rx_adhoc_06282021.basket_name,
          prescriber_rx_adhoc_06282021.basket_type,
          prescriber_rx_adhoc_06282021.rollup_week,
          prescriber_rx_adhoc_06282021.rollup_month,
          prescriber_rx_adhoc_06282021.nrx_count,
          prescriber_rx_adhoc_06282021.trx_count,
          prescriber_rx_adhoc_06282021.nrx_quantity,
          prescriber_rx_adhoc_06282021.trx_quantity,
          prescriber_rx_adhoc_06282021.unnormalized_nrx_count,
          prescriber_rx_adhoc_06282021.unnormalized_trx_count,
          prescriber_rx_adhoc_06282021.market_name,
          prescriber_rx_adhoc_06282021.payer_name,
          prescriber_rx_adhoc_06282021.plan_name,
          prescriber_rx_adhoc_06282021.pbm_name,
          prescriber_rx_adhoc_06282021.model,
          prescriber_rx_adhoc_06282021.payment_method,
          prescriber_rx_adhoc_06282021.ims_specialty,
          prescriber_rx_adhoc_06282021.ims_rx_type,
          prescriber_rx_adhoc_06282021.ims_supplemental_data,
          prescriber_rx_adhoc_06282021.ims_zip_other,
          prescriber_rx_adhoc_06282021.ims_report_number_cnt,
          prescriber_rx_adhoc_06282021.cnt_file_id,
          prescriber_rx_adhoc_06282021.cnt_record_id,
          prescriber_rx_adhoc_06282021.ims_report_number_qty,
          prescriber_rx_adhoc_06282021.qty_file_id,
          prescriber_rx_adhoc_06282021.qty_record_id,
          prescriber_rx_adhoc_06282021.rollup_flag,
          prescriber_rx_adhoc_06282021.indication
SEGMENTED BY hash(prescriber_rx_adhoc_06282021.ims_client_number, prescriber_rx_adhoc_06282021.basket_id, prescriber_rx_adhoc_06282021.data_date, prescriber_rx_adhoc_06282021.date, prescriber_rx_adhoc_06282021.sales_category, prescriber_rx_adhoc_06282021.tvcmid, prescriber_rx_adhoc_06282021.rollup_week, prescriber_rx_adhoc_06282021.rollup_month, prescriber_rx_adhoc_06282021.nrx_count, prescriber_rx_adhoc_06282021.trx_count, prescriber_rx_adhoc_06282021.nrx_quantity, prescriber_rx_adhoc_06282021.trx_quantity, prescriber_rx_adhoc_06282021.unnormalized_nrx_count, prescriber_rx_adhoc_06282021.unnormalized_trx_count, prescriber_rx_adhoc_06282021.ims_rx_type, prescriber_rx_adhoc_06282021.ims_report_number_cnt, prescriber_rx_adhoc_06282021.cnt_file_id, prescriber_rx_adhoc_06282021.cnt_record_id, prescriber_rx_adhoc_06282021.ims_report_number_qty, prescriber_rx_adhoc_06282021.qty_file_id, prescriber_rx_adhoc_06282021.qty_record_id, prescriber_rx_adhoc_06282021.rollup_flag, prescriber_rx_adhoc_06282021.ims_id, prescriber_rx_adhoc_06282021.payer_plan_number, prescriber_rx_adhoc_06282021.ims_product_group, prescriber_rx_adhoc_06282021.ims_specialty, prescriber_rx_adhoc_06282021.ims_zip_other, prescriber_rx_adhoc_06282021.report_frequency, prescriber_rx_adhoc_06282021.ims_supplemental_data, prescriber_rx_adhoc_06282021.indication, prescriber_rx_adhoc_06282021.prescriber_first_name, prescriber_rx_adhoc_06282021.prescriber_last_name) ALL NODES;

CREATE PROJECTION sandbox."IMS ID ISSUES_AJOVY10262020_b0" /*+basename(IMS ID ISSUES_AJOVY10262020),createtype(L)*/ 
(
 "IMS ID"
)
AS
 SELECT "IMS ID ISSUES_AJOVY10262020"."IMS ID"
 FROM sandbox."IMS ID ISSUES_AJOVY10262020"
 ORDER BY "IMS ID ISSUES_AJOVY10262020"."IMS ID"
SEGMENTED BY hash("IMS ID ISSUES_AJOVY10262020"."IMS ID") ALL NODES;

CREATE PROJECTION sandbox."IQVIA OPTUM OUTLETS11032020_b0" /*+basename(IQVIA OPTUM OUTLETS11032020),createtype(L)*/ 
(
 "Outlet #",
 Active,
 PRE,
 Name,
 "10/2/2020 12:00:00 AM"
)
AS
 SELECT "IQVIA OPTUM OUTLETS11032020"."Outlet #",
        "IQVIA OPTUM OUTLETS11032020".Active,
        "IQVIA OPTUM OUTLETS11032020".PRE,
        "IQVIA OPTUM OUTLETS11032020".Name,
        "IQVIA OPTUM OUTLETS11032020"."10/2/2020 12:00:00 AM"
 FROM sandbox."IQVIA OPTUM OUTLETS11032020"
 ORDER BY "IQVIA OPTUM OUTLETS11032020"."Outlet #",
          "IQVIA OPTUM OUTLETS11032020".Active,
          "IQVIA OPTUM OUTLETS11032020".PRE,
          "IQVIA OPTUM OUTLETS11032020".Name,
          "IQVIA OPTUM OUTLETS11032020"."10/2/2020 12:00:00 AM"
SEGMENTED BY hash("IQVIA OPTUM OUTLETS11032020"."Outlet #", "IQVIA OPTUM OUTLETS11032020".PRE, "IQVIA OPTUM OUTLETS11032020".Active, "IQVIA OPTUM OUTLETS11032020"."10/2/2020 12:00:00 AM", "IQVIA OPTUM OUTLETS11032020".Name) ALL NODES;

CREATE PROJECTION sandbox.RELIANCE_PRODUCT_MODEL_b0 /*+basename(RELIANCE_PRODUCT_MODEL),createtype(L)*/ 
(
 Market,
 "Source Name",
 "Product Name",
 "Product Description",
 "Manufacturer Name"
)
AS
 SELECT RELIANCE_PRODUCT_MODEL.Market,
        RELIANCE_PRODUCT_MODEL."Source Name",
        RELIANCE_PRODUCT_MODEL."Product Name",
        RELIANCE_PRODUCT_MODEL."Product Description",
        RELIANCE_PRODUCT_MODEL."Manufacturer Name"
 FROM sandbox.RELIANCE_PRODUCT_MODEL
 ORDER BY RELIANCE_PRODUCT_MODEL.Market,
          RELIANCE_PRODUCT_MODEL."Source Name",
          RELIANCE_PRODUCT_MODEL."Product Name",
          RELIANCE_PRODUCT_MODEL."Product Description",
          RELIANCE_PRODUCT_MODEL."Manufacturer Name"
SEGMENTED BY hash(RELIANCE_PRODUCT_MODEL.Market, RELIANCE_PRODUCT_MODEL."Source Name", RELIANCE_PRODUCT_MODEL."Manufacturer Name", RELIANCE_PRODUCT_MODEL."Product Name", RELIANCE_PRODUCT_MODEL."Product Description") ALL NODES;

CREATE PROJECTION sandbox.prescriber_rx_adhoc_12022020_b0 /*+basename(prescriber_rx_adhoc_12022020),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication
)
AS
 SELECT prescriber_rx_adhoc_12022020.ims_id,
        prescriber_rx_adhoc_12022020.payer_plan_number,
        prescriber_rx_adhoc_12022020.ims_client_number,
        prescriber_rx_adhoc_12022020.report_frequency,
        prescriber_rx_adhoc_12022020.ims_product_group,
        prescriber_rx_adhoc_12022020.basket_id,
        prescriber_rx_adhoc_12022020.data_date,
        prescriber_rx_adhoc_12022020.date,
        prescriber_rx_adhoc_12022020.sales_category,
        prescriber_rx_adhoc_12022020.tvcmid,
        prescriber_rx_adhoc_12022020.prescriber_first_name,
        prescriber_rx_adhoc_12022020.prescriber_last_name,
        prescriber_rx_adhoc_12022020.basket_name,
        prescriber_rx_adhoc_12022020.basket_type,
        prescriber_rx_adhoc_12022020.rollup_week,
        prescriber_rx_adhoc_12022020.rollup_month,
        prescriber_rx_adhoc_12022020.nrx_count,
        prescriber_rx_adhoc_12022020.trx_count,
        prescriber_rx_adhoc_12022020.nrx_quantity,
        prescriber_rx_adhoc_12022020.trx_quantity,
        prescriber_rx_adhoc_12022020.unnormalized_nrx_count,
        prescriber_rx_adhoc_12022020.unnormalized_trx_count,
        prescriber_rx_adhoc_12022020.market_name,
        prescriber_rx_adhoc_12022020.payer_name,
        prescriber_rx_adhoc_12022020.plan_name,
        prescriber_rx_adhoc_12022020.pbm_name,
        prescriber_rx_adhoc_12022020.model,
        prescriber_rx_adhoc_12022020.payment_method,
        prescriber_rx_adhoc_12022020.ims_specialty,
        prescriber_rx_adhoc_12022020.ims_rx_type,
        prescriber_rx_adhoc_12022020.ims_supplemental_data,
        prescriber_rx_adhoc_12022020.ims_zip_other,
        prescriber_rx_adhoc_12022020.ims_report_number_cnt,
        prescriber_rx_adhoc_12022020.cnt_file_id,
        prescriber_rx_adhoc_12022020.cnt_record_id,
        prescriber_rx_adhoc_12022020.ims_report_number_qty,
        prescriber_rx_adhoc_12022020.qty_file_id,
        prescriber_rx_adhoc_12022020.qty_record_id,
        prescriber_rx_adhoc_12022020.rollup_flag,
        prescriber_rx_adhoc_12022020.indication
 FROM sandbox.prescriber_rx_adhoc_12022020
 ORDER BY prescriber_rx_adhoc_12022020.ims_id,
          prescriber_rx_adhoc_12022020.payer_plan_number,
          prescriber_rx_adhoc_12022020.ims_client_number,
          prescriber_rx_adhoc_12022020.report_frequency,
          prescriber_rx_adhoc_12022020.ims_product_group,
          prescriber_rx_adhoc_12022020.basket_id,
          prescriber_rx_adhoc_12022020.data_date,
          prescriber_rx_adhoc_12022020.date,
          prescriber_rx_adhoc_12022020.sales_category,
          prescriber_rx_adhoc_12022020.tvcmid,
          prescriber_rx_adhoc_12022020.prescriber_first_name,
          prescriber_rx_adhoc_12022020.prescriber_last_name,
          prescriber_rx_adhoc_12022020.basket_name,
          prescriber_rx_adhoc_12022020.basket_type,
          prescriber_rx_adhoc_12022020.rollup_week,
          prescriber_rx_adhoc_12022020.rollup_month,
          prescriber_rx_adhoc_12022020.nrx_count,
          prescriber_rx_adhoc_12022020.trx_count,
          prescriber_rx_adhoc_12022020.nrx_quantity,
          prescriber_rx_adhoc_12022020.trx_quantity,
          prescriber_rx_adhoc_12022020.unnormalized_nrx_count,
          prescriber_rx_adhoc_12022020.unnormalized_trx_count,
          prescriber_rx_adhoc_12022020.market_name,
          prescriber_rx_adhoc_12022020.payer_name,
          prescriber_rx_adhoc_12022020.plan_name,
          prescriber_rx_adhoc_12022020.pbm_name,
          prescriber_rx_adhoc_12022020.model,
          prescriber_rx_adhoc_12022020.payment_method,
          prescriber_rx_adhoc_12022020.ims_specialty,
          prescriber_rx_adhoc_12022020.ims_rx_type,
          prescriber_rx_adhoc_12022020.ims_supplemental_data,
          prescriber_rx_adhoc_12022020.ims_zip_other,
          prescriber_rx_adhoc_12022020.ims_report_number_cnt,
          prescriber_rx_adhoc_12022020.cnt_file_id,
          prescriber_rx_adhoc_12022020.cnt_record_id,
          prescriber_rx_adhoc_12022020.ims_report_number_qty,
          prescriber_rx_adhoc_12022020.qty_file_id,
          prescriber_rx_adhoc_12022020.qty_record_id,
          prescriber_rx_adhoc_12022020.rollup_flag,
          prescriber_rx_adhoc_12022020.indication
SEGMENTED BY hash(prescriber_rx_adhoc_12022020.ims_client_number, prescriber_rx_adhoc_12022020.basket_id, prescriber_rx_adhoc_12022020.data_date, prescriber_rx_adhoc_12022020.date, prescriber_rx_adhoc_12022020.sales_category, prescriber_rx_adhoc_12022020.tvcmid, prescriber_rx_adhoc_12022020.rollup_week, prescriber_rx_adhoc_12022020.rollup_month, prescriber_rx_adhoc_12022020.nrx_count, prescriber_rx_adhoc_12022020.trx_count, prescriber_rx_adhoc_12022020.nrx_quantity, prescriber_rx_adhoc_12022020.trx_quantity, prescriber_rx_adhoc_12022020.unnormalized_nrx_count, prescriber_rx_adhoc_12022020.unnormalized_trx_count, prescriber_rx_adhoc_12022020.ims_rx_type, prescriber_rx_adhoc_12022020.ims_report_number_cnt, prescriber_rx_adhoc_12022020.cnt_file_id, prescriber_rx_adhoc_12022020.cnt_record_id, prescriber_rx_adhoc_12022020.ims_report_number_qty, prescriber_rx_adhoc_12022020.qty_file_id, prescriber_rx_adhoc_12022020.qty_record_id, prescriber_rx_adhoc_12022020.rollup_flag, prescriber_rx_adhoc_12022020.ims_id, prescriber_rx_adhoc_12022020.payer_plan_number, prescriber_rx_adhoc_12022020.ims_product_group, prescriber_rx_adhoc_12022020.ims_specialty, prescriber_rx_adhoc_12022020.ims_zip_other, prescriber_rx_adhoc_12022020.report_frequency, prescriber_rx_adhoc_12022020.ims_supplemental_data, prescriber_rx_adhoc_12022020.indication, prescriber_rx_adhoc_12022020.prescriber_first_name, prescriber_rx_adhoc_12022020.prescriber_last_name) ALL NODES;

CREATE PROJECTION sandbox.pgk_my_sample_closet_b0 /*+basename(pgk_my_sample_closet),createtype(L)*/ 
(
 "IMS ID",
 Decile,
 TVCMID,
 "First Name",
 "Last Name",
 "Middle Name",
 Suffix,
 "Address 1",
 "Address 2",
 "Address 3",
 City,
 State,
 Zip,
 "SLN 1",
 "SLN 1 Expiration Date",
 "SLN 2",
 "SLN 2 State",
 "SLN 2 Expiration Date",
 Specialty,
 "Specialty Description",
 "Specialty Group",
 "IMS ID_1",
 NPI,
 DEA,
 Designation,
 Decile_1,
 "Email Rented?",
 "Dup IMS ID"
)
AS
 SELECT pgk_my_sample_closet."IMS ID",
        pgk_my_sample_closet.Decile,
        pgk_my_sample_closet.TVCMID,
        pgk_my_sample_closet."First Name",
        pgk_my_sample_closet."Last Name",
        pgk_my_sample_closet."Middle Name",
        pgk_my_sample_closet.Suffix,
        pgk_my_sample_closet."Address 1",
        pgk_my_sample_closet."Address 2",
        pgk_my_sample_closet."Address 3",
        pgk_my_sample_closet.City,
        pgk_my_sample_closet.State,
        pgk_my_sample_closet.Zip,
        pgk_my_sample_closet."SLN 1",
        pgk_my_sample_closet."SLN 1 Expiration Date",
        pgk_my_sample_closet."SLN 2",
        pgk_my_sample_closet."SLN 2 State",
        pgk_my_sample_closet."SLN 2 Expiration Date",
        pgk_my_sample_closet.Specialty,
        pgk_my_sample_closet."Specialty Description",
        pgk_my_sample_closet."Specialty Group",
        pgk_my_sample_closet."IMS ID_1",
        pgk_my_sample_closet.NPI,
        pgk_my_sample_closet.DEA,
        pgk_my_sample_closet.Designation,
        pgk_my_sample_closet.Decile_1,
        pgk_my_sample_closet."Email Rented?",
        pgk_my_sample_closet."Dup IMS ID"
 FROM sandbox.pgk_my_sample_closet
 ORDER BY pgk_my_sample_closet."IMS ID",
          pgk_my_sample_closet.Decile,
          pgk_my_sample_closet.TVCMID,
          pgk_my_sample_closet."First Name",
          pgk_my_sample_closet."Last Name",
          pgk_my_sample_closet."Middle Name",
          pgk_my_sample_closet.Suffix,
          pgk_my_sample_closet."Address 1"
SEGMENTED BY hash(pgk_my_sample_closet."IMS ID", pgk_my_sample_closet.Decile, pgk_my_sample_closet.TVCMID, pgk_my_sample_closet.Zip, pgk_my_sample_closet."IMS ID_1", pgk_my_sample_closet.Decile_1, pgk_my_sample_closet."SLN 1", pgk_my_sample_closet."SLN 1 Expiration Date") ALL NODES;

CREATE PROJECTION sandbox.ref_rptng_mrkts_b0 /*+basename(ref_rptng_mrkts),createtype(A)*/ 
(
 basket_id,
 basket_name,
 basket_type,
 status,
 geo_summary_include,
 presc_summary_include,
 market_share_market_id,
 market_share_brand_id,
 rptg_decile_attribute_type,
 rptg_decile_attribute_prod_id,
 rptg_segment_attribute_type,
 rptg_segment_attribute_prod_id
)
AS
 SELECT ref_rptng_mrkts.basket_id,
        ref_rptng_mrkts.basket_name,
        ref_rptng_mrkts.basket_type,
        ref_rptng_mrkts.status,
        ref_rptng_mrkts.geo_summary_include,
        ref_rptng_mrkts.presc_summary_include,
        ref_rptng_mrkts.market_share_market_id,
        ref_rptng_mrkts.market_share_brand_id,
        ref_rptng_mrkts.rptg_decile_attribute_type,
        ref_rptng_mrkts.rptg_decile_attribute_prod_id,
        ref_rptng_mrkts.rptg_segment_attribute_type,
        ref_rptng_mrkts.rptg_segment_attribute_prod_id
 FROM sandbox.ref_rptng_mrkts
 ORDER BY ref_rptng_mrkts.basket_id,
          ref_rptng_mrkts.basket_name,
          ref_rptng_mrkts.basket_type,
          ref_rptng_mrkts.status,
          ref_rptng_mrkts.geo_summary_include,
          ref_rptng_mrkts.presc_summary_include,
          ref_rptng_mrkts.market_share_market_id,
          ref_rptng_mrkts.market_share_brand_id
SEGMENTED BY hash(ref_rptng_mrkts.basket_id, ref_rptng_mrkts.status, ref_rptng_mrkts.geo_summary_include, ref_rptng_mrkts.presc_summary_include, ref_rptng_mrkts.market_share_market_id, ref_rptng_mrkts.market_share_brand_id, ref_rptng_mrkts.rptg_decile_attribute_prod_id, ref_rptng_mrkts.rptg_segment_attribute_prod_id) ALL NODES;

CREATE PROJECTION sandbox.TVCMID_b0 /*+basename(TVCMID),createtype(L)*/ 
(
 tvcmid,
 State
)
AS
 SELECT TVCMID.tvcmid,
        TVCMID.State
 FROM sandbox.TVCMID
 ORDER BY TVCMID.tvcmid,
          TVCMID.State
SEGMENTED BY hash(TVCMID.tvcmid, TVCMID.State) ALL NODES;

CREATE PROJECTION sandbox."SYNEOS TERRs MISSING IMS IDs_b0" /*+basename(SYNEOS TERRs MISSING IMS IDs),createtype(L)*/ 
(
 "SYNEOS TERR",
 "Count of Missing IMS IDs"
)
AS
 SELECT "SYNEOS TERRs MISSING IMS IDs"."SYNEOS TERR",
        "SYNEOS TERRs MISSING IMS IDs"."Count of Missing IMS IDs"
 FROM sandbox."SYNEOS TERRs MISSING IMS IDs"
 ORDER BY "SYNEOS TERRs MISSING IMS IDs"."SYNEOS TERR",
          "SYNEOS TERRs MISSING IMS IDs"."Count of Missing IMS IDs"
SEGMENTED BY hash("SYNEOS TERRs MISSING IMS IDs"."Count of Missing IMS IDs", "SYNEOS TERRs MISSING IMS IDs"."SYNEOS TERR") ALL NODES;

CREATE PROJECTION sandbox.veeva_call_b0 /*+basename(veeva_call),createtype(A)*/ 
(
 id,
 ownerid,
 isdeleted,
 name,
 recordtypeid,
 createddate,
 createdbyid,
 lastmodifieddate,
 lastmodifiedbyid,
 systemmodstamp,
 lastactivitydate,
 mayedit,
 islocked,
 lastvieweddate,
 lastreferenceddate,
 sample_card_vod__c,
 add_detail_vod__c,
 property_vod__c,
 account_vod__c,
 zvod_product_discussion_vod__c,
 status_vod__c,
 parent_address_vod__c,
 account_plan_vod__c,
 zvod_savenew_vod__c,
 next_call_notes_vod__c,
 mobile_id_vod__c,
 zvod_account_credentials_vod_c,
 zvod_account_preferred_name_vo,
 zvod_account_sample_status_vod,
 zvod_attendees_vod__c,
 zvod_key_messages_vod__c,
 zvod_detailing_vod__c,
 zvod_expenses_vod__c,
 zvod_followup_vod__c,
 zvod_samples_vod__c,
 zvod_save_vod__c,
 zvod_submit_vod__c,
 zvod_delete_vod__c,
 activity_type__c,
 significant_event__c,
 location_vod__c,
 subject_vod__c,
 call_datetime_vod__c,
 disbursed_to_vod__c,
 request_receipt_vod__c,
 signature_date_vod__c,
 territory_vod__c,
 submitted_by_mobile_vod__c,
 call_type_vod__c,
 add_key_message_vod__c,
 address_vod__c,
 attendees_vod__c,
 attendee_type_vod__c,
 call_date_vod__c,
 detailed_products_vod__c,
 no_disbursement_vod__c,
 parent_call_vod__c,
 user_vod__c,
 contact_vod__c,
 zvod_entity_vod__c,
 medical_event_vod__c,
 mobile_created_datetime_vod__c,
 mobile_last_modified_datetime,
 license_vod__c,
 is_parent_call_vod__c,
 entity_display_name_vod__c,
 last_device_vod__c,
 ship_address_line_1_vod__c,
 ship_address_line_2_vod__c,
 ship_city_vod__c,
 ship_country_vod__c,
 ship_license_expiration_date,
 ship_license_status_vod__c,
 ship_license_vod__c,
 ship_state_vod__c,
 ship_to_address_vod__c,
 ship_zip_vod__c,
 ship_to_address_text_vod__c,
 clm_vod__c,
 zvod_clmdetails_vod__c,
 is_sampled_call_vod__c,
 zvod_surveys_vod__c,
 presentations_vod__c,
 entity_reference_id_vod__c,
 error_reference_call_vod__c,
 duration_vod__c,
 color_vod__c,
 allowed_products_vod__c,
 zvod_attachments_vod__c,
 sample_card_reason_vod__c,
 assmca_vod__c,
 address_line_1_vod__c,
 address_line_2_vod__c,
 city_vod__c,
 dea_address_line_1_vod__c,
 dea_address_line_2_vod__c,
 dea_address_vod__c,
 dea_city_vod__c,
 dea_expiration_date_vod__c,
 dea_state_vod__c,
 dea_zip_4_vod__c,
 dea_zip_vod__c,
 dea_vod__c,
 ship_zip_4_vod__c,
 state_vod__c,
 zip_4_vod__c,
 zip_vod__c,
 sample_send_card_vod__c,
 zvod_address_vod_c_dea_status_,
 signature_page_image_vod__c,
 credentials_vod__c,
 salutation_vod__c,
 zvod_account_call_reminder_vod,
 sales_org_tva__c,
 zvod_business_account_vod__c,
 product_priority_1_vod__c,
 product_priority_2_vod__c,
 product_priority_3_vod__c,
 product_priority_4_vod__c,
 product_priority_5_vod__c,
 zvod_more_actions_vod__c,
 zvod_call_conflict_status,
 signature_timestamp_vod__c,
 expense_amount_vod__c,
 total_expense_attendees_count,
 attendee_list_vod__c,
 expense_post_status_vod__c,
 attendee_post_status_vod__c,
 expense_system_external_id,
 incurred_expense_vod__c,
 assigner_vod__c,
 assignment_datetime_vod__c,
 zvod_call_objective_vod__c,
 signature_location_longitude,
 signature_location_latitude,
 location_services_status,
 created_by_timezone_tva__c,
 license_expiration_date_vod__c,
 license_status_vod__c,
 ship_assmca_vod__c,
 ship_dea_expiration_date,
 ship_dea_vod__c,
 call_method_tva__c,
 bendeka_indication_tva__c,
 file_id,
 record_id,
 austedo_indication_tva__c,
 call_duration_tva__c,
 how_executed_tva__c,
 Remote_Meeting_vod__c,
 Veeva_Remote_Meeting_Id_vod__c,
 Cobrowse_URL_Participant_vod__c,
 Signature_Captured_Remotely_vod__c,
 Remote_Signature_Attendee_Name_vod__c,
 rowrank
)
AS
 SELECT veeva_call.id,
        veeva_call.ownerid,
        veeva_call.isdeleted,
        veeva_call.name,
        veeva_call.recordtypeid,
        veeva_call.createddate,
        veeva_call.createdbyid,
        veeva_call.lastmodifieddate,
        veeva_call.lastmodifiedbyid,
        veeva_call.systemmodstamp,
        veeva_call.lastactivitydate,
        veeva_call.mayedit,
        veeva_call.islocked,
        veeva_call.lastvieweddate,
        veeva_call.lastreferenceddate,
        veeva_call.sample_card_vod__c,
        veeva_call.add_detail_vod__c,
        veeva_call.property_vod__c,
        veeva_call.account_vod__c,
        veeva_call.zvod_product_discussion_vod__c,
        veeva_call.status_vod__c,
        veeva_call.parent_address_vod__c,
        veeva_call.account_plan_vod__c,
        veeva_call.zvod_savenew_vod__c,
        veeva_call.next_call_notes_vod__c,
        veeva_call.mobile_id_vod__c,
        veeva_call.zvod_account_credentials_vod_c,
        veeva_call.zvod_account_preferred_name_vo,
        veeva_call.zvod_account_sample_status_vod,
        veeva_call.zvod_attendees_vod__c,
        veeva_call.zvod_key_messages_vod__c,
        veeva_call.zvod_detailing_vod__c,
        veeva_call.zvod_expenses_vod__c,
        veeva_call.zvod_followup_vod__c,
        veeva_call.zvod_samples_vod__c,
        veeva_call.zvod_save_vod__c,
        veeva_call.zvod_submit_vod__c,
        veeva_call.zvod_delete_vod__c,
        veeva_call.activity_type__c,
        veeva_call.significant_event__c,
        veeva_call.location_vod__c,
        veeva_call.subject_vod__c,
        veeva_call.call_datetime_vod__c,
        veeva_call.disbursed_to_vod__c,
        veeva_call.request_receipt_vod__c,
        veeva_call.signature_date_vod__c,
        veeva_call.territory_vod__c,
        veeva_call.submitted_by_mobile_vod__c,
        veeva_call.call_type_vod__c,
        veeva_call.add_key_message_vod__c,
        veeva_call.address_vod__c,
        veeva_call.attendees_vod__c,
        veeva_call.attendee_type_vod__c,
        veeva_call.call_date_vod__c,
        veeva_call.detailed_products_vod__c,
        veeva_call.no_disbursement_vod__c,
        veeva_call.parent_call_vod__c,
        veeva_call.user_vod__c,
        veeva_call.contact_vod__c,
        veeva_call.zvod_entity_vod__c,
        veeva_call.medical_event_vod__c,
        veeva_call.mobile_created_datetime_vod__c,
        veeva_call.mobile_last_modified_datetime,
        veeva_call.license_vod__c,
        veeva_call.is_parent_call_vod__c,
        veeva_call.entity_display_name_vod__c,
        veeva_call.last_device_vod__c,
        veeva_call.ship_address_line_1_vod__c,
        veeva_call.ship_address_line_2_vod__c,
        veeva_call.ship_city_vod__c,
        veeva_call.ship_country_vod__c,
        veeva_call.ship_license_expiration_date,
        veeva_call.ship_license_status_vod__c,
        veeva_call.ship_license_vod__c,
        veeva_call.ship_state_vod__c,
        veeva_call.ship_to_address_vod__c,
        veeva_call.ship_zip_vod__c,
        veeva_call.ship_to_address_text_vod__c,
        veeva_call.clm_vod__c,
        veeva_call.zvod_clmdetails_vod__c,
        veeva_call.is_sampled_call_vod__c,
        veeva_call.zvod_surveys_vod__c,
        veeva_call.presentations_vod__c,
        veeva_call.entity_reference_id_vod__c,
        veeva_call.error_reference_call_vod__c,
        veeva_call.duration_vod__c,
        veeva_call.color_vod__c,
        veeva_call.allowed_products_vod__c,
        veeva_call.zvod_attachments_vod__c,
        veeva_call.sample_card_reason_vod__c,
        veeva_call.assmca_vod__c,
        veeva_call.address_line_1_vod__c,
        veeva_call.address_line_2_vod__c,
        veeva_call.city_vod__c,
        veeva_call.dea_address_line_1_vod__c,
        veeva_call.dea_address_line_2_vod__c,
        veeva_call.dea_address_vod__c,
        veeva_call.dea_city_vod__c,
        veeva_call.dea_expiration_date_vod__c,
        veeva_call.dea_state_vod__c,
        veeva_call.dea_zip_4_vod__c,
        veeva_call.dea_zip_vod__c,
        veeva_call.dea_vod__c,
        veeva_call.ship_zip_4_vod__c,
        veeva_call.state_vod__c,
        veeva_call.zip_4_vod__c,
        veeva_call.zip_vod__c,
        veeva_call.sample_send_card_vod__c,
        veeva_call.zvod_address_vod_c_dea_status_,
        veeva_call.signature_page_image_vod__c,
        veeva_call.credentials_vod__c,
        veeva_call.salutation_vod__c,
        veeva_call.zvod_account_call_reminder_vod,
        veeva_call.sales_org_tva__c,
        veeva_call.zvod_business_account_vod__c,
        veeva_call.product_priority_1_vod__c,
        veeva_call.product_priority_2_vod__c,
        veeva_call.product_priority_3_vod__c,
        veeva_call.product_priority_4_vod__c,
        veeva_call.product_priority_5_vod__c,
        veeva_call.zvod_more_actions_vod__c,
        veeva_call.zvod_call_conflict_status,
        veeva_call.signature_timestamp_vod__c,
        veeva_call.expense_amount_vod__c,
        veeva_call.total_expense_attendees_count,
        veeva_call.attendee_list_vod__c,
        veeva_call.expense_post_status_vod__c,
        veeva_call.attendee_post_status_vod__c,
        veeva_call.expense_system_external_id,
        veeva_call.incurred_expense_vod__c,
        veeva_call.assigner_vod__c,
        veeva_call.assignment_datetime_vod__c,
        veeva_call.zvod_call_objective_vod__c,
        veeva_call.signature_location_longitude,
        veeva_call.signature_location_latitude,
        veeva_call.location_services_status,
        veeva_call.created_by_timezone_tva__c,
        veeva_call.license_expiration_date_vod__c,
        veeva_call.license_status_vod__c,
        veeva_call.ship_assmca_vod__c,
        veeva_call.ship_dea_expiration_date,
        veeva_call.ship_dea_vod__c,
        veeva_call.call_method_tva__c,
        veeva_call.bendeka_indication_tva__c,
        veeva_call.file_id,
        veeva_call.record_id,
        veeva_call.austedo_indication_tva__c,
        veeva_call.call_duration_tva__c,
        veeva_call.how_executed_tva__c,
        veeva_call.Remote_Meeting_vod__c,
        veeva_call.Veeva_Remote_Meeting_Id_vod__c,
        veeva_call.Cobrowse_URL_Participant_vod__c,
        veeva_call.Signature_Captured_Remotely_vod__c,
        veeva_call.Remote_Signature_Attendee_Name_vod__c,
        veeva_call.rowrank
 FROM sandbox.veeva_call
 ORDER BY veeva_call.id
SEGMENTED BY hash(veeva_call.id) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_bkp_b0 /*+basename(ic_rx_bkp),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_bkp.ic_data_month,
        ic_rx_bkp.basket_name,
        ic_rx_bkp.sales_force_id,
        ic_rx_bkp.area_number,
        ic_rx_bkp.region_number,
        ic_rx_bkp.territory_number,
        ic_rx_bkp.ims_id,
        ic_rx_bkp.tvcmid,
        ic_rx_bkp.outlet_code,
        ic_rx_bkp.va_station_number,
        ic_rx_bkp.dnc_flag,
        ic_rx_bkp.dnp_flag,
        ic_rx_bkp.rollup_month,
        ic_rx_bkp.month_bucket,
        ic_rx_bkp.nrx_count,
        ic_rx_bkp.trx_count,
        ic_rx_bkp.nrx_quantity,
        ic_rx_bkp.trx_quantity,
        ic_rx_bkp.include_in_nation_rollup,
        ic_rx_bkp.include_in_area_rollup,
        ic_rx_bkp.include_in_region_rollup,
        ic_rx_bkp.join_key,
        ic_rx_bkp.row_source,
        ic_rx_bkp.row_create_date,
        ic_rx_bkp.indication,
        ic_rx_bkp.outlet_dea,
        ic_rx_bkp.payer_plan_number,
        ic_rx_bkp.payment_method
 FROM sandbox.ic_rx_bkp
 ORDER BY ic_rx_bkp.area_number,
          ic_rx_bkp.region_number,
          ic_rx_bkp.territory_number,
          ic_rx_bkp.ims_id,
          ic_rx_bkp.tvcmid
SEGMENTED BY hash(ic_rx_bkp.ic_data_month, ic_rx_bkp.tvcmid, ic_rx_bkp.outlet_code, ic_rx_bkp.dnc_flag, ic_rx_bkp.dnp_flag, ic_rx_bkp.rollup_month, ic_rx_bkp.month_bucket, ic_rx_bkp.nrx_count, ic_rx_bkp.trx_count, ic_rx_bkp.nrx_quantity, ic_rx_bkp.trx_quantity, ic_rx_bkp.include_in_nation_rollup, ic_rx_bkp.include_in_area_rollup, ic_rx_bkp.include_in_region_rollup, ic_rx_bkp.row_create_date, ic_rx_bkp.ims_id, ic_rx_bkp.va_station_number, ic_rx_bkp.join_key, ic_rx_bkp.area_number, ic_rx_bkp.region_number, ic_rx_bkp.territory_number, ic_rx_bkp.sales_force_id, ic_rx_bkp.row_source, ic_rx_bkp.basket_name) ALL NODES;

CREATE PROJECTION sandbox.pay_type_xref_b0 /*+basename(pay_type_xref),createtype(L)*/ 
(
 model,
 pay_type,
 standard_teva_assignments,
 pay_type_index
)
AS
 SELECT pay_type_xref.model,
        pay_type_xref.pay_type,
        pay_type_xref.standard_teva_assignments,
        pay_type_xref.pay_type_index
 FROM sandbox.pay_type_xref
 ORDER BY pay_type_xref.model,
          pay_type_xref.pay_type,
          pay_type_xref.standard_teva_assignments,
          pay_type_xref.pay_type_index
SEGMENTED BY hash(pay_type_xref.pay_type_index, pay_type_xref.model, pay_type_xref.pay_type, pay_type_xref.standard_teva_assignments) ALL NODES;

CREATE PROJECTION sandbox.pay_type_overrides_b0 /*+basename(pay_type_overrides),createtype(L)*/ 
(
 iqvia_payer_name,
 iqvia_plan_name_substr,
 override_model
)
AS
 SELECT pay_type_overrides.iqvia_payer_name,
        pay_type_overrides.iqvia_plan_name_substr,
        pay_type_overrides.override_model
 FROM sandbox.pay_type_overrides
 ORDER BY pay_type_overrides.iqvia_payer_name,
          pay_type_overrides.iqvia_plan_name_substr,
          pay_type_overrides.override_model
SEGMENTED BY hash(pay_type_overrides.override_model, pay_type_overrides.iqvia_payer_name, pay_type_overrides.iqvia_plan_name_substr) ALL NODES;

CREATE PROJECTION sandbox.plantrak_oldview_b0 /*+basename(plantrak_oldview),createtype(L)*/ 
(
 "Payer ID",
 "Payer Name",
 "Plan ID",
 "Payer/Plan ID",
 "Plan Name",
 Model,
 "Payment Method",
 "Xref To",
 "Xref Date",
 City,
 "HQ State",
 "Operating State",
 Months
)
AS
 SELECT plantrak_oldview."Payer ID",
        plantrak_oldview."Payer Name",
        plantrak_oldview."Plan ID",
        plantrak_oldview."Payer/Plan ID",
        plantrak_oldview."Plan Name",
        plantrak_oldview.Model,
        plantrak_oldview."Payment Method",
        plantrak_oldview."Xref To",
        plantrak_oldview."Xref Date",
        plantrak_oldview.City,
        plantrak_oldview."HQ State",
        plantrak_oldview."Operating State",
        plantrak_oldview.Months
 FROM sandbox.plantrak_oldview
 ORDER BY plantrak_oldview."Payer ID",
          plantrak_oldview."Payer Name",
          plantrak_oldview."Plan ID",
          plantrak_oldview."Payer/Plan ID",
          plantrak_oldview."Plan Name",
          plantrak_oldview.Model,
          plantrak_oldview."Payment Method",
          plantrak_oldview."Xref To"
SEGMENTED BY hash(plantrak_oldview."Payer ID", plantrak_oldview."Plan ID", plantrak_oldview."Payer/Plan ID", plantrak_oldview."Payer Name", plantrak_oldview.Model, plantrak_oldview."Payment Method", plantrak_oldview."Xref To", plantrak_oldview."Xref Date") ALL NODES;

CREATE PROJECTION sandbox.rptng_approv_email_05022021_b0 /*+basename(rptng_approv_email_05022021),createtype(A)*/ 
(
 veeva_sent_email_id,
 sent_email_id,
 product,
 date_sent,
 status,
 failure_message,
 veeva_account_id,
 tvcmid,
 veeva_call_id,
 call_id,
 sender_email,
 territory,
 recipient_email,
 click_count,
 open_count,
 last_open_date,
 valid_consent,
 delivered,
 opened,
 dropped,
 clicked,
 downloaded,
 viewed,
 template_id,
 template_name,
 event_msg_vod__c,
 click_url_vod__c,
 subject
)
AS
 SELECT rptng_approv_email_05022021.veeva_sent_email_id,
        rptng_approv_email_05022021.sent_email_id,
        rptng_approv_email_05022021.product,
        rptng_approv_email_05022021.date_sent,
        rptng_approv_email_05022021.status,
        rptng_approv_email_05022021.failure_message,
        rptng_approv_email_05022021.veeva_account_id,
        rptng_approv_email_05022021.tvcmid,
        rptng_approv_email_05022021.veeva_call_id,
        rptng_approv_email_05022021.call_id,
        rptng_approv_email_05022021.sender_email,
        rptng_approv_email_05022021.territory,
        rptng_approv_email_05022021.recipient_email,
        rptng_approv_email_05022021.click_count,
        rptng_approv_email_05022021.open_count,
        rptng_approv_email_05022021.last_open_date,
        rptng_approv_email_05022021.valid_consent,
        rptng_approv_email_05022021.delivered,
        rptng_approv_email_05022021.opened,
        rptng_approv_email_05022021.dropped,
        rptng_approv_email_05022021.clicked,
        rptng_approv_email_05022021.downloaded,
        rptng_approv_email_05022021.viewed,
        rptng_approv_email_05022021.template_id,
        rptng_approv_email_05022021.template_name,
        rptng_approv_email_05022021.event_msg_vod__c,
        rptng_approv_email_05022021.click_url_vod__c,
        rptng_approv_email_05022021.subject
 FROM sandbox.rptng_approv_email_05022021
 ORDER BY rptng_approv_email_05022021.veeva_sent_email_id,
          rptng_approv_email_05022021.sent_email_id,
          rptng_approv_email_05022021.product,
          rptng_approv_email_05022021.date_sent,
          rptng_approv_email_05022021.status,
          rptng_approv_email_05022021.failure_message,
          rptng_approv_email_05022021.veeva_account_id,
          rptng_approv_email_05022021.tvcmid
SEGMENTED BY hash(rptng_approv_email_05022021.veeva_sent_email_id) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_mar2021_b0 /*+basename(ic_rx_mar2021),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_mar2021.ic_data_month,
        ic_rx_mar2021.basket_name,
        ic_rx_mar2021.sales_force_id,
        ic_rx_mar2021.area_number,
        ic_rx_mar2021.region_number,
        ic_rx_mar2021.territory_number,
        ic_rx_mar2021.ims_id,
        ic_rx_mar2021.tvcmid,
        ic_rx_mar2021.outlet_code,
        ic_rx_mar2021.va_station_number,
        ic_rx_mar2021.dnc_flag,
        ic_rx_mar2021.dnp_flag,
        ic_rx_mar2021.rollup_month,
        ic_rx_mar2021.month_bucket,
        ic_rx_mar2021.nrx_count,
        ic_rx_mar2021.trx_count,
        ic_rx_mar2021.nrx_quantity,
        ic_rx_mar2021.trx_quantity,
        ic_rx_mar2021.include_in_nation_rollup,
        ic_rx_mar2021.include_in_area_rollup,
        ic_rx_mar2021.include_in_region_rollup,
        ic_rx_mar2021.join_key,
        ic_rx_mar2021.row_source,
        ic_rx_mar2021.row_create_date,
        ic_rx_mar2021.indication,
        ic_rx_mar2021.outlet_dea,
        ic_rx_mar2021.payer_plan_number,
        ic_rx_mar2021.payment_method
 FROM sandbox.ic_rx_mar2021
 ORDER BY ic_rx_mar2021.ic_data_month,
          ic_rx_mar2021.basket_name,
          ic_rx_mar2021.sales_force_id,
          ic_rx_mar2021.area_number,
          ic_rx_mar2021.region_number,
          ic_rx_mar2021.territory_number,
          ic_rx_mar2021.ims_id,
          ic_rx_mar2021.tvcmid
SEGMENTED BY hash(ic_rx_mar2021.ic_data_month, ic_rx_mar2021.tvcmid, ic_rx_mar2021.outlet_code, ic_rx_mar2021.dnc_flag, ic_rx_mar2021.dnp_flag, ic_rx_mar2021.rollup_month, ic_rx_mar2021.month_bucket, ic_rx_mar2021.nrx_count) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_mar2021_b0 /*+basename(ic_demo_mar2021),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_mar2021.ic_data_month,
        ic_demo_mar2021.sales_force_id,
        ic_demo_mar2021.area_number,
        ic_demo_mar2021.region_number,
        ic_demo_mar2021.territory_number,
        ic_demo_mar2021.ims_id,
        ic_demo_mar2021.tvcmid,
        ic_demo_mar2021.outlet_code,
        ic_demo_mar2021.va_station_number,
        ic_demo_mar2021.specialty,
        ic_demo_mar2021.last_name,
        ic_demo_mar2021.first_name,
        ic_demo_mar2021.mid_name,
        ic_demo_mar2021.address_1,
        ic_demo_mar2021.address_2,
        ic_demo_mar2021.address_3,
        ic_demo_mar2021.city,
        ic_demo_mar2021.state,
        ic_demo_mar2021.zip,
        ic_demo_mar2021.address_source,
        ic_demo_mar2021.pdrp_flag,
        ic_demo_mar2021.pdrp_date,
        ic_demo_mar2021.np_pa_flag,
        ic_demo_mar2021.no_spend,
        ic_demo_mar2021.ama_no_contact_flag,
        ic_demo_mar2021.join_key,
        ic_demo_mar2021.row_source,
        ic_demo_mar2021.row_create_date,
        ic_demo_mar2021.outlet_dea,
        ic_demo_mar2021.secondary_specialty
 FROM sandbox.ic_demo_mar2021
 ORDER BY ic_demo_mar2021.ic_data_month,
          ic_demo_mar2021.sales_force_id,
          ic_demo_mar2021.area_number,
          ic_demo_mar2021.region_number,
          ic_demo_mar2021.territory_number,
          ic_demo_mar2021.ims_id,
          ic_demo_mar2021.tvcmid,
          ic_demo_mar2021.outlet_code
SEGMENTED BY hash(ic_demo_mar2021.ic_data_month, ic_demo_mar2021.tvcmid, ic_demo_mar2021.outlet_code, ic_demo_mar2021.mid_name, ic_demo_mar2021.state, ic_demo_mar2021.zip, ic_demo_mar2021.pdrp_flag, ic_demo_mar2021.pdrp_date) ALL NODES;

CREATE PROJECTION sandbox.fcr_summary_b0 /*+basename(fcr_summary),createtype(A)*/ 
(
 rsm_name,
 rsm_title,
 region_number,
 rsm_email,
 sales_rep_name,
 sales_rep_title,
 territory_number,
 sales_rep_email,
 fcr_date
)
AS
 SELECT fcr_summary.rsm_name,
        fcr_summary.rsm_title,
        fcr_summary.region_number,
        fcr_summary.rsm_email,
        fcr_summary.sales_rep_name,
        fcr_summary.sales_rep_title,
        fcr_summary.territory_number,
        fcr_summary.sales_rep_email,
        fcr_summary.fcr_date
 FROM sandbox.fcr_summary
 ORDER BY fcr_summary.rsm_name,
          fcr_summary.rsm_title,
          fcr_summary.region_number,
          fcr_summary.rsm_email,
          fcr_summary.sales_rep_name,
          fcr_summary.sales_rep_title,
          fcr_summary.territory_number,
          fcr_summary.sales_rep_email
SEGMENTED BY hash(fcr_summary.fcr_date, fcr_summary.region_number, fcr_summary.territory_number, fcr_summary.rsm_title, fcr_summary.sales_rep_title, fcr_summary.rsm_name, fcr_summary.sales_rep_name, fcr_summary.rsm_email) ALL NODES;

CREATE PROJECTION sandbox.payer_test1_b0 /*+basename(payer_test1),createtype(A)*/ 
(
 activity_id,
 federation_id,
 contact,
 source_name,
 "datetime",
 trackback_id,
 previous_activity,
 level_name,
 activity_role_name,
 type_name,
 native_type,
 details,
 line_item_id,
 brand_name,
 activity,
 line_item_datetime,
 line_item_previous_line_item,
 line_item_trackback_id,
 line_item_details,
 line_item_type_name,
 line_item_native_type,
 basket_id,
 web_url
)
AS
 SELECT payer_test1.activity_id,
        payer_test1.federation_id,
        payer_test1.contact,
        payer_test1.source_name,
        payer_test1."datetime",
        payer_test1.trackback_id,
        payer_test1.previous_activity,
        payer_test1.level_name,
        payer_test1.activity_role_name,
        payer_test1.type_name,
        payer_test1.native_type,
        payer_test1.details,
        payer_test1.line_item_id,
        payer_test1.brand_name,
        payer_test1.activity,
        payer_test1.line_item_datetime,
        payer_test1.line_item_previous_line_item,
        payer_test1.line_item_trackback_id,
        payer_test1.line_item_details,
        payer_test1.line_item_type_name,
        payer_test1.line_item_native_type,
        payer_test1.basket_id,
        payer_test1.web_url
 FROM sandbox.payer_test1
 ORDER BY payer_test1.activity_id
SEGMENTED BY hash(payer_test1.activity_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plan_geography_b0 /*+basename(ftf_health_plan_geography),createtype(A)*/ 
(
 health_plan_id,
 operating_state,
 lives_coverage,
 file_id,
 record_id
)
AS
 SELECT ftf_health_plan_geography.health_plan_id,
        ftf_health_plan_geography.operating_state,
        ftf_health_plan_geography.lives_coverage,
        ftf_health_plan_geography.file_id,
        ftf_health_plan_geography.record_id
 FROM sandbox.ftf_health_plan_geography
 ORDER BY ftf_health_plan_geography.health_plan_id,
          ftf_health_plan_geography.operating_state,
          ftf_health_plan_geography.lives_coverage,
          ftf_health_plan_geography.file_id,
          ftf_health_plan_geography.record_id
SEGMENTED BY hash(ftf_health_plan_geography.record_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_b0 /*+basename(ftf_restrictions),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 restriction_detail_id,
 restriction_code,
 formulary_entry_restriction_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 record_id,
 file_id
)
AS
 SELECT ftf_restrictions.health_plan_id,
        ftf_restrictions.drug_id,
        ftf_restrictions.restriction_detail_id,
        ftf_restrictions.restriction_code,
        ftf_restrictions.formulary_entry_restriction_id,
        ftf_restrictions.restriction_detail_text,
        ftf_restrictions.restriction_addtnl_information_1,
        ftf_restrictions.restriction_addtnl_information_2,
        ftf_restrictions.record_id,
        ftf_restrictions.file_id
 FROM sandbox.ftf_restrictions
 ORDER BY ftf_restrictions.health_plan_id,
          ftf_restrictions.drug_id,
          ftf_restrictions.restriction_detail_id,
          ftf_restrictions.restriction_code,
          ftf_restrictions.formulary_entry_restriction_id,
          ftf_restrictions.restriction_detail_text,
          ftf_restrictions.restriction_addtnl_information_1,
          ftf_restrictions.restriction_addtnl_information_2,
          ftf_restrictions.record_id,
          ftf_restrictions.file_id
SEGMENTED BY hash(ftf_restrictions.record_id) ALL NODES;

CREATE PROJECTION sandbox.ims_plan_xref_b0 /*+basename(ims_plan_xref),createtype(A)*/ 
(
 payer_num,
 payer_name,
 plan_num,
 payer_plan_num,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data,
 file_id,
 record_id
)
AS
 SELECT ims_plan_xref.payer_num,
        ims_plan_xref.payer_name,
        ims_plan_xref.plan_num,
        ims_plan_xref.payer_plan_num,
        ims_plan_xref.plan_name,
        ims_plan_xref.model,
        ims_plan_xref.city,
        ims_plan_xref.hq_state,
        ims_plan_xref.operating_state,
        ims_plan_xref.months_with_data,
        ims_plan_xref.file_id,
        ims_plan_xref.record_id
 FROM sandbox.ims_plan_xref
 ORDER BY ims_plan_xref.payer_num,
          ims_plan_xref.payer_name,
          ims_plan_xref.plan_num,
          ims_plan_xref.payer_plan_num,
          ims_plan_xref.plan_name,
          ims_plan_xref.model,
          ims_plan_xref.city,
          ims_plan_xref.hq_state,
          ims_plan_xref.operating_state,
          ims_plan_xref.months_with_data,
          ims_plan_xref.file_id,
          ims_plan_xref.record_id
SEGMENTED BY hash(ims_plan_xref.record_id) ALL NODES;

CREATE PROJECTION sandbox.a_prodgrp1_b0 /*+basename(a_prodgrp1),createtype(L)*/ 
(
 market_name,
 market_id,
 product_desc,
 basket_id,
 prod_group
)
AS
 SELECT a_prodgrp1.market_name,
        a_prodgrp1.market_id,
        a_prodgrp1.product_desc,
        a_prodgrp1.basket_id,
        a_prodgrp1.prod_group
 FROM sandbox.a_prodgrp1
 ORDER BY a_prodgrp1.market_name,
          a_prodgrp1.market_id,
          a_prodgrp1.product_desc,
          a_prodgrp1.basket_id,
          a_prodgrp1.prod_group
SEGMENTED BY hash(a_prodgrp1.market_id, a_prodgrp1.basket_id, a_prodgrp1.prod_group, a_prodgrp1.market_name, a_prodgrp1.product_desc) ALL NODES;

CREATE PROJECTION sandbox.a_jrtest_b0 /*+basename(a_jrtest),createtype(A)*/ 
(
 ims_id,
 prod_group,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 trx
)
AS
 SELECT a_jrtest.ims_id,
        a_jrtest.prod_group,
        a_jrtest.payment_method,
        a_jrtest.pbm_name,
        a_jrtest.payer_name,
        a_jrtest.plan_name,
        a_jrtest.trx
 FROM sandbox.a_jrtest
 ORDER BY a_jrtest.ims_id,
          a_jrtest.prod_group,
          a_jrtest.payment_method,
          a_jrtest.pbm_name,
          a_jrtest.payer_name,
          a_jrtest.plan_name
SEGMENTED BY hash(a_jrtest.ims_id) ALL NODES;

CREATE PROJECTION sandbox.addr_b0 /*+basename(addr),createtype(A)*/ 
(
 tvcmid,
 address_id,
 address_type,
 address_type_name,
 address_line_1,
 address_line_2,
 county,
 city,
 state,
 state_name,
 country_code,
 country_name,
 zip5_postal_code,
 zip4_postal_extension_code,
 address_status,
 address_status_name,
 address_effective_date,
 msa_cbsa,
 fips_state_code,
 fips_state_description,
 fips_county_code,
 fips_county_description,
 deliverability_confidence,
 address_setting_type_code,
 address_setting_type_description,
 address_category_code,
 address_category_description,
 address_latitude,
 address_longitude,
 postal_barcode,
 single_address_indicator,
 practice_location_confidence_indicator,
 practice_location_rank,
 validation_message,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT addr.tvcmid,
        addr.address_id,
        addr.address_type,
        addr.address_type_name,
        addr.address_line_1,
        addr.address_line_2,
        addr.county,
        addr.city,
        addr.state,
        addr.state_name,
        addr.country_code,
        addr.country_name,
        addr.zip5_postal_code,
        addr.zip4_postal_extension_code,
        addr.address_status,
        addr.address_status_name,
        addr.address_effective_date,
        addr.msa_cbsa,
        addr.fips_state_code,
        addr.fips_state_description,
        addr.fips_county_code,
        addr.fips_county_description,
        addr.deliverability_confidence,
        addr.address_setting_type_code,
        addr.address_setting_type_description,
        addr.address_category_code,
        addr.address_category_description,
        addr.address_latitude,
        addr.address_longitude,
        addr.postal_barcode,
        addr.single_address_indicator,
        addr.practice_location_confidence_indicator,
        addr.practice_location_rank,
        addr.validation_message,
        addr.created_by,
        addr.created_date,
        addr.updated_by,
        addr.updated_date,
        addr.file_id,
        addr.record_id
 FROM sandbox.addr
 ORDER BY addr.tvcmid,
          addr.address_id,
          addr.address_type,
          addr.address_type_name,
          addr.address_line_1,
          addr.address_line_2,
          addr.county,
          addr.city,
          addr.state,
          addr.state_name,
          addr.country_code,
          addr.country_name,
          addr.zip5_postal_code,
          addr.zip4_postal_extension_code,
          addr.address_status,
          addr.address_status_name,
          addr.address_effective_date,
          addr.msa_cbsa,
          addr.fips_state_code,
          addr.fips_state_description,
          addr.fips_county_code,
          addr.fips_county_description,
          addr.deliverability_confidence,
          addr.address_setting_type_code,
          addr.address_setting_type_description,
          addr.address_category_code,
          addr.address_category_description,
          addr.address_latitude,
          addr.address_longitude,
          addr.postal_barcode,
          addr.single_address_indicator,
          addr.practice_location_confidence_indicator,
          addr.practice_location_rank,
          addr.validation_message,
          addr.created_by,
          addr.created_date,
          addr.updated_by,
          addr.updated_date,
          addr.record_id
SEGMENTED BY hash(addr.record_id) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plan_preprocessed_b0 /*+basename(iqvia_plan_preprocessed),createtype(A)*/ 
(
 iqvia_payer_id,
 iqvia_payer_name,
 iqvia_plan_id,
 iqvia_plan_code,
 iqvia_plan_name,
 model,
 iqvia_pbm,
 paytype,
 paytype_index,
 cycle_id
)
AS
 SELECT iqvia_plan_preprocessed.iqvia_payer_id,
        iqvia_plan_preprocessed.iqvia_payer_name,
        iqvia_plan_preprocessed.iqvia_plan_id,
        iqvia_plan_preprocessed.iqvia_plan_code,
        iqvia_plan_preprocessed.iqvia_plan_name,
        iqvia_plan_preprocessed.model,
        iqvia_plan_preprocessed.iqvia_pbm,
        iqvia_plan_preprocessed.paytype,
        iqvia_plan_preprocessed.paytype_index,
        iqvia_plan_preprocessed.cycle_id
 FROM sandbox.iqvia_plan_preprocessed
 ORDER BY iqvia_plan_preprocessed.iqvia_payer_name,
          iqvia_plan_preprocessed.iqvia_plan_name
SEGMENTED BY hash(iqvia_plan_preprocessed.paytype) ALL NODES;

CREATE PROJECTION sandbox.iqvia_pbm_preprocessed_b0 /*+basename(iqvia_pbm_preprocessed),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_pbm,
 xref_to,
 iqvia_plan_name,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_pbm_preprocessed.iqvia_plan_code,
        iqvia_pbm_preprocessed.iqvia_pbm,
        iqvia_pbm_preprocessed.xref_to,
        iqvia_pbm_preprocessed.iqvia_plan_name,
        iqvia_pbm_preprocessed.cycle_id,
        iqvia_pbm_preprocessed.modified_time,
        iqvia_pbm_preprocessed.modified_by
 FROM sandbox.iqvia_pbm_preprocessed
 ORDER BY iqvia_pbm_preprocessed.iqvia_plan_code,
          iqvia_pbm_preprocessed.iqvia_pbm,
          iqvia_pbm_preprocessed.xref_to,
          iqvia_pbm_preprocessed.iqvia_plan_name,
          iqvia_pbm_preprocessed.cycle_id,
          iqvia_pbm_preprocessed.modified_time,
          iqvia_pbm_preprocessed.modified_by
SEGMENTED BY hash(iqvia_pbm_preprocessed.cycle_id, iqvia_pbm_preprocessed.modified_time, iqvia_pbm_preprocessed.modified_by, iqvia_pbm_preprocessed.iqvia_plan_code, iqvia_pbm_preprocessed.xref_to, iqvia_pbm_preprocessed.iqvia_pbm, iqvia_pbm_preprocessed.iqvia_plan_name) ALL NODES;

CREATE PROJECTION sandbox.ftf_health_plans_preprocessed_b0 /*+basename(ftf_health_plans_preprocessed),createtype(A)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 parent_id,
 ftf_parent_name,
 ftf_health_plan_type,
 pref_brand_tier,
 plan_lives,
 paytype,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_health_plans_preprocessed.ftf_health_plan_fid,
        ftf_health_plans_preprocessed.ftf_health_plan_name,
        ftf_health_plans_preprocessed.ftf_provider_fid,
        ftf_health_plans_preprocessed.ftf_provider_name,
        ftf_health_plans_preprocessed.parent_id,
        ftf_health_plans_preprocessed.ftf_parent_name,
        ftf_health_plans_preprocessed.ftf_health_plan_type,
        ftf_health_plans_preprocessed.pref_brand_tier,
        ftf_health_plans_preprocessed.plan_lives,
        ftf_health_plans_preprocessed.paytype,
        ftf_health_plans_preprocessed.cycle_id,
        ftf_health_plans_preprocessed.modified_time,
        ftf_health_plans_preprocessed.modified_by
 FROM sandbox.ftf_health_plans_preprocessed
 ORDER BY ftf_health_plans_preprocessed.ftf_health_plan_fid,
          ftf_health_plans_preprocessed.ftf_health_plan_name,
          ftf_health_plans_preprocessed.ftf_provider_fid,
          ftf_health_plans_preprocessed.ftf_provider_name,
          ftf_health_plans_preprocessed.parent_id,
          ftf_health_plans_preprocessed.ftf_parent_name,
          ftf_health_plans_preprocessed.ftf_health_plan_type,
          ftf_health_plans_preprocessed.pref_brand_tier
SEGMENTED BY hash(ftf_health_plans_preprocessed.ftf_health_plan_fid, ftf_health_plans_preprocessed.ftf_provider_fid, ftf_health_plans_preprocessed.parent_id, ftf_health_plans_preprocessed.plan_lives, ftf_health_plans_preprocessed.cycle_id, ftf_health_plans_preprocessed.modified_time, ftf_health_plans_preprocessed.modified_by, ftf_health_plans_preprocessed.pref_brand_tier) ALL NODES;

CREATE PROJECTION sandbox.ftf_formularies_preprocessed_b0 /*+basename(ftf_formularies_preprocessed),createtype(A)*/ 
(
 drug_seq,
 ftf_health_plan_fid,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status,
 check_blank_pharmstat,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formularies_preprocessed.drug_seq,
        ftf_formularies_preprocessed.ftf_health_plan_fid,
        ftf_formularies_preprocessed.drug_id,
        ftf_formularies_preprocessed.tier_code,
        ftf_formularies_preprocessed.restrictions,
        ftf_formularies_preprocessed.reason_code,
        ftf_formularies_preprocessed.reason_code_description,
        ftf_formularies_preprocessed.pharmacy_status,
        ftf_formularies_preprocessed.check_blank_pharmstat,
        ftf_formularies_preprocessed.cycle_id,
        ftf_formularies_preprocessed.modified_time,
        ftf_formularies_preprocessed.modified_by
 FROM sandbox.ftf_formularies_preprocessed
 ORDER BY ftf_formularies_preprocessed.drug_seq,
          ftf_formularies_preprocessed.ftf_health_plan_fid
SEGMENTED BY hash(ftf_formularies_preprocessed.drug_seq, ftf_formularies_preprocessed.ftf_health_plan_fid, ftf_formularies_preprocessed.drug_id, ftf_formularies_preprocessed.tier_code, ftf_formularies_preprocessed.cycle_id, ftf_formularies_preprocessed.modified_time, ftf_formularies_preprocessed.modified_by, ftf_formularies_preprocessed.restrictions) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbms_preprocessed_b0 /*+basename(ftf_pbms_preprocessed),createtype(A)*/ 
(
 ftf_health_plan_fid,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_pbms_preprocessed.ftf_health_plan_fid,
        ftf_pbms_preprocessed.pbm_id,
        ftf_pbms_preprocessed.pbm,
        ftf_pbms_preprocessed.pbm_function_id,
        ftf_pbms_preprocessed.pbm_function,
        ftf_pbms_preprocessed.cycle_id,
        ftf_pbms_preprocessed.modified_time,
        ftf_pbms_preprocessed.modified_by
 FROM sandbox.ftf_pbms_preprocessed
 ORDER BY ftf_pbms_preprocessed.ftf_health_plan_fid,
          ftf_pbms_preprocessed.pbm_id,
          ftf_pbms_preprocessed.pbm,
          ftf_pbms_preprocessed.pbm_function_id,
          ftf_pbms_preprocessed.pbm_function,
          ftf_pbms_preprocessed.cycle_id,
          ftf_pbms_preprocessed.modified_time,
          ftf_pbms_preprocessed.modified_by
SEGMENTED BY hash(ftf_pbms_preprocessed.ftf_health_plan_fid, ftf_pbms_preprocessed.pbm_id, ftf_pbms_preprocessed.pbm_function_id, ftf_pbms_preprocessed.cycle_id, ftf_pbms_preprocessed.modified_time, ftf_pbms_preprocessed.modified_by, ftf_pbms_preprocessed.pbm, ftf_pbms_preprocessed.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_v1_b0 /*+basename(ftf_restrictions_preprocessed_v1),createtype(A)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 grouped_restriction_level,
 drug_seq,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_v1.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_v1.drug_id,
        ftf_restrictions_preprocessed_v1.restriction_code,
        ftf_restrictions_preprocessed_v1.restriction_detail_id,
        ftf_restrictions_preprocessed_v1.restriction_detail_text,
        ftf_restrictions_preprocessed_v1.grouped_restriction_level,
        ftf_restrictions_preprocessed_v1.drug_seq,
        ftf_restrictions_preprocessed_v1.botox,
        ftf_restrictions_preprocessed_v1.step,
        ftf_restrictions_preprocessed_v1.pres_pa,
        ftf_restrictions_preprocessed_v1.pat_pa,
        ftf_restrictions_preprocessed_v1.med_rec,
        ftf_restrictions_preprocessed_v1.unspec,
        ftf_restrictions_preprocessed_v1.cycle_id,
        ftf_restrictions_preprocessed_v1.modified_time,
        ftf_restrictions_preprocessed_v1.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_v1
 ORDER BY ftf_restrictions_preprocessed_v1.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_v1.drug_id,
          ftf_restrictions_preprocessed_v1.restriction_code,
          ftf_restrictions_preprocessed_v1.restriction_detail_id,
          ftf_restrictions_preprocessed_v1.restriction_detail_text,
          ftf_restrictions_preprocessed_v1.grouped_restriction_level,
          ftf_restrictions_preprocessed_v1.drug_seq,
          ftf_restrictions_preprocessed_v1.botox
SEGMENTED BY hash(ftf_restrictions_preprocessed_v1.ftf_health_plan_fid, ftf_restrictions_preprocessed_v1.drug_id, ftf_restrictions_preprocessed_v1.restriction_code, ftf_restrictions_preprocessed_v1.restriction_detail_id, ftf_restrictions_preprocessed_v1.drug_seq, ftf_restrictions_preprocessed_v1.botox, ftf_restrictions_preprocessed_v1.step, ftf_restrictions_preprocessed_v1.pres_pa) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_v2_b0 /*+basename(ftf_restrictions_preprocessed_v2),createtype(A)*/ 
(
 ftf_health_plan_fid,
 drug_id,
 drug_seq,
 MAX,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_v2.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_v2.drug_id,
        ftf_restrictions_preprocessed_v2.drug_seq,
        ftf_restrictions_preprocessed_v2.MAX,
        ftf_restrictions_preprocessed_v2.botox,
        ftf_restrictions_preprocessed_v2.step,
        ftf_restrictions_preprocessed_v2.pres_pa,
        ftf_restrictions_preprocessed_v2.pat_pa,
        ftf_restrictions_preprocessed_v2.med_rec,
        ftf_restrictions_preprocessed_v2.unspec,
        ftf_restrictions_preprocessed_v2.cycle_id,
        ftf_restrictions_preprocessed_v2.modified_time,
        ftf_restrictions_preprocessed_v2.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_v2
 ORDER BY ftf_restrictions_preprocessed_v2.ftf_health_plan_fid,
          ftf_restrictions_preprocessed_v2.drug_id,
          ftf_restrictions_preprocessed_v2.drug_seq
SEGMENTED BY hash(ftf_restrictions_preprocessed_v2.ftf_health_plan_fid, ftf_restrictions_preprocessed_v2.drug_id, ftf_restrictions_preprocessed_v2.drug_seq) ALL NODES;

CREATE PROJECTION sandbox.Ajovy_Dispense_b0 /*+basename(Ajovy_Dispense),createtype(L)*/ 
(
 file_date,
 rx_received_date,
 order_created_date,
 shipping_date,
 prescriber_npi,
 prescriber_full_name,
 prescriber_first_name,
 prescriber_middle_name,
 prescriber_last_name,
 prescriber_address,
 prescriber_city,
 prescriber_state,
 prescriber_zip,
 pharmacy_npi,
 pharmacy_ncpdp_provider_id,
 pharmacy_name,
 pharmacy_address,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 unique_patient_id,
 product_ndc,
 dispense_quantity,
 dispense_number,
 refills_remaining,
 script_type,
 coverage_code,
 primary_payer_name,
 primary_bin_number,
 primary_payment_type,
 primary_benefit_type,
 patient_purchase_price,
 patient_initial_cost,
 patient_benefit,
 payer_cost,
 copay_assistance_applied,
 patient_state
)
AS
 SELECT Ajovy_Dispense.file_date,
        Ajovy_Dispense.rx_received_date,
        Ajovy_Dispense.order_created_date,
        Ajovy_Dispense.shipping_date,
        Ajovy_Dispense.prescriber_npi,
        Ajovy_Dispense.prescriber_full_name,
        Ajovy_Dispense.prescriber_first_name,
        Ajovy_Dispense.prescriber_middle_name,
        Ajovy_Dispense.prescriber_last_name,
        Ajovy_Dispense.prescriber_address,
        Ajovy_Dispense.prescriber_city,
        Ajovy_Dispense.prescriber_state,
        Ajovy_Dispense.prescriber_zip,
        Ajovy_Dispense.pharmacy_npi,
        Ajovy_Dispense.pharmacy_ncpdp_provider_id,
        Ajovy_Dispense.pharmacy_name,
        Ajovy_Dispense.pharmacy_address,
        Ajovy_Dispense.pharmacy_city,
        Ajovy_Dispense.pharmacy_state,
        Ajovy_Dispense.pharmacy_zip,
        Ajovy_Dispense.unique_patient_id,
        Ajovy_Dispense.product_ndc,
        Ajovy_Dispense.dispense_quantity,
        Ajovy_Dispense.dispense_number,
        Ajovy_Dispense.refills_remaining,
        Ajovy_Dispense.script_type,
        Ajovy_Dispense.coverage_code,
        Ajovy_Dispense.primary_payer_name,
        Ajovy_Dispense.primary_bin_number,
        Ajovy_Dispense.primary_payment_type,
        Ajovy_Dispense.primary_benefit_type,
        Ajovy_Dispense.patient_purchase_price,
        Ajovy_Dispense.patient_initial_cost,
        Ajovy_Dispense.patient_benefit,
        Ajovy_Dispense.payer_cost,
        Ajovy_Dispense.copay_assistance_applied,
        Ajovy_Dispense.patient_state
 FROM sandbox.Ajovy_Dispense
 ORDER BY Ajovy_Dispense.file_date,
          Ajovy_Dispense.rx_received_date,
          Ajovy_Dispense.order_created_date,
          Ajovy_Dispense.shipping_date,
          Ajovy_Dispense.prescriber_npi,
          Ajovy_Dispense.prescriber_full_name,
          Ajovy_Dispense.prescriber_first_name,
          Ajovy_Dispense.prescriber_middle_name
SEGMENTED BY hash(Ajovy_Dispense.file_date, Ajovy_Dispense.rx_received_date, Ajovy_Dispense.order_created_date, Ajovy_Dispense.shipping_date, Ajovy_Dispense.pharmacy_ncpdp_provider_id, Ajovy_Dispense.dispense_number, Ajovy_Dispense.refills_remaining, Ajovy_Dispense.primary_bin_number) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_formularies_b0 /*+basename(raw_ftf_formularies),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status
)
AS
 SELECT raw_ftf_formularies.health_plan_id,
        raw_ftf_formularies.drug_id,
        raw_ftf_formularies.tier_code,
        raw_ftf_formularies.restrictions,
        raw_ftf_formularies.reason_code,
        raw_ftf_formularies.reason_code_description,
        raw_ftf_formularies.pharmacy_status
 FROM sandbox.raw_ftf_formularies
 ORDER BY raw_ftf_formularies.health_plan_id,
          raw_ftf_formularies.drug_id,
          raw_ftf_formularies.tier_code,
          raw_ftf_formularies.restrictions,
          raw_ftf_formularies.reason_code,
          raw_ftf_formularies.reason_code_description
SEGMENTED BY hash(raw_ftf_formularies.health_plan_id, raw_ftf_formularies.drug_id, raw_ftf_formularies.tier_code, raw_ftf_formularies.restrictions, raw_ftf_formularies.reason_code, raw_ftf_formularies.reason_code_description) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plans_b0 /*+basename(raw_ftf_health_plans),createtype(A)*/ 
(
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier
)
AS
 SELECT raw_ftf_health_plans.formularyf_id,
        raw_ftf_health_plans.provider_id,
        raw_ftf_health_plans.provider,
        raw_ftf_health_plans.health_plan_id,
        raw_ftf_health_plans.health_plan,
        raw_ftf_health_plans.parent_id,
        raw_ftf_health_plans.parent,
        raw_ftf_health_plans.national_lives_count,
        raw_ftf_health_plans.plan_type_name,
        raw_ftf_health_plans.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans
 ORDER BY raw_ftf_health_plans.formularyf_id,
          raw_ftf_health_plans.provider_id,
          raw_ftf_health_plans.provider,
          raw_ftf_health_plans.health_plan_id,
          raw_ftf_health_plans.health_plan,
          raw_ftf_health_plans.parent_id,
          raw_ftf_health_plans.parent,
          raw_ftf_health_plans.national_lives_count
SEGMENTED BY hash(raw_ftf_health_plans.formularyf_id, raw_ftf_health_plans.provider_id, raw_ftf_health_plans.health_plan_id, raw_ftf_health_plans.parent_id, raw_ftf_health_plans.national_lives_count, raw_ftf_health_plans.preferred_brand_tier, raw_ftf_health_plans.health_plan, raw_ftf_health_plans.provider) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_pbms_b0 /*+basename(raw_ftf_pbms),createtype(A)*/ 
(
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function
)
AS
 SELECT raw_ftf_pbms.health_plan_id,
        raw_ftf_pbms.pbm_id,
        raw_ftf_pbms.pbm,
        raw_ftf_pbms.pbm_function_id,
        raw_ftf_pbms.pbm_function
 FROM sandbox.raw_ftf_pbms
 ORDER BY raw_ftf_pbms.health_plan_id,
          raw_ftf_pbms.pbm_id,
          raw_ftf_pbms.pbm,
          raw_ftf_pbms.pbm_function_id,
          raw_ftf_pbms.pbm_function
SEGMENTED BY hash(raw_ftf_pbms.health_plan_id, raw_ftf_pbms.pbm_id, raw_ftf_pbms.pbm_function_id, raw_ftf_pbms.pbm, raw_ftf_pbms.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_plan_b0 /*+basename(raw_iqvia_plan),createtype(A)*/ 
(
 payer_num,
 payer_name,
 plan_num,
 payer_plan_num,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data
)
AS
 SELECT raw_iqvia_plan.payer_num,
        raw_iqvia_plan.payer_name,
        raw_iqvia_plan.plan_num,
        raw_iqvia_plan.payer_plan_num,
        raw_iqvia_plan.plan_name,
        raw_iqvia_plan.model,
        raw_iqvia_plan.city,
        raw_iqvia_plan.hq_state,
        raw_iqvia_plan.operating_state,
        raw_iqvia_plan.months_with_data
 FROM sandbox.raw_iqvia_plan
 ORDER BY raw_iqvia_plan.payer_num,
          raw_iqvia_plan.payer_name,
          raw_iqvia_plan.plan_num,
          raw_iqvia_plan.payer_plan_num,
          raw_iqvia_plan.plan_name,
          raw_iqvia_plan.model,
          raw_iqvia_plan.city,
          raw_iqvia_plan.hq_state
SEGMENTED BY hash(raw_iqvia_plan.payer_num, raw_iqvia_plan.plan_num, raw_iqvia_plan.hq_state, raw_iqvia_plan.operating_state, raw_iqvia_plan.months_with_data, raw_iqvia_plan.payer_plan_num, raw_iqvia_plan.model, raw_iqvia_plan.city) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_pbm_b0 /*+basename(raw_iqvia_pbm),createtype(A)*/ 
(
 pbm_name,
 payer_plan_num,
 xref_to_payer_plan_num,
 ipd_id,
 ipd_type,
 plan_name,
 pbm_num,
 ims_processor_num
)
AS
 SELECT raw_iqvia_pbm.pbm_name,
        raw_iqvia_pbm.payer_plan_num,
        raw_iqvia_pbm.xref_to_payer_plan_num,
        raw_iqvia_pbm.ipd_id,
        raw_iqvia_pbm.ipd_type,
        raw_iqvia_pbm.plan_name,
        raw_iqvia_pbm.pbm_num,
        raw_iqvia_pbm.ims_processor_num
 FROM sandbox.raw_iqvia_pbm
 ORDER BY raw_iqvia_pbm.pbm_name,
          raw_iqvia_pbm.payer_plan_num,
          raw_iqvia_pbm.xref_to_payer_plan_num,
          raw_iqvia_pbm.ipd_id,
          raw_iqvia_pbm.ipd_type,
          raw_iqvia_pbm.plan_name,
          raw_iqvia_pbm.pbm_num,
          raw_iqvia_pbm.ims_processor_num
SEGMENTED BY hash(raw_iqvia_pbm.pbm_num, raw_iqvia_pbm.payer_plan_num, raw_iqvia_pbm.xref_to_payer_plan_num, raw_iqvia_pbm.ipd_id, raw_iqvia_pbm.ipd_type, raw_iqvia_pbm.ims_processor_num, raw_iqvia_pbm.pbm_name, raw_iqvia_pbm.plan_name) ALL NODES;

CREATE PROJECTION sandbox.raw_teva_ims_bridge_b0 /*+basename(raw_teva_ims_bridge),createtype(L)*/ 
(
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name
)
AS
 SELECT raw_teva_ims_bridge.payer_name,
        raw_teva_ims_bridge.code,
        raw_teva_ims_bridge.name,
        raw_teva_ims_bridge.state,
        raw_teva_ims_bridge.comments,
        raw_teva_ims_bridge.plan_id,
        raw_teva_ims_bridge.plan_name,
        raw_teva_ims_bridge.provider_name,
        raw_teva_ims_bridge.plan_type_name
 FROM sandbox.raw_teva_ims_bridge
 ORDER BY raw_teva_ims_bridge.payer_name,
          raw_teva_ims_bridge.code,
          raw_teva_ims_bridge.name,
          raw_teva_ims_bridge.state,
          raw_teva_ims_bridge.comments,
          raw_teva_ims_bridge.plan_id,
          raw_teva_ims_bridge.plan_name,
          raw_teva_ims_bridge.provider_name
SEGMENTED BY hash(raw_teva_ims_bridge.state, raw_teva_ims_bridge.code, raw_teva_ims_bridge.plan_id, raw_teva_ims_bridge.plan_type_name, raw_teva_ims_bridge.payer_name, raw_teva_ims_bridge.name, raw_teva_ims_bridge.comments, raw_teva_ims_bridge.plan_name) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_restrictions_b0 /*+basename(raw_ftf_restrictions),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level
)
AS
 SELECT raw_ftf_restrictions.health_plan_id,
        raw_ftf_restrictions.drug_id,
        raw_ftf_restrictions.restriction_code,
        raw_ftf_restrictions.restriction_detail_id,
        raw_ftf_restrictions.restriction_detail_text,
        raw_ftf_restrictions.restriction_addtnl_information_1,
        raw_ftf_restrictions.restriction_addtnl_information_2,
        raw_ftf_restrictions.step_count,
        raw_ftf_restrictions.pa_form,
        raw_ftf_restrictions.indication,
        raw_ftf_restrictions.grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions
 ORDER BY raw_ftf_restrictions.health_plan_id,
          raw_ftf_restrictions.drug_id,
          raw_ftf_restrictions.restriction_code,
          raw_ftf_restrictions.restriction_detail_id,
          raw_ftf_restrictions.restriction_detail_text,
          raw_ftf_restrictions.restriction_addtnl_information_1,
          raw_ftf_restrictions.restriction_addtnl_information_2,
          raw_ftf_restrictions.step_count
SEGMENTED BY hash(raw_ftf_restrictions.health_plan_id, raw_ftf_restrictions.drug_id, raw_ftf_restrictions.restriction_code, raw_ftf_restrictions.restriction_detail_id, raw_ftf_restrictions.step_count, raw_ftf_restrictions.indication, raw_ftf_restrictions.grouped_restriction_level, raw_ftf_restrictions.restriction_detail_text) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plan_geography_b0 /*+basename(raw_ftf_health_plan_geography),createtype(L)*/ 
(
 health_plan_id,
 county_fips_id,
 county_id,
 county_name,
 state_id,
 state_name,
 county_lives
)
AS
 SELECT raw_ftf_health_plan_geography.health_plan_id,
        raw_ftf_health_plan_geography.county_fips_id,
        raw_ftf_health_plan_geography.county_id,
        raw_ftf_health_plan_geography.county_name,
        raw_ftf_health_plan_geography.state_id,
        raw_ftf_health_plan_geography.state_name,
        raw_ftf_health_plan_geography.county_lives
 FROM sandbox.raw_ftf_health_plan_geography
 ORDER BY raw_ftf_health_plan_geography.health_plan_id,
          raw_ftf_health_plan_geography.county_fips_id,
          raw_ftf_health_plan_geography.county_id,
          raw_ftf_health_plan_geography.county_name,
          raw_ftf_health_plan_geography.state_id,
          raw_ftf_health_plan_geography.state_name,
          raw_ftf_health_plan_geography.county_lives
SEGMENTED BY hash(raw_ftf_health_plan_geography.health_plan_id, raw_ftf_health_plan_geography.county_fips_id, raw_ftf_health_plan_geography.county_id, raw_ftf_health_plan_geography.state_id, raw_ftf_health_plan_geography.county_lives, raw_ftf_health_plan_geography.state_name, raw_ftf_health_plan_geography.county_name) ALL NODES;

CREATE PROJECTION sandbox.suggestions_targets_b0 /*+basename(suggestions_targets),createtype(A)*/ 
(
 veeva_account_id,
 territory_number,
 product
)
AS
 SELECT suggestions_targets.veeva_account_id,
        suggestions_targets.territory_number,
        suggestions_targets.product
 FROM sandbox.suggestions_targets
 ORDER BY suggestions_targets.veeva_account_id,
          suggestions_targets.territory_number,
          suggestions_targets.product
SEGMENTED BY hash(suggestions_targets.veeva_account_id, suggestions_targets.territory_number, suggestions_targets.product) ALL NODES;

CREATE PROJECTION sandbox.ddd_exc_or_b0 /*+basename(ddd_exc_or),createtype(L)*/ 
(
 outlet_code,
 outlet_name,
 sub_cat
)
AS
 SELECT ddd_exc_or.outlet_code,
        ddd_exc_or.outlet_name,
        ddd_exc_or.sub_cat
 FROM sandbox.ddd_exc_or
 ORDER BY ddd_exc_or.outlet_code,
          ddd_exc_or.outlet_name,
          ddd_exc_or.sub_cat
SEGMENTED BY hash(ddd_exc_or.outlet_code, ddd_exc_or.outlet_name, ddd_exc_or.sub_cat) ALL NODES;

CREATE PROJECTION sandbox.access_monitor_s121_b0 /*+basename(access_monitor_s121),createtype(L)*/ 
(
 client_id,
 client_physician_id,
 me_number,
 npi,
 valid_menum_flag,
 valid_npi_flag,
 am_no_see_rating,
 teams_no_see_rating,
 annual_call_freq_perc_25,
 annual_call_freq_perc_50,
 annual_call_freq_perc_75,
 teams_call_freq,
 industry_attainment,
 teams_attainment,
 attn_perc_25,
 attn_perc_50,
 attn_perc_75,
 teams_attn_perc,
 am_specialty_grouping,
 teams_spec,
 am_zip,
 teams_zip,
 reach_type,
 annual_f2f_call_freq_perc_25,
 annual_f2f_call_freq_perc_50,
 annual_f2f_call_freq_perc_75,
 teams_call_freq_f2f,
 annual_remote_call_freq_perc_25,
 annual_remote_call_freq_perc_50,
 annual_remote_call_freq_perc_75,
 teams_call_freq_remote
)
AS
 SELECT access_monitor_s121.client_id,
        access_monitor_s121.client_physician_id,
        access_monitor_s121.me_number,
        access_monitor_s121.npi,
        access_monitor_s121.valid_menum_flag,
        access_monitor_s121.valid_npi_flag,
        access_monitor_s121.am_no_see_rating,
        access_monitor_s121.teams_no_see_rating,
        access_monitor_s121.annual_call_freq_perc_25,
        access_monitor_s121.annual_call_freq_perc_50,
        access_monitor_s121.annual_call_freq_perc_75,
        access_monitor_s121.teams_call_freq,
        access_monitor_s121.industry_attainment,
        access_monitor_s121.teams_attainment,
        access_monitor_s121.attn_perc_25,
        access_monitor_s121.attn_perc_50,
        access_monitor_s121.attn_perc_75,
        access_monitor_s121.teams_attn_perc,
        access_monitor_s121.am_specialty_grouping,
        access_monitor_s121.teams_spec,
        access_monitor_s121.am_zip,
        access_monitor_s121.teams_zip,
        access_monitor_s121.reach_type,
        access_monitor_s121.annual_f2f_call_freq_perc_25,
        access_monitor_s121.annual_f2f_call_freq_perc_50,
        access_monitor_s121.annual_f2f_call_freq_perc_75,
        access_monitor_s121.teams_call_freq_f2f,
        access_monitor_s121.annual_remote_call_freq_perc_25,
        access_monitor_s121.annual_remote_call_freq_perc_50,
        access_monitor_s121.annual_remote_call_freq_perc_75,
        access_monitor_s121.teams_call_freq_remote
 FROM sandbox.access_monitor_s121
 ORDER BY access_monitor_s121.client_id,
          access_monitor_s121.client_physician_id,
          access_monitor_s121.me_number,
          access_monitor_s121.npi,
          access_monitor_s121.valid_menum_flag,
          access_monitor_s121.valid_npi_flag,
          access_monitor_s121.am_no_see_rating,
          access_monitor_s121.teams_no_see_rating
SEGMENTED BY hash(access_monitor_s121.client_id, access_monitor_s121.valid_menum_flag, access_monitor_s121.valid_npi_flag, access_monitor_s121.am_no_see_rating, access_monitor_s121.annual_call_freq_perc_25, access_monitor_s121.annual_call_freq_perc_50, access_monitor_s121.annual_call_freq_perc_75, access_monitor_s121.industry_attainment) ALL NODES;

CREATE PROJECTION sandbox.afm_cycle1_teva_hcp_report_b0 /*+basename(afm_cycle1_teva_hcp_report),createtype(L)*/ 
(
 npi,
 zs_spec_desc_md,
 specialty_name,
 specialty_group,
 pff_ctt_vol,
 pff_en,
 pff_en_quintile,
 pff_affinity,
 pr_ctt_vol,
 pr_en,
 pr_en_quintile,
 pr_affinity,
 pi_ctt_vol,
 pi_en,
 pi_en_quintile,
 pi_affinity,
 dph_ctt_vol,
 dph_en,
 dph_en_quintile,
 dph_affinity,
 dpl_ctt_vol,
 dpl_en,
 dpl_en_quintile,
 dpl_affinity,
 drt_ctt_vol,
 drt_en,
 drt_en_quintile,
 drt_affinity,
 top_channels,
 pp_access_rating,
 npp_access_rating,
 peer_offer_en,
 copay_offer_en,
 sample_offer_en,
 voucher_offer_en
)
AS
 SELECT afm_cycle1_teva_hcp_report.npi,
        afm_cycle1_teva_hcp_report.zs_spec_desc_md,
        afm_cycle1_teva_hcp_report.specialty_name,
        afm_cycle1_teva_hcp_report.specialty_group,
        afm_cycle1_teva_hcp_report.pff_ctt_vol,
        afm_cycle1_teva_hcp_report.pff_en,
        afm_cycle1_teva_hcp_report.pff_en_quintile,
        afm_cycle1_teva_hcp_report.pff_affinity,
        afm_cycle1_teva_hcp_report.pr_ctt_vol,
        afm_cycle1_teva_hcp_report.pr_en,
        afm_cycle1_teva_hcp_report.pr_en_quintile,
        afm_cycle1_teva_hcp_report.pr_affinity,
        afm_cycle1_teva_hcp_report.pi_ctt_vol,
        afm_cycle1_teva_hcp_report.pi_en,
        afm_cycle1_teva_hcp_report.pi_en_quintile,
        afm_cycle1_teva_hcp_report.pi_affinity,
        afm_cycle1_teva_hcp_report.dph_ctt_vol,
        afm_cycle1_teva_hcp_report.dph_en,
        afm_cycle1_teva_hcp_report.dph_en_quintile,
        afm_cycle1_teva_hcp_report.dph_affinity,
        afm_cycle1_teva_hcp_report.dpl_ctt_vol,
        afm_cycle1_teva_hcp_report.dpl_en,
        afm_cycle1_teva_hcp_report.dpl_en_quintile,
        afm_cycle1_teva_hcp_report.dpl_affinity,
        afm_cycle1_teva_hcp_report.drt_ctt_vol,
        afm_cycle1_teva_hcp_report.drt_en,
        afm_cycle1_teva_hcp_report.drt_en_quintile,
        afm_cycle1_teva_hcp_report.drt_affinity,
        afm_cycle1_teva_hcp_report.top_channels,
        afm_cycle1_teva_hcp_report.pp_access_rating,
        afm_cycle1_teva_hcp_report.npp_access_rating,
        afm_cycle1_teva_hcp_report.peer_offer_en,
        afm_cycle1_teva_hcp_report.copay_offer_en,
        afm_cycle1_teva_hcp_report.sample_offer_en,
        afm_cycle1_teva_hcp_report.voucher_offer_en
 FROM sandbox.afm_cycle1_teva_hcp_report
 ORDER BY afm_cycle1_teva_hcp_report.npi,
          afm_cycle1_teva_hcp_report.zs_spec_desc_md,
          afm_cycle1_teva_hcp_report.specialty_name,
          afm_cycle1_teva_hcp_report.specialty_group,
          afm_cycle1_teva_hcp_report.pff_ctt_vol,
          afm_cycle1_teva_hcp_report.pff_en,
          afm_cycle1_teva_hcp_report.pff_en_quintile,
          afm_cycle1_teva_hcp_report.pff_affinity
SEGMENTED BY hash(afm_cycle1_teva_hcp_report.npi, afm_cycle1_teva_hcp_report.pff_en, afm_cycle1_teva_hcp_report.pr_en, afm_cycle1_teva_hcp_report.pi_en, afm_cycle1_teva_hcp_report.dph_en, afm_cycle1_teva_hcp_report.dpl_en, afm_cycle1_teva_hcp_report.drt_en, afm_cycle1_teva_hcp_report.pff_ctt_vol) ALL NODES;

CREATE PROJECTION sandbox.drug_assignments_b0 /*+basename(drug_assignments),createtype(L)*/ 
(
 drug_id,
 drug_seq,
 product,
 file_id,
 record_id
)
AS
 SELECT drug_assignments.drug_id,
        drug_assignments.drug_seq,
        drug_assignments.product,
        drug_assignments.file_id,
        drug_assignments.record_id
 FROM sandbox.drug_assignments
 ORDER BY drug_assignments.drug_id,
          drug_assignments.drug_seq,
          drug_assignments.product,
          drug_assignments.file_id,
          drug_assignments.record_id
SEGMENTED BY hash(drug_assignments.drug_id, drug_assignments.drug_seq, drug_assignments.file_id, drug_assignments.record_id, drug_assignments.product) ALL NODES;

CREATE PROJECTION sandbox.sample_table_b0 /*+basename(sample_table),createtype(L)*/ 
(
 a
)
AS
 SELECT sample_table.a
 FROM sandbox.sample_table
 ORDER BY sample_table.a
SEGMENTED BY hash(sample_table.a) ALL NODES;

CREATE PROJECTION sandbox.a_prodgrp_a_b0 /*+basename(a_prodgrp_a),createtype(L)*/ 
(
 mkt_name,
 mkt_id,
 mkt_rpt_flag,
 bfs_name,
 bfs_id,
 brand,
 teva_prod,
 mkt_basket,
 prod_grp
)
AS
 SELECT a_prodgrp_a.mkt_name,
        a_prodgrp_a.mkt_id,
        a_prodgrp_a.mkt_rpt_flag,
        a_prodgrp_a.bfs_name,
        a_prodgrp_a.bfs_id,
        a_prodgrp_a.brand,
        a_prodgrp_a.teva_prod,
        a_prodgrp_a.mkt_basket,
        a_prodgrp_a.prod_grp
 FROM sandbox.a_prodgrp_a
 ORDER BY a_prodgrp_a.mkt_name,
          a_prodgrp_a.mkt_id,
          a_prodgrp_a.mkt_rpt_flag,
          a_prodgrp_a.bfs_name,
          a_prodgrp_a.bfs_id,
          a_prodgrp_a.brand,
          a_prodgrp_a.teva_prod,
          a_prodgrp_a.mkt_basket
SEGMENTED BY hash(a_prodgrp_a.mkt_id, a_prodgrp_a.mkt_rpt_flag, a_prodgrp_a.bfs_id, a_prodgrp_a.teva_prod, a_prodgrp_a.mkt_basket, a_prodgrp_a.brand, a_prodgrp_a.prod_grp, a_prodgrp_a.mkt_name) ALL NODES;

CREATE PROJECTION sandbox.a_prodgrp_b0 /*+basename(a_prodgrp),createtype(L)*/ 
(
 mkt_name,
 mkt_id,
 mkt_rpt_flag,
 bfs_name,
 bfs_id,
 brand,
 teva_prod,
 mkt_basket,
 prod_grp
)
AS
 SELECT a_prodgrp.mkt_name,
        a_prodgrp.mkt_id,
        a_prodgrp.mkt_rpt_flag,
        a_prodgrp.bfs_name,
        a_prodgrp.bfs_id,
        a_prodgrp.brand,
        a_prodgrp.teva_prod,
        a_prodgrp.mkt_basket,
        a_prodgrp.prod_grp
 FROM sandbox.a_prodgrp
 ORDER BY a_prodgrp.mkt_name,
          a_prodgrp.mkt_id,
          a_prodgrp.mkt_rpt_flag,
          a_prodgrp.bfs_name,
          a_prodgrp.bfs_id,
          a_prodgrp.brand,
          a_prodgrp.teva_prod,
          a_prodgrp.mkt_basket
SEGMENTED BY hash(a_prodgrp.mkt_id, a_prodgrp.mkt_rpt_flag, a_prodgrp.bfs_id, a_prodgrp.teva_prod, a_prodgrp.mkt_basket, a_prodgrp.brand, a_prodgrp.prod_grp, a_prodgrp.mkt_name) ALL NODES;

CREATE PROJECTION sandbox.a_roster_denorm_b0 /*+basename(a_roster_denorm),createtype(L)*/ 
(
 sales_force_id,
 terr,
 terr_name,
 reg,
 reg_name,
 area,
 area_name,
 nation,
 nation_name
)
AS
 SELECT a_roster_denorm.sales_force_id,
        a_roster_denorm.terr,
        a_roster_denorm.terr_name,
        a_roster_denorm.reg,
        a_roster_denorm.reg_name,
        a_roster_denorm.area,
        a_roster_denorm.area_name,
        a_roster_denorm.nation,
        a_roster_denorm.nation_name
 FROM sandbox.a_roster_denorm
 ORDER BY a_roster_denorm.sales_force_id,
          a_roster_denorm.terr,
          a_roster_denorm.terr_name,
          a_roster_denorm.reg,
          a_roster_denorm.reg_name,
          a_roster_denorm.area,
          a_roster_denorm.area_name,
          a_roster_denorm.nation
SEGMENTED BY hash(a_roster_denorm.sales_force_id, a_roster_denorm.terr, a_roster_denorm.reg, a_roster_denorm.area, a_roster_denorm.nation, a_roster_denorm.nation_name, a_roster_denorm.terr_name, a_roster_denorm.reg_name) ALL NODES;

CREATE PROJECTION sandbox.a_roster_norm_b0 /*+basename(a_roster_norm),createtype(L)*/ 
(
 sales_force_id,
 sorg_lvl,
 sorg,
 sorg_name,
 terr,
 terr_name,
 reg,
 reg_name,
 area,
 area_name,
 nation,
 nation_name
)
AS
 SELECT a_roster_norm.sales_force_id,
        a_roster_norm.sorg_lvl,
        a_roster_norm.sorg,
        a_roster_norm.sorg_name,
        a_roster_norm.terr,
        a_roster_norm.terr_name,
        a_roster_norm.reg,
        a_roster_norm.reg_name,
        a_roster_norm.area,
        a_roster_norm.area_name,
        a_roster_norm.nation,
        a_roster_norm.nation_name
 FROM sandbox.a_roster_norm
 ORDER BY a_roster_norm.sales_force_id,
          a_roster_norm.sorg_lvl,
          a_roster_norm.sorg,
          a_roster_norm.sorg_name,
          a_roster_norm.terr,
          a_roster_norm.terr_name,
          a_roster_norm.reg,
          a_roster_norm.reg_name
SEGMENTED BY hash(a_roster_norm.sales_force_id, a_roster_norm.sorg_lvl, a_roster_norm.sorg, a_roster_norm.terr, a_roster_norm.reg, a_roster_norm.area, a_roster_norm.nation, a_roster_norm.nation_name) ALL NODES;

CREATE PROJECTION sandbox.a_payer_Migrane_Market_b0 /*+basename(a_payer_Migrane_Market),createtype(A)*/ 
(
 ims_id,
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkt_id,
 prod_grp,
 teva_prod,
 SubGroup,
 trx_c1,
 trx_p1,
 trx_c3,
 trx_p3
)
AS
 SELECT a_payer_Migrane_Market.ims_id,
        a_payer_Migrane_Market.sorg_lvl,
        a_payer_Migrane_Market.sorg,
        a_payer_Migrane_Market.payment_method,
        a_payer_Migrane_Market.pbm_name,
        a_payer_Migrane_Market.payer_name,
        a_payer_Migrane_Market.plan_name,
        a_payer_Migrane_Market.mkt_id,
        a_payer_Migrane_Market.prod_grp,
        a_payer_Migrane_Market.teva_prod,
        a_payer_Migrane_Market.SubGroup,
        a_payer_Migrane_Market.trx_c1,
        a_payer_Migrane_Market.trx_p1,
        a_payer_Migrane_Market.trx_c3,
        a_payer_Migrane_Market.trx_p3
 FROM sandbox.a_payer_Migrane_Market
 ORDER BY a_payer_Migrane_Market.ims_id,
          a_payer_Migrane_Market.sorg_lvl,
          a_payer_Migrane_Market.sorg,
          a_payer_Migrane_Market.payment_method,
          a_payer_Migrane_Market.pbm_name,
          a_payer_Migrane_Market.payer_name,
          a_payer_Migrane_Market.plan_name,
          a_payer_Migrane_Market.mkt_id,
          a_payer_Migrane_Market.prod_grp,
          a_payer_Migrane_Market.teva_prod,
          a_payer_Migrane_Market.SubGroup
SEGMENTED BY hash(a_payer_Migrane_Market.ims_id) ALL NODES;

CREATE PROJECTION sandbox.a_align_payer_rollup_b0 /*+basename(a_align_payer_rollup),createtype(A)*/ 
(
 ims_id,
 sorg_lvl,
 sorg
)
AS
 SELECT a_align_payer_rollup.ims_id,
        a_align_payer_rollup.sorg_lvl,
        a_align_payer_rollup.sorg
 FROM sandbox.a_align_payer_rollup
 ORDER BY a_align_payer_rollup.ims_id,
          a_align_payer_rollup.sorg_lvl,
          a_align_payer_rollup.sorg
SEGMENTED BY hash(a_align_payer_rollup.ims_id, a_align_payer_rollup.sorg_lvl, a_align_payer_rollup.sorg) ALL NODES;

CREATE PROJECTION sandbox.a_payer_rollup_temp_b0 /*+basename(a_payer_rollup_temp),createtype(A)*/ 
(
 ims_id,
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkt_id,
 prod_grp,
 teva_prod,
 SubGroup,
 trx_c1,
 trx_p1,
 trx_c3,
 trx_p3
)
AS
 SELECT a_payer_rollup_temp.ims_id,
        a_payer_rollup_temp.sorg_lvl,
        a_payer_rollup_temp.sorg,
        a_payer_rollup_temp.payment_method,
        a_payer_rollup_temp.pbm_name,
        a_payer_rollup_temp.payer_name,
        a_payer_rollup_temp.plan_name,
        a_payer_rollup_temp.mkt_id,
        a_payer_rollup_temp.prod_grp,
        a_payer_rollup_temp.teva_prod,
        a_payer_rollup_temp.SubGroup,
        a_payer_rollup_temp.trx_c1,
        a_payer_rollup_temp.trx_p1,
        a_payer_rollup_temp.trx_c3,
        a_payer_rollup_temp.trx_p3
 FROM sandbox.a_payer_rollup_temp
 ORDER BY a_payer_rollup_temp.ims_id,
          a_payer_rollup_temp.sorg_lvl,
          a_payer_rollup_temp.sorg,
          a_payer_rollup_temp.payment_method,
          a_payer_rollup_temp.pbm_name,
          a_payer_rollup_temp.payer_name,
          a_payer_rollup_temp.plan_name,
          a_payer_rollup_temp.mkt_id,
          a_payer_rollup_temp.prod_grp,
          a_payer_rollup_temp.teva_prod,
          a_payer_rollup_temp.SubGroup
SEGMENTED BY hash(a_payer_rollup_temp.ims_id, a_payer_rollup_temp.sorg_lvl, a_payer_rollup_temp.sorg, a_payer_rollup_temp.payment_method, a_payer_rollup_temp.pbm_name, a_payer_rollup_temp.payer_name, a_payer_rollup_temp.plan_name) ALL NODES;

CREATE PROJECTION sandbox.a_payer_rollup_b0 /*+basename(a_payer_rollup),createtype(A)*/ 
(
 ims_id,
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkt_id,
 prod_grp,
 teva_prod,
 SubGroup,
 trx_c1,
 trx_p1,
 trx_c3,
 trx_p3
)
AS
 SELECT a_payer_rollup.ims_id,
        a_payer_rollup.sorg_lvl,
        a_payer_rollup.sorg,
        a_payer_rollup.payment_method,
        a_payer_rollup.pbm_name,
        a_payer_rollup.payer_name,
        a_payer_rollup.plan_name,
        a_payer_rollup.mkt_id,
        a_payer_rollup.prod_grp,
        a_payer_rollup.teva_prod,
        a_payer_rollup.SubGroup,
        a_payer_rollup.trx_c1,
        a_payer_rollup.trx_p1,
        a_payer_rollup.trx_c3,
        a_payer_rollup.trx_p3
 FROM sandbox.a_payer_rollup
 ORDER BY a_payer_rollup.ims_id,
          a_payer_rollup.sorg_lvl,
          a_payer_rollup.sorg,
          a_payer_rollup.payment_method,
          a_payer_rollup.pbm_name,
          a_payer_rollup.payer_name,
          a_payer_rollup.plan_name,
          a_payer_rollup.mkt_id,
          a_payer_rollup.prod_grp,
          a_payer_rollup.teva_prod,
          a_payer_rollup.SubGroup
SEGMENTED BY hash(a_payer_rollup.ims_id, a_payer_rollup.sorg_lvl, a_payer_rollup.sorg, a_payer_rollup.payment_method, a_payer_rollup.pbm_name, a_payer_rollup.payer_name, a_payer_rollup.plan_name) ALL NODES;

CREATE PROJECTION sandbox.a_tmp_a_b0 /*+basename(a_tmp_a),createtype(A)*/ 
(
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkttrx_c3,
 mkttrx_p3,
 mkttrx_A_c3,
 mkttrx_A_p3
)
AS
 SELECT a_tmp_a.sorg_lvl,
        a_tmp_a.sorg,
        a_tmp_a.payment_method,
        a_tmp_a.pbm_name,
        a_tmp_a.payer_name,
        a_tmp_a.plan_name,
        a_tmp_a.mkttrx_c3,
        a_tmp_a.mkttrx_p3,
        a_tmp_a.mkttrx_A_c3,
        a_tmp_a.mkttrx_A_p3
 FROM sandbox.a_tmp_a
 ORDER BY a_tmp_a.sorg_lvl,
          a_tmp_a.sorg,
          a_tmp_a.payment_method,
          a_tmp_a.pbm_name,
          a_tmp_a.payer_name,
          a_tmp_a.plan_name
SEGMENTED BY hash(a_tmp_a.sorg_lvl, a_tmp_a.sorg, a_tmp_a.payment_method, a_tmp_a.pbm_name, a_tmp_a.payer_name, a_tmp_a.plan_name) ALL NODES;

CREATE PROJECTION sandbox.a_tmp_b_b0 /*+basename(a_tmp_b),createtype(A)*/ 
(
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkttrx_c3,
 mkttrx_p3,
 mkttrx_A_c3,
 mkttrx_A_p3,
 Total,
 RunningTotal
)
AS
 SELECT a_tmp_b.sorg_lvl,
        a_tmp_b.sorg,
        a_tmp_b.payment_method,
        a_tmp_b.pbm_name,
        a_tmp_b.payer_name,
        a_tmp_b.plan_name,
        a_tmp_b.mkttrx_c3,
        a_tmp_b.mkttrx_p3,
        a_tmp_b.mkttrx_A_c3,
        a_tmp_b.mkttrx_A_p3,
        a_tmp_b.Total,
        a_tmp_b.RunningTotal
 FROM sandbox.a_tmp_b
 ORDER BY a_tmp_b.sorg,
          a_tmp_b.mkttrx_c3
SEGMENTED BY hash(a_tmp_b.sorg) ALL NODES;

CREATE PROJECTION sandbox.a_top_plans_rollup_b0 /*+basename(a_top_plans_rollup),createtype(A)*/ 
(
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkttrx_c3,
 mkttrx_p3,
 mkttrx_A_c3,
 mkttrx_A_p3,
 Total,
 RunningTotal
)
AS
 SELECT a_top_plans_rollup.sorg_lvl,
        a_top_plans_rollup.sorg,
        a_top_plans_rollup.payment_method,
        a_top_plans_rollup.pbm_name,
        a_top_plans_rollup.payer_name,
        a_top_plans_rollup.plan_name,
        a_top_plans_rollup.mkttrx_c3,
        a_top_plans_rollup.mkttrx_p3,
        a_top_plans_rollup.mkttrx_A_c3,
        a_top_plans_rollup.mkttrx_A_p3,
        a_top_plans_rollup.Total,
        a_top_plans_rollup.RunningTotal
 FROM sandbox.a_top_plans_rollup
 ORDER BY a_top_plans_rollup.sorg,
          a_top_plans_rollup.mkttrx_c3
SEGMENTED BY hash(a_top_plans_rollup.sorg) ALL NODES;

CREATE PROJECTION sandbox.a_plans_by_geo_b0 /*+basename(a_plans_by_geo),createtype(A)*/ 
(
 sorg_lvl,
 sorg,
 payment_method,
 pbm_name,
 payer_name,
 plan_name,
 mkt_id,
 prod_grp,
 teva_prod,
 mkttrx_c3,
 Total,
 mkttrx_p3,
 mkttrx_A_c3,
 mkttrx_A_p3,
 trx_c1,
 trx_p1,
 trx_c3,
 trx_p3
)
AS
 SELECT a_plans_by_geo.sorg_lvl,
        a_plans_by_geo.sorg,
        a_plans_by_geo.payment_method,
        a_plans_by_geo.pbm_name,
        a_plans_by_geo.payer_name,
        a_plans_by_geo.plan_name,
        a_plans_by_geo.mkt_id,
        a_plans_by_geo.prod_grp,
        a_plans_by_geo.teva_prod,
        a_plans_by_geo.mkttrx_c3,
        a_plans_by_geo.Total,
        a_plans_by_geo.mkttrx_p3,
        a_plans_by_geo.mkttrx_A_c3,
        a_plans_by_geo.mkttrx_A_p3,
        a_plans_by_geo.trx_c1,
        a_plans_by_geo.trx_p1,
        a_plans_by_geo.trx_c3,
        a_plans_by_geo.trx_p3
 FROM sandbox.a_plans_by_geo
 ORDER BY a_plans_by_geo.sorg_lvl,
          a_plans_by_geo.sorg,
          a_plans_by_geo.payment_method,
          a_plans_by_geo.pbm_name,
          a_plans_by_geo.payer_name,
          a_plans_by_geo.plan_name,
          a_plans_by_geo.mkt_id,
          a_plans_by_geo.prod_grp,
          a_plans_by_geo.teva_prod,
          a_plans_by_geo.mkttrx_c3,
          a_plans_by_geo.Total,
          a_plans_by_geo.mkttrx_p3,
          a_plans_by_geo.mkttrx_A_c3,
          a_plans_by_geo.mkttrx_A_p3
SEGMENTED BY hash(a_plans_by_geo.sorg) ALL NODES;

CREATE PROJECTION sandbox.presr_rx_resp_07172021_b0 /*+basename(presr_rx_resp_07172021),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication,
 pbm_parent_name
)
AS
 SELECT presr_rx_resp_07172021.ims_id,
        presr_rx_resp_07172021.payer_plan_number,
        presr_rx_resp_07172021.ims_client_number,
        presr_rx_resp_07172021.report_frequency,
        presr_rx_resp_07172021.ims_product_group,
        presr_rx_resp_07172021.basket_id,
        presr_rx_resp_07172021.data_date,
        presr_rx_resp_07172021.date,
        presr_rx_resp_07172021.sales_category,
        presr_rx_resp_07172021.tvcmid,
        presr_rx_resp_07172021.prescriber_first_name,
        presr_rx_resp_07172021.prescriber_last_name,
        presr_rx_resp_07172021.basket_name,
        presr_rx_resp_07172021.basket_type,
        presr_rx_resp_07172021.rollup_week,
        presr_rx_resp_07172021.rollup_month,
        presr_rx_resp_07172021.nrx_count,
        presr_rx_resp_07172021.trx_count,
        presr_rx_resp_07172021.nrx_quantity,
        presr_rx_resp_07172021.trx_quantity,
        presr_rx_resp_07172021.unnormalized_nrx_count,
        presr_rx_resp_07172021.unnormalized_trx_count,
        presr_rx_resp_07172021.market_name,
        presr_rx_resp_07172021.payer_name,
        presr_rx_resp_07172021.plan_name,
        presr_rx_resp_07172021.pbm_name,
        presr_rx_resp_07172021.model,
        presr_rx_resp_07172021.payment_method,
        presr_rx_resp_07172021.ims_specialty,
        presr_rx_resp_07172021.ims_rx_type,
        presr_rx_resp_07172021.ims_supplemental_data,
        presr_rx_resp_07172021.ims_zip_other,
        presr_rx_resp_07172021.ims_report_number_cnt,
        presr_rx_resp_07172021.cnt_file_id,
        presr_rx_resp_07172021.cnt_record_id,
        presr_rx_resp_07172021.ims_report_number_qty,
        presr_rx_resp_07172021.qty_file_id,
        presr_rx_resp_07172021.qty_record_id,
        presr_rx_resp_07172021.rollup_flag,
        presr_rx_resp_07172021.indication,
        presr_rx_resp_07172021.pbm_parent_name
 FROM sandbox.presr_rx_resp_07172021
 ORDER BY presr_rx_resp_07172021.rollup_flag,
          presr_rx_resp_07172021.ims_rx_type,
          presr_rx_resp_07172021.report_frequency,
          presr_rx_resp_07172021.basket_type,
          presr_rx_resp_07172021.ims_client_number,
          presr_rx_resp_07172021.indication,
          presr_rx_resp_07172021.market_name,
          presr_rx_resp_07172021.ims_product_group,
          presr_rx_resp_07172021.basket_id,
          presr_rx_resp_07172021.ims_specialty,
          presr_rx_resp_07172021.ims_zip_other,
          presr_rx_resp_07172021.ims_report_number_qty,
          presr_rx_resp_07172021.ims_report_number_cnt,
          presr_rx_resp_07172021.tvcmid,
          presr_rx_resp_07172021.payment_method,
          presr_rx_resp_07172021.payer_plan_number,
          presr_rx_resp_07172021.rollup_month,
          presr_rx_resp_07172021.rollup_week,
          presr_rx_resp_07172021.nrx_quantity,
          presr_rx_resp_07172021.trx_quantity,
          presr_rx_resp_07172021.nrx_count,
          presr_rx_resp_07172021.trx_count,
          presr_rx_resp_07172021.sales_category,
          presr_rx_resp_07172021.ims_id
SEGMENTED BY hash(presr_rx_resp_07172021.ims_id) ALL NODES;

CREATE PROJECTION sandbox.sample_table1_b0 /*+basename(sample_table1),createtype(L)*/ 
(
 a
)
AS
 SELECT sample_table1.a
 FROM sandbox.sample_table1
 ORDER BY sample_table1.a
SEGMENTED BY hash(sample_table1.a) ALL NODES;

CREATE PROJECTION sandbox.key_controller_list_v1_b0 /*+basename(key_controller_list_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT key_controller_list_v1.ftf_health_plan_fid,
        key_controller_list_v1.ftf_health_plan_name,
        key_controller_list_v1.key_controlling_account,
        key_controller_list_v1.key_controlling_plan_formulary,
        key_controller_list_v1.key_controlling_parent,
        key_controller_list_v1.payer_pbm,
        key_controller_list_v1.file_id,
        key_controller_list_v1.record_id
 FROM sandbox.key_controller_list_v1
 ORDER BY key_controller_list_v1.ftf_health_plan_fid,
          key_controller_list_v1.ftf_health_plan_name,
          key_controller_list_v1.key_controlling_account,
          key_controller_list_v1.key_controlling_plan_formulary,
          key_controller_list_v1.key_controlling_parent,
          key_controller_list_v1.payer_pbm,
          key_controller_list_v1.file_id,
          key_controller_list_v1.record_id
SEGMENTED BY hash(key_controller_list_v1.ftf_health_plan_fid, key_controller_list_v1.file_id, key_controller_list_v1.record_id, key_controller_list_v1.key_controlling_account, key_controller_list_v1.key_controlling_plan_formulary, key_controller_list_v1.key_controlling_parent, key_controller_list_v1.payer_pbm, key_controller_list_v1.ftf_health_plan_name) ALL NODES;

CREATE PROJECTION sandbox.provider_override_default_v1_b0 /*+basename(provider_override_default_v1),createtype(L)*/ 
(
 provider_id,
 paytype_regex,
 provider_name,
 fill_in_iqvia_payer_name_if_no_bridge,
 override_best_iqvia_payer,
 fill_in_iqvia_pbm_if_no_bridge,
 override_best_iqvia_pbm,
 file_id,
 record_id
)
AS
 SELECT provider_override_default_v1.provider_id,
        provider_override_default_v1.paytype_regex,
        provider_override_default_v1.provider_name,
        provider_override_default_v1.fill_in_iqvia_payer_name_if_no_bridge,
        provider_override_default_v1.override_best_iqvia_payer,
        provider_override_default_v1.fill_in_iqvia_pbm_if_no_bridge,
        provider_override_default_v1.override_best_iqvia_pbm,
        provider_override_default_v1.file_id,
        provider_override_default_v1.record_id
 FROM sandbox.provider_override_default_v1
 ORDER BY provider_override_default_v1.provider_id,
          provider_override_default_v1.paytype_regex,
          provider_override_default_v1.provider_name,
          provider_override_default_v1.fill_in_iqvia_payer_name_if_no_bridge,
          provider_override_default_v1.override_best_iqvia_payer,
          provider_override_default_v1.fill_in_iqvia_pbm_if_no_bridge,
          provider_override_default_v1.override_best_iqvia_pbm,
          provider_override_default_v1.file_id
SEGMENTED BY hash(provider_override_default_v1.file_id, provider_override_default_v1.record_id, provider_override_default_v1.provider_id, provider_override_default_v1.paytype_regex, provider_override_default_v1.provider_name, provider_override_default_v1.fill_in_iqvia_payer_name_if_no_bridge, provider_override_default_v1.override_best_iqvia_payer, provider_override_default_v1.fill_in_iqvia_pbm_if_no_bridge) ALL NODES;

CREATE PROJECTION sandbox.iqvia_mb_may_v3_b0 /*+basename(iqvia_mb_may_v3),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 cycle_id
)
AS
 SELECT iqvia_mb_may_v3.iqvia_plan_code,
        iqvia_mb_may_v3.iqvia_plan_name,
        iqvia_mb_may_v3.iqvia_payer_name,
        iqvia_mb_may_v3.iqvia_pbm,
        iqvia_mb_may_v3.payment_type,
        iqvia_mb_may_v3.iqvia_model,
        iqvia_mb_may_v3.ftf_health_plan_fid,
        iqvia_mb_may_v3.ftf_health_plan_name,
        iqvia_mb_may_v3.ftf_health_plan_type,
        iqvia_mb_may_v3.key_controlling_plan_formulary,
        iqvia_mb_may_v3.key_controlling_account,
        iqvia_mb_may_v3.key_controlling_parent,
        iqvia_mb_may_v3.payer_pbm,
        iqvia_mb_may_v3.ajovy_access_for_ftf_plan,
        iqvia_mb_may_v3.aimovig_access_for_ftf_plan,
        iqvia_mb_may_v3.emgality_access_for_ftf_plan,
        iqvia_mb_may_v3.total_lives_for_ftf_plan,
        iqvia_mb_may_v3.key_pbm,
        iqvia_mb_may_v3.cycle_id
 FROM sandbox.iqvia_mb_may_v3
 ORDER BY iqvia_mb_may_v3.iqvia_plan_code,
          iqvia_mb_may_v3.iqvia_plan_name,
          iqvia_mb_may_v3.iqvia_payer_name,
          iqvia_mb_may_v3.iqvia_pbm,
          iqvia_mb_may_v3.payment_type,
          iqvia_mb_may_v3.iqvia_model,
          iqvia_mb_may_v3.ftf_health_plan_fid,
          iqvia_mb_may_v3.ftf_health_plan_name
SEGMENTED BY hash(iqvia_mb_may_v3.total_lives_for_ftf_plan, iqvia_mb_may_v3.cycle_id, iqvia_mb_may_v3.iqvia_plan_code, iqvia_mb_may_v3.iqvia_plan_name, iqvia_mb_may_v3.iqvia_payer_name, iqvia_mb_may_v3.iqvia_pbm, iqvia_mb_may_v3.payment_type, iqvia_mb_may_v3.iqvia_model) ALL NODES;

CREATE PROJECTION sandbox.mb_may_v4_b0 /*+basename(mb_may_v4),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 coverage_category_for_ajovy,
 coverage_category_for_aimovig,
 coverage_category_for_emgality,
 ftfproviderfid,
 ftf_provider_name,
 ftf_parent_name,
 paytypeindex,
 pay_type,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 ftf_match_iqvia,
 lives_mx,
 cycle_id
)
AS
 SELECT mb_may_v4.ftf_health_plan_fid,
        mb_may_v4.ftf_health_plan_name,
        mb_may_v4.coverage_category_for_ajovy,
        mb_may_v4.coverage_category_for_aimovig,
        mb_may_v4.coverage_category_for_emgality,
        mb_may_v4.ftfproviderfid,
        mb_may_v4.ftf_provider_name,
        mb_may_v4.ftf_parent_name,
        mb_may_v4.paytypeindex,
        mb_may_v4.pay_type,
        mb_may_v4.ftf_health_plan_type,
        mb_may_v4.key_controlling_plan_formulary,
        mb_may_v4.key_controlling_account,
        mb_may_v4.key_controlling_parent,
        mb_may_v4.payer_pbm,
        mb_may_v4.key_pbm,
        mb_may_v4.iqvia_payer_name,
        mb_may_v4.iqvia_pbm,
        mb_may_v4.ftf_formulary_management_pbm,
        mb_may_v4.ftf_formulary_influencer_pbm,
        mb_may_v4.ftf_claims_processing_pbm,
        mb_may_v4.pref_brand_tier,
        mb_may_v4.ftf_match_iqvia,
        mb_may_v4.lives_mx,
        mb_may_v4.cycle_id
 FROM sandbox.mb_may_v4
 ORDER BY mb_may_v4.ftf_health_plan_fid,
          mb_may_v4.ftf_health_plan_name,
          mb_may_v4.coverage_category_for_ajovy,
          mb_may_v4.coverage_category_for_aimovig,
          mb_may_v4.coverage_category_for_emgality,
          mb_may_v4.ftfproviderfid,
          mb_may_v4.ftf_provider_name,
          mb_may_v4.ftf_parent_name
SEGMENTED BY hash(mb_may_v4.pref_brand_tier, mb_may_v4.ftf_match_iqvia, mb_may_v4.lives_mx, mb_may_v4.cycle_id, mb_may_v4.ftf_health_plan_fid, mb_may_v4.ftf_health_plan_name, mb_may_v4.coverage_category_for_ajovy, mb_may_v4.coverage_category_for_aimovig) ALL NODES;

CREATE PROJECTION sandbox.override_fid_iqvia_key_controller_list_b0 /*+basename(override_fid_iqvia_key_controller_list),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 file_id,
 record_id
)
AS
 SELECT override_fid_iqvia_key_controller_list.iqvia_plan_code,
        override_fid_iqvia_key_controller_list.iqvia_plan_name,
        override_fid_iqvia_key_controller_list.ftf_health_plan_fid,
        override_fid_iqvia_key_controller_list.ftf_health_plan_name,
        override_fid_iqvia_key_controller_list.key_controlling_plan_formulary,
        override_fid_iqvia_key_controller_list.key_controlling_account,
        override_fid_iqvia_key_controller_list.key_controlling_parent,
        override_fid_iqvia_key_controller_list.payer_pbm,
        override_fid_iqvia_key_controller_list.file_id,
        override_fid_iqvia_key_controller_list.record_id
 FROM sandbox.override_fid_iqvia_key_controller_list
 ORDER BY override_fid_iqvia_key_controller_list.iqvia_plan_code,
          override_fid_iqvia_key_controller_list.iqvia_plan_name,
          override_fid_iqvia_key_controller_list.ftf_health_plan_fid,
          override_fid_iqvia_key_controller_list.ftf_health_plan_name,
          override_fid_iqvia_key_controller_list.key_controlling_plan_formulary,
          override_fid_iqvia_key_controller_list.key_controlling_account,
          override_fid_iqvia_key_controller_list.key_controlling_parent,
          override_fid_iqvia_key_controller_list.payer_pbm
SEGMENTED BY hash(override_fid_iqvia_key_controller_list.iqvia_plan_code, override_fid_iqvia_key_controller_list.ftf_health_plan_fid, override_fid_iqvia_key_controller_list.file_id, override_fid_iqvia_key_controller_list.record_id, override_fid_iqvia_key_controller_list.iqvia_plan_name, override_fid_iqvia_key_controller_list.ftf_health_plan_name, override_fid_iqvia_key_controller_list.key_controlling_plan_formulary, override_fid_iqvia_key_controller_list.key_controlling_account) ALL NODES;

CREATE PROJECTION sandbox.ftf_restriction_id_group_mapping_v2_b0 /*+basename(ftf_restriction_id_group_mapping_v2),createtype(L)*/ 
(
 restriction_detail_id,
 restriction_detail_text,
 row_count,
 restriction_group,
 coverage_cat,
 other_pmf_metrics
)
AS
 SELECT ftf_restriction_id_group_mapping_v2.restriction_detail_id,
        ftf_restriction_id_group_mapping_v2.restriction_detail_text,
        ftf_restriction_id_group_mapping_v2.row_count,
        ftf_restriction_id_group_mapping_v2.restriction_group,
        ftf_restriction_id_group_mapping_v2.coverage_cat,
        ftf_restriction_id_group_mapping_v2.other_pmf_metrics
 FROM sandbox.ftf_restriction_id_group_mapping_v2
 ORDER BY ftf_restriction_id_group_mapping_v2.restriction_detail_id,
          ftf_restriction_id_group_mapping_v2.restriction_detail_text,
          ftf_restriction_id_group_mapping_v2.row_count,
          ftf_restriction_id_group_mapping_v2.restriction_group,
          ftf_restriction_id_group_mapping_v2.coverage_cat,
          ftf_restriction_id_group_mapping_v2.other_pmf_metrics
SEGMENTED BY hash(ftf_restriction_id_group_mapping_v2.restriction_detail_id, ftf_restriction_id_group_mapping_v2.row_count, ftf_restriction_id_group_mapping_v2.coverage_cat, ftf_restriction_id_group_mapping_v2.other_pmf_metrics, ftf_restriction_id_group_mapping_v2.restriction_detail_text, ftf_restriction_id_group_mapping_v2.restriction_group) ALL NODES;

CREATE PROJECTION sandbox.archer_target_data_b0 /*+basename(archer_target_data),createtype(L)*/ 
(
 territory,
 geography,
 region,
 tvcmid,
 ims_id,
 npi,
 decile,
 vmat2_12_mth,
 pdrp_flag,
 last_name,
 first_name,
 specialty,
 address,
 city,
 state,
 zip
)
AS
 SELECT archer_target_data.territory,
        archer_target_data.geography,
        archer_target_data.region,
        archer_target_data.tvcmid,
        archer_target_data.ims_id,
        archer_target_data.npi,
        archer_target_data.decile,
        archer_target_data.vmat2_12_mth,
        archer_target_data.pdrp_flag,
        archer_target_data.last_name,
        archer_target_data.first_name,
        archer_target_data.specialty,
        archer_target_data.address,
        archer_target_data.city,
        archer_target_data.state,
        archer_target_data.zip
 FROM sandbox.archer_target_data
 ORDER BY archer_target_data.territory,
          archer_target_data.geography,
          archer_target_data.region,
          archer_target_data.tvcmid,
          archer_target_data.ims_id,
          archer_target_data.npi,
          archer_target_data.decile,
          archer_target_data.vmat2_12_mth
SEGMENTED BY hash(archer_target_data.tvcmid, archer_target_data.decile, archer_target_data.pdrp_flag, archer_target_data.state, archer_target_data.zip, archer_target_data.territory, archer_target_data.region, archer_target_data.ims_id) ALL NODES;

CREATE PROJECTION sandbox.archer_zip_terr_b0 /*+basename(archer_zip_terr),createtype(L)*/ 
(
 zip_code,
 city,
 state_code,
 territory_number,
 territory_name,
 area_name,
 region_name,
 mirror_flag,
 sales_force_id,
 region_number,
 area_number
)
AS
 SELECT archer_zip_terr.zip_code,
        archer_zip_terr.city,
        archer_zip_terr.state_code,
        archer_zip_terr.territory_number,
        archer_zip_terr.territory_name,
        archer_zip_terr.area_name,
        archer_zip_terr.region_name,
        archer_zip_terr.mirror_flag,
        archer_zip_terr.sales_force_id,
        archer_zip_terr.region_number,
        archer_zip_terr.area_number
 FROM sandbox.archer_zip_terr
 ORDER BY archer_zip_terr.zip_code,
          archer_zip_terr.city,
          archer_zip_terr.state_code,
          archer_zip_terr.territory_number,
          archer_zip_terr.territory_name,
          archer_zip_terr.area_name,
          archer_zip_terr.region_name,
          archer_zip_terr.mirror_flag
SEGMENTED BY hash(archer_zip_terr.zip_code, archer_zip_terr.state_code, archer_zip_terr.mirror_flag, archer_zip_terr.sales_force_id, archer_zip_terr.region_number, archer_zip_terr.area_number, archer_zip_terr.territory_number, archer_zip_terr.city) ALL NODES;

CREATE PROJECTION sandbox."digital-affinity_b0" /*+basename(digital-affinity),createtype(L)*/ 
(
 vid__v,
 id,
 entity_type,
 id_type
)
AS
 SELECT "digital-affinity".vid__v,
        "digital-affinity".id,
        "digital-affinity".entity_type,
        "digital-affinity".id_type
 FROM sandbox."digital-affinity"
 ORDER BY "digital-affinity".vid__v,
          "digital-affinity".id,
          "digital-affinity".entity_type,
          "digital-affinity".id_type
SEGMENTED BY hash("digital-affinity".vid__v, "digital-affinity".id, "digital-affinity".entity_type, "digital-affinity".id_type) ALL NODES;

CREATE PROJECTION sandbox.ic_rx_Feb21_b0 /*+basename(ic_rx_Feb21),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication,
 outlet_dea,
 payer_plan_number,
 payment_method
)
AS
 SELECT ic_rx_Feb21.ic_data_month,
        ic_rx_Feb21.basket_name,
        ic_rx_Feb21.sales_force_id,
        ic_rx_Feb21.area_number,
        ic_rx_Feb21.region_number,
        ic_rx_Feb21.territory_number,
        ic_rx_Feb21.ims_id,
        ic_rx_Feb21.tvcmid,
        ic_rx_Feb21.outlet_code,
        ic_rx_Feb21.va_station_number,
        ic_rx_Feb21.dnc_flag,
        ic_rx_Feb21.dnp_flag,
        ic_rx_Feb21.rollup_month,
        ic_rx_Feb21.month_bucket,
        ic_rx_Feb21.nrx_count,
        ic_rx_Feb21.trx_count,
        ic_rx_Feb21.nrx_quantity,
        ic_rx_Feb21.trx_quantity,
        ic_rx_Feb21.include_in_nation_rollup,
        ic_rx_Feb21.include_in_area_rollup,
        ic_rx_Feb21.include_in_region_rollup,
        ic_rx_Feb21.join_key,
        ic_rx_Feb21.row_source,
        ic_rx_Feb21.row_create_date,
        ic_rx_Feb21.indication,
        ic_rx_Feb21.outlet_dea,
        ic_rx_Feb21.payer_plan_number,
        ic_rx_Feb21.payment_method
 FROM sandbox.ic_rx_Feb21
 ORDER BY ic_rx_Feb21.area_number,
          ic_rx_Feb21.region_number,
          ic_rx_Feb21.territory_number,
          ic_rx_Feb21.ims_id,
          ic_rx_Feb21.tvcmid
SEGMENTED BY hash(ic_rx_Feb21.ic_data_month, ic_rx_Feb21.tvcmid, ic_rx_Feb21.outlet_code, ic_rx_Feb21.dnc_flag, ic_rx_Feb21.dnp_flag, ic_rx_Feb21.rollup_month, ic_rx_Feb21.month_bucket, ic_rx_Feb21.nrx_count, ic_rx_Feb21.trx_count, ic_rx_Feb21.nrx_quantity, ic_rx_Feb21.trx_quantity, ic_rx_Feb21.include_in_nation_rollup, ic_rx_Feb21.include_in_area_rollup, ic_rx_Feb21.include_in_region_rollup, ic_rx_Feb21.row_create_date, ic_rx_Feb21.ims_id, ic_rx_Feb21.va_station_number, ic_rx_Feb21.join_key, ic_rx_Feb21.area_number, ic_rx_Feb21.region_number, ic_rx_Feb21.territory_number, ic_rx_Feb21.sales_force_id, ic_rx_Feb21.row_source, ic_rx_Feb21.basket_name) ALL NODES;

CREATE PROJECTION sandbox.ic_demo_Feb21_b0 /*+basename(ic_demo_Feb21),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date,
 outlet_dea,
 secondary_specialty
)
AS
 SELECT ic_demo_Feb21.ic_data_month,
        ic_demo_Feb21.sales_force_id,
        ic_demo_Feb21.area_number,
        ic_demo_Feb21.region_number,
        ic_demo_Feb21.territory_number,
        ic_demo_Feb21.ims_id,
        ic_demo_Feb21.tvcmid,
        ic_demo_Feb21.outlet_code,
        ic_demo_Feb21.va_station_number,
        ic_demo_Feb21.specialty,
        ic_demo_Feb21.last_name,
        ic_demo_Feb21.first_name,
        ic_demo_Feb21.mid_name,
        ic_demo_Feb21.address_1,
        ic_demo_Feb21.address_2,
        ic_demo_Feb21.address_3,
        ic_demo_Feb21.city,
        ic_demo_Feb21.state,
        ic_demo_Feb21.zip,
        ic_demo_Feb21.address_source,
        ic_demo_Feb21.pdrp_flag,
        ic_demo_Feb21.pdrp_date,
        ic_demo_Feb21.np_pa_flag,
        ic_demo_Feb21.no_spend,
        ic_demo_Feb21.ama_no_contact_flag,
        ic_demo_Feb21.join_key,
        ic_demo_Feb21.row_source,
        ic_demo_Feb21.row_create_date,
        ic_demo_Feb21.outlet_dea,
        ic_demo_Feb21.secondary_specialty
 FROM sandbox.ic_demo_Feb21
 ORDER BY ic_demo_Feb21.area_number,
          ic_demo_Feb21.region_number,
          ic_demo_Feb21.territory_number,
          ic_demo_Feb21.ims_id,
          ic_demo_Feb21.tvcmid
SEGMENTED BY hash(ic_demo_Feb21.ic_data_month, ic_demo_Feb21.tvcmid, ic_demo_Feb21.outlet_code, ic_demo_Feb21.mid_name, ic_demo_Feb21.state, ic_demo_Feb21.zip, ic_demo_Feb21.pdrp_flag, ic_demo_Feb21.pdrp_date, ic_demo_Feb21.np_pa_flag, ic_demo_Feb21.no_spend, ic_demo_Feb21.ama_no_contact_flag, ic_demo_Feb21.row_create_date, ic_demo_Feb21.ims_id, ic_demo_Feb21.va_station_number, ic_demo_Feb21.specialty, ic_demo_Feb21.join_key, ic_demo_Feb21.area_number, ic_demo_Feb21.region_number, ic_demo_Feb21.territory_number, ic_demo_Feb21.sales_force_id, ic_demo_Feb21.first_name, ic_demo_Feb21.city, ic_demo_Feb21.address_source, ic_demo_Feb21.last_name, ic_demo_Feb21.address_1, ic_demo_Feb21.address_2, ic_demo_Feb21.address_3, ic_demo_Feb21.row_source) ALL NODES;

CREATE PROJECTION sandbox.act_hub_CSD1015_b0 /*+basename(act_hub_CSD1015),createtype(A)*/ 
(
 npi,
 activity_id,
 federation_id,
 contact,
 source_name,
 "datetime",
 trackback_id,
 previous_activity,
 level_name,
 activity_role_name,
 type_name,
 native_type,
 details,
 line_item_id,
 brand_name,
 activity,
 line_item_datetime,
 line_item_previous_line_item,
 line_item_trackback_id,
 line_item_details,
 line_item_type_name,
 line_item_native_type,
 basket_id,
 web_url
)
AS
 SELECT act_hub_CSD1015.npi,
        act_hub_CSD1015.activity_id,
        act_hub_CSD1015.federation_id,
        act_hub_CSD1015.contact,
        act_hub_CSD1015.source_name,
        act_hub_CSD1015."datetime",
        act_hub_CSD1015.trackback_id,
        act_hub_CSD1015.previous_activity,
        act_hub_CSD1015.level_name,
        act_hub_CSD1015.activity_role_name,
        act_hub_CSD1015.type_name,
        act_hub_CSD1015.native_type,
        act_hub_CSD1015.details,
        act_hub_CSD1015.line_item_id,
        act_hub_CSD1015.brand_name,
        act_hub_CSD1015.activity,
        act_hub_CSD1015.line_item_datetime,
        act_hub_CSD1015.line_item_previous_line_item,
        act_hub_CSD1015.line_item_trackback_id,
        act_hub_CSD1015.line_item_details,
        act_hub_CSD1015.line_item_type_name,
        act_hub_CSD1015.line_item_native_type,
        act_hub_CSD1015.basket_id,
        act_hub_CSD1015.web_url
 FROM sandbox.act_hub_CSD1015
 ORDER BY act_hub_CSD1015.activity_id
SEGMENTED BY hash(act_hub_CSD1015.activity_id) ALL NODES;

CREATE PROJECTION sandbox.mb_to_monthly_account_summary_b0 /*+basename(mb_to_monthly_account_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 target,
 new_account,
 market_volume_indicator,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg
)
AS
 SELECT mb_to_monthly_account_summary.sales_force_id,
        mb_to_monthly_account_summary.nation_id,
        mb_to_monthly_account_summary.nation,
        mb_to_monthly_account_summary.area_id,
        mb_to_monthly_account_summary.area,
        mb_to_monthly_account_summary.region_id,
        mb_to_monthly_account_summary.region,
        mb_to_monthly_account_summary.territory_id,
        mb_to_monthly_account_summary.territory,
        mb_to_monthly_account_summary.rep_name,
        mb_to_monthly_account_summary.user_id,
        mb_to_monthly_account_summary.time_period,
        mb_to_monthly_account_summary.period_type,
        mb_to_monthly_account_summary.period,
        mb_to_monthly_account_summary.market_id,
        mb_to_monthly_account_summary.market_name,
        mb_to_monthly_account_summary.brand_id,
        mb_to_monthly_account_summary.brand_name,
        mb_to_monthly_account_summary.teva_product_flag,
        mb_to_monthly_account_summary.customer_id,
        mb_to_monthly_account_summary.tvcmid,
        mb_to_monthly_account_summary.network_name,
        mb_to_monthly_account_summary.account_name,
        mb_to_monthly_account_summary.channel,
        mb_to_monthly_account_summary.address,
        mb_to_monthly_account_summary.city,
        mb_to_monthly_account_summary.state,
        mb_to_monthly_account_summary.zip,
        mb_to_monthly_account_summary.formulary_control,
        mb_to_monthly_account_summary.gpo,
        mb_to_monthly_account_summary.target,
        mb_to_monthly_account_summary.new_account,
        mb_to_monthly_account_summary.market_volume_indicator,
        mb_to_monthly_account_summary.product_vol_dollars,
        mb_to_monthly_account_summary.product_vol_mg,
        mb_to_monthly_account_summary.product_vol_mcg,
        mb_to_monthly_account_summary.market_vol_dollars,
        mb_to_monthly_account_summary.market_vol_mg,
        mb_to_monthly_account_summary.market_vol_mcg,
        mb_to_monthly_account_summary.prev_prod_vol_dollars,
        mb_to_monthly_account_summary.prev_prod_vol_mg,
        mb_to_monthly_account_summary.prev_prod_vol_mcg,
        mb_to_monthly_account_summary.prev_market_vol_dollars,
        mb_to_monthly_account_summary.prev_market_vol_mg,
        mb_to_monthly_account_summary.prev_market_vol_mcg
 FROM sandbox.mb_to_monthly_account_summary
 ORDER BY mb_to_monthly_account_summary.sales_force_id,
          mb_to_monthly_account_summary.nation_id,
          mb_to_monthly_account_summary.nation,
          mb_to_monthly_account_summary.area_id,
          mb_to_monthly_account_summary.area,
          mb_to_monthly_account_summary.region_id,
          mb_to_monthly_account_summary.region,
          mb_to_monthly_account_summary.territory_id
SEGMENTED BY hash(mb_to_monthly_account_summary.sales_force_id, mb_to_monthly_account_summary.market_id, mb_to_monthly_account_summary.brand_id, mb_to_monthly_account_summary.teva_product_flag, mb_to_monthly_account_summary.tvcmid, mb_to_monthly_account_summary.state, mb_to_monthly_account_summary.zip, mb_to_monthly_account_summary.new_account) ALL NODES;

CREATE PROJECTION sandbox.act_hub_CSD1015_nonAustedo_b0 /*+basename(act_hub_CSD1015_nonAustedo),createtype(A)*/ 
(
 npi,
 activity_id,
 federation_id,
 contact,
 source_name,
 "datetime",
 trackback_id,
 previous_activity,
 level_name,
 activity_role_name,
 type_name,
 native_type,
 details,
 line_item_id,
 brand_name,
 activity,
 line_item_datetime,
 line_item_previous_line_item,
 line_item_trackback_id,
 line_item_details,
 line_item_type_name,
 line_item_native_type,
 basket_id,
 web_url
)
AS
 SELECT act_hub_CSD1015_nonAustedo.npi,
        act_hub_CSD1015_nonAustedo.activity_id,
        act_hub_CSD1015_nonAustedo.federation_id,
        act_hub_CSD1015_nonAustedo.contact,
        act_hub_CSD1015_nonAustedo.source_name,
        act_hub_CSD1015_nonAustedo."datetime",
        act_hub_CSD1015_nonAustedo.trackback_id,
        act_hub_CSD1015_nonAustedo.previous_activity,
        act_hub_CSD1015_nonAustedo.level_name,
        act_hub_CSD1015_nonAustedo.activity_role_name,
        act_hub_CSD1015_nonAustedo.type_name,
        act_hub_CSD1015_nonAustedo.native_type,
        act_hub_CSD1015_nonAustedo.details,
        act_hub_CSD1015_nonAustedo.line_item_id,
        act_hub_CSD1015_nonAustedo.brand_name,
        act_hub_CSD1015_nonAustedo.activity,
        act_hub_CSD1015_nonAustedo.line_item_datetime,
        act_hub_CSD1015_nonAustedo.line_item_previous_line_item,
        act_hub_CSD1015_nonAustedo.line_item_trackback_id,
        act_hub_CSD1015_nonAustedo.line_item_details,
        act_hub_CSD1015_nonAustedo.line_item_type_name,
        act_hub_CSD1015_nonAustedo.line_item_native_type,
        act_hub_CSD1015_nonAustedo.basket_id,
        act_hub_CSD1015_nonAustedo.web_url
 FROM sandbox.act_hub_CSD1015_nonAustedo
 ORDER BY act_hub_CSD1015_nonAustedo.activity_id
SEGMENTED BY hash(act_hub_CSD1015_nonAustedo.activity_id) ALL NODES;

CREATE PROJECTION sandbox.Austedo_Enroll_b0 /*+basename(Austedo_Enroll),createtype(L)*/ 
(
 First_name,
 Last_name,
 NPI
)
AS
 SELECT Austedo_Enroll.First_name,
        Austedo_Enroll.Last_name,
        Austedo_Enroll.NPI
 FROM sandbox.Austedo_Enroll
 ORDER BY Austedo_Enroll.First_name,
          Austedo_Enroll.Last_name,
          Austedo_Enroll.NPI
SEGMENTED BY hash(Austedo_Enroll.First_name, Austedo_Enroll.Last_name, Austedo_Enroll.NPI) ALL NODES;

CREATE PROJECTION sandbox.zip_states_b0 /*+basename(zip_states),createtype(L)*/ 
(
 ZIP_CODE,
 STATE
)
AS
 SELECT zip_states.ZIP_CODE,
        zip_states.STATE
 FROM sandbox.zip_states
 ORDER BY zip_states.ZIP_CODE,
          zip_states.STATE
SEGMENTED BY hash(zip_states.ZIP_CODE, zip_states.STATE) ALL NODES;

CREATE PROJECTION sandbox.fcr_summ_0622_b0 /*+basename(fcr_summ_0622),createtype(A)*/ 
(
 rsm_name,
 rsm_title,
 region_number,
 rsm_email,
 sales_rep_name,
 sales_rep_title,
 territory_number,
 sales_rep_email,
 fcr_date
)
AS
 SELECT fcr_summ_0622.rsm_name,
        fcr_summ_0622.rsm_title,
        fcr_summ_0622.region_number,
        fcr_summ_0622.rsm_email,
        fcr_summ_0622.sales_rep_name,
        fcr_summ_0622.sales_rep_title,
        fcr_summ_0622.territory_number,
        fcr_summ_0622.sales_rep_email,
        fcr_summ_0622.fcr_date
 FROM sandbox.fcr_summ_0622
 ORDER BY fcr_summ_0622.rsm_name,
          fcr_summ_0622.rsm_title,
          fcr_summ_0622.region_number,
          fcr_summ_0622.rsm_email,
          fcr_summ_0622.sales_rep_name,
          fcr_summ_0622.sales_rep_title,
          fcr_summ_0622.territory_number,
          fcr_summ_0622.sales_rep_email
SEGMENTED BY hash(fcr_summ_0622.fcr_date, fcr_summ_0622.region_number, fcr_summ_0622.territory_number, fcr_summ_0622.rsm_title, fcr_summ_0622.sales_rep_title, fcr_summ_0622.rsm_name, fcr_summ_0622.sales_rep_name, fcr_summ_0622.rsm_email) ALL NODES;

CREATE PROJECTION sandbox.payer_test_b0 /*+basename(payer_test),createtype(A)*/ 
(
 IMS_ID,
 TVCMID,
 First_Name,
 Middle_Name,
 Last_Name,
 Cred,
 Location,
 Address_1,
 Address_2,
 City,
 State_Code,
 Zip_Code,
 Zip_Extension,
 Telephone,
 Alternative_Telephone
)
AS
 SELECT payer_test.IMS_ID,
        payer_test.TVCMID,
        payer_test.First_Name,
        payer_test.Middle_Name,
        payer_test.Last_Name,
        payer_test.Cred,
        payer_test.Location,
        payer_test.Address_1,
        payer_test.Address_2,
        payer_test.City,
        payer_test.State_Code,
        payer_test.Zip_Code,
        payer_test.Zip_Extension,
        payer_test.Telephone,
        payer_test.Alternative_Telephone
 FROM sandbox.payer_test
 ORDER BY payer_test.IMS_ID,
          payer_test.TVCMID,
          payer_test.First_Name,
          payer_test.Middle_Name,
          payer_test.Last_Name,
          payer_test.Cred,
          payer_test.Location,
          payer_test.Address_1
SEGMENTED BY hash(payer_test.TVCMID, payer_test.IMS_ID, payer_test.First_Name, payer_test.Middle_Name, payer_test.Last_Name, payer_test.City, payer_test.State_Code, payer_test.Zip_Code) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_v2_b0 /*+basename(ftf_restrictions_v2),createtype(A)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level,
 record_id,
 file_id
)
AS
 SELECT ftf_restrictions_v2.health_plan_id,
        ftf_restrictions_v2.drug_id,
        ftf_restrictions_v2.restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        ftf_restrictions_v2.restriction_detail_text,
        ftf_restrictions_v2.restriction_addtnl_information_1,
        ftf_restrictions_v2.restriction_addtnl_information_2,
        ftf_restrictions_v2.step_count,
        ftf_restrictions_v2.pa_form,
        ftf_restrictions_v2.indication,
        ftf_restrictions_v2.grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM sandbox.ftf_restrictions_v2
 ORDER BY ftf_restrictions_v2.health_plan_id,
          ftf_restrictions_v2.drug_id,
          ftf_restrictions_v2.restriction_code,
          ftf_restrictions_v2.restriction_detail_id,
          ftf_restrictions_v2.restriction_detail_text,
          ftf_restrictions_v2.restriction_addtnl_information_1,
          ftf_restrictions_v2.restriction_addtnl_information_2,
          ftf_restrictions_v2.step_count
SEGMENTED BY hash(ftf_restrictions_v2.record_id) ALL NODES;

CREATE PROJECTION sandbox.Ajovy_Status_b0 /*+basename(Ajovy_Status),createtype(L)*/ 
(
 file_date,
 rx_received_date,
 order_created_date,
 unique_patient_id,
 status,
 is_refill,
 script_type,
 refills_remaining,
 patient_age,
 inventory_item_name,
 prescriber_npi,
 prescriber_full_name,
 prescriber_first_name,
 prescriber_middle_name,
 prescriber_last_name,
 prescriber_address,
 prescriber_city,
 prescriber_state,
 prescriber_zip,
 primary_payer_name,
 primary_payment_type,
 primary_benefit_type,
 purchase_status
)
AS
 SELECT Ajovy_Status.file_date,
        Ajovy_Status.rx_received_date,
        Ajovy_Status.order_created_date,
        Ajovy_Status.unique_patient_id,
        Ajovy_Status.status,
        Ajovy_Status.is_refill,
        Ajovy_Status.script_type,
        Ajovy_Status.refills_remaining,
        Ajovy_Status.patient_age,
        Ajovy_Status.inventory_item_name,
        Ajovy_Status.prescriber_npi,
        Ajovy_Status.prescriber_full_name,
        Ajovy_Status.prescriber_first_name,
        Ajovy_Status.prescriber_middle_name,
        Ajovy_Status.prescriber_last_name,
        Ajovy_Status.prescriber_address,
        Ajovy_Status.prescriber_city,
        Ajovy_Status.prescriber_state,
        Ajovy_Status.prescriber_zip,
        Ajovy_Status.primary_payer_name,
        Ajovy_Status.primary_payment_type,
        Ajovy_Status.primary_benefit_type,
        Ajovy_Status.purchase_status
 FROM sandbox.Ajovy_Status
 ORDER BY Ajovy_Status.file_date,
          Ajovy_Status.rx_received_date,
          Ajovy_Status.order_created_date,
          Ajovy_Status.unique_patient_id,
          Ajovy_Status.status,
          Ajovy_Status.is_refill,
          Ajovy_Status.script_type,
          Ajovy_Status.refills_remaining
SEGMENTED BY hash(Ajovy_Status.file_date, Ajovy_Status.rx_received_date, Ajovy_Status.order_created_date, Ajovy_Status.refills_remaining, Ajovy_Status.patient_age, Ajovy_Status.status, Ajovy_Status.is_refill, Ajovy_Status.script_type) ALL NODES;

CREATE PROJECTION sandbox.veeva_suggestions_b0 /*+basename(veeva_suggestions),createtype(L)*/ 
(
 account_priority_score_vod__c,
 account_vod__c,
 display_dismiss_vod__c,
 display_mark_as_complete_vod__c,
 display_score_vod__c,
 email_template_id_vod__c,
 email_template_vault_id_vod__c,
 email_template_vod__c,
 expiration_date_vod__c,
 marked_as_complete_vod__c,
 mark_complete_count_vod__c,
 name,
 ownerid,
 posted_date,
 priority_vod__c,
 reason_vod__c,
 record_type_name_vod__c,
 suppress_reason_vod__c,
 title_vod__c,
 business_rule_name,
 product,
 combined_owner_account_key,
 days_since_last_call
)
AS
 SELECT veeva_suggestions.account_priority_score_vod__c,
        veeva_suggestions.account_vod__c,
        veeva_suggestions.display_dismiss_vod__c,
        veeva_suggestions.display_mark_as_complete_vod__c,
        veeva_suggestions.display_score_vod__c,
        veeva_suggestions.email_template_id_vod__c,
        veeva_suggestions.email_template_vault_id_vod__c,
        veeva_suggestions.email_template_vod__c,
        veeva_suggestions.expiration_date_vod__c,
        veeva_suggestions.marked_as_complete_vod__c,
        veeva_suggestions.mark_complete_count_vod__c,
        veeva_suggestions.name,
        veeva_suggestions.ownerid,
        veeva_suggestions.posted_date,
        veeva_suggestions.priority_vod__c,
        veeva_suggestions.reason_vod__c,
        veeva_suggestions.record_type_name_vod__c,
        veeva_suggestions.suppress_reason_vod__c,
        veeva_suggestions.title_vod__c,
        veeva_suggestions.business_rule_name,
        veeva_suggestions.product,
        veeva_suggestions.combined_owner_account_key,
        veeva_suggestions.days_since_last_call
 FROM sandbox.veeva_suggestions
 ORDER BY veeva_suggestions.account_priority_score_vod__c,
          veeva_suggestions.account_vod__c,
          veeva_suggestions.display_dismiss_vod__c,
          veeva_suggestions.display_mark_as_complete_vod__c,
          veeva_suggestions.display_score_vod__c,
          veeva_suggestions.email_template_id_vod__c,
          veeva_suggestions.email_template_vault_id_vod__c,
          veeva_suggestions.email_template_vod__c
SEGMENTED BY hash(veeva_suggestions.account_priority_score_vod__c, veeva_suggestions.expiration_date_vod__c, veeva_suggestions.mark_complete_count_vod__c, veeva_suggestions.posted_date, veeva_suggestions.days_since_last_call, veeva_suggestions.display_dismiss_vod__c, veeva_suggestions.display_mark_as_complete_vod__c, veeva_suggestions.display_score_vod__c) ALL NODES;

CREATE PROJECTION sandbox.fcr_summary_0714_b0 /*+basename(fcr_summary_0714),createtype(A)*/ 
(
 rsm_name,
 rsm_title,
 region_number,
 rsm_email,
 sales_rep_name,
 sales_rep_title,
 territory_number,
 sales_rep_email,
 fcr_date
)
AS
 SELECT fcr_summary_0714.rsm_name,
        fcr_summary_0714.rsm_title,
        fcr_summary_0714.region_number,
        fcr_summary_0714.rsm_email,
        fcr_summary_0714.sales_rep_name,
        fcr_summary_0714.sales_rep_title,
        fcr_summary_0714.territory_number,
        fcr_summary_0714.sales_rep_email,
        fcr_summary_0714.fcr_date
 FROM sandbox.fcr_summary_0714
 ORDER BY fcr_summary_0714.rsm_name,
          fcr_summary_0714.rsm_title,
          fcr_summary_0714.region_number,
          fcr_summary_0714.rsm_email,
          fcr_summary_0714.sales_rep_name,
          fcr_summary_0714.sales_rep_title,
          fcr_summary_0714.territory_number,
          fcr_summary_0714.sales_rep_email
SEGMENTED BY hash(fcr_summary_0714.fcr_date, fcr_summary_0714.region_number, fcr_summary_0714.rsm_title, fcr_summary_0714.sales_rep_title, fcr_summary_0714.territory_number, fcr_summary_0714.rsm_email, fcr_summary_0714.sales_rep_email, fcr_summary_0714.rsm_name) ALL NODES;

CREATE PROJECTION sandbox.Enrollment_b0 /*+basename(Enrollment),createtype(L)*/ 
(
 Prescriber_Name,
 State,
 Zip,
 NPI
)
AS
 SELECT Enrollment.Prescriber_Name,
        Enrollment.State,
        Enrollment.Zip,
        Enrollment.NPI
 FROM sandbox.Enrollment
 ORDER BY Enrollment.Prescriber_Name,
          Enrollment.State,
          Enrollment.Zip,
          Enrollment.NPI
SEGMENTED BY hash(Enrollment.Zip, Enrollment.NPI, Enrollment.State, Enrollment.Prescriber_Name) ALL NODES;

CREATE PROJECTION sandbox."MediCal HCPs_b0" /*+basename(MediCal HCPs),createtype(L)*/ 
(
 Region_ID,
 Region_Name,
 Territory_ID,
 Territory_Name,
 IMS_ID,
 First_Name,
 Last_Name,
 Specialty_Name,
 Specialty_Group,
 ACUTE_MIGRAINE,
 PREVENT_MIGRAINE,
 "ANTI-CGRP",
 AJOVY
)
AS
 SELECT "MediCal HCPs".Region_ID,
        "MediCal HCPs".Region_Name,
        "MediCal HCPs".Territory_ID,
        "MediCal HCPs".Territory_Name,
        "MediCal HCPs".IMS_ID,
        "MediCal HCPs".First_Name,
        "MediCal HCPs".Last_Name,
        "MediCal HCPs".Specialty_Name,
        "MediCal HCPs".Specialty_Group,
        "MediCal HCPs".ACUTE_MIGRAINE,
        "MediCal HCPs".PREVENT_MIGRAINE,
        "MediCal HCPs"."ANTI-CGRP",
        "MediCal HCPs".AJOVY
 FROM sandbox."MediCal HCPs"
 ORDER BY "MediCal HCPs".Region_ID,
          "MediCal HCPs".Region_Name,
          "MediCal HCPs".Territory_ID,
          "MediCal HCPs".Territory_Name,
          "MediCal HCPs".IMS_ID,
          "MediCal HCPs".First_Name,
          "MediCal HCPs".Last_Name,
          "MediCal HCPs".Specialty_Name
SEGMENTED BY hash("MediCal HCPs".ACUTE_MIGRAINE, "MediCal HCPs".PREVENT_MIGRAINE, "MediCal HCPs"."ANTI-CGRP", "MediCal HCPs".AJOVY, "MediCal HCPs".Region_ID, "MediCal HCPs".Territory_ID, "MediCal HCPs".Territory_Name, "MediCal HCPs".IMS_ID) ALL NODES;

CREATE PROJECTION sandbox.presr_rx_for_June_ic_07192021_b0 /*+basename(presr_rx_for_June_ic_07192021),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication,
 pbm_parent_name
)
AS
 SELECT presr_rx_for_June_ic_07192021.ims_id,
        presr_rx_for_June_ic_07192021.payer_plan_number,
        presr_rx_for_June_ic_07192021.ims_client_number,
        presr_rx_for_June_ic_07192021.report_frequency,
        presr_rx_for_June_ic_07192021.ims_product_group,
        presr_rx_for_June_ic_07192021.basket_id,
        presr_rx_for_June_ic_07192021.data_date,
        presr_rx_for_June_ic_07192021.date,
        presr_rx_for_June_ic_07192021.sales_category,
        presr_rx_for_June_ic_07192021.tvcmid,
        presr_rx_for_June_ic_07192021.prescriber_first_name,
        presr_rx_for_June_ic_07192021.prescriber_last_name,
        presr_rx_for_June_ic_07192021.basket_name,
        presr_rx_for_June_ic_07192021.basket_type,
        presr_rx_for_June_ic_07192021.rollup_week,
        presr_rx_for_June_ic_07192021.rollup_month,
        presr_rx_for_June_ic_07192021.nrx_count,
        presr_rx_for_June_ic_07192021.trx_count,
        presr_rx_for_June_ic_07192021.nrx_quantity,
        presr_rx_for_June_ic_07192021.trx_quantity,
        presr_rx_for_June_ic_07192021.unnormalized_nrx_count,
        presr_rx_for_June_ic_07192021.unnormalized_trx_count,
        presr_rx_for_June_ic_07192021.market_name,
        presr_rx_for_June_ic_07192021.payer_name,
        presr_rx_for_June_ic_07192021.plan_name,
        presr_rx_for_June_ic_07192021.pbm_name,
        presr_rx_for_June_ic_07192021.model,
        presr_rx_for_June_ic_07192021.payment_method,
        presr_rx_for_June_ic_07192021.ims_specialty,
        presr_rx_for_June_ic_07192021.ims_rx_type,
        presr_rx_for_June_ic_07192021.ims_supplemental_data,
        presr_rx_for_June_ic_07192021.ims_zip_other,
        presr_rx_for_June_ic_07192021.ims_report_number_cnt,
        presr_rx_for_June_ic_07192021.cnt_file_id,
        presr_rx_for_June_ic_07192021.cnt_record_id,
        presr_rx_for_June_ic_07192021.ims_report_number_qty,
        presr_rx_for_June_ic_07192021.qty_file_id,
        presr_rx_for_June_ic_07192021.qty_record_id,
        presr_rx_for_June_ic_07192021.rollup_flag,
        presr_rx_for_June_ic_07192021.indication,
        presr_rx_for_June_ic_07192021.pbm_parent_name
 FROM sandbox.presr_rx_for_June_ic_07192021
 ORDER BY presr_rx_for_June_ic_07192021.rollup_flag,
          presr_rx_for_June_ic_07192021.ims_rx_type,
          presr_rx_for_June_ic_07192021.report_frequency,
          presr_rx_for_June_ic_07192021.basket_type,
          presr_rx_for_June_ic_07192021.ims_client_number,
          presr_rx_for_June_ic_07192021.indication,
          presr_rx_for_June_ic_07192021.market_name,
          presr_rx_for_June_ic_07192021.ims_product_group,
          presr_rx_for_June_ic_07192021.basket_id,
          presr_rx_for_June_ic_07192021.ims_specialty,
          presr_rx_for_June_ic_07192021.ims_zip_other,
          presr_rx_for_June_ic_07192021.ims_report_number_qty,
          presr_rx_for_June_ic_07192021.ims_report_number_cnt,
          presr_rx_for_June_ic_07192021.tvcmid,
          presr_rx_for_June_ic_07192021.payment_method,
          presr_rx_for_June_ic_07192021.payer_plan_number,
          presr_rx_for_June_ic_07192021.rollup_month,
          presr_rx_for_June_ic_07192021.rollup_week,
          presr_rx_for_June_ic_07192021.nrx_quantity,
          presr_rx_for_June_ic_07192021.trx_quantity,
          presr_rx_for_June_ic_07192021.nrx_count,
          presr_rx_for_June_ic_07192021.trx_count,
          presr_rx_for_June_ic_07192021.sales_category,
          presr_rx_for_June_ic_07192021.ims_id
SEGMENTED BY hash(presr_rx_for_June_ic_07192021.ims_id) ALL NODES;

CREATE PROJECTION sandbox.license_audits_b0 /*+basename(license_audits),createtype(A)*/ 
(
 database_size_bytes,
 license_size_bytes,
 usage_percent,
 audit_start_timestamp,
 audit_end_timestamp,
 confidence_level_percent,
 error_tolerance_percent,
 used_sampling,
 confidence_interval_lower_bound_bytes,
 confidence_interval_upper_bound_bytes,
 sample_count,
 cell_count,
 audited_data
)
AS
 SELECT license_audits.database_size_bytes,
        license_audits.license_size_bytes,
        license_audits.usage_percent,
        license_audits.audit_start_timestamp,
        license_audits.audit_end_timestamp,
        license_audits.confidence_level_percent,
        license_audits.error_tolerance_percent,
        license_audits.used_sampling,
        license_audits.confidence_interval_lower_bound_bytes,
        license_audits.confidence_interval_upper_bound_bytes,
        license_audits.sample_count,
        license_audits.cell_count,
        license_audits.audited_data
 FROM sandbox.license_audits
 ORDER BY license_audits.database_size_bytes,
          license_audits.license_size_bytes,
          license_audits.usage_percent,
          license_audits.audit_start_timestamp,
          license_audits.audit_end_timestamp,
          license_audits.confidence_level_percent,
          license_audits.error_tolerance_percent,
          license_audits.used_sampling
SEGMENTED BY hash(license_audits.database_size_bytes, license_audits.usage_percent, license_audits.audit_start_timestamp, license_audits.audit_end_timestamp, license_audits.confidence_level_percent, license_audits.error_tolerance_percent, license_audits.used_sampling, license_audits.confidence_interval_lower_bound_bytes) ALL NODES;

CREATE PROJECTION sandbox.query_profiles_b0 /*+basename(query_profiles),createtype(A)*/ 
(
 session_id,
 transaction_id,
 statement_id,
 identifier,
 node_name,
 query,
 query_search_path,
 schema_name,
 table_name,
 query_duration_us,
 query_start_epoch,
 query_start,
 query_type,
 error_code,
 user_name,
 processed_row_count,
 reserved_extra_memory_b,
 is_executing
)
AS
 SELECT query_profiles.session_id,
        query_profiles.transaction_id,
        query_profiles.statement_id,
        query_profiles.identifier,
        query_profiles.node_name,
        query_profiles.query,
        query_profiles.query_search_path,
        query_profiles.schema_name,
        query_profiles.table_name,
        query_profiles.query_duration_us,
        query_profiles.query_start_epoch,
        query_profiles.query_start,
        query_profiles.query_type,
        query_profiles.error_code,
        query_profiles.user_name,
        query_profiles.processed_row_count,
        query_profiles.reserved_extra_memory_b,
        query_profiles.is_executing
 FROM sandbox.query_profiles
 ORDER BY query_profiles.session_id,
          query_profiles.transaction_id,
          query_profiles.statement_id,
          query_profiles.identifier,
          query_profiles.node_name,
          query_profiles.query,
          query_profiles.query_search_path,
          query_profiles.schema_name
SEGMENTED BY hash(query_profiles.transaction_id, query_profiles.statement_id, query_profiles.query_start_epoch, query_profiles.error_code, query_profiles.processed_row_count, query_profiles.reserved_extra_memory_b, query_profiles.is_executing, query_profiles.query_duration_us) ALL NODES;

CREATE PROJECTION sandbox.sessions_b0 /*+basename(sessions),createtype(A)*/ 
(
 node_name,
 user_name,
 client_hostname,
 client_pid,
 login_timestamp,
 session_id,
 idle_session_timeout,
 grace_period,
 client_label,
 transaction_start,
 transaction_id,
 transaction_description,
 statement_start,
 statement_id,
 last_statement_duration_us,
 runtime_priority,
 current_statement,
 last_statement,
 ssl_state,
 authentication_method,
 client_type,
 client_version,
 client_os,
 client_os_user_name,
 client_authentication_name,
 client_authentication,
 requested_protocol,
 effective_protocol,
 external_memory_kb
)
AS
 SELECT sessions.node_name,
        sessions.user_name,
        sessions.client_hostname,
        sessions.client_pid,
        sessions.login_timestamp,
        sessions.session_id,
        sessions.idle_session_timeout,
        sessions.grace_period,
        sessions.client_label,
        sessions.transaction_start,
        sessions.transaction_id,
        sessions.transaction_description,
        sessions.statement_start,
        sessions.statement_id,
        sessions.last_statement_duration_us,
        sessions.runtime_priority,
        sessions.current_statement,
        sessions.last_statement,
        sessions.ssl_state,
        sessions.authentication_method,
        sessions.client_type,
        sessions.client_version,
        sessions.client_os,
        sessions.client_os_user_name,
        sessions.client_authentication_name,
        sessions.client_authentication,
        sessions.requested_protocol,
        sessions.effective_protocol,
        sessions.external_memory_kb
 FROM sandbox.sessions
 ORDER BY sessions.node_name
SEGMENTED BY hash(sessions.client_pid, sessions.login_timestamp, sessions.idle_session_timeout, sessions.grace_period, sessions.transaction_start, sessions.transaction_id, sessions.statement_start, sessions.statement_id) ALL NODES;

CREATE PROJECTION sandbox.PSS_ARX_HCP_LIST_b0 /*+basename(PSS_ARX_HCP_LIST),createtype(L)*/ 
(
 "Prescribing Physician FN",
 "Prescribing Physician LN",
 "Prescribing Physician NPI"
)
AS
 SELECT PSS_ARX_HCP_LIST."Prescribing Physician FN",
        PSS_ARX_HCP_LIST."Prescribing Physician LN",
        PSS_ARX_HCP_LIST."Prescribing Physician NPI"
 FROM sandbox.PSS_ARX_HCP_LIST
 ORDER BY PSS_ARX_HCP_LIST."Prescribing Physician FN",
          PSS_ARX_HCP_LIST."Prescribing Physician LN",
          PSS_ARX_HCP_LIST."Prescribing Physician NPI"
SEGMENTED BY hash(PSS_ARX_HCP_LIST."Prescribing Physician NPI", PSS_ARX_HCP_LIST."Prescribing Physician FN", PSS_ARX_HCP_LIST."Prescribing Physician LN") ALL NODES;

CREATE PROJECTION sandbox.iqvia_payer_paytype_override_v1_b0 /*+basename(iqvia_payer_paytype_override_v1),createtype(A)*/ 
(
 iqvia_payer_name,
 iqvia_plan_name_regex,
 paytype,
 file_id,
 record_id
)
AS
 SELECT iqvia_payer_paytype_override_v1.iqvia_payer_name,
        iqvia_payer_paytype_override_v1.iqvia_plan_name_regex,
        iqvia_payer_paytype_override_v1.paytype,
        iqvia_payer_paytype_override_v1.file_id,
        iqvia_payer_paytype_override_v1.record_id
 FROM sandbox.iqvia_payer_paytype_override_v1
 ORDER BY iqvia_payer_paytype_override_v1.iqvia_payer_name,
          iqvia_payer_paytype_override_v1.iqvia_plan_name_regex,
          iqvia_payer_paytype_override_v1.paytype,
          iqvia_payer_paytype_override_v1.file_id,
          iqvia_payer_paytype_override_v1.record_id
SEGMENTED BY hash(iqvia_payer_paytype_override_v1.file_id, iqvia_payer_paytype_override_v1.record_id, iqvia_payer_paytype_override_v1.paytype, iqvia_payer_paytype_override_v1.iqvia_payer_name, iqvia_payer_paytype_override_v1.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.iqvia_paytypeindex_v1_b0 /*+basename(iqvia_paytypeindex_v1),createtype(L)*/ 
(
 paytype_index,
 paytype,
 file_id,
 record_id
)
AS
 SELECT iqvia_paytypeindex_v1.paytype_index,
        iqvia_paytypeindex_v1.paytype,
        iqvia_paytypeindex_v1.file_id,
        iqvia_paytypeindex_v1.record_id
 FROM sandbox.iqvia_paytypeindex_v1
 ORDER BY iqvia_paytypeindex_v1.paytype_index,
          iqvia_paytypeindex_v1.paytype,
          iqvia_paytypeindex_v1.file_id,
          iqvia_paytypeindex_v1.record_id
SEGMENTED BY hash(iqvia_paytypeindex_v1.file_id, iqvia_paytypeindex_v1.record_id, iqvia_paytypeindex_v1.paytype_index, iqvia_paytypeindex_v1.paytype) ALL NODES;

CREATE PROJECTION sandbox.model_paytype_map_v1_b0 /*+basename(model_paytype_map_v1),createtype(L)*/ 
(
 model,
 paytype,
 notes,
 file_id,
 record_id
)
AS
 SELECT model_paytype_map_v1.model,
        model_paytype_map_v1.paytype,
        model_paytype_map_v1.notes,
        model_paytype_map_v1.file_id,
        model_paytype_map_v1.record_id
 FROM sandbox.model_paytype_map_v1
 ORDER BY model_paytype_map_v1.model,
          model_paytype_map_v1.paytype,
          model_paytype_map_v1.notes,
          model_paytype_map_v1.file_id,
          model_paytype_map_v1.record_id
SEGMENTED BY hash(model_paytype_map_v1.file_id, model_paytype_map_v1.record_id, model_paytype_map_v1.model, model_paytype_map_v1.paytype, model_paytype_map_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plans_discard_v1_b0 /*+basename(iqvia_plans_discard_v1),createtype(L)*/ 
(
 payer_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT iqvia_plans_discard_v1.payer_id,
        iqvia_plans_discard_v1.notes,
        iqvia_plans_discard_v1.file_id,
        iqvia_plans_discard_v1.record_id
 FROM sandbox.iqvia_plans_discard_v1
 ORDER BY iqvia_plans_discard_v1.payer_id,
          iqvia_plans_discard_v1.notes,
          iqvia_plans_discard_v1.file_id,
          iqvia_plans_discard_v1.record_id
SEGMENTED BY hash(iqvia_plans_discard_v1.file_id, iqvia_plans_discard_v1.record_id, iqvia_plans_discard_v1.payer_id, iqvia_plans_discard_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.ftf_plans_paytypeindex_v1_b0 /*+basename(ftf_plans_paytypeindex_v1),createtype(L)*/ 
(
 ftf_health_plantype,
 paytype_index,
 file_id,
 record_id
)
AS
 SELECT ftf_plans_paytypeindex_v1.ftf_health_plantype,
        ftf_plans_paytypeindex_v1.paytype_index,
        ftf_plans_paytypeindex_v1.file_id,
        ftf_plans_paytypeindex_v1.record_id
 FROM sandbox.ftf_plans_paytypeindex_v1
 ORDER BY ftf_plans_paytypeindex_v1.ftf_health_plantype,
          ftf_plans_paytypeindex_v1.paytype_index,
          ftf_plans_paytypeindex_v1.file_id,
          ftf_plans_paytypeindex_v1.record_id
SEGMENTED BY hash(ftf_plans_paytypeindex_v1.paytype_index, ftf_plans_paytypeindex_v1.file_id, ftf_plans_paytypeindex_v1.record_id, ftf_plans_paytypeindex_v1.ftf_health_plantype) ALL NODES;

CREATE PROJECTION sandbox.drug_assignments_v1_b0 /*+basename(drug_assignments_v1),createtype(L)*/ 
(
 drug_id,
 drug_seq,
 product,
 file_id,
 record_id
)
AS
 SELECT drug_assignments_v1.drug_id,
        drug_assignments_v1.drug_seq,
        drug_assignments_v1.product,
        drug_assignments_v1.file_id,
        drug_assignments_v1.record_id
 FROM sandbox.drug_assignments_v1
 ORDER BY drug_assignments_v1.drug_id,
          drug_assignments_v1.drug_seq,
          drug_assignments_v1.product,
          drug_assignments_v1.file_id,
          drug_assignments_v1.record_id
SEGMENTED BY hash(drug_assignments_v1.drug_id, drug_assignments_v1.drug_seq, drug_assignments_v1.file_id, drug_assignments_v1.record_id, drug_assignments_v1.product) ALL NODES;

CREATE PROJECTION sandbox.botox_step_restriction_v1_b0 /*+basename(botox_step_restriction_v1),createtype(L)*/ 
(
 code,
 botox_step_flag,
 restriction_group,
 notes,
 file_id,
 record_id
)
AS
 SELECT botox_step_restriction_v1.code,
        botox_step_restriction_v1.botox_step_flag,
        botox_step_restriction_v1.restriction_group,
        botox_step_restriction_v1.notes,
        botox_step_restriction_v1.file_id,
        botox_step_restriction_v1.record_id
 FROM sandbox.botox_step_restriction_v1
 ORDER BY botox_step_restriction_v1.code,
          botox_step_restriction_v1.botox_step_flag,
          botox_step_restriction_v1.restriction_group,
          botox_step_restriction_v1.notes,
          botox_step_restriction_v1.file_id,
          botox_step_restriction_v1.record_id
SEGMENTED BY hash(botox_step_restriction_v1.code, botox_step_restriction_v1.file_id, botox_step_restriction_v1.record_id, botox_step_restriction_v1.botox_step_flag, botox_step_restriction_v1.restriction_group, botox_step_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.pa_restriction_v1_b0 /*+basename(pa_restriction_v1),createtype(L)*/ 
(
 code,
 prescriber_prior_authorization_category,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT pa_restriction_v1.code,
        pa_restriction_v1.prescriber_prior_authorization_category,
        pa_restriction_v1.restriction_detail_id,
        pa_restriction_v1.notes,
        pa_restriction_v1.file_id,
        pa_restriction_v1.record_id
 FROM sandbox.pa_restriction_v1
 ORDER BY pa_restriction_v1.code,
          pa_restriction_v1.prescriber_prior_authorization_category,
          pa_restriction_v1.restriction_detail_id,
          pa_restriction_v1.notes,
          pa_restriction_v1.file_id,
          pa_restriction_v1.record_id
SEGMENTED BY hash(pa_restriction_v1.code, pa_restriction_v1.file_id, pa_restriction_v1.record_id, pa_restriction_v1.prescriber_prior_authorization_category, pa_restriction_v1.restriction_detail_id, pa_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.step_restriction_v1_b0 /*+basename(step_restriction_v1),createtype(L)*/ 
(
 code,
 step_category,
 restriction_group,
 notes,
 file_id,
 record_id
)
AS
 SELECT step_restriction_v1.code,
        step_restriction_v1.step_category,
        step_restriction_v1.restriction_group,
        step_restriction_v1.notes,
        step_restriction_v1.file_id,
        step_restriction_v1.record_id
 FROM sandbox.step_restriction_v1
 ORDER BY step_restriction_v1.code,
          step_restriction_v1.step_category,
          step_restriction_v1.restriction_group,
          step_restriction_v1.notes,
          step_restriction_v1.file_id,
          step_restriction_v1.record_id
SEGMENTED BY hash(step_restriction_v1.code, step_restriction_v1.file_id, step_restriction_v1.record_id, step_restriction_v1.step_category, step_restriction_v1.restriction_group, step_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.patient_pa_restriction_v1_b0 /*+basename(patient_pa_restriction_v1),createtype(L)*/ 
(
 code,
 patient_prior_authorization_category,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT patient_pa_restriction_v1.code,
        patient_pa_restriction_v1.patient_prior_authorization_category,
        patient_pa_restriction_v1.restriction_detail_id,
        patient_pa_restriction_v1.notes,
        patient_pa_restriction_v1.file_id,
        patient_pa_restriction_v1.record_id
 FROM sandbox.patient_pa_restriction_v1
 ORDER BY patient_pa_restriction_v1.code,
          patient_pa_restriction_v1.patient_prior_authorization_category,
          patient_pa_restriction_v1.restriction_detail_id,
          patient_pa_restriction_v1.notes,
          patient_pa_restriction_v1.file_id,
          patient_pa_restriction_v1.record_id
SEGMENTED BY hash(patient_pa_restriction_v1.code, patient_pa_restriction_v1.file_id, patient_pa_restriction_v1.record_id, patient_pa_restriction_v1.patient_prior_authorization_category, patient_pa_restriction_v1.restriction_detail_id, patient_pa_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.medical_rec_restriction_v1_b0 /*+basename(medical_rec_restriction_v1),createtype(L)*/ 
(
 code,
 medical_records_submission_required_flag,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT medical_rec_restriction_v1.code,
        medical_rec_restriction_v1.medical_records_submission_required_flag,
        medical_rec_restriction_v1.restriction_detail_id,
        medical_rec_restriction_v1.notes,
        medical_rec_restriction_v1.file_id,
        medical_rec_restriction_v1.record_id
 FROM sandbox.medical_rec_restriction_v1
 ORDER BY medical_rec_restriction_v1.code,
          medical_rec_restriction_v1.medical_records_submission_required_flag,
          medical_rec_restriction_v1.restriction_detail_id,
          medical_rec_restriction_v1.notes,
          medical_rec_restriction_v1.file_id,
          medical_rec_restriction_v1.record_id
SEGMENTED BY hash(medical_rec_restriction_v1.code, medical_rec_restriction_v1.file_id, medical_rec_restriction_v1.record_id, medical_rec_restriction_v1.medical_records_submission_required_flag, medical_rec_restriction_v1.restriction_detail_id, medical_rec_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.unspecified_rec_restriction_v1_b0 /*+basename(unspecified_rec_restriction_v1),createtype(L)*/ 
(
 code,
 unspecified_restriction_flag,
 restriction_detail_id,
 notes,
 file_id,
 record_id
)
AS
 SELECT unspecified_rec_restriction_v1.code,
        unspecified_rec_restriction_v1.unspecified_restriction_flag,
        unspecified_rec_restriction_v1.restriction_detail_id,
        unspecified_rec_restriction_v1.notes,
        unspecified_rec_restriction_v1.file_id,
        unspecified_rec_restriction_v1.record_id
 FROM sandbox.unspecified_rec_restriction_v1
 ORDER BY unspecified_rec_restriction_v1.code,
          unspecified_rec_restriction_v1.unspecified_restriction_flag,
          unspecified_rec_restriction_v1.restriction_detail_id,
          unspecified_rec_restriction_v1.notes,
          unspecified_rec_restriction_v1.file_id,
          unspecified_rec_restriction_v1.record_id
SEGMENTED BY hash(unspecified_rec_restriction_v1.code, unspecified_rec_restriction_v1.file_id, unspecified_rec_restriction_v1.record_id, unspecified_rec_restriction_v1.unspecified_restriction_flag, unspecified_rec_restriction_v1.restriction_detail_id, unspecified_rec_restriction_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.override_bridge_ftf_plan_types_v1_b0 /*+basename(override_bridge_ftf_plan_types_v1),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 override_ftf_health_plan_type,
 override_precedence,
 file_id,
 record_id
)
AS
 SELECT override_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex,
        override_bridge_ftf_plan_types_v1.iqvia_payer_name_regex,
        override_bridge_ftf_plan_types_v1.iqvia_plan_name_regex,
        override_bridge_ftf_plan_types_v1.override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v1.override_precedence,
        override_bridge_ftf_plan_types_v1.file_id,
        override_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v1
 ORDER BY override_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex,
          override_bridge_ftf_plan_types_v1.iqvia_payer_name_regex,
          override_bridge_ftf_plan_types_v1.iqvia_plan_name_regex,
          override_bridge_ftf_plan_types_v1.override_ftf_health_plan_type,
          override_bridge_ftf_plan_types_v1.override_precedence,
          override_bridge_ftf_plan_types_v1.file_id,
          override_bridge_ftf_plan_types_v1.record_id
SEGMENTED BY hash(override_bridge_ftf_plan_types_v1.override_precedence, override_bridge_ftf_plan_types_v1.file_id, override_bridge_ftf_plan_types_v1.record_id, override_bridge_ftf_plan_types_v1.iqvia_payer_name_regex, override_bridge_ftf_plan_types_v1.override_ftf_health_plan_type, override_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex, override_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.delete_bridge_ftf_plan_types_v1_b0 /*+basename(delete_bridge_ftf_plan_types_v1),createtype(L)*/ 
(
 ftf_health_plan_name_regex,
 iqvia_payer_name_regex,
 iqvia_plan_name_regex,
 delete_flag,
 file_id,
 record_id
)
AS
 SELECT delete_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex,
        delete_bridge_ftf_plan_types_v1.iqvia_payer_name_regex,
        delete_bridge_ftf_plan_types_v1.iqvia_plan_name_regex,
        delete_bridge_ftf_plan_types_v1.delete_flag,
        delete_bridge_ftf_plan_types_v1.file_id,
        delete_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v1
 ORDER BY delete_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex,
          delete_bridge_ftf_plan_types_v1.iqvia_payer_name_regex,
          delete_bridge_ftf_plan_types_v1.iqvia_plan_name_regex,
          delete_bridge_ftf_plan_types_v1.delete_flag,
          delete_bridge_ftf_plan_types_v1.file_id,
          delete_bridge_ftf_plan_types_v1.record_id
SEGMENTED BY hash(delete_bridge_ftf_plan_types_v1.file_id, delete_bridge_ftf_plan_types_v1.record_id, delete_bridge_ftf_plan_types_v1.iqvia_payer_name_regex, delete_bridge_ftf_plan_types_v1.delete_flag, delete_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex, delete_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) ALL NODES;

CREATE PROJECTION sandbox.ftf_pbm_functions_v1_b0 /*+basename(ftf_pbm_functions_v1),createtype(L)*/ 
(
 pbm_function_id,
 pbm_function,
 notes,
 used,
 file_id,
 record_id
)
AS
 SELECT ftf_pbm_functions_v1.pbm_function_id,
        ftf_pbm_functions_v1.pbm_function,
        ftf_pbm_functions_v1.notes,
        ftf_pbm_functions_v1.used,
        ftf_pbm_functions_v1.file_id,
        ftf_pbm_functions_v1.record_id
 FROM sandbox.ftf_pbm_functions_v1
 ORDER BY ftf_pbm_functions_v1.pbm_function_id,
          ftf_pbm_functions_v1.pbm_function,
          ftf_pbm_functions_v1.notes,
          ftf_pbm_functions_v1.used,
          ftf_pbm_functions_v1.file_id,
          ftf_pbm_functions_v1.record_id
SEGMENTED BY hash(ftf_pbm_functions_v1.pbm_function_id, ftf_pbm_functions_v1.used, ftf_pbm_functions_v1.file_id, ftf_pbm_functions_v1.record_id, ftf_pbm_functions_v1.pbm_function, ftf_pbm_functions_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.has_st_mapping_v1_b0 /*+basename(has_st_mapping_v1),createtype(L)*/ 
(
 has_st,
 st_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_st_mapping_v1.has_st,
        has_st_mapping_v1.st_regex,
        has_st_mapping_v1.notes,
        has_st_mapping_v1.file_id,
        has_st_mapping_v1.record_id
 FROM sandbox.has_st_mapping_v1
 ORDER BY has_st_mapping_v1.has_st,
          has_st_mapping_v1.st_regex,
          has_st_mapping_v1.notes,
          has_st_mapping_v1.file_id,
          has_st_mapping_v1.record_id
SEGMENTED BY hash(has_st_mapping_v1.has_st, has_st_mapping_v1.file_id, has_st_mapping_v1.record_id, has_st_mapping_v1.st_regex, has_st_mapping_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.has_pa_mapping_v1_b0 /*+basename(has_pa_mapping_v1),createtype(L)*/ 
(
 has_pa,
 pa_regex,
 notes,
 file_id,
 record_id
)
AS
 SELECT has_pa_mapping_v1.has_pa,
        has_pa_mapping_v1.pa_regex,
        has_pa_mapping_v1.notes,
        has_pa_mapping_v1.file_id,
        has_pa_mapping_v1.record_id
 FROM sandbox.has_pa_mapping_v1
 ORDER BY has_pa_mapping_v1.has_pa,
          has_pa_mapping_v1.pa_regex,
          has_pa_mapping_v1.notes,
          has_pa_mapping_v1.file_id,
          has_pa_mapping_v1.record_id
SEGMENTED BY hash(has_pa_mapping_v1.has_pa, has_pa_mapping_v1.file_id, has_pa_mapping_v1.record_id, has_pa_mapping_v1.pa_regex, has_pa_mapping_v1.notes) ALL NODES;

CREATE PROJECTION sandbox.calc_pbm_key_pbm_mapping_v1_b0 /*+basename(calc_pbm_key_pbm_mapping_v1),createtype(L)*/ 
(
 calculated_pbm,
 key_pbm,
 added_by,
 file_id,
 record_id
)
AS
 SELECT calc_pbm_key_pbm_mapping_v1.calculated_pbm,
        calc_pbm_key_pbm_mapping_v1.key_pbm,
        calc_pbm_key_pbm_mapping_v1.added_by,
        calc_pbm_key_pbm_mapping_v1.file_id,
        calc_pbm_key_pbm_mapping_v1.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v1
 ORDER BY calc_pbm_key_pbm_mapping_v1.calculated_pbm,
          calc_pbm_key_pbm_mapping_v1.key_pbm,
          calc_pbm_key_pbm_mapping_v1.added_by,
          calc_pbm_key_pbm_mapping_v1.file_id,
          calc_pbm_key_pbm_mapping_v1.record_id
SEGMENTED BY hash(calc_pbm_key_pbm_mapping_v1.file_id, calc_pbm_key_pbm_mapping_v1.record_id, calc_pbm_key_pbm_mapping_v1.calculated_pbm, calc_pbm_key_pbm_mapping_v1.key_pbm, calc_pbm_key_pbm_mapping_v1.added_by) ALL NODES;

CREATE PROJECTION sandbox.calculated_pbm_config_v1_b0 /*+basename(calculated_pbm_config_v1),createtype(L)*/ 
(
 ftf_formulary_management_pbm_regex,
 ftf_formulary_influencer_pbm_regex,
 ftf_claims_processing_pbm_regex,
 calculated_pbm_column,
 file_id,
 record_id
)
AS
 SELECT calculated_pbm_config_v1.ftf_formulary_management_pbm_regex,
        calculated_pbm_config_v1.ftf_formulary_influencer_pbm_regex,
        calculated_pbm_config_v1.ftf_claims_processing_pbm_regex,
        calculated_pbm_config_v1.calculated_pbm_column,
        calculated_pbm_config_v1.file_id,
        calculated_pbm_config_v1.record_id
 FROM sandbox.calculated_pbm_config_v1
 ORDER BY calculated_pbm_config_v1.ftf_formulary_management_pbm_regex,
          calculated_pbm_config_v1.ftf_formulary_influencer_pbm_regex,
          calculated_pbm_config_v1.ftf_claims_processing_pbm_regex,
          calculated_pbm_config_v1.calculated_pbm_column,
          calculated_pbm_config_v1.file_id,
          calculated_pbm_config_v1.record_id
SEGMENTED BY hash(calculated_pbm_config_v1.file_id, calculated_pbm_config_v1.record_id, calculated_pbm_config_v1.ftf_formulary_management_pbm_regex, calculated_pbm_config_v1.ftf_formulary_influencer_pbm_regex, calculated_pbm_config_v1.ftf_claims_processing_pbm_regex, calculated_pbm_config_v1.calculated_pbm_column) ALL NODES;

CREATE PROJECTION sandbox.payer_spine_iqvia_kcf_level_may_b0 /*+basename(payer_spine_iqvia_kcf_level_may),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 apportionment_factor,
 trx
)
AS
 SELECT payer_spine_iqvia_kcf_level_may.iqvia_plan_code,
        payer_spine_iqvia_kcf_level_may.iqvia_plan_name,
        payer_spine_iqvia_kcf_level_may.iqvia_payer_name,
        payer_spine_iqvia_kcf_level_may.iqvia_pbm,
        payer_spine_iqvia_kcf_level_may.payment_type,
        payer_spine_iqvia_kcf_level_may.key_controlling_plan_formulary,
        payer_spine_iqvia_kcf_level_may.key_controlling_account,
        payer_spine_iqvia_kcf_level_may.ajovy_access_for_ftf_plan,
        payer_spine_iqvia_kcf_level_may.aimovig_access_for_ftf_plan,
        payer_spine_iqvia_kcf_level_may.emgality_access_for_ftf_plan,
        payer_spine_iqvia_kcf_level_may.apportionment_factor,
        payer_spine_iqvia_kcf_level_may.trx
 FROM sandbox.payer_spine_iqvia_kcf_level_may
 ORDER BY payer_spine_iqvia_kcf_level_may.iqvia_plan_code,
          payer_spine_iqvia_kcf_level_may.iqvia_plan_name,
          payer_spine_iqvia_kcf_level_may.iqvia_payer_name,
          payer_spine_iqvia_kcf_level_may.iqvia_pbm,
          payer_spine_iqvia_kcf_level_may.payment_type,
          payer_spine_iqvia_kcf_level_may.key_controlling_plan_formulary,
          payer_spine_iqvia_kcf_level_may.key_controlling_account,
          payer_spine_iqvia_kcf_level_may.ajovy_access_for_ftf_plan
SEGMENTED BY hash(payer_spine_iqvia_kcf_level_may.iqvia_plan_code, payer_spine_iqvia_kcf_level_may.apportionment_factor, payer_spine_iqvia_kcf_level_may.trx, payer_spine_iqvia_kcf_level_may.iqvia_plan_name, payer_spine_iqvia_kcf_level_may.iqvia_payer_name, payer_spine_iqvia_kcf_level_may.iqvia_pbm, payer_spine_iqvia_kcf_level_may.payment_type, payer_spine_iqvia_kcf_level_may.key_controlling_plan_formulary) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_formularies_v5_b0 /*+basename(raw_ftf_formularies_v5),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status
)
AS
 SELECT raw_ftf_formularies_v5.health_plan_id,
        raw_ftf_formularies_v5.drug_id,
        raw_ftf_formularies_v5.tier_code,
        raw_ftf_formularies_v5.restrictions,
        raw_ftf_formularies_v5.reason_code,
        raw_ftf_formularies_v5.reason_code_description,
        raw_ftf_formularies_v5.pharmacy_status
 FROM sandbox.raw_ftf_formularies_v5
 ORDER BY raw_ftf_formularies_v5.health_plan_id,
          raw_ftf_formularies_v5.drug_id,
          raw_ftf_formularies_v5.tier_code,
          raw_ftf_formularies_v5.restrictions,
          raw_ftf_formularies_v5.reason_code,
          raw_ftf_formularies_v5.reason_code_description,
          raw_ftf_formularies_v5.pharmacy_status
SEGMENTED BY hash(raw_ftf_formularies_v5.health_plan_id, raw_ftf_formularies_v5.drug_id, raw_ftf_formularies_v5.tier_code, raw_ftf_formularies_v5.restrictions, raw_ftf_formularies_v5.pharmacy_status, raw_ftf_formularies_v5.reason_code, raw_ftf_formularies_v5.reason_code_description) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plans_v5_b0 /*+basename(raw_ftf_health_plans_v5),createtype(L)*/ 
(
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier
)
AS
 SELECT raw_ftf_health_plans_v5.formularyf_id,
        raw_ftf_health_plans_v5.provider_id,
        raw_ftf_health_plans_v5.provider,
        raw_ftf_health_plans_v5.health_plan_id,
        raw_ftf_health_plans_v5.health_plan,
        raw_ftf_health_plans_v5.parent_id,
        raw_ftf_health_plans_v5.parent,
        raw_ftf_health_plans_v5.national_lives_count,
        raw_ftf_health_plans_v5.plan_type_name,
        raw_ftf_health_plans_v5.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_v5
 ORDER BY raw_ftf_health_plans_v5.formularyf_id,
          raw_ftf_health_plans_v5.provider_id,
          raw_ftf_health_plans_v5.provider,
          raw_ftf_health_plans_v5.health_plan_id,
          raw_ftf_health_plans_v5.health_plan,
          raw_ftf_health_plans_v5.parent_id,
          raw_ftf_health_plans_v5.parent,
          raw_ftf_health_plans_v5.national_lives_count
SEGMENTED BY hash(raw_ftf_health_plans_v5.national_lives_count, raw_ftf_health_plans_v5.formularyf_id, raw_ftf_health_plans_v5.provider_id, raw_ftf_health_plans_v5.health_plan_id, raw_ftf_health_plans_v5.parent_id, raw_ftf_health_plans_v5.preferred_brand_tier, raw_ftf_health_plans_v5.health_plan, raw_ftf_health_plans_v5.provider) ALL NODES;

CREATE PROJECTION sandbox.saba_mkt_ajovy_payer_spine_prod_list_b0 /*+basename(saba_mkt_ajovy_payer_spine_prod_list),createtype(L)*/ 
(
 product_name,
 notes,
 file_id,
 record_id
)
AS
 SELECT saba_mkt_ajovy_payer_spine_prod_list.product_name,
        saba_mkt_ajovy_payer_spine_prod_list.notes,
        saba_mkt_ajovy_payer_spine_prod_list.file_id,
        saba_mkt_ajovy_payer_spine_prod_list.record_id
 FROM sandbox.saba_mkt_ajovy_payer_spine_prod_list
 ORDER BY saba_mkt_ajovy_payer_spine_prod_list.product_name,
          saba_mkt_ajovy_payer_spine_prod_list.notes,
          saba_mkt_ajovy_payer_spine_prod_list.file_id,
          saba_mkt_ajovy_payer_spine_prod_list.record_id
SEGMENTED BY hash(saba_mkt_ajovy_payer_spine_prod_list.file_id, saba_mkt_ajovy_payer_spine_prod_list.record_id, saba_mkt_ajovy_payer_spine_prod_list.product_name, saba_mkt_ajovy_payer_spine_prod_list.notes) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_health_plan_geography_v5_b0 /*+basename(raw_ftf_health_plan_geography_v5),createtype(L)*/ 
(
 health_plan_id,
 county_fips_id,
 county_id,
 county_name,
 state_id,
 state_name,
 county_lives
)
AS
 SELECT raw_ftf_health_plan_geography_v5.health_plan_id,
        raw_ftf_health_plan_geography_v5.county_fips_id,
        raw_ftf_health_plan_geography_v5.county_id,
        raw_ftf_health_plan_geography_v5.county_name,
        raw_ftf_health_plan_geography_v5.state_id,
        raw_ftf_health_plan_geography_v5.state_name,
        raw_ftf_health_plan_geography_v5.county_lives
 FROM sandbox.raw_ftf_health_plan_geography_v5
 ORDER BY raw_ftf_health_plan_geography_v5.health_plan_id,
          raw_ftf_health_plan_geography_v5.county_fips_id,
          raw_ftf_health_plan_geography_v5.county_id,
          raw_ftf_health_plan_geography_v5.county_name,
          raw_ftf_health_plan_geography_v5.state_id,
          raw_ftf_health_plan_geography_v5.state_name,
          raw_ftf_health_plan_geography_v5.county_lives
SEGMENTED BY hash(raw_ftf_health_plan_geography_v5.county_fips_id, raw_ftf_health_plan_geography_v5.county_id, raw_ftf_health_plan_geography_v5.state_id, raw_ftf_health_plan_geography_v5.county_lives, raw_ftf_health_plan_geography_v5.health_plan_id, raw_ftf_health_plan_geography_v5.county_name, raw_ftf_health_plan_geography_v5.state_name) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_pbms_v5_b0 /*+basename(raw_ftf_pbms_v5),createtype(L)*/ 
(
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function
)
AS
 SELECT raw_ftf_pbms_v5.health_plan_id,
        raw_ftf_pbms_v5.pbm_id,
        raw_ftf_pbms_v5.pbm,
        raw_ftf_pbms_v5.pbm_function_id,
        raw_ftf_pbms_v5.pbm_function
 FROM sandbox.raw_ftf_pbms_v5
 ORDER BY raw_ftf_pbms_v5.health_plan_id,
          raw_ftf_pbms_v5.pbm_id,
          raw_ftf_pbms_v5.pbm,
          raw_ftf_pbms_v5.pbm_function_id,
          raw_ftf_pbms_v5.pbm_function
SEGMENTED BY hash(raw_ftf_pbms_v5.health_plan_id, raw_ftf_pbms_v5.pbm_id, raw_ftf_pbms_v5.pbm_function_id, raw_ftf_pbms_v5.pbm, raw_ftf_pbms_v5.pbm_function) ALL NODES;

CREATE PROJECTION sandbox.raw_ftf_restrictions_v5_b0 /*+basename(raw_ftf_restrictions_v5),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_details_id,
 restriction_details_text,
 restriction_details_information_1,
 restriction_details_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level
)
AS
 SELECT raw_ftf_restrictions_v5.health_plan_id,
        raw_ftf_restrictions_v5.drug_id,
        raw_ftf_restrictions_v5.restriction_code,
        raw_ftf_restrictions_v5.restriction_details_id,
        raw_ftf_restrictions_v5.restriction_details_text,
        raw_ftf_restrictions_v5.restriction_details_information_1,
        raw_ftf_restrictions_v5.restriction_details_information_2,
        raw_ftf_restrictions_v5.step_count,
        raw_ftf_restrictions_v5.pa_form,
        raw_ftf_restrictions_v5.indication,
        raw_ftf_restrictions_v5.grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_v5
 ORDER BY raw_ftf_restrictions_v5.health_plan_id,
          raw_ftf_restrictions_v5.drug_id,
          raw_ftf_restrictions_v5.restriction_code,
          raw_ftf_restrictions_v5.restriction_details_id,
          raw_ftf_restrictions_v5.restriction_details_text,
          raw_ftf_restrictions_v5.restriction_details_information_1,
          raw_ftf_restrictions_v5.restriction_details_information_2,
          raw_ftf_restrictions_v5.step_count
SEGMENTED BY hash(raw_ftf_restrictions_v5.health_plan_id, raw_ftf_restrictions_v5.drug_id, raw_ftf_restrictions_v5.step_count, raw_ftf_restrictions_v5.restriction_details_id, raw_ftf_restrictions_v5.indication, raw_ftf_restrictions_v5.grouped_restriction_level, raw_ftf_restrictions_v5.restriction_code, raw_ftf_restrictions_v5.restriction_details_text) ALL NODES;

CREATE PROJECTION sandbox.raw_teva_ims_bridge_v5_b0 /*+basename(raw_teva_ims_bridge_v5),createtype(L)*/ 
(
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name
)
AS
 SELECT raw_teva_ims_bridge_v5.payer_name,
        raw_teva_ims_bridge_v5.code,
        raw_teva_ims_bridge_v5.name,
        raw_teva_ims_bridge_v5.state,
        raw_teva_ims_bridge_v5.comments,
        raw_teva_ims_bridge_v5.plan_id,
        raw_teva_ims_bridge_v5.plan_name,
        raw_teva_ims_bridge_v5.provider_name,
        raw_teva_ims_bridge_v5.plan_type_name
 FROM sandbox.raw_teva_ims_bridge_v5
 ORDER BY raw_teva_ims_bridge_v5.payer_name,
          raw_teva_ims_bridge_v5.code,
          raw_teva_ims_bridge_v5.name,
          raw_teva_ims_bridge_v5.state,
          raw_teva_ims_bridge_v5.comments,
          raw_teva_ims_bridge_v5.plan_id,
          raw_teva_ims_bridge_v5.plan_name,
          raw_teva_ims_bridge_v5.provider_name
SEGMENTED BY hash(raw_teva_ims_bridge_v5.payer_name, raw_teva_ims_bridge_v5.code, raw_teva_ims_bridge_v5.name, raw_teva_ims_bridge_v5.state, raw_teva_ims_bridge_v5.comments, raw_teva_ims_bridge_v5.plan_id, raw_teva_ims_bridge_v5.plan_type_name, raw_teva_ims_bridge_v5.plan_name) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_plan_v5_b0 /*+basename(raw_iqvia_plan_v5),createtype(L)*/ 
(
 payer_id,
 payer_name,
 plan_id,
 payer_plan_id,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data
)
AS
 SELECT raw_iqvia_plan_v5.payer_id,
        raw_iqvia_plan_v5.payer_name,
        raw_iqvia_plan_v5.plan_id,
        raw_iqvia_plan_v5.payer_plan_id,
        raw_iqvia_plan_v5.plan_name,
        raw_iqvia_plan_v5.model,
        raw_iqvia_plan_v5.city,
        raw_iqvia_plan_v5.hq_state,
        raw_iqvia_plan_v5.operating_state,
        raw_iqvia_plan_v5.months_with_data
 FROM sandbox.raw_iqvia_plan_v5
 ORDER BY raw_iqvia_plan_v5.payer_id,
          raw_iqvia_plan_v5.payer_name,
          raw_iqvia_plan_v5.plan_id,
          raw_iqvia_plan_v5.payer_plan_id,
          raw_iqvia_plan_v5.plan_name,
          raw_iqvia_plan_v5.model,
          raw_iqvia_plan_v5.city,
          raw_iqvia_plan_v5.hq_state
SEGMENTED BY hash(raw_iqvia_plan_v5.payer_id, raw_iqvia_plan_v5.plan_id, raw_iqvia_plan_v5.payer_plan_id, raw_iqvia_plan_v5.plan_name, raw_iqvia_plan_v5.model, raw_iqvia_plan_v5.city, raw_iqvia_plan_v5.hq_state, raw_iqvia_plan_v5.operating_state) ALL NODES;

CREATE PROJECTION sandbox.raw_iqvia_pbm_v5_b0 /*+basename(raw_iqvia_pbm_v5),createtype(L)*/ 
(
 pbm_name,
 payer_plan_id,
 xref_to_payer_plan_id,
 ipd_id,
 ipd_type,
 plan_name,
 pbm_id,
 ims_processor_number
)
AS
 SELECT raw_iqvia_pbm_v5.pbm_name,
        raw_iqvia_pbm_v5.payer_plan_id,
        raw_iqvia_pbm_v5.xref_to_payer_plan_id,
        raw_iqvia_pbm_v5.ipd_id,
        raw_iqvia_pbm_v5.ipd_type,
        raw_iqvia_pbm_v5.plan_name,
        raw_iqvia_pbm_v5.pbm_id,
        raw_iqvia_pbm_v5.ims_processor_number
 FROM sandbox.raw_iqvia_pbm_v5
 ORDER BY raw_iqvia_pbm_v5.pbm_name,
          raw_iqvia_pbm_v5.payer_plan_id,
          raw_iqvia_pbm_v5.xref_to_payer_plan_id,
          raw_iqvia_pbm_v5.ipd_id,
          raw_iqvia_pbm_v5.ipd_type,
          raw_iqvia_pbm_v5.plan_name,
          raw_iqvia_pbm_v5.pbm_id,
          raw_iqvia_pbm_v5.ims_processor_number
SEGMENTED BY hash(raw_iqvia_pbm_v5.pbm_name, raw_iqvia_pbm_v5.payer_plan_id, raw_iqvia_pbm_v5.xref_to_payer_plan_id, raw_iqvia_pbm_v5.ipd_id, raw_iqvia_pbm_v5.ipd_type, raw_iqvia_pbm_v5.plan_name, raw_iqvia_pbm_v5.pbm_id, raw_iqvia_pbm_v5.ims_processor_number) ALL NODES;

CREATE PROJECTION sandbox.payer_spine25_detailed_teva_brands_b0 /*+basename(payer_spine25_detailed_teva_brands),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 payment_type,
 Ajovy_access_for_ftf_plan,
 Aimovig_access_for_ftf_plan,
 Emgality_access_for_ftf_plan,
 lives_plan_kcf_lvl,
 lives_plan_lvl,
 apportionment_factor,
 saba_trx,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT payer_spine25_detailed_teva_brands.iqvia_plan_code,
        payer_spine25_detailed_teva_brands.iqvia_plan_name,
        payer_spine25_detailed_teva_brands.iqvia_payer_name,
        payer_spine25_detailed_teva_brands.iqvia_pbm,
        payer_spine25_detailed_teva_brands.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands.key_controlling_account,
        payer_spine25_detailed_teva_brands.key_controlling_parent,
        payer_spine25_detailed_teva_brands.payer_pbm,
        payer_spine25_detailed_teva_brands.payment_type,
        payer_spine25_detailed_teva_brands.Ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands.Aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands.Emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands.lives_plan_lvl,
        payer_spine25_detailed_teva_brands.apportionment_factor,
        payer_spine25_detailed_teva_brands.saba_trx,
        payer_spine25_detailed_teva_brands.cycle_id,
        payer_spine25_detailed_teva_brands.modified_time,
        payer_spine25_detailed_teva_brands.modified_by
 FROM sandbox.payer_spine25_detailed_teva_brands
 ORDER BY payer_spine25_detailed_teva_brands.iqvia_plan_code,
          payer_spine25_detailed_teva_brands.iqvia_plan_name,
          payer_spine25_detailed_teva_brands.iqvia_payer_name,
          payer_spine25_detailed_teva_brands.iqvia_pbm,
          payer_spine25_detailed_teva_brands.key_controlling_plan_formulary,
          payer_spine25_detailed_teva_brands.key_controlling_account,
          payer_spine25_detailed_teva_brands.key_controlling_parent,
          payer_spine25_detailed_teva_brands.payer_pbm
SEGMENTED BY hash(payer_spine25_detailed_teva_brands.iqvia_plan_code, payer_spine25_detailed_teva_brands.key_controlling_plan_formulary) ALL NODES;

CREATE PROJECTION sandbox.comparison_payer_spine_detailed_kcf_b0 /*+basename(comparison_payer_spine_detailed_kcf),createtype(A)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 key_controlling_plan_formulary,
 iqvia_payer_name,
 iqvia_pbm,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 payment_type,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 apportionment_factor,
 saba_trx,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_payment_type,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_apportionment_factor,
 change_saba_trx,
 change,
 month_flag,
 status,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT comparison_payer_spine_detailed_kcf.iqvia_plan_code,
        comparison_payer_spine_detailed_kcf.iqvia_plan_name,
        comparison_payer_spine_detailed_kcf.key_controlling_plan_formulary,
        comparison_payer_spine_detailed_kcf.iqvia_payer_name,
        comparison_payer_spine_detailed_kcf.iqvia_pbm,
        comparison_payer_spine_detailed_kcf.key_controlling_account,
        comparison_payer_spine_detailed_kcf.key_controlling_parent,
        comparison_payer_spine_detailed_kcf.payer_pbm,
        comparison_payer_spine_detailed_kcf.payment_type,
        comparison_payer_spine_detailed_kcf.ajovy_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.aimovig_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.emgality_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.apportionment_factor,
        comparison_payer_spine_detailed_kcf.saba_trx,
        comparison_payer_spine_detailed_kcf.change_iqvia_plan_code,
        comparison_payer_spine_detailed_kcf.change_iqvia_plan_name,
        comparison_payer_spine_detailed_kcf.change_iqvia_payer_name,
        comparison_payer_spine_detailed_kcf.change_iqvia_pbm,
        comparison_payer_spine_detailed_kcf.change_key_controlling_plan_formulary,
        comparison_payer_spine_detailed_kcf.change_key_controlling_account,
        comparison_payer_spine_detailed_kcf.change_key_controlling_parent,
        comparison_payer_spine_detailed_kcf.change_payer_pbm,
        comparison_payer_spine_detailed_kcf.change_payment_type,
        comparison_payer_spine_detailed_kcf.change_ajovy_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.change_aimovig_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.change_emgality_access_for_ftf_plan,
        comparison_payer_spine_detailed_kcf.change_apportionment_factor,
        comparison_payer_spine_detailed_kcf.change_saba_trx,
        comparison_payer_spine_detailed_kcf.change,
        comparison_payer_spine_detailed_kcf.month_flag,
        comparison_payer_spine_detailed_kcf.status,
        comparison_payer_spine_detailed_kcf.cycle_id,
        comparison_payer_spine_detailed_kcf.modified_time,
        comparison_payer_spine_detailed_kcf.modified_by
 FROM sandbox.comparison_payer_spine_detailed_kcf
 ORDER BY comparison_payer_spine_detailed_kcf.iqvia_plan_code,
          comparison_payer_spine_detailed_kcf.iqvia_plan_name,
          comparison_payer_spine_detailed_kcf.key_controlling_plan_formulary,
          comparison_payer_spine_detailed_kcf.iqvia_payer_name,
          comparison_payer_spine_detailed_kcf.iqvia_pbm,
          comparison_payer_spine_detailed_kcf.key_controlling_account,
          comparison_payer_spine_detailed_kcf.key_controlling_parent,
          comparison_payer_spine_detailed_kcf.payer_pbm,
          comparison_payer_spine_detailed_kcf.payment_type,
          comparison_payer_spine_detailed_kcf.ajovy_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.aimovig_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.emgality_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.apportionment_factor,
          comparison_payer_spine_detailed_kcf.saba_trx,
          comparison_payer_spine_detailed_kcf.change_iqvia_plan_code,
          comparison_payer_spine_detailed_kcf.change_iqvia_plan_name,
          comparison_payer_spine_detailed_kcf.change_iqvia_payer_name,
          comparison_payer_spine_detailed_kcf.change_iqvia_pbm,
          comparison_payer_spine_detailed_kcf.change_key_controlling_plan_formulary,
          comparison_payer_spine_detailed_kcf.change_key_controlling_account,
          comparison_payer_spine_detailed_kcf.change_key_controlling_parent,
          comparison_payer_spine_detailed_kcf.change_payer_pbm,
          comparison_payer_spine_detailed_kcf.change_payment_type,
          comparison_payer_spine_detailed_kcf.change_ajovy_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.change_aimovig_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.change_emgality_access_for_ftf_plan,
          comparison_payer_spine_detailed_kcf.change_apportionment_factor,
          comparison_payer_spine_detailed_kcf.change_saba_trx,
          comparison_payer_spine_detailed_kcf.change,
          comparison_payer_spine_detailed_kcf.month_flag,
          comparison_payer_spine_detailed_kcf.status
SEGMENTED BY hash(comparison_payer_spine_detailed_kcf.iqvia_plan_code, comparison_payer_spine_detailed_kcf.iqvia_plan_name, comparison_payer_spine_detailed_kcf.key_controlling_plan_formulary, comparison_payer_spine_detailed_kcf.iqvia_payer_name, comparison_payer_spine_detailed_kcf.iqvia_pbm, comparison_payer_spine_detailed_kcf.key_controlling_account, comparison_payer_spine_detailed_kcf.key_controlling_parent, comparison_payer_spine_detailed_kcf.payer_pbm, comparison_payer_spine_detailed_kcf.payment_type, comparison_payer_spine_detailed_kcf.ajovy_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.aimovig_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.emgality_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.apportionment_factor, comparison_payer_spine_detailed_kcf.saba_trx, comparison_payer_spine_detailed_kcf.change_iqvia_plan_code, comparison_payer_spine_detailed_kcf.change_iqvia_plan_name, comparison_payer_spine_detailed_kcf.change_iqvia_payer_name, comparison_payer_spine_detailed_kcf.change_iqvia_pbm, comparison_payer_spine_detailed_kcf.change_key_controlling_plan_formulary, comparison_payer_spine_detailed_kcf.change_key_controlling_account, comparison_payer_spine_detailed_kcf.change_key_controlling_parent, comparison_payer_spine_detailed_kcf.change_payer_pbm, comparison_payer_spine_detailed_kcf.change_payment_type, comparison_payer_spine_detailed_kcf.change_ajovy_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.change_aimovig_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.change_emgality_access_for_ftf_plan, comparison_payer_spine_detailed_kcf.change_apportionment_factor, comparison_payer_spine_detailed_kcf.change_saba_trx, comparison_payer_spine_detailed_kcf.change, comparison_payer_spine_detailed_kcf.month_flag, comparison_payer_spine_detailed_kcf.status) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_xref_cdw_v1_b0 /*+basename(ftf_iqvia_xref_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 xref_iqvia_payer_name,
 best_matched_iqvia_payer_name,
 xref_iqvia_pbm,
 best_matched_iqvia_pbm,
 paytype,
 model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 ftf_pref_brand_tier,
 total_lives_for_ftf_plan,
 key_pbm,
 check_iq_payer,
 check_iq_pbm,
 cycle_id,
 modified_time,
 modified_by,
 nurtec_access_for_ftf_plan,
 qulipta_access_for_ftf_plan,
 austedo_hd_access_for_ftf_plan,
 austedo_td_access_for_ftf_plan,
 ingrezza_td_access_for_ftf_plan
)
AS
 SELECT ftf_iqvia_xref_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.paytype,
        ftf_iqvia_xref_cdw_v1.model,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_cdw_v1.payer_pbm,
        ftf_iqvia_xref_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.key_pbm,
        ftf_iqvia_xref_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_cdw_v1.cycle_id,
        ftf_iqvia_xref_cdw_v1.modified_time,
        ftf_iqvia_xref_cdw_v1.modified_by,
        ftf_iqvia_xref_cdw_v1.nurtec_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.qulipta_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.austedo_hd_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.austedo_td_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.ingrezza_td_access_for_ftf_plan
 FROM sandbox.ftf_iqvia_xref_cdw_v1
 ORDER BY ftf_iqvia_xref_cdw_v1.cycle_id
SEGMENTED BY hash(ftf_iqvia_xref_cdw_v1.iqvia_plan_code, ftf_iqvia_xref_cdw_v1.ftf_health_plan_fid, ftf_iqvia_xref_cdw_v1.ftf_provider_fid, ftf_iqvia_xref_cdw_v1.ftf_pref_brand_tier, ftf_iqvia_xref_cdw_v1.total_lives_for_ftf_plan, ftf_iqvia_xref_cdw_v1.check_iq_payer, ftf_iqvia_xref_cdw_v1.check_iq_pbm, ftf_iqvia_xref_cdw_v1.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_iqvia_xref_v2_cdw_v1_b0 /*+basename(ftf_iqvia_xref_v2_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 ftf_pref_brand_tier,
 total_lives_for_ftf_plan,
 key_pbm,
 check_iq_payer,
 check_iq_pbm,
 cycle_id,
 modified_time,
 modified_by,
 nurtec_access_for_ftf_plan,
 qulipta_access_for_ftf_plan,
 austedo_hd_access_for_ftf_plan,
 austedo_td_access_for_ftf_plan,
 ingrezza_td_access_for_ftf_plan
)
AS
 SELECT ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_payer_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_pbm,
        ftf_iqvia_xref_v2_cdw_v1.payment_type,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_model,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_v2_cdw_v1.payer_pbm,
        ftf_iqvia_xref_v2_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_v2_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.key_pbm,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_v2_cdw_v1.cycle_id,
        ftf_iqvia_xref_v2_cdw_v1.modified_time,
        ftf_iqvia_xref_v2_cdw_v1.modified_by,
        ftf_iqvia_xref_v2_cdw_v1.nurtec_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.qulipta_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.austedo_hd_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.austedo_td_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.ingrezza_td_access_for_ftf_plan
 FROM sandbox.ftf_iqvia_xref_v2_cdw_v1
 ORDER BY ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_code,
          ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_name,
          ftf_iqvia_xref_v2_cdw_v1.iqvia_payer_name,
          ftf_iqvia_xref_v2_cdw_v1.iqvia_pbm,
          ftf_iqvia_xref_v2_cdw_v1.payment_type,
          ftf_iqvia_xref_v2_cdw_v1.iqvia_model,
          ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_fid,
          ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_name
SEGMENTED BY hash(ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_code, ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_fid, ftf_iqvia_xref_v2_cdw_v1.ftf_provider_fid, ftf_iqvia_xref_v2_cdw_v1.ftf_pref_brand_tier, ftf_iqvia_xref_v2_cdw_v1.total_lives_for_ftf_plan, ftf_iqvia_xref_v2_cdw_v1.check_iq_payer, ftf_iqvia_xref_v2_cdw_v1.check_iq_pbm, ftf_iqvia_xref_v2_cdw_v1.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1_b0 /*+basename(iqvia_plan_code_ftf_hp_id_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by,
 nurtec_access_for_ftf_plan,
 qulipta_access_for_ftf_plan,
 austedo_hd_access_for_ftf_plan,
 austedo_td_access_for_ftf_plan,
 ingrezza_td_access_for_ftf_plan
)
AS
 SELECT iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_by,
        iqvia_plan_code_ftf_hp_id_cdw_v1.nurtec_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.qulipta_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_hd_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_td_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ingrezza_td_access_for_ftf_plan
 FROM sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
 ORDER BY iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
          iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
          iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
          iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
          iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
          iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
          iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
          iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name
SEGMENTED BY hash(iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code, iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid, iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan, iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id, iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time, iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type, iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model, iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type) ALL NODES;

CREATE PROJECTION sandbox.comparison_iqvia_fid_plans_cdw_v1_b0 /*+basename(comparison_iqvia_fid_plans_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 ftf_health_plan_fid,
 ftf_health_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 payment_type,
 iqvia_model,
 ftf_health_plan_type,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 total_lives_for_ftf_plan,
 key_pbm,
 change_iqvia_plan_code,
 change_iqvia_plan_name,
 change_iqvia_payer_name,
 change_iqvia_pbm,
 change_payment_type,
 change_iqvia_model,
 change_ftf_health_plan_fid,
 change_ftf_health_plan_name,
 change_ftf_health_plan_type,
 change_key_controlling_plan_formulary,
 change_key_controlling_account,
 change_key_controlling_parent,
 change_payer_pbm,
 change_ajovy_access_for_ftf_plan,
 change_aimovig_access_for_ftf_plan,
 change_emgality_access_for_ftf_plan,
 change_total_lives_for_ftf_plan,
 change_key_pbm,
 change,
 check_iq_payer,
 check_iq_pbm,
 change_in_lives,
 month_flag,
 status,
 cycle_id,
 modified_time,
 modified_by,
 nurtec_access_for_ftf_plan,
 qulipta_access_for_ftf_plan,
 change_nurtec_access_for_ftf_plan,
 change_qulipta_access_for_ftf_plan
)
AS
 SELECT comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.payment_type,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_payment_type,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.change_payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_payer,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_in_lives,
        comparison_iqvia_fid_plans_cdw_v1.month_flag,
        comparison_iqvia_fid_plans_cdw_v1.status,
        comparison_iqvia_fid_plans_cdw_v1.cycle_id,
        comparison_iqvia_fid_plans_cdw_v1.modified_time,
        comparison_iqvia_fid_plans_cdw_v1.modified_by,
        comparison_iqvia_fid_plans_cdw_v1.nurtec_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.qulipta_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_nurtec_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_qulipta_access_for_ftf_plan
 FROM sandbox.comparison_iqvia_fid_plans_cdw_v1
 ORDER BY comparison_iqvia_fid_plans_cdw_v1.cycle_id
SEGMENTED BY hash(comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_code, comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid, comparison_iqvia_fid_plans_cdw_v1.total_lives_for_ftf_plan, comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_code, comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_name, comparison_iqvia_fid_plans_cdw_v1.change_iqvia_payer_name, comparison_iqvia_fid_plans_cdw_v1.change_iqvia_pbm, comparison_iqvia_fid_plans_cdw_v1.change_payment_type) ALL NODES;

CREATE PROJECTION sandbox.key_ctl_account_summary_cdw_v1_b0 /*+basename(key_ctl_account_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT key_ctl_account_summary_cdw_v1.paytype,
        key_ctl_account_summary_cdw_v1.ftf_health_plan_type,
        key_ctl_account_summary_cdw_v1.key_controlling_account,
        key_ctl_account_summary_cdw_v1.current_month_lives,
        key_ctl_account_summary_cdw_v1.previous_month_lives,
        key_ctl_account_summary_cdw_v1.cycle_id,
        key_ctl_account_summary_cdw_v1.modified_time,
        key_ctl_account_summary_cdw_v1.modified_by
 FROM sandbox.key_ctl_account_summary_cdw_v1
 ORDER BY key_ctl_account_summary_cdw_v1.paytype,
          key_ctl_account_summary_cdw_v1.ftf_health_plan_type,
          key_ctl_account_summary_cdw_v1.key_controlling_account
SEGMENTED BY hash(key_ctl_account_summary_cdw_v1.current_month_lives, key_ctl_account_summary_cdw_v1.previous_month_lives, key_ctl_account_summary_cdw_v1.cycle_id, key_ctl_account_summary_cdw_v1.modified_time, key_ctl_account_summary_cdw_v1.paytype, key_ctl_account_summary_cdw_v1.modified_by, key_ctl_account_summary_cdw_v1.ftf_health_plan_type, key_ctl_account_summary_cdw_v1.key_controlling_account) ALL NODES;

CREATE PROJECTION sandbox.key_pbm_summary_cdw_v1_b0 /*+basename(key_pbm_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 ftf_health_plan_type,
 key_pbm,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT key_pbm_summary_cdw_v1.paytype,
        key_pbm_summary_cdw_v1.ftf_health_plan_type,
        key_pbm_summary_cdw_v1.key_pbm,
        key_pbm_summary_cdw_v1.current_month_lives,
        key_pbm_summary_cdw_v1.previous_month_lives,
        key_pbm_summary_cdw_v1.cycle_id,
        key_pbm_summary_cdw_v1.modified_time,
        key_pbm_summary_cdw_v1.modified_by
 FROM sandbox.key_pbm_summary_cdw_v1
 ORDER BY key_pbm_summary_cdw_v1.paytype,
          key_pbm_summary_cdw_v1.ftf_health_plan_type,
          key_pbm_summary_cdw_v1.key_pbm
SEGMENTED BY hash(key_pbm_summary_cdw_v1.current_month_lives, key_pbm_summary_cdw_v1.previous_month_lives, key_pbm_summary_cdw_v1.cycle_id, key_pbm_summary_cdw_v1.modified_time, key_pbm_summary_cdw_v1.paytype, key_pbm_summary_cdw_v1.modified_by, key_pbm_summary_cdw_v1.ftf_health_plan_type, key_pbm_summary_cdw_v1.key_pbm) ALL NODES;

CREATE PROJECTION sandbox.iqvia_payer_name_summary_cdw_v1_b0 /*+basename(iqvia_payer_name_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 iqvia_payer_name,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_payer_name_summary_cdw_v1.paytype,
        iqvia_payer_name_summary_cdw_v1.iqvia_payer_name,
        iqvia_payer_name_summary_cdw_v1.current_month_lives,
        iqvia_payer_name_summary_cdw_v1.previous_month_lives,
        iqvia_payer_name_summary_cdw_v1.cycle_id,
        iqvia_payer_name_summary_cdw_v1.modified_time,
        iqvia_payer_name_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_payer_name_summary_cdw_v1
 ORDER BY iqvia_payer_name_summary_cdw_v1.paytype,
          iqvia_payer_name_summary_cdw_v1.iqvia_payer_name
SEGMENTED BY hash(iqvia_payer_name_summary_cdw_v1.current_month_lives, iqvia_payer_name_summary_cdw_v1.previous_month_lives, iqvia_payer_name_summary_cdw_v1.cycle_id, iqvia_payer_name_summary_cdw_v1.modified_time, iqvia_payer_name_summary_cdw_v1.modified_by, iqvia_payer_name_summary_cdw_v1.paytype, iqvia_payer_name_summary_cdw_v1.iqvia_payer_name) ALL NODES;

CREATE PROJECTION sandbox.iqvia_pbm_summary_cdw_v1_b0 /*+basename(iqvia_pbm_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 iqvia_pbm,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT iqvia_pbm_summary_cdw_v1.paytype,
        iqvia_pbm_summary_cdw_v1.iqvia_pbm,
        iqvia_pbm_summary_cdw_v1.current_month_lives,
        iqvia_pbm_summary_cdw_v1.previous_month_lives,
        iqvia_pbm_summary_cdw_v1.cycle_id,
        iqvia_pbm_summary_cdw_v1.modified_time,
        iqvia_pbm_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_summary_cdw_v1
 ORDER BY iqvia_pbm_summary_cdw_v1.paytype,
          iqvia_pbm_summary_cdw_v1.iqvia_pbm
SEGMENTED BY hash(iqvia_pbm_summary_cdw_v1.current_month_lives, iqvia_pbm_summary_cdw_v1.previous_month_lives, iqvia_pbm_summary_cdw_v1.cycle_id, iqvia_pbm_summary_cdw_v1.modified_time, iqvia_pbm_summary_cdw_v1.modified_by, iqvia_pbm_summary_cdw_v1.paytype, iqvia_pbm_summary_cdw_v1.iqvia_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_formulary_management_pbm_summary_cdw_v1_b0 /*+basename(ftf_formulary_management_pbm_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 ftf_formulary_management_pbm,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formulary_management_pbm_summary_cdw_v1.paytype,
        ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm,
        ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_management_pbm_summary_cdw_v1
 ORDER BY ftf_formulary_management_pbm_summary_cdw_v1.paytype,
          ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm
SEGMENTED BY hash(ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives, ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives, ftf_formulary_management_pbm_summary_cdw_v1.cycle_id, ftf_formulary_management_pbm_summary_cdw_v1.modified_time, ftf_formulary_management_pbm_summary_cdw_v1.modified_by, ftf_formulary_management_pbm_summary_cdw_v1.paytype, ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_formulary_influencer_pbm_summary_cdw_v1_b0 /*+basename(ftf_formulary_influencer_pbm_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 ftf_formulary_influencer_pbm,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formulary_influencer_pbm_summary_cdw_v1.paytype,
        ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_influencer_pbm_summary_cdw_v1
 ORDER BY ftf_formulary_influencer_pbm_summary_cdw_v1.paytype,
          ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm
SEGMENTED BY hash(ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives, ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives, ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id, ftf_formulary_influencer_pbm_summary_cdw_v1.modified_time, ftf_formulary_influencer_pbm_summary_cdw_v1.modified_by, ftf_formulary_influencer_pbm_summary_cdw_v1.paytype, ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_claims_processing_pbm_summary_cdw_v1_b0 /*+basename(ftf_claims_processing_pbm_summary_cdw_v1),createtype(L)*/ 
(
 paytype,
 ftf_claims_processing_pbm,
 current_month_lives,
 previous_month_lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_claims_processing_pbm_summary_cdw_v1.paytype,
        ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm,
        ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.cycle_id,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_time,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_claims_processing_pbm_summary_cdw_v1
 ORDER BY ftf_claims_processing_pbm_summary_cdw_v1.paytype,
          ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm
SEGMENTED BY hash(ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives, ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives, ftf_claims_processing_pbm_summary_cdw_v1.cycle_id, ftf_claims_processing_pbm_summary_cdw_v1.modified_time, ftf_claims_processing_pbm_summary_cdw_v1.modified_by, ftf_claims_processing_pbm_summary_cdw_v1.paytype, ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm) ALL NODES;

CREATE PROJECTION sandbox.st_lives_summary_cdw_v1_b0 /*+basename(st_lives_summary_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 ftf_parent_name,
 paytype,
 ftf_health_plan_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 state,
 ftf_state_hp_lives,
 pref_brand_tier,
 ajovy_formulary,
 aimovig_formulary,
 emgality_formulary,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT st_lives_summary_cdw_v1.ftf_health_plan_fid,
        st_lives_summary_cdw_v1.ftf_health_plan_name,
        st_lives_summary_cdw_v1.ftf_provider_name,
        st_lives_summary_cdw_v1.ftf_parent_name,
        st_lives_summary_cdw_v1.paytype,
        st_lives_summary_cdw_v1.ftf_health_plan_type,
        st_lives_summary_cdw_v1.key_controlling_account,
        st_lives_summary_cdw_v1.key_controlling_plan_formulary,
        st_lives_summary_cdw_v1.key_controlling_parent,
        st_lives_summary_cdw_v1.payer_pbm,
        st_lives_summary_cdw_v1.key_pbm,
        st_lives_summary_cdw_v1.iqvia_payer_name,
        st_lives_summary_cdw_v1.iqvia_pbm,
        st_lives_summary_cdw_v1.state,
        st_lives_summary_cdw_v1.ftf_state_hp_lives,
        st_lives_summary_cdw_v1.pref_brand_tier,
        st_lives_summary_cdw_v1.ajovy_formulary,
        st_lives_summary_cdw_v1.aimovig_formulary,
        st_lives_summary_cdw_v1.emgality_formulary,
        st_lives_summary_cdw_v1.cycle_id,
        st_lives_summary_cdw_v1.modified_time,
        st_lives_summary_cdw_v1.modified_by
 FROM sandbox.st_lives_summary_cdw_v1
 ORDER BY st_lives_summary_cdw_v1.cycle_id
SEGMENTED BY hash(st_lives_summary_cdw_v1.ftf_health_plan_fid, st_lives_summary_cdw_v1.ftf_state_hp_lives, st_lives_summary_cdw_v1.pref_brand_tier, st_lives_summary_cdw_v1.cycle_id, st_lives_summary_cdw_v1.modified_time, st_lives_summary_cdw_v1.paytype, st_lives_summary_cdw_v1.ftf_health_plan_type, st_lives_summary_cdw_v1.state) ALL NODES;

CREATE PROJECTION sandbox.ftf_hp_id_key_controlling_account_cdw_v1_b0 /*+basename(ftf_hp_id_key_controlling_account_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 payment_type,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_controlling_account_cdw_v1.payment_type,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent,
        ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.key_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.cycle_id,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_time,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_controlling_account_cdw_v1
 ORDER BY ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid
SEGMENTED BY hash(ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid, ftf_hp_id_key_controlling_account_cdw_v1.cycle_id, ftf_hp_id_key_controlling_account_cdw_v1.modified_time, ftf_hp_id_key_controlling_account_cdw_v1.modified_by, ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name, ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name, ftf_hp_id_key_controlling_account_cdw_v1.payment_type, ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account) ALL NODES;

CREATE PROJECTION sandbox.ftf_hp_id_key_pbm_cdw_v1_b0 /*+basename(ftf_hp_id_key_pbm_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_name,
 payment_type,
 key_pbm,
 assigned_iqvia_pbm,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_pbm_cdw_v1.payment_type,
        ftf_hp_id_key_pbm_cdw_v1.key_pbm,
        ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm,
        ftf_hp_id_key_pbm_cdw_v1.cycle_id,
        ftf_hp_id_key_pbm_cdw_v1.modified_time,
        ftf_hp_id_key_pbm_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_pbm_cdw_v1
 ORDER BY ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid
SEGMENTED BY hash(ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid, ftf_hp_id_key_pbm_cdw_v1.cycle_id, ftf_hp_id_key_pbm_cdw_v1.modified_time, ftf_hp_id_key_pbm_cdw_v1.modified_by, ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name, ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name, ftf_hp_id_key_pbm_cdw_v1.payment_type, ftf_hp_id_key_pbm_cdw_v1.key_pbm) ALL NODES;

CREATE PROJECTION sandbox.ftf_plan_master_file_op_cdw_v1_b0 /*+basename(ftf_plan_master_file_op_cdw_v1),createtype(L)*/ 
(
 ftf_health_plan_fid,
 product,
 ftf_health_plan_name,
 coverage_category,
 ftf_provider_name,
 paytype,
 ftf_health_plan_type,
 plan_lives,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 key_pbm,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 pref_brand_tier,
 pharmacy_status,
 ftf_tier,
 restrictions,
 copay_tier,
 restriction_category,
 step,
 botox,
 prescriber_pa,
 patient_pa,
 medical_records,
 criteria_unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_op_cdw_v1.product,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_op_cdw_v1.coverage_category,
        ftf_plan_master_file_op_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_op_cdw_v1.paytype,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_op_cdw_v1.plan_lives,
        ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_op_cdw_v1.key_controlling_account,
        ftf_plan_master_file_op_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_op_cdw_v1.payer_pbm,
        ftf_plan_master_file_op_cdw_v1.key_pbm,
        ftf_plan_master_file_op_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_op_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_op_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_op_cdw_v1.pharmacy_status,
        ftf_plan_master_file_op_cdw_v1.ftf_tier,
        ftf_plan_master_file_op_cdw_v1.restrictions,
        ftf_plan_master_file_op_cdw_v1.copay_tier,
        ftf_plan_master_file_op_cdw_v1.restriction_category,
        ftf_plan_master_file_op_cdw_v1.step,
        ftf_plan_master_file_op_cdw_v1.botox,
        ftf_plan_master_file_op_cdw_v1.prescriber_pa,
        ftf_plan_master_file_op_cdw_v1.patient_pa,
        ftf_plan_master_file_op_cdw_v1.medical_records,
        ftf_plan_master_file_op_cdw_v1.criteria_unspec,
        ftf_plan_master_file_op_cdw_v1.cycle_id,
        ftf_plan_master_file_op_cdw_v1.modified_time,
        ftf_plan_master_file_op_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_op_cdw_v1
 ORDER BY ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid
SEGMENTED BY hash(ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_coverage_category_cdw_v1_b0 /*+basename(paytype_product_coverage_category_cdw_v1),createtype(L)*/ 
(
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT paytype_product_coverage_category_cdw_v1.paytype,
        paytype_product_coverage_category_cdw_v1.product,
        paytype_product_coverage_category_cdw_v1.metric,
        paytype_product_coverage_category_cdw_v1.lives,
        paytype_product_coverage_category_cdw_v1.cycle_id,
        paytype_product_coverage_category_cdw_v1.modified_time,
        paytype_product_coverage_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_coverage_category_cdw_v1
 ORDER BY paytype_product_coverage_category_cdw_v1.cycle_id
SEGMENTED BY hash(paytype_product_coverage_category_cdw_v1.lives, paytype_product_coverage_category_cdw_v1.cycle_id, paytype_product_coverage_category_cdw_v1.modified_time, paytype_product_coverage_category_cdw_v1.modified_by, paytype_product_coverage_category_cdw_v1.paytype, paytype_product_coverage_category_cdw_v1.product, paytype_product_coverage_category_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_copay_tier_cdw_v1_b0 /*+basename(paytype_product_copay_tier_cdw_v1),createtype(L)*/ 
(
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT paytype_product_copay_tier_cdw_v1.paytype,
        paytype_product_copay_tier_cdw_v1.product,
        paytype_product_copay_tier_cdw_v1.metric,
        paytype_product_copay_tier_cdw_v1.lives,
        paytype_product_copay_tier_cdw_v1.cycle_id,
        paytype_product_copay_tier_cdw_v1.modified_time,
        paytype_product_copay_tier_cdw_v1.modified_by
 FROM sandbox.paytype_product_copay_tier_cdw_v1
 ORDER BY paytype_product_copay_tier_cdw_v1.cycle_id
SEGMENTED BY hash(paytype_product_copay_tier_cdw_v1.lives, paytype_product_copay_tier_cdw_v1.cycle_id, paytype_product_copay_tier_cdw_v1.modified_time, paytype_product_copay_tier_cdw_v1.modified_by, paytype_product_copay_tier_cdw_v1.paytype, paytype_product_copay_tier_cdw_v1.product, paytype_product_copay_tier_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_step_category_cdw_v1_b0 /*+basename(paytype_product_step_category_cdw_v1),createtype(L)*/ 
(
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT paytype_product_step_category_cdw_v1.paytype,
        paytype_product_step_category_cdw_v1.product,
        paytype_product_step_category_cdw_v1.metric,
        paytype_product_step_category_cdw_v1.lives,
        paytype_product_step_category_cdw_v1.cycle_id,
        paytype_product_step_category_cdw_v1.modified_time,
        paytype_product_step_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_step_category_cdw_v1
 ORDER BY paytype_product_step_category_cdw_v1.cycle_id
SEGMENTED BY hash(paytype_product_step_category_cdw_v1.lives, paytype_product_step_category_cdw_v1.cycle_id, paytype_product_step_category_cdw_v1.modified_time, paytype_product_step_category_cdw_v1.modified_by, paytype_product_step_category_cdw_v1.paytype, paytype_product_step_category_cdw_v1.product, paytype_product_step_category_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.paytype_product_patient_pa_cdw_v1_b0 /*+basename(paytype_product_patient_pa_cdw_v1),createtype(L)*/ 
(
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT paytype_product_patient_pa_cdw_v1.paytype,
        paytype_product_patient_pa_cdw_v1.product,
        paytype_product_patient_pa_cdw_v1.metric,
        paytype_product_patient_pa_cdw_v1.lives,
        paytype_product_patient_pa_cdw_v1.cycle_id,
        paytype_product_patient_pa_cdw_v1.modified_time,
        paytype_product_patient_pa_cdw_v1.modified_by
 FROM sandbox.paytype_product_patient_pa_cdw_v1
 ORDER BY paytype_product_patient_pa_cdw_v1.cycle_id
SEGMENTED BY hash(paytype_product_patient_pa_cdw_v1.lives, paytype_product_patient_pa_cdw_v1.cycle_id, paytype_product_patient_pa_cdw_v1.modified_time, paytype_product_patient_pa_cdw_v1.modified_by, paytype_product_patient_pa_cdw_v1.paytype, paytype_product_patient_pa_cdw_v1.product, paytype_product_patient_pa_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.key_controlling_account_product_cov_category_paytype_cdw_v1_b0 /*+basename(key_controlling_account_product_cov_category_paytype_cdw_v1),createtype(L)*/ 
(
 key_controlling_account,
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account,
        key_controlling_account_product_cov_category_paytype_cdw_v1.paytype,
        key_controlling_account_product_cov_category_paytype_cdw_v1.product,
        key_controlling_account_product_cov_category_paytype_cdw_v1.metric,
        key_controlling_account_product_cov_category_paytype_cdw_v1.lives,
        key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_time,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_controlling_account_product_cov_category_paytype_cdw_v1
 ORDER BY key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id
SEGMENTED BY hash(key_controlling_account_product_cov_category_paytype_cdw_v1.lives, key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id, key_controlling_account_product_cov_category_paytype_cdw_v1.modified_time, key_controlling_account_product_cov_category_paytype_cdw_v1.modified_by, key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account, key_controlling_account_product_cov_category_paytype_cdw_v1.paytype, key_controlling_account_product_cov_category_paytype_cdw_v1.product, key_controlling_account_product_cov_category_paytype_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.key_pbm_product_cov_category_paytype_cdw_v1_b0 /*+basename(key_pbm_product_cov_category_paytype_cdw_v1),createtype(L)*/ 
(
 key_pbm,
 paytype,
 product,
 metric,
 lives,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT key_pbm_product_cov_category_paytype_cdw_v1.key_pbm,
        key_pbm_product_cov_category_paytype_cdw_v1.paytype,
        key_pbm_product_cov_category_paytype_cdw_v1.product,
        key_pbm_product_cov_category_paytype_cdw_v1.metric,
        key_pbm_product_cov_category_paytype_cdw_v1.lives,
        key_pbm_product_cov_category_paytype_cdw_v1.cycle_id,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_time,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_pbm_product_cov_category_paytype_cdw_v1
 ORDER BY key_pbm_product_cov_category_paytype_cdw_v1.cycle_id
SEGMENTED BY hash(key_pbm_product_cov_category_paytype_cdw_v1.lives, key_pbm_product_cov_category_paytype_cdw_v1.cycle_id, key_pbm_product_cov_category_paytype_cdw_v1.modified_time, key_pbm_product_cov_category_paytype_cdw_v1.modified_by, key_pbm_product_cov_category_paytype_cdw_v1.key_pbm, key_pbm_product_cov_category_paytype_cdw_v1.paytype, key_pbm_product_cov_category_paytype_cdw_v1.product, key_pbm_product_cov_category_paytype_cdw_v1.metric) ALL NODES;

CREATE PROJECTION sandbox.payer_spine25_detailed_teva_brands_cdw_v1_b0 /*+basename(payer_spine25_detailed_teva_brands_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 payment_type,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 lives_plan_kcf_lvl,
 lives_plan_lvl,
 apportionment_factor,
 saba_trx,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.payment_type,
        payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_detailed_teva_brands_cdw_v1.saba_trx,
        payer_spine25_detailed_teva_brands_cdw_v1.cycle_id,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_time,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_by
 FROM sandbox.payer_spine25_detailed_teva_brands_cdw_v1
 ORDER BY payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
          payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
          payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
          payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
          payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
          payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
          payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
          payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm
SEGMENTED BY hash(payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code, payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl, payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl, payer_spine25_detailed_teva_brands_cdw_v1.cycle_id, payer_spine25_detailed_teva_brands_cdw_v1.modified_time, payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor, payer_spine25_detailed_teva_brands_cdw_v1.saba_trx, payer_spine25_detailed_teva_brands_cdw_v1.modified_by) ALL NODES;

CREATE PROJECTION sandbox.payer_spine25_plan_teva_brands_cdw_v1_b0 /*+basename(payer_spine25_plan_teva_brands_cdw_v1),createtype(L)*/ 
(
 iqvia_plan_code,
 iqvia_plan_name,
 iqvia_payer_name,
 iqvia_pbm,
 key_controlling_plan_formulary,
 key_controlling_account,
 key_controlling_parent,
 payer_pbm,
 payment_type,
 ajovy_access_for_ftf_plan,
 aimovig_access_for_ftf_plan,
 emgality_access_for_ftf_plan,
 lives_plan_kcf_lvl,
 lives_plan_lvl,
 apportionment_factor,
 saba_trx,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_plan_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.payment_type,
        payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_plan_teva_brands_cdw_v1.saba_trx,
        payer_spine25_plan_teva_brands_cdw_v1.cycle_id,
        payer_spine25_plan_teva_brands_cdw_v1.modified_time,
        payer_spine25_plan_teva_brands_cdw_v1.modified_by
 FROM sandbox.payer_spine25_plan_teva_brands_cdw_v1
 ORDER BY payer_spine25_plan_teva_brands_cdw_v1.cycle_id
SEGMENTED BY hash(payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code) ALL NODES;

CREATE PROJECTION sandbox.tp_pre_calls_anti_psych_b0 /*+basename(tp_pre_calls_anti_psych),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 area_id,
 region_id,
 territory_id,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 pri_specialty_code,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT tp_pre_calls_anti_psych.sales_force_id,
        tp_pre_calls_anti_psych.nation_id,
        tp_pre_calls_anti_psych.area_id,
        tp_pre_calls_anti_psych.region_id,
        tp_pre_calls_anti_psych.territory_id,
        tp_pre_calls_anti_psych.rep_name,
        tp_pre_calls_anti_psych.user_id,
        tp_pre_calls_anti_psych.market_id,
        tp_pre_calls_anti_psych.market_name,
        tp_pre_calls_anti_psych.brand_id,
        tp_pre_calls_anti_psych.brand_name,
        tp_pre_calls_anti_psych.teva_product_flag,
        tp_pre_calls_anti_psych.payer_id,
        tp_pre_calls_anti_psych.payer_name,
        tp_pre_calls_anti_psych.plan_id,
        tp_pre_calls_anti_psych.plan_name,
        tp_pre_calls_anti_psych.payer_plan_id,
        tp_pre_calls_anti_psych.customer_id,
        tp_pre_calls_anti_psych.tvcmid,
        tp_pre_calls_anti_psych.hcp_plan_vol_rank,
        tp_pre_calls_anti_psych.prescriber_name,
        tp_pre_calls_anti_psych.pdrp_flag,
        tp_pre_calls_anti_psych.hcp_restriction_flag,
        tp_pre_calls_anti_psych.address,
        tp_pre_calls_anti_psych.city,
        tp_pre_calls_anti_psych.state,
        tp_pre_calls_anti_psych.zip,
        tp_pre_calls_anti_psych.target_status_flag,
        tp_pre_calls_anti_psych.partner_target_status_flag,
        tp_pre_calls_anti_psych.method_of_payment,
        tp_pre_calls_anti_psych.pri_specialty_code,
        tp_pre_calls_anti_psych.segment,
        tp_pre_calls_anti_psych.decile,
        tp_pre_calls_anti_psych.market_volume_indicator,
        tp_pre_calls_anti_psych.product_vol_trx_count,
        tp_pre_calls_anti_psych.market_vol_trx_count,
        tp_pre_calls_anti_psych.prev_prod_vol_trx_count,
        tp_pre_calls_anti_psych.prev_market_vol_trx_count,
        tp_pre_calls_anti_psych.product_vol_nrx_count,
        tp_pre_calls_anti_psych.market_vol_nrx_count,
        tp_pre_calls_anti_psych.prev_prod_vol_nrx_count,
        tp_pre_calls_anti_psych.prev_market_vol_nrx_count,
        tp_pre_calls_anti_psych.samples,
        tp_pre_calls_anti_psych.details_p1,
        tp_pre_calls_anti_psych.details_p2,
        tp_pre_calls_anti_psych.details_p3,
        tp_pre_calls_anti_psych.focus_target
 FROM sandbox.tp_pre_calls_anti_psych
 ORDER BY tp_pre_calls_anti_psych.sales_force_id,
          tp_pre_calls_anti_psych.nation_id,
          tp_pre_calls_anti_psych.area_id,
          tp_pre_calls_anti_psych.region_id,
          tp_pre_calls_anti_psych.territory_id,
          tp_pre_calls_anti_psych.rep_name,
          tp_pre_calls_anti_psych.user_id,
          tp_pre_calls_anti_psych.market_id
SEGMENTED BY hash(tp_pre_calls_anti_psych.customer_id) ALL NODES;

CREATE PROJECTION sandbox.tmp_region_area_c_new_b0 /*+basename(tmp_region_area_c_new),createtype(A)*/ 
(
 territory_number,
 area_number,
 region_number
)
AS
 SELECT tmp_region_area_c_new.territory_number,
        tmp_region_area_c_new.area_number,
        tmp_region_area_c_new.region_number
 FROM sandbox.tmp_region_area_c_new
 ORDER BY tmp_region_area_c_new.territory_number,
          tmp_region_area_c_new.area_number,
          tmp_region_area_c_new.region_number
SEGMENTED BY hash(tmp_region_area_c_new.territory_number, tmp_region_area_c_new.area_number, tmp_region_area_c_new.region_number) ALL NODES;

CREATE PROJECTION sandbox.past_mapping_changes_b0 /*+basename(past_mapping_changes),createtype(L)*/ 
(
 Restrictions,
 Manual_update,
 restrictions_up,
 has_pa,
 has_st,
 hasPAST
)
AS
 SELECT past_mapping_changes.Restrictions,
        past_mapping_changes.Manual_update,
        past_mapping_changes.restrictions_up,
        past_mapping_changes.has_pa,
        past_mapping_changes.has_st,
        past_mapping_changes.hasPAST
 FROM sandbox.past_mapping_changes
 ORDER BY past_mapping_changes.Restrictions,
          past_mapping_changes.Manual_update,
          past_mapping_changes.restrictions_up,
          past_mapping_changes.has_pa,
          past_mapping_changes.has_st,
          past_mapping_changes.hasPAST
SEGMENTED BY hash(past_mapping_changes.has_pa, past_mapping_changes.has_st, past_mapping_changes.hasPAST, past_mapping_changes.Restrictions, past_mapping_changes.Manual_update, past_mapping_changes.restrictions_up) ALL NODES;

CREATE PROJECTION sandbox.grouped_rest_ranking_control_b0 /*+basename(grouped_rest_ranking_control),createtype(L)*/ 
(
 restriction_group,
 rank_rest_grp
)
AS
 SELECT grouped_rest_ranking_control.restriction_group,
        grouped_rest_ranking_control.rank_rest_grp
 FROM sandbox.grouped_rest_ranking_control
 ORDER BY grouped_rest_ranking_control.restriction_group,
          grouped_rest_ranking_control.rank_rest_grp
SEGMENTED BY hash(grouped_rest_ranking_control.rank_rest_grp, grouped_rest_ranking_control.restriction_group) ALL NODES;

CREATE PROJECTION sandbox.ftf_formularies_preprocessed_cdw_v3_b0 /*+basename(ftf_formularies_preprocessed_cdw_v3),createtype(L)*/ 
(
 drug_seq,
 ftf_health_plan_fid,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 pharmacy_status,
 Market_Access_Coverage,
 has_pa,
 has_st,
 hasPAST,
 plan_lives,
 check_blank_pharmstat,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_formularies_preprocessed_cdw_v3.drug_seq,
        ftf_formularies_preprocessed_cdw_v3.ftf_health_plan_fid,
        ftf_formularies_preprocessed_cdw_v3.drug_id,
        ftf_formularies_preprocessed_cdw_v3.tier_code,
        ftf_formularies_preprocessed_cdw_v3.restrictions,
        ftf_formularies_preprocessed_cdw_v3.reason_code,
        ftf_formularies_preprocessed_cdw_v3.reason_code_description,
        ftf_formularies_preprocessed_cdw_v3.pharmacy_status,
        ftf_formularies_preprocessed_cdw_v3.Market_Access_Coverage,
        ftf_formularies_preprocessed_cdw_v3.has_pa,
        ftf_formularies_preprocessed_cdw_v3.has_st,
        ftf_formularies_preprocessed_cdw_v3.hasPAST,
        ftf_formularies_preprocessed_cdw_v3.plan_lives,
        ftf_formularies_preprocessed_cdw_v3.check_blank_pharmstat,
        ftf_formularies_preprocessed_cdw_v3.cycle_id,
        ftf_formularies_preprocessed_cdw_v3.modified_time,
        ftf_formularies_preprocessed_cdw_v3.modified_by
 FROM sandbox.ftf_formularies_preprocessed_cdw_v3
 ORDER BY ftf_formularies_preprocessed_cdw_v3.drug_seq,
          ftf_formularies_preprocessed_cdw_v3.ftf_health_plan_fid
SEGMENTED BY hash(ftf_formularies_preprocessed_cdw_v3.drug_seq, ftf_formularies_preprocessed_cdw_v3.ftf_health_plan_fid, ftf_formularies_preprocessed_cdw_v3.drug_id, ftf_formularies_preprocessed_cdw_v3.has_pa, ftf_formularies_preprocessed_cdw_v3.has_st, ftf_formularies_preprocessed_cdw_v3.hasPAST, ftf_formularies_preprocessed_cdw_v3.plan_lives, ftf_formularies_preprocessed_cdw_v3.cycle_id) ALL NODES;

CREATE PROJECTION sandbox.ftf_restrictions_preprocessed_cdw_v4_b0 /*+basename(ftf_restrictions_preprocessed_cdw_v4),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 drug_seq,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_group,
 coverage_cat,
 other_pmf_metrics,
 rank_rest_grp,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_restrictions_preprocessed_cdw_v4.health_plan_id,
        ftf_restrictions_preprocessed_cdw_v4.drug_id,
        ftf_restrictions_preprocessed_cdw_v4.drug_seq,
        ftf_restrictions_preprocessed_cdw_v4.restriction_code,
        ftf_restrictions_preprocessed_cdw_v4.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v4.restriction_detail_text,
        ftf_restrictions_preprocessed_cdw_v4.restriction_group,
        ftf_restrictions_preprocessed_cdw_v4.coverage_cat,
        ftf_restrictions_preprocessed_cdw_v4.other_pmf_metrics,
        ftf_restrictions_preprocessed_cdw_v4.rank_rest_grp,
        ftf_restrictions_preprocessed_cdw_v4.botox,
        ftf_restrictions_preprocessed_cdw_v4.step,
        ftf_restrictions_preprocessed_cdw_v4.pres_pa,
        ftf_restrictions_preprocessed_cdw_v4.pat_pa,
        ftf_restrictions_preprocessed_cdw_v4.med_rec,
        ftf_restrictions_preprocessed_cdw_v4.unspec,
        ftf_restrictions_preprocessed_cdw_v4.cycle_id,
        ftf_restrictions_preprocessed_cdw_v4.modified_time,
        ftf_restrictions_preprocessed_cdw_v4.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v4
 ORDER BY ftf_restrictions_preprocessed_cdw_v4.health_plan_id,
          ftf_restrictions_preprocessed_cdw_v4.drug_id,
          ftf_restrictions_preprocessed_cdw_v4.drug_seq,
          ftf_restrictions_preprocessed_cdw_v4.restriction_code,
          ftf_restrictions_preprocessed_cdw_v4.restriction_detail_id,
          ftf_restrictions_preprocessed_cdw_v4.restriction_detail_text,
          ftf_restrictions_preprocessed_cdw_v4.restriction_group,
          ftf_restrictions_preprocessed_cdw_v4.coverage_cat
SEGMENTED BY hash(ftf_restrictions_preprocessed_cdw_v4.health_plan_id, ftf_restrictions_preprocessed_cdw_v4.drug_id, ftf_restrictions_preprocessed_cdw_v4.drug_seq, ftf_restrictions_preprocessed_cdw_v4.rank_rest_grp, ftf_restrictions_preprocessed_cdw_v4.botox, ftf_restrictions_preprocessed_cdw_v4.step, ftf_restrictions_preprocessed_cdw_v4.pres_pa, ftf_restrictions_preprocessed_cdw_v4.pat_pa) ALL NODES;

CREATE PROJECTION sandbox.plan_prod_master_cdw_v2_b0 /*+basename(plan_prod_master_cdw_v2),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 Market_Access_Coverage,
 has_pa,
 has_st,
 hasPAST,
 botox,
 step,
 pres_pa,
 pat_pa,
 med_rec,
 unspec,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_group,
 ref_coverage_cat,
 other_pmf_metrics,
 calc_coverage_cat,
 copay_tier,
 tier_cat,
 restcat,
 restriction_category,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT plan_prod_master_cdw_v2.ftf_health_plan_fid,
        plan_prod_master_cdw_v2.ftf_health_plan_name,
        plan_prod_master_cdw_v2.ftf_provider_fid,
        plan_prod_master_cdw_v2.ftf_provider_name,
        plan_prod_master_cdw_v2.ftf_parent_name,
        plan_prod_master_cdw_v2.paytype_index,
        plan_prod_master_cdw_v2.paytype,
        plan_prod_master_cdw_v2.ftf_health_plan_type,
        plan_prod_master_cdw_v2.pref_brand_tier,
        plan_prod_master_cdw_v2.fillIn_blank_iqpayer,
        plan_prod_master_cdw_v2.fillIn_blank_iqpbm,
        plan_prod_master_cdw_v2.ftf_match_iqvia,
        plan_prod_master_cdw_v2.iqvia_payer_name,
        plan_prod_master_cdw_v2.iqvia_pbm,
        plan_prod_master_cdw_v2.ftf_formulary_management_pbm,
        plan_prod_master_cdw_v2.ftf_formulary_influencer_pbm,
        plan_prod_master_cdw_v2.ftf_claims_processing_pbm,
        plan_prod_master_cdw_v2.lives_mn,
        plan_prod_master_cdw_v2.calculated_pbm_value,
        plan_prod_master_cdw_v2.key_pbm,
        plan_prod_master_cdw_v2.drug_id,
        plan_prod_master_cdw_v2.drug_seq,
        plan_prod_master_cdw_v2.tier_code,
        plan_prod_master_cdw_v2.restrictions,
        plan_prod_master_cdw_v2.reason_code,
        plan_prod_master_cdw_v2.pharmacy_status,
        plan_prod_master_cdw_v2.Market_Access_Coverage,
        plan_prod_master_cdw_v2.has_pa,
        plan_prod_master_cdw_v2.has_st,
        plan_prod_master_cdw_v2.hasPAST,
        plan_prod_master_cdw_v2.botox,
        plan_prod_master_cdw_v2.step,
        plan_prod_master_cdw_v2.pres_pa,
        plan_prod_master_cdw_v2.pat_pa,
        plan_prod_master_cdw_v2.med_rec,
        plan_prod_master_cdw_v2.unspec,
        plan_prod_master_cdw_v2.restriction_code,
        plan_prod_master_cdw_v2.restriction_detail_id,
        plan_prod_master_cdw_v2.restriction_detail_text,
        plan_prod_master_cdw_v2.restriction_group,
        plan_prod_master_cdw_v2.ref_coverage_cat,
        plan_prod_master_cdw_v2.other_pmf_metrics,
        plan_prod_master_cdw_v2.calc_coverage_cat,
        plan_prod_master_cdw_v2.copay_tier,
        plan_prod_master_cdw_v2.tier_cat,
        plan_prod_master_cdw_v2.restcat,
        plan_prod_master_cdw_v2.restriction_category,
        plan_prod_master_cdw_v2.cycle_id,
        plan_prod_master_cdw_v2.modified_time,
        plan_prod_master_cdw_v2.modified_by
 FROM sandbox.plan_prod_master_cdw_v2
 ORDER BY plan_prod_master_cdw_v2.ftf_health_plan_fid,
          plan_prod_master_cdw_v2.drug_seq
SEGMENTED BY hash(plan_prod_master_cdw_v2.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.ftf_plan_master_file_cdw_v2_b0 /*+basename(ftf_plan_master_file_cdw_v2),createtype(L)*/ 
(
 ftf_health_plan_fid,
 ftf_health_plan_name,
 ftf_provider_fid,
 ftf_provider_name,
 ftf_parent_name,
 paytype_index,
 paytype,
 ftf_health_plan_type,
 pref_brand_tier,
 fillIn_blank_iqpayer,
 fillIn_blank_iqpbm,
 ftf_match_iqvia,
 iqvia_payer_name,
 iqvia_pbm,
 ftf_formulary_management_pbm,
 ftf_formulary_influencer_pbm,
 ftf_claims_processing_pbm,
 lives_mn,
 calculated_pbm_value,
 key_pbm,
 drug_id,
 drug_seq,
 product,
 tier_code,
 restrictions,
 reason_code,
 pharmacy_status,
 Market_Access_Coverage,
 has_pa,
 has_st,
 hasPAST,
 botox,
 botox_step_flag,
 step,
 step_category,
 pres_pa,
 prescriber_prior_authorization_category,
 pat_pa,
 patient_prior_authorization_category,
 med_rec,
 medical_records_submission_required_flag,
 unspec,
 unspecified_restriction_flag,
 copay_Tier,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_group,
 ref_coverage_cat,
 other_pmf_metrics,
 calc_coverage_cat,
 restriction_category,
 tier_cat,
 restcat,
 key_controlling_account,
 key_controlling_plan_formulary,
 key_controlling_parent,
 payer_pbm,
 market_access_cvg_w_overides,
 calc_coverage_cat_w_overrides,
 cycle_id,
 modified_time,
 modified_by
)
AS
 SELECT ftf_plan_master_file_cdw_v2.ftf_health_plan_fid,
        ftf_plan_master_file_cdw_v2.ftf_health_plan_name,
        ftf_plan_master_file_cdw_v2.ftf_provider_fid,
        ftf_plan_master_file_cdw_v2.ftf_provider_name,
        ftf_plan_master_file_cdw_v2.ftf_parent_name,
        ftf_plan_master_file_cdw_v2.paytype_index,
        ftf_plan_master_file_cdw_v2.paytype,
        ftf_plan_master_file_cdw_v2.ftf_health_plan_type,
        ftf_plan_master_file_cdw_v2.pref_brand_tier,
        ftf_plan_master_file_cdw_v2.fillIn_blank_iqpayer,
        ftf_plan_master_file_cdw_v2.fillIn_blank_iqpbm,
        ftf_plan_master_file_cdw_v2.ftf_match_iqvia,
        ftf_plan_master_file_cdw_v2.iqvia_payer_name,
        ftf_plan_master_file_cdw_v2.iqvia_pbm,
        ftf_plan_master_file_cdw_v2.ftf_formulary_management_pbm,
        ftf_plan_master_file_cdw_v2.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_cdw_v2.ftf_claims_processing_pbm,
        ftf_plan_master_file_cdw_v2.lives_mn,
        ftf_plan_master_file_cdw_v2.calculated_pbm_value,
        ftf_plan_master_file_cdw_v2.key_pbm,
        ftf_plan_master_file_cdw_v2.drug_id,
        ftf_plan_master_file_cdw_v2.drug_seq,
        ftf_plan_master_file_cdw_v2.product,
        ftf_plan_master_file_cdw_v2.tier_code,
        ftf_plan_master_file_cdw_v2.restrictions,
        ftf_plan_master_file_cdw_v2.reason_code,
        ftf_plan_master_file_cdw_v2.pharmacy_status,
        ftf_plan_master_file_cdw_v2.Market_Access_Coverage,
        ftf_plan_master_file_cdw_v2.has_pa,
        ftf_plan_master_file_cdw_v2.has_st,
        ftf_plan_master_file_cdw_v2.hasPAST,
        ftf_plan_master_file_cdw_v2.botox,
        ftf_plan_master_file_cdw_v2.botox_step_flag,
        ftf_plan_master_file_cdw_v2.step,
        ftf_plan_master_file_cdw_v2.step_category,
        ftf_plan_master_file_cdw_v2.pres_pa,
        ftf_plan_master_file_cdw_v2.prescriber_prior_authorization_category,
        ftf_plan_master_file_cdw_v2.pat_pa,
        ftf_plan_master_file_cdw_v2.patient_prior_authorization_category,
        ftf_plan_master_file_cdw_v2.med_rec,
        ftf_plan_master_file_cdw_v2.medical_records_submission_required_flag,
        ftf_plan_master_file_cdw_v2.unspec,
        ftf_plan_master_file_cdw_v2.unspecified_restriction_flag,
        ftf_plan_master_file_cdw_v2.copay_Tier,
        ftf_plan_master_file_cdw_v2.restriction_code,
        ftf_plan_master_file_cdw_v2.restriction_detail_id,
        ftf_plan_master_file_cdw_v2.restriction_detail_text,
        ftf_plan_master_file_cdw_v2.restriction_group,
        ftf_plan_master_file_cdw_v2.ref_coverage_cat,
        ftf_plan_master_file_cdw_v2.other_pmf_metrics,
        ftf_plan_master_file_cdw_v2.calc_coverage_cat,
        ftf_plan_master_file_cdw_v2.restriction_category,
        ftf_plan_master_file_cdw_v2.tier_cat,
        ftf_plan_master_file_cdw_v2.restcat,
        ftf_plan_master_file_cdw_v2.key_controlling_account,
        ftf_plan_master_file_cdw_v2.key_controlling_plan_formulary,
        ftf_plan_master_file_cdw_v2.key_controlling_parent,
        ftf_plan_master_file_cdw_v2.payer_pbm,
        ftf_plan_master_file_cdw_v2.market_access_cvg_w_overides,
        ftf_plan_master_file_cdw_v2.calc_coverage_cat_w_overrides,
        ftf_plan_master_file_cdw_v2.cycle_id,
        ftf_plan_master_file_cdw_v2.modified_time,
        ftf_plan_master_file_cdw_v2.modified_by
 FROM sandbox.ftf_plan_master_file_cdw_v2
 ORDER BY ftf_plan_master_file_cdw_v2.ftf_health_plan_fid,
          ftf_plan_master_file_cdw_v2.ftf_health_plan_name,
          ftf_plan_master_file_cdw_v2.ftf_provider_fid,
          ftf_plan_master_file_cdw_v2.ftf_provider_name,
          ftf_plan_master_file_cdw_v2.ftf_parent_name,
          ftf_plan_master_file_cdw_v2.paytype_index,
          ftf_plan_master_file_cdw_v2.paytype,
          ftf_plan_master_file_cdw_v2.ftf_health_plan_type,
          ftf_plan_master_file_cdw_v2.pref_brand_tier,
          ftf_plan_master_file_cdw_v2.fillIn_blank_iqpayer,
          ftf_plan_master_file_cdw_v2.fillIn_blank_iqpbm,
          ftf_plan_master_file_cdw_v2.ftf_match_iqvia,
          ftf_plan_master_file_cdw_v2.iqvia_payer_name,
          ftf_plan_master_file_cdw_v2.iqvia_pbm,
          ftf_plan_master_file_cdw_v2.ftf_formulary_management_pbm,
          ftf_plan_master_file_cdw_v2.ftf_formulary_influencer_pbm,
          ftf_plan_master_file_cdw_v2.ftf_claims_processing_pbm,
          ftf_plan_master_file_cdw_v2.lives_mn,
          ftf_plan_master_file_cdw_v2.calculated_pbm_value,
          ftf_plan_master_file_cdw_v2.key_pbm,
          ftf_plan_master_file_cdw_v2.drug_id,
          ftf_plan_master_file_cdw_v2.drug_seq
SEGMENTED BY hash(ftf_plan_master_file_cdw_v2.ftf_health_plan_fid) ALL NODES;

CREATE PROJECTION sandbox.LAI_monthly_prescriber_summary_b0 /*+basename(LAI_monthly_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 GPO,
 GPO_1,
 refresh_month
)
AS
 SELECT LAI_monthly_prescriber_summary.sales_force_id,
        LAI_monthly_prescriber_summary.nation_id,
        LAI_monthly_prescriber_summary.nation,
        LAI_monthly_prescriber_summary.area_id,
        LAI_monthly_prescriber_summary.area,
        LAI_monthly_prescriber_summary.region_id,
        LAI_monthly_prescriber_summary.region,
        LAI_monthly_prescriber_summary.territory_id,
        LAI_monthly_prescriber_summary.territory,
        LAI_monthly_prescriber_summary.rep_name,
        LAI_monthly_prescriber_summary.user_id,
        LAI_monthly_prescriber_summary.time_period,
        LAI_monthly_prescriber_summary.period_type,
        LAI_monthly_prescriber_summary.period,
        LAI_monthly_prescriber_summary.market_id,
        LAI_monthly_prescriber_summary.market_name,
        LAI_monthly_prescriber_summary.brand_id,
        LAI_monthly_prescriber_summary.brand_name,
        LAI_monthly_prescriber_summary.teva_product_flag,
        LAI_monthly_prescriber_summary.customer_id,
        LAI_monthly_prescriber_summary.tvcmid,
        LAI_monthly_prescriber_summary.pdrp_flag,
        LAI_monthly_prescriber_summary.hcp_restriction_flag,
        LAI_monthly_prescriber_summary.prescriber_name,
        LAI_monthly_prescriber_summary.new_prescriber,
        LAI_monthly_prescriber_summary.address,
        LAI_monthly_prescriber_summary.city,
        LAI_monthly_prescriber_summary.state,
        LAI_monthly_prescriber_summary.zip,
        LAI_monthly_prescriber_summary.target_status_flag,
        LAI_monthly_prescriber_summary.partner_target_status_flag,
        LAI_monthly_prescriber_summary.method_of_payment,
        LAI_monthly_prescriber_summary.specialty,
        LAI_monthly_prescriber_summary.segment,
        LAI_monthly_prescriber_summary.decile,
        LAI_monthly_prescriber_summary.market_volume_indicator,
        LAI_monthly_prescriber_summary.product_vol_trx_count,
        LAI_monthly_prescriber_summary.market_vol_trx_count,
        LAI_monthly_prescriber_summary.prev_prod_vol_trx_count,
        LAI_monthly_prescriber_summary.prev_market_vol_trx_count,
        LAI_monthly_prescriber_summary.product_vol_nrx_count,
        LAI_monthly_prescriber_summary.market_vol_nrx_count,
        LAI_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        LAI_monthly_prescriber_summary.prev_market_vol_nrx_count,
        LAI_monthly_prescriber_summary.samples,
        LAI_monthly_prescriber_summary.details_p1,
        LAI_monthly_prescriber_summary.details_p2,
        LAI_monthly_prescriber_summary.details_p3,
        LAI_monthly_prescriber_summary.GPO,
        LAI_monthly_prescriber_summary.GPO_1,
        LAI_monthly_prescriber_summary.refresh_month
 FROM sandbox.LAI_monthly_prescriber_summary
 ORDER BY LAI_monthly_prescriber_summary.sales_force_id,
          LAI_monthly_prescriber_summary.nation_id,
          LAI_monthly_prescriber_summary.nation,
          LAI_monthly_prescriber_summary.area_id,
          LAI_monthly_prescriber_summary.area,
          LAI_monthly_prescriber_summary.region_id,
          LAI_monthly_prescriber_summary.region,
          LAI_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(LAI_monthly_prescriber_summary.market_id, LAI_monthly_prescriber_summary.brand_id, LAI_monthly_prescriber_summary.teva_product_flag, LAI_monthly_prescriber_summary.tvcmid, LAI_monthly_prescriber_summary.pdrp_flag, LAI_monthly_prescriber_summary.new_prescriber, LAI_monthly_prescriber_summary.state, LAI_monthly_prescriber_summary.zip) ALL NODES;

CREATE PROJECTION sandbox.tmp_trend_rows_combined_b0 /*+basename(tmp_trend_rows_combined),createtype(A)*/ 
(
 customer_id
)
AS
 SELECT tmp_trend_rows_combined.customer_id
 FROM sandbox.tmp_trend_rows_combined
 ORDER BY tmp_trend_rows_combined.customer_id
SEGMENTED BY hash(tmp_trend_rows_combined.customer_id) ALL NODES;

CREATE PROJECTION sandbox.call_check_b0 /*+basename(call_check),createtype(A)*/ 
(
 id,
 ownerid,
 isdeleted,
 name,
 recordtypeid,
 createddate,
 createdbyid,
 lastmodifieddate,
 lastmodifiedbyid,
 systemmodstamp,
 lastactivitydate,
 mayedit,
 islocked,
 lastvieweddate,
 lastreferenceddate,
 sample_card_vod__c,
 add_detail_vod__c,
 property_vod__c,
 account_vod__c,
 zvod_product_discussion_vod__c,
 status_vod__c,
 parent_address_vod__c,
 account_plan_vod__c,
 zvod_savenew_vod__c,
 next_call_notes_vod__c,
 mobile_id_vod__c,
 zvod_account_credentials_vod_c,
 zvod_account_preferred_name_vo,
 zvod_account_sample_status_vod,
 zvod_attendees_vod__c,
 zvod_key_messages_vod__c,
 zvod_detailing_vod__c,
 zvod_expenses_vod__c,
 zvod_followup_vod__c,
 zvod_samples_vod__c,
 zvod_save_vod__c,
 zvod_submit_vod__c,
 zvod_delete_vod__c,
 activity_type__c,
 significant_event__c,
 location_vod__c,
 subject_vod__c,
 call_datetime_vod__c,
 disbursed_to_vod__c,
 request_receipt_vod__c,
 signature_date_vod__c,
 territory_vod__c,
 submitted_by_mobile_vod__c,
 call_type_vod__c,
 add_key_message_vod__c,
 address_vod__c,
 attendees_vod__c,
 attendee_type_vod__c,
 call_date_vod__c,
 detailed_products_vod__c,
 no_disbursement_vod__c,
 parent_call_vod__c,
 user_vod__c,
 contact_vod__c,
 zvod_entity_vod__c,
 medical_event_vod__c,
 mobile_created_datetime_vod__c,
 mobile_last_modified_datetime,
 license_vod__c,
 is_parent_call_vod__c,
 entity_display_name_vod__c,
 last_device_vod__c,
 ship_address_line_1_vod__c,
 ship_address_line_2_vod__c,
 ship_city_vod__c,
 ship_country_vod__c,
 ship_license_expiration_date,
 ship_license_status_vod__c,
 ship_license_vod__c,
 ship_state_vod__c,
 ship_to_address_vod__c,
 ship_zip_vod__c,
 ship_to_address_text_vod__c,
 clm_vod__c,
 zvod_clmdetails_vod__c,
 is_sampled_call_vod__c,
 zvod_surveys_vod__c,
 presentations_vod__c,
 entity_reference_id_vod__c,
 error_reference_call_vod__c,
 duration_vod__c,
 color_vod__c,
 allowed_products_vod__c,
 zvod_attachments_vod__c,
 sample_card_reason_vod__c,
 assmca_vod__c,
 address_line_1_vod__c,
 address_line_2_vod__c,
 city_vod__c,
 dea_address_line_1_vod__c,
 dea_address_line_2_vod__c,
 dea_address_vod__c,
 dea_city_vod__c,
 dea_expiration_date_vod__c,
 dea_state_vod__c,
 dea_zip_4_vod__c,
 dea_zip_vod__c,
 dea_vod__c,
 ship_zip_4_vod__c,
 state_vod__c,
 zip_4_vod__c,
 zip_vod__c,
 sample_send_card_vod__c,
 zvod_address_vod_c_dea_status_,
 signature_page_image_vod__c,
 credentials_vod__c,
 salutation_vod__c,
 zvod_account_call_reminder_vod,
 sales_org_tva__c,
 zvod_business_account_vod__c,
 product_priority_1_vod__c,
 product_priority_2_vod__c,
 product_priority_3_vod__c,
 product_priority_4_vod__c,
 product_priority_5_vod__c,
 zvod_more_actions_vod__c,
 zvod_call_conflict_status,
 signature_timestamp_vod__c,
 expense_amount_vod__c,
 total_expense_attendees_count,
 attendee_list_vod__c,
 expense_post_status_vod__c,
 attendee_post_status_vod__c,
 expense_system_external_id,
 incurred_expense_vod__c,
 assigner_vod__c,
 assignment_datetime_vod__c,
 zvod_call_objective_vod__c,
 signature_location_longitude,
 signature_location_latitude,
 location_services_status,
 created_by_timezone_tva__c,
 license_expiration_date_vod__c,
 license_status_vod__c,
 ship_assmca_vod__c,
 ship_dea_expiration_date,
 ship_dea_vod__c,
 call_method_tva__c,
 bendeka_indication_tva__c,
 file_id,
 record_id,
 austedo_indication_tva__c,
 call_duration_tva__c,
 how_executed_tva__c,
 Remote_Meeting_vod__c,
 Veeva_Remote_Meeting_Id_vod__c,
 Cobrowse_URL_Participant_vod__c,
 Signature_Captured_Remotely_vod__c,
 Remote_Signature_Attendee_Name_vod__c,
 t21s10_austedo_indication_tva__c,
 row_num
)
AS
 SELECT call_check.id,
        call_check.ownerid,
        call_check.isdeleted,
        call_check.name,
        call_check.recordtypeid,
        call_check.createddate,
        call_check.createdbyid,
        call_check.lastmodifieddate,
        call_check.lastmodifiedbyid,
        call_check.systemmodstamp,
        call_check.lastactivitydate,
        call_check.mayedit,
        call_check.islocked,
        call_check.lastvieweddate,
        call_check.lastreferenceddate,
        call_check.sample_card_vod__c,
        call_check.add_detail_vod__c,
        call_check.property_vod__c,
        call_check.account_vod__c,
        call_check.zvod_product_discussion_vod__c,
        call_check.status_vod__c,
        call_check.parent_address_vod__c,
        call_check.account_plan_vod__c,
        call_check.zvod_savenew_vod__c,
        call_check.next_call_notes_vod__c,
        call_check.mobile_id_vod__c,
        call_check.zvod_account_credentials_vod_c,
        call_check.zvod_account_preferred_name_vo,
        call_check.zvod_account_sample_status_vod,
        call_check.zvod_attendees_vod__c,
        call_check.zvod_key_messages_vod__c,
        call_check.zvod_detailing_vod__c,
        call_check.zvod_expenses_vod__c,
        call_check.zvod_followup_vod__c,
        call_check.zvod_samples_vod__c,
        call_check.zvod_save_vod__c,
        call_check.zvod_submit_vod__c,
        call_check.zvod_delete_vod__c,
        call_check.activity_type__c,
        call_check.significant_event__c,
        call_check.location_vod__c,
        call_check.subject_vod__c,
        call_check.call_datetime_vod__c,
        call_check.disbursed_to_vod__c,
        call_check.request_receipt_vod__c,
        call_check.signature_date_vod__c,
        call_check.territory_vod__c,
        call_check.submitted_by_mobile_vod__c,
        call_check.call_type_vod__c,
        call_check.add_key_message_vod__c,
        call_check.address_vod__c,
        call_check.attendees_vod__c,
        call_check.attendee_type_vod__c,
        call_check.call_date_vod__c,
        call_check.detailed_products_vod__c,
        call_check.no_disbursement_vod__c,
        call_check.parent_call_vod__c,
        call_check.user_vod__c,
        call_check.contact_vod__c,
        call_check.zvod_entity_vod__c,
        call_check.medical_event_vod__c,
        call_check.mobile_created_datetime_vod__c,
        call_check.mobile_last_modified_datetime,
        call_check.license_vod__c,
        call_check.is_parent_call_vod__c,
        call_check.entity_display_name_vod__c,
        call_check.last_device_vod__c,
        call_check.ship_address_line_1_vod__c,
        call_check.ship_address_line_2_vod__c,
        call_check.ship_city_vod__c,
        call_check.ship_country_vod__c,
        call_check.ship_license_expiration_date,
        call_check.ship_license_status_vod__c,
        call_check.ship_license_vod__c,
        call_check.ship_state_vod__c,
        call_check.ship_to_address_vod__c,
        call_check.ship_zip_vod__c,
        call_check.ship_to_address_text_vod__c,
        call_check.clm_vod__c,
        call_check.zvod_clmdetails_vod__c,
        call_check.is_sampled_call_vod__c,
        call_check.zvod_surveys_vod__c,
        call_check.presentations_vod__c,
        call_check.entity_reference_id_vod__c,
        call_check.error_reference_call_vod__c,
        call_check.duration_vod__c,
        call_check.color_vod__c,
        call_check.allowed_products_vod__c,
        call_check.zvod_attachments_vod__c,
        call_check.sample_card_reason_vod__c,
        call_check.assmca_vod__c,
        call_check.address_line_1_vod__c,
        call_check.address_line_2_vod__c,
        call_check.city_vod__c,
        call_check.dea_address_line_1_vod__c,
        call_check.dea_address_line_2_vod__c,
        call_check.dea_address_vod__c,
        call_check.dea_city_vod__c,
        call_check.dea_expiration_date_vod__c,
        call_check.dea_state_vod__c,
        call_check.dea_zip_4_vod__c,
        call_check.dea_zip_vod__c,
        call_check.dea_vod__c,
        call_check.ship_zip_4_vod__c,
        call_check.state_vod__c,
        call_check.zip_4_vod__c,
        call_check.zip_vod__c,
        call_check.sample_send_card_vod__c,
        call_check.zvod_address_vod_c_dea_status_,
        call_check.signature_page_image_vod__c,
        call_check.credentials_vod__c,
        call_check.salutation_vod__c,
        call_check.zvod_account_call_reminder_vod,
        call_check.sales_org_tva__c,
        call_check.zvod_business_account_vod__c,
        call_check.product_priority_1_vod__c,
        call_check.product_priority_2_vod__c,
        call_check.product_priority_3_vod__c,
        call_check.product_priority_4_vod__c,
        call_check.product_priority_5_vod__c,
        call_check.zvod_more_actions_vod__c,
        call_check.zvod_call_conflict_status,
        call_check.signature_timestamp_vod__c,
        call_check.expense_amount_vod__c,
        call_check.total_expense_attendees_count,
        call_check.attendee_list_vod__c,
        call_check.expense_post_status_vod__c,
        call_check.attendee_post_status_vod__c,
        call_check.expense_system_external_id,
        call_check.incurred_expense_vod__c,
        call_check.assigner_vod__c,
        call_check.assignment_datetime_vod__c,
        call_check.zvod_call_objective_vod__c,
        call_check.signature_location_longitude,
        call_check.signature_location_latitude,
        call_check.location_services_status,
        call_check.created_by_timezone_tva__c,
        call_check.license_expiration_date_vod__c,
        call_check.license_status_vod__c,
        call_check.ship_assmca_vod__c,
        call_check.ship_dea_expiration_date,
        call_check.ship_dea_vod__c,
        call_check.call_method_tva__c,
        call_check.bendeka_indication_tva__c,
        call_check.file_id,
        call_check.record_id,
        call_check.austedo_indication_tva__c,
        call_check.call_duration_tva__c,
        call_check.how_executed_tva__c,
        call_check.Remote_Meeting_vod__c,
        call_check.Veeva_Remote_Meeting_Id_vod__c,
        call_check.Cobrowse_URL_Participant_vod__c,
        call_check.Signature_Captured_Remotely_vod__c,
        call_check.Remote_Signature_Attendee_Name_vod__c,
        call_check.t21s10_austedo_indication_tva__c,
        call_check.row_num
 FROM sandbox.call_check
 ORDER BY call_check.id
SEGMENTED BY hash(call_check.id) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_prescriber_summary_b0 /*+basename(ts_weekly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 partner_target_status_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT ts_weekly_prescriber_summary.sales_force_id,
        ts_weekly_prescriber_summary.nation_id,
        ts_weekly_prescriber_summary.nation,
        ts_weekly_prescriber_summary.area_id,
        ts_weekly_prescriber_summary.area,
        ts_weekly_prescriber_summary.region_id,
        ts_weekly_prescriber_summary.region,
        ts_weekly_prescriber_summary.territory_id,
        ts_weekly_prescriber_summary.territory,
        ts_weekly_prescriber_summary.rep_name,
        ts_weekly_prescriber_summary.user_id,
        ts_weekly_prescriber_summary.time_period,
        ts_weekly_prescriber_summary.period_type,
        ts_weekly_prescriber_summary.period,
        ts_weekly_prescriber_summary.market_id,
        ts_weekly_prescriber_summary.market_name,
        ts_weekly_prescriber_summary.brand_id,
        ts_weekly_prescriber_summary.brand_name,
        ts_weekly_prescriber_summary.teva_product_flag,
        ts_weekly_prescriber_summary.customer_id,
        ts_weekly_prescriber_summary.tvcmid,
        ts_weekly_prescriber_summary.pdrp_flag,
        ts_weekly_prescriber_summary.hcp_restriction_flag,
        ts_weekly_prescriber_summary.prescriber_name,
        ts_weekly_prescriber_summary.new_prescriber,
        ts_weekly_prescriber_summary.address,
        ts_weekly_prescriber_summary.city,
        ts_weekly_prescriber_summary.state,
        ts_weekly_prescriber_summary.zip,
        ts_weekly_prescriber_summary.partner_target_status_flag,
        ts_weekly_prescriber_summary.target_status_flag,
        ts_weekly_prescriber_summary.method_of_payment,
        ts_weekly_prescriber_summary.specialty,
        ts_weekly_prescriber_summary.segment,
        ts_weekly_prescriber_summary.decile,
        ts_weekly_prescriber_summary.market_volume_indicator,
        ts_weekly_prescriber_summary.product_vol_trx_count,
        ts_weekly_prescriber_summary.market_vol_trx_count,
        ts_weekly_prescriber_summary.prev_prod_vol_trx_count,
        ts_weekly_prescriber_summary.prev_market_vol_trx_count,
        ts_weekly_prescriber_summary.product_vol_nrx_count,
        ts_weekly_prescriber_summary.market_vol_nrx_count,
        ts_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        ts_weekly_prescriber_summary.prev_market_vol_nrx_count,
        ts_weekly_prescriber_summary.samples,
        ts_weekly_prescriber_summary.details_p1,
        ts_weekly_prescriber_summary.details_p2,
        ts_weekly_prescriber_summary.details_p3
 FROM sandbox.ts_weekly_prescriber_summary
 ORDER BY ts_weekly_prescriber_summary.sales_force_id,
          ts_weekly_prescriber_summary.nation_id,
          ts_weekly_prescriber_summary.nation,
          ts_weekly_prescriber_summary.area_id,
          ts_weekly_prescriber_summary.area,
          ts_weekly_prescriber_summary.region_id,
          ts_weekly_prescriber_summary.region,
          ts_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(ts_weekly_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_new_prescriber_b0 /*+basename(ts_weekly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 week_ending,
 week_bucket,
 curr_trx,
 prev_trx
)
AS
 SELECT ts_weekly_new_prescriber.customer_id,
        ts_weekly_new_prescriber.brand_id,
        ts_weekly_new_prescriber.week_ending,
        ts_weekly_new_prescriber.week_bucket,
        ts_weekly_new_prescriber.curr_trx,
        ts_weekly_new_prescriber.prev_trx
 FROM sandbox.ts_weekly_new_prescriber
 ORDER BY ts_weekly_new_prescriber.customer_id,
          ts_weekly_new_prescriber.brand_id,
          ts_weekly_new_prescriber.week_ending,
          ts_weekly_new_prescriber.week_bucket
SEGMENTED BY hash(ts_weekly_new_prescriber.customer_id, ts_weekly_new_prescriber.brand_id) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_prescriber_sales_b0 /*+basename(ts_weekly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 week_ending,
 week_bucket,
 data_source,
 channel,
 pbm_name,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT ts_weekly_prescriber_sales.customer_id,
        ts_weekly_prescriber_sales.tvcmid,
        ts_weekly_prescriber_sales.ims_id,
        ts_weekly_prescriber_sales.product_id,
        ts_weekly_prescriber_sales.payer_plan_id,
        ts_weekly_prescriber_sales.week_ending,
        ts_weekly_prescriber_sales.week_bucket,
        ts_weekly_prescriber_sales.data_source,
        ts_weekly_prescriber_sales.channel,
        ts_weekly_prescriber_sales.pbm_name,
        ts_weekly_prescriber_sales.method_of_payment,
        ts_weekly_prescriber_sales.trx,
        ts_weekly_prescriber_sales.nrx,
        ts_weekly_prescriber_sales.trx_units,
        ts_weekly_prescriber_sales.nrx_units,
        ts_weekly_prescriber_sales.trx_dollars,
        ts_weekly_prescriber_sales.nrx_dollars,
        ts_weekly_prescriber_sales.new_prescriber
 FROM sandbox.ts_weekly_prescriber_sales
 ORDER BY ts_weekly_prescriber_sales.customer_id,
          ts_weekly_prescriber_sales.tvcmid,
          ts_weekly_prescriber_sales.ims_id
SEGMENTED BY hash(ts_weekly_prescriber_sales.ims_id) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_prescriber_sales_summary_b0 /*+basename(ts_weekly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 week_ending,
 week_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT ts_weekly_prescriber_sales_summary.sales_force_id,
        ts_weekly_prescriber_sales_summary.customer_id,
        ts_weekly_prescriber_sales_summary.tvcmid,
        ts_weekly_prescriber_sales_summary.ims_id,
        ts_weekly_prescriber_sales_summary.period_type,
        ts_weekly_prescriber_sales_summary.period,
        ts_weekly_prescriber_sales_summary.week_ending,
        ts_weekly_prescriber_sales_summary.week_bucket,
        ts_weekly_prescriber_sales_summary.market_id,
        ts_weekly_prescriber_sales_summary.brand_id,
        ts_weekly_prescriber_sales_summary.payer_id,
        ts_weekly_prescriber_sales_summary.payer_plan_id,
        ts_weekly_prescriber_sales_summary.method_of_payment,
        ts_weekly_prescriber_sales_summary.hcp_payer_vol_rank,
        ts_weekly_prescriber_sales_summary.hcp_plan_vol_rank,
        ts_weekly_prescriber_sales_summary.product_vol_trx_count,
        ts_weekly_prescriber_sales_summary.prev_prod_vol_trx_count,
        ts_weekly_prescriber_sales_summary.product_vol_nrx_count,
        ts_weekly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        ts_weekly_prescriber_sales_summary.market_vol_trx_count,
        ts_weekly_prescriber_sales_summary.prev_market_vol_trx_count,
        ts_weekly_prescriber_sales_summary.market_vol_nrx_count,
        ts_weekly_prescriber_sales_summary.prev_market_vol_nrx_count,
        ts_weekly_prescriber_sales_summary.samples,
        ts_weekly_prescriber_sales_summary.details_p1,
        ts_weekly_prescriber_sales_summary.details_p2,
        ts_weekly_prescriber_sales_summary.details_p3
 FROM sandbox.ts_weekly_prescriber_sales_summary
 ORDER BY ts_weekly_prescriber_sales_summary.sales_force_id,
          ts_weekly_prescriber_sales_summary.customer_id,
          ts_weekly_prescriber_sales_summary.tvcmid,
          ts_weekly_prescriber_sales_summary.ims_id,
          ts_weekly_prescriber_sales_summary.period_type,
          ts_weekly_prescriber_sales_summary.period,
          ts_weekly_prescriber_sales_summary.week_ending,
          ts_weekly_prescriber_sales_summary.week_bucket
SEGMENTED BY hash(ts_weekly_prescriber_sales_summary.tvcmid) ALL NODES;

CREATE PROJECTION sandbox.ts_weekly_payer_prescriber_summary_b0 /*+basename(ts_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT ts_weekly_payer_prescriber_summary.sales_force_id,
        ts_weekly_payer_prescriber_summary.nation_id,
        ts_weekly_payer_prescriber_summary.nation,
        ts_weekly_payer_prescriber_summary.area_id,
        ts_weekly_payer_prescriber_summary.area,
        ts_weekly_payer_prescriber_summary.region_id,
        ts_weekly_payer_prescriber_summary.region,
        ts_weekly_payer_prescriber_summary.territory_id,
        ts_weekly_payer_prescriber_summary.territory,
        ts_weekly_payer_prescriber_summary.rep_name,
        ts_weekly_payer_prescriber_summary.user_id,
        ts_weekly_payer_prescriber_summary.time_period,
        ts_weekly_payer_prescriber_summary.period_type,
        ts_weekly_payer_prescriber_summary.period,
        ts_weekly_payer_prescriber_summary.market_id,
        ts_weekly_payer_prescriber_summary.market_name,
        ts_weekly_payer_prescriber_summary.brand_id,
        ts_weekly_payer_prescriber_summary.brand_name,
        ts_weekly_payer_prescriber_summary.teva_product_flag,
        ts_weekly_payer_prescriber_summary.payer_id,
        ts_weekly_payer_prescriber_summary.payer_name,
        ts_weekly_payer_prescriber_summary.plan_id,
        ts_weekly_payer_prescriber_summary.plan_name,
        ts_weekly_payer_prescriber_summary.payer_plan_id,
        ts_weekly_payer_prescriber_summary.customer_id,
        ts_weekly_payer_prescriber_summary.tvcmid,
        ts_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        ts_weekly_payer_prescriber_summary.prescriber_name,
        ts_weekly_payer_prescriber_summary.pdrp_flag,
        ts_weekly_payer_prescriber_summary.hcp_restriction_flag,
        ts_weekly_payer_prescriber_summary.address,
        ts_weekly_payer_prescriber_summary.city,
        ts_weekly_payer_prescriber_summary.state,
        ts_weekly_payer_prescriber_summary.zip,
        ts_weekly_payer_prescriber_summary.target_status_flag,
        ts_weekly_payer_prescriber_summary.partner_target_status_flag,
        ts_weekly_payer_prescriber_summary.method_of_payment,
        ts_weekly_payer_prescriber_summary.specialty,
        ts_weekly_payer_prescriber_summary.segment,
        ts_weekly_payer_prescriber_summary.decile,
        ts_weekly_payer_prescriber_summary.rep_type,
        ts_weekly_payer_prescriber_summary.market_volume_indicator,
        ts_weekly_payer_prescriber_summary.product_vol_trx_count,
        ts_weekly_payer_prescriber_summary.market_vol_trx_count,
        ts_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        ts_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        ts_weekly_payer_prescriber_summary.product_vol_nrx_count,
        ts_weekly_payer_prescriber_summary.market_vol_nrx_count,
        ts_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        ts_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        ts_weekly_payer_prescriber_summary.samples,
        ts_weekly_payer_prescriber_summary.details_p1,
        ts_weekly_payer_prescriber_summary.details_p2,
        ts_weekly_payer_prescriber_summary.details_p3,
        ts_weekly_payer_prescriber_summary.focus_target
 FROM sandbox.ts_weekly_payer_prescriber_summary
 ORDER BY ts_weekly_payer_prescriber_summary.sales_force_id,
          ts_weekly_payer_prescriber_summary.nation_id,
          ts_weekly_payer_prescriber_summary.nation,
          ts_weekly_payer_prescriber_summary.area_id,
          ts_weekly_payer_prescriber_summary.area,
          ts_weekly_payer_prescriber_summary.region_id,
          ts_weekly_payer_prescriber_summary.region,
          ts_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(ts_weekly_payer_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_prescriber_sales_summary_b0 /*+basename(ts_monthly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 month_ending,
 month_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_restriction_flag,
 segment,
 decile,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT ts_monthly_prescriber_sales_summary.sales_force_id,
        ts_monthly_prescriber_sales_summary.customer_id,
        ts_monthly_prescriber_sales_summary.tvcmid,
        ts_monthly_prescriber_sales_summary.ims_id,
        ts_monthly_prescriber_sales_summary.period_type,
        ts_monthly_prescriber_sales_summary.period,
        ts_monthly_prescriber_sales_summary.month_ending,
        ts_monthly_prescriber_sales_summary.month_bucket,
        ts_monthly_prescriber_sales_summary.market_id,
        ts_monthly_prescriber_sales_summary.brand_id,
        ts_monthly_prescriber_sales_summary.payer_id,
        ts_monthly_prescriber_sales_summary.payer_plan_id,
        ts_monthly_prescriber_sales_summary.method_of_payment,
        ts_monthly_prescriber_sales_summary.hcp_restriction_flag,
        ts_monthly_prescriber_sales_summary.segment,
        ts_monthly_prescriber_sales_summary.decile,
        ts_monthly_prescriber_sales_summary.hcp_payer_vol_rank,
        ts_monthly_prescriber_sales_summary.hcp_plan_vol_rank,
        ts_monthly_prescriber_sales_summary.product_vol_trx_count,
        ts_monthly_prescriber_sales_summary.prev_prod_vol_trx_count,
        ts_monthly_prescriber_sales_summary.product_vol_nrx_count,
        ts_monthly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        ts_monthly_prescriber_sales_summary.market_vol_trx_count,
        ts_monthly_prescriber_sales_summary.prev_market_vol_trx_count,
        ts_monthly_prescriber_sales_summary.market_vol_nrx_count,
        ts_monthly_prescriber_sales_summary.prev_market_vol_nrx_count,
        ts_monthly_prescriber_sales_summary.samples,
        ts_monthly_prescriber_sales_summary.details_p1,
        ts_monthly_prescriber_sales_summary.details_p2,
        ts_monthly_prescriber_sales_summary.details_p3
 FROM sandbox.ts_monthly_prescriber_sales_summary
 ORDER BY ts_monthly_prescriber_sales_summary.sales_force_id,
          ts_monthly_prescriber_sales_summary.customer_id,
          ts_monthly_prescriber_sales_summary.tvcmid,
          ts_monthly_prescriber_sales_summary.ims_id,
          ts_monthly_prescriber_sales_summary.period_type,
          ts_monthly_prescriber_sales_summary.period,
          ts_monthly_prescriber_sales_summary.month_ending,
          ts_monthly_prescriber_sales_summary.month_bucket
SEGMENTED BY hash(ts_monthly_prescriber_sales_summary.tvcmid, ts_monthly_prescriber_sales_summary.month_ending, ts_monthly_prescriber_sales_summary.month_bucket, ts_monthly_prescriber_sales_summary.market_id, ts_monthly_prescriber_sales_summary.brand_id, ts_monthly_prescriber_sales_summary.hcp_payer_vol_rank, ts_monthly_prescriber_sales_summary.hcp_plan_vol_rank, ts_monthly_prescriber_sales_summary.product_vol_trx_count) ALL NODES;

CREATE PROJECTION sandbox.ts_monthly_prescriber_summary_b0 /*+basename(ts_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT ts_monthly_prescriber_summary.sales_force_id,
        ts_monthly_prescriber_summary.nation_id,
        ts_monthly_prescriber_summary.nation,
        ts_monthly_prescriber_summary.area_id,
        ts_monthly_prescriber_summary.area,
        ts_monthly_prescriber_summary.region_id,
        ts_monthly_prescriber_summary.region,
        ts_monthly_prescriber_summary.territory_id,
        ts_monthly_prescriber_summary.territory,
        ts_monthly_prescriber_summary.rep_name,
        ts_monthly_prescriber_summary.user_id,
        ts_monthly_prescriber_summary.time_period,
        ts_monthly_prescriber_summary.period_type,
        ts_monthly_prescriber_summary.period,
        ts_monthly_prescriber_summary.market_id,
        ts_monthly_prescriber_summary.market_name,
        ts_monthly_prescriber_summary.brand_id,
        ts_monthly_prescriber_summary.brand_name,
        ts_monthly_prescriber_summary.teva_product_flag,
        ts_monthly_prescriber_summary.customer_id,
        ts_monthly_prescriber_summary.tvcmid,
        ts_monthly_prescriber_summary.pdrp_flag,
        ts_monthly_prescriber_summary.hcp_restriction_flag,
        ts_monthly_prescriber_summary.prescriber_name,
        ts_monthly_prescriber_summary.new_prescriber,
        ts_monthly_prescriber_summary.address,
        ts_monthly_prescriber_summary.city,
        ts_monthly_prescriber_summary.state,
        ts_monthly_prescriber_summary.zip,
        ts_monthly_prescriber_summary.target_status_flag,
        ts_monthly_prescriber_summary.partner_target_status_flag,
        ts_monthly_prescriber_summary.method_of_payment,
        ts_monthly_prescriber_summary.specialty,
        ts_monthly_prescriber_summary.segment,
        ts_monthly_prescriber_summary.decile,
        ts_monthly_prescriber_summary.market_volume_indicator,
        ts_monthly_prescriber_summary.product_vol_trx_count,
        ts_monthly_prescriber_summary.market_vol_trx_count,
        ts_monthly_prescriber_summary.prev_prod_vol_trx_count,
        ts_monthly_prescriber_summary.prev_market_vol_trx_count,
        ts_monthly_prescriber_summary.product_vol_nrx_count,
        ts_monthly_prescriber_summary.market_vol_nrx_count,
        ts_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        ts_monthly_prescriber_summary.prev_market_vol_nrx_count,
        ts_monthly_prescriber_summary.samples,
        ts_monthly_prescriber_summary.details_p1,
        ts_monthly_prescriber_summary.details_p2,
        ts_monthly_prescriber_summary.details_p3
 FROM sandbox.ts_monthly_prescriber_summary
 ORDER BY ts_monthly_prescriber_summary.sales_force_id,
          ts_monthly_prescriber_summary.nation_id,
          ts_monthly_prescriber_summary.nation,
          ts_monthly_prescriber_summary.area_id,
          ts_monthly_prescriber_summary.area,
          ts_monthly_prescriber_summary.region_id,
          ts_monthly_prescriber_summary.region,
          ts_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(ts_monthly_prescriber_summary.market_id, ts_monthly_prescriber_summary.brand_id, ts_monthly_prescriber_summary.teva_product_flag, ts_monthly_prescriber_summary.tvcmid, ts_monthly_prescriber_summary.pdrp_flag, ts_monthly_prescriber_summary.new_prescriber, ts_monthly_prescriber_summary.state, ts_monthly_prescriber_summary.zip) ALL NODES;

CREATE PROJECTION sandbox.tn_pre_calls_anti_psych_b0 /*+basename(tn_pre_calls_anti_psych),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target,
 AssistRx_flag,
 ShSol_flag
)
AS
 SELECT tn_pre_calls_anti_psych.sales_force_id,
        tn_pre_calls_anti_psych.nation_id,
        tn_pre_calls_anti_psych.nation,
        tn_pre_calls_anti_psych.area_id,
        tn_pre_calls_anti_psych.area,
        tn_pre_calls_anti_psych.region_id,
        tn_pre_calls_anti_psych.region,
        tn_pre_calls_anti_psych.territory_id,
        tn_pre_calls_anti_psych.territory,
        tn_pre_calls_anti_psych.rep_name,
        tn_pre_calls_anti_psych.user_id,
        tn_pre_calls_anti_psych.time_period,
        tn_pre_calls_anti_psych.period_type,
        tn_pre_calls_anti_psych.period,
        tn_pre_calls_anti_psych.market_id,
        tn_pre_calls_anti_psych.market_name,
        tn_pre_calls_anti_psych.brand_id,
        tn_pre_calls_anti_psych.brand_name,
        tn_pre_calls_anti_psych.teva_product_flag,
        tn_pre_calls_anti_psych.payer_id,
        tn_pre_calls_anti_psych.payer_name,
        tn_pre_calls_anti_psych.plan_id,
        tn_pre_calls_anti_psych.plan_name,
        tn_pre_calls_anti_psych.payer_plan_id,
        tn_pre_calls_anti_psych.customer_id,
        tn_pre_calls_anti_psych.tvcmid,
        tn_pre_calls_anti_psych.hcp_plan_vol_rank,
        tn_pre_calls_anti_psych.prescriber_name,
        tn_pre_calls_anti_psych.pdrp_flag,
        tn_pre_calls_anti_psych.hcp_restriction_flag,
        tn_pre_calls_anti_psych.address,
        tn_pre_calls_anti_psych.city,
        tn_pre_calls_anti_psych.state,
        tn_pre_calls_anti_psych.zip,
        tn_pre_calls_anti_psych.target_status_flag,
        tn_pre_calls_anti_psych.partner_target_status_flag,
        tn_pre_calls_anti_psych.method_of_payment,
        tn_pre_calls_anti_psych.specialty,
        tn_pre_calls_anti_psych.segment,
        tn_pre_calls_anti_psych.decile,
        tn_pre_calls_anti_psych.market_volume_indicator,
        tn_pre_calls_anti_psych.product_vol_trx_count,
        tn_pre_calls_anti_psych.market_vol_trx_count,
        tn_pre_calls_anti_psych.prev_prod_vol_trx_count,
        tn_pre_calls_anti_psych.prev_market_vol_trx_count,
        tn_pre_calls_anti_psych.product_vol_nrx_count,
        tn_pre_calls_anti_psych.market_vol_nrx_count,
        tn_pre_calls_anti_psych.prev_prod_vol_nrx_count,
        tn_pre_calls_anti_psych.prev_market_vol_nrx_count,
        tn_pre_calls_anti_psych.samples,
        tn_pre_calls_anti_psych.details_p1,
        tn_pre_calls_anti_psych.details_p2,
        tn_pre_calls_anti_psych.details_p3,
        tn_pre_calls_anti_psych.focus_target,
        tn_pre_calls_anti_psych.AssistRx_flag,
        tn_pre_calls_anti_psych.ShSol_flag
 FROM sandbox.tn_pre_calls_anti_psych
 ORDER BY tn_pre_calls_anti_psych.sales_force_id,
          tn_pre_calls_anti_psych.nation_id,
          tn_pre_calls_anti_psych.nation,
          tn_pre_calls_anti_psych.area_id,
          tn_pre_calls_anti_psych.area,
          tn_pre_calls_anti_psych.region_id,
          tn_pre_calls_anti_psych.region,
          tn_pre_calls_anti_psych.territory_id
SEGMENTED BY hash(tn_pre_calls_anti_psych.customer_id) ALL NODES;


CREATE  VIEW sandbox.V_HCOS_KAISER_PROF_AFFIL AS
 SELECT hcp.tvcmid AS TVCMID,
        p.ims_id AS IMS_ID,
        p.npi AS NPI,
        p.all_dea AS ALL_DEA,
        p.last_name AS LAST_NAME,
        p.first_name AS FIRST_NAME,
        p.middle_name AS MIDDLE_NAME,
        at.affil_type_desc AS AFFIL_TYPE_DESC,
        b.ims_org_id AS IMS_FACILITY_NUMBER,
        b.cot_facility_type AS COT_FACILITY_TYPE,
        b.business_name AS BUSINESS_NAME,
        b.physical_addr_1 AS PHYSICAL_ADDR_1,
        b.physical_addr_2 AS PHYSICAL_ADDR_2,
        b.physical_city AS PHYSICAL_CITY,
        b.physical_state AS PHYSICAL_STATE,
        b.physical_zip AS PHYSICAL_ZIP
 FROM (((((( SELECT bx.ims_org_id,
        bx.cot_facility_type,
        bx.business_name,
        bx.physical_addr_1,
        bx.physical_addr_2,
        bx.physical_city,
        bx.physical_state,
        bx.physical_zip
 FROM hcos.ims_hcos_business bx
 WHERE (bx.file_id = ( SELECT max(ims_hcos_business.file_id) AS file_id
 FROM hcos.ims_hcos_business))) b JOIN ( SELECT pafx.ims_org_id,
        pafx.hce_id_prfsnl,
        pafx.affil_type_id
 FROM hcos.ims_hcos_provider_affiliation_fact pafx
 WHERE (pafx.file_id = ( SELECT max(ims_hcos_provider_affiliation_fact.file_id) AS file_id
 FROM hcos.ims_hcos_provider_affiliation_fact))) paf ON ((b.ims_org_id = paf.ims_org_id))) JOIN ( SELECT px.ims_id,
        px.npi,
        px.all_dea,
        px.last_name,
        px.first_name,
        px.middle_name,
        px.hce_id_prfsnl
 FROM hcos.ims_hcos_professional px
 WHERE (px.file_id = ( SELECT max(ims_hcos_professional.file_id) AS file_id
 FROM hcos.ims_hcos_professional))) p ON ((paf.hce_id_prfsnl = p.hce_id_prfsnl))) LEFT  JOIN ( SELECT atx.affil_type_id,
        atx.affil_type_desc
 FROM hcos.ims_hcos_affiliation_type atx
 WHERE (atx.file_id = ( SELECT max(ims_hcos_affiliation_type.file_id) AS file_id
 FROM hcos.ims_hcos_affiliation_type))) at ON ((paf.affil_type_id = at.affil_type_id))) JOIN ( SELECT rfx.ims_org_id_child,
        rfx.ims_org_id_parent
 FROM hcos.ims_hcos_relationship_fact rfx
 WHERE (rfx.file_id = ( SELECT max(ims_hcos_relationship_fact.file_id) AS max
 FROM hcos.ims_hcos_relationship_fact))) rf ON ((b.ims_org_id = rf.ims_org_id_child))) LEFT  JOIN mdm.hcp hcp ON ((p.ims_id = hcp.ims_prescriber_id)))
 WHERE (rf.ims_org_id_parent = 'INS00000226'::varchar(11));

CREATE  VIEW sandbox.test_view AS
 SELECT ftf_restrictions.health_plan_id,
        ftf_restrictions.drug_id,
        ftf_restrictions.restriction_detail_id,
        ftf_restrictions.restriction_code,
        ftf_restrictions.formulary_entry_restriction_id,
        ftf_restrictions.restriction_detail_text,
        ftf_restrictions.restriction_addtnl_information_1,
        ftf_restrictions.restriction_addtnl_information_2,
        ftf_restrictions.record_id,
        ftf_restrictions.file_id
 FROM cleansed.ftf_restrictions
 WHERE (ftf_restrictions.file_id IN ( SELECT max(ftf_restrictions.file_id) AS max
 FROM cleansed.ftf_restrictions));

CREATE  VIEW sandbox.vw_ftf_formularies AS
 SELECT ftf_formularies.health_plan_id,
        ftf_formularies.drug_id,
        ftf_formularies.tier_code,
        ftf_formularies.restrictions,
        ftf_formularies.reason_code,
        ftf_formularies.reason_code_description,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW sandbox.vw_prev_month_payer_spine25_detailed_teva_brands_cdw_v1 AS
 SELECT payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.payment_type,
        payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_detailed_teva_brands_cdw_v1.saba_trx
 FROM sandbox.payer_spine25_detailed_teva_brands_cdw_v1
 WHERE (payer_spine25_detailed_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_detailed_teva_brands_cdw_v1'::varchar(41)))))));

CREATE  VIEW sandbox.vw_curr_comparison_payer_spine_cdw_v1 AS
 SELECT comparison_payer_spine_cdw_v1.iqvia_plan_code,
        comparison_payer_spine_cdw_v1.iqvia_plan_name,
        comparison_payer_spine_cdw_v1.iqvia_payer_name,
        comparison_payer_spine_cdw_v1.iqvia_pbm,
        comparison_payer_spine_cdw_v1.key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.key_controlling_account,
        comparison_payer_spine_cdw_v1.key_controlling_parent,
        comparison_payer_spine_cdw_v1.payer_pbm,
        comparison_payer_spine_cdw_v1.payment_type,
        comparison_payer_spine_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.lives_plan_lvl,
        comparison_payer_spine_cdw_v1.apportionment_factor,
        comparison_payer_spine_cdw_v1.saba_trx,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_code,
        comparison_payer_spine_cdw_v1.change_iqvia_plan_name,
        comparison_payer_spine_cdw_v1.change_iqvia_payer_name,
        comparison_payer_spine_cdw_v1.change_iqvia_pbm,
        comparison_payer_spine_cdw_v1.change_key_controlling_plan_formulary,
        comparison_payer_spine_cdw_v1.change_key_controlling_account,
        comparison_payer_spine_cdw_v1.change_key_controlling_parent,
        comparison_payer_spine_cdw_v1.change_payer_pbm,
        comparison_payer_spine_cdw_v1.change_payment_type,
        comparison_payer_spine_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_payer_spine_cdw_v1.change_lives_plan_kcf_lvl,
        comparison_payer_spine_cdw_v1.change_lives_plan_lvl,
        comparison_payer_spine_cdw_v1.change_apportionment_factor,
        comparison_payer_spine_cdw_v1.change_saba_trx,
        comparison_payer_spine_cdw_v1.change,
        comparison_payer_spine_cdw_v1.month_flag,
        comparison_payer_spine_cdw_v1.status,
        comparison_payer_spine_cdw_v1.cycle_id,
        comparison_payer_spine_cdw_v1.modified_time,
        comparison_payer_spine_cdw_v1.modified_by
 FROM sandbox.comparison_payer_spine_cdw_v1
 WHERE (comparison_payer_spine_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_payer_spine_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_iqvia_plans_discard AS
 SELECT iqvia_plans_discard_v01.payer_id,
        btrim(iqvia_plans_discard_v01.notes) AS notes
 FROM sandbox.iqvia_plans_discard_v01
 WHERE (iqvia_plans_discard_v01.file_id IN ( SELECT max(iqvia_plans_discard_v01.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v01));

CREATE  VIEW sandbox.vw_model_paytype_map AS
 SELECT btrim(model_paytype_map_v01.model) AS model,
        btrim(model_paytype_map_v01.paytype) AS paytype,
        btrim(model_paytype_map_v01.notes) AS notes
 FROM sandbox.model_paytype_map_v01
 WHERE (model_paytype_map_v01.file_id IN ( SELECT max(model_paytype_map_v01.file_id) AS max
 FROM sandbox.model_paytype_map_v01));

CREATE  VIEW sandbox.vw_iqvia_paytypeindex AS
 SELECT iqvia_paytypeindex_v01.paytype_index,
        btrim(iqvia_paytypeindex_v01.paytype) AS paytype
 FROM sandbox.iqvia_paytypeindex_v01
 WHERE (iqvia_paytypeindex_v01.file_id IN ( SELECT max(iqvia_paytypeindex_v01.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v01));

CREATE  VIEW sandbox.vw_iqvia_payer_paytype_override AS
 SELECT btrim(iqvia_payer_paytype_override_v01.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v01.paytype) AS paytype
 FROM sandbox.iqvia_payer_paytype_override_v01
 WHERE (iqvia_payer_paytype_override_v01.file_id IN ( SELECT max(iqvia_payer_paytype_override_v01.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v01));

CREATE  VIEW sandbox.vw_ftf_plans_paytypeindex AS
 SELECT btrim(ftf_plans_paytypeindex_v01.ftf_health_plan_type) AS ftf_health_plan_type,
        ftf_plans_paytypeindex_v01.paytype_index
 FROM sandbox.ftf_plans_paytypeindex_v01
 WHERE (ftf_plans_paytypeindex_v01.file_id IN ( SELECT max(ftf_plans_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v01));

CREATE  VIEW sandbox.vw_ftf_paytype_paytypeindex AS
 SELECT ftf_paytype_paytypeindex_v01.paytype_index,
        btrim(ftf_paytype_paytypeindex_v01.paytype) AS paytype
 FROM sandbox.ftf_paytype_paytypeindex_v01
 WHERE (ftf_paytype_paytypeindex_v01.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v01));

CREATE  VIEW sandbox.vw_ftf_override_provider AS
 SELECT ftf_override_provider_v01.provider_fid,
        ftf_override_provider_v01.paytype_index,
        btrim(ftf_override_provider_v01.notes) AS notes
 FROM sandbox.ftf_override_provider_v01
 WHERE (ftf_override_provider_v01.file_id IN ( SELECT max(ftf_override_provider_v01.file_id) AS max
 FROM sandbox.ftf_override_provider_v01));

CREATE  VIEW sandbox.vw_ftf_override_plan AS
 SELECT ftf_override_plan_v01.ftf_health_plan_fid,
        ftf_override_plan_v01.paytype_index,
        btrim(ftf_override_plan_v01.notes) AS notes
 FROM sandbox.ftf_override_plan_v01
 WHERE (ftf_override_plan_v01.file_id IN ( SELECT max(ftf_override_plan_v01.file_id) AS max
 FROM sandbox.ftf_override_plan_v01));

CREATE  VIEW sandbox.vw_drug_assignments AS
 SELECT drug_assignments_v01.drug_id,
        drug_assignments_v01.drug_seq,
        btrim(drug_assignments_v01.product) AS product
 FROM sandbox.drug_assignments_v01
 WHERE (drug_assignments_v01.file_id IN ( SELECT max(drug_assignments_v01.file_id) AS max
 FROM sandbox.drug_assignments_v01));

CREATE  VIEW sandbox.vw_ftf_pbm_functions AS
 SELECT ftf_pbm_functions_v01.pbm_function_id,
        btrim(ftf_pbm_functions_v01.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v01.notes) AS notes,
        ftf_pbm_functions_v01.used
 FROM sandbox.ftf_pbm_functions_v01
 WHERE (ftf_pbm_functions_v01.file_id IN ( SELECT max(ftf_pbm_functions_v01.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v01));

CREATE  VIEW sandbox.vw_botox_step_restriction AS
 SELECT botox_step_restriction_v01.code,
        btrim(botox_step_restriction_v01.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v01.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v01.notes) AS notes
 FROM sandbox.botox_step_restriction_v01
 WHERE (botox_step_restriction_v01.file_id IN ( SELECT max(botox_step_restriction_v01.file_id) AS max
 FROM sandbox.botox_step_restriction_v01));

CREATE  VIEW sandbox.vw_step_restriction AS
 SELECT step_restriction_v01.code,
        btrim(step_restriction_v01.step_category) AS step_category,
        btrim(step_restriction_v01.restriction_group) AS restriction_group,
        btrim(step_restriction_v01.notes) AS notes
 FROM sandbox.step_restriction_v01
 WHERE (step_restriction_v01.file_id IN ( SELECT max(step_restriction_v01.file_id) AS max
 FROM sandbox.step_restriction_v01));

CREATE  VIEW sandbox.vw_pa_restriction AS
 SELECT pa_restriction_v01.code,
        btrim(pa_restriction_v01.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v01.notes) AS notes
 FROM sandbox.pa_restriction_v01
 WHERE (pa_restriction_v01.file_id IN ( SELECT max(pa_restriction_v01.file_id) AS max
 FROM sandbox.pa_restriction_v01));

CREATE  VIEW sandbox.vw_patient_pa_restriction AS
 SELECT patient_pa_restriction_v01.code,
        btrim(patient_pa_restriction_v01.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v01.notes) AS notes
 FROM sandbox.patient_pa_restriction_v01
 WHERE (patient_pa_restriction_v01.file_id IN ( SELECT max(patient_pa_restriction_v01.file_id) AS max
 FROM sandbox.patient_pa_restriction_v01));

CREATE  VIEW sandbox.vw_medical_rec_restriction AS
 SELECT medical_rec_restriction_v01.code,
        btrim(medical_rec_restriction_v01.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v01.notes) AS notes
 FROM sandbox.medical_rec_restriction_v01
 WHERE (medical_rec_restriction_v01.file_id IN ( SELECT max(medical_rec_restriction_v01.file_id) AS max
 FROM sandbox.medical_rec_restriction_v01));

CREATE  VIEW sandbox.vw_unspecified_rec_restriction AS
 SELECT unspecified_rec_restriction_v01.code,
        btrim(unspecified_rec_restriction_v01.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v01.notes) AS notes
 FROM sandbox.unspecified_rec_restriction_v01
 WHERE (unspecified_rec_restriction_v01.file_id IN ( SELECT max(unspecified_rec_restriction_v01.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v01));

CREATE  VIEW sandbox.vw_override_bridge_ftf_plan_types AS
 SELECT btrim(override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v01.override_precedence
 FROM sandbox.override_bridge_ftf_plan_types_v01
 WHERE (override_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_delete_bridge_ftf_plan_types AS
 SELECT btrim(delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.delete_flag) AS delete_flag
 FROM sandbox.delete_bridge_ftf_plan_types_v01
 WHERE (delete_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_provider_override_default AS
 SELECT provider_override_default_v01.provider_id,
        btrim(provider_override_default_v01.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v01.provider_name) AS provider_name,
        btrim(provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_pbm) AS override_best_iqvia_pbm
 FROM sandbox.provider_override_default_v01
 WHERE (provider_override_default_v01.file_id IN ( SELECT max(provider_override_default_v01.file_id) AS max
 FROM sandbox.provider_override_default_v01));

CREATE  VIEW sandbox.vw_key_controller_list AS
 SELECT key_controller_list_v01.ftf_health_plan_fid,
        btrim(key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v01.payer_pbm) AS payer_pbm
 FROM sandbox.key_controller_list_v01
 WHERE (key_controller_list_v01.file_id IN ( SELECT max(key_controller_list_v01.file_id) AS max
 FROM sandbox.key_controller_list_v01));

CREATE  VIEW sandbox.vw_calculated_pbm_config AS
 SELECT btrim(calculated_pbm_config_v01.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v01.calculated_pbm_column) AS calculated_pbm_column
 FROM sandbox.calculated_pbm_config_v01
 WHERE (calculated_pbm_config_v01.file_id IN ( SELECT max(calculated_pbm_config_v01.file_id) AS max
 FROM sandbox.calculated_pbm_config_v01));

CREATE  VIEW sandbox.vw_calc_pbm_key_pbm_mapping AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v01.calculated_pbm) AS calculated_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.added_by) AS added_by
 FROM sandbox.calc_pbm_key_pbm_mapping_v01
 WHERE (calc_pbm_key_pbm_mapping_v01.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v01.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v01));

CREATE  VIEW sandbox.vw_has_pa_mapping AS
 SELECT has_pa_mapping_v01.has_pa,
        btrim(has_pa_mapping_v01.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v01.notes) AS notes
 FROM sandbox.has_pa_mapping_v01
 WHERE (has_pa_mapping_v01.file_id IN ( SELECT max(has_pa_mapping_v01.file_id) AS max
 FROM sandbox.has_pa_mapping_v01));

CREATE  VIEW sandbox.vw_has_st_mapping AS
 SELECT has_st_mapping_v01.has_st,
        btrim(has_st_mapping_v01.st_regex) AS st_regex,
        btrim(has_st_mapping_v01.notes) AS notes
 FROM sandbox.has_st_mapping_v01
 WHERE (has_st_mapping_v01.file_id IN ( SELECT max(has_st_mapping_v01.file_id) AS max
 FROM sandbox.has_st_mapping_v01));

CREATE  VIEW sandbox.vw_formulary_derivation_config AS
 SELECT btrim(formulary_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v01.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v01.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v01.formulary) AS formulary,
        btrim(formulary_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex
 FROM sandbox.formulary_derivation_config_v01
 WHERE (formulary_derivation_config_v01.file_id IN ( SELECT max(formulary_derivation_config_v01.file_id) AS max
 FROM sandbox.formulary_derivation_config_v01));

CREATE  VIEW sandbox.vw_copay_tier_derivation_config AS
 SELECT btrim(copay_tier_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        copay_tier_derivation_config_v01.tier_cat,
        btrim(copay_tier_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v01.copay_tier) AS copay_tier
 FROM sandbox.copay_tier_derivation_config_v01
 WHERE (copay_tier_derivation_config_v01.file_id IN ( SELECT max(copay_tier_derivation_config_v01.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v01));

CREATE  VIEW sandbox.vw_tier_cat_description_mapping AS
 SELECT tier_cat_description_mapping_v01.tier_cat,
        btrim(tier_cat_description_mapping_v01.description) AS description,
        btrim(tier_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.tier_cat_description_mapping_v01
 WHERE (tier_cat_description_mapping_v01.file_id IN ( SELECT max(tier_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.tier_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_restriction_category_derivation_config AS
 SELECT btrim(restriction_category_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v01.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v01.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v01.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v01.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v01.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v01.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v01.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v01.restcat,
        btrim(restriction_category_derivation_config_v01.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v01.meaning) AS meaning
 FROM sandbox.restriction_category_derivation_config_v01
 WHERE (restriction_category_derivation_config_v01.file_id IN ( SELECT max(restriction_category_derivation_config_v01.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_restriction_cat_description_mapping AS
 SELECT btrim(restriction_cat_description_mapping_v01.rest_cat) AS rest_cat,
        btrim(restriction_cat_description_mapping_v01.description) AS description,
        btrim(restriction_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.restriction_cat_description_mapping_v01
 WHERE (restriction_cat_description_mapping_v01.file_id IN ( SELECT max(restriction_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.restriction_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_coverage_category_derivation_config AS
 SELECT btrim(coverage_category_derivation_config_v01.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v01.coverage_cat_code,
        btrim(coverage_category_derivation_config_v01.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v01.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v01.meaning) AS meaning
 FROM sandbox.coverage_category_derivation_config_v01
 WHERE (coverage_category_derivation_config_v01.file_id IN ( SELECT max(coverage_category_derivation_config_v01.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_coverage_cat_description_mapping AS
 SELECT btrim(coverage_cat_description_mapping_v01.coverage_cat) AS coverage_cat,
        btrim(coverage_cat_description_mapping_v01.description) AS description,
        btrim(coverage_cat_description_mapping_v01.notes) AS notes
 FROM sandbox.coverage_cat_description_mapping_v01
 WHERE (coverage_cat_description_mapping_v01.file_id IN ( SELECT max(coverage_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.coverage_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_step_restriction_description AS
 SELECT step_restriction_description_v01.step,
        btrim(step_restriction_description_v01.description) AS description
 FROM sandbox.step_restriction_description_v01
 WHERE (step_restriction_description_v01.file_id IN ( SELECT max(step_restriction_description_v01.file_id) AS max
 FROM sandbox.step_restriction_description_v01));

CREATE  VIEW sandbox.vw_pres_pa_restriction_description AS
 SELECT pres_pa_restriction_description_v01.prespa,
        btrim(pres_pa_restriction_description_v01.description) AS description
 FROM sandbox.pres_pa_restriction_description_v01
 WHERE (pres_pa_restriction_description_v01.file_id IN ( SELECT max(pres_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_pat_pa_restriction_description AS
 SELECT pat_pa_restriction_description_v01.patpa,
        btrim(pat_pa_restriction_description_v01.description) AS description
 FROM sandbox.pat_pa_restriction_description_v01
 WHERE (pat_pa_restriction_description_v01.file_id IN ( SELECT max(pat_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_override_fid_iqvia_key_controller_list AS
 SELECT override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
        btrim(override_fid_iqvia_key_controller_list_v01.iqvia_plan_name) AS iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
        btrim(override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(override_fid_iqvia_key_controller_list_v01.payer_pbm) AS payer_pbm
 FROM sandbox.override_fid_iqvia_key_controller_list_v01
 WHERE (override_fid_iqvia_key_controller_list_v01.file_id IN ( SELECT max(override_fid_iqvia_key_controller_list_v01.file_id) AS max
 FROM sandbox.override_fid_iqvia_key_controller_list_v01));

CREATE  VIEW sandbox.vw_comparison_payer_spine_detailed_report AS
 SELECT a.iqvia_plan_code AS "IQVIA Plan Code",
        a.iqvia_plan_name AS "IQVIA Plan Name",
        a.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        a.iqvia_payer_name AS "IQVIA Payer Name",
        a.iqvia_pbm AS "IQVIA PBM",
        a.key_controlling_account AS "Key Controlling Account",
        a.key_controlling_parent AS "Key Controlling Parent",
        a.payer_pbm AS "PBM/Payer",
        a.payment_type AS "Payment Type",
        a.ajovy_access_for_ftf_plan AS "AJOVY Access for FTF Plan",
        a.aimovig_access_for_ftf_plan AS "Aimovig Access for FTF Plan",
        a.emgality_access_for_ftf_plan AS "Emgality Access for FTF Plan",
        a.apportionment_factor AS "Apportionment Factor",
        a.saba_trx AS "Apportionment SABA TRx",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_code = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Code Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan Formulary Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "PBM/Payer Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payment_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payment Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ajovy_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "AJOVY Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_aimovig_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Aimovig Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_emgality_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Emgality Access for FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_apportionment_factor = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Apportionment Factor Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_saba_trx = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Apportionment SABA TRx Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        a.month_flag AS "Month Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        0 AS "Change in TRx",
        tbl_lvl_audit.date_run AS "Date Run",
        (to_timestamptz((a.cycle_id)::float))::timestamp AS "Modified Time"
 FROM (sandbox.vw_curr_comparison_payer_spine_cdw_v1 a LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_payer_spine_cdw_v1'::varchar(29))))
 ORDER BY a.iqvia_plan_code,
          a.key_controlling_plan_formulary;

CREATE  VIEW sandbox.vw_curr_saba_mkt_ajovy_payer_spine_prod_list AS
 SELECT btrim(saba_mkt_ajovy_payer_spine_prod_list.product_name) AS product_name,
        btrim(saba_mkt_ajovy_payer_spine_prod_list.notes) AS notes,
        saba_mkt_ajovy_payer_spine_prod_list.file_id,
        saba_mkt_ajovy_payer_spine_prod_list.record_id
 FROM sandbox.saba_mkt_ajovy_payer_spine_prod_list
 WHERE (saba_mkt_ajovy_payer_spine_prod_list.file_id IN ( SELECT max(saba_mkt_ajovy_payer_spine_prod_list.file_id) AS max
 FROM sandbox.saba_mkt_ajovy_payer_spine_prod_list));

CREATE  VIEW sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1 AS
 SELECT comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.payment_type,
        comparison_iqvia_fid_plans_cdw_v1.iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.nurtec_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.qulipta_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_code,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_payer_name,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_payment_type,
        comparison_iqvia_fid_plans_cdw_v1.change_iqvia_model,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_fid,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_name,
        comparison_iqvia_fid_plans_cdw_v1.change_ftf_health_plan_type,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_plan_formulary,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_account,
        comparison_iqvia_fid_plans_cdw_v1.change_key_controlling_parent,
        comparison_iqvia_fid_plans_cdw_v1.change_payer_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_ajovy_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_aimovig_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_emgality_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_nurtec_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_qulipta_access_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_total_lives_for_ftf_plan,
        comparison_iqvia_fid_plans_cdw_v1.change_key_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_payer,
        comparison_iqvia_fid_plans_cdw_v1.check_iq_pbm,
        comparison_iqvia_fid_plans_cdw_v1.change_in_lives,
        comparison_iqvia_fid_plans_cdw_v1.month_flag,
        comparison_iqvia_fid_plans_cdw_v1.status,
        comparison_iqvia_fid_plans_cdw_v1.cycle_id,
        comparison_iqvia_fid_plans_cdw_v1.modified_time,
        comparison_iqvia_fid_plans_cdw_v1.modified_by
 FROM sandbox.comparison_iqvia_fid_plans_cdw_v1
 WHERE (comparison_iqvia_fid_plans_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_iqvia_fid_plans_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1 AS
 SELECT comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.paytype,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Nurtec,
        comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Qulipta,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_fid,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_provider_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_parent_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_paytype,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_health_plan_type,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_account,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_plan_formulary,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_controlling_parent,
        comparison_ftf_health_plan_fid_cdw_v1.change_payer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_key_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_management_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_formulary_influencer_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_ftf_claims_processing_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_lives_mn,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_payer_name,
        comparison_ftf_health_plan_fid_cdw_v1.change_iqvia_pbm,
        comparison_ftf_health_plan_fid_cdw_v1.change_pref_brand_tier,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Ajovy,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Aimovig,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Emgality,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Nurtec,
        comparison_ftf_health_plan_fid_cdw_v1.change_Coverage_Category_Qulipta,
        comparison_ftf_health_plan_fid_cdw_v1.change,
        comparison_ftf_health_plan_fid_cdw_v1.month_flag,
        comparison_ftf_health_plan_fid_cdw_v1.status,
        comparison_ftf_health_plan_fid_cdw_v1.change_in_lives,
        comparison_ftf_health_plan_fid_cdw_v1.cycle_id,
        comparison_ftf_health_plan_fid_cdw_v1.modified_time,
        comparison_ftf_health_plan_fid_cdw_v1.modified_by
 FROM sandbox.comparison_ftf_health_plan_fid_cdw_v1
 WHERE (comparison_ftf_health_plan_fid_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_ftf_health_plan_fid_cdw_v1'::varchar(37)))))));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_xref_v2_cdw_v1 AS
 SELECT ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_payer_name,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_pbm,
        ftf_iqvia_xref_v2_cdw_v1.payment_type,
        ftf_iqvia_xref_v2_cdw_v1.iqvia_model,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_v2_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_v2_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_v2_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_v2_cdw_v1.payer_pbm,
        ftf_iqvia_xref_v2_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.nurtec_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.qulipta_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.austedo_hd_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.austedo_td_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.ingrezza_td_access_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_v2_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_v2_cdw_v1.key_pbm,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_v2_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_v2_cdw_v1.cycle_id,
        ftf_iqvia_xref_v2_cdw_v1.modified_time,
        ftf_iqvia_xref_v2_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_xref_v2_cdw_v1
 WHERE (ftf_iqvia_xref_v2_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_xref_v2_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_access_master_bridge_cdw_v1 AS
 SELECT access_master_bridge_cdw_v1.ftf_health_plan_fid,
        access_master_bridge_cdw_v1.ftf_health_plan_name,
        access_master_bridge_cdw_v1.coverage_category_ajovy,
        access_master_bridge_cdw_v1.coverage_category_aimovig,
        access_master_bridge_cdw_v1.coverage_category_emgality,
        access_master_bridge_cdw_v1.coverage_category_nurtec,
        access_master_bridge_cdw_v1.coverage_category_qulitpa,
        access_master_bridge_cdw_v1.coverage_category_austedo_hd,
        access_master_bridge_cdw_v1.coverage_category_austedo_td,
        access_master_bridge_cdw_v1.coverage_category_ingrezza_td,
        access_master_bridge_cdw_v1.ftf_provider_fid,
        access_master_bridge_cdw_v1.ftf_provider_name,
        access_master_bridge_cdw_v1.ftf_parent_name,
        access_master_bridge_cdw_v1.paytype_index,
        access_master_bridge_cdw_v1.paytype,
        access_master_bridge_cdw_v1.ftf_health_plan_type,
        access_master_bridge_cdw_v1.key_controlling_plan_formulary,
        access_master_bridge_cdw_v1.key_controlling_account,
        access_master_bridge_cdw_v1.key_controlling_parent,
        access_master_bridge_cdw_v1.payer_pbm,
        access_master_bridge_cdw_v1.key_pbm,
        access_master_bridge_cdw_v1.iqvia_payer_name,
        access_master_bridge_cdw_v1.iqvia_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_management_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm,
        access_master_bridge_cdw_v1.ftf_claims_processing_pbm,
        access_master_bridge_cdw_v1.pref_brand_tier,
        access_master_bridge_cdw_v1.ftf_match_iqvia,
        access_master_bridge_cdw_v1.previous_lives,
        access_master_bridge_cdw_v1.current_lives,
        access_master_bridge_cdw_v1.cycle_id,
        access_master_bridge_cdw_v1.modified_time,
        access_master_bridge_cdw_v1.modified_by
 FROM sandbox.access_master_bridge_cdw_v1
 WHERE (access_master_bridge_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'access_master_bridge_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_prev_month_access_master_bridge_cdw_v1 AS
 SELECT access_master_bridge_cdw_v1.ftf_health_plan_fid,
        access_master_bridge_cdw_v1.ftf_health_plan_name,
        access_master_bridge_cdw_v1.coverage_category_ajovy,
        access_master_bridge_cdw_v1.coverage_category_aimovig,
        access_master_bridge_cdw_v1.coverage_category_emgality,
        access_master_bridge_cdw_v1.coverage_category_nurtec,
        access_master_bridge_cdw_v1.coverage_category_qulitpa,
        access_master_bridge_cdw_v1.coverage_category_austedo_hd,
        access_master_bridge_cdw_v1.coverage_category_austedo_td,
        access_master_bridge_cdw_v1.coverage_category_ingrezza_td,
        access_master_bridge_cdw_v1.ftf_provider_fid,
        access_master_bridge_cdw_v1.ftf_provider_name,
        access_master_bridge_cdw_v1.ftf_parent_name,
        access_master_bridge_cdw_v1.paytype_index,
        access_master_bridge_cdw_v1.paytype,
        access_master_bridge_cdw_v1.ftf_health_plan_type,
        access_master_bridge_cdw_v1.key_controlling_plan_formulary,
        access_master_bridge_cdw_v1.key_controlling_account,
        access_master_bridge_cdw_v1.key_controlling_parent,
        access_master_bridge_cdw_v1.payer_pbm,
        access_master_bridge_cdw_v1.key_pbm,
        access_master_bridge_cdw_v1.iqvia_payer_name,
        access_master_bridge_cdw_v1.iqvia_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_management_pbm,
        access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm,
        access_master_bridge_cdw_v1.ftf_claims_processing_pbm,
        access_master_bridge_cdw_v1.pref_brand_tier,
        access_master_bridge_cdw_v1.ftf_match_iqvia,
        access_master_bridge_cdw_v1.previous_lives,
        access_master_bridge_cdw_v1.current_lives,
        access_master_bridge_cdw_v1.cycle_id,
        access_master_bridge_cdw_v1.modified_time,
        access_master_bridge_cdw_v1.modified_by
 FROM sandbox.access_master_bridge_cdw_v1
 WHERE (access_master_bridge_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'access_master_bridge_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_curr_amb4_cdw_v1 AS
 SELECT amb4_cdw_v1.ftf_health_plan_fid,
        amb4_cdw_v1.ftf_health_plan_name,
        amb4_cdw_v1.old_coverage_category_ajovy,
        amb4_cdw_v1.old_coverage_category_aimovig,
        amb4_cdw_v1.old_coverage_category_emgality,
        amb4_cdw_v1.old_coverage_category_nurtec,
        amb4_cdw_v1.old_coverage_category_qulitpa,
        amb4_cdw_v1.old_coverage_category_austedo_hd,
        amb4_cdw_v1.old_coverage_category_austedo_td,
        amb4_cdw_v1.old_coverage_category_ingrezza_td,
        amb4_cdw_v1.old_ftf_provider_fid,
        amb4_cdw_v1.old_ftf_provider_name,
        amb4_cdw_v1.old_ftf_parent_name,
        amb4_cdw_v1.old_paytype_index,
        amb4_cdw_v1.old_paytype,
        amb4_cdw_v1.old_ftf_health_plan_type,
        amb4_cdw_v1.old_pref_brand_tier,
        amb4_cdw_v1.old_key_controlling_plan_formulary,
        amb4_cdw_v1.old_key_controlling_account,
        amb4_cdw_v1.old_key_pbm,
        amb4_cdw_v1.old_payer_pbm,
        amb4_cdw_v1.fillIn_blank_iqpayer,
        amb4_cdw_v1.fillIn_blank_iqpbm,
        amb4_cdw_v1.ftf_match_iqvia,
        amb4_cdw_v1.old_iqvia_payer_name,
        amb4_cdw_v1.old_iqvia_pbm,
        amb4_cdw_v1.old_ftf_formulary_management_pbm,
        amb4_cdw_v1.old_ftf_formulary_influencer_pbm,
        amb4_cdw_v1.old_ftf_claims_processing_pbm,
        amb4_cdw_v1.lives_mx,
        amb4_cdw_v1.new_ftf_health_plan_fid,
        amb4_cdw_v1.old_ftf_health_plan_fid,
        amb4_cdw_v1.new_ftf_health_plan_name,
        amb4_cdw_v1.old_ftf_health_plan_name,
        amb4_cdw_v1.ftf_provider_fid,
        amb4_cdw_v1.ftf_provider_name,
        amb4_cdw_v1.ftf_parent_name,
        amb4_cdw_v1.paytype_index,
        amb4_cdw_v1.paytype,
        amb4_cdw_v1.ftf_health_plan_type,
        amb4_cdw_v1.pref_brand_tier,
        amb4_cdw_v1.lives_mn,
        amb4_cdw_v1.iqvia_payer_name,
        amb4_cdw_v1.iqvia_pbm,
        amb4_cdw_v1.ftf_formulary_management_pbm,
        amb4_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_cdw_v1.ftf_claims_processing_pbm,
        amb4_cdw_v1.cycle_id,
        amb4_cdw_v1.modified_time,
        amb4_cdw_v1.modified_by
 FROM sandbox.amb4_cdw_v1
 WHERE (amb4_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_cdw_v1'::varchar(11)))))));

CREATE  VIEW sandbox.vw_curr_pivot_plan_prod_master_cdw_v1 AS
 SELECT pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_name,
        pivot_plan_prod_master_cdw_v1.ftf_provider_fid,
        pivot_plan_prod_master_cdw_v1.ftf_provider_name,
        pivot_plan_prod_master_cdw_v1.ftf_parent_name,
        pivot_plan_prod_master_cdw_v1.paytype,
        pivot_plan_prod_master_cdw_v1.paytype_index,
        pivot_plan_prod_master_cdw_v1.ftf_health_plan_type,
        pivot_plan_prod_master_cdw_v1.key_controlling_account,
        pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_cdw_v1.key_controlling_parent,
        pivot_plan_prod_master_cdw_v1.payer_pbm,
        pivot_plan_prod_master_cdw_v1.key_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        pivot_plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        pivot_plan_prod_master_cdw_v1.lives_mn,
        pivot_plan_prod_master_cdw_v1.iqvia_payer_name,
        pivot_plan_prod_master_cdw_v1.iqvia_pbm,
        pivot_plan_prod_master_cdw_v1.pref_brand_tier,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Nurtec,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Qulipta,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Austedo_HD,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Austedo_TD,
        pivot_plan_prod_master_cdw_v1.Coverage_Category_Ingrezza_TD,
        pivot_plan_prod_master_cdw_v1.prev_lives,
        pivot_plan_prod_master_cdw_v1.ftf_match_iqvia,
        pivot_plan_prod_master_cdw_v1.cycle_id,
        pivot_plan_prod_master_cdw_v1.modified_time,
        pivot_plan_prod_master_cdw_v1.modified_by
 FROM sandbox.pivot_plan_prod_master_cdw_v1
 WHERE (pivot_plan_prod_master_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'pivot_plan_prod_master_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_xref_cdw_v1 AS
 SELECT ftf_iqvia_xref_cdw_v1.iqvia_plan_code,
        ftf_iqvia_xref_cdw_v1.iqvia_plan_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_payer_name,
        ftf_iqvia_xref_cdw_v1.xref_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.best_matched_iqvia_pbm,
        ftf_iqvia_xref_cdw_v1.paytype,
        ftf_iqvia_xref_cdw_v1.model,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_xref_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_xref_cdw_v1.ftf_provider_fid,
        ftf_iqvia_xref_cdw_v1.ftf_provider_name,
        ftf_iqvia_xref_cdw_v1.ftf_parent_name,
        ftf_iqvia_xref_cdw_v1.key_controlling_plan_formulary,
        ftf_iqvia_xref_cdw_v1.key_controlling_account,
        ftf_iqvia_xref_cdw_v1.key_controlling_parent,
        ftf_iqvia_xref_cdw_v1.payer_pbm,
        ftf_iqvia_xref_cdw_v1.ajovy_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.aimovig_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.emgality_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.nurtec_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.qulipta_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.austedo_hd_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.austedo_td_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.ingrezza_td_access_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.ftf_pref_brand_tier,
        ftf_iqvia_xref_cdw_v1.total_lives_for_ftf_plan,
        ftf_iqvia_xref_cdw_v1.key_pbm,
        ftf_iqvia_xref_cdw_v1.check_iq_payer,
        ftf_iqvia_xref_cdw_v1.check_iq_pbm,
        ftf_iqvia_xref_cdw_v1.cycle_id,
        ftf_iqvia_xref_cdw_v1.modified_time,
        ftf_iqvia_xref_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_xref_cdw_v1
 WHERE (ftf_iqvia_xref_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_xref_cdw_v1'::varchar(21)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1 AS
 SELECT iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.nurtec_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.qulipta_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_hd_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_td_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ingrezza_td_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
 WHERE (iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_code_ftf_hp_id_cdw_v1'::varchar(32)))))));

CREATE  VIEW sandbox.vw_prev_month_iqvia_plan_code_ftf_hp_id_cdw_v1 AS
 SELECT iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent,
        iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.nurtec_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.qulipta_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_hd_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_td_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.ingrezza_td_access_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan,
        iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm,
        iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_time,
        iqvia_plan_code_ftf_hp_id_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_code_ftf_hp_id_cdw_v1
 WHERE (iqvia_plan_code_ftf_hp_id_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = 'COMPLETED'::varchar(9)) AND (a.date_run < ( SELECT parent_process_execution.date_run
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_code_ftf_hp_id_cdw_v1'::varchar(32)))))));

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_health_plan_detail AS
 SELECT lpad((vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_ajovy AS "Coverage Category Ajovy",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_aimovig AS "Coverage Category Aimovig",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_emgality AS "Coverage Category Emgality",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_nurtec AS "Coverage Category Nurtec",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_qulitpa AS "Coverage Category Qulipta",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_austedo_hd AS "Coverage Category Austedo HD",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_austedo_td AS "Coverage Category Austedo TD",
        vw_curr_access_master_bridge_cdw_v1.coverage_category_ingrezza_td AS "Coverage Category Ingrezza TD",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_access_master_bridge_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_access_master_bridge_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_access_master_bridge_cdw_v1.paytype AS "Payment Type",
        vw_curr_access_master_bridge_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_access_master_bridge_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_access_master_bridge_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_access_master_bridge_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_access_master_bridge_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_access_master_bridge_cdw_v1.ftf_match_iqvia AS "FTF Match IQVIA",
        vw_curr_access_master_bridge_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_access_master_bridge_cdw_v1.previous_lives AS "Previous Month Lives",
        vw_curr_access_master_bridge_cdw_v1.current_lives AS "Current Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_access_master_bridge_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_iqvia_plan_code_ftf_hp_id AS
 SELECT lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payment_type AS "Payment Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.iqvia_model AS "IQVIA Model",
        lpad((vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ajovy_access_for_ftf_plan AS "Ajovy Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.aimovig_access_for_ftf_plan AS "Aimovig Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.emgality_access_for_ftf_plan AS "Emgality Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.nurtec_access_for_ftf_plan AS "Nurtec Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.qulipta_access_for_ftf_plan AS "Qulipta Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_hd_access_for_ftf_plan AS "Austedo HD Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.austedo_td_access_for_ftf_plan AS "Austedo TD Access For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.ingrezza_td_access_for_ftf_plan AS "Ingrezza TD Access For FTF Plan",
        (vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.total_lives_for_ftf_plan)::varchar AS "Total Lives For FTF Plan",
        vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1.key_pbm AS "Key PBM"
 FROM sandbox.vw_curr_iqvia_plan_code_ftf_hp_id_cdw_v1 UNION  SELECT '0000010001'::varchar(10) AS "IQVIA Plan Code",
        'CASH'::varchar(4) AS "IQVIA Plan Name",
        'CASH'::varchar(4) AS "IQVIA Payer Name",
        ''::varchar AS "IQVIA PBM",
        'CASH'::varchar(4) AS "Payment Type",
        ''::varchar AS "IQVIA Model",
        ''::varchar AS "FTF Health Plan FID",
        ''::varchar AS "FTF Health Plan Name",
        ''::varchar AS "FTF Health Plan Type",
        ''::varchar AS "Key Controlling Plan Formulary",
        ''::varchar AS "Key Controlling Account",
        ''::varchar AS "Key Controlling Parent",
        ''::varchar AS "Payer/PBM",
        ''::varchar AS "Ajovy Access For FTF Plan",
        ''::varchar AS "Aimovig Access For FTF Plan",
        ''::varchar AS "Emgality Access For FTF Plan",
        ''::varchar AS "Nurtec Access For FTF Plan",
        ''::varchar AS "Qulipta Access For FTF Plan",
        ''::varchar AS "Austedo HD Access For FTF Plan",
        ''::varchar AS "Austedo TD Access For FTF Plan",
        ''::varchar AS "Ingrezza TD Access For FTF Plan",
        ''::varchar AS "Total Lives For FTF Plan",
        ''::varchar AS "Key PBM"
 FROM v_catalog.dual;

CREATE  VIEW sandbox.create_paragard_anda_sales AS
SELECT sh.source_customer_id AS "BP #", NULL AS "Ortho E", sh.customer_name AS "BP Name", coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1) AS "Ship-to Street", sh.ship_to_city AS "Ship-to City", sh.ship_to_state AS "Ship-to State", sh.ship_to_zip AS "Ship-to ZipCd", NULL AS "Ship-to Ctry", NULL AS "Ship-to Phone", NULL AS "Ship-to Fax", NULL AS "Ship-to Email", ad.address AS "Bill-to Street", ad.city AS "Bill-to City", ad.state AS "Bill-to State", ad.zip_code AS "Bill-to ZipCd", NULL AS "Bill-to Ctry", NULL AS "Bill-to Phone", NULL AS "Bill-to Fax", NULL AS "Bill-to Email", CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END AS "Class of Trade", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS "Invoice #", CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END AS "Del Amt", to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS "Inv Date", CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END AS Packs, NULL AS UnitPrice, NULL AS Territory, NULL AS "Order Type Cd", NULL AS "Order Type Desc", NULL AS LOBCdDesc, NULL AS PriceMatrixDef, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))) AS ParentBPCd, NULL AS ParentBPCdDesc, NULL AS GrandParentBPCdDesc, NULL AS "PO#", NULL AS "UPS#", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS OrdNbr, NULL AS OrdLnNbr, NULL AS DiscAmt, NULL AS WhseCd, 'ANDA'::varchar(4) AS DATA_SOURCE, '51285020401'::varchar(11) AS NDC11_CODE FROM (datamart.specialty_pharmacy_shipment sh LEFT JOIN (SELECT tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code FROM datamart.tw_address) ad ON ((sh.tw_bill_to_address_id = ad.address_id))) WHERE ((sh.basket_name ~~ '%PARAGARD%'::varchar(10)) AND (sh.specialty_pharmacy_data_source = 'Anda'::varchar(4)) AND (sh.ship_date >= add_months(trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)), (-1))) AND (sh.ship_date < trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)))) GROUP BY sh.source_customer_id, NULL, sh.customer_name, coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1), sh.ship_to_city, sh.ship_to_state, sh.ship_to_zip, ad.address, ad.city, ad.state, ad.zip_code, CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END, CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END, CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END, to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)), CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END, CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))), 'ANDA'::varchar(4), '51285020401'::varchar(11);

CREATE  VIEW sandbox.knipper_merge_test AS
 SELECT merges.current_tvcmid AS TVCMIDWinner,
        merges.previous_tvcmid AS TVCMIDLoser,
        to_char((now())::date, 'MM/DD/YYYY'::varchar(10)) AS TVCMIDMergeEffectiveDate
 FROM mdm.merges
 GROUP BY merges.current_tvcmid,
          merges.previous_tvcmid,
          to_char((now())::date, 'MM/DD/YYYY'::varchar(10));

CREATE  VIEW sandbox.knipper_supplemental_test AS
 SELECT a.tvcmid AS TVCMID,
        CASE WHEN (a.medical_suffix IS NULL) THEN ''::varchar ELSE a.medical_suffix END AS ProfDesig,
        a.first_name AS FName,
        a.last_name AS Lname,
        CASE WHEN (a.middle_name IS NULL) THEN ''::varchar ELSE a.middle_name END AS MI,
        CASE WHEN (a.personal_suffix IS NULL) THEN ''::varchar ELSE a.personal_suffix END AS Suffix,
        CASE WHEN (a.hce_status_desc IS NULL) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'ACTIVE'::varchar(6)) THEN 'A'::varchar(1) WHEN (a.hce_status_desc = 'INACTIVE'::varchar(8)) THEN 'I'::varchar(1) ELSE 'D'::varchar(1) END AS Status,
        CASE WHEN (a.hce_status_desc = 'PRESUMED DEAD'::varchar(13)) THEN 'D'::varchar(1) WHEN (a.hce_status_desc = 'SEMI-RETIRED'::varchar(12)) THEN 'O'::varchar(1) WHEN (a.hce_status_desc = 'RETIRED'::varchar(7)) THEN 'R'::varchar(1) ELSE ''::varchar END AS DeleteReason,
        CASE WHEN ((a.hce_status_desc IS NULL) OR (a.hce_status_desc <> ALL (ARRAY['ACTIVE'::varchar(8), 'INACTIVE'::varchar(8)]))) THEN to_char(e.last_update_date, 'MM/DD/YYYY'::varchar(10)) ELSE ''::varchar END AS DeleteDate,
        CASE WHEN (a.primary_specialty IS NULL) THEN 'US'::varchar(2) ELSE a.primary_specialty END AS Specialty,
        CASE WHEN (a.address_line1 IS NULL) THEN ''::varchar ELSE a.address_line1 END AS Address1,
        CASE WHEN (a.address_line2 IS NULL) THEN ''::varchar ELSE a.address_line2 END AS Address2,
        ''::varchar AS Address3,
        CASE WHEN (a.city IS NULL) THEN ''::varchar ELSE a.city END AS City,
        CASE WHEN (a.state IS NULL) THEN ''::varchar ELSE a.state END AS State,
        CASE WHEN (a.zip IS NULL) THEN ''::varchar ELSE a.zip END AS Zip,
        CASE WHEN (b.sln IS NULL) THEN ''::varchar ELSE b.sln END AS SLN,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE CASE WHEN (b.sln_status_code = 'A'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END END AS SLNActiveFlag,
        CASE WHEN ((b.sln IS NULL) OR (b.sln = ''::varchar)) THEN ''::varchar ELSE to_char(b.sln_expiration_date, 'MM/DD/YYYY'::varchar(10)) END AS SLNExpirationDate,
        CASE WHEN (c.flag_value = 'Y'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNCWakeFlag,
        CASE WHEN (d.tvcmid IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP
 FROM (((((( SELECT prescriber_rx.tvcmid
 FROM datamart.prescriber_rx
 GROUP BY prescriber_rx.tvcmid) exp JOIN ( SELECT hcp_demo.tvcmid,
        hcp_demo.ims_id,
        hcp_demo.npi,
        hcp_demo.last_name,
        hcp_demo.first_name,
        hcp_demo.middle_name,
        hcp_demo.personal_suffix,
        hcp_demo.medical_suffix,
        hcp_demo.primary_specialty,
        hcp_demo.address_line1,
        hcp_demo.address_line2,
        hcp_demo.city,
        hcp_demo.state_code AS state,
        hcp_demo.zip,
        hcp_demo.business_phone,
        hcp_demo.business_email,
        hcp_demo.hce_status_desc,
        hcp_demo.file_id,
        hcp_demo.record_id,
        hcp_demo.np_pa_flag
 FROM datamart.customer_hcp_demographics hcp_demo
 WHERE (hcp_demo.file_id = ( SELECT max(customer_hcp_demographics.file_id) AS MAX
 FROM datamart.customer_hcp_demographics))) a ON ((exp.tvcmid = a.tvcmid))) JOIN ( SELECT sample_eligibility.sln,
        sample_eligibility.sln_state,
        sample_eligibility.sln_expiration_date,
        sample_eligibility.sln_status_code,
        sample_eligibility.tvcmid
 FROM mdm.sample_eligibility
 WHERE (sample_eligibility.file_id = ( SELECT max(sample_eligibility.file_id) AS MAX
 FROM mdm.sample_eligibility))) b ON (((a.tvcmid = b.tvcmid) AND (a.state = b.sln_state)))) LEFT  JOIN ( SELECT ims_flag.tvcmid,
        ims_flag.flag_type,
        ims_flag.flag_value
 FROM mdm.ims_flag
 WHERE ((ims_flag.file_id = ( SELECT max(ims_flag.file_id) AS MAX
 FROM mdm.ims_flag)) AND (ims_flag.flag_type = 'AMADNC'::varchar(6)))) c ON ((a.tvcmid = c.tvcmid))) LEFT  JOIN datamart.do_not_promote d ON ((a.tvcmid = d.tvcmid))) LEFT  JOIN ( SELECT hcp.updated_date AS last_update_date,
        hcp.tvcmid
 FROM mdm.hcp
 WHERE (hcp.file_id = ( SELECT max(hcp.file_id) AS MAX
 FROM mdm.hcp))) e ON ((a.tvcmid = e.tvcmid)));

CREATE  VIEW sandbox.ad_hoc_ad AS
 SELECT ('"'::varchar(1) || fed.id_num) AS federation_id,
        NULL AS contact,
        'Third_Party_Redemptions'::varchar(23) AS source,
        to_char(c.fill_date, 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS "datetime",
        concat((c.file_id)::varchar, (c.record_id)::varchar) AS trackback_id,
        NULL AS previous_activity,
        (brand.basket_id)::varchar(20) AS level_master_id,
        'HCP'::varchar(3) AS activity_role,
        'Voucher/Coupon_Redemption'::varchar(25) AS type,
        'Voucher/Coupon_Redemption'::varchar(25) AS native_type,
        ((((('Voucher/Coupon Redemption - '::varchar(28) || coalesce(b.name, ''::varchar)) || ','::varchar(1)) || coalesce(cvp.program_description, ''::varchar)) || ','::varchar(1)) || c.redemption_type) AS details,
        to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) AS created,
        (to_char(now(), 'yyyy-mm-ddThh:mi:ss.msz'::varchar(23)) || '"'::varchar(1)) AS modified
 FROM ((((datamart.copay c JOIN reference.copay_voucher_program cvp ON (((c.program_number = cvp.program_number) AND (c.redemption_type = cvp.redemption_type)))) JOIN datamart.tvcmid_xref fed ON (((c.physician_tvcmid = fed.tvcmid) AND (fed.id_type = 'FED_ID'::varchar(6))))) LEFT  JOIN product.basket b ON ((c.basket_id = b.basket_id))) LEFT  JOIN ( SELECT bb.basket_id,
        bb.name,
        bp.basket_id AS prod_id
 FROM ((product.basket_item bip JOIN product.basket bp ON ((bip.entity_id = bp.basket_id))) JOIN product.basket bb ON (((bip.basket_id = bb.basket_id) AND (bb.basket_type = 'brand'::varchar(5)))))) brand ON ((c.basket_id = brand.prod_id)));

CREATE  VIEW sandbox.v_sent_email AS
 SELECT se.id,
        se.isdeleted,
        se.name,
        se.createddate,
        se.createdbyid,
        se.lastmodifieddate,
        se.lastmodifiedbyid,
        se.systemmodstamp,
        se.mayedit,
        se.islocked,
        se.is_parent_call_vod__c,
        se.call2_vod__c,
        se.product_vod__c,
        se.detail_priority_vod__c,
        se.mobile_id_vod__c,
        se.type_vod__c,
        se.file_id,
        se.record_id
 FROM (veeva.call_detail se JOIN ( SELECT call_detail.id,
        max(call_detail.file_id) AS file_id
 FROM veeva.call_detail
 WHERE (call_detail.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call_detail.id) se2 ON (((se.id = se2.id) AND (se.file_id = se2.file_id))));

CREATE  VIEW sandbox.account AS
 SELECT x.id,
        x.isdeleted,
        x.masterrecordid,
        x.name,
        x.lastname,
        x.firstname,
        x.salutation,
        x.type,
        x.recordtypeid,
        x.phone,
        x.fax,
        x.website,
        x.numberofemployees,
        x.ownership,
        x.ownerid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.isexcludedfromrealign,
        x.personcontactid,
        x.ispersonaccount,
        x.personmailingstreet,
        x.personmailingcity,
        x.personmailingstate,
        x.personmailingpostalcode,
        x.personmailingcountry,
        x.personmailinglatitude,
        x.personmailinglongitude,
        x.personotherstreet,
        x.personothercity,
        x.personotherstate,
        x.personotherpostalcode,
        x.personothercountry,
        x.personotherlatitude,
        x.personotherlongitude,
        x.personmobilephone,
        x.personhomephone,
        x.personotherphone,
        x.personassistantphone,
        x.personemail,
        x.persontitle,
        x.persondepartment,
        x.personassistantname,
        x.personbirthdate,
        x.personhasoptedoutofemail,
        x.personhasoptedoutoffax,
        x.persondonotcall,
        x.personlastcurequestdate,
        x.personlastcuupdatedate,
        x.personemailbouncedreason,
        x.personemailbounceddate,
        x.jigsaw,
        x.jigsawcompanyid,
        x.accountsource,
        x.sicdesc,
        x.external_id_vod__c,
        x.credentials_vod__c,
        x.exclude_from_zip_to_terr_proce,
        x.group_specialty_1_vod__c,
        x.group_specialty_2_vod__c,
        x.specialty_1_vod__c,
        x.specialty_2_vod__c,
        x.formatted_name_vod__c,
        x.territory_test_vod__c,
        x.mobile_id_vod__c,
        x.gender_vod__c,
        x.id_vod__c,
        x.do_not_sync_sales_data_vod__c,
        x.id2_vod__c,
        x.preferred_name_vod__c,
        x.sample_default_vod__c,
        x.segmentations_vod__c,
        x.restricted_products_vod__c,
        x.payer_id_vod__c,
        x.account_status_tva__c,
        x.do_not_call_vod__c,
        x.beds__c,
        x.spend_amount__c,
        x.pdrp_opt_out_vod__c,
        x.spend_status_value_vod__c,
        x.pdrp_opt_out_date_vod__c,
        x.spend_status_vod__c,
        x.enable_restricted_products,
        x.call_reminder_vod__c,
        x.account_group_vod__c,
        x.primary_parent_vod__c,
        x.color_vod__c,
        x.middle_vod__c,
        x.suffix_vod__c,
        x.account_location_tva__c,
        x.no_orders_vod__c,
        x.account_master_id_tva__c,
        x.account_email_tva__c,
        x.account_search_firstlast,
        x.account_search_lastfirst,
        x.person_preferred_name_tva__c,
        x.practice_at_hospital_vod__c,
        x.practice_near_hospital_vod__c,
        x.do_not_create_child_account,
        x.total_mds_dos__c,
        x.aha__c,
        x.order_type_vod__c,
        x.npi_vod__c,
        x.me__c,
        x.speaker__c,
        x.investigator_vod__c,
        x.default_order_type_vod__c,
        x.person_degree_tva__c,
        x.tax_status__c,
        x.model__c,
        x.offerings__c,
        x.departments__c,
        x.account_type__c,
        x.account_search_business_vod__c,
        x.business_professional_person,
        x.no_spend_tva__c,
        x.hospital_type_vod__c,
        x.account_class_vod__c,
        x.furigana_vod__c,
        x.tirf_rems_tva__c,
        x.fentora_app_tva__c,
        x.total_revenue_000__c,
        x.net_income_loss_000__c,
        x.pmpm_income_loss_000__c,
        x.commercial_premiums_pmpm__c,
        x.medical_loss_ratio__c,
        x.medical_expenses_pmpm__c,
        x.commercial_patient_days_1000,
        x.hmo_market_shr__c,
        x.hmo__c,
        x.hmo_pos__c,
        x.ppo__c,
        x.ppo_pos__c,
        x.medicare__c,
        x.medicaid__c,
        x.nuvigil_app_tva__c,
        x.mds_status_tva__c,
        x.lis_status_tva__c,
        x.dnc_pcs_tva__c,
        x.dnc_cns_tva__c,
        x.suffix_tva__c,
        x.tysabri_status_tva__c,
        x.business_description__c,
        x.regional_strategy__c,
        x.contracts_process__c,
        x.cml_profiled_tva__c,
        x.cell_phone_tva__c,
        x.no_contact_tva__c,
        x.outlet_id_tva__c,
        x.pmo_gpo_account_affiliations,
        x.territory_status_tva__c,
        x.zdea_number_tva__c,
        x.veeva_id_tva__c,
        x.treanda_lq_tgt_tva__c,
        x.tbo_filgrastim_target_tva__c,
        x.sln_rescrub_tva__c,
        x.account_identifier_vod__c,
        x.target__c,
        x.kol_vod__c,
        x.rems_expiration_date_teva__c,
        x.account_demo_id_tva__c,
        x.total_lives__c,
        x.total_physicians_enrolled__c,
        x.tirf_rems_eff_date_tva__c,
        x.business_associate_agreement,
        x.do_not_promote_tva__c,
        x.account_dea_tva__c,
        x.bp_number__c,
        x.paragard_segmentation_tva__c,
        x.telesales_activity_tva__c,
        x.designation_tva__c,
        x.total_pharmacists__c,
        x.comp_pricing_tva__c,
        x.formulary_tva__c,
        x.gln_tva__c,
        x.gpo_contracts_tva__c,
        x.hin_tva__c,
        x.max_id_tva__c,
        x.oncology_services_tva__c,
        x.pcp_program_tva__c,
        x.pharmacy_location_tva__c,
        x.primary_credential_tva__c,
        x.primary_wholesaler_tva__c,
        x.rep_credentialing_tva__c,
        x.secondary_credential_tva__c,
        x.sign_in_location_tva__c,
        x.special_tva__c,
        x.sub_type_id_tva__c,
        x.sub_type_tva__c,
        x.teva_contracts_tva__c,
        x.ims_org_id_tva__c,
        x.year_of_birth_tva__c,
        x.teaching_hospital_tva__c,
        x.account_archived_tva__c,
        x.mobile_id_vod__pc,
        x.file_id,
        x.record_id,
        x.cm_id_tva__c,
        x.staff_email,
        x.company_managed_email,
        x.alternate_email
 FROM (veeva.account x JOIN ( SELECT account.id,
        max(account.file_id) AS file_id
 FROM veeva.account
 GROUP BY account.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.v_account AS
 SELECT x.id,
        x.isdeleted,
        x.masterrecordid,
        x.name,
        x.lastname,
        x.firstname,
        x.salutation,
        x.type,
        x.recordtypeid,
        x.phone,
        x.fax,
        x.website,
        x.numberofemployees,
        x.ownership,
        x.ownerid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.isexcludedfromrealign,
        x.personcontactid,
        x.ispersonaccount,
        x.personmailingstreet,
        x.personmailingcity,
        x.personmailingstate,
        x.personmailingpostalcode,
        x.personmailingcountry,
        x.personmailinglatitude,
        x.personmailinglongitude,
        x.personotherstreet,
        x.personothercity,
        x.personotherstate,
        x.personotherpostalcode,
        x.personothercountry,
        x.personotherlatitude,
        x.personotherlongitude,
        x.personmobilephone,
        x.personhomephone,
        x.personotherphone,
        x.personassistantphone,
        x.personemail,
        x.persontitle,
        x.persondepartment,
        x.personassistantname,
        x.personbirthdate,
        x.personhasoptedoutofemail,
        x.personhasoptedoutoffax,
        x.persondonotcall,
        x.personlastcurequestdate,
        x.personlastcuupdatedate,
        x.personemailbouncedreason,
        x.personemailbounceddate,
        x.jigsaw,
        x.jigsawcompanyid,
        x.accountsource,
        x.sicdesc,
        x.external_id_vod__c,
        x.credentials_vod__c,
        x.exclude_from_zip_to_terr_proce,
        x.group_specialty_1_vod__c,
        x.group_specialty_2_vod__c,
        x.specialty_1_vod__c,
        x.specialty_2_vod__c,
        x.formatted_name_vod__c,
        x.territory_test_vod__c,
        x.mobile_id_vod__c,
        x.gender_vod__c,
        x.id_vod__c,
        x.do_not_sync_sales_data_vod__c,
        x.id2_vod__c,
        x.preferred_name_vod__c,
        x.sample_default_vod__c,
        x.segmentations_vod__c,
        x.restricted_products_vod__c,
        x.payer_id_vod__c,
        x.account_status_tva__c,
        x.do_not_call_vod__c,
        x.beds__c,
        x.spend_amount__c,
        x.pdrp_opt_out_vod__c,
        x.spend_status_value_vod__c,
        x.pdrp_opt_out_date_vod__c,
        x.spend_status_vod__c,
        x.enable_restricted_products,
        x.call_reminder_vod__c,
        x.account_group_vod__c,
        x.primary_parent_vod__c,
        x.color_vod__c,
        x.middle_vod__c,
        x.suffix_vod__c,
        x.account_location_tva__c,
        x.no_orders_vod__c,
        x.account_master_id_tva__c,
        x.account_email_tva__c,
        x.account_search_firstlast,
        x.account_search_lastfirst,
        x.person_preferred_name_tva__c,
        x.practice_at_hospital_vod__c,
        x.practice_near_hospital_vod__c,
        x.do_not_create_child_account,
        x.total_mds_dos__c,
        x.aha__c,
        x.order_type_vod__c,
        x.npi_vod__c,
        x.me__c,
        x.speaker__c,
        x.investigator_vod__c,
        x.default_order_type_vod__c,
        x.person_degree_tva__c,
        x.tax_status__c,
        x.model__c,
        x.offerings__c,
        x.departments__c,
        x.account_type__c,
        x.account_search_business_vod__c,
        x.business_professional_person,
        x.no_spend_tva__c,
        x.hospital_type_vod__c,
        x.account_class_vod__c,
        x.furigana_vod__c,
        x.tirf_rems_tva__c,
        x.fentora_app_tva__c,
        x.total_revenue_000__c,
        x.net_income_loss_000__c,
        x.pmpm_income_loss_000__c,
        x.commercial_premiums_pmpm__c,
        x.medical_loss_ratio__c,
        x.medical_expenses_pmpm__c,
        x.commercial_patient_days_1000,
        x.hmo_market_shr__c,
        x.hmo__c,
        x.hmo_pos__c,
        x.ppo__c,
        x.ppo_pos__c,
        x.medicare__c,
        x.medicaid__c,
        x.nuvigil_app_tva__c,
        x.mds_status_tva__c,
        x.lis_status_tva__c,
        x.dnc_pcs_tva__c,
        x.dnc_cns_tva__c,
        x.suffix_tva__c,
        x.tysabri_status_tva__c,
        x.business_description__c,
        x.regional_strategy__c,
        x.contracts_process__c,
        x.cml_profiled_tva__c,
        x.cell_phone_tva__c,
        x.no_contact_tva__c,
        x.outlet_id_tva__c,
        x.pmo_gpo_account_affiliations,
        x.territory_status_tva__c,
        x.zdea_number_tva__c,
        x.veeva_id_tva__c,
        x.treanda_lq_tgt_tva__c,
        x.tbo_filgrastim_target_tva__c,
        x.sln_rescrub_tva__c,
        x.account_identifier_vod__c,
        x.target__c,
        x.kol_vod__c,
        x.rems_expiration_date_teva__c,
        x.account_demo_id_tva__c,
        x.total_lives__c,
        x.total_physicians_enrolled__c,
        x.tirf_rems_eff_date_tva__c,
        x.business_associate_agreement,
        x.do_not_promote_tva__c,
        x.account_dea_tva__c,
        x.bp_number__c,
        x.paragard_segmentation_tva__c,
        x.telesales_activity_tva__c,
        x.designation_tva__c,
        x.total_pharmacists__c,
        x.comp_pricing_tva__c,
        x.formulary_tva__c,
        x.gln_tva__c,
        x.gpo_contracts_tva__c,
        x.hin_tva__c,
        x.max_id_tva__c,
        x.oncology_services_tva__c,
        x.pcp_program_tva__c,
        x.pharmacy_location_tva__c,
        x.primary_credential_tva__c,
        x.primary_wholesaler_tva__c,
        x.rep_credentialing_tva__c,
        x.secondary_credential_tva__c,
        x.sign_in_location_tva__c,
        x.special_tva__c,
        x.sub_type_id_tva__c,
        x.sub_type_tva__c,
        x.teva_contracts_tva__c,
        x.ims_org_id_tva__c,
        x.year_of_birth_tva__c,
        x.teaching_hospital_tva__c,
        x.account_archived_tva__c,
        x.mobile_id_vod__pc,
        x.file_id,
        x.record_id,
        x.cm_id_tva__c,
        x.staff_email,
        x.company_managed_email,
        x.alternate_email
 FROM (veeva.account x JOIN ( SELECT account.id,
        max(account.file_id) AS file_id
 FROM veeva.account
 GROUP BY account.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.v_call AS
 SELECT x.id,
        x.ownerid,
        x.isdeleted,
        x.name,
        x.recordtypeid,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.lastactivitydate,
        x.mayedit,
        x.islocked,
        x.lastvieweddate,
        x.lastreferenceddate,
        x.sample_card_vod__c,
        x.add_detail_vod__c,
        x.property_vod__c,
        x.account_vod__c,
        x.zvod_product_discussion_vod__c,
        x.status_vod__c,
        x.parent_address_vod__c,
        x.account_plan_vod__c,
        x.zvod_savenew_vod__c,
        x.next_call_notes_vod__c,
        x.mobile_id_vod__c,
        x.zvod_account_credentials_vod_c,
        x.zvod_account_preferred_name_vo,
        x.zvod_account_sample_status_vod,
        x.zvod_attendees_vod__c,
        x.zvod_key_messages_vod__c,
        x.zvod_detailing_vod__c,
        x.zvod_expenses_vod__c,
        x.zvod_followup_vod__c,
        x.zvod_samples_vod__c,
        x.zvod_save_vod__c,
        x.zvod_submit_vod__c,
        x.zvod_delete_vod__c,
        x.activity_type__c,
        x.significant_event__c,
        x.location_vod__c,
        x.subject_vod__c,
        x.call_datetime_vod__c,
        x.disbursed_to_vod__c,
        x.request_receipt_vod__c,
        x.signature_date_vod__c,
        x.territory_vod__c,
        x.submitted_by_mobile_vod__c,
        x.call_type_vod__c,
        x.add_key_message_vod__c,
        x.address_vod__c,
        x.attendees_vod__c,
        x.attendee_type_vod__c,
        x.call_date_vod__c,
        x.detailed_products_vod__c,
        x.no_disbursement_vod__c,
        x.parent_call_vod__c,
        x.user_vod__c,
        x.contact_vod__c,
        x.zvod_entity_vod__c,
        x.medical_event_vod__c,
        x.mobile_created_datetime_vod__c,
        x.mobile_last_modified_datetime,
        x.license_vod__c,
        x.is_parent_call_vod__c,
        x.entity_display_name_vod__c,
        x.last_device_vod__c,
        x.ship_address_line_1_vod__c,
        x.ship_address_line_2_vod__c,
        x.ship_city_vod__c,
        x.ship_country_vod__c,
        x.ship_license_expiration_date,
        x.ship_license_status_vod__c,
        x.ship_license_vod__c,
        x.ship_state_vod__c,
        x.ship_to_address_vod__c,
        x.ship_zip_vod__c,
        x.ship_to_address_text_vod__c,
        x.clm_vod__c,
        x.zvod_clmdetails_vod__c,
        x.is_sampled_call_vod__c,
        x.zvod_surveys_vod__c,
        x.presentations_vod__c,
        x.entity_reference_id_vod__c,
        x.error_reference_call_vod__c,
        x.duration_vod__c,
        x.color_vod__c,
        x.allowed_products_vod__c,
        x.zvod_attachments_vod__c,
        x.sample_card_reason_vod__c,
        x.assmca_vod__c,
        x.address_line_1_vod__c,
        x.address_line_2_vod__c,
        x.city_vod__c,
        x.dea_address_line_1_vod__c,
        x.dea_address_line_2_vod__c,
        x.dea_address_vod__c,
        x.dea_city_vod__c,
        x.dea_expiration_date_vod__c,
        x.dea_state_vod__c,
        x.dea_zip_4_vod__c,
        x.dea_zip_vod__c,
        x.dea_vod__c,
        x.ship_zip_4_vod__c,
        x.state_vod__c,
        x.zip_4_vod__c,
        x.zip_vod__c,
        x.sample_send_card_vod__c,
        x.zvod_address_vod_c_dea_status_,
        x.signature_page_image_vod__c,
        x.credentials_vod__c,
        x.salutation_vod__c,
        x.zvod_account_call_reminder_vod,
        x.sales_org_tva__c,
        x.zvod_business_account_vod__c,
        x.product_priority_1_vod__c,
        x.product_priority_2_vod__c,
        x.product_priority_3_vod__c,
        x.product_priority_4_vod__c,
        x.product_priority_5_vod__c,
        x.zvod_more_actions_vod__c,
        x.zvod_call_conflict_status,
        x.signature_timestamp_vod__c,
        x.expense_amount_vod__c,
        x.total_expense_attendees_count,
        x.attendee_list_vod__c,
        x.expense_post_status_vod__c,
        x.attendee_post_status_vod__c,
        x.expense_system_external_id,
        x.incurred_expense_vod__c,
        x.assigner_vod__c,
        x.assignment_datetime_vod__c,
        x.zvod_call_objective_vod__c,
        x.signature_location_longitude,
        x.signature_location_latitude,
        x.location_services_status,
        x.created_by_timezone_tva__c,
        x.license_expiration_date_vod__c,
        x.license_status_vod__c,
        x.ship_assmca_vod__c,
        x.ship_dea_expiration_date,
        x.ship_dea_vod__c,
        x.call_method_tva__c,
        x.bendeka_indication_tva__c,
        x.file_id,
        x.record_id,
        x.austedo_indication_tva__c,
        x.call_duration_tva__c,
        x.how_executed_tva__c,
        x.Remote_Meeting_vod__c,
        x.Veeva_Remote_Meeting_Id_vod__c,
        x.Cobrowse_URL_Participant_vod__c,
        x.Signature_Captured_Remotely_vod__c,
        x.Remote_Signature_Attendee_Name_vod__c
 FROM (veeva.call x JOIN ( SELECT call.id,
        max(call.file_id) AS file_id
 FROM veeva.call
 WHERE (call.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.v_call_detail AS
 SELECT x.id,
        x.isdeleted,
        x.name,
        x.createddate,
        x.createdbyid,
        x.lastmodifieddate,
        x.lastmodifiedbyid,
        x.systemmodstamp,
        x.mayedit,
        x.islocked,
        x.is_parent_call_vod__c,
        x.call2_vod__c,
        x.product_vod__c,
        x.detail_priority_vod__c,
        x.mobile_id_vod__c,
        x.type_vod__c,
        x.file_id,
        x.record_id
 FROM (veeva.call_detail x JOIN ( SELECT call_detail.id,
        max(call_detail.file_id) AS file_id
 FROM veeva.call_detail
 WHERE (call_detail.createddate >= add_months((statement_timestamp())::timestamp, (-25)))
 GROUP BY call_detail.id) x2 ON (((x.id = x2.id) AND (x.file_id = x2.file_id))));

CREATE  VIEW sandbox.vw_curr_provider_override_default_v1 AS
 SELECT btrim(provider_override_default_v1.provider_id) AS provider_id,
        btrim(provider_override_default_v1.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v1.provider_name) AS provider_name,
        btrim(provider_override_default_v1.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v1.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v1.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v1.override_best_iqvia_pbm) AS override_best_iqvia_pbm,
        provider_override_default_v1.file_id,
        provider_override_default_v1.record_id
 FROM sandbox.provider_override_default_v1
 WHERE (provider_override_default_v1.file_id IN ( SELECT max(provider_override_default_v1.file_id) AS max
 FROM sandbox.provider_override_default_v1));

CREATE  VIEW sandbox.vw_curr_calculated_pbm_config_v1 AS
 SELECT btrim(calculated_pbm_config_v1.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v1.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v1.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v1.calculated_pbm_column) AS calculated_pbm_column,
        calculated_pbm_config_v1.file_id,
        calculated_pbm_config_v1.record_id
 FROM sandbox.calculated_pbm_config_v1
 WHERE (calculated_pbm_config_v1.file_id IN ( SELECT max(calculated_pbm_config_v1.file_id) AS max
 FROM sandbox.calculated_pbm_config_v1));

CREATE  VIEW sandbox.vw_curr_has_pa_mapping_v1 AS
 SELECT has_pa_mapping_v1.has_pa,
        btrim(has_pa_mapping_v1.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v1.notes) AS notes,
        has_pa_mapping_v1.file_id,
        has_pa_mapping_v1.record_id
 FROM sandbox.has_pa_mapping_v1
 WHERE (has_pa_mapping_v1.file_id IN ( SELECT max(has_pa_mapping_v1.file_id) AS max
 FROM sandbox.has_pa_mapping_v1));

CREATE  VIEW sandbox.vw_curr_has_st_mapping_v1 AS
 SELECT has_st_mapping_v1.has_st,
        btrim(has_st_mapping_v1.st_regex) AS st_regex,
        btrim(has_st_mapping_v1.notes) AS notes,
        has_st_mapping_v1.file_id,
        has_st_mapping_v1.record_id
 FROM sandbox.has_st_mapping_v1
 WHERE (has_st_mapping_v1.file_id IN ( SELECT max(has_st_mapping_v1.file_id) AS max
 FROM sandbox.has_st_mapping_v1));

CREATE  VIEW sandbox.vw_curr_calc_pbm_key_pbm_mapping_v1 AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v1.calculated_pbm) AS calculated_pbm_value,
        btrim(calc_pbm_key_pbm_mapping_v1.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v1.added_by) AS added_by,
        calc_pbm_key_pbm_mapping_v1.file_id,
        calc_pbm_key_pbm_mapping_v1.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v1
 WHERE (calc_pbm_key_pbm_mapping_v1.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v1.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v1));

CREATE  VIEW sandbox.vw_curr_copay_tier_derivation_config AS
 SELECT btrim(copay_tier_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(copay_tier_derivation_config_v1.tier_cat) AS tier_cat,
        btrim(copay_tier_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v1.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v1.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v1.copay_tier) AS copay_tier,
        copay_tier_derivation_config_v1.file_id,
        copay_tier_derivation_config_v1.record_id
 FROM sandbox.copay_tier_derivation_config_v1
 WHERE (copay_tier_derivation_config_v1.file_id IN ( SELECT max(copay_tier_derivation_config_v1.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_restriction_category_derivation_config AS
 SELECT btrim(restriction_category_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v1.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v1.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v1.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v1.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v1.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v1.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v1.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v1.restcat,
        btrim(restriction_category_derivation_config_v1.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v1.meaning) AS meaning,
        restriction_category_derivation_config_v1.file_id,
        restriction_category_derivation_config_v1.record_id
 FROM sandbox.restriction_category_derivation_config_v1
 WHERE (restriction_category_derivation_config_v1.file_id IN ( SELECT max(restriction_category_derivation_config_v1.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_formulary_derivation_config AS
 SELECT btrim(formulary_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v1.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v1.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v1.formulary) AS formulary,
        btrim(formulary_derivation_config_v1.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v1.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v1.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        formulary_derivation_config_v1.file_id,
        formulary_derivation_config_v1.record_id
 FROM sandbox.formulary_derivation_config_v1
 WHERE (formulary_derivation_config_v1.file_id IN ( SELECT max(formulary_derivation_config_v1.file_id) AS max
 FROM sandbox.formulary_derivation_config_v1));

CREATE  VIEW sandbox.vw_curr_key_controller_list_v1 AS
 SELECT key_controller_list_v1.ftf_health_plan_fid,
        btrim(key_controller_list_v1.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v1.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v1.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v1.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v1.payer_pbm) AS payer_pbm,
        key_controller_list_v1.file_id,
        key_controller_list_v1.record_id
 FROM sandbox.key_controller_list_v1
 WHERE (key_controller_list_v1.file_id IN ( SELECT max(key_controller_list_v1.file_id) AS max
 FROM sandbox.key_controller_list_v1));

CREATE  VIEW sandbox.vw_curr_botox_step_restriction_v1 AS
 SELECT botox_step_restriction_v1.code,
        btrim(botox_step_restriction_v1.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v1.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v1.notes) AS notes,
        botox_step_restriction_v1.file_id,
        botox_step_restriction_v1.record_id
 FROM sandbox.botox_step_restriction_v1
 WHERE (botox_step_restriction_v1.file_id IN ( SELECT max(botox_step_restriction_v1.file_id) AS max
 FROM sandbox.botox_step_restriction_v1));

CREATE  VIEW sandbox.vw_curr_step_restriction_v1 AS
 SELECT step_restriction_v1.code,
        btrim(step_restriction_v1.step_category) AS step_category,
        btrim(step_restriction_v1.restriction_group) AS restriction_group,
        btrim(step_restriction_v1.notes) AS notes,
        step_restriction_v1.file_id,
        step_restriction_v1.record_id
 FROM sandbox.step_restriction_v1
 WHERE (step_restriction_v1.file_id IN ( SELECT max(step_restriction_v1.file_id) AS max
 FROM sandbox.step_restriction_v1));

CREATE  VIEW sandbox.vw_curr_pa_restriction_v1 AS
 SELECT pa_restriction_v1.code,
        btrim(pa_restriction_v1.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v1.notes) AS notes,
        pa_restriction_v1.file_id,
        pa_restriction_v1.record_id
 FROM sandbox.pa_restriction_v1
 WHERE (pa_restriction_v1.file_id IN ( SELECT max(pa_restriction_v1.file_id) AS max
 FROM sandbox.pa_restriction_v1));

CREATE  VIEW sandbox.vw_curr_patient_pa_restriction_v1 AS
 SELECT patient_pa_restriction_v1.code,
        btrim(patient_pa_restriction_v1.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v1.notes) AS notes,
        patient_pa_restriction_v1.file_id,
        patient_pa_restriction_v1.record_id
 FROM sandbox.patient_pa_restriction_v1
 WHERE (patient_pa_restriction_v1.file_id IN ( SELECT max(patient_pa_restriction_v1.file_id) AS max
 FROM sandbox.patient_pa_restriction_v1));

CREATE  VIEW sandbox.vw_curr_medical_rec_restriction_v1 AS
 SELECT medical_rec_restriction_v1.code,
        btrim(medical_rec_restriction_v1.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v1.notes) AS notes,
        medical_rec_restriction_v1.file_id,
        medical_rec_restriction_v1.record_id
 FROM sandbox.medical_rec_restriction_v1
 WHERE (medical_rec_restriction_v1.file_id IN ( SELECT max(medical_rec_restriction_v1.file_id) AS max
 FROM sandbox.medical_rec_restriction_v1));

CREATE  VIEW sandbox.vw_curr_unspecified_rec_restriction_v1 AS
 SELECT unspecified_rec_restriction_v1.code,
        btrim(unspecified_rec_restriction_v1.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v1.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v1.notes) AS notes,
        unspecified_rec_restriction_v1.file_id,
        unspecified_rec_restriction_v1.record_id
 FROM sandbox.unspecified_rec_restriction_v1
 WHERE (unspecified_rec_restriction_v1.file_id IN ( SELECT max(unspecified_rec_restriction_v1.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v1));

CREATE  VIEW sandbox.vw_curr_step_restriction_description_v1 AS
 SELECT step_restriction_description_v1.step,
        btrim(step_restriction_description_v1.description) AS description,
        step_restriction_description_v1.file_id,
        step_restriction_description_v1.record_id
 FROM sandbox.step_restriction_description_v1
 WHERE (step_restriction_description_v1.file_id IN ( SELECT max(step_restriction_description_v1.file_id) AS max
 FROM sandbox.step_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_pres_pa_restriction_description_v1 AS
 SELECT pres_pa_restriction_description_v1.prespa,
        btrim(pres_pa_restriction_description_v1.description) AS description,
        pres_pa_restriction_description_v1.file_id,
        pres_pa_restriction_description_v1.record_id
 FROM sandbox.pres_pa_restriction_description_v1
 WHERE (pres_pa_restriction_description_v1.file_id IN ( SELECT max(pres_pa_restriction_description_v1.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_pat_pa_restriction_description_v1 AS
 SELECT pat_pa_restriction_description_v1.patpa,
        btrim(pat_pa_restriction_description_v1.description) AS description,
        pat_pa_restriction_description_v1.file_id,
        pat_pa_restriction_description_v1.record_id
 FROM sandbox.pat_pa_restriction_description_v1
 WHERE (pat_pa_restriction_description_v1.file_id IN ( SELECT max(pat_pa_restriction_description_v1.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v1));

CREATE  VIEW sandbox.vw_curr_ftf_paytype_paytypeindex_v1 AS
 SELECT ftf_paytype_paytypeindex_v1.paytype_index,
        btrim(ftf_paytype_paytypeindex_v1.paytype) AS paytype,
        ftf_paytype_paytypeindex_v1.file_id,
        ftf_paytype_paytypeindex_v1.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v1
 WHERE (ftf_paytype_paytypeindex_v1.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v1.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_ftf_override_provider_v1 AS
 SELECT ftf_override_provider_v1.paytype_index,
        ftf_override_provider_v1.ftf_provider_fid,
        ftf_override_provider_v1.file_id,
        ftf_override_provider_v1.record_id
 FROM sandbox.ftf_override_provider_v1
 WHERE (ftf_override_provider_v1.file_id IN ( SELECT max(ftf_override_provider_v1.file_id) AS max
 FROM sandbox.ftf_override_provider_v1));

CREATE  VIEW sandbox.vw_curr_ftf_override_plan_v1 AS
 SELECT ftf_override_plan_v1.paytype_index,
        ftf_override_plan_v1.ftf_health_plan_fid,
        ftf_override_plan_v1.file_id,
        ftf_override_plan_v1.record_id
 FROM sandbox.ftf_override_plan_v1
 WHERE (ftf_override_plan_v1.file_id IN ( SELECT max(ftf_override_plan_v1.file_id) AS max
 FROM sandbox.ftf_override_plan_v1));

CREATE  VIEW sandbox.vw_curr_coverage_category_derivation_config AS
 SELECT btrim(coverage_category_derivation_config_v1.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v1.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v1.coverage_cat_code,
        btrim(coverage_category_derivation_config_v1.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v1.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v1.meaning) AS meaning,
        coverage_category_derivation_config_v1.file_id,
        coverage_category_derivation_config_v1.record_id
 FROM sandbox.coverage_category_derivation_config_v1
 WHERE (coverage_category_derivation_config_v1.file_id IN ( SELECT max(coverage_category_derivation_config_v1.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v1));

CREATE  VIEW sandbox.vw_key_controlling_plan_formulary_coverage_categories AS
 SELECT pivot_plan_prod_master_v1.key_controlling_plan_formulary,
        pivot_plan_prod_master_v1.paytype,
        pivot_plan_prod_master_v1.ftf_health_plan_type,
        pivot_plan_prod_master_v1.Coverage_Category_Ajovy,
        pivot_plan_prod_master_v1.Coverage_Category_Aimovig,
        pivot_plan_prod_master_v1.Coverage_Category_Emgality,
        count(DISTINCT pivot_plan_prod_master_v1.ftf_health_plan_fid) AS count_ftf_health_plan_fid,
        sum(pivot_plan_prod_master_v1.lives_mn) AS sum_lives,
        dense_rank() OVER (PARTITION BY pivot_plan_prod_master_v1.key_controlling_plan_formulary ORDER BY pivot_plan_prod_master_v1.key_controlling_plan_formulary) AS sequence
 FROM sandbox.pivot_plan_prod_master_v1 pivot_plan_prod_master_v1
 GROUP BY pivot_plan_prod_master_v1.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1.paytype,
          pivot_plan_prod_master_v1.ftf_health_plan_type,
          pivot_plan_prod_master_v1.Coverage_Category_Ajovy,
          pivot_plan_prod_master_v1.Coverage_Category_Aimovig,
          pivot_plan_prod_master_v1.Coverage_Category_Emgality
 ORDER BY pivot_plan_prod_master_v1.key_controlling_plan_formulary,
          pivot_plan_prod_master_v1.paytype,
          pivot_plan_prod_master_v1.ftf_health_plan_type;

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_formularies_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_formularies_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_formularies_cdw.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies_cdw.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies_cdw
 WHERE (raw_ftf_formularies_cdw.file_id IN ( SELECT max(raw_ftf_formularies_cdw.file_id) AS max
 FROM sandbox.raw_ftf_formularies_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plan_geography_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography_cdw.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography_cdw.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 WHERE (raw_ftf_health_plan_geography_cdw.file_id IN ( SELECT max(raw_ftf_health_plan_geography_cdw.file_id) AS max
 FROM sandbox.raw_ftf_health_plan_geography_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_pbms_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms_cdw
 WHERE (raw_ftf_pbms_cdw.file_id IN ( SELECT max(raw_ftf_pbms_cdw.file_id) AS max
 FROM sandbox.raw_ftf_pbms_cdw));

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_restrictions_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_restrictions_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions_cdw.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions_cdw.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions_cdw.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions_cdw.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions_cdw.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_cdw
 WHERE (raw_ftf_restrictions_cdw.file_id IN ( SELECT max(raw_ftf_restrictions_cdw.file_id) AS max
 FROM sandbox.raw_ftf_restrictions_cdw));

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref_cdw AS
 SELECT (replace(replace(btrim(raw_iqvia_plan_cdw.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_iqvia_plan_cdw.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_num,
        (replace(replace(btrim(raw_iqvia_plan_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan_cdw.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan_cdw.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan_cdw.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan_cdw.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan_cdw.months_with_data
 FROM sandbox.raw_iqvia_plan_cdw
 WHERE (raw_iqvia_plan_cdw.file_id IN ( SELECT max(raw_iqvia_plan_cdw.file_id) AS max
 FROM sandbox.raw_iqvia_plan_cdw));

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref_cdw AS
 SELECT replace(replace(btrim(raw_iqvia_pbm_cdw.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        (replace(replace(btrim(raw_iqvia_pbm_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm_cdw.pbm_num,
        raw_iqvia_pbm_cdw.ims_processor_num
 FROM sandbox.raw_iqvia_pbm_cdw
 WHERE (raw_iqvia_pbm_cdw.file_id IN ( SELECT max(raw_iqvia_pbm_cdw.file_id) AS max
 FROM sandbox.raw_iqvia_pbm_cdw));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_formularies_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_formularies_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_formularies_cdw.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies_cdw.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies_cdw.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies_cdw
 WHERE (raw_ftf_formularies_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_formularies_cdw.file_id
 FROM sandbox.raw_ftf_formularies_cdw
 GROUP BY raw_ftf_formularies_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plans_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plans_cdw.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS formularyf_id,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans_cdw.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        raw_ftf_health_plans_cdw.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_cdw
 WHERE (raw_ftf_health_plans_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_health_plans_cdw.file_id
 FROM sandbox.raw_ftf_health_plans_cdw
 GROUP BY raw_ftf_health_plans_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plan_geography_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plan_geography_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography_cdw.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography_cdw.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 WHERE (raw_ftf_health_plan_geography_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_health_plan_geography_cdw.file_id
 FROM sandbox.raw_ftf_health_plan_geography_cdw
 GROUP BY raw_ftf_health_plan_geography_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_pbms_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_pbms_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        (replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms_cdw.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms_cdw
 WHERE (raw_ftf_pbms_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_pbms_cdw.file_id
 FROM sandbox.raw_ftf_pbms_cdw
 GROUP BY raw_ftf_pbms_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_restrictions_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(raw_ftf_restrictions_cdw.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions_cdw.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions_cdw.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions_cdw.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions_cdw.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions_cdw.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions_cdw.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions_cdw
 WHERE (raw_ftf_restrictions_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_ftf_restrictions_cdw.file_id
 FROM sandbox.raw_ftf_restrictions_cdw
 GROUP BY raw_ftf_restrictions_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_plan_xref_cdw AS
 SELECT (replace(replace(btrim(raw_iqvia_plan_cdw.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_iqvia_plan_cdw.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_num,
        (replace(replace(btrim(raw_iqvia_plan_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan_cdw.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan_cdw.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan_cdw.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan_cdw.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan_cdw.months_with_data
 FROM sandbox.raw_iqvia_plan_cdw
 WHERE (raw_iqvia_plan_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_iqvia_plan_cdw.file_id
 FROM sandbox.raw_iqvia_plan_cdw
 GROUP BY raw_iqvia_plan_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_pbm_xref_cdw AS
 SELECT replace(replace(btrim(raw_iqvia_pbm_cdw.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        (replace(replace(btrim(raw_iqvia_pbm_cdw.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm_cdw.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm_cdw.pbm_num,
        raw_iqvia_pbm_cdw.ims_processor_num
 FROM sandbox.raw_iqvia_pbm_cdw
 WHERE (raw_iqvia_pbm_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_iqvia_pbm_cdw.file_id
 FROM sandbox.raw_iqvia_pbm_cdw
 GROUP BY raw_iqvia_pbm_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_curr_iqvia_plans_discard_cdw AS
 SELECT iqvia_plans_discard_v01.payer_id,
        btrim(iqvia_plans_discard_v01.notes) AS notes,
        iqvia_plans_discard_v01.file_id,
        iqvia_plans_discard_v01.record_id
 FROM sandbox.iqvia_plans_discard_v01
 WHERE (iqvia_plans_discard_v01.file_id IN ( SELECT max(iqvia_plans_discard_v01.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v01));

CREATE  VIEW sandbox.vw_curr_model_paytype_map_cdw AS
 SELECT btrim(model_paytype_map_v01.model) AS model,
        btrim(model_paytype_map_v01.paytype) AS paytype,
        btrim(model_paytype_map_v01.notes) AS notes,
        model_paytype_map_v01.file_id,
        model_paytype_map_v01.record_id
 FROM sandbox.model_paytype_map_v01
 WHERE (model_paytype_map_v01.file_id IN ( SELECT max(model_paytype_map_v01.file_id) AS max
 FROM sandbox.model_paytype_map_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_paytypeindex_cdw AS
 SELECT iqvia_paytypeindex_v01.paytype_index,
        btrim(iqvia_paytypeindex_v01.paytype) AS paytype,
        iqvia_paytypeindex_v01.file_id,
        iqvia_paytypeindex_v01.record_id
 FROM sandbox.iqvia_paytypeindex_v01
 WHERE (iqvia_paytypeindex_v01.file_id IN ( SELECT max(iqvia_paytypeindex_v01.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_paytype_override_cdw AS
 SELECT btrim(iqvia_payer_paytype_override_v01.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v01.paytype) AS paytype,
        iqvia_payer_paytype_override_v01.file_id,
        iqvia_payer_paytype_override_v01.record_id
 FROM sandbox.iqvia_payer_paytype_override_v01
 WHERE (iqvia_payer_paytype_override_v01.file_id IN ( SELECT max(iqvia_payer_paytype_override_v01.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v01));

CREATE  VIEW sandbox.vw_curr_ftf_plans_paytypeindex_cdw AS
 SELECT btrim(ftf_plans_paytypeindex_v01.ftf_health_plan_type) AS ftf_health_plan_type,
        ftf_plans_paytypeindex_v01.paytype_index,
        ftf_plans_paytypeindex_v01.file_id,
        ftf_plans_paytypeindex_v01.record_id
 FROM sandbox.ftf_plans_paytypeindex_v01
 WHERE (ftf_plans_paytypeindex_v01.file_id IN ( SELECT max(ftf_plans_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_ftf_paytype_paytypeindex_cdw AS
 SELECT ftf_paytype_paytypeindex_v01.paytype_index,
        btrim(ftf_paytype_paytypeindex_v01.paytype) AS paytype,
        ftf_paytype_paytypeindex_v01.file_id,
        ftf_paytype_paytypeindex_v01.record_id
 FROM sandbox.ftf_paytype_paytypeindex_v01
 WHERE (ftf_paytype_paytypeindex_v01.file_id IN ( SELECT max(ftf_paytype_paytypeindex_v01.file_id) AS max
 FROM sandbox.ftf_paytype_paytypeindex_v01));

CREATE  VIEW sandbox.vw_curr_ftf_override_provider_cdw AS
 SELECT ftf_override_provider_v01.provider_fid,
        ftf_override_provider_v01.paytype_index,
        btrim(ftf_override_provider_v01.notes) AS notes,
        ftf_override_provider_v01.file_id,
        ftf_override_provider_v01.record_id
 FROM sandbox.ftf_override_provider_v01
 WHERE (ftf_override_provider_v01.file_id IN ( SELECT max(ftf_override_provider_v01.file_id) AS max
 FROM sandbox.ftf_override_provider_v01));

CREATE  VIEW sandbox.vw_curr_ftf_override_plan_cdw AS
 SELECT ftf_override_plan_v01.ftf_health_plan_fid,
        ftf_override_plan_v01.paytype_index,
        btrim(ftf_override_plan_v01.notes) AS notes,
        ftf_override_plan_v01.file_id,
        ftf_override_plan_v01.record_id
 FROM sandbox.ftf_override_plan_v01
 WHERE (ftf_override_plan_v01.file_id IN ( SELECT max(ftf_override_plan_v01.file_id) AS max
 FROM sandbox.ftf_override_plan_v01));

CREATE  VIEW sandbox.vw_curr_drug_assignments_cdw AS
 SELECT drug_assignments_v01.drug_id,
        drug_assignments_v01.drug_seq,
        btrim(drug_assignments_v01.product) AS product,
        drug_assignments_v01.file_id,
        drug_assignments_v01.record_id
 FROM sandbox.drug_assignments_v01
 WHERE (drug_assignments_v01.file_id IN ( SELECT max(drug_assignments_v01.file_id) AS max
 FROM sandbox.drug_assignments_v01));

CREATE  VIEW sandbox.vw_curr_ftf_pbm_functions_cdw AS
 SELECT ftf_pbm_functions_v01.pbm_function_id,
        btrim(ftf_pbm_functions_v01.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v01.notes) AS notes,
        ftf_pbm_functions_v01.used,
        ftf_pbm_functions_v01.file_id,
        ftf_pbm_functions_v01.record_id
 FROM sandbox.ftf_pbm_functions_v01
 WHERE (ftf_pbm_functions_v01.file_id IN ( SELECT max(ftf_pbm_functions_v01.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v01));

CREATE  VIEW sandbox.vw_curr_botox_step_restriction_cdw AS
 SELECT botox_step_restriction_v01.code,
        btrim(botox_step_restriction_v01.botox_step_flag) AS botox_step_flag,
        btrim(botox_step_restriction_v01.restriction_group) AS restriction_group,
        btrim(botox_step_restriction_v01.notes) AS notes,
        botox_step_restriction_v01.file_id,
        botox_step_restriction_v01.record_id
 FROM sandbox.botox_step_restriction_v01
 WHERE (botox_step_restriction_v01.file_id IN ( SELECT max(botox_step_restriction_v01.file_id) AS max
 FROM sandbox.botox_step_restriction_v01));

CREATE  VIEW sandbox.vw_curr_step_restriction_cdw AS
 SELECT step_restriction_v01.code,
        btrim(step_restriction_v01.step_category) AS step_category,
        btrim(step_restriction_v01.restriction_group) AS restriction_group,
        btrim(step_restriction_v01.notes) AS notes,
        step_restriction_v01.file_id,
        step_restriction_v01.record_id
 FROM sandbox.step_restriction_v01
 WHERE (step_restriction_v01.file_id IN ( SELECT max(step_restriction_v01.file_id) AS max
 FROM sandbox.step_restriction_v01));

CREATE  VIEW sandbox.vw_curr_pa_restriction_cdw AS
 SELECT pa_restriction_v01.code,
        btrim(pa_restriction_v01.prescriber_prior_authorization_category) AS prescriber_prior_authorization_category,
        btrim(pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(pa_restriction_v01.notes) AS notes,
        pa_restriction_v01.file_id,
        pa_restriction_v01.record_id
 FROM sandbox.pa_restriction_v01
 WHERE (pa_restriction_v01.file_id IN ( SELECT max(pa_restriction_v01.file_id) AS max
 FROM sandbox.pa_restriction_v01));

CREATE  VIEW sandbox.vw_curr_patient_pa_restriction_cdw AS
 SELECT patient_pa_restriction_v01.code,
        btrim(patient_pa_restriction_v01.patient_prior_authorization_category) AS patient_prior_authorization_category,
        btrim(patient_pa_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(patient_pa_restriction_v01.notes) AS notes,
        patient_pa_restriction_v01.file_id,
        patient_pa_restriction_v01.record_id
 FROM sandbox.patient_pa_restriction_v01
 WHERE (patient_pa_restriction_v01.file_id IN ( SELECT max(patient_pa_restriction_v01.file_id) AS max
 FROM sandbox.patient_pa_restriction_v01));

CREATE  VIEW sandbox.vw_curr_medical_rec_restriction_cdw AS
 SELECT medical_rec_restriction_v01.code,
        btrim(medical_rec_restriction_v01.medical_records_submission_required_flag) AS medical_records_submission_required_flag,
        btrim(medical_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(medical_rec_restriction_v01.notes) AS notes,
        medical_rec_restriction_v01.file_id,
        medical_rec_restriction_v01.record_id
 FROM sandbox.medical_rec_restriction_v01
 WHERE (medical_rec_restriction_v01.file_id IN ( SELECT max(medical_rec_restriction_v01.file_id) AS max
 FROM sandbox.medical_rec_restriction_v01));

CREATE  VIEW sandbox.vw_curr_unspecified_rec_restriction_cdw AS
 SELECT unspecified_rec_restriction_v01.code,
        btrim(unspecified_rec_restriction_v01.unspecified_restriction_flag) AS unspecified_restriction_flag,
        btrim(unspecified_rec_restriction_v01.restriction_detail_id) AS restriction_detail_id,
        btrim(unspecified_rec_restriction_v01.notes) AS notes,
        unspecified_rec_restriction_v01.file_id,
        unspecified_rec_restriction_v01.record_id
 FROM sandbox.unspecified_rec_restriction_v01
 WHERE (unspecified_rec_restriction_v01.file_id IN ( SELECT max(unspecified_rec_restriction_v01.file_id) AS max
 FROM sandbox.unspecified_rec_restriction_v01));

CREATE  VIEW sandbox.vw_curr_override_bridge_ftf_plan_types_cdw AS
 SELECT btrim(override_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v01.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v01.override_precedence,
        override_bridge_ftf_plan_types_v01.file_id,
        override_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v01
 WHERE (override_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_curr_delete_bridge_ftf_plan_types_cdw AS
 SELECT btrim(delete_bridge_ftf_plan_types_v01.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v01.delete_flag) AS delete_flag,
        delete_bridge_ftf_plan_types_v01.file_id,
        delete_bridge_ftf_plan_types_v01.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v01
 WHERE (delete_bridge_ftf_plan_types_v01.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v01.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v01));

CREATE  VIEW sandbox.vw_curr_provider_override_default_cdw AS
 SELECT provider_override_default_v01.provider_id,
        btrim(provider_override_default_v01.paytype_regex) AS paytype_regex,
        btrim(provider_override_default_v01.provider_name) AS provider_name,
        btrim(provider_override_default_v01.fill_in_iqvia_payer_name_if_no_bridge) AS fill_in_iqvia_payer_name_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_payer) AS override_best_iqvia_payer,
        btrim(provider_override_default_v01.fill_in_iqvia_pbm_if_no_bridge) AS fill_in_iqvia_pbm_if_no_bridge,
        btrim(provider_override_default_v01.override_best_iqvia_pbm) AS override_best_iqvia_pbm,
        provider_override_default_v01.file_id,
        provider_override_default_v01.record_id
 FROM sandbox.provider_override_default_v01
 WHERE (provider_override_default_v01.file_id IN ( SELECT max(provider_override_default_v01.file_id) AS max
 FROM sandbox.provider_override_default_v01));

CREATE  VIEW sandbox.vw_curr_key_controller_list_cdw AS
 SELECT key_controller_list_v01.ftf_health_plan_fid,
        btrim(key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(key_controller_list_v01.payer_pbm) AS payer_pbm,
        key_controller_list_v01.file_id,
        key_controller_list_v01.record_id
 FROM sandbox.key_controller_list_v01
 WHERE (key_controller_list_v01.file_id IN ( SELECT max(key_controller_list_v01.file_id) AS max
 FROM sandbox.key_controller_list_v01));

CREATE  VIEW sandbox.vw_curr_calculated_pbm_config_cdw AS
 SELECT btrim(calculated_pbm_config_v01.ftf_formulary_management_pbm_regex) AS ftf_formulary_management_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_formulary_influencer_pbm_regex) AS ftf_formulary_influencer_pbm_regex,
        btrim(calculated_pbm_config_v01.ftf_claims_processing_pbm_regex) AS ftf_claims_processing_pbm_regex,
        btrim(calculated_pbm_config_v01.calculated_pbm_column) AS calculated_pbm_column,
        calculated_pbm_config_v01.file_id,
        calculated_pbm_config_v01.record_id
 FROM sandbox.calculated_pbm_config_v01
 WHERE (calculated_pbm_config_v01.file_id IN ( SELECT max(calculated_pbm_config_v01.file_id) AS max
 FROM sandbox.calculated_pbm_config_v01));

CREATE  VIEW sandbox.vw_curr_calc_pbm_key_pbm_mapping_cdw AS
 SELECT btrim(calc_pbm_key_pbm_mapping_v01.calculated_pbm) AS calculated_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.key_pbm) AS key_pbm,
        btrim(calc_pbm_key_pbm_mapping_v01.added_by) AS added_by,
        calc_pbm_key_pbm_mapping_v01.file_id,
        calc_pbm_key_pbm_mapping_v01.record_id
 FROM sandbox.calc_pbm_key_pbm_mapping_v01
 WHERE (calc_pbm_key_pbm_mapping_v01.file_id IN ( SELECT max(calc_pbm_key_pbm_mapping_v01.file_id) AS max
 FROM sandbox.calc_pbm_key_pbm_mapping_v01));

CREATE  VIEW sandbox.vw_curr_has_pa_mapping_cdw AS
 SELECT has_pa_mapping_v01.has_pa,
        btrim(has_pa_mapping_v01.pa_regex) AS pa_regex,
        btrim(has_pa_mapping_v01.notes) AS notes,
        has_pa_mapping_v01.file_id,
        has_pa_mapping_v01.record_id
 FROM sandbox.has_pa_mapping_v01
 WHERE (has_pa_mapping_v01.file_id IN ( SELECT max(has_pa_mapping_v01.file_id) AS max
 FROM sandbox.has_pa_mapping_v01));

CREATE  VIEW sandbox.vw_curr_has_st_mapping_cdw AS
 SELECT has_st_mapping_v01.has_st,
        btrim(has_st_mapping_v01.st_regex) AS st_regex,
        btrim(has_st_mapping_v01.notes) AS notes,
        has_st_mapping_v01.file_id,
        has_st_mapping_v01.record_id
 FROM sandbox.has_st_mapping_v01
 WHERE (has_st_mapping_v01.file_id IN ( SELECT max(has_st_mapping_v01.file_id) AS max
 FROM sandbox.has_st_mapping_v01));

CREATE  VIEW sandbox.vw_curr_formulary_derivation_config_cdw AS
 SELECT btrim(formulary_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        btrim(formulary_derivation_config_v01.has_pa_regex) AS has_pa_regex,
        btrim(formulary_derivation_config_v01.has_st_regex) AS has_st_regex,
        btrim(formulary_derivation_config_v01.formulary) AS formulary,
        btrim(formulary_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(formulary_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(formulary_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        formulary_derivation_config_v01.file_id,
        formulary_derivation_config_v01.record_id
 FROM sandbox.formulary_derivation_config_v01
 WHERE (formulary_derivation_config_v01.file_id IN ( SELECT max(formulary_derivation_config_v01.file_id) AS max
 FROM sandbox.formulary_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_restriction_category_derivation_config_cdw AS
 SELECT btrim(restriction_category_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(restriction_category_derivation_config_v01.has_pa_has_st_regex) AS has_pa_has_st_regex,
        btrim(restriction_category_derivation_config_v01.unspec_regex) AS unspec_regex,
        btrim(restriction_category_derivation_config_v01.step_regex) AS step_regex,
        btrim(restriction_category_derivation_config_v01.botox_regex) AS botox_regex,
        btrim(restriction_category_derivation_config_v01.prespa_regex) AS prespa_regex,
        btrim(restriction_category_derivation_config_v01.tier_cat_regex) AS tier_cat_regex,
        btrim(restriction_category_derivation_config_v01.medrecs_regex) AS medrecs_regex,
        restriction_category_derivation_config_v01.restcat,
        btrim(restriction_category_derivation_config_v01.restriction_category) AS restriction_category,
        btrim(restriction_category_derivation_config_v01.meaning) AS meaning,
        restriction_category_derivation_config_v01.file_id,
        restriction_category_derivation_config_v01.record_id
 FROM sandbox.restriction_category_derivation_config_v01
 WHERE (restriction_category_derivation_config_v01.file_id IN ( SELECT max(restriction_category_derivation_config_v01.file_id) AS max
 FROM sandbox.restriction_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_restriction_cat_description_mapping_cdw AS
 SELECT btrim(restriction_cat_description_mapping_v01.rest_cat) AS rest_cat,
        btrim(restriction_cat_description_mapping_v01.description) AS description,
        btrim(restriction_cat_description_mapping_v01.notes) AS notes,
        restriction_cat_description_mapping_v01.file_id,
        restriction_cat_description_mapping_v01.record_id
 FROM sandbox.restriction_cat_description_mapping_v01
 WHERE (restriction_cat_description_mapping_v01.file_id IN ( SELECT max(restriction_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.restriction_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_coverage_cat_description_mapping_cdw AS
 SELECT btrim(coverage_cat_description_mapping_v01.coverage_cat) AS coverage_cat,
        btrim(coverage_cat_description_mapping_v01.description) AS description,
        btrim(coverage_cat_description_mapping_v01.notes) AS notes,
        coverage_cat_description_mapping_v01.file_id,
        coverage_cat_description_mapping_v01.record_id
 FROM sandbox.coverage_cat_description_mapping_v01
 WHERE (coverage_cat_description_mapping_v01.file_id IN ( SELECT max(coverage_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.coverage_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_step_restriction_description_cdw AS
 SELECT step_restriction_description_v01.step,
        btrim(step_restriction_description_v01.description) AS description,
        step_restriction_description_v01.file_id,
        step_restriction_description_v01.record_id
 FROM sandbox.step_restriction_description_v01
 WHERE (step_restriction_description_v01.file_id IN ( SELECT max(step_restriction_description_v01.file_id) AS max
 FROM sandbox.step_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_pres_pa_restriction_description_cdw AS
 SELECT pres_pa_restriction_description_v01.prespa,
        btrim(pres_pa_restriction_description_v01.description) AS description,
        pres_pa_restriction_description_v01.file_id,
        pres_pa_restriction_description_v01.record_id
 FROM sandbox.pres_pa_restriction_description_v01
 WHERE (pres_pa_restriction_description_v01.file_id IN ( SELECT max(pres_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pres_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_pat_pa_restriction_description_cdw AS
 SELECT pat_pa_restriction_description_v01.patpa,
        btrim(pat_pa_restriction_description_v01.description) AS description,
        pat_pa_restriction_description_v01.file_id,
        pat_pa_restriction_description_v01.record_id
 FROM sandbox.pat_pa_restriction_description_v01
 WHERE (pat_pa_restriction_description_v01.file_id IN ( SELECT max(pat_pa_restriction_description_v01.file_id) AS max
 FROM sandbox.pat_pa_restriction_description_v01));

CREATE  VIEW sandbox.vw_curr_override_fid_iqvia_key_controller_list_cdw AS
 SELECT override_fid_iqvia_key_controller_list_v01.iqvia_plan_code,
        btrim(override_fid_iqvia_key_controller_list_v01.iqvia_plan_name) AS iqvia_plan_name,
        override_fid_iqvia_key_controller_list_v01.ftf_health_plan_fid,
        btrim(override_fid_iqvia_key_controller_list_v01.ftf_health_plan_name) AS ftf_health_plan_name,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_plan_formulary) AS key_controlling_plan_formulary,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_account) AS key_controlling_account,
        btrim(override_fid_iqvia_key_controller_list_v01.key_controlling_parent) AS key_controlling_parent,
        btrim(override_fid_iqvia_key_controller_list_v01.payer_pbm) AS payer_pbm,
        override_fid_iqvia_key_controller_list_v01.file_id,
        override_fid_iqvia_key_controller_list_v01.record_id
 FROM sandbox.override_fid_iqvia_key_controller_list_v01
 WHERE (override_fid_iqvia_key_controller_list_v01.file_id IN ( SELECT max(override_fid_iqvia_key_controller_list_v01.file_id) AS max
 FROM sandbox.override_fid_iqvia_key_controller_list_v01));

CREATE  VIEW sandbox.vw_curr_iqvia_plan_preprocessed_cdw_v1 AS
 SELECT iqvia_plan_preprocessed_cdw_v1.iqvia_payer_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_payer_name,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_id,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_plan_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_plan_preprocessed_cdw_v1.model,
        iqvia_plan_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_plan_preprocessed_cdw_v1.paytype,
        iqvia_plan_preprocessed_cdw_v1.paytype_index,
        iqvia_plan_preprocessed_cdw_v1.cycle_id,
        iqvia_plan_preprocessed_cdw_v1.modified_time,
        iqvia_plan_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_plan_preprocessed_cdw_v1
 WHERE (iqvia_plan_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plan_preprocessed_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_pbm_preprocessed_cdw_v1 AS
 SELECT iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_code,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_pbm,
        iqvia_pbm_preprocessed_cdw_v1.xref_to,
        iqvia_pbm_preprocessed_cdw_v1.iqvia_plan_name,
        iqvia_pbm_preprocessed_cdw_v1.cycle_id,
        iqvia_pbm_preprocessed_cdw_v1.modified_time,
        iqvia_pbm_preprocessed_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_preprocessed_cdw_v1
 WHERE (iqvia_pbm_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_pbm_preprocessed_cdw_v1'::varchar(29)))))));

CREATE  VIEW sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 AS
 SELECT ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_fid,
        ftf_health_plans_preprocessed_cdw_v1.ftf_provider_name,
        ftf_health_plans_preprocessed_cdw_v1.parent_id,
        ftf_health_plans_preprocessed_cdw_v1.ftf_parent_name,
        ftf_health_plans_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_health_plans_preprocessed_cdw_v1.pref_brand_tier,
        ftf_health_plans_preprocessed_cdw_v1.plan_lives,
        ftf_health_plans_preprocessed_cdw_v1.paytype,
        ftf_health_plans_preprocessed_cdw_v1.paytype_index,
        ftf_health_plans_preprocessed_cdw_v1.cycle_id,
        ftf_health_plans_preprocessed_cdw_v1.modified_time,
        ftf_health_plans_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_health_plans_preprocessed_cdw_v1
 WHERE (ftf_health_plans_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_health_plans_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formularies_preprocessed_cdw_v1 AS
 SELECT ftf_formularies_preprocessed_cdw_v1.drug_seq,
        ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_formularies_preprocessed_cdw_v1.drug_id,
        ftf_formularies_preprocessed_cdw_v1.tier_code,
        ftf_formularies_preprocessed_cdw_v1.restrictions,
        ftf_formularies_preprocessed_cdw_v1.reason_code,
        ftf_formularies_preprocessed_cdw_v1.reason_code_description,
        ftf_formularies_preprocessed_cdw_v1.pharmacy_status,
        ftf_formularies_preprocessed_cdw_v1.plan_lives,
        ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat,
        ftf_formularies_preprocessed_cdw_v1.cycle_id,
        ftf_formularies_preprocessed_cdw_v1.modified_time,
        ftf_formularies_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_formularies_preprocessed_cdw_v1
 WHERE (ftf_formularies_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formularies_preprocessed_cdw_v1'::varchar(35)))))));

CREATE  VIEW sandbox.vw_curr_ftf_pbms_preprocessed_cdw_v1 AS
 SELECT ftf_pbms_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_pbms_preprocessed_cdw_v1.pbm_id,
        ftf_pbms_preprocessed_cdw_v1.pbm,
        ftf_pbms_preprocessed_cdw_v1.pbm_function_id,
        ftf_pbms_preprocessed_cdw_v1.pbm_function,
        ftf_pbms_preprocessed_cdw_v1.cycle_id,
        ftf_pbms_preprocessed_cdw_v1.modified_time,
        ftf_pbms_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_pbms_preprocessed_cdw_v1
 WHERE (ftf_pbms_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_pbms_preprocessed_cdw_v1'::varchar(28)))))));

CREATE  VIEW sandbox.vw_curr_ftf_restrictions_preprocessed_cdw_v1 AS
 SELECT ftf_restrictions_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v1.drug_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_code,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v1.restriction_detail_text,
        ftf_restrictions_preprocessed_cdw_v1.grouped_restriction_level,
        ftf_restrictions_preprocessed_cdw_v1.drug_seq,
        ftf_restrictions_preprocessed_cdw_v1.botox,
        ftf_restrictions_preprocessed_cdw_v1.step,
        ftf_restrictions_preprocessed_cdw_v1.pres_pa,
        ftf_restrictions_preprocessed_cdw_v1.pat_pa,
        ftf_restrictions_preprocessed_cdw_v1.med_rec,
        ftf_restrictions_preprocessed_cdw_v1.unspec,
        ftf_restrictions_preprocessed_cdw_v1.cycle_id,
        ftf_restrictions_preprocessed_cdw_v1.modified_time,
        ftf_restrictions_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v1
 WHERE (ftf_restrictions_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_restrictions_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_restrictions_preprocessed_cdw_v2 AS
 SELECT ftf_restrictions_preprocessed_cdw_v2.ftf_health_plan_fid,
        ftf_restrictions_preprocessed_cdw_v2.drug_id,
        ftf_restrictions_preprocessed_cdw_v2.drug_seq,
        ftf_restrictions_preprocessed_cdw_v2.restriction_detail_id,
        ftf_restrictions_preprocessed_cdw_v2.botox,
        ftf_restrictions_preprocessed_cdw_v2.step,
        ftf_restrictions_preprocessed_cdw_v2.pres_pa,
        ftf_restrictions_preprocessed_cdw_v2.pat_pa,
        ftf_restrictions_preprocessed_cdw_v2.med_rec,
        ftf_restrictions_preprocessed_cdw_v2.unspec,
        ftf_restrictions_preprocessed_cdw_v2.cycle_id,
        ftf_restrictions_preprocessed_cdw_v2.modified_time,
        ftf_restrictions_preprocessed_cdw_v2.modified_by
 FROM sandbox.ftf_restrictions_preprocessed_cdw_v2
 WHERE (ftf_restrictions_preprocessed_cdw_v2.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_restrictions_preprocessed_cdw_v2'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 AS
 SELECT ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_payer_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.comments,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_provider_name,
        ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.hp_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.overriden_ftf_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.model,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_pbm,
        ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_delete,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index,
        ftf_iqvia_bridge_preprocessed_cdw_v1.paytype,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types,
        ftf_iqvia_bridge_preprocessed_cdw_v1.old_ftf_health_plan_type,
        ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time,
        ftf_iqvia_bridge_preprocessed_cdw_v1.modified_by
 FROM sandbox.ftf_iqvia_bridge_preprocessed_cdw_v1
 WHERE (ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_iqvia_bridge_preprocessed_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge_cdw AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS code,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_id,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge_cdw
 WHERE (raw_teva_ims_bridge_cdw.file_id IN ( SELECT max(raw_teva_ims_bridge_cdw.file_id) AS max
 FROM sandbox.raw_teva_ims_bridge_cdw));

CREATE  VIEW sandbox.vw_prev_month_ftf_ims_bridge_cdw AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge_cdw.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS code,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        (replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS plan_id,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge_cdw
 WHERE (raw_teva_ims_bridge_cdw.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata_cdw.file_id,
        data_file_metadata_cdw.processed_date,
        rank() OVER (ORDER BY data_file_metadata_cdw.processed_date DESC) AS rn
 FROM sandbox.data_file_metadata_cdw
 WHERE ((data_file_metadata_cdw.file_id IN ( SELECT raw_teva_ims_bridge_cdw.file_id
 FROM sandbox.raw_teva_ims_bridge_cdw
 GROUP BY raw_teva_ims_bridge_cdw.file_id)) AND (data_file_metadata_cdw.processed_date < ( SELECT max(parent_process_execution.date_run) AS max
 FROM sandbox.parent_process_execution
 WHERE (parent_process_execution.parent_process_id = 1))))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.ftf_delta_report AS
 SELECT comparison_ftf_health_plan_fid.ftf_health_plan_fid AS "FTF Health Plan FID",
        comparison_ftf_health_plan_fid.ftf_health_plan_name AS "FTF Health Plan Name",
        comparison_ftf_health_plan_fid.ftf_provider_fid AS "FTF Provider FID",
        comparison_ftf_health_plan_fid.ftf_provider_name AS "FTF Provider Name",
        comparison_ftf_health_plan_fid.ftf_parent_name AS "FTF Parent Name",
        comparison_ftf_health_plan_fid.paytype AS "Pay Type",
        comparison_ftf_health_plan_fid.ftf_health_plan_type AS "FTF Health Plan Type",
        comparison_ftf_health_plan_fid.key_controlling_account AS "Key Controlling Account",
        comparison_ftf_health_plan_fid.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        comparison_ftf_health_plan_fid.key_controlling_parent AS "Key Controlling Parent",
        comparison_ftf_health_plan_fid.payer_pbm AS "Payer/PBM",
        comparison_ftf_health_plan_fid.key_pbm AS "Key PBM",
        comparison_ftf_health_plan_fid.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        comparison_ftf_health_plan_fid.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        comparison_ftf_health_plan_fid.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        comparison_ftf_health_plan_fid.lives_mn AS Lives,
        comparison_ftf_health_plan_fid.iqvia_payer_name AS "IQVIA Payer Name best matched to FTF Plan",
        comparison_ftf_health_plan_fid.iqvia_pbm AS "IQVIA PBM best matched to FTF Plan",
        comparison_ftf_health_plan_fid.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        comparison_ftf_health_plan_fid.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        comparison_ftf_health_plan_fid.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        comparison_ftf_health_plan_fid.pref_brand_tier AS "Pref Brand Tier",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan FID Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider FID Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Parent Name Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pay Type Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payer/PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Management PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Influencer PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Claims Processing PBM Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Lives Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name best matched to FTF Plan Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM best matched to FTF Plan Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Ajovy Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Aimovig Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Emgality Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pref Brand Tier Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN comparison_ftf_health_plan_fid.status WHEN (comparison_ftf_health_plan_fid.change > 0) THEN 'FALSE'::varchar(5) ELSE comparison_ftf_health_plan_fid.status END AS "Final Flag",
        comparison_ftf_health_plan_fid.month_flag AS "Month Flag",
        CASE WHEN (comparison_ftf_health_plan_fid.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (comparison_ftf_health_plan_fid.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE comparison_ftf_health_plan_fid.status END AS Status,
        comparison_ftf_health_plan_fid.change_in_lives AS "Change in Lives",
        (now())::date AS date_run,
        ('2021-08-10 10:58:30+00'::timestamptz)::timestamp AS modified_time
 FROM sandbox.comparison_ftf_health_plan_fid
 WHERE (comparison_ftf_health_plan_fid.cycle_id IN ( SELECT max(comparison_ftf_health_plan_fid.cycle_id) AS max
 FROM sandbox.comparison_ftf_health_plan_fid));

CREATE  VIEW sandbox.teva_iqvia_bridge_mismatch_analysis AS
 SELECT vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_code AS IQVIA_Plan_Code,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_plan_name AS IQVIA_Plan_Name,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_fid AS "FTF Health Plan FID",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.paytype_index AS PayTypeIndex,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.paytype AS "Pay Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.hp_type AS "HP Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_paytype AS "IQVIA Pay Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.model AS Model,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_pay_types AS "Check Pay Types",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_hp_types AS "Check HP Types",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.old_ftf_health_plan_type AS "Old_FTF Health Plan Type",
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.cycle_id,
        vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.modified_time
 FROM sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1
 WHERE (coalesce(vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW sandbox.vw_iqvia_plan_change AS
 SELECT a.entity AS "Change Type",
        a.id AS ID,
        a.name AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM ((((((((((( SELECT 'Payer'::varchar(5) AS entity,
        curr_month_ims_plan_xref.payer_num AS id,
        curr_month_ims_plan_xref.payer_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ANTI  JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        prev_month_ims_plan_xref.payer_num AS id,
        prev_month_ims_plan_xref.payer_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ANTI  JOIN sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num)))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        vw_curr_month_ims_plan_xref_cdw.payer_num AS id,
        vw_curr_month_ims_plan_xref_cdw.payer_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_plan_xref_cdw
 WHERE (vw_curr_month_ims_plan_xref_cdw.payer_num IN ( SELECT curr_month_ims_plan_xref.payer_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num) AND (curr_month_ims_plan_xref.payer_name <> prev_month_ims_plan_xref.payer_name))))))) UNION  SELECT 'Payer'::varchar(5) AS entity,
        vw_prev_month_ims_plan_xref_cdw.payer_num AS id,
        vw_prev_month_ims_plan_xref_cdw.payer_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_plan_xref_cdw
 WHERE (vw_prev_month_ims_plan_xref_cdw.payer_num IN ( SELECT prev_month_ims_plan_xref.payer_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_num = prev_month_ims_plan_xref.payer_num) AND (curr_month_ims_plan_xref.payer_name <> prev_month_ims_plan_xref.payer_name))))))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        curr_month_ims_plan_xref.payer_plan_num AS id,
        curr_month_ims_plan_xref.plan_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ANTI  JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num)))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        prev_month_ims_plan_xref.payer_plan_num AS id,
        prev_month_ims_plan_xref.plan_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ANTI  JOIN sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref ON ((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num)))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        vw_curr_month_ims_plan_xref_cdw.payer_plan_num AS id,
        vw_curr_month_ims_plan_xref_cdw.plan_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_plan_xref_cdw
 WHERE (vw_curr_month_ims_plan_xref_cdw.payer_plan_num IN ( SELECT curr_month_ims_plan_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num) AND (curr_month_ims_plan_xref.plan_name <> prev_month_ims_plan_xref.plan_name))))))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        vw_prev_month_ims_plan_xref_cdw.payer_plan_num AS id,
        vw_prev_month_ims_plan_xref_cdw.plan_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_plan_xref_cdw
 WHERE (vw_prev_month_ims_plan_xref_cdw.payer_plan_num IN ( SELECT prev_month_ims_plan_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_plan_xref_cdw curr_month_ims_plan_xref JOIN sandbox.vw_prev_month_ims_plan_xref_cdw prev_month_ims_plan_xref ON (((curr_month_ims_plan_xref.payer_plan_num = prev_month_ims_plan_xref.payer_plan_num) AND (curr_month_ims_plan_xref.plan_name <> prev_month_ims_plan_xref.plan_name))))))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        curr_month_ims_pbm_xref.payer_plan_num AS id,
        curr_month_ims_pbm_xref.pbm_name AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref ANTI  JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON ((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num)))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        prev_month_ims_pbm_xref.payer_plan_num AS id,
        prev_month_ims_pbm_xref.pbm_name AS name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ANTI  JOIN sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref ON ((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num)))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        vw_curr_month_ims_pbm_xref_cdw.payer_plan_num AS id,
        vw_curr_month_ims_pbm_xref_cdw.pbm_name AS name,
        'Changed to'::varchar(10) AS status
 FROM sandbox.vw_curr_month_ims_pbm_xref_cdw
 WHERE (vw_curr_month_ims_pbm_xref_cdw.payer_plan_num IN ( SELECT curr_month_ims_pbm_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON (((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num) AND (curr_month_ims_pbm_xref.pbm_name <> prev_month_ims_pbm_xref.pbm_name))))))) UNION  SELECT 'PBM'::varchar(3) AS entity,
        vw_prev_month_ims_pbm_xref_cdw.payer_plan_num AS id,
        vw_prev_month_ims_pbm_xref_cdw.pbm_name AS name,
        'Changed from'::varchar(12) AS status
 FROM sandbox.vw_prev_month_ims_pbm_xref_cdw
 WHERE (vw_prev_month_ims_pbm_xref_cdw.payer_plan_num IN ( SELECT prev_month_ims_pbm_xref.payer_plan_num
 FROM (sandbox.vw_curr_month_ims_pbm_xref_cdw curr_month_ims_pbm_xref JOIN sandbox.vw_prev_month_ims_pbm_xref_cdw prev_month_ims_pbm_xref ON (((curr_month_ims_pbm_xref.payer_plan_num = prev_month_ims_pbm_xref.payer_plan_num) AND (curr_month_ims_pbm_xref.pbm_name <> prev_month_ims_pbm_xref.pbm_name))))))) a
 ORDER BY a.entity,
          a.status,
          a.id,
          a.name;

CREATE  VIEW sandbox.vw_curr_iqvia_plancode_fid_xref_cdw_v1 AS
 SELECT iqvia_plancode_fid_xref_cdw_v1.iqvia_payer_name,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_code,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.comments,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_fid,
        iqvia_plancode_fid_xref_cdw_v1.ftf_provider_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_parent_name,
        iqvia_plancode_fid_xref_cdw_v1.ftf_health_plan_type,
        iqvia_plancode_fid_xref_cdw_v1.paytype_index,
        iqvia_plancode_fid_xref_cdw_v1.paytype,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_pbm,
        iqvia_plancode_fid_xref_cdw_v1.hp_type,
        iqvia_plancode_fid_xref_cdw_v1.iqvia_paytype,
        iqvia_plancode_fid_xref_cdw_v1.pref_brand_tier,
        iqvia_plancode_fid_xref_cdw_v1.lives,
        iqvia_plancode_fid_xref_cdw_v1.cycle_id,
        iqvia_plancode_fid_xref_cdw_v1.modified_time,
        iqvia_plancode_fid_xref_cdw_v1.modified_by
 FROM sandbox.iqvia_plancode_fid_xref_cdw_v1
 WHERE (iqvia_plancode_fid_xref_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_plancode_fid_xref_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_fid_best_iqviapayer_cdw_v1 AS
 SELECT fid_best_iqviapayer_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapayer_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapayer_cdw_v1.ftf_provider_fid,
        fid_best_iqviapayer_cdw_v1.ftf_provider_name,
        fid_best_iqviapayer_cdw_v1.iqvia_payer_name,
        fid_best_iqviapayer_cdw_v1.frequency,
        fid_best_iqviapayer_cdw_v1.cycle_id,
        fid_best_iqviapayer_cdw_v1.modified_time,
        fid_best_iqviapayer_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapayer_cdw_v1
 WHERE (fid_best_iqviapayer_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'fid_best_iqviapayer_cdw_v1'::varchar(26)))))));

CREATE  VIEW sandbox.vw_curr_fid_best_iqviapbm_cdw_v1 AS
 SELECT fid_best_iqviapbm_cdw_v1.ftf_health_plan_fid,
        fid_best_iqviapbm_cdw_v1.ftf_health_plan_name,
        fid_best_iqviapbm_cdw_v1.ftf_provider_fid,
        fid_best_iqviapbm_cdw_v1.ftf_provider_name,
        fid_best_iqviapbm_cdw_v1.iqvia_pbm,
        fid_best_iqviapbm_cdw_v1.frequency,
        fid_best_iqviapbm_cdw_v1.cycle_id,
        fid_best_iqviapbm_cdw_v1.modified_time,
        fid_best_iqviapbm_cdw_v1.modified_by
 FROM sandbox.fid_best_iqviapbm_cdw_v1
 WHERE (fid_best_iqviapbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'fid_best_iqviapbm_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_amb4_iqvia_payer_cdw_v1 AS
 SELECT amb4_iqvia_payer_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_payer_cdw_v1.ftf_provider_fid,
        amb4_iqvia_payer_cdw_v1.ftf_provider_name,
        amb4_iqvia_payer_cdw_v1.ftf_parent_name,
        amb4_iqvia_payer_cdw_v1.paytype_index,
        amb4_iqvia_payer_cdw_v1.paytype,
        amb4_iqvia_payer_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_payer_cdw_v1.pref_brand_tier,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_payer_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_payer_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_payer_cdw_v1.iqvia_payer_name,
        amb4_iqvia_payer_cdw_v1.iqvia_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_payer_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_payer_cdw_v1.lives_mn,
        amb4_iqvia_payer_cdw_v1.cycle_id,
        amb4_iqvia_payer_cdw_v1.modified_time,
        amb4_iqvia_payer_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_payer_cdw_v1
 WHERE (amb4_iqvia_payer_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_iqvia_payer_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_amb4_iqvia_pbm_cdw_v1 AS
 SELECT amb4_iqvia_pbm_cdw_v1.ftf_health_plan_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_name,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_fid,
        amb4_iqvia_pbm_cdw_v1.ftf_provider_name,
        amb4_iqvia_pbm_cdw_v1.ftf_parent_name,
        amb4_iqvia_pbm_cdw_v1.paytype_index,
        amb4_iqvia_pbm_cdw_v1.paytype,
        amb4_iqvia_pbm_cdw_v1.ftf_health_plan_type,
        amb4_iqvia_pbm_cdw_v1.pref_brand_tier,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpayer,
        amb4_iqvia_pbm_cdw_v1.fillIn_blank_iqpbm,
        amb4_iqvia_pbm_cdw_v1.ftf_match_iqvia,
        amb4_iqvia_pbm_cdw_v1.iqvia_payer_name,
        amb4_iqvia_pbm_cdw_v1.iqvia_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_management_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_formulary_influencer_pbm,
        amb4_iqvia_pbm_cdw_v1.ftf_claims_processing_pbm,
        amb4_iqvia_pbm_cdw_v1.lives_mn,
        amb4_iqvia_pbm_cdw_v1.cycle_id,
        amb4_iqvia_pbm_cdw_v1.modified_time,
        amb4_iqvia_pbm_cdw_v1.modified_by
 FROM sandbox.amb4_iqvia_pbm_cdw_v1
 WHERE (amb4_iqvia_pbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb4_iqvia_pbm_cdw_v1'::varchar(21)))))));

CREATE  VIEW sandbox.vw_curr_amb7_cdw_v1 AS
 SELECT amb7_cdw_v1.ftf_health_plan_fid,
        amb7_cdw_v1.ftf_health_plan_name,
        amb7_cdw_v1.ftf_provider_fid,
        amb7_cdw_v1.ftf_provider_name,
        amb7_cdw_v1.ftf_parent_name,
        amb7_cdw_v1.paytype_index,
        amb7_cdw_v1.paytype,
        amb7_cdw_v1.ftf_health_plan_type,
        amb7_cdw_v1.pref_brand_tier,
        amb7_cdw_v1.fillIn_blank_iqpayer,
        amb7_cdw_v1.fillIn_blank_iqpbm,
        amb7_cdw_v1.ftf_match_iqvia,
        amb7_cdw_v1.iqvia_payer_name,
        amb7_cdw_v1.iqvia_pbm,
        amb7_cdw_v1.ftf_formulary_management_pbm,
        amb7_cdw_v1.ftf_formulary_influencer_pbm,
        amb7_cdw_v1.ftf_claims_processing_pbm,
        amb7_cdw_v1.lives_mn,
        amb7_cdw_v1.calculated_pbm_value,
        amb7_cdw_v1.key_pbm,
        amb7_cdw_v1.cycle_id,
        amb7_cdw_v1.modified_time,
        amb7_cdw_v1.modified_by
 FROM sandbox.amb7_cdw_v1
 WHERE (amb7_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'amb7_cdw_v1'::varchar(11)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hpid_keypbm_cdw_v1 AS
 SELECT ftf_hpid_keypbm_cdw_v1.ftf_health_plan_fid,
        ftf_hpid_keypbm_cdw_v1.ftf_health_plan_name,
        ftf_hpid_keypbm_cdw_v1.ftf_provider_name,
        ftf_hpid_keypbm_cdw_v1.paytype,
        ftf_hpid_keypbm_cdw_v1.iqvia_pbm,
        ftf_hpid_keypbm_cdw_v1.key_pbm,
        ftf_hpid_keypbm_cdw_v1.cycle_id,
        ftf_hpid_keypbm_cdw_v1.modified_time,
        ftf_hpid_keypbm_cdw_v1.modified_by
 FROM sandbox.ftf_hpid_keypbm_cdw_v1
 WHERE (ftf_hpid_keypbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hpid_keypbm_cdw_v1'::varchar(22)))))));

CREATE  VIEW sandbox.vw_curr_plan_prod_master_cdw_v1 AS
 SELECT plan_prod_master_cdw_v1.ftf_health_plan_fid,
        plan_prod_master_cdw_v1.ftf_health_plan_name,
        plan_prod_master_cdw_v1.ftf_provider_fid,
        plan_prod_master_cdw_v1.ftf_provider_name,
        plan_prod_master_cdw_v1.ftf_parent_name,
        plan_prod_master_cdw_v1.paytype_index,
        plan_prod_master_cdw_v1.paytype,
        plan_prod_master_cdw_v1.ftf_health_plan_type,
        plan_prod_master_cdw_v1.pref_brand_tier,
        plan_prod_master_cdw_v1.fillIn_blank_iqpayer,
        plan_prod_master_cdw_v1.fillIn_blank_iqpbm,
        plan_prod_master_cdw_v1.ftf_match_iqvia,
        plan_prod_master_cdw_v1.iqvia_payer_name,
        plan_prod_master_cdw_v1.iqvia_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_management_pbm,
        plan_prod_master_cdw_v1.ftf_formulary_influencer_pbm,
        plan_prod_master_cdw_v1.ftf_claims_processing_pbm,
        plan_prod_master_cdw_v1.lives_mn,
        plan_prod_master_cdw_v1.calculated_pbm_value,
        plan_prod_master_cdw_v1.key_pbm,
        plan_prod_master_cdw_v1.drug_id,
        plan_prod_master_cdw_v1.drug_seq,
        plan_prod_master_cdw_v1.tier_code,
        plan_prod_master_cdw_v1.restrictions,
        plan_prod_master_cdw_v1.reason_code,
        plan_prod_master_cdw_v1.pharmacy_status,
        plan_prod_master_cdw_v1.botox,
        plan_prod_master_cdw_v1.step,
        plan_prod_master_cdw_v1.pres_pa,
        plan_prod_master_cdw_v1.pat_pa,
        plan_prod_master_cdw_v1.med_rec,
        plan_prod_master_cdw_v1.unspec,
        plan_prod_master_cdw_v1.tier,
        plan_prod_master_cdw_v1.has_pa,
        plan_prod_master_cdw_v1.has_st,
        plan_prod_master_cdw_v1.formulary,
        plan_prod_master_cdw_v1.copay_tier,
        plan_prod_master_cdw_v1.tier_cat,
        plan_prod_master_cdw_v1.restcat,
        plan_prod_master_cdw_v1.restriction_category,
        plan_prod_master_cdw_v1.coverage_cat_code,
        plan_prod_master_cdw_v1.coverage_category,
        plan_prod_master_cdw_v1.cycle_id,
        plan_prod_master_cdw_v1.modified_time,
        plan_prod_master_cdw_v1.modified_by
 FROM sandbox.plan_prod_master_cdw_v1
 WHERE (plan_prod_master_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'plan_prod_master_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_ftf_plan_master_file_cdw_v1 AS
 SELECT ftf_plan_master_file_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_cdw_v1.ftf_provider_fid,
        ftf_plan_master_file_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_cdw_v1.ftf_parent_name,
        ftf_plan_master_file_cdw_v1.paytype_index,
        ftf_plan_master_file_cdw_v1.paytype,
        ftf_plan_master_file_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpayer,
        ftf_plan_master_file_cdw_v1.fillIn_blank_iqpbm,
        ftf_plan_master_file_cdw_v1.ftf_match_iqvia,
        ftf_plan_master_file_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_cdw_v1.lives_mn,
        ftf_plan_master_file_cdw_v1.calculated_pbm_value,
        ftf_plan_master_file_cdw_v1.key_pbm,
        ftf_plan_master_file_cdw_v1.drug_id,
        ftf_plan_master_file_cdw_v1.drug_seq,
        ftf_plan_master_file_cdw_v1.product,
        ftf_plan_master_file_cdw_v1.tier_code,
        ftf_plan_master_file_cdw_v1.restrictions,
        ftf_plan_master_file_cdw_v1.reason_code,
        ftf_plan_master_file_cdw_v1.pharmacy_status,
        ftf_plan_master_file_cdw_v1.botox,
        ftf_plan_master_file_cdw_v1.botox_step_flag,
        ftf_plan_master_file_cdw_v1.step,
        ftf_plan_master_file_cdw_v1.step_category,
        ftf_plan_master_file_cdw_v1.pres_pa,
        ftf_plan_master_file_cdw_v1.prescriber_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.pat_pa,
        ftf_plan_master_file_cdw_v1.med_rec,
        ftf_plan_master_file_cdw_v1.unspec,
        ftf_plan_master_file_cdw_v1.patient_prior_authorization_category,
        ftf_plan_master_file_cdw_v1.medical_records_submission_required_flag,
        ftf_plan_master_file_cdw_v1.unspecified_restriction_flag,
        ftf_plan_master_file_cdw_v1.ftf_tier,
        ftf_plan_master_file_cdw_v1.has_pa,
        ftf_plan_master_file_cdw_v1.has_st,
        ftf_plan_master_file_cdw_v1.formulary,
        ftf_plan_master_file_cdw_v1.copay_Tier,
        ftf_plan_master_file_cdw_v1.tier_cat,
        ftf_plan_master_file_cdw_v1.restcat,
        ftf_plan_master_file_cdw_v1.restriction_category,
        ftf_plan_master_file_cdw_v1.coverage_cat_code,
        ftf_plan_master_file_cdw_v1.coverage_category,
        ftf_plan_master_file_cdw_v1.key_controlling_account,
        ftf_plan_master_file_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_cdw_v1.payer_pbm,
        ftf_plan_master_file_cdw_v1.cycle_id,
        ftf_plan_master_file_cdw_v1.modified_time,
        ftf_plan_master_file_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_cdw_v1
 WHERE (ftf_plan_master_file_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_plan_master_file_cdw_v1'::varchar(27)))))));

CREATE  VIEW sandbox.vw_curr_copay_tier_derivation_config_cdw AS
 SELECT btrim(copay_tier_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        copay_tier_derivation_config_v01.tier_cat,
        btrim(copay_tier_derivation_config_v01.tier_regex) AS tier_regex,
        btrim(copay_tier_derivation_config_v01.pref_brand_tier_regex) AS pref_brand_tier_regex,
        btrim(copay_tier_derivation_config_v01.ftf_health_plan_type_regex) AS ftf_health_plan_type_regex,
        btrim(copay_tier_derivation_config_v01.copay_tier) AS copay_tier,
        copay_tier_derivation_config_v01.file_id,
        copay_tier_derivation_config_v01.record_id
 FROM sandbox.copay_tier_derivation_config_v01
 WHERE (copay_tier_derivation_config_v01.file_id IN ( SELECT max(copay_tier_derivation_config_v01.file_id) AS max
 FROM sandbox.copay_tier_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_tier_cat_description_mapping_cdw AS
 SELECT tier_cat_description_mapping_v01.tier_cat,
        btrim(tier_cat_description_mapping_v01.description) AS description,
        btrim(tier_cat_description_mapping_v01.notes) AS notes,
        tier_cat_description_mapping_v01.file_id,
        tier_cat_description_mapping_v01.record_id
 FROM sandbox.tier_cat_description_mapping_v01
 WHERE (tier_cat_description_mapping_v01.file_id IN ( SELECT max(tier_cat_description_mapping_v01.file_id) AS max
 FROM sandbox.tier_cat_description_mapping_v01));

CREATE  VIEW sandbox.vw_curr_coverage_category_derivation_config_cdw AS
 SELECT btrim(coverage_category_derivation_config_v01.paytype_regex) AS paytype_regex,
        btrim(coverage_category_derivation_config_v01.pharmacy_status_regex) AS pharmacy_status_regex,
        coverage_category_derivation_config_v01.coverage_cat_code,
        btrim(coverage_category_derivation_config_v01.coverage_category) AS coverage_category,
        btrim(coverage_category_derivation_config_v01.restriction_cat_code_regex) AS restriction_cat_code_regex,
        btrim(coverage_category_derivation_config_v01.meaning) AS meaning,
        coverage_category_derivation_config_v01.file_id,
        coverage_category_derivation_config_v01.record_id
 FROM sandbox.coverage_category_derivation_config_v01
 WHERE (coverage_category_derivation_config_v01.file_id IN ( SELECT max(coverage_category_derivation_config_v01.file_id) AS max
 FROM sandbox.coverage_category_derivation_config_v01));

CREATE  VIEW sandbox.vw_curr_payer_spine25_detailed_teva_brands_cdw_v1 AS
 SELECT payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_detailed_teva_brands_cdw_v1.payment_type,
        payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_detailed_teva_brands_cdw_v1.saba_trx,
        payer_spine25_detailed_teva_brands_cdw_v1.cycle_id,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_time,
        payer_spine25_detailed_teva_brands_cdw_v1.modified_by
 FROM sandbox.payer_spine25_detailed_teva_brands_cdw_v1
 WHERE (payer_spine25_detailed_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_detailed_teva_brands_cdw_v1'::varchar(41)))))));

CREATE  VIEW sandbox.ics_mop AS
 SELECT rx_vertical.ims_id,
        rx_vertical.hcp_id,
        rx_vertical.plan_code,
        rx_vertical.plan_name,
        rx_vertical.model,
        rx_vertical.basket_name,
        sum(CASE WHEN (rx_vertical.month_bucket = 24) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth24,
        sum(CASE WHEN (rx_vertical.month_bucket = 23) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth23,
        sum(CASE WHEN (rx_vertical.month_bucket = 22) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth22,
        sum(CASE WHEN (rx_vertical.month_bucket = 21) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth21,
        sum(CASE WHEN (rx_vertical.month_bucket = 20) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth20,
        sum(CASE WHEN (rx_vertical.month_bucket = 19) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth19,
        sum(CASE WHEN (rx_vertical.month_bucket = 18) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth18,
        sum(CASE WHEN (rx_vertical.month_bucket = 17) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth17,
        sum(CASE WHEN (rx_vertical.month_bucket = 16) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth16,
        sum(CASE WHEN (rx_vertical.month_bucket = 15) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth15,
        sum(CASE WHEN (rx_vertical.month_bucket = 14) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth14,
        sum(CASE WHEN (rx_vertical.month_bucket = 13) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth13,
        sum(CASE WHEN (rx_vertical.month_bucket = 12) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth12,
        sum(CASE WHEN (rx_vertical.month_bucket = 11) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth11,
        sum(CASE WHEN (rx_vertical.month_bucket = 10) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth10,
        sum(CASE WHEN (rx_vertical.month_bucket = 9) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth9,
        sum(CASE WHEN (rx_vertical.month_bucket = 8) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth8,
        sum(CASE WHEN (rx_vertical.month_bucket = 7) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth7,
        sum(CASE WHEN (rx_vertical.month_bucket = 6) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth6,
        sum(CASE WHEN (rx_vertical.month_bucket = 5) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth5,
        sum(CASE WHEN (rx_vertical.month_bucket = 4) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth4,
        sum(CASE WHEN (rx_vertical.month_bucket = 3) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth3,
        sum(CASE WHEN (rx_vertical.month_bucket = 2) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth2,
        sum(CASE WHEN (rx_vertical.month_bucket = 1) THEN rx_vertical.trx_count ELSE 0::numeric(18,0) END) AS trx_mth1
 FROM ( SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id,
        CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(xref.veeva_account_id, rx.ims_id) END AS hcp_id,
        rx.payer_plan_number AS plan_code,
        rx.plan_name,
        rx.model,
        rx.basket_name,
        w.month_bucket,
        rx.trx_count
 FROM ((datamart.prescriber_rx rx JOIN ( SELECT ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket
 FROM integration.ims_week_buckets
 GROUP BY ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket) w ON ((rx.rollup_month = w.month_ending))) LEFT  JOIN ( SELECT a.tvcmid,
        a.veeva_account_id
 FROM ( SELECT xref.tvcmid,
        xref.id_num AS veeva_account_id,
        row_number() OVER (PARTITION BY xref.tvcmid ORDER BY xref.id_num) AS rnk
 FROM datamart.tvcmid_xref xref
 WHERE (xref.id_type = 'VEEVA_ID'::varchar(8))) a
 WHERE (a.rnk = 1)) xref ON ((xref.tvcmid = rx.tvcmid)))
 WHERE ((rx.market_name = 'ICS MARKET TOTAL'::varchar(16)) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9)) AND (w.month_bucket >= 1) AND (w.month_bucket <= 24))) rx_vertical
 GROUP BY rx_vertical.ims_id,
          rx_vertical.hcp_id,
          rx_vertical.plan_code,
          rx_vertical.plan_name,
          rx_vertical.model,
          rx_vertical.basket_name;

CREATE  VIEW sandbox.call AS
 SELECT a.id,
        a.ownerid,
        a.isdeleted,
        a.name,
        a.recordtypeid,
        a.createddate,
        a.createdbyid,
        a.lastmodifieddate,
        a.lastmodifiedbyid,
        a.systemmodstamp,
        a.lastactivitydate,
        a.mayedit,
        a.islocked,
        a.lastvieweddate,
        a.lastreferenceddate,
        a.sample_card_vod__c,
        a.add_detail_vod__c,
        a.property_vod__c,
        a.account_vod__c,
        a.zvod_product_discussion_vod__c,
        a.status_vod__c,
        a.parent_address_vod__c,
        a.account_plan_vod__c,
        a.zvod_savenew_vod__c,
        a.next_call_notes_vod__c,
        a.mobile_id_vod__c,
        a.zvod_account_credentials_vod_c,
        a.zvod_account_preferred_name_vo,
        a.zvod_account_sample_status_vod,
        a.zvod_attendees_vod__c,
        a.zvod_key_messages_vod__c,
        a.zvod_detailing_vod__c,
        a.zvod_expenses_vod__c,
        a.zvod_followup_vod__c,
        a.zvod_samples_vod__c,
        a.zvod_save_vod__c,
        a.zvod_submit_vod__c,
        a.zvod_delete_vod__c,
        a.activity_type__c,
        a.significant_event__c,
        a.location_vod__c,
        a.subject_vod__c,
        a.call_datetime_vod__c,
        a.disbursed_to_vod__c,
        a.request_receipt_vod__c,
        a.signature_date_vod__c,
        a.territory_vod__c,
        a.submitted_by_mobile_vod__c,
        a.call_type_vod__c,
        a.add_key_message_vod__c,
        a.address_vod__c,
        a.attendees_vod__c,
        a.attendee_type_vod__c,
        a.call_date_vod__c,
        a.detailed_products_vod__c,
        a.no_disbursement_vod__c,
        a.parent_call_vod__c,
        a.user_vod__c,
        a.contact_vod__c,
        a.zvod_entity_vod__c,
        a.medical_event_vod__c,
        a.mobile_created_datetime_vod__c,
        a.mobile_last_modified_datetime,
        a.license_vod__c,
        a.is_parent_call_vod__c,
        a.entity_display_name_vod__c,
        a.last_device_vod__c,
        a.ship_address_line_1_vod__c,
        a.ship_address_line_2_vod__c,
        a.ship_city_vod__c,
        a.ship_country_vod__c,
        a.ship_license_expiration_date,
        a.ship_license_status_vod__c,
        a.ship_license_vod__c,
        a.ship_state_vod__c,
        a.ship_to_address_vod__c,
        a.ship_zip_vod__c,
        a.ship_to_address_text_vod__c,
        a.clm_vod__c,
        a.zvod_clmdetails_vod__c,
        a.is_sampled_call_vod__c,
        a.zvod_surveys_vod__c,
        a.presentations_vod__c,
        a.entity_reference_id_vod__c,
        a.error_reference_call_vod__c,
        a.duration_vod__c,
        a.color_vod__c,
        a.allowed_products_vod__c,
        a.zvod_attachments_vod__c,
        a.sample_card_reason_vod__c,
        a.assmca_vod__c,
        a.address_line_1_vod__c,
        a.address_line_2_vod__c,
        a.city_vod__c,
        a.dea_address_line_1_vod__c,
        a.dea_address_line_2_vod__c,
        a.dea_address_vod__c,
        a.dea_city_vod__c,
        a.dea_expiration_date_vod__c,
        a.dea_state_vod__c,
        a.dea_zip_4_vod__c,
        a.dea_zip_vod__c,
        a.dea_vod__c,
        a.ship_zip_4_vod__c,
        a.state_vod__c,
        a.zip_4_vod__c,
        a.zip_vod__c,
        a.sample_send_card_vod__c,
        a.zvod_address_vod_c_dea_status_,
        a.signature_page_image_vod__c,
        a.credentials_vod__c,
        a.salutation_vod__c,
        a.zvod_account_call_reminder_vod,
        a.sales_org_tva__c,
        a.zvod_business_account_vod__c,
        a.product_priority_1_vod__c,
        a.product_priority_2_vod__c,
        a.product_priority_3_vod__c,
        a.product_priority_4_vod__c,
        a.product_priority_5_vod__c,
        a.zvod_more_actions_vod__c,
        a.zvod_call_conflict_status,
        a.signature_timestamp_vod__c,
        a.expense_amount_vod__c,
        a.total_expense_attendees_count,
        a.attendee_list_vod__c,
        a.expense_post_status_vod__c,
        a.attendee_post_status_vod__c,
        a.expense_system_external_id,
        a.incurred_expense_vod__c,
        a.assigner_vod__c,
        a.assignment_datetime_vod__c,
        a.zvod_call_objective_vod__c,
        a.signature_location_longitude,
        a.signature_location_latitude,
        a.location_services_status,
        a.created_by_timezone_tva__c,
        a.license_expiration_date_vod__c,
        a.license_status_vod__c,
        a.ship_assmca_vod__c,
        a.ship_dea_expiration_date,
        a.ship_dea_vod__c,
        a.call_method_tva__c,
        a.bendeka_indication_tva__c,
        a.file_id,
        a.record_id,
        a.austedo_indication_tva__c,
        a.call_duration_tva__c,
        a.how_executed_tva__c,
        a.Remote_Meeting_vod__c,
        a.Veeva_Remote_Meeting_Id_vod__c,
        a.Cobrowse_URL_Participant_vod__c,
        a.Signature_Captured_Remotely_vod__c,
        a.Remote_Signature_Attendee_Name_vod__c,
        a.rowrank
 FROM ( SELECT c.id,
        c.ownerid,
        c.isdeleted,
        c.name,
        c.recordtypeid,
        c.createddate,
        c.createdbyid,
        c.lastmodifieddate,
        c.lastmodifiedbyid,
        c.systemmodstamp,
        c.lastactivitydate,
        c.mayedit,
        c.islocked,
        c.lastvieweddate,
        c.lastreferenceddate,
        c.sample_card_vod__c,
        c.add_detail_vod__c,
        c.property_vod__c,
        c.account_vod__c,
        c.zvod_product_discussion_vod__c,
        c.status_vod__c,
        c.parent_address_vod__c,
        c.account_plan_vod__c,
        c.zvod_savenew_vod__c,
        c.next_call_notes_vod__c,
        c.mobile_id_vod__c,
        c.zvod_account_credentials_vod_c,
        c.zvod_account_preferred_name_vo,
        c.zvod_account_sample_status_vod,
        c.zvod_attendees_vod__c,
        c.zvod_key_messages_vod__c,
        c.zvod_detailing_vod__c,
        c.zvod_expenses_vod__c,
        c.zvod_followup_vod__c,
        c.zvod_samples_vod__c,
        c.zvod_save_vod__c,
        c.zvod_submit_vod__c,
        c.zvod_delete_vod__c,
        c.activity_type__c,
        c.significant_event__c,
        c.location_vod__c,
        c.subject_vod__c,
        c.call_datetime_vod__c,
        c.disbursed_to_vod__c,
        c.request_receipt_vod__c,
        c.signature_date_vod__c,
        c.territory_vod__c,
        c.submitted_by_mobile_vod__c,
        c.call_type_vod__c,
        c.add_key_message_vod__c,
        c.address_vod__c,
        c.attendees_vod__c,
        c.attendee_type_vod__c,
        c.call_date_vod__c,
        c.detailed_products_vod__c,
        c.no_disbursement_vod__c,
        c.parent_call_vod__c,
        c.user_vod__c,
        c.contact_vod__c,
        c.zvod_entity_vod__c,
        c.medical_event_vod__c,
        c.mobile_created_datetime_vod__c,
        c.mobile_last_modified_datetime,
        c.license_vod__c,
        c.is_parent_call_vod__c,
        c.entity_display_name_vod__c,
        c.last_device_vod__c,
        c.ship_address_line_1_vod__c,
        c.ship_address_line_2_vod__c,
        c.ship_city_vod__c,
        c.ship_country_vod__c,
        c.ship_license_expiration_date,
        c.ship_license_status_vod__c,
        c.ship_license_vod__c,
        c.ship_state_vod__c,
        c.ship_to_address_vod__c,
        c.ship_zip_vod__c,
        c.ship_to_address_text_vod__c,
        c.clm_vod__c,
        c.zvod_clmdetails_vod__c,
        c.is_sampled_call_vod__c,
        c.zvod_surveys_vod__c,
        c.presentations_vod__c,
        c.entity_reference_id_vod__c,
        c.error_reference_call_vod__c,
        c.duration_vod__c,
        c.color_vod__c,
        c.allowed_products_vod__c,
        c.zvod_attachments_vod__c,
        c.sample_card_reason_vod__c,
        c.assmca_vod__c,
        c.address_line_1_vod__c,
        c.address_line_2_vod__c,
        c.city_vod__c,
        c.dea_address_line_1_vod__c,
        c.dea_address_line_2_vod__c,
        c.dea_address_vod__c,
        c.dea_city_vod__c,
        c.dea_expiration_date_vod__c,
        c.dea_state_vod__c,
        c.dea_zip_4_vod__c,
        c.dea_zip_vod__c,
        c.dea_vod__c,
        c.ship_zip_4_vod__c,
        c.state_vod__c,
        c.zip_4_vod__c,
        c.zip_vod__c,
        c.sample_send_card_vod__c,
        c.zvod_address_vod_c_dea_status_,
        c.signature_page_image_vod__c,
        c.credentials_vod__c,
        c.salutation_vod__c,
        c.zvod_account_call_reminder_vod,
        c.sales_org_tva__c,
        c.zvod_business_account_vod__c,
        c.product_priority_1_vod__c,
        c.product_priority_2_vod__c,
        c.product_priority_3_vod__c,
        c.product_priority_4_vod__c,
        c.product_priority_5_vod__c,
        c.zvod_more_actions_vod__c,
        c.zvod_call_conflict_status,
        c.signature_timestamp_vod__c,
        c.expense_amount_vod__c,
        c.total_expense_attendees_count,
        c.attendee_list_vod__c,
        c.expense_post_status_vod__c,
        c.attendee_post_status_vod__c,
        c.expense_system_external_id,
        c.incurred_expense_vod__c,
        c.assigner_vod__c,
        c.assignment_datetime_vod__c,
        c.zvod_call_objective_vod__c,
        c.signature_location_longitude,
        c.signature_location_latitude,
        c.location_services_status,
        c.created_by_timezone_tva__c,
        c.license_expiration_date_vod__c,
        c.license_status_vod__c,
        c.ship_assmca_vod__c,
        c.ship_dea_expiration_date,
        c.ship_dea_vod__c,
        c.call_method_tva__c,
        c.bendeka_indication_tva__c,
        c.file_id,
        c.record_id,
        c.austedo_indication_tva__c,
        c.call_duration_tva__c,
        c.how_executed_tva__c,
        c.Remote_Meeting_vod__c,
        c.Veeva_Remote_Meeting_Id_vod__c,
        c.Cobrowse_URL_Participant_vod__c,
        c.Signature_Captured_Remotely_vod__c,
        c.Remote_Signature_Attendee_Name_vod__c,
        rank() OVER (PARTITION BY c.id ORDER BY c.file_id DESC) AS rowrank
 FROM veeva.call c
 WHERE (c.call_date_vod__c >= add_months((statement_timestamp())::timestamp, (-24)))) a
 WHERE (a.rowrank = 1);

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies AS
 SELECT btrim(ftf_formularies.health_plan_id) AS health_plan_id,
        btrim(ftf_formularies.drug_id) AS drug_id,
        btrim(ftf_formularies.tier_code) AS tier_code,
        btrim(ftf_formularies.restrictions) AS restrictions,
        btrim(ftf_formularies.reason_code) AS reason_code,
        btrim(ftf_formularies.reason_code_description) AS btrim,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans AS
 SELECT btrim(ftf_health_plans.formularyf_id) AS formularyf_id,
        btrim(ftf_health_plans.provider_id) AS provider_id,
        btrim(ftf_health_plans.provider) AS provider,
        btrim(ftf_health_plans.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plans.health_plan) AS health_plan,
        btrim(ftf_health_plans.parent_id) AS parent_id,
        btrim(ftf_health_plans.parent) AS parent,
        ftf_health_plans.national_lives_count,
        btrim(ftf_health_plans.plan_type_name) AS plan_type_name,
        ftf_health_plans.preferred_brand_tier,
        ftf_health_plans.file_id,
        ftf_health_plans.record_id
 FROM cleansed.ftf_health_plans
 WHERE (ftf_health_plans.file_id IN ( SELECT max(ftf_health_plans.file_id) AS max
 FROM cleansed.ftf_health_plans));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography AS
 SELECT btrim(ftf_health_plan_geography.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plan_geography.operating_state) AS operating_state,
        ftf_health_plan_geography.lives_coverage,
        ftf_health_plan_geography.file_id,
        ftf_health_plan_geography.record_id
 FROM cleansed.ftf_health_plan_geography
 WHERE (ftf_health_plan_geography.file_id IN ( SELECT max(ftf_health_plan_geography.file_id) AS max
 FROM cleansed.ftf_health_plan_geography));

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms AS
 SELECT btrim(ftf_pbms.health_plan_id) AS health_plan_id,
        btrim(ftf_pbms.pbm_id) AS pbm_id,
        btrim(ftf_pbms.pbm) AS pbm,
        btrim(ftf_pbms.pbm_function_id) AS pbm_function_id,
        btrim(ftf_pbms.pbm_function) AS pbm_function,
        ftf_pbms.file_id,
        ftf_pbms.record_id
 FROM cleansed.ftf_pbms
 WHERE (ftf_pbms.file_id IN ( SELECT max(ftf_pbms.file_id) AS max
 FROM cleansed.ftf_pbms));

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions AS
 SELECT btrim(ftf_restrictions_v2.health_plan_id) AS health_plan_id,
        btrim(ftf_restrictions_v2.drug_id) AS drug_id,
        btrim(ftf_restrictions_v2.restriction_code) AS restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        btrim(ftf_restrictions_v2.restriction_detail_text) AS restriction_detail_text,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_1) AS restriction_addtnl_information_1,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_2) AS restriction_addtnl_information_2,
        btrim(ftf_restrictions_v2.step_count) AS step_count,
        btrim(ftf_restrictions_v2.pa_form) AS pa_form,
        btrim(ftf_restrictions_v2.indication) AS indication,
        btrim(ftf_restrictions_v2.grouped_restriction_level) AS grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 WHERE (ftf_restrictions_v2.file_id IN ( SELECT max(ftf_restrictions_v2.file_id) AS max
 FROM cleansed.ftf_restrictions_v2));

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref AS
 SELECT btrim(ims_plan_xref.payer_num) AS payer_num,
        btrim(ims_plan_xref.payer_name) AS payer_name,
        btrim(ims_plan_xref.plan_num) AS plan_num,
        btrim(ims_plan_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_plan_xref.plan_name) AS plan_name,
        btrim(ims_plan_xref.model) AS model,
        btrim(ims_plan_xref.city) AS city,
        btrim(ims_plan_xref.hq_state) AS hq_state,
        btrim(ims_plan_xref.operating_state) AS operating_state,
        ims_plan_xref.months_with_data,
        ims_plan_xref.file_id,
        ims_plan_xref.record_id
 FROM cleansed.ims_plan_xref
 WHERE (ims_plan_xref.file_id IN ( SELECT max(ims_plan_xref.file_id) AS max
 FROM cleansed.ims_plan_xref));

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref AS
 SELECT btrim(ims_pbm_xref.pbm_name) AS pbm_name,
        btrim(ims_pbm_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_pbm_xref.xref_to_payer_plan_num) AS xref_to_payer_plan_num,
        btrim(ims_pbm_xref.ipd_id) AS ipd_id,
        btrim(ims_pbm_xref.ipd_type) AS ipd_type,
        btrim(ims_pbm_xref.plan_name) AS plan_name,
        ims_pbm_xref.pbm_num,
        ims_pbm_xref.ims_processor_num,
        ims_pbm_xref.file_id,
        ims_pbm_xref.record_id
 FROM cleansed.ims_pbm_xref
 WHERE (ims_pbm_xref.file_id IN ( SELECT max(ims_pbm_xref.file_id) AS max
 FROM cleansed.ims_pbm_xref));

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge AS
 SELECT btrim(ftf_ims_bridge.payer_name) AS payer_name,
        btrim(ftf_ims_bridge.code) AS code,
        btrim(ftf_ims_bridge.name) AS name,
        btrim(ftf_ims_bridge.state) AS state,
        btrim(ftf_ims_bridge.comments) AS comments,
        ftf_ims_bridge.plan_id,
        btrim(ftf_ims_bridge.plan_name) AS plan_name,
        btrim(ftf_ims_bridge.provider_name) AS provider_name,
        btrim(ftf_ims_bridge.plan_type_name) AS plan_type_name,
        ftf_ims_bridge.file_id,
        ftf_ims_bridge.record_id
 FROM cleansed.ftf_ims_bridge
 WHERE (ftf_ims_bridge.file_id IN ( SELECT max(ftf_ims_bridge.file_id) AS max
 FROM cleansed.ftf_ims_bridge));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies AS
 SELECT btrim(ftf_formularies.health_plan_id) AS health_plan_id,
        btrim(ftf_formularies.drug_id) AS drug_id,
        btrim(ftf_formularies.tier_code) AS tier_code,
        btrim(ftf_formularies.restrictions) AS restrictions,
        btrim(ftf_formularies.reason_code) AS reason_code,
        btrim(ftf_formularies.reason_code_description) AS btrim,
        ftf_formularies.file_id,
        ftf_formularies.record_id
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_formularies.file_id
 FROM cleansed.ftf_formularies
 GROUP BY ftf_formularies.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plans AS
 SELECT btrim(ftf_health_plans.formularyf_id) AS formularyf_id,
        btrim(ftf_health_plans.provider_id) AS provider_id,
        btrim(ftf_health_plans.provider) AS provider,
        btrim(ftf_health_plans.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plans.health_plan) AS health_plan,
        btrim(ftf_health_plans.parent_id) AS parent_id,
        btrim(ftf_health_plans.parent) AS parent,
        ftf_health_plans.national_lives_count,
        btrim(ftf_health_plans.plan_type_name) AS plan_type_name,
        ftf_health_plans.preferred_brand_tier,
        ftf_health_plans.file_id,
        ftf_health_plans.record_id
 FROM cleansed.ftf_health_plans
 WHERE (ftf_health_plans.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_health_plans.file_id
 FROM cleansed.ftf_health_plans
 GROUP BY ftf_health_plans.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_health_plan_geography AS
 SELECT btrim(ftf_health_plan_geography.health_plan_id) AS health_plan_id,
        btrim(ftf_health_plan_geography.operating_state) AS operating_state,
        ftf_health_plan_geography.lives_coverage,
        ftf_health_plan_geography.file_id,
        ftf_health_plan_geography.record_id
 FROM cleansed.ftf_health_plan_geography
 WHERE (ftf_health_plan_geography.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_health_plan_geography.file_id
 FROM cleansed.ftf_health_plan_geography
 GROUP BY ftf_health_plan_geography.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_pbms AS
 SELECT btrim(ftf_pbms.health_plan_id) AS health_plan_id,
        btrim(ftf_pbms.pbm_id) AS pbm_id,
        btrim(ftf_pbms.pbm) AS pbm,
        btrim(ftf_pbms.pbm_function_id) AS pbm_function_id,
        btrim(ftf_pbms.pbm_function) AS pbm_function,
        ftf_pbms.file_id,
        ftf_pbms.record_id
 FROM cleansed.ftf_pbms
 WHERE (ftf_pbms.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_pbms.file_id
 FROM cleansed.ftf_pbms
 GROUP BY ftf_pbms.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions AS
 SELECT btrim(ftf_restrictions_v2.health_plan_id) AS health_plan_id,
        btrim(ftf_restrictions_v2.drug_id) AS drug_id,
        btrim(ftf_restrictions_v2.restriction_code) AS restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        btrim(ftf_restrictions_v2.restriction_detail_text) AS restriction_detail_text,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_1) AS restriction_addtnl_information_1,
        btrim(ftf_restrictions_v2.restriction_addtnl_information_2) AS restriction_addtnl_information_2,
        btrim(ftf_restrictions_v2.step_count) AS step_count,
        btrim(ftf_restrictions_v2.pa_form) AS pa_form,
        btrim(ftf_restrictions_v2.indication) AS indication,
        btrim(ftf_restrictions_v2.grouped_restriction_level) AS grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 WHERE (ftf_restrictions_v2.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_restrictions_v2.file_id
 FROM cleansed.ftf_restrictions_v2
 GROUP BY ftf_restrictions_v2.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_plan_xref AS
 SELECT btrim(ims_plan_xref.payer_num) AS payer_num,
        btrim(ims_plan_xref.payer_name) AS payer_name,
        btrim(ims_plan_xref.plan_num) AS plan_num,
        btrim(ims_plan_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_plan_xref.plan_name) AS plan_name,
        btrim(ims_plan_xref.model) AS model,
        btrim(ims_plan_xref.city) AS city,
        btrim(ims_plan_xref.hq_state) AS hq_state,
        btrim(ims_plan_xref.operating_state) AS operating_state,
        ims_plan_xref.months_with_data,
        ims_plan_xref.file_id,
        ims_plan_xref.record_id
 FROM cleansed.ims_plan_xref
 WHERE (ims_plan_xref.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ims_plan_xref.file_id
 FROM cleansed.ims_plan_xref
 GROUP BY ims_plan_xref.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ims_pbm_xref AS
 SELECT btrim(ims_pbm_xref.pbm_name) AS pbm_name,
        btrim(ims_pbm_xref.payer_plan_num) AS payer_plan_num,
        btrim(ims_pbm_xref.xref_to_payer_plan_num) AS xref_to_payer_plan_num,
        btrim(ims_pbm_xref.ipd_id) AS ipd_id,
        btrim(ims_pbm_xref.ipd_type) AS ipd_type,
        btrim(ims_pbm_xref.plan_name) AS plan_name,
        ims_pbm_xref.pbm_num,
        ims_pbm_xref.ims_processor_num,
        ims_pbm_xref.file_id,
        ims_pbm_xref.record_id
 FROM cleansed.ims_pbm_xref
 WHERE (ims_pbm_xref.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ims_pbm_xref.file_id
 FROM cleansed.ims_pbm_xref
 GROUP BY ims_pbm_xref.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_prev_month_ftf_ims_bridge AS
 SELECT btrim(ftf_ims_bridge.payer_name) AS payer_name,
        btrim(ftf_ims_bridge.code) AS code,
        btrim(ftf_ims_bridge.name) AS name,
        btrim(ftf_ims_bridge.state) AS state,
        btrim(ftf_ims_bridge.comments) AS comments,
        ftf_ims_bridge.plan_id,
        btrim(ftf_ims_bridge.plan_name) AS plan_name,
        btrim(ftf_ims_bridge.provider_name) AS provider_name,
        btrim(ftf_ims_bridge.plan_type_name) AS plan_type_name,
        ftf_ims_bridge.file_id,
        ftf_ims_bridge.record_id
 FROM cleansed.ftf_ims_bridge
 WHERE (ftf_ims_bridge.file_id IN ( SELECT metadata_file.file_id
 FROM ( SELECT data_file_metadata.file_id,
        (date_part('month'::varchar(5), data_file_metadata.processed_date))::int AS month,
        rank() OVER (PARTITION BY (date_part('month'::varchar(5), data_file_metadata.processed_date))::int ORDER BY data_file_metadata.processed_date DESC) AS rn
 FROM metadata.data_file_metadata
 WHERE ((data_file_metadata.file_id IN ( SELECT ftf_ims_bridge.file_id
 FROM cleansed.ftf_ims_bridge
 GROUP BY ftf_ims_bridge.file_id)) AND ("datediff"('month'::varchar(5), data_file_metadata.processed_date, (now())::date) = 1))) metadata_file
 WHERE (metadata_file.rn = 1)));

CREATE  VIEW sandbox.vw_qc_uniq_iqvia_model_plan_count AS
 SELECT iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.model;

CREATE  VIEW sandbox.vw_qc_uniq_paytype_plan_count AS
 SELECT iqvia_plan_preprocessed.paytype,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_uniq_payer_plan_count AS
 SELECT iqvia_plan_preprocessed.iqvia_payer_name,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_payer_name;

CREATE  VIEW sandbox.vw_qc_uniq_pbm_plan_count AS
 SELECT iqvia_plan_preprocessed.iqvia_pbm,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_pbm;

CREATE  VIEW sandbox.vw_qc_uniq_plan_model_codes AS
 SELECT iqvia_plan_preprocessed.iqvia_payer_name,
        iqvia_plan_preprocessed.paytype,
        iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_code) AS count
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.iqvia_payer_name,
          iqvia_plan_preprocessed.paytype,
          iqvia_plan_preprocessed.model
 ORDER BY iqvia_plan_preprocessed.iqvia_payer_name,
          iqvia_plan_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_uniq_paytype_model_plan_count AS
 SELECT iqvia_plan_preprocessed.paytype,
        iqvia_plan_preprocessed.model,
        count(DISTINCT iqvia_plan_preprocessed.iqvia_plan_name) AS plan_counts
 FROM sandbox.iqvia_plan_preprocessed
 WHERE (iqvia_plan_preprocessed.cycle_id IN ( SELECT max(iqvia_plan_preprocessed.cycle_id) AS max
 FROM sandbox.iqvia_plan_preprocessed))
 GROUP BY iqvia_plan_preprocessed.paytype,
          iqvia_plan_preprocessed.model;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_paytype_plan_count AS
 SELECT ftf_health_plans_preprocessed.paytype,
        count(DISTINCT ftf_health_plans_preprocessed.ftf_health_plan_name) AS plan_count
 FROM sandbox.ftf_health_plans_preprocessed
 WHERE (ftf_health_plans_preprocessed.cycle_id IN ( SELECT max(ftf_health_plans_preprocessed.cycle_id) AS max
 FROM sandbox.ftf_health_plans_preprocessed))
 GROUP BY ftf_health_plans_preprocessed.paytype
 ORDER BY ftf_health_plans_preprocessed.paytype;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_paytype_plantype_plan_count AS
 SELECT ftf_health_plans_preprocessed.paytype,
        ftf_health_plans_preprocessed.ftf_health_plan_type,
        count(DISTINCT ftf_health_plans_preprocessed.ftf_health_plan_name) AS plan_count
 FROM sandbox.ftf_health_plans_preprocessed
 WHERE (ftf_health_plans_preprocessed.cycle_id IN ( SELECT max(ftf_health_plans_preprocessed.cycle_id) AS max
 FROM sandbox.ftf_health_plans_preprocessed))
 GROUP BY ftf_health_plans_preprocessed.paytype,
          ftf_health_plans_preprocessed.ftf_health_plan_type
 ORDER BY ftf_health_plans_preprocessed.paytype,
          ftf_health_plans_preprocessed.ftf_health_plan_type;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_restriction_group_plan_count AS
 SELECT ftf_restrictions_preprocessed_v1.grouped_restriction_level,
        count(DISTINCT ftf_restrictions_preprocessed_v1.ftf_health_plan_fid) AS plan_count
 FROM sandbox.ftf_restrictions_preprocessed_v1
 GROUP BY ftf_restrictions_preprocessed_v1.grouped_restriction_level
 ORDER BY ftf_restrictions_preprocessed_v1.grouped_restriction_level;

CREATE  VIEW sandbox.vw_qc_ftf_uniq_restriction_detail_plan_count AS
 SELECT ftf_restrictions_preprocessed_v1.restriction_detail_text,
        count(DISTINCT ftf_restrictions_preprocessed_v1.ftf_health_plan_fid) AS plan_count
 FROM sandbox.ftf_restrictions_preprocessed_v1
 GROUP BY ftf_restrictions_preprocessed_v1.restriction_detail_text
 ORDER BY ftf_restrictions_preprocessed_v1.restriction_detail_text;

CREATE  VIEW sandbox.vw_curr_iqvia_plans_discard_v1 AS
 SELECT btrim(iqvia_plans_discard_v1.payer_id) AS payer_id,
        btrim(iqvia_plans_discard_v1.notes) AS notes,
        iqvia_plans_discard_v1.file_id,
        iqvia_plans_discard_v1.record_id
 FROM sandbox.iqvia_plans_discard_v1
 WHERE (iqvia_plans_discard_v1.file_id IN ( SELECT max(iqvia_plans_discard_v1.file_id) AS max
 FROM sandbox.iqvia_plans_discard_v1));

CREATE  VIEW sandbox.vw_curr_model_paytype_map_v1 AS
 SELECT btrim(model_paytype_map_v1.model) AS model,
        btrim(model_paytype_map_v1.paytype) AS paytype,
        btrim(model_paytype_map_v1.notes) AS notes,
        model_paytype_map_v1.file_id,
        model_paytype_map_v1.record_id
 FROM sandbox.model_paytype_map_v1
 WHERE (model_paytype_map_v1.file_id IN ( SELECT max(model_paytype_map_v1.file_id) AS max
 FROM sandbox.model_paytype_map_v1));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_paytype_override_v1 AS
 SELECT btrim(iqvia_payer_paytype_override_v1.iqvia_payer_name) AS iqvia_payer_name,
        btrim(iqvia_payer_paytype_override_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(iqvia_payer_paytype_override_v1.paytype) AS paytype,
        iqvia_payer_paytype_override_v1.file_id,
        iqvia_payer_paytype_override_v1.record_id
 FROM sandbox.iqvia_payer_paytype_override_v1
 WHERE (iqvia_payer_paytype_override_v1.file_id IN ( SELECT max(iqvia_payer_paytype_override_v1.file_id) AS max
 FROM sandbox.iqvia_payer_paytype_override_v1));

CREATE  VIEW sandbox.vw_curr_iqvia_paytypeindex_v1 AS
 SELECT btrim(iqvia_paytypeindex_v1.paytype_index) AS paytype_index,
        btrim(iqvia_paytypeindex_v1.paytype) AS paytype,
        iqvia_paytypeindex_v1.file_id,
        iqvia_paytypeindex_v1.record_id
 FROM sandbox.iqvia_paytypeindex_v1
 WHERE (iqvia_paytypeindex_v1.file_id IN ( SELECT max(iqvia_paytypeindex_v1.file_id) AS max
 FROM sandbox.iqvia_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_drug_assignments_v1 AS
 SELECT drug_assignments_v1.drug_id,
        drug_assignments_v1.drug_seq,
        btrim(drug_assignments_v1.product) AS product,
        drug_assignments_v1.file_id,
        drug_assignments_v1.record_id
 FROM sandbox.drug_assignments_v1
 WHERE (drug_assignments_v1.file_id IN ( SELECT max(drug_assignments_v1.file_id) AS max
 FROM sandbox.drug_assignments_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans_v1 AS
 SELECT replace(replace(btrim(raw_ftf_health_plans.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS formularyf_id,
        replace(replace(btrim(raw_ftf_health_plans.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        replace(replace(btrim(raw_ftf_health_plans.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        replace(replace(btrim(raw_ftf_health_plans.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        raw_ftf_health_plans.preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans;

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plan_geography_v1 AS
 SELECT replace(replace(btrim(raw_ftf_health_plan_geography.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plan_geography.state_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_ftf_health_plan_geography.county_lives AS lives_coverage
 FROM sandbox.raw_ftf_health_plan_geography;

CREATE  VIEW sandbox.vw_curr_month_ftf_pbms_v1 AS
 SELECT replace(replace(btrim(raw_ftf_pbms.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_pbms.pbm_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_id,
        replace(replace(btrim(raw_ftf_pbms.pbm), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm,
        replace(replace(btrim(raw_ftf_pbms.pbm_function_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function_id,
        replace(replace(btrim(raw_ftf_pbms.pbm_function), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_function
 FROM sandbox.raw_ftf_pbms;

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_v1 AS
 SELECT replace(replace(btrim(raw_ftf_restrictions.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_restrictions.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS drug_id,
        replace(replace(btrim(raw_ftf_restrictions.restriction_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_code,
        raw_ftf_restrictions.restriction_detail_id,
        replace(replace(btrim(raw_ftf_restrictions.restriction_detail_text), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_detail_text,
        replace(replace(btrim(raw_ftf_restrictions.restriction_addtnl_information_1), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_1,
        replace(replace(btrim(raw_ftf_restrictions.restriction_addtnl_information_2), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restriction_addtnl_information_2,
        replace(replace(btrim(raw_ftf_restrictions.step_count), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS step_count,
        replace(replace(btrim(raw_ftf_restrictions.pa_form), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pa_form,
        replace(replace(btrim(raw_ftf_restrictions.indication), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS indication,
        replace(replace(btrim(raw_ftf_restrictions.grouped_restriction_level), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS grouped_restriction_level
 FROM sandbox.raw_ftf_restrictions;

CREATE  VIEW sandbox.vw_curr_month_ims_plan_xref_v1 AS
 SELECT replace(replace(btrim(raw_iqvia_plan.payer_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_num,
        replace(replace(btrim(raw_iqvia_plan.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        replace(replace(btrim(raw_iqvia_plan.plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_num,
        replace(replace(btrim(raw_iqvia_plan.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_plan.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_iqvia_plan.model), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS model,
        replace(replace(btrim(raw_iqvia_plan.city), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS city,
        replace(replace(btrim(raw_iqvia_plan.hq_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS hq_state,
        replace(replace(btrim(raw_iqvia_plan.operating_state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS operating_state,
        raw_iqvia_plan.months_with_data
 FROM sandbox.raw_iqvia_plan;

CREATE  VIEW sandbox.vw_curr_month_ims_pbm_xref_v1 AS
 SELECT replace(replace(btrim(raw_iqvia_pbm.pbm_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pbm_name,
        replace(replace(btrim(raw_iqvia_pbm.payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm.xref_to_payer_plan_num), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS xref_to_payer_plan_num,
        replace(replace(btrim(raw_iqvia_pbm.ipd_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_id,
        replace(replace(btrim(raw_iqvia_pbm.ipd_type), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS ipd_type,
        replace(replace(btrim(raw_iqvia_pbm.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        raw_iqvia_pbm.pbm_num,
        raw_iqvia_pbm.ims_processor_num
 FROM sandbox.raw_iqvia_pbm;

CREATE  VIEW sandbox.vw_curr_month_ftf_ims_bridge_v1 AS
 SELECT replace(replace(btrim(raw_teva_ims_bridge.payer_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS payer_name,
        replace(replace(btrim(raw_teva_ims_bridge.code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS code,
        replace(replace(btrim(raw_teva_ims_bridge.name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS name,
        replace(replace(btrim(raw_teva_ims_bridge.state), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS state,
        replace(replace(btrim(raw_teva_ims_bridge.comments), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS comments,
        raw_teva_ims_bridge.plan_id,
        replace(replace(btrim(raw_teva_ims_bridge.plan_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_name,
        replace(replace(btrim(raw_teva_ims_bridge.provider_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider_name,
        replace(replace(btrim(raw_teva_ims_bridge.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name
 FROM sandbox.raw_teva_ims_bridge;

CREATE  VIEW sandbox.vw_curr_ftf_plans_paytypeindex_v1 AS
 SELECT btrim(ftf_plans_paytypeindex_v1.ftf_health_plantype) AS ftf_health_plantype,
        ftf_plans_paytypeindex_v1.paytype_index,
        ftf_plans_paytypeindex_v1.file_id,
        ftf_plans_paytypeindex_v1.record_id
 FROM sandbox.ftf_plans_paytypeindex_v1
 WHERE (ftf_plans_paytypeindex_v1.file_id IN ( SELECT max(ftf_plans_paytypeindex_v1.file_id) AS max
 FROM sandbox.ftf_plans_paytypeindex_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_v1 AS
 SELECT replace(replace(btrim(raw_ftf_formularies.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan_id,
        replace(replace(btrim(raw_ftf_formularies.drug_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS drug_id,
        replace(replace(btrim(raw_ftf_formularies.tier_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(raw_ftf_formularies.restrictions), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(raw_ftf_formularies.reason_code), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(raw_ftf_formularies.reason_code_description), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(raw_ftf_formularies.pharmacy_status), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS pharmacy_status
 FROM sandbox.raw_ftf_formularies;

CREATE  VIEW sandbox.vw_curr_ftf_pbm_functions_v1 AS
 SELECT ftf_pbm_functions_v1.pbm_function_id,
        btrim(ftf_pbm_functions_v1.pbm_function) AS pbm_function,
        btrim(ftf_pbm_functions_v1.notes) AS notes,
        ftf_pbm_functions_v1.used,
        ftf_pbm_functions_v1.file_id,
        ftf_pbm_functions_v1.record_id
 FROM sandbox.ftf_pbm_functions_v1
 WHERE (ftf_pbm_functions_v1.file_id IN ( SELECT max(ftf_pbm_functions_v1.file_id) AS max
 FROM sandbox.ftf_pbm_functions_v1));

CREATE  VIEW sandbox.vw_override_bridge_ftf_plan_types_v1 AS
 SELECT btrim(override_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(override_bridge_ftf_plan_types_v1.override_ftf_health_plan_type) AS override_ftf_health_plan_type,
        override_bridge_ftf_plan_types_v1.override_precedence,
        override_bridge_ftf_plan_types_v1.file_id,
        override_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.override_bridge_ftf_plan_types_v1
 WHERE (override_bridge_ftf_plan_types_v1.file_id IN ( SELECT max(override_bridge_ftf_plan_types_v1.file_id) AS max
 FROM sandbox.override_bridge_ftf_plan_types_v1));

CREATE  VIEW sandbox.vw_delete_bridge_ftf_plan_types_v1 AS
 SELECT btrim(delete_bridge_ftf_plan_types_v1.ftf_health_plan_name_regex) AS ftf_health_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.iqvia_payer_name_regex) AS iqvia_payer_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.iqvia_plan_name_regex) AS iqvia_plan_name_regex,
        btrim(delete_bridge_ftf_plan_types_v1.delete_flag) AS delete_flag,
        delete_bridge_ftf_plan_types_v1.file_id,
        delete_bridge_ftf_plan_types_v1.record_id
 FROM sandbox.delete_bridge_ftf_plan_types_v1
 WHERE (delete_bridge_ftf_plan_types_v1.file_id IN ( SELECT max(delete_bridge_ftf_plan_types_v1.file_id) AS max
 FROM sandbox.delete_bridge_ftf_plan_types_v1));

CREATE  VIEW sandbox.vw_curr_month_ftf_health_plans_cdw AS
 SELECT (replace(replace(btrim(raw_ftf_health_plans_cdw.formularyf_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS formularyf_id,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.provider_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS provider_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.provider), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS provider,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS health_plan_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.health_plan), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS health_plan,
        (replace(replace(btrim(raw_ftf_health_plans_cdw.parent_id), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)))::float AS parent_id,
        replace(replace(btrim(raw_ftf_health_plans_cdw.parent), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS parent,
        raw_ftf_health_plans_cdw.national_lives_count,
        replace(replace(btrim(raw_ftf_health_plans_cdw.plan_type_name), '   '::varchar(3), ' '::varchar(1)), '  '::varchar(2), ' '::varchar(1)) AS plan_type_name,
        (raw_ftf_health_plans_cdw.preferred_brand_tier)::int AS preferred_brand_tier
 FROM sandbox.raw_ftf_health_plans_cdw
 WHERE (raw_ftf_health_plans_cdw.file_id IN ( SELECT max(raw_ftf_health_plans_cdw.file_id) AS max
 FROM sandbox.raw_ftf_health_plans_cdw));

CREATE  VIEW sandbox.vw_curr_ftf_plan_master_file_op_cdw_v1 AS
 SELECT ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid,
        ftf_plan_master_file_op_cdw_v1.product,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name,
        ftf_plan_master_file_op_cdw_v1.coverage_category,
        ftf_plan_master_file_op_cdw_v1.ftf_provider_name,
        ftf_plan_master_file_op_cdw_v1.paytype,
        ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type,
        ftf_plan_master_file_op_cdw_v1.plan_lives,
        ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary,
        ftf_plan_master_file_op_cdw_v1.key_controlling_account,
        ftf_plan_master_file_op_cdw_v1.key_controlling_parent,
        ftf_plan_master_file_op_cdw_v1.payer_pbm,
        ftf_plan_master_file_op_cdw_v1.key_pbm,
        ftf_plan_master_file_op_cdw_v1.iqvia_payer_name,
        ftf_plan_master_file_op_cdw_v1.iqvia_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm,
        ftf_plan_master_file_op_cdw_v1.pref_brand_tier,
        ftf_plan_master_file_op_cdw_v1.pharmacy_status,
        ftf_plan_master_file_op_cdw_v1.ftf_tier,
        ftf_plan_master_file_op_cdw_v1.restrictions,
        ftf_plan_master_file_op_cdw_v1.copay_tier,
        ftf_plan_master_file_op_cdw_v1.restriction_category,
        ftf_plan_master_file_op_cdw_v1.step,
        ftf_plan_master_file_op_cdw_v1.botox,
        ftf_plan_master_file_op_cdw_v1.prescriber_pa,
        ftf_plan_master_file_op_cdw_v1.patient_pa,
        ftf_plan_master_file_op_cdw_v1.medical_records,
        ftf_plan_master_file_op_cdw_v1.criteria_unspec,
        ftf_plan_master_file_op_cdw_v1.cycle_id,
        ftf_plan_master_file_op_cdw_v1.modified_time,
        ftf_plan_master_file_op_cdw_v1.modified_by
 FROM sandbox.ftf_plan_master_file_op_cdw_v1
 WHERE (ftf_plan_master_file_op_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_plan_master_file_op_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_key_ctl_account_summary_cdw_v1 AS
 SELECT key_ctl_account_summary_cdw_v1.paytype,
        key_ctl_account_summary_cdw_v1.ftf_health_plan_type,
        key_ctl_account_summary_cdw_v1.key_controlling_account,
        key_ctl_account_summary_cdw_v1.current_month_lives,
        key_ctl_account_summary_cdw_v1.previous_month_lives,
        key_ctl_account_summary_cdw_v1.cycle_id,
        key_ctl_account_summary_cdw_v1.modified_time,
        key_ctl_account_summary_cdw_v1.modified_by
 FROM sandbox.key_ctl_account_summary_cdw_v1
 WHERE (key_ctl_account_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_ctl_account_summary_cdw_v1'::varchar(30)))))));

CREATE  VIEW sandbox.vw_curr_key_pbm_summary_cdw_v1 AS
 SELECT key_pbm_summary_cdw_v1.paytype,
        key_pbm_summary_cdw_v1.ftf_health_plan_type,
        key_pbm_summary_cdw_v1.key_pbm,
        key_pbm_summary_cdw_v1.current_month_lives,
        key_pbm_summary_cdw_v1.previous_month_lives,
        key_pbm_summary_cdw_v1.cycle_id,
        key_pbm_summary_cdw_v1.modified_time,
        key_pbm_summary_cdw_v1.modified_by
 FROM sandbox.key_pbm_summary_cdw_v1
 WHERE (key_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_pbm_summary_cdw_v1'::varchar(22)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_payer_name_summary_cdw_v1 AS
 SELECT iqvia_payer_name_summary_cdw_v1.paytype,
        iqvia_payer_name_summary_cdw_v1.iqvia_payer_name,
        iqvia_payer_name_summary_cdw_v1.current_month_lives,
        iqvia_payer_name_summary_cdw_v1.previous_month_lives,
        iqvia_payer_name_summary_cdw_v1.cycle_id,
        iqvia_payer_name_summary_cdw_v1.modified_time,
        iqvia_payer_name_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_payer_name_summary_cdw_v1
 WHERE (iqvia_payer_name_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_payer_name_summary_cdw_v1'::varchar(31)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formulary_management_pbm_summary_cdw_v1 AS
 SELECT ftf_formulary_management_pbm_summary_cdw_v1.paytype,
        ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm,
        ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_management_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_management_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_management_pbm_summary_cdw_v1
 WHERE (ftf_formulary_management_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formulary_management_pbm_summary_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1 AS
 SELECT ftf_formulary_influencer_pbm_summary_cdw_v1.paytype,
        ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm,
        ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives,
        ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_time,
        ftf_formulary_influencer_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_formulary_influencer_pbm_summary_cdw_v1
 WHERE (ftf_formulary_influencer_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_formulary_influencer_pbm_summary_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_ftf_claims_processing_pbm_summary_cdw_v1 AS
 SELECT ftf_claims_processing_pbm_summary_cdw_v1.paytype,
        ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm,
        ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives,
        ftf_claims_processing_pbm_summary_cdw_v1.cycle_id,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_time,
        ftf_claims_processing_pbm_summary_cdw_v1.modified_by
 FROM sandbox.ftf_claims_processing_pbm_summary_cdw_v1
 WHERE (ftf_claims_processing_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_claims_processing_pbm_summary_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_st_lives_summary_cdw_v1 AS
 SELECT st_lives_summary_cdw_v1.ftf_health_plan_fid,
        st_lives_summary_cdw_v1.ftf_health_plan_name,
        st_lives_summary_cdw_v1.ftf_provider_name,
        st_lives_summary_cdw_v1.ftf_parent_name,
        st_lives_summary_cdw_v1.paytype,
        st_lives_summary_cdw_v1.ftf_health_plan_type,
        st_lives_summary_cdw_v1.key_controlling_account,
        st_lives_summary_cdw_v1.key_controlling_plan_formulary,
        st_lives_summary_cdw_v1.key_controlling_parent,
        st_lives_summary_cdw_v1.payer_pbm,
        st_lives_summary_cdw_v1.key_pbm,
        st_lives_summary_cdw_v1.iqvia_payer_name,
        st_lives_summary_cdw_v1.iqvia_pbm,
        st_lives_summary_cdw_v1.state,
        st_lives_summary_cdw_v1.ftf_state_hp_lives,
        st_lives_summary_cdw_v1.pref_brand_tier,
        st_lives_summary_cdw_v1.ajovy_formulary,
        st_lives_summary_cdw_v1.aimovig_formulary,
        st_lives_summary_cdw_v1.emgality_formulary,
        st_lives_summary_cdw_v1.cycle_id,
        st_lives_summary_cdw_v1.modified_time,
        st_lives_summary_cdw_v1.modified_by
 FROM sandbox.st_lives_summary_cdw_v1
 WHERE (st_lives_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'st_lives_summary_cdw_v1'::varchar(23)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hp_id_key_controlling_account_cdw_v1 AS
 SELECT ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_controlling_account_cdw_v1.payment_type,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary,
        ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent,
        ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.key_pbm,
        ftf_hp_id_key_controlling_account_cdw_v1.cycle_id,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_time,
        ftf_hp_id_key_controlling_account_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_controlling_account_cdw_v1
 WHERE (ftf_hp_id_key_controlling_account_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hp_id_key_controlling_account_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_ftf_hp_id_key_pbm_cdw_v1 AS
 SELECT ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid,
        ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name,
        ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name,
        ftf_hp_id_key_pbm_cdw_v1.payment_type,
        ftf_hp_id_key_pbm_cdw_v1.key_pbm,
        ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm,
        ftf_hp_id_key_pbm_cdw_v1.cycle_id,
        ftf_hp_id_key_pbm_cdw_v1.modified_time,
        ftf_hp_id_key_pbm_cdw_v1.modified_by
 FROM sandbox.ftf_hp_id_key_pbm_cdw_v1
 WHERE (ftf_hp_id_key_pbm_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'ftf_hp_id_key_pbm_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_coverage_category_cdw_v1 AS
 SELECT paytype_product_coverage_category_cdw_v1.paytype,
        paytype_product_coverage_category_cdw_v1.product,
        paytype_product_coverage_category_cdw_v1.metric,
        paytype_product_coverage_category_cdw_v1.lives,
        paytype_product_coverage_category_cdw_v1.cycle_id,
        paytype_product_coverage_category_cdw_v1.modified_time,
        paytype_product_coverage_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_coverage_category_cdw_v1
 WHERE (paytype_product_coverage_category_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_coverage_category_cdw_v1'::varchar(40)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_copay_tier_cdw_v1 AS
 SELECT paytype_product_copay_tier_cdw_v1.paytype,
        paytype_product_copay_tier_cdw_v1.product,
        paytype_product_copay_tier_cdw_v1.metric,
        paytype_product_copay_tier_cdw_v1.lives,
        paytype_product_copay_tier_cdw_v1.cycle_id,
        paytype_product_copay_tier_cdw_v1.modified_time,
        paytype_product_copay_tier_cdw_v1.modified_by
 FROM sandbox.paytype_product_copay_tier_cdw_v1
 WHERE (paytype_product_copay_tier_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_copay_tier_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_step_category_cdw_v1 AS
 SELECT paytype_product_step_category_cdw_v1.paytype,
        paytype_product_step_category_cdw_v1.product,
        paytype_product_step_category_cdw_v1.metric,
        paytype_product_step_category_cdw_v1.lives,
        paytype_product_step_category_cdw_v1.cycle_id,
        paytype_product_step_category_cdw_v1.modified_time,
        paytype_product_step_category_cdw_v1.modified_by
 FROM sandbox.paytype_product_step_category_cdw_v1
 WHERE (paytype_product_step_category_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_step_category_cdw_v1'::varchar(36)))))));

CREATE  VIEW sandbox.vw_curr_paytype_product_patient_pa_cdw_v1 AS
 SELECT paytype_product_patient_pa_cdw_v1.paytype,
        paytype_product_patient_pa_cdw_v1.product,
        paytype_product_patient_pa_cdw_v1.metric,
        paytype_product_patient_pa_cdw_v1.lives,
        paytype_product_patient_pa_cdw_v1.cycle_id,
        paytype_product_patient_pa_cdw_v1.modified_time,
        paytype_product_patient_pa_cdw_v1.modified_by
 FROM sandbox.paytype_product_patient_pa_cdw_v1
 WHERE (paytype_product_patient_pa_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'paytype_product_patient_pa_cdw_v1'::varchar(33)))))));

CREATE  VIEW sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1 AS
 SELECT key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account,
        key_controlling_account_product_cov_category_paytype_cdw_v1.paytype,
        key_controlling_account_product_cov_category_paytype_cdw_v1.product,
        key_controlling_account_product_cov_category_paytype_cdw_v1.metric,
        key_controlling_account_product_cov_category_paytype_cdw_v1.lives,
        key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_time,
        key_controlling_account_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_controlling_account_product_cov_category_paytype_cdw_v1
 WHERE (key_controlling_account_product_cov_category_paytype_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_controlling_account_product_cov_category_paytype_cdw_v1'::varchar(59)))))));

CREATE  VIEW sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1 AS
 SELECT key_pbm_product_cov_category_paytype_cdw_v1.key_pbm,
        key_pbm_product_cov_category_paytype_cdw_v1.paytype,
        key_pbm_product_cov_category_paytype_cdw_v1.product,
        key_pbm_product_cov_category_paytype_cdw_v1.metric,
        key_pbm_product_cov_category_paytype_cdw_v1.lives,
        key_pbm_product_cov_category_paytype_cdw_v1.cycle_id,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_time,
        key_pbm_product_cov_category_paytype_cdw_v1.modified_by
 FROM sandbox.key_pbm_product_cov_category_paytype_cdw_v1
 WHERE (key_pbm_product_cov_category_paytype_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'key_pbm_product_cov_category_paytype_cdw_v1'::varchar(43)))))));

CREATE  VIEW sandbox.vw_curr_iqvia_pbm_summary_cdw_v1 AS
 SELECT iqvia_pbm_summary_cdw_v1.paytype,
        iqvia_pbm_summary_cdw_v1.iqvia_pbm,
        iqvia_pbm_summary_cdw_v1.current_month_lives,
        iqvia_pbm_summary_cdw_v1.previous_month_lives,
        iqvia_pbm_summary_cdw_v1.cycle_id,
        iqvia_pbm_summary_cdw_v1.modified_time,
        iqvia_pbm_summary_cdw_v1.modified_by
 FROM sandbox.iqvia_pbm_summary_cdw_v1
 WHERE (iqvia_pbm_summary_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'iqvia_pbm_summary_cdw_v1'::varchar(24)))))));

CREATE  VIEW sandbox.vw_ftf_delta_report AS
 SELECT a.ftf_health_plan_fid AS "FTF Health Plan FID",
        a.ftf_health_plan_name AS "FTF Health Plan Name",
        a.ftf_provider_fid AS "FTF Provider FID",
        a.ftf_provider_name AS "FTF Provider Name",
        a.ftf_parent_name AS "FTF Parent Name",
        a.paytype AS "Pay Type",
        a.ftf_health_plan_type AS "FTF Health Plan Type",
        a.key_controlling_account AS "Key Controlling Account",
        a.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        a.key_controlling_parent AS "Key Controlling Parent",
        a.payer_pbm AS "Payer/PBM",
        a.key_pbm AS "Key PBM",
        a.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        a.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        a.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        a.lives_mn AS Lives,
        a.iqvia_payer_name AS "IQVIA Payer Name best matched to FTF Plan",
        a.iqvia_pbm AS "IQVIA PBM best matched to FTF Plan",
        a.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        a.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        a.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        a.pref_brand_tier AS "Pref Brand Tier",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan FID Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider FID Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Provider Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Parent Name Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pay Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payer/PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Management PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Formulary Influencer PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Claims Processing PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Lives Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name best matched to FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM best matched to FTF Plan Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Ajovy Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Aimovig Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Coverage Category for Emgality Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Pref Brand Tier Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        a.month_flag AS "Month Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        a.change_in_lives AS "Change in Lives",
        tbl_lvl_audit.date_run,
        (to_timestamptz((a.cycle_id)::float))::timestamp AS modified_time
 FROM (sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1 a LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_ftf_health_plan_fid_cdw_v1'::varchar(37))))
 GROUP BY a.ftf_health_plan_fid,
          a.ftf_health_plan_name,
          a.ftf_provider_fid,
          a.ftf_provider_name,
          a.ftf_parent_name,
          a.paytype,
          a.ftf_health_plan_type,
          a.key_controlling_account,
          a.key_controlling_plan_formulary,
          a.key_controlling_parent,
          a.payer_pbm,
          a.key_pbm,
          a.ftf_formulary_management_pbm,
          a.ftf_formulary_influencer_pbm,
          a.ftf_claims_processing_pbm,
          a.lives_mn,
          a.iqvia_payer_name,
          a.iqvia_pbm,
          a.Coverage_Category_Ajovy,
          a.Coverage_Category_Aimovig,
          a.Coverage_Category_Emgality,
          a.pref_brand_tier,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_provider_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_parent_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_paytype = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_management_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_formulary_influencer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_claims_processing_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_lives_mn = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Ajovy = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Aimovig = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_Coverage_Category_Emgality = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_pref_brand_tier = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END,
          a.month_flag,
          CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END,
          a.change_in_lives,
          tbl_lvl_audit.date_run,
          (to_timestamptz((a.cycle_id)::float))::timestamp
 ORDER BY a.ftf_health_plan_fid;

CREATE  VIEW sandbox.vw_curr_payer_spine25_plan_teva_brands_cdw_v1 AS
 SELECT payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name,
        payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account,
        payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent,
        payer_spine25_plan_teva_brands_cdw_v1.payer_pbm,
        payer_spine25_plan_teva_brands_cdw_v1.payment_type,
        payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl,
        payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor,
        payer_spine25_plan_teva_brands_cdw_v1.saba_trx
 FROM sandbox.payer_spine25_plan_teva_brands_cdw_v1
 WHERE (payer_spine25_plan_teva_brands_cdw_v1.cycle_id IN ( SELECT max(b.cycle_id) AS max
 FROM (sandbox.tbl_lvl_audit a JOIN sandbox.process_audit_tbl b ON (((a.process_id = b.process_id) AND (a.cycle_id = b.cycle_id))))
 WHERE ((b.status = ANY (ARRAY['COMPLETED'::varchar(9), 'INITIATED'::varchar(9)])) AND (a.tbl_id IN ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'payer_spine25_plan_teva_brands_cdw_v1'::varchar(37)))))));

CREATE  VIEW sandbox.access_granularity_ftf AS
 SELECT vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy AS "Coverage Category for Ajovy",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig AS "Coverage Category for Aimovig",
        vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality AS "Coverage Category for Emgality",
        count(DISTINCT vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_fid) AS "FTF Health Plan FID",
        vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_pivot_plan_prod_master_cdw_v1.paytype AS "Pay Type",
        sum(vw_curr_pivot_plan_prod_master_cdw_v1.lives_mn) AS Lives
 FROM sandbox.vw_curr_pivot_plan_prod_master_cdw_v1
 GROUP BY vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_plan_formulary,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Ajovy,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Aimovig,
          vw_curr_pivot_plan_prod_master_cdw_v1.Coverage_Category_Emgality,
          vw_curr_pivot_plan_prod_master_cdw_v1.paytype,
          vw_curr_pivot_plan_prod_master_cdw_v1.ftf_health_plan_type,
          vw_curr_pivot_plan_prod_master_cdw_v1.key_controlling_account;

CREATE  VIEW sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.restriction_code,
        a.restriction_detail_id,
        a.restriction_detail_text,
        a.restriction_addtnl_information_1,
        a.restriction_addtnl_information_2,
        a.step_count,
        a.pa_form,
        a.indication,
        a.grouped_restriction_level
 FROM (sandbox.vw_curr_month_ftf_restrictions_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.restriction_code,
        a.restriction_detail_id,
        a.restriction_detail_text,
        a.restriction_addtnl_information_1,
        a.restriction_addtnl_information_2,
        a.step_count,
        a.pa_form,
        a.indication,
        a.grouped_restriction_level
 FROM (sandbox.vw_prev_month_ftf_restrictions_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.tier_code,
        a.restrictions,
        a.reason_code,
        a.reason_code_description,
        a.pharmacy_status
 FROM (sandbox.vw_curr_month_ftf_formularies_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs AS
 SELECT a.health_plan_id,
        a.drug_id,
        a.tier_code,
        a.restrictions,
        a.reason_code,
        a.reason_code_description,
        a.pharmacy_status
 FROM (sandbox.vw_prev_month_ftf_formularies_cdw a JOIN sandbox.vw_curr_drug_assignments_cdw drug_assignments ON ((a.drug_id = drug_assignments.drug_id)));

CREATE  VIEW sandbox.vw_curr_month_ftf_formularies_cdw_v2 AS
 SELECT (replace(replace(btrim(ftf_formularies.health_plan_id), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)))::float AS health_plan_id,
        (replace(replace(btrim(ftf_formularies.drug_id), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)))::float AS drug_id,
        replace(replace(btrim(ftf_formularies.tier_code), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS tier_code,
        replace(replace(btrim(ftf_formularies.restrictions), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS restrictions,
        replace(replace(btrim(ftf_formularies.reason_code), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS reason_code,
        replace(replace(btrim(ftf_formularies.reason_code_description), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS reason_code_description,
        replace(replace(btrim(ftf_formularies.pharmacy_status), ' '::varchar(1), ' '::varchar(1)), ' '::varchar(1), ' '::varchar(1)) AS pharmacy_status,
        ftf_formularies.Market_Access_Coverage
 FROM cleansed.ftf_formularies
 WHERE (ftf_formularies.file_id IN ( SELECT max(ftf_formularies.file_id) AS max
 FROM cleansed.ftf_formularies));

CREATE  VIEW sandbox.vw_comparison_iqvia_fid_delta_report AS
 SELECT a.iqvia_plan_code AS "IQVIA Plan Code",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_code = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Code Flag",
        a.iqvia_plan_name AS "IQVIA Plan Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Plan Name Flag",
        a.iqvia_payer_name AS "IQVIA Payer Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_payer_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Payer Name Flag",
        a.iqvia_pbm AS "IQVIA PBM",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA PBM Flag",
        a.payment_type AS "Payment Type",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payment_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Payment Type Flag",
        a.iqvia_model AS "IQVIA Model ",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_iqvia_model = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "IQVIA Model  Flag",
        a.ftf_health_plan_fid AS "FTF Plan ID",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_fid = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Plan ID Flag",
        a.ftf_health_plan_name AS "FTF Plan Name",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_name = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Plan Name Flag",
        a.ftf_health_plan_type AS "FTF Health Plan Type",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ftf_health_plan_type = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "FTF Health Plan Type Flag",
        a.key_controlling_plan_formulary AS "Key Controlling Plan/Formulary",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_plan_formulary = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Plan/Formulary Flag",
        a.key_controlling_account AS "Key Controlling Account",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_account = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Account Flag",
        a.key_controlling_parent AS "Key Controlling Parent",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_controlling_parent = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key Controlling Parent Flag",
        a.payer_pbm AS "PBM/Payer",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_payer_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "PBM/Payer Flag",
        a.ajovy_access_for_ftf_plan AS "Ajovy Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_ajovy_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Ajovy Access for FTF Plan Flag",
        a.aimovig_access_for_ftf_plan AS "Aimovig Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_aimovig_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Aimovig Access for FTF Plan Flag",
        a.emgality_access_for_ftf_plan AS "Emgality Access for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_emgality_access_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Emgality Access for FTF Plan Flag",
        a.total_lives_for_ftf_plan AS "Total Lives for FTF Plan",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_total_lives_for_ftf_plan = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Total Lives for FTF Plan Flag",
        a.key_pbm AS "Key PBM",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change_key_pbm = 0) THEN 'TRUE'::varchar(4) ELSE 'FALSE'::varchar(5) END AS "Key PBM Flag",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN 'Added'::varchar(5) WHEN (a.status = 'Delete'::varchar(6)) THEN 'Deleted'::varchar(7) ELSE a.status END AS Status,
        a.change_in_lives AS "Change in Lives",
        CASE WHEN (a.status = 'New'::varchar(3)) THEN a.status WHEN (a.status = 'Delete'::varchar(6)) THEN a.status WHEN (a.change > 0) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Final Flag",
        round((a.total_lives_for_ftf_plan / b.ck), 0) AS "Apportioned Lives for FTF/IQVIA Plan",
        a.month_flag,
        tbl_lvl_audit.date_run,
        (to_timestamptz((a.cycle_id)::float))::timestamp AS modified_time
 FROM ((sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1 a LEFT  JOIN ( SELECT vw_curr_comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid,
        count(*) AS ck
 FROM sandbox.vw_curr_comparison_iqvia_fid_plans_cdw_v1
 GROUP BY vw_curr_comparison_iqvia_fid_plans_cdw_v1.ftf_health_plan_fid) b ON ((a.ftf_health_plan_fid = b.ftf_health_plan_fid))) LEFT  JOIN sandbox.tbl_lvl_audit tbl_lvl_audit ON ((tbl_lvl_audit.cycle_id = a.cycle_id)))
 WHERE (tbl_lvl_audit.tbl_id = ( SELECT tbl_info.tbl_id
 FROM sandbox.tbl_info
 WHERE (tbl_info.tbl_name = 'comparison_iqvia_fid_plans_cdw_v1'::varchar(33))))
 ORDER BY a.iqvia_plan_code,
          a.ftf_health_plan_fid,
          a.month_flag;

CREATE  VIEW sandbox.vw_teva_iqvia_bridge_mismatch_analysis AS
 SELECT bridge_dt.iqvia_payer_name AS "IQVIA Payer Name",
        bridge_dt.iqvia_plan_code AS IQVIA_Plan_Code,
        bridge_dt.iqvia_plan_name AS IQVIA_Plan_Name,
        bridge_dt.ftf_health_plan_fid AS "FTF Health Plan FID",
        bridge_dt.ftf_health_plan_name AS "FTF Health Plan Name",
        ftf_health_plans_preprocessed.ftf_provider_fid AS "FTF Provider FID",
        bridge_dt.ftf_provider_name AS "FTF Provider Name",
        bridge_dt.ftf_health_plan_type AS "FTF Health Plan Type",
        bridge_dt.paytype_index AS PayTypeIndex,
        bridge_dt.paytype AS "Pay Type",
        bridge_dt.hp_type AS "HP Type",
        bridge_dt.iqvia_paytype AS "IQVIA Pay Type",
        bridge_dt.model AS Model,
        bridge_dt.check_pay_types AS "Check Pay Types",
        bridge_dt.check_hp_types AS "Check HP Types",
        bridge_dt.iqvia_pbm AS "IQVIA PBM",
        bridge_dt.old_ftf_health_plan_type AS "Old_FTF Health Plan Type",
        (to_timestamptz((bridge_dt.cycle_id)::float))::timestamp AS modified_time,
        process_audit_tbl.date_run
 FROM ((sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 bridge_dt LEFT  JOIN sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 ftf_health_plans_preprocessed ON ((bridge_dt.ftf_health_plan_fid = ftf_health_plans_preprocessed.ftf_health_plan_fid))) LEFT  JOIN sandbox.process_audit_tbl process_audit_tbl ON (((bridge_dt.cycle_id = process_audit_tbl.cycle_id) AND (process_audit_tbl.process_id = 1) AND (process_audit_tbl.status = 'COMPLETED'::varchar(9)))))
 WHERE (coalesce(bridge_dt.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW sandbox.vw_ftf_formularies_pharmacy_status_check AS
 SELECT vw_curr_ftf_formularies_preprocessed_cdw_v1.drug_seq AS "Drug Seq",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.ftf_health_plan_fid AS "FTF Health Plan FID",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.drug_id AS "Drug Id",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.tier_code AS "Tier Code",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.restrictions AS Restrictions,
        vw_curr_ftf_formularies_preprocessed_cdw_v1.reason_code AS "Reason Code",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.reason_code_description AS "Reason Code Description",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.pharmacy_status AS "Pharmacy Status",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.plan_lives AS "Plan Lives",
        vw_curr_ftf_formularies_preprocessed_cdw_v1.check_blank_pharmstat AS "Check Pharmacy Status"
 FROM sandbox.vw_curr_ftf_formularies_preprocessed_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_controlling_account_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_controlling_account_product_coverage_category_commercial AS
 SELECT vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_controlling_account_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW sandbox.vw_final_extract_key_pbm_product_coverage_category_allpaytypes AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_key_pbm_product_coverage_category_commercial AS
 SELECT vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.product AS Product,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.metric AS Metric,
        vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_key_pbm_product_cov_category_paytype_cdw_v1
 WHERE (upper(vw_curr_key_pbm_product_cov_category_paytype_cdw_v1.paytype) = 'COMMERCIAL'::varchar(10));

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_copay_tier AS
 SELECT vw_curr_paytype_product_copay_tier_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_copay_tier_cdw_v1.product AS Product,
        vw_curr_paytype_product_copay_tier_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_copay_tier_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_copay_tier_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_coverage_category AS
 SELECT vw_curr_paytype_product_coverage_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_coverage_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_coverage_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_coverage_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_coverage_category_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_patient_pa AS
 SELECT vw_curr_paytype_product_patient_pa_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_patient_pa_cdw_v1.product AS Product,
        vw_curr_paytype_product_patient_pa_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_patient_pa_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_patient_pa_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_pay_type_product_step_edit_type AS
 SELECT vw_curr_paytype_product_step_category_cdw_v1.paytype AS "Payment Type",
        vw_curr_paytype_product_step_category_cdw_v1.product AS Product,
        vw_curr_paytype_product_step_category_cdw_v1.metric AS Metric,
        vw_curr_paytype_product_step_category_cdw_v1.lives AS Lives
 FROM sandbox.vw_curr_paytype_product_step_category_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ftf_hp_id_key_controlling_plan_account AS
 SELECT lpad((vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_hp_id_key_controlling_account_cdw_v1.payer_pbm AS "Payer/PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_controlling_account_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ftf_hp_id_key_pbm AS
 SELECT lpad((vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.payment_type AS "Payment Type",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_hp_id_key_pbm_cdw_v1.assigned_iqvia_pbm AS "Assigned IQVIA PBM"
 FROM sandbox.vw_curr_ftf_hp_id_key_pbm_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ftf_plan_master_file AS
 SELECT lpad((vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_ftf_plan_master_file_op_cdw_v1.product AS Product,
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.coverage_category AS "Coverage Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_ftf_plan_master_file_op_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_ftf_plan_master_file_op_cdw_v1.plan_lives AS "Plan Lives",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_ftf_plan_master_file_op_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.pharmacy_status AS "Pharmacy Status",
        vw_curr_ftf_plan_master_file_op_cdw_v1.ftf_tier AS "FTF Tier",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restrictions AS Restrictions,
        vw_curr_ftf_plan_master_file_op_cdw_v1.copay_tier AS "Tier Cat",
        vw_curr_ftf_plan_master_file_op_cdw_v1.restriction_category AS "Restriction Category",
        vw_curr_ftf_plan_master_file_op_cdw_v1.step AS Step,
        vw_curr_ftf_plan_master_file_op_cdw_v1.botox AS Botox,
        vw_curr_ftf_plan_master_file_op_cdw_v1.prescriber_pa AS "Prescriber PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.patient_pa AS "Patient PA",
        vw_curr_ftf_plan_master_file_op_cdw_v1.medical_records AS "Medical Records",
        vw_curr_ftf_plan_master_file_op_cdw_v1.criteria_unspec AS "Criteria Unspec"
 FROM sandbox.vw_curr_ftf_plan_master_file_op_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_key_controlling_account_summary AS
 SELECT vw_curr_key_ctl_account_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_ctl_account_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_ctl_account_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_key_ctl_account_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_ctl_account_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_ctl_account_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_key_pbm_summary AS
 SELECT vw_curr_key_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_key_pbm_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_key_pbm_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_key_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_key_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_key_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_iqvia_player_summary AS
 SELECT vw_curr_iqvia_payer_name_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_payer_name_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_iqvia_payer_name_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_payer_name_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_payer_name_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_iqvia_pbm_summary AS
 SELECT vw_curr_iqvia_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_iqvia_pbm_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_iqvia_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_iqvia_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_iqvia_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_mgt_summary AS
 SELECT vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_management_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_management_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_formulary_infl_summary AS
 SELECT vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_formulary_influencer_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_ftf_pbm_claims_proc_summary AS
 SELECT vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.current_month_lives AS "Current Month Lives",
        vw_curr_ftf_claims_processing_pbm_summary_cdw_v1.previous_month_lives AS "Previous Month Lives",
        ''::varchar AS "Current VS Prior",
        ''::varchar AS "% Change"
 FROM sandbox.vw_curr_ftf_claims_processing_pbm_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_cm_state_lives_formular_status AS
 SELECT lpad((vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_st_lives_summary_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_st_lives_summary_cdw_v1.paytype AS "Payment Type",
        vw_curr_st_lives_summary_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_st_lives_summary_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_st_lives_summary_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_st_lives_summary_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_st_lives_summary_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_st_lives_summary_cdw_v1.state AS State,
        vw_curr_st_lives_summary_cdw_v1.ftf_state_hp_lives AS "FTF State HP Lives",
        vw_curr_st_lives_summary_cdw_v1.pref_brand_tier AS "Pref Band Tier",
        vw_curr_st_lives_summary_cdw_v1.ajovy_formulary AS "Ajovy Formulary",
        vw_curr_st_lives_summary_cdw_v1.aimovig_formulary AS "Aimovig Formulary",
        vw_curr_st_lives_summary_cdw_v1.emgality_formulary AS "Emgality Formulary"
 FROM sandbox.vw_curr_st_lives_summary_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_payer_spine25_detailed_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_detailed_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_detailed_teva_brands_cdw_v1;

CREATE  VIEW sandbox.vw_final_extract_payer_spine25_plan_teva_brands AS
 SELECT lpad((vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_code)::varchar, 10, '0'::varchar(1)) AS "IQVIA Plan Code",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_plan_name AS "IQVIA Plan Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.iqvia_pbm AS "IQVIA PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.payment_type AS "Payment Type",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.ajovy_access_for_ftf_plan AS "Coverage Category Ajovy",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.aimovig_access_for_ftf_plan AS "Coverage Category Aimovig",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.emgality_access_for_ftf_plan AS "Coverage Category Emgality",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_kcf_lvl AS "Lives KCF Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.lives_plan_lvl AS "Lives Plan Level",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.apportionment_factor AS "Apportionment Factor",
        vw_curr_payer_spine25_plan_teva_brands_cdw_v1.saba_trx AS "SABA TRx"
 FROM sandbox.vw_curr_payer_spine25_plan_teva_brands_cdw_v1;

CREATE  VIEW sandbox.vw_ftf_plan_change AS
 SELECT a.entity AS "Change Type",
        a.id AS ID,
        a.name AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM ((((((( SELECT 'Plan'::varchar(4) AS entity,
        curr_month_ftf_health_plans.formularyf_id AS id,
        curr_month_ftf_health_plans.health_plan AS name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ANTI  JOIN sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ON ((curr_month_ftf_health_plans.formularyf_id = prev_month_ftf_health_plans.formularyf_id))) UNION  SELECT 'Plan'::varchar(4) AS entity,
        prev_month_ftf_health_plans.formularyf_id AS ftf_health_plan_fid,
        prev_month_ftf_health_plans.health_plan AS ftf_health_plan_name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ANTI  JOIN sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ON ((curr_month_ftf_health_plans.formularyf_id = prev_month_ftf_health_plans.formularyf_id)))) UNION  SELECT 'Provider'::varchar(8) AS entity,
        curr_month_ftf_health_plans.provider_id AS ftf_provider_fid,
        curr_month_ftf_health_plans.provider AS ftf_provider_name,
        'Added'::varchar(5) AS status
 FROM (sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ANTI  JOIN sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ON ((curr_month_ftf_health_plans.provider_id = prev_month_ftf_health_plans.provider_id)))) UNION  SELECT 'Provider'::varchar(8) AS entity,
        prev_month_ftf_health_plans.provider_id AS ftf_provider_fid,
        prev_month_ftf_health_plans.provider AS ftf_provider_name,
        'Deleted'::varchar(7) AS status
 FROM (sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans ANTI  JOIN sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans ON ((curr_month_ftf_health_plans.provider_id = prev_month_ftf_health_plans.provider_id)))) UNION  SELECT 'Pharmacy Status'::varchar(15) AS entity,
        NULL AS id,
        b.pharmacy_status,
        'Added'::varchar(5) AS status
 FROM ( SELECT curr_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs curr_month_ftf_formularies
 GROUP BY curr_month_ftf_formularies.pharmacy_status EXCEPT  SELECT prev_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs prev_month_ftf_formularies
 GROUP BY prev_month_ftf_formularies.pharmacy_status) b) UNION  SELECT 'Pharmacy Status'::varchar(15) AS entity,
        NULL AS id,
        b.pharmacy_status,
        'Added'::varchar(5) AS status
 FROM ( SELECT prev_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_prev_month_ftf_formularies_cdw_required_drugs prev_month_ftf_formularies
 GROUP BY prev_month_ftf_formularies.pharmacy_status EXCEPT  SELECT curr_month_ftf_formularies.pharmacy_status
 FROM sandbox.vw_curr_month_ftf_formularies_cdw_required_drugs curr_month_ftf_formularies
 GROUP BY curr_month_ftf_formularies.pharmacy_status) b) UNION  SELECT 'Health Plan Type'::varchar(16) AS entity,
        NULL AS id,
        b.plan_type_name,
        'Added'::varchar(5) AS status
 FROM ( SELECT curr_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans
 GROUP BY curr_month_ftf_health_plans.plan_type_name EXCEPT  SELECT prev_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans
 GROUP BY prev_month_ftf_health_plans.plan_type_name) b) UNION  SELECT 'Health Plan Type'::varchar(16) AS entity,
        NULL AS id,
        b.plan_type_name,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT prev_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_prev_month_ftf_health_plans_cdw prev_month_ftf_health_plans
 GROUP BY prev_month_ftf_health_plans.plan_type_name EXCEPT  SELECT curr_month_ftf_health_plans.plan_type_name
 FROM sandbox.vw_curr_month_ftf_health_plans_cdw curr_month_ftf_health_plans
 GROUP BY curr_month_ftf_health_plans.plan_type_name) b) a
 ORDER BY a.entity,
          a.status,
          a.id,
          a.name;

CREATE  VIEW sandbox.vw_bridge_mismatch_detailed_report AS
 SELECT bridge_dt.iqvia_payer_name AS "IQVIA Payer Name",
        bridge_dt.iqvia_plan_code AS "IQVIA Plan Code",
        bridge_dt.iqvia_plan_name AS "IQVIA Plan Name",
        bridge_dt.comments AS Comments,
        bridge_dt.ftf_health_plan_fid AS "FTF Health Plan FID",
        bridge_dt.ftf_health_plan_name AS "FTF Health Plan Name",
        ftf_health_plans_preprocessed.ftf_provider_fid AS "FTF Provider FID",
        bridge_dt.ftf_provider_name AS "FTF Provider Name",
        bridge_dt.ftf_health_plan_type AS "FTF Health Plan Type",
        bridge_dt.hp_type AS "HP Type",
        bridge_dt.overriden_ftf_plan_type AS "Overriden FTF Plan Type",
        bridge_dt.model AS Model,
        bridge_dt.iqvia_pbm AS "IQVIA PBM",
        bridge_dt.iqvia_paytype AS "IQVIA Paytype",
        bridge_dt.check_delete AS "Delete Flag",
        bridge_dt.paytype_index AS "Paytype Index",
        bridge_dt.paytype AS Paytype,
        bridge_dt.check_pay_types AS "Check Paytypes",
        bridge_dt.check_hp_types AS "Check HP Types",
        bridge_dt.old_ftf_health_plan_type AS "Old FTF health Plan Type"
 FROM ((sandbox.vw_curr_ftf_iqvia_bridge_preprocessed_cdw_v1 bridge_dt LEFT  JOIN sandbox.vw_curr_ftf_health_plans_preprocessed_cdw_v1 ftf_health_plans_preprocessed ON ((bridge_dt.ftf_health_plan_fid = ftf_health_plans_preprocessed.ftf_health_plan_fid))) LEFT  JOIN sandbox.process_audit_tbl process_audit_tbl ON (((bridge_dt.cycle_id = process_audit_tbl.cycle_id) AND (process_audit_tbl.process_id = 1) AND (process_audit_tbl.status = 'COMPLETED'::varchar(9)))))
 WHERE (coalesce(bridge_dt.check_delete, ''::varchar) <> 'DELETE'::varchar(6));

CREATE  VIEW sandbox.vw_final_extract_ajovy_migraine_market_all_changes AS
 SELECT lpad((vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_fid)::varchar, 6, '0'::varchar(1)) AS "FTF Health Plan FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_name AS "FTF Health Plan Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Ajovy AS "Coverage Category Ajovy",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Aimovig AS "Coverage Category Aimovig",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Emgality AS "Coverage Category Emgality",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Nurtec AS "Coverage Category Nurtec",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.Coverage_Category_Qulipta AS "Coverage Category Qulipta",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_fid AS "FTF Provider FID",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_provider_name AS "FTF Provider Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_parent_name AS "FTF Parent Name",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.paytype AS "Payment Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_health_plan_type AS "FTF Health Plan Type",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_plan_formulary AS "Key Controlling Plan Formulary",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_account AS "Key Controlling Account",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_controlling_parent AS "Key Controlling Parent",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.payer_pbm AS "Payer/PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.key_pbm AS "Key PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_payer_name AS "IQVIA Payer Name Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.iqvia_pbm AS "IQVIA PBM Best Matched to FTF Plan",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_management_pbm AS "FTF Formulary Management PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_formulary_influencer_pbm AS "FTF Formulary Influencer PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.ftf_claims_processing_pbm AS "FTF Claims Processing PBM",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.lives_mn AS Lives,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.month_flag AS "Month Flag",
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.status AS Status,
        vw_curr_comparison_ftf_health_plan_fid_cdw_v1.change_in_lives AS "Change in Lives"
 FROM sandbox.vw_curr_comparison_ftf_health_plan_fid_cdw_v1;

CREATE  VIEW sandbox.vw_ftf_restriction_change AS
 SELECT a.entity AS "Change Type",
        a.category_value AS Name,
        a.status AS Status,
        CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END AS "Status Flag"
 FROM (((( SELECT 'Group Restriction'::varchar(17) AS entity,
        b.category_value,
        'No Change'::varchar(9) AS status
 FROM (( SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level) a JOIN ( SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level) b ON ((a.category_value = b.category_value))) UNION  SELECT 'Group Restriction'::varchar(17) AS entity,
        vw_curr_month_ftf_restrictions.category_value,
        'Added'::varchar(5) AS status
 FROM ( SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level EXCEPT  SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level) vw_curr_month_ftf_restrictions) UNION  SELECT 'Group Restriction'::varchar(17) AS entity,
        vw_prev_month_ftf_restrictions_cdw.category_value,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.grouped_restriction_level EXCEPT  SELECT vw_curr_month_ftf_restrictions.grouped_restriction_level AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.grouped_restriction_level) vw_prev_month_ftf_restrictions_cdw) UNION  SELECT 'Restriction Detail'::varchar(18) AS entity,
        vw_curr_month_ftf_restrictions.category_value,
        'Added'::varchar(5) AS status
 FROM ( SELECT vw_curr_month_ftf_restrictions.restriction_detail_text AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.restriction_detail_text EXCEPT  SELECT vw_prev_month_ftf_restrictions_cdw.restriction_detail_text AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.restriction_detail_text) vw_curr_month_ftf_restrictions) UNION  SELECT 'Restriction Detail'::varchar(18) AS entity,
        vw_prev_month_ftf_restrictions_cdw.category_value,
        'Deleted'::varchar(7) AS status
 FROM ( SELECT vw_prev_month_ftf_restrictions_cdw.restriction_detail_text AS category_value
 FROM sandbox.vw_prev_month_ftf_restrictions_cdw_required_drugs vw_prev_month_ftf_restrictions_cdw
 GROUP BY vw_prev_month_ftf_restrictions_cdw.restriction_detail_text EXCEPT  SELECT vw_curr_month_ftf_restrictions.restriction_detail_text AS category_value
 FROM sandbox.vw_curr_month_ftf_restrictions_cdw_required_drugs vw_curr_month_ftf_restrictions
 GROUP BY vw_curr_month_ftf_restrictions.restriction_detail_text) vw_prev_month_ftf_restrictions_cdw) a
 WHERE (coalesce(a.category_value, ''::varchar) <> ''::varchar)
 GROUP BY a.entity,
          a.category_value,
          a.status,
          CASE WHEN (a.status = 'Changed to'::varchar(10)) THEN 'FALSE'::varchar(5) WHEN (a.status = 'Changed from'::varchar(12)) THEN 'FALSE'::varchar(5) ELSE a.status END
 ORDER BY a.entity,
          a.status,
          a.category_value;

CREATE  VIEW sandbox.asi_market_access_w_test AS
SELECT A.zip, A.state, A.payer_plan_num, A.report_num, A.ims_product_group_num, A.data_month, A.nrx_001, A.nrx_002, A.nrx_003, A.nrx_004, A.nrx_005, A.nrx_006, A.nrx_007, A.nrx_008, A.nrx_009, A.nrx_010, A.nrx_011, A.nrx_012, A.nrx_013, A.nrx_014, A.nrx_015, A.nrx_016, A.nrx_017, A.nrx_018, A.nrx_019, A.nrx_020, A.nrx_021, A.nrx_022, A.nrx_023, A.nrx_024, A.trx_001, A.trx_002, A.trx_003, A.trx_004, A.trx_005, A.trx_006, A.trx_007, A.trx_008, A.trx_009, A.trx_010, A.trx_011, A.trx_012, A.trx_013, A.trx_014, A.trx_015, A.trx_016, A.trx_017, A.trx_018, A.trx_019, A.trx_020, A.trx_021, A.trx_022, A.trx_023, A.trx_024 FROM ((SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state, mpzd.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((((datamart.prescriber_rx rx JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN (SELECT market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo WHERE (hcp_demo.file_id = (SELECT max(customer_hcp_demographics.file_id) AS MAX FROM datamart.customer_hcp_demographics))) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo WHERE (hco_demo.file_id = (SELECT max(customer_hco_demographics.file_id) AS MAX FROM datamart.customer_hco_demographics))) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_report_number_cnt = ANY (ARRAY['1'::varchar(1), '2'::varchar(1), '3'::varchar(1), '4'::varchar(1), '5'::varchar(1), '6'::varchar(1), '68'::varchar(2)])) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state, mpzd.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime Therapeutics'::varchar(18)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((add_months(last_day(sp.ship_date), 1) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) A;

CREATE  VIEW sandbox.vw_concur_hcp_delta_0928 AS
 SELECT concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar) AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 1))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 1))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 1))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar),
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp) EXCEPT  SELECT concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar) AS cust_id,
        NULL AS organization_name,
        'HCP'::varchar(3) AS contact_type,
        initcap(hcp.first_name) AS first_name,
        initcap(hcp.middle_name) AS middle_name,
        initcap(hcp.last_name) AS last_name,
        hcp.suffix,
        npi.npi,
        addr.address_line_1,
        addr.address_line_2,
        addr.city,
        addr.state,
        addr.zipcode,
        sln.license_number AS sln,
        sln.state AS sln_state,
        dea.dea_number AS dea,
        NULL AS affiliation,
        CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END AS credential,
        hcp.healthcare_professional_status_code,
        date((statement_timestamp())::timestamp) AS create_date
 FROM (((((( SELECT hcp.TVCMID AS tvcmid,
        hcp.FIRST_NAME AS first_name,
        hcp.MIDDLE_NAME AS middle_name,
        hcp.LAST_NAME AS last_name,
        hcp.SUFFIX AS suffix,
        hcp.HEALTHCARE_PROFESSIONAL_STATUS_CODE AS healthcare_professional_status_code,
        hcp.TEVA_SPECIALTY_CODE AS teva_specialty_code
 FROM (raw.mdm_hcp hcp JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_hcp.file_id
 FROM raw.mdm_hcp
 GROUP BY mdm_hcp.file_id) a) hcp_file ON (((hcp.file_id = hcp_file.file_id) AND (hcp_file.file_rank = 2))))) hcp JOIN ( SELECT ad.TVCMID AS tvcmid,
        ad.ADDRESS_ID AS address_id,
        ad.ADDRESS_STATUS AS address_status,
        ad.ADDRESS_TYPE AS address_type,
        initcap(ad.ADDRESS_LINE_1) AS address_line_1,
        initcap(ad.ADDRESS_LINE_2) AS address_line_2,
        initcap(ad.CITY) AS city,
        ad.STATE AS state,
        ad.ZIP5_POSTAL_CODE AS zipcode,
        rank() OVER (PARTITION BY ad.TVCMID ORDER BY ad.PRACTICE_LOCATION_RANK DESC, ad.record_id) AS addr_rank
 FROM (raw.mdm_address ad JOIN ( SELECT a.file_id,
        rank() OVER (ORDER BY a.file_id DESC) AS file_rank
 FROM ( SELECT mdm_address.file_id
 FROM raw.mdm_address
 GROUP BY mdm_address.file_id) a) addr_file ON (((ad.file_id = addr_file.file_id) AND (ad.ADDRESS_STATUS = 'A'::varchar(1)) AND (ad.SINGLE_ADDRESS_INDICATOR = 'Y'::varchar(1)) AND (addr_file.file_rank = 2))))) addr ON (((hcp.tvcmid = addr.tvcmid) AND (addr.addr_rank = 1)))) JOIN ( SELECT p.TVCMID AS tvcmid,
        d.profession_code_shortname,
        rank() OVER (PARTITION BY p.TVCMID ORDER BY p.CREATED_DATE DESC) AS rnk
 FROM (raw.mdm_professional p JOIN reference.Designations d ON (((p.PROFESSION_CODE = d.profession_code) AND (p.PROFESSION_RANK = 1::float) AND (p.STATUS = 'A'::varchar(1)))))) prof ON (((hcp.tvcmid = prof.tvcmid) AND (prof.rnk = 1)))) LEFT  JOIN ( SELECT mdm_dea_address.TVCMID AS tvcmid,
        mdm_dea_address.DEA_NUMBER AS dea_number,
        mdm_dea_address.ADDRESS_ID AS address_id,
        rank() OVER (PARTITION BY mdm_dea_address.TVCMID, mdm_dea_address.ADDRESS_ID ORDER BY mdm_dea_address.DEA_EXPIRATION_DATE DESC, mdm_dea_address.UPDATED_DATE DESC, mdm_dea_address.record_id) AS rnk
 FROM raw.mdm_dea_address
 WHERE (mdm_dea_address.DEA_STATUS_CODE = 'A'::varchar(1))) dea ON (((addr.address_id = dea.address_id) AND (addr.tvcmid = dea.tvcmid) AND (dea.rnk = 1)))) LEFT  JOIN ( SELECT npi.tvcmid,
        npi.npi
 FROM (( SELECT mdm_alternate_id.file_id,
        mdm_alternate_id.TVCMID AS tvcmid,
        max(mdm_alternate_id.ALTERNATE_ID_VALUE) AS npi
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id,
          mdm_alternate_id.TVCMID) npi JOIN ( SELECT b.file_id,
        rank() OVER (ORDER BY b.file_id DESC) AS file_rank
 FROM ( SELECT mdm_alternate_id.file_id
 FROM raw.mdm_alternate_id
 WHERE ((mdm_alternate_id.ALTERNATE_ID_TYPE = 'NPI'::varchar(3)) AND (mdm_alternate_id.STATUS = 'A'::varchar(1)))
 GROUP BY mdm_alternate_id.file_id) b) npi2 ON (((npi.file_id = npi2.file_id) AND (npi2.file_rank = 2))))) npi ON ((hcp.tvcmid = npi.tvcmid))) LEFT  JOIN ( SELECT sln.TVCMID AS tvcmid,
        sln.AUTHORIZATION_NUMBER AS license_number,
        sln.STATE AS state,
        rank() OVER (PARTITION BY sln.TVCMID, sln.STATE ORDER BY sln.LICENSE_TYPE_PRIVILEGE_RANK, sln.LICENSE_EXPIRATION_DATE DESC, sln.LICENSE_EFFECTIVE_DATE DESC, sln.UPDATED_DATE DESC, sln.record_id) AS rnk
 FROM raw.mdm_license sln
 WHERE (sln.LICENSE_STATUS_CODE = 'A'::varchar(1))) sln ON (((hcp.tvcmid = sln.tvcmid) AND (addr.state = sln.state) AND (sln.rnk = 1))))
 GROUP BY concat('H'::varchar(1), (trunc(hcp.tvcmid))::varchar),
          NULL,
          'HCP'::varchar(3),
          initcap(hcp.first_name),
          initcap(hcp.middle_name),
          initcap(hcp.last_name),
          hcp.suffix,
          npi.npi,
          addr.address_line_1,
          addr.address_line_2,
          addr.city,
          addr.state,
          addr.zipcode,
          sln.license_number,
          sln.state,
          dea.dea_number,
          CASE WHEN ((prof.profession_code_shortname = 'RN'::varchar(2)) AND (hcp.teva_specialty_code = ANY (ARRAY['NRP'::varchar(3), 'CNA'::varchar(3), 'ARN'::varchar(3), 'CNM'::varchar(3), 'CNS'::varchar(3), 'PHA'::varchar(3)]))) THEN hcp.teva_specialty_code ELSE prof.profession_code_shortname END,
          hcp.healthcare_professional_status_code,
          date((statement_timestamp())::timestamp);

SELECT MARK_DESIGN_KSAFE(1);

