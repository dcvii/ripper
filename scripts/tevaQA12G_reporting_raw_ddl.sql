CREATE SCHEMA reporting;


CREATE TABLE reporting.test
(
    col int
);


CREATE TABLE reporting.temp_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation varchar(5),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    time_period varchar(7),
    period_type varchar(10),
    period varchar(63),
    month_bucket int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    tvcmid int,
    prescriber_name varchar(102),
    pdrp_flag varchar(1),
    address varchar(100),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    product_vol_trx numeric(21,3),
    market_vol_trx numeric(21,3),
    prev_prod_vol_trx numeric(21,3),
    prev_market_vol_trx numeric(21,3),
    product_vol_nrx numeric(21,3),
    market_vol_nrx numeric(21,3),
    prev_prod_vol_nrx numeric(21,3),
    prev_market_vol_nrx numeric(21,3),
    product_vol_trx_region numeric(39,21),
    market_vol_trx_region numeric(39,21),
    prev_prod_vol_trx_region numeric(39,21),
    prev_market_vol_trx_region numeric(39,21),
    product_vol_nrx_region numeric(39,21),
    market_vol_nrx_region numeric(39,21),
    prev_prod_vol_nrx_region numeric(39,21),
    prev_market_vol_nrx_region numeric(39,21),
    product_vol_trx_area numeric(39,21),
    market_vol_trx_area numeric(39,21),
    prev_prod_vol_trx_area numeric(39,21),
    prev_market_vol_trx_area numeric(39,21),
    product_vol_nrx_area numeric(39,21),
    market_vol_nrx_area numeric(39,21),
    prev_prod_vol_nrx_area numeric(39,21),
    prev_market_vol_nrx_area numeric(39,21),
    product_vol_trx_nation numeric(39,21),
    market_vol_trx_nation numeric(39,21),
    prev_prod_vol_trx_nation numeric(39,21),
    prev_market_vol_trx_nation numeric(39,21),
    product_vol_nrx_nation numeric(39,21),
    market_vol_nrx_nation numeric(39,21),
    prev_prod_vol_nrx_nation numeric(39,21),
    prev_market_vol_nrx_nation numeric(39,21)
);


CREATE TABLE reporting.specialty_mapping
(
    ims_specialty_code varchar(10),
    sales_force_id varchar(5),
    market_id int,
    specialty_description varchar(100),
    specialty_group varchar(25)
);


CREATE TABLE reporting.sales_force_product
(
    sales_force_id varchar(5) NOT NULL,
    product_basket_id int NOT NULL,
    product_name varchar(300),
    CONSTRAINT PK_sales_force_product PRIMARY KEY (sales_force_id, product_basket_id) DISABLED
);


CREATE TABLE reporting.weekly_workdays
(
    sales_force_id varchar(5),
    geography_id varchar(10),
    week date,
    expected_workdays numeric(4,2),
    actual_workdays numeric(4,2)
);


CREATE TABLE reporting.tntp_filter_table
(
    sales_force_id varchar(5),
    sales_force_name varchar(50),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    user_ids long varchar(3074)
);


CREATE TABLE reporting.par_rnf
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(15),
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(25),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int,
    prescriber_count_calls int,
    prescriber_count_samples int,
    prescriber_reached_calls int,
    prescriber_reached_samples int,
    how_executed varchar(40),
    call_recordtype varchar(80)
);


CREATE TABLE reporting.sp_monthly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int
);


CREATE TABLE reporting.tp_weekly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.roster
(
    geography_id varchar(10) NOT NULL,
    geography_name varchar(100),
    geography_level varchar(10),
    sales_force_id varchar(5),
    sales_force_name varchar(100),
    parent_geography_id varchar(10),
    employee_id varchar(100),
    rep_name varchar(100),
    rep_type varchar(10),
    user_id varchar(255),
    global_employee_id varchar(35),
    email varchar(255),
    CONSTRAINT PK_roster PRIMARY KEY (geography_id) DISABLED
);


CREATE TABLE reporting.customer_attributes
(
    customer_id varchar(25),
    tvcmid int,
    sales_force_id varchar(5),
    product_id int,
    attribute_type varchar(50),
    attribute_value varchar(100),
    attribute_effective_start_date date,
    attribute_effective_end_date date
);


CREATE TABLE reporting.activity_plan
(
    customer_id varchar(25),
    tvcmid int,
    product_id int,
    sales_force_id varchar(5),
    territory_id varchar(8),
    time_period varchar(10),
    planned_p1_calls int,
    planned_p2_calls int,
    planned_p3_calls int,
    planned_samples int,
    target_status_flag varchar(1)
);


CREATE TABLE reporting.monthly_activity
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    geography_id varchar(10),
    current_geography_id varchar(10),
    sales_force_id varchar(5),
    teva_employee_id varchar(50),
    activity_id varchar(64),
    activity_zip varchar(5),
    customer_type varchar(50),
    month_end date,
    month_bucket int,
    activity_name varchar(100),
    activity_detail varchar(500),
    activity_value numeric(20,2),
    how_executed varchar(40),
    call_recordtype varchar(80)
);


CREATE TABLE reporting.to_syncare
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    territory_id varchar(10),
    territory_name varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period date,
    patient_id varchar(100),
    customer_id varchar(25),
    tvcmid int,
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    physician_address varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(10),
    recent_cml varchar(200),
    insurance varchar(200)
);


CREATE TABLE reporting.geography_access
(
    geography_id varchar(10) NOT NULL,
    authorized_user_ids varchar(5500),
    CONSTRAINT PK_geography_access PRIMARY KEY (geography_id) DISABLED
);


CREATE TABLE reporting.monthly_new_prescriber
(
    customer_id varchar(25) NOT NULL,
    brand_id int NOT NULL,
    month_ending date NOT NULL,
    month_bucket int,
    current_trx numeric(18,3),
    prior_trx numeric(18,3),
    CONSTRAINT PK_monthly_new_prescriber PRIMARY KEY (customer_id, brand_id, month_ending) DISABLED
);


CREATE TABLE reporting.monthly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    month_ending date,
    month_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_restriction_flag varchar(1),
    segment varchar(100),
    decile varchar(100),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE reporting.tp_monthly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.tn_monthly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.tp_monthly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3)
);


CREATE TABLE reporting.tp_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.tp_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    cogentine_decile_value varchar(100),
    antipsych_decile_value varchar(100),
    focus_target varchar(100),
    titration_flag varchar(5),
    AssistRx_flag varchar(5),
    ShSol_flag varchar(5)
);


CREATE TABLE reporting.tn_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100),
    AssistRx_flag varchar(5),
    ShSol_flag varchar(5)
);


CREATE TABLE reporting.sp_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.sp_pre_call_summary_submarket
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.tn_pre_call_summary_submarket
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.ma_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.call_activity
(
    veeva_call_id varchar(20),
    veeva_parent_call_id varchar(18),
    call_id varchar(80),
    veeva_remote_meeting_id varchar(18),
    engage_meeting_id varchar(20),
    veeva_account_id varchar(20),
    sales_force_id varchar(2),
    territory_number varchar(8),
    tvcmid int,
    call_record_type varchar(80),
    call_type varchar(50),
    customer_type varchar(50),
    how_executed varchar(40),
    rep_first_name varchar(50),
    rep_last_name varchar(50),
    hcp_first_name varchar(50),
    hcp_last_name varchar(80),
    hco_name varchar(80),
    call_date date,
    address varchar(500),
    first_product_detailed varchar(300),
    second_product_detailed varchar(300),
    third_product_detailed varchar(300),
    meeting_scheduled_date date,
    latest_meeting_start_date date,
    meeting_duration int,
    non_host_attendees int,
    avg_attendee_duration float,
    hcp_invites int,
    teva_engage_meeting_status varchar(39),
    attendance_report_process_status_vod__c varchar(255),
    meeting_outcome_status_vod__c varchar(255)
);


CREATE TABLE reporting.call_key_messages
(
    veeva_account_id varchar(18),
    tvcmid int,
    call_id varchar(80),
    call_record_type varchar(80),
    product varchar(80),
    key_message varchar(80),
    call_date date,
    duration numeric(12,4),
    display_order varchar(64),
    call_status varchar(255),
    territory varchar(100),
    call_type varchar(255),
    hcp_name varchar(1300)
);


CREATE TABLE reporting.approved_email
(
    veeva_sent_email_id varchar(36),
    sent_email_id varchar(160),
    product varchar(2600),
    date_sent timestamptz,
    status varchar(9),
    failure_message varchar(510),
    veeva_account_id varchar(36),
    tvcmid int,
    veeva_call_id varchar(36),
    call_id varchar(80),
    sender_email varchar(160),
    territory varchar(200),
    recipient_email varchar(160),
    click_count float,
    open_count float,
    last_open_date timestamptz,
    valid_consent varchar(5),
    delivered varchar(1),
    opened varchar(1),
    dropped varchar(1),
    clicked varchar(1),
    downloaded varchar(1),
    viewed varchar(1),
    template_id varchar(36),
    template_name varchar(80),
    event_msg_vod__c varchar(65000),
    click_url_vod__c varchar(510),
    subject varchar(255)
);


CREATE TABLE reporting.engage_call_activity
(
    veeva_call_id varchar(20),
    veeva_parent_call_id varchar(18),
    call_id varchar(80),
    veeva_remote_meeting_id varchar(18),
    engage_meeting_id varchar(20),
    veeva_account_id varchar(20),
    sales_force_id varchar(2),
    territory_number varchar(8),
    tvcmid int,
    call_record_type varchar(80),
    call_type varchar(50),
    customer_type varchar(50),
    how_executed varchar(40),
    rep_first_name varchar(50),
    rep_last_name varchar(50),
    hcp_first_name varchar(50),
    hcp_last_name varchar(80),
    hco_name varchar(80),
    call_date date,
    address varchar(500),
    first_product_detailed varchar(300),
    second_product_detailed varchar(300),
    third_product_detailed varchar(300),
    meeting_scheduled_date date,
    latest_meeting_start_date date,
    meeting_duration int,
    non_host_attendees int,
    avg_attendee_duration float,
    hcp_invites int,
    teva_engage_meeting_status varchar(39),
    attendance_report_process_status_vod__c varchar(255),
    meeting_outcome_status_vod__c varchar(255)
);


CREATE TABLE reporting.tmp_call_key_messages
(
    veeva_account_id varchar(18),
    tvcmid int,
    call_id varchar(80),
    call_record_type varchar(80),
    product varchar(80),
    key_message varchar(80),
    call_date date,
    duration numeric(12,4),
    display_order varchar(64),
    call_status varchar(255),
    territory varchar(100),
    call_type varchar(255),
    hcp_name varchar(1300),
    current_territory varchar(100)
);


CREATE TABLE reporting.ajovy_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    ns_nation_id varchar(8),
    ns_nation varchar(200),
    ns_area_id varchar(8),
    ns_area varchar(200),
    ns_region_id varchar(8),
    ns_region varchar(200),
    ns_territory_id varchar(8),
    ns_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    lives_covered int
);


CREATE TABLE reporting.austedo_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    np_nation_id varchar(8),
    np_nation varchar(200),
    np_area_id varchar(8),
    np_area varchar(200),
    np_region_id varchar(8),
    np_region varchar(200),
    np_territory_id varchar(8),
    np_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.digihaler_reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    rs_nation_id varchar(8),
    rs_nation varchar(200),
    rs_area_id varchar(8),
    rs_area varchar(200),
    rs_region_id varchar(8),
    rs_region varchar(200),
    rs_territory_id varchar(8),
    rs_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.engage_call_activity_hist
(
    veeva_call_id varchar(20),
    veeva_parent_call_id varchar(18),
    call_id varchar(80),
    veeva_remote_meeting_id varchar(18),
    engage_meeting_id varchar(20),
    veeva_account_id varchar(20),
    sales_force_id varchar(2),
    territory_number varchar(8),
    tvcmid int,
    call_record_type varchar(80),
    call_type varchar(50),
    customer_type varchar(50),
    how_executed varchar(40),
    rep_first_name varchar(50),
    rep_last_name varchar(50),
    hcp_first_name varchar(50),
    hcp_last_name varchar(80),
    hco_name varchar(80),
    call_date date,
    address varchar(500),
    first_product_detailed varchar(300),
    second_product_detailed varchar(300),
    third_product_detailed varchar(300),
    meeting_scheduled_date date,
    latest_meeting_start_date date,
    meeting_duration int,
    non_host_attendees int,
    avg_attendee_duration float,
    hcp_invites int,
    teva_engage_meeting_status varchar(39),
    attendance_report_process_status_vod__c varchar(255),
    meeting_outcome_status_vod__c varchar(255)
);


CREATE TABLE reporting.call_key_messages_hist
(
    veeva_account_id varchar(18),
    tvcmid int,
    call_id varchar(80),
    call_record_type varchar(80),
    product varchar(80),
    key_message varchar(80),
    call_date date,
    duration numeric(12,4),
    display_order varchar(64),
    call_status varchar(255),
    territory varchar(100),
    call_type varchar(255),
    hcp_name varchar(1300)
);


CREATE TABLE reporting.rs_mnthly_pyr_pres_summ
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.par_rnf_csd991
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(15),
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(25),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int,
    prescriber_count_calls int,
    prescriber_count_samples int,
    prescriber_reached_calls int,
    prescriber_reached_samples int,
    how_executed varchar(40),
    call_recordtype varchar(80)
);


CREATE TABLE reporting.par_rnf_cummulative
(
    sales_force_id varchar(200),
    geography_level varchar(200),
    geography_id varchar(200),
    geography varchar(200),
    rep_name varchar(200),
    user_id varchar(200),
    market_id int,
    market_name varchar(200),
    brand_id int,
    brand_name varchar(200),
    time_period varchar(200),
    period_type varchar(200),
    period varchar(200),
    decile varchar(200),
    segment varchar(200),
    specialty varchar(200),
    target_status varchar(200),
    total_details int,
    prescriber_count_calls int,
    how_executed varchar(200),
    new_customer int,
    final_cummulative_count int
);


CREATE TABLE reporting.ajovy_reverse_geo_payer_weekly
(
    ns_nation_id varchar(8),
    ns_nation varchar(200),
    ns_area_id varchar(8),
    ns_area varchar(200),
    ns_region_id varchar(8),
    ns_region varchar(200),
    ns_territory_id varchar(8),
    ns_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    lives_covered int
);


CREATE TABLE reporting.ts_weekly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    decile varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_units int,
    market_vol_units int,
    prev_prod_vol_units int,
    prev_market_vol_units int,
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.ts_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    segment varchar(100),
    decile varchar(100),
    target varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    channel varchar(50),
    market_volume_indicator int,
    new_accounts int,
    accounts_ordering int,
    avg_sales_per_account numeric(18,2),
    prev_accounts_ordering int,
    product_vol_units int,
    market_vol_units int,
    prev_prod_vol_units int,
    prev_market_vol_units int,
    accounts_detailed_count int,
    total_accounts_count int
);


CREATE TABLE reporting.payer_mapping
(
    payer_plan_id varchar(10) NOT NULL,
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    model_id varchar(10),
    method_of_payment varchar(250),
    CONSTRAINT PK_payer_mapping PRIMARY KEY (payer_plan_id) DISABLED
);


CREATE TABLE reporting.monthly_workdays
(
    sales_force_id varchar(5),
    geography_id varchar(10) NOT NULL,
    month date NOT NULL,
    expected_workdays numeric(6,4),
    actual_workdays numeric(6,4),
    CONSTRAINT PK_monthly_workdays PRIMARY KEY (geography_id, month) DISABLED
);


CREATE TABLE reporting.quota
(
    territory_id varchar(10) NOT NULL,
    sales_force_id varchar(5),
    product_id int NOT NULL,
    time_period varchar(10) NOT NULL,
    quota_strength_unit numeric(18,3),
    quota_quantity numeric(18,3),
    quota_dollars numeric(18,3),
    CONSTRAINT PK_quota PRIMARY KEY (territory_id, product_id, time_period) DISABLED
);


CREATE TABLE reporting.reporting_rollup_week
(
    rollup_week date NOT NULL,
    sales_week_bucket int,
    activity_week_bucket int,
    CONSTRAINT PK_rollup_week PRIMARY KEY (rollup_week) DISABLED
);


CREATE TABLE reporting.reporting_rollup_month
(
    rollup_month date NOT NULL,
    sales_month_bucket int,
    activity_month_bucket int,
    CONSTRAINT PK_rollup_month PRIMARY KEY (rollup_month) DISABLED
);


CREATE TABLE reporting.tn_monthly_geo_summary_old_format
(
    sales_force_id varchar(5),
    geography_level varchar(9),
    geography_id varchar(100),
    geography varchar(113),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(10),
    segment varchar(100),
    product_vol_trx numeric(21,3),
    product_vol_new_pres_trx numeric(21,3),
    market_vol_trx numeric(21,3),
    prev_prod_vol_trx numeric(21,3),
    prev_market_vol_trx numeric(21,3),
    product_vol_nrx numeric(21,3),
    product_vol_new_pres_nrx numeric(21,3),
    market_vol_nrx numeric(21,3),
    prev_prod_vol_nrx numeric(21,3),
    prev_market_vol_nrx numeric(21,3),
    prescribers_count int,
    new_prescribers_count int
);


CREATE TABLE reporting.product
(
    product_id int NOT NULL,
    product_name varchar(300),
    product_type varchar(100),
    brand_id int,
    brand_name varchar(300),
    market_id int,
    market_name varchar(300),
    teva_product_flag varchar(1),
    geo_summary_include varchar(1),
    presc_summary_include varchar(1),
    market_share_market_id int,
    market_share_market_name varchar(300),
    market_share_default_brand varchar(1),
    rptg_decile_attribute_type varchar(100),
    rptg_decile_attribute_prod_id int,
    rptg_segment_attribute_type varchar(100),
    rptg_segment_attribute_prod_id int,
    molecule_id varchar(1),
    molecule_name varchar(1),
    class_name varchar(1),
    form_strength_name varchar(1),
    indication varchar(1),
    CONSTRAINT PK_product PRIMARY KEY (product_id) DISABLED
);


CREATE TABLE reporting.sp_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int
);


CREATE TABLE reporting.sp_weekly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.tn_weekly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.tp_monthly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.tp_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.user_access_table
(
    user_id varchar(255) NOT NULL,
    user_type varchar(10),
    assigned_geography_id varchar(10),
    authorized_geography_id varchar(10) NOT NULL,
    CONSTRAINT PK_user_access_table PRIMARY KEY (user_id, authorized_geography_id) DISABLED
);


CREATE TABLE reporting.calls_per_day_goal
(
    sales_force_id varchar(5),
    product_id int,
    month date,
    rep_calls_per_day numeric(4,2),
    goal_type varchar(25),
    prod_percent numeric(4,3)
);


CREATE TABLE reporting.customer_address
(
    customer_id varchar(25) NOT NULL,
    tvcmid int,
    ims_id varchar(10),
    address_1 varchar(100),
    address_2 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    alignment_zip varchar(5),
    sales_force_id varchar(5),
    territory_id varchar(10) NOT NULL,
    territory_name varchar(100),
    base_flag varchar(1),
    region_id varchar(10),
    region_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    territory_count int,
    region_count int,
    area_count int,
    sales_force_count int,
    CONSTRAINT PK_customer_address PRIMARY KEY (customer_id, territory_id) DISABLED
);


CREATE TABLE reporting.monthly_account_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    month date,
    month_bucket int,
    data_source varchar(25),
    subcat_code varchar(2),
    channel varchar(50),
    trx_count numeric(18,3),
    nrx_count numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars numeric(18,2),
    nrx_dollars numeric(18,2),
    mcgs int,
    mgs int,
    new_account varchar(1)
);


CREATE TABLE reporting.weekly_account_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    week date,
    week_bucket int,
    data_source varchar(25),
    subcat_code varchar(2),
    channel varchar(50),
    trx_count numeric(18,3),
    nrx_count numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars numeric(18,2),
    nrx_dollars numeric(18,2),
    mcgs int,
    mgs int,
    new_account varchar(1)
);


CREATE TABLE reporting.syncare_dispensed_weekly
(
    customer_id varchar(25),
    tvcmid int NOT NULL,
    npi varchar(10),
    product_id int NOT NULL,
    patient_id varchar(100) NOT NULL,
    week date NOT NULL,
    units int,
    dollars numeric(18,2),
    copay numeric(18,2),
    copay_vs_wac numeric(18,4),
    CONSTRAINT PK_syncare_dispensed_weekly PRIMARY KEY (tvcmid, product_id, patient_id, week) DISABLED
);


CREATE TABLE reporting.syncare_dispensed_monthly
(
    customer_id varchar(25),
    tvcmid int NOT NULL,
    npi varchar(10),
    product_id int NOT NULL,
    patient_id varchar(100) NOT NULL,
    month date NOT NULL,
    units int,
    dollars numeric(18,2),
    copay numeric(18,2),
    copay_vs_wac numeric(18,4),
    CONSTRAINT PK_syncare_dispensed_monthly PRIMARY KEY (tvcmid, product_id, patient_id, month) DISABLED
);


CREATE TABLE reporting.to_monthly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    new_prescriber varchar(1),
    specialty varchar(100),
    specialty_group varchar(10),
    method_of_payment varchar(250),
    product_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.geography_access_transaction
(
    geography_id varchar(10) NOT NULL,
    authorized_user_ids varchar(5500),
    CONSTRAINT PK_geography_access_transaction PRIMARY KEY (geography_id) DISABLED
);


CREATE TABLE reporting.weekly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    week_ending date,
    week_bucket int,
    data_source varchar(25),
    channel varchar(50),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars numeric(18,2),
    nrx_dollars numeric(18,2),
    new_prescriber varchar(1)
);


CREATE TABLE reporting.monthly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    month_ending date,
    month_bucket int,
    data_source varchar(25),
    channel varchar(50),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars numeric(18,3),
    nrx_dollars numeric(18,3),
    new_prescriber varchar(1)
);


CREATE TABLE reporting.tn_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.tn_monthly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3)
);


CREATE TABLE reporting.tp_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.tn_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.mb_par_rnf
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(15),
    decile varchar(100),
    segment varchar(100),
    specialty varchar(25),
    target_status varchar(25),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    samples int,
    prescriber_count_calls int,
    prescriber_count_samples int,
    prescriber_reached_calls int,
    prescriber_reached_samples int,
    how_executed varchar(40)
);


CREATE TABLE reporting.reverse_geo_payer
(
    ma_nation_id varchar(8),
    ma_nation varchar(200),
    ma_area_id varchar(8),
    ma_area varchar(200),
    ma_region_id varchar(8),
    ma_region varchar(200),
    ma_territory_id varchar(8),
    ma_territory varchar(200),
    ns_nation_id varchar(8),
    ns_nation varchar(200),
    ns_area_id varchar(8),
    ns_area varchar(200),
    ns_region_id varchar(8),
    ns_region varchar(200),
    ns_territory_id varchar(8),
    ns_territory varchar(200),
    sp_nation_id varchar(8),
    sp_nation varchar(200),
    sp_area_id varchar(8),
    sp_area varchar(200),
    sp_region_id varchar(8),
    sp_region varchar(200),
    sp_territory_id varchar(8),
    sp_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    lives_covered int
);


CREATE TABLE reporting.zip_alignment
(
    sales_force_id varchar(5) NOT NULL,
    zip varchar(5) NOT NULL,
    city varchar(50),
    state_code varchar(2),
    territory_id varchar(10),
    territory_name varchar(100),
    rep_name varchar(100),
    rep_id varchar(100),
    mobile_phone varchar(100),
    rep_email varchar(255),
    region_id varchar(8),
    region_name varchar(50),
    regional_mgr_name varchar(100),
    area_id varchar(8),
    area_name varchar(50),
    area_mgr_name varchar(100),
    mirror_territory_id varchar(10),
    mirror_territory_name varchar(100),
    CONSTRAINT PK_zip_alignment PRIMARY KEY (sales_force_id, zip) DISABLED
);


CREATE TABLE reporting.sa_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.LAI_monthly_new_prescriber
(
    customer_id varchar(200),
    brand_id int,
    month_ending date,
    month_bucket int,
    curr_trx float,
    prev_trx float
);


CREATE TABLE reporting.LAI_monthly_prescriber_sales
(
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    product_id int,
    payer_plan_id varchar(200),
    month_ending date,
    month_bucket int,
    data_source varchar(200),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx float,
    nrx float,
    trx_units float,
    nrx_units float,
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE reporting.LAI_monthly_prescriber_sales_summary
(
    sales_force_id varchar(200),
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    period_type varchar(200),
    period varchar(200),
    month_ending date,
    month_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(200),
    payer_plan_id varchar(200),
    method_of_payment varchar(200),
    hcp_restriction_flag varchar(200),
    segment varchar(200),
    decile varchar(200),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(37,15),
    prev_prod_vol_trx_count numeric(37,15),
    product_vol_nrx_count numeric(37,15),
    prev_prod_vol_nrx_count numeric(37,15),
    market_vol_trx_count numeric(37,15),
    prev_market_vol_trx_count numeric(37,15),
    market_vol_nrx_count numeric(37,15),
    prev_market_vol_nrx_count numeric(37,15),
    samples numeric(37,15),
    details_p1 numeric(37,15),
    details_p2 numeric(37,15),
    details_p3 numeric(37,15)
);


CREATE TABLE reporting.LAI_monthly_prescriber_summary
(
    sales_force_id varchar(200),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(200),
    period varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(200),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(200),
    prescriber_name varchar(102),
    new_prescriber varchar(1),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    target_status_flag varchar(1),
    partner_target_status_flag varchar(1),
    method_of_payment varchar(200),
    specialty varchar(25),
    segment varchar(200),
    decile varchar(200),
    market_volume_indicator int,
    product_vol_trx_count numeric(37,15),
    market_vol_trx_count numeric(37,15),
    prev_prod_vol_trx_count numeric(37,15),
    prev_market_vol_trx_count numeric(37,15),
    product_vol_nrx_count numeric(37,15),
    market_vol_nrx_count numeric(37,15),
    prev_prod_vol_nrx_count numeric(37,15),
    prev_market_vol_nrx_count numeric(37,15),
    samples numeric(37,15),
    details_p1 numeric(37,15),
    details_p2 numeric(37,15),
    details_p3 numeric(37,15)
);


CREATE TABLE reporting.LAI_monthly_payer_prescriber_summary
(
    sales_force_id varchar(200),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.LAI_monthly_geography_summary
(
    sales_force_id varchar(200),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.LAI_monthly_payer_geography_summary
(
    sales_force_id varchar(200),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    rep_type varchar(100),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3)
);


CREATE TABLE reporting.LAI_weekly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    week_ending date,
    week_bucket int,
    data_source varchar(7),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE reporting.LAI_weekly_new_prescriber
(
    customer_id varchar(25),
    brand_id int,
    week_ending date,
    week_bucket int,
    curr_trx numeric(21,3),
    prev_trx numeric(21,3)
);


CREATE TABLE reporting.LAI_weekly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    week_ending date,
    week_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE reporting.LAI_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    partner_target_status_flag varchar(5),
    target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.LAI_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    rep_type varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.LAI_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    rep_type varchar(100),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.LAI_weekly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    rep_type varchar(100),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.ts_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    rep_type varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.ajovy_reverse_geo_payer_weekly_bkp_0124
(
    ns_nation_id varchar(8),
    ns_nation varchar(200),
    ns_area_id varchar(8),
    ns_area varchar(200),
    ns_region_id varchar(8),
    ns_region varchar(200),
    ns_territory_id varchar(8),
    ns_territory varchar(200),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(15),
    period_type varchar(15),
    period varchar(100),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(4),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(2),
    zip varchar(5),
    final_key_controlling_account varchar(100),
    key_parent_account varchar(100),
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    plan_payment_type varchar(10),
    market_volume_indicator varchar(1),
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    lives_covered int
);


CREATE TABLE reporting.austedo_titration_dosage
(
    customer_id varchar(200),
    tvcmid int,
    ims_id varchar(200),
    zip varchar(10),
    sales_force_id varchar(200),
    territory_id varchar(10),
    territory_name varchar(100),
    region_id varchar(10),
    region_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    product_name varchar(50),
    data_type varchar(50),
    Avg_TD_Daily_Dose_New_Patient numeric(10,3),
    Avg_TD_Daily_Dose_Cont_Patient numeric(10,3),
    Data_Ending_Month date
);


CREATE TABLE reporting.geography_alignment
(
    territory_id varchar(10) NOT NULL,
    territory_name varchar(100),
    base_flag varchar(1),
    region_id varchar(10),
    region_name varchar(100),
    area_id varchar(10),
    area_name varchar(100),
    nation_id varchar(10),
    nation_name varchar(100),
    sales_force_id varchar(5),
    sales_force_name varchar(50),
    CONSTRAINT PK_geography_alignment PRIMARY KEY (territory_id) DISABLED
);


CREATE TABLE reporting.tmp_oncology_account_detail_periods
(
    sales_force_id varchar(5),
    nation varchar(8),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    period varchar(63),
    month_bucket int,
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(1),
    territory_count int,
    region_count int,
    area_count int,
    sales_force_count int,
    target varchar(100),
    new_account varchar(1),
    product_vol_dollars numeric(20,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(20,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(20,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(20,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int
);


CREATE TABLE reporting.product_item
(
    product_id int NOT NULL,
    product_name varchar(300),
    product_type varchar(100),
    item_id int NOT NULL,
    item_name varchar(300),
    item_type varchar(100),
    CONSTRAINT PK_product_item PRIMARY KEY (product_id, item_id) DISABLED
);


CREATE TABLE reporting.sales_force_headcounts
(
    sales_force_id varchar(5),
    month date,
    headcount int,
    products int
);


CREATE TABLE reporting.tn_monthly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.tn_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.to_monthly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    segment varchar(100),
    target varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    syncare_flag varchar(1),
    channel varchar(50),
    market_volume_indicator int,
    call_goals numeric(11,2),
    new_accounts int,
    accounts_ordering int,
    avg_sales_per_account numeric(18,2),
    prev_accounts_ordering int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    accounts_detailed_count int,
    total_accounts_count int
);


CREATE TABLE reporting.to_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    segment varchar(100),
    target varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    syncare_flag varchar(1),
    channel varchar(50),
    market_volume_indicator int,
    call_goals numeric(11,2),
    new_accounts int,
    accounts_ordering int,
    avg_sales_per_account numeric(18,2),
    prev_accounts_ordering int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    accounts_detailed_count int,
    total_accounts_count int
);


CREATE TABLE reporting.user_access_table_transaction
(
    user_id varchar(255) NOT NULL,
    user_type varchar(10),
    assigned_geography_id varchar(10),
    authorized_geography_id varchar(10) NOT NULL,
    CONSTRAINT PK_user_access_table_transaction PRIMARY KEY (user_id, authorized_geography_id) DISABLED
);


CREATE TABLE reporting.par_calls
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(10),
    customer_type varchar(50),
    details_p1 int,
    details_p2 int,
    details_p3 int,
    total_details int,
    call_goals numeric(11,4),
    calls_per_day_goal numeric(11,4),
    expected_workdays numeric(11,4),
    actual_workdays numeric(11,4),
    how_executed varchar(40),
    target_status varchar(25),
    call_recordtype varchar(80)
);


CREATE TABLE reporting.weekly_activity
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    geography_id varchar(10),
    current_geography_id varchar(10),
    sales_force_id varchar(5),
    teva_employee_id varchar(50),
    activity_id varchar(64),
    activity_zip varchar(5),
    customer_type varchar(50),
    week_end date,
    week_bucket int,
    activity_name varchar(100),
    activity_detail varchar(500),
    activity_value numeric(20,2),
    how_executed varchar(40),
    call_recordtype varchar(80)
);


CREATE TABLE reporting.syncare_events
(
    customer_id varchar(25),
    tvcmid int,
    npi varchar(10),
    patient_id varchar(100),
    product_id int,
    event_date date,
    enrollment_flag varchar(1),
    recent_cml varchar(200),
    insurance varchar(200),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    physician_address varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(10)
);


CREATE TABLE reporting.customer
(
    customer_id varchar(25) NOT NULL,
    tvcmid int,
    ims_id varchar(10),
    ims_outlet_code varchar(10),
    ims_facility_number varchar(11),
    federation_id varchar(200),
    customer_type varchar(15),
    prescriber_type varchar(25),
    network_name varchar(100),
    account_name varchar(100),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    credential varchar(100),
    subcat_group varchar(100),
    subcat_code varchar(2),
    pdrp_flag varchar(1),
    pri_specialty_code varchar(10),
    pri_specialty_desc varchar(100),
    sec_specialty_code varchar(10),
    sec_specialty_desc varchar(100),
    cm_status_flag varchar(15),
    gpo varchar(100),
    dnp_flag varchar(1),
    product_1_dnc_flag varchar(1),
    product_2_dnc_flag varchar(1),
    a_specialty_group varchar(10),
    b_specialty_group varchar(10),
    c_specialty_group varchar(10),
    formulary_control varchar(20),
    CONSTRAINT PK_customer PRIMARY KEY (customer_id) DISABLED
);


CREATE TABLE reporting.to_monthly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int
);


CREATE TABLE reporting.to_weekly_account_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    network_name varchar(100),
    account_name varchar(100),
    channel varchar(50),
    address varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    formulary_control varchar(20),
    gpo varchar(100),
    target varchar(100),
    new_account varchar(1),
    market_volume_indicator int,
    product_vol_dollars numeric(21,2),
    product_vol_mg int,
    product_vol_mcg int,
    market_vol_dollars numeric(21,2),
    market_vol_mg int,
    market_vol_mcg int,
    prev_prod_vol_dollars numeric(21,2),
    prev_prod_vol_mg int,
    prev_prod_vol_mcg int,
    prev_market_vol_dollars numeric(21,2),
    prev_market_vol_mg int,
    prev_market_vol_mcg int
);


CREATE TABLE reporting.weekly_new_prescriber
(
    customer_id varchar(25) NOT NULL,
    brand_id int NOT NULL,
    week_ending date NOT NULL,
    week_bucket int,
    current_trx numeric(18,3),
    prior_trx numeric(18,3),
    CONSTRAINT PK_weekly_new_prescriber PRIMARY KEY (customer_id, brand_id, week_ending) DISABLED
);


CREATE TABLE reporting.weekly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    week_ending date,
    week_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE reporting.sp_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.tp_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    partner_target_status_flag varchar(5),
    target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.sp_monthly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.sp_monthly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3)
);


CREATE TABLE reporting.sp_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.tn_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.sp_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.reporting_rollup_month_month
(
    rollup_month date,
    sales_month_bucket int,
    activity_month_bucket int
);


CREATE TABLE reporting.teva_plantrak_workbook
(
    payer_number varchar(6),
    payer_name varchar(100),
    payer_parent_number varchar(6),
    payer_parent_name varchar(100),
    plan_number varchar(4),
    payer_plan_number varchar(10) NOT NULL,
    plan_name varchar(100),
    model varchar(10),
    method_of_payment varchar(250),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4),
    pbm_number varchar(6),
    pbm_name varchar(100),
    pbm_parent varchar(6),
    pbm_parent_name varchar(100),
    key_controlling_account varchar(100),
    key_parent_account varchar(100),
    lives_covered int NOT NULL,
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100),
    key_controlling_parent varchar(100),
    pbm_payer_filter varchar(100),
    CONSTRAINT PK_teva_plantrak_workbook PRIMARY KEY (payer_plan_number) DISABLED
);


CREATE TABLE reporting.sa_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.sa_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.teva_plantrak_workbook_09132020
(
    payer_number varchar(6),
    payer_name varchar(100),
    payer_parent_number varchar(6),
    payer_parent_name varchar(100),
    plan_number varchar(4),
    payer_plan_number varchar(10),
    plan_name varchar(100),
    model varchar(10),
    method_of_payment varchar(250),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4),
    pbm_number varchar(6),
    pbm_name varchar(100),
    pbm_parent varchar(6),
    pbm_parent_name varchar(100),
    key_controlling_account varchar(100),
    key_parent_account varchar(100),
    lives_covered int,
    ajovy_formulary_status varchar(100),
    aimovig_formulary_status varchar(100),
    emgality_formulary_status varchar(100)
);


CREATE TABLE reporting.engage_meeting_attendee
(
    veeva_remote_meeting_id varchar(18),
    engage_meeting_id varchar(20),
    veeva_call_id varchar(18),
    attendee_name varchar(150),
    participant_id varchar(20),
    join_time timestamptz,
    leave_time timestamptz,
    meeting_start_time timestamptz,
    meeting_end_time timestamptz,
    attendee_duration int,
    meeting_duration int,
    attendee_type varchar(8)
);


CREATE TABLE reporting.rs_weekly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.rs_weekly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.rs_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.rs_weekly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3)
);


CREATE TABLE reporting.rs_monthly_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    customer_id varchar(25),
    tvcmid int,
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    prescriber_name varchar(100),
    new_prescriber varchar(5),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int
);


CREATE TABLE reporting.rs_monthly_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(15),
    period varchar(15),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    target_status_flag varchar(1),
    method_of_payment varchar(250),
    specialty varchar(15),
    segment varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    product_vol_new_pres_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    product_vol_new_pres_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    prescribers_count int,
    new_prescribers_count int,
    decile varchar(100)
);


CREATE TABLE reporting.rs_monthly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.rs_monthly_payer_geography_summary
(
    sales_force_id varchar(5),
    geography_level varchar(10),
    geography_id varchar(100),
    geography varchar(250),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(11),
    period varchar(11),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    method_of_payment varchar(250),
    market_volume_indicator int,
    geo_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3)
);


CREATE TABLE reporting.rs_pre_call_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.rs_pre_call_summary_tmp
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.approved_email_hist
(
    veeva_sent_email_id varchar(36),
    sent_email_id varchar(160),
    product varchar(2600),
    date_sent timestamptz,
    status varchar(9),
    failure_message varchar(510),
    veeva_account_id varchar(36),
    tvcmid int,
    veeva_call_id varchar(36),
    call_id varchar(80),
    sender_email varchar(160),
    territory varchar(200),
    recipient_email varchar(160),
    click_count float,
    open_count float,
    last_open_date timestamptz,
    valid_consent varchar(5),
    delivered varchar(1),
    opened varchar(1),
    dropped varchar(1),
    clicked varchar(1),
    downloaded varchar(1),
    viewed varchar(1),
    template_id varchar(36),
    template_name varchar(80),
    event_msg_vod__c varchar(65000),
    click_url_vod__c varchar(510),
    subject varchar(255)
);


CREATE TABLE reporting.zs_teva_payer_master_detailed
(
    plan_code varchar(10),
    Plan_Name varchar(100),
    Payer_Name varchar(100),
    PBM varchar(100),
    Payment_Type varchar(100),
    Key_Controlling_Plan_Formulary varchar(100),
    Key_Controlling_Account varchar(100),
    AJOVY_Access_for_FTF_Plan varchar(50),
    Aimovig_Access_for_FTF_Plan varchar(50),
    Emgality_Access_for_FTF_Plan varchar(50),
    Apportionment_Factor numeric(18,4),
    key_controlling_parent varchar(100),
    pbm_payer_filter varchar(100)
);


CREATE TABLE reporting.tmp_ma_mnthly_pyr_pres_summ
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(100),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    Nation_Product_TRx_Count numeric(21,3),
    Nation_Product_NRx_Count numeric(21,3),
    Nation_Market_TRx_Count numeric(21,3),
    Nation_Market_NRx_Count numeric(21,3),
    Nation_Product_TRx_Payer_Count numeric(21,3),
    Nation_Product_NRx_Payer_Count numeric(21,3),
    Nation_Market_TRx_Payer_Count numeric(21,3),
    Nation_Market_NRx_Payer_Count numeric(21,3),
    Nation_Product_TRx_Plan_Count numeric(21,3),
    Nation_Product_NRx_Plan_Count numeric(21,3),
    Nation_Market_TRx_Plan_Count numeric(21,3),
    Nation_Market_NRx_Plan_Count numeric(21,3),
    focus_target varchar(100)
);


CREATE TABLE reporting.tp_pre_calls_anti_psych
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    cogentine_decile_value varchar(100),
    antipsych_decile_value varchar(100),
    focus_target varchar(100),
    titration_flag varchar(5),
    AssistRx_flag varchar(5),
    ShSol_flag varchar(5)
);


CREATE TABLE reporting.tn_pre_calls_anti_psych
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100),
    AssistRx_flag varchar(5),
    ShSol_flag varchar(5)
);


CREATE TABLE reporting.tp_anti_psych_weekly_new_prescriber
(
    customer_id varchar(25),
    brand_id int,
    week_ending date,
    week_bucket int,
    curr_trx numeric(21,3),
    prev_trx numeric(21,3)
);


CREATE TABLE reporting.tp_anti_psych_weekly_prescriber_sales
(
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    product_id int,
    payer_plan_id varchar(10),
    week_ending date,
    week_bucket int,
    data_source varchar(7),
    channel varchar(30),
    pbm_name varchar(100),
    method_of_payment varchar(250),
    trx numeric(18,3),
    nrx numeric(18,3),
    trx_units numeric(18,3),
    nrx_units numeric(18,3),
    trx_dollars int,
    nrx_dollars int,
    new_prescriber varchar(1)
);


CREATE TABLE reporting.tp_anti_psych_weekly_prescriber_sales_summary
(
    sales_force_id varchar(5),
    customer_id varchar(25),
    tvcmid int,
    ims_id varchar(10),
    period_type varchar(10),
    period varchar(11),
    week_ending date,
    week_bucket int,
    market_id int,
    brand_id int,
    payer_id varchar(6),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    hcp_payer_vol_rank int,
    hcp_plan_vol_rank int,
    product_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples numeric(20,2),
    details_p1 numeric(20,2),
    details_p2 numeric(20,2),
    details_p3 numeric(20,2)
);


CREATE TABLE reporting.tp_anti_psych_weekly_payer_prescriber_summary
(
    sales_force_id varchar(5),
    nation_id varchar(10),
    nation varchar(10),
    area_id varchar(10),
    area varchar(100),
    region_id varchar(10),
    region varchar(100),
    territory_id varchar(10),
    territory varchar(100),
    rep_name varchar(100),
    user_id varchar(255),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    customer_id varchar(25),
    tvcmid int,
    hcp_plan_vol_rank int,
    prescriber_name varchar(100),
    pdrp_flag varchar(1),
    hcp_restriction_flag varchar(1),
    address varchar(100),
    city varchar(100),
    state varchar(100),
    zip varchar(10),
    target_status_flag varchar(5),
    partner_target_status_flag varchar(5),
    method_of_payment varchar(250),
    specialty varchar(25),
    segment varchar(100),
    decile varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    prev_prod_vol_trx_count numeric(21,3),
    prev_market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3),
    prev_prod_vol_nrx_count numeric(21,3),
    prev_market_vol_nrx_count numeric(21,3),
    samples int,
    details_p1 int,
    details_p2 int,
    details_p3 int,
    focus_target varchar(100)
);


CREATE TABLE reporting.uzedy_reverse_geo_payer_weekly
(
    ts_nation_id varchar(10),
    ts_nation varchar(10),
    ts_area_id varchar(10),
    ts_area varchar(100),
    ts_region_id varchar(10),
    ts_region varchar(100),
    ts_territory_id varchar(10),
    ts_territory varchar(100),
    market_id int,
    market_name varchar(300),
    brand_id int,
    brand_name varchar(300),
    teva_product_flag varchar(1),
    time_period varchar(10),
    period_type varchar(10),
    period varchar(11),
    pbm_id varchar(6),
    pbm_name varchar(100),
    payer_id varchar(6),
    payer_name varchar(100),
    plan_id varchar(6),
    plan_name varchar(100),
    payer_plan_id varchar(10),
    method_of_payment varchar(250),
    state varchar(100),
    zip varchar(10),
    key_controlling_parent varchar(100),
    key_controlling_account varchar(100),
    key_controlling_plan_formulary varchar(100),
    market_volume_indicator int,
    product_vol_trx_count numeric(21,3),
    market_vol_trx_count numeric(21,3),
    product_vol_nrx_count numeric(21,3),
    market_vol_nrx_count numeric(21,3)
);


CREATE PROJECTION reporting.geography_alignment_b0 /*+basename(geography_alignment),createtype(L)*/ 
(
 territory_id,
 territory_name,
 base_flag,
 region_id,
 region_name,
 area_id,
 area_name,
 nation_id,
 nation_name,
 sales_force_id,
 sales_force_name
)
AS
 SELECT geography_alignment.territory_id,
        geography_alignment.territory_name,
        geography_alignment.base_flag,
        geography_alignment.region_id,
        geography_alignment.region_name,
        geography_alignment.area_id,
        geography_alignment.area_name,
        geography_alignment.nation_id,
        geography_alignment.nation_name,
        geography_alignment.sales_force_id,
        geography_alignment.sales_force_name
 FROM reporting.geography_alignment
 ORDER BY geography_alignment.territory_id
SEGMENTED BY hash(geography_alignment.region_id) ALL NODES;

CREATE PROJECTION reporting.quota_b0 /*+basename(quota),createtype(L)*/ 
(
 territory_id,
 sales_force_id,
 product_id,
 time_period,
 quota_strength_unit,
 quota_quantity,
 quota_dollars
)
AS
 SELECT quota.territory_id,
        quota.sales_force_id,
        quota.product_id,
        quota.time_period,
        quota.quota_strength_unit,
        quota.quota_quantity,
        quota.quota_dollars
 FROM reporting.quota
 ORDER BY quota.time_period
SEGMENTED BY hash(quota.territory_id, quota.product_id, quota.time_period) ALL NODES;

CREATE PROJECTION reporting.temp_payer_prescriber_summary_b0 /*+basename(temp_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 time_period,
 period_type,
 period,
 month_bucket,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 tvcmid,
 prescriber_name,
 pdrp_flag,
 address,
 method_of_payment,
 specialty,
 segment,
 decile,
 product_vol_trx,
 market_vol_trx,
 prev_prod_vol_trx,
 prev_market_vol_trx,
 product_vol_nrx,
 market_vol_nrx,
 prev_prod_vol_nrx,
 prev_market_vol_nrx,
 product_vol_trx_region,
 market_vol_trx_region,
 prev_prod_vol_trx_region,
 prev_market_vol_trx_region,
 product_vol_nrx_region,
 market_vol_nrx_region,
 prev_prod_vol_nrx_region,
 prev_market_vol_nrx_region,
 product_vol_trx_area,
 market_vol_trx_area,
 prev_prod_vol_trx_area,
 prev_market_vol_trx_area,
 product_vol_nrx_area,
 market_vol_nrx_area,
 prev_prod_vol_nrx_area,
 prev_market_vol_nrx_area,
 product_vol_trx_nation,
 market_vol_trx_nation,
 prev_prod_vol_trx_nation,
 prev_market_vol_trx_nation,
 product_vol_nrx_nation,
 market_vol_nrx_nation,
 prev_prod_vol_nrx_nation,
 prev_market_vol_nrx_nation
)
AS
 SELECT temp_payer_prescriber_summary.sales_force_id,
        temp_payer_prescriber_summary.nation,
        temp_payer_prescriber_summary.area_id,
        temp_payer_prescriber_summary.area,
        temp_payer_prescriber_summary.region_id,
        temp_payer_prescriber_summary.region,
        temp_payer_prescriber_summary.territory_id,
        temp_payer_prescriber_summary.territory,
        temp_payer_prescriber_summary.time_period,
        temp_payer_prescriber_summary.period_type,
        temp_payer_prescriber_summary.period,
        temp_payer_prescriber_summary.month_bucket,
        temp_payer_prescriber_summary.market_name,
        temp_payer_prescriber_summary.brand_id,
        temp_payer_prescriber_summary.brand_name,
        temp_payer_prescriber_summary.teva_product_flag,
        temp_payer_prescriber_summary.payer_id,
        temp_payer_prescriber_summary.payer_name,
        temp_payer_prescriber_summary.plan_id,
        temp_payer_prescriber_summary.plan_name,
        temp_payer_prescriber_summary.payer_plan_id,
        temp_payer_prescriber_summary.tvcmid,
        temp_payer_prescriber_summary.prescriber_name,
        temp_payer_prescriber_summary.pdrp_flag,
        temp_payer_prescriber_summary.address,
        temp_payer_prescriber_summary.method_of_payment,
        temp_payer_prescriber_summary.specialty,
        temp_payer_prescriber_summary.segment,
        temp_payer_prescriber_summary.decile,
        temp_payer_prescriber_summary.product_vol_trx,
        temp_payer_prescriber_summary.market_vol_trx,
        temp_payer_prescriber_summary.prev_prod_vol_trx,
        temp_payer_prescriber_summary.prev_market_vol_trx,
        temp_payer_prescriber_summary.product_vol_nrx,
        temp_payer_prescriber_summary.market_vol_nrx,
        temp_payer_prescriber_summary.prev_prod_vol_nrx,
        temp_payer_prescriber_summary.prev_market_vol_nrx,
        temp_payer_prescriber_summary.product_vol_trx_region,
        temp_payer_prescriber_summary.market_vol_trx_region,
        temp_payer_prescriber_summary.prev_prod_vol_trx_region,
        temp_payer_prescriber_summary.prev_market_vol_trx_region,
        temp_payer_prescriber_summary.product_vol_nrx_region,
        temp_payer_prescriber_summary.market_vol_nrx_region,
        temp_payer_prescriber_summary.prev_prod_vol_nrx_region,
        temp_payer_prescriber_summary.prev_market_vol_nrx_region,
        temp_payer_prescriber_summary.product_vol_trx_area,
        temp_payer_prescriber_summary.market_vol_trx_area,
        temp_payer_prescriber_summary.prev_prod_vol_trx_area,
        temp_payer_prescriber_summary.prev_market_vol_trx_area,
        temp_payer_prescriber_summary.product_vol_nrx_area,
        temp_payer_prescriber_summary.market_vol_nrx_area,
        temp_payer_prescriber_summary.prev_prod_vol_nrx_area,
        temp_payer_prescriber_summary.prev_market_vol_nrx_area,
        temp_payer_prescriber_summary.product_vol_trx_nation,
        temp_payer_prescriber_summary.market_vol_trx_nation,
        temp_payer_prescriber_summary.prev_prod_vol_trx_nation,
        temp_payer_prescriber_summary.prev_market_vol_trx_nation,
        temp_payer_prescriber_summary.product_vol_nrx_nation,
        temp_payer_prescriber_summary.market_vol_nrx_nation,
        temp_payer_prescriber_summary.prev_prod_vol_nrx_nation,
        temp_payer_prescriber_summary.prev_market_vol_nrx_nation
 FROM reporting.temp_payer_prescriber_summary
 ORDER BY temp_payer_prescriber_summary.sales_force_id,
          temp_payer_prescriber_summary.territory_id,
          temp_payer_prescriber_summary.tvcmid,
          temp_payer_prescriber_summary.market_name,
          temp_payer_prescriber_summary.brand_name,
          temp_payer_prescriber_summary.month_bucket,
          temp_payer_prescriber_summary.payer_name,
          temp_payer_prescriber_summary.plan_name
SEGMENTED BY hash(temp_payer_prescriber_summary.sales_force_id, temp_payer_prescriber_summary.nation, temp_payer_prescriber_summary.time_period, temp_payer_prescriber_summary.month_bucket, temp_payer_prescriber_summary.brand_id, temp_payer_prescriber_summary.teva_product_flag, temp_payer_prescriber_summary.payer_id, temp_payer_prescriber_summary.plan_id, temp_payer_prescriber_summary.tvcmid, temp_payer_prescriber_summary.pdrp_flag, temp_payer_prescriber_summary.area_id, temp_payer_prescriber_summary.region_id, temp_payer_prescriber_summary.territory_id, temp_payer_prescriber_summary.period_type, temp_payer_prescriber_summary.payer_plan_id, temp_payer_prescriber_summary.product_vol_trx, temp_payer_prescriber_summary.market_vol_trx, temp_payer_prescriber_summary.prev_prod_vol_trx, temp_payer_prescriber_summary.prev_market_vol_trx, temp_payer_prescriber_summary.product_vol_nrx, temp_payer_prescriber_summary.market_vol_nrx, temp_payer_prescriber_summary.prev_prod_vol_nrx, temp_payer_prescriber_summary.prev_market_vol_nrx, temp_payer_prescriber_summary.product_vol_trx_region, temp_payer_prescriber_summary.market_vol_trx_region, temp_payer_prescriber_summary.prev_prod_vol_trx_region, temp_payer_prescriber_summary.prev_market_vol_trx_region, temp_payer_prescriber_summary.product_vol_nrx_region, temp_payer_prescriber_summary.market_vol_nrx_region, temp_payer_prescriber_summary.prev_prod_vol_nrx_region, temp_payer_prescriber_summary.prev_market_vol_nrx_region, temp_payer_prescriber_summary.product_vol_trx_area) ALL NODES;

CREATE PROJECTION reporting.tntp_filter_table_b0 /*+basename(tntp_filter_table),createtype(A)*/ 
(
 sales_force_id,
 sales_force_name,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 user_ids
)
AS
 SELECT tntp_filter_table.sales_force_id,
        tntp_filter_table.sales_force_name,
        tntp_filter_table.area_id,
        tntp_filter_table.area_name,
        tntp_filter_table.region_id,
        tntp_filter_table.region_name,
        tntp_filter_table.territory_id,
        tntp_filter_table.territory_name,
        tntp_filter_table.user_ids
 FROM reporting.tntp_filter_table
 ORDER BY tntp_filter_table.territory_id
SEGMENTED BY hash(tntp_filter_table.territory_id) ALL NODES;

CREATE PROJECTION reporting.to_monthly_geography_summary_b0 /*+basename(to_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 segment,
 target,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 syncare_flag,
 channel,
 market_volume_indicator,
 call_goals,
 new_accounts,
 accounts_ordering,
 avg_sales_per_account,
 prev_accounts_ordering,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 accounts_detailed_count,
 total_accounts_count
)
AS
 SELECT to_monthly_geography_summary.sales_force_id,
        to_monthly_geography_summary.geography_level,
        to_monthly_geography_summary.geography_id,
        to_monthly_geography_summary.geography,
        to_monthly_geography_summary.rep_name,
        to_monthly_geography_summary.user_id,
        to_monthly_geography_summary.time_period,
        to_monthly_geography_summary.period_type,
        to_monthly_geography_summary.period,
        to_monthly_geography_summary.segment,
        to_monthly_geography_summary.target,
        to_monthly_geography_summary.market_id,
        to_monthly_geography_summary.market_name,
        to_monthly_geography_summary.brand_id,
        to_monthly_geography_summary.brand_name,
        to_monthly_geography_summary.teva_product_flag,
        to_monthly_geography_summary.syncare_flag,
        to_monthly_geography_summary.channel,
        to_monthly_geography_summary.market_volume_indicator,
        to_monthly_geography_summary.call_goals,
        to_monthly_geography_summary.new_accounts,
        to_monthly_geography_summary.accounts_ordering,
        to_monthly_geography_summary.avg_sales_per_account,
        to_monthly_geography_summary.prev_accounts_ordering,
        to_monthly_geography_summary.product_vol_dollars,
        to_monthly_geography_summary.product_vol_mg,
        to_monthly_geography_summary.product_vol_mcg,
        to_monthly_geography_summary.market_vol_dollars,
        to_monthly_geography_summary.market_vol_mg,
        to_monthly_geography_summary.market_vol_mcg,
        to_monthly_geography_summary.prev_prod_vol_dollars,
        to_monthly_geography_summary.prev_prod_vol_mg,
        to_monthly_geography_summary.prev_prod_vol_mcg,
        to_monthly_geography_summary.prev_market_vol_dollars,
        to_monthly_geography_summary.prev_market_vol_mg,
        to_monthly_geography_summary.prev_market_vol_mcg,
        to_monthly_geography_summary.details_p1,
        to_monthly_geography_summary.details_p2,
        to_monthly_geography_summary.details_p3,
        to_monthly_geography_summary.total_details,
        to_monthly_geography_summary.accounts_detailed_count,
        to_monthly_geography_summary.total_accounts_count
 FROM reporting.to_monthly_geography_summary
 ORDER BY to_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(to_monthly_geography_summary.sales_force_id, to_monthly_geography_summary.market_id, to_monthly_geography_summary.brand_id, to_monthly_geography_summary.teva_product_flag, to_monthly_geography_summary.syncare_flag, to_monthly_geography_summary.market_volume_indicator, to_monthly_geography_summary.call_goals, to_monthly_geography_summary.new_accounts) ALL NODES;

CREATE PROJECTION reporting.tn_monthly_geography_summary_b0 /*+basename(tn_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT tn_monthly_geography_summary.sales_force_id,
        tn_monthly_geography_summary.geography_level,
        tn_monthly_geography_summary.geography_id,
        tn_monthly_geography_summary.geography,
        tn_monthly_geography_summary.rep_name,
        tn_monthly_geography_summary.user_id,
        tn_monthly_geography_summary.time_period,
        tn_monthly_geography_summary.period_type,
        tn_monthly_geography_summary.period,
        tn_monthly_geography_summary.market_id,
        tn_monthly_geography_summary.market_name,
        tn_monthly_geography_summary.brand_id,
        tn_monthly_geography_summary.brand_name,
        tn_monthly_geography_summary.teva_product_flag,
        tn_monthly_geography_summary.target_status_flag,
        tn_monthly_geography_summary.method_of_payment,
        tn_monthly_geography_summary.specialty,
        tn_monthly_geography_summary.segment,
        tn_monthly_geography_summary.market_volume_indicator,
        tn_monthly_geography_summary.product_vol_trx_count,
        tn_monthly_geography_summary.product_vol_new_pres_trx_count,
        tn_monthly_geography_summary.market_vol_trx_count,
        tn_monthly_geography_summary.prev_prod_vol_trx_count,
        tn_monthly_geography_summary.prev_market_vol_trx_count,
        tn_monthly_geography_summary.product_vol_nrx_count,
        tn_monthly_geography_summary.product_vol_new_pres_nrx_count,
        tn_monthly_geography_summary.market_vol_nrx_count,
        tn_monthly_geography_summary.prev_prod_vol_nrx_count,
        tn_monthly_geography_summary.prev_market_vol_nrx_count,
        tn_monthly_geography_summary.prescribers_count,
        tn_monthly_geography_summary.new_prescribers_count,
        tn_monthly_geography_summary.decile
 FROM reporting.tn_monthly_geography_summary
 ORDER BY tn_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(tn_monthly_geography_summary.sales_force_id, tn_monthly_geography_summary.market_id, tn_monthly_geography_summary.brand_id, tn_monthly_geography_summary.teva_product_flag, tn_monthly_geography_summary.target_status_flag, tn_monthly_geography_summary.market_volume_indicator, tn_monthly_geography_summary.prescribers_count, tn_monthly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.customer_attributes_b0 /*+basename(customer_attributes),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 sales_force_id,
 product_id,
 attribute_type,
 attribute_value,
 attribute_effective_start_date,
 attribute_effective_end_date
)
AS
 SELECT customer_attributes.customer_id,
        customer_attributes.tvcmid,
        customer_attributes.sales_force_id,
        customer_attributes.product_id,
        customer_attributes.attribute_type,
        customer_attributes.attribute_value,
        customer_attributes.attribute_effective_start_date,
        customer_attributes.attribute_effective_end_date
 FROM reporting.customer_attributes
 ORDER BY customer_attributes.customer_id,
          customer_attributes.tvcmid,
          customer_attributes.sales_force_id
SEGMENTED BY hash(customer_attributes.tvcmid, customer_attributes.sales_force_id, customer_attributes.product_id, customer_attributes.attribute_effective_start_date, customer_attributes.attribute_effective_end_date, customer_attributes.customer_id, customer_attributes.attribute_type, customer_attributes.attribute_value) ALL NODES;

CREATE PROJECTION reporting.customer_address_b0 /*+basename(customer_address),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 address_1,
 address_2,
 city,
 state,
 zip,
 alignment_zip,
 sales_force_id,
 territory_id,
 territory_name,
 base_flag,
 region_id,
 region_name,
 area_id,
 area_name,
 territory_count,
 region_count,
 area_count,
 sales_force_count
)
AS
 SELECT customer_address.customer_id,
        customer_address.tvcmid,
        customer_address.ims_id,
        customer_address.address_1,
        customer_address.address_2,
        customer_address.city,
        customer_address.state,
        customer_address.zip,
        customer_address.alignment_zip,
        customer_address.sales_force_id,
        customer_address.territory_id,
        customer_address.territory_name,
        customer_address.base_flag,
        customer_address.region_id,
        customer_address.region_name,
        customer_address.area_id,
        customer_address.area_name,
        customer_address.territory_count,
        customer_address.region_count,
        customer_address.area_count,
        customer_address.sales_force_count
 FROM reporting.customer_address
 ORDER BY customer_address.customer_id,
          customer_address.territory_id
SEGMENTED BY hash(customer_address.customer_id, customer_address.territory_id) ALL NODES;

CREATE PROJECTION reporting.activity_plan_b0 /*+basename(activity_plan),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 product_id,
 sales_force_id,
 territory_id,
 time_period,
 planned_p1_calls,
 planned_p2_calls,
 planned_p3_calls,
 planned_samples,
 target_status_flag
)
AS
 SELECT activity_plan.customer_id,
        activity_plan.tvcmid,
        activity_plan.product_id,
        activity_plan.sales_force_id,
        activity_plan.territory_id,
        activity_plan.time_period,
        activity_plan.planned_p1_calls,
        activity_plan.planned_p2_calls,
        activity_plan.planned_p3_calls,
        activity_plan.planned_samples,
        activity_plan.target_status_flag
 FROM reporting.activity_plan
 ORDER BY activity_plan.customer_id,
          activity_plan.tvcmid,
          activity_plan.product_id,
          activity_plan.sales_force_id,
          activity_plan.territory_id,
          activity_plan.time_period,
          activity_plan.planned_p1_calls,
          activity_plan.planned_p2_calls
SEGMENTED BY hash(activity_plan.tvcmid, activity_plan.product_id, activity_plan.sales_force_id, activity_plan.territory_id, activity_plan.planned_p1_calls, activity_plan.planned_p2_calls, activity_plan.planned_p3_calls, activity_plan.planned_samples) ALL NODES;

CREATE PROJECTION reporting.monthly_account_sales_b0 /*+basename(monthly_account_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 month,
 month_bucket,
 data_source,
 subcat_code,
 channel,
 trx_count,
 nrx_count,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 mcgs,
 mgs,
 new_account
)
AS
 SELECT monthly_account_sales.customer_id,
        monthly_account_sales.tvcmid,
        monthly_account_sales.ims_id,
        monthly_account_sales.product_id,
        monthly_account_sales.month,
        monthly_account_sales.month_bucket,
        monthly_account_sales.data_source,
        monthly_account_sales.subcat_code,
        monthly_account_sales.channel,
        monthly_account_sales.trx_count,
        monthly_account_sales.nrx_count,
        monthly_account_sales.trx_units,
        monthly_account_sales.nrx_units,
        monthly_account_sales.trx_dollars,
        monthly_account_sales.nrx_dollars,
        monthly_account_sales.mcgs,
        monthly_account_sales.mgs,
        monthly_account_sales.new_account
 FROM reporting.monthly_account_sales
 ORDER BY monthly_account_sales.customer_id,
          monthly_account_sales.tvcmid,
          monthly_account_sales.ims_id
SEGMENTED BY hash(monthly_account_sales.tvcmid, monthly_account_sales.product_id, monthly_account_sales.month, monthly_account_sales.month_bucket, monthly_account_sales.subcat_code, monthly_account_sales.trx_count, monthly_account_sales.nrx_count, monthly_account_sales.trx_units) ALL NODES;

CREATE PROJECTION reporting.syncare_dispensed_weekly_b0 /*+basename(syncare_dispensed_weekly),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 npi,
 product_id,
 patient_id,
 week,
 units,
 dollars,
 copay,
 copay_vs_wac
)
AS
 SELECT syncare_dispensed_weekly.customer_id,
        syncare_dispensed_weekly.tvcmid,
        syncare_dispensed_weekly.npi,
        syncare_dispensed_weekly.product_id,
        syncare_dispensed_weekly.patient_id,
        syncare_dispensed_weekly.week,
        syncare_dispensed_weekly.units,
        syncare_dispensed_weekly.dollars,
        syncare_dispensed_weekly.copay,
        syncare_dispensed_weekly.copay_vs_wac
 FROM reporting.syncare_dispensed_weekly
 ORDER BY syncare_dispensed_weekly.customer_id,
          syncare_dispensed_weekly.tvcmid,
          syncare_dispensed_weekly.npi,
          syncare_dispensed_weekly.product_id,
          syncare_dispensed_weekly.patient_id
SEGMENTED BY hash(syncare_dispensed_weekly.tvcmid, syncare_dispensed_weekly.product_id, syncare_dispensed_weekly.patient_id, syncare_dispensed_weekly.week) ALL NODES;

CREATE PROJECTION reporting.syncare_dispensed_monthly_b0 /*+basename(syncare_dispensed_monthly),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 npi,
 product_id,
 patient_id,
 month,
 units,
 dollars,
 copay,
 copay_vs_wac
)
AS
 SELECT syncare_dispensed_monthly.customer_id,
        syncare_dispensed_monthly.tvcmid,
        syncare_dispensed_monthly.npi,
        syncare_dispensed_monthly.product_id,
        syncare_dispensed_monthly.patient_id,
        syncare_dispensed_monthly.month,
        syncare_dispensed_monthly.units,
        syncare_dispensed_monthly.dollars,
        syncare_dispensed_monthly.copay,
        syncare_dispensed_monthly.copay_vs_wac
 FROM reporting.syncare_dispensed_monthly
 ORDER BY syncare_dispensed_monthly.customer_id,
          syncare_dispensed_monthly.tvcmid,
          syncare_dispensed_monthly.npi,
          syncare_dispensed_monthly.product_id,
          syncare_dispensed_monthly.patient_id,
          syncare_dispensed_monthly.month
SEGMENTED BY hash(syncare_dispensed_monthly.tvcmid, syncare_dispensed_monthly.product_id, syncare_dispensed_monthly.patient_id, syncare_dispensed_monthly.month) ALL NODES;

CREATE PROJECTION reporting.syncare_events_b0 /*+basename(syncare_events),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 npi,
 patient_id,
 product_id,
 event_date,
 enrollment_flag,
 recent_cml,
 insurance,
 physician_first_name,
 physician_last_name,
 physician_address,
 physician_city,
 physician_state,
 physician_zip
)
AS
 SELECT syncare_events.customer_id,
        syncare_events.tvcmid,
        syncare_events.npi,
        syncare_events.patient_id,
        syncare_events.product_id,
        syncare_events.event_date,
        syncare_events.enrollment_flag,
        syncare_events.recent_cml,
        syncare_events.insurance,
        syncare_events.physician_first_name,
        syncare_events.physician_last_name,
        syncare_events.physician_address,
        syncare_events.physician_city,
        syncare_events.physician_state,
        syncare_events.physician_zip
 FROM reporting.syncare_events
 ORDER BY syncare_events.customer_id,
          syncare_events.tvcmid,
          syncare_events.npi,
          syncare_events.patient_id,
          syncare_events.product_id,
          syncare_events.event_date,
          syncare_events.enrollment_flag,
          syncare_events.recent_cml
SEGMENTED BY hash(syncare_events.tvcmid) ALL NODES;

CREATE PROJECTION reporting.to_weekly_account_summary_b0 /*+basename(to_weekly_account_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 target,
 new_account,
 market_volume_indicator,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg
)
AS
 SELECT to_weekly_account_summary.sales_force_id,
        to_weekly_account_summary.nation_id,
        to_weekly_account_summary.nation,
        to_weekly_account_summary.area_id,
        to_weekly_account_summary.area,
        to_weekly_account_summary.region_id,
        to_weekly_account_summary.region,
        to_weekly_account_summary.territory_id,
        to_weekly_account_summary.territory,
        to_weekly_account_summary.rep_name,
        to_weekly_account_summary.user_id,
        to_weekly_account_summary.time_period,
        to_weekly_account_summary.period_type,
        to_weekly_account_summary.period,
        to_weekly_account_summary.market_id,
        to_weekly_account_summary.market_name,
        to_weekly_account_summary.brand_id,
        to_weekly_account_summary.brand_name,
        to_weekly_account_summary.teva_product_flag,
        to_weekly_account_summary.customer_id,
        to_weekly_account_summary.tvcmid,
        to_weekly_account_summary.network_name,
        to_weekly_account_summary.account_name,
        to_weekly_account_summary.channel,
        to_weekly_account_summary.address,
        to_weekly_account_summary.city,
        to_weekly_account_summary.state,
        to_weekly_account_summary.zip,
        to_weekly_account_summary.formulary_control,
        to_weekly_account_summary.gpo,
        to_weekly_account_summary.target,
        to_weekly_account_summary.new_account,
        to_weekly_account_summary.market_volume_indicator,
        to_weekly_account_summary.product_vol_dollars,
        to_weekly_account_summary.product_vol_mg,
        to_weekly_account_summary.product_vol_mcg,
        to_weekly_account_summary.market_vol_dollars,
        to_weekly_account_summary.market_vol_mg,
        to_weekly_account_summary.market_vol_mcg,
        to_weekly_account_summary.prev_prod_vol_dollars,
        to_weekly_account_summary.prev_prod_vol_mg,
        to_weekly_account_summary.prev_prod_vol_mcg,
        to_weekly_account_summary.prev_market_vol_dollars,
        to_weekly_account_summary.prev_market_vol_mg,
        to_weekly_account_summary.prev_market_vol_mcg
 FROM reporting.to_weekly_account_summary
 ORDER BY to_weekly_account_summary.sales_force_id,
          to_weekly_account_summary.nation_id,
          to_weekly_account_summary.nation,
          to_weekly_account_summary.area_id,
          to_weekly_account_summary.area,
          to_weekly_account_summary.region_id,
          to_weekly_account_summary.region,
          to_weekly_account_summary.territory_id
SEGMENTED BY hash(to_weekly_account_summary.sales_force_id, to_weekly_account_summary.market_id, to_weekly_account_summary.brand_id, to_weekly_account_summary.teva_product_flag, to_weekly_account_summary.tvcmid, to_weekly_account_summary.state, to_weekly_account_summary.zip, to_weekly_account_summary.new_account) ALL NODES;

CREATE PROJECTION reporting.to_syncare_b0 /*+basename(to_syncare),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area_name,
 region_id,
 region_name,
 territory_id,
 territory_name,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 patient_id,
 customer_id,
 tvcmid,
 physician_first_name,
 physician_last_name,
 physician_address,
 physician_city,
 physician_state,
 physician_zip,
 recent_cml,
 insurance
)
AS
 SELECT to_syncare.sales_force_id,
        to_syncare.nation_id,
        to_syncare.nation,
        to_syncare.area_id,
        to_syncare.area_name,
        to_syncare.region_id,
        to_syncare.region_name,
        to_syncare.territory_id,
        to_syncare.territory_name,
        to_syncare.rep_name,
        to_syncare.user_id,
        to_syncare.time_period,
        to_syncare.period_type,
        to_syncare.period,
        to_syncare.patient_id,
        to_syncare.customer_id,
        to_syncare.tvcmid,
        to_syncare.physician_first_name,
        to_syncare.physician_last_name,
        to_syncare.physician_address,
        to_syncare.physician_city,
        to_syncare.physician_state,
        to_syncare.physician_zip,
        to_syncare.recent_cml,
        to_syncare.insurance
 FROM reporting.to_syncare
 ORDER BY to_syncare.sales_force_id,
          to_syncare.nation_id,
          to_syncare.nation,
          to_syncare.area_id,
          to_syncare.area_name,
          to_syncare.region_id,
          to_syncare.region_name,
          to_syncare.territory_id
SEGMENTED BY hash(to_syncare.tvcmid) ALL NODES;

CREATE PROJECTION reporting.to_monthly_prescriber_summary_b0 /*+basename(to_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 physician_first_name,
 physician_last_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 new_prescriber,
 specialty,
 specialty_group,
 method_of_payment,
 product_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_trx_count,
 prev_prod_vol_nrx_count
)
AS
 SELECT to_monthly_prescriber_summary.sales_force_id,
        to_monthly_prescriber_summary.nation_id,
        to_monthly_prescriber_summary.nation,
        to_monthly_prescriber_summary.area_id,
        to_monthly_prescriber_summary.area,
        to_monthly_prescriber_summary.region_id,
        to_monthly_prescriber_summary.region,
        to_monthly_prescriber_summary.territory_id,
        to_monthly_prescriber_summary.territory,
        to_monthly_prescriber_summary.rep_name,
        to_monthly_prescriber_summary.user_id,
        to_monthly_prescriber_summary.time_period,
        to_monthly_prescriber_summary.period_type,
        to_monthly_prescriber_summary.period,
        to_monthly_prescriber_summary.market_id,
        to_monthly_prescriber_summary.market_name,
        to_monthly_prescriber_summary.brand_id,
        to_monthly_prescriber_summary.brand_name,
        to_monthly_prescriber_summary.teva_product_flag,
        to_monthly_prescriber_summary.customer_id,
        to_monthly_prescriber_summary.tvcmid,
        to_monthly_prescriber_summary.physician_first_name,
        to_monthly_prescriber_summary.physician_last_name,
        to_monthly_prescriber_summary.pdrp_flag,
        to_monthly_prescriber_summary.hcp_restriction_flag,
        to_monthly_prescriber_summary.address,
        to_monthly_prescriber_summary.city,
        to_monthly_prescriber_summary.state,
        to_monthly_prescriber_summary.zip,
        to_monthly_prescriber_summary.new_prescriber,
        to_monthly_prescriber_summary.specialty,
        to_monthly_prescriber_summary.specialty_group,
        to_monthly_prescriber_summary.method_of_payment,
        to_monthly_prescriber_summary.product_vol_trx_count,
        to_monthly_prescriber_summary.product_vol_nrx_count,
        to_monthly_prescriber_summary.prev_prod_vol_trx_count,
        to_monthly_prescriber_summary.prev_prod_vol_nrx_count
 FROM reporting.to_monthly_prescriber_summary
 ORDER BY to_monthly_prescriber_summary.sales_force_id,
          to_monthly_prescriber_summary.nation_id,
          to_monthly_prescriber_summary.nation,
          to_monthly_prescriber_summary.area_id,
          to_monthly_prescriber_summary.area,
          to_monthly_prescriber_summary.region_id,
          to_monthly_prescriber_summary.region,
          to_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(to_monthly_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.weekly_prescriber_sales_b0 /*+basename(weekly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 week_ending,
 week_bucket,
 data_source,
 channel,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT weekly_prescriber_sales.customer_id,
        weekly_prescriber_sales.tvcmid,
        weekly_prescriber_sales.ims_id,
        weekly_prescriber_sales.product_id,
        weekly_prescriber_sales.payer_plan_id,
        weekly_prescriber_sales.week_ending,
        weekly_prescriber_sales.week_bucket,
        weekly_prescriber_sales.data_source,
        weekly_prescriber_sales.channel,
        weekly_prescriber_sales.method_of_payment,
        weekly_prescriber_sales.trx,
        weekly_prescriber_sales.nrx,
        weekly_prescriber_sales.trx_units,
        weekly_prescriber_sales.nrx_units,
        weekly_prescriber_sales.trx_dollars,
        weekly_prescriber_sales.nrx_dollars,
        weekly_prescriber_sales.new_prescriber
 FROM reporting.weekly_prescriber_sales
 ORDER BY weekly_prescriber_sales.customer_id,
          weekly_prescriber_sales.tvcmid,
          weekly_prescriber_sales.ims_id
SEGMENTED BY hash(weekly_prescriber_sales.tvcmid, weekly_prescriber_sales.product_id, weekly_prescriber_sales.week_ending, weekly_prescriber_sales.week_bucket, weekly_prescriber_sales.trx, weekly_prescriber_sales.nrx, weekly_prescriber_sales.trx_units, weekly_prescriber_sales.nrx_units) ALL NODES;

CREATE PROJECTION reporting.weekly_prescriber_sales_summary_b0 /*+basename(weekly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 week_ending,
 week_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT weekly_prescriber_sales_summary.sales_force_id,
        weekly_prescriber_sales_summary.customer_id,
        weekly_prescriber_sales_summary.tvcmid,
        weekly_prescriber_sales_summary.ims_id,
        weekly_prescriber_sales_summary.period_type,
        weekly_prescriber_sales_summary.period,
        weekly_prescriber_sales_summary.week_ending,
        weekly_prescriber_sales_summary.week_bucket,
        weekly_prescriber_sales_summary.market_id,
        weekly_prescriber_sales_summary.brand_id,
        weekly_prescriber_sales_summary.payer_id,
        weekly_prescriber_sales_summary.payer_plan_id,
        weekly_prescriber_sales_summary.method_of_payment,
        weekly_prescriber_sales_summary.hcp_payer_vol_rank,
        weekly_prescriber_sales_summary.hcp_plan_vol_rank,
        weekly_prescriber_sales_summary.product_vol_trx_count,
        weekly_prescriber_sales_summary.prev_prod_vol_trx_count,
        weekly_prescriber_sales_summary.product_vol_nrx_count,
        weekly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        weekly_prescriber_sales_summary.market_vol_trx_count,
        weekly_prescriber_sales_summary.prev_market_vol_trx_count,
        weekly_prescriber_sales_summary.market_vol_nrx_count,
        weekly_prescriber_sales_summary.prev_market_vol_nrx_count,
        weekly_prescriber_sales_summary.samples,
        weekly_prescriber_sales_summary.details_p1,
        weekly_prescriber_sales_summary.details_p2,
        weekly_prescriber_sales_summary.details_p3
 FROM reporting.weekly_prescriber_sales_summary
 ORDER BY weekly_prescriber_sales_summary.sales_force_id,
          weekly_prescriber_sales_summary.customer_id,
          weekly_prescriber_sales_summary.tvcmid,
          weekly_prescriber_sales_summary.ims_id,
          weekly_prescriber_sales_summary.week_ending,
          weekly_prescriber_sales_summary.week_bucket,
          weekly_prescriber_sales_summary.market_id,
          weekly_prescriber_sales_summary.brand_id,
          weekly_prescriber_sales_summary.payer_plan_id,
          weekly_prescriber_sales_summary.method_of_payment
SEGMENTED BY hash(weekly_prescriber_sales_summary.sales_force_id, weekly_prescriber_sales_summary.customer_id, weekly_prescriber_sales_summary.tvcmid, weekly_prescriber_sales_summary.ims_id, weekly_prescriber_sales_summary.week_ending, weekly_prescriber_sales_summary.week_bucket, weekly_prescriber_sales_summary.market_id, weekly_prescriber_sales_summary.brand_id, weekly_prescriber_sales_summary.payer_plan_id, weekly_prescriber_sales_summary.method_of_payment) ALL NODES;

CREATE PROJECTION reporting.sp_weekly_payer_prescriber_summary_b0 /*+basename(sp_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT sp_weekly_payer_prescriber_summary.sales_force_id,
        sp_weekly_payer_prescriber_summary.nation_id,
        sp_weekly_payer_prescriber_summary.nation,
        sp_weekly_payer_prescriber_summary.area_id,
        sp_weekly_payer_prescriber_summary.area,
        sp_weekly_payer_prescriber_summary.region_id,
        sp_weekly_payer_prescriber_summary.region,
        sp_weekly_payer_prescriber_summary.territory_id,
        sp_weekly_payer_prescriber_summary.territory,
        sp_weekly_payer_prescriber_summary.rep_name,
        sp_weekly_payer_prescriber_summary.user_id,
        sp_weekly_payer_prescriber_summary.time_period,
        sp_weekly_payer_prescriber_summary.period_type,
        sp_weekly_payer_prescriber_summary.period,
        sp_weekly_payer_prescriber_summary.market_id,
        sp_weekly_payer_prescriber_summary.market_name,
        sp_weekly_payer_prescriber_summary.brand_id,
        sp_weekly_payer_prescriber_summary.brand_name,
        sp_weekly_payer_prescriber_summary.teva_product_flag,
        sp_weekly_payer_prescriber_summary.payer_id,
        sp_weekly_payer_prescriber_summary.payer_name,
        sp_weekly_payer_prescriber_summary.plan_id,
        sp_weekly_payer_prescriber_summary.plan_name,
        sp_weekly_payer_prescriber_summary.payer_plan_id,
        sp_weekly_payer_prescriber_summary.customer_id,
        sp_weekly_payer_prescriber_summary.tvcmid,
        sp_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        sp_weekly_payer_prescriber_summary.prescriber_name,
        sp_weekly_payer_prescriber_summary.pdrp_flag,
        sp_weekly_payer_prescriber_summary.hcp_restriction_flag,
        sp_weekly_payer_prescriber_summary.address,
        sp_weekly_payer_prescriber_summary.city,
        sp_weekly_payer_prescriber_summary.state,
        sp_weekly_payer_prescriber_summary.zip,
        sp_weekly_payer_prescriber_summary.target_status_flag,
        sp_weekly_payer_prescriber_summary.partner_target_status_flag,
        sp_weekly_payer_prescriber_summary.method_of_payment,
        sp_weekly_payer_prescriber_summary.specialty,
        sp_weekly_payer_prescriber_summary.segment,
        sp_weekly_payer_prescriber_summary.decile,
        sp_weekly_payer_prescriber_summary.market_volume_indicator,
        sp_weekly_payer_prescriber_summary.product_vol_trx_count,
        sp_weekly_payer_prescriber_summary.market_vol_trx_count,
        sp_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        sp_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        sp_weekly_payer_prescriber_summary.product_vol_nrx_count,
        sp_weekly_payer_prescriber_summary.market_vol_nrx_count,
        sp_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        sp_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        sp_weekly_payer_prescriber_summary.samples,
        sp_weekly_payer_prescriber_summary.details_p1,
        sp_weekly_payer_prescriber_summary.details_p2,
        sp_weekly_payer_prescriber_summary.details_p3,
        sp_weekly_payer_prescriber_summary.focus_target
 FROM reporting.sp_weekly_payer_prescriber_summary
 ORDER BY sp_weekly_payer_prescriber_summary.sales_force_id,
          sp_weekly_payer_prescriber_summary.nation_id,
          sp_weekly_payer_prescriber_summary.nation,
          sp_weekly_payer_prescriber_summary.area_id,
          sp_weekly_payer_prescriber_summary.area,
          sp_weekly_payer_prescriber_summary.region_id,
          sp_weekly_payer_prescriber_summary.region,
          sp_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(sp_weekly_payer_prescriber_summary.sales_force_id, sp_weekly_payer_prescriber_summary.market_id, sp_weekly_payer_prescriber_summary.brand_id, sp_weekly_payer_prescriber_summary.teva_product_flag, sp_weekly_payer_prescriber_summary.payer_id, sp_weekly_payer_prescriber_summary.plan_id, sp_weekly_payer_prescriber_summary.tvcmid, sp_weekly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.monthly_prescriber_sales_b0 /*+basename(monthly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 month_ending,
 month_bucket,
 data_source,
 channel,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT monthly_prescriber_sales.customer_id,
        monthly_prescriber_sales.tvcmid,
        monthly_prescriber_sales.ims_id,
        monthly_prescriber_sales.product_id,
        monthly_prescriber_sales.payer_plan_id,
        monthly_prescriber_sales.month_ending,
        monthly_prescriber_sales.month_bucket,
        monthly_prescriber_sales.data_source,
        monthly_prescriber_sales.channel,
        monthly_prescriber_sales.method_of_payment,
        monthly_prescriber_sales.trx,
        monthly_prescriber_sales.nrx,
        monthly_prescriber_sales.trx_units,
        monthly_prescriber_sales.nrx_units,
        monthly_prescriber_sales.trx_dollars,
        monthly_prescriber_sales.nrx_dollars,
        monthly_prescriber_sales.new_prescriber
 FROM reporting.monthly_prescriber_sales
 ORDER BY monthly_prescriber_sales.customer_id,
          monthly_prescriber_sales.tvcmid,
          monthly_prescriber_sales.ims_id,
          monthly_prescriber_sales.product_id,
          monthly_prescriber_sales.payer_plan_id,
          monthly_prescriber_sales.month_ending,
          monthly_prescriber_sales.month_bucket,
          monthly_prescriber_sales.data_source
SEGMENTED BY hash(monthly_prescriber_sales.tvcmid, monthly_prescriber_sales.product_id, monthly_prescriber_sales.month_ending, monthly_prescriber_sales.month_bucket, monthly_prescriber_sales.trx, monthly_prescriber_sales.nrx, monthly_prescriber_sales.trx_units, monthly_prescriber_sales.nrx_units) ALL NODES;

CREATE PROJECTION reporting.tp_monthly_prescriber_summary_b0 /*+basename(tp_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tp_monthly_prescriber_summary.sales_force_id,
        tp_monthly_prescriber_summary.nation_id,
        tp_monthly_prescriber_summary.nation,
        tp_monthly_prescriber_summary.area_id,
        tp_monthly_prescriber_summary.area,
        tp_monthly_prescriber_summary.region_id,
        tp_monthly_prescriber_summary.region,
        tp_monthly_prescriber_summary.territory_id,
        tp_monthly_prescriber_summary.territory,
        tp_monthly_prescriber_summary.rep_name,
        tp_monthly_prescriber_summary.user_id,
        tp_monthly_prescriber_summary.time_period,
        tp_monthly_prescriber_summary.period_type,
        tp_monthly_prescriber_summary.period,
        tp_monthly_prescriber_summary.market_id,
        tp_monthly_prescriber_summary.market_name,
        tp_monthly_prescriber_summary.brand_id,
        tp_monthly_prescriber_summary.brand_name,
        tp_monthly_prescriber_summary.teva_product_flag,
        tp_monthly_prescriber_summary.customer_id,
        tp_monthly_prescriber_summary.tvcmid,
        tp_monthly_prescriber_summary.pdrp_flag,
        tp_monthly_prescriber_summary.hcp_restriction_flag,
        tp_monthly_prescriber_summary.prescriber_name,
        tp_monthly_prescriber_summary.new_prescriber,
        tp_monthly_prescriber_summary.address,
        tp_monthly_prescriber_summary.city,
        tp_monthly_prescriber_summary.state,
        tp_monthly_prescriber_summary.zip,
        tp_monthly_prescriber_summary.target_status_flag,
        tp_monthly_prescriber_summary.partner_target_status_flag,
        tp_monthly_prescriber_summary.method_of_payment,
        tp_monthly_prescriber_summary.specialty,
        tp_monthly_prescriber_summary.segment,
        tp_monthly_prescriber_summary.decile,
        tp_monthly_prescriber_summary.market_volume_indicator,
        tp_monthly_prescriber_summary.product_vol_trx_count,
        tp_monthly_prescriber_summary.market_vol_trx_count,
        tp_monthly_prescriber_summary.prev_prod_vol_trx_count,
        tp_monthly_prescriber_summary.prev_market_vol_trx_count,
        tp_monthly_prescriber_summary.product_vol_nrx_count,
        tp_monthly_prescriber_summary.market_vol_nrx_count,
        tp_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        tp_monthly_prescriber_summary.prev_market_vol_nrx_count,
        tp_monthly_prescriber_summary.samples,
        tp_monthly_prescriber_summary.details_p1,
        tp_monthly_prescriber_summary.details_p2,
        tp_monthly_prescriber_summary.details_p3
 FROM reporting.tp_monthly_prescriber_summary
 ORDER BY tp_monthly_prescriber_summary.sales_force_id,
          tp_monthly_prescriber_summary.nation_id,
          tp_monthly_prescriber_summary.nation,
          tp_monthly_prescriber_summary.area_id,
          tp_monthly_prescriber_summary.area,
          tp_monthly_prescriber_summary.region_id,
          tp_monthly_prescriber_summary.region,
          tp_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(tp_monthly_prescriber_summary.sales_force_id, tp_monthly_prescriber_summary.market_id, tp_monthly_prescriber_summary.brand_id, tp_monthly_prescriber_summary.teva_product_flag, tp_monthly_prescriber_summary.tvcmid, tp_monthly_prescriber_summary.pdrp_flag, tp_monthly_prescriber_summary.hcp_restriction_flag, tp_monthly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.tp_monthly_payer_prescriber_summary_b0 /*+basename(tp_monthly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT tp_monthly_payer_prescriber_summary.sales_force_id,
        tp_monthly_payer_prescriber_summary.nation_id,
        tp_monthly_payer_prescriber_summary.nation,
        tp_monthly_payer_prescriber_summary.area_id,
        tp_monthly_payer_prescriber_summary.area,
        tp_monthly_payer_prescriber_summary.region_id,
        tp_monthly_payer_prescriber_summary.region,
        tp_monthly_payer_prescriber_summary.territory_id,
        tp_monthly_payer_prescriber_summary.territory,
        tp_monthly_payer_prescriber_summary.rep_name,
        tp_monthly_payer_prescriber_summary.user_id,
        tp_monthly_payer_prescriber_summary.time_period,
        tp_monthly_payer_prescriber_summary.period_type,
        tp_monthly_payer_prescriber_summary.period,
        tp_monthly_payer_prescriber_summary.market_id,
        tp_monthly_payer_prescriber_summary.market_name,
        tp_monthly_payer_prescriber_summary.brand_id,
        tp_monthly_payer_prescriber_summary.brand_name,
        tp_monthly_payer_prescriber_summary.teva_product_flag,
        tp_monthly_payer_prescriber_summary.payer_id,
        tp_monthly_payer_prescriber_summary.payer_name,
        tp_monthly_payer_prescriber_summary.plan_id,
        tp_monthly_payer_prescriber_summary.plan_name,
        tp_monthly_payer_prescriber_summary.payer_plan_id,
        tp_monthly_payer_prescriber_summary.customer_id,
        tp_monthly_payer_prescriber_summary.tvcmid,
        tp_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        tp_monthly_payer_prescriber_summary.prescriber_name,
        tp_monthly_payer_prescriber_summary.pdrp_flag,
        tp_monthly_payer_prescriber_summary.hcp_restriction_flag,
        tp_monthly_payer_prescriber_summary.address,
        tp_monthly_payer_prescriber_summary.city,
        tp_monthly_payer_prescriber_summary.state,
        tp_monthly_payer_prescriber_summary.zip,
        tp_monthly_payer_prescriber_summary.target_status_flag,
        tp_monthly_payer_prescriber_summary.partner_target_status_flag,
        tp_monthly_payer_prescriber_summary.method_of_payment,
        tp_monthly_payer_prescriber_summary.specialty,
        tp_monthly_payer_prescriber_summary.segment,
        tp_monthly_payer_prescriber_summary.decile,
        tp_monthly_payer_prescriber_summary.market_volume_indicator,
        tp_monthly_payer_prescriber_summary.product_vol_trx_count,
        tp_monthly_payer_prescriber_summary.market_vol_trx_count,
        tp_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        tp_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        tp_monthly_payer_prescriber_summary.product_vol_nrx_count,
        tp_monthly_payer_prescriber_summary.market_vol_nrx_count,
        tp_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        tp_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        tp_monthly_payer_prescriber_summary.samples,
        tp_monthly_payer_prescriber_summary.details_p1,
        tp_monthly_payer_prescriber_summary.details_p2,
        tp_monthly_payer_prescriber_summary.details_p3,
        tp_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        tp_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        tp_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        tp_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        tp_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        tp_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        tp_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        tp_monthly_payer_prescriber_summary.focus_target
 FROM reporting.tp_monthly_payer_prescriber_summary
 ORDER BY tp_monthly_payer_prescriber_summary.sales_force_id,
          tp_monthly_payer_prescriber_summary.nation_id,
          tp_monthly_payer_prescriber_summary.nation,
          tp_monthly_payer_prescriber_summary.area_id,
          tp_monthly_payer_prescriber_summary.area,
          tp_monthly_payer_prescriber_summary.region_id,
          tp_monthly_payer_prescriber_summary.region,
          tp_monthly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(tp_monthly_payer_prescriber_summary.sales_force_id, tp_monthly_payer_prescriber_summary.market_id, tp_monthly_payer_prescriber_summary.brand_id, tp_monthly_payer_prescriber_summary.teva_product_flag, tp_monthly_payer_prescriber_summary.payer_id, tp_monthly_payer_prescriber_summary.plan_id, tp_monthly_payer_prescriber_summary.tvcmid, tp_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tp_monthly_payer_geography_summary_b0 /*+basename(tp_monthly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count
)
AS
 SELECT tp_monthly_payer_geography_summary.sales_force_id,
        tp_monthly_payer_geography_summary.geography_level,
        tp_monthly_payer_geography_summary.geography_id,
        tp_monthly_payer_geography_summary.geography,
        tp_monthly_payer_geography_summary.rep_name,
        tp_monthly_payer_geography_summary.user_id,
        tp_monthly_payer_geography_summary.time_period,
        tp_monthly_payer_geography_summary.period_type,
        tp_monthly_payer_geography_summary.period,
        tp_monthly_payer_geography_summary.payer_id,
        tp_monthly_payer_geography_summary.payer_name,
        tp_monthly_payer_geography_summary.plan_id,
        tp_monthly_payer_geography_summary.plan_name,
        tp_monthly_payer_geography_summary.payer_plan_id,
        tp_monthly_payer_geography_summary.market_id,
        tp_monthly_payer_geography_summary.market_name,
        tp_monthly_payer_geography_summary.brand_id,
        tp_monthly_payer_geography_summary.brand_name,
        tp_monthly_payer_geography_summary.teva_product_flag,
        tp_monthly_payer_geography_summary.method_of_payment,
        tp_monthly_payer_geography_summary.market_volume_indicator,
        tp_monthly_payer_geography_summary.geo_plan_vol_rank,
        tp_monthly_payer_geography_summary.product_vol_trx_count,
        tp_monthly_payer_geography_summary.market_vol_trx_count,
        tp_monthly_payer_geography_summary.prev_prod_vol_trx_count,
        tp_monthly_payer_geography_summary.prev_market_vol_trx_count,
        tp_monthly_payer_geography_summary.product_vol_nrx_count,
        tp_monthly_payer_geography_summary.market_vol_nrx_count,
        tp_monthly_payer_geography_summary.prev_prod_vol_nrx_count,
        tp_monthly_payer_geography_summary.prev_market_vol_nrx_count,
        tp_monthly_payer_geography_summary.Nation_Product_TRx_Count,
        tp_monthly_payer_geography_summary.Nation_Product_NRx_Count,
        tp_monthly_payer_geography_summary.Nation_Market_TRx_Count,
        tp_monthly_payer_geography_summary.Nation_Market_NRx_Count
 FROM reporting.tp_monthly_payer_geography_summary
 ORDER BY tp_monthly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(tp_monthly_payer_geography_summary.sales_force_id, tp_monthly_payer_geography_summary.payer_id, tp_monthly_payer_geography_summary.plan_id, tp_monthly_payer_geography_summary.market_id, tp_monthly_payer_geography_summary.brand_id, tp_monthly_payer_geography_summary.teva_product_flag, tp_monthly_payer_geography_summary.market_volume_indicator, tp_monthly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.sp_monthly_prescriber_summary_b0 /*+basename(sp_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT sp_monthly_prescriber_summary.sales_force_id,
        sp_monthly_prescriber_summary.nation_id,
        sp_monthly_prescriber_summary.nation,
        sp_monthly_prescriber_summary.area_id,
        sp_monthly_prescriber_summary.area,
        sp_monthly_prescriber_summary.region_id,
        sp_monthly_prescriber_summary.region,
        sp_monthly_prescriber_summary.territory_id,
        sp_monthly_prescriber_summary.territory,
        sp_monthly_prescriber_summary.rep_name,
        sp_monthly_prescriber_summary.user_id,
        sp_monthly_prescriber_summary.time_period,
        sp_monthly_prescriber_summary.period_type,
        sp_monthly_prescriber_summary.period,
        sp_monthly_prescriber_summary.market_id,
        sp_monthly_prescriber_summary.market_name,
        sp_monthly_prescriber_summary.brand_id,
        sp_monthly_prescriber_summary.brand_name,
        sp_monthly_prescriber_summary.teva_product_flag,
        sp_monthly_prescriber_summary.customer_id,
        sp_monthly_prescriber_summary.tvcmid,
        sp_monthly_prescriber_summary.pdrp_flag,
        sp_monthly_prescriber_summary.hcp_restriction_flag,
        sp_monthly_prescriber_summary.prescriber_name,
        sp_monthly_prescriber_summary.new_prescriber,
        sp_monthly_prescriber_summary.address,
        sp_monthly_prescriber_summary.city,
        sp_monthly_prescriber_summary.state,
        sp_monthly_prescriber_summary.zip,
        sp_monthly_prescriber_summary.target_status_flag,
        sp_monthly_prescriber_summary.partner_target_status_flag,
        sp_monthly_prescriber_summary.method_of_payment,
        sp_monthly_prescriber_summary.specialty,
        sp_monthly_prescriber_summary.segment,
        sp_monthly_prescriber_summary.decile,
        sp_monthly_prescriber_summary.market_volume_indicator,
        sp_monthly_prescriber_summary.product_vol_trx_count,
        sp_monthly_prescriber_summary.market_vol_trx_count,
        sp_monthly_prescriber_summary.prev_prod_vol_trx_count,
        sp_monthly_prescriber_summary.prev_market_vol_trx_count,
        sp_monthly_prescriber_summary.product_vol_nrx_count,
        sp_monthly_prescriber_summary.market_vol_nrx_count,
        sp_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        sp_monthly_prescriber_summary.prev_market_vol_nrx_count,
        sp_monthly_prescriber_summary.samples,
        sp_monthly_prescriber_summary.details_p1,
        sp_monthly_prescriber_summary.details_p2,
        sp_monthly_prescriber_summary.details_p3
 FROM reporting.sp_monthly_prescriber_summary
 ORDER BY sp_monthly_prescriber_summary.customer_id
SEGMENTED BY hash(sp_monthly_prescriber_summary.customer_id, sp_monthly_prescriber_summary.sales_force_id) ALL NODES;

CREATE PROJECTION reporting.sp_monthly_payer_geography_summary_b0 /*+basename(sp_monthly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count
)
AS
 SELECT sp_monthly_payer_geography_summary.sales_force_id,
        sp_monthly_payer_geography_summary.geography_level,
        sp_monthly_payer_geography_summary.geography_id,
        sp_monthly_payer_geography_summary.geography,
        sp_monthly_payer_geography_summary.rep_name,
        sp_monthly_payer_geography_summary.user_id,
        sp_monthly_payer_geography_summary.time_period,
        sp_monthly_payer_geography_summary.period_type,
        sp_monthly_payer_geography_summary.period,
        sp_monthly_payer_geography_summary.payer_id,
        sp_monthly_payer_geography_summary.payer_name,
        sp_monthly_payer_geography_summary.plan_id,
        sp_monthly_payer_geography_summary.plan_name,
        sp_monthly_payer_geography_summary.payer_plan_id,
        sp_monthly_payer_geography_summary.market_id,
        sp_monthly_payer_geography_summary.market_name,
        sp_monthly_payer_geography_summary.brand_id,
        sp_monthly_payer_geography_summary.brand_name,
        sp_monthly_payer_geography_summary.teva_product_flag,
        sp_monthly_payer_geography_summary.method_of_payment,
        sp_monthly_payer_geography_summary.market_volume_indicator,
        sp_monthly_payer_geography_summary.geo_plan_vol_rank,
        sp_monthly_payer_geography_summary.product_vol_trx_count,
        sp_monthly_payer_geography_summary.market_vol_trx_count,
        sp_monthly_payer_geography_summary.prev_prod_vol_trx_count,
        sp_monthly_payer_geography_summary.prev_market_vol_trx_count,
        sp_monthly_payer_geography_summary.product_vol_nrx_count,
        sp_monthly_payer_geography_summary.market_vol_nrx_count,
        sp_monthly_payer_geography_summary.prev_prod_vol_nrx_count,
        sp_monthly_payer_geography_summary.prev_market_vol_nrx_count,
        sp_monthly_payer_geography_summary.Nation_Product_TRx_Count,
        sp_monthly_payer_geography_summary.Nation_Product_NRx_Count,
        sp_monthly_payer_geography_summary.Nation_Market_TRx_Count,
        sp_monthly_payer_geography_summary.Nation_Market_NRx_Count
 FROM reporting.sp_monthly_payer_geography_summary
 ORDER BY sp_monthly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(sp_monthly_payer_geography_summary.sales_force_id, sp_monthly_payer_geography_summary.payer_id, sp_monthly_payer_geography_summary.plan_id, sp_monthly_payer_geography_summary.market_id, sp_monthly_payer_geography_summary.brand_id, sp_monthly_payer_geography_summary.teva_product_flag, sp_monthly_payer_geography_summary.market_volume_indicator, sp_monthly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.sp_pre_call_summary_b0 /*+basename(sp_pre_call_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT sp_pre_call_summary.sales_force_id,
        sp_pre_call_summary.nation_id,
        sp_pre_call_summary.nation,
        sp_pre_call_summary.area_id,
        sp_pre_call_summary.area,
        sp_pre_call_summary.region_id,
        sp_pre_call_summary.region,
        sp_pre_call_summary.territory_id,
        sp_pre_call_summary.territory,
        sp_pre_call_summary.rep_name,
        sp_pre_call_summary.user_id,
        sp_pre_call_summary.time_period,
        sp_pre_call_summary.period_type,
        sp_pre_call_summary.period,
        sp_pre_call_summary.market_id,
        sp_pre_call_summary.market_name,
        sp_pre_call_summary.brand_id,
        sp_pre_call_summary.brand_name,
        sp_pre_call_summary.teva_product_flag,
        sp_pre_call_summary.payer_id,
        sp_pre_call_summary.payer_name,
        sp_pre_call_summary.plan_id,
        sp_pre_call_summary.plan_name,
        sp_pre_call_summary.payer_plan_id,
        sp_pre_call_summary.customer_id,
        sp_pre_call_summary.tvcmid,
        sp_pre_call_summary.hcp_plan_vol_rank,
        sp_pre_call_summary.prescriber_name,
        sp_pre_call_summary.pdrp_flag,
        sp_pre_call_summary.hcp_restriction_flag,
        sp_pre_call_summary.address,
        sp_pre_call_summary.city,
        sp_pre_call_summary.state,
        sp_pre_call_summary.zip,
        sp_pre_call_summary.target_status_flag,
        sp_pre_call_summary.partner_target_status_flag,
        sp_pre_call_summary.method_of_payment,
        sp_pre_call_summary.specialty,
        sp_pre_call_summary.segment,
        sp_pre_call_summary.decile,
        sp_pre_call_summary.market_volume_indicator,
        sp_pre_call_summary.product_vol_trx_count,
        sp_pre_call_summary.market_vol_trx_count,
        sp_pre_call_summary.prev_prod_vol_trx_count,
        sp_pre_call_summary.prev_market_vol_trx_count,
        sp_pre_call_summary.product_vol_nrx_count,
        sp_pre_call_summary.market_vol_nrx_count,
        sp_pre_call_summary.prev_prod_vol_nrx_count,
        sp_pre_call_summary.prev_market_vol_nrx_count,
        sp_pre_call_summary.samples,
        sp_pre_call_summary.details_p1,
        sp_pre_call_summary.details_p2,
        sp_pre_call_summary.details_p3,
        sp_pre_call_summary.focus_target
 FROM reporting.sp_pre_call_summary
 ORDER BY sp_pre_call_summary.sales_force_id,
          sp_pre_call_summary.nation_id,
          sp_pre_call_summary.nation,
          sp_pre_call_summary.area_id,
          sp_pre_call_summary.area,
          sp_pre_call_summary.region_id,
          sp_pre_call_summary.region,
          sp_pre_call_summary.territory_id
SEGMENTED BY hash(sp_pre_call_summary.sales_force_id, sp_pre_call_summary.market_id, sp_pre_call_summary.brand_id, sp_pre_call_summary.teva_product_flag, sp_pre_call_summary.payer_id, sp_pre_call_summary.plan_id, sp_pre_call_summary.tvcmid, sp_pre_call_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tn_pre_call_summary_b0 /*+basename(tn_pre_call_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target,
 AssistRx_flag,
 ShSol_flag
)
AS
 SELECT tn_pre_call_summary.sales_force_id,
        tn_pre_call_summary.nation_id,
        tn_pre_call_summary.nation,
        tn_pre_call_summary.area_id,
        tn_pre_call_summary.area,
        tn_pre_call_summary.region_id,
        tn_pre_call_summary.region,
        tn_pre_call_summary.territory_id,
        tn_pre_call_summary.territory,
        tn_pre_call_summary.rep_name,
        tn_pre_call_summary.user_id,
        tn_pre_call_summary.time_period,
        tn_pre_call_summary.period_type,
        tn_pre_call_summary.period,
        tn_pre_call_summary.market_id,
        tn_pre_call_summary.market_name,
        tn_pre_call_summary.brand_id,
        tn_pre_call_summary.brand_name,
        tn_pre_call_summary.teva_product_flag,
        tn_pre_call_summary.payer_id,
        tn_pre_call_summary.payer_name,
        tn_pre_call_summary.plan_id,
        tn_pre_call_summary.plan_name,
        tn_pre_call_summary.payer_plan_id,
        tn_pre_call_summary.customer_id,
        tn_pre_call_summary.tvcmid,
        tn_pre_call_summary.hcp_plan_vol_rank,
        tn_pre_call_summary.prescriber_name,
        tn_pre_call_summary.pdrp_flag,
        tn_pre_call_summary.hcp_restriction_flag,
        tn_pre_call_summary.address,
        tn_pre_call_summary.city,
        tn_pre_call_summary.state,
        tn_pre_call_summary.zip,
        tn_pre_call_summary.target_status_flag,
        tn_pre_call_summary.partner_target_status_flag,
        tn_pre_call_summary.method_of_payment,
        tn_pre_call_summary.specialty,
        tn_pre_call_summary.segment,
        tn_pre_call_summary.decile,
        tn_pre_call_summary.market_volume_indicator,
        tn_pre_call_summary.product_vol_trx_count,
        tn_pre_call_summary.market_vol_trx_count,
        tn_pre_call_summary.prev_prod_vol_trx_count,
        tn_pre_call_summary.prev_market_vol_trx_count,
        tn_pre_call_summary.product_vol_nrx_count,
        tn_pre_call_summary.market_vol_nrx_count,
        tn_pre_call_summary.prev_prod_vol_nrx_count,
        tn_pre_call_summary.prev_market_vol_nrx_count,
        tn_pre_call_summary.samples,
        tn_pre_call_summary.details_p1,
        tn_pre_call_summary.details_p2,
        tn_pre_call_summary.details_p3,
        tn_pre_call_summary.focus_target,
        tn_pre_call_summary.AssistRx_flag,
        tn_pre_call_summary.ShSol_flag
 FROM reporting.tn_pre_call_summary
 ORDER BY tn_pre_call_summary.sales_force_id,
          tn_pre_call_summary.nation_id,
          tn_pre_call_summary.nation,
          tn_pre_call_summary.area_id,
          tn_pre_call_summary.area,
          tn_pre_call_summary.region_id,
          tn_pre_call_summary.region,
          tn_pre_call_summary.territory_id
SEGMENTED BY hash(tn_pre_call_summary.sales_force_id, tn_pre_call_summary.market_id, tn_pre_call_summary.brand_id, tn_pre_call_summary.teva_product_flag, tn_pre_call_summary.payer_id, tn_pre_call_summary.plan_id, tn_pre_call_summary.tvcmid, tn_pre_call_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tp_pre_call_summary_b0 /*+basename(tp_pre_call_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 cogentine_decile_value,
 antipsych_decile_value,
 focus_target,
 titration_flag,
 AssistRx_flag,
 ShSol_flag
)
AS
 SELECT tp_pre_call_summary.sales_force_id,
        tp_pre_call_summary.nation_id,
        tp_pre_call_summary.nation,
        tp_pre_call_summary.area_id,
        tp_pre_call_summary.area,
        tp_pre_call_summary.region_id,
        tp_pre_call_summary.region,
        tp_pre_call_summary.territory_id,
        tp_pre_call_summary.territory,
        tp_pre_call_summary.rep_name,
        tp_pre_call_summary.user_id,
        tp_pre_call_summary.time_period,
        tp_pre_call_summary.period_type,
        tp_pre_call_summary.period,
        tp_pre_call_summary.market_id,
        tp_pre_call_summary.market_name,
        tp_pre_call_summary.brand_id,
        tp_pre_call_summary.brand_name,
        tp_pre_call_summary.teva_product_flag,
        tp_pre_call_summary.payer_id,
        tp_pre_call_summary.payer_name,
        tp_pre_call_summary.plan_id,
        tp_pre_call_summary.plan_name,
        tp_pre_call_summary.payer_plan_id,
        tp_pre_call_summary.customer_id,
        tp_pre_call_summary.tvcmid,
        tp_pre_call_summary.hcp_plan_vol_rank,
        tp_pre_call_summary.prescriber_name,
        tp_pre_call_summary.pdrp_flag,
        tp_pre_call_summary.hcp_restriction_flag,
        tp_pre_call_summary.address,
        tp_pre_call_summary.city,
        tp_pre_call_summary.state,
        tp_pre_call_summary.zip,
        tp_pre_call_summary.target_status_flag,
        tp_pre_call_summary.partner_target_status_flag,
        tp_pre_call_summary.method_of_payment,
        tp_pre_call_summary.specialty,
        tp_pre_call_summary.segment,
        tp_pre_call_summary.decile,
        tp_pre_call_summary.market_volume_indicator,
        tp_pre_call_summary.product_vol_trx_count,
        tp_pre_call_summary.market_vol_trx_count,
        tp_pre_call_summary.prev_prod_vol_trx_count,
        tp_pre_call_summary.prev_market_vol_trx_count,
        tp_pre_call_summary.product_vol_nrx_count,
        tp_pre_call_summary.market_vol_nrx_count,
        tp_pre_call_summary.prev_prod_vol_nrx_count,
        tp_pre_call_summary.prev_market_vol_nrx_count,
        tp_pre_call_summary.samples,
        tp_pre_call_summary.details_p1,
        tp_pre_call_summary.details_p2,
        tp_pre_call_summary.details_p3,
        tp_pre_call_summary.cogentine_decile_value,
        tp_pre_call_summary.antipsych_decile_value,
        tp_pre_call_summary.focus_target,
        tp_pre_call_summary.titration_flag,
        tp_pre_call_summary.AssistRx_flag,
        tp_pre_call_summary.ShSol_flag
 FROM reporting.tp_pre_call_summary
 ORDER BY tp_pre_call_summary.sales_force_id,
          tp_pre_call_summary.nation_id,
          tp_pre_call_summary.nation,
          tp_pre_call_summary.area_id,
          tp_pre_call_summary.area,
          tp_pre_call_summary.region_id,
          tp_pre_call_summary.region,
          tp_pre_call_summary.territory_id
SEGMENTED BY hash(tp_pre_call_summary.sales_force_id, tp_pre_call_summary.market_id, tp_pre_call_summary.brand_id, tp_pre_call_summary.teva_product_flag, tp_pre_call_summary.payer_id, tp_pre_call_summary.plan_id, tp_pre_call_summary.tvcmid, tp_pre_call_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.sp_pre_call_summary_submarket_b0 /*+basename(sp_pre_call_summary_submarket),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT sp_pre_call_summary_submarket.sales_force_id,
        sp_pre_call_summary_submarket.nation_id,
        sp_pre_call_summary_submarket.nation,
        sp_pre_call_summary_submarket.area_id,
        sp_pre_call_summary_submarket.area,
        sp_pre_call_summary_submarket.region_id,
        sp_pre_call_summary_submarket.region,
        sp_pre_call_summary_submarket.territory_id,
        sp_pre_call_summary_submarket.territory,
        sp_pre_call_summary_submarket.rep_name,
        sp_pre_call_summary_submarket.user_id,
        sp_pre_call_summary_submarket.time_period,
        sp_pre_call_summary_submarket.period_type,
        sp_pre_call_summary_submarket.period,
        sp_pre_call_summary_submarket.market_id,
        sp_pre_call_summary_submarket.market_name,
        sp_pre_call_summary_submarket.brand_id,
        sp_pre_call_summary_submarket.brand_name,
        sp_pre_call_summary_submarket.teva_product_flag,
        sp_pre_call_summary_submarket.payer_id,
        sp_pre_call_summary_submarket.payer_name,
        sp_pre_call_summary_submarket.plan_id,
        sp_pre_call_summary_submarket.plan_name,
        sp_pre_call_summary_submarket.payer_plan_id,
        sp_pre_call_summary_submarket.customer_id,
        sp_pre_call_summary_submarket.tvcmid,
        sp_pre_call_summary_submarket.hcp_plan_vol_rank,
        sp_pre_call_summary_submarket.prescriber_name,
        sp_pre_call_summary_submarket.pdrp_flag,
        sp_pre_call_summary_submarket.hcp_restriction_flag,
        sp_pre_call_summary_submarket.address,
        sp_pre_call_summary_submarket.city,
        sp_pre_call_summary_submarket.state,
        sp_pre_call_summary_submarket.zip,
        sp_pre_call_summary_submarket.target_status_flag,
        sp_pre_call_summary_submarket.partner_target_status_flag,
        sp_pre_call_summary_submarket.method_of_payment,
        sp_pre_call_summary_submarket.specialty,
        sp_pre_call_summary_submarket.segment,
        sp_pre_call_summary_submarket.decile,
        sp_pre_call_summary_submarket.market_volume_indicator,
        sp_pre_call_summary_submarket.product_vol_trx_count,
        sp_pre_call_summary_submarket.market_vol_trx_count,
        sp_pre_call_summary_submarket.prev_prod_vol_trx_count,
        sp_pre_call_summary_submarket.prev_market_vol_trx_count,
        sp_pre_call_summary_submarket.product_vol_nrx_count,
        sp_pre_call_summary_submarket.market_vol_nrx_count,
        sp_pre_call_summary_submarket.prev_prod_vol_nrx_count,
        sp_pre_call_summary_submarket.prev_market_vol_nrx_count,
        sp_pre_call_summary_submarket.samples,
        sp_pre_call_summary_submarket.details_p1,
        sp_pre_call_summary_submarket.details_p2,
        sp_pre_call_summary_submarket.details_p3
 FROM reporting.sp_pre_call_summary_submarket
 ORDER BY sp_pre_call_summary_submarket.sales_force_id,
          sp_pre_call_summary_submarket.nation_id,
          sp_pre_call_summary_submarket.nation,
          sp_pre_call_summary_submarket.area_id,
          sp_pre_call_summary_submarket.area,
          sp_pre_call_summary_submarket.region_id,
          sp_pre_call_summary_submarket.region,
          sp_pre_call_summary_submarket.territory_id
SEGMENTED BY hash(sp_pre_call_summary_submarket.sales_force_id, sp_pre_call_summary_submarket.market_id, sp_pre_call_summary_submarket.brand_id, sp_pre_call_summary_submarket.teva_product_flag, sp_pre_call_summary_submarket.payer_id, sp_pre_call_summary_submarket.plan_id, sp_pre_call_summary_submarket.tvcmid, sp_pre_call_summary_submarket.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tn_pre_call_summary_submarket_b0 /*+basename(tn_pre_call_summary_submarket),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tn_pre_call_summary_submarket.sales_force_id,
        tn_pre_call_summary_submarket.nation_id,
        tn_pre_call_summary_submarket.nation,
        tn_pre_call_summary_submarket.area_id,
        tn_pre_call_summary_submarket.area,
        tn_pre_call_summary_submarket.region_id,
        tn_pre_call_summary_submarket.region,
        tn_pre_call_summary_submarket.territory_id,
        tn_pre_call_summary_submarket.territory,
        tn_pre_call_summary_submarket.rep_name,
        tn_pre_call_summary_submarket.user_id,
        tn_pre_call_summary_submarket.time_period,
        tn_pre_call_summary_submarket.period_type,
        tn_pre_call_summary_submarket.period,
        tn_pre_call_summary_submarket.market_id,
        tn_pre_call_summary_submarket.market_name,
        tn_pre_call_summary_submarket.brand_id,
        tn_pre_call_summary_submarket.brand_name,
        tn_pre_call_summary_submarket.teva_product_flag,
        tn_pre_call_summary_submarket.payer_id,
        tn_pre_call_summary_submarket.payer_name,
        tn_pre_call_summary_submarket.plan_id,
        tn_pre_call_summary_submarket.plan_name,
        tn_pre_call_summary_submarket.payer_plan_id,
        tn_pre_call_summary_submarket.customer_id,
        tn_pre_call_summary_submarket.tvcmid,
        tn_pre_call_summary_submarket.hcp_plan_vol_rank,
        tn_pre_call_summary_submarket.prescriber_name,
        tn_pre_call_summary_submarket.pdrp_flag,
        tn_pre_call_summary_submarket.hcp_restriction_flag,
        tn_pre_call_summary_submarket.address,
        tn_pre_call_summary_submarket.city,
        tn_pre_call_summary_submarket.state,
        tn_pre_call_summary_submarket.zip,
        tn_pre_call_summary_submarket.target_status_flag,
        tn_pre_call_summary_submarket.partner_target_status_flag,
        tn_pre_call_summary_submarket.method_of_payment,
        tn_pre_call_summary_submarket.specialty,
        tn_pre_call_summary_submarket.segment,
        tn_pre_call_summary_submarket.decile,
        tn_pre_call_summary_submarket.market_volume_indicator,
        tn_pre_call_summary_submarket.product_vol_trx_count,
        tn_pre_call_summary_submarket.market_vol_trx_count,
        tn_pre_call_summary_submarket.prev_prod_vol_trx_count,
        tn_pre_call_summary_submarket.prev_market_vol_trx_count,
        tn_pre_call_summary_submarket.product_vol_nrx_count,
        tn_pre_call_summary_submarket.market_vol_nrx_count,
        tn_pre_call_summary_submarket.prev_prod_vol_nrx_count,
        tn_pre_call_summary_submarket.prev_market_vol_nrx_count,
        tn_pre_call_summary_submarket.samples,
        tn_pre_call_summary_submarket.details_p1,
        tn_pre_call_summary_submarket.details_p2,
        tn_pre_call_summary_submarket.details_p3
 FROM reporting.tn_pre_call_summary_submarket
 ORDER BY tn_pre_call_summary_submarket.sales_force_id,
          tn_pre_call_summary_submarket.nation_id,
          tn_pre_call_summary_submarket.nation,
          tn_pre_call_summary_submarket.area_id,
          tn_pre_call_summary_submarket.area,
          tn_pre_call_summary_submarket.region_id,
          tn_pre_call_summary_submarket.region,
          tn_pre_call_summary_submarket.territory_id
SEGMENTED BY hash(tn_pre_call_summary_submarket.sales_force_id, tn_pre_call_summary_submarket.market_id, tn_pre_call_summary_submarket.brand_id, tn_pre_call_summary_submarket.teva_product_flag, tn_pre_call_summary_submarket.payer_id, tn_pre_call_summary_submarket.plan_id, tn_pre_call_summary_submarket.tvcmid, tn_pre_call_summary_submarket.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.ma_monthly_payer_prescriber_summary_b0 /*+basename(ma_monthly_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT ma_monthly_payer_prescriber_summary.sales_force_id,
        ma_monthly_payer_prescriber_summary.nation_id,
        ma_monthly_payer_prescriber_summary.nation,
        ma_monthly_payer_prescriber_summary.area_id,
        ma_monthly_payer_prescriber_summary.area,
        ma_monthly_payer_prescriber_summary.region_id,
        ma_monthly_payer_prescriber_summary.region,
        ma_monthly_payer_prescriber_summary.territory_id,
        ma_monthly_payer_prescriber_summary.territory,
        ma_monthly_payer_prescriber_summary.rep_name,
        ma_monthly_payer_prescriber_summary.user_id,
        ma_monthly_payer_prescriber_summary.time_period,
        ma_monthly_payer_prescriber_summary.period_type,
        ma_monthly_payer_prescriber_summary.period,
        ma_monthly_payer_prescriber_summary.market_id,
        ma_monthly_payer_prescriber_summary.market_name,
        ma_monthly_payer_prescriber_summary.brand_id,
        ma_monthly_payer_prescriber_summary.brand_name,
        ma_monthly_payer_prescriber_summary.teva_product_flag,
        ma_monthly_payer_prescriber_summary.payer_id,
        ma_monthly_payer_prescriber_summary.payer_name,
        ma_monthly_payer_prescriber_summary.plan_id,
        ma_monthly_payer_prescriber_summary.plan_name,
        ma_monthly_payer_prescriber_summary.payer_plan_id,
        ma_monthly_payer_prescriber_summary.customer_id,
        ma_monthly_payer_prescriber_summary.tvcmid,
        ma_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        ma_monthly_payer_prescriber_summary.prescriber_name,
        ma_monthly_payer_prescriber_summary.pdrp_flag,
        ma_monthly_payer_prescriber_summary.hcp_restriction_flag,
        ma_monthly_payer_prescriber_summary.address,
        ma_monthly_payer_prescriber_summary.city,
        ma_monthly_payer_prescriber_summary.state,
        ma_monthly_payer_prescriber_summary.zip,
        ma_monthly_payer_prescriber_summary.target_status_flag,
        ma_monthly_payer_prescriber_summary.partner_target_status_flag,
        ma_monthly_payer_prescriber_summary.method_of_payment,
        ma_monthly_payer_prescriber_summary.specialty,
        ma_monthly_payer_prescriber_summary.segment,
        ma_monthly_payer_prescriber_summary.decile,
        ma_monthly_payer_prescriber_summary.market_volume_indicator,
        ma_monthly_payer_prescriber_summary.product_vol_trx_count,
        ma_monthly_payer_prescriber_summary.market_vol_trx_count,
        ma_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        ma_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        ma_monthly_payer_prescriber_summary.product_vol_nrx_count,
        ma_monthly_payer_prescriber_summary.market_vol_nrx_count,
        ma_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        ma_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        ma_monthly_payer_prescriber_summary.samples,
        ma_monthly_payer_prescriber_summary.details_p1,
        ma_monthly_payer_prescriber_summary.details_p2,
        ma_monthly_payer_prescriber_summary.details_p3,
        ma_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        ma_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        ma_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        ma_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        ma_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        ma_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        ma_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        ma_monthly_payer_prescriber_summary.focus_target
 FROM reporting.ma_monthly_payer_prescriber_summary
 ORDER BY ma_monthly_payer_prescriber_summary.sales_force_id,
          ma_monthly_payer_prescriber_summary.nation_id,
          ma_monthly_payer_prescriber_summary.nation,
          ma_monthly_payer_prescriber_summary.area_id,
          ma_monthly_payer_prescriber_summary.area,
          ma_monthly_payer_prescriber_summary.region_id,
          ma_monthly_payer_prescriber_summary.region,
          ma_monthly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(ma_monthly_payer_prescriber_summary.sales_force_id, ma_monthly_payer_prescriber_summary.market_id, ma_monthly_payer_prescriber_summary.brand_id, ma_monthly_payer_prescriber_summary.teva_product_flag, ma_monthly_payer_prescriber_summary.payer_id, ma_monthly_payer_prescriber_summary.plan_id, ma_monthly_payer_prescriber_summary.tvcmid, ma_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.reverse_geo_payer_b0 /*+basename(reverse_geo_payer),createtype(L)*/ 
(
 ma_nation_id,
 ma_nation,
 ma_area_id,
 ma_area,
 ma_region_id,
 ma_region,
 ma_territory_id,
 ma_territory,
 ns_nation_id,
 ns_nation,
 ns_area_id,
 ns_area,
 ns_region_id,
 ns_region,
 ns_territory_id,
 ns_territory,
 sp_nation_id,
 sp_nation,
 sp_area_id,
 sp_area,
 sp_region_id,
 sp_region,
 sp_territory_id,
 sp_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 lives_covered
)
AS
 SELECT reverse_geo_payer.ma_nation_id,
        reverse_geo_payer.ma_nation,
        reverse_geo_payer.ma_area_id,
        reverse_geo_payer.ma_area,
        reverse_geo_payer.ma_region_id,
        reverse_geo_payer.ma_region,
        reverse_geo_payer.ma_territory_id,
        reverse_geo_payer.ma_territory,
        reverse_geo_payer.ns_nation_id,
        reverse_geo_payer.ns_nation,
        reverse_geo_payer.ns_area_id,
        reverse_geo_payer.ns_area,
        reverse_geo_payer.ns_region_id,
        reverse_geo_payer.ns_region,
        reverse_geo_payer.ns_territory_id,
        reverse_geo_payer.ns_territory,
        reverse_geo_payer.sp_nation_id,
        reverse_geo_payer.sp_nation,
        reverse_geo_payer.sp_area_id,
        reverse_geo_payer.sp_area,
        reverse_geo_payer.sp_region_id,
        reverse_geo_payer.sp_region,
        reverse_geo_payer.sp_territory_id,
        reverse_geo_payer.sp_territory,
        reverse_geo_payer.market_id,
        reverse_geo_payer.market_name,
        reverse_geo_payer.brand_id,
        reverse_geo_payer.brand_name,
        reverse_geo_payer.teva_product_flag,
        reverse_geo_payer.time_period,
        reverse_geo_payer.period_type,
        reverse_geo_payer.period,
        reverse_geo_payer.pbm_id,
        reverse_geo_payer.pbm_name,
        reverse_geo_payer.payer_id,
        reverse_geo_payer.payer_name,
        reverse_geo_payer.plan_id,
        reverse_geo_payer.plan_name,
        reverse_geo_payer.payer_plan_id,
        reverse_geo_payer.method_of_payment,
        reverse_geo_payer.state,
        reverse_geo_payer.zip,
        reverse_geo_payer.final_key_controlling_account,
        reverse_geo_payer.key_parent_account,
        reverse_geo_payer.ajovy_formulary_status,
        reverse_geo_payer.aimovig_formulary_status,
        reverse_geo_payer.emgality_formulary_status,
        reverse_geo_payer.plan_payment_type,
        reverse_geo_payer.market_volume_indicator,
        reverse_geo_payer.product_vol_trx_count,
        reverse_geo_payer.market_vol_trx_count,
        reverse_geo_payer.product_vol_nrx_count,
        reverse_geo_payer.market_vol_nrx_count,
        reverse_geo_payer.lives_covered
 FROM reporting.reverse_geo_payer
 ORDER BY reverse_geo_payer.ma_nation_id,
          reverse_geo_payer.ma_nation,
          reverse_geo_payer.ma_area_id,
          reverse_geo_payer.ma_area,
          reverse_geo_payer.ma_region_id,
          reverse_geo_payer.ma_region,
          reverse_geo_payer.ma_territory_id,
          reverse_geo_payer.ma_territory
SEGMENTED BY hash(reverse_geo_payer.ma_nation_id, reverse_geo_payer.ma_area_id, reverse_geo_payer.ma_region_id, reverse_geo_payer.ma_territory_id, reverse_geo_payer.ns_nation_id, reverse_geo_payer.ns_area_id, reverse_geo_payer.ns_region_id, reverse_geo_payer.ns_territory_id) ALL NODES;

CREATE PROJECTION reporting.zip_alignment_b0 /*+basename(zip_alignment),createtype(L)*/ 
(
 sales_force_id,
 zip,
 city,
 state_code,
 territory_id,
 territory_name,
 rep_name,
 rep_id,
 mobile_phone,
 rep_email,
 region_id,
 region_name,
 regional_mgr_name,
 area_id,
 area_name,
 area_mgr_name,
 mirror_territory_id,
 mirror_territory_name
)
AS
 SELECT zip_alignment.sales_force_id,
        zip_alignment.zip,
        zip_alignment.city,
        zip_alignment.state_code,
        zip_alignment.territory_id,
        zip_alignment.territory_name,
        zip_alignment.rep_name,
        zip_alignment.rep_id,
        zip_alignment.mobile_phone,
        zip_alignment.rep_email,
        zip_alignment.region_id,
        zip_alignment.region_name,
        zip_alignment.regional_mgr_name,
        zip_alignment.area_id,
        zip_alignment.area_name,
        zip_alignment.area_mgr_name,
        zip_alignment.mirror_territory_id,
        zip_alignment.mirror_territory_name
 FROM reporting.zip_alignment
 ORDER BY zip_alignment.sales_force_id,
          zip_alignment.zip,
          zip_alignment.city,
          zip_alignment.state_code
SEGMENTED BY hash(zip_alignment.sales_force_id, zip_alignment.zip) ALL NODES;

CREATE PROJECTION reporting.call_activity_b0 /*+basename(call_activity),createtype(A)*/ 
(
 veeva_call_id,
 veeva_parent_call_id,
 call_id,
 veeva_remote_meeting_id,
 engage_meeting_id,
 veeva_account_id,
 sales_force_id,
 territory_number,
 tvcmid,
 call_record_type,
 call_type,
 customer_type,
 how_executed,
 rep_first_name,
 rep_last_name,
 hcp_first_name,
 hcp_last_name,
 hco_name,
 call_date,
 address,
 first_product_detailed,
 second_product_detailed,
 third_product_detailed,
 meeting_scheduled_date,
 latest_meeting_start_date,
 meeting_duration,
 non_host_attendees,
 avg_attendee_duration,
 hcp_invites,
 teva_engage_meeting_status,
 attendance_report_process_status_vod__c,
 meeting_outcome_status_vod__c
)
AS
 SELECT call_activity.veeva_call_id,
        call_activity.veeva_parent_call_id,
        call_activity.call_id,
        call_activity.veeva_remote_meeting_id,
        call_activity.engage_meeting_id,
        call_activity.veeva_account_id,
        call_activity.sales_force_id,
        call_activity.territory_number,
        call_activity.tvcmid,
        call_activity.call_record_type,
        call_activity.call_type,
        call_activity.customer_type,
        call_activity.how_executed,
        call_activity.rep_first_name,
        call_activity.rep_last_name,
        call_activity.hcp_first_name,
        call_activity.hcp_last_name,
        call_activity.hco_name,
        call_activity.call_date,
        call_activity.address,
        call_activity.first_product_detailed,
        call_activity.second_product_detailed,
        call_activity.third_product_detailed,
        call_activity.meeting_scheduled_date,
        call_activity.latest_meeting_start_date,
        call_activity.meeting_duration,
        call_activity.non_host_attendees,
        call_activity.avg_attendee_duration,
        call_activity.hcp_invites,
        call_activity.teva_engage_meeting_status,
        call_activity.attendance_report_process_status_vod__c,
        call_activity.meeting_outcome_status_vod__c
 FROM reporting.call_activity
 ORDER BY call_activity.sales_force_id,
          call_activity.veeva_call_id,
          call_activity.veeva_account_id
SEGMENTED BY hash(call_activity.veeva_call_id) ALL NODES;

CREATE PROJECTION reporting.call_key_messages_b0 /*+basename(call_key_messages),createtype(A)*/ 
(
 veeva_account_id,
 tvcmid,
 call_id,
 call_record_type,
 product,
 key_message,
 call_date,
 duration,
 display_order,
 call_status,
 territory,
 call_type,
 hcp_name
)
AS
 SELECT call_key_messages.veeva_account_id,
        call_key_messages.tvcmid,
        call_key_messages.call_id,
        call_key_messages.call_record_type,
        call_key_messages.product,
        call_key_messages.key_message,
        call_key_messages.call_date,
        call_key_messages.duration,
        call_key_messages.display_order,
        call_key_messages.call_status,
        call_key_messages.territory,
        call_key_messages.call_type,
        call_key_messages.hcp_name
 FROM reporting.call_key_messages
 ORDER BY call_key_messages.veeva_account_id,
          call_key_messages.tvcmid,
          call_key_messages.call_id,
          call_key_messages.call_record_type,
          call_key_messages.product,
          call_key_messages.key_message,
          call_key_messages.call_date,
          call_key_messages.duration
SEGMENTED BY hash(call_key_messages.tvcmid, call_key_messages.call_date, call_key_messages.duration, call_key_messages.veeva_account_id, call_key_messages.display_order, call_key_messages.call_id, call_key_messages.call_record_type, call_key_messages.product) ALL NODES;

CREATE PROJECTION reporting.approved_email_b0 /*+basename(approved_email),createtype(A)*/ 
(
 veeva_sent_email_id,
 sent_email_id,
 product,
 date_sent,
 status,
 failure_message,
 veeva_account_id,
 tvcmid,
 veeva_call_id,
 call_id,
 sender_email,
 territory,
 recipient_email,
 click_count,
 open_count,
 last_open_date,
 valid_consent,
 delivered,
 opened,
 dropped,
 clicked,
 downloaded,
 viewed,
 template_id,
 template_name,
 event_msg_vod__c,
 click_url_vod__c,
 subject
)
AS
 SELECT approved_email.veeva_sent_email_id,
        approved_email.sent_email_id,
        approved_email.product,
        approved_email.date_sent,
        approved_email.status,
        approved_email.failure_message,
        approved_email.veeva_account_id,
        approved_email.tvcmid,
        approved_email.veeva_call_id,
        approved_email.call_id,
        approved_email.sender_email,
        approved_email.territory,
        approved_email.recipient_email,
        approved_email.click_count,
        approved_email.open_count,
        approved_email.last_open_date,
        approved_email.valid_consent,
        approved_email.delivered,
        approved_email.opened,
        approved_email.dropped,
        approved_email.clicked,
        approved_email.downloaded,
        approved_email.viewed,
        approved_email.template_id,
        approved_email.template_name,
        approved_email.event_msg_vod__c,
        approved_email.click_url_vod__c,
        approved_email.subject
 FROM reporting.approved_email
 ORDER BY approved_email.veeva_sent_email_id,
          approved_email.sent_email_id,
          approved_email.product,
          approved_email.date_sent,
          approved_email.status,
          approved_email.failure_message,
          approved_email.veeva_account_id,
          approved_email.tvcmid
SEGMENTED BY hash(approved_email.veeva_sent_email_id) ALL NODES;

CREATE PROJECTION reporting.engage_call_activity_b0 /*+basename(engage_call_activity),createtype(A)*/ 
(
 veeva_call_id,
 veeva_parent_call_id,
 call_id,
 veeva_remote_meeting_id,
 engage_meeting_id,
 veeva_account_id,
 sales_force_id,
 territory_number,
 tvcmid,
 call_record_type,
 call_type,
 customer_type,
 how_executed,
 rep_first_name,
 rep_last_name,
 hcp_first_name,
 hcp_last_name,
 hco_name,
 call_date,
 address,
 first_product_detailed,
 second_product_detailed,
 third_product_detailed,
 meeting_scheduled_date,
 latest_meeting_start_date,
 meeting_duration,
 non_host_attendees,
 avg_attendee_duration,
 hcp_invites,
 teva_engage_meeting_status,
 attendance_report_process_status_vod__c,
 meeting_outcome_status_vod__c
)
AS
 SELECT engage_call_activity.veeva_call_id,
        engage_call_activity.veeva_parent_call_id,
        engage_call_activity.call_id,
        engage_call_activity.veeva_remote_meeting_id,
        engage_call_activity.engage_meeting_id,
        engage_call_activity.veeva_account_id,
        engage_call_activity.sales_force_id,
        engage_call_activity.territory_number,
        engage_call_activity.tvcmid,
        engage_call_activity.call_record_type,
        engage_call_activity.call_type,
        engage_call_activity.customer_type,
        engage_call_activity.how_executed,
        engage_call_activity.rep_first_name,
        engage_call_activity.rep_last_name,
        engage_call_activity.hcp_first_name,
        engage_call_activity.hcp_last_name,
        engage_call_activity.hco_name,
        engage_call_activity.call_date,
        engage_call_activity.address,
        engage_call_activity.first_product_detailed,
        engage_call_activity.second_product_detailed,
        engage_call_activity.third_product_detailed,
        engage_call_activity.meeting_scheduled_date,
        engage_call_activity.latest_meeting_start_date,
        engage_call_activity.meeting_duration,
        engage_call_activity.non_host_attendees,
        engage_call_activity.avg_attendee_duration,
        engage_call_activity.hcp_invites,
        engage_call_activity.teva_engage_meeting_status,
        engage_call_activity.attendance_report_process_status_vod__c,
        engage_call_activity.meeting_outcome_status_vod__c
 FROM reporting.engage_call_activity
 ORDER BY engage_call_activity.sales_force_id,
          engage_call_activity.veeva_call_id,
          engage_call_activity.veeva_account_id
SEGMENTED BY hash(engage_call_activity.veeva_call_id) ALL NODES;

CREATE PROJECTION reporting.tmp_call_key_messages_b0 /*+basename(tmp_call_key_messages),createtype(A)*/ 
(
 veeva_account_id,
 tvcmid,
 call_id,
 call_record_type,
 product,
 key_message,
 call_date,
 duration,
 display_order,
 call_status,
 territory,
 call_type,
 hcp_name,
 current_territory
)
AS
 SELECT tmp_call_key_messages.veeva_account_id,
        tmp_call_key_messages.tvcmid,
        tmp_call_key_messages.call_id,
        tmp_call_key_messages.call_record_type,
        tmp_call_key_messages.product,
        tmp_call_key_messages.key_message,
        tmp_call_key_messages.call_date,
        tmp_call_key_messages.duration,
        tmp_call_key_messages.display_order,
        tmp_call_key_messages.call_status,
        tmp_call_key_messages.territory,
        tmp_call_key_messages.call_type,
        tmp_call_key_messages.hcp_name,
        tmp_call_key_messages.current_territory
 FROM reporting.tmp_call_key_messages
 ORDER BY tmp_call_key_messages.veeva_account_id,
          tmp_call_key_messages.tvcmid,
          tmp_call_key_messages.call_id,
          tmp_call_key_messages.call_record_type,
          tmp_call_key_messages.product,
          tmp_call_key_messages.key_message,
          tmp_call_key_messages.call_date,
          tmp_call_key_messages.duration
SEGMENTED BY hash(tmp_call_key_messages.tvcmid, tmp_call_key_messages.call_date, tmp_call_key_messages.duration, tmp_call_key_messages.veeva_account_id, tmp_call_key_messages.display_order, tmp_call_key_messages.call_id, tmp_call_key_messages.call_record_type, tmp_call_key_messages.product) ALL NODES;

CREATE PROJECTION reporting.digihaler_reverse_geo_payer_b0 /*+basename(digihaler_reverse_geo_payer),createtype(L)*/ 
(
 ma_nation_id,
 ma_nation,
 ma_area_id,
 ma_area,
 ma_region_id,
 ma_region,
 ma_territory_id,
 ma_territory,
 rs_nation_id,
 rs_nation,
 rs_area_id,
 rs_area,
 rs_region_id,
 rs_region,
 rs_territory_id,
 rs_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count
)
AS
 SELECT digihaler_reverse_geo_payer.ma_nation_id,
        digihaler_reverse_geo_payer.ma_nation,
        digihaler_reverse_geo_payer.ma_area_id,
        digihaler_reverse_geo_payer.ma_area,
        digihaler_reverse_geo_payer.ma_region_id,
        digihaler_reverse_geo_payer.ma_region,
        digihaler_reverse_geo_payer.ma_territory_id,
        digihaler_reverse_geo_payer.ma_territory,
        digihaler_reverse_geo_payer.rs_nation_id,
        digihaler_reverse_geo_payer.rs_nation,
        digihaler_reverse_geo_payer.rs_area_id,
        digihaler_reverse_geo_payer.rs_area,
        digihaler_reverse_geo_payer.rs_region_id,
        digihaler_reverse_geo_payer.rs_region,
        digihaler_reverse_geo_payer.rs_territory_id,
        digihaler_reverse_geo_payer.rs_territory,
        digihaler_reverse_geo_payer.market_id,
        digihaler_reverse_geo_payer.market_name,
        digihaler_reverse_geo_payer.brand_id,
        digihaler_reverse_geo_payer.brand_name,
        digihaler_reverse_geo_payer.teva_product_flag,
        digihaler_reverse_geo_payer.time_period,
        digihaler_reverse_geo_payer.period_type,
        digihaler_reverse_geo_payer.period,
        digihaler_reverse_geo_payer.pbm_id,
        digihaler_reverse_geo_payer.pbm_name,
        digihaler_reverse_geo_payer.payer_id,
        digihaler_reverse_geo_payer.payer_name,
        digihaler_reverse_geo_payer.plan_id,
        digihaler_reverse_geo_payer.plan_name,
        digihaler_reverse_geo_payer.payer_plan_id,
        digihaler_reverse_geo_payer.method_of_payment,
        digihaler_reverse_geo_payer.state,
        digihaler_reverse_geo_payer.zip,
        digihaler_reverse_geo_payer.final_key_controlling_account,
        digihaler_reverse_geo_payer.key_parent_account,
        digihaler_reverse_geo_payer.plan_payment_type,
        digihaler_reverse_geo_payer.market_volume_indicator,
        digihaler_reverse_geo_payer.product_vol_trx_count,
        digihaler_reverse_geo_payer.market_vol_trx_count,
        digihaler_reverse_geo_payer.product_vol_nrx_count,
        digihaler_reverse_geo_payer.market_vol_nrx_count
 FROM reporting.digihaler_reverse_geo_payer
 ORDER BY digihaler_reverse_geo_payer.ma_nation_id,
          digihaler_reverse_geo_payer.ma_nation,
          digihaler_reverse_geo_payer.ma_area_id,
          digihaler_reverse_geo_payer.ma_area,
          digihaler_reverse_geo_payer.ma_region_id,
          digihaler_reverse_geo_payer.ma_region,
          digihaler_reverse_geo_payer.ma_territory_id,
          digihaler_reverse_geo_payer.ma_territory
SEGMENTED BY hash(digihaler_reverse_geo_payer.ma_nation_id, digihaler_reverse_geo_payer.ma_area_id, digihaler_reverse_geo_payer.ma_region_id, digihaler_reverse_geo_payer.ma_territory_id, digihaler_reverse_geo_payer.rs_nation_id, digihaler_reverse_geo_payer.rs_area_id, digihaler_reverse_geo_payer.rs_region_id, digihaler_reverse_geo_payer.rs_territory_id) ALL NODES;

CREATE PROJECTION reporting.engage_call_activity_hist_b0 /*+basename(engage_call_activity_hist),createtype(A)*/ 
(
 veeva_call_id,
 veeva_parent_call_id,
 call_id,
 veeva_remote_meeting_id,
 engage_meeting_id,
 veeva_account_id,
 sales_force_id,
 territory_number,
 tvcmid,
 call_record_type,
 call_type,
 customer_type,
 how_executed,
 rep_first_name,
 rep_last_name,
 hcp_first_name,
 hcp_last_name,
 hco_name,
 call_date,
 address,
 first_product_detailed,
 second_product_detailed,
 third_product_detailed,
 meeting_scheduled_date,
 latest_meeting_start_date,
 meeting_duration,
 non_host_attendees,
 avg_attendee_duration,
 hcp_invites,
 teva_engage_meeting_status,
 attendance_report_process_status_vod__c,
 meeting_outcome_status_vod__c
)
AS
 SELECT engage_call_activity_hist.veeva_call_id,
        engage_call_activity_hist.veeva_parent_call_id,
        engage_call_activity_hist.call_id,
        engage_call_activity_hist.veeva_remote_meeting_id,
        engage_call_activity_hist.engage_meeting_id,
        engage_call_activity_hist.veeva_account_id,
        engage_call_activity_hist.sales_force_id,
        engage_call_activity_hist.territory_number,
        engage_call_activity_hist.tvcmid,
        engage_call_activity_hist.call_record_type,
        engage_call_activity_hist.call_type,
        engage_call_activity_hist.customer_type,
        engage_call_activity_hist.how_executed,
        engage_call_activity_hist.rep_first_name,
        engage_call_activity_hist.rep_last_name,
        engage_call_activity_hist.hcp_first_name,
        engage_call_activity_hist.hcp_last_name,
        engage_call_activity_hist.hco_name,
        engage_call_activity_hist.call_date,
        engage_call_activity_hist.address,
        engage_call_activity_hist.first_product_detailed,
        engage_call_activity_hist.second_product_detailed,
        engage_call_activity_hist.third_product_detailed,
        engage_call_activity_hist.meeting_scheduled_date,
        engage_call_activity_hist.latest_meeting_start_date,
        engage_call_activity_hist.meeting_duration,
        engage_call_activity_hist.non_host_attendees,
        engage_call_activity_hist.avg_attendee_duration,
        engage_call_activity_hist.hcp_invites,
        engage_call_activity_hist.teva_engage_meeting_status,
        engage_call_activity_hist.attendance_report_process_status_vod__c,
        engage_call_activity_hist.meeting_outcome_status_vod__c
 FROM reporting.engage_call_activity_hist
 ORDER BY engage_call_activity_hist.veeva_call_id,
          engage_call_activity_hist.veeva_parent_call_id,
          engage_call_activity_hist.call_id,
          engage_call_activity_hist.veeva_remote_meeting_id,
          engage_call_activity_hist.engage_meeting_id,
          engage_call_activity_hist.veeva_account_id,
          engage_call_activity_hist.sales_force_id,
          engage_call_activity_hist.territory_number
SEGMENTED BY hash(engage_call_activity_hist.sales_force_id, engage_call_activity_hist.territory_number, engage_call_activity_hist.tvcmid, engage_call_activity_hist.call_date, engage_call_activity_hist.meeting_scheduled_date, engage_call_activity_hist.latest_meeting_start_date, engage_call_activity_hist.meeting_duration, engage_call_activity_hist.non_host_attendees) ALL NODES;

CREATE PROJECTION reporting.call_key_messages_hist_b0 /*+basename(call_key_messages_hist),createtype(A)*/ 
(
 veeva_account_id,
 tvcmid,
 call_id,
 call_record_type,
 product,
 key_message,
 call_date,
 duration,
 display_order,
 call_status,
 territory,
 call_type,
 hcp_name
)
AS
 SELECT call_key_messages_hist.veeva_account_id,
        call_key_messages_hist.tvcmid,
        call_key_messages_hist.call_id,
        call_key_messages_hist.call_record_type,
        call_key_messages_hist.product,
        call_key_messages_hist.key_message,
        call_key_messages_hist.call_date,
        call_key_messages_hist.duration,
        call_key_messages_hist.display_order,
        call_key_messages_hist.call_status,
        call_key_messages_hist.territory,
        call_key_messages_hist.call_type,
        call_key_messages_hist.hcp_name
 FROM reporting.call_key_messages_hist
 ORDER BY call_key_messages_hist.veeva_account_id,
          call_key_messages_hist.tvcmid,
          call_key_messages_hist.call_id,
          call_key_messages_hist.call_record_type,
          call_key_messages_hist.product,
          call_key_messages_hist.key_message,
          call_key_messages_hist.call_date,
          call_key_messages_hist.duration
SEGMENTED BY hash(call_key_messages_hist.tvcmid, call_key_messages_hist.call_date, call_key_messages_hist.duration, call_key_messages_hist.veeva_account_id, call_key_messages_hist.display_order, call_key_messages_hist.call_id, call_key_messages_hist.call_record_type, call_key_messages_hist.product) ALL NODES;

CREATE PROJECTION reporting.rs_mnthly_pyr_pres_summ_b0 /*+basename(rs_mnthly_pyr_pres_summ),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT rs_mnthly_pyr_pres_summ.sales_force_id,
        rs_mnthly_pyr_pres_summ.nation_id,
        rs_mnthly_pyr_pres_summ.nation,
        rs_mnthly_pyr_pres_summ.area_id,
        rs_mnthly_pyr_pres_summ.area,
        rs_mnthly_pyr_pres_summ.region_id,
        rs_mnthly_pyr_pres_summ.region,
        rs_mnthly_pyr_pres_summ.territory_id,
        rs_mnthly_pyr_pres_summ.territory,
        rs_mnthly_pyr_pres_summ.rep_name,
        rs_mnthly_pyr_pres_summ.user_id,
        rs_mnthly_pyr_pres_summ.time_period,
        rs_mnthly_pyr_pres_summ.period_type,
        rs_mnthly_pyr_pres_summ.period,
        rs_mnthly_pyr_pres_summ.market_id,
        rs_mnthly_pyr_pres_summ.market_name,
        rs_mnthly_pyr_pres_summ.brand_id,
        rs_mnthly_pyr_pres_summ.brand_name,
        rs_mnthly_pyr_pres_summ.teva_product_flag,
        rs_mnthly_pyr_pres_summ.payer_id,
        rs_mnthly_pyr_pres_summ.payer_name,
        rs_mnthly_pyr_pres_summ.plan_id,
        rs_mnthly_pyr_pres_summ.plan_name,
        rs_mnthly_pyr_pres_summ.payer_plan_id,
        rs_mnthly_pyr_pres_summ.customer_id,
        rs_mnthly_pyr_pres_summ.tvcmid,
        rs_mnthly_pyr_pres_summ.hcp_plan_vol_rank,
        rs_mnthly_pyr_pres_summ.prescriber_name,
        rs_mnthly_pyr_pres_summ.pdrp_flag,
        rs_mnthly_pyr_pres_summ.hcp_restriction_flag,
        rs_mnthly_pyr_pres_summ.address,
        rs_mnthly_pyr_pres_summ.city,
        rs_mnthly_pyr_pres_summ.state,
        rs_mnthly_pyr_pres_summ.zip,
        rs_mnthly_pyr_pres_summ.target_status_flag,
        rs_mnthly_pyr_pres_summ.partner_target_status_flag,
        rs_mnthly_pyr_pres_summ.method_of_payment,
        rs_mnthly_pyr_pres_summ.specialty,
        rs_mnthly_pyr_pres_summ.segment,
        rs_mnthly_pyr_pres_summ.decile,
        rs_mnthly_pyr_pres_summ.market_volume_indicator,
        rs_mnthly_pyr_pres_summ.product_vol_trx_count,
        rs_mnthly_pyr_pres_summ.market_vol_trx_count,
        rs_mnthly_pyr_pres_summ.prev_prod_vol_trx_count,
        rs_mnthly_pyr_pres_summ.prev_market_vol_trx_count,
        rs_mnthly_pyr_pres_summ.product_vol_nrx_count,
        rs_mnthly_pyr_pres_summ.market_vol_nrx_count,
        rs_mnthly_pyr_pres_summ.prev_prod_vol_nrx_count,
        rs_mnthly_pyr_pres_summ.prev_market_vol_nrx_count,
        rs_mnthly_pyr_pres_summ.samples,
        rs_mnthly_pyr_pres_summ.details_p1,
        rs_mnthly_pyr_pres_summ.details_p2,
        rs_mnthly_pyr_pres_summ.details_p3,
        rs_mnthly_pyr_pres_summ.Nation_Product_TRx_Count,
        rs_mnthly_pyr_pres_summ.Nation_Product_NRx_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_TRx_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_NRx_Count,
        rs_mnthly_pyr_pres_summ.Nation_Product_TRx_Payer_Count,
        rs_mnthly_pyr_pres_summ.Nation_Product_NRx_Payer_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_TRx_Payer_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_NRx_Payer_Count,
        rs_mnthly_pyr_pres_summ.Nation_Product_TRx_Plan_Count,
        rs_mnthly_pyr_pres_summ.Nation_Product_NRx_Plan_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_TRx_Plan_Count,
        rs_mnthly_pyr_pres_summ.Nation_Market_NRx_Plan_Count,
        rs_mnthly_pyr_pres_summ.focus_target
 FROM reporting.rs_mnthly_pyr_pres_summ
 ORDER BY rs_mnthly_pyr_pres_summ.sales_force_id,
          rs_mnthly_pyr_pres_summ.nation_id,
          rs_mnthly_pyr_pres_summ.nation,
          rs_mnthly_pyr_pres_summ.area_id,
          rs_mnthly_pyr_pres_summ.area,
          rs_mnthly_pyr_pres_summ.region_id,
          rs_mnthly_pyr_pres_summ.region,
          rs_mnthly_pyr_pres_summ.territory_id
SEGMENTED BY hash(rs_mnthly_pyr_pres_summ.sales_force_id, rs_mnthly_pyr_pres_summ.market_id, rs_mnthly_pyr_pres_summ.brand_id, rs_mnthly_pyr_pres_summ.teva_product_flag, rs_mnthly_pyr_pres_summ.payer_id, rs_mnthly_pyr_pres_summ.plan_id, rs_mnthly_pyr_pres_summ.tvcmid, rs_mnthly_pyr_pres_summ.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.par_rnf_csd991_b0 /*+basename(par_rnf_csd991),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prescriber_count_calls,
 prescriber_count_samples,
 prescriber_reached_calls,
 prescriber_reached_samples,
 how_executed,
 call_recordtype
)
AS
 SELECT par_rnf_csd991.sales_force_id,
        par_rnf_csd991.geography_level,
        par_rnf_csd991.geography_id,
        par_rnf_csd991.geography,
        par_rnf_csd991.rep_name,
        par_rnf_csd991.user_id,
        par_rnf_csd991.market_id,
        par_rnf_csd991.market_name,
        par_rnf_csd991.brand_id,
        par_rnf_csd991.brand_name,
        par_rnf_csd991.time_period,
        par_rnf_csd991.period_type,
        par_rnf_csd991.period,
        par_rnf_csd991.decile,
        par_rnf_csd991.segment,
        par_rnf_csd991.specialty,
        par_rnf_csd991.target_status,
        par_rnf_csd991.details_p1,
        par_rnf_csd991.details_p2,
        par_rnf_csd991.details_p3,
        par_rnf_csd991.total_details,
        par_rnf_csd991.samples,
        par_rnf_csd991.prescriber_count_calls,
        par_rnf_csd991.prescriber_count_samples,
        par_rnf_csd991.prescriber_reached_calls,
        par_rnf_csd991.prescriber_reached_samples,
        par_rnf_csd991.how_executed,
        par_rnf_csd991.call_recordtype
 FROM reporting.par_rnf_csd991
 ORDER BY par_rnf_csd991.sales_force_id,
          par_rnf_csd991.geography_level,
          par_rnf_csd991.geography_id,
          par_rnf_csd991.geography,
          par_rnf_csd991.rep_name,
          par_rnf_csd991.user_id,
          par_rnf_csd991.market_id,
          par_rnf_csd991.market_name
SEGMENTED BY hash(par_rnf_csd991.sales_force_id, par_rnf_csd991.market_id, par_rnf_csd991.brand_id, par_rnf_csd991.details_p1, par_rnf_csd991.details_p2, par_rnf_csd991.details_p3, par_rnf_csd991.total_details, par_rnf_csd991.samples) ALL NODES;

CREATE PROJECTION reporting.par_rnf_cummulative_b0 /*+basename(par_rnf_cummulative),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 total_details,
 prescriber_count_calls,
 how_executed,
 new_customer,
 final_cummulative_count
)
AS
 SELECT par_rnf_cummulative.sales_force_id,
        par_rnf_cummulative.geography_level,
        par_rnf_cummulative.geography_id,
        par_rnf_cummulative.geography,
        par_rnf_cummulative.rep_name,
        par_rnf_cummulative.user_id,
        par_rnf_cummulative.market_id,
        par_rnf_cummulative.market_name,
        par_rnf_cummulative.brand_id,
        par_rnf_cummulative.brand_name,
        par_rnf_cummulative.time_period,
        par_rnf_cummulative.period_type,
        par_rnf_cummulative.period,
        par_rnf_cummulative.decile,
        par_rnf_cummulative.segment,
        par_rnf_cummulative.specialty,
        par_rnf_cummulative.target_status,
        par_rnf_cummulative.total_details,
        par_rnf_cummulative.prescriber_count_calls,
        par_rnf_cummulative.how_executed,
        par_rnf_cummulative.new_customer,
        par_rnf_cummulative.final_cummulative_count
 FROM reporting.par_rnf_cummulative
 ORDER BY par_rnf_cummulative.sales_force_id,
          par_rnf_cummulative.geography_level,
          par_rnf_cummulative.geography_id,
          par_rnf_cummulative.geography,
          par_rnf_cummulative.rep_name,
          par_rnf_cummulative.user_id,
          par_rnf_cummulative.market_id,
          par_rnf_cummulative.market_name
SEGMENTED BY hash(par_rnf_cummulative.market_id, par_rnf_cummulative.brand_id, par_rnf_cummulative.total_details, par_rnf_cummulative.prescriber_count_calls, par_rnf_cummulative.new_customer, par_rnf_cummulative.final_cummulative_count, par_rnf_cummulative.sales_force_id, par_rnf_cummulative.geography_level) ALL NODES;

CREATE PROJECTION reporting.ajovy_reverse_geo_payer_weekly_b0 /*+basename(ajovy_reverse_geo_payer_weekly),createtype(A)*/ 
(
 ns_nation_id,
 ns_nation,
 ns_area_id,
 ns_area,
 ns_region_id,
 ns_region,
 ns_territory_id,
 ns_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 lives_covered
)
AS
 SELECT ajovy_reverse_geo_payer_weekly.ns_nation_id,
        ajovy_reverse_geo_payer_weekly.ns_nation,
        ajovy_reverse_geo_payer_weekly.ns_area_id,
        ajovy_reverse_geo_payer_weekly.ns_area,
        ajovy_reverse_geo_payer_weekly.ns_region_id,
        ajovy_reverse_geo_payer_weekly.ns_region,
        ajovy_reverse_geo_payer_weekly.ns_territory_id,
        ajovy_reverse_geo_payer_weekly.ns_territory,
        ajovy_reverse_geo_payer_weekly.market_id,
        ajovy_reverse_geo_payer_weekly.market_name,
        ajovy_reverse_geo_payer_weekly.brand_id,
        ajovy_reverse_geo_payer_weekly.brand_name,
        ajovy_reverse_geo_payer_weekly.teva_product_flag,
        ajovy_reverse_geo_payer_weekly.time_period,
        ajovy_reverse_geo_payer_weekly.period_type,
        ajovy_reverse_geo_payer_weekly.period,
        ajovy_reverse_geo_payer_weekly.pbm_id,
        ajovy_reverse_geo_payer_weekly.pbm_name,
        ajovy_reverse_geo_payer_weekly.payer_id,
        ajovy_reverse_geo_payer_weekly.payer_name,
        ajovy_reverse_geo_payer_weekly.plan_id,
        ajovy_reverse_geo_payer_weekly.plan_name,
        ajovy_reverse_geo_payer_weekly.payer_plan_id,
        ajovy_reverse_geo_payer_weekly.method_of_payment,
        ajovy_reverse_geo_payer_weekly.state,
        ajovy_reverse_geo_payer_weekly.zip,
        ajovy_reverse_geo_payer_weekly.final_key_controlling_account,
        ajovy_reverse_geo_payer_weekly.key_parent_account,
        ajovy_reverse_geo_payer_weekly.ajovy_formulary_status,
        ajovy_reverse_geo_payer_weekly.aimovig_formulary_status,
        ajovy_reverse_geo_payer_weekly.emgality_formulary_status,
        ajovy_reverse_geo_payer_weekly.plan_payment_type,
        ajovy_reverse_geo_payer_weekly.market_volume_indicator,
        ajovy_reverse_geo_payer_weekly.product_vol_trx_count,
        ajovy_reverse_geo_payer_weekly.market_vol_trx_count,
        ajovy_reverse_geo_payer_weekly.product_vol_nrx_count,
        ajovy_reverse_geo_payer_weekly.market_vol_nrx_count,
        ajovy_reverse_geo_payer_weekly.lives_covered
 FROM reporting.ajovy_reverse_geo_payer_weekly
 ORDER BY ajovy_reverse_geo_payer_weekly.ns_nation_id,
          ajovy_reverse_geo_payer_weekly.ns_nation,
          ajovy_reverse_geo_payer_weekly.ns_area_id,
          ajovy_reverse_geo_payer_weekly.ns_area,
          ajovy_reverse_geo_payer_weekly.ns_region_id,
          ajovy_reverse_geo_payer_weekly.ns_region,
          ajovy_reverse_geo_payer_weekly.ns_territory_id,
          ajovy_reverse_geo_payer_weekly.ns_territory
SEGMENTED BY hash(ajovy_reverse_geo_payer_weekly.ns_nation_id, ajovy_reverse_geo_payer_weekly.ns_area_id, ajovy_reverse_geo_payer_weekly.ns_region_id, ajovy_reverse_geo_payer_weekly.ns_territory_id, ajovy_reverse_geo_payer_weekly.market_id, ajovy_reverse_geo_payer_weekly.brand_id, ajovy_reverse_geo_payer_weekly.teva_product_flag, ajovy_reverse_geo_payer_weekly.pbm_id) ALL NODES;

CREATE PROJECTION reporting.tp_anti_psych_weekly_new_prescriber_b0 /*+basename(tp_anti_psych_weekly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 week_ending,
 week_bucket,
 curr_trx,
 prev_trx
)
AS
 SELECT tp_anti_psych_weekly_new_prescriber.customer_id,
        tp_anti_psych_weekly_new_prescriber.brand_id,
        tp_anti_psych_weekly_new_prescriber.week_ending,
        tp_anti_psych_weekly_new_prescriber.week_bucket,
        tp_anti_psych_weekly_new_prescriber.curr_trx,
        tp_anti_psych_weekly_new_prescriber.prev_trx
 FROM reporting.tp_anti_psych_weekly_new_prescriber
 ORDER BY tp_anti_psych_weekly_new_prescriber.customer_id,
          tp_anti_psych_weekly_new_prescriber.brand_id,
          tp_anti_psych_weekly_new_prescriber.week_ending,
          tp_anti_psych_weekly_new_prescriber.week_bucket
SEGMENTED BY hash(tp_anti_psych_weekly_new_prescriber.customer_id, tp_anti_psych_weekly_new_prescriber.brand_id) ALL NODES;

CREATE PROJECTION reporting.tp_anti_psych_weekly_prescriber_sales_b0 /*+basename(tp_anti_psych_weekly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 week_ending,
 week_bucket,
 data_source,
 channel,
 pbm_name,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT tp_anti_psych_weekly_prescriber_sales.customer_id,
        tp_anti_psych_weekly_prescriber_sales.tvcmid,
        tp_anti_psych_weekly_prescriber_sales.ims_id,
        tp_anti_psych_weekly_prescriber_sales.product_id,
        tp_anti_psych_weekly_prescriber_sales.payer_plan_id,
        tp_anti_psych_weekly_prescriber_sales.week_ending,
        tp_anti_psych_weekly_prescriber_sales.week_bucket,
        tp_anti_psych_weekly_prescriber_sales.data_source,
        tp_anti_psych_weekly_prescriber_sales.channel,
        tp_anti_psych_weekly_prescriber_sales.pbm_name,
        tp_anti_psych_weekly_prescriber_sales.method_of_payment,
        tp_anti_psych_weekly_prescriber_sales.trx,
        tp_anti_psych_weekly_prescriber_sales.nrx,
        tp_anti_psych_weekly_prescriber_sales.trx_units,
        tp_anti_psych_weekly_prescriber_sales.nrx_units,
        tp_anti_psych_weekly_prescriber_sales.trx_dollars,
        tp_anti_psych_weekly_prescriber_sales.nrx_dollars,
        tp_anti_psych_weekly_prescriber_sales.new_prescriber
 FROM reporting.tp_anti_psych_weekly_prescriber_sales
 ORDER BY tp_anti_psych_weekly_prescriber_sales.customer_id,
          tp_anti_psych_weekly_prescriber_sales.tvcmid,
          tp_anti_psych_weekly_prescriber_sales.ims_id,
          tp_anti_psych_weekly_prescriber_sales.product_id,
          tp_anti_psych_weekly_prescriber_sales.payer_plan_id,
          tp_anti_psych_weekly_prescriber_sales.week_ending,
          tp_anti_psych_weekly_prescriber_sales.week_bucket,
          tp_anti_psych_weekly_prescriber_sales.channel,
          tp_anti_psych_weekly_prescriber_sales.pbm_name,
          tp_anti_psych_weekly_prescriber_sales.method_of_payment
SEGMENTED BY hash(tp_anti_psych_weekly_prescriber_sales.ims_id) ALL NODES;

CREATE PROJECTION reporting.tp_anti_psych_weekly_prescriber_sales_summary_b0 /*+basename(tp_anti_psych_weekly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 week_ending,
 week_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tp_anti_psych_weekly_prescriber_sales_summary.sales_force_id,
        tp_anti_psych_weekly_prescriber_sales_summary.customer_id,
        tp_anti_psych_weekly_prescriber_sales_summary.tvcmid,
        tp_anti_psych_weekly_prescriber_sales_summary.ims_id,
        tp_anti_psych_weekly_prescriber_sales_summary.period_type,
        tp_anti_psych_weekly_prescriber_sales_summary.period,
        tp_anti_psych_weekly_prescriber_sales_summary.week_ending,
        tp_anti_psych_weekly_prescriber_sales_summary.week_bucket,
        tp_anti_psych_weekly_prescriber_sales_summary.market_id,
        tp_anti_psych_weekly_prescriber_sales_summary.brand_id,
        tp_anti_psych_weekly_prescriber_sales_summary.payer_id,
        tp_anti_psych_weekly_prescriber_sales_summary.payer_plan_id,
        tp_anti_psych_weekly_prescriber_sales_summary.method_of_payment,
        tp_anti_psych_weekly_prescriber_sales_summary.hcp_payer_vol_rank,
        tp_anti_psych_weekly_prescriber_sales_summary.hcp_plan_vol_rank,
        tp_anti_psych_weekly_prescriber_sales_summary.product_vol_trx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.prev_prod_vol_trx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.product_vol_nrx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.market_vol_trx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.prev_market_vol_trx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.market_vol_nrx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.prev_market_vol_nrx_count,
        tp_anti_psych_weekly_prescriber_sales_summary.samples,
        tp_anti_psych_weekly_prescriber_sales_summary.details_p1,
        tp_anti_psych_weekly_prescriber_sales_summary.details_p2,
        tp_anti_psych_weekly_prescriber_sales_summary.details_p3
 FROM reporting.tp_anti_psych_weekly_prescriber_sales_summary
 ORDER BY tp_anti_psych_weekly_prescriber_sales_summary.sales_force_id,
          tp_anti_psych_weekly_prescriber_sales_summary.customer_id,
          tp_anti_psych_weekly_prescriber_sales_summary.tvcmid,
          tp_anti_psych_weekly_prescriber_sales_summary.ims_id,
          tp_anti_psych_weekly_prescriber_sales_summary.period_type,
          tp_anti_psych_weekly_prescriber_sales_summary.period,
          tp_anti_psych_weekly_prescriber_sales_summary.week_ending,
          tp_anti_psych_weekly_prescriber_sales_summary.week_bucket
SEGMENTED BY hash(tp_anti_psych_weekly_prescriber_sales_summary.tvcmid) ALL NODES;

CREATE PROJECTION reporting.tp_anti_psych_weekly_payer_prescriber_summary_b0 /*+basename(tp_anti_psych_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT tp_anti_psych_weekly_payer_prescriber_summary.sales_force_id,
        tp_anti_psych_weekly_payer_prescriber_summary.nation_id,
        tp_anti_psych_weekly_payer_prescriber_summary.nation,
        tp_anti_psych_weekly_payer_prescriber_summary.area_id,
        tp_anti_psych_weekly_payer_prescriber_summary.area,
        tp_anti_psych_weekly_payer_prescriber_summary.region_id,
        tp_anti_psych_weekly_payer_prescriber_summary.region,
        tp_anti_psych_weekly_payer_prescriber_summary.territory_id,
        tp_anti_psych_weekly_payer_prescriber_summary.territory,
        tp_anti_psych_weekly_payer_prescriber_summary.rep_name,
        tp_anti_psych_weekly_payer_prescriber_summary.user_id,
        tp_anti_psych_weekly_payer_prescriber_summary.time_period,
        tp_anti_psych_weekly_payer_prescriber_summary.period_type,
        tp_anti_psych_weekly_payer_prescriber_summary.period,
        tp_anti_psych_weekly_payer_prescriber_summary.market_id,
        tp_anti_psych_weekly_payer_prescriber_summary.market_name,
        tp_anti_psych_weekly_payer_prescriber_summary.brand_id,
        tp_anti_psych_weekly_payer_prescriber_summary.brand_name,
        tp_anti_psych_weekly_payer_prescriber_summary.teva_product_flag,
        tp_anti_psych_weekly_payer_prescriber_summary.payer_id,
        tp_anti_psych_weekly_payer_prescriber_summary.payer_name,
        tp_anti_psych_weekly_payer_prescriber_summary.plan_id,
        tp_anti_psych_weekly_payer_prescriber_summary.plan_name,
        tp_anti_psych_weekly_payer_prescriber_summary.payer_plan_id,
        tp_anti_psych_weekly_payer_prescriber_summary.customer_id,
        tp_anti_psych_weekly_payer_prescriber_summary.tvcmid,
        tp_anti_psych_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        tp_anti_psych_weekly_payer_prescriber_summary.prescriber_name,
        tp_anti_psych_weekly_payer_prescriber_summary.pdrp_flag,
        tp_anti_psych_weekly_payer_prescriber_summary.hcp_restriction_flag,
        tp_anti_psych_weekly_payer_prescriber_summary.address,
        tp_anti_psych_weekly_payer_prescriber_summary.city,
        tp_anti_psych_weekly_payer_prescriber_summary.state,
        tp_anti_psych_weekly_payer_prescriber_summary.zip,
        tp_anti_psych_weekly_payer_prescriber_summary.target_status_flag,
        tp_anti_psych_weekly_payer_prescriber_summary.partner_target_status_flag,
        tp_anti_psych_weekly_payer_prescriber_summary.method_of_payment,
        tp_anti_psych_weekly_payer_prescriber_summary.specialty,
        tp_anti_psych_weekly_payer_prescriber_summary.segment,
        tp_anti_psych_weekly_payer_prescriber_summary.decile,
        tp_anti_psych_weekly_payer_prescriber_summary.market_volume_indicator,
        tp_anti_psych_weekly_payer_prescriber_summary.product_vol_trx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.market_vol_trx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.product_vol_nrx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.market_vol_nrx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        tp_anti_psych_weekly_payer_prescriber_summary.samples,
        tp_anti_psych_weekly_payer_prescriber_summary.details_p1,
        tp_anti_psych_weekly_payer_prescriber_summary.details_p2,
        tp_anti_psych_weekly_payer_prescriber_summary.details_p3,
        tp_anti_psych_weekly_payer_prescriber_summary.focus_target
 FROM reporting.tp_anti_psych_weekly_payer_prescriber_summary
 ORDER BY tp_anti_psych_weekly_payer_prescriber_summary.customer_id,
          tp_anti_psych_weekly_payer_prescriber_summary.tvcmid
SEGMENTED BY hash(tp_anti_psych_weekly_payer_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.uzedy_reverse_geo_payer_weekly_b0 /*+basename(uzedy_reverse_geo_payer_weekly),createtype(L)*/ 
(
 ts_nation_id,
 ts_nation,
 ts_area_id,
 ts_area,
 ts_region_id,
 ts_region,
 ts_territory_id,
 ts_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 key_controlling_parent,
 key_controlling_account,
 key_controlling_plan_formulary,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count
)
AS
 SELECT uzedy_reverse_geo_payer_weekly.ts_nation_id,
        uzedy_reverse_geo_payer_weekly.ts_nation,
        uzedy_reverse_geo_payer_weekly.ts_area_id,
        uzedy_reverse_geo_payer_weekly.ts_area,
        uzedy_reverse_geo_payer_weekly.ts_region_id,
        uzedy_reverse_geo_payer_weekly.ts_region,
        uzedy_reverse_geo_payer_weekly.ts_territory_id,
        uzedy_reverse_geo_payer_weekly.ts_territory,
        uzedy_reverse_geo_payer_weekly.market_id,
        uzedy_reverse_geo_payer_weekly.market_name,
        uzedy_reverse_geo_payer_weekly.brand_id,
        uzedy_reverse_geo_payer_weekly.brand_name,
        uzedy_reverse_geo_payer_weekly.teva_product_flag,
        uzedy_reverse_geo_payer_weekly.time_period,
        uzedy_reverse_geo_payer_weekly.period_type,
        uzedy_reverse_geo_payer_weekly.period,
        uzedy_reverse_geo_payer_weekly.pbm_id,
        uzedy_reverse_geo_payer_weekly.pbm_name,
        uzedy_reverse_geo_payer_weekly.payer_id,
        uzedy_reverse_geo_payer_weekly.payer_name,
        uzedy_reverse_geo_payer_weekly.plan_id,
        uzedy_reverse_geo_payer_weekly.plan_name,
        uzedy_reverse_geo_payer_weekly.payer_plan_id,
        uzedy_reverse_geo_payer_weekly.method_of_payment,
        uzedy_reverse_geo_payer_weekly.state,
        uzedy_reverse_geo_payer_weekly.zip,
        uzedy_reverse_geo_payer_weekly.key_controlling_parent,
        uzedy_reverse_geo_payer_weekly.key_controlling_account,
        uzedy_reverse_geo_payer_weekly.key_controlling_plan_formulary,
        uzedy_reverse_geo_payer_weekly.market_volume_indicator,
        uzedy_reverse_geo_payer_weekly.product_vol_trx_count,
        uzedy_reverse_geo_payer_weekly.market_vol_trx_count,
        uzedy_reverse_geo_payer_weekly.product_vol_nrx_count,
        uzedy_reverse_geo_payer_weekly.market_vol_nrx_count
 FROM reporting.uzedy_reverse_geo_payer_weekly
 ORDER BY uzedy_reverse_geo_payer_weekly.ts_nation_id,
          uzedy_reverse_geo_payer_weekly.ts_nation,
          uzedy_reverse_geo_payer_weekly.ts_area_id,
          uzedy_reverse_geo_payer_weekly.ts_area,
          uzedy_reverse_geo_payer_weekly.ts_region_id,
          uzedy_reverse_geo_payer_weekly.ts_region,
          uzedy_reverse_geo_payer_weekly.ts_territory_id,
          uzedy_reverse_geo_payer_weekly.ts_territory
SEGMENTED BY hash(uzedy_reverse_geo_payer_weekly.market_id, uzedy_reverse_geo_payer_weekly.brand_id, uzedy_reverse_geo_payer_weekly.teva_product_flag, uzedy_reverse_geo_payer_weekly.pbm_id, uzedy_reverse_geo_payer_weekly.payer_id, uzedy_reverse_geo_payer_weekly.plan_id, uzedy_reverse_geo_payer_weekly.market_volume_indicator, uzedy_reverse_geo_payer_weekly.ts_nation_id) ALL NODES;

CREATE PROJECTION reporting.monthly_workdays_b0 /*+basename(monthly_workdays),createtype(L)*/ 
(
 sales_force_id,
 geography_id,
 month,
 expected_workdays,
 actual_workdays
)
AS
 SELECT monthly_workdays.sales_force_id,
        monthly_workdays.geography_id,
        monthly_workdays.month,
        monthly_workdays.expected_workdays,
        monthly_workdays.actual_workdays
 FROM reporting.monthly_workdays
 ORDER BY monthly_workdays.sales_force_id,
          monthly_workdays.geography_id,
          monthly_workdays.month
SEGMENTED BY hash(monthly_workdays.geography_id, monthly_workdays.month) ALL NODES;

CREATE PROJECTION reporting.reporting_rollup_week_b0 /*+basename(reporting_rollup_week),createtype(L)*/ 
(
 rollup_week,
 sales_week_bucket,
 activity_week_bucket
)
AS
 SELECT reporting_rollup_week.rollup_week,
        reporting_rollup_week.sales_week_bucket,
        reporting_rollup_week.activity_week_bucket
 FROM reporting.reporting_rollup_week
 ORDER BY reporting_rollup_week.rollup_week
SEGMENTED BY hash(reporting_rollup_week.rollup_week) ALL NODES;

CREATE PROJECTION reporting.reporting_rollup_month_b0 /*+basename(reporting_rollup_month),createtype(L)*/ 
(
 rollup_month,
 sales_month_bucket,
 activity_month_bucket
)
AS
 SELECT reporting_rollup_month.rollup_month,
        reporting_rollup_month.sales_month_bucket,
        reporting_rollup_month.activity_month_bucket
 FROM reporting.reporting_rollup_month
 ORDER BY reporting_rollup_month.rollup_month
SEGMENTED BY hash(reporting_rollup_month.rollup_month) ALL NODES;

CREATE PROJECTION reporting.weekly_workdays_b0 /*+basename(weekly_workdays),createtype(L)*/ 
(
 sales_force_id,
 geography_id,
 week,
 expected_workdays,
 actual_workdays
)
AS
 SELECT weekly_workdays.sales_force_id,
        weekly_workdays.geography_id,
        weekly_workdays.week,
        weekly_workdays.expected_workdays,
        weekly_workdays.actual_workdays
 FROM reporting.weekly_workdays
 ORDER BY weekly_workdays.sales_force_id,
          weekly_workdays.geography_id,
          weekly_workdays.week
SEGMENTED BY hash(weekly_workdays.geography_id) ALL NODES;

CREATE PROJECTION reporting.tn_monthly_geo_summary_old_format_b0 /*+basename(tn_monthly_geo_summary_old_format),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 time_period,
 period_type,
 period,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 product_vol_trx,
 product_vol_new_pres_trx,
 market_vol_trx,
 prev_prod_vol_trx,
 prev_market_vol_trx,
 product_vol_nrx,
 product_vol_new_pres_nrx,
 market_vol_nrx,
 prev_prod_vol_nrx,
 prev_market_vol_nrx,
 prescribers_count,
 new_prescribers_count
)
AS
 SELECT tn_monthly_geo_summary_old_format.sales_force_id,
        tn_monthly_geo_summary_old_format.geography_level,
        tn_monthly_geo_summary_old_format.geography_id,
        tn_monthly_geo_summary_old_format.geography,
        tn_monthly_geo_summary_old_format.time_period,
        tn_monthly_geo_summary_old_format.period_type,
        tn_monthly_geo_summary_old_format.period,
        tn_monthly_geo_summary_old_format.market_name,
        tn_monthly_geo_summary_old_format.brand_id,
        tn_monthly_geo_summary_old_format.brand_name,
        tn_monthly_geo_summary_old_format.teva_product_flag,
        tn_monthly_geo_summary_old_format.target_status_flag,
        tn_monthly_geo_summary_old_format.method_of_payment,
        tn_monthly_geo_summary_old_format.specialty,
        tn_monthly_geo_summary_old_format.segment,
        tn_monthly_geo_summary_old_format.product_vol_trx,
        tn_monthly_geo_summary_old_format.product_vol_new_pres_trx,
        tn_monthly_geo_summary_old_format.market_vol_trx,
        tn_monthly_geo_summary_old_format.prev_prod_vol_trx,
        tn_monthly_geo_summary_old_format.prev_market_vol_trx,
        tn_monthly_geo_summary_old_format.product_vol_nrx,
        tn_monthly_geo_summary_old_format.product_vol_new_pres_nrx,
        tn_monthly_geo_summary_old_format.market_vol_nrx,
        tn_monthly_geo_summary_old_format.prev_prod_vol_nrx,
        tn_monthly_geo_summary_old_format.prev_market_vol_nrx,
        tn_monthly_geo_summary_old_format.prescribers_count,
        tn_monthly_geo_summary_old_format.new_prescribers_count
 FROM reporting.tn_monthly_geo_summary_old_format
 ORDER BY tn_monthly_geo_summary_old_format.sales_force_id,
          tn_monthly_geo_summary_old_format.geography_level,
          tn_monthly_geo_summary_old_format.geography_id,
          tn_monthly_geo_summary_old_format.geography,
          tn_monthly_geo_summary_old_format.time_period,
          tn_monthly_geo_summary_old_format.period_type,
          tn_monthly_geo_summary_old_format.period,
          tn_monthly_geo_summary_old_format.market_name,
          tn_monthly_geo_summary_old_format.brand_id,
          tn_monthly_geo_summary_old_format.brand_name,
          tn_monthly_geo_summary_old_format.teva_product_flag,
          tn_monthly_geo_summary_old_format.target_status_flag,
          tn_monthly_geo_summary_old_format.method_of_payment,
          tn_monthly_geo_summary_old_format.specialty,
          tn_monthly_geo_summary_old_format.segment,
          tn_monthly_geo_summary_old_format.product_vol_trx,
          tn_monthly_geo_summary_old_format.product_vol_new_pres_trx,
          tn_monthly_geo_summary_old_format.market_vol_trx,
          tn_monthly_geo_summary_old_format.prev_prod_vol_trx,
          tn_monthly_geo_summary_old_format.prev_market_vol_trx,
          tn_monthly_geo_summary_old_format.product_vol_nrx,
          tn_monthly_geo_summary_old_format.product_vol_new_pres_nrx,
          tn_monthly_geo_summary_old_format.market_vol_nrx,
          tn_monthly_geo_summary_old_format.prev_prod_vol_nrx,
          tn_monthly_geo_summary_old_format.prev_market_vol_nrx,
          tn_monthly_geo_summary_old_format.prescribers_count,
          tn_monthly_geo_summary_old_format.new_prescribers_count
SEGMENTED BY hash(tn_monthly_geo_summary_old_format.sales_force_id, tn_monthly_geo_summary_old_format.geography_level, tn_monthly_geo_summary_old_format.geography_id, tn_monthly_geo_summary_old_format.geography, tn_monthly_geo_summary_old_format.time_period, tn_monthly_geo_summary_old_format.period_type, tn_monthly_geo_summary_old_format.period, tn_monthly_geo_summary_old_format.market_name, tn_monthly_geo_summary_old_format.brand_id, tn_monthly_geo_summary_old_format.brand_name, tn_monthly_geo_summary_old_format.teva_product_flag, tn_monthly_geo_summary_old_format.target_status_flag, tn_monthly_geo_summary_old_format.method_of_payment, tn_monthly_geo_summary_old_format.specialty, tn_monthly_geo_summary_old_format.segment, tn_monthly_geo_summary_old_format.product_vol_trx, tn_monthly_geo_summary_old_format.product_vol_new_pres_trx, tn_monthly_geo_summary_old_format.market_vol_trx, tn_monthly_geo_summary_old_format.prev_prod_vol_trx, tn_monthly_geo_summary_old_format.prev_market_vol_trx, tn_monthly_geo_summary_old_format.product_vol_nrx, tn_monthly_geo_summary_old_format.product_vol_new_pres_nrx, tn_monthly_geo_summary_old_format.market_vol_nrx, tn_monthly_geo_summary_old_format.prev_prod_vol_nrx, tn_monthly_geo_summary_old_format.prev_market_vol_nrx, tn_monthly_geo_summary_old_format.prescribers_count, tn_monthly_geo_summary_old_format.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.product_b0 /*+basename(product),createtype(L)*/ 
(
 product_id,
 product_name,
 product_type,
 brand_id,
 brand_name,
 market_id,
 market_name,
 teva_product_flag,
 geo_summary_include,
 presc_summary_include,
 market_share_market_id,
 market_share_market_name,
 market_share_default_brand,
 rptg_decile_attribute_type,
 rptg_decile_attribute_prod_id,
 rptg_segment_attribute_type,
 rptg_segment_attribute_prod_id,
 molecule_id,
 molecule_name,
 class_name,
 form_strength_name,
 indication
)
AS
 SELECT product.product_id,
        product.product_name,
        product.product_type,
        product.brand_id,
        product.brand_name,
        product.market_id,
        product.market_name,
        product.teva_product_flag,
        product.geo_summary_include,
        product.presc_summary_include,
        product.market_share_market_id,
        product.market_share_market_name,
        product.market_share_default_brand,
        product.rptg_decile_attribute_type,
        product.rptg_decile_attribute_prod_id,
        product.rptg_segment_attribute_type,
        product.rptg_segment_attribute_prod_id,
        product.molecule_id,
        product.molecule_name,
        product.class_name,
        product.form_strength_name,
        product.indication
 FROM reporting.product
 ORDER BY product.product_id
SEGMENTED BY hash(product.product_id) ALL NODES;

CREATE PROJECTION reporting.sales_force_headcounts_b0 /*+basename(sales_force_headcounts),createtype(L)*/ 
(
 sales_force_id,
 month,
 headcount,
 products
)
AS
 SELECT sales_force_headcounts.sales_force_id,
        sales_force_headcounts.month,
        sales_force_headcounts.headcount,
        sales_force_headcounts.products
 FROM reporting.sales_force_headcounts
 ORDER BY sales_force_headcounts.sales_force_id,
          sales_force_headcounts.month,
          sales_force_headcounts.headcount,
          sales_force_headcounts.products
SEGMENTED BY hash(sales_force_headcounts.sales_force_id, sales_force_headcounts.month, sales_force_headcounts.headcount, sales_force_headcounts.products) ALL NODES;

CREATE PROJECTION reporting.par_rnf_b0 /*+basename(par_rnf),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prescriber_count_calls,
 prescriber_count_samples,
 prescriber_reached_calls,
 prescriber_reached_samples,
 how_executed,
 call_recordtype
)
AS
 SELECT par_rnf.sales_force_id,
        par_rnf.geography_level,
        par_rnf.geography_id,
        par_rnf.geography,
        par_rnf.rep_name,
        par_rnf.user_id,
        par_rnf.market_id,
        par_rnf.market_name,
        par_rnf.brand_id,
        par_rnf.brand_name,
        par_rnf.time_period,
        par_rnf.period_type,
        par_rnf.period,
        par_rnf.decile,
        par_rnf.segment,
        par_rnf.specialty,
        par_rnf.target_status,
        par_rnf.details_p1,
        par_rnf.details_p2,
        par_rnf.details_p3,
        par_rnf.total_details,
        par_rnf.samples,
        par_rnf.prescriber_count_calls,
        par_rnf.prescriber_count_samples,
        par_rnf.prescriber_reached_calls,
        par_rnf.prescriber_reached_samples,
        par_rnf.how_executed,
        par_rnf.call_recordtype
 FROM reporting.par_rnf
 ORDER BY par_rnf.sales_force_id
SEGMENTED BY hash(par_rnf.sales_force_id, par_rnf.market_id, par_rnf.brand_id, par_rnf.details_p1, par_rnf.details_p2, par_rnf.details_p3, par_rnf.total_details, par_rnf.samples) ALL NODES;

CREATE PROJECTION reporting.tn_weekly_geography_summary_b0 /*+basename(tn_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT tn_weekly_geography_summary.sales_force_id,
        tn_weekly_geography_summary.geography_level,
        tn_weekly_geography_summary.geography_id,
        tn_weekly_geography_summary.geography,
        tn_weekly_geography_summary.rep_name,
        tn_weekly_geography_summary.user_id,
        tn_weekly_geography_summary.time_period,
        tn_weekly_geography_summary.period_type,
        tn_weekly_geography_summary.period,
        tn_weekly_geography_summary.market_id,
        tn_weekly_geography_summary.market_name,
        tn_weekly_geography_summary.brand_id,
        tn_weekly_geography_summary.brand_name,
        tn_weekly_geography_summary.teva_product_flag,
        tn_weekly_geography_summary.target_status_flag,
        tn_weekly_geography_summary.method_of_payment,
        tn_weekly_geography_summary.specialty,
        tn_weekly_geography_summary.segment,
        tn_weekly_geography_summary.market_volume_indicator,
        tn_weekly_geography_summary.product_vol_trx_count,
        tn_weekly_geography_summary.product_vol_new_pres_trx_count,
        tn_weekly_geography_summary.market_vol_trx_count,
        tn_weekly_geography_summary.prev_prod_vol_trx_count,
        tn_weekly_geography_summary.prev_market_vol_trx_count,
        tn_weekly_geography_summary.product_vol_nrx_count,
        tn_weekly_geography_summary.product_vol_new_pres_nrx_count,
        tn_weekly_geography_summary.market_vol_nrx_count,
        tn_weekly_geography_summary.prev_prod_vol_nrx_count,
        tn_weekly_geography_summary.prev_market_vol_nrx_count,
        tn_weekly_geography_summary.prescribers_count,
        tn_weekly_geography_summary.new_prescribers_count,
        tn_weekly_geography_summary.decile
 FROM reporting.tn_weekly_geography_summary
 ORDER BY tn_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(tn_weekly_geography_summary.sales_force_id, tn_weekly_geography_summary.market_id, tn_weekly_geography_summary.brand_id, tn_weekly_geography_summary.teva_product_flag, tn_weekly_geography_summary.target_status_flag, tn_weekly_geography_summary.market_volume_indicator, tn_weekly_geography_summary.prescribers_count, tn_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.tp_weekly_payer_geography_summary_b0 /*+basename(tp_weekly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count
)
AS
 SELECT tp_weekly_payer_geography_summary.sales_force_id,
        tp_weekly_payer_geography_summary.geography_level,
        tp_weekly_payer_geography_summary.geography_id,
        tp_weekly_payer_geography_summary.geography,
        tp_weekly_payer_geography_summary.rep_name,
        tp_weekly_payer_geography_summary.user_id,
        tp_weekly_payer_geography_summary.time_period,
        tp_weekly_payer_geography_summary.period_type,
        tp_weekly_payer_geography_summary.period,
        tp_weekly_payer_geography_summary.payer_id,
        tp_weekly_payer_geography_summary.payer_name,
        tp_weekly_payer_geography_summary.plan_id,
        tp_weekly_payer_geography_summary.plan_name,
        tp_weekly_payer_geography_summary.payer_plan_id,
        tp_weekly_payer_geography_summary.market_id,
        tp_weekly_payer_geography_summary.market_name,
        tp_weekly_payer_geography_summary.brand_id,
        tp_weekly_payer_geography_summary.brand_name,
        tp_weekly_payer_geography_summary.teva_product_flag,
        tp_weekly_payer_geography_summary.method_of_payment,
        tp_weekly_payer_geography_summary.market_volume_indicator,
        tp_weekly_payer_geography_summary.geo_plan_vol_rank,
        tp_weekly_payer_geography_summary.product_vol_trx_count,
        tp_weekly_payer_geography_summary.market_vol_trx_count,
        tp_weekly_payer_geography_summary.prev_prod_vol_trx_count,
        tp_weekly_payer_geography_summary.prev_market_vol_trx_count,
        tp_weekly_payer_geography_summary.product_vol_nrx_count,
        tp_weekly_payer_geography_summary.market_vol_nrx_count,
        tp_weekly_payer_geography_summary.prev_prod_vol_nrx_count,
        tp_weekly_payer_geography_summary.prev_market_vol_nrx_count
 FROM reporting.tp_weekly_payer_geography_summary
 ORDER BY tp_weekly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(tp_weekly_payer_geography_summary.sales_force_id, tp_weekly_payer_geography_summary.payer_id, tp_weekly_payer_geography_summary.plan_id, tp_weekly_payer_geography_summary.market_id, tp_weekly_payer_geography_summary.brand_id, tp_weekly_payer_geography_summary.teva_product_flag, tp_weekly_payer_geography_summary.market_volume_indicator, tp_weekly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.sp_weekly_payer_geography_summary_b0 /*+basename(sp_weekly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count
)
AS
 SELECT sp_weekly_payer_geography_summary.sales_force_id,
        sp_weekly_payer_geography_summary.geography_level,
        sp_weekly_payer_geography_summary.geography_id,
        sp_weekly_payer_geography_summary.geography,
        sp_weekly_payer_geography_summary.rep_name,
        sp_weekly_payer_geography_summary.user_id,
        sp_weekly_payer_geography_summary.time_period,
        sp_weekly_payer_geography_summary.period_type,
        sp_weekly_payer_geography_summary.period,
        sp_weekly_payer_geography_summary.payer_id,
        sp_weekly_payer_geography_summary.payer_name,
        sp_weekly_payer_geography_summary.plan_id,
        sp_weekly_payer_geography_summary.plan_name,
        sp_weekly_payer_geography_summary.payer_plan_id,
        sp_weekly_payer_geography_summary.market_id,
        sp_weekly_payer_geography_summary.market_name,
        sp_weekly_payer_geography_summary.brand_id,
        sp_weekly_payer_geography_summary.brand_name,
        sp_weekly_payer_geography_summary.teva_product_flag,
        sp_weekly_payer_geography_summary.method_of_payment,
        sp_weekly_payer_geography_summary.market_volume_indicator,
        sp_weekly_payer_geography_summary.geo_plan_vol_rank,
        sp_weekly_payer_geography_summary.product_vol_trx_count,
        sp_weekly_payer_geography_summary.market_vol_trx_count,
        sp_weekly_payer_geography_summary.prev_prod_vol_trx_count,
        sp_weekly_payer_geography_summary.prev_market_vol_trx_count,
        sp_weekly_payer_geography_summary.product_vol_nrx_count,
        sp_weekly_payer_geography_summary.market_vol_nrx_count,
        sp_weekly_payer_geography_summary.prev_prod_vol_nrx_count,
        sp_weekly_payer_geography_summary.prev_market_vol_nrx_count
 FROM reporting.sp_weekly_payer_geography_summary
 ORDER BY sp_weekly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(sp_weekly_payer_geography_summary.sales_force_id, sp_weekly_payer_geography_summary.payer_id, sp_weekly_payer_geography_summary.plan_id, sp_weekly_payer_geography_summary.market_id, sp_weekly_payer_geography_summary.brand_id, sp_weekly_payer_geography_summary.teva_product_flag, sp_weekly_payer_geography_summary.market_volume_indicator, sp_weekly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.par_calls_b0 /*+basename(par_calls),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 customer_type,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 call_goals,
 calls_per_day_goal,
 expected_workdays,
 actual_workdays,
 how_executed,
 target_status,
 call_recordtype
)
AS
 SELECT par_calls.sales_force_id,
        par_calls.geography_level,
        par_calls.geography_id,
        par_calls.geography,
        par_calls.rep_name,
        par_calls.user_id,
        par_calls.market_id,
        par_calls.market_name,
        par_calls.brand_id,
        par_calls.brand_name,
        par_calls.time_period,
        par_calls.period_type,
        par_calls.period,
        par_calls.customer_type,
        par_calls.details_p1,
        par_calls.details_p2,
        par_calls.details_p3,
        par_calls.total_details,
        par_calls.call_goals,
        par_calls.calls_per_day_goal,
        par_calls.expected_workdays,
        par_calls.actual_workdays,
        par_calls.how_executed,
        par_calls.target_status,
        par_calls.call_recordtype
 FROM reporting.par_calls
 ORDER BY par_calls.sales_force_id
SEGMENTED BY hash(par_calls.sales_force_id, par_calls.market_id, par_calls.brand_id, par_calls.details_p1, par_calls.details_p2, par_calls.details_p3, par_calls.total_details, par_calls.call_goals) ALL NODES;

CREATE PROJECTION reporting.weekly_activity_b0 /*+basename(weekly_activity),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 geography_id,
 current_geography_id,
 sales_force_id,
 teva_employee_id,
 activity_id,
 activity_zip,
 customer_type,
 week_end,
 week_bucket,
 activity_name,
 activity_detail,
 activity_value,
 how_executed,
 call_recordtype
)
AS
 SELECT weekly_activity.customer_id,
        weekly_activity.tvcmid,
        weekly_activity.ims_id,
        weekly_activity.product_id,
        weekly_activity.geography_id,
        weekly_activity.current_geography_id,
        weekly_activity.sales_force_id,
        weekly_activity.teva_employee_id,
        weekly_activity.activity_id,
        weekly_activity.activity_zip,
        weekly_activity.customer_type,
        weekly_activity.week_end,
        weekly_activity.week_bucket,
        weekly_activity.activity_name,
        weekly_activity.activity_detail,
        weekly_activity.activity_value,
        weekly_activity.how_executed,
        weekly_activity.call_recordtype
 FROM reporting.weekly_activity
 ORDER BY weekly_activity.customer_id,
          weekly_activity.tvcmid,
          weekly_activity.ims_id
SEGMENTED BY hash(weekly_activity.tvcmid) ALL NODES;

CREATE PROJECTION reporting.monthly_activity_b0 /*+basename(monthly_activity),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 geography_id,
 current_geography_id,
 sales_force_id,
 teva_employee_id,
 activity_id,
 activity_zip,
 customer_type,
 month_end,
 month_bucket,
 activity_name,
 activity_detail,
 activity_value,
 how_executed,
 call_recordtype
)
AS
 SELECT monthly_activity.customer_id,
        monthly_activity.tvcmid,
        monthly_activity.ims_id,
        monthly_activity.product_id,
        monthly_activity.geography_id,
        monthly_activity.current_geography_id,
        monthly_activity.sales_force_id,
        monthly_activity.teva_employee_id,
        monthly_activity.activity_id,
        monthly_activity.activity_zip,
        monthly_activity.customer_type,
        monthly_activity.month_end,
        monthly_activity.month_bucket,
        monthly_activity.activity_name,
        monthly_activity.activity_detail,
        monthly_activity.activity_value,
        monthly_activity.how_executed,
        monthly_activity.call_recordtype
 FROM reporting.monthly_activity
 ORDER BY monthly_activity.customer_id,
          monthly_activity.tvcmid,
          monthly_activity.ims_id
SEGMENTED BY hash(monthly_activity.tvcmid) ALL NODES;

CREATE PROJECTION reporting.to_monthly_account_summary_b0 /*+basename(to_monthly_account_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 target,
 new_account,
 market_volume_indicator,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg
)
AS
 SELECT to_monthly_account_summary.sales_force_id,
        to_monthly_account_summary.nation_id,
        to_monthly_account_summary.nation,
        to_monthly_account_summary.area_id,
        to_monthly_account_summary.area,
        to_monthly_account_summary.region_id,
        to_monthly_account_summary.region,
        to_monthly_account_summary.territory_id,
        to_monthly_account_summary.territory,
        to_monthly_account_summary.rep_name,
        to_monthly_account_summary.user_id,
        to_monthly_account_summary.time_period,
        to_monthly_account_summary.period_type,
        to_monthly_account_summary.period,
        to_monthly_account_summary.market_id,
        to_monthly_account_summary.market_name,
        to_monthly_account_summary.brand_id,
        to_monthly_account_summary.brand_name,
        to_monthly_account_summary.teva_product_flag,
        to_monthly_account_summary.customer_id,
        to_monthly_account_summary.tvcmid,
        to_monthly_account_summary.network_name,
        to_monthly_account_summary.account_name,
        to_monthly_account_summary.channel,
        to_monthly_account_summary.address,
        to_monthly_account_summary.city,
        to_monthly_account_summary.state,
        to_monthly_account_summary.zip,
        to_monthly_account_summary.formulary_control,
        to_monthly_account_summary.gpo,
        to_monthly_account_summary.target,
        to_monthly_account_summary.new_account,
        to_monthly_account_summary.market_volume_indicator,
        to_monthly_account_summary.product_vol_dollars,
        to_monthly_account_summary.product_vol_mg,
        to_monthly_account_summary.product_vol_mcg,
        to_monthly_account_summary.market_vol_dollars,
        to_monthly_account_summary.market_vol_mg,
        to_monthly_account_summary.market_vol_mcg,
        to_monthly_account_summary.prev_prod_vol_dollars,
        to_monthly_account_summary.prev_prod_vol_mg,
        to_monthly_account_summary.prev_prod_vol_mcg,
        to_monthly_account_summary.prev_market_vol_dollars,
        to_monthly_account_summary.prev_market_vol_mg,
        to_monthly_account_summary.prev_market_vol_mcg
 FROM reporting.to_monthly_account_summary
 ORDER BY to_monthly_account_summary.sales_force_id,
          to_monthly_account_summary.nation_id,
          to_monthly_account_summary.nation,
          to_monthly_account_summary.area_id,
          to_monthly_account_summary.area,
          to_monthly_account_summary.region_id,
          to_monthly_account_summary.region,
          to_monthly_account_summary.territory_id
SEGMENTED BY hash(to_monthly_account_summary.sales_force_id, to_monthly_account_summary.market_id, to_monthly_account_summary.brand_id, to_monthly_account_summary.teva_product_flag, to_monthly_account_summary.tvcmid, to_monthly_account_summary.state, to_monthly_account_summary.zip, to_monthly_account_summary.new_account) ALL NODES;

CREATE PROJECTION reporting.geography_access_b0 /*+basename(geography_access),createtype(L)*/ 
(
 geography_id,
 authorized_user_ids
)
AS
 SELECT geography_access.geography_id,
        geography_access.authorized_user_ids
 FROM reporting.geography_access
 ORDER BY geography_access.geography_id
SEGMENTED BY hash(geography_access.geography_id) ALL NODES;

CREATE PROJECTION reporting.geography_access_transaction_b0 /*+basename(geography_access_transaction),createtype(L)*/ 
(
 geography_id,
 authorized_user_ids
)
AS
 SELECT geography_access_transaction.geography_id,
        geography_access_transaction.authorized_user_ids
 FROM reporting.geography_access_transaction
 ORDER BY geography_access_transaction.geography_id
SEGMENTED BY hash(geography_access_transaction.geography_id) ALL NODES;

CREATE PROJECTION reporting.tp_weekly_payer_prescriber_summary_b0 /*+basename(tp_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT tp_weekly_payer_prescriber_summary.sales_force_id,
        tp_weekly_payer_prescriber_summary.nation_id,
        tp_weekly_payer_prescriber_summary.nation,
        tp_weekly_payer_prescriber_summary.area_id,
        tp_weekly_payer_prescriber_summary.area,
        tp_weekly_payer_prescriber_summary.region_id,
        tp_weekly_payer_prescriber_summary.region,
        tp_weekly_payer_prescriber_summary.territory_id,
        tp_weekly_payer_prescriber_summary.territory,
        tp_weekly_payer_prescriber_summary.rep_name,
        tp_weekly_payer_prescriber_summary.user_id,
        tp_weekly_payer_prescriber_summary.time_period,
        tp_weekly_payer_prescriber_summary.period_type,
        tp_weekly_payer_prescriber_summary.period,
        tp_weekly_payer_prescriber_summary.market_id,
        tp_weekly_payer_prescriber_summary.market_name,
        tp_weekly_payer_prescriber_summary.brand_id,
        tp_weekly_payer_prescriber_summary.brand_name,
        tp_weekly_payer_prescriber_summary.teva_product_flag,
        tp_weekly_payer_prescriber_summary.payer_id,
        tp_weekly_payer_prescriber_summary.payer_name,
        tp_weekly_payer_prescriber_summary.plan_id,
        tp_weekly_payer_prescriber_summary.plan_name,
        tp_weekly_payer_prescriber_summary.payer_plan_id,
        tp_weekly_payer_prescriber_summary.customer_id,
        tp_weekly_payer_prescriber_summary.tvcmid,
        tp_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        tp_weekly_payer_prescriber_summary.prescriber_name,
        tp_weekly_payer_prescriber_summary.pdrp_flag,
        tp_weekly_payer_prescriber_summary.hcp_restriction_flag,
        tp_weekly_payer_prescriber_summary.address,
        tp_weekly_payer_prescriber_summary.city,
        tp_weekly_payer_prescriber_summary.state,
        tp_weekly_payer_prescriber_summary.zip,
        tp_weekly_payer_prescriber_summary.target_status_flag,
        tp_weekly_payer_prescriber_summary.partner_target_status_flag,
        tp_weekly_payer_prescriber_summary.method_of_payment,
        tp_weekly_payer_prescriber_summary.specialty,
        tp_weekly_payer_prescriber_summary.segment,
        tp_weekly_payer_prescriber_summary.decile,
        tp_weekly_payer_prescriber_summary.market_volume_indicator,
        tp_weekly_payer_prescriber_summary.product_vol_trx_count,
        tp_weekly_payer_prescriber_summary.market_vol_trx_count,
        tp_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        tp_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        tp_weekly_payer_prescriber_summary.product_vol_nrx_count,
        tp_weekly_payer_prescriber_summary.market_vol_nrx_count,
        tp_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        tp_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        tp_weekly_payer_prescriber_summary.samples,
        tp_weekly_payer_prescriber_summary.details_p1,
        tp_weekly_payer_prescriber_summary.details_p2,
        tp_weekly_payer_prescriber_summary.details_p3,
        tp_weekly_payer_prescriber_summary.focus_target
 FROM reporting.tp_weekly_payer_prescriber_summary
 ORDER BY tp_weekly_payer_prescriber_summary.sales_force_id,
          tp_weekly_payer_prescriber_summary.nation_id,
          tp_weekly_payer_prescriber_summary.nation,
          tp_weekly_payer_prescriber_summary.area_id,
          tp_weekly_payer_prescriber_summary.area,
          tp_weekly_payer_prescriber_summary.region_id,
          tp_weekly_payer_prescriber_summary.region,
          tp_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(tp_weekly_payer_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.tn_monthly_prescriber_summary_b0 /*+basename(tn_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tn_monthly_prescriber_summary.sales_force_id,
        tn_monthly_prescriber_summary.nation_id,
        tn_monthly_prescriber_summary.nation,
        tn_monthly_prescriber_summary.area_id,
        tn_monthly_prescriber_summary.area,
        tn_monthly_prescriber_summary.region_id,
        tn_monthly_prescriber_summary.region,
        tn_monthly_prescriber_summary.territory_id,
        tn_monthly_prescriber_summary.territory,
        tn_monthly_prescriber_summary.rep_name,
        tn_monthly_prescriber_summary.user_id,
        tn_monthly_prescriber_summary.time_period,
        tn_monthly_prescriber_summary.period_type,
        tn_monthly_prescriber_summary.period,
        tn_monthly_prescriber_summary.market_id,
        tn_monthly_prescriber_summary.market_name,
        tn_monthly_prescriber_summary.brand_id,
        tn_monthly_prescriber_summary.brand_name,
        tn_monthly_prescriber_summary.teva_product_flag,
        tn_monthly_prescriber_summary.customer_id,
        tn_monthly_prescriber_summary.tvcmid,
        tn_monthly_prescriber_summary.pdrp_flag,
        tn_monthly_prescriber_summary.hcp_restriction_flag,
        tn_monthly_prescriber_summary.prescriber_name,
        tn_monthly_prescriber_summary.new_prescriber,
        tn_monthly_prescriber_summary.address,
        tn_monthly_prescriber_summary.city,
        tn_monthly_prescriber_summary.state,
        tn_monthly_prescriber_summary.zip,
        tn_monthly_prescriber_summary.target_status_flag,
        tn_monthly_prescriber_summary.partner_target_status_flag,
        tn_monthly_prescriber_summary.method_of_payment,
        tn_monthly_prescriber_summary.specialty,
        tn_monthly_prescriber_summary.segment,
        tn_monthly_prescriber_summary.decile,
        tn_monthly_prescriber_summary.market_volume_indicator,
        tn_monthly_prescriber_summary.product_vol_trx_count,
        tn_monthly_prescriber_summary.market_vol_trx_count,
        tn_monthly_prescriber_summary.prev_prod_vol_trx_count,
        tn_monthly_prescriber_summary.prev_market_vol_trx_count,
        tn_monthly_prescriber_summary.product_vol_nrx_count,
        tn_monthly_prescriber_summary.market_vol_nrx_count,
        tn_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        tn_monthly_prescriber_summary.prev_market_vol_nrx_count,
        tn_monthly_prescriber_summary.samples,
        tn_monthly_prescriber_summary.details_p1,
        tn_monthly_prescriber_summary.details_p2,
        tn_monthly_prescriber_summary.details_p3
 FROM reporting.tn_monthly_prescriber_summary
 ORDER BY tn_monthly_prescriber_summary.customer_id,
          tn_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(tn_monthly_prescriber_summary.sales_force_id, tn_monthly_prescriber_summary.market_id, tn_monthly_prescriber_summary.brand_id, tn_monthly_prescriber_summary.teva_product_flag, tn_monthly_prescriber_summary.tvcmid, tn_monthly_prescriber_summary.pdrp_flag, tn_monthly_prescriber_summary.hcp_restriction_flag, tn_monthly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.tn_monthly_payer_prescriber_summary_b0 /*+basename(tn_monthly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT tn_monthly_payer_prescriber_summary.sales_force_id,
        tn_monthly_payer_prescriber_summary.nation_id,
        tn_monthly_payer_prescriber_summary.nation,
        tn_monthly_payer_prescriber_summary.area_id,
        tn_monthly_payer_prescriber_summary.area,
        tn_monthly_payer_prescriber_summary.region_id,
        tn_monthly_payer_prescriber_summary.region,
        tn_monthly_payer_prescriber_summary.territory_id,
        tn_monthly_payer_prescriber_summary.territory,
        tn_monthly_payer_prescriber_summary.rep_name,
        tn_monthly_payer_prescriber_summary.user_id,
        tn_monthly_payer_prescriber_summary.time_period,
        tn_monthly_payer_prescriber_summary.period_type,
        tn_monthly_payer_prescriber_summary.period,
        tn_monthly_payer_prescriber_summary.market_id,
        tn_monthly_payer_prescriber_summary.market_name,
        tn_monthly_payer_prescriber_summary.brand_id,
        tn_monthly_payer_prescriber_summary.brand_name,
        tn_monthly_payer_prescriber_summary.teva_product_flag,
        tn_monthly_payer_prescriber_summary.payer_id,
        tn_monthly_payer_prescriber_summary.payer_name,
        tn_monthly_payer_prescriber_summary.plan_id,
        tn_monthly_payer_prescriber_summary.plan_name,
        tn_monthly_payer_prescriber_summary.payer_plan_id,
        tn_monthly_payer_prescriber_summary.customer_id,
        tn_monthly_payer_prescriber_summary.tvcmid,
        tn_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        tn_monthly_payer_prescriber_summary.prescriber_name,
        tn_monthly_payer_prescriber_summary.pdrp_flag,
        tn_monthly_payer_prescriber_summary.hcp_restriction_flag,
        tn_monthly_payer_prescriber_summary.address,
        tn_monthly_payer_prescriber_summary.city,
        tn_monthly_payer_prescriber_summary.state,
        tn_monthly_payer_prescriber_summary.zip,
        tn_monthly_payer_prescriber_summary.target_status_flag,
        tn_monthly_payer_prescriber_summary.partner_target_status_flag,
        tn_monthly_payer_prescriber_summary.method_of_payment,
        tn_monthly_payer_prescriber_summary.specialty,
        tn_monthly_payer_prescriber_summary.segment,
        tn_monthly_payer_prescriber_summary.decile,
        tn_monthly_payer_prescriber_summary.market_volume_indicator,
        tn_monthly_payer_prescriber_summary.product_vol_trx_count,
        tn_monthly_payer_prescriber_summary.market_vol_trx_count,
        tn_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        tn_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        tn_monthly_payer_prescriber_summary.product_vol_nrx_count,
        tn_monthly_payer_prescriber_summary.market_vol_nrx_count,
        tn_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        tn_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        tn_monthly_payer_prescriber_summary.samples,
        tn_monthly_payer_prescriber_summary.details_p1,
        tn_monthly_payer_prescriber_summary.details_p2,
        tn_monthly_payer_prescriber_summary.details_p3,
        tn_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        tn_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        tn_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        tn_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        tn_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        tn_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        tn_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        tn_monthly_payer_prescriber_summary.focus_target
 FROM reporting.tn_monthly_payer_prescriber_summary
 ORDER BY tn_monthly_payer_prescriber_summary.customer_id
SEGMENTED BY hash(tn_monthly_payer_prescriber_summary.sales_force_id, tn_monthly_payer_prescriber_summary.market_id, tn_monthly_payer_prescriber_summary.brand_id, tn_monthly_payer_prescriber_summary.teva_product_flag, tn_monthly_payer_prescriber_summary.payer_id, tn_monthly_payer_prescriber_summary.plan_id, tn_monthly_payer_prescriber_summary.tvcmid, tn_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tn_monthly_payer_geography_summary_b0 /*+basename(tn_monthly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count
)
AS
 SELECT tn_monthly_payer_geography_summary.sales_force_id,
        tn_monthly_payer_geography_summary.geography_level,
        tn_monthly_payer_geography_summary.geography_id,
        tn_monthly_payer_geography_summary.geography,
        tn_monthly_payer_geography_summary.rep_name,
        tn_monthly_payer_geography_summary.user_id,
        tn_monthly_payer_geography_summary.time_period,
        tn_monthly_payer_geography_summary.period_type,
        tn_monthly_payer_geography_summary.period,
        tn_monthly_payer_geography_summary.payer_id,
        tn_monthly_payer_geography_summary.payer_name,
        tn_monthly_payer_geography_summary.plan_id,
        tn_monthly_payer_geography_summary.plan_name,
        tn_monthly_payer_geography_summary.payer_plan_id,
        tn_monthly_payer_geography_summary.market_id,
        tn_monthly_payer_geography_summary.market_name,
        tn_monthly_payer_geography_summary.brand_id,
        tn_monthly_payer_geography_summary.brand_name,
        tn_monthly_payer_geography_summary.teva_product_flag,
        tn_monthly_payer_geography_summary.method_of_payment,
        tn_monthly_payer_geography_summary.market_volume_indicator,
        tn_monthly_payer_geography_summary.geo_plan_vol_rank,
        tn_monthly_payer_geography_summary.product_vol_trx_count,
        tn_monthly_payer_geography_summary.market_vol_trx_count,
        tn_monthly_payer_geography_summary.prev_prod_vol_trx_count,
        tn_monthly_payer_geography_summary.prev_market_vol_trx_count,
        tn_monthly_payer_geography_summary.product_vol_nrx_count,
        tn_monthly_payer_geography_summary.market_vol_nrx_count,
        tn_monthly_payer_geography_summary.prev_prod_vol_nrx_count,
        tn_monthly_payer_geography_summary.prev_market_vol_nrx_count,
        tn_monthly_payer_geography_summary.Nation_Product_TRx_Count,
        tn_monthly_payer_geography_summary.Nation_Product_NRx_Count,
        tn_monthly_payer_geography_summary.Nation_Market_TRx_Count,
        tn_monthly_payer_geography_summary.Nation_Market_NRx_Count
 FROM reporting.tn_monthly_payer_geography_summary
 ORDER BY tn_monthly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(tn_monthly_payer_geography_summary.sales_force_id, tn_monthly_payer_geography_summary.payer_id, tn_monthly_payer_geography_summary.plan_id, tn_monthly_payer_geography_summary.market_id, tn_monthly_payer_geography_summary.brand_id, tn_monthly_payer_geography_summary.teva_product_flag, tn_monthly_payer_geography_summary.market_volume_indicator, tn_monthly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.mb_par_rnf_b0 /*+basename(mb_par_rnf),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 time_period,
 period_type,
 period,
 decile,
 segment,
 specialty,
 target_status,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 samples,
 prescriber_count_calls,
 prescriber_count_samples,
 prescriber_reached_calls,
 prescriber_reached_samples,
 how_executed
)
AS
 SELECT mb_par_rnf.sales_force_id,
        mb_par_rnf.geography_level,
        mb_par_rnf.geography_id,
        mb_par_rnf.geography,
        mb_par_rnf.rep_name,
        mb_par_rnf.user_id,
        mb_par_rnf.market_id,
        mb_par_rnf.market_name,
        mb_par_rnf.brand_id,
        mb_par_rnf.brand_name,
        mb_par_rnf.time_period,
        mb_par_rnf.period_type,
        mb_par_rnf.period,
        mb_par_rnf.decile,
        mb_par_rnf.segment,
        mb_par_rnf.specialty,
        mb_par_rnf.target_status,
        mb_par_rnf.details_p1,
        mb_par_rnf.details_p2,
        mb_par_rnf.details_p3,
        mb_par_rnf.total_details,
        mb_par_rnf.samples,
        mb_par_rnf.prescriber_count_calls,
        mb_par_rnf.prescriber_count_samples,
        mb_par_rnf.prescriber_reached_calls,
        mb_par_rnf.prescriber_reached_samples,
        mb_par_rnf.how_executed
 FROM reporting.mb_par_rnf
 ORDER BY mb_par_rnf.sales_force_id,
          mb_par_rnf.geography_level,
          mb_par_rnf.geography_id,
          mb_par_rnf.geography,
          mb_par_rnf.rep_name,
          mb_par_rnf.user_id,
          mb_par_rnf.market_id,
          mb_par_rnf.market_name
SEGMENTED BY hash(mb_par_rnf.sales_force_id, mb_par_rnf.market_id, mb_par_rnf.brand_id, mb_par_rnf.details_p1, mb_par_rnf.details_p2, mb_par_rnf.details_p3, mb_par_rnf.total_details, mb_par_rnf.samples) ALL NODES;

CREATE PROJECTION reporting.sa_pre_call_summary_b0 /*+basename(sa_pre_call_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT sa_pre_call_summary.sales_force_id,
        sa_pre_call_summary.nation_id,
        sa_pre_call_summary.nation,
        sa_pre_call_summary.area_id,
        sa_pre_call_summary.area,
        sa_pre_call_summary.region_id,
        sa_pre_call_summary.region,
        sa_pre_call_summary.territory_id,
        sa_pre_call_summary.territory,
        sa_pre_call_summary.rep_name,
        sa_pre_call_summary.user_id,
        sa_pre_call_summary.time_period,
        sa_pre_call_summary.period_type,
        sa_pre_call_summary.period,
        sa_pre_call_summary.market_id,
        sa_pre_call_summary.market_name,
        sa_pre_call_summary.brand_id,
        sa_pre_call_summary.brand_name,
        sa_pre_call_summary.teva_product_flag,
        sa_pre_call_summary.payer_id,
        sa_pre_call_summary.payer_name,
        sa_pre_call_summary.plan_id,
        sa_pre_call_summary.plan_name,
        sa_pre_call_summary.payer_plan_id,
        sa_pre_call_summary.customer_id,
        sa_pre_call_summary.tvcmid,
        sa_pre_call_summary.hcp_plan_vol_rank,
        sa_pre_call_summary.prescriber_name,
        sa_pre_call_summary.pdrp_flag,
        sa_pre_call_summary.hcp_restriction_flag,
        sa_pre_call_summary.address,
        sa_pre_call_summary.city,
        sa_pre_call_summary.state,
        sa_pre_call_summary.zip,
        sa_pre_call_summary.target_status_flag,
        sa_pre_call_summary.partner_target_status_flag,
        sa_pre_call_summary.method_of_payment,
        sa_pre_call_summary.specialty,
        sa_pre_call_summary.segment,
        sa_pre_call_summary.decile,
        sa_pre_call_summary.market_volume_indicator,
        sa_pre_call_summary.product_vol_trx_count,
        sa_pre_call_summary.market_vol_trx_count,
        sa_pre_call_summary.prev_prod_vol_trx_count,
        sa_pre_call_summary.prev_market_vol_trx_count,
        sa_pre_call_summary.product_vol_nrx_count,
        sa_pre_call_summary.market_vol_nrx_count,
        sa_pre_call_summary.prev_prod_vol_nrx_count,
        sa_pre_call_summary.prev_market_vol_nrx_count,
        sa_pre_call_summary.samples,
        sa_pre_call_summary.details_p1,
        sa_pre_call_summary.details_p2,
        sa_pre_call_summary.details_p3,
        sa_pre_call_summary.focus_target
 FROM reporting.sa_pre_call_summary
 ORDER BY sa_pre_call_summary.sales_force_id,
          sa_pre_call_summary.nation_id,
          sa_pre_call_summary.nation,
          sa_pre_call_summary.area_id,
          sa_pre_call_summary.area,
          sa_pre_call_summary.region_id,
          sa_pre_call_summary.region,
          sa_pre_call_summary.territory_id
SEGMENTED BY hash(sa_pre_call_summary.sales_force_id, sa_pre_call_summary.market_id, sa_pre_call_summary.brand_id, sa_pre_call_summary.teva_product_flag, sa_pre_call_summary.payer_id, sa_pre_call_summary.plan_id, sa_pre_call_summary.tvcmid, sa_pre_call_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.weekly_prescriber_sales_summary_2330_b0 /*+basename(weekly_prescriber_sales_summary_2330),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 week_ending,
 week_bucket,
 market_id,
 brand_id,
 method_of_payment,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT weekly_prescriber_sales_summary.sales_force_id,
        weekly_prescriber_sales_summary.customer_id,
        weekly_prescriber_sales_summary.tvcmid,
        weekly_prescriber_sales_summary.ims_id,
        weekly_prescriber_sales_summary.period_type,
        weekly_prescriber_sales_summary.period,
        weekly_prescriber_sales_summary.week_ending,
        weekly_prescriber_sales_summary.week_bucket,
        weekly_prescriber_sales_summary.market_id,
        weekly_prescriber_sales_summary.brand_id,
        weekly_prescriber_sales_summary.method_of_payment,
        weekly_prescriber_sales_summary.product_vol_trx_count,
        weekly_prescriber_sales_summary.prev_prod_vol_trx_count,
        weekly_prescriber_sales_summary.product_vol_nrx_count,
        weekly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        weekly_prescriber_sales_summary.market_vol_trx_count,
        weekly_prescriber_sales_summary.prev_market_vol_trx_count,
        weekly_prescriber_sales_summary.market_vol_nrx_count,
        weekly_prescriber_sales_summary.prev_market_vol_nrx_count,
        weekly_prescriber_sales_summary.samples,
        weekly_prescriber_sales_summary.details_p1,
        weekly_prescriber_sales_summary.details_p2,
        weekly_prescriber_sales_summary.details_p3
 FROM reporting.weekly_prescriber_sales_summary
 ORDER BY weekly_prescriber_sales_summary.sales_force_id,
          weekly_prescriber_sales_summary.customer_id,
          weekly_prescriber_sales_summary.tvcmid,
          weekly_prescriber_sales_summary.ims_id,
          weekly_prescriber_sales_summary.period_type,
          weekly_prescriber_sales_summary.period,
          weekly_prescriber_sales_summary.week_ending,
          weekly_prescriber_sales_summary.week_bucket,
          weekly_prescriber_sales_summary.market_id,
          weekly_prescriber_sales_summary.brand_id,
          weekly_prescriber_sales_summary.method_of_payment
SEGMENTED BY hash(weekly_prescriber_sales_summary.sales_force_id, weekly_prescriber_sales_summary.customer_id, weekly_prescriber_sales_summary.tvcmid, weekly_prescriber_sales_summary.ims_id, weekly_prescriber_sales_summary.period_type, weekly_prescriber_sales_summary.period, weekly_prescriber_sales_summary.week_ending, weekly_prescriber_sales_summary.week_bucket, weekly_prescriber_sales_summary.market_id, weekly_prescriber_sales_summary.brand_id, weekly_prescriber_sales_summary.method_of_payment) ALL NODES;

CREATE PROJECTION reporting.ajovy_reverse_geo_payer_weekly_bkp_0124_b0 /*+basename(ajovy_reverse_geo_payer_weekly_bkp_0124),createtype(A)*/ 
(
 ns_nation_id,
 ns_nation,
 ns_area_id,
 ns_area,
 ns_region_id,
 ns_region,
 ns_territory_id,
 ns_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 lives_covered
)
AS
 SELECT ajovy_reverse_geo_payer_weekly_bkp_0124.ns_nation_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_nation,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_area_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_area,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_region_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_region,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_territory_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ns_territory,
        ajovy_reverse_geo_payer_weekly_bkp_0124.market_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.market_name,
        ajovy_reverse_geo_payer_weekly_bkp_0124.brand_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.brand_name,
        ajovy_reverse_geo_payer_weekly_bkp_0124.teva_product_flag,
        ajovy_reverse_geo_payer_weekly_bkp_0124.time_period,
        ajovy_reverse_geo_payer_weekly_bkp_0124.period_type,
        ajovy_reverse_geo_payer_weekly_bkp_0124.period,
        ajovy_reverse_geo_payer_weekly_bkp_0124.pbm_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.pbm_name,
        ajovy_reverse_geo_payer_weekly_bkp_0124.payer_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.payer_name,
        ajovy_reverse_geo_payer_weekly_bkp_0124.plan_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.plan_name,
        ajovy_reverse_geo_payer_weekly_bkp_0124.payer_plan_id,
        ajovy_reverse_geo_payer_weekly_bkp_0124.method_of_payment,
        ajovy_reverse_geo_payer_weekly_bkp_0124.state,
        ajovy_reverse_geo_payer_weekly_bkp_0124.zip,
        ajovy_reverse_geo_payer_weekly_bkp_0124.final_key_controlling_account,
        ajovy_reverse_geo_payer_weekly_bkp_0124.key_parent_account,
        ajovy_reverse_geo_payer_weekly_bkp_0124.ajovy_formulary_status,
        ajovy_reverse_geo_payer_weekly_bkp_0124.aimovig_formulary_status,
        ajovy_reverse_geo_payer_weekly_bkp_0124.emgality_formulary_status,
        ajovy_reverse_geo_payer_weekly_bkp_0124.plan_payment_type,
        ajovy_reverse_geo_payer_weekly_bkp_0124.market_volume_indicator,
        ajovy_reverse_geo_payer_weekly_bkp_0124.product_vol_trx_count,
        ajovy_reverse_geo_payer_weekly_bkp_0124.market_vol_trx_count,
        ajovy_reverse_geo_payer_weekly_bkp_0124.product_vol_nrx_count,
        ajovy_reverse_geo_payer_weekly_bkp_0124.market_vol_nrx_count,
        ajovy_reverse_geo_payer_weekly_bkp_0124.lives_covered
 FROM reporting.ajovy_reverse_geo_payer_weekly_bkp_0124
 ORDER BY ajovy_reverse_geo_payer_weekly_bkp_0124.ns_nation_id,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_nation,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_area_id,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_area,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_region_id,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_region,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_territory_id,
          ajovy_reverse_geo_payer_weekly_bkp_0124.ns_territory
SEGMENTED BY hash(ajovy_reverse_geo_payer_weekly_bkp_0124.ns_nation_id, ajovy_reverse_geo_payer_weekly_bkp_0124.ns_area_id, ajovy_reverse_geo_payer_weekly_bkp_0124.ns_region_id, ajovy_reverse_geo_payer_weekly_bkp_0124.ns_territory_id, ajovy_reverse_geo_payer_weekly_bkp_0124.market_id, ajovy_reverse_geo_payer_weekly_bkp_0124.brand_id, ajovy_reverse_geo_payer_weekly_bkp_0124.teva_product_flag, ajovy_reverse_geo_payer_weekly_bkp_0124.pbm_id) ALL NODES;

CREATE PROJECTION reporting.austedo_titration_dosage_b0 /*+basename(austedo_titration_dosage),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 zip,
 sales_force_id,
 territory_id,
 territory_name,
 region_id,
 region_name,
 area_id,
 area_name,
 product_name,
 data_type,
 Avg_TD_Daily_Dose_New_Patient,
 Avg_TD_Daily_Dose_Cont_Patient,
 Data_Ending_Month
)
AS
 SELECT austedo_titration_dosage.customer_id,
        austedo_titration_dosage.tvcmid,
        austedo_titration_dosage.ims_id,
        austedo_titration_dosage.zip,
        austedo_titration_dosage.sales_force_id,
        austedo_titration_dosage.territory_id,
        austedo_titration_dosage.territory_name,
        austedo_titration_dosage.region_id,
        austedo_titration_dosage.region_name,
        austedo_titration_dosage.area_id,
        austedo_titration_dosage.area_name,
        austedo_titration_dosage.product_name,
        austedo_titration_dosage.data_type,
        austedo_titration_dosage.Avg_TD_Daily_Dose_New_Patient,
        austedo_titration_dosage.Avg_TD_Daily_Dose_Cont_Patient,
        austedo_titration_dosage.Data_Ending_Month
 FROM reporting.austedo_titration_dosage
 ORDER BY austedo_titration_dosage.customer_id,
          austedo_titration_dosage.tvcmid,
          austedo_titration_dosage.ims_id,
          austedo_titration_dosage.zip,
          austedo_titration_dosage.sales_force_id,
          austedo_titration_dosage.territory_id,
          austedo_titration_dosage.territory_name,
          austedo_titration_dosage.region_id
SEGMENTED BY hash(austedo_titration_dosage.Data_Ending_Month) ALL NODES;

CREATE PROJECTION reporting.payer_mapping_b0 /*+basename(payer_mapping),createtype(L)*/ 
(
 payer_plan_id,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 model_id,
 method_of_payment
)
AS
 SELECT payer_mapping.payer_plan_id,
        payer_mapping.pbm_id,
        payer_mapping.pbm_name,
        payer_mapping.payer_id,
        payer_mapping.payer_name,
        payer_mapping.plan_id,
        payer_mapping.plan_name,
        payer_mapping.model_id,
        payer_mapping.method_of_payment
 FROM reporting.payer_mapping
 ORDER BY payer_mapping.payer_plan_id
SEGMENTED BY hash(payer_mapping.payer_plan_id) ALL NODES;

CREATE PROJECTION reporting.tmp_oncology_account_detail_periods_b0 /*+basename(tmp_oncology_account_detail_periods),createtype(A)*/ 
(
 sales_force_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 period,
 month_bucket,
 brand_id,
 brand_name,
 teva_product_flag,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 territory_count,
 region_count,
 area_count,
 sales_force_count,
 target,
 new_account,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg
)
AS
 SELECT tmp_oncology_account_detail_periods.sales_force_id,
        tmp_oncology_account_detail_periods.nation,
        tmp_oncology_account_detail_periods.area_id,
        tmp_oncology_account_detail_periods.area,
        tmp_oncology_account_detail_periods.region_id,
        tmp_oncology_account_detail_periods.region,
        tmp_oncology_account_detail_periods.territory_id,
        tmp_oncology_account_detail_periods.territory,
        tmp_oncology_account_detail_periods.period,
        tmp_oncology_account_detail_periods.month_bucket,
        tmp_oncology_account_detail_periods.brand_id,
        tmp_oncology_account_detail_periods.brand_name,
        tmp_oncology_account_detail_periods.teva_product_flag,
        tmp_oncology_account_detail_periods.tvcmid,
        tmp_oncology_account_detail_periods.network_name,
        tmp_oncology_account_detail_periods.account_name,
        tmp_oncology_account_detail_periods.channel,
        tmp_oncology_account_detail_periods.address,
        tmp_oncology_account_detail_periods.city,
        tmp_oncology_account_detail_periods.state,
        tmp_oncology_account_detail_periods.zip,
        tmp_oncology_account_detail_periods.formulary_control,
        tmp_oncology_account_detail_periods.gpo,
        tmp_oncology_account_detail_periods.territory_count,
        tmp_oncology_account_detail_periods.region_count,
        tmp_oncology_account_detail_periods.area_count,
        tmp_oncology_account_detail_periods.sales_force_count,
        tmp_oncology_account_detail_periods.target,
        tmp_oncology_account_detail_periods.new_account,
        tmp_oncology_account_detail_periods.product_vol_dollars,
        tmp_oncology_account_detail_periods.product_vol_mg,
        tmp_oncology_account_detail_periods.product_vol_mcg,
        tmp_oncology_account_detail_periods.market_vol_dollars,
        tmp_oncology_account_detail_periods.market_vol_mg,
        tmp_oncology_account_detail_periods.market_vol_mcg,
        tmp_oncology_account_detail_periods.prev_prod_vol_dollars,
        tmp_oncology_account_detail_periods.prev_prod_vol_mg,
        tmp_oncology_account_detail_periods.prev_prod_vol_mcg,
        tmp_oncology_account_detail_periods.prev_market_vol_dollars,
        tmp_oncology_account_detail_periods.prev_market_vol_mg,
        tmp_oncology_account_detail_periods.prev_market_vol_mcg
 FROM reporting.tmp_oncology_account_detail_periods
 ORDER BY tmp_oncology_account_detail_periods.sales_force_id,
          tmp_oncology_account_detail_periods.nation,
          tmp_oncology_account_detail_periods.area_id,
          tmp_oncology_account_detail_periods.area,
          tmp_oncology_account_detail_periods.region_id,
          tmp_oncology_account_detail_periods.region,
          tmp_oncology_account_detail_periods.territory_id,
          tmp_oncology_account_detail_periods.territory,
          tmp_oncology_account_detail_periods.period,
          tmp_oncology_account_detail_periods.month_bucket,
          tmp_oncology_account_detail_periods.brand_id,
          tmp_oncology_account_detail_periods.brand_name,
          tmp_oncology_account_detail_periods.teva_product_flag,
          tmp_oncology_account_detail_periods.tvcmid,
          tmp_oncology_account_detail_periods.network_name,
          tmp_oncology_account_detail_periods.account_name,
          tmp_oncology_account_detail_periods.channel,
          tmp_oncology_account_detail_periods.address,
          tmp_oncology_account_detail_periods.city,
          tmp_oncology_account_detail_periods.state,
          tmp_oncology_account_detail_periods.zip,
          tmp_oncology_account_detail_periods.formulary_control,
          tmp_oncology_account_detail_periods.gpo,
          tmp_oncology_account_detail_periods.territory_count,
          tmp_oncology_account_detail_periods.region_count,
          tmp_oncology_account_detail_periods.area_count,
          tmp_oncology_account_detail_periods.sales_force_count,
          tmp_oncology_account_detail_periods.target,
          tmp_oncology_account_detail_periods.new_account,
          tmp_oncology_account_detail_periods.product_vol_dollars,
          tmp_oncology_account_detail_periods.product_vol_mg,
          tmp_oncology_account_detail_periods.product_vol_mcg,
          tmp_oncology_account_detail_periods.market_vol_dollars,
          tmp_oncology_account_detail_periods.market_vol_mg,
          tmp_oncology_account_detail_periods.market_vol_mcg,
          tmp_oncology_account_detail_periods.prev_prod_vol_dollars,
          tmp_oncology_account_detail_periods.prev_prod_vol_mg,
          tmp_oncology_account_detail_periods.prev_prod_vol_mcg,
          tmp_oncology_account_detail_periods.prev_market_vol_dollars,
          tmp_oncology_account_detail_periods.prev_market_vol_mg,
          tmp_oncology_account_detail_periods.prev_market_vol_mcg
SEGMENTED BY hash(hash(tmp_oncology_account_detail_periods.sales_force_id, tmp_oncology_account_detail_periods.nation, tmp_oncology_account_detail_periods.area_id, tmp_oncology_account_detail_periods.area, tmp_oncology_account_detail_periods.region_id, tmp_oncology_account_detail_periods.region, tmp_oncology_account_detail_periods.territory_id, tmp_oncology_account_detail_periods.territory, tmp_oncology_account_detail_periods.period, tmp_oncology_account_detail_periods.month_bucket, tmp_oncology_account_detail_periods.brand_id, tmp_oncology_account_detail_periods.brand_name, tmp_oncology_account_detail_periods.teva_product_flag, tmp_oncology_account_detail_periods.tvcmid, tmp_oncology_account_detail_periods.network_name, tmp_oncology_account_detail_periods.account_name, tmp_oncology_account_detail_periods.channel, tmp_oncology_account_detail_periods.address, tmp_oncology_account_detail_periods.city, tmp_oncology_account_detail_periods.state, tmp_oncology_account_detail_periods.zip, tmp_oncology_account_detail_periods.formulary_control, tmp_oncology_account_detail_periods.gpo, tmp_oncology_account_detail_periods.territory_count, tmp_oncology_account_detail_periods.region_count, tmp_oncology_account_detail_periods.area_count, tmp_oncology_account_detail_periods.sales_force_count, tmp_oncology_account_detail_periods.target, tmp_oncology_account_detail_periods.new_account, tmp_oncology_account_detail_periods.product_vol_dollars, tmp_oncology_account_detail_periods.product_vol_mg, tmp_oncology_account_detail_periods.product_vol_mcg), tmp_oncology_account_detail_periods.market_vol_dollars, tmp_oncology_account_detail_periods.market_vol_mg, tmp_oncology_account_detail_periods.market_vol_mcg, tmp_oncology_account_detail_periods.prev_prod_vol_dollars, tmp_oncology_account_detail_periods.prev_prod_vol_mg, tmp_oncology_account_detail_periods.prev_prod_vol_mcg, tmp_oncology_account_detail_periods.prev_market_vol_dollars, tmp_oncology_account_detail_periods.prev_market_vol_mg, tmp_oncology_account_detail_periods.prev_market_vol_mcg) ALL NODES;

CREATE PROJECTION reporting.specialty_mapping_b0 /*+basename(specialty_mapping),createtype(L)*/ 
(
 ims_specialty_code,
 sales_force_id,
 market_id,
 specialty_description,
 specialty_group
)
AS
 SELECT specialty_mapping.ims_specialty_code,
        specialty_mapping.sales_force_id,
        specialty_mapping.market_id,
        specialty_mapping.specialty_description,
        specialty_mapping.specialty_group
 FROM reporting.specialty_mapping
 ORDER BY specialty_mapping.ims_specialty_code,
          specialty_mapping.sales_force_id,
          specialty_mapping.market_id
SEGMENTED BY hash(specialty_mapping.sales_force_id, specialty_mapping.market_id, specialty_mapping.ims_specialty_code, specialty_mapping.specialty_group, specialty_mapping.specialty_description) ALL NODES;

CREATE PROJECTION reporting.sales_force_product_b0 /*+basename(sales_force_product),createtype(L)*/ 
(
 sales_force_id,
 product_basket_id,
 product_name
)
AS
 SELECT sales_force_product.sales_force_id,
        sales_force_product.product_basket_id,
        sales_force_product.product_name
 FROM reporting.sales_force_product
 ORDER BY sales_force_product.sales_force_id,
          sales_force_product.product_name
SEGMENTED BY hash(sales_force_product.sales_force_id, sales_force_product.product_basket_id) ALL NODES;

CREATE PROJECTION reporting.product_item_b0 /*+basename(product_item),createtype(L)*/ 
(
 product_id,
 product_name,
 product_type,
 item_id,
 item_name,
 item_type
)
AS
 SELECT product_item.product_id,
        product_item.product_name,
        product_item.product_type,
        product_item.item_id,
        product_item.item_name,
        product_item.item_type
 FROM reporting.product_item
 ORDER BY product_item.product_id,
          product_item.item_id
SEGMENTED BY hash(product_item.product_id, product_item.item_id) ALL NODES;

CREATE PROJECTION reporting.roster_b0 /*+basename(roster),createtype(L)*/ 
(
 geography_id,
 geography_name,
 geography_level,
 sales_force_id,
 sales_force_name,
 parent_geography_id,
 employee_id,
 rep_name,
 rep_type,
 user_id,
 global_employee_id,
 email
)
AS
 SELECT roster.geography_id,
        roster.geography_name,
        roster.geography_level,
        roster.sales_force_id,
        roster.sales_force_name,
        roster.parent_geography_id,
        roster.employee_id,
        roster.rep_name,
        roster.rep_type,
        roster.user_id,
        roster.global_employee_id,
        roster.email
 FROM reporting.roster
 ORDER BY roster.geography_id
SEGMENTED BY hash(roster.geography_id) ALL NODES;

CREATE PROJECTION reporting.user_access_table_b0 /*+basename(user_access_table),createtype(L)*/ 
(
 user_id,
 user_type,
 assigned_geography_id,
 authorized_geography_id
)
AS
 SELECT user_access_table.user_id,
        user_access_table.user_type,
        user_access_table.assigned_geography_id,
        user_access_table.authorized_geography_id
 FROM reporting.user_access_table
 ORDER BY user_access_table.user_id,
          user_access_table.authorized_geography_id
SEGMENTED BY hash(user_access_table.assigned_geography_id) ALL NODES;

CREATE PROJECTION reporting.user_access_table_transaction_b0 /*+basename(user_access_table_transaction),createtype(L)*/ 
(
 user_id,
 user_type,
 assigned_geography_id,
 authorized_geography_id
)
AS
 SELECT user_access_table_transaction.user_id,
        user_access_table_transaction.user_type,
        user_access_table_transaction.assigned_geography_id,
        user_access_table_transaction.authorized_geography_id
 FROM reporting.user_access_table_transaction
 ORDER BY user_access_table_transaction.user_id,
          user_access_table_transaction.assigned_geography_id
SEGMENTED BY hash(user_access_table_transaction.assigned_geography_id) ALL NODES;

CREATE PROJECTION reporting.to_weekly_geography_summary_b0 /*+basename(to_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 segment,
 target,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 syncare_flag,
 channel,
 market_volume_indicator,
 call_goals,
 new_accounts,
 accounts_ordering,
 avg_sales_per_account,
 prev_accounts_ordering,
 product_vol_dollars,
 product_vol_mg,
 product_vol_mcg,
 market_vol_dollars,
 market_vol_mg,
 market_vol_mcg,
 prev_prod_vol_dollars,
 prev_prod_vol_mg,
 prev_prod_vol_mcg,
 prev_market_vol_dollars,
 prev_market_vol_mg,
 prev_market_vol_mcg,
 details_p1,
 details_p2,
 details_p3,
 total_details,
 accounts_detailed_count,
 total_accounts_count
)
AS
 SELECT to_weekly_geography_summary.sales_force_id,
        to_weekly_geography_summary.geography_level,
        to_weekly_geography_summary.geography_id,
        to_weekly_geography_summary.geography,
        to_weekly_geography_summary.rep_name,
        to_weekly_geography_summary.user_id,
        to_weekly_geography_summary.time_period,
        to_weekly_geography_summary.period_type,
        to_weekly_geography_summary.period,
        to_weekly_geography_summary.segment,
        to_weekly_geography_summary.target,
        to_weekly_geography_summary.market_id,
        to_weekly_geography_summary.market_name,
        to_weekly_geography_summary.brand_id,
        to_weekly_geography_summary.brand_name,
        to_weekly_geography_summary.teva_product_flag,
        to_weekly_geography_summary.syncare_flag,
        to_weekly_geography_summary.channel,
        to_weekly_geography_summary.market_volume_indicator,
        to_weekly_geography_summary.call_goals,
        to_weekly_geography_summary.new_accounts,
        to_weekly_geography_summary.accounts_ordering,
        to_weekly_geography_summary.avg_sales_per_account,
        to_weekly_geography_summary.prev_accounts_ordering,
        to_weekly_geography_summary.product_vol_dollars,
        to_weekly_geography_summary.product_vol_mg,
        to_weekly_geography_summary.product_vol_mcg,
        to_weekly_geography_summary.market_vol_dollars,
        to_weekly_geography_summary.market_vol_mg,
        to_weekly_geography_summary.market_vol_mcg,
        to_weekly_geography_summary.prev_prod_vol_dollars,
        to_weekly_geography_summary.prev_prod_vol_mg,
        to_weekly_geography_summary.prev_prod_vol_mcg,
        to_weekly_geography_summary.prev_market_vol_dollars,
        to_weekly_geography_summary.prev_market_vol_mg,
        to_weekly_geography_summary.prev_market_vol_mcg,
        to_weekly_geography_summary.details_p1,
        to_weekly_geography_summary.details_p2,
        to_weekly_geography_summary.details_p3,
        to_weekly_geography_summary.total_details,
        to_weekly_geography_summary.accounts_detailed_count,
        to_weekly_geography_summary.total_accounts_count
 FROM reporting.to_weekly_geography_summary
 ORDER BY to_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(to_weekly_geography_summary.sales_force_id, to_weekly_geography_summary.market_id, to_weekly_geography_summary.brand_id, to_weekly_geography_summary.teva_product_flag, to_weekly_geography_summary.syncare_flag, to_weekly_geography_summary.market_volume_indicator, to_weekly_geography_summary.call_goals, to_weekly_geography_summary.new_accounts) ALL NODES;

CREATE PROJECTION reporting.tn_weekly_payer_geography_summary_b0 /*+basename(tn_weekly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count
)
AS
 SELECT tn_weekly_payer_geography_summary.sales_force_id,
        tn_weekly_payer_geography_summary.geography_level,
        tn_weekly_payer_geography_summary.geography_id,
        tn_weekly_payer_geography_summary.geography,
        tn_weekly_payer_geography_summary.rep_name,
        tn_weekly_payer_geography_summary.user_id,
        tn_weekly_payer_geography_summary.time_period,
        tn_weekly_payer_geography_summary.period_type,
        tn_weekly_payer_geography_summary.period,
        tn_weekly_payer_geography_summary.payer_id,
        tn_weekly_payer_geography_summary.payer_name,
        tn_weekly_payer_geography_summary.plan_id,
        tn_weekly_payer_geography_summary.plan_name,
        tn_weekly_payer_geography_summary.payer_plan_id,
        tn_weekly_payer_geography_summary.market_id,
        tn_weekly_payer_geography_summary.market_name,
        tn_weekly_payer_geography_summary.brand_id,
        tn_weekly_payer_geography_summary.brand_name,
        tn_weekly_payer_geography_summary.teva_product_flag,
        tn_weekly_payer_geography_summary.method_of_payment,
        tn_weekly_payer_geography_summary.market_volume_indicator,
        tn_weekly_payer_geography_summary.geo_plan_vol_rank,
        tn_weekly_payer_geography_summary.product_vol_trx_count,
        tn_weekly_payer_geography_summary.market_vol_trx_count,
        tn_weekly_payer_geography_summary.prev_prod_vol_trx_count,
        tn_weekly_payer_geography_summary.prev_market_vol_trx_count,
        tn_weekly_payer_geography_summary.product_vol_nrx_count,
        tn_weekly_payer_geography_summary.market_vol_nrx_count,
        tn_weekly_payer_geography_summary.prev_prod_vol_nrx_count,
        tn_weekly_payer_geography_summary.prev_market_vol_nrx_count
 FROM reporting.tn_weekly_payer_geography_summary
 ORDER BY tn_weekly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(tn_weekly_payer_geography_summary.sales_force_id, tn_weekly_payer_geography_summary.payer_id, tn_weekly_payer_geography_summary.plan_id, tn_weekly_payer_geography_summary.market_id, tn_weekly_payer_geography_summary.brand_id, tn_weekly_payer_geography_summary.teva_product_flag, tn_weekly_payer_geography_summary.market_volume_indicator, tn_weekly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tp_weekly_geography_summary_b0 /*+basename(tp_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT tp_weekly_geography_summary.sales_force_id,
        tp_weekly_geography_summary.geography_level,
        tp_weekly_geography_summary.geography_id,
        tp_weekly_geography_summary.geography,
        tp_weekly_geography_summary.rep_name,
        tp_weekly_geography_summary.user_id,
        tp_weekly_geography_summary.time_period,
        tp_weekly_geography_summary.period_type,
        tp_weekly_geography_summary.period,
        tp_weekly_geography_summary.market_id,
        tp_weekly_geography_summary.market_name,
        tp_weekly_geography_summary.brand_id,
        tp_weekly_geography_summary.brand_name,
        tp_weekly_geography_summary.teva_product_flag,
        tp_weekly_geography_summary.target_status_flag,
        tp_weekly_geography_summary.method_of_payment,
        tp_weekly_geography_summary.specialty,
        tp_weekly_geography_summary.segment,
        tp_weekly_geography_summary.market_volume_indicator,
        tp_weekly_geography_summary.product_vol_trx_count,
        tp_weekly_geography_summary.product_vol_new_pres_trx_count,
        tp_weekly_geography_summary.market_vol_trx_count,
        tp_weekly_geography_summary.prev_prod_vol_trx_count,
        tp_weekly_geography_summary.prev_market_vol_trx_count,
        tp_weekly_geography_summary.product_vol_nrx_count,
        tp_weekly_geography_summary.product_vol_new_pres_nrx_count,
        tp_weekly_geography_summary.market_vol_nrx_count,
        tp_weekly_geography_summary.prev_prod_vol_nrx_count,
        tp_weekly_geography_summary.prev_market_vol_nrx_count,
        tp_weekly_geography_summary.prescribers_count,
        tp_weekly_geography_summary.new_prescribers_count,
        tp_weekly_geography_summary.decile
 FROM reporting.tp_weekly_geography_summary
 ORDER BY tp_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(tp_weekly_geography_summary.sales_force_id, tp_weekly_geography_summary.market_id, tp_weekly_geography_summary.brand_id, tp_weekly_geography_summary.teva_product_flag, tp_weekly_geography_summary.target_status_flag, tp_weekly_geography_summary.market_volume_indicator, tp_weekly_geography_summary.prescribers_count, tp_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.sp_weekly_geography_summary_b0 /*+basename(sp_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count
)
AS
 SELECT sp_weekly_geography_summary.sales_force_id,
        sp_weekly_geography_summary.geography_level,
        sp_weekly_geography_summary.geography_id,
        sp_weekly_geography_summary.geography,
        sp_weekly_geography_summary.rep_name,
        sp_weekly_geography_summary.user_id,
        sp_weekly_geography_summary.time_period,
        sp_weekly_geography_summary.period_type,
        sp_weekly_geography_summary.period,
        sp_weekly_geography_summary.market_id,
        sp_weekly_geography_summary.market_name,
        sp_weekly_geography_summary.brand_id,
        sp_weekly_geography_summary.brand_name,
        sp_weekly_geography_summary.teva_product_flag,
        sp_weekly_geography_summary.target_status_flag,
        sp_weekly_geography_summary.method_of_payment,
        sp_weekly_geography_summary.specialty,
        sp_weekly_geography_summary.segment,
        sp_weekly_geography_summary.market_volume_indicator,
        sp_weekly_geography_summary.product_vol_trx_count,
        sp_weekly_geography_summary.product_vol_new_pres_trx_count,
        sp_weekly_geography_summary.market_vol_trx_count,
        sp_weekly_geography_summary.prev_prod_vol_trx_count,
        sp_weekly_geography_summary.prev_market_vol_trx_count,
        sp_weekly_geography_summary.product_vol_nrx_count,
        sp_weekly_geography_summary.product_vol_new_pres_nrx_count,
        sp_weekly_geography_summary.market_vol_nrx_count,
        sp_weekly_geography_summary.prev_prod_vol_nrx_count,
        sp_weekly_geography_summary.prev_market_vol_nrx_count,
        sp_weekly_geography_summary.prescribers_count,
        sp_weekly_geography_summary.new_prescribers_count
 FROM reporting.sp_weekly_geography_summary
 ORDER BY sp_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(sp_weekly_geography_summary.sales_force_id, sp_weekly_geography_summary.market_id, sp_weekly_geography_summary.brand_id, sp_weekly_geography_summary.teva_product_flag, sp_weekly_geography_summary.target_status_flag, sp_weekly_geography_summary.market_volume_indicator, sp_weekly_geography_summary.prescribers_count, sp_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.tp_monthly_geography_summary_b0 /*+basename(tp_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT tp_monthly_geography_summary.sales_force_id,
        tp_monthly_geography_summary.geography_level,
        tp_monthly_geography_summary.geography_id,
        tp_monthly_geography_summary.geography,
        tp_monthly_geography_summary.rep_name,
        tp_monthly_geography_summary.user_id,
        tp_monthly_geography_summary.time_period,
        tp_monthly_geography_summary.period_type,
        tp_monthly_geography_summary.period,
        tp_monthly_geography_summary.market_id,
        tp_monthly_geography_summary.market_name,
        tp_monthly_geography_summary.brand_id,
        tp_monthly_geography_summary.brand_name,
        tp_monthly_geography_summary.teva_product_flag,
        tp_monthly_geography_summary.target_status_flag,
        tp_monthly_geography_summary.method_of_payment,
        tp_monthly_geography_summary.specialty,
        tp_monthly_geography_summary.segment,
        tp_monthly_geography_summary.market_volume_indicator,
        tp_monthly_geography_summary.product_vol_trx_count,
        tp_monthly_geography_summary.product_vol_new_pres_trx_count,
        tp_monthly_geography_summary.market_vol_trx_count,
        tp_monthly_geography_summary.prev_prod_vol_trx_count,
        tp_monthly_geography_summary.prev_market_vol_trx_count,
        tp_monthly_geography_summary.product_vol_nrx_count,
        tp_monthly_geography_summary.product_vol_new_pres_nrx_count,
        tp_monthly_geography_summary.market_vol_nrx_count,
        tp_monthly_geography_summary.prev_prod_vol_nrx_count,
        tp_monthly_geography_summary.prev_market_vol_nrx_count,
        tp_monthly_geography_summary.prescribers_count,
        tp_monthly_geography_summary.new_prescribers_count,
        tp_monthly_geography_summary.decile
 FROM reporting.tp_monthly_geography_summary
 ORDER BY tp_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(tp_monthly_geography_summary.sales_force_id, tp_monthly_geography_summary.market_id, tp_monthly_geography_summary.brand_id, tp_monthly_geography_summary.teva_product_flag, tp_monthly_geography_summary.target_status_flag, tp_monthly_geography_summary.market_volume_indicator, tp_monthly_geography_summary.prescribers_count, tp_monthly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.sp_monthly_geography_summary_b0 /*+basename(sp_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count
)
AS
 SELECT sp_monthly_geography_summary.sales_force_id,
        sp_monthly_geography_summary.geography_level,
        sp_monthly_geography_summary.geography_id,
        sp_monthly_geography_summary.geography,
        sp_monthly_geography_summary.rep_name,
        sp_monthly_geography_summary.user_id,
        sp_monthly_geography_summary.time_period,
        sp_monthly_geography_summary.period_type,
        sp_monthly_geography_summary.period,
        sp_monthly_geography_summary.market_id,
        sp_monthly_geography_summary.market_name,
        sp_monthly_geography_summary.brand_id,
        sp_monthly_geography_summary.brand_name,
        sp_monthly_geography_summary.teva_product_flag,
        sp_monthly_geography_summary.target_status_flag,
        sp_monthly_geography_summary.method_of_payment,
        sp_monthly_geography_summary.specialty,
        sp_monthly_geography_summary.segment,
        sp_monthly_geography_summary.market_volume_indicator,
        sp_monthly_geography_summary.product_vol_trx_count,
        sp_monthly_geography_summary.product_vol_new_pres_trx_count,
        sp_monthly_geography_summary.market_vol_trx_count,
        sp_monthly_geography_summary.prev_prod_vol_trx_count,
        sp_monthly_geography_summary.prev_market_vol_trx_count,
        sp_monthly_geography_summary.product_vol_nrx_count,
        sp_monthly_geography_summary.product_vol_new_pres_nrx_count,
        sp_monthly_geography_summary.market_vol_nrx_count,
        sp_monthly_geography_summary.prev_prod_vol_nrx_count,
        sp_monthly_geography_summary.prev_market_vol_nrx_count,
        sp_monthly_geography_summary.prescribers_count,
        sp_monthly_geography_summary.new_prescribers_count
 FROM reporting.sp_monthly_geography_summary
 ORDER BY sp_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(sp_monthly_geography_summary.sales_force_id, sp_monthly_geography_summary.market_id, sp_monthly_geography_summary.brand_id, sp_monthly_geography_summary.teva_product_flag, sp_monthly_geography_summary.target_status_flag, sp_monthly_geography_summary.market_volume_indicator, sp_monthly_geography_summary.prescribers_count, sp_monthly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.calls_per_day_goal_b0 /*+basename(calls_per_day_goal),createtype(L)*/ 
(
 sales_force_id,
 product_id,
 month,
 rep_calls_per_day,
 goal_type,
 prod_percent
)
AS
 SELECT calls_per_day_goal.sales_force_id,
        calls_per_day_goal.product_id,
        calls_per_day_goal.month,
        calls_per_day_goal.rep_calls_per_day,
        calls_per_day_goal.goal_type,
        calls_per_day_goal.prod_percent
 FROM reporting.calls_per_day_goal
 ORDER BY calls_per_day_goal.sales_force_id,
          calls_per_day_goal.product_id,
          calls_per_day_goal.month,
          calls_per_day_goal.rep_calls_per_day,
          calls_per_day_goal.goal_type,
          calls_per_day_goal.prod_percent
SEGMENTED BY hash(calls_per_day_goal.sales_force_id, calls_per_day_goal.product_id, calls_per_day_goal.month, calls_per_day_goal.rep_calls_per_day, calls_per_day_goal.prod_percent, calls_per_day_goal.goal_type) ALL NODES;

CREATE PROJECTION reporting.customer_b0 /*+basename(customer),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 ims_outlet_code,
 ims_facility_number,
 federation_id,
 customer_type,
 prescriber_type,
 network_name,
 account_name,
 physician_first_name,
 physician_last_name,
 credential,
 subcat_group,
 subcat_code,
 pdrp_flag,
 pri_specialty_code,
 pri_specialty_desc,
 sec_specialty_code,
 sec_specialty_desc,
 cm_status_flag,
 gpo,
 dnp_flag,
 product_1_dnc_flag,
 product_2_dnc_flag,
 a_specialty_group,
 b_specialty_group,
 c_specialty_group,
 formulary_control
)
AS
 SELECT customer.customer_id,
        customer.tvcmid,
        customer.ims_id,
        customer.ims_outlet_code,
        customer.ims_facility_number,
        customer.federation_id,
        customer.customer_type,
        customer.prescriber_type,
        customer.network_name,
        customer.account_name,
        customer.physician_first_name,
        customer.physician_last_name,
        customer.credential,
        customer.subcat_group,
        customer.subcat_code,
        customer.pdrp_flag,
        customer.pri_specialty_code,
        customer.pri_specialty_desc,
        customer.sec_specialty_code,
        customer.sec_specialty_desc,
        customer.cm_status_flag,
        customer.gpo,
        customer.dnp_flag,
        customer.product_1_dnc_flag,
        customer.product_2_dnc_flag,
        customer.a_specialty_group,
        customer.b_specialty_group,
        customer.c_specialty_group,
        customer.formulary_control
 FROM reporting.customer
 ORDER BY customer.customer_id
SEGMENTED BY hash(customer.tvcmid) ALL NODES;

CREATE PROJECTION reporting.weekly_account_sales_b0 /*+basename(weekly_account_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 week,
 week_bucket,
 data_source,
 subcat_code,
 channel,
 trx_count,
 nrx_count,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 mcgs,
 mgs,
 new_account
)
AS
 SELECT weekly_account_sales.customer_id,
        weekly_account_sales.tvcmid,
        weekly_account_sales.ims_id,
        weekly_account_sales.product_id,
        weekly_account_sales.week,
        weekly_account_sales.week_bucket,
        weekly_account_sales.data_source,
        weekly_account_sales.subcat_code,
        weekly_account_sales.channel,
        weekly_account_sales.trx_count,
        weekly_account_sales.nrx_count,
        weekly_account_sales.trx_units,
        weekly_account_sales.nrx_units,
        weekly_account_sales.trx_dollars,
        weekly_account_sales.nrx_dollars,
        weekly_account_sales.mcgs,
        weekly_account_sales.mgs,
        weekly_account_sales.new_account
 FROM reporting.weekly_account_sales
 ORDER BY weekly_account_sales.customer_id,
          weekly_account_sales.tvcmid
SEGMENTED BY hash(weekly_account_sales.tvcmid, weekly_account_sales.product_id, weekly_account_sales.week, weekly_account_sales.week_bucket, weekly_account_sales.subcat_code, weekly_account_sales.trx_count, weekly_account_sales.nrx_count, weekly_account_sales.trx_units) ALL NODES;

CREATE PROJECTION reporting.weekly_new_prescriber_b0 /*+basename(weekly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 week_ending,
 week_bucket,
 current_trx,
 prior_trx
)
AS
 SELECT weekly_new_prescriber.customer_id,
        weekly_new_prescriber.brand_id,
        weekly_new_prescriber.week_ending,
        weekly_new_prescriber.week_bucket,
        weekly_new_prescriber.current_trx,
        weekly_new_prescriber.prior_trx
 FROM reporting.weekly_new_prescriber
 ORDER BY weekly_new_prescriber.customer_id,
          weekly_new_prescriber.brand_id,
          weekly_new_prescriber.week_ending,
          weekly_new_prescriber.week_bucket
SEGMENTED BY hash(weekly_new_prescriber.customer_id, weekly_new_prescriber.brand_id, weekly_new_prescriber.week_ending) ALL NODES;

CREATE PROJECTION reporting.monthly_new_prescriber_b0 /*+basename(monthly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 month_ending,
 month_bucket,
 current_trx,
 prior_trx
)
AS
 SELECT monthly_new_prescriber.customer_id,
        monthly_new_prescriber.brand_id,
        monthly_new_prescriber.month_ending,
        monthly_new_prescriber.month_bucket,
        monthly_new_prescriber.current_trx,
        monthly_new_prescriber.prior_trx
 FROM reporting.monthly_new_prescriber
 ORDER BY monthly_new_prescriber.customer_id,
          monthly_new_prescriber.brand_id,
          monthly_new_prescriber.month_ending,
          monthly_new_prescriber.month_bucket
SEGMENTED BY hash(monthly_new_prescriber.customer_id, monthly_new_prescriber.brand_id, monthly_new_prescriber.month_ending) ALL NODES;

CREATE PROJECTION reporting.tn_weekly_prescriber_summary_b0 /*+basename(tn_weekly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tn_weekly_prescriber_summary.sales_force_id,
        tn_weekly_prescriber_summary.nation_id,
        tn_weekly_prescriber_summary.nation,
        tn_weekly_prescriber_summary.area_id,
        tn_weekly_prescriber_summary.area,
        tn_weekly_prescriber_summary.region_id,
        tn_weekly_prescriber_summary.region,
        tn_weekly_prescriber_summary.territory_id,
        tn_weekly_prescriber_summary.territory,
        tn_weekly_prescriber_summary.rep_name,
        tn_weekly_prescriber_summary.user_id,
        tn_weekly_prescriber_summary.time_period,
        tn_weekly_prescriber_summary.period_type,
        tn_weekly_prescriber_summary.period,
        tn_weekly_prescriber_summary.market_id,
        tn_weekly_prescriber_summary.market_name,
        tn_weekly_prescriber_summary.brand_id,
        tn_weekly_prescriber_summary.brand_name,
        tn_weekly_prescriber_summary.teva_product_flag,
        tn_weekly_prescriber_summary.customer_id,
        tn_weekly_prescriber_summary.tvcmid,
        tn_weekly_prescriber_summary.pdrp_flag,
        tn_weekly_prescriber_summary.hcp_restriction_flag,
        tn_weekly_prescriber_summary.prescriber_name,
        tn_weekly_prescriber_summary.new_prescriber,
        tn_weekly_prescriber_summary.address,
        tn_weekly_prescriber_summary.city,
        tn_weekly_prescriber_summary.state,
        tn_weekly_prescriber_summary.zip,
        tn_weekly_prescriber_summary.target_status_flag,
        tn_weekly_prescriber_summary.partner_target_status_flag,
        tn_weekly_prescriber_summary.method_of_payment,
        tn_weekly_prescriber_summary.specialty,
        tn_weekly_prescriber_summary.segment,
        tn_weekly_prescriber_summary.decile,
        tn_weekly_prescriber_summary.market_volume_indicator,
        tn_weekly_prescriber_summary.product_vol_trx_count,
        tn_weekly_prescriber_summary.market_vol_trx_count,
        tn_weekly_prescriber_summary.prev_prod_vol_trx_count,
        tn_weekly_prescriber_summary.prev_market_vol_trx_count,
        tn_weekly_prescriber_summary.product_vol_nrx_count,
        tn_weekly_prescriber_summary.market_vol_nrx_count,
        tn_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        tn_weekly_prescriber_summary.prev_market_vol_nrx_count,
        tn_weekly_prescriber_summary.samples,
        tn_weekly_prescriber_summary.details_p1,
        tn_weekly_prescriber_summary.details_p2,
        tn_weekly_prescriber_summary.details_p3
 FROM reporting.tn_weekly_prescriber_summary
 ORDER BY tn_weekly_prescriber_summary.sales_force_id,
          tn_weekly_prescriber_summary.nation_id,
          tn_weekly_prescriber_summary.nation,
          tn_weekly_prescriber_summary.area_id,
          tn_weekly_prescriber_summary.area,
          tn_weekly_prescriber_summary.region_id,
          tn_weekly_prescriber_summary.region,
          tn_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(tn_weekly_prescriber_summary.sales_force_id, tn_weekly_prescriber_summary.market_id, tn_weekly_prescriber_summary.brand_id, tn_weekly_prescriber_summary.teva_product_flag, tn_weekly_prescriber_summary.tvcmid, tn_weekly_prescriber_summary.pdrp_flag, tn_weekly_prescriber_summary.hcp_restriction_flag, tn_weekly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.tn_weekly_payer_prescriber_summary_b0 /*+basename(tn_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT tn_weekly_payer_prescriber_summary.sales_force_id,
        tn_weekly_payer_prescriber_summary.nation_id,
        tn_weekly_payer_prescriber_summary.nation,
        tn_weekly_payer_prescriber_summary.area_id,
        tn_weekly_payer_prescriber_summary.area,
        tn_weekly_payer_prescriber_summary.region_id,
        tn_weekly_payer_prescriber_summary.region,
        tn_weekly_payer_prescriber_summary.territory_id,
        tn_weekly_payer_prescriber_summary.territory,
        tn_weekly_payer_prescriber_summary.rep_name,
        tn_weekly_payer_prescriber_summary.user_id,
        tn_weekly_payer_prescriber_summary.time_period,
        tn_weekly_payer_prescriber_summary.period_type,
        tn_weekly_payer_prescriber_summary.period,
        tn_weekly_payer_prescriber_summary.market_id,
        tn_weekly_payer_prescriber_summary.market_name,
        tn_weekly_payer_prescriber_summary.brand_id,
        tn_weekly_payer_prescriber_summary.brand_name,
        tn_weekly_payer_prescriber_summary.teva_product_flag,
        tn_weekly_payer_prescriber_summary.payer_id,
        tn_weekly_payer_prescriber_summary.payer_name,
        tn_weekly_payer_prescriber_summary.plan_id,
        tn_weekly_payer_prescriber_summary.plan_name,
        tn_weekly_payer_prescriber_summary.payer_plan_id,
        tn_weekly_payer_prescriber_summary.customer_id,
        tn_weekly_payer_prescriber_summary.tvcmid,
        tn_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        tn_weekly_payer_prescriber_summary.prescriber_name,
        tn_weekly_payer_prescriber_summary.pdrp_flag,
        tn_weekly_payer_prescriber_summary.hcp_restriction_flag,
        tn_weekly_payer_prescriber_summary.address,
        tn_weekly_payer_prescriber_summary.city,
        tn_weekly_payer_prescriber_summary.state,
        tn_weekly_payer_prescriber_summary.zip,
        tn_weekly_payer_prescriber_summary.target_status_flag,
        tn_weekly_payer_prescriber_summary.partner_target_status_flag,
        tn_weekly_payer_prescriber_summary.method_of_payment,
        tn_weekly_payer_prescriber_summary.specialty,
        tn_weekly_payer_prescriber_summary.segment,
        tn_weekly_payer_prescriber_summary.decile,
        tn_weekly_payer_prescriber_summary.market_volume_indicator,
        tn_weekly_payer_prescriber_summary.product_vol_trx_count,
        tn_weekly_payer_prescriber_summary.market_vol_trx_count,
        tn_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        tn_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        tn_weekly_payer_prescriber_summary.product_vol_nrx_count,
        tn_weekly_payer_prescriber_summary.market_vol_nrx_count,
        tn_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        tn_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        tn_weekly_payer_prescriber_summary.samples,
        tn_weekly_payer_prescriber_summary.details_p1,
        tn_weekly_payer_prescriber_summary.details_p2,
        tn_weekly_payer_prescriber_summary.details_p3,
        tn_weekly_payer_prescriber_summary.focus_target
 FROM reporting.tn_weekly_payer_prescriber_summary
 ORDER BY tn_weekly_payer_prescriber_summary.sales_force_id,
          tn_weekly_payer_prescriber_summary.nation_id,
          tn_weekly_payer_prescriber_summary.nation,
          tn_weekly_payer_prescriber_summary.area_id,
          tn_weekly_payer_prescriber_summary.area,
          tn_weekly_payer_prescriber_summary.region_id,
          tn_weekly_payer_prescriber_summary.region,
          tn_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(tn_weekly_payer_prescriber_summary.sales_force_id, tn_weekly_payer_prescriber_summary.market_id, tn_weekly_payer_prescriber_summary.brand_id, tn_weekly_payer_prescriber_summary.teva_product_flag, tn_weekly_payer_prescriber_summary.payer_id, tn_weekly_payer_prescriber_summary.plan_id, tn_weekly_payer_prescriber_summary.tvcmid, tn_weekly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tp_weekly_prescriber_summary_b0 /*+basename(tp_weekly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 partner_target_status_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT tp_weekly_prescriber_summary.sales_force_id,
        tp_weekly_prescriber_summary.nation_id,
        tp_weekly_prescriber_summary.nation,
        tp_weekly_prescriber_summary.area_id,
        tp_weekly_prescriber_summary.area,
        tp_weekly_prescriber_summary.region_id,
        tp_weekly_prescriber_summary.region,
        tp_weekly_prescriber_summary.territory_id,
        tp_weekly_prescriber_summary.territory,
        tp_weekly_prescriber_summary.rep_name,
        tp_weekly_prescriber_summary.user_id,
        tp_weekly_prescriber_summary.time_period,
        tp_weekly_prescriber_summary.period_type,
        tp_weekly_prescriber_summary.period,
        tp_weekly_prescriber_summary.market_id,
        tp_weekly_prescriber_summary.market_name,
        tp_weekly_prescriber_summary.brand_id,
        tp_weekly_prescriber_summary.brand_name,
        tp_weekly_prescriber_summary.teva_product_flag,
        tp_weekly_prescriber_summary.customer_id,
        tp_weekly_prescriber_summary.tvcmid,
        tp_weekly_prescriber_summary.pdrp_flag,
        tp_weekly_prescriber_summary.hcp_restriction_flag,
        tp_weekly_prescriber_summary.prescriber_name,
        tp_weekly_prescriber_summary.new_prescriber,
        tp_weekly_prescriber_summary.address,
        tp_weekly_prescriber_summary.city,
        tp_weekly_prescriber_summary.state,
        tp_weekly_prescriber_summary.zip,
        tp_weekly_prescriber_summary.partner_target_status_flag,
        tp_weekly_prescriber_summary.target_status_flag,
        tp_weekly_prescriber_summary.method_of_payment,
        tp_weekly_prescriber_summary.specialty,
        tp_weekly_prescriber_summary.segment,
        tp_weekly_prescriber_summary.decile,
        tp_weekly_prescriber_summary.market_volume_indicator,
        tp_weekly_prescriber_summary.product_vol_trx_count,
        tp_weekly_prescriber_summary.market_vol_trx_count,
        tp_weekly_prescriber_summary.prev_prod_vol_trx_count,
        tp_weekly_prescriber_summary.prev_market_vol_trx_count,
        tp_weekly_prescriber_summary.product_vol_nrx_count,
        tp_weekly_prescriber_summary.market_vol_nrx_count,
        tp_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        tp_weekly_prescriber_summary.prev_market_vol_nrx_count,
        tp_weekly_prescriber_summary.samples,
        tp_weekly_prescriber_summary.details_p1,
        tp_weekly_prescriber_summary.details_p2,
        tp_weekly_prescriber_summary.details_p3
 FROM reporting.tp_weekly_prescriber_summary
 ORDER BY tp_weekly_prescriber_summary.sales_force_id,
          tp_weekly_prescriber_summary.nation_id,
          tp_weekly_prescriber_summary.nation,
          tp_weekly_prescriber_summary.area_id,
          tp_weekly_prescriber_summary.area,
          tp_weekly_prescriber_summary.region_id,
          tp_weekly_prescriber_summary.region,
          tp_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(tp_weekly_prescriber_summary.sales_force_id, tp_weekly_prescriber_summary.market_id, tp_weekly_prescriber_summary.brand_id, tp_weekly_prescriber_summary.teva_product_flag, tp_weekly_prescriber_summary.tvcmid, tp_weekly_prescriber_summary.pdrp_flag, tp_weekly_prescriber_summary.hcp_restriction_flag, tp_weekly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.sp_weekly_prescriber_summary_b0 /*+basename(sp_weekly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT sp_weekly_prescriber_summary.sales_force_id,
        sp_weekly_prescriber_summary.nation_id,
        sp_weekly_prescriber_summary.nation,
        sp_weekly_prescriber_summary.area_id,
        sp_weekly_prescriber_summary.area,
        sp_weekly_prescriber_summary.region_id,
        sp_weekly_prescriber_summary.region,
        sp_weekly_prescriber_summary.territory_id,
        sp_weekly_prescriber_summary.territory,
        sp_weekly_prescriber_summary.rep_name,
        sp_weekly_prescriber_summary.user_id,
        sp_weekly_prescriber_summary.time_period,
        sp_weekly_prescriber_summary.period_type,
        sp_weekly_prescriber_summary.period,
        sp_weekly_prescriber_summary.market_id,
        sp_weekly_prescriber_summary.market_name,
        sp_weekly_prescriber_summary.brand_id,
        sp_weekly_prescriber_summary.brand_name,
        sp_weekly_prescriber_summary.teva_product_flag,
        sp_weekly_prescriber_summary.customer_id,
        sp_weekly_prescriber_summary.tvcmid,
        sp_weekly_prescriber_summary.pdrp_flag,
        sp_weekly_prescriber_summary.hcp_restriction_flag,
        sp_weekly_prescriber_summary.prescriber_name,
        sp_weekly_prescriber_summary.new_prescriber,
        sp_weekly_prescriber_summary.address,
        sp_weekly_prescriber_summary.city,
        sp_weekly_prescriber_summary.state,
        sp_weekly_prescriber_summary.zip,
        sp_weekly_prescriber_summary.target_status_flag,
        sp_weekly_prescriber_summary.partner_target_status_flag,
        sp_weekly_prescriber_summary.method_of_payment,
        sp_weekly_prescriber_summary.specialty,
        sp_weekly_prescriber_summary.segment,
        sp_weekly_prescriber_summary.decile,
        sp_weekly_prescriber_summary.market_volume_indicator,
        sp_weekly_prescriber_summary.product_vol_trx_count,
        sp_weekly_prescriber_summary.market_vol_trx_count,
        sp_weekly_prescriber_summary.prev_prod_vol_trx_count,
        sp_weekly_prescriber_summary.prev_market_vol_trx_count,
        sp_weekly_prescriber_summary.product_vol_nrx_count,
        sp_weekly_prescriber_summary.market_vol_nrx_count,
        sp_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        sp_weekly_prescriber_summary.prev_market_vol_nrx_count,
        sp_weekly_prescriber_summary.samples,
        sp_weekly_prescriber_summary.details_p1,
        sp_weekly_prescriber_summary.details_p2,
        sp_weekly_prescriber_summary.details_p3
 FROM reporting.sp_weekly_prescriber_summary
 ORDER BY sp_weekly_prescriber_summary.sales_force_id,
          sp_weekly_prescriber_summary.nation_id,
          sp_weekly_prescriber_summary.nation,
          sp_weekly_prescriber_summary.area_id,
          sp_weekly_prescriber_summary.area,
          sp_weekly_prescriber_summary.region_id,
          sp_weekly_prescriber_summary.region,
          sp_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(sp_weekly_prescriber_summary.sales_force_id, sp_weekly_prescriber_summary.market_id, sp_weekly_prescriber_summary.brand_id, sp_weekly_prescriber_summary.teva_product_flag, sp_weekly_prescriber_summary.tvcmid, sp_weekly_prescriber_summary.pdrp_flag, sp_weekly_prescriber_summary.hcp_restriction_flag, sp_weekly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.monthly_prescriber_sales_summary_b0 /*+basename(monthly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 month_ending,
 month_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_restriction_flag,
 segment,
 decile,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT monthly_prescriber_sales_summary.sales_force_id,
        monthly_prescriber_sales_summary.customer_id,
        monthly_prescriber_sales_summary.tvcmid,
        monthly_prescriber_sales_summary.ims_id,
        monthly_prescriber_sales_summary.period_type,
        monthly_prescriber_sales_summary.period,
        monthly_prescriber_sales_summary.month_ending,
        monthly_prescriber_sales_summary.month_bucket,
        monthly_prescriber_sales_summary.market_id,
        monthly_prescriber_sales_summary.brand_id,
        monthly_prescriber_sales_summary.payer_id,
        monthly_prescriber_sales_summary.payer_plan_id,
        monthly_prescriber_sales_summary.method_of_payment,
        monthly_prescriber_sales_summary.hcp_restriction_flag,
        monthly_prescriber_sales_summary.segment,
        monthly_prescriber_sales_summary.decile,
        monthly_prescriber_sales_summary.hcp_payer_vol_rank,
        monthly_prescriber_sales_summary.hcp_plan_vol_rank,
        monthly_prescriber_sales_summary.product_vol_trx_count,
        monthly_prescriber_sales_summary.prev_prod_vol_trx_count,
        monthly_prescriber_sales_summary.product_vol_nrx_count,
        monthly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        monthly_prescriber_sales_summary.market_vol_trx_count,
        monthly_prescriber_sales_summary.prev_market_vol_trx_count,
        monthly_prescriber_sales_summary.market_vol_nrx_count,
        monthly_prescriber_sales_summary.prev_market_vol_nrx_count,
        monthly_prescriber_sales_summary.samples,
        monthly_prescriber_sales_summary.details_p1,
        monthly_prescriber_sales_summary.details_p2,
        monthly_prescriber_sales_summary.details_p3
 FROM reporting.monthly_prescriber_sales_summary
 ORDER BY monthly_prescriber_sales_summary.sales_force_id,
          monthly_prescriber_sales_summary.customer_id,
          monthly_prescriber_sales_summary.tvcmid,
          monthly_prescriber_sales_summary.ims_id,
          monthly_prescriber_sales_summary.period_type,
          monthly_prescriber_sales_summary.period,
          monthly_prescriber_sales_summary.month_ending,
          monthly_prescriber_sales_summary.month_bucket
SEGMENTED BY hash(monthly_prescriber_sales_summary.sales_force_id, monthly_prescriber_sales_summary.customer_id, monthly_prescriber_sales_summary.tvcmid, monthly_prescriber_sales_summary.ims_id, monthly_prescriber_sales_summary.month_ending, monthly_prescriber_sales_summary.month_bucket, monthly_prescriber_sales_summary.market_id, monthly_prescriber_sales_summary.brand_id, monthly_prescriber_sales_summary.payer_plan_id, monthly_prescriber_sales_summary.method_of_payment) ALL NODES;

CREATE PROJECTION reporting.sp_monthly_payer_prescriber_summary_b0 /*+basename(sp_monthly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT sp_monthly_payer_prescriber_summary.sales_force_id,
        sp_monthly_payer_prescriber_summary.nation_id,
        sp_monthly_payer_prescriber_summary.nation,
        sp_monthly_payer_prescriber_summary.area_id,
        sp_monthly_payer_prescriber_summary.area,
        sp_monthly_payer_prescriber_summary.region_id,
        sp_monthly_payer_prescriber_summary.region,
        sp_monthly_payer_prescriber_summary.territory_id,
        sp_monthly_payer_prescriber_summary.territory,
        sp_monthly_payer_prescriber_summary.rep_name,
        sp_monthly_payer_prescriber_summary.user_id,
        sp_monthly_payer_prescriber_summary.time_period,
        sp_monthly_payer_prescriber_summary.period_type,
        sp_monthly_payer_prescriber_summary.period,
        sp_monthly_payer_prescriber_summary.market_id,
        sp_monthly_payer_prescriber_summary.market_name,
        sp_monthly_payer_prescriber_summary.brand_id,
        sp_monthly_payer_prescriber_summary.brand_name,
        sp_monthly_payer_prescriber_summary.teva_product_flag,
        sp_monthly_payer_prescriber_summary.payer_id,
        sp_monthly_payer_prescriber_summary.payer_name,
        sp_monthly_payer_prescriber_summary.plan_id,
        sp_monthly_payer_prescriber_summary.plan_name,
        sp_monthly_payer_prescriber_summary.payer_plan_id,
        sp_monthly_payer_prescriber_summary.customer_id,
        sp_monthly_payer_prescriber_summary.tvcmid,
        sp_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        sp_monthly_payer_prescriber_summary.prescriber_name,
        sp_monthly_payer_prescriber_summary.pdrp_flag,
        sp_monthly_payer_prescriber_summary.hcp_restriction_flag,
        sp_monthly_payer_prescriber_summary.address,
        sp_monthly_payer_prescriber_summary.city,
        sp_monthly_payer_prescriber_summary.state,
        sp_monthly_payer_prescriber_summary.zip,
        sp_monthly_payer_prescriber_summary.target_status_flag,
        sp_monthly_payer_prescriber_summary.partner_target_status_flag,
        sp_monthly_payer_prescriber_summary.method_of_payment,
        sp_monthly_payer_prescriber_summary.specialty,
        sp_monthly_payer_prescriber_summary.segment,
        sp_monthly_payer_prescriber_summary.decile,
        sp_monthly_payer_prescriber_summary.market_volume_indicator,
        sp_monthly_payer_prescriber_summary.product_vol_trx_count,
        sp_monthly_payer_prescriber_summary.market_vol_trx_count,
        sp_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        sp_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        sp_monthly_payer_prescriber_summary.product_vol_nrx_count,
        sp_monthly_payer_prescriber_summary.market_vol_nrx_count,
        sp_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        sp_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        sp_monthly_payer_prescriber_summary.samples,
        sp_monthly_payer_prescriber_summary.details_p1,
        sp_monthly_payer_prescriber_summary.details_p2,
        sp_monthly_payer_prescriber_summary.details_p3,
        sp_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        sp_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        sp_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        sp_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        sp_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        sp_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        sp_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        sp_monthly_payer_prescriber_summary.focus_target
 FROM reporting.sp_monthly_payer_prescriber_summary
 ORDER BY sp_monthly_payer_prescriber_summary.customer_id
SEGMENTED BY hash(sp_monthly_payer_prescriber_summary.sales_force_id, sp_monthly_payer_prescriber_summary.market_id, sp_monthly_payer_prescriber_summary.brand_id, sp_monthly_payer_prescriber_summary.teva_product_flag, sp_monthly_payer_prescriber_summary.payer_id, sp_monthly_payer_prescriber_summary.plan_id, sp_monthly_payer_prescriber_summary.tvcmid, sp_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.reporting_rollup_month_month_b0 /*+basename(reporting_rollup_month_month),createtype(A)*/ 
(
 rollup_month,
 sales_month_bucket,
 activity_month_bucket
)
AS
 SELECT reporting_rollup_month_month.rollup_month,
        reporting_rollup_month_month.sales_month_bucket,
        reporting_rollup_month_month.activity_month_bucket
 FROM reporting.reporting_rollup_month_month
 ORDER BY reporting_rollup_month_month.rollup_month,
          reporting_rollup_month_month.sales_month_bucket,
          reporting_rollup_month_month.activity_month_bucket
SEGMENTED BY hash(reporting_rollup_month_month.rollup_month, reporting_rollup_month_month.sales_month_bucket, reporting_rollup_month_month.activity_month_bucket) ALL NODES;

CREATE PROJECTION reporting.teva_plantrak_workbook_b0 /*+basename(teva_plantrak_workbook),createtype(L)*/ 
(
 payer_number,
 payer_name,
 payer_parent_number,
 payer_parent_name,
 plan_number,
 payer_plan_number,
 plan_name,
 model,
 method_of_payment,
 city,
 hq_state,
 operating_state,
 months_with_data,
 pbm_number,
 pbm_name,
 pbm_parent,
 pbm_parent_name,
 key_controlling_account,
 key_parent_account,
 lives_covered,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status,
 key_controlling_parent,
 pbm_payer_filter
)
AS
 SELECT teva_plantrak_workbook.payer_number,
        teva_plantrak_workbook.payer_name,
        teva_plantrak_workbook.payer_parent_number,
        teva_plantrak_workbook.payer_parent_name,
        teva_plantrak_workbook.plan_number,
        teva_plantrak_workbook.payer_plan_number,
        teva_plantrak_workbook.plan_name,
        teva_plantrak_workbook.model,
        teva_plantrak_workbook.method_of_payment,
        teva_plantrak_workbook.city,
        teva_plantrak_workbook.hq_state,
        teva_plantrak_workbook.operating_state,
        teva_plantrak_workbook.months_with_data,
        teva_plantrak_workbook.pbm_number,
        teva_plantrak_workbook.pbm_name,
        teva_plantrak_workbook.pbm_parent,
        teva_plantrak_workbook.pbm_parent_name,
        teva_plantrak_workbook.key_controlling_account,
        teva_plantrak_workbook.key_parent_account,
        teva_plantrak_workbook.lives_covered,
        teva_plantrak_workbook.ajovy_formulary_status,
        teva_plantrak_workbook.aimovig_formulary_status,
        teva_plantrak_workbook.emgality_formulary_status,
        teva_plantrak_workbook.key_controlling_parent,
        teva_plantrak_workbook.pbm_payer_filter
 FROM reporting.teva_plantrak_workbook
 ORDER BY teva_plantrak_workbook.payer_plan_number
SEGMENTED BY hash(teva_plantrak_workbook.payer_plan_number) ALL NODES;

CREATE PROJECTION reporting.sa_weekly_payer_prescriber_summary_b0 /*+basename(sa_weekly_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT sa_weekly_payer_prescriber_summary.sales_force_id,
        sa_weekly_payer_prescriber_summary.nation_id,
        sa_weekly_payer_prescriber_summary.nation,
        sa_weekly_payer_prescriber_summary.area_id,
        sa_weekly_payer_prescriber_summary.area,
        sa_weekly_payer_prescriber_summary.region_id,
        sa_weekly_payer_prescriber_summary.region,
        sa_weekly_payer_prescriber_summary.territory_id,
        sa_weekly_payer_prescriber_summary.territory,
        sa_weekly_payer_prescriber_summary.rep_name,
        sa_weekly_payer_prescriber_summary.user_id,
        sa_weekly_payer_prescriber_summary.time_period,
        sa_weekly_payer_prescriber_summary.period_type,
        sa_weekly_payer_prescriber_summary.period,
        sa_weekly_payer_prescriber_summary.market_id,
        sa_weekly_payer_prescriber_summary.market_name,
        sa_weekly_payer_prescriber_summary.brand_id,
        sa_weekly_payer_prescriber_summary.brand_name,
        sa_weekly_payer_prescriber_summary.teva_product_flag,
        sa_weekly_payer_prescriber_summary.payer_id,
        sa_weekly_payer_prescriber_summary.payer_name,
        sa_weekly_payer_prescriber_summary.plan_id,
        sa_weekly_payer_prescriber_summary.plan_name,
        sa_weekly_payer_prescriber_summary.payer_plan_id,
        sa_weekly_payer_prescriber_summary.customer_id,
        sa_weekly_payer_prescriber_summary.tvcmid,
        sa_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        sa_weekly_payer_prescriber_summary.prescriber_name,
        sa_weekly_payer_prescriber_summary.pdrp_flag,
        sa_weekly_payer_prescriber_summary.hcp_restriction_flag,
        sa_weekly_payer_prescriber_summary.address,
        sa_weekly_payer_prescriber_summary.city,
        sa_weekly_payer_prescriber_summary.state,
        sa_weekly_payer_prescriber_summary.zip,
        sa_weekly_payer_prescriber_summary.target_status_flag,
        sa_weekly_payer_prescriber_summary.partner_target_status_flag,
        sa_weekly_payer_prescriber_summary.method_of_payment,
        sa_weekly_payer_prescriber_summary.specialty,
        sa_weekly_payer_prescriber_summary.segment,
        sa_weekly_payer_prescriber_summary.decile,
        sa_weekly_payer_prescriber_summary.market_volume_indicator,
        sa_weekly_payer_prescriber_summary.product_vol_trx_count,
        sa_weekly_payer_prescriber_summary.market_vol_trx_count,
        sa_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        sa_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        sa_weekly_payer_prescriber_summary.product_vol_nrx_count,
        sa_weekly_payer_prescriber_summary.market_vol_nrx_count,
        sa_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        sa_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        sa_weekly_payer_prescriber_summary.samples,
        sa_weekly_payer_prescriber_summary.details_p1,
        sa_weekly_payer_prescriber_summary.details_p2,
        sa_weekly_payer_prescriber_summary.details_p3,
        sa_weekly_payer_prescriber_summary.focus_target
 FROM reporting.sa_weekly_payer_prescriber_summary
 ORDER BY sa_weekly_payer_prescriber_summary.sales_force_id,
          sa_weekly_payer_prescriber_summary.nation_id,
          sa_weekly_payer_prescriber_summary.nation,
          sa_weekly_payer_prescriber_summary.area_id,
          sa_weekly_payer_prescriber_summary.area,
          sa_weekly_payer_prescriber_summary.region_id,
          sa_weekly_payer_prescriber_summary.region,
          sa_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(sa_weekly_payer_prescriber_summary.sales_force_id, sa_weekly_payer_prescriber_summary.market_id, sa_weekly_payer_prescriber_summary.brand_id, sa_weekly_payer_prescriber_summary.teva_product_flag, sa_weekly_payer_prescriber_summary.payer_id, sa_weekly_payer_prescriber_summary.plan_id, sa_weekly_payer_prescriber_summary.tvcmid, sa_weekly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.sa_monthly_payer_prescriber_summary_b0 /*+basename(sa_monthly_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT sa_monthly_payer_prescriber_summary.sales_force_id,
        sa_monthly_payer_prescriber_summary.nation_id,
        sa_monthly_payer_prescriber_summary.nation,
        sa_monthly_payer_prescriber_summary.area_id,
        sa_monthly_payer_prescriber_summary.area,
        sa_monthly_payer_prescriber_summary.region_id,
        sa_monthly_payer_prescriber_summary.region,
        sa_monthly_payer_prescriber_summary.territory_id,
        sa_monthly_payer_prescriber_summary.territory,
        sa_monthly_payer_prescriber_summary.rep_name,
        sa_monthly_payer_prescriber_summary.user_id,
        sa_monthly_payer_prescriber_summary.time_period,
        sa_monthly_payer_prescriber_summary.period_type,
        sa_monthly_payer_prescriber_summary.period,
        sa_monthly_payer_prescriber_summary.market_id,
        sa_monthly_payer_prescriber_summary.market_name,
        sa_monthly_payer_prescriber_summary.brand_id,
        sa_monthly_payer_prescriber_summary.brand_name,
        sa_monthly_payer_prescriber_summary.teva_product_flag,
        sa_monthly_payer_prescriber_summary.payer_id,
        sa_monthly_payer_prescriber_summary.payer_name,
        sa_monthly_payer_prescriber_summary.plan_id,
        sa_monthly_payer_prescriber_summary.plan_name,
        sa_monthly_payer_prescriber_summary.payer_plan_id,
        sa_monthly_payer_prescriber_summary.customer_id,
        sa_monthly_payer_prescriber_summary.tvcmid,
        sa_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        sa_monthly_payer_prescriber_summary.prescriber_name,
        sa_monthly_payer_prescriber_summary.pdrp_flag,
        sa_monthly_payer_prescriber_summary.hcp_restriction_flag,
        sa_monthly_payer_prescriber_summary.address,
        sa_monthly_payer_prescriber_summary.city,
        sa_monthly_payer_prescriber_summary.state,
        sa_monthly_payer_prescriber_summary.zip,
        sa_monthly_payer_prescriber_summary.target_status_flag,
        sa_monthly_payer_prescriber_summary.partner_target_status_flag,
        sa_monthly_payer_prescriber_summary.method_of_payment,
        sa_monthly_payer_prescriber_summary.specialty,
        sa_monthly_payer_prescriber_summary.segment,
        sa_monthly_payer_prescriber_summary.decile,
        sa_monthly_payer_prescriber_summary.market_volume_indicator,
        sa_monthly_payer_prescriber_summary.product_vol_trx_count,
        sa_monthly_payer_prescriber_summary.market_vol_trx_count,
        sa_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        sa_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        sa_monthly_payer_prescriber_summary.product_vol_nrx_count,
        sa_monthly_payer_prescriber_summary.market_vol_nrx_count,
        sa_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        sa_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        sa_monthly_payer_prescriber_summary.samples,
        sa_monthly_payer_prescriber_summary.details_p1,
        sa_monthly_payer_prescriber_summary.details_p2,
        sa_monthly_payer_prescriber_summary.details_p3,
        sa_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        sa_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        sa_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        sa_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        sa_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        sa_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        sa_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        sa_monthly_payer_prescriber_summary.focus_target
 FROM reporting.sa_monthly_payer_prescriber_summary
 ORDER BY sa_monthly_payer_prescriber_summary.sales_force_id,
          sa_monthly_payer_prescriber_summary.nation_id,
          sa_monthly_payer_prescriber_summary.nation,
          sa_monthly_payer_prescriber_summary.area_id,
          sa_monthly_payer_prescriber_summary.area,
          sa_monthly_payer_prescriber_summary.region_id,
          sa_monthly_payer_prescriber_summary.region,
          sa_monthly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(sa_monthly_payer_prescriber_summary.sales_force_id, sa_monthly_payer_prescriber_summary.market_id, sa_monthly_payer_prescriber_summary.brand_id, sa_monthly_payer_prescriber_summary.teva_product_flag, sa_monthly_payer_prescriber_summary.payer_id, sa_monthly_payer_prescriber_summary.plan_id, sa_monthly_payer_prescriber_summary.tvcmid, sa_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.teva_plantrak_workbook_09132020_b0 /*+basename(teva_plantrak_workbook_09132020),createtype(A)*/ 
(
 payer_number,
 payer_name,
 payer_parent_number,
 payer_parent_name,
 plan_number,
 payer_plan_number,
 plan_name,
 model,
 method_of_payment,
 city,
 hq_state,
 operating_state,
 months_with_data,
 pbm_number,
 pbm_name,
 pbm_parent,
 pbm_parent_name,
 key_controlling_account,
 key_parent_account,
 lives_covered,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status
)
AS
 SELECT teva_plantrak_workbook_09132020.payer_number,
        teva_plantrak_workbook_09132020.payer_name,
        teva_plantrak_workbook_09132020.payer_parent_number,
        teva_plantrak_workbook_09132020.payer_parent_name,
        teva_plantrak_workbook_09132020.plan_number,
        teva_plantrak_workbook_09132020.payer_plan_number,
        teva_plantrak_workbook_09132020.plan_name,
        teva_plantrak_workbook_09132020.model,
        teva_plantrak_workbook_09132020.method_of_payment,
        teva_plantrak_workbook_09132020.city,
        teva_plantrak_workbook_09132020.hq_state,
        teva_plantrak_workbook_09132020.operating_state,
        teva_plantrak_workbook_09132020.months_with_data,
        teva_plantrak_workbook_09132020.pbm_number,
        teva_plantrak_workbook_09132020.pbm_name,
        teva_plantrak_workbook_09132020.pbm_parent,
        teva_plantrak_workbook_09132020.pbm_parent_name,
        teva_plantrak_workbook_09132020.key_controlling_account,
        teva_plantrak_workbook_09132020.key_parent_account,
        teva_plantrak_workbook_09132020.lives_covered,
        teva_plantrak_workbook_09132020.ajovy_formulary_status,
        teva_plantrak_workbook_09132020.aimovig_formulary_status,
        teva_plantrak_workbook_09132020.emgality_formulary_status
 FROM reporting.teva_plantrak_workbook_09132020
 ORDER BY teva_plantrak_workbook_09132020.payer_plan_number
SEGMENTED BY hash(teva_plantrak_workbook_09132020.payer_plan_number) ALL NODES;

CREATE PROJECTION reporting.engage_meeting_attendee_b0 /*+basename(engage_meeting_attendee),createtype(A)*/ 
(
 veeva_remote_meeting_id,
 engage_meeting_id,
 veeva_call_id,
 attendee_name,
 participant_id,
 join_time,
 leave_time,
 meeting_start_time,
 meeting_end_time,
 attendee_duration,
 meeting_duration,
 attendee_type
)
AS
 SELECT engage_meeting_attendee.veeva_remote_meeting_id,
        engage_meeting_attendee.engage_meeting_id,
        engage_meeting_attendee.veeva_call_id,
        engage_meeting_attendee.attendee_name,
        engage_meeting_attendee.participant_id,
        engage_meeting_attendee.join_time,
        engage_meeting_attendee.leave_time,
        engage_meeting_attendee.meeting_start_time,
        engage_meeting_attendee.meeting_end_time,
        engage_meeting_attendee.attendee_duration,
        engage_meeting_attendee.meeting_duration,
        engage_meeting_attendee.attendee_type
 FROM reporting.engage_meeting_attendee
 ORDER BY engage_meeting_attendee.veeva_remote_meeting_id,
          engage_meeting_attendee.engage_meeting_id,
          engage_meeting_attendee.veeva_call_id,
          engage_meeting_attendee.attendee_name,
          engage_meeting_attendee.participant_id,
          engage_meeting_attendee.join_time,
          engage_meeting_attendee.leave_time,
          engage_meeting_attendee.meeting_start_time,
          engage_meeting_attendee.meeting_end_time,
          engage_meeting_attendee.attendee_duration,
          engage_meeting_attendee.meeting_duration,
          engage_meeting_attendee.attendee_type
SEGMENTED BY hash(engage_meeting_attendee.veeva_remote_meeting_id, engage_meeting_attendee.engage_meeting_id, engage_meeting_attendee.veeva_call_id, engage_meeting_attendee.attendee_name, engage_meeting_attendee.participant_id, engage_meeting_attendee.join_time, engage_meeting_attendee.leave_time, engage_meeting_attendee.meeting_start_time, engage_meeting_attendee.meeting_end_time, engage_meeting_attendee.attendee_duration, engage_meeting_attendee.meeting_duration, engage_meeting_attendee.attendee_type) ALL NODES;

CREATE PROJECTION reporting.rs_weekly_prescriber_summary_b0 /*+basename(rs_weekly_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT rs_weekly_prescriber_summary.sales_force_id,
        rs_weekly_prescriber_summary.nation_id,
        rs_weekly_prescriber_summary.nation,
        rs_weekly_prescriber_summary.area_id,
        rs_weekly_prescriber_summary.area,
        rs_weekly_prescriber_summary.region_id,
        rs_weekly_prescriber_summary.region,
        rs_weekly_prescriber_summary.territory_id,
        rs_weekly_prescriber_summary.territory,
        rs_weekly_prescriber_summary.rep_name,
        rs_weekly_prescriber_summary.user_id,
        rs_weekly_prescriber_summary.time_period,
        rs_weekly_prescriber_summary.period_type,
        rs_weekly_prescriber_summary.period,
        rs_weekly_prescriber_summary.market_id,
        rs_weekly_prescriber_summary.market_name,
        rs_weekly_prescriber_summary.brand_id,
        rs_weekly_prescriber_summary.brand_name,
        rs_weekly_prescriber_summary.teva_product_flag,
        rs_weekly_prescriber_summary.customer_id,
        rs_weekly_prescriber_summary.tvcmid,
        rs_weekly_prescriber_summary.pdrp_flag,
        rs_weekly_prescriber_summary.hcp_restriction_flag,
        rs_weekly_prescriber_summary.prescriber_name,
        rs_weekly_prescriber_summary.new_prescriber,
        rs_weekly_prescriber_summary.address,
        rs_weekly_prescriber_summary.city,
        rs_weekly_prescriber_summary.state,
        rs_weekly_prescriber_summary.zip,
        rs_weekly_prescriber_summary.target_status_flag,
        rs_weekly_prescriber_summary.partner_target_status_flag,
        rs_weekly_prescriber_summary.method_of_payment,
        rs_weekly_prescriber_summary.specialty,
        rs_weekly_prescriber_summary.segment,
        rs_weekly_prescriber_summary.decile,
        rs_weekly_prescriber_summary.market_volume_indicator,
        rs_weekly_prescriber_summary.product_vol_trx_count,
        rs_weekly_prescriber_summary.market_vol_trx_count,
        rs_weekly_prescriber_summary.prev_prod_vol_trx_count,
        rs_weekly_prescriber_summary.prev_market_vol_trx_count,
        rs_weekly_prescriber_summary.product_vol_nrx_count,
        rs_weekly_prescriber_summary.market_vol_nrx_count,
        rs_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        rs_weekly_prescriber_summary.prev_market_vol_nrx_count,
        rs_weekly_prescriber_summary.samples,
        rs_weekly_prescriber_summary.details_p1,
        rs_weekly_prescriber_summary.details_p2,
        rs_weekly_prescriber_summary.details_p3
 FROM reporting.rs_weekly_prescriber_summary
 ORDER BY rs_weekly_prescriber_summary.sales_force_id,
          rs_weekly_prescriber_summary.nation_id,
          rs_weekly_prescriber_summary.nation,
          rs_weekly_prescriber_summary.area_id,
          rs_weekly_prescriber_summary.area,
          rs_weekly_prescriber_summary.region_id,
          rs_weekly_prescriber_summary.region,
          rs_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(rs_weekly_prescriber_summary.sales_force_id, rs_weekly_prescriber_summary.market_id, rs_weekly_prescriber_summary.brand_id, rs_weekly_prescriber_summary.teva_product_flag, rs_weekly_prescriber_summary.tvcmid, rs_weekly_prescriber_summary.pdrp_flag, rs_weekly_prescriber_summary.hcp_restriction_flag, rs_weekly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.rs_weekly_geography_summary_b0 /*+basename(rs_weekly_geography_summary),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT rs_weekly_geography_summary.sales_force_id,
        rs_weekly_geography_summary.geography_level,
        rs_weekly_geography_summary.geography_id,
        rs_weekly_geography_summary.geography,
        rs_weekly_geography_summary.rep_name,
        rs_weekly_geography_summary.user_id,
        rs_weekly_geography_summary.time_period,
        rs_weekly_geography_summary.period_type,
        rs_weekly_geography_summary.period,
        rs_weekly_geography_summary.market_id,
        rs_weekly_geography_summary.market_name,
        rs_weekly_geography_summary.brand_id,
        rs_weekly_geography_summary.brand_name,
        rs_weekly_geography_summary.teva_product_flag,
        rs_weekly_geography_summary.target_status_flag,
        rs_weekly_geography_summary.method_of_payment,
        rs_weekly_geography_summary.specialty,
        rs_weekly_geography_summary.segment,
        rs_weekly_geography_summary.market_volume_indicator,
        rs_weekly_geography_summary.product_vol_trx_count,
        rs_weekly_geography_summary.product_vol_new_pres_trx_count,
        rs_weekly_geography_summary.market_vol_trx_count,
        rs_weekly_geography_summary.prev_prod_vol_trx_count,
        rs_weekly_geography_summary.prev_market_vol_trx_count,
        rs_weekly_geography_summary.product_vol_nrx_count,
        rs_weekly_geography_summary.product_vol_new_pres_nrx_count,
        rs_weekly_geography_summary.market_vol_nrx_count,
        rs_weekly_geography_summary.prev_prod_vol_nrx_count,
        rs_weekly_geography_summary.prev_market_vol_nrx_count,
        rs_weekly_geography_summary.prescribers_count,
        rs_weekly_geography_summary.new_prescribers_count,
        rs_weekly_geography_summary.decile
 FROM reporting.rs_weekly_geography_summary
 ORDER BY rs_weekly_geography_summary.sales_force_id,
          rs_weekly_geography_summary.geography_level,
          rs_weekly_geography_summary.geography_id,
          rs_weekly_geography_summary.geography,
          rs_weekly_geography_summary.rep_name,
          rs_weekly_geography_summary.user_id,
          rs_weekly_geography_summary.time_period,
          rs_weekly_geography_summary.period_type
SEGMENTED BY hash(rs_weekly_geography_summary.sales_force_id, rs_weekly_geography_summary.market_id, rs_weekly_geography_summary.brand_id, rs_weekly_geography_summary.teva_product_flag, rs_weekly_geography_summary.target_status_flag, rs_weekly_geography_summary.market_volume_indicator, rs_weekly_geography_summary.prescribers_count, rs_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.rs_weekly_payer_prescriber_summary_b0 /*+basename(rs_weekly_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT rs_weekly_payer_prescriber_summary.sales_force_id,
        rs_weekly_payer_prescriber_summary.nation_id,
        rs_weekly_payer_prescriber_summary.nation,
        rs_weekly_payer_prescriber_summary.area_id,
        rs_weekly_payer_prescriber_summary.area,
        rs_weekly_payer_prescriber_summary.region_id,
        rs_weekly_payer_prescriber_summary.region,
        rs_weekly_payer_prescriber_summary.territory_id,
        rs_weekly_payer_prescriber_summary.territory,
        rs_weekly_payer_prescriber_summary.rep_name,
        rs_weekly_payer_prescriber_summary.user_id,
        rs_weekly_payer_prescriber_summary.time_period,
        rs_weekly_payer_prescriber_summary.period_type,
        rs_weekly_payer_prescriber_summary.period,
        rs_weekly_payer_prescriber_summary.market_id,
        rs_weekly_payer_prescriber_summary.market_name,
        rs_weekly_payer_prescriber_summary.brand_id,
        rs_weekly_payer_prescriber_summary.brand_name,
        rs_weekly_payer_prescriber_summary.teva_product_flag,
        rs_weekly_payer_prescriber_summary.payer_id,
        rs_weekly_payer_prescriber_summary.payer_name,
        rs_weekly_payer_prescriber_summary.plan_id,
        rs_weekly_payer_prescriber_summary.plan_name,
        rs_weekly_payer_prescriber_summary.payer_plan_id,
        rs_weekly_payer_prescriber_summary.customer_id,
        rs_weekly_payer_prescriber_summary.tvcmid,
        rs_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        rs_weekly_payer_prescriber_summary.prescriber_name,
        rs_weekly_payer_prescriber_summary.pdrp_flag,
        rs_weekly_payer_prescriber_summary.hcp_restriction_flag,
        rs_weekly_payer_prescriber_summary.address,
        rs_weekly_payer_prescriber_summary.city,
        rs_weekly_payer_prescriber_summary.state,
        rs_weekly_payer_prescriber_summary.zip,
        rs_weekly_payer_prescriber_summary.target_status_flag,
        rs_weekly_payer_prescriber_summary.partner_target_status_flag,
        rs_weekly_payer_prescriber_summary.method_of_payment,
        rs_weekly_payer_prescriber_summary.specialty,
        rs_weekly_payer_prescriber_summary.segment,
        rs_weekly_payer_prescriber_summary.decile,
        rs_weekly_payer_prescriber_summary.market_volume_indicator,
        rs_weekly_payer_prescriber_summary.product_vol_trx_count,
        rs_weekly_payer_prescriber_summary.market_vol_trx_count,
        rs_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        rs_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        rs_weekly_payer_prescriber_summary.product_vol_nrx_count,
        rs_weekly_payer_prescriber_summary.market_vol_nrx_count,
        rs_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        rs_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        rs_weekly_payer_prescriber_summary.samples,
        rs_weekly_payer_prescriber_summary.details_p1,
        rs_weekly_payer_prescriber_summary.details_p2,
        rs_weekly_payer_prescriber_summary.details_p3,
        rs_weekly_payer_prescriber_summary.focus_target
 FROM reporting.rs_weekly_payer_prescriber_summary
 ORDER BY rs_weekly_payer_prescriber_summary.sales_force_id,
          rs_weekly_payer_prescriber_summary.nation_id,
          rs_weekly_payer_prescriber_summary.nation,
          rs_weekly_payer_prescriber_summary.area_id,
          rs_weekly_payer_prescriber_summary.area,
          rs_weekly_payer_prescriber_summary.region_id,
          rs_weekly_payer_prescriber_summary.region,
          rs_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(rs_weekly_payer_prescriber_summary.sales_force_id, rs_weekly_payer_prescriber_summary.market_id, rs_weekly_payer_prescriber_summary.brand_id, rs_weekly_payer_prescriber_summary.teva_product_flag, rs_weekly_payer_prescriber_summary.payer_id, rs_weekly_payer_prescriber_summary.plan_id, rs_weekly_payer_prescriber_summary.tvcmid, rs_weekly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.rs_weekly_payer_geography_summary_b0 /*+basename(rs_weekly_payer_geography_summary),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count
)
AS
 SELECT rs_weekly_payer_geography_summary.sales_force_id,
        rs_weekly_payer_geography_summary.geography_level,
        rs_weekly_payer_geography_summary.geography_id,
        rs_weekly_payer_geography_summary.geography,
        rs_weekly_payer_geography_summary.rep_name,
        rs_weekly_payer_geography_summary.user_id,
        rs_weekly_payer_geography_summary.time_period,
        rs_weekly_payer_geography_summary.period_type,
        rs_weekly_payer_geography_summary.period,
        rs_weekly_payer_geography_summary.payer_id,
        rs_weekly_payer_geography_summary.payer_name,
        rs_weekly_payer_geography_summary.plan_id,
        rs_weekly_payer_geography_summary.plan_name,
        rs_weekly_payer_geography_summary.payer_plan_id,
        rs_weekly_payer_geography_summary.market_id,
        rs_weekly_payer_geography_summary.market_name,
        rs_weekly_payer_geography_summary.brand_id,
        rs_weekly_payer_geography_summary.brand_name,
        rs_weekly_payer_geography_summary.teva_product_flag,
        rs_weekly_payer_geography_summary.method_of_payment,
        rs_weekly_payer_geography_summary.market_volume_indicator,
        rs_weekly_payer_geography_summary.geo_plan_vol_rank,
        rs_weekly_payer_geography_summary.product_vol_trx_count,
        rs_weekly_payer_geography_summary.market_vol_trx_count,
        rs_weekly_payer_geography_summary.prev_prod_vol_trx_count,
        rs_weekly_payer_geography_summary.prev_market_vol_trx_count,
        rs_weekly_payer_geography_summary.product_vol_nrx_count,
        rs_weekly_payer_geography_summary.market_vol_nrx_count,
        rs_weekly_payer_geography_summary.prev_prod_vol_nrx_count,
        rs_weekly_payer_geography_summary.prev_market_vol_nrx_count
 FROM reporting.rs_weekly_payer_geography_summary
 ORDER BY rs_weekly_payer_geography_summary.sales_force_id,
          rs_weekly_payer_geography_summary.geography_level,
          rs_weekly_payer_geography_summary.geography_id,
          rs_weekly_payer_geography_summary.geography,
          rs_weekly_payer_geography_summary.rep_name,
          rs_weekly_payer_geography_summary.user_id,
          rs_weekly_payer_geography_summary.time_period,
          rs_weekly_payer_geography_summary.period_type
SEGMENTED BY hash(rs_weekly_payer_geography_summary.sales_force_id, rs_weekly_payer_geography_summary.payer_id, rs_weekly_payer_geography_summary.plan_id, rs_weekly_payer_geography_summary.market_id, rs_weekly_payer_geography_summary.brand_id, rs_weekly_payer_geography_summary.teva_product_flag, rs_weekly_payer_geography_summary.market_volume_indicator, rs_weekly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.rs_monthly_prescriber_summary_b0 /*+basename(rs_monthly_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT rs_monthly_prescriber_summary.sales_force_id,
        rs_monthly_prescriber_summary.nation_id,
        rs_monthly_prescriber_summary.nation,
        rs_monthly_prescriber_summary.area_id,
        rs_monthly_prescriber_summary.area,
        rs_monthly_prescriber_summary.region_id,
        rs_monthly_prescriber_summary.region,
        rs_monthly_prescriber_summary.territory_id,
        rs_monthly_prescriber_summary.territory,
        rs_monthly_prescriber_summary.rep_name,
        rs_monthly_prescriber_summary.user_id,
        rs_monthly_prescriber_summary.time_period,
        rs_monthly_prescriber_summary.period_type,
        rs_monthly_prescriber_summary.period,
        rs_monthly_prescriber_summary.market_id,
        rs_monthly_prescriber_summary.market_name,
        rs_monthly_prescriber_summary.brand_id,
        rs_monthly_prescriber_summary.brand_name,
        rs_monthly_prescriber_summary.teva_product_flag,
        rs_monthly_prescriber_summary.customer_id,
        rs_monthly_prescriber_summary.tvcmid,
        rs_monthly_prescriber_summary.pdrp_flag,
        rs_monthly_prescriber_summary.hcp_restriction_flag,
        rs_monthly_prescriber_summary.prescriber_name,
        rs_monthly_prescriber_summary.new_prescriber,
        rs_monthly_prescriber_summary.address,
        rs_monthly_prescriber_summary.city,
        rs_monthly_prescriber_summary.state,
        rs_monthly_prescriber_summary.zip,
        rs_monthly_prescriber_summary.target_status_flag,
        rs_monthly_prescriber_summary.partner_target_status_flag,
        rs_monthly_prescriber_summary.method_of_payment,
        rs_monthly_prescriber_summary.specialty,
        rs_monthly_prescriber_summary.segment,
        rs_monthly_prescriber_summary.decile,
        rs_monthly_prescriber_summary.market_volume_indicator,
        rs_monthly_prescriber_summary.product_vol_trx_count,
        rs_monthly_prescriber_summary.market_vol_trx_count,
        rs_monthly_prescriber_summary.prev_prod_vol_trx_count,
        rs_monthly_prescriber_summary.prev_market_vol_trx_count,
        rs_monthly_prescriber_summary.product_vol_nrx_count,
        rs_monthly_prescriber_summary.market_vol_nrx_count,
        rs_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        rs_monthly_prescriber_summary.prev_market_vol_nrx_count,
        rs_monthly_prescriber_summary.samples,
        rs_monthly_prescriber_summary.details_p1,
        rs_monthly_prescriber_summary.details_p2,
        rs_monthly_prescriber_summary.details_p3
 FROM reporting.rs_monthly_prescriber_summary
 ORDER BY rs_monthly_prescriber_summary.sales_force_id,
          rs_monthly_prescriber_summary.nation_id,
          rs_monthly_prescriber_summary.nation,
          rs_monthly_prescriber_summary.area_id,
          rs_monthly_prescriber_summary.area,
          rs_monthly_prescriber_summary.region_id,
          rs_monthly_prescriber_summary.region,
          rs_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(rs_monthly_prescriber_summary.sales_force_id, rs_monthly_prescriber_summary.market_id, rs_monthly_prescriber_summary.brand_id, rs_monthly_prescriber_summary.teva_product_flag, rs_monthly_prescriber_summary.tvcmid, rs_monthly_prescriber_summary.pdrp_flag, rs_monthly_prescriber_summary.hcp_restriction_flag, rs_monthly_prescriber_summary.new_prescriber) ALL NODES;

CREATE PROJECTION reporting.rs_monthly_geography_summary_b0 /*+basename(rs_monthly_geography_summary),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT rs_monthly_geography_summary.sales_force_id,
        rs_monthly_geography_summary.geography_level,
        rs_monthly_geography_summary.geography_id,
        rs_monthly_geography_summary.geography,
        rs_monthly_geography_summary.rep_name,
        rs_monthly_geography_summary.user_id,
        rs_monthly_geography_summary.time_period,
        rs_monthly_geography_summary.period_type,
        rs_monthly_geography_summary.period,
        rs_monthly_geography_summary.market_id,
        rs_monthly_geography_summary.market_name,
        rs_monthly_geography_summary.brand_id,
        rs_monthly_geography_summary.brand_name,
        rs_monthly_geography_summary.teva_product_flag,
        rs_monthly_geography_summary.target_status_flag,
        rs_monthly_geography_summary.method_of_payment,
        rs_monthly_geography_summary.specialty,
        rs_monthly_geography_summary.segment,
        rs_monthly_geography_summary.market_volume_indicator,
        rs_monthly_geography_summary.product_vol_trx_count,
        rs_monthly_geography_summary.product_vol_new_pres_trx_count,
        rs_monthly_geography_summary.market_vol_trx_count,
        rs_monthly_geography_summary.prev_prod_vol_trx_count,
        rs_monthly_geography_summary.prev_market_vol_trx_count,
        rs_monthly_geography_summary.product_vol_nrx_count,
        rs_monthly_geography_summary.product_vol_new_pres_nrx_count,
        rs_monthly_geography_summary.market_vol_nrx_count,
        rs_monthly_geography_summary.prev_prod_vol_nrx_count,
        rs_monthly_geography_summary.prev_market_vol_nrx_count,
        rs_monthly_geography_summary.prescribers_count,
        rs_monthly_geography_summary.new_prescribers_count,
        rs_monthly_geography_summary.decile
 FROM reporting.rs_monthly_geography_summary
 ORDER BY rs_monthly_geography_summary.sales_force_id,
          rs_monthly_geography_summary.geography_level,
          rs_monthly_geography_summary.geography_id,
          rs_monthly_geography_summary.geography,
          rs_monthly_geography_summary.rep_name,
          rs_monthly_geography_summary.user_id,
          rs_monthly_geography_summary.time_period,
          rs_monthly_geography_summary.period_type
SEGMENTED BY hash(rs_monthly_geography_summary.sales_force_id, rs_monthly_geography_summary.market_id, rs_monthly_geography_summary.brand_id, rs_monthly_geography_summary.teva_product_flag, rs_monthly_geography_summary.target_status_flag, rs_monthly_geography_summary.market_volume_indicator, rs_monthly_geography_summary.prescribers_count, rs_monthly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.rs_monthly_payer_prescriber_summary_b0 /*+basename(rs_monthly_payer_prescriber_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT rs_monthly_payer_prescriber_summary.sales_force_id,
        rs_monthly_payer_prescriber_summary.nation_id,
        rs_monthly_payer_prescriber_summary.nation,
        rs_monthly_payer_prescriber_summary.area_id,
        rs_monthly_payer_prescriber_summary.area,
        rs_monthly_payer_prescriber_summary.region_id,
        rs_monthly_payer_prescriber_summary.region,
        rs_monthly_payer_prescriber_summary.territory_id,
        rs_monthly_payer_prescriber_summary.territory,
        rs_monthly_payer_prescriber_summary.rep_name,
        rs_monthly_payer_prescriber_summary.user_id,
        rs_monthly_payer_prescriber_summary.time_period,
        rs_monthly_payer_prescriber_summary.period_type,
        rs_monthly_payer_prescriber_summary.period,
        rs_monthly_payer_prescriber_summary.market_id,
        rs_monthly_payer_prescriber_summary.market_name,
        rs_monthly_payer_prescriber_summary.brand_id,
        rs_monthly_payer_prescriber_summary.brand_name,
        rs_monthly_payer_prescriber_summary.teva_product_flag,
        rs_monthly_payer_prescriber_summary.payer_id,
        rs_monthly_payer_prescriber_summary.payer_name,
        rs_monthly_payer_prescriber_summary.plan_id,
        rs_monthly_payer_prescriber_summary.plan_name,
        rs_monthly_payer_prescriber_summary.payer_plan_id,
        rs_monthly_payer_prescriber_summary.customer_id,
        rs_monthly_payer_prescriber_summary.tvcmid,
        rs_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        rs_monthly_payer_prescriber_summary.prescriber_name,
        rs_monthly_payer_prescriber_summary.pdrp_flag,
        rs_monthly_payer_prescriber_summary.hcp_restriction_flag,
        rs_monthly_payer_prescriber_summary.address,
        rs_monthly_payer_prescriber_summary.city,
        rs_monthly_payer_prescriber_summary.state,
        rs_monthly_payer_prescriber_summary.zip,
        rs_monthly_payer_prescriber_summary.target_status_flag,
        rs_monthly_payer_prescriber_summary.partner_target_status_flag,
        rs_monthly_payer_prescriber_summary.method_of_payment,
        rs_monthly_payer_prescriber_summary.specialty,
        rs_monthly_payer_prescriber_summary.segment,
        rs_monthly_payer_prescriber_summary.decile,
        rs_monthly_payer_prescriber_summary.market_volume_indicator,
        rs_monthly_payer_prescriber_summary.product_vol_trx_count,
        rs_monthly_payer_prescriber_summary.market_vol_trx_count,
        rs_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        rs_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        rs_monthly_payer_prescriber_summary.product_vol_nrx_count,
        rs_monthly_payer_prescriber_summary.market_vol_nrx_count,
        rs_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        rs_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        rs_monthly_payer_prescriber_summary.samples,
        rs_monthly_payer_prescriber_summary.details_p1,
        rs_monthly_payer_prescriber_summary.details_p2,
        rs_monthly_payer_prescriber_summary.details_p3,
        rs_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        rs_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        rs_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        rs_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        rs_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        rs_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        rs_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        rs_monthly_payer_prescriber_summary.focus_target
 FROM reporting.rs_monthly_payer_prescriber_summary
 ORDER BY rs_monthly_payer_prescriber_summary.sales_force_id,
          rs_monthly_payer_prescriber_summary.nation_id,
          rs_monthly_payer_prescriber_summary.nation,
          rs_monthly_payer_prescriber_summary.area_id,
          rs_monthly_payer_prescriber_summary.area,
          rs_monthly_payer_prescriber_summary.region_id,
          rs_monthly_payer_prescriber_summary.region,
          rs_monthly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(rs_monthly_payer_prescriber_summary.sales_force_id, rs_monthly_payer_prescriber_summary.market_id, rs_monthly_payer_prescriber_summary.brand_id, rs_monthly_payer_prescriber_summary.teva_product_flag, rs_monthly_payer_prescriber_summary.payer_id, rs_monthly_payer_prescriber_summary.plan_id, rs_monthly_payer_prescriber_summary.tvcmid, rs_monthly_payer_prescriber_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.rs_monthly_payer_geography_summary_b0 /*+basename(rs_monthly_payer_geography_summary),createtype(A)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count
)
AS
 SELECT rs_monthly_payer_geography_summary.sales_force_id,
        rs_monthly_payer_geography_summary.geography_level,
        rs_monthly_payer_geography_summary.geography_id,
        rs_monthly_payer_geography_summary.geography,
        rs_monthly_payer_geography_summary.rep_name,
        rs_monthly_payer_geography_summary.user_id,
        rs_monthly_payer_geography_summary.time_period,
        rs_monthly_payer_geography_summary.period_type,
        rs_monthly_payer_geography_summary.period,
        rs_monthly_payer_geography_summary.payer_id,
        rs_monthly_payer_geography_summary.payer_name,
        rs_monthly_payer_geography_summary.plan_id,
        rs_monthly_payer_geography_summary.plan_name,
        rs_monthly_payer_geography_summary.payer_plan_id,
        rs_monthly_payer_geography_summary.market_id,
        rs_monthly_payer_geography_summary.market_name,
        rs_monthly_payer_geography_summary.brand_id,
        rs_monthly_payer_geography_summary.brand_name,
        rs_monthly_payer_geography_summary.teva_product_flag,
        rs_monthly_payer_geography_summary.method_of_payment,
        rs_monthly_payer_geography_summary.market_volume_indicator,
        rs_monthly_payer_geography_summary.geo_plan_vol_rank,
        rs_monthly_payer_geography_summary.product_vol_trx_count,
        rs_monthly_payer_geography_summary.market_vol_trx_count,
        rs_monthly_payer_geography_summary.prev_prod_vol_trx_count,
        rs_monthly_payer_geography_summary.prev_market_vol_trx_count,
        rs_monthly_payer_geography_summary.product_vol_nrx_count,
        rs_monthly_payer_geography_summary.market_vol_nrx_count,
        rs_monthly_payer_geography_summary.prev_prod_vol_nrx_count,
        rs_monthly_payer_geography_summary.prev_market_vol_nrx_count,
        rs_monthly_payer_geography_summary.Nation_Product_TRx_Count,
        rs_monthly_payer_geography_summary.Nation_Product_NRx_Count,
        rs_monthly_payer_geography_summary.Nation_Market_TRx_Count,
        rs_monthly_payer_geography_summary.Nation_Market_NRx_Count
 FROM reporting.rs_monthly_payer_geography_summary
 ORDER BY rs_monthly_payer_geography_summary.sales_force_id,
          rs_monthly_payer_geography_summary.geography_level,
          rs_monthly_payer_geography_summary.geography_id,
          rs_monthly_payer_geography_summary.geography,
          rs_monthly_payer_geography_summary.rep_name,
          rs_monthly_payer_geography_summary.user_id,
          rs_monthly_payer_geography_summary.time_period,
          rs_monthly_payer_geography_summary.period_type
SEGMENTED BY hash(rs_monthly_payer_geography_summary.sales_force_id, rs_monthly_payer_geography_summary.payer_id, rs_monthly_payer_geography_summary.plan_id, rs_monthly_payer_geography_summary.market_id, rs_monthly_payer_geography_summary.brand_id, rs_monthly_payer_geography_summary.teva_product_flag, rs_monthly_payer_geography_summary.market_volume_indicator, rs_monthly_payer_geography_summary.geo_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.rs_pre_call_summary_b0 /*+basename(rs_pre_call_summary),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT rs_pre_call_summary.sales_force_id,
        rs_pre_call_summary.nation_id,
        rs_pre_call_summary.nation,
        rs_pre_call_summary.area_id,
        rs_pre_call_summary.area,
        rs_pre_call_summary.region_id,
        rs_pre_call_summary.region,
        rs_pre_call_summary.territory_id,
        rs_pre_call_summary.territory,
        rs_pre_call_summary.rep_name,
        rs_pre_call_summary.user_id,
        rs_pre_call_summary.time_period,
        rs_pre_call_summary.period_type,
        rs_pre_call_summary.period,
        rs_pre_call_summary.market_id,
        rs_pre_call_summary.market_name,
        rs_pre_call_summary.brand_id,
        rs_pre_call_summary.brand_name,
        rs_pre_call_summary.teva_product_flag,
        rs_pre_call_summary.payer_id,
        rs_pre_call_summary.payer_name,
        rs_pre_call_summary.plan_id,
        rs_pre_call_summary.plan_name,
        rs_pre_call_summary.payer_plan_id,
        rs_pre_call_summary.customer_id,
        rs_pre_call_summary.tvcmid,
        rs_pre_call_summary.hcp_plan_vol_rank,
        rs_pre_call_summary.prescriber_name,
        rs_pre_call_summary.pdrp_flag,
        rs_pre_call_summary.hcp_restriction_flag,
        rs_pre_call_summary.address,
        rs_pre_call_summary.city,
        rs_pre_call_summary.state,
        rs_pre_call_summary.zip,
        rs_pre_call_summary.target_status_flag,
        rs_pre_call_summary.partner_target_status_flag,
        rs_pre_call_summary.method_of_payment,
        rs_pre_call_summary.specialty,
        rs_pre_call_summary.segment,
        rs_pre_call_summary.decile,
        rs_pre_call_summary.market_volume_indicator,
        rs_pre_call_summary.product_vol_trx_count,
        rs_pre_call_summary.market_vol_trx_count,
        rs_pre_call_summary.prev_prod_vol_trx_count,
        rs_pre_call_summary.prev_market_vol_trx_count,
        rs_pre_call_summary.product_vol_nrx_count,
        rs_pre_call_summary.market_vol_nrx_count,
        rs_pre_call_summary.prev_prod_vol_nrx_count,
        rs_pre_call_summary.prev_market_vol_nrx_count,
        rs_pre_call_summary.samples,
        rs_pre_call_summary.details_p1,
        rs_pre_call_summary.details_p2,
        rs_pre_call_summary.details_p3,
        rs_pre_call_summary.focus_target
 FROM reporting.rs_pre_call_summary
 ORDER BY rs_pre_call_summary.sales_force_id,
          rs_pre_call_summary.nation_id,
          rs_pre_call_summary.nation,
          rs_pre_call_summary.area_id,
          rs_pre_call_summary.area,
          rs_pre_call_summary.region_id,
          rs_pre_call_summary.region,
          rs_pre_call_summary.territory_id
SEGMENTED BY hash(rs_pre_call_summary.sales_force_id, rs_pre_call_summary.market_id, rs_pre_call_summary.brand_id, rs_pre_call_summary.teva_product_flag, rs_pre_call_summary.payer_id, rs_pre_call_summary.plan_id, rs_pre_call_summary.tvcmid, rs_pre_call_summary.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.ajovy_reverse_geo_payer_b0 /*+basename(ajovy_reverse_geo_payer),createtype(L)*/ 
(
 ma_nation_id,
 ma_nation,
 ma_area_id,
 ma_area,
 ma_region_id,
 ma_region,
 ma_territory_id,
 ma_territory,
 ns_nation_id,
 ns_nation,
 ns_area_id,
 ns_area,
 ns_region_id,
 ns_region,
 ns_territory_id,
 ns_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 ajovy_formulary_status,
 aimovig_formulary_status,
 emgality_formulary_status,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 lives_covered
)
AS
 SELECT ajovy_reverse_geo_payer.ma_nation_id,
        ajovy_reverse_geo_payer.ma_nation,
        ajovy_reverse_geo_payer.ma_area_id,
        ajovy_reverse_geo_payer.ma_area,
        ajovy_reverse_geo_payer.ma_region_id,
        ajovy_reverse_geo_payer.ma_region,
        ajovy_reverse_geo_payer.ma_territory_id,
        ajovy_reverse_geo_payer.ma_territory,
        ajovy_reverse_geo_payer.ns_nation_id,
        ajovy_reverse_geo_payer.ns_nation,
        ajovy_reverse_geo_payer.ns_area_id,
        ajovy_reverse_geo_payer.ns_area,
        ajovy_reverse_geo_payer.ns_region_id,
        ajovy_reverse_geo_payer.ns_region,
        ajovy_reverse_geo_payer.ns_territory_id,
        ajovy_reverse_geo_payer.ns_territory,
        ajovy_reverse_geo_payer.market_id,
        ajovy_reverse_geo_payer.market_name,
        ajovy_reverse_geo_payer.brand_id,
        ajovy_reverse_geo_payer.brand_name,
        ajovy_reverse_geo_payer.teva_product_flag,
        ajovy_reverse_geo_payer.time_period,
        ajovy_reverse_geo_payer.period_type,
        ajovy_reverse_geo_payer.period,
        ajovy_reverse_geo_payer.pbm_id,
        ajovy_reverse_geo_payer.pbm_name,
        ajovy_reverse_geo_payer.payer_id,
        ajovy_reverse_geo_payer.payer_name,
        ajovy_reverse_geo_payer.plan_id,
        ajovy_reverse_geo_payer.plan_name,
        ajovy_reverse_geo_payer.payer_plan_id,
        ajovy_reverse_geo_payer.method_of_payment,
        ajovy_reverse_geo_payer.state,
        ajovy_reverse_geo_payer.zip,
        ajovy_reverse_geo_payer.final_key_controlling_account,
        ajovy_reverse_geo_payer.key_parent_account,
        ajovy_reverse_geo_payer.ajovy_formulary_status,
        ajovy_reverse_geo_payer.aimovig_formulary_status,
        ajovy_reverse_geo_payer.emgality_formulary_status,
        ajovy_reverse_geo_payer.plan_payment_type,
        ajovy_reverse_geo_payer.market_volume_indicator,
        ajovy_reverse_geo_payer.product_vol_trx_count,
        ajovy_reverse_geo_payer.market_vol_trx_count,
        ajovy_reverse_geo_payer.product_vol_nrx_count,
        ajovy_reverse_geo_payer.market_vol_nrx_count,
        ajovy_reverse_geo_payer.lives_covered
 FROM reporting.ajovy_reverse_geo_payer
 ORDER BY ajovy_reverse_geo_payer.ma_nation_id,
          ajovy_reverse_geo_payer.ma_nation,
          ajovy_reverse_geo_payer.ma_area_id,
          ajovy_reverse_geo_payer.ma_area,
          ajovy_reverse_geo_payer.ma_region_id,
          ajovy_reverse_geo_payer.ma_region,
          ajovy_reverse_geo_payer.ma_territory_id,
          ajovy_reverse_geo_payer.ma_territory
SEGMENTED BY hash(ajovy_reverse_geo_payer.ma_nation_id, ajovy_reverse_geo_payer.ma_area_id, ajovy_reverse_geo_payer.ma_region_id, ajovy_reverse_geo_payer.ma_territory_id, ajovy_reverse_geo_payer.ns_nation_id, ajovy_reverse_geo_payer.ns_area_id, ajovy_reverse_geo_payer.ns_region_id, ajovy_reverse_geo_payer.ns_territory_id) ALL NODES;

CREATE PROJECTION reporting.austedo_reverse_geo_payer_b0 /*+basename(austedo_reverse_geo_payer),createtype(L)*/ 
(
 ma_nation_id,
 ma_nation,
 ma_area_id,
 ma_area,
 ma_region_id,
 ma_region,
 ma_territory_id,
 ma_territory,
 np_nation_id,
 np_nation,
 np_area_id,
 np_area,
 np_region_id,
 np_region,
 np_territory_id,
 np_territory,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 time_period,
 period_type,
 period,
 pbm_id,
 pbm_name,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 method_of_payment,
 state,
 zip,
 final_key_controlling_account,
 key_parent_account,
 plan_payment_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count
)
AS
 SELECT austedo_reverse_geo_payer.ma_nation_id,
        austedo_reverse_geo_payer.ma_nation,
        austedo_reverse_geo_payer.ma_area_id,
        austedo_reverse_geo_payer.ma_area,
        austedo_reverse_geo_payer.ma_region_id,
        austedo_reverse_geo_payer.ma_region,
        austedo_reverse_geo_payer.ma_territory_id,
        austedo_reverse_geo_payer.ma_territory,
        austedo_reverse_geo_payer.np_nation_id,
        austedo_reverse_geo_payer.np_nation,
        austedo_reverse_geo_payer.np_area_id,
        austedo_reverse_geo_payer.np_area,
        austedo_reverse_geo_payer.np_region_id,
        austedo_reverse_geo_payer.np_region,
        austedo_reverse_geo_payer.np_territory_id,
        austedo_reverse_geo_payer.np_territory,
        austedo_reverse_geo_payer.market_id,
        austedo_reverse_geo_payer.market_name,
        austedo_reverse_geo_payer.brand_id,
        austedo_reverse_geo_payer.brand_name,
        austedo_reverse_geo_payer.teva_product_flag,
        austedo_reverse_geo_payer.time_period,
        austedo_reverse_geo_payer.period_type,
        austedo_reverse_geo_payer.period,
        austedo_reverse_geo_payer.pbm_id,
        austedo_reverse_geo_payer.pbm_name,
        austedo_reverse_geo_payer.payer_id,
        austedo_reverse_geo_payer.payer_name,
        austedo_reverse_geo_payer.plan_id,
        austedo_reverse_geo_payer.plan_name,
        austedo_reverse_geo_payer.payer_plan_id,
        austedo_reverse_geo_payer.method_of_payment,
        austedo_reverse_geo_payer.state,
        austedo_reverse_geo_payer.zip,
        austedo_reverse_geo_payer.final_key_controlling_account,
        austedo_reverse_geo_payer.key_parent_account,
        austedo_reverse_geo_payer.plan_payment_type,
        austedo_reverse_geo_payer.market_volume_indicator,
        austedo_reverse_geo_payer.product_vol_trx_count,
        austedo_reverse_geo_payer.market_vol_trx_count,
        austedo_reverse_geo_payer.product_vol_nrx_count,
        austedo_reverse_geo_payer.market_vol_nrx_count
 FROM reporting.austedo_reverse_geo_payer
 ORDER BY austedo_reverse_geo_payer.ma_nation_id,
          austedo_reverse_geo_payer.ma_nation,
          austedo_reverse_geo_payer.ma_area_id,
          austedo_reverse_geo_payer.ma_area,
          austedo_reverse_geo_payer.ma_region_id,
          austedo_reverse_geo_payer.ma_region,
          austedo_reverse_geo_payer.ma_territory_id,
          austedo_reverse_geo_payer.ma_territory
SEGMENTED BY hash(austedo_reverse_geo_payer.ma_nation_id, austedo_reverse_geo_payer.ma_area_id, austedo_reverse_geo_payer.ma_region_id, austedo_reverse_geo_payer.ma_territory_id, austedo_reverse_geo_payer.np_nation_id, austedo_reverse_geo_payer.np_area_id, austedo_reverse_geo_payer.np_region_id, austedo_reverse_geo_payer.np_territory_id) ALL NODES;

CREATE PROJECTION reporting.rs_pre_call_summary_tmp_b0 /*+basename(rs_pre_call_summary_tmp),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT rs_pre_call_summary_tmp.sales_force_id,
        rs_pre_call_summary_tmp.nation_id,
        rs_pre_call_summary_tmp.nation,
        rs_pre_call_summary_tmp.area_id,
        rs_pre_call_summary_tmp.area,
        rs_pre_call_summary_tmp.region_id,
        rs_pre_call_summary_tmp.region,
        rs_pre_call_summary_tmp.territory_id,
        rs_pre_call_summary_tmp.territory,
        rs_pre_call_summary_tmp.rep_name,
        rs_pre_call_summary_tmp.user_id,
        rs_pre_call_summary_tmp.time_period,
        rs_pre_call_summary_tmp.period_type,
        rs_pre_call_summary_tmp.period,
        rs_pre_call_summary_tmp.market_id,
        rs_pre_call_summary_tmp.market_name,
        rs_pre_call_summary_tmp.brand_id,
        rs_pre_call_summary_tmp.brand_name,
        rs_pre_call_summary_tmp.teva_product_flag,
        rs_pre_call_summary_tmp.payer_id,
        rs_pre_call_summary_tmp.payer_name,
        rs_pre_call_summary_tmp.plan_id,
        rs_pre_call_summary_tmp.plan_name,
        rs_pre_call_summary_tmp.payer_plan_id,
        rs_pre_call_summary_tmp.customer_id,
        rs_pre_call_summary_tmp.tvcmid,
        rs_pre_call_summary_tmp.hcp_plan_vol_rank,
        rs_pre_call_summary_tmp.prescriber_name,
        rs_pre_call_summary_tmp.pdrp_flag,
        rs_pre_call_summary_tmp.hcp_restriction_flag,
        rs_pre_call_summary_tmp.address,
        rs_pre_call_summary_tmp.city,
        rs_pre_call_summary_tmp.state,
        rs_pre_call_summary_tmp.zip,
        rs_pre_call_summary_tmp.target_status_flag,
        rs_pre_call_summary_tmp.partner_target_status_flag,
        rs_pre_call_summary_tmp.method_of_payment,
        rs_pre_call_summary_tmp.specialty,
        rs_pre_call_summary_tmp.segment,
        rs_pre_call_summary_tmp.decile,
        rs_pre_call_summary_tmp.market_volume_indicator,
        rs_pre_call_summary_tmp.product_vol_trx_count,
        rs_pre_call_summary_tmp.market_vol_trx_count,
        rs_pre_call_summary_tmp.prev_prod_vol_trx_count,
        rs_pre_call_summary_tmp.prev_market_vol_trx_count,
        rs_pre_call_summary_tmp.product_vol_nrx_count,
        rs_pre_call_summary_tmp.market_vol_nrx_count,
        rs_pre_call_summary_tmp.prev_prod_vol_nrx_count,
        rs_pre_call_summary_tmp.prev_market_vol_nrx_count,
        rs_pre_call_summary_tmp.samples,
        rs_pre_call_summary_tmp.details_p1,
        rs_pre_call_summary_tmp.details_p2,
        rs_pre_call_summary_tmp.details_p3,
        rs_pre_call_summary_tmp.focus_target
 FROM reporting.rs_pre_call_summary_tmp
 ORDER BY rs_pre_call_summary_tmp.sales_force_id,
          rs_pre_call_summary_tmp.nation_id,
          rs_pre_call_summary_tmp.nation,
          rs_pre_call_summary_tmp.area_id,
          rs_pre_call_summary_tmp.area,
          rs_pre_call_summary_tmp.region_id,
          rs_pre_call_summary_tmp.region,
          rs_pre_call_summary_tmp.territory_id
SEGMENTED BY hash(rs_pre_call_summary_tmp.sales_force_id, rs_pre_call_summary_tmp.market_id, rs_pre_call_summary_tmp.brand_id, rs_pre_call_summary_tmp.teva_product_flag, rs_pre_call_summary_tmp.payer_id, rs_pre_call_summary_tmp.plan_id, rs_pre_call_summary_tmp.tvcmid, rs_pre_call_summary_tmp.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.approved_email_hist_b0 /*+basename(approved_email_hist),createtype(A)*/ 
(
 veeva_sent_email_id,
 sent_email_id,
 product,
 date_sent,
 status,
 failure_message,
 veeva_account_id,
 tvcmid,
 veeva_call_id,
 call_id,
 sender_email,
 territory,
 recipient_email,
 click_count,
 open_count,
 last_open_date,
 valid_consent,
 delivered,
 opened,
 dropped,
 clicked,
 downloaded,
 viewed,
 template_id,
 template_name,
 event_msg_vod__c,
 click_url_vod__c,
 subject
)
AS
 SELECT approved_email_hist.veeva_sent_email_id,
        approved_email_hist.sent_email_id,
        approved_email_hist.product,
        approved_email_hist.date_sent,
        approved_email_hist.status,
        approved_email_hist.failure_message,
        approved_email_hist.veeva_account_id,
        approved_email_hist.tvcmid,
        approved_email_hist.veeva_call_id,
        approved_email_hist.call_id,
        approved_email_hist.sender_email,
        approved_email_hist.territory,
        approved_email_hist.recipient_email,
        approved_email_hist.click_count,
        approved_email_hist.open_count,
        approved_email_hist.last_open_date,
        approved_email_hist.valid_consent,
        approved_email_hist.delivered,
        approved_email_hist.opened,
        approved_email_hist.dropped,
        approved_email_hist.clicked,
        approved_email_hist.downloaded,
        approved_email_hist.viewed,
        approved_email_hist.template_id,
        approved_email_hist.template_name,
        approved_email_hist.event_msg_vod__c,
        approved_email_hist.click_url_vod__c,
        approved_email_hist.subject
 FROM reporting.approved_email_hist
 ORDER BY approved_email_hist.veeva_sent_email_id,
          approved_email_hist.sent_email_id,
          approved_email_hist.product,
          approved_email_hist.date_sent,
          approved_email_hist.status,
          approved_email_hist.failure_message,
          approved_email_hist.veeva_account_id,
          approved_email_hist.tvcmid
SEGMENTED BY hash(approved_email_hist.date_sent, approved_email_hist.tvcmid, approved_email_hist.click_count, approved_email_hist.open_count, approved_email_hist.last_open_date, approved_email_hist.valid_consent, approved_email_hist.delivered, approved_email_hist.opened) ALL NODES;

CREATE PROJECTION reporting.zs_teva_payer_master_detailed_b0 /*+basename(zs_teva_payer_master_detailed),createtype(L)*/ 
(
 plan_code,
 Plan_Name,
 Payer_Name,
 PBM,
 Payment_Type,
 Key_Controlling_Plan_Formulary,
 Key_Controlling_Account,
 AJOVY_Access_for_FTF_Plan,
 Aimovig_Access_for_FTF_Plan,
 Emgality_Access_for_FTF_Plan,
 Apportionment_Factor,
 key_controlling_parent,
 pbm_payer_filter
)
AS
 SELECT zs_teva_payer_master_detailed.plan_code,
        zs_teva_payer_master_detailed.Plan_Name,
        zs_teva_payer_master_detailed.Payer_Name,
        zs_teva_payer_master_detailed.PBM,
        zs_teva_payer_master_detailed.Payment_Type,
        zs_teva_payer_master_detailed.Key_Controlling_Plan_Formulary,
        zs_teva_payer_master_detailed.Key_Controlling_Account,
        zs_teva_payer_master_detailed.AJOVY_Access_for_FTF_Plan,
        zs_teva_payer_master_detailed.Aimovig_Access_for_FTF_Plan,
        zs_teva_payer_master_detailed.Emgality_Access_for_FTF_Plan,
        zs_teva_payer_master_detailed.Apportionment_Factor,
        zs_teva_payer_master_detailed.key_controlling_parent,
        zs_teva_payer_master_detailed.pbm_payer_filter
 FROM reporting.zs_teva_payer_master_detailed
 ORDER BY zs_teva_payer_master_detailed.plan_code,
          zs_teva_payer_master_detailed.Plan_Name,
          zs_teva_payer_master_detailed.Payer_Name,
          zs_teva_payer_master_detailed.PBM,
          zs_teva_payer_master_detailed.Payment_Type,
          zs_teva_payer_master_detailed.Key_Controlling_Plan_Formulary,
          zs_teva_payer_master_detailed.Key_Controlling_Account,
          zs_teva_payer_master_detailed.AJOVY_Access_for_FTF_Plan
SEGMENTED BY hash(zs_teva_payer_master_detailed.Apportionment_Factor, zs_teva_payer_master_detailed.plan_code, zs_teva_payer_master_detailed.AJOVY_Access_for_FTF_Plan, zs_teva_payer_master_detailed.Aimovig_Access_for_FTF_Plan, zs_teva_payer_master_detailed.Emgality_Access_for_FTF_Plan, zs_teva_payer_master_detailed.Plan_Name, zs_teva_payer_master_detailed.Payer_Name, zs_teva_payer_master_detailed.PBM) ALL NODES;

CREATE PROJECTION reporting.tmp_ma_mnthly_pyr_pres_summ_b0 /*+basename(tmp_ma_mnthly_pyr_pres_summ),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT tmp_ma_mnthly_pyr_pres_summ.sales_force_id,
        tmp_ma_mnthly_pyr_pres_summ.nation_id,
        tmp_ma_mnthly_pyr_pres_summ.nation,
        tmp_ma_mnthly_pyr_pres_summ.area_id,
        tmp_ma_mnthly_pyr_pres_summ.area,
        tmp_ma_mnthly_pyr_pres_summ.region_id,
        tmp_ma_mnthly_pyr_pres_summ.region,
        tmp_ma_mnthly_pyr_pres_summ.territory_id,
        tmp_ma_mnthly_pyr_pres_summ.territory,
        tmp_ma_mnthly_pyr_pres_summ.rep_name,
        tmp_ma_mnthly_pyr_pres_summ.user_id,
        tmp_ma_mnthly_pyr_pres_summ.time_period,
        tmp_ma_mnthly_pyr_pres_summ.period_type,
        tmp_ma_mnthly_pyr_pres_summ.period,
        tmp_ma_mnthly_pyr_pres_summ.market_id,
        tmp_ma_mnthly_pyr_pres_summ.market_name,
        tmp_ma_mnthly_pyr_pres_summ.brand_id,
        tmp_ma_mnthly_pyr_pres_summ.brand_name,
        tmp_ma_mnthly_pyr_pres_summ.teva_product_flag,
        tmp_ma_mnthly_pyr_pres_summ.payer_id,
        tmp_ma_mnthly_pyr_pres_summ.payer_name,
        tmp_ma_mnthly_pyr_pres_summ.plan_id,
        tmp_ma_mnthly_pyr_pres_summ.plan_name,
        tmp_ma_mnthly_pyr_pres_summ.payer_plan_id,
        tmp_ma_mnthly_pyr_pres_summ.customer_id,
        tmp_ma_mnthly_pyr_pres_summ.tvcmid,
        tmp_ma_mnthly_pyr_pres_summ.hcp_plan_vol_rank,
        tmp_ma_mnthly_pyr_pres_summ.prescriber_name,
        tmp_ma_mnthly_pyr_pres_summ.pdrp_flag,
        tmp_ma_mnthly_pyr_pres_summ.hcp_restriction_flag,
        tmp_ma_mnthly_pyr_pres_summ.address,
        tmp_ma_mnthly_pyr_pres_summ.city,
        tmp_ma_mnthly_pyr_pres_summ.state,
        tmp_ma_mnthly_pyr_pres_summ.zip,
        tmp_ma_mnthly_pyr_pres_summ.target_status_flag,
        tmp_ma_mnthly_pyr_pres_summ.partner_target_status_flag,
        tmp_ma_mnthly_pyr_pres_summ.method_of_payment,
        tmp_ma_mnthly_pyr_pres_summ.specialty,
        tmp_ma_mnthly_pyr_pres_summ.segment,
        tmp_ma_mnthly_pyr_pres_summ.decile,
        tmp_ma_mnthly_pyr_pres_summ.market_volume_indicator,
        tmp_ma_mnthly_pyr_pres_summ.product_vol_trx_count,
        tmp_ma_mnthly_pyr_pres_summ.market_vol_trx_count,
        tmp_ma_mnthly_pyr_pres_summ.prev_prod_vol_trx_count,
        tmp_ma_mnthly_pyr_pres_summ.prev_market_vol_trx_count,
        tmp_ma_mnthly_pyr_pres_summ.product_vol_nrx_count,
        tmp_ma_mnthly_pyr_pres_summ.market_vol_nrx_count,
        tmp_ma_mnthly_pyr_pres_summ.prev_prod_vol_nrx_count,
        tmp_ma_mnthly_pyr_pres_summ.prev_market_vol_nrx_count,
        tmp_ma_mnthly_pyr_pres_summ.samples,
        tmp_ma_mnthly_pyr_pres_summ.details_p1,
        tmp_ma_mnthly_pyr_pres_summ.details_p2,
        tmp_ma_mnthly_pyr_pres_summ.details_p3,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_TRx_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_NRx_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_TRx_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_NRx_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_TRx_Payer_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_NRx_Payer_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_TRx_Payer_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_NRx_Payer_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_TRx_Plan_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Product_NRx_Plan_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_TRx_Plan_Count,
        tmp_ma_mnthly_pyr_pres_summ.Nation_Market_NRx_Plan_Count,
        tmp_ma_mnthly_pyr_pres_summ.focus_target
 FROM reporting.tmp_ma_mnthly_pyr_pres_summ
 ORDER BY tmp_ma_mnthly_pyr_pres_summ.sales_force_id,
          tmp_ma_mnthly_pyr_pres_summ.nation_id,
          tmp_ma_mnthly_pyr_pres_summ.nation,
          tmp_ma_mnthly_pyr_pres_summ.area_id,
          tmp_ma_mnthly_pyr_pres_summ.area,
          tmp_ma_mnthly_pyr_pres_summ.region_id,
          tmp_ma_mnthly_pyr_pres_summ.region,
          tmp_ma_mnthly_pyr_pres_summ.territory_id
SEGMENTED BY hash(tmp_ma_mnthly_pyr_pres_summ.sales_force_id, tmp_ma_mnthly_pyr_pres_summ.market_id, tmp_ma_mnthly_pyr_pres_summ.brand_id, tmp_ma_mnthly_pyr_pres_summ.teva_product_flag, tmp_ma_mnthly_pyr_pres_summ.payer_id, tmp_ma_mnthly_pyr_pres_summ.plan_id, tmp_ma_mnthly_pyr_pres_summ.tvcmid, tmp_ma_mnthly_pyr_pres_summ.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tp_pre_calls_anti_psych_b0 /*+basename(tp_pre_calls_anti_psych),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 cogentine_decile_value,
 antipsych_decile_value,
 focus_target,
 titration_flag,
 AssistRx_flag,
 ShSol_flag
)
AS
 SELECT tp_pre_calls_anti_psych.sales_force_id,
        tp_pre_calls_anti_psych.nation_id,
        tp_pre_calls_anti_psych.nation,
        tp_pre_calls_anti_psych.area_id,
        tp_pre_calls_anti_psych.area,
        tp_pre_calls_anti_psych.region_id,
        tp_pre_calls_anti_psych.region,
        tp_pre_calls_anti_psych.territory_id,
        tp_pre_calls_anti_psych.territory,
        tp_pre_calls_anti_psych.rep_name,
        tp_pre_calls_anti_psych.user_id,
        tp_pre_calls_anti_psych.time_period,
        tp_pre_calls_anti_psych.period_type,
        tp_pre_calls_anti_psych.period,
        tp_pre_calls_anti_psych.market_id,
        tp_pre_calls_anti_psych.market_name,
        tp_pre_calls_anti_psych.brand_id,
        tp_pre_calls_anti_psych.brand_name,
        tp_pre_calls_anti_psych.teva_product_flag,
        tp_pre_calls_anti_psych.payer_id,
        tp_pre_calls_anti_psych.payer_name,
        tp_pre_calls_anti_psych.plan_id,
        tp_pre_calls_anti_psych.plan_name,
        tp_pre_calls_anti_psych.payer_plan_id,
        tp_pre_calls_anti_psych.customer_id,
        tp_pre_calls_anti_psych.tvcmid,
        tp_pre_calls_anti_psych.hcp_plan_vol_rank,
        tp_pre_calls_anti_psych.prescriber_name,
        tp_pre_calls_anti_psych.pdrp_flag,
        tp_pre_calls_anti_psych.hcp_restriction_flag,
        tp_pre_calls_anti_psych.address,
        tp_pre_calls_anti_psych.city,
        tp_pre_calls_anti_psych.state,
        tp_pre_calls_anti_psych.zip,
        tp_pre_calls_anti_psych.target_status_flag,
        tp_pre_calls_anti_psych.partner_target_status_flag,
        tp_pre_calls_anti_psych.method_of_payment,
        tp_pre_calls_anti_psych.specialty,
        tp_pre_calls_anti_psych.segment,
        tp_pre_calls_anti_psych.decile,
        tp_pre_calls_anti_psych.market_volume_indicator,
        tp_pre_calls_anti_psych.product_vol_trx_count,
        tp_pre_calls_anti_psych.market_vol_trx_count,
        tp_pre_calls_anti_psych.prev_prod_vol_trx_count,
        tp_pre_calls_anti_psych.prev_market_vol_trx_count,
        tp_pre_calls_anti_psych.product_vol_nrx_count,
        tp_pre_calls_anti_psych.market_vol_nrx_count,
        tp_pre_calls_anti_psych.prev_prod_vol_nrx_count,
        tp_pre_calls_anti_psych.prev_market_vol_nrx_count,
        tp_pre_calls_anti_psych.samples,
        tp_pre_calls_anti_psych.details_p1,
        tp_pre_calls_anti_psych.details_p2,
        tp_pre_calls_anti_psych.details_p3,
        tp_pre_calls_anti_psych.cogentine_decile_value,
        tp_pre_calls_anti_psych.antipsych_decile_value,
        tp_pre_calls_anti_psych.focus_target,
        tp_pre_calls_anti_psych.titration_flag,
        tp_pre_calls_anti_psych.AssistRx_flag,
        tp_pre_calls_anti_psych.ShSol_flag
 FROM reporting.tp_pre_calls_anti_psych
 ORDER BY tp_pre_calls_anti_psych.sales_force_id,
          tp_pre_calls_anti_psych.nation_id,
          tp_pre_calls_anti_psych.nation,
          tp_pre_calls_anti_psych.area_id,
          tp_pre_calls_anti_psych.area,
          tp_pre_calls_anti_psych.region_id,
          tp_pre_calls_anti_psych.region,
          tp_pre_calls_anti_psych.territory_id
SEGMENTED BY hash(tp_pre_calls_anti_psych.sales_force_id, tp_pre_calls_anti_psych.market_id, tp_pre_calls_anti_psych.brand_id, tp_pre_calls_anti_psych.teva_product_flag, tp_pre_calls_anti_psych.payer_id, tp_pre_calls_anti_psych.plan_id, tp_pre_calls_anti_psych.tvcmid, tp_pre_calls_anti_psych.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.tn_pre_calls_anti_psych_b0 /*+basename(tn_pre_calls_anti_psych),createtype(A)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target,
 AssistRx_flag,
 ShSol_flag
)
AS
 SELECT tn_pre_calls_anti_psych.sales_force_id,
        tn_pre_calls_anti_psych.nation_id,
        tn_pre_calls_anti_psych.nation,
        tn_pre_calls_anti_psych.area_id,
        tn_pre_calls_anti_psych.area,
        tn_pre_calls_anti_psych.region_id,
        tn_pre_calls_anti_psych.region,
        tn_pre_calls_anti_psych.territory_id,
        tn_pre_calls_anti_psych.territory,
        tn_pre_calls_anti_psych.rep_name,
        tn_pre_calls_anti_psych.user_id,
        tn_pre_calls_anti_psych.time_period,
        tn_pre_calls_anti_psych.period_type,
        tn_pre_calls_anti_psych.period,
        tn_pre_calls_anti_psych.market_id,
        tn_pre_calls_anti_psych.market_name,
        tn_pre_calls_anti_psych.brand_id,
        tn_pre_calls_anti_psych.brand_name,
        tn_pre_calls_anti_psych.teva_product_flag,
        tn_pre_calls_anti_psych.payer_id,
        tn_pre_calls_anti_psych.payer_name,
        tn_pre_calls_anti_psych.plan_id,
        tn_pre_calls_anti_psych.plan_name,
        tn_pre_calls_anti_psych.payer_plan_id,
        tn_pre_calls_anti_psych.customer_id,
        tn_pre_calls_anti_psych.tvcmid,
        tn_pre_calls_anti_psych.hcp_plan_vol_rank,
        tn_pre_calls_anti_psych.prescriber_name,
        tn_pre_calls_anti_psych.pdrp_flag,
        tn_pre_calls_anti_psych.hcp_restriction_flag,
        tn_pre_calls_anti_psych.address,
        tn_pre_calls_anti_psych.city,
        tn_pre_calls_anti_psych.state,
        tn_pre_calls_anti_psych.zip,
        tn_pre_calls_anti_psych.target_status_flag,
        tn_pre_calls_anti_psych.partner_target_status_flag,
        tn_pre_calls_anti_psych.method_of_payment,
        tn_pre_calls_anti_psych.specialty,
        tn_pre_calls_anti_psych.segment,
        tn_pre_calls_anti_psych.decile,
        tn_pre_calls_anti_psych.market_volume_indicator,
        tn_pre_calls_anti_psych.product_vol_trx_count,
        tn_pre_calls_anti_psych.market_vol_trx_count,
        tn_pre_calls_anti_psych.prev_prod_vol_trx_count,
        tn_pre_calls_anti_psych.prev_market_vol_trx_count,
        tn_pre_calls_anti_psych.product_vol_nrx_count,
        tn_pre_calls_anti_psych.market_vol_nrx_count,
        tn_pre_calls_anti_psych.prev_prod_vol_nrx_count,
        tn_pre_calls_anti_psych.prev_market_vol_nrx_count,
        tn_pre_calls_anti_psych.samples,
        tn_pre_calls_anti_psych.details_p1,
        tn_pre_calls_anti_psych.details_p2,
        tn_pre_calls_anti_psych.details_p3,
        tn_pre_calls_anti_psych.focus_target,
        tn_pre_calls_anti_psych.AssistRx_flag,
        tn_pre_calls_anti_psych.ShSol_flag
 FROM reporting.tn_pre_calls_anti_psych
 ORDER BY tn_pre_calls_anti_psych.sales_force_id,
          tn_pre_calls_anti_psych.nation_id,
          tn_pre_calls_anti_psych.nation,
          tn_pre_calls_anti_psych.area_id,
          tn_pre_calls_anti_psych.area,
          tn_pre_calls_anti_psych.region_id,
          tn_pre_calls_anti_psych.region,
          tn_pre_calls_anti_psych.territory_id
SEGMENTED BY hash(tn_pre_calls_anti_psych.sales_force_id, tn_pre_calls_anti_psych.market_id, tn_pre_calls_anti_psych.brand_id, tn_pre_calls_anti_psych.teva_product_flag, tn_pre_calls_anti_psych.payer_id, tn_pre_calls_anti_psych.plan_id, tn_pre_calls_anti_psych.tvcmid, tn_pre_calls_anti_psych.hcp_plan_vol_rank) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_prescriber_sales_summary_b0 /*+basename(LAI_monthly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 month_ending,
 month_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_restriction_flag,
 segment,
 decile,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT LAI_monthly_prescriber_sales_summary.sales_force_id,
        LAI_monthly_prescriber_sales_summary.customer_id,
        LAI_monthly_prescriber_sales_summary.tvcmid,
        LAI_monthly_prescriber_sales_summary.ims_id,
        LAI_monthly_prescriber_sales_summary.period_type,
        LAI_monthly_prescriber_sales_summary.period,
        LAI_monthly_prescriber_sales_summary.month_ending,
        LAI_monthly_prescriber_sales_summary.month_bucket,
        LAI_monthly_prescriber_sales_summary.market_id,
        LAI_monthly_prescriber_sales_summary.brand_id,
        LAI_monthly_prescriber_sales_summary.payer_id,
        LAI_monthly_prescriber_sales_summary.payer_plan_id,
        LAI_monthly_prescriber_sales_summary.method_of_payment,
        LAI_monthly_prescriber_sales_summary.hcp_restriction_flag,
        LAI_monthly_prescriber_sales_summary.segment,
        LAI_monthly_prescriber_sales_summary.decile,
        LAI_monthly_prescriber_sales_summary.hcp_payer_vol_rank,
        LAI_monthly_prescriber_sales_summary.hcp_plan_vol_rank,
        LAI_monthly_prescriber_sales_summary.product_vol_trx_count,
        LAI_monthly_prescriber_sales_summary.prev_prod_vol_trx_count,
        LAI_monthly_prescriber_sales_summary.product_vol_nrx_count,
        LAI_monthly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        LAI_monthly_prescriber_sales_summary.market_vol_trx_count,
        LAI_monthly_prescriber_sales_summary.prev_market_vol_trx_count,
        LAI_monthly_prescriber_sales_summary.market_vol_nrx_count,
        LAI_monthly_prescriber_sales_summary.prev_market_vol_nrx_count,
        LAI_monthly_prescriber_sales_summary.samples,
        LAI_monthly_prescriber_sales_summary.details_p1,
        LAI_monthly_prescriber_sales_summary.details_p2,
        LAI_monthly_prescriber_sales_summary.details_p3
 FROM reporting.LAI_monthly_prescriber_sales_summary
 ORDER BY LAI_monthly_prescriber_sales_summary.sales_force_id,
          LAI_monthly_prescriber_sales_summary.customer_id,
          LAI_monthly_prescriber_sales_summary.tvcmid,
          LAI_monthly_prescriber_sales_summary.ims_id,
          LAI_monthly_prescriber_sales_summary.period_type,
          LAI_monthly_prescriber_sales_summary.period,
          LAI_monthly_prescriber_sales_summary.month_ending,
          LAI_monthly_prescriber_sales_summary.month_bucket
SEGMENTED BY hash(LAI_monthly_prescriber_sales_summary.tvcmid, LAI_monthly_prescriber_sales_summary.month_ending, LAI_monthly_prescriber_sales_summary.month_bucket, LAI_monthly_prescriber_sales_summary.market_id, LAI_monthly_prescriber_sales_summary.brand_id, LAI_monthly_prescriber_sales_summary.hcp_payer_vol_rank, LAI_monthly_prescriber_sales_summary.hcp_plan_vol_rank, LAI_monthly_prescriber_sales_summary.product_vol_trx_count) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_new_prescriber_b0 /*+basename(LAI_monthly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 month_ending,
 month_bucket,
 curr_trx,
 prev_trx
)
AS
 SELECT LAI_monthly_new_prescriber.customer_id,
        LAI_monthly_new_prescriber.brand_id,
        LAI_monthly_new_prescriber.month_ending,
        LAI_monthly_new_prescriber.month_bucket,
        LAI_monthly_new_prescriber.curr_trx,
        LAI_monthly_new_prescriber.prev_trx
 FROM reporting.LAI_monthly_new_prescriber
 ORDER BY LAI_monthly_new_prescriber.customer_id,
          LAI_monthly_new_prescriber.brand_id,
          LAI_monthly_new_prescriber.month_ending,
          LAI_monthly_new_prescriber.month_bucket,
          LAI_monthly_new_prescriber.curr_trx,
          LAI_monthly_new_prescriber.prev_trx
SEGMENTED BY hash(LAI_monthly_new_prescriber.brand_id, LAI_monthly_new_prescriber.month_ending, LAI_monthly_new_prescriber.month_bucket, LAI_monthly_new_prescriber.curr_trx, LAI_monthly_new_prescriber.prev_trx, LAI_monthly_new_prescriber.customer_id) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_prescriber_sales_b0 /*+basename(LAI_monthly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 month_ending,
 month_bucket,
 data_source,
 channel,
 pbm_name,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT LAI_monthly_prescriber_sales.customer_id,
        LAI_monthly_prescriber_sales.tvcmid,
        LAI_monthly_prescriber_sales.ims_id,
        LAI_monthly_prescriber_sales.product_id,
        LAI_monthly_prescriber_sales.payer_plan_id,
        LAI_monthly_prescriber_sales.month_ending,
        LAI_monthly_prescriber_sales.month_bucket,
        LAI_monthly_prescriber_sales.data_source,
        LAI_monthly_prescriber_sales.channel,
        LAI_monthly_prescriber_sales.pbm_name,
        LAI_monthly_prescriber_sales.method_of_payment,
        LAI_monthly_prescriber_sales.trx,
        LAI_monthly_prescriber_sales.nrx,
        LAI_monthly_prescriber_sales.trx_units,
        LAI_monthly_prescriber_sales.nrx_units,
        LAI_monthly_prescriber_sales.trx_dollars,
        LAI_monthly_prescriber_sales.nrx_dollars,
        LAI_monthly_prescriber_sales.new_prescriber
 FROM reporting.LAI_monthly_prescriber_sales
 ORDER BY LAI_monthly_prescriber_sales.customer_id,
          LAI_monthly_prescriber_sales.tvcmid,
          LAI_monthly_prescriber_sales.ims_id,
          LAI_monthly_prescriber_sales.product_id,
          LAI_monthly_prescriber_sales.payer_plan_id,
          LAI_monthly_prescriber_sales.month_ending,
          LAI_monthly_prescriber_sales.month_bucket,
          LAI_monthly_prescriber_sales.data_source
SEGMENTED BY hash(LAI_monthly_prescriber_sales.tvcmid, LAI_monthly_prescriber_sales.product_id, LAI_monthly_prescriber_sales.month_ending, LAI_monthly_prescriber_sales.month_bucket, LAI_monthly_prescriber_sales.trx, LAI_monthly_prescriber_sales.nrx, LAI_monthly_prescriber_sales.trx_units, LAI_monthly_prescriber_sales.nrx_units) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_prescriber_summary_b0 /*+basename(LAI_monthly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT LAI_monthly_prescriber_summary.sales_force_id,
        LAI_monthly_prescriber_summary.nation_id,
        LAI_monthly_prescriber_summary.nation,
        LAI_monthly_prescriber_summary.area_id,
        LAI_monthly_prescriber_summary.area,
        LAI_monthly_prescriber_summary.region_id,
        LAI_monthly_prescriber_summary.region,
        LAI_monthly_prescriber_summary.territory_id,
        LAI_monthly_prescriber_summary.territory,
        LAI_monthly_prescriber_summary.rep_name,
        LAI_monthly_prescriber_summary.user_id,
        LAI_monthly_prescriber_summary.time_period,
        LAI_monthly_prescriber_summary.period_type,
        LAI_monthly_prescriber_summary.period,
        LAI_monthly_prescriber_summary.market_id,
        LAI_monthly_prescriber_summary.market_name,
        LAI_monthly_prescriber_summary.brand_id,
        LAI_monthly_prescriber_summary.brand_name,
        LAI_monthly_prescriber_summary.teva_product_flag,
        LAI_monthly_prescriber_summary.customer_id,
        LAI_monthly_prescriber_summary.tvcmid,
        LAI_monthly_prescriber_summary.pdrp_flag,
        LAI_monthly_prescriber_summary.hcp_restriction_flag,
        LAI_monthly_prescriber_summary.prescriber_name,
        LAI_monthly_prescriber_summary.new_prescriber,
        LAI_monthly_prescriber_summary.address,
        LAI_monthly_prescriber_summary.city,
        LAI_monthly_prescriber_summary.state,
        LAI_monthly_prescriber_summary.zip,
        LAI_monthly_prescriber_summary.target_status_flag,
        LAI_monthly_prescriber_summary.partner_target_status_flag,
        LAI_monthly_prescriber_summary.method_of_payment,
        LAI_monthly_prescriber_summary.specialty,
        LAI_monthly_prescriber_summary.segment,
        LAI_monthly_prescriber_summary.decile,
        LAI_monthly_prescriber_summary.market_volume_indicator,
        LAI_monthly_prescriber_summary.product_vol_trx_count,
        LAI_monthly_prescriber_summary.market_vol_trx_count,
        LAI_monthly_prescriber_summary.prev_prod_vol_trx_count,
        LAI_monthly_prescriber_summary.prev_market_vol_trx_count,
        LAI_monthly_prescriber_summary.product_vol_nrx_count,
        LAI_monthly_prescriber_summary.market_vol_nrx_count,
        LAI_monthly_prescriber_summary.prev_prod_vol_nrx_count,
        LAI_monthly_prescriber_summary.prev_market_vol_nrx_count,
        LAI_monthly_prescriber_summary.samples,
        LAI_monthly_prescriber_summary.details_p1,
        LAI_monthly_prescriber_summary.details_p2,
        LAI_monthly_prescriber_summary.details_p3
 FROM reporting.LAI_monthly_prescriber_summary
 ORDER BY LAI_monthly_prescriber_summary.sales_force_id,
          LAI_monthly_prescriber_summary.nation_id,
          LAI_monthly_prescriber_summary.nation,
          LAI_monthly_prescriber_summary.area_id,
          LAI_monthly_prescriber_summary.area,
          LAI_monthly_prescriber_summary.region_id,
          LAI_monthly_prescriber_summary.region,
          LAI_monthly_prescriber_summary.territory_id
SEGMENTED BY hash(LAI_monthly_prescriber_summary.market_id, LAI_monthly_prescriber_summary.brand_id, LAI_monthly_prescriber_summary.teva_product_flag, LAI_monthly_prescriber_summary.tvcmid, LAI_monthly_prescriber_summary.pdrp_flag, LAI_monthly_prescriber_summary.new_prescriber, LAI_monthly_prescriber_summary.state, LAI_monthly_prescriber_summary.zip) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_payer_prescriber_summary_b0 /*+basename(LAI_monthly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count,
 Nation_Product_TRx_Payer_Count,
 Nation_Product_NRx_Payer_Count,
 Nation_Market_TRx_Payer_Count,
 Nation_Market_NRx_Payer_Count,
 Nation_Product_TRx_Plan_Count,
 Nation_Product_NRx_Plan_Count,
 Nation_Market_TRx_Plan_Count,
 Nation_Market_NRx_Plan_Count,
 focus_target
)
AS
 SELECT LAI_monthly_payer_prescriber_summary.sales_force_id,
        LAI_monthly_payer_prescriber_summary.nation_id,
        LAI_monthly_payer_prescriber_summary.nation,
        LAI_monthly_payer_prescriber_summary.area_id,
        LAI_monthly_payer_prescriber_summary.area,
        LAI_monthly_payer_prescriber_summary.region_id,
        LAI_monthly_payer_prescriber_summary.region,
        LAI_monthly_payer_prescriber_summary.territory_id,
        LAI_monthly_payer_prescriber_summary.territory,
        LAI_monthly_payer_prescriber_summary.rep_name,
        LAI_monthly_payer_prescriber_summary.user_id,
        LAI_monthly_payer_prescriber_summary.time_period,
        LAI_monthly_payer_prescriber_summary.period_type,
        LAI_monthly_payer_prescriber_summary.period,
        LAI_monthly_payer_prescriber_summary.market_id,
        LAI_monthly_payer_prescriber_summary.market_name,
        LAI_monthly_payer_prescriber_summary.brand_id,
        LAI_monthly_payer_prescriber_summary.brand_name,
        LAI_monthly_payer_prescriber_summary.teva_product_flag,
        LAI_monthly_payer_prescriber_summary.payer_id,
        LAI_monthly_payer_prescriber_summary.payer_name,
        LAI_monthly_payer_prescriber_summary.plan_id,
        LAI_monthly_payer_prescriber_summary.plan_name,
        LAI_monthly_payer_prescriber_summary.payer_plan_id,
        LAI_monthly_payer_prescriber_summary.customer_id,
        LAI_monthly_payer_prescriber_summary.tvcmid,
        LAI_monthly_payer_prescriber_summary.hcp_plan_vol_rank,
        LAI_monthly_payer_prescriber_summary.prescriber_name,
        LAI_monthly_payer_prescriber_summary.pdrp_flag,
        LAI_monthly_payer_prescriber_summary.hcp_restriction_flag,
        LAI_monthly_payer_prescriber_summary.address,
        LAI_monthly_payer_prescriber_summary.city,
        LAI_monthly_payer_prescriber_summary.state,
        LAI_monthly_payer_prescriber_summary.zip,
        LAI_monthly_payer_prescriber_summary.target_status_flag,
        LAI_monthly_payer_prescriber_summary.partner_target_status_flag,
        LAI_monthly_payer_prescriber_summary.method_of_payment,
        LAI_monthly_payer_prescriber_summary.specialty,
        LAI_monthly_payer_prescriber_summary.segment,
        LAI_monthly_payer_prescriber_summary.decile,
        LAI_monthly_payer_prescriber_summary.rep_type,
        LAI_monthly_payer_prescriber_summary.market_volume_indicator,
        LAI_monthly_payer_prescriber_summary.product_vol_trx_count,
        LAI_monthly_payer_prescriber_summary.market_vol_trx_count,
        LAI_monthly_payer_prescriber_summary.prev_prod_vol_trx_count,
        LAI_monthly_payer_prescriber_summary.prev_market_vol_trx_count,
        LAI_monthly_payer_prescriber_summary.product_vol_nrx_count,
        LAI_monthly_payer_prescriber_summary.market_vol_nrx_count,
        LAI_monthly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        LAI_monthly_payer_prescriber_summary.prev_market_vol_nrx_count,
        LAI_monthly_payer_prescriber_summary.samples,
        LAI_monthly_payer_prescriber_summary.details_p1,
        LAI_monthly_payer_prescriber_summary.details_p2,
        LAI_monthly_payer_prescriber_summary.details_p3,
        LAI_monthly_payer_prescriber_summary.Nation_Product_TRx_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Product_NRx_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_TRx_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_NRx_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Product_TRx_Payer_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Product_NRx_Payer_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_TRx_Payer_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_NRx_Payer_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Product_TRx_Plan_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Product_NRx_Plan_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_TRx_Plan_Count,
        LAI_monthly_payer_prescriber_summary.Nation_Market_NRx_Plan_Count,
        LAI_monthly_payer_prescriber_summary.focus_target
 FROM reporting.LAI_monthly_payer_prescriber_summary
 ORDER BY LAI_monthly_payer_prescriber_summary.sales_force_id,
          LAI_monthly_payer_prescriber_summary.nation_id
SEGMENTED BY hash(LAI_monthly_payer_prescriber_summary.market_id, LAI_monthly_payer_prescriber_summary.brand_id, LAI_monthly_payer_prescriber_summary.teva_product_flag, LAI_monthly_payer_prescriber_summary.payer_id, LAI_monthly_payer_prescriber_summary.plan_id, LAI_monthly_payer_prescriber_summary.tvcmid, LAI_monthly_payer_prescriber_summary.hcp_plan_vol_rank, LAI_monthly_payer_prescriber_summary.pdrp_flag) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_geography_summary_b0 /*+basename(LAI_monthly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT LAI_monthly_geography_summary.sales_force_id,
        LAI_monthly_geography_summary.geography_level,
        LAI_monthly_geography_summary.geography_id,
        LAI_monthly_geography_summary.geography,
        LAI_monthly_geography_summary.rep_name,
        LAI_monthly_geography_summary.user_id,
        LAI_monthly_geography_summary.time_period,
        LAI_monthly_geography_summary.period_type,
        LAI_monthly_geography_summary.period,
        LAI_monthly_geography_summary.market_id,
        LAI_monthly_geography_summary.market_name,
        LAI_monthly_geography_summary.brand_id,
        LAI_monthly_geography_summary.brand_name,
        LAI_monthly_geography_summary.teva_product_flag,
        LAI_monthly_geography_summary.target_status_flag,
        LAI_monthly_geography_summary.method_of_payment,
        LAI_monthly_geography_summary.specialty,
        LAI_monthly_geography_summary.segment,
        LAI_monthly_geography_summary.rep_type,
        LAI_monthly_geography_summary.market_volume_indicator,
        LAI_monthly_geography_summary.product_vol_trx_count,
        LAI_monthly_geography_summary.product_vol_new_pres_trx_count,
        LAI_monthly_geography_summary.market_vol_trx_count,
        LAI_monthly_geography_summary.prev_prod_vol_trx_count,
        LAI_monthly_geography_summary.prev_market_vol_trx_count,
        LAI_monthly_geography_summary.product_vol_nrx_count,
        LAI_monthly_geography_summary.product_vol_new_pres_nrx_count,
        LAI_monthly_geography_summary.market_vol_nrx_count,
        LAI_monthly_geography_summary.prev_prod_vol_nrx_count,
        LAI_monthly_geography_summary.prev_market_vol_nrx_count,
        LAI_monthly_geography_summary.prescribers_count,
        LAI_monthly_geography_summary.new_prescribers_count,
        LAI_monthly_geography_summary.decile
 FROM reporting.LAI_monthly_geography_summary
 ORDER BY LAI_monthly_geography_summary.sales_force_id
SEGMENTED BY hash(LAI_monthly_geography_summary.market_id, LAI_monthly_geography_summary.brand_id, LAI_monthly_geography_summary.teva_product_flag, LAI_monthly_geography_summary.target_status_flag, LAI_monthly_geography_summary.market_volume_indicator, LAI_monthly_geography_summary.prescribers_count, LAI_monthly_geography_summary.new_prescribers_count, LAI_monthly_geography_summary.geography_level) ALL NODES;

CREATE PROJECTION reporting.LAI_monthly_payer_geography_summary_b0 /*+basename(LAI_monthly_payer_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 method_of_payment,
 rep_type,
 market_volume_indicator,
 geo_plan_vol_rank,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 Nation_Product_TRx_Count,
 Nation_Product_NRx_Count,
 Nation_Market_TRx_Count,
 Nation_Market_NRx_Count
)
AS
 SELECT LAI_monthly_payer_geography_summary.sales_force_id,
        LAI_monthly_payer_geography_summary.geography_level,
        LAI_monthly_payer_geography_summary.geography_id,
        LAI_monthly_payer_geography_summary.geography,
        LAI_monthly_payer_geography_summary.rep_name,
        LAI_monthly_payer_geography_summary.user_id,
        LAI_monthly_payer_geography_summary.time_period,
        LAI_monthly_payer_geography_summary.period_type,
        LAI_monthly_payer_geography_summary.period,
        LAI_monthly_payer_geography_summary.payer_id,
        LAI_monthly_payer_geography_summary.payer_name,
        LAI_monthly_payer_geography_summary.plan_id,
        LAI_monthly_payer_geography_summary.plan_name,
        LAI_monthly_payer_geography_summary.payer_plan_id,
        LAI_monthly_payer_geography_summary.market_id,
        LAI_monthly_payer_geography_summary.market_name,
        LAI_monthly_payer_geography_summary.brand_id,
        LAI_monthly_payer_geography_summary.brand_name,
        LAI_monthly_payer_geography_summary.teva_product_flag,
        LAI_monthly_payer_geography_summary.method_of_payment,
        LAI_monthly_payer_geography_summary.rep_type,
        LAI_monthly_payer_geography_summary.market_volume_indicator,
        LAI_monthly_payer_geography_summary.geo_plan_vol_rank,
        LAI_monthly_payer_geography_summary.product_vol_trx_count,
        LAI_monthly_payer_geography_summary.market_vol_trx_count,
        LAI_monthly_payer_geography_summary.prev_prod_vol_trx_count,
        LAI_monthly_payer_geography_summary.prev_market_vol_trx_count,
        LAI_monthly_payer_geography_summary.product_vol_nrx_count,
        LAI_monthly_payer_geography_summary.market_vol_nrx_count,
        LAI_monthly_payer_geography_summary.prev_prod_vol_nrx_count,
        LAI_monthly_payer_geography_summary.prev_market_vol_nrx_count,
        LAI_monthly_payer_geography_summary.Nation_Product_TRx_Count,
        LAI_monthly_payer_geography_summary.Nation_Product_NRx_Count,
        LAI_monthly_payer_geography_summary.Nation_Market_TRx_Count,
        LAI_monthly_payer_geography_summary.Nation_Market_NRx_Count
 FROM reporting.LAI_monthly_payer_geography_summary
 ORDER BY LAI_monthly_payer_geography_summary.sales_force_id
SEGMENTED BY hash(LAI_monthly_payer_geography_summary.payer_id, LAI_monthly_payer_geography_summary.plan_id, LAI_monthly_payer_geography_summary.market_id, LAI_monthly_payer_geography_summary.brand_id, LAI_monthly_payer_geography_summary.teva_product_flag, LAI_monthly_payer_geography_summary.market_volume_indicator, LAI_monthly_payer_geography_summary.geo_plan_vol_rank, LAI_monthly_payer_geography_summary.geography_level) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_new_prescriber_b0 /*+basename(LAI_weekly_new_prescriber),createtype(L)*/ 
(
 customer_id,
 brand_id,
 week_ending,
 week_bucket,
 curr_trx,
 prev_trx
)
AS
 SELECT LAI_weekly_new_prescriber.customer_id,
        LAI_weekly_new_prescriber.brand_id,
        LAI_weekly_new_prescriber.week_ending,
        LAI_weekly_new_prescriber.week_bucket,
        LAI_weekly_new_prescriber.curr_trx,
        LAI_weekly_new_prescriber.prev_trx
 FROM reporting.LAI_weekly_new_prescriber
 ORDER BY LAI_weekly_new_prescriber.customer_id,
          LAI_weekly_new_prescriber.brand_id,
          LAI_weekly_new_prescriber.week_ending,
          LAI_weekly_new_prescriber.week_bucket
SEGMENTED BY hash(LAI_weekly_new_prescriber.customer_id, LAI_weekly_new_prescriber.brand_id) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_prescriber_sales_b0 /*+basename(LAI_weekly_prescriber_sales),createtype(L)*/ 
(
 customer_id,
 tvcmid,
 ims_id,
 product_id,
 payer_plan_id,
 week_ending,
 week_bucket,
 data_source,
 channel,
 pbm_name,
 method_of_payment,
 trx,
 nrx,
 trx_units,
 nrx_units,
 trx_dollars,
 nrx_dollars,
 new_prescriber
)
AS
 SELECT LAI_weekly_prescriber_sales.customer_id,
        LAI_weekly_prescriber_sales.tvcmid,
        LAI_weekly_prescriber_sales.ims_id,
        LAI_weekly_prescriber_sales.product_id,
        LAI_weekly_prescriber_sales.payer_plan_id,
        LAI_weekly_prescriber_sales.week_ending,
        LAI_weekly_prescriber_sales.week_bucket,
        LAI_weekly_prescriber_sales.data_source,
        LAI_weekly_prescriber_sales.channel,
        LAI_weekly_prescriber_sales.pbm_name,
        LAI_weekly_prescriber_sales.method_of_payment,
        LAI_weekly_prescriber_sales.trx,
        LAI_weekly_prescriber_sales.nrx,
        LAI_weekly_prescriber_sales.trx_units,
        LAI_weekly_prescriber_sales.nrx_units,
        LAI_weekly_prescriber_sales.trx_dollars,
        LAI_weekly_prescriber_sales.nrx_dollars,
        LAI_weekly_prescriber_sales.new_prescriber
 FROM reporting.LAI_weekly_prescriber_sales
 ORDER BY LAI_weekly_prescriber_sales.customer_id,
          LAI_weekly_prescriber_sales.tvcmid,
          LAI_weekly_prescriber_sales.ims_id
SEGMENTED BY hash(LAI_weekly_prescriber_sales.tvcmid) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_prescriber_sales_summary_b0 /*+basename(LAI_weekly_prescriber_sales_summary),createtype(L)*/ 
(
 sales_force_id,
 customer_id,
 tvcmid,
 ims_id,
 period_type,
 period,
 week_ending,
 week_bucket,
 market_id,
 brand_id,
 payer_id,
 payer_plan_id,
 method_of_payment,
 hcp_payer_vol_rank,
 hcp_plan_vol_rank,
 product_vol_trx_count,
 prev_prod_vol_trx_count,
 product_vol_nrx_count,
 prev_prod_vol_nrx_count,
 market_vol_trx_count,
 prev_market_vol_trx_count,
 market_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT LAI_weekly_prescriber_sales_summary.sales_force_id,
        LAI_weekly_prescriber_sales_summary.customer_id,
        LAI_weekly_prescriber_sales_summary.tvcmid,
        LAI_weekly_prescriber_sales_summary.ims_id,
        LAI_weekly_prescriber_sales_summary.period_type,
        LAI_weekly_prescriber_sales_summary.period,
        LAI_weekly_prescriber_sales_summary.week_ending,
        LAI_weekly_prescriber_sales_summary.week_bucket,
        LAI_weekly_prescriber_sales_summary.market_id,
        LAI_weekly_prescriber_sales_summary.brand_id,
        LAI_weekly_prescriber_sales_summary.payer_id,
        LAI_weekly_prescriber_sales_summary.payer_plan_id,
        LAI_weekly_prescriber_sales_summary.method_of_payment,
        LAI_weekly_prescriber_sales_summary.hcp_payer_vol_rank,
        LAI_weekly_prescriber_sales_summary.hcp_plan_vol_rank,
        LAI_weekly_prescriber_sales_summary.product_vol_trx_count,
        LAI_weekly_prescriber_sales_summary.prev_prod_vol_trx_count,
        LAI_weekly_prescriber_sales_summary.product_vol_nrx_count,
        LAI_weekly_prescriber_sales_summary.prev_prod_vol_nrx_count,
        LAI_weekly_prescriber_sales_summary.market_vol_trx_count,
        LAI_weekly_prescriber_sales_summary.prev_market_vol_trx_count,
        LAI_weekly_prescriber_sales_summary.market_vol_nrx_count,
        LAI_weekly_prescriber_sales_summary.prev_market_vol_nrx_count,
        LAI_weekly_prescriber_sales_summary.samples,
        LAI_weekly_prescriber_sales_summary.details_p1,
        LAI_weekly_prescriber_sales_summary.details_p2,
        LAI_weekly_prescriber_sales_summary.details_p3
 FROM reporting.LAI_weekly_prescriber_sales_summary
 ORDER BY LAI_weekly_prescriber_sales_summary.sales_force_id,
          LAI_weekly_prescriber_sales_summary.customer_id,
          LAI_weekly_prescriber_sales_summary.tvcmid,
          LAI_weekly_prescriber_sales_summary.ims_id,
          LAI_weekly_prescriber_sales_summary.period_type,
          LAI_weekly_prescriber_sales_summary.period,
          LAI_weekly_prescriber_sales_summary.week_ending,
          LAI_weekly_prescriber_sales_summary.week_bucket
SEGMENTED BY hash(LAI_weekly_prescriber_sales_summary.tvcmid) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_prescriber_summary_b0 /*+basename(LAI_weekly_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 pdrp_flag,
 hcp_restriction_flag,
 prescriber_name,
 new_prescriber,
 address,
 city,
 state,
 zip,
 partner_target_status_flag,
 target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT LAI_weekly_prescriber_summary.sales_force_id,
        LAI_weekly_prescriber_summary.nation_id,
        LAI_weekly_prescriber_summary.nation,
        LAI_weekly_prescriber_summary.area_id,
        LAI_weekly_prescriber_summary.area,
        LAI_weekly_prescriber_summary.region_id,
        LAI_weekly_prescriber_summary.region,
        LAI_weekly_prescriber_summary.territory_id,
        LAI_weekly_prescriber_summary.territory,
        LAI_weekly_prescriber_summary.rep_name,
        LAI_weekly_prescriber_summary.user_id,
        LAI_weekly_prescriber_summary.time_period,
        LAI_weekly_prescriber_summary.period_type,
        LAI_weekly_prescriber_summary.period,
        LAI_weekly_prescriber_summary.market_id,
        LAI_weekly_prescriber_summary.market_name,
        LAI_weekly_prescriber_summary.brand_id,
        LAI_weekly_prescriber_summary.brand_name,
        LAI_weekly_prescriber_summary.teva_product_flag,
        LAI_weekly_prescriber_summary.customer_id,
        LAI_weekly_prescriber_summary.tvcmid,
        LAI_weekly_prescriber_summary.pdrp_flag,
        LAI_weekly_prescriber_summary.hcp_restriction_flag,
        LAI_weekly_prescriber_summary.prescriber_name,
        LAI_weekly_prescriber_summary.new_prescriber,
        LAI_weekly_prescriber_summary.address,
        LAI_weekly_prescriber_summary.city,
        LAI_weekly_prescriber_summary.state,
        LAI_weekly_prescriber_summary.zip,
        LAI_weekly_prescriber_summary.partner_target_status_flag,
        LAI_weekly_prescriber_summary.target_status_flag,
        LAI_weekly_prescriber_summary.method_of_payment,
        LAI_weekly_prescriber_summary.specialty,
        LAI_weekly_prescriber_summary.segment,
        LAI_weekly_prescriber_summary.decile,
        LAI_weekly_prescriber_summary.market_volume_indicator,
        LAI_weekly_prescriber_summary.product_vol_trx_count,
        LAI_weekly_prescriber_summary.market_vol_trx_count,
        LAI_weekly_prescriber_summary.prev_prod_vol_trx_count,
        LAI_weekly_prescriber_summary.prev_market_vol_trx_count,
        LAI_weekly_prescriber_summary.product_vol_nrx_count,
        LAI_weekly_prescriber_summary.market_vol_nrx_count,
        LAI_weekly_prescriber_summary.prev_prod_vol_nrx_count,
        LAI_weekly_prescriber_summary.prev_market_vol_nrx_count,
        LAI_weekly_prescriber_summary.samples,
        LAI_weekly_prescriber_summary.details_p1,
        LAI_weekly_prescriber_summary.details_p2,
        LAI_weekly_prescriber_summary.details_p3
 FROM reporting.LAI_weekly_prescriber_summary
 ORDER BY LAI_weekly_prescriber_summary.sales_force_id,
          LAI_weekly_prescriber_summary.nation_id,
          LAI_weekly_prescriber_summary.nation,
          LAI_weekly_prescriber_summary.area_id,
          LAI_weekly_prescriber_summary.area,
          LAI_weekly_prescriber_summary.region_id,
          LAI_weekly_prescriber_summary.region,
          LAI_weekly_prescriber_summary.territory_id
SEGMENTED BY hash(LAI_weekly_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_payer_prescriber_summary_b0 /*+basename(LAI_weekly_payer_prescriber_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 rep_type,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT LAI_weekly_payer_prescriber_summary.sales_force_id,
        LAI_weekly_payer_prescriber_summary.nation_id,
        LAI_weekly_payer_prescriber_summary.nation,
        LAI_weekly_payer_prescriber_summary.area_id,
        LAI_weekly_payer_prescriber_summary.area,
        LAI_weekly_payer_prescriber_summary.region_id,
        LAI_weekly_payer_prescriber_summary.region,
        LAI_weekly_payer_prescriber_summary.territory_id,
        LAI_weekly_payer_prescriber_summary.territory,
        LAI_weekly_payer_prescriber_summary.rep_name,
        LAI_weekly_payer_prescriber_summary.user_id,
        LAI_weekly_payer_prescriber_summary.time_period,
        LAI_weekly_payer_prescriber_summary.period_type,
        LAI_weekly_payer_prescriber_summary.period,
        LAI_weekly_payer_prescriber_summary.market_id,
        LAI_weekly_payer_prescriber_summary.market_name,
        LAI_weekly_payer_prescriber_summary.brand_id,
        LAI_weekly_payer_prescriber_summary.brand_name,
        LAI_weekly_payer_prescriber_summary.teva_product_flag,
        LAI_weekly_payer_prescriber_summary.payer_id,
        LAI_weekly_payer_prescriber_summary.payer_name,
        LAI_weekly_payer_prescriber_summary.plan_id,
        LAI_weekly_payer_prescriber_summary.plan_name,
        LAI_weekly_payer_prescriber_summary.payer_plan_id,
        LAI_weekly_payer_prescriber_summary.customer_id,
        LAI_weekly_payer_prescriber_summary.tvcmid,
        LAI_weekly_payer_prescriber_summary.hcp_plan_vol_rank,
        LAI_weekly_payer_prescriber_summary.prescriber_name,
        LAI_weekly_payer_prescriber_summary.pdrp_flag,
        LAI_weekly_payer_prescriber_summary.hcp_restriction_flag,
        LAI_weekly_payer_prescriber_summary.address,
        LAI_weekly_payer_prescriber_summary.city,
        LAI_weekly_payer_prescriber_summary.state,
        LAI_weekly_payer_prescriber_summary.zip,
        LAI_weekly_payer_prescriber_summary.target_status_flag,
        LAI_weekly_payer_prescriber_summary.partner_target_status_flag,
        LAI_weekly_payer_prescriber_summary.method_of_payment,
        LAI_weekly_payer_prescriber_summary.specialty,
        LAI_weekly_payer_prescriber_summary.segment,
        LAI_weekly_payer_prescriber_summary.decile,
        LAI_weekly_payer_prescriber_summary.rep_type,
        LAI_weekly_payer_prescriber_summary.market_volume_indicator,
        LAI_weekly_payer_prescriber_summary.product_vol_trx_count,
        LAI_weekly_payer_prescriber_summary.market_vol_trx_count,
        LAI_weekly_payer_prescriber_summary.prev_prod_vol_trx_count,
        LAI_weekly_payer_prescriber_summary.prev_market_vol_trx_count,
        LAI_weekly_payer_prescriber_summary.product_vol_nrx_count,
        LAI_weekly_payer_prescriber_summary.market_vol_nrx_count,
        LAI_weekly_payer_prescriber_summary.prev_prod_vol_nrx_count,
        LAI_weekly_payer_prescriber_summary.prev_market_vol_nrx_count,
        LAI_weekly_payer_prescriber_summary.samples,
        LAI_weekly_payer_prescriber_summary.details_p1,
        LAI_weekly_payer_prescriber_summary.details_p2,
        LAI_weekly_payer_prescriber_summary.details_p3,
        LAI_weekly_payer_prescriber_summary.focus_target
 FROM reporting.LAI_weekly_payer_prescriber_summary
 ORDER BY LAI_weekly_payer_prescriber_summary.sales_force_id,
          LAI_weekly_payer_prescriber_summary.nation_id,
          LAI_weekly_payer_prescriber_summary.nation,
          LAI_weekly_payer_prescriber_summary.area_id,
          LAI_weekly_payer_prescriber_summary.area,
          LAI_weekly_payer_prescriber_summary.region_id,
          LAI_weekly_payer_prescriber_summary.region,
          LAI_weekly_payer_prescriber_summary.territory_id
SEGMENTED BY hash(LAI_weekly_payer_prescriber_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.LAI_weekly_geography_summary_b0 /*+basename(LAI_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 target_status_flag,
 method_of_payment,
 rep_type,
 specialty,
 segment,
 market_volume_indicator,
 product_vol_trx_count,
 product_vol_new_pres_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 product_vol_new_pres_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 prescribers_count,
 new_prescribers_count,
 decile
)
AS
 SELECT LAI_weekly_geography_summary.sales_force_id,
        LAI_weekly_geography_summary.geography_level,
        LAI_weekly_geography_summary.geography_id,
        LAI_weekly_geography_summary.geography,
        LAI_weekly_geography_summary.rep_name,
        LAI_weekly_geography_summary.user_id,
        LAI_weekly_geography_summary.time_period,
        LAI_weekly_geography_summary.period_type,
        LAI_weekly_geography_summary.period,
        LAI_weekly_geography_summary.market_id,
        LAI_weekly_geography_summary.market_name,
        LAI_weekly_geography_summary.brand_id,
        LAI_weekly_geography_summary.brand_name,
        LAI_weekly_geography_summary.teva_product_flag,
        LAI_weekly_geography_summary.target_status_flag,
        LAI_weekly_geography_summary.method_of_payment,
        LAI_weekly_geography_summary.rep_type,
        LAI_weekly_geography_summary.specialty,
        LAI_weekly_geography_summary.segment,
        LAI_weekly_geography_summary.market_volume_indicator,
        LAI_weekly_geography_summary.product_vol_trx_count,
        LAI_weekly_geography_summary.product_vol_new_pres_trx_count,
        LAI_weekly_geography_summary.market_vol_trx_count,
        LAI_weekly_geography_summary.prev_prod_vol_trx_count,
        LAI_weekly_geography_summary.prev_market_vol_trx_count,
        LAI_weekly_geography_summary.product_vol_nrx_count,
        LAI_weekly_geography_summary.product_vol_new_pres_nrx_count,
        LAI_weekly_geography_summary.market_vol_nrx_count,
        LAI_weekly_geography_summary.prev_prod_vol_nrx_count,
        LAI_weekly_geography_summary.prev_market_vol_nrx_count,
        LAI_weekly_geography_summary.prescribers_count,
        LAI_weekly_geography_summary.new_prescribers_count,
        LAI_weekly_geography_summary.decile
 FROM reporting.LAI_weekly_geography_summary
 ORDER BY LAI_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(LAI_weekly_geography_summary.sales_force_id, LAI_weekly_geography_summary.market_id, LAI_weekly_geography_summary.brand_id, LAI_weekly_geography_summary.teva_product_flag, LAI_weekly_geography_summary.target_status_flag, LAI_weekly_geography_summary.market_volume_indicator, LAI_weekly_geography_summary.prescribers_count, LAI_weekly_geography_summary.new_prescribers_count) ALL NODES;

CREATE PROJECTION reporting.ts_pre_call_summary_b0 /*+basename(ts_pre_call_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 rep_type,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 payer_id,
 payer_name,
 plan_id,
 plan_name,
 payer_plan_id,
 customer_id,
 tvcmid,
 hcp_plan_vol_rank,
 prescriber_name,
 pdrp_flag,
 hcp_restriction_flag,
 address,
 city,
 state,
 zip,
 target_status_flag,
 partner_target_status_flag,
 method_of_payment,
 specialty,
 segment,
 decile,
 market_volume_indicator,
 product_vol_trx_count,
 market_vol_trx_count,
 prev_prod_vol_trx_count,
 prev_market_vol_trx_count,
 product_vol_nrx_count,
 market_vol_nrx_count,
 prev_prod_vol_nrx_count,
 prev_market_vol_nrx_count,
 samples,
 details_p1,
 details_p2,
 details_p3,
 focus_target
)
AS
 SELECT ts_pre_call_summary.sales_force_id,
        ts_pre_call_summary.nation_id,
        ts_pre_call_summary.nation,
        ts_pre_call_summary.area_id,
        ts_pre_call_summary.area,
        ts_pre_call_summary.region_id,
        ts_pre_call_summary.region,
        ts_pre_call_summary.territory_id,
        ts_pre_call_summary.territory,
        ts_pre_call_summary.rep_name,
        ts_pre_call_summary.rep_type,
        ts_pre_call_summary.user_id,
        ts_pre_call_summary.time_period,
        ts_pre_call_summary.period_type,
        ts_pre_call_summary.period,
        ts_pre_call_summary.market_id,
        ts_pre_call_summary.market_name,
        ts_pre_call_summary.brand_id,
        ts_pre_call_summary.brand_name,
        ts_pre_call_summary.teva_product_flag,
        ts_pre_call_summary.payer_id,
        ts_pre_call_summary.payer_name,
        ts_pre_call_summary.plan_id,
        ts_pre_call_summary.plan_name,
        ts_pre_call_summary.payer_plan_id,
        ts_pre_call_summary.customer_id,
        ts_pre_call_summary.tvcmid,
        ts_pre_call_summary.hcp_plan_vol_rank,
        ts_pre_call_summary.prescriber_name,
        ts_pre_call_summary.pdrp_flag,
        ts_pre_call_summary.hcp_restriction_flag,
        ts_pre_call_summary.address,
        ts_pre_call_summary.city,
        ts_pre_call_summary.state,
        ts_pre_call_summary.zip,
        ts_pre_call_summary.target_status_flag,
        ts_pre_call_summary.partner_target_status_flag,
        ts_pre_call_summary.method_of_payment,
        ts_pre_call_summary.specialty,
        ts_pre_call_summary.segment,
        ts_pre_call_summary.decile,
        ts_pre_call_summary.market_volume_indicator,
        ts_pre_call_summary.product_vol_trx_count,
        ts_pre_call_summary.market_vol_trx_count,
        ts_pre_call_summary.prev_prod_vol_trx_count,
        ts_pre_call_summary.prev_market_vol_trx_count,
        ts_pre_call_summary.product_vol_nrx_count,
        ts_pre_call_summary.market_vol_nrx_count,
        ts_pre_call_summary.prev_prod_vol_nrx_count,
        ts_pre_call_summary.prev_market_vol_nrx_count,
        ts_pre_call_summary.samples,
        ts_pre_call_summary.details_p1,
        ts_pre_call_summary.details_p2,
        ts_pre_call_summary.details_p3,
        ts_pre_call_summary.focus_target
 FROM reporting.ts_pre_call_summary
 ORDER BY ts_pre_call_summary.sales_force_id,
          ts_pre_call_summary.nation_id,
          ts_pre_call_summary.nation,
          ts_pre_call_summary.area_id,
          ts_pre_call_summary.area,
          ts_pre_call_summary.region_id,
          ts_pre_call_summary.region,
          ts_pre_call_summary.territory_id
SEGMENTED BY hash(ts_pre_call_summary.customer_id) ALL NODES;

CREATE PROJECTION reporting.ts_weekly_account_summary_b0 /*+basename(ts_weekly_account_summary),createtype(L)*/ 
(
 sales_force_id,
 nation_id,
 nation,
 area_id,
 area,
 region_id,
 region,
 territory_id,
 territory,
 rep_name,
 rep_type,
 user_id,
 time_period,
 period_type,
 period,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 customer_id,
 tvcmid,
 network_name,
 account_name,
 channel,
 address,
 city,
 state,
 zip,
 formulary_control,
 gpo,
 target,
 decile,
 new_account,
 market_volume_indicator,
 product_vol_units,
 market_vol_units,
 prev_prod_vol_units,
 prev_market_vol_units,
 samples,
 details_p1,
 details_p2,
 details_p3
)
AS
 SELECT ts_weekly_account_summary.sales_force_id,
        ts_weekly_account_summary.nation_id,
        ts_weekly_account_summary.nation,
        ts_weekly_account_summary.area_id,
        ts_weekly_account_summary.area,
        ts_weekly_account_summary.region_id,
        ts_weekly_account_summary.region,
        ts_weekly_account_summary.territory_id,
        ts_weekly_account_summary.territory,
        ts_weekly_account_summary.rep_name,
        ts_weekly_account_summary.rep_type,
        ts_weekly_account_summary.user_id,
        ts_weekly_account_summary.time_period,
        ts_weekly_account_summary.period_type,
        ts_weekly_account_summary.period,
        ts_weekly_account_summary.market_id,
        ts_weekly_account_summary.market_name,
        ts_weekly_account_summary.brand_id,
        ts_weekly_account_summary.brand_name,
        ts_weekly_account_summary.teva_product_flag,
        ts_weekly_account_summary.customer_id,
        ts_weekly_account_summary.tvcmid,
        ts_weekly_account_summary.network_name,
        ts_weekly_account_summary.account_name,
        ts_weekly_account_summary.channel,
        ts_weekly_account_summary.address,
        ts_weekly_account_summary.city,
        ts_weekly_account_summary.state,
        ts_weekly_account_summary.zip,
        ts_weekly_account_summary.formulary_control,
        ts_weekly_account_summary.gpo,
        ts_weekly_account_summary.target,
        ts_weekly_account_summary.decile,
        ts_weekly_account_summary.new_account,
        ts_weekly_account_summary.market_volume_indicator,
        ts_weekly_account_summary.product_vol_units,
        ts_weekly_account_summary.market_vol_units,
        ts_weekly_account_summary.prev_prod_vol_units,
        ts_weekly_account_summary.prev_market_vol_units,
        ts_weekly_account_summary.samples,
        ts_weekly_account_summary.details_p1,
        ts_weekly_account_summary.details_p2,
        ts_weekly_account_summary.details_p3
 FROM reporting.ts_weekly_account_summary
 ORDER BY ts_weekly_account_summary.sales_force_id,
          ts_weekly_account_summary.nation_id,
          ts_weekly_account_summary.nation,
          ts_weekly_account_summary.area_id,
          ts_weekly_account_summary.area,
          ts_weekly_account_summary.region_id,
          ts_weekly_account_summary.region,
          ts_weekly_account_summary.territory_id
SEGMENTED BY hash(ts_weekly_account_summary.sales_force_id, ts_weekly_account_summary.market_id, ts_weekly_account_summary.brand_id, ts_weekly_account_summary.teva_product_flag, ts_weekly_account_summary.tvcmid, ts_weekly_account_summary.state, ts_weekly_account_summary.zip, ts_weekly_account_summary.new_account) ALL NODES;

CREATE PROJECTION reporting.ts_weekly_geography_summary_b0 /*+basename(ts_weekly_geography_summary),createtype(L)*/ 
(
 sales_force_id,
 geography_level,
 geography_id,
 geography,
 rep_name,
 rep_type,
 user_id,
 time_period,
 period_type,
 period,
 segment,
 decile,
 target,
 market_id,
 market_name,
 brand_id,
 brand_name,
 teva_product_flag,
 channel,
 market_volume_indicator,
 new_accounts,
 accounts_ordering,
 avg_sales_per_account,
 prev_accounts_ordering,
 product_vol_units,
 market_vol_units,
 prev_prod_vol_units,
 prev_market_vol_units,
 accounts_detailed_count,
 total_accounts_count
)
AS
 SELECT ts_weekly_geography_summary.sales_force_id,
        ts_weekly_geography_summary.geography_level,
        ts_weekly_geography_summary.geography_id,
        ts_weekly_geography_summary.geography,
        ts_weekly_geography_summary.rep_name,
        ts_weekly_geography_summary.rep_type,
        ts_weekly_geography_summary.user_id,
        ts_weekly_geography_summary.time_period,
        ts_weekly_geography_summary.period_type,
        ts_weekly_geography_summary.period,
        ts_weekly_geography_summary.segment,
        ts_weekly_geography_summary.decile,
        ts_weekly_geography_summary.target,
        ts_weekly_geography_summary.market_id,
        ts_weekly_geography_summary.market_name,
        ts_weekly_geography_summary.brand_id,
        ts_weekly_geography_summary.brand_name,
        ts_weekly_geography_summary.teva_product_flag,
        ts_weekly_geography_summary.channel,
        ts_weekly_geography_summary.market_volume_indicator,
        ts_weekly_geography_summary.new_accounts,
        ts_weekly_geography_summary.accounts_ordering,
        ts_weekly_geography_summary.avg_sales_per_account,
        ts_weekly_geography_summary.prev_accounts_ordering,
        ts_weekly_geography_summary.product_vol_units,
        ts_weekly_geography_summary.market_vol_units,
        ts_weekly_geography_summary.prev_prod_vol_units,
        ts_weekly_geography_summary.prev_market_vol_units,
        ts_weekly_geography_summary.accounts_detailed_count,
        ts_weekly_geography_summary.total_accounts_count
 FROM reporting.ts_weekly_geography_summary
 ORDER BY ts_weekly_geography_summary.sales_force_id
SEGMENTED BY hash(ts_weekly_geography_summary.sales_force_id, ts_weekly_geography_summary.market_id, ts_weekly_geography_summary.brand_id, ts_weekly_geography_summary.teva_product_flag, ts_weekly_geography_summary.market_volume_indicator, ts_weekly_geography_summary.new_accounts, ts_weekly_geography_summary.accounts_ordering, ts_weekly_geography_summary.avg_sales_per_account) ALL NODES;


CREATE  VIEW reporting.v_nv_dc_chicago_reps AS
 SELECT r.full_name AS rep_name,
        r.title,
        r.territory_number,
        r.territory_name,
        r.team,
        r.hire_date,
        coalesce(m.full_name, 'NA'::varchar(2)) AS manager_name,
        coalesce(d.full_name, 'NA'::varchar(2)) AS director_name
 FROM (((datamart.roster r LEFT  JOIN datamart.roster m ON (((r.parent_territory_number = m.territory_number) AND (r.rep_type = 'REP'::varchar(3))))) LEFT  JOIN datamart.roster d ON (((m.parent_territory_number = d.territory_number) AND (m.rep_type = 'MGR'::varchar(3))))) JOIN (( SELECT current_alignment.territory_number
 FROM datamart.current_alignment
 WHERE ((upper(current_alignment.city) = 'CHICAGO'::varchar(7)) OR (current_alignment.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))) UNION  SELECT aa.territory_number
 FROM (datamart.alternate_alignments aa JOIN datamart.current_alignment ca ON ((aa.zip_code = ca.zip_code)))
 WHERE (((now())::date >= aa.start_date) AND ((now())::date <= aa.end_date) AND ((upper(ca.city) = 'CHICAGO'::varchar(7)) OR (ca.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))))
 GROUP BY aa.territory_number) UNION  SELECT c.territory_number
 FROM (datamart.sfa_call c JOIN datamart.current_alignment ca ON (((c.zip_on_call = ca.zip_code) AND ((upper(ca.city) = 'CHICAGO'::varchar(7)) OR (ca.state_code = ANY (ARRAY['DC'::varchar(2), 'NV'::varchar(2)]))))))
 WHERE ("datediff"('day'::varchar(3), c.call_date, (now())::date) <= 60)
 GROUP BY c.territory_number) t ON ((r.territory_number = t.territory_number)))
 WHERE (r.full_name <> 'Vacant'::varchar(6))
 GROUP BY r.full_name,
          r.title,
          r.territory_number,
          r.territory_name,
          r.team,
          r.hire_date,
          coalesce(m.full_name, 'NA'::varchar(2)),
          coalesce(d.full_name, 'NA'::varchar(2))
 ORDER BY r.territory_number;

CREATE  VIEW reporting.ajovy_activity_plan AS
 SELECT ap.sales_force_id,
        ap.territory_id,
        ap.customer_id,
        ap.tvcmid,
        p.market_id,
        ap.target_status_flag
 FROM (reporting.activity_plan ap JOIN reporting.product p ON (((ap.product_id = p.product_id) AND (upper(p.product_name) ~~ 'AJOVY%'::varchar(6)))))
 WHERE (ap.customer_id IS NOT NULL)
 GROUP BY ap.sales_force_id,
          ap.territory_id,
          ap.customer_id,
          ap.tvcmid,
          p.market_id,
          ap.target_status_flag;

CREATE  VIEW reporting.fcr_summary AS
 SELECT a.rsm_name,
        a.rsm_title,
        a.region_number,
        a.rsm_email,
        a.sales_rep_name,
        a.sales_rep_title,
        a.territory_number,
        a.sales_rep_email,
        a.fcr_date,
        a.report_status_vod__c
 FROM ( SELECT CASE WHEN (u.isactive = 'false'::varchar(5)) THEN (u.name || ' (inactive)'::varchar(11)) ELSE u.name END AS rsm_name,
        u.title AS rsm_title,
        t21.Name AS region_number,
        u.email AS rsm_email,
        CASE WHEN (a.isactive = 'false'::varchar(5)) THEN (a.name || ' (inactive)'::varchar(11)) ELSE a.name END AS sales_rep_name,
        a.title AS sales_rep_title,
        CASE WHEN (t22.Name IS NULL) THEN 'NA'::varchar(2) ELSE t22.Name END AS territory_number,
        a.email AS sales_rep_email,
        st.review_date_vod__c AS fcr_date,
        st.report_status_vod__c
 FROM (((((((veeva.v_survey s JOIN ( SELECT x.id,
        x.lastmodifieddate,
        x.survey_vod__c,
        x.employee_vod__c,
        x.coach_vod__c,
        x.review_date_vod__c,
        x.report_status_vod__c
 FROM ( SELECT v_survey_target.id,
        v_survey_target.lastmodifieddate,
        v_survey_target.survey_vod__c,
        v_survey_target.Employee_vod__c AS employee_vod__c,
        v_survey_target.coach_vod__c,
        v_survey_target.Review_date_vod__c AS review_date_vod__c,
        v_survey_target.report_status_vod__c,
        rank() OVER (PARTITION BY v_survey_target.Employee_vod__c, v_survey_target.Review_date_vod__c ORDER BY v_survey_target.lastmodifieddate DESC) AS ranker
 FROM veeva.v_survey_target) x
 WHERE (x.ranker = 1)) st ON ((s.id = st.survey_vod__c))) JOIN veeva.v_veeva_user a ON ((st.employee_vod__c = a.id))) JOIN veeva.v_veeva_user u ON ((st.coach_vod__c = u.id))) JOIN veeva.userterritory2association uta1 ON ((st.coach_vod__c = uta1.UserId))) JOIN veeva.territory2 t21 ON ((uta1.Territory2Id = t21.Id))) LEFT  JOIN veeva.userterritory2association uta2 ON (((st.employee_vod__c = uta2.UserId) AND (uta1.file_id = uta2.file_id)))) LEFT  JOIN veeva.territory2 t22 ON (((uta2.Territory2Id = t22.Id) AND (t21.file_id = t22.file_id))))
 WHERE ((s.name = 'Field Coaching Report'::varchar(21)) AND (uta1.file_id IN ( SELECT max(userterritory2association.file_id) AS max
 FROM veeva.userterritory2association)) AND (t21.file_id IN ( SELECT max(territory2.file_id) AS max
 FROM veeva.territory2)) AND (st.review_date_vod__c >= '2021-01-01'::date) AND (substr(t21.Name, 1, 2) = ANY (ARRAY['TR'::varchar(2), 'TP'::varchar(2), 'TN'::varchar(2)])))) a
 WHERE (substr(a.territory_number, 7, 2) <> '99'::varchar(2))
 GROUP BY a.rsm_name,
          a.rsm_title,
          a.region_number,
          a.rsm_email,
          a.sales_rep_name,
          a.sales_rep_title,
          a.territory_number,
          a.sales_rep_email,
          a.fcr_date,
          a.report_status_vod__c;

SELECT MARK_DESIGN_KSAFE(1);

