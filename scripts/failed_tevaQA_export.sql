

CREATE  VIEW teva_ingestion.EXT_VV_CALL2_VOD__C_test AS
SELECT EXT_VV_CALL2_VOD__C_src.ID, EXT_VV_CALL2_VOD__C_src.OWNERID, EXT_VV_CALL2_VOD__C_src.ISDELETED, EXT_VV_CALL2_VOD__C_src.NAME, EXT_VV_CALL2_VOD__C_src.RECORDTYPEID, EXT_VV_CALL2_VOD__C_src.CREATEDDATE, EXT_VV_CALL2_VOD__C_src.CREATEDBYID, EXT_VV_CALL2_VOD__C_src.LASTMODIFIEDDATE, EXT_VV_CALL2_VOD__C_src.LASTMODIFIEDBYID, EXT_VV_CALL2_VOD__C_src.SYSTEMMODSTAMP, EXT_VV_CALL2_VOD__C_src.LASTACTIVITYDATE, EXT_VV_CALL2_VOD__C_src.MAYEDIT, EXT_VV_CALL2_VOD__C_src.ISLOCKED, EXT_VV_CALL2_VOD__C_src.LASTVIEWEDDATE, EXT_VV_CALL2_VOD__C_src.LASTREFERENCEDDATE, EXT_VV_CALL2_VOD__C_src.SAMPLE_CARD_VOD__C, EXT_VV_CALL2_VOD__C_src.ADD_DETAIL_VOD__C, (EXT_VV_CALL2_VOD__C_src.PROPERTY_VOD__C)::numeric(8,0) AS PROPERTY_VOD__C, EXT_VV_CALL2_VOD__C_src.ACCOUNT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_PRODUCT_DISCUSSION_VOD__C, EXT_VV_CALL2_VOD__C_src.STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.PARENT_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.ACCOUNT_PLAN_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAVENEW_VOD__C, EXT_VV_CALL2_VOD__C_src.NEXT_CALL_NOTES_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_ID_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_CREDENTIALS_VOD_C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_PREFERRED_NAME_VO, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_SAMPLE_STATUS_VOD, EXT_VV_CALL2_VOD__C_src.ZVOD_ATTENDEES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_KEY_MESSAGES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_DETAILING_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_EXPENSES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_FOLLOWUP_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAMPLES_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SAVE_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SUBMIT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_DELETE_VOD__C, EXT_VV_CALL2_VOD__C_src.ACTIVITY_TYPE__C, EXT_VV_CALL2_VOD__C_src.SIGNIFICANT_EVENT__C, EXT_VV_CALL2_VOD__C_src.LOCATION_VOD__C, EXT_VV_CALL2_VOD__C_src.SUBJECT_VOD__C, EXT_VV_CALL2_VOD__C_src.UNLOCK_VOD__C, (EXT_VV_CALL2_VOD__C_src.CALL_DATETIME_VOD__C)::timestamptz AS CALL_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.DISBURSED_TO_VOD__C, EXT_VV_CALL2_VOD__C_src.REQUEST_RECEIPT_VOD__C, EXT_VV_CALL2_VOD__C_src.SIGNATURE_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.TERRITORY_VOD__C, EXT_VV_CALL2_VOD__C_src.SUBMITTED_BY_MOBILE_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_TYPE_VOD__C, EXT_VV_CALL2_VOD__C_src.ADD_KEY_MESSAGE_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_VOD__C, (EXT_VV_CALL2_VOD__C_src.ATTENDEES_VOD__C)::numeric(3,0) AS ATTENDEES_VOD__C, EXT_VV_CALL2_VOD__C_src.ATTENDEE_TYPE_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DETAILED_PRODUCTS_VOD__C, EXT_VV_CALL2_VOD__C_src.NO_DISBURSEMENT_VOD__C, EXT_VV_CALL2_VOD__C_src.PARENT_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.USER_VOD__C, EXT_VV_CALL2_VOD__C_src.CONTACT_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ENTITY_VOD__C, EXT_VV_CALL2_VOD__C_src.MEDICAL_EVENT_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_CREATED_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.MOBILE_LAST_MODIFIED_DATETIME, EXT_VV_CALL2_VOD__C_src.LICENSE_VOD__C, (EXT_VV_CALL2_VOD__C_src.IS_PARENT_CALL_VOD__C)::numeric(18,0) AS IS_PARENT_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.ENTITY_DISPLAY_NAME_VOD__C, EXT_VV_CALL2_VOD__C_src.OVERRIDE_LOCK_VOD__C, EXT_VV_CALL2_VOD__C_src.LAST_DEVICE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_COUNTRY_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_EXPIRATION_DATE, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_LICENSE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_TO_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_TO_ADDRESS_TEXT_VOD__C, EXT_VV_CALL2_VOD__C_src.CLM_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CLMDETAILS_VOD__C, EXT_VV_CALL2_VOD__C_src.IS_SAMPLED_CALL_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_SURVEYS_VOD__C, EXT_VV_CALL2_VOD__C_src.PRESENTATIONS_VOD__C, EXT_VV_CALL2_VOD__C_src.ENTITY_REFERENCE_ID_VOD__C, EXT_VV_CALL2_VOD__C_src.ERROR_REFERENCE_CALL_VOD__C, (EXT_VV_CALL2_VOD__C_src.DURATION_VOD__C)::numeric(18,0) AS DURATION_VOD__C, EXT_VV_CALL2_VOD__C_src.COLOR_VOD__C, EXT_VV_CALL2_VOD__C_src.ALLOWED_PRODUCTS_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ATTACHMENTS_VOD__C, EXT_VV_CALL2_VOD__C_src.SAMPLE_CARD_REASON_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSMCA_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_LINE_1_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_LINE_2_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ADDRESS_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_CITY_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_EXPIRATION_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.DEA_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.STATE_VOD__C, EXT_VV_CALL2_VOD__C_src.ZIP_4_VOD__C, EXT_VV_CALL2_VOD__C_src.ZIP_VOD__C, EXT_VV_CALL2_VOD__C_src.SAMPLE_SEND_CARD_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ADDRESS_VOD_C_DEA_STATUS_, EXT_VV_CALL2_VOD__C_src.SIGNATURE_PAGE_IMAGE_VOD__C, EXT_VV_CALL2_VOD__C_src.CREDENTIALS_VOD__C, EXT_VV_CALL2_VOD__C_src.SALUTATION_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_ACCOUNT_CALL_REMINDER_VOD, EXT_VV_CALL2_VOD__C_src.SALES_ORG_TVA__C, EXT_VV_CALL2_VOD__C_src.ZVOD_BUSINESS_ACCOUNT_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_1_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_2_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_3_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_4_VOD__C, EXT_VV_CALL2_VOD__C_src.PRODUCT_PRIORITY_5_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_MORE_ACTIONS_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CALL_CONFLICT_STATUS, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_TIMESTAMP_VOD__C)::numeric(15,0) AS SIGNATURE_TIMESTAMP_VOD__C, (EXT_VV_CALL2_VOD__C_src.EXPENSE_AMOUNT_VOD__C)::numeric(18,0) AS EXPENSE_AMOUNT_VOD__C, (EXT_VV_CALL2_VOD__C_src.TOTAL_EXPENSE_ATTENDEES_COUNT)::numeric(5,0) AS TOTAL_EXPENSE_ATTENDEES_COUNT, EXT_VV_CALL2_VOD__C_src.ATTENDEE_LIST_VOD__C, EXT_VV_CALL2_VOD__C_src.EXPENSE_POST_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.ATTENDEE_POST_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.EXPENSE_SYSTEM_EXTERNAL_ID, EXT_VV_CALL2_VOD__C_src.INCURRED_EXPENSE_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSIGNER_VOD__C, EXT_VV_CALL2_VOD__C_src.ASSIGNMENT_DATETIME_VOD__C, EXT_VV_CALL2_VOD__C_src.ZVOD_CALL_OBJECTIVE_VOD__C, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_LOCATION_LONGITUDE)::numeric(15,6) AS SIGNATURE_LOCATION_LONGITUDE, (EXT_VV_CALL2_VOD__C_src.SIGNATURE_LOCATION_LATITUDE)::numeric(15,6) AS SIGNATURE_LOCATION_LATITUDE, EXT_VV_CALL2_VOD__C_src.LOCATION_SERVICES_STATUS, EXT_VV_CALL2_VOD__C_src.CREATED_BY_TIMEZONE_TVA__C, EXT_VV_CALL2_VOD__C_src.LICENSE_EXPIRATION_DATE_VOD__C, EXT_VV_CALL2_VOD__C_src.LICENSE_STATUS_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_ASSMCA_VOD__C, EXT_VV_CALL2_VOD__C_src.SHIP_DEA_EXPIRATION_DATE, EXT_VV_CALL2_VOD__C_src.SHIP_DEA_VOD__C, EXT_VV_CALL2_VOD__C_src.CALL_METHOD_TVA__C, EXT_VV_CALL2_VOD__C_src.batch_id, EXT_VV_CALL2_VOD__C_src.row_id, EXT_VV_CALL2_VOD__C_src.update_ts FROM teva_ingestion.EXT_VV_CALL2_VOD__C_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_samples_prof AS
SELECT ap.ROW_ID AS sample_id, ea.ROW_ID AS call_id, c.ROW_ID AS siebel_contact_row_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, rep_p.X_SALES_FORCE AS sales_force_id, rep_p.NAME AS territory_num, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, CASE WHEN (ap.RELATION_TYPE_CD = 'Direct Send'::varchar(11)) THEN 'REQUEST'::varchar(7) WHEN (ap.RELATION_TYPE_CD = 'Sample'::varchar(6)) THEN 'DROP'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS sample_type, CASE WHEN (p.DESC_TEXT ~~ 'Adipex%'::varchar(7)) THEN 'ADIPEX-P'::varchar(8) WHEN (p.DESC_TEXT ~~ 'Amrix%'::varchar(6)) THEN 'AMRIX'::varchar(5) WHEN (p.DESC_TEXT ~~ 'Azilect%'::varchar(8)) THEN 'AZILECT'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Budesonide%'::varchar(11)) THEN 'BUDESONIDE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'COPAXONE%'::varchar(9)) THEN 'COPAXONE'::varchar(8) WHEN (p.DESC_TEXT ~~ 'ENJUVIA%'::varchar(8)) THEN 'ENJUVIA'::varchar(7) WHEN (p.DESC_TEXT ~~ 'LoSeasonique%'::varchar(13)) THEN 'LOSEASONIQUE'::varchar(12) WHEN (p.DESC_TEXT ~~ 'NIASPAN%'::varchar(8)) THEN 'NIASPAN'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Nuvigil%'::varchar(8)) THEN 'NUVIGIL'::varchar(7) WHEN (p.DESC_TEXT ~~ 'ProAir%'::varchar(7)) THEN 'PROAIR'::varchar(6) WHEN (p.DESC_TEXT ~~ 'Qnasl%'::varchar(6)) THEN 'QNASL'::varchar(5) WHEN (p.DESC_TEXT ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (p.DESC_TEXT ~~ 'Seasonique%'::varchar(11)) THEN 'SEASONIQUE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'Tev-Tropin%'::varchar(11)) THEN 'TEV-TROPIN'::varchar(10) ELSE 'UNKNOWN'::varchar(7) END AS product_name, p.DESC_TEXT AS sample_name, p.PART_NUM AS sample_ndc, ap.QTY AS qty, ea.NAME AS name_on_call, ea.COMMENTS AS address_line_on_call, ea.ZIPCODE AS zip_on_call, d.ims_id, eax.ATTRIB_03 AS dea_num, ea.OWNER_PER_ID AS ownerid, emp.CSN AS employeenumber, ea.CREATED_BY AS created_by, ea.CREATED AS created_date FROM (((((((WSMP_ADMIN.S_EVT_ACT ea JOIN WSMP_ADMIN.S_CONTACT c ON ((ea.TARGET_PER_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN rep_p ON ((ea.OWNER_POSTN_ID = rep_p.ROW_ID))) JOIN WSMP_ADMIN.S_ACT_PRDINT ap ON ((ea.ROW_ID = ap.ACTIVITY_ID))) JOIN WSMP_ADMIN.S_PROD_INT p ON ((ap.PRDINT_ID = p.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_EVT_ACT_X eax ON ((ea.ROW_ID = eax.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT dim_sfa_csf_demo.IMS_ID AS ims_id, dim_sfa_csf_demo.CM_ID AS cm_id, dim_sfa_csf_demo.ME_NUM AS me_num, dim_sfa_csf_demo.SIEBEL_CONTACT_ROW_ID AS siebel_contact_row_id, row_number() OVER (PARTITION BY dim_sfa_csf_demo.SIEBEL_CONTACT_ROW_ID ORDER BY dim_sfa_csf_demo.VEEVA_ACCOUNT_ID, dim_sfa_csf_demo.SALES_FORCE_ID) AS rnk FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) WHERE ((rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ap.RELATION_TYPE_CD = ANY (ARRAY['Direct Send'::varchar(11), 'Sample'::varchar(6)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_samples_account_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_PER_ID AS csf_demo_id, 'ACCT'::varchar(4) AS call_type, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.INTEGRATION_ID AS integration_id, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_PER_ID AS siebel_target_per_id, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.product_name, details.lot_num, details.qty, details.relation_type_cd, o.OU_TYPE_CD AS ou_type_cd, CASE WHEN (length(emp.INTEGRATION_ID) = 18) THEN emp.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM ((((WSMP_ADMIN.S_EVT_ACT ea LEFT JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_ORG_EXT o ON ((o.ROW_ID = rep_p.BU_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.TARGET_PER_ID))) JOIN (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, appl.LOT_NUM AS lot_num, appl.QTY AS qty, appl.RELATION_TYPE_CD AS relation_type_cd FROM (WSMP_ADMIN.S_ACT_PRDINT appl JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE ((appl.CONFLICT_ID = '0'::varchar(1)) AND (appl.RELATION_TYPE_CD = ANY (ARRAY['DirectSend'::varchar(10), 'Sample'::varchar(6)])))) details ON ((details.activity_id = ea.ROW_ID))) WHERE ((rep_p.NAME <> ALL (ARRAY['Siebel Administrator'::varchar(20), 'TWH Siebel Administrator'::varchar(24)])) AND (o.NAME <> ALL (ARRAY['Siebel Administration'::varchar(21), 'ERM AnonUser'::varchar(12), 'Default Organization'::varchar(20)])) AND (coalesce(o.OU_TYPE_CD, 'XXX'::varchar(3)) <> 'Manufacturer'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_account_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_OU_ID AS csf_demo_id, 'ACCT'::varchar(4) AS call_type, o.OU_TYPE_CD AS ou_type_cd, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_OU_ID AS siebel_target_ou_id, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.first_detailed_product, details.second_detailed_product, details.third_detailed_product, details.fourth_detailed_product, details.fifth_detailed_product, details.sixth_detailed_product, CASE WHEN (length(o.INTEGRATION_ID) = 18) THEN o.INTEGRATION_ID ELSE NULL END AS veeva_account_id, ea.INTEGRATION_ID AS integration_id FROM ((((WSMP_ADMIN.S_EVT_ACT ea LEFT JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_ORG_EXT o ON ((o.ROW_ID = ea.TARGET_OU_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.activity_id, max(CASE WHEN (iq.priority = 1) THEN iq.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (iq.priority = 2) THEN iq.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (iq.priority = 3) THEN iq.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (iq.priority = 4) THEN iq.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (iq.priority = 5) THEN iq.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (iq.priority = 6) THEN iq.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority FROM (WSMP_ADMIN.S_ACT_PROD_APPL appl LEFT JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE (appl.CONFLICT_ID = '0'::varchar(1))) iq GROUP BY iq.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID))) WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2011-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = 'Account Call'::varchar(12)) AND (ea.TODO_CD = 'Account Call'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_demo_accounts AS
SELECT oe.ROW_ID AS csf_demo_id, p.X_SALES_FORCE AS sales_force_id, 'ACCT'::varchar(4) AS demo_type, oe.OU_TYPE_CD AS account_type, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, x.ATTRIB_07 AS hms_id, x.X_ATTRIB_109 AS bp_code, p.NAME AS territory_num, btrim(oe.NAME) AS org_name, substr(btrim(ap.ADDR), 1, 75) AS address1, substr(btrim(ap.ADDR_LINE_2), 1, 75) AS address2, substr(btrim(ap.ADDR_LINE_3), 1, 75) AS address3, ap.CITY AS city, ap.STATE AS state, ap.ZIPCODE AS zip, s_accnt_postn.LAST_CALL_DT AS last_call_date, ap.ROW_ID AS siebel_addr_per_row_id, 'Y'::varchar(1) AS ora_viewable_flag, oe.CREATED AS sfa_create_date, (statement_timestamp())::timestamp AS last_build_date, CASE WHEN (length(oe.INTEGRATION_ID) = 18) THEN oe.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM ((((WSMP_ADMIN.S_ORG_EXT oe LEFT JOIN WSMP_ADMIN.S_ORG_EXT_X x ON ((oe.ROW_ID = x.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ADDR_PER ap ON ((oe.PR_ADDR_ID = ap.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ACCNT_POSTN ON ((oe.ROW_ID = s_accnt_postn.OU_EXT_ID))) LEFT JOIN WSMP_ADMIN.S_POSTN p ON ((s_accnt_postn.POSITION_ID = p.ROW_ID))) WHERE ((oe.NAME <> ALL (ARRAY['Siebel Administration'::varchar(21), 'ERM AnonUser'::varchar(12), 'Default Organization'::varchar(20)])) AND (p.NAME <> ALL (ARRAY['Siebel Administrator'::varchar(20), 'TWH Siebel Administrator'::varchar(24)])) AND (oe.OU_TYPE_CD <> 'Manufacturer'::varchar(12)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_4th_sales_roster AS
SELECT fourth_sale_force_roster.EMPLOYEE_ID AS employee_id, fourth_sale_force_roster.USERNAME AS username, CASE fourth_sale_force_roster.LAST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE fourth_sale_force_roster.LAST_NAME END AS last_name, CASE fourth_sale_force_roster.FIRST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE fourth_sale_force_roster.FIRST_NAME END AS first_name, fourth_sale_force_roster.MIDDLE_NAME AS middle_name, fourth_sale_force_roster.SALUTATION AS salutation, fourth_sale_force_roster.SUFFIX AS suffix, fourth_sale_force_roster.TITLE AS title, fourth_sale_force_roster.TERRITORY AS territory, fourth_sale_force_roster.TERRITORY_NAME AS territory_name, CASE WHEN (substr(fourth_sale_force_roster.MANAGER_TERRITORY, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (fourth_sale_force_roster.MANAGER_TERRITORY = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (fourth_sale_force_roster.MANAGER_TERRITORY = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE fourth_sale_force_roster.MANAGER_TERRITORY END AS manager_territory, fourth_sale_force_roster.TEAM AS team, fourth_sale_force_roster.BUSINESS_LINE_1_ADDR AS business_line_1_addr, fourth_sale_force_roster.BUSINESS_LINE_2_ADDR AS business_line_2_addr, fourth_sale_force_roster.BUSINESS_LINE_3_ADDR AS business_line_3_addr, fourth_sale_force_roster.BUSINESS_CITY AS business_city, fourth_sale_force_roster.BUSINESS_STATE AS business_state, fourth_sale_force_roster.BUSINESS_POSTAL_CODE AS business_postal_code, fourth_sale_force_roster.BUSINESS_COUNTRY_CODE AS business_country_code, fourth_sale_force_roster.HOME_LINE_1_ADDR AS home_line_1_addr, fourth_sale_force_roster.HOME_LINE_2_ADDR AS home_line_2_addr, fourth_sale_force_roster.HOME_LINE_3_ADDR AS home_line_3_addr, fourth_sale_force_roster.HOME_CITY AS home_city, fourth_sale_force_roster.HOME_STATE AS home_state, fourth_sale_force_roster.HOME_POSTAL_CODE AS home_postal_code, fourth_sale_force_roster.HOME_COUNTRY_CODE AS home_country_code, fourth_sale_force_roster.CORRESPONDENCE_ADDRESS AS correspondence_address, fourth_sale_force_roster.BUSINESS_PHONE AS business_phone, fourth_sale_force_roster.BUSINESS_PHONE_EXTENSION AS business_phone_extension, fourth_sale_force_roster.BUSINESS_FAX AS business_fax, fourth_sale_force_roster.VOICE_MAIL AS voice_mail, fourth_sale_force_roster.MOBILE_PHONE AS mobile_phone, fourth_sale_force_roster.HOME_PHONE AS home_phone, fourth_sale_force_roster.HOME_FAX AS home_fax, fourth_sale_force_roster.CORRESPONDENCE_PHONE AS correspondence_phone, fourth_sale_force_roster.BUSINESS_EMAIL AS business_email, fourth_sale_force_roster.HOME_EMAIL AS home_email, fourth_sale_force_roster.CORRESPONDENCE_EMAIL AS correspondence_email, fourth_sale_force_roster.COST_CENTER AS cost_center FROM WSMP_ADMIN.FOURTH_SALE_FORCE_ROSTER WHERE ((fourth_sale_force_roster.TERRITORY !~~ '%ZZZZ%'::varchar(6)) AND ((trunc(fourth_sale_force_roster.HIRE_DT, 'DD'::varchar(2)) <= (statement_timestamp())::timestamp) OR (fourth_sale_force_roster.HIRE_DT IS NULL)) AND (fourth_sale_force_roster.TERRITORY <> '111111'::varchar(6)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_SP_Attendees AS
SELECT a.EVENT_NUMBER AS event_number, e.EVENT_NAME AS event_name, e.EVENT_START_DATE AS event_start_date, a.ME_NUMBER AS me_number, a.DEA_NUMBER AS dea_number, cm.CEPH_ID AS ceph_id, a.CUSTOMER_ID AS customer_id, (cm.CUSTOMER_MASTER_ID)::varchar AS cm_id, a.ATTENDEE_FIRST_NAME AS attendee_first_name, a.ATTENDEE_LAST_NAME AS attendee_last_name, a.ATTENDEE_ADDRESS_LINE_1 AS attendee_address_line_1, a.ATTENDEE_ADDRESS_LINE_2 AS attendee_address_line_2, a.ATTENDEE_ADDRESS_LINE_3 AS attendee_address_line_3, a.ATTENDEE_CITY AS attendee_city, a.ATTENDEE_STATE_PROVINCE AS attendee_state_province, a.ATTENDEE_POSTAL_CODE AS attendee_postal_code, a.ATTENDEE_SPECIALTY AS attendee_specialty, a.ATTENDEE_DEGREE AS attendee_degree FROM ((WSMP_ADMIN.STG_AHM_EVENT_ATTENDEE a JOIN WSMP_ADMIN.STG_AHM_EVENT e ON ((e.EVENT_NUMBER = a.EVENT_NUMBER))) LEFT JOIN WSMP_ADMIN.STG_CUSTOMER_MASTER cm ON ((cm.SOURCE_ID = a.IMS_NUMBER))) WHERE ((e.EVENT_START_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (e.EVENT_START_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1))))) GROUP BY a.EVENT_NUMBER, e.EVENT_NAME, e.EVENT_START_DATE, a.ME_NUMBER, a.DEA_NUMBER, cm.CEPH_ID, a.CUSTOMER_ID, (cm.CUSTOMER_MASTER_ID)::varchar, a.ATTENDEE_FIRST_NAME, a.ATTENDEE_LAST_NAME, a.ATTENDEE_ADDRESS_LINE_1, a.ATTENDEE_ADDRESS_LINE_2, a.ATTENDEE_ADDRESS_LINE_3, a.ATTENDEE_CITY, a.ATTENDEE_STATE_PROVINCE, a.ATTENDEE_POSTAL_CODE, a.ATTENDEE_SPECIALTY, a.ATTENDEE_DEGREE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_AHM_PostalCodeTerritory AS
SELECT ahm_postal_code_territory_xref.COUNTRY_CODE, ahm_postal_code_territory_xref.POSTAL_CODE, ahm_postal_code_territory_xref.TERRITORY FROM WSMP_ADMIN.AHM_POSTAL_CODE_TERRITORY_XREF WHERE (ahm_postal_code_territory_xref.TERRITORY !~~ '%ZZZZ%'::varchar(6));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Amrix_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Azilect_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_rx_backup AS
SELECT rx.STATION_NUMBER, rx.VA_PRODUCT, 0 AS PRODUCT_ID, rx.PRODUCT_CODE, to_char(rx.MONTH, 'YYYY-MM-DD'::varchar(10)) AS MONTH, rx.TRX_CNT, rx.CMOP_CNT, rx.TRX_QTY, rx.CMOP_QTY, rx.CNT_30_DAY_RX, rx.ID FROM (WSMP_ADMIN.DW_CMOP_RX_TEVA rx JOIN CUSTOMER.DIM_VA_PRODUCT_XREF p ON ((rx.PRODUCT_CODE = p.WK_PROD_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_station AS
SELECT dim_va_station.VISN, dim_va_station.STATION_NUMBER, dim_va_station.STATION, dim_va_station.STATION_TYPE, dim_va_station.ADDRESS, dim_va_station.CITY, dim_va_station.STATE, dim_va_station.ZIP, dim_va_station.CMOP, dim_va_station.CMOP_DATE, to_char(dim_va_station.CREATE_DATE, 'YYYY-MM-DD'::varchar(10)) AS CREATE_DATE, to_char(dim_va_station.LAST_UPD_DATE, 'YYYY-MM-DD'::varchar(10)) AS LAST_UPD_DATE, dim_va_station.STANDARD_ZIP FROM WSMP_ADMIN.DIM_VA_STATION;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales_backup AS
SELECT STG_ANDA_SALES.TRANSACTION_ID, to_char(STG_ANDA_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_ANDA_SALES.PRODUCT_BRAND, STG_ANDA_SALES.PRODUCT_NDC, STG_ANDA_SALES.PRODUCT_DESC, STG_ANDA_SALES.INVOICE_QTY, STG_ANDA_SALES.INVOICE_UNITS, STG_ANDA_SALES.INVOICE_COST, STG_ANDA_SALES.INVOICE_PACK_COST, STG_ANDA_SALES.INVOICE_UNIT_COST, STG_ANDA_SALES.CONTRACT_PACK_COST, STG_ANDA_SALES.CONTRACT_PURCHASES, STG_ANDA_SALES.CONTRACT_NUMBER, STG_ANDA_SALES.DISPENSING_LOCATION, STG_ANDA_SALES.DL_ADDRESS_1, STG_ANDA_SALES.DL_ADDRESS_2, STG_ANDA_SALES.DL_CITY, STG_ANDA_SALES.DL_STATE, STG_ANDA_SALES.DL_ZIP, STG_ANDA_SALES.DL_DEA_NUM, STG_ANDA_SALES.DEPOT_LOCATION, STG_ANDA_SALES.DEP_ADDRESS_1, STG_ANDA_SALES.DEP_ADDRESS_2, STG_ANDA_SALES.DEP_CITY, STG_ANDA_SALES.DEP_STATE, STG_ANDA_SALES.DEP_ZIP, STG_ANDA_SALES.DEP_DEA_NUM, STG_ANDA_SALES.UNIT_AP, STG_ANDA_SALES.AP FROM WSMP_ADMIN.STG_ANDA_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_cns_deciles AS
SELECT d.ims_id AS hcp_id, CASE d.decile_name WHEN NULLSEQUAL 'Modafinil'::varchar(9) THEN 'Wake'::varchar(4) ELSE d.decile_name END AS decile_name, d.trx_cnt_01_06 AS decile_value FROM WSMP_ADMIN.tfc_ims_decile d WHERE ((d.decile_name = ANY (ARRAY['Fentora'::varchar(7), 'Actiq'::varchar(5), 'Nuvigil'::varchar(7), 'Amrix'::varchar(5), 'Azilect'::varchar(7), 'Copaxone'::varchar(8)])) AND (NOT EXISTS (SELECT NULL FROM WSMP_ADMIN.tfc_ims_presc_demo_w pd WHERE ((pd.ims_id = d.ims_id) AND (pd.pdrp_flag = 'Y'::char(1)))))) UNION ALL SELECT d.ims_id AS hcp_id, CASE d.decile_name WHEN NULLSEQUAL 'Modafinil'::varchar(9) THEN 'Wake'::varchar(4) ELSE d.decile_name END AS decile_name, d.trx_cnt_01_06 AS decile_value FROM WSMP_ADMIN.tfc_ims_decile d WHERE (d.decile_name = ANY (ARRAY['TIRF Total'::varchar(10), 'Total Combo SAO'::varchar(15), 'Total Opioid Market'::varchar(19), 'Total LAO'::varchar(9), 'Total Pure SAO'::varchar(14), 'Branded Sleep / Sedative'::varchar(24), 'Modafinil'::varchar(9), 'Muscle Relaxant Market'::varchar(22)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_program_backup AS
SELECT DIM_ASI_PROGRAM.REDEMPTION_TYPE, DIM_ASI_PROGRAM.ASI_PROGRAM_NUM, DIM_ASI_PROGRAM.PROGRAM_DESC, DIM_ASI_PROGRAM.SALES_FORCE_ID, DIM_ASI_PROGRAM.PROGRAM_TYPE, DIM_ASI_PROGRAM.PRODUCT_NAME, to_char(DIM_ASI_PROGRAM.PROGRAM_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_START_DATE, to_char(DIM_ASI_PROGRAM.PROGRAM_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_END_DATE, DIM_ASI_PROGRAM.NUMBER_OF_TABLETS FROM WSMP_ADMIN.DIM_ASI_PROGRAM;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_redemption_backup AS
SELECT coalesce(tfc_asi_copay_detail_wkly.VEEVA_ACCOUNT_ID, tfc_asi_copay_detail_wkly.IMS_ID) AS veeva_account_id, tfc_asi_copay_detail_wkly.IMS_ID AS ims_id, tfc_asi_copay_detail_wkly.REDEMPTION_TYPE AS redemption_type, to_char(tfc_asi_copay_detail_wkly.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(tfc_asi_copay_detail_wkly.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, tfc_asi_copay_detail_wkly.DAYS_SUPPLY AS days_supply, tfc_asi_copay_detail_wkly.NDC_CODE AS ndc_code, tfc_asi_copay_detail_wkly.BRAND_NAME AS brand_name, tfc_asi_copay_detail_wkly.QTY AS qty, tfc_asi_copay_detail_wkly.REFILLS AS refills, tfc_asi_copay_detail_wkly.PROGRAM_NUM AS program_num, tfc_asi_copay_detail_wkly.COPAY_CARD_NUM AS copay_voucher_num, tfc_asi_copay_detail_wkly.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, tfc_asi_copay_detail_wkly.PHARMACY_CHAIN AS pharmacy_chain, tfc_asi_copay_detail_wkly.PHARMACY_NAME AS pharmacy_name, tfc_asi_copay_detail_wkly.PHARMACY_ADDRESS AS pharmacy_address, tfc_asi_copay_detail_wkly.PHARMACY_ADDRESS2 AS pharmacy_address2, tfc_asi_copay_detail_wkly.PHARMACY_CITY AS pharmacy_city, tfc_asi_copay_detail_wkly.PHARMACY_STATE AS pharmacy_state, tfc_asi_copay_detail_wkly.PHARMACY_ZIP AS pharmacy_zip, tfc_asi_copay_detail_wkly.PHARMACY_NPI_NUM AS pharmacy_npi_num, NULL AS ceph_id, tfc_asi_copay_detail_wkly.ME_NUM AS me_num, tfc_asi_copay_detail_wkly.PRINCIPLE_PHYS_DEA_NUM AS principle_phys_dea_num, tfc_asi_copay_detail_wkly.PRINCIPLE_PHYS_NPI_NUM AS principle_phys_npi_num, tfc_asi_copay_detail_wkly.PHYSICIAN_NAME AS physician_name, tfc_asi_copay_detail_wkly.ASI_PHYS_ADDRESS1 AS physician_address1, tfc_asi_copay_detail_wkly.ASI_PHYS_ADDRESS2 AS physician_address2, tfc_asi_copay_detail_wkly.ASI_PHYS_CITY AS physician_city, tfc_asi_copay_detail_wkly.ASI_PHYS_STATE AS physician_state, tfc_asi_copay_detail_wkly.ASI_PHYS_ZIP AS physician_zip, tfc_asi_copay_detail_wkly.REBATE_AMOUNT AS rebate_amount, tfc_asi_copay_detail_wkly.MEMBER_CASH_EXPENSE AS member_cash_expense, tfc_asi_copay_detail_wkly.SUBMITTED_COST AS submitted_cost, tfc_asi_copay_detail_wkly.PHARMACY_FEE AS pharmacy_fee, tfc_asi_copay_detail_wkly.TOTAL_AMOUNT_DUE AS total_amount_due, tfc_asi_copay_detail_wkly.CALC_AWP AS calc_awp, tfc_asi_copay_detail_wkly.OCC_PAYMENT_TYPE AS occ_payment_type, tfc_asi_copay_detail_wkly.NEW_REFILL AS new_refill FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY WHERE ((tfc_asi_copay_detail_wkly.BRAND_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (tfc_asi_copay_detail_wkly.FILL_DATE < (statement_timestamp())::timestamp) AND (tfc_asi_copay_detail_wkly.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, tfc_asi_copay_detail_wkly.FILL_DATE) <= 25::float)) UNION ALL SELECT coalesce(tfc_asi_redemption_detail_wkly.VEEVA_ACCOUNT_ID, tfc_asi_redemption_detail_wkly.IMS_ID) AS veeva_account_id, tfc_asi_redemption_detail_wkly.IMS_ID AS ims_id, tfc_asi_redemption_detail_wkly.REDEMPTION_TYPE AS redemption_type, to_char(tfc_asi_redemption_detail_wkly.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(tfc_asi_redemption_detail_wkly.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, tfc_asi_redemption_detail_wkly.DAYS_SUPPLY AS days_supply, tfc_asi_redemption_detail_wkly.NDC_CODE AS ndc_code, tfc_asi_redemption_detail_wkly.PRODUCT_NAME AS brand_name, tfc_asi_redemption_detail_wkly.QTY AS qty, tfc_asi_redemption_detail_wkly.REFILLS AS refills, tfc_asi_redemption_detail_wkly.PROGRAM_NUM AS program_num, tfc_asi_redemption_detail_wkly.VOUCHER_NUM AS copay_voucher_num, tfc_asi_redemption_detail_wkly.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, tfc_asi_redemption_detail_wkly.PHARMACY_CHAIN AS pharmacy_chain, tfc_asi_redemption_detail_wkly.PHARMACY_NAME AS pharmacy_name, tfc_asi_redemption_detail_wkly.PHARMACY_ADDRESS AS pharmacy_address, NULL AS pharmacy_address2, tfc_asi_redemption_detail_wkly.PHARMACY_CITY AS pharmacy_city, tfc_asi_redemption_detail_wkly.PHARMACY_STATE AS pharmacy_state, tfc_asi_redemption_detail_wkly.PHARMACY_ZIP AS pharmacy_zip, tfc_asi_redemption_detail_wkly.PHARMACY_NPI_NUM AS pharmacy_npi_num, NULL AS ceph_id, tfc_asi_redemption_detail_wkly.ME_NUM AS me_num, tfc_asi_redemption_detail_wkly.DEA_NUM AS dea_num, tfc_asi_redemption_detail_wkly.NPI AS npi, tfc_asi_redemption_detail_wkly.PROVIDER_NAME AS provider_name, tfc_asi_redemption_detail_wkly.PROVIDER_ADDRESS AS provider_address, NULL AS physician_address2, tfc_asi_redemption_detail_wkly.PROVIDER_CITY AS provider_city, tfc_asi_redemption_detail_wkly.PROVIDER_STATE AS provider_state, tfc_asi_redemption_detail_wkly.PROVIDER_ZIP AS provider_zip, tfc_asi_redemption_detail_wkly.REBATE_AMOUNT AS rebate_amount, tfc_asi_redemption_detail_wkly.MEMBER_CASH_EXPENSE AS member_cash_expense, tfc_asi_redemption_detail_wkly.SUBMITTED_COST AS submitted_cost, tfc_asi_redemption_detail_wkly.PHARMACY_FEE AS pharmacy_fee, tfc_asi_redemption_detail_wkly.TOTAL_AMOUNT_DUE AS total_amount_due, tfc_asi_redemption_detail_wkly.CALC_AWP AS calc_awp, NULL AS occ_payment_type, tfc_asi_redemption_detail_wkly.NEW_REFILL AS new_refill FROM WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY WHERE ((tfc_asi_redemption_detail_wkly.PRODUCT_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (tfc_asi_redemption_detail_wkly.FILL_DATE < (statement_timestamp())::timestamp) AND (tfc_asi_redemption_detail_wkly.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, tfc_asi_redemption_detail_wkly.FILL_DATE) <= 25::float));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_omnicare_sale_backup AS
SELECT STG_OMNICARE_SALES.TRANSACTION_ID, to_char(STG_OMNICARE_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_OMNICARE_SALES.PRODUCT_BRAND, STG_OMNICARE_SALES.PRODUCT_NDC, STG_OMNICARE_SALES.PRODUCT_DESC, STG_OMNICARE_SALES.INVOICE_QTY, STG_OMNICARE_SALES.INVOICE_UNITS, STG_OMNICARE_SALES.INVOICE_COST, STG_OMNICARE_SALES.INVOICE_PACK_COST, STG_OMNICARE_SALES.INVOICE_UNIT_COST, STG_OMNICARE_SALES.CONTRACT_PACK_COST, STG_OMNICARE_SALES.CONTRACT_PURCHASES, STG_OMNICARE_SALES.CONTRACT_NUMBER, STG_OMNICARE_SALES.DISPENSING_LOCATION, STG_OMNICARE_SALES.DL_ADDRESS_1, STG_OMNICARE_SALES.DL_ADDRESS_2, STG_OMNICARE_SALES.DL_CITY, STG_OMNICARE_SALES.DL_STATE, STG_OMNICARE_SALES.DL_ZIP, STG_OMNICARE_SALES.DL_DEA_NUM, STG_OMNICARE_SALES.DEPOT_LOCATION, STG_OMNICARE_SALES.DEP_ADDRESS_1, STG_OMNICARE_SALES.DEP_ADDRESS_2, STG_OMNICARE_SALES.DEP_CITY, STG_OMNICARE_SALES.DEP_STATE, STG_OMNICARE_SALES.DEP_ZIP, STG_OMNICARE_SALES.DEP_DEA_NUM, STG_OMNICARE_SALES.UNIT_AP, STG_OMNICARE_SALES.AP FROM WSMP_ADMIN.STG_OMNICARE_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_paragard_anda_sales_backup AS
SELECT ('A'::varchar(1) || lpad((STG_TW_ANDA_SALES.CUSTOMER_NO)::varchar, 9, '0'::varchar(1))) AS BP_CODE, NULL AS ORTHO_E, STG_TW_ANDA_SALES.CUSTOMER AS BP_NAME, coalesce(STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE2, STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE1) AS SHIP_TO_ADDRESS, STG_TW_ANDA_SALES.CITY AS SHIP_TO_CITY, STG_TW_ANDA_SALES.STATE AS SHIP_TO_STATE, STG_TW_ANDA_SALES.ZIP AS SHIP_TO_ZIP_CODE, NULL AS SHIP_TO_COUNTRY, NULL AS SHIP_TO_PHONE, NULL AS SHIP_TO_FAX, NULL AS SHIP_TO_EMAIL, coalesce(STG_TW_ANDA_SALES.BILL_ADDRESS_LINE2, STG_TW_ANDA_SALES.BILL_ADDRESS_LINE1) AS BILL_TO_ADDRESS, STG_TW_ANDA_SALES.BILL_CITY AS BILL_TO_CITY, STG_TW_ANDA_SALES.BILL_STATE AS BILL_TO_STATE, STG_TW_ANDA_SALES.BILL_ZIP AS BILL_TO_ZIP_CODE, NULL AS BILL_TO_COUNTRY, NULL AS BILL_TO_PHONE, NULL AS BILL_TO_FAX, NULL AS BILL_TO_EMAIL, STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD AS CLASS_OF_TRADE, STG_TW_ANDA_SALES.ORDER_NO AS INVOICE_NUM, STG_TW_ANDA_SALES.NET_COST AS DEL_AMT, to_char(to_date(STG_TW_ANDA_SALES.SALES_DATE, 'MM/DD/YY'::varchar(8)), 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_TW_ANDA_SALES.UNITS_NET AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", STG_TW_ANDA_SALES.PACKAGE_SIZE AS PACKS, NULL AS UNIT_PRICE, NULL AS TERRITORY, NULL AS ORDER_TYPE_CODE, NULL AS ORDER_TYPE_DESC, NULL AS LOB_CODE_DESC, NULL AS PRICE_MATRIX_DEF, ('A'::varchar(1) || lpad((STG_TW_ANDA_SALES.BILL_CUSTOMER_NO)::varchar, 9, '0'::varchar(1))) AS PARENT_BP_CODE, NULL AS PARENT_BP_DESC, NULL AS GRAND_PARENT_BP_DESC, NULL AS PO_NUMBER, NULL AS UPS_NUMBER, STG_TW_ANDA_SALES.ORDER_NO AS ORDER_NUMBER, NULL AS ORDER_LINE_NUMBER, NULL AS DISC_AMT, NULL AS WHSE_CD FROM WSMP_ADMIN.STG_TW_ANDA_SALES WHERE (STG_TW_ANDA_SALES.BRAND ~~ '%PARAGARD%'::varchar(10));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_accountsummary AS
SELECT STG_TB_CB_ACCOUNTS.ACCOUNT_ID, STG_TB_CB_ACCOUNTS.LOCATION_ID, STG_TB_CB_ACCOUNTS.DEA_NUMBER, STG_TB_CB_ACCOUNTS.END_CUSTOMER, STG_TB_CB_ACCOUNTS.ADDRESS_1, STG_TB_CB_ACCOUNTS.ADDRESS_2, STG_TB_CB_ACCOUNTS.CITY, STG_TB_CB_ACCOUNTS.STATE, STG_TB_CB_ACCOUNTS.ZIP, STG_TB_CB_ACCOUNTS.CONTRACT_TITLE, STG_TB_CB_ACCOUNTS.CONTRACT_ID, STG_TB_CB_ACCOUNTS.WHOLESALER_NAME, STG_TB_CB_ACCOUNTS.HIN, STG_TB_CB_ACCOUNTS.CONTRACT_ALIAS, STG_TB_CB_ACCOUNTS.WHOLESALER_DEA, STG_TB_CB_ACCOUNTS.COT_SOURCE, STG_TB_CB_ACCOUNTS.CLASS_OF_TRADE FROM WSMP_ADMIN.STG_TB_CB_ACCOUNTS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_transactions_backup AS
SELECT STG_TB_CB_TRANSACTIONS.ACCOUNT_ID, STG_TB_CB_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_CB_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_CB_TRANSACTIONS.NDC_CODE, STG_TB_CB_TRANSACTIONS.PRODUCT_NAME, STG_TB_CB_TRANSACTIONS.CONTRACT_ID, STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS, STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS, to_char(STG_TB_CB_TRANSACTIONS.RECEIPT_DATE, 'YYYY-MM-DD'::varchar(10)) AS RECEIPT_DATE, STG_TB_CB_TRANSACTIONS.UNIT_AP, STG_TB_CB_TRANSACTIONS.AP, STG_TB_CB_TRANSACTIONS.DEBIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS CREDIT_MEMO_DATE, STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.SETTLEMENT_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS SETTLEMENT_DATE, STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE, STG_TB_CB_TRANSACTIONS.CONTRACT_ALIAS FROM WSMP_ADMIN.STG_TB_CB_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_transactions_backup AS
SELECT STG_TB_DS_TRANSACTIONS.ACCOUNT_ID, STG_TB_DS_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_DS_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_DS_TRANSACTIONS.NDC_CODE, STG_TB_DS_TRANSACTIONS.PRODUCT_NAME, STG_TB_DS_TRANSACTIONS.TRANSACTION_TYPE, STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS, STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS, STG_TB_DS_TRANSACTIONS.UNIT_AP, STG_TB_DS_TRANSACTIONS.AP FROM WSMP_ADMIN.STG_TB_DS_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ddd_subcategory AS
SELECT DIM_DDD_SUBCATEGORY.SUBCATEGORY_CODE, DIM_DDD_SUBCATEGORY.CATEGORY_CODE, DIM_DDD_SUBCATEGORY.COT_CODE, DIM_DDD_SUBCATEGORY.MAILORDER_FLAG, DIM_DDD_SUBCATEGORY.NONRETAIL_FLAG, DIM_DDD_SUBCATEGORY.OUTLET_EXAMPLE, DIM_DDD_SUBCATEGORY.OUTLET_DESC, DIM_DDD_SUBCATEGORY.OUTLET_DEFN, DIM_DDD_SUBCATEGORY.MDM_FLAG, DIM_DDD_SUBCATEGORY.ADM_FLAG, DIM_DDD_SUBCATEGORY.ONC_SUBCAT_GROUP FROM WSMP_ADMIN.DIM_DDD_SUBCATEGORY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_dnc AS
SELECT dnc.IMS_ID AS ims_id, dea.DEA_NUM AS dea_num, dnc.LAST_NAME AS last_name, dnc.FIRST_NAME AS first_name, dnc.MIDDLE_NAME AS mid_name, dnc.ADDRESS AS address, dnc.CITY AS city, dnc.STATE AS state, dnc.ZIP AS zip, npi.NPI AS npi FROM ((WSMP_ADMIN.DIM_DNC dnc LEFT JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((dnc.IMS_ID = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.STG_IMS_NPI npi ON ((dnc.IMS_ID = npi.IMS_ID))) WHERE ((dnc.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (dnc.SALES_FORCE_ID = 'TC'::varchar(2)) AND ((dea.DEA_NUM IS NULL) OR (regexp_replace(dea.DEA_NUM, '[0-9]'::varchar(5), ''::varchar, 1, 0, ''::varchar) IS NOT NULL)) AND ((dea.DEA_NUM IS NOT NULL) OR (npi.NPI IS NOT NULL)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_IMSZip_List AS
SELECT CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END AS ims_id, stg_ims_presc_demo_w.ims_zip AS zip FROM WSMP_ADMIN.STG_IMS_PRESC_DEMO_W WHERE ((stg_ims_presc_demo_w.sales_force_id = 'TR'::varchar(2)) AND ((stg_ims_presc_demo_w.last_name <> 'l32123'::varchar(6)) OR (stg_ims_presc_demo_w.last_name IS NULL) OR (length(stg_ims_presc_demo_w.ims_id) = 8))) GROUP BY CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END, stg_ims_presc_demo_w.ims_zip ORDER BY CASE WHEN (length(stg_ims_presc_demo_w.ims_id) = 8) THEN ('XX'::varchar(2) || substr(stg_ims_presc_demo_w.ims_id, 4)) ELSE stg_ims_presc_demo_w.ims_id END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0))) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pcs_ddd_nonretail AS
SELECT TFC_PCS_DDD_NONRETAIL.TERRITORY_NUM, TFC_PCS_DDD_NONRETAIL.OUTLET_CODE, TFC_PCS_DDD_NONRETAIL.SUBCATEGORY_CODE, TFC_PCS_DDD_NONRETAIL.CATEGORY_CODE, TFC_PCS_DDD_NONRETAIL.IMS_PRODUCT_CODE, TFC_PCS_DDD_NONRETAIL.PRODUCT_CODE, TFC_PCS_DDD_NONRETAIL.MTH_YYYYMM, TFC_PCS_DDD_NONRETAIL.QTY_MTH01, TFC_PCS_DDD_NONRETAIL.QTY_MTH02, TFC_PCS_DDD_NONRETAIL.QTY_MTH03, TFC_PCS_DDD_NONRETAIL.QTY_MTH04, TFC_PCS_DDD_NONRETAIL.QTY_MTH05, TFC_PCS_DDD_NONRETAIL.QTY_MTH06, TFC_PCS_DDD_NONRETAIL.QTY_MTH07, TFC_PCS_DDD_NONRETAIL.QTY_MTH08, TFC_PCS_DDD_NONRETAIL.QTY_MTH09, TFC_PCS_DDD_NONRETAIL.QTY_MTH10, TFC_PCS_DDD_NONRETAIL.QTY_MTH11, TFC_PCS_DDD_NONRETAIL.QTY_MTH12, TFC_PCS_DDD_NONRETAIL.QTY_MTH13, TFC_PCS_DDD_NONRETAIL.QTY_MTH14, TFC_PCS_DDD_NONRETAIL.QTY_MTH15, TFC_PCS_DDD_NONRETAIL.QTY_MTH16, TFC_PCS_DDD_NONRETAIL.QTY_MTH17, TFC_PCS_DDD_NONRETAIL.QTY_MTH18, TFC_PCS_DDD_NONRETAIL.QTY_MTH19, TFC_PCS_DDD_NONRETAIL.QTY_MTH20, TFC_PCS_DDD_NONRETAIL.QTY_MTH21, TFC_PCS_DDD_NONRETAIL.QTY_MTH22, TFC_PCS_DDD_NONRETAIL.QTY_MTH23, TFC_PCS_DDD_NONRETAIL.QTY_MTH24, TFC_PCS_DDD_NONRETAIL.OUTLET_NAME, TFC_PCS_DDD_NONRETAIL.OUTLET_ADDRESS, TFC_PCS_DDD_NONRETAIL.OUTLET_CITY, TFC_PCS_DDD_NONRETAIL.OUTLET_STATE, TFC_PCS_DDD_NONRETAIL.OUTLET_ZIP FROM WSMP_ADMIN.TFC_PCS_DDD_NONRETAIL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pdrp AS
SELECT d.IMS_ID AS ims_id, d.DEA_NUM AS dea_num, d.LAST_NAME AS last_name, d.FIRST_NAME AS first_name, d.MID_NAME AS mid_name, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ADDRESS ELSE d.PTR_ADDRESS END) AS address, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_CITY ELSE d.PTR_CITY END) AS city, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_STATE ELSE d.PTR_STATE END) AS state, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ZIP ELSE d.PTR_ZIP END) AS zip, npi.NPI AS npi FROM (WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d LEFT JOIN WSMP_ADMIN.STG_IMS_NPI npi ON ((d.IMS_ID = npi.IMS_ID))) WHERE ((d.PDRP_FLAG = 'Y'::char(1)) AND ((d.DEA_NUM IS NULL) OR (regexp_replace(d.DEA_NUM, '[0-9]'::varchar(5), ''::varchar, 1, 0, ''::varchar) IS NOT NULL)) AND ((d.DEA_NUM IS NOT NULL) OR (npi.NPI IS NOT NULL))) GROUP BY d.IMS_ID, d.DEA_NUM, d.LAST_NAME, d.FIRST_NAME, d.MID_NAME, upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ADDRESS ELSE d.PTR_ADDRESS END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_CITY ELSE d.PTR_CITY END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_STATE ELSE d.PTR_STATE END), upper(CASE WHEN (d.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)])) THEN d.COMP_ZIP ELSE d.PTR_ZIP END), npi.NPI;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_extract_backup AS
SELECT coalesce(r.VEEVA_ACCOUNT_ID, r.IMS_ID) AS account_id, r.ENROLLMENT_ID AS enrollment_id, r.NPI AS npi, r.DEA_NUM AS dea_num, r.PROGRAM_ID AS program_id, substr(r.PROGRAM_NAME, 1, 4) AS REMS_PROGRAM, r.STATUS AS enrollment_status, r.IN_PROGRESS_STEP AS current_enrollment_step, to_char(r.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(r.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT coalesce(STG_REMS_FACILITY.VEEVA_ACCOUNT_ID, STG_REMS_FACILITY.ASI_ACCOUNT_ID) AS account_id, STG_REMS_FACILITY.ENROLLMENT_ID AS enrollment_id, STG_REMS_FACILITY.NPI AS npi, STG_REMS_FACILITY.DEA AS dea, STG_REMS_FACILITY.PROGRAM_ID AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS REMS_program, STG_REMS_FACILITY.STATUS_DESCRIPTION AS enrollment_status, STG_REMS_FACILITY.IN_PROGRESS_STEP AS current_enrollment_step, to_char(STG_REMS_FACILITY.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(STG_REMS_FACILITY.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_program_lookup_backup AS
SELECT r.PROGRAM_ID AS program_id, r.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT stg_rems_facility.PROGRAM_ID AS program_id, stg_rems_facility.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_TC_Physician_Univ AS
SELECT npi.NPI AS npi, dc.dea_num, upper(dc.last_name) AS last_name, upper(dc.first_name) AS first_name, upper(dc.mid_name) AS middle_name, upper(dc.address) AS address, upper(dc.city) AS city, dc.state, dc.zip FROM WSMP_ADMIN.demo_combined dc, WSMP_ADMIN.STG_IMS_NPI npi WHERE (((dc.ims_id IS NOT NULL) OR (dc.dea_num IS NOT NULL)) AND (dc.ims_id = npi.IMS_ID) AND (dc.sales_force_id = 'TC'::varchar(2)) AND ((npi.NPI, dc.territory_num) IN (SELECT n.NPI AS npi, min(d.territory_num) AS min FROM WSMP_ADMIN.STG_IMS_NPI n, WSMP_ADMIN.demo_combined d WHERE ((d.sales_force_id = 'TC'::varchar(2)) AND (n.IMS_ID = d.ims_id)) GROUP BY n.NPI)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_TP_Physician_Univ AS
SELECT npi.NPI AS npi, dc.dea_num, upper(dc.last_name) AS last_name, upper(dc.first_name) AS first_name, upper(dc.mid_name) AS middle_name, upper(dc.address) AS address, upper(dc.city) AS city, dc.state, dc.zip FROM WSMP_ADMIN.demo_combined dc, WSMP_ADMIN.STG_IMS_NPI npi WHERE (((dc.ims_id IS NOT NULL) OR (dc.dea_num IS NOT NULL)) AND (dc.ims_id = npi.IMS_ID) AND (dc.sales_force_id = 'TP'::varchar(2)) AND ((npi.NPI, dc.territory_num) IN (SELECT n.NPI AS npi, min(d.territory_num) AS min FROM WSMP_ADMIN.STG_IMS_NPI n, WSMP_ADMIN.demo_combined d WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (n.IMS_ID = d.ims_id)) GROUP BY n.NPI)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_zs_tr_calls_obw AS
SELECT c.SALES_FORCE_ID AS sales_force_id, c.TERRITORY_NUM AS territory_num, c.VEEVA_ACCOUNT_ID AS veeva_account_id, c.IMS_ID AS ims_id, c.CALL_DATE AS call_date, cd1.PRODUCT AS first_product_detailed, cd2.PRODUCT AS second_product_detailed, cd3.PRODUCT AS third_product_detailed, cd4.PRODUCT AS fourth_product_detailed FROM ((((WSMP_ADMIN.DW_CALL c LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd1 ON (((c.DW_CALL_KEY = cd1.DW_CALL_KEY) AND (cd1.DETAIL_POSITION = 1::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd2 ON (((c.DW_CALL_KEY = cd2.DW_CALL_KEY) AND (cd2.DETAIL_POSITION = 2::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd3 ON (((c.DW_CALL_KEY = cd3.DW_CALL_KEY) AND (cd3.DETAIL_POSITION = 3::numeric(18,0))))) LEFT JOIN WSMP_ADMIN.DW_CALL_DETAIL cd4 ON (((c.DW_CALL_KEY = cd4.DW_CALL_KEY) AND (cd4.DETAIL_POSITION = 4::numeric(18,0))))) WHERE ((c.SALES_FORCE_ID = 'TR'::varchar(2)) AND (c.CALL_DATE > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)) AND (c.CALL_DATE <= (trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float)) AND (c.VEEVA_ACCOUNT_ID IN (SELECT vv_account.ID AS id FROM WSMP_ADMIN.VV_ACCOUNT WHERE (vv_account.ISPERSONACCOUNT = 'true'::varchar(4)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_debarred_with_veevaid AS
SELECT dnc.SALES_FORCE_ID AS sales_force_id, sln.veeva_id, sln.state_license_number, coalesce(dea.DEA_NUM, x.ID_NUM) AS dea_num FROM (((WSMP_ADMIN.DIM_DNC dnc LEFT JOIN (SELECT acc.ID AS veeva_id, acc.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM (((((WSMP_ADMIN.VV_ACCOUNT acc JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acc.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acc.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_TSF_VOD__C tsf ON (((tsf.ACCOUNT_VOD__C = acc.ID) AND (tsf.TERRITORY_VOD__C = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acc.ID) AND (tsf.ADDRESS_VOD__C = addr.ID)))) WHERE ((g.DEVELOPERNAME ~~ 'TC%'::varchar(3)) AND (addr.LICENSE_VOD__C IS NOT NULL))) sln ON ((dnc.IMS_ID = sln.ims_id))) LEFT JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((dnc.IMS_ID = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF x ON (((dnc.CM_ID = x.CM_ID) AND (x.ID_TYPE = 'DEA_NUM'::varchar(7))))) WHERE ((dnc.DEBARRED = 'Y'::varchar(1)) AND (dnc.SALES_FORCE_ID = 'TC'::varchar(2)) AND ((dea.DEA_NUM IS NOT NULL) OR (sln.state_license_number IS NOT NULL))) GROUP BY dnc.SALES_FORCE_ID, sln.veeva_id, sln.state_license_number, coalesce(dea.DEA_NUM, x.ID_NUM);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_do_not_promote_with_veevaid_backup AS
(SELECT d.SALES_FORCE_ID AS sales_force_id, acct.ID AS veeva_id, sln.state_license_number, dea.DEA_NUM AS dea_num, d.PRODUCT_NAME AS product_name, d.SPECIALTY_GROUP AS specialty_group, 'N'::varchar(1) AS app FROM (((WSMP_ADMIN.DIM_DNC d JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((d.IMS_ID = dea.IMS_ID))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (d.SALES_FORCE_ID = sln.sales_force_id)))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) UNION SELECT 'TC'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.DEA_NUM AS dea_num, 'NUVIGIL'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((acct.ID_VOD__C = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.NUVIGIL_APP_TVA__C = 'true'::varchar(4))) UNION SELECT 'TP'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.DEA_NUM AS dea_num, 'FENTORA'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.STG_IMS_DEA dea ON ((acct.ID_VOD__C = dea.IMS_ID))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.FENTORA_APP_TVA__C = 'true'::varchar(4));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_rx AS
SELECT rx.STATION_NUMBER, rx.VA_PRODUCT, 0 AS PRODUCT_ID, rx.PRODUCT_CODE, to_char(rx.MONTH, 'YYYY-MM-DD'::varchar(10)) AS MONTH, CASE mod(rx.TRX_CNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.TRX_CNT)::int)::varchar ELSE rtrim((rx.TRX_CNT)::varchar, '0'::varchar(1)) END AS TRX_CNT, CASE mod(rx.CMOP_CNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CMOP_CNT)::int)::varchar ELSE rtrim((rx.CMOP_CNT)::varchar, '0'::varchar(1)) END AS CMOP_CNT, CASE mod(rx.TRX_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.TRX_QTY)::int)::varchar ELSE rtrim((rx.TRX_QTY)::varchar, '0'::varchar(1)) END AS TRX_QTY, CASE mod(rx.CMOP_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CMOP_QTY)::int)::varchar ELSE rtrim((rx.CMOP_QTY)::varchar, '0'::varchar(1)) END AS CMOP_QTY, CASE mod(rx.CNT_30_DAY_RX, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.CNT_30_DAY_RX)::int)::varchar ELSE rtrim((rx.CNT_30_DAY_RX)::varchar, '0'::varchar(1)) END AS CNT_30_DAY_RX, rx.ID FROM (WSMP_ADMIN.DW_CMOP_RX_TEVA rx JOIN (SELECT dim_va_product_xref.WK_PROD_CODE AS wk_prod_code FROM CUSTOMER.DIM_VA_PRODUCT_XREF GROUP BY dim_va_product_xref.WK_PROD_CODE) p ON ((rx.PRODUCT_CODE = p.wk_prod_code)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_program AS
SELECT DIM_ASI_PROGRAM.REDEMPTION_TYPE, DIM_ASI_PROGRAM.ASI_PROGRAM_NUM, DIM_ASI_PROGRAM.PROGRAM_DESC, DIM_ASI_PROGRAM.SALES_FORCE_ID, DIM_ASI_PROGRAM.PROGRAM_TYPE, DIM_ASI_PROGRAM.PRODUCT_NAME, to_char(DIM_ASI_PROGRAM.PROGRAM_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_START_DATE, to_char(DIM_ASI_PROGRAM.PROGRAM_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_END_DATE, (DIM_ASI_PROGRAM.NUMBER_OF_TABLETS)::int AS NUMBER_OF_TABLETS FROM WSMP_ADMIN.DIM_ASI_PROGRAM;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_copay_voucher_redemption AS
SELECT coalesce(TFC_ASI_COPAY_DETAIL_WKLY.VEEVA_ACCOUNT_ID, TFC_ASI_COPAY_DETAIL_WKLY.IMS_ID) AS veeva_account_id, TFC_ASI_COPAY_DETAIL_WKLY.IMS_ID AS ims_id, TFC_ASI_COPAY_DETAIL_WKLY.REDEMPTION_TYPE AS redemption_type, to_char(TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(TFC_ASI_COPAY_DETAIL_WKLY.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.DAYS_SUPPLY)::varchar, '0'::varchar(1)) END AS days_supply, TFC_ASI_COPAY_DETAIL_WKLY.NDC_CODE AS ndc_code, TFC_ASI_COPAY_DETAIL_WKLY.BRAND_NAME AS brand_name, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.QTY)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.QTY)::varchar, '0'::varchar(1)) END AS qty, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.REFILLS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.REFILLS)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.REFILLS)::varchar, '0'::varchar(1)) END AS refills, TFC_ASI_COPAY_DETAIL_WKLY.PROGRAM_NUM AS program_num, TFC_ASI_COPAY_DETAIL_WKLY.COPAY_CARD_NUM AS copay_voucher_num, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CHAIN AS pharmacy_chain, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NAME AS pharmacy_name, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS AS pharmacy_address, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ADDRESS2 AS pharmacy_address2, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_CITY AS pharmacy_city, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_STATE AS pharmacy_state, TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_ZIP AS pharmacy_zip, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_NPI_NUM)::varchar, '0'::varchar(1)) END AS pharmacy_npi_num, NULL AS ceph_id, TFC_ASI_COPAY_DETAIL_WKLY.ME_NUM AS me_num, TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_DEA_NUM AS principle_phys_dea_num, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PRINCIPLE_PHYS_NPI_NUM)::varchar, '0'::varchar(1)) END AS principle_phys_npi_num, TFC_ASI_COPAY_DETAIL_WKLY.PHYSICIAN_NAME AS physician_name, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS1 AS physician_address1, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ADDRESS2 AS physician_address2, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_CITY AS physician_city, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_STATE AS physician_state, TFC_ASI_COPAY_DETAIL_WKLY.ASI_PHYS_ZIP AS physician_zip, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.REBATE_AMOUNT)::varchar, '0'::varchar(1)) END AS rebate_amount, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::varchar, '0'::varchar(1)) END AS member_cash_expense, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.SUBMITTED_COST)::varchar, '0'::varchar(1)) END AS submitted_cost, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.PHARMACY_FEE)::varchar, '0'::varchar(1)) END AS pharmacy_fee, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::varchar, '0'::varchar(1)) END AS total_amount_due, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.CALC_AWP)::varchar, '0'::varchar(1)) END AS calc_awp, TFC_ASI_COPAY_DETAIL_WKLY.OCC_PAYMENT_TYPE AS occ_payment_type, CASE mod(TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL)::int)::varchar ELSE rtrim((TFC_ASI_COPAY_DETAIL_WKLY.NEW_REFILL)::varchar, '0'::varchar(1)) END AS new_refill FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY WHERE ((TFC_ASI_COPAY_DETAIL_WKLY.BRAND_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE < (statement_timestamp())::timestamp) AND (TFC_ASI_COPAY_DETAIL_WKLY.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, TFC_ASI_COPAY_DETAIL_WKLY.FILL_DATE) <= 25::float)) UNION ALL SELECT coalesce(TFC_ASI_REDEMPTION_DETAIL_WKLY.VEEVA_ACCOUNT_ID, TFC_ASI_REDEMPTION_DETAIL_WKLY.IMS_ID) AS veeva_account_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.IMS_ID AS ims_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.REDEMPTION_TYPE AS redemption_type, to_char(TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, to_char(TFC_ASI_REDEMPTION_DETAIL_WKLY.HCP_DATE_WRITTEN, 'YYYY-MM-DD'::varchar(10)) AS hcp_date_written, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.DAYS_SUPPLY)::varchar, '0'::varchar(1)) END AS days_supply, TFC_ASI_REDEMPTION_DETAIL_WKLY.NDC_CODE AS ndc_code, TFC_ASI_REDEMPTION_DETAIL_WKLY.PRODUCT_NAME AS brand_name, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.QTY)::varchar, '0'::varchar(1)) END AS qty, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.REFILLS)::varchar, '0'::varchar(1)) END AS refills, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROGRAM_NUM AS program_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.VOUCHER_NUM AS copay_voucher_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CHAIN_NUM AS pharmacy_chain_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CHAIN AS pharmacy_chain, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NAME AS pharmacy_name, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_ADDRESS AS pharmacy_address, NULL AS pharmacy_address2, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_CITY AS pharmacy_city, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_STATE AS pharmacy_state, TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_ZIP AS pharmacy_zip, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_NPI_NUM)::varchar, '0'::varchar(1)) END AS pharmacy_npi_num, NULL AS ceph_id, TFC_ASI_REDEMPTION_DETAIL_WKLY.ME_NUM AS me_num, TFC_ASI_REDEMPTION_DETAIL_WKLY.DEA_NUM AS dea_num, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.NPI)::varchar, '0'::varchar(1)) END AS npi, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_NAME AS provider_name, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_ADDRESS AS provider_address, NULL AS physician_address2, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_CITY AS provider_city, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_STATE AS provider_state, TFC_ASI_REDEMPTION_DETAIL_WKLY.PROVIDER_ZIP AS provider_zip, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.REBATE_AMOUNT)::varchar, '0'::varchar(1)) END AS rebate_amount, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.MEMBER_CASH_EXPENSE)::varchar, '0'::varchar(1)) END AS member_cash_expense, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.SUBMITTED_COST)::varchar, '0'::varchar(1)) END AS submitted_cost, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.PHARMACY_FEE)::varchar, '0'::varchar(1)) END AS pharmacy_fee, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.TOTAL_AMOUNT_DUE)::varchar, '0'::varchar(1)) END AS total_amount_due, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.CALC_AWP)::varchar, '0'::varchar(1)) END AS calc_awp, NULL AS occ_payment_type, CASE mod(TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL)::int)::varchar ELSE rtrim((TFC_ASI_REDEMPTION_DETAIL_WKLY.NEW_REFILL)::varchar, '0'::varchar(1)) END AS new_refill FROM WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY WHERE ((TFC_ASI_REDEMPTION_DETAIL_WKLY.PRODUCT_NAME = ANY (ARRAY['NUVIGIL'::varchar(7), 'FENTORA'::varchar(7), 'AMRIX'::varchar(5), 'ADIPEX-P'::varchar(8), 'TEV-TROPIN'::varchar(10), 'AZILECT'::varchar(7), 'QUARTETTE'::varchar(9)])) AND (TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE < (statement_timestamp())::timestamp) AND (TFC_ASI_REDEMPTION_DETAIL_WKLY.HCP_DATE_WRITTEN < (statement_timestamp())::timestamp) AND (months_between((statement_timestamp())::timestamp, TFC_ASI_REDEMPTION_DETAIL_WKLY.FILL_DATE) <= 25::float));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rxnormalizationControl2014 AS
SELECT p.IMS_CLIENT_NUM_W AS ClientNo, p.IMS_REPORT_NUM_W_CNT AS RxReportNo, lpad(p.IMS_PRODUCT_GROUP_NUM, 9, '0'::varchar(1)) AS ProductGroupNo, p.IMS_REPORT_NUM_W_QTY AS CorrespondingUnitsReportNo, p.PRODUCT_NAME AS ProductGroupName, CASE mod(nf.DIVISOR, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((nf.DIVISOR)::int)::varchar ELSE rtrim((nf.DIVISOR)::varchar, '0'::varchar(1)) END AS Divisor, CASE mod(nf.MULTIPLIER, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((nf.MULTIPLIER)::int)::varchar ELSE rtrim((nf.MULTIPLIER)::varchar, '0'::varchar(1)) END AS Multiplier FROM (WSMP_ADMIN.DRM45_PRODUCT_2014 p JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_SP_Programs AS
SELECT p.EVENT_NUMBER, p.PARENT_EVENT_NUMBER, p.EVENT_NAME, p.EVENT_STATUS_CODE, p.EVENT_STATUS_DESCRIPTION, to_char(p.EVENT_STATUS_CHANGE_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_STATUS_CHANGE_DATE, to_char(p.EVENT_START_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_START_DATE, to_char(p.EVENT_END_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_END_DATE, p.EVENT_TIME_ZONE, p.FUNDING_SOURCE, p.EVENT_TYPE, p.EVENT_TYPE_DESCRIPTION, p.EVENT_FORMAT, p.EVENT_LOCATION, to_char(p.PENDING_MGMNT_APPROVAL_DATE, 'YYYY-MM-DD'::varchar(10)) AS PENDING_MGMNT_APPROVAL_DATE, to_char(p.EVENT_APPROVAL_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_APPROVAL_DATE, p.EVENT_APPROVER_ID, to_char(p.EVENT_SCHEDULE_DATE, 'YYYY-MM-DD'::varchar(10)) AS EVENT_SCHEDULE_DATE, to_char(p.ATTENDEE_CLOSEOUT_DATE, 'YYYY-MM-DD'::varchar(10)) AS ATTENDEE_CLOSEOUT_DATE, to_char(p.FINANCIAL_CLOSEOUT_DATE, 'YYYY-MM-DD'::varchar(10)) AS FINANCIAL_CLOSEOUT_DATE, to_char(p.CANCELLATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS CANCELLATION_DATE, p.CANCELLATION_REASON, p.CANCELLATION_SOURCE, p.EVENT_VENUE_MIN_CNT_REQ_IND, p.EVENT_VENUE_MIN_COUNT, p.ESTIMATED_ATTENDANCE, p.VENUE_ID, p.VENUE_FULL_NAME, p.VENUE_ADDRESS_LINE_1, p.VENUE_ADDRESS_LINE_2, p.VENUE_ADDRESS_LINE_3, p.VENUE_ADDRESS_LINE_4, p.VENUE_CITY, p.VENUE_STATE_PROVINCE, p.VENUE_POSTAL_CODE, p.VENUE_POSTAL_EXTENDED_CODE, p.VENUE_COUNTRY_CODE, p.VENUE_CONTACT, p.VENUE_PHONE, p.VENUE_FAX, p.VENUE_EMAIL, p.TRADE_SECRET_INDICATOR, p.TRADE_SECRET_REASON, p.CUSTOM_FIELD_1, p.CUSTOM_FIELD_2, p.CUSTOM_FIELD_3, p.CUSTOM_FIELD_4, p.CUSTOM_FIELD_5, p.REC_STAT_CD, e.PAYMENT_ID AS payment_id, e.EXPENSE_CATEGORY AS expense_category, CASE mod(e.AMOUNT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((e.AMOUNT)::int)::varchar ELSE rtrim((e.AMOUNT)::varchar, '0'::varchar(1)) END AS amount FROM (WSMP_ADMIN.STG_AHM_EVENT p LEFT JOIN WSMP_ADMIN.STG_AHM_EVENT_EXPENSE e ON ((e.EVENT_NUMBER = p.EVENT_NUMBER)));

CREATE  VIEW teva_ingestion.MS_MTHLY_RX_QTY AS
SELECT CASE WHEN (MS_MTHLY_RX_QTY_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_MTHLY_RX_QTY_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_report_num))::int END AS ims_report_num, btrim(MS_MTHLY_RX_QTY_src.zip_other) AS zip_other, btrim(MS_MTHLY_RX_QTY_src.ims_id) AS ims_id, btrim(MS_MTHLY_RX_QTY_src.ndc) AS ndc, btrim(MS_MTHLY_RX_QTY_src.plan_id) AS plan_id, CASE WHEN (MS_MTHLY_RX_QTY_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.sales_category))::int END AS sales_category, btrim(MS_MTHLY_RX_QTY_src.rx_type) AS rx_type, CASE WHEN (MS_MTHLY_RX_QTY_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_MTHLY_RX_QTY_src.filler_01) AS filler_01, btrim(MS_MTHLY_RX_QTY_src.me_num) AS me_num, btrim(MS_MTHLY_RX_QTY_src.last_name) AS last_name, btrim(MS_MTHLY_RX_QTY_src.first_name) AS first_name, btrim(MS_MTHLY_RX_QTY_src.middle_name) AS middle_name, btrim(MS_MTHLY_RX_QTY_src.address) AS address, btrim(MS_MTHLY_RX_QTY_src.city) AS city, btrim(MS_MTHLY_RX_QTY_src.state) AS state, btrim(MS_MTHLY_RX_QTY_src.zip) AS zip, btrim(MS_MTHLY_RX_QTY_src.specialty) AS specialty, btrim(MS_MTHLY_RX_QTY_src.plan_name) AS plan_name, btrim(MS_MTHLY_RX_QTY_src.ndc_description) AS ndc_description, btrim(MS_MTHLY_RX_QTY_src.data_date) AS data_date, CASE WHEN (MS_MTHLY_RX_QTY_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_QTY_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_MTHLY_RX_QTY_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_MTHLY_RX_QTY_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_QTY_src.trx_024))::numeric(9,3) END AS trx_024, MS_MTHLY_RX_QTY_src.batch_id, MS_MTHLY_RX_QTY_src.row_id, MS_MTHLY_RX_QTY_src.update_ts FROM teva_ingestion.MS_MTHLY_RX_QTY_src;

CREATE  VIEW teva_ingestion.MS_WKLY_RX_QTY AS
SELECT CASE WHEN (MS_WKLY_RX_QTY_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_WKLY_RX_QTY_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_report_num))::int END AS ims_report_num, btrim(MS_WKLY_RX_QTY_src.zip_other) AS zip_other, btrim(MS_WKLY_RX_QTY_src.ims_id) AS ims_id, btrim(MS_WKLY_RX_QTY_src.ndc) AS ndc, btrim(MS_WKLY_RX_QTY_src.plan_id) AS plan_id, CASE WHEN (MS_WKLY_RX_QTY_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.sales_category))::int END AS sales_category, btrim(MS_WKLY_RX_QTY_src.rx_type) AS rx_type, CASE WHEN (MS_WKLY_RX_QTY_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_WKLY_RX_QTY_src.filler_01) AS filler_01, btrim(MS_WKLY_RX_QTY_src.me_num) AS me_num, btrim(MS_WKLY_RX_QTY_src.last_name) AS last_name, btrim(MS_WKLY_RX_QTY_src.first_name) AS first_name, btrim(MS_WKLY_RX_QTY_src.middle_name) AS middle_name, btrim(MS_WKLY_RX_QTY_src.address) AS address, btrim(MS_WKLY_RX_QTY_src.city) AS city, btrim(MS_WKLY_RX_QTY_src.state) AS state, btrim(MS_WKLY_RX_QTY_src.zip) AS zip, btrim(MS_WKLY_RX_QTY_src.specialty) AS specialty, btrim(MS_WKLY_RX_QTY_src.plan_name) AS plan_name, btrim(MS_WKLY_RX_QTY_src.ndc_description) AS ndc_description, btrim(MS_WKLY_RX_QTY_src.data_date) AS data_date, CASE WHEN (MS_WKLY_RX_QTY_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_QTY_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (MS_WKLY_RX_QTY_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (MS_WKLY_RX_QTY_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_WKLY_RX_QTY_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_WKLY_RX_QTY_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_WKLY_RX_QTY_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_WKLY_RX_QTY_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_WKLY_RX_QTY_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_WKLY_RX_QTY_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_WKLY_RX_QTY_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_WKLY_RX_QTY_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_WKLY_RX_QTY_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_WKLY_RX_QTY_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_WKLY_RX_QTY_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_WKLY_RX_QTY_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_WKLY_RX_QTY_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_WKLY_RX_QTY_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_WKLY_RX_QTY_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_WKLY_RX_QTY_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_WKLY_RX_QTY_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_WKLY_RX_QTY_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_WKLY_RX_QTY_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_WKLY_RX_QTY_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_WKLY_RX_QTY_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_WKLY_RX_QTY_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_WKLY_RX_QTY_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (MS_WKLY_RX_QTY_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (MS_WKLY_RX_QTY_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (MS_WKLY_RX_QTY_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (MS_WKLY_RX_QTY_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (MS_WKLY_RX_QTY_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (MS_WKLY_RX_QTY_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (MS_WKLY_RX_QTY_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (MS_WKLY_RX_QTY_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (MS_WKLY_RX_QTY_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (MS_WKLY_RX_QTY_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (MS_WKLY_RX_QTY_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (MS_WKLY_RX_QTY_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (MS_WKLY_RX_QTY_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (MS_WKLY_RX_QTY_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (MS_WKLY_RX_QTY_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (MS_WKLY_RX_QTY_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (MS_WKLY_RX_QTY_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (MS_WKLY_RX_QTY_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (MS_WKLY_RX_QTY_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (MS_WKLY_RX_QTY_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (MS_WKLY_RX_QTY_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (MS_WKLY_RX_QTY_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (MS_WKLY_RX_QTY_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (MS_WKLY_RX_QTY_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (MS_WKLY_RX_QTY_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (MS_WKLY_RX_QTY_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (MS_WKLY_RX_QTY_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (MS_WKLY_RX_QTY_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (MS_WKLY_RX_QTY_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (MS_WKLY_RX_QTY_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (MS_WKLY_RX_QTY_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (MS_WKLY_RX_QTY_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (MS_WKLY_RX_QTY_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (MS_WKLY_RX_QTY_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (MS_WKLY_RX_QTY_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (MS_WKLY_RX_QTY_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (MS_WKLY_RX_QTY_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (MS_WKLY_RX_QTY_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (MS_WKLY_RX_QTY_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (MS_WKLY_RX_QTY_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (MS_WKLY_RX_QTY_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (MS_WKLY_RX_QTY_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (MS_WKLY_RX_QTY_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (MS_WKLY_RX_QTY_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (MS_WKLY_RX_QTY_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (MS_WKLY_RX_QTY_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (MS_WKLY_RX_QTY_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (MS_WKLY_RX_QTY_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (MS_WKLY_RX_QTY_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (MS_WKLY_RX_QTY_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (MS_WKLY_RX_QTY_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (MS_WKLY_RX_QTY_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (MS_WKLY_RX_QTY_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (MS_WKLY_RX_QTY_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (MS_WKLY_RX_QTY_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (MS_WKLY_RX_QTY_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (MS_WKLY_RX_QTY_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (MS_WKLY_RX_QTY_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (MS_WKLY_RX_QTY_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (MS_WKLY_RX_QTY_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (MS_WKLY_RX_QTY_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (MS_WKLY_RX_QTY_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (MS_WKLY_RX_QTY_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (MS_WKLY_RX_QTY_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (MS_WKLY_RX_QTY_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (MS_WKLY_RX_QTY_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (MS_WKLY_RX_QTY_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (MS_WKLY_RX_QTY_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (MS_WKLY_RX_QTY_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (MS_WKLY_RX_QTY_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (MS_WKLY_RX_QTY_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (MS_WKLY_RX_QTY_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (MS_WKLY_RX_QTY_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (MS_WKLY_RX_QTY_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (MS_WKLY_RX_QTY_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (MS_WKLY_RX_QTY_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (MS_WKLY_RX_QTY_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (MS_WKLY_RX_QTY_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (MS_WKLY_RX_QTY_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (MS_WKLY_RX_QTY_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (MS_WKLY_RX_QTY_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (MS_WKLY_RX_QTY_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (MS_WKLY_RX_QTY_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (MS_WKLY_RX_QTY_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (MS_WKLY_RX_QTY_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (MS_WKLY_RX_QTY_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (MS_WKLY_RX_QTY_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (MS_WKLY_RX_QTY_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (MS_WKLY_RX_QTY_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (MS_WKLY_RX_QTY_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (MS_WKLY_RX_QTY_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (MS_WKLY_RX_QTY_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (MS_WKLY_RX_QTY_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (MS_WKLY_RX_QTY_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (MS_WKLY_RX_QTY_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (MS_WKLY_RX_QTY_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (MS_WKLY_RX_QTY_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (MS_WKLY_RX_QTY_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (MS_WKLY_RX_QTY_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (MS_WKLY_RX_QTY_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (MS_WKLY_RX_QTY_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (MS_WKLY_RX_QTY_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (MS_WKLY_RX_QTY_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (MS_WKLY_RX_QTY_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (MS_WKLY_RX_QTY_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (MS_WKLY_RX_QTY_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (MS_WKLY_RX_QTY_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (MS_WKLY_RX_QTY_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_QTY_src.trx_132))::numeric(9,3) END AS trx_132, MS_WKLY_RX_QTY_src.batch_id, MS_WKLY_RX_QTY_src.row_id, MS_WKLY_RX_QTY_src.update_ts FROM teva_ingestion.MS_WKLY_RX_QTY_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_caremark_external_match AS
SELECT foo2.caremark_md_id AS source_key, 'CAREMARK'::varchar(8) AS source_name, 'CAREMARK'::varchar(8) AS file_name, btrim(((foo2.first_name || ' '::varchar(1)) || foo2.last_name)) AS person_name, NULL AS organization_name, 99 AS ex_sub_type, 1 AS ex_hce_type, NULL AS ex_communication_type, NULL AS ex_alt_id_value, NULL AS ex_alt_id, NULL AS ex_communication_value, foo2.state AS ex_state, foo2.zip AS ex_zip, NULL AS ex_alt_id_state, foo2.city AS ex_city, NULL AS ex_suffix, btrim(((coalesce(foo2.first_name, ''::varchar) || ' '::varchar(1)) || coalesce(foo2.last_name, ''::varchar))) AS ex_person_name, NULL AS ex_organization_name, foo2.address1 AS address_part1, foo2.address1 AS ex_address_line1, foo2.address2 AS ex_address_line2, btrim(((coalesce(foo2.address1, ''::varchar) || ' '::varchar(1)) || coalesce(foo2.address2, ''::varchar))) AS ex_address FROM (SELECT foo1.CAREMARK_MD_ID AS caremark_md_id, foo1.LAST_NAME AS last_name, foo1.FIRST_NAME AS first_name, foo1.NPI AS npi, CASE WHEN ((foo1.ADDRESS1 IS NULL) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS2 WHEN ((foo1.ADDRESS1 ~~ 'STE %'::varchar(5)) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS2 ELSE foo1.ADDRESS1 END AS address1, CASE WHEN ((foo1.ADDRESS1 IS NULL) AND (foo1.ADDRESS2 IS NOT NULL)) THEN NULL WHEN ((foo1.ADDRESS1 ~~ 'STE %'::varchar(5)) AND (foo1.ADDRESS2 IS NOT NULL)) THEN foo1.ADDRESS1 ELSE foo1.ADDRESS2 END AS address2, foo1.CITY AS city, foo1.STATE AS state, foo1.ZIP AS zip, foo1.oldest_ship_date, foo1.SHIP_DATE AS current_ship_date, foo1.how_many_rows FROM (SELECT c.CAREMARK_MD_ID, c.LAST_NAME, c.FIRST_NAME, c.NPI, c.ADDRESS1, c.ADDRESS2, c.CITY, c.STATE, c.ZIP, c.PRODUCT_NDC, c.SHIP_DATE, c.QTY, c.IMS_ID, c.IMS_ID_VIA, c.LAST_BUILD_DATE, c.PRODUCT_CODE, c.TRX_CNT, c.IMS_PRODUCT_GROUP_NUM, row_number() OVER (PARTITION BY c.CAREMARK_MD_ID ORDER BY c.SHIP_DATE DESC) AS rnk, count(1) OVER (PARTITION BY c.CAREMARK_MD_ID) AS how_many_rows, min(c.SHIP_DATE) OVER (PARTITION BY c.CAREMARK_MD_ID) AS oldest_ship_date FROM WSMP_ADMIN.STG_CAREMARK_RX c WHERE ((c.IMS_ID IS NULL) AND (c.LAST_NAME <> 'UNAVAILABLE'::varchar(11)) AND ((c.ADDRESS1 IS NOT NULL) OR (c.ADDRESS2 IS NOT NULL)))) foo1 WHERE (foo1.rnk = 1)) foo2 ORDER BY foo2.caremark_md_id;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ftf_ims_monthly_market_obm AS
SELECT substr(rx.payer_plan_num, 1, 6) AS "PLAN ID", rx.plan_name AS "PLAN NAME", substr(rx.payer_plan_num, ((length(rx.payer_plan_num) - 4) + 1), 4) AS "PAYER ID", rx.payer_name AS "PAYER NAME", rx.market_name AS "MARKET NAME", rx.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx WHERE (rx.market_name = ANY (ARRAY['ANTI-PARKINSON'::varchar(14), 'BDP NASAL'::varchar(9), 'ICS'::varchar(3), 'MULTIPLE SCLEROSIS'::varchar(18), 'SABA'::varchar(4), 'WAKE'::varchar(4)])) GROUP BY rx.payer_plan_num, rx.plan_name, rx.payer_name, rx.market_name, rx.product_name, rx.zip, rx.month_ending;

CREATE  VIEW metadata.outbound_table_counts AS
SELECT A.outbound_table, A.counts FROM ((((((((((((((((((((((((SELECT 'datamart.v_ob_asi_market_access'::varchar(31) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_market_access GROUP BY 'datamart.v_ob_asi_market_access'::varchar(31) UNION ALL SELECT 'datamart.v_ob_asi_rems_extract'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rems_extract GROUP BY 'datamart.v_ob_asi_rems_extract'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_asi_rems_programs'::varchar(31) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rems_programs GROUP BY 'datamart.v_ob_asi_rems_programs'::varchar(31)) UNION ALL SELECT 'datamart.v_ob_asi_rx_by_market'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_rx_by_market GROUP BY 'datamart.v_ob_asi_rx_by_market'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_asi_survey_data'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_asi_survey_data GROUP BY 'datamart.v_ob_asi_survey_data'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_axiom_market'::varchar(26) AS outbound_table, count(*) AS counts FROM datamart.v_ob_axiom_market GROUP BY 'datamart.v_ob_axiom_market'::varchar(26)) UNION ALL SELECT 'datamart.v_ob_axiom_product_totals'::varchar(34) AS outbound_table, count(*) AS counts FROM datamart.v_ob_axiom_product_totals GROUP BY 'datamart.v_ob_axiom_product_totals'::varchar(34)) UNION ALL SELECT 'datamart.v_ob_kc_copay_voucher_program'::varchar(38) AS outbound_table, count(*) AS counts FROM datamart.v_ob_kc_copay_voucher_program GROUP BY 'datamart.v_ob_kc_copay_voucher_program'::varchar(38)) UNION ALL SELECT 'datamart.v_ob_kc_copay_voucher_redemption'::varchar(41) AS outbound_table, count(*) AS counts FROM datamart.v_ob_kc_copay_voucher_redemption GROUP BY 'datamart.v_ob_kc_copay_voucher_redemption'::varchar(41)) UNION ALL SELECT 'datamart.v_ob_touchpoint_call'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_touchpoint_call GROUP BY 'datamart.v_ob_touchpoint_call'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_zs_agile_copay_redemptions'::varchar(40) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_copay_redemptions GROUP BY 'datamart.v_ob_zs_agile_copay_redemptions'::varchar(40)) UNION ALL SELECT 'datamart.v_ob_zs_agile_copay_voucher_drops'::varchar(42) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_copay_voucher_drops GROUP BY 'datamart.v_ob_zs_agile_copay_voucher_drops'::varchar(42)) UNION ALL SELECT 'datamart.v_ob_zs_agile_demographics'::varchar(35) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_demographics GROUP BY 'datamart.v_ob_zs_agile_demographics'::varchar(35)) UNION ALL SELECT 'datamart.v_ob_zs_agile_details'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_details GROUP BY 'datamart.v_ob_zs_agile_details'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_zs_agile_rx'::varchar(25) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_rx GROUP BY 'datamart.v_ob_zs_agile_rx'::varchar(25)) UNION ALL SELECT 'datamart.v_ob_zs_agile_samples'::varchar(30) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_samples GROUP BY 'datamart.v_ob_zs_agile_samples'::varchar(30)) UNION ALL SELECT 'datamart.v_ob_zs_agile_sp_attendees'::varchar(35) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_sp_attendees GROUP BY 'datamart.v_ob_zs_agile_sp_attendees'::varchar(35)) UNION ALL SELECT 'datamart.v_ob_zs_agile_sp_programs'::varchar(34) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_sp_programs GROUP BY 'datamart.v_ob_zs_agile_sp_programs'::varchar(34)) UNION ALL SELECT 'datamart.v_ob_zs_agile_voucher_redemptions'::varchar(42) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_agile_voucher_redemptions GROUP BY 'datamart.v_ob_zs_agile_voucher_redemptions'::varchar(42)) UNION ALL SELECT 'datamart.v_ob_zs_ic_ims_zip_list'::varchar(32) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_ims_zip_list GROUP BY 'datamart.v_ob_zs_ic_ims_zip_list'::varchar(32)) UNION ALL SELECT 'datamart.v_ob_zs_ic_medicaid_plan_groups'::varchar(40) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_medicaid_plan_groups GROUP BY 'datamart.v_ob_zs_ic_medicaid_plan_groups'::varchar(40)) UNION ALL SELECT 'datamart.v_ob_zs_ic_mop'::varchar(23) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_ic_mop GROUP BY 'datamart.v_ob_zs_ic_mop'::varchar(23)) UNION ALL SELECT 'datamart.v_ob_zs_tr_calls_obw'::varchar(29) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_calls_obw GROUP BY 'datamart.v_ob_zs_tr_calls_obw'::varchar(29)) UNION ALL SELECT 'datamart.v_ob_zs_tr_demographics'::varchar(32) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_demographics GROUP BY 'datamart.v_ob_zs_tr_demographics'::varchar(32)) UNION ALL SELECT 'datamart.v_ob_zs_tr_launch_analytics'::varchar(36) AS outbound_table, count(*) AS counts FROM datamart.v_ob_zs_tr_launch_analytics GROUP BY 'datamart.v_ob_zs_tr_launch_analytics'::varchar(36)) A;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales AS
SELECT clozapine_sales.transaction_id AS TRANSACTION_ID, to_char(clozapine_sales.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, clozapine_sales.product_brand AS PRODUCT_BRAND, clozapine_sales.product_ndc AS PRODUCT_NDC, clozapine_sales.product_desc AS PRODUCT_DESC, clozapine_sales.invoice_qty AS INVOICE_QTY, clozapine_sales.invoice_units AS INVOICE_UNITS, clozapine_sales.invoice_cost AS INVOICE_COST, clozapine_sales.invoice_pack_cost AS INVOICE_PACK_COST, clozapine_sales.invoice_unit_cost AS INVOICE_UNIT_COST, clozapine_sales.contract_pack_cost AS CONTRACT_PACK_COST, clozapine_sales.contract_purchases AS CONTRACT_PURCHASES, clozapine_sales.contract_number AS CONTRACT_NUMBER, clozapine_sales.dispensing_location AS DISPENSING_LOCATION, clozapine_sales.dl_address_1 AS DL_ADDRESS_1, clozapine_sales.dl_address_2 AS DL_ADDRESS_2, clozapine_sales.dl_city AS DL_CITY, clozapine_sales.dl_state AS DL_STATE, clozapine_sales.dl_zip AS DL_ZIP, clozapine_sales.dl_dea_number AS DL_DEA_NUMBER, clozapine_sales.depot_location AS DEPOT_LOCATION, clozapine_sales.dep_address_1 AS DEP_ADDRESS_1, clozapine_sales.dep_address_2 AS DEP_ADDRESS_2, clozapine_sales.dep_city AS DEP_CITY, clozapine_sales.dep_state AS DEP_STATE, clozapine_sales.dep_zip AS DEP_ZIP, clozapine_sales.dep_dea_number AS DEP_DEA_NUMBER, clozapine_sales.unit_ap AS UNIT_AP, clozapine_sales.ap AS AP FROM datamart.clozapine_sales WHERE (clozapine_sales.data_source = 'Anda'::varchar(4));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_AHM_Sales_Roster AS
SELECT AHM_SALE_FORCE_ROSTER.EMPLOYEE_ID AS employee_id, AHM_SALE_FORCE_ROSTER.USERNAME AS username, CASE AHM_SALE_FORCE_ROSTER.LAST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.LAST_NAME END AS last_name, CASE AHM_SALE_FORCE_ROSTER.FIRST_NAME WHEN NULLSEQUAL 'Vacant'::varchar(6) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.FIRST_NAME END AS first_name, AHM_SALE_FORCE_ROSTER.MIDDLE_NAME AS middle_name, AHM_SALE_FORCE_ROSTER.SALUTATION AS salutation, AHM_SALE_FORCE_ROSTER.SUFFIX AS suffix, AHM_SALE_FORCE_ROSTER.TITLE AS title, AHM_SALE_FORCE_ROSTER.TERRITORY AS territory, AHM_SALE_FORCE_ROSTER.TERRITORY_NAME AS territory_name, CASE WHEN (substr(AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY, 3, 4) = 'ZZZZ'::varchar(4)) THEN NULL WHEN (AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY = 'TOFRMZ00'::varchar(8)) THEN NULL WHEN (AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY = 'TOSCGZ00'::varchar(8)) THEN NULL ELSE AHM_SALE_FORCE_ROSTER.MANAGER_TERRITORY END AS manager_territory, AHM_SALE_FORCE_ROSTER.TEAM AS team, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_1_ADDR AS business_line_1_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_2_ADDR AS business_line_2_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_LINE_3_ADDR AS business_line_3_addr, AHM_SALE_FORCE_ROSTER.BUSINESS_CITY AS business_city, AHM_SALE_FORCE_ROSTER.BUSINESS_STATE AS business_state, AHM_SALE_FORCE_ROSTER.BUSINESS_POSTAL_CODE AS business_postal_code, AHM_SALE_FORCE_ROSTER.BUSINESS_COUNTRY_CODE AS business_country_code, AHM_SALE_FORCE_ROSTER.HOME_LINE_1_ADDR AS home_line_1_addr, AHM_SALE_FORCE_ROSTER.HOME_LINE_2_ADDR AS home_line_2_addr, AHM_SALE_FORCE_ROSTER.HOME_LINE_3_ADDR AS home_line_3_addr, AHM_SALE_FORCE_ROSTER.HOME_CITY AS home_city, AHM_SALE_FORCE_ROSTER.HOME_STATE AS home_state, AHM_SALE_FORCE_ROSTER.HOME_POSTAL_CODE AS home_postal_code, AHM_SALE_FORCE_ROSTER.HOME_COUNTRY_CODE AS home_country_code, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_ADDRESS AS correspondence_address, AHM_SALE_FORCE_ROSTER.BUSINESS_PHONE AS business_phone, AHM_SALE_FORCE_ROSTER.BUSINESS_PHONE_EXTENSION AS business_phone_extension, AHM_SALE_FORCE_ROSTER.BUSINESS_FAX AS business_fax, AHM_SALE_FORCE_ROSTER.VOICE_MAIL AS voice_mail, AHM_SALE_FORCE_ROSTER.MOBILE_PHONE AS mobile_phone, AHM_SALE_FORCE_ROSTER.HOME_PHONE AS home_phone, AHM_SALE_FORCE_ROSTER.HOME_FAX AS home_fax, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_PHONE AS correspondence_phone, AHM_SALE_FORCE_ROSTER.BUSINESS_EMAIL AS business_email, AHM_SALE_FORCE_ROSTER.HOME_EMAIL AS home_email, AHM_SALE_FORCE_ROSTER.CORRESPONDENCE_EMAIL AS correspondence_email, AHM_SALE_FORCE_ROSTER.COST_CENTER AS cost_center FROM WSMP_ADMIN.AHM_SALE_FORCE_ROSTER WHERE ((AHM_SALE_FORCE_ROSTER.TERRITORY !~~ '%ZZZZ%'::varchar(6)) AND (AHM_SALE_FORCE_ROSTER.TEAM <> ALL (ARRAY['Teva Clin Nurse Educ'::varchar(20), 'Field Medical Affairs'::varchar(21), 'Clinical Nurse Educator'::varchar(23)])));

CREATE  VIEW outbound.zzz_azilect_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_azilect_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_fentora_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_fentora_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_kc_copay_voucher_program AS
SELECT c.redemption_type, c.program_number, c.program_description, c.sales_force_id, c.program_type, c.product_name, to_char(c.program_start_date, 'YYYY-MM-DD'::varchar(10)) AS program_start_date, to_char(c.program_end_date, 'YYYY-MM-DD'::varchar(10)) AS program_end_date, c.number_of_tablets FROM reference.copay_voucher_program c;

CREATE  VIEW outbound.zzz_nuvigil_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_nuvigil_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.zzz_asi_survey_data AS
(( SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(sqr_main.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        CASE WHEN ((s.name = ANY (ARRAY['Pharmacy Survey'::varchar(34), 'Respiratory - RespiClick Readiness'::varchar(34)])) AND (q.order_vod__c = ANY (ARRAY[0::numeric(18,0), 1::numeric(18,0), 2::numeric(18,0)]))) THEN (concat(((q.order_vod__c + 1::numeric(18,0)))::varchar, '. '::varchar(2)) || sqr_main.question_text_vod__c) WHEN ((s.name = ANY (ARRAY['Pharmacy Survey'::varchar(34), 'Respiratory - RespiClick Readiness'::varchar(34)])) AND (q.order_vod__c <> ALL (ARRAY[0::numeric(18,0), 1::numeric(18,0), 2::numeric(18,0)]))) THEN ('. '::varchar(2) || sqr_main.question_text_vod__c) ELSE sqr_main.question_text_vod__c END AS question,
        sqr_main.response AS answer,
        to_char(sqr_main.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(sqr_main.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY t.account_vod__c, q.id, sqr_main.response ORDER BY sqr_main.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr4.createddate,
        sqr4.lastmodifieddate,
        sqr4.survey_target_vod__c,
        sqr4.survey_question_vod__c,
        sqr4.question_text_vod__c,
        response.response
 FROM (( SELECT sqr3.id,
        sqr3.createddate,
        sqr3.lastmodifieddate,
        sqr3.survey_target_vod__c,
        sqr3.survey_question_vod__c,
        sqr3.question_text_vod__c,
        row_number() OVER (PARTITION BY sqr3.id ORDER BY sqr3.file_id DESC) AS rnk
 FROM veeva.survey_question_response sqr3
 WHERE (sqr3.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr4 JOIN ( SELECT "substring"(v.values, 1, 18) AS id,
        "substring"(v.values, 19, length(v.values)) AS response
 FROM ( SELECT public.MapItems(r.v1) OVER () AS ( keys, values )
 FROM ( SELECT public.MapDelimitedExtractor((coalesce((sqr2.id || replace(sqr2.response_vod__c, ';'::varchar(1), (';'::varchar(1) || sqr2.id))), sqr2.id))::long varchar(10468) USING PARAMETERS delimiter=';'::varchar(1)) AS v1
 FROM ( SELECT sqr1.id,
        sqr1.response_vod__c,
        row_number() OVER (PARTITION BY st.account_vod__c, sqr1.survey_question_vod__c ORDER BY sqr1.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response sqr1 JOIN veeva.survey_target st ON ((sqr1.survey_target_vod__c = st.id)))
 WHERE (sqr1.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr2
 WHERE (sqr2.rnk = 1)) r) v
 GROUP BY "substring"(v.values, 1, 18),
          "substring"(v.values, 19, length(v.values))) response ON (((sqr4.id = response.id) AND (sqr4.rnk = 1))))) sqr_main ON ((q.id = sqr_main.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = sqr_main.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS MAX
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS MAX
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS MAX
 FROM veeva.survey_target)) AND (s.name = ANY (ARRAY['Pharmacy Survey'::varchar(42), 'Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(42), 'Respiratory - RespiClick Readiness'::varchar(42), 'Respiratory Business Survey'::varchar(42), 'Respiratory Professional Survey'::varchar(42), 'e-Rx Survey'::varchar(42)])))) a
 WHERE (a.rnk = 1) UNION  SELECT B.veeva_account_id,
        B.bu,
        max(B.survey_update_date) OVER (PARTITION BY B.veeva_account_id),
        B.survey,
        B.question,
        B.answer,
        B.response_update_date,
        B.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        (s.name || ' B'::varchar(2)) AS survey,
        r.question_text_vod__c AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY t.account_vod__c, q.id ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT a.createddate,
        a.lastmodifieddate,
        a.survey_target_vod__c,
        a.survey_question_vod__c,
        a.question_text_vod__c,
        response.response
 FROM (( SELECT sqr.id,
        sqr.createddate,
        sqr.lastmodifieddate,
        sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c
 FROM ( SELECT survey_question_response.id,
        survey_question_response.isdeleted,
        survey_question_response.name,
        survey_question_response.recordtypeid,
        survey_question_response.createddate,
        survey_question_response.createdbyid,
        survey_question_response.lastmodifieddate,
        survey_question_response.lastmodifiedbyid,
        survey_question_response.systemmodstamp,
        survey_question_response.mayedit,
        survey_question_response.islocked,
        survey_question_response.survey_target_vod__c,
        survey_question_response.answer_choice_vod__c,
        survey_question_response.date_vod__c,
        survey_question_response.datetime_vod__c,
        survey_question_response.external_id_vod__c,
        survey_question_response.mobile_id_vod__c,
        survey_question_response.number_vod__c,
        survey_question_response.order_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.required_vod__c,
        survey_question_response.response_hash_vod__c,
        survey_question_response.response_vod__c,
        survey_question_response.score_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.text_vod__c,
        survey_question_response.type_vod__c,
        survey_question_response.file_id,
        survey_question_response.record_id
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c !~~ '%Adasuve%Review%'::varchar(16))) sqr) a LEFT  JOIN ( SELECT "substring"(v.values, 1, 18) AS id,
        "substring"(v.values, 19, length(v.values)) AS response
 FROM ( SELECT public.MapItems(r.v1) OVER () AS ( keys, values )
 FROM ( SELECT public.MapDelimitedExtractor(((sqr.id || replace(sqr.response_vod__c, ';'::varchar(1), (';'::varchar(1) || sqr.id))))::long varchar(10468) USING PARAMETERS delimiter=';'::varchar(1)) AS v1
 FROM veeva.survey_question_response sqr
 WHERE (sqr.file_id = ( SELECT max(survey_question_response.file_id) AS max
 FROM veeva.survey_question_response))) r) v
 GROUP BY "substring"(v.values, 1, 18),
          "substring"(v.values, 19, length(v.values))) response ON ((a.id = response.id)))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(s1.file_id) AS MAX
 FROM veeva.survey s1)) AND (q.file_id = ( SELECT max(q1.file_id) AS MAX
 FROM veeva.survey_question q1)) AND (t.file_id = ( SELECT max(t1.file_id) AS MAX
 FROM veeva.survey_target t1)) AND (s.name = 'e-Rx Survey'::varchar(11)) AND (q.order_vod__c = 1::numeric(18,0)))) B
 WHERE (B.rnk = 1)
 GROUP BY B.veeva_account_id,
          B.bu,
          B.survey_update_date,
          B.survey,
          B.question,
          B.answer,
          B.response_update_date,
          B.response_create_date) UNION  SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        '*Future Scheduled Adasuve Formulary Review Date'::varchar(47) AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY s.id, q.id, t.account_vod__c, r.response ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr_yr.survey_target_vod__c,
        sqr_yr.survey_question_vod__c,
        sqr_yr.question_text_vod__c,
        sqr_yr.lastmodifieddate,
        sqr_yr.createddate,
        ((((coalesce(sqr_yr.response_vod__c, ''::varchar) || '-'::varchar(1)) || CASE WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jan'::varchar(3)) THEN '01'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Feb'::varchar(3)) THEN '02'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Mar'::varchar(3)) THEN '03'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Apr'::varchar(3)) THEN '04'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'May'::varchar(3)) THEN '05'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jun'::varchar(3)) THEN '06'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jul'::varchar(3)) THEN '07'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Aug'::varchar(3)) THEN '08'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Sep'::varchar(3)) THEN '09'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Oct'::varchar(3)) THEN '10'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Nov'::varchar(3)) THEN '11'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Dec'::varchar(3)) THEN '12'::varchar(2) ELSE ''::varchar END) || '-'::varchar(1)) || coalesce(sqr_day.response_vod__c, ''::varchar)) AS response
 FROM ((( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.lastmodifieddate,
        sqr.createddate,
        row_number() OVER (PARTITION BY sqr.survey_target_vod__c, sqr.survey_question_vod__c ORDER BY sqr.createddate DESC) AS rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        survey_question_response.lastmodifieddate,
        survey_question_response.createddate,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Year%'::varchar(40))) sqr
 WHERE (sqr.rnk = 1)) sqr_yr JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT qr.survey_target_vod__c,
        qr.survey_question_vod__c,
        qr.question_text_vod__c,
        qr.response_vod__c,
        row_number() OVER (PARTITION BY st.account_vod__c, qr.survey_question_vod__c ORDER BY qr.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response qr JOIN ( SELECT survey_target.id,
        survey_target.account_vod__c
 FROM veeva.survey_target
 GROUP BY survey_target.id,
          survey_target.account_vod__c) st ON ((qr.survey_target_vod__c = st.id)))
 WHERE (qr.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Month%'::varchar(41))) sqr
 WHERE (sqr.rnk = 1)) sqr_mth ON (((sqr_mth.survey_target_vod__c = sqr_yr.survey_target_vod__c) AND (sqr_yr.rnk = 1)))) JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Future Scheduled Adasuve % Review Date%'::varchar(40))) sqr
 WHERE (sqr.rnk = 1)) sqr_day ON ((sqr_day.survey_target_vod__c = sqr_yr.survey_target_vod__c)))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS max
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS max
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS max
 FROM veeva.survey_target)) AND (s.name = 'REMS Enrollment and Formulary'::varchar(29)))) a
 WHERE (a.rnk = 1)) UNION  SELECT a.veeva_account_id,
        a.bu,
        a.survey_update_date,
        a.survey,
        a.question,
        a.answer,
        a.response_update_date,
        a.response_create_date
 FROM ( SELECT t.account_vod__c AS veeva_account_id,
        substr(s.territory_vod__c, 1, 2) AS bu,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS survey_update_date,
        s.name AS survey,
        '*Prior Adasuve Formulary Review Date'::varchar(36) AS question,
        r.response AS answer,
        to_char(r.lastmodifieddate, 'YYYY-MM-DD'::varchar(10)) AS response_update_date,
        to_char(r.createddate, 'YYYY-MM-DD'::varchar(10)) AS response_create_date,
        row_number() OVER (PARTITION BY s.id, q.id, t.account_vod__c, r.response ORDER BY r.lastmodifieddate DESC) AS rnk
 FROM (((veeva.survey s JOIN veeva.survey_question q ON ((s.id = q.survey_vod__c))) JOIN ( SELECT sqr_yr.survey_target_vod__c,
        sqr_yr.survey_question_vod__c,
        sqr_yr.question_text_vod__c,
        sqr_yr.lastmodifieddate,
        sqr_yr.createddate,
        ((coalesce(sqr_yr.response_vod__c, ''::varchar) || '-'::varchar(1)) || CASE WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jan'::varchar(3)) THEN '01'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Feb'::varchar(3)) THEN '02'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Mar'::varchar(3)) THEN '03'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Apr'::varchar(3)) THEN '04'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'May'::varchar(3)) THEN '05'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jun'::varchar(3)) THEN '06'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Jul'::varchar(3)) THEN '07'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Aug'::varchar(3)) THEN '08'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Sep'::varchar(3)) THEN '09'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Oct'::varchar(3)) THEN '10'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Nov'::varchar(3)) THEN '11'::varchar(2) WHEN ("substring"(sqr_mth.response_vod__c, 1, 3) = 'Dec'::varchar(3)) THEN '12'::varchar(2) ELSE ''::varchar END) AS response
 FROM (( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.lastmodifieddate,
        sqr.createddate,
        row_number() OVER (PARTITION BY sqr.survey_target_vod__c, sqr.survey_question_vod__c ORDER BY sqr.createddate DESC) AS rnk
 FROM ( SELECT qr.survey_target_vod__c,
        qr.survey_question_vod__c,
        qr.question_text_vod__c,
        qr.response_vod__c,
        qr.lastmodifieddate,
        qr.createddate,
        row_number() OVER (PARTITION BY st.account_vod__c, qr.survey_question_vod__c ORDER BY qr.lastmodifieddate DESC) AS rnk
 FROM (veeva.survey_question_response qr JOIN ( SELECT survey_target.id,
        survey_target.account_vod__c
 FROM veeva.survey_target
 GROUP BY survey_target.id,
          survey_target.account_vod__c) st ON ((qr.survey_target_vod__c = st.id)))
 WHERE (qr.question_text_vod__c ~~ '%Prior Adasuve % Review Year'::varchar(28))) sqr
 WHERE (sqr.rnk = 1)) sqr_yr JOIN ( SELECT sqr.survey_target_vod__c,
        sqr.survey_question_vod__c,
        sqr.question_text_vod__c,
        sqr.response_vod__c,
        sqr.rnk
 FROM ( SELECT survey_question_response.survey_target_vod__c,
        survey_question_response.survey_question_vod__c,
        survey_question_response.question_text_vod__c,
        survey_question_response.response_vod__c,
        row_number() OVER (PARTITION BY survey_question_response.survey_target_vod__c, survey_question_response.survey_question_vod__c ORDER BY survey_question_response.lastmodifieddate DESC) AS rnk
 FROM veeva.survey_question_response
 WHERE (survey_question_response.question_text_vod__c ~~ '%Prior Adasuve % Review Month'::varchar(29))) sqr
 WHERE (sqr.rnk = 1)) sqr_mth ON (((sqr_mth.survey_target_vod__c = sqr_yr.survey_target_vod__c) AND (sqr_yr.rnk = 1))))) r ON ((q.id = r.survey_question_vod__c))) JOIN veeva.survey_target t ON ((t.id = r.survey_target_vod__c)))
 WHERE ((s.file_id = ( SELECT max(survey.file_id) AS max
 FROM veeva.survey)) AND (q.file_id = ( SELECT max(survey_question.file_id) AS max
 FROM veeva.survey_question)) AND (t.file_id = ( SELECT max(survey_target.file_id) AS max
 FROM veeva.survey_target)) AND (s.name = 'REMS Enrollment and Formulary'::varchar(29)))) a
 WHERE (a.rnk = 1);

CREATE  VIEW outbound.zzz_asi_rx_by_market AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, NULL AS zip_other, rx.ims_id, d.primary_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, NULL AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, NULL AS me_num, d.last_name, d.first_name, d.middle_name, d.address_line1 AS address, d.city, d.state, d.zip, d.address_line2 AS supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, 48 AS bucket_count, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN customer_master.hcp_demo d ON ((rx.tvcmid = d.tvcmid))) WHERE ((rx.market_name = ANY (ARRAY['MULTIPLE SCLEROSIS'::varchar(18), 'PAIN'::varchar(4), 'ANTI-PARKINSON'::varchar(14), 'SMR'::varchar(3), 'WAKE'::varchar(4)])) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'MONTH'::varchar(5)) AND (d.file_id = (SELECT max(hcp_demo.file_id) AS file_id FROM customer_master.hcp_demo))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_id, d.primary_specialty, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), d.last_name, d.first_name, d.middle_name, d.address_line1, d.city, d.state, d.zip, d.address_line2, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END, rx.data_date UNION SELECT mkt.market_name, '111'::varchar(3) AS ims_client_num, '55'::varchar(2) AS ims_report_num, NULL AS zip_other, sp.ims_id, d.primary_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pr.ims_product_group_num, NULL AS filler_01, NULL AS me_num, d.last_name, d.first_name, d.middle_name, d.address_line1 AS address, d.city, d.state, d.zip, d.address_line2 AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, sp.ship_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 0) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((((datamart.specialty_pharmacy_shipment sp JOIN integration.ims_week_buckets mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN customer_master.hcp_demo d ON ((sp.tvcmid = d.tvcmid))) JOIN (SELECT bi.entity_id, pb.name AS market_name FROM (product.basket_item bi JOIN product.basket pb ON ((bi.basket_id = pb.basket_id))) WHERE ((pb.basket_type = 'market'::varchar(6)) AND (pb.name = 'MS MARKET'::varchar(9)))) mkt ON ((sp.basket_id = mkt.entity_id))) LEFT JOIN (SELECT sp.entity_id AS basket_id, sp.source_product_code AS ims_product_group_num, sp.source_product_name FROM (metadata.data_feed_metadata dfeed JOIN product.source_product sp ON ((dfeed.feed_id = sp.feed_id))) WHERE ((dfeed.short_name = 'ims_mhj_cnt_m'::varchar(13)) AND (sp.source_client_num = '632'::varchar(3)) AND (sp.source_report_num = '2'::varchar(1)))) pr ON ((sp.basket_id = pr.basket_id))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL) AND (d.file_id = (SELECT max(hcp_demo.file_id) AS file_id FROM customer_master.hcp_demo))) GROUP BY mkt.market_name, sp.ims_id, d.primary_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pr.ims_product_group_num, d.last_name, d.first_name, d.middle_name, d.address_line1, d.city, d.state, d.zip, d.address_line2, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END, sp.ship_date) UNION SELECT mkt.name AS market_name, cm.zip, '111'::varchar(3) AS ims_client_num, '55'::varchar(2) AS ims_report_num, NULL AS zip_other, NULL AS ims_id, NULL AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pr.ims_product_group_num, NULL AS filler_01, NULL AS me_num, NULL AS last_name, NULL AS first_name, NULL AS address, NULL AS city, NULL AS state, NULL AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, mth.month_ending AS data_month, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 0) THEN cm.total_rxs ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.total_rxs ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.total_rxs ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.total_rxs ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.total_rxs ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.total_rxs ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.total_rxs ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.total_rxs ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.total_rxs ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.total_rxs ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.total_rxs ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.total_rxs ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.total_rxs ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.total_rxs ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.total_rxs ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.total_rxs ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.total_rxs ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.total_rxs ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.total_rxs ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.total_rxs ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.total_rxs ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.total_rxs ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.total_rxs ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.total_rxs ELSE NULL::float END) AS trx_024 FROM (((datamart.cmop_rx cm JOIN integration.ims_week_buckets mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT bi.entity_id, pb.name FROM (product.basket_item bi JOIN product.basket pb ON ((bi.basket_id = pb.basket_id))) WHERE ((pb.basket_type = 'market'::varchar(6)) AND (pb.name = ANY (ARRAY['MS MARKET'::varchar(9), 'PD MARKET'::varchar(9)])))) mkt ON ((cm.basket_id = mkt.entity_id))) LEFT JOIN (SELECT sp.entity_id AS basket_id, sp.source_product_code AS ims_product_group_num, sp.source_product_name FROM (metadata.data_feed_metadata dfeed JOIN product.source_product sp ON ((dfeed.feed_id = sp.feed_id))) WHERE ((dfeed.short_name = 'ims_mhj_cnt_m'::varchar(13)) AND (sp.source_client_num = '632'::varchar(3)) AND (sp.source_report_num = '2'::varchar(1)))) pr ON ((cm.basket_id = pr.basket_id))) GROUP BY mkt.name, cm.zip, pr.ims_product_group_num, mth.month_ending;

CREATE  VIEW outbound.zzz_tw_specialty_account AS
SELECT tw_account.specialty_pharmacy_data_source AS data_source, tw_account.customer_id AS customer_code, tw_account.customer_name, tw_account.parent_customer_id AS parent_customer_code, tw_account.parent_customer_name, tw_account.customer_type AS customer_type_code, tw_account.pvp_340B_id AS pvp_340b_id, NULL AS start_date, NULL AS end_date, 'Y'::varchar(1) AS active_ind, NULL AS dea_num, NULL AS hin FROM datamart.tw_account;

CREATE  VIEW outbound.zzz_tw_specialty_address AS
SELECT tw_address.specialty_pharmacy_data_source AS data_source, tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code, tw_address.phone, tw_address.fax, tw_address.email, tw_address.tax_id FROM datamart.tw_address;

CREATE  VIEW outbound.zzz_tw_specialty_addr_xref AS
SELECT tw_address_xref.specialty_pharmacy_data_source AS data_source, tw_address_xref.customer_code, tw_address_xref.address_id, tw_address_xref.address_type, NULL AS start_date, NULL AS end_date, 'Y'::varchar(1) AS active_ind FROM datamart.tw_address_xref;

CREATE  VIEW outbound.zzz_zs_agile_demographics AS
SELECT d.tvcmid AS TVCMID, d.ims_id AS IMS_ID, d.veeva_account_id AS VEEVA_ACCOUNT_ID, d.first_name AS FIRST_NAME, d.middle_name AS MID_NAME, d.last_name AS LAST_NAME, d.degree AS DEGREE, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3) AS ADDRESS, d.ptr_city AS CITY, d.ptr_state AS STATE, d.ptr_zip AS ZIP, d.specialty AS PRIM_SPECIALTY, s1.nuvigil_report_group AS NUVIGIL_REPORT_GROUP, dec1.decile_trx_count_6_mo AS NUVIGIL_DECILE, dec2.decile_trx_count_6_mo AS WAKE_DECILE, s1.amrix_target_flag AS TARGET_FLAG FROM ((((datamart.prescriber_combined_demographics d LEFT JOIN reference.specialty_xref s1 ON ((s1.specialty_code = d.specialty))) LEFT JOIN datamart.rx_deciles dec1 ON (((dec1.ims_id = d.ims_id) AND (upper(dec1.decile_name) = 'NUVIGIL'::varchar(7))))) LEFT JOIN datamart.rx_deciles dec2 ON (((dec2.ims_id = d.ims_id) AND (upper(dec2.decile_name) = 'MODAFINIL'::varchar(9))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx prescriber_rx WHERE ((prescriber_rx.basket_id = 36) AND (prescriber_rx.rollup_month >= add_months(prescriber_rx.data_date, (-24))) AND (prescriber_rx.rollup_month <= add_months(prescriber_rx.data_date, (-1))) AND (upper(prescriber_rx.basket_type) = 'PRODUCT'::varchar(7)) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY prescriber_rx.ims_id UNION SELECT sfa_demographics.ims_id FROM datamart.sfa_demographics WHERE (sfa_demographics.sales_force_id = 'TP'::varchar(2)) GROUP BY sfa_demographics.ims_id) rx ON ((d.ims_id = rx.ims_id))) WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL)) GROUP BY d.tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.middle_name, d.last_name, d.degree, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3), d.ptr_city, d.ptr_state, d.ptr_zip, d.specialty, s1.nuvigil_report_group, dec1.decile_trx_count_6_mo, dec2.decile_trx_count_6_mo, s1.amrix_target_flag;

CREATE  VIEW outbound.zzz_asi_rx_by_market_ms_new AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '2'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, rx.ims_zip AS zip_other, sp.ims_id, rx.ims_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, rx.ims_me_num AS me_num, rx.ims_last_name AS last_name, rx.ims_first_name AS first_name, rx.ims_middle_name AS middle_name, rx.ims_address AS address, rx.ims_city AS city, rx.ims_state AS state_code, rx.ims_zip AS zip, NULL AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, to_char(max(mth.month_ending), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM (((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN reference.asi_outbound_ims_product_group_mapping pg ON (((sp.specialty_pharmacy_data_source = pg.data_source) AND (sp.basket_id = pg.basket_id) AND (pg.market_name = 'MS MARKET'::varchar(9))))) LEFT JOIN (SELECT a.ims_last_name, a.ims_first_name, a.ims_middle_name, a.ims_address, a.ims_city, a.ims_state, a.ims_zip, a.ims_client_number, a.ims_me_num, a.ims_id, a.ims_specialty, a.rnk FROM (SELECT axd.ims_last_name, axd.ims_first_name, axd.ims_middle_name, axd.ims_address, axd.ims_city, axd.ims_state, axd.ims_zip, axd.ims_client_number, axd.ims_me_num, axd.ims_id, axd.ims_specialty, row_number() OVER (PARTITION BY axd.ims_id ORDER BY axd.ims_specialty) AS rnk FROM outbound.asi_xponent_demographics axd) a WHERE (a.rnk = 1)) rx ON ((rx.ims_id = sp.ims_id))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (rx.ims_client_number = '632'::varchar(3)) AND (sp.ims_id IS NOT NULL)) GROUP BY pg.market_name, sp.ims_id, rx.ims_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pg.ims_product_group, rx.ims_me_num, rx.ims_last_name, rx.ims_first_name, rx.ims_middle_name, rx.ims_address, rx.ims_city, rx.ims_state, rx.ims_zip, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, (SELECT to_char(x.month_ending, 'MMDDYY'::varchar(7)) AS to_char FROM (SELECT max(ims_week_buckets.month_ending) AS month_ending FROM integration.ims_week_buckets WHERE (ims_week_buckets.full_month = 'Y'::varchar(1))) x) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_024 FROM ((datamart.cmop_rx cm JOIN (SELECT ims_week_buckets.month_ending, ims_week_buckets.month_bucket FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_ending, ims_week_buckets.month_bucket) mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.cmop_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MMDDYY'::varchar(7)) AS to_char FROM (SELECT max(ims_week_buckets.month_ending) AS month_ending FROM integration.ims_week_buckets WHERE (ims_week_buckets.full_month = 'Y'::varchar(1))) x);

CREATE  VIEW outbound.zzz_asi_rx_by_market_pd AS
SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '6'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '6'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MMDDYY'::varchar(6)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.cmop_rxs_normalized ELSE NULL::float END) AS trx_024 FROM ((datamart.cmop_rx cm JOIN outbound.month_rollup_and_bucket mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'PD MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.cmop_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MMDDYY'::varchar(6)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1));

CREATE  VIEW outbound.zzz_asi_market_access_w_tot AS
SELECT asi_market_access_w.report_num, asi_market_access_w.ims_product_group_num AS product_num, asi_market_access_w.data_month, sum(asi_market_access_w.nrx_001) AS total_nrx_01, sum(asi_market_access_w.nrx_002) AS total_nrx_02, sum(asi_market_access_w.nrx_003) AS total_nrx_03, sum(asi_market_access_w.nrx_004) AS total_nrx_04, sum(asi_market_access_w.nrx_005) AS total_nrx_05, sum(asi_market_access_w.nrx_006) AS total_nrx_06, sum(asi_market_access_w.nrx_007) AS total_nrx_07, sum(asi_market_access_w.nrx_008) AS total_nrx_08, sum(asi_market_access_w.nrx_009) AS total_nrx_09, sum(asi_market_access_w.nrx_010) AS total_nrx_10, sum(asi_market_access_w.nrx_011) AS total_nrx_11, sum(asi_market_access_w.nrx_012) AS total_nrx_12, sum(asi_market_access_w.nrx_013) AS total_nrx_13, sum(asi_market_access_w.nrx_014) AS total_nrx_14, sum(asi_market_access_w.nrx_015) AS total_nrx_15, sum(asi_market_access_w.nrx_016) AS total_nrx_16, sum(asi_market_access_w.nrx_017) AS total_nrx_17, sum(asi_market_access_w.nrx_018) AS total_nrx_18, sum(asi_market_access_w.nrx_019) AS total_nrx_19, sum(asi_market_access_w.nrx_020) AS total_nrx_20, sum(asi_market_access_w.nrx_021) AS total_nrx_21, sum(asi_market_access_w.nrx_022) AS total_nrx_22, sum(asi_market_access_w.nrx_023) AS total_nrx_23, sum(asi_market_access_w.nrx_024) AS total_nrx_24, sum(asi_market_access_w.trx_001) AS total_trx_01, sum(asi_market_access_w.trx_002) AS total_trx_02, sum(asi_market_access_w.trx_003) AS total_trx_03, sum(asi_market_access_w.trx_004) AS total_trx_04, sum(asi_market_access_w.trx_005) AS total_trx_05, sum(asi_market_access_w.trx_006) AS total_trx_06, sum(asi_market_access_w.trx_007) AS total_trx_07, sum(asi_market_access_w.trx_008) AS total_trx_08, sum(asi_market_access_w.trx_009) AS total_trx_09, sum(asi_market_access_w.trx_010) AS total_trx_10, sum(asi_market_access_w.trx_011) AS total_trx_11, sum(asi_market_access_w.trx_012) AS total_trx_12, sum(asi_market_access_w.trx_013) AS total_trx_13, sum(asi_market_access_w.trx_014) AS total_trx_14, sum(asi_market_access_w.trx_015) AS total_trx_15, sum(asi_market_access_w.trx_016) AS total_trx_16, sum(asi_market_access_w.trx_017) AS total_trx_17, sum(asi_market_access_w.trx_018) AS total_trx_18, sum(asi_market_access_w.trx_019) AS total_trx_19, sum(asi_market_access_w.trx_020) AS total_trx_20, sum(asi_market_access_w.trx_021) AS total_trx_21, sum(asi_market_access_w.trx_022) AS total_trx_22, sum(asi_market_access_w.trx_023) AS total_trx_23, sum(asi_market_access_w.trx_024) AS total_trx_24 FROM outbound.asi_market_access_w GROUP BY asi_market_access_w.report_num, asi_market_access_w.ims_product_group_num, asi_market_access_w.data_month;

CREATE  VIEW outbound.zzz_asi_market_access_m_tot AS
SELECT asi_market_access_m.report_num, asi_market_access_m.ims_product_group_num AS product_num, asi_market_access_m.data_month, sum(asi_market_access_m.nrx_001) AS total_nrx_01, sum(asi_market_access_m.nrx_002) AS total_nrx_02, sum(asi_market_access_m.nrx_003) AS total_nrx_03, sum(asi_market_access_m.nrx_004) AS total_nrx_04, sum(asi_market_access_m.nrx_005) AS total_nrx_05, sum(asi_market_access_m.nrx_006) AS total_nrx_06, sum(asi_market_access_m.nrx_007) AS total_nrx_07, sum(asi_market_access_m.nrx_008) AS total_nrx_08, sum(asi_market_access_m.nrx_009) AS total_nrx_09, sum(asi_market_access_m.nrx_010) AS total_nrx_10, sum(asi_market_access_m.nrx_011) AS total_nrx_11, sum(asi_market_access_m.nrx_012) AS total_nrx_12, sum(asi_market_access_m.nrx_013) AS total_nrx_13, sum(asi_market_access_m.nrx_014) AS total_nrx_14, sum(asi_market_access_m.nrx_015) AS total_nrx_15, sum(asi_market_access_m.nrx_016) AS total_nrx_16, sum(asi_market_access_m.nrx_017) AS total_nrx_17, sum(asi_market_access_m.nrx_018) AS total_nrx_18, sum(asi_market_access_m.nrx_019) AS total_nrx_19, sum(asi_market_access_m.nrx_020) AS total_nrx_20, sum(asi_market_access_m.nrx_021) AS total_nrx_21, sum(asi_market_access_m.nrx_022) AS total_nrx_22, sum(asi_market_access_m.nrx_023) AS total_nrx_23, sum(asi_market_access_m.nrx_024) AS total_nrx_24, sum(asi_market_access_m.trx_001) AS total_trx_01, sum(asi_market_access_m.trx_002) AS total_trx_02, sum(asi_market_access_m.trx_003) AS total_trx_03, sum(asi_market_access_m.trx_004) AS total_trx_04, sum(asi_market_access_m.trx_005) AS total_trx_05, sum(asi_market_access_m.trx_006) AS total_trx_06, sum(asi_market_access_m.trx_007) AS total_trx_07, sum(asi_market_access_m.trx_008) AS total_trx_08, sum(asi_market_access_m.trx_009) AS total_trx_09, sum(asi_market_access_m.trx_010) AS total_trx_10, sum(asi_market_access_m.trx_011) AS total_trx_11, sum(asi_market_access_m.trx_012) AS total_trx_12, sum(asi_market_access_m.trx_013) AS total_trx_13, sum(asi_market_access_m.trx_014) AS total_trx_14, sum(asi_market_access_m.trx_015) AS total_trx_15, sum(asi_market_access_m.trx_016) AS total_trx_16, sum(asi_market_access_m.trx_017) AS total_trx_17, sum(asi_market_access_m.trx_018) AS total_trx_18, sum(asi_market_access_m.trx_019) AS total_trx_19, sum(asi_market_access_m.trx_020) AS total_trx_20, sum(asi_market_access_m.trx_021) AS total_trx_21, sum(asi_market_access_m.trx_022) AS total_trx_22, sum(asi_market_access_m.trx_023) AS total_trx_23, sum(asi_market_access_m.trx_024) AS total_trx_24 FROM outbound.asi_market_access_m GROUP BY asi_market_access_m.report_num, asi_market_access_m.ims_product_group_num, asi_market_access_m.data_month;

CREATE  VIEW outbound.zzz_amrix_market AS
SELECT axiom_market.plan_num AS PLAN_NUM, axiom_market.product_code AS PRODUCT_CODE, coalesce(sum(axiom_market.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_market.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_market.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_market.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_market.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_market.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_market.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_market.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_market.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_market.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_market.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_market.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_market.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_market.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_market.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_market.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_market.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_market.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_market.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_market.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_market.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_market.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_market.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_market.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_market.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_market.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_market.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_market.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_market.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_market.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_market.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_market.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_market.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_market.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_market.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_market.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_market.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_market.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_market.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_market.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_market.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_market.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_market.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_market.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_market.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_market.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_market.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_market.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_market axiom_market WHERE (axiom_market.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) GROUP BY axiom_market.plan_num, axiom_market.product_code;

CREATE  VIEW outbound.zzz_amrix_product_totals AS
SELECT axiom_product_totals.product_code AS PRODUCT_CODE, coalesce(sum(axiom_product_totals.trx_cnt24), 0::float) AS TRX_CNT24, coalesce(sum(axiom_product_totals.nrx_cnt24), 0::float) AS NRX_CNT24, coalesce(sum(axiom_product_totals.trx_cnt23), 0::float) AS TRX_CNT23, coalesce(sum(axiom_product_totals.nrx_cnt23), 0::float) AS NRX_CNT23, coalesce(sum(axiom_product_totals.trx_cnt22), 0::float) AS TRX_CNT22, coalesce(sum(axiom_product_totals.nrx_cnt22), 0::float) AS NRX_CNT22, coalesce(sum(axiom_product_totals.trx_cnt21), 0::float) AS TRX_CNT21, coalesce(sum(axiom_product_totals.nrx_cnt21), 0::float) AS NRX_CNT21, coalesce(sum(axiom_product_totals.trx_cnt20), 0::float) AS TRX_CNT20, coalesce(sum(axiom_product_totals.nrx_cnt20), 0::float) AS NRX_CNT20, coalesce(sum(axiom_product_totals.trx_cnt19), 0::float) AS TRX_CNT19, coalesce(sum(axiom_product_totals.nrx_cnt19), 0::float) AS NRX_CNT19, coalesce(sum(axiom_product_totals.trx_cnt18), 0::float) AS TRX_CNT18, coalesce(sum(axiom_product_totals.nrx_cnt18), 0::float) AS NRX_CNT18, coalesce(sum(axiom_product_totals.trx_cnt17), 0::float) AS TRX_CNT17, coalesce(sum(axiom_product_totals.nrx_cnt17), 0::float) AS NRX_CNT17, coalesce(sum(axiom_product_totals.trx_cnt16), 0::float) AS TRX_CNT16, coalesce(sum(axiom_product_totals.nrx_cnt16), 0::float) AS NRX_CNT16, coalesce(sum(axiom_product_totals.trx_cnt15), 0::float) AS TRX_CNT15, coalesce(sum(axiom_product_totals.nrx_cnt15), 0::float) AS NRX_CNT15, coalesce(sum(axiom_product_totals.trx_cnt14), 0::float) AS TRX_CNT14, coalesce(sum(axiom_product_totals.nrx_cnt14), 0::float) AS NRX_CNT14, coalesce(sum(axiom_product_totals.trx_cnt13), 0::float) AS TRX_CNT13, coalesce(sum(axiom_product_totals.nrx_cnt13), 0::float) AS NRX_CNT13, coalesce(sum(axiom_product_totals.trx_cnt12), 0::float) AS TRX_CNT12, coalesce(sum(axiom_product_totals.nrx_cnt12), 0::float) AS NRX_CNT12, coalesce(sum(axiom_product_totals.trx_cnt11), 0::float) AS TRX_CNT11, coalesce(sum(axiom_product_totals.nrx_cnt11), 0::float) AS NRX_CNT11, coalesce(sum(axiom_product_totals.trx_cnt10), 0::float) AS TRX_CNT10, coalesce(sum(axiom_product_totals.nrx_cnt10), 0::float) AS NRX_CNT10, coalesce(sum(axiom_product_totals.trx_cnt9), 0::float) AS TRX_CNT9, coalesce(sum(axiom_product_totals.nrx_cnt9), 0::float) AS NRX_CNT9, coalesce(sum(axiom_product_totals.trx_cnt8), 0::float) AS TRX_CNT8, coalesce(sum(axiom_product_totals.nrx_cnt8), 0::float) AS NRX_CNT8, coalesce(sum(axiom_product_totals.trx_cnt7), 0::float) AS TRX_CNT7, coalesce(sum(axiom_product_totals.nrx_cnt7), 0::float) AS NRX_CNT7, coalesce(sum(axiom_product_totals.trx_cnt6), 0::float) AS TRX_CNT6, coalesce(sum(axiom_product_totals.nrx_cnt6), 0::float) AS NRX_CNT6, coalesce(sum(axiom_product_totals.trx_cnt5), 0::float) AS TRX_CNT5, coalesce(sum(axiom_product_totals.nrx_cnt5), 0::float) AS NRX_CNT5, coalesce(sum(axiom_product_totals.trx_cnt4), 0::float) AS TRX_CNT4, coalesce(sum(axiom_product_totals.nrx_cnt4), 0::float) AS NRX_CNT4, coalesce(sum(axiom_product_totals.trx_cnt3), 0::float) AS TRX_CNT3, coalesce(sum(axiom_product_totals.nrx_cnt3), 0::float) AS NRX_CNT3, coalesce(sum(axiom_product_totals.trx_cnt2), 0::float) AS TRX_CNT2, coalesce(sum(axiom_product_totals.nrx_cnt2), 0::float) AS NRX_CNT2, coalesce(sum(axiom_product_totals.trx_cnt1), 0::float) AS TRX_CNT1, coalesce(sum(axiom_product_totals.nrx_cnt1), 0::float) AS NRX_CNT1 FROM outbound.axiom_product_totals axiom_product_totals WHERE (axiom_product_totals.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) GROUP BY axiom_product_totals.product_code;

CREATE  VIEW outbound.ftf_ims_monthly_market_obm AS
(SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = ANY (ARRAY['ALLERGY MARKET TOTAL'::varchar(20), 'BDP NASAL MARKET TOTAL'::varchar(22), 'ICS MARKET TOTAL'::varchar(16), 'ICS SPLIT MARKET TOTAL'::varchar(22), 'LABA MARKET TOTAL'::varchar(17), 'SABA MARKET TOTAL'::varchar(17)])) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month UNION SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = ANY (ARRAY['MS MARKET'::varchar(9), 'PD MARKET'::varchar(9)])) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month) UNION SELECT a.plan_number AS "PLAN ID", a.plan_name AS "PLAN NAME", a.payer_number AS "PAYER ID", a.payer_name AS "PAYER NAME", pg.market_name AS "MARKET NAME", rx.basket_name AS "PRODUCT NAME", mpzd.zip, to_char(rx.rollup_month, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum((rx.trx_count / mpzd.divisor)) AS TRX, sum((rx.nrx_count / mpzd.divisor)) AS NRX FROM (((((datamart.plantrak_workbook a JOIN datamart.prescriber_rx rx ON (((a.plan_name = rx.plan_name) AND (a.payer_name = rx.payer_name) AND (a.model = rx.model) AND (a.payer_plan_number = rx.payer_plan_number) AND (a.method_of_payment = rx.payment_method)))) JOIN outbound.month_rollup_and_bucket mth ON (((last_day(rx.rollup_month) = mth.month_ending) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24)))) JOIN (SELECT market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.sales_force_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.ims_id, market_presc_zip_divisor.zip, market_presc_zip_divisor.divisor) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) JOIN (SELECT ims_report_cnt_qty_mapping.ims_client_number, ims_report_cnt_qty_mapping.ims_report_number_cnt, ims_report_cnt_qty_mapping.report_frequency FROM reference.ims_report_cnt_qty_mapping WHERE (ims_report_cnt_qty_mapping.active_flag = 'Y'::char(1))) actv ON (((rx.ims_client_number = actv.ims_client_number) AND (rx.ims_report_number_cnt = actv.ims_report_number_cnt) AND (rx.report_frequency = actv.report_frequency)))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.data_source = 'FTF'::varchar(3)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.data_source) pg ON ((pg.basket_id = rx.basket_id))) WHERE (rx.market_name = 'TOTAL STIMULANT/SLEEP/SEDATIVE'::varchar(30)) GROUP BY a.plan_number, a.plan_name, a.payer_number, a.payer_name, pg.market_name, rx.basket_name, mpzd.zip, rx.rollup_month;

CREATE  VIEW outbound.zzz_zs_agile_mkt_fentora_obq_demo AS
SELECT pcd.tvcmid, pcd.ims_id, pcd.veeva_account_id, pcd.first_name, pcd.middle_name, pcd.last_name, pcd.degree, ((pcd.ptr_address_1 || pcd.ptr_address_2) || pcd.ptr_address_3) AS address, pcd.ptr_city, pcd.ptr_state, pcd.ptr_zip, pcd.specialty AS prim_specialty, s.fentora_report_group, rxd.decile_trx_count_6_mo AS fentora_decile, CASE WHEN (cp.ims_id IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS target_flag FROM ((((datamart.prescriber_combined_demographics pcd LEFT JOIN reference.specialty_xref s ON ((pcd.specialty = s.specialty_code))) LEFT JOIN datamart.rx_deciles rxd ON (((pcd.ims_id = rxd.ims_id) AND (rxd.decile_name = 'AMRIX'::varchar(5))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx WHERE (prescriber_rx.basket_id = 40)) rx ON ((rx.ims_id = pcd.ims_id))) LEFT JOIN datamart.call_plan cp ON (((pcd.ims_id = cp.ims_id) AND (pcd.sales_force_id = cp.sales_force_id) AND (cp.basket_id = 40)))) WHERE ((pcd.sales_force_id = 'TP'::varchar(2)) AND (pcd.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (pcd.first_name IS NOT NULL)) GROUP BY pcd.tvcmid, pcd.ims_id, pcd.veeva_account_id, pcd.first_name, pcd.middle_name, pcd.last_name, pcd.degree, ((pcd.ptr_address_1 || pcd.ptr_address_2) || pcd.ptr_address_3), pcd.ptr_city, pcd.ptr_state, pcd.ptr_zip, pcd.specialty, s.fentora_report_group, rxd.decile_trx_count_6_mo, CASE WHEN (cp.ims_id IS NOT NULL) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END;

CREATE  VIEW outbound.zzz_demo_amrix AS
SELECT d.tvcmid AS TVCMID, d.ims_id AS IMS_ID, d.veeva_account_id AS VEEVA_ACCOUNT_ID, d.first_name AS FIRST_NAME, d.middle_name AS MID_NAME, d.last_name AS LAST_NAME, d.degree AS DEGREE, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3) AS ADDRESS, d.ptr_city AS CITY, d.ptr_state AS STATE, d.ptr_zip AS ZIP, d.specialty AS PRIM_SPECIALTY, s1.nuvigil_report_group AS amrix_report_group, dec1.decile_trx_count_6_mo AS amrix_decile, dec2.decile_trx_count_6_mo AS bsmr_decile, dec3.decile_trx_count_6_mo AS total_muscal_relaxant_decile, NULL AS bsmr_less_soma_zanaflex_decile, dec4.decile_trx_count_6_mo AS Cyclobenzaprine_HCL_decile, s1.amrix_target_flag AS TARGET_FLAG FROM ((((((datamart.prescriber_combined_demographics d LEFT JOIN reference.specialty_xref s1 ON ((s1.specialty_code = d.specialty))) LEFT JOIN datamart.rx_deciles dec1 ON (((dec1.ims_id = d.ims_id) AND (upper(dec1.decile_name) = 'AMRIX'::varchar(5))))) LEFT JOIN datamart.rx_deciles dec2 ON (((dec2.ims_id = d.ims_id) AND (upper(dec2.decile_name) = 'BRANDED MUSCLE RELAXANTS'::varchar(24))))) LEFT JOIN datamart.rx_deciles dec3 ON (((dec3.ims_id = d.ims_id) AND (upper(dec3.decile_name) = 'TOTAL MUSCLE RELAXANTS'::varchar(22))))) LEFT JOIN datamart.rx_deciles dec4 ON (((dec4.ims_id = d.ims_id) AND (upper(dec4.decile_name) = 'CYCLOBENZAPRINE HCL'::varchar(19))))) JOIN (SELECT prescriber_rx.ims_id FROM datamart.prescriber_rx prescriber_rx WHERE ((prescriber_rx.basket_id = 176) AND (prescriber_rx.rollup_month >= add_months(prescriber_rx.data_date, (-24))) AND (prescriber_rx.rollup_month <= add_months(prescriber_rx.data_date, (-1))) AND (upper(prescriber_rx.basket_type) = 'PRODUCT'::varchar(7)) AND (prescriber_rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY prescriber_rx.ims_id UNION SELECT sfa_demographics.ims_id FROM datamart.sfa_demographics WHERE (sfa_demographics.sales_force_id = 'TP'::varchar(2)) GROUP BY sfa_demographics.ims_id) rx ON ((d.ims_id = rx.ims_id))) WHERE ((d.sales_force_id = 'TP'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL)) GROUP BY d.tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.middle_name, d.last_name, d.degree, ((((d.ptr_address_1 || ' '::varchar(1)) || d.ptr_address_2) || ' '::varchar(1)) || d.ptr_address_3), d.ptr_city, d.ptr_state, d.ptr_zip, d.specialty, s1.nuvigil_report_group, dec1.decile_trx_count_6_mo, dec2.decile_trx_count_6_mo, dec3.decile_trx_count_6_mo, dec4.decile_trx_count_6_mo, s1.amrix_target_flag;

CREATE  VIEW outbound.zs_calls_by_specialty AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, sum(c.calls) AS calls_6mth FROM (((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.veeva_account_id, c.territory_number AS territory_num, sum(1) AS calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TO'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TS'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.veeva_account_id, c.territory_number) c ON (((d.VEEVA_ACCOUNT_ID = c.veeva_account_id) AND (d.territory_num = c.territory_num)))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW sandbox.asi_market_access_w_test AS
SELECT A.zip, A.state, A.payer_plan_num, A.report_num, A.ims_product_group_num, A.data_month, A.nrx_001, A.nrx_002, A.nrx_003, A.nrx_004, A.nrx_005, A.nrx_006, A.nrx_007, A.nrx_008, A.nrx_009, A.nrx_010, A.nrx_011, A.nrx_012, A.nrx_013, A.nrx_014, A.nrx_015, A.nrx_016, A.nrx_017, A.nrx_018, A.nrx_019, A.nrx_020, A.nrx_021, A.nrx_022, A.nrx_023, A.nrx_024, A.trx_001, A.trx_002, A.trx_003, A.trx_004, A.trx_005, A.trx_006, A.trx_007, A.trx_008, A.trx_009, A.trx_010, A.trx_011, A.trx_012, A.trx_013, A.trx_014, A.trx_015, A.trx_016, A.trx_017, A.trx_018, A.trx_019, A.trx_020, A.trx_021, A.trx_022, A.trx_023, A.trx_024 FROM ((SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state, mpzd.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((((datamart.prescriber_rx rx JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN (SELECT market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo WHERE (hcp_demo.file_id = (SELECT max(customer_hcp_demographics.file_id) AS MAX FROM datamart.customer_hcp_demographics))) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo WHERE (hco_demo.file_id = (SELECT max(customer_hco_demographics.file_id) AS MAX FROM datamart.customer_hco_demographics))) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_report_number_cnt = ANY (ARRAY['1'::varchar(1), '2'::varchar(1), '3'::varchar(1), '4'::varchar(1), '5'::varchar(1), '6'::varchar(1), '68'::varchar(2)])) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state, mpzd.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime Therapeutics'::varchar(18)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((add_months(last_day(sp.ship_date), 1) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) A;

CREATE  VIEW outbound.zzz_access_monitor_calls_by_specialty_oncology AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_xpd_demographics AS
SELECT xpd_demographics.ims_client_number, xpd_demographics.ims_report_number, xpd_demographics.ims_id, xpd_demographics.tvcmid, xpd_demographics.last_name, xpd_demographics.first_name, xpd_demographics.middle_name, xpd_demographics.address_1, xpd_demographics.address_2, xpd_demographics.city, xpd_demographics.state, xpd_demographics.zip, xpd_demographics.specialty, xpd_demographics.specialty_description, xpd_demographics.trx_decile_retail, xpd_demographics.nrx_decile_retail, xpd_demographics.nbrx_decile_retail, xpd_demographics.trx_decile_mail, xpd_demographics.nrx_decile_mail, xpd_demographics.nbrx_decile_mail, xpd_demographics.market_prescriber_reliability_retail, xpd_demographics.market_prescriber_reliability_mail FROM datamart.xpd_demographics;

CREATE  VIEW outbound.zs_xpd_core_metrics AS
SELECT xpd_core_metrics.ims_client_number, xpd_core_metrics.ims_report_number, xpd_core_metrics.channel_indicator, xpd_core_metrics.ims_id, xpd_core_metrics.tvcmid, xpd_core_metrics.specialty, xpd_core_metrics.ims_product_group, xpd_core_metrics.basket_id, xpd_core_metrics.basket_name, xpd_core_metrics.rollup_month, xpd_core_metrics.xpo_nrx, xpd_core_metrics.xpo_trx, xpd_core_metrics.unknown_nrx, xpd_core_metrics.unknown_trx, xpd_core_metrics.new_therapy_starts, xpd_core_metrics.continued_new, xpd_core_metrics.switch_to, xpd_core_metrics.add_on, xpd_core_metrics.restart_same_new, xpd_core_metrics.restart_different, xpd_core_metrics.continued_refill, xpd_core_metrics.restart_same_refill, xpd_core_metrics.switch_from, xpd_core_metrics.restart_different_from, xpd_core_metrics.add_to, xpd_core_metrics.market_new_to_brand_rx, xpd_core_metrics.dynamic_capture_rx FROM datamart.xpd_core_metrics;

CREATE  VIEW WSMP_ADMIN_ORA.v_do_not_promote AS
SELECT iq2.ims_id, iq2.last_name, iq2.first_name, iq2.mid_name, iq2.suffix FROM (SELECT iq1.ims_id, iq1.last_name, iq1.first_name, iq1.mid_name, iq1.suffix, row_number() OVER (PARTITION BY iq1.ims_id ORDER BY iq1.u_rnk) AS rnk FROM (SELECT dim_debarred.IMS_ID AS ims_id, dim_debarred.LAST_NAME AS last_name, dim_debarred.FIRST_NAME AS first_name, dim_debarred.MID_NAME AS mid_name, dim_debarred.SUFFIX AS suffix, 2 AS u_rnk FROM teva_archive.DIM_DEBARRED WHERE (dim_debarred.IMS_ID IS NOT NULL) UNION SELECT debarred.IMS_ID AS ims_id, debarred.LAST_NAME AS last_name, debarred.FIRST_NAME AS first_name, debarred.MIDDLE_NAME AS middle_name, debarred.SUFFIX AS suffix, 1 AS u_rnk FROM WSMP_ADMIN.DEBARRED WHERE ((debarred.IMS_ID IS NOT NULL) AND (debarred.CURRENT_IND = 'Y'::varchar(1)))) iq1) iq2 WHERE (iq2.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_zs_tr_demo_obw AS
SELECT acct.ID AS veeva_account_id, acct.ID_VOD__C AS ims_id, g.DEVELOPERNAME AS territory_num, acct.FIRSTNAME AS first_name, acct.LASTNAME AS last_name, addr.NAME AS address1, addr.ADDRESS_LINE_2_VOD__C AS address2, addr.CITY_VOD__C AS city, addr.STATE_VOD__C AS state, addr.ZIP_VOD__C AS zip, cg.call_goal, cg.committed_p1, cg.committed_p2, cg.committed_p3 FROM ((((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_TSF_VOD__C tsf ON (((tsf.ACCOUNT_VOD__C = acct.ID) AND (tsf.TERRITORY_VOD__C = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (tsf.ADDRESS_VOD__C = addr.ID)))) LEFT JOIN (SELECT cg.ACCOUNT_TVA__C AS account_tva__c, cg.TERRITORY_TVA__C AS territory_tva__c, sum(CASE WHEN (cg.PRIORITY_TVA__C = 1::numeric(18,0)) THEN cg.GOAL_TVA__C ELSE 0::numeric(18,0) END) AS call_goal, min(CASE WHEN (cg.PRIORITY_TVA__C = 1::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p1, min(CASE WHEN (cg.PRIORITY_TVA__C = 2::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p2, min(CASE WHEN (cg.PRIORITY_TVA__C = 3::numeric(18,0)) THEN p.NAME ELSE NULL END) AS committed_p3 FROM (WSMP_ADMIN.VV_CALL_GOAL_TVA__C cg JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((cg.PRODUCT_CATALOG_TVA__C = p.ID))) WHERE (cg.TERRITORY_TVA__C ~~ 'TR%'::varchar(3)) GROUP BY cg.ACCOUNT_TVA__C, cg.TERRITORY_TVA__C) cg ON (((cg.account_tva__c = acct.ID) AND (cg.territory_tva__c = g.DEVELOPERNAME)))) WHERE ((g.DEVELOPERNAME ~~ 'TR%'::varchar(3)) AND (acct.ISPERSONACCOUNT = 'true'::varchar(4)) AND (acct.ID IN (SELECT dw_call.VEEVA_ACCOUNT_ID AS veeva_account_id FROM WSMP_ADMIN.DW_CALL WHERE (dw_call.CALL_DATE > ((trunc(((statement_timestamp())::timestamp + 1::float), 'd'::varchar(1)) + (-2)::float) + (-42)::float)))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_survey_backup AS
((SELECT a.account_id, a.bu, a.survey_update_date, a.survey, a.question, a.answer, a.response_update_date, a.response_create_date FROM (SELECT yr.account_id, yr.bu, yr.survey_update_date, yr.survey, '*Future Scheduled Adasuve Formulary Review Date'::varchar(47) AS question, ((((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) || '-'::varchar(1)) || coalesce(lpad(dy.answer, 2, '0'::varchar(1)), '  '::varchar(2))) AS answer, yr.response_update_date, yr.response_create_date FROM (((SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Year'::varchar(47))) yr JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question ~~ '*Future Scheduled Adasuve % Review Month'::varchar(40))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c))) JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Future Scheduled Adasuve Formulary Review Date'::varchar(47))) dy ON ((yr.survey_target_vod__c = dy.survey_target_vod__c)))) a UNION ALL SELECT b.account_id, b.bu, b.survey_update_date, b.survey, b.question, b.answer, b.response_update_date, b.response_create_date FROM (SELECT yr.account_id, yr.bu, yr.survey_update_date, yr.survey, '*Prior Adasuve Formulary Review Date'::varchar(36) AS question, ((coalesce(yr.answer, '    '::varchar(4)) || '-'::varchar(1)) || CASE substr(mth.answer, 1, 3) WHEN NULLSEQUAL 'Jan'::varchar(3) THEN '01'::varchar(2) WHEN NULLSEQUAL 'Feb'::varchar(3) THEN '02'::varchar(2) WHEN NULLSEQUAL 'Mar'::varchar(3) THEN '03'::varchar(2) WHEN NULLSEQUAL 'Apr'::varchar(3) THEN '04'::varchar(2) WHEN NULLSEQUAL 'May'::varchar(3) THEN '05'::varchar(2) WHEN NULLSEQUAL 'Jun'::varchar(3) THEN '06'::varchar(2) WHEN NULLSEQUAL 'Jul'::varchar(3) THEN '07'::varchar(2) WHEN NULLSEQUAL 'Aug'::varchar(3) THEN '08'::varchar(2) WHEN NULLSEQUAL 'Sep'::varchar(3) THEN '09'::varchar(2) WHEN NULLSEQUAL 'Oct'::varchar(3) THEN '10'::varchar(2) WHEN NULLSEQUAL 'Nov'::varchar(3) THEN '11'::varchar(2) WHEN NULLSEQUAL 'Dec'::varchar(3) THEN '12'::varchar(2) ELSE '  '::varchar(2) END) AS answer, yr.response_update_date, yr.response_create_date FROM ((SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question = '*Prior Adasuve Formulary Review Year'::varchar(36))) yr JOIN (SELECT x.account_id, x.bu, x.survey, x.question, x.answer, x.response_create_date, x.response_update_date, x.answer_type, x.survey_target_vod__c, x.rnk, x.nm, x.survey_update_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question ~~ '*Prior Adasuve % Review Month'::varchar(29))) mth ON ((yr.survey_target_vod__c = mth.survey_target_vod__c)))) b) UNION ALL SELECT c.account_id, c.bu, c.survey_update_date, c.survey, c.question, c.answer, c.response_update_date, c.response_create_date FROM (SELECT x.account_id, x.bu, x.survey_update_date, x.survey, x.question, x.answer, x.response_update_date, x.response_create_date FROM (SELECT w.account_id, w.bu, w.survey, w.question, w.answer, w.response_create_date, w.response_update_date, w.answer_type, w.survey_target_vod__c, w.rnk, w.nm, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])))) x WHERE (x.question !~~ '%Adasuve%Review%'::varchar(16))) c) UNION ALL SELECT y.account_id, y.bu, y.survey_update_date, y.survey, y.question, y.answer, y.response_update_date, y.response_create_date FROM (SELECT w.account_id, w.bu, max(w.response_update_date) OVER (PARTITION BY w.account_id) AS survey_update_date, w.survey, w.question, w.answer, w.response_update_date, w.response_create_date FROM (SELECT st.ACCOUNT_VOD__C AS account_id, substr(s.TERRITORY_VOD__C, 1, 2) AS bu, coalesce(b.SURVEY_NAME, s.NAME) AS survey, coalesce(a.QUESTION_TEXT_VOD__C, sq.TEXT_VOD__C) AS question, CASE ty.NAME WHEN NULLSEQUAL 'Date_vod'::varchar(8) THEN to_char(qr.DATE_VOD__C, 'YYYY-MM-DD'::varchar(10)) WHEN NULLSEQUAL 'Text_vod'::varchar(8) THEN qr.TEXT_VOD__C ELSE qr.RESPONSE_VOD__C END AS answer, to_char(qr.CREATEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_create_date, to_char(qr.LASTMODIFIEDDATE, 'YYYY-MM-DD'::varchar(10)) AS response_update_date, ty.NAME AS answer_type, st.ID AS survey_target_vod__c, row_number() OVER (PARTITION BY st.ACCOUNT_VOD__C, sq.ID ORDER BY qr.LASTMODIFIEDDATE DESC) AS rnk, s.NAME AS nm FROM ((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_QUESTION_VOD__C sq ON ((s.ID = sq.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C st ON ((s.ID = st.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C qr ON (((st.ID = qr.SURVEY_TARGET_VOD__C) AND (sq.ID = qr.SURVEY_QUESTION_VOD__C)))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((qr.TYPE_VOD__C = ty.ID))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_QUESTION_ABBR a ON ((sq.ID = a.SURVEY_QUESTION_VOD__C))) LEFT JOIN WSMP_ADMIN.STG_VV_SURVEY_NAME_ABBR b ON ((s.ID = b.SURVEY_VOD__C)))) w WHERE ((w.rnk = 1) AND (w.nm = 'e-Rx Survey'::varchar(11)))) y;

CREATE  VIEW teva_ingestion.EXTERNAL_TABLE_CLEANUP AS
SELECT EXTERNAL_TABLE_CLEANUP_src.TABLE_NAME, EXTERNAL_TABLE_CLEANUP_src.ERROR_FLAG, CASE WHEN (EXTERNAL_TABLE_CLEANUP_src.NUM_ROWS = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXTERNAL_TABLE_CLEANUP_src.NUM_ROWS)::numeric(37,15) END AS NUM_ROWS, EXTERNAL_TABLE_CLEANUP_src.REMOVE, EXTERNAL_TABLE_CLEANUP_src.LOCATION, EXTERNAL_TABLE_CLEANUP_src.DIRECTORY_NAME, EXTERNAL_TABLE_CLEANUP_src.DIRECTORY_PATH, CASE WHEN (EXTERNAL_TABLE_CLEANUP_src.FILE_CREATE_DATE = ''::varchar) THEN NULL::timestamp ELSE (EXTERNAL_TABLE_CLEANUP_src.FILE_CREATE_DATE)::timestamp END AS FILE_CREATE_DATE, EXTERNAL_TABLE_CLEANUP_src.FILE_EXISTS, EXTERNAL_TABLE_CLEANUP_src.batch_id, EXTERNAL_TABLE_CLEANUP_src.row_id, EXTERNAL_TABLE_CLEANUP_src.update_ts FROM teva_ingestion.EXTERNAL_TABLE_CLEANUP_src WHERE (EXTERNAL_TABLE_CLEANUP_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXTERNAL_TABLE_CLEANUP'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_CAREMARK_RX2 AS
SELECT EXT_CAREMARK_RX2_src.MD_ID, EXT_CAREMARK_RX2_src.MD_LAST_NAME, EXT_CAREMARK_RX2_src.MD_FIRST_NAME, EXT_CAREMARK_RX2_src.PRESCRIBER_NPI, EXT_CAREMARK_RX2_src.MD_ADDR1, EXT_CAREMARK_RX2_src.MD_ADDR2, EXT_CAREMARK_RX2_src.MD_CITY, EXT_CAREMARK_RX2_src.MD_STATE, EXT_CAREMARK_RX2_src.MD_ZIP, EXT_CAREMARK_RX2_src.NDC_NUMBER, EXT_CAREMARK_RX2_src.SHIP_DATE, CASE WHEN (EXT_CAREMARK_RX2_src.QTY = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CAREMARK_RX2_src.QTY)::numeric(37,15) END AS QTY, EXT_CAREMARK_RX2_src.batch_id, EXT_CAREMARK_RX2_src.row_id, EXT_CAREMARK_RX2_src.update_ts FROM teva_ingestion.EXT_CAREMARK_RX2_src WHERE (EXT_CAREMARK_RX2_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_CAREMARK_RX2'::varchar(16))));

CREATE  VIEW teva_ingestion.EXT_CMOP_RX_DATA_TEVA_HIST AS
SELECT EXT_CMOP_RX_DATA_TEVA_HIST_src.CMOP, EXT_CMOP_RX_DATA_TEVA_HIST_src.VISN, EXT_CMOP_RX_DATA_TEVA_HIST_src.STATION_NUMBER, EXT_CMOP_RX_DATA_TEVA_HIST_src.STATION, EXT_CMOP_RX_DATA_TEVA_HIST_src.VA_PRODUCT, CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_RXS")::numeric(37,15) END AS "201012_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_TOTAL_QTY")::numeric(37,15) END AS "201012_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201012_30_DAY_RXS")::numeric(37,15) END AS "201012_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_RXS")::numeric(37,15) END AS "201101_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_TOTAL_QTY")::numeric(37,15) END AS "201101_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201101_30_DAY_RXS")::numeric(37,15) END AS "201101_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_RXS")::numeric(37,15) END AS "201102_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_TOTAL_QTY")::numeric(37,15) END AS "201102_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201102_30_DAY_RXS")::numeric(37,15) END AS "201102_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_RXS")::numeric(37,15) END AS "201103_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_TOTAL_QTY")::numeric(37,15) END AS "201103_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201103_30_DAY_RXS")::numeric(37,15) END AS "201103_30_DAY_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_RXS")::numeric(37,15) END AS "201104_TOTAL_RXS", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_QTY" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_TOTAL_QTY")::numeric(37,15) END AS "201104_TOTAL_QTY", CASE WHEN (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_30_DAY_RXS" = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_CMOP_RX_DATA_TEVA_HIST_src."201104_30_DAY_RXS")::numeric(37,15) END AS "201104_30_DAY_RXS", EXT_CMOP_RX_DATA_TEVA_HIST_src.ZIP, EXT_CMOP_RX_DATA_TEVA_HIST_src.batch_id, EXT_CMOP_RX_DATA_TEVA_HIST_src.row_id, EXT_CMOP_RX_DATA_TEVA_HIST_src.update_ts FROM teva_ingestion.EXT_CMOP_RX_DATA_TEVA_HIST_src WHERE (EXT_CMOP_RX_DATA_TEVA_HIST_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_CMOP_RX_DATA_TEVA_HIST'::varchar(26))));

CREATE  VIEW teva_ingestion.EXT_IMS_DEA AS
SELECT EXT_IMS_DEA_src.IMS_ID, EXT_IMS_DEA_src.FIRST_NAME, EXT_IMS_DEA_src.LAST_NAME, EXT_IMS_DEA_src.DEA_NUM, EXT_IMS_DEA_src.DEA_EXPIR_DATE, EXT_IMS_DEA_src.DEA_STATUS, EXT_IMS_DEA_src.NPI, EXT_IMS_DEA_src.batch_id, EXT_IMS_DEA_src.row_id, EXT_IMS_DEA_src.update_ts FROM teva_ingestion.EXT_IMS_DEA_src WHERE (EXT_IMS_DEA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_DEA'::varchar(11))));

CREATE  VIEW teva_ingestion.EXT_NTIS AS
SELECT EXT_NTIS_src.DEA_NUM, EXT_NTIS_src.BUSINESS_ACTIVITY_CODE, EXT_NTIS_src.DRUG_SCHEDULES, EXT_NTIS_src.EXPIRATION_DATE, EXT_NTIS_src.COMPANY_NAME, EXT_NTIS_src.ADDRESS_LINE1, EXT_NTIS_src.ADDRESS_LINE2, EXT_NTIS_src.ADDRESS_LINE3, EXT_NTIS_src.CITY, EXT_NTIS_src.STATE, EXT_NTIS_src.ZIP_CODE, EXT_NTIS_src.BASC, EXT_NTIS_src.PAYMENT_INDICATOR, EXT_NTIS_src.CONTROLLED_SUBSTANCE_AUTH, EXT_NTIS_src.batch_id, EXT_NTIS_src.row_id, EXT_NTIS_src.update_ts FROM teva_ingestion.EXT_NTIS_src WHERE (EXT_NTIS_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_NTIS'::varchar(8))));

CREATE  VIEW teva_ingestion.EXT_SIEBEL_BUS_ACCTS_TO_VEEVA AS
SELECT EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.SIEBELID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.VEEVA_ID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.EXTERNAL_ID_VOD__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.NAME, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.RECORDTYPEID, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.TYPE, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_STATUS_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_LOCATION_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ACCOUNT_MASTER_ID_TVA__C, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.ENDIT, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.batch_id, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.row_id, EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.update_ts FROM teva_ingestion.EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src WHERE (EXT_SIEBEL_BUS_ACCTS_TO_VEEVA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_SIEBEL_BUS_ACCTS_TO_VEEVA'::varchar(29))));

CREATE  VIEW teva_ingestion.EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA AS
SELECT EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.SIEBELID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.EXTERNAL_ID_VOD__C, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.VEEVA_ID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.INVEEVAALREADY, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.RECORDTYPEID, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.FIRSTNAME, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.LASTNAME, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.batch_id, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.row_id, EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.update_ts FROM teva_ingestion.EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src WHERE (EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_SIEBEL_PRSN_ACCTS_TO_VEEVA'::varchar(30))));

CREATE  VIEW teva_ingestion.EXT_TW_ICS_ASI AS
SELECT EXT_TW_ICS_ASI_src.BP_NUMBER, EXT_TW_ICS_ASI_src.HCP_ID, EXT_TW_ICS_ASI_src.TRANSACTION_DATE, EXT_TW_ICS_ASI_src.INVOICE_NUMBER, EXT_TW_ICS_ASI_src.ACCOUNT_TYPE, EXT_TW_ICS_ASI_src.CLASS_OF_TRADE, EXT_TW_ICS_ASI_src.TERRITORY_ID, EXT_TW_ICS_ASI_src.AREA_ID, EXT_TW_ICS_ASI_src.SHIP_TO_STREET, EXT_TW_ICS_ASI_src.SHIP_TO_CITY, EXT_TW_ICS_ASI_src.SHIP_TO_STATE, EXT_TW_ICS_ASI_src.SHIP_TO_ZIP, CASE WHEN (EXT_TW_ICS_ASI_src.DOLLARS_PARAGARD = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_TW_ICS_ASI_src.DOLLARS_PARAGARD)::numeric(37,15) END AS DOLLARS_PARAGARD, CASE WHEN (EXT_TW_ICS_ASI_src.UNITS_PARAGARD = ''::varchar) THEN NULL::numeric(37,15) ELSE (EXT_TW_ICS_ASI_src.UNITS_PARAGARD)::numeric(37,15) END AS UNITS_PARAGARD, EXT_TW_ICS_ASI_src.batch_id, EXT_TW_ICS_ASI_src.row_id, EXT_TW_ICS_ASI_src.update_ts FROM teva_ingestion.EXT_TW_ICS_ASI_src WHERE (EXT_TW_ICS_ASI_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_TW_ICS_ASI'::varchar(14))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Amrix_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['A00380'::varchar(6), 'A00100'::varchar(6), 'A00330'::varchar(6), 'A00210'::varchar(6), 'A00370'::varchar(6), 'A00220'::varchar(6), 'A00230'::varchar(6), 'A00350'::varchar(6), 'A00360'::varchar(6), 'A00240'::varchar(6), 'A00320'::varchar(6), 'A00250'::varchar(6), 'A00340'::varchar(6), 'A00260'::varchar(6), 'A00270'::varchar(6), 'A00280'::varchar(6), 'A00290'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Azilect_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['700105'::varchar(6), '700110'::varchar(6), '700210'::varchar(6), '700220'::varchar(6), '700310'::varchar(6), '700320'::varchar(6), '700410'::varchar(6), '700420'::varchar(6), '700510'::varchar(6), '700520'::varchar(6), '700530'::varchar(6), '700540'::varchar(6), '700550'::varchar(6), '700582'::varchar(6), '700584'::varchar(6), '700586'::varchar(6), '700588'::varchar(6), '700570'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx WHERE ((rx.product_code = ANY (ARRAY['100N00'::varchar(6), '100100'::varchar(6), '100120'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rxnormalizationControl2014_backup AS
SELECT p.IMS_CLIENT_NUM_W AS ClientNo, p.IMS_REPORT_NUM_W_CNT AS RxReportNo, lpad(p.IMS_PRODUCT_GROUP_NUM, 9, '0'::varchar(1)) AS ProductGroupNo, p.IMS_REPORT_NUM_W_QTY AS CorrespondingUnitsReportNo, p.PRODUCT_NAME AS ProductGroupName, nf.DIVISOR AS Divisor, nf.MULTIPLIER AS Multiplier FROM (WSMP_ADMIN.DRM45_PRODUCT_2014 p JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_onc AS
SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = ANY (ARRAY['ONC'::varchar(3), 'TO'::varchar(2)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ceph_sales_roster AS
SELECT DIM_CSF_SALES_ROSTER_TEVA.EMAIL AS email, DIM_CSF_SALES_ROSTER_TEVA.FIRST_NAME AS first_name, DIM_CSF_SALES_ROSTER_TEVA.LAST_NAME AS last_name, NULL AS PASSWORD, CASE WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'REP'::varchar(3)) THEN 'Sales Representative'::varchar(20) WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'AD'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) WHEN (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE = 'RM'::varchar(2)) THEN 'Regional Sales Manager'::varchar(22) ELSE NULL END AS rep_desc, DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE AS rep_type FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((DIM_CSF_SALES_ROSTER_TEVA.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TR'::varchar(2), 'TN'::varchar(2)])) AND (DIM_CSF_SALES_ROSTER_TEVA.LAST_NAME <> 'Vacant'::varchar(6)) AND (DIM_CSF_SALES_ROSTER_TEVA.REP_TYPE IS NOT NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_accountsummary AS
SELECT STG_TB_DS_ACCOUNTS.ACCOUNT_ID, STG_TB_DS_ACCOUNTS.LOCATION_ID, STG_TB_DS_ACCOUNTS.ACCOUNT_NAME, STG_TB_DS_ACCOUNTS.ACCOUNT_CLASS, STG_TB_DS_ACCOUNTS.ADDRESS_1, STG_TB_DS_ACCOUNTS.ADDRESS_2, STG_TB_DS_ACCOUNTS.CITY, STG_TB_DS_ACCOUNTS.STATE, STG_TB_DS_ACCOUNTS.ZIP FROM WSMP_ADMIN.STG_TB_DS_ACCOUNTS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Touchpoint_Presentation AS
SELECT STG_TOUCHPOINT_PRESENTATION.CALL_ID, STG_TOUCHPOINT_PRESENTATION.CALL_ATTEMPT_ID, STG_TOUCHPOINT_PRESENTATION.PRESENTATION_ID, STG_TOUCHPOINT_PRESENTATION.PRODUCT, STG_TOUCHPOINT_PRESENTATION."POSITION", STG_TOUCHPOINT_PRESENTATION.ITEM_TYPE, STG_TOUCHPOINT_PRESENTATION.ITEM_DESCRIPTION, STG_TOUCHPOINT_PRESENTATION.QUANTITY FROM WSMP_ADMIN.STG_TOUCHPOINT_PRESENTATION;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Touchpoint_Call AS
SELECT STG_TOUCHPOINT_CALL.CALL_ID, STG_TOUCHPOINT_CALL.CALL_ATTEMPT_ID, STG_TOUCHPOINT_CALL.TOUCHPOINT_ID, STG_TOUCHPOINT_CALL.CLIENT_ID, STG_TOUCHPOINT_CALL.IMS_ID, STG_TOUCHPOINT_CALL.FIRST_NAME, STG_TOUCHPOINT_CALL.LAST_NAME, STG_TOUCHPOINT_CALL.CALL_TYPE, STG_TOUCHPOINT_CALL.CALL_DATE, STG_TOUCHPOINT_CALL.STATUS_CODE, STG_TOUCHPOINT_CALL.STATUS_DESCRIPTION, STG_TOUCHPOINT_CALL.REP_ID, STG_TOUCHPOINT_CALL.REP_FIRST_NAME, STG_TOUCHPOINT_CALL.REP_LAST_NAME FROM WSMP_ADMIN.STG_TOUCHPOINT_CALL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_anda_sales_backup_2 AS
SELECT STG_ANDA_SALES.TRANSACTION_ID, to_char(STG_ANDA_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_ANDA_SALES.PRODUCT_BRAND, STG_ANDA_SALES.PRODUCT_NDC, STG_ANDA_SALES.PRODUCT_DESC, CASE mod(STG_ANDA_SALES.INVOICE_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_QTY)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_QTY)::varchar, '0'::varchar(1)) END AS INVOICE_QTY, CASE mod(STG_ANDA_SALES.INVOICE_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_UNITS)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_UNITS)::varchar, '0'::varchar(1)) END AS INVOICE_UNITS, CASE mod(STG_ANDA_SALES.INVOICE_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_COST)::varchar, '0'::varchar(1)) END AS INVOICE_COST, CASE mod(STG_ANDA_SALES.INVOICE_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_PACK_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_PACK_COST)::varchar, '0'::varchar(1)) END AS INVOICE_PACK_COST, CASE mod(STG_ANDA_SALES.INVOICE_UNIT_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.INVOICE_UNIT_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.INVOICE_UNIT_COST)::varchar, '0'::varchar(1)) END AS INVOICE_UNIT_COST, CASE mod(STG_ANDA_SALES.CONTRACT_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.CONTRACT_PACK_COST)::int)::varchar ELSE rtrim((STG_ANDA_SALES.CONTRACT_PACK_COST)::varchar, '0'::varchar(1)) END AS CONTRACT_PACK_COST, CASE mod(STG_ANDA_SALES.CONTRACT_PURCHASES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.CONTRACT_PURCHASES)::int)::varchar ELSE rtrim((STG_ANDA_SALES.CONTRACT_PURCHASES)::varchar, '0'::varchar(1)) END AS CONTRACT_PURCHASES, STG_ANDA_SALES.CONTRACT_NUMBER, STG_ANDA_SALES.DISPENSING_LOCATION, STG_ANDA_SALES.DL_ADDRESS_1, STG_ANDA_SALES.DL_ADDRESS_2, STG_ANDA_SALES.DL_CITY, STG_ANDA_SALES.DL_STATE, STG_ANDA_SALES.DL_ZIP, STG_ANDA_SALES.DL_DEA_NUM, STG_ANDA_SALES.DEPOT_LOCATION, STG_ANDA_SALES.DEP_ADDRESS_1, STG_ANDA_SALES.DEP_ADDRESS_2, STG_ANDA_SALES.DEP_CITY, STG_ANDA_SALES.DEP_STATE, STG_ANDA_SALES.DEP_ZIP, STG_ANDA_SALES.DEP_DEA_NUM, CASE mod(STG_ANDA_SALES.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.UNIT_AP)::int)::varchar ELSE rtrim((STG_ANDA_SALES.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_ANDA_SALES.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_ANDA_SALES.AP)::int)::varchar ELSE rtrim((STG_ANDA_SALES.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_ANDA_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_omnicare_sale AS
SELECT STG_OMNICARE_SALES.TRANSACTION_ID, to_char(STG_OMNICARE_SALES.INVOICE_DATE, 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, STG_OMNICARE_SALES.PRODUCT_BRAND, STG_OMNICARE_SALES.PRODUCT_NDC, STG_OMNICARE_SALES.PRODUCT_DESC, CASE mod(STG_OMNICARE_SALES.INVOICE_QTY, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_QTY)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_QTY)::varchar, '0'::varchar(1)) END AS INVOICE_QTY, CASE mod(STG_OMNICARE_SALES.INVOICE_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_UNITS)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_UNITS)::varchar, '0'::varchar(1)) END AS INVOICE_UNITS, CASE mod(STG_OMNICARE_SALES.INVOICE_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_COST)::varchar, '0'::varchar(1)) END AS INVOICE_COST, CASE mod(STG_OMNICARE_SALES.INVOICE_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_PACK_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_PACK_COST)::varchar, '0'::varchar(1)) END AS INVOICE_PACK_COST, CASE mod(STG_OMNICARE_SALES.INVOICE_UNIT_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.INVOICE_UNIT_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.INVOICE_UNIT_COST)::varchar, '0'::varchar(1)) END AS INVOICE_UNIT_COST, CASE mod(STG_OMNICARE_SALES.CONTRACT_PACK_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.CONTRACT_PACK_COST)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.CONTRACT_PACK_COST)::varchar, '0'::varchar(1)) END AS CONTRACT_PACK_COST, CASE mod(STG_OMNICARE_SALES.CONTRACT_PURCHASES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.CONTRACT_PURCHASES)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.CONTRACT_PURCHASES)::varchar, '0'::varchar(1)) END AS CONTRACT_PURCHASES, STG_OMNICARE_SALES.CONTRACT_NUMBER, STG_OMNICARE_SALES.DISPENSING_LOCATION, STG_OMNICARE_SALES.DL_ADDRESS_1, STG_OMNICARE_SALES.DL_ADDRESS_2, STG_OMNICARE_SALES.DL_CITY, STG_OMNICARE_SALES.DL_STATE, STG_OMNICARE_SALES.DL_ZIP, STG_OMNICARE_SALES.DL_DEA_NUM, STG_OMNICARE_SALES.DEPOT_LOCATION, STG_OMNICARE_SALES.DEP_ADDRESS_1, STG_OMNICARE_SALES.DEP_ADDRESS_2, STG_OMNICARE_SALES.DEP_CITY, STG_OMNICARE_SALES.DEP_STATE, STG_OMNICARE_SALES.DEP_ZIP, STG_OMNICARE_SALES.DEP_DEA_NUM, CASE mod(STG_OMNICARE_SALES.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.UNIT_AP)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_OMNICARE_SALES.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_OMNICARE_SALES.AP)::int)::varchar ELSE rtrim((STG_OMNICARE_SALES.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_OMNICARE_SALES;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_cb_transactions AS
SELECT STG_TB_CB_TRANSACTIONS.ACCOUNT_ID, STG_TB_CB_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_CB_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_CB_TRANSACTIONS.NDC_CODE, STG_TB_CB_TRANSACTIONS.PRODUCT_NAME, STG_TB_CB_TRANSACTIONS.CONTRACT_ID, CASE mod(STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CHARGEBACK_UNITS)::varchar, '0'::varchar(1)) END AS CHARGEBACK_UNITS, CASE mod(STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CHARGEBACK_DOLLARS)::varchar, '0'::varchar(1)) END AS CHARGEBACK_DOLLARS, to_char(STG_TB_CB_TRANSACTIONS.RECEIPT_DATE, 'YYYY-MM-DD'::varchar(10)) AS RECEIPT_DATE, CASE mod(STG_TB_CB_TRANSACTIONS.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.UNIT_AP)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_TB_CB_TRANSACTIONS.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.AP)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.AP)::varchar, '0'::varchar(1)) END AS AP, STG_TB_CB_TRANSACTIONS.DEBIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS CREDIT_MEMO_DATE, STG_TB_CB_TRANSACTIONS.CREDIT_MEMO_NUM, to_char(STG_TB_CB_TRANSACTIONS.SETTLEMENT_DATE, 'YYYY-MM-DD HH24:MI:SS'::varchar(21)) AS SETTLEMENT_DATE, CASE mod(STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE)::int)::varchar ELSE rtrim((STG_TB_CB_TRANSACTIONS.CONTRACT_PRICE)::varchar, '0'::varchar(1)) END AS CONTRACT_PRICE, STG_TB_CB_TRANSACTIONS.CONTRACT_ALIAS FROM WSMP_ADMIN.STG_TB_CB_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_tb_ds_transactions AS
SELECT STG_TB_DS_TRANSACTIONS.ACCOUNT_ID, STG_TB_DS_TRANSACTIONS.LOCATION_ID, to_char(STG_TB_DS_TRANSACTIONS.SHIPMENT_DATE, 'YYYY-MM-DD'::varchar(10)) AS SHIPMENT_DATE, STG_TB_DS_TRANSACTIONS.NDC_CODE, STG_TB_DS_TRANSACTIONS.PRODUCT_NAME, STG_TB_DS_TRANSACTIONS.TRANSACTION_TYPE, CASE mod(STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_UNITS)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_UNITS, CASE mod(STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.DIRECT_SALES_DOLLARS)::varchar, '0'::varchar(1)) END AS DIRECT_SALES_DOLLARS, CASE mod(STG_TB_DS_TRANSACTIONS.UNIT_AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.UNIT_AP)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.UNIT_AP)::varchar, '0'::varchar(1)) END AS UNIT_AP, CASE mod(STG_TB_DS_TRANSACTIONS.AP, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TB_DS_TRANSACTIONS.AP)::int)::varchar ELSE rtrim((STG_TB_DS_TRANSACTIONS.AP)::varchar, '0'::varchar(1)) END AS AP FROM WSMP_ADMIN.STG_TB_DS_TRANSACTIONS;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_rems_account AS
SELECT stg.ASI_ACCOUNT_ID AS HCP_ID, align.TERRITORY_NUM AS territory_num, stg.SITE_NAME AS ACCOUNT_NAME, stg.ADDRESS_1 AS ADDRESS1, stg.ADDRESS_2 AS ADDRESS2, NULL AS ADDRESS3, stg.CITY, stg.STATE, stg.ZIP_CODE AS ZIP, 'Y'::varchar(1) AS PRIMARY_ADDRESS, stg.PHONE_NUMBER, fact.IMS_ORG_ID AS EXTERNAL_ID, 'HOSPITAL'::varchar(8) AS CUSTOMER_TYPE, NULL AS BPNUMBER, NULL AS SUBTYPE, NULL AS CM_ID FROM ((WSMP_ADMIN.STG_REMS_FACILITY stg LEFT JOIN (SELECT kc_zip_to_territory.ZIP, kc_zip_to_territory.CITY, kc_zip_to_territory.STATE, kc_zip_to_territory.TERRITORY_NUM, kc_zip_to_territory.IS_A_MIRROR, kc_zip_to_territory.MIRROR_TERRITORY_NUM, kc_zip_to_territory.TERRITORY_NAME, kc_zip_to_territory.AREA_NAME, kc_zip_to_territory.REGION_NAME, kc_zip_to_territory.SALES_FORCE_ID, kc_zip_to_territory.ORGANIZATION_CODE, kc_zip_to_territory.COMMENTS FROM WSMP_ADMIN.KC_ZIP_TO_TERRITORY WHERE (kc_zip_to_territory.SALES_FORCE_ID = 'TB'::varchar(2))) align ON ((substr(stg.ZIP_CODE, 1, 5) = align.ZIP))) LEFT JOIN WSMP_ADMIN.HCOS_IDENTIFIER_FACT fact ON (((fact.IDENTIFIER_ID = 15::numeric(18,0)) AND (fact.IDENTIFIER = stg.NPI)))) WHERE (stg.VEEVA_ACCOUNT_ID IS NULL);

CREATE  VIEW teva_ingestion.EXT_IMS_DDD_CHANGE_LOG AS
SELECT btrim(EXT_IMS_DDD_CHANGE_LOG_src.CONSTANT) AS CONSTANT, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CLI_SFX) AS CLI_SFX, btrim(EXT_IMS_DDD_CHANGE_LOG_src.NOT_USED) AS NOT_USED, btrim(EXT_IMS_DDD_CHANGE_LOG_src."TERR#") AS "TERR#", btrim(EXT_IMS_DDD_CHANGE_LOG_src."OUTLET#") AS "OUTLET#", btrim(EXT_IMS_DDD_CHANGE_LOG_src.OUTLET_NAME) AS OUTLET_NAME, btrim(EXT_IMS_DDD_CHANGE_LOG_src.ADDRESS) AS ADDRESS, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CITY) AS CITY, btrim(EXT_IMS_DDD_CHANGE_LOG_src.STATE) AS STATE, btrim(EXT_IMS_DDD_CHANGE_LOG_src.SUBCAT) AS SUBCAT, btrim(EXT_IMS_DDD_CHANGE_LOG_src.CODE) AS CODE, EXT_IMS_DDD_CHANGE_LOG_src.batch_id, EXT_IMS_DDD_CHANGE_LOG_src.row_id, EXT_IMS_DDD_CHANGE_LOG_src.update_ts FROM teva_ingestion.EXT_IMS_DDD_CHANGE_LOG_src WHERE (EXT_IMS_DDD_CHANGE_LOG_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_DDD_CHANGE_LOG'::varchar(22))));

CREATE  VIEW teva_ingestion.EXT_IMS_PDRP AS
SELECT btrim(EXT_IMS_PDRP_src.IMS_ID) AS IMS_ID, btrim(EXT_IMS_PDRP_src.FILLER_01) AS FILLER_01, btrim(EXT_IMS_PDRP_src.FILLER_02) AS FILLER_02, btrim(EXT_IMS_PDRP_src.ME_NBR) AS ME_NBR, btrim(EXT_IMS_PDRP_src.LAST_NAME) AS LAST_NAME, btrim(EXT_IMS_PDRP_src.FIRST_NAME) AS FIRST_NAME, btrim(EXT_IMS_PDRP_src.MIDDLE) AS MIDDLE, btrim(EXT_IMS_PDRP_src.FILLER_03) AS FILLER_03, CASE WHEN (EXT_IMS_PDRP_src.PDRP_DATE = ''::varchar) THEN NULL::timestamp ELSE (btrim(EXT_IMS_PDRP_src.PDRP_DATE))::timestamp END AS PDRP_DATE, EXT_IMS_PDRP_src.batch_id, EXT_IMS_PDRP_src.row_id, EXT_IMS_PDRP_src.update_ts FROM teva_ingestion.EXT_IMS_PDRP_src WHERE (EXT_IMS_PDRP_src.batch_id = (SELECT max(teva_ingestion_control.batch_id) AS max FROM teva_ingestion.teva_ingestion_control WHERE (teva_ingestion_control.file_class = 'EXT_IMS_PDRP'::varchar(12))));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_paragard_anda_sales AS
SELECT ('A'::varchar(1) || btrim(to_char(STG_TW_ANDA_SALES.CUSTOMER_NO, '000000000'::varchar(9)))) AS BP_CODE, NULL AS ORTHO_E, STG_TW_ANDA_SALES.CUSTOMER AS BP_NAME, coalesce(STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE2, STG_TW_ANDA_SALES.CUSTOMER_ADDRESS_LINE1) AS SHIP_TO_ADDRESS, STG_TW_ANDA_SALES.CITY AS SHIP_TO_CITY, STG_TW_ANDA_SALES.STATE AS SHIP_TO_STATE, STG_TW_ANDA_SALES.ZIP AS SHIP_TO_ZIP_CODE, NULL AS SHIP_TO_COUNTRY, NULL AS SHIP_TO_PHONE, NULL AS SHIP_TO_FAX, NULL AS SHIP_TO_EMAIL, coalesce(STG_TW_ANDA_SALES.BILL_ADDRESS_LINE2, STG_TW_ANDA_SALES.BILL_ADDRESS_LINE1) AS BILL_TO_ADDRESS, STG_TW_ANDA_SALES.BILL_CITY AS BILL_TO_CITY, STG_TW_ANDA_SALES.BILL_STATE AS BILL_TO_STATE, STG_TW_ANDA_SALES.BILL_ZIP AS BILL_TO_ZIP_CODE, NULL AS BILL_TO_COUNTRY, NULL AS BILL_TO_PHONE, NULL AS BILL_TO_FAX, NULL AS BILL_TO_EMAIL, CASE mod(STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.CUSTOMER_TYPE_CD)::varchar, '0'::varchar(1)) END AS CLASS_OF_TRADE, CASE mod(STG_TW_ANDA_SALES.ORDER_NO, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.ORDER_NO)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.ORDER_NO)::varchar, '0'::varchar(1)) END AS INVOICE_NUM, CASE mod(STG_TW_ANDA_SALES.NET_COST, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.NET_COST)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.NET_COST)::varchar, '0'::varchar(1)) END AS DEL_AMT, to_char(to_date(STG_TW_ANDA_SALES.SALES_DATE, 'MM/DD/YY'::varchar(8)), 'YYYY-MM-DD'::varchar(10)) AS INVOICE_DATE, CASE mod(STG_TW_ANDA_SALES.UNITS_NET, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.UNITS_NET)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.UNITS_NET)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(STG_TW_ANDA_SALES.PACKAGE_SIZE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.PACKAGE_SIZE)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.PACKAGE_SIZE)::varchar, '0'::varchar(1)) END AS PACKS, NULL AS UNIT_PRICE, NULL AS TERRITORY, NULL AS ORDER_TYPE_CODE, NULL AS ORDER_TYPE_DESC, NULL AS LOB_CODE_DESC, NULL AS PRICE_MATRIX_DEF, ('A'::varchar(1) || btrim(to_char(STG_TW_ANDA_SALES.BILL_CUSTOMER_NO, '000000000'::varchar(9)))) AS PARENT_BP_CODE, NULL AS PARENT_BP_DESC, NULL AS GRAND_PARENT_BP_DESC, NULL AS PO_NUMBER, NULL AS UPS_NUMBER, CASE mod(STG_TW_ANDA_SALES.ORDER_NO, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_TW_ANDA_SALES.ORDER_NO)::int)::varchar ELSE rtrim((STG_TW_ANDA_SALES.ORDER_NO)::varchar, '0'::varchar(1)) END AS ORDER_NUMBER, NULL AS ORDER_LINE_NUMBER, NULL AS DISC_AMT, NULL AS WHSE_CD FROM WSMP_ADMIN.STG_TW_ANDA_SALES WHERE (STG_TW_ANDA_SALES.BRAND ~~ '%PARAGARD%'::varchar(10));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_extract AS
SELECT coalesce(r.VEEVA_ACCOUNT_ID, r.IMS_ID) AS account_id, r.ENROLLMENT_ID AS enrollment_id, r.NPI AS npi, r.DEA_NUM AS dea_num, (r.PROGRAM_ID)::int AS program_id, substr(r.PROGRAM_NAME, 1, 4) AS REMS_PROGRAM, r.STATUS AS enrollment_status, r.IN_PROGRESS_STEP AS current_enrollment_step, to_char(r.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(r.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT coalesce(STG_REMS_FACILITY.VEEVA_ACCOUNT_ID, STG_REMS_FACILITY.ASI_ACCOUNT_ID) AS account_id, STG_REMS_FACILITY.ENROLLMENT_ID AS enrollment_id, STG_REMS_FACILITY.NPI AS npi, STG_REMS_FACILITY.DEA AS dea, (STG_REMS_FACILITY.PROGRAM_ID)::int AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS REMS_program, STG_REMS_FACILITY.STATUS_DESCRIPTION AS enrollment_status, STG_REMS_FACILITY.IN_PROGRESS_STEP AS current_enrollment_step, to_char(STG_REMS_FACILITY.EFFECTIVE_DATE, 'YYYY-MM-DD'::varchar(10)) AS effective_date, to_char(STG_REMS_FACILITY.EXPIRATION_DATE, 'YYYY-MM-DD'::varchar(10)) AS expiration_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_rems_program_lookup AS
SELECT (r.PROGRAM_ID)::int AS program_id, r.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r UNION SELECT (STG_REMS_FACILITY.PROGRAM_ID)::int AS program_id, STG_REMS_FACILITY.PROGRAM_NAME AS program_name FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ddd_category AS
SELECT DIM_DDD_CATEGORY.CATEGORY_CODE, DIM_DDD_CATEGORY.CATEGORY_DESC, DIM_DDD_CATEGORY.CATEGORY_DEFN FROM WSMP_ADMIN.DIM_DDD_CATEGORY ORDER BY DIM_DDD_CATEGORY.CATEGORY_CODE LIMIT 100;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_BrandedIMS_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, coalesce(demo.veeva_account_id, rx.ims_id) AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1.000) THEN rx.trx_cnt ELSE 0.000 END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-019'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-15-001'::varchar(10), '330-15-002'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND ((rx.payment_method ~~ '%MEDICAID%'::varchar(10)) OR (rx.payer_plan_num = ANY (ARRAY['7001720001'::varchar(10), '0013670087'::varchar(10)])))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, coalesce(demo.veeva_account_id, rx.ims_id), rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_BrandedIMS_MoP AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-019'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-15-001'::varchar(10), '330-15-002'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-12-003'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-001'::varchar(10)) THEN 'QNASL 80'::varchar(8) WHEN (rx.product_code = '330-15-002'::varchar(10)) THEN 'QNASL 40'::varchar(8) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-040'::varchar(10)) THEN 'ZETONNA'::varchar(7) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ICS_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-13-010'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-008'::varchar(10), '330-13-011'::varchar(10), '330-13-017'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ics_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) ELSE 'UNKOWN'::varchar(6) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-13-010'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-008'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-13-017'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-16-020'::varchar(10)) THEN 'AEROSPAN'::varchar(8) WHEN (rx.product_code = '330-13-010'::varchar(10)) THEN 'AEROBID'::varchar(7) WHEN (rx.product_code = '330-13-021'::varchar(10)) THEN 'ALVESCO'::varchar(7) WHEN (rx.product_code = '330-13-016'::varchar(10)) THEN 'ASMANEX'::varchar(7) WHEN (rx.product_code = '330-13-008'::varchar(10)) THEN 'AZMACORT'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10)])) THEN 'FLOVENT'::varchar(7) WHEN (rx.product_code = '330-13-009'::varchar(10)) THEN 'PULMICORT'::varchar(9) WHEN (rx.product_code = ANY (ARRAY['330-13-005'::varchar(10), '330-13-006'::varchar(10)])) THEN 'QVAR'::varchar(4) WHEN (rx.product_code = '330-13-011'::varchar(10)) THEN 'ARNUITY ELLIPTA'::varchar(15) WHEN (rx.product_code = '330-13-017'::varchar(10)) THEN 'ASMANEX HFA MDI'::varchar(15) ELSE 'UNKOWN'::varchar(6) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_NASAL_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_nasal_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-15-005'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-15-015'::varchar(10), '330-15-025'::varchar(10), '330-15-030'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-15-005'::varchar(10)) THEN 'FLONASE'::varchar(7) WHEN (rx.product_code = '330-15-010'::varchar(10)) THEN 'FLUTICASONE'::varchar(11) WHEN (rx.product_code = '330-15-019'::varchar(10)) THEN 'NASACORT'::varchar(8) WHEN (rx.product_code = '330-15-015'::varchar(10)) THEN 'NASONEX'::varchar(7) WHEN (rx.product_code = '330-15-025'::varchar(10)) THEN 'OMNARIS'::varchar(7) WHEN (rx.product_code = '330-15-030'::varchar(10)) THEN 'RHINOCORT'::varchar(9) WHEN (rx.product_code = '330-15-047'::varchar(10)) THEN 'VERAMYST'::varchar(8) WHEN (rx.product_code = '330-15-050'::varchar(10)) THEN 'OTHER (NASAL)'::varchar(13) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_SABA_MedicaidPlanGroups AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, rx.payer_plan_num AS plan_code, rx.plan_name, rx.model, rx.payer_name AS plan_group, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-16-056'::varchar(10), '330-14-006'::varchar(10)])) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.payment_method ~~ '%MEDICAID%'::varchar(10))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = ANY (ARRAY['330-16-056'::varchar(10), '330-14-006'::varchar(10)])) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_saba_mop AS
SELECT CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END AS ims_id, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END AS hcp_id, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)) AS payment_method, CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = '330-14-006'::varchar(10)) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END AS product, (sum(CASE WHEN (rx.month_bucket = 24::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth24, (sum(CASE WHEN (rx.month_bucket = 23::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth23, (sum(CASE WHEN (rx.month_bucket = 22::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth22, (sum(CASE WHEN (rx.month_bucket = 21::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth21, (sum(CASE WHEN (rx.month_bucket = 20::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth20, (sum(CASE WHEN (rx.month_bucket = 19::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth19, (sum(CASE WHEN (rx.month_bucket = 18::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth18, (sum(CASE WHEN (rx.month_bucket = 17::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth17, (sum(CASE WHEN (rx.month_bucket = 16::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth16, (sum(CASE WHEN (rx.month_bucket = 15::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth15, (sum(CASE WHEN (rx.month_bucket = 14::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth14, (sum(CASE WHEN (rx.month_bucket = 13::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth13, (sum(CASE WHEN (rx.month_bucket = 12::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth12, (sum(CASE WHEN (rx.month_bucket = 11::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth11, (sum(CASE WHEN (rx.month_bucket = 10::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth10, (sum(CASE WHEN (rx.month_bucket = 9::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth9, (sum(CASE WHEN (rx.month_bucket = 8::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth8, (sum(CASE WHEN (rx.month_bucket = 7::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth7, (sum(CASE WHEN (rx.month_bucket = 6::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth6, (sum(CASE WHEN (rx.month_bucket = 5::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth5, (sum(CASE WHEN (rx.month_bucket = 4::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth4, (sum(CASE WHEN (rx.month_bucket = 3::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth3, (sum(CASE WHEN (rx.month_bucket = 2::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth2, (sum(CASE WHEN (rx.month_bucket = 1::numeric(18,0)) THEN rx.trx_cnt ELSE 0::numeric(18,0) END))::numeric(18,3) AS trx_mth1 FROM (WSMP_ADMIN.dw_presc_plan_rx_w rx LEFT JOIN (SELECT iq1.ims_id, iq1.veeva_account_id FROM (SELECT VV_ACCOUNT.ID_VOD__C AS ims_id, VV_ACCOUNT.ID AS veeva_account_id, row_number() OVER (PARTITION BY VV_ACCOUNT.ID_VOD__C ORDER BY VV_ACCOUNT.ID) AS rnk FROM WSMP_ADMIN.VV_ACCOUNT WHERE (VV_ACCOUNT.ID_VOD__C IS NOT NULL)) iq1 WHERE (iq1.rnk = 1)) demo ON ((demo.ims_id = rx.ims_id))) WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-002'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-14-004'::varchar(10), '330-14-006'::varchar(10), '330-14-005'::varchar(10)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0))) GROUP BY CASE WHEN (length(rx.ims_id) = 8) THEN ('XX'::varchar(2) || substr(rx.ims_id, 4)) ELSE rx.ims_id END, CASE WHEN (length(rx.ims_id) = 8) THEN NULL ELSE coalesce(demo.veeva_account_id, rx.ims_id) END, coalesce(rx.payment_method, 'COMMERCIAL 3RD PTY'::varchar(18)), CASE WHEN (rx.product_code = '330-14-001'::varchar(10)) THEN 'ALBUTEROL CFC'::varchar(13) WHEN (rx.product_code = '330-14-007'::varchar(10)) THEN 'MAXAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-14-009'::varchar(10), '330-14-002'::varchar(10)])) THEN 'PROAIR'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-050'::varchar(10), '330-14-003'::varchar(10)])) THEN 'PROVENTIL'::varchar(9) WHEN (rx.product_code = '330-14-008'::varchar(10)) THEN 'RELION'::varchar(6) WHEN (rx.product_code = ANY (ARRAY['330-16-055'::varchar(10), '330-14-004'::varchar(10)])) THEN 'VENTOLIN'::varchar(8) WHEN (rx.product_code = '330-14-006'::varchar(10)) THEN 'XOPENEX'::varchar(7) WHEN (rx.product_code = '330-14-005'::varchar(10)) THEN 'OTHER (SABA)'::varchar(12) ELSE 'UNKNOWN'::varchar(7) END;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_nuvigil_demo AS
SELECT CASE mod(dem.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((dem.tvcmid)::int)::varchar ELSE rtrim((dem.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, dem.ims_id, dem.veeva_account_id, initcap(dem.first_name) AS first_name, initcap(dem.middle_name) AS middle_name, initcap(dem.last_name) AS last_name, dem.DEGREE, initcap(dem.address1) AS address1, initcap(dem.address2) AS address2, initcap(dem.address3) AS address3, initcap(dem.city) AS city, dem.state, dem.zip, dem.prim_specialty, dem.nuvigil_report_group, dec1.trx_cnt_01_06 AS nuvigil_decile, dec2.trx_cnt_01_06 AS wake_decile FROM (((SELECT demo.tvcmid, demo.ims_id, demo.veeva_account_id, demo.first_name, demo.middle_name, demo.last_name, demo.DEGREE, demo.address1, demo.address2, demo.address3, demo.city, demo.state, demo.zip, demo.prim_specialty, demo.nuvigil_report_group, demo.source_rank, rank() OVER (PARTITION BY demo.tvcmid, demo.ims_id ORDER BY demo.source_rank) AS demo_rank FROM (SELECT d.TVCMID AS tvcmid, d.IMS_ID AS ims_id, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.FIRST_NAME AS first_name, d.MIDDLE_NAME AS middle_name, d.LAST_NAME AS last_name, d.CREDENTIALS AS DEGREE, d.ADDRESS1 AS address1, d.ADDRESS2 AS address2, d.ADDRESS3 AS address3, d.CITY AS city, d.STATE AS state, d.ZIP AS zip, coalesce(d2.specialty, coalesce(s1.SPECIALTY_CODE, coalesce(s2.specialty_code, d.PRIM_SPECIALTY))) AS prim_specialty, coalesce(s1.NUVIGIL_REPORT_GROUP, s2.nuvigil_report_group) AS nuvigil_report_group, 1 AS source_rank FROM (((WSMP_ADMIN.DIM_SFA_CSF_DEMO d LEFT JOIN WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d2 ON (((d2.ims_id = d.IMS_ID) AND (d2.sales_force_id = 'TC'::varchar(2))))) LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.PRIM_SPECIALTY))) LEFT JOIN (SELECT TFC_SPECIALTY_XREF.SPECIALTY_CODE AS specialty_code, TFC_SPECIALTY_XREF.SPECIALTY_DESC AS specialty_desc, TFC_SPECIALTY_XREF.NUVIGIL_REPORT_GROUP AS nuvigil_report_group FROM WSMP_ADMIN.TFC_SPECIALTY_XREF WHERE (TFC_SPECIALTY_XREF.SPECIALTY_CODE IN (SELECT iq1.specialty_code FROM (SELECT TFC_SPECIALTY_XREF.SPECIALTY_DESC AS specialty_desc, min(TFC_SPECIALTY_XREF.SPECIALTY_CODE) AS specialty_code FROM WSMP_ADMIN.TFC_SPECIALTY_XREF GROUP BY TFC_SPECIALTY_XREF.SPECIALTY_DESC) iq1))) s2 ON ((upper(CASE d.PRIM_SPECIALTY WHEN NULLSEQUAL 'Other'::varchar(5) THEN 'OTHER SPECIALTY'::varchar(15) ELSE d.PRIM_SPECIALTY END) = s2.specialty_desc))) WHERE ((d.SALES_FORCE_ID = 'TC'::varchar(2)) AND (d.DEMO_TYPE = 'PROF'::varchar(4)) AND (d.DEMO_RANK = 1::numeric(18,0))) UNION ALL SELECT s1.tvcmid, s1.ims_id, NULL AS siebel_id, s1.first_name, s1.mid_name, s1.last_name, s1.DEGREE AS degree, s1.address1, s1.address2, s1.address3, s1.city, s1.state, s1.zip, s1.prim_specialty, s1.nuvigil_report_group, s1.source_rank FROM (SELECT cm1.TVCMID AS tvcmid, d.ims_id, cm1.ID_NUM AS siebel_id, d.first_name, d.mid_name, d.last_name, NULL AS DEGREE, d.ptr_address AS address1, NULL AS address2, NULL AS address3, d.ptr_city AS city, d.ptr_state AS state, d.ptr_zip AS zip, d.specialty AS prim_specialty, s1.NUVIGIL_REPORT_GROUP AS nuvigil_report_group, 2 AS source_rank FROM ((WSMP_ADMIN.TFC_IMS_PRESC_DEMO_M d LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.specialty))) LEFT JOIN WSMP_ADMIN.tvcmid_xref cm1 ON (((cm1.ID_NUM = d.ims_id) AND (cm1.ID_TYPE = 'IMS_ID'::varchar(6))))) WHERE (d.sales_force_id = 'TC'::varchar(2))) s1) demo) dem LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec1 ON (((dec1.ims_id = dem.ims_id) AND (dec1.category = 'Provigil'::varchar(8)) AND (dec1.decile_name = 'Nuvigil'::varchar(7))))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec2 ON (((dec2.ims_id = dem.ims_id) AND (dec2.category = 'Provigil'::varchar(8)) AND (dec2.decile_name = 'Modafinil'::varchar(9))))) WHERE (dem.demo_rank = 1);

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_CNT_M AS
SELECT CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_CNT_M_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_CNT_M_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_CNT_M_src.ndc) AS ndc, btrim(EXT_IMS_MHK_CNT_M_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_CNT_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_CNT_M_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_CNT_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_CNT_M_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_CNT_M_src.me_num) AS me_num, btrim(EXT_IMS_MHK_CNT_M_src.last_name) AS last_name, btrim(EXT_IMS_MHK_CNT_M_src.first_name) AS first_name, btrim(EXT_IMS_MHK_CNT_M_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_CNT_M_src.address) AS address, btrim(EXT_IMS_MHK_CNT_M_src.city) AS city, btrim(EXT_IMS_MHK_CNT_M_src.state) AS state, btrim(EXT_IMS_MHK_CNT_M_src.zip) AS zip, btrim(EXT_IMS_MHK_CNT_M_src.specialty) AS specialty, btrim(EXT_IMS_MHK_CNT_M_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_CNT_M_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_CNT_M_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_CNT_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_M_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_CNT_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_CNT_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_M_src.trx_024))::numeric(9,3) END AS trx_024, EXT_IMS_MHK_CNT_M_src.batch_id, EXT_IMS_MHK_CNT_M_src.row_id, EXT_IMS_MHK_CNT_M_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_CNT_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_CNT_W AS
SELECT CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_CNT_W_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_CNT_W_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_CNT_W_src.ndc) AS ndc, btrim(EXT_IMS_MHK_CNT_W_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_CNT_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_CNT_W_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_CNT_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_CNT_W_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_CNT_W_src.me_num) AS me_num, btrim(EXT_IMS_MHK_CNT_W_src.last_name) AS last_name, btrim(EXT_IMS_MHK_CNT_W_src.first_name) AS first_name, btrim(EXT_IMS_MHK_CNT_W_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_CNT_W_src.address) AS address, btrim(EXT_IMS_MHK_CNT_W_src.city) AS city, btrim(EXT_IMS_MHK_CNT_W_src.state) AS state, btrim(EXT_IMS_MHK_CNT_W_src.zip) AS zip, btrim(EXT_IMS_MHK_CNT_W_src.specialty) AS specialty, btrim(EXT_IMS_MHK_CNT_W_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_CNT_W_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_CNT_W_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_CNT_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_CNT_W_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (EXT_IMS_MHK_CNT_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (EXT_IMS_MHK_CNT_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_CNT_W_src.trx_132))::numeric(9,3) END AS trx_132, EXT_IMS_MHK_CNT_W_src.batch_id, EXT_IMS_MHK_CNT_W_src.row_id, EXT_IMS_MHK_CNT_W_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_CNT_W_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_QTY_M AS
SELECT CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_QTY_M_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_QTY_M_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_QTY_M_src.ndc) AS ndc, btrim(EXT_IMS_MHK_QTY_M_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_QTY_M_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_QTY_M_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_QTY_M_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_QTY_M_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_QTY_M_src.me_num) AS me_num, btrim(EXT_IMS_MHK_QTY_M_src.last_name) AS last_name, btrim(EXT_IMS_MHK_QTY_M_src.first_name) AS first_name, btrim(EXT_IMS_MHK_QTY_M_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_QTY_M_src.address) AS address, btrim(EXT_IMS_MHK_QTY_M_src.city) AS city, btrim(EXT_IMS_MHK_QTY_M_src.state) AS state, btrim(EXT_IMS_MHK_QTY_M_src.zip) AS zip, btrim(EXT_IMS_MHK_QTY_M_src.specialty) AS specialty, btrim(EXT_IMS_MHK_QTY_M_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_QTY_M_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_QTY_M_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_QTY_M_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_M_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_QTY_M_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_QTY_M_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_M_src.trx_024))::numeric(9,3) END AS trx_024, EXT_IMS_MHK_QTY_M_src.batch_id, EXT_IMS_MHK_QTY_M_src.row_id, EXT_IMS_MHK_QTY_M_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_QTY_M_src;

CREATE  VIEW teva_ingestion.EXT_IMS_MHK_QTY_W AS
SELECT CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_report_num))::int END AS ims_report_num, btrim(EXT_IMS_MHK_QTY_W_src.zip_other) AS zip_other, btrim(EXT_IMS_MHK_QTY_W_src.ims_id) AS ims_id, btrim(EXT_IMS_MHK_QTY_W_src.ndc) AS ndc, btrim(EXT_IMS_MHK_QTY_W_src.plan_id) AS plan_id, CASE WHEN (EXT_IMS_MHK_QTY_W_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.sales_category))::int END AS sales_category, btrim(EXT_IMS_MHK_QTY_W_src.rx_type) AS rx_type, CASE WHEN (EXT_IMS_MHK_QTY_W_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(EXT_IMS_MHK_QTY_W_src.filler_01) AS filler_01, btrim(EXT_IMS_MHK_QTY_W_src.me_num) AS me_num, btrim(EXT_IMS_MHK_QTY_W_src.last_name) AS last_name, btrim(EXT_IMS_MHK_QTY_W_src.first_name) AS first_name, btrim(EXT_IMS_MHK_QTY_W_src.middle_name) AS middle_name, btrim(EXT_IMS_MHK_QTY_W_src.address) AS address, btrim(EXT_IMS_MHK_QTY_W_src.city) AS city, btrim(EXT_IMS_MHK_QTY_W_src.state) AS state, btrim(EXT_IMS_MHK_QTY_W_src.zip) AS zip, btrim(EXT_IMS_MHK_QTY_W_src.specialty) AS specialty, btrim(EXT_IMS_MHK_QTY_W_src.plan_name) AS plan_name, btrim(EXT_IMS_MHK_QTY_W_src.ndc_description) AS ndc_description, btrim(EXT_IMS_MHK_QTY_W_src.data_date) AS data_date, CASE WHEN (EXT_IMS_MHK_QTY_W_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(EXT_IMS_MHK_QTY_W_src.bucket_count))::int END AS bucket_count, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (EXT_IMS_MHK_QTY_W_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (EXT_IMS_MHK_QTY_W_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(EXT_IMS_MHK_QTY_W_src.trx_132))::numeric(9,3) END AS trx_132, EXT_IMS_MHK_QTY_W_src.batch_id, EXT_IMS_MHK_QTY_W_src.row_id, EXT_IMS_MHK_QTY_W_src.update_ts FROM teva_ingestion.EXT_IMS_MHK_QTY_W_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_pvs_for_data_stewards AS
SELECT sp_pharm_address_lookups.SOURCE_ID AS source_id, sp_pharm_address_lookups.TEVA_LAST_NAME AS last_name, sp_pharm_address_lookups.TEVA_FIRST_NAME AS first_name, sp_pharm_address_lookups.TEVA_PROFESSIONAL_ID AS npi, sp_pharm_address_lookups.TEVA_ADDRESS1 AS address1, sp_pharm_address_lookups.TEVA_ADDRESS2 AS address2, sp_pharm_address_lookups.TEVA_CITY AS city, sp_pharm_address_lookups.TEVA_STATE AS state, sp_pharm_address_lookups.TEVA_ZIP AS zip, NULL AS IMS_ID, NULL AS HCE_ID FROM WSMP_ADMIN.sp_pharm_address_lookups WHERE (trunc(sp_pharm_address_lookups.CREATE_DATE, 'DD'::varchar(2)) = trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) ORDER BY sp_pharm_address_lookups.TEVA_LAST_NAME, sp_pharm_address_lookups.TEVA_FIRST_NAME, sp_pharm_address_lookups.TEVA_ZIP;

CREATE  VIEW metadata.reference_table_counts AS
SELECT A.reference_table, A.counts FROM ((((((((((((((((((((((((SELECT 'reference.alignment_active_dates'::varchar(32) AS reference_table, count(*) AS counts FROM reference.alignment_active_dates GROUP BY 'reference.alignment_active_dates'::varchar(32) UNION ALL SELECT 'reference.bag'::varchar(13) AS reference_table, count(*) AS counts FROM reference.bag GROUP BY 'reference.bag'::varchar(13)) UNION ALL SELECT 'reference.bag_product'::varchar(21) AS reference_table, count(*) AS counts FROM reference.bag_product GROUP BY 'reference.bag_product'::varchar(21)) UNION ALL SELECT 'reference.bag_territory'::varchar(23) AS reference_table, count(*) AS counts FROM reference.bag_territory GROUP BY 'reference.bag_territory'::varchar(23)) UNION ALL SELECT 'reference.calendar'::varchar(18) AS reference_table, count(*) AS counts FROM reference.calendar GROUP BY 'reference.calendar'::varchar(18)) UNION ALL SELECT 'reference.call_plan_active_dates'::varchar(32) AS reference_table, count(*) AS counts FROM reference.call_plan_active_dates GROUP BY 'reference.call_plan_active_dates'::varchar(32)) UNION ALL SELECT 'reference.caremark_md_id_to_tvcmid'::varchar(34) AS reference_table, count(*) AS counts FROM reference.caremark_md_id_to_tvcmid GROUP BY 'reference.caremark_md_id_to_tvcmid'::varchar(34)) UNION ALL SELECT 'reference.city_state_zip'::varchar(24) AS reference_table, count(*) AS counts FROM reference.city_state_zip GROUP BY 'reference.city_state_zip'::varchar(24)) UNION ALL SELECT 'reference.comp_alignment_exceptions'::varchar(35) AS reference_table, count(*) AS counts FROM reference.comp_alignment_exceptions GROUP BY 'reference.comp_alignment_exceptions'::varchar(35)) UNION ALL SELECT 'reference.copay_voucher_program'::varchar(31) AS reference_table, count(*) AS counts FROM reference.copay_voucher_program GROUP BY 'reference.copay_voucher_program'::varchar(31)) UNION ALL SELECT 'reference.ddd_445_calendar'::varchar(26) AS reference_table, count(*) AS counts FROM reference.ddd_445_calendar GROUP BY 'reference.ddd_445_calendar'::varchar(26)) UNION ALL SELECT 'reference.ddd_category'::varchar(22) AS reference_table, count(*) AS counts FROM reference.ddd_category GROUP BY 'reference.ddd_category'::varchar(22)) UNION ALL SELECT 'reference.ddd_subcategory'::varchar(25) AS reference_table, count(*) AS counts FROM reference.ddd_subcategory GROUP BY 'reference.ddd_subcategory'::varchar(25)) UNION ALL SELECT 'reference.ims_model_payment_method'::varchar(34) AS reference_table, count(*) AS counts FROM reference.ims_model_payment_method GROUP BY 'reference.ims_model_payment_method'::varchar(34)) UNION ALL SELECT 'reference.invoice_adjustments'::varchar(29) AS reference_table, count(*) AS counts FROM reference.invoice_adjustments GROUP BY 'reference.invoice_adjustments'::varchar(29)) UNION ALL SELECT 'reference.market_sales_force'::varchar(28) AS reference_table, count(*) AS counts FROM reference.market_sales_force GROUP BY 'reference.market_sales_force'::varchar(28)) UNION ALL SELECT 'reference.oncology_account_id_867_xref'::varchar(38) AS reference_table, count(*) AS counts FROM reference.oncology_account_id_867_xref GROUP BY 'reference.oncology_account_id_867_xref'::varchar(38)) UNION ALL SELECT 'reference.oncology_account_id_ims_xref'::varchar(38) AS reference_table, count(*) AS counts FROM reference.oncology_account_id_ims_xref GROUP BY 'reference.oncology_account_id_ims_xref'::varchar(38)) UNION ALL SELECT 'reference.oncology_excluded_outlets'::varchar(35) AS reference_table, count(*) AS counts FROM reference.oncology_excluded_outlets GROUP BY 'reference.oncology_excluded_outlets'::varchar(35)) UNION ALL SELECT 'reference.payer_parent'::varchar(22) AS reference_table, count(*) AS counts FROM reference.payer_parent GROUP BY 'reference.payer_parent'::varchar(22)) UNION ALL SELECT 'reference.pbm_parent'::varchar(20) AS reference_table, count(*) AS counts FROM reference.pbm_parent GROUP BY 'reference.pbm_parent'::varchar(20)) UNION ALL SELECT 'reference.specialty_xref'::varchar(24) AS reference_table, count(*) AS counts FROM reference.specialty_xref GROUP BY 'reference.specialty_xref'::varchar(24)) UNION ALL SELECT 'reference.unreported_sales'::varchar(26) AS reference_table, count(*) AS counts FROM reference.unreported_sales GROUP BY 'reference.unreported_sales'::varchar(26)) UNION ALL SELECT 'reference.us_states'::varchar(19) AS reference_table, count(*) AS counts FROM reference.us_states GROUP BY 'reference.us_states'::varchar(19)) UNION ALL SELECT 'reference.zipcode_timezone'::varchar(26) AS reference_table, count(*) AS counts FROM reference.zipcode_timezone GROUP BY 'reference.zipcode_timezone'::varchar(26)) A;

CREATE  VIEW metadata.cleansed_table_counts_by_file_id AS
SELECT A.cleansed_table, A.file_id, A.counts FROM (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((SELECT 'cleansed.kc_hr_addresses'::varchar(24) AS cleansed_table, kc_hr_addresses.file_id, count(*) AS counts FROM cleansed.kc_hr_addresses GROUP BY 'cleansed.kc_hr_addresses'::varchar(24), kc_hr_addresses.file_id UNION ALL SELECT 'cleansed.kc_hr_associates'::varchar(25) AS cleansed_table, kc_hr_associates.file_id, count(*) AS counts FROM cleansed.kc_hr_associates GROUP BY 'cleansed.kc_hr_associates'::varchar(25), kc_hr_associates.file_id) UNION ALL SELECT 'cleansed.kc_hr_aud_associates'::varchar(29) AS cleansed_table, kc_hr_aud_associates.file_id, count(*) AS counts FROM cleansed.kc_hr_aud_associates GROUP BY 'cleansed.kc_hr_aud_associates'::varchar(29), kc_hr_aud_associates.file_id) UNION ALL SELECT 'customer_master.alternate_identifier'::varchar(36) AS cleansed_table, alternate_identifier.file_id, count(*) AS counts FROM customer_master.alternate_identifier GROUP BY 'customer_master.alternate_identifier'::varchar(36), alternate_identifier.file_id) UNION ALL SELECT 'customer_master.raw_dea'::varchar(23) AS cleansed_table, raw_dea.file_id, count(*) AS counts FROM customer_master.raw_dea GROUP BY 'customer_master.raw_dea'::varchar(23), raw_dea.file_id) UNION ALL SELECT 'customer_master.hcp_detail'::varchar(26) AS cleansed_table, hcp_detail.file_id, count(*) AS counts FROM customer_master.hcp_detail GROUP BY 'customer_master.hcp_detail'::varchar(26), hcp_detail.file_id) UNION ALL SELECT 'customer_master.ims_flag'::varchar(24) AS cleansed_table, ims_flag.file_id, count(*) AS counts FROM customer_master.ims_flag GROUP BY 'customer_master.ims_flag'::varchar(24), ims_flag.file_id) UNION ALL SELECT 'customer_master.teva_flag'::varchar(25) AS cleansed_table, teva_flag.file_id, count(*) AS counts FROM customer_master.teva_flag GROUP BY 'customer_master.teva_flag'::varchar(25), teva_flag.file_id) UNION ALL SELECT 'customer_master.sample_eligibility'::varchar(34) AS cleansed_table, sample_eligibility.file_id, count(*) AS counts FROM customer_master.sample_eligibility GROUP BY 'customer_master.sample_eligibility'::varchar(34), sample_eligibility.file_id) UNION ALL SELECT 'cleansed.ahm_event'::varchar(18) AS cleansed_table, ahm_event.file_id, count(*) AS counts FROM cleansed.ahm_event GROUP BY 'cleansed.ahm_event'::varchar(18), ahm_event.file_id) UNION ALL SELECT 'cleansed.ahm_event_attendee'::varchar(27) AS cleansed_table, ahm_event_attendee.file_id, count(*) AS counts FROM cleansed.ahm_event_attendee GROUP BY 'cleansed.ahm_event_attendee'::varchar(27), ahm_event_attendee.file_id) UNION ALL SELECT 'cleansed.ahm_event_count'::varchar(24) AS cleansed_table, ahm_event_count.file_id, count(*) AS counts FROM cleansed.ahm_event_count GROUP BY 'cleansed.ahm_event_count'::varchar(24), ahm_event_count.file_id) UNION ALL SELECT 'cleansed.ahm_event_expense'::varchar(26) AS cleansed_table, ahm_event_expense.file_id, count(*) AS counts FROM cleansed.ahm_event_expense GROUP BY 'cleansed.ahm_event_expense'::varchar(26), ahm_event_expense.file_id) UNION ALL SELECT 'cleansed.ahm_event_host'::varchar(23) AS cleansed_table, ahm_event_host.file_id, count(*) AS counts FROM cleansed.ahm_event_host GROUP BY 'cleansed.ahm_event_host'::varchar(23), ahm_event_host.file_id) UNION ALL SELECT 'cleansed.ahm_event_product'::varchar(26) AS cleansed_table, ahm_event_product.file_id, count(*) AS counts FROM cleansed.ahm_event_product GROUP BY 'cleansed.ahm_event_product'::varchar(26), ahm_event_product.file_id) UNION ALL SELECT 'cleansed.ahm_event_speaker'::varchar(26) AS cleansed_table, ahm_event_speaker.file_id, count(*) AS counts FROM cleansed.ahm_event_speaker GROUP BY 'cleansed.ahm_event_speaker'::varchar(26), ahm_event_speaker.file_id) UNION ALL SELECT 'cleansed.ahm_organization'::varchar(25) AS cleansed_table, ahm_organization.file_id, count(*) AS counts FROM cleansed.ahm_organization GROUP BY 'cleansed.ahm_organization'::varchar(25), ahm_organization.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_contract'::varchar(29) AS cleansed_table, ahm_speaker_contract.file_id, count(*) AS counts FROM cleansed.ahm_speaker_contract GROUP BY 'cleansed.ahm_speaker_contract'::varchar(29), ahm_speaker_contract.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_license'::varchar(28) AS cleansed_table, ahm_speaker_license.file_id, count(*) AS counts FROM cleansed.ahm_speaker_license GROUP BY 'cleansed.ahm_speaker_license'::varchar(28), ahm_speaker_license.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_profile'::varchar(28) AS cleansed_table, ahm_speaker_profile.file_id, count(*) AS counts FROM cleansed.ahm_speaker_profile GROUP BY 'cleansed.ahm_speaker_profile'::varchar(28), ahm_speaker_profile.file_id) UNION ALL SELECT 'cleansed.ahm_speaker_training'::varchar(29) AS cleansed_table, ahm_speaker_training.file_id, count(*) AS counts FROM cleansed.ahm_speaker_training GROUP BY 'cleansed.ahm_speaker_training'::varchar(29), ahm_speaker_training.file_id) UNION ALL SELECT 'cleansed.ahm_topic_product'::varchar(26) AS cleansed_table, ahm_topic_product.file_id, count(*) AS counts FROM cleansed.ahm_topic_product GROUP BY 'cleansed.ahm_topic_product'::varchar(26), ahm_topic_product.file_id) UNION ALL SELECT 'cleansed.anda_sales'::varchar(19) AS cleansed_table, anda_sales.file_id, count(*) AS counts FROM cleansed.anda_sales GROUP BY 'cleansed.anda_sales'::varchar(19), anda_sales.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail'::varchar(39) AS cleansed_table, alphascrip_weekly_copay_detail.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail GROUP BY 'cleansed.alphascrip_weekly_copay_detail'::varchar(39), alphascrip_weekly_copay_detail.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_cgd'::varchar(36) AS cleansed_table, alphascrip_weekly_copay_cgd.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_cgd GROUP BY 'cleansed.alphascrip_weekly_copay_cgd'::varchar(36), alphascrip_weekly_copay_cgd.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail_2'::varchar(41) AS cleansed_table, alphascrip_weekly_copay_detail_2.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail_2 GROUP BY 'cleansed.alphascrip_weekly_copay_detail_2'::varchar(41), alphascrip_weekly_copay_detail_2.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_detail_3'::varchar(41) AS cleansed_table, alphascrip_weekly_copay_detail_3.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_detail_3 GROUP BY 'cleansed.alphascrip_weekly_copay_detail_3'::varchar(41), alphascrip_weekly_copay_detail_3.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_copay_pskw'::varchar(37) AS cleansed_table, alphascrip_weekly_copay_pskw.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_copay_pskw GROUP BY 'cleansed.alphascrip_weekly_copay_pskw'::varchar(37), alphascrip_weekly_copay_pskw.file_id) UNION ALL SELECT 'cleansed.alphascrip_copay_redemptions'::varchar(37) AS cleansed_table, alphascrip_copay_redemptions.file_id, count(*) AS counts FROM cleansed.alphascrip_copay_redemptions GROUP BY 'cleansed.alphascrip_copay_redemptions'::varchar(37), alphascrip_copay_redemptions.file_id) UNION ALL SELECT 'cleansed.alphascrip_redemptions'::varchar(31) AS cleansed_table, alphascrip_redemptions.file_id, count(*) AS counts FROM cleansed.alphascrip_redemptions GROUP BY 'cleansed.alphascrip_redemptions'::varchar(31), alphascrip_redemptions.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_voucher_detail_3'::varchar(43) AS cleansed_table, alphascrip_weekly_voucher_detail_3.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_voucher_detail_3 GROUP BY 'cleansed.alphascrip_weekly_voucher_detail_3'::varchar(43), alphascrip_weekly_voucher_detail_3.file_id) UNION ALL SELECT 'cleansed.alphascrip_weekly_voucher_detail_2'::varchar(43) AS cleansed_table, alphascrip_weekly_voucher_detail_2.file_id, count(*) AS counts FROM cleansed.alphascrip_weekly_voucher_detail_2 GROUP BY 'cleansed.alphascrip_weekly_voucher_detail_2'::varchar(43), alphascrip_weekly_voucher_detail_2.file_id) UNION ALL SELECT 'cleansed.kc_sales_call_goals'::varchar(28) AS cleansed_table, kc_sales_call_goals.file_id, count(*) AS counts FROM cleansed.kc_sales_call_goals GROUP BY 'cleansed.kc_sales_call_goals'::varchar(28), kc_sales_call_goals.file_id) UNION ALL SELECT 'cleansed.caremark_rx_aob'::varchar(24) AS cleansed_table, caremark_rx_aob.file_id, count(*) AS counts FROM cleansed.caremark_rx_aob GROUP BY 'cleansed.caremark_rx_aob'::varchar(24), caremark_rx_aob.file_id) UNION ALL SELECT 'cleansed.caremark_rx_medicare'::varchar(29) AS cleansed_table, caremark_rx_medicare.file_id, count(*) AS counts FROM cleansed.caremark_rx_medicare GROUP BY 'cleansed.caremark_rx_medicare'::varchar(29), caremark_rx_medicare.file_id) UNION ALL SELECT 'veeva.dsa_slide'::varchar(15) AS cleansed_table, dsa_slide.file_id, count(*) AS counts FROM veeva.dsa_slide GROUP BY 'veeva.dsa_slide'::varchar(15), dsa_slide.file_id) UNION ALL SELECT 'veeva.dsa_presentation'::varchar(22) AS cleansed_table, dsa_presentation.file_id, count(*) AS counts FROM veeva.dsa_presentation GROUP BY 'veeva.dsa_presentation'::varchar(22), dsa_presentation.file_id) UNION ALL SELECT 'cleansed.clozapine_unit_ap'::varchar(26) AS cleansed_table, clozapine_unit_ap.file_id, count(*) AS counts FROM cleansed.clozapine_unit_ap GROUP BY 'cleansed.clozapine_unit_ap'::varchar(26), clozapine_unit_ap.file_id) UNION ALL SELECT 'cleansed.cmop_rx'::varchar(16) AS cleansed_table, cmop_rx.file_id, count(*) AS counts FROM cleansed.cmop_rx GROUP BY 'cleansed.cmop_rx'::varchar(16), cmop_rx.file_id) UNION ALL SELECT 'customer_master.customer_flags'::varchar(30) AS cleansed_table, customer_flags.file_id, count(*) AS counts FROM customer_master.customer_flags GROUP BY 'customer_master.customer_flags'::varchar(30), customer_flags.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_qty'::varchar(24) AS cleansed_table, ims_ddd_dod_qty.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_qty GROUP BY 'cleansed.ims_ddd_dod_qty'::varchar(24), ims_ddd_dod_qty.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_dollars_ms'::varchar(31) AS cleansed_table, ims_ddd_dod_dollars_ms.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_dollars_ms GROUP BY 'cleansed.ims_ddd_dod_dollars_ms'::varchar(31), ims_ddd_dod_dollars_ms.file_id) UNION ALL SELECT 'cleansed.ims_ddd_dod_dollars_pd'::varchar(31) AS cleansed_table, ims_ddd_dod_dollars_pd.file_id, count(*) AS counts FROM cleansed.ims_ddd_dod_dollars_pd GROUP BY 'cleansed.ims_ddd_dod_dollars_pd'::varchar(31), ims_ddd_dod_dollars_pd.file_id) UNION ALL SELECT 'cleansed.diplomat_enrollment'::varchar(28) AS cleansed_table, diplomat_enrollment.file_id, count(*) AS counts FROM cleansed.diplomat_enrollment GROUP BY 'cleansed.diplomat_enrollment'::varchar(28), diplomat_enrollment.file_id) UNION ALL SELECT 'cleansed.diplomat_rx'::varchar(20) AS cleansed_table, diplomat_rx.file_id, count(*) AS counts FROM cleansed.diplomat_rx GROUP BY 'cleansed.diplomat_rx'::varchar(20), diplomat_rx.file_id) UNION ALL SELECT 'cleansed.ims_outlet_master'::varchar(26) AS cleansed_table, ims_outlet_master.file_id, count(*) AS counts FROM cleansed.ims_outlet_master GROUP BY 'cleansed.ims_outlet_master'::varchar(26), ims_outlet_master.file_id) UNION ALL SELECT 'cleansed.valuecentric_852'::varchar(25) AS cleansed_table, valuecentric_852.file_id, count(*) AS counts FROM cleansed.valuecentric_852 GROUP BY 'cleansed.valuecentric_852'::varchar(25), valuecentric_852.file_id) UNION ALL SELECT 'cleansed.ftf_accounts'::varchar(21) AS cleansed_table, ftf_accounts.file_id, count(*) AS counts FROM cleansed.ftf_accounts GROUP BY 'cleansed.ftf_accounts'::varchar(21), ftf_accounts.file_id) UNION ALL SELECT 'cleansed.ftf_control'::varchar(20) AS cleansed_table, ftf_control.file_id, count(*) AS counts FROM cleansed.ftf_control GROUP BY 'cleansed.ftf_control'::varchar(20), ftf_control.file_id) UNION ALL SELECT 'cleansed.ftf_copays'::varchar(19) AS cleansed_table, ftf_copays.file_id, count(*) AS counts FROM cleansed.ftf_copays GROUP BY 'cleansed.ftf_copays'::varchar(19), ftf_copays.file_id) UNION ALL SELECT 'cleansed.ftf_drug_class_therapeutic_area'::varchar(40) AS cleansed_table, ftf_drug_class_therapeutic_area.file_id, count(*) AS counts FROM cleansed.ftf_drug_class_therapeutic_area GROUP BY 'cleansed.ftf_drug_class_therapeutic_area'::varchar(40), ftf_drug_class_therapeutic_area.file_id) UNION ALL SELECT 'cleansed.ftf_drugs'::varchar(18) AS cleansed_table, ftf_drugs.file_id, count(*) AS counts FROM cleansed.ftf_drugs GROUP BY 'cleansed.ftf_drugs'::varchar(18), ftf_drugs.file_id) UNION ALL SELECT 'cleansed.ftf_formularies'::varchar(24) AS cleansed_table, ftf_formularies.file_id, count(*) AS counts FROM cleansed.ftf_formularies GROUP BY 'cleansed.ftf_formularies'::varchar(24), ftf_formularies.file_id) UNION ALL SELECT 'cleansed.ftf_health_plan_geography'::varchar(34) AS cleansed_table, ftf_health_plan_geography.file_id, count(*) AS counts FROM cleansed.ftf_health_plan_geography GROUP BY 'cleansed.ftf_health_plan_geography'::varchar(34), ftf_health_plan_geography.file_id) UNION ALL SELECT 'cleansed.ftf_health_plans'::varchar(25) AS cleansed_table, ftf_health_plans.file_id, count(*) AS counts FROM cleansed.ftf_health_plans GROUP BY 'cleansed.ftf_health_plans'::varchar(25), ftf_health_plans.file_id) UNION ALL SELECT 'cleansed.ftf_ims_bridge'::varchar(23) AS cleansed_table, ftf_ims_bridge.file_id, count(*) AS counts FROM cleansed.ftf_ims_bridge GROUP BY 'cleansed.ftf_ims_bridge'::varchar(23), ftf_ims_bridge.file_id) UNION ALL SELECT 'cleansed.ftf_pbms'::varchar(17) AS cleansed_table, ftf_pbms.file_id, count(*) AS counts FROM cleansed.ftf_pbms GROUP BY 'cleansed.ftf_pbms'::varchar(17), ftf_pbms.file_id) UNION ALL SELECT 'cleansed.ftf_restrictions'::varchar(25) AS cleansed_table, ftf_restrictions.file_id, count(*) AS counts FROM cleansed.ftf_restrictions GROUP BY 'cleansed.ftf_restrictions'::varchar(25), ftf_restrictions.file_id) UNION ALL SELECT 'cleansed.ftf_wk_bridge'::varchar(22) AS cleansed_table, ftf_wk_bridge.file_id, count(*) AS counts FROM cleansed.ftf_wk_bridge GROUP BY 'cleansed.ftf_wk_bridge'::varchar(22), ftf_wk_bridge.file_id) UNION ALL SELECT 'cleansed.ftf_tiers'::varchar(18) AS cleansed_table, ftf_tiers.file_id, count(*) AS counts FROM cleansed.ftf_tiers GROUP BY 'cleansed.ftf_tiers'::varchar(18), ftf_tiers.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_detail'::varchar(24) AS cleansed_table, ims_hcos_aco_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_detail GROUP BY 'hcos.ims_hcos_aco_detail'::varchar(24), ims_hcos_aco_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_detail_fact'::varchar(29) AS cleansed_table, ims_hcos_aco_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_detail_fact GROUP BY 'hcos.ims_hcos_aco_detail_fact'::varchar(29), ims_hcos_aco_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_org_fact'::varchar(26) AS cleansed_table, ims_hcos_aco_org_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_org_fact GROUP BY 'hcos.ims_hcos_aco_org_fact'::varchar(26), ims_hcos_aco_org_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_roster'::varchar(24) AS cleansed_table, ims_hcos_aco_roster.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_roster GROUP BY 'hcos.ims_hcos_aco_roster'::varchar(24), ims_hcos_aco_roster.file_id) UNION ALL SELECT 'hcos.ims_hcos_aco_type'::varchar(22) AS cleansed_table, ims_hcos_aco_type.file_id, count(*) AS counts FROM hcos.ims_hcos_aco_type GROUP BY 'hcos.ims_hcos_aco_type'::varchar(22), ims_hcos_aco_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_affiliation_type'::varchar(30) AS cleansed_table, ims_hcos_affiliation_type.file_id, count(*) AS counts FROM hcos.ims_hcos_affiliation_type GROUP BY 'hcos.ims_hcos_affiliation_type'::varchar(30), ims_hcos_affiliation_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_cluster_type'::varchar(30) AS cleansed_table, ims_hcos_bed_cluster_type.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_cluster_type GROUP BY 'hcos.ims_hcos_bed_cluster_type'::varchar(30), ims_hcos_bed_cluster_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_fact'::varchar(22) AS cleansed_table, ims_hcos_bed_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_fact GROUP BY 'hcos.ims_hcos_bed_fact'::varchar(22), ims_hcos_bed_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_bed_type'::varchar(22) AS cleansed_table, ims_hcos_bed_type.file_id, count(*) AS counts FROM hcos.ims_hcos_bed_type GROUP BY 'hcos.ims_hcos_bed_type'::varchar(22), ims_hcos_bed_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_business'::varchar(22) AS cleansed_table, ims_hcos_business.file_id, count(*) AS counts FROM hcos.ims_hcos_business GROUP BY 'hcos.ims_hcos_business'::varchar(22), ims_hcos_business.file_id) UNION ALL SELECT 'hcos.ims_hcos_business_detail'::varchar(29) AS cleansed_table, ims_hcos_business_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_business_detail GROUP BY 'hcos.ims_hcos_business_detail'::varchar(29), ims_hcos_business_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_business_detail_fact'::varchar(34) AS cleansed_table, ims_hcos_business_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_business_detail_fact GROUP BY 'hcos.ims_hcos_business_detail_fact'::varchar(34), ims_hcos_business_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_class_of_trade'::varchar(28) AS cleansed_table, ims_hcos_class_of_trade.file_id, count(*) AS counts FROM hcos.ims_hcos_class_of_trade GROUP BY 'hcos.ims_hcos_class_of_trade'::varchar(28), ims_hcos_class_of_trade.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_code'::varchar(27) AS cleansed_table, ims_hcos_clinical_code.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_code GROUP BY 'hcos.ims_hcos_clinical_code'::varchar(27), ims_hcos_clinical_code.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact'::varchar(27) AS cleansed_table, ims_hcos_clinical_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact GROUP BY 'hcos.ims_hcos_clinical_fact'::varchar(27), ims_hcos_clinical_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact_national'::varchar(36) AS cleansed_table, ims_hcos_clinical_fact_national.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact_national GROUP BY 'hcos.ims_hcos_clinical_fact_national'::varchar(36), ims_hcos_clinical_fact_national.file_id) UNION ALL SELECT 'hcos.ims_hcos_clinical_fact_state'::varchar(33) AS cleansed_table, ims_hcos_clinical_fact_state.file_id, count(*) AS counts FROM hcos.ims_hcos_clinical_fact_state GROUP BY 'hcos.ims_hcos_clinical_fact_state'::varchar(33), ims_hcos_clinical_fact_state.file_id) UNION ALL SELECT 'hcos.ims_hcos_contact_affiliation_fact'::varchar(38) AS cleansed_table, ims_hcos_contact_affiliation_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_contact_affiliation_fact GROUP BY 'hcos.ims_hcos_contact_affiliation_fact'::varchar(38), ims_hcos_contact_affiliation_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_cot_fact'::varchar(22) AS cleansed_table, ims_hcos_cot_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_cot_fact GROUP BY 'hcos.ims_hcos_cot_fact'::varchar(22), ims_hcos_cot_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_financial_fact'::varchar(28) AS cleansed_table, ims_hcos_financial_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_financial_fact GROUP BY 'hcos.ims_hcos_financial_fact'::varchar(28), ims_hcos_financial_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_fact'::varchar(29) AS cleansed_table, ims_hcos_identifier_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_fact GROUP BY 'hcos.ims_hcos_identifier_fact'::varchar(29), ims_hcos_identifier_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_type'::varchar(29) AS cleansed_table, ims_hcos_identifier_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_type GROUP BY 'hcos.ims_hcos_identifier_type'::varchar(29), ims_hcos_identifier_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_category_type'::varchar(38) AS cleansed_table, ims_hcos_identifier_category_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_category_type GROUP BY 'hcos.ims_hcos_identifier_category_type'::varchar(38), ims_hcos_identifier_category_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_identifier_term_type'::varchar(34) AS cleansed_table, ims_hcos_identifier_term_type.file_id, count(*) AS counts FROM hcos.ims_hcos_identifier_term_type GROUP BY 'hcos.ims_hcos_identifier_term_type'::varchar(34), ims_hcos_identifier_term_type.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional'::varchar(26) AS cleansed_table, ims_hcos_professional.file_id, count(*) AS counts FROM hcos.ims_hcos_professional GROUP BY 'hcos.ims_hcos_professional'::varchar(26), ims_hcos_professional.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_detail'::varchar(33) AS cleansed_table, ims_hcos_professional_detail.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_detail GROUP BY 'hcos.ims_hcos_professional_detail'::varchar(33), ims_hcos_professional_detail.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_detail_fact'::varchar(38) AS cleansed_table, ims_hcos_professional_detail_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_detail_fact GROUP BY 'hcos.ims_hcos_professional_detail_fact'::varchar(38), ims_hcos_professional_detail_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_specialty_fact'::varchar(41) AS cleansed_table, ims_hcos_professional_specialty_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_specialty_fact GROUP BY 'hcos.ims_hcos_professional_specialty_fact'::varchar(41), ims_hcos_professional_specialty_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_specialty'::varchar(36) AS cleansed_table, ims_hcos_professional_specialty.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_specialty GROUP BY 'hcos.ims_hcos_professional_specialty'::varchar(36), ims_hcos_professional_specialty.file_id) UNION ALL SELECT 'hcos.ims_hcos_professional_title'::varchar(32) AS cleansed_table, ims_hcos_professional_title.file_id, count(*) AS counts FROM hcos.ims_hcos_professional_title GROUP BY 'hcos.ims_hcos_professional_title'::varchar(32), ims_hcos_professional_title.file_id) UNION ALL SELECT 'hcos.ims_hcos_provider_affiliation_fact'::varchar(39) AS cleansed_table, ims_hcos_provider_affiliation_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_provider_affiliation_fact GROUP BY 'hcos.ims_hcos_provider_affiliation_fact'::varchar(39), ims_hcos_provider_affiliation_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_relationship_fact'::varchar(31) AS cleansed_table, ims_hcos_relationship_fact.file_id, count(*) AS counts FROM hcos.ims_hcos_relationship_fact GROUP BY 'hcos.ims_hcos_relationship_fact'::varchar(31), ims_hcos_relationship_fact.file_id) UNION ALL SELECT 'hcos.ims_hcos_relationship_type'::varchar(31) AS cleansed_table, ims_hcos_relationship_type.file_id, count(*) AS counts FROM hcos.ims_hcos_relationship_type GROUP BY 'hcos.ims_hcos_relationship_type'::varchar(31), ims_hcos_relationship_type.file_id) UNION ALL SELECT 'cleansed.i3_rx_by_strength'::varchar(26) AS cleansed_table, i3_rx_by_strength.file_id, count(*) AS counts FROM cleansed.i3_rx_by_strength GROUP BY 'cleansed.i3_rx_by_strength'::varchar(26), i3_rx_by_strength.file_id) UNION ALL SELECT 'cleansed.i3_rx'::varchar(14) AS cleansed_table, i3_rx.file_id, count(*) AS counts FROM cleansed.i3_rx GROUP BY 'cleansed.i3_rx'::varchar(14), i3_rx.file_id) UNION ALL SELECT 'cleansed.i3_rx_tysabri'::varchar(22) AS cleansed_table, i3_rx_tysabri.file_id, count(*) AS counts FROM cleansed.i3_rx_tysabri GROUP BY 'cleansed.i3_rx_tysabri'::varchar(22), i3_rx_tysabri.file_id) UNION ALL SELECT 'veeva.ids_call_detail'::varchar(21) AS cleansed_table, ids_call_detail.file_id, count(*) AS counts FROM veeva.ids_call_detail GROUP BY 'veeva.ids_call_detail'::varchar(21), ids_call_detail.file_id) UNION ALL SELECT 'veeva.ids_call'::varchar(14) AS cleansed_table, ids_call.file_id, count(*) AS counts FROM veeva.ids_call GROUP BY 'veeva.ids_call'::varchar(14), ids_call.file_id) UNION ALL SELECT 'cleansed.ims_product_list_monthly'::varchar(33) AS cleansed_table, ims_product_list_monthly.file_id, count(*) AS counts FROM cleansed.ims_product_list_monthly GROUP BY 'cleansed.ims_product_list_monthly'::varchar(33), ims_product_list_monthly.file_id) UNION ALL SELECT 'cleansed.ims_product_list_weekly'::varchar(32) AS cleansed_table, ims_product_list_weekly.file_id, count(*) AS counts FROM cleansed.ims_product_list_weekly GROUP BY 'cleansed.ims_product_list_weekly'::varchar(32), ims_product_list_weekly.file_id) UNION ALL SELECT 'cleansed.ims_mhj_cnt_m'::varchar(22) AS cleansed_table, ims_mhj_cnt_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_cnt_m GROUP BY 'cleansed.ims_mhj_cnt_m'::varchar(22), ims_mhj_cnt_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_cnt_w'::varchar(22) AS cleansed_table, ims_mhj_cnt_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_cnt_w GROUP BY 'cleansed.ims_mhj_cnt_w'::varchar(22), ims_mhj_cnt_w.file_id) UNION ALL SELECT 'cleansed.ims_mhj_control_m'::varchar(26) AS cleansed_table, ims_mhj_control_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_control_m GROUP BY 'cleansed.ims_mhj_control_m'::varchar(26), ims_mhj_control_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_control_w'::varchar(26) AS cleansed_table, ims_mhj_control_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_control_w GROUP BY 'cleansed.ims_mhj_control_w'::varchar(26), ims_mhj_control_w.file_id) UNION ALL SELECT 'cleansed.ims_mhj_qty_m'::varchar(22) AS cleansed_table, ims_mhj_qty_m.file_id, count(*) AS counts FROM cleansed.ims_mhj_qty_m GROUP BY 'cleansed.ims_mhj_qty_m'::varchar(22), ims_mhj_qty_m.file_id) UNION ALL SELECT 'cleansed.ims_mhj_qty_w'::varchar(22) AS cleansed_table, ims_mhj_qty_w.file_id, count(*) AS counts FROM cleansed.ims_mhj_qty_w GROUP BY 'cleansed.ims_mhj_qty_w'::varchar(22), ims_mhj_qty_w.file_id) UNION ALL SELECT 'cleansed.ims_pbm_xref'::varchar(21) AS cleansed_table, ims_pbm_xref.file_id, count(*) AS counts FROM cleansed.ims_pbm_xref GROUP BY 'cleansed.ims_pbm_xref'::varchar(21), ims_pbm_xref.file_id) UNION ALL SELECT 'cleansed.ims_plan_xref'::varchar(22) AS cleansed_table, ims_plan_xref.file_id, count(*) AS counts FROM cleansed.ims_plan_xref GROUP BY 'cleansed.ims_plan_xref'::varchar(22), ims_plan_xref.file_id) UNION ALL SELECT 'cleansed.ims_plan_xref_accelerated'::varchar(34) AS cleansed_table, ims_plan_xref_accelerated.file_id, count(*) AS counts FROM cleansed.ims_plan_xref_accelerated GROUP BY 'cleansed.ims_plan_xref_accelerated'::varchar(34), ims_plan_xref_accelerated.file_id) UNION ALL SELECT 'cleansed.kc_sales_zip_to_territory'::varchar(34) AS cleansed_table, kc_sales_zip_to_territory.file_id, count(*) AS counts FROM cleansed.kc_sales_zip_to_territory GROUP BY 'cleansed.kc_sales_zip_to_territory'::varchar(34), kc_sales_zip_to_territory.file_id) UNION ALL SELECT 'cleansed.knipper_samples_shipped'::varchar(32) AS cleansed_table, knipper_samples_shipped.file_id, count(*) AS counts FROM cleansed.knipper_samples_shipped GROUP BY 'cleansed.knipper_samples_shipped'::varchar(32), knipper_samples_shipped.file_id) UNION ALL SELECT 'cleansed.mm_ram_to_state'::varchar(24) AS cleansed_table, mm_ram_to_state.file_id, count(*) AS counts FROM cleansed.mm_ram_to_state GROUP BY 'cleansed.mm_ram_to_state'::varchar(24), mm_ram_to_state.file_id) UNION ALL SELECT 'cleansed.omnicare_sales'::varchar(23) AS cleansed_table, omnicare_sales.file_id, count(*) AS counts FROM cleansed.omnicare_sales GROUP BY 'cleansed.omnicare_sales'::varchar(23), omnicare_sales.file_id) UNION ALL SELECT 'cleansed.onc_account_targets'::varchar(28) AS cleansed_table, onc_account_targets.file_id, count(*) AS counts FROM cleansed.onc_account_targets GROUP BY 'cleansed.onc_account_targets'::varchar(28), onc_account_targets.file_id) UNION ALL SELECT 'cleansed.onc_call_detail_goals'::varchar(30) AS cleansed_table, onc_call_detail_goals.file_id, count(*) AS counts FROM cleansed.onc_call_detail_goals GROUP BY 'cleansed.onc_call_detail_goals'::varchar(30), onc_call_detail_goals.file_id) UNION ALL SELECT 'cleansed.ims_ddd_monthly_retail_onc'::varchar(35) AS cleansed_table, ims_ddd_monthly_retail_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_monthly_retail_onc GROUP BY 'cleansed.ims_ddd_monthly_retail_onc'::varchar(35), ims_ddd_monthly_retail_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_weekly_retail_onc'::varchar(34) AS cleansed_table, ims_ddd_weekly_retail_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_weekly_retail_onc GROUP BY 'cleansed.ims_ddd_weekly_retail_onc'::varchar(34), ims_ddd_weekly_retail_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_monthly_dollars'::varchar(40) AS cleansed_table, ims_ddd_md_demo_monthly_dollars.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_monthly_dollars GROUP BY 'cleansed.ims_ddd_md_demo_monthly_dollars'::varchar(40), ims_ddd_md_demo_monthly_dollars.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_monthly_qty'::varchar(36) AS cleansed_table, ims_ddd_md_demo_monthly_qty.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_monthly_qty GROUP BY 'cleansed.ims_ddd_md_demo_monthly_qty'::varchar(36), ims_ddd_md_demo_monthly_qty.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_monthly_dollars_onc'::varchar(39) AS cleansed_table, ims_ddd_md_monthly_dollars_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_monthly_dollars_onc GROUP BY 'cleansed.ims_ddd_md_monthly_dollars_onc'::varchar(39), ims_ddd_md_monthly_dollars_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_monthly_quantity_onc'::varchar(40) AS cleansed_table, ims_ddd_md_monthly_quantity_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_monthly_quantity_onc GROUP BY 'cleansed.ims_ddd_md_monthly_quantity_onc'::varchar(40), ims_ddd_md_monthly_quantity_onc.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_demo_weekly'::varchar(31) AS cleansed_table, ims_ddd_md_demo_weekly.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_demo_weekly GROUP BY 'cleansed.ims_ddd_md_demo_weekly'::varchar(31), ims_ddd_md_demo_weekly.file_id) UNION ALL SELECT 'cleansed.ims_ddd_md_weekly_sales_onc'::varchar(36) AS cleansed_table, ims_ddd_md_weekly_sales_onc.file_id, count(*) AS counts FROM cleansed.ims_ddd_md_weekly_sales_onc GROUP BY 'cleansed.ims_ddd_md_weekly_sales_onc'::varchar(36), ims_ddd_md_weekly_sales_onc.file_id) UNION ALL SELECT 'cleansed.onc_manual_fcrs'::varchar(24) AS cleansed_table, onc_manual_fcrs.file_id, count(*) AS counts FROM cleansed.onc_manual_fcrs GROUP BY 'cleansed.onc_manual_fcrs'::varchar(24), onc_manual_fcrs.file_id) UNION ALL SELECT 'cleansed.onc_sales_quotas'::varchar(25) AS cleansed_table, onc_sales_quotas.file_id, count(*) AS counts FROM cleansed.onc_sales_quotas GROUP BY 'cleansed.onc_sales_quotas'::varchar(25), onc_sales_quotas.file_id) UNION ALL SELECT 'cleansed.ims_ddd_non_retail_pcs'::varchar(31) AS cleansed_table, ims_ddd_non_retail_pcs.file_id, count(*) AS counts FROM cleansed.ims_ddd_non_retail_pcs GROUP BY 'cleansed.ims_ddd_non_retail_pcs'::varchar(31), ims_ddd_non_retail_pcs.file_id) UNION ALL SELECT 'cleansed.ims_ddd_retail_pcs'::varchar(27) AS cleansed_table, ims_ddd_retail_pcs.file_id, count(*) AS counts FROM cleansed.ims_ddd_retail_pcs GROUP BY 'cleansed.ims_ddd_retail_pcs'::varchar(27), ims_ddd_retail_pcs.file_id) UNION ALL SELECT 'cleansed.prime_rx'::varchar(17) AS cleansed_table, prime_rx.file_id, count(*) AS counts FROM cleansed.prime_rx GROUP BY 'cleansed.prime_rx'::varchar(17), prime_rx.file_id) UNION ALL SELECT 'cleansed.rems_facility'::varchar(22) AS cleansed_table, rems_facility.file_id, count(*) AS counts FROM cleansed.rems_facility GROUP BY 'cleansed.rems_facility'::varchar(22), rems_facility.file_id) UNION ALL SELECT 'cleansed.rems_pharmacy'::varchar(22) AS cleansed_table, rems_pharmacy.file_id, count(*) AS counts FROM cleansed.rems_pharmacy GROUP BY 'cleansed.rems_pharmacy'::varchar(22), rems_pharmacy.file_id) UNION ALL SELECT 'cleansed.rems_prescriber'::varchar(24) AS cleansed_table, rems_prescriber.file_id, count(*) AS counts FROM cleansed.rems_prescriber GROUP BY 'cleansed.rems_prescriber'::varchar(24), rems_prescriber.file_id) UNION ALL SELECT 'cleansed.specialty_pharmacy_cm_lookup'::varchar(37) AS cleansed_table, specialty_pharmacy_cm_lookup.file_id, count(*) AS counts FROM cleansed.specialty_pharmacy_cm_lookup GROUP BY 'cleansed.specialty_pharmacy_cm_lookup'::varchar(37), specialty_pharmacy_cm_lookup.file_id) UNION ALL SELECT 'cleansed.specialty_pharmacy_lookups'::varchar(35) AS cleansed_table, specialty_pharmacy_lookups.file_id, count(*) AS counts FROM cleansed.specialty_pharmacy_lookups GROUP BY 'cleansed.specialty_pharmacy_lookups'::varchar(35), specialty_pharmacy_lookups.file_id) UNION ALL SELECT 'cleansed.tb_cb_accounts'::varchar(23) AS cleansed_table, tb_cb_accounts.file_id, count(*) AS counts FROM cleansed.tb_cb_accounts GROUP BY 'cleansed.tb_cb_accounts'::varchar(23), tb_cb_accounts.file_id) UNION ALL SELECT 'cleansed.tb_cb_transactions'::varchar(27) AS cleansed_table, tb_cb_transactions.file_id, count(*) AS counts FROM cleansed.tb_cb_transactions GROUP BY 'cleansed.tb_cb_transactions'::varchar(27), tb_cb_transactions.file_id) UNION ALL SELECT 'cleansed.tb_ds_accounts'::varchar(23) AS cleansed_table, tb_ds_accounts.file_id, count(*) AS counts FROM cleansed.tb_ds_accounts GROUP BY 'cleansed.tb_ds_accounts'::varchar(23), tb_ds_accounts.file_id) UNION ALL SELECT 'cleansed.tb_ds_transactions'::varchar(27) AS cleansed_table, tb_ds_transactions.file_id, count(*) AS counts FROM cleansed.tb_ds_transactions GROUP BY 'cleansed.tb_ds_transactions'::varchar(27), tb_ds_transactions.file_id) UNION ALL SELECT 'veeva.time_off_territory_kc'::varchar(27) AS cleansed_table, time_off_territory_kc.file_id, count(*) AS counts FROM veeva.time_off_territory_kc GROUP BY 'veeva.time_off_territory_kc'::varchar(27), time_off_territory_kc.file_id) UNION ALL SELECT 'veeva.time_off_territory'::varchar(24) AS cleansed_table, time_off_territory.file_id, count(*) AS counts FROM veeva.time_off_territory GROUP BY 'veeva.time_off_territory'::varchar(24), time_off_territory.file_id) UNION ALL SELECT 'cleansed.publicis_touchpoint_call'::varchar(33) AS cleansed_table, publicis_touchpoint_call.file_id, count(*) AS counts FROM cleansed.publicis_touchpoint_call GROUP BY 'cleansed.publicis_touchpoint_call'::varchar(33), publicis_touchpoint_call.file_id) UNION ALL SELECT 'cleansed.publicis_touchpoint_presentation'::varchar(41) AS cleansed_table, publicis_touchpoint_presentation.file_id, count(*) AS counts FROM cleansed.publicis_touchpoint_presentation GROUP BY 'cleansed.publicis_touchpoint_presentation'::varchar(41), publicis_touchpoint_presentation.file_id) UNION ALL SELECT 'cleansed.anda_sales_tw'::varchar(22) AS cleansed_table, anda_sales_tw.file_id, count(*) AS counts FROM cleansed.anda_sales_tw GROUP BY 'cleansed.anda_sales_tw'::varchar(22), anda_sales_tw.file_id) UNION ALL SELECT 'cleansed.biologics_sales_tw'::varchar(27) AS cleansed_table, biologics_sales_tw.file_id, count(*) AS counts FROM cleansed.biologics_sales_tw GROUP BY 'cleansed.biologics_sales_tw'::varchar(27), biologics_sales_tw.file_id) UNION ALL SELECT 'cleansed.hd_smith_sales_tw'::varchar(26) AS cleansed_table, hd_smith_sales_tw.file_id, count(*) AS counts FROM cleansed.hd_smith_sales_tw GROUP BY 'cleansed.hd_smith_sales_tw'::varchar(26), hd_smith_sales_tw.file_id) UNION ALL SELECT 'cleansed.ics_account_tw'::varchar(23) AS cleansed_table, ics_account_tw.file_id, count(*) AS counts FROM cleansed.ics_account_tw GROUP BY 'cleansed.ics_account_tw'::varchar(23), ics_account_tw.file_id) UNION ALL SELECT 'cleansed.ics_sales_tw'::varchar(21) AS cleansed_table, ics_sales_tw.file_id, count(*) AS counts FROM cleansed.ics_sales_tw GROUP BY 'cleansed.ics_sales_tw'::varchar(21), ics_sales_tw.file_id) UNION ALL SELECT 'veeva.account'::varchar(13) AS cleansed_table, account.file_id, count(*) AS counts FROM veeva.account GROUP BY 'veeva.account'::varchar(13), account.file_id) UNION ALL SELECT 'veeva.accountshare'::varchar(18) AS cleansed_table, accountshare.file_id, count(*) AS counts FROM veeva.accountshare GROUP BY 'veeva.accountshare'::varchar(18), accountshare.file_id) UNION ALL SELECT 'veeva.account_merge_history'::varchar(27) AS cleansed_table, account_merge_history.file_id, count(*) AS counts FROM veeva.account_merge_history GROUP BY 'veeva.account_merge_history'::varchar(27), account_merge_history.file_id) UNION ALL SELECT 'veeva.address'::varchar(13) AS cleansed_table, address.file_id, count(*) AS counts FROM veeva.address GROUP BY 'veeva.address'::varchar(13), address.file_id) UNION ALL SELECT 'veeva.affiliation'::varchar(17) AS cleansed_table, affiliation.file_id, count(*) AS counts FROM veeva.affiliation GROUP BY 'veeva.affiliation'::varchar(17), affiliation.file_id) UNION ALL SELECT 'veeva.assessment'::varchar(16) AS cleansed_table, assessment.file_id, count(*) AS counts FROM veeva.assessment GROUP BY 'veeva.assessment'::varchar(16), assessment.file_id) UNION ALL SELECT 'veeva.call_goal'::varchar(15) AS cleansed_table, call_goal.file_id, count(*) AS counts FROM veeva.call_goal GROUP BY 'veeva.call_goal'::varchar(15), call_goal.file_id) UNION ALL SELECT 'veeva.call_detail'::varchar(17) AS cleansed_table, call_detail.file_id, count(*) AS counts FROM veeva.call_detail GROUP BY 'veeva.call_detail'::varchar(17), call_detail.file_id) UNION ALL SELECT 'veeva.call_key_message'::varchar(22) AS cleansed_table, call_key_message.file_id, count(*) AS counts FROM veeva.call_key_message GROUP BY 'veeva.call_key_message'::varchar(22), call_key_message.file_id) UNION ALL SELECT 'veeva.call_sample'::varchar(17) AS cleansed_table, call_sample.file_id, count(*) AS counts FROM veeva.call_sample GROUP BY 'veeva.call_sample'::varchar(17), call_sample.file_id) UNION ALL SELECT 'veeva.call'::varchar(10) AS cleansed_table, call.file_id, count(*) AS counts FROM veeva.call GROUP BY 'veeva.call'::varchar(10), call.file_id) UNION ALL SELECT 'veeva.call_history'::varchar(18) AS cleansed_table, call_history.file_id, count(*) AS counts FROM veeva.call_history GROUP BY 'veeva.call_history'::varchar(18), call_history.file_id) UNION ALL SELECT 'veeva.deciles'::varchar(13) AS cleansed_table, deciles.file_id, count(*) AS counts FROM veeva.deciles GROUP BY 'veeva.deciles'::varchar(13), deciles.file_id) UNION ALL SELECT 'veeva.group'::varchar(11) AS cleansed_table, "group".file_id, count(*) AS counts FROM veeva."group" GROUP BY 'veeva.group'::varchar(11), "group".file_id) UNION ALL SELECT 'veeva.key_message'::varchar(17) AS cleansed_table, key_message.file_id, count(*) AS counts FROM veeva.key_message GROUP BY 'veeva.key_message'::varchar(17), key_message.file_id) UNION ALL SELECT 'veeva.medical_inquiry'::varchar(21) AS cleansed_table, medical_inquiry.file_id, count(*) AS counts FROM veeva.medical_inquiry GROUP BY 'veeva.medical_inquiry'::varchar(21), medical_inquiry.file_id) UNION ALL SELECT 'veeva.product_metrics'::varchar(21) AS cleansed_table, product_metrics.file_id, count(*) AS counts FROM veeva.product_metrics GROUP BY 'veeva.product_metrics'::varchar(21), product_metrics.file_id) UNION ALL SELECT 'veeva.product'::varchar(13) AS cleansed_table, product.file_id, count(*) AS counts FROM veeva.product GROUP BY 'veeva.product'::varchar(13), product.file_id) UNION ALL SELECT 'veeva.survey_question_response'::varchar(30) AS cleansed_table, survey_question_response.file_id, count(*) AS counts FROM veeva.survey_question_response GROUP BY 'veeva.survey_question_response'::varchar(30), survey_question_response.file_id) UNION ALL SELECT 'veeva.recordtype'::varchar(16) AS cleansed_table, recordtype.file_id, count(*) AS counts FROM veeva.recordtype GROUP BY 'veeva.recordtype'::varchar(16), recordtype.file_id) UNION ALL SELECT 'veeva.survey_question'::varchar(21) AS cleansed_table, survey_question.file_id, count(*) AS counts FROM veeva.survey_question GROUP BY 'veeva.survey_question'::varchar(21), survey_question.file_id) UNION ALL SELECT 'veeva.survey_target'::varchar(19) AS cleansed_table, survey_target.file_id, count(*) AS counts FROM veeva.survey_target GROUP BY 'veeva.survey_target'::varchar(19), survey_target.file_id) UNION ALL SELECT 'veeva.survey'::varchar(12) AS cleansed_table, survey.file_id, count(*) AS counts FROM veeva.survey GROUP BY 'veeva.survey'::varchar(12), survey.file_id) UNION ALL SELECT 'veeva.sync_tracking'::varchar(19) AS cleansed_table, sync_tracking.file_id, count(*) AS counts FROM veeva.sync_tracking GROUP BY 'veeva.sync_tracking'::varchar(19), sync_tracking.file_id) UNION ALL SELECT 'veeva.territory'::varchar(15) AS cleansed_table, territory.file_id, count(*) AS counts FROM veeva.territory GROUP BY 'veeva.territory'::varchar(15), territory.file_id) UNION ALL SELECT 'veeva.tsf'::varchar(9) AS cleansed_table, tsf.file_id, count(*) AS counts FROM veeva.tsf GROUP BY 'veeva.tsf'::varchar(9), tsf.file_id) UNION ALL SELECT 'veeva.veeva_user'::varchar(16) AS cleansed_table, veeva_user.file_id, count(*) AS counts FROM veeva.veeva_user GROUP BY 'veeva.veeva_user'::varchar(16), veeva_user.file_id) UNION ALL SELECT 'veeva.user_role'::varchar(15) AS cleansed_table, user_role.file_id, count(*) AS counts FROM veeva.user_role GROUP BY 'veeva.user_role'::varchar(15), user_role.file_id) UNION ALL SELECT 'veeva.user_territory'::varchar(20) AS cleansed_table, user_territory.file_id, count(*) AS counts FROM veeva.user_territory GROUP BY 'veeva.user_territory'::varchar(20), user_territory.file_id) UNION ALL SELECT 'cleansed.valuecentric_867'::varchar(25) AS cleansed_table, valuecentric_867.file_id, count(*) AS counts FROM cleansed.valuecentric_867 GROUP BY 'cleansed.valuecentric_867'::varchar(25), valuecentric_867.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tc'::varchar(24) AS cleansed_table, zs_call_plan_tc.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tc GROUP BY 'cleansed.zs_call_plan_tc'::varchar(24), zs_call_plan_tc.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tn'::varchar(24) AS cleansed_table, zs_call_plan_tn.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tn GROUP BY 'cleansed.zs_call_plan_tn'::varchar(24), zs_call_plan_tn.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tp'::varchar(24) AS cleansed_table, zs_call_plan_tp.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tp GROUP BY 'cleansed.zs_call_plan_tp'::varchar(24), zs_call_plan_tp.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tr'::varchar(24) AS cleansed_table, zs_call_plan_tr.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tr GROUP BY 'cleansed.zs_call_plan_tr'::varchar(24), zs_call_plan_tr.file_id) UNION ALL SELECT 'cleansed.zs_call_plan_tw'::varchar(24) AS cleansed_table, zs_call_plan_tw.file_id, count(*) AS counts FROM cleansed.zs_call_plan_tw GROUP BY 'cleansed.zs_call_plan_tw'::varchar(24), zs_call_plan_tw.file_id) UNION ALL SELECT 'cleansed.kc_hr_job_titles'::varchar(25) AS cleansed_table, kc_hr_job_titles.file_id, count(*) AS counts FROM cleansed.kc_hr_job_titles GROUP BY 'cleansed.kc_hr_job_titles'::varchar(25), kc_hr_job_titles.file_id) UNION ALL SELECT 'cleansed.kc_hr_people'::varchar(21) AS cleansed_table, kc_hr_people.file_id, count(*) AS counts FROM cleansed.kc_hr_people GROUP BY 'cleansed.kc_hr_people'::varchar(21), kc_hr_people.file_id) UNION ALL SELECT 'cleansed.kc_hr_people_addresses'::varchar(31) AS cleansed_table, kc_hr_people_addresses.file_id, count(*) AS counts FROM cleansed.kc_hr_people_addresses GROUP BY 'cleansed.kc_hr_people_addresses'::varchar(31), kc_hr_people_addresses.file_id) UNION ALL SELECT 'cleansed.kc_hr_people_phones'::varchar(28) AS cleansed_table, kc_hr_people_phones.file_id, count(*) AS counts FROM cleansed.kc_hr_people_phones GROUP BY 'cleansed.kc_hr_people_phones'::varchar(28), kc_hr_people_phones.file_id) UNION ALL SELECT 'cleansed.kc_hr_phones'::varchar(21) AS cleansed_table, kc_hr_phones.file_id, count(*) AS counts FROM cleansed.kc_hr_phones GROUP BY 'cleansed.kc_hr_phones'::varchar(21), kc_hr_phones.file_id) UNION ALL SELECT 'cleansed.kc_hr_territories'::varchar(26) AS cleansed_table, kc_hr_territories.file_id, count(*) AS counts FROM cleansed.kc_hr_territories GROUP BY 'cleansed.kc_hr_territories'::varchar(26), kc_hr_territories.file_id) UNION ALL SELECT 'customer_master.hco_demo'::varchar(24) AS cleansed_table, hco_demo.file_id, count(*) AS counts FROM customer_master.hco_demo GROUP BY 'customer_master.hco_demo'::varchar(24), hco_demo.file_id) UNION ALL SELECT 'customer_master.hcp_demo'::varchar(24) AS cleansed_table, hcp_demo.file_id, count(*) AS counts FROM customer_master.hcp_demo GROUP BY 'customer_master.hcp_demo'::varchar(24), hcp_demo.file_id) UNION ALL SELECT 'customer_master.tvcmid_merges'::varchar(29) AS cleansed_table, tvcmid_merges.file_id, count(*) AS counts FROM customer_master.tvcmid_merges GROUP BY 'customer_master.tvcmid_merges'::varchar(29), tvcmid_merges.file_id) UNION ALL SELECT 'customer_master.tvcmid_xref'::varchar(27) AS cleansed_table, tvcmid_xref.file_id, count(*) AS counts FROM customer_master.tvcmid_xref GROUP BY 'customer_master.tvcmid_xref'::varchar(27), tvcmid_xref.file_id) UNION ALL SELECT 'cleansed.nw_hr_sales_loa'::varchar(24) AS cleansed_table, nw_hr_sales_loa.file_id, count(*) AS counts FROM cleansed.nw_hr_sales_loa GROUP BY 'cleansed.nw_hr_sales_loa'::varchar(24), nw_hr_sales_loa.file_id) UNION ALL SELECT 'cleansed.nw_hr_sales_roster'::varchar(27) AS cleansed_table, nw_hr_sales_roster.file_id, count(*) AS counts FROM cleansed.nw_hr_sales_roster GROUP BY 'cleansed.nw_hr_sales_roster'::varchar(27), nw_hr_sales_roster.file_id) UNION ALL SELECT 'cleansed.nw_hr_terr_id_change'::varchar(29) AS cleansed_table, nw_hr_terr_id_change.file_id, count(*) AS counts FROM cleansed.nw_hr_terr_id_change GROUP BY 'cleansed.nw_hr_terr_id_change'::varchar(29), nw_hr_terr_id_change.file_id) A ORDER BY A.cleansed_table, A.file_id;

CREATE  VIEW sandbox.create_paragard_anda_sales AS
SELECT sh.source_customer_id AS "BP #", NULL AS "Ortho E", sh.customer_name AS "BP Name", coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1) AS "Ship-to Street", sh.ship_to_city AS "Ship-to City", sh.ship_to_state AS "Ship-to State", sh.ship_to_zip AS "Ship-to ZipCd", NULL AS "Ship-to Ctry", NULL AS "Ship-to Phone", NULL AS "Ship-to Fax", NULL AS "Ship-to Email", ad.address AS "Bill-to Street", ad.city AS "Bill-to City", ad.state AS "Bill-to State", ad.zip_code AS "Bill-to ZipCd", NULL AS "Bill-to Ctry", NULL AS "Bill-to Phone", NULL AS "Bill-to Fax", NULL AS "Bill-to Email", CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END AS "Class of Trade", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS "Invoice #", CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END AS "Del Amt", to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS "Inv Date", CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END AS Packs, NULL AS UnitPrice, NULL AS Territory, NULL AS "Order Type Cd", NULL AS "Order Type Desc", NULL AS LOBCdDesc, NULL AS PriceMatrixDef, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))) AS ParentBPCd, NULL AS ParentBPCdDesc, NULL AS GrandParentBPCdDesc, NULL AS "PO#", NULL AS "UPS#", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS OrdNbr, NULL AS OrdLnNbr, NULL AS DiscAmt, NULL AS WhseCd, 'ANDA'::varchar(4) AS DATA_SOURCE, '51285020401'::varchar(11) AS NDC11_CODE FROM (datamart.specialty_pharmacy_shipment sh LEFT JOIN (SELECT tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code FROM datamart.tw_address) ad ON ((sh.tw_bill_to_address_id = ad.address_id))) WHERE ((sh.basket_name ~~ '%PARAGARD%'::varchar(10)) AND (sh.specialty_pharmacy_data_source = 'Anda'::varchar(4)) AND (sh.ship_date >= add_months(trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)), (-1))) AND (sh.ship_date < trunc(('now()'::varchar(5))::date, 'MM'::varchar(2)))) GROUP BY sh.source_customer_id, NULL, sh.customer_name, coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1), sh.ship_to_city, sh.ship_to_state, sh.ship_to_zip, ad.address, ad.city, ad.state, ad.zip_code, CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END, CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END, CASE mod(sh.invoice_amount, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.invoice_amount)::int)::varchar ELSE rtrim((sh.invoice_amount)::varchar, '0'::varchar(1)) END, to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)), CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END, CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))), 'ANDA'::varchar(4), '51285020401'::varchar(11);

CREATE  VIEW outbound.zzz_asi_market_access_w AS
SELECT A.zip, A.state, A.payer_plan_num, A.report_num, A.ims_product_group_num, A.data_month, A.nrx_001, A.nrx_002, A.nrx_003, A.nrx_004, A.nrx_005, A.nrx_006, A.nrx_007, A.nrx_008, A.nrx_009, A.nrx_010, A.nrx_011, A.nrx_012, A.nrx_013, A.nrx_014, A.nrx_015, A.nrx_016, A.nrx_017, A.nrx_018, A.nrx_019, A.nrx_020, A.nrx_021, A.nrx_022, A.nrx_023, A.nrx_024, A.trx_001, A.trx_002, A.trx_003, A.trx_004, A.trx_005, A.trx_006, A.trx_007, A.trx_008, A.trx_009, A.trx_010, A.trx_011, A.trx_012, A.trx_013, A.trx_014, A.trx_015, A.trx_016, A.trx_017, A.trx_018, A.trx_019, A.trx_020, A.trx_021, A.trx_022, A.trx_023, A.trx_024 FROM ((SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state, mpzd.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((((datamart.prescriber_rx rx JOIN outbound.month_rollup_and_bucket iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN (SELECT market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state FROM outbound.market_presc_zip_divisor GROUP BY market_presc_zip_divisor.ims_id, market_presc_zip_divisor.ims_client_number, market_presc_zip_divisor.ims_report_number, market_presc_zip_divisor.state) mpzd ON (((rx.ims_id = mpzd.ims_id) AND (rx.ims_client_number = mpzd.ims_client_number) AND (rx.ims_report_number_cnt = mpzd.ims_report_number)))) LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo WHERE (hcp_demo.file_id = (SELECT max(customer_hcp_demographics.file_id) AS MAX FROM datamart.customer_hcp_demographics))) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo WHERE (hco_demo.file_id = (SELECT max(customer_hco_demographics.file_id) AS MAX FROM datamart.customer_hco_demographics))) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_report_number_cnt = ANY (ARRAY['1'::varchar(1), '2'::varchar(1), '3'::varchar(1), '4'::varchar(1), '5'::varchar(1), '6'::varchar(1), '68'::varchar(2)])) AND (rx.report_frequency = 'SPLITWEEK'::varchar(9))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state, mpzd.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime Therapeutics'::varchar(18)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) UNION ALL SELECT CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END AS ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN (SELECT month_rollup_and_bucket.month_ending, month_rollup_and_bucket.month_bucket FROM outbound.month_rollup_and_bucket) mth ON ((add_months(last_day(sp.ship_date), 1) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY CASE WHEN (sp.ship_to_zip IS NULL) THEN '00000'::varchar(5) ELSE sp.ship_to_zip END, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(x.month_ending, 'MM/YYYY'::varchar(7)) AS TO_CHAR FROM (SELECT max(month_rollup_and_bucket.month_ending) AS month_ending FROM outbound.month_rollup_and_bucket) x)) A;

CREATE  VIEW outbound.zzz_asi_rx_by_market_ms AS
(SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (last_day(rx.date) = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (datamart.prescriber_rx rx JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number = axd.ims_client_number) AND (rx.ims_report_number_cnt = axd.ims_report_number) AND (rx.ims_id = axd.ims_id) AND (rx.ims_product_group = axd.ims_product_group) AND (rx.ims_specialty = axd.ims_specialty) AND (rx.ims_zip_other = axd.ims_zip_other)))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '2'::varchar(1)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))), rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, rx.ims_zip AS zip_other, sp.ims_id, rx.ims_specialty AS specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END AS plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, rx.ims_me_num AS me_num, rx.ims_last_name AS last_name, rx.ims_first_name AS first_name, rx.ims_middle_name AS middle_name, rx.ims_address AS address, rx.ims_city AS city, rx.ims_state AS state_code, rx.ims_zip AS zip, NULL AS supplemental_data, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END AS plan_name, to_char(mth2.data_date, 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN (SELECT max(month_rollup_and_bucket.month_ending) AS data_date FROM outbound.month_rollup_and_bucket) mth2 ON (true)) JOIN reference.asi_outbound_ims_product_group_mapping pg ON (((sp.specialty_pharmacy_data_source = pg.data_source) AND (sp.basket_id = pg.basket_id) AND (pg.market_name = 'MS MARKET'::varchar(9))))) LEFT JOIN (SELECT a.ims_last_name, a.ims_first_name, a.ims_middle_name, a.ims_address, a.ims_city, a.ims_state, a.ims_zip, a.ims_client_number, a.ims_me_num, a.ims_id, a.ims_specialty, a.rnk FROM (SELECT axd.ims_last_name, axd.ims_first_name, axd.ims_middle_name, axd.ims_address, axd.ims_city, axd.ims_state, axd.ims_zip, axd.ims_client_number, axd.ims_me_num, axd.ims_id, axd.ims_specialty, row_number() OVER (PARTITION BY axd.ims_id ORDER BY axd.ims_specialty) AS rnk FROM outbound.asi_xponent_demographics axd) a WHERE (a.rnk = 1)) rx ON (((rx.ims_id = sp.ims_id) AND (rx.ims_client_number = '632'::varchar(3))))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'OptumRx'::varchar(7)])) AND (sp.ims_id IS NOT NULL)) GROUP BY pg.market_name, sp.ims_id, rx.ims_specialty, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END, pg.ims_product_group, rx.ims_me_num, rx.ims_last_name, rx.ims_first_name, rx.ims_middle_name, rx.ims_address, rx.ims_city, rx.ims_state, rx.ims_zip, CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3 MAIL ORDER DATA UNSPEC'::varchar(25) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3 TYSABRI MAIL ORDER DATA UNSPEC'::varchar(33) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME MAIL ORDER DATA UNSPEC'::varchar(28) ELSE NULL END, to_char(mth2.data_date, 'MMDDYY'::varchar(6))) UNION ALL SELECT pg.market_name, '632'::varchar(3) AS ims_client_num, '2'::varchar(2) AS ims_report_num, cm.zip AS zip_other, NULL AS ims_id, '01N'::varchar(3) AS specialty, 'CMOP000000'::varchar(10) AS payer_plan_id, '02'::varchar(2) AS sales_category, 'B'::varchar(1) AS rx_type, pg.ims_product_group AS ims_product_group_num, NULL AS filler_01, '0'::varchar(1) AS me_num, 'NATIONAL ASSIGNMENT'::varchar(19) AS last_name, NULL AS first_name, NULL AS middle_name, NULL AS address, NULL AS city, NULL AS state, '00001'::varchar(5) AS zip, NULL AS supplemental_data, 'VA DATA UNSPEC'::varchar(14) AS plan_name, to_char(mth2.data_date, 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN cm.total_rxs_normalized ELSE NULL::float END) AS trx_024 FROM (((datamart.cmop_rx cm JOIN outbound.month_rollup_and_bucket mth ON ((last_day(cm.comp_month) = mth.month_ending))) JOIN (SELECT max(month_rollup_and_bucket.month_ending) AS data_date FROM outbound.month_rollup_and_bucket) mth2 ON (true)) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group FROM reference.asi_outbound_ims_product_group_mapping WHERE ((asi_outbound_ims_product_group_mapping.data_source = 'CMOP'::varchar(4)) AND (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9))) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group) pg ON ((pg.basket_id = cm.basket_id))) WHERE ((mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (cm.total_rxs_normalized <> 0::numeric(18,0))) GROUP BY pg.market_name, cm.zip, pg.ims_product_group, to_char(mth2.data_date, 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_cns AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_cns AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_oncology AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = 'TO'::varchar(2)) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_detailed_data_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, c.sales_force_id, c.territory_num, NULL AS me_number, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)) AS call_date, c.basket_id AS product_id, c.product AS product_name, c.detail_position AS "position", d.ZIP AS physician_zip, x.specialty_code FROM ((((SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.sales_force_id, c.tvcmid, c.veeva_account_id, c.territory_number AS territory_num, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.sales_force_id, c.tvcmid, c.veeva_account_id, c.territory_number, c.rep_id, d.basket_id, d.product, c.call_date, d.detail_position) c ON (((d.tvcmid = c.tvcmid) AND (d.territory_num = c.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) WHERE (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY 'TEVA'::varchar(4), c.sales_force_id, c.territory_num, NULL, d.npi, d.VEEVA_ACCOUNT_ID, c.tvcmid, d.ims_id, to_char(c.call_date, 'mm/dd/yyyy'::varchar(10)), c.basket_id, c.product, c.detail_position, d.ZIP, x.specialty_code;

CREATE  VIEW outbound.zzz_asi_market_access_m AS
(SELECT coalesce(d.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(d.state, o.state, pcd.ptr_state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, rx.ims_product_group AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), 0)) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-1))) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-2))) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-3))) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-4))) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-5))) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-6))) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-7))) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-8))) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-9))) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-10))) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-11))) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-12))) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-13))) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-14))) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-15))) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-16))) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-17))) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-18))) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-19))) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-20))) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-21))) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-22))) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (rx.date = add_months(last_day(rx.data_date), (-23))) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((datamart.prescriber_rx rx LEFT JOIN (SELECT hcp_demo.tvcmid, hcp_demo.state_code AS state, hcp_demo.zip FROM datamart.customer_hcp_demographics hcp_demo) d ON ((rx.tvcmid = d.tvcmid))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) WHERE ((rx.ims_report_number_cnt = ANY (ARRAY['2'::varchar(1), '6'::varchar(1), '14'::varchar(2), '16'::varchar(2), '81'::varchar(2)])) AND (rx.basket_type = 'product'::varchar(7)) AND (rx.report_frequency = 'MONTH'::varchar(5))) GROUP BY coalesce(d.zip, o.zip, pcd.ptr_zip), coalesce(d.state, o.state, pcd.ptr_state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, rx.ims_product_group, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) UNION ALL SELECT sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.comp_month) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['Prime Therapeutics'::varchar(18), 'Prime T'::varchar(7)])) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (sp.ims_id IS NOT NULL)) GROUP BY sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1))) UNION ALL SELECT sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END AS payer_plan_num, '55'::varchar(2) AS report_num, pg.ims_product_group AS ims_product_group_num, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1)) AS data_month, NULL::float AS nrx_001, NULL::float AS nrx_002, NULL::float AS nrx_003, NULL::float AS nrx_004, NULL::float AS nrx_005, NULL::float AS nrx_006, NULL::float AS nrx_007, NULL::float AS nrx_008, NULL::float AS nrx_009, NULL::float AS nrx_010, NULL::float AS nrx_011, NULL::float AS nrx_012, NULL::float AS nrx_013, NULL::float AS nrx_014, NULL::float AS nrx_015, NULL::float AS nrx_016, NULL::float AS nrx_017, NULL::float AS nrx_018, NULL::float AS nrx_019, NULL::float AS nrx_020, NULL::float AS nrx_021, NULL::float AS nrx_022, NULL::float AS nrx_023, NULL::float AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN sp.trx_cnt ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN sp.trx_cnt ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN sp.trx_cnt ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN sp.trx_cnt ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN sp.trx_cnt ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN sp.trx_cnt ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN sp.trx_cnt ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN sp.trx_cnt ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN sp.trx_cnt ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN sp.trx_cnt ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN sp.trx_cnt ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN sp.trx_cnt ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN sp.trx_cnt ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN sp.trx_cnt ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN sp.trx_cnt ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN sp.trx_cnt ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN sp.trx_cnt ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN sp.trx_cnt ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN sp.trx_cnt ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN sp.trx_cnt ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN sp.trx_cnt ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN sp.trx_cnt ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN sp.trx_cnt ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN sp.trx_cnt ELSE NULL::float END) AS trx_024 FROM ((datamart.specialty_pharmacy_shipment sp JOIN outbound.month_rollup_and_bucket mth ON ((last_day(sp.ship_date) = mth.month_ending))) JOIN (SELECT asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source FROM reference.asi_outbound_ims_product_group_mapping WHERE (asi_outbound_ims_product_group_mapping.market_name = 'MS MARKET'::varchar(9)) GROUP BY asi_outbound_ims_product_group_mapping.basket_id, asi_outbound_ims_product_group_mapping.market_name, asi_outbound_ims_product_group_mapping.ims_product_group, asi_outbound_ims_product_group_mapping.data_source) pg ON (((pg.basket_id = sp.basket_id) AND (pg.data_source = sp.specialty_pharmacy_data_source)))) WHERE ((sp.specialty_pharmacy_data_source = ANY (ARRAY['OptumRx'::varchar(7), 'OptumRx'::varchar(7)])) AND (mth.month_bucket >= 1) AND (mth.month_bucket <= 24) AND (sp.ims_id IS NOT NULL)) GROUP BY sp.ship_to_zip, sp.ship_to_state, CASE WHEN (pg.market_name = 'MS MARKET'::varchar(9)) THEN CASE WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id <> 572)) THEN 'I3'::varchar(2) WHEN ((sp.specialty_pharmacy_data_source = 'OptumRx'::varchar(7)) AND (sp.basket_id = 572)) THEN 'I3TYS'::varchar(5) WHEN (sp.specialty_pharmacy_data_source = 'Prime Therapeutics'::varchar(18)) THEN 'PRIME'::varchar(5) ELSE NULL END ELSE NULL END, pg.ims_product_group, (SELECT to_char(month_rollup_and_bucket.month_ending, 'MM/YYYY'::varchar(7)) AS to_char FROM outbound.month_rollup_and_bucket WHERE (month_rollup_and_bucket.month_bucket = 1));

CREATE  VIEW public.sql_files_view AS
 SELECT 'Please run compute_flextable_keys_and_build_view() to update this view to reflect real and virtual columns in the flex table'::varchar(124) AS status
 FROM v_catalog.dual;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_tb_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, replace(rt1.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_from_account_type, acct1.OUTLET_ID_TVA__C AS ims_outlet_code, acct1.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, replace(rt2.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_to_account_type, acct2.ID_VOD__C AS ims_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt1 ON ((acct1.RECORDTYPEID = rt1.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt2 ON ((acct2.RECORDTYPEID = rt2.ID))) JOIN (SELECT acctshr.ACCOUNTID AS accountid FROM (WSMP_ADMIN.VV_ACCOUNTSHARE acctshr JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) WHERE (g.DEVELOPERNAME ~~ 'TB%'::varchar(3)) GROUP BY acctshr.ACCOUNTID) x ON ((acct1.ID = x.accountid))) WHERE (rt1.NAME <> ALL (ARRAY['Professional_vod'::varchar(16), 'Staff'::varchar(5)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_segment AS
SELECT iq.veeva_account_id, iq.product_name, iq.segment FROM (SELECT pm.ACCOUNT_VOD__C AS veeva_account_id, p.NAME AS product_name, coalesce(pm.SEGMENT__C, pm.BUSINESS_SEGMENT_TVA__C) AS segment, row_number() OVER (PARTITION BY pm.ACCOUNT_VOD__C, p.NAME ORDER BY pm.LASTMODIFIEDDATE) AS rnk FROM (WSMP_ADMIN.VV_PRODUCT_METRICS_VOD__C pm JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((pm.PRODUCTS_VOD__C = p.ID))) WHERE ((pm.SEGMENT__C IS NOT NULL) OR (pm.BUSINESS_SEGMENT_TVA__C IS NOT NULL))) iq WHERE (iq.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_samples AS
SELECT s.ID AS sample_id, c.ID AS call_id, a.ID AS veeva_account_id, trunc(c.LOCAL_CALL_DATETIME_VOD__C, 'DD'::varchar(2)) AS call_date, substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.CALL_TYPE_VOD__C AS call_type, c.ATTENDEE_TYPE_VOD__C AS attendee_type, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (a.ID_VOD__C IS NULL) AND (a.CREDENTIALS_VOD__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS demo_type, CASE WHEN (p.PRODUCT_TYPE_VOD__C = 'BRC'::varchar(3)) THEN 'REQUEST'::varchar(7) ELSE 'DROP'::varchar(4) END AS sample_type, upper(pp.NAME) AS product_name, upper(p.NAME) AS sample_name, p.PRODUCT_ID_TEVA__C AS sample_ndc, s.QUANTITY_VOD__C AS qty, c.ENTITY_DISPLAY_NAME_VOD__C AS name_on_call, c.ADDRESS_LINE_1_VOD__C AS address1_on_call, c.ADDRESS_LINE_2_VOD__C AS address2_on_call, c.CITY_VOD__C AS city_on_call, c.STATE_VOD__C AS state_on_call, c.ZIP_VOD__C AS zip_on_call, a.ID_VOD__C AS ims_id, c.DEA_VOD__C AS dea_num, c.OWNERID AS ownerid, u.EMPLOYEENUMBER AS employeenumber, c.PARENT_CALL_VOD__C AS parent_call_id, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date FROM (((((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_CALL2_SAMPLE_VOD__C s ON ((c.ID = s.CALL2_VOD__C))) JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((s.PRODUCT_VOD__C = p.ID))) LEFT JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C pp ON ((p.PARENT_PRODUCT_VOD__C = pp.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rtc ON ((c.RECORDTYPEID = rtc.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((a.RECORDTYPEID = rta.ID))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) WHERE ((c.LOCAL_CALL_DATETIME_VOD__C >= '2012-01-01 00:00:00'::timestamp(0)) AND (c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)) AND (p.PRODUCT_TYPE_VOD__C = ANY (ARRAY['BRC'::varchar(3), 'Sample'::varchar(6)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_rtm AS
SELECT substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.ID AS call_id, c.ACCOUNT_VOD__C AS veeva_account_id, a.ID_VOD__C AS ims_id, a.EXTERNAL_ID_VOD__C AS siebel_id, trunc(c.CALL_DATETIME_VOD__C, 'DD'::varchar(2)) AS rtm_letter_date, CASE WHEN (p.PRODUCT_ID_TEVA__C ~~ 'AMR%'::varchar(4)) THEN 'AMRIX'::varchar(5) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'FEN%'::varchar(4)) THEN 'FENTORA'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'NUV%'::varchar(4)) THEN 'NUVIGIL'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TIRF%'::varchar(5)) THEN 'FENTORA'::varchar(7) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TRE%'::varchar(4)) THEN 'TREANDA'::varchar(7) ELSE 'error'::varchar(5) END AS product_name, CASE WHEN (p.PRODUCT_ID_TEVA__C ~~ 'AMR%'::varchar(4)) THEN 'A00100'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'FEN%'::varchar(4)) THEN '300500'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'NUV%'::varchar(4)) THEN '100N00'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TIRF%'::varchar(5)) THEN '300500'::varchar(6) WHEN (p.PRODUCT_ID_TEVA__C ~~ 'TRE%'::varchar(4)) THEN 'ONC590'::varchar(6) ELSE 'error'::varchar(5) END AS product_code, p.PRODUCT_ID_TEVA__C AS rtm_letter_code, p.DESCRIPTION_VOD__C AS description, c.ENTITY_DISPLAY_NAME_VOD__C AS prof_full_name, u.EMPLOYEENUMBER AS emp_id, u.NAME AS emp_full_name, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date FROM ((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_CALL2_SAMPLE_VOD__C s ON ((c.ID = s.CALL2_VOD__C))) JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((s.PRODUCT_VOD__C = p.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) WHERE ((p.PRODUCT_TYPE_VOD__C = 'Educational'::varchar(11)) AND (p.SUB_TYPE__C = 'Letters'::varchar(7)) AND (c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_merge_history AS
SELECT vv_acct_merge_history_vod__c.NAME AS old_veeva_account_id, vv_acct_merge_history_vod__c.ACCOUNT_VOD__C AS new_veeva_account_id, vv_acct_merge_history_vod__c.CREATEDDATE AS merge_date FROM WSMP_ADMIN.VV_ACCT_MERGE_HISTORY_VOD__C;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_call_plan AS
SELECT iq.account_tva__c AS veeva_account_id, iq.id_vod__c AS ims_id, substr(iq.territory_tva__c, 1, 2) AS sales_force_id, iq.territory_tva__c AS territory_num, initcap(iq.name) AS prod, sum(CASE WHEN (iq.priority_tva__c = 1::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p1, sum(CASE WHEN (iq.priority_tva__c = 2::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p2, sum(CASE WHEN (iq.priority_tva__c = 3::numeric(18,0)) THEN iq.goal_tva__c ELSE 0::numeric(18,0) END) AS committed_p3, iq.lastname AS last_name, iq.firstname AS first_name, iq.start_date_tva__c AS start_date, iq.end_date_tva__c AS end_date FROM (SELECT cg.ACCOUNT_TVA__C AS account_tva__c, a.ID_VOD__C AS id_vod__c, cg.TERRITORY_TVA__C AS territory_tva__c, p.NAME AS name, cg.PRIORITY_TVA__C AS priority_tva__c, cg.GOAL_TVA__C AS goal_tva__c, a.LASTNAME AS lastname, a.FIRSTNAME AS firstname, cg.START_DATE_TVA__C AS start_date_tva__c, cg.END_DATE_TVA__C AS end_date_tva__c FROM ((WSMP_ADMIN.VV_CALL_GOAL_TVA__C cg JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((cg.PRODUCT_CATALOG_TVA__C = p.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((cg.ACCOUNT_TVA__C = a.ID)))) iq GROUP BY iq.account_tva__c, iq.id_vod__c, iq.territory_tva__c, iq.name, iq.lastname, iq.firstname, iq.start_date_tva__c, iq.end_date_tva__c;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_bp_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, acct1.EXTERNAL_ID_VOD__C AS bp_code, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, acct2.ID_VOD__C AS ims_id FROM (((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt ON ((acct1.RECORDTYPEID = rt.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) WHERE (rt.NAME = 'ParaGard_TVA'::varchar(12));

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_affiliations AS
SELECT affl.FROM_ACCOUNT_VOD__C AS affiliated_from_id, replace(rt1.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_from_account_type, acct1.OUTLET_ID_TVA__C AS ims_outlet_code, acct1.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id, affl.TO_ACCOUNT_VOD__C AS affiliated_to_id, replace(rt2.NAME, '_vod'::varchar(4), ''::varchar) AS affiliated_to_account_type, acct2.ID_VOD__C AS ims_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acct1 JOIN WSMP_ADMIN.VV_AFFILIATION_VOD__C affl ON ((acct1.ID = affl.FROM_ACCOUNT_VOD__C))) JOIN WSMP_ADMIN.VV_ACCOUNT acct2 ON ((affl.TO_ACCOUNT_VOD__C = acct2.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt1 ON ((acct1.RECORDTYPEID = rt1.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rt2 ON ((acct2.RECORDTYPEID = rt2.ID))) JOIN (SELECT acctshr.ACCOUNTID AS accountid FROM (WSMP_ADMIN.VV_ACCOUNTSHARE acctshr JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) GROUP BY acctshr.ACCOUNTID) x ON ((acct1.ID = x.accountid))) WHERE (rt1.NAME <> ALL (ARRAY['Professional_vod'::varchar(16), 'Staff'::varchar(5)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_territory_rep_mgr_dir AS
SELECT rep.SALES_FORCE_ID AS sales_force_id, rep.TERRITORY_NUM AS rep_territory_num, rep.TERRITORY_NAME AS rep_territory_name, m.TERRITORY_NUM AS m_territory_num, m.TERRITORY_NAME AS m_territory_name, d.TERRITORY_NUM AS d_territory_num, d.TERRITORY_NAME AS d_territory_name, h.TERRITORY_NUM AS h_territory_num, h.TERRITORY_NAME AS h_territory_name FROM (((WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA rep LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA m ON ((rep.PARENT_TERRITORY_NUM = m.TERRITORY_NUM))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA d ON (((m.PARENT_TERRITORY_NUM = d.TERRITORY_NUM) AND (d.REP_TYPE IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA h ON ((d.PARENT_TERRITORY_NUM = h.TERRITORY_NUM))) WHERE (rep.REP_TYPE = 'REP'::varchar(3));

CREATE  VIEW WSMP_ADMIN_ORA.v_roster_teva_rep_mgr_dir AS
SELECT rep.SALES_FORCE_ID AS sales_force_id, rep.EMPLOYEE_ID AS rep_emp_id, rep.TERRITORY_NUM AS rep_territory_num, rep.FIRST_NAME AS rep_first_name, rep.LAST_NAME AS rep_last_name, rep.FULL_NAME AS rep_full_name, rep.EMAIL AS rep_email, rep.USERNAME AS rep_username, rep.HIRE_DATE AS rep_hire_date, m.EMPLOYEE_ID AS m_emp_id, m.TERRITORY_NUM AS m_territory_num, m.FIRST_NAME AS m_first_name, m.LAST_NAME AS m_last_name, m.FULL_NAME AS m_full_name, m.EMAIL AS m_email, m.USERNAME AS m_username, d.EMPLOYEE_ID AS d_emp_id, d.TERRITORY_NUM AS d_territory_num, d.FIRST_NAME AS d_first_name, d.LAST_NAME AS d_last_name, d.FULL_NAME AS d_full_name, d.EMAIL AS d_email, d.USERNAME AS d_username, h.EMPLOYEE_ID AS h_emp_id, h.TERRITORY_NUM AS h_territory_num, h.FIRST_NAME AS h_first_name, h.LAST_NAME AS h_last_name, h.FULL_NAME AS h_full_name, h.EMAIL AS h_email, h.USERNAME AS h_username FROM (((WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA rep LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA m ON ((rep.PARENT_TERRITORY_NUM = m.TERRITORY_NUM))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA d ON (((m.PARENT_TERRITORY_NUM = d.TERRITORY_NUM) AND (d.REP_TYPE IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA h ON ((d.PARENT_TERRITORY_NUM = h.TERRITORY_NUM))) WHERE (rep.REP_TYPE = 'REP'::varchar(3)) ORDER BY rep.TERRITORY_NUM;

CREATE  VIEW WSMP_ADMIN_ORA.v_onc_related_accounts AS
SELECT ra.ACCT_DEMO_ID AS acct_demo_id, coalesce(ad.OUTLET_NAME, ad.FACILITY_NAME, ad.PRESCRIBER_NAME) AS acct_name, ra.REL_TYPE AS rel_type, ra.REL_ACCT_DEMO_ID AS rel_acct_demo_id, coalesce(rd.OUTLET_NAME, rd.FACILITY_NAME, rd.PRESCRIBER_NAME) AS rel_acct_name FROM ((WSMP_ADMIN.DIM_ONC_RELATED_ACCOUNTS ra JOIN WSMP_ADMIN.DIM_ONC_ACCOUNT_DEMO ad ON ((ad.ACCT_DEMO_ID = ra.ACCT_DEMO_ID))) JOIN WSMP_ADMIN.DIM_ONC_ACCOUNT_DEMO rd ON ((rd.ACCT_DEMO_ID = ra.REL_ACCT_DEMO_ID)));

CREATE  VIEW WSMP_ADMIN_ORA.v_hcos_kaiser_prof_affil AS
SELECT p.IMS_ID AS ims_id, p.NPI AS npi, p.ALL_DEA AS all_dea, p.LAST_NAME AS last_name, p.FIRST_NAME AS first_name, p.MIDDLE_NAME AS middle_name, at.AFFIL_TYPE_DESC AS affil_type_desc, b.IMS_ORG_ID AS ims_facility_number, b.COT_FACILITY_TYPE AS cot_facility_type, b.BUSINESS_NAME AS business_name, b.PHYSICAL_ADDR_1 AS physical_addr_1, b.PHYSICAL_ADDR_2 AS physical_addr_2, b.PHYSICAL_CITY AS physical_city, b.PHYSICAL_STATE AS physical_state, b.PHYSICAL_ZIP AS physical_zip FROM ((((WSMP_ADMIN.HCOS_BUSINESS b JOIN WSMP_ADMIN.HCOS_PROVIDER_AFFILIATION_FACT paf ON ((b.IMS_ORG_ID = paf.IMS_ORG_ID))) JOIN WSMP_ADMIN.HCOS_PROFESSIONAL p ON ((paf.HCE_ID_PRFSNL = p.HCE_ID_PRFSNL))) LEFT JOIN WSMP_ADMIN.HCOS_AFFILIATION_TYPE at ON ((paf.AFFIL_TYPE_ID = at.AFFIL_TYPE_ID))) JOIN WSMP_ADMIN.HCOS_RELATIONSHIP_FACT rf ON ((b.IMS_ORG_ID = rf.IMS_ORG_ID_CHILD))) WHERE ((rf.IMS_ORG_ID_PARENT = 'INS00000226'::varchar(11)) AND (b.PHYSICAL_STATE = 'CA'::varchar(2)));

CREATE  VIEW WSMP_ADMIN_ORA.v_hcos_kaiser_contact_affil AS
SELECT p.IMS_ID AS ims_id, p.NPI AS npi, p.ALL_DEA AS all_dea, p.LAST_NAME AS last_name, p.FIRST_NAME AS first_name, p.MIDDLE_NAME AS middle_name, pt.TITLE_GROUP_DESC AS title_group_desc, b.IMS_ORG_ID AS ims_facility_number, b.BUSINESS_NAME AS business_name, b.PHYSICAL_ADDR_1 AS physical_addr_1, b.PHYSICAL_ADDR_2 AS physical_addr_2, b.PHYSICAL_CITY AS physical_city, b.PHYSICAL_STATE AS physical_state, b.PHYSICAL_ZIP AS physical_zip FROM ((((WSMP_ADMIN.HCOS_BUSINESS b JOIN WSMP_ADMIN.HCOS_CONTACT_AFFILTN_FACT caf ON ((b.IMS_ORG_ID = caf.IMS_ORG_ID))) JOIN WSMP_ADMIN.HCOS_PROFESSIONAL p ON ((caf.HCE_ID_PRFSNL = p.HCE_ID_PRFSNL))) LEFT JOIN WSMP_ADMIN.HCOS_PROFESSIONAL_TITLE pt ON ((caf.TITLE_GROUP_CODE = pt.TITLE_GROUP_CODE))) JOIN WSMP_ADMIN.HCOS_RELATIONSHIP_FACT rf ON ((b.IMS_ORG_ID = rf.IMS_ORG_ID_CHILD))) WHERE ((rf.IMS_ORG_ID_PARENT = 'INS00000226'::varchar(11)) AND (b.PHYSICAL_STATE = 'CA'::varchar(2)));

CREATE  VIEW WSMP_ADMIN_ORA.v_asi_voucher_redemption AS
SELECT 'asi'::varchar(3) AS provider, ar.RD_KEY AS rd_key, ar.PROGRAM_NUM AS program_num, ar.VOUCHER_NUM AS voucher_num, ar.CEPH_ID AS ceph_id, ar.NDC_CODE AS ndc_code, ar.PRODUCT_NAME AS product_name, ar.FILL_DATE AS fill_date, ar.QTY AS qty, ap.PROGRAM_DESC AS program_desc, ap.SALES_FORCE_ID AS sales_force_id, ap.PROGRAM_TYPE AS program_type, ar.COMP_INCLUDE AS comp_include FROM (WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL ar LEFT JOIN WSMP_ADMIN.DIM_ASI_PROGRAM ap ON ((ap.ASI_PROGRAM_NUM = ar.PROGRAM_NUM))) WHERE (ar.REDEMPTION_TYPE = 'VOUCHER'::varchar(7)) ORDER BY ar.CEPH_ID, ar.FILL_DATE, ar.NDC_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_asi_plan_name AS
SELECT tfc_ims_plan_xref.PAYER_PLAN_NUM AS payer_plan_num, tfc_ims_plan_xref.PLAN_NAME AS plan_name, CASE tfc_ims_plan_xref.PAYER_NUM WHEN NULLSEQUAL '000002'::varchar(6) THEN tfc_ims_plan_xref.PLAN_NAME ELSE tfc_ims_plan_xref.PAYER_NAME END AS payer_name, tfc_ims_plan_xref.MODEL AS model FROM WSMP_ADMIN.TFC_IMS_PLAN_XREF ORDER BY tfc_ims_plan_xref.PAYER_PLAN_NUM;

CREATE  VIEW WSMP_ADMIN_ORA.v_adasuve_sampling AS
SELECT stg_rems_facility.ENROLLMENT_ID AS enrollment_id, stg_rems_facility.SITE_NAME AS site_name, stg_rems_facility.ADDRESS_1 AS address_1, stg_rems_facility.ADDRESS_2 AS address_2, stg_rems_facility.CITY AS city, stg_rems_facility.STATE AS state, stg_rems_facility.ZIP_CODE AS zip_code FROM WSMP_ADMIN.STG_REMS_FACILITY WHERE ((stg_rems_facility.STATUS_DESCRIPTION = 'Enrolled'::varchar(8)) AND (stg_rems_facility.EXPIRATION_DATE > (statement_timestamp())::timestamp));

CREATE  VIEW WSMP_ADMIN_ORA.i_adasuve_rems_facility AS
SELECT stg_rems_facility.VEEVA_ACCOUNT_ID AS veeva_account_id, stg_rems_facility.NPI AS npi, stg_rems_facility.DEA AS dea, stg_rems_facility.ENROLLMENT_ID AS enrollment_id, stg_rems_facility.PROGRAM_NAME AS program_name, stg_rems_facility.HEALTHCARE_FACILITY_TYPE AS healthcare_facility_type, stg_rems_facility.SITE_NAME AS site_name, stg_rems_facility.ADDRESS_1 AS address_1, stg_rems_facility.ADDRESS_2 AS address_2, stg_rems_facility.CITY AS city, stg_rems_facility.STATE AS state, stg_rems_facility.ZIP_CODE AS zip_code, stg_rems_facility.FIRST_NAME AS first_name, stg_rems_facility.MIDDLE_NAME AS middle_name, stg_rems_facility.LAST_NAME AS last_name, stg_rems_facility.STATUS_DESCRIPTION AS status_description, stg_rems_facility.IN_PROGRESS_STEP AS in_progress_step, stg_rems_facility.PHONE_NUMBER AS phone_number, stg_rems_facility.EFFECTIVE_DATE AS effective_date, stg_rems_facility.EXPIRATION_DATE AS expiration_date, stg_rems_facility.LAST_BUILD_DATE AS last_build_date FROM WSMP_ADMIN.STG_REMS_FACILITY;

CREATE  VIEW CUSTOMER_ORA.dim_product_price_mfg AS
SELECT p.PRODUCT_ID AS product_id, pr.FIRST_VALID_DATE AS first_valid_date, pr.LAST_VALID_DATE AS last_valid_date, p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE ((p.CEPHALON_PRODUCT = 'Y'::char(1)) AND (pr.PRICE_TYPE = 'MFGWAC'::varchar(6)));

CREATE  VIEW CUSTOMER_ORA.dim_product_price_comp AS
SELECT p.PRODUCT_ID AS product_id, pr.FIRST_VALID_DATE AS first_valid_date, pr.LAST_VALID_DATE AS last_valid_date, p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE (pr.PRICE_TYPE = 'COMPWAC'::varchar(7));

CREATE  VIEW CUSTOMER_ORA.dim_product_price AS
SELECT p.PRODUCT_CODE AS product_code, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.NAME AS product_name, pr.UNIT_PRICE AS product_price, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, pr.CREATE_DATE AS create_date, pr.CREATE_USER AS create_user, pr.UPDATE_DATE AS update_date, pr.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p JOIN CUSTOMER.PRODUCT_PRICE pr ON ((pr.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.VENDOR_PRODUCT vp ON (((vp.PRODUCT_ID = p.PRODUCT_ID) AND (vp.VENDOR_ID = 2::numeric(18,0))))) WHERE ((p.CEPHALON_PRODUCT = 'Y'::char(1)) AND (pr.PRICE_TYPE = 'COMPWAC'::varchar(7)) AND ((statement_timestamp())::timestamp >= pr.FIRST_VALID_DATE) AND ((statement_timestamp())::timestamp <= pr.LAST_VALID_DATE));

CREATE  VIEW CUSTOMER_ORA.dim_product_ims_ddd AS
SELECT p.PRODUCT_ID AS product_id, (vp.VENDOR_PRODUCT_CODE)::varchar(9) AS ims_product_code, p.PRODUCT_CODE AS product_code, vp.VENDOR_PRODUCT_NAME AS ims_product_name, p.CEPHALON_PRODUCT AS cephalon_product, p.THERAPEUTIC_AREA AS therapeutic_area, p.ACTIVE AS active, vp.SUMMARY_PRODUCT_IND AS summary_product_ind, CASE pp.PRODUCT_ID WHEN NULLSEQUAL NULL::numeric(1,0) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS parent_product_id, CASE pp.PRODUCT_CODE WHEN NULLSEQUAL NULL THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS parent_product, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS brand_id, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.NAME ELSE pp.NAME END AS brand_name, m.MARKET_CODE AS market_code, m.NAME AS market_name FROM ((((CUSTOMER.PRODUCT p JOIN CUSTOMER.VENDOR_PRODUCT vp ON ((vp.PRODUCT_ID = p.PRODUCT_ID))) LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = ANY (ARRAY[1::numeric(18,0), 4::numeric(18,0)])) AND (m.ACTIVE = 'Y'::char(1))))) WHERE ((vp.VENDOR_ID = 2::numeric(18,0)) AND (p.ACTIVE = 'Y'::char(1)));

CREATE  VIEW CUSTOMER_ORA.dim_product_brand AS
SELECT p.PRODUCT_CODE AS brand_code, p.PRODUCT_ID AS brand_id, p.NAME AS brand_name, m.MARKET_CODE AS market_code, p.PROMOTED_PRODUCT AS promoted_product, p.THERAPEUTIC_AREA AS therapeutic_area, p.CREATE_DATE AS create_date, p.CREATE_USER AS create_user, p.UPDATE_DATE AS update_date, p.UPDATE_USER AS update_user FROM ((CUSTOMER.PRODUCT p LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = 1::numeric(18,0))))) WHERE ((p.ACTIVE = 'Y'::char(1)) AND (p.PARENT_PRODUCT_IND = 'Y'::char(1)));

CREATE  VIEW CUSTOMER_ORA.dim_product AS
SELECT p.PRODUCT_ID AS product_id, p.PRODUCT_CODE AS product_code, p.NAME AS product_name, m.MARKET_CODE AS market_code, m.NAME AS market_name, p.ACTIVE AS active, p.CEPHALON_PRODUCT AS ceph_prod_flag, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_ID ELSE pp.PRODUCT_ID END AS brand_id, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.PRODUCT_CODE ELSE pp.PRODUCT_CODE END AS brand_code, CASE WHEN (coalesce(p.PARENT_PRODUCT_IND, 'N'::char(1)) = 'Y'::char(1)) THEN p.NAME ELSE pp.NAME END AS brand_name, p.THERAPEUTIC_AREA AS therapeutic_area, p.CREATE_DATE AS create_date, p.CREATE_USER AS create_user, p.UPDATE_DATE AS update_date, p.UPDATE_USER AS update_user FROM (((CUSTOMER.PRODUCT p LEFT JOIN CUSTOMER.PRODUCT pp ON ((pp.PRODUCT_ID = p.PARENT_PRODUCT_ID))) LEFT JOIN CUSTOMER.MARKET_PRODUCT mp ON (((mp.PRODUCT_ID = p.PRODUCT_ID) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) >= trunc(mp.FIRST_VALID_DATE, 'DD'::varchar(2))) AND (trunc((statement_timestamp())::timestamp, 'DD'::varchar(2)) <= trunc(mp.LAST_VALID_DATE, 'DD'::varchar(2)))))) LEFT JOIN CUSTOMER.MARKET m ON (((m.MARKET_ID = mp.MARKET_ID) AND (m.VENDOR_ID = ANY (ARRAY[1::numeric(18,0), 4::numeric(18,0)])) AND (m.ACTIVE = 'Y'::char(1)))));

CREATE  VIEW WSMP_ADMIN_ORA.i_contact_data AS
SELECT d.ims_id, d.veeva_account_id, CASE WHEN (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END AS nuvigil_dnc_flag, CASE WHEN (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END AS fentora_dnc_flag, CASE WHEN (s.IMS_ID IS NOT NULL) THEN 'Y'::varchar(1) ELSE NULL END AS dnp_flag, r.status AS tirf_rems_flag, r.effective_date AS tirf_rems_effective_date, r.expiration_date AS tirf_rems_expiration_date, seg.PARAGARD_SEGMENT AS paragard_segment FROM ((((((SELECT ims_ids.ims_id, a.ID AS veeva_account_id FROM ((((SELECT tfc_ims_presc_demo_w.ims_id FROM WSMP_ADMIN.tfc_ims_presc_demo_w UNION SELECT dim_dnc.IMS_ID AS ims_id FROM WSMP_ADMIN.DIM_DNC) UNION SELECT debarred.IMS_ID AS ims_id FROM WSMP_ADMIN.DEBARRED WHERE (debarred.CURRENT_IND = 'Y'::varchar(1))) UNION SELECT vv_account.ID_VOD__C AS ims_id FROM WSMP_ADMIN.VV_ACCOUNT WHERE (vv_account.ID_VOD__C IS NOT NULL)) ims_ids LEFT JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((ims_ids.ims_id = a.ID_VOD__C)))) d LEFT JOIN WSMP_ADMIN.DIM_DNC dncn ON (((d.ims_id = dncn.IMS_ID) AND (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7))))) LEFT JOIN WSMP_ADMIN.DIM_DNC dncf ON (((d.ims_id = dncf.IMS_ID) AND (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7))))) LEFT JOIN WSMP_ADMIN.DEBARRED s ON (((d.ims_id = s.IMS_ID) AND (s.CURRENT_IND = 'Y'::varchar(1))))) LEFT JOIN (SELECT r.IMS_ID AS ims_id, CASE WHEN ((r.STATUS = 'Enrolled'::varchar(8)) AND (r.PPAF_COUNT IS NOT NULL)) THEN concat('Enrolled-'::varchar(9), (r.PPAF_COUNT)::varchar) ELSE r.STATUS END AS status, r.EFFECTIVE_DATE AS effective_date, r.EXPIRATION_DATE AS expiration_date FROM WSMP_ADMIN.STG_REMS_PRESCRIBER r GROUP BY r.IMS_ID, CASE WHEN ((r.STATUS = 'Enrolled'::varchar(8)) AND (r.PPAF_COUNT IS NOT NULL)) THEN concat('Enrolled-'::varchar(9), (r.PPAF_COUNT)::varchar) ELSE r.STATUS END, r.EFFECTIVE_DATE, r.EXPIRATION_DATE) r ON ((d.ims_id = r.ims_id))) LEFT JOIN WSMP_ADMIN.STG_TW_PARAGARD_SEGMENT seg ON ((d.ims_id = seg.IMS_ID))) GROUP BY d.ims_id, d.veeva_account_id, CASE WHEN (dncn.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END, CASE WHEN (dncf.PRODUCT_NAME = 'FENTORA'::varchar(7)) THEN 'Y'::varchar(1) ELSE NULL END, CASE WHEN (s.IMS_ID IS NOT NULL) THEN 'Y'::varchar(1) ELSE NULL END, r.status, r.effective_date, r.expiration_date, seg.PARAGARD_SEGMENT;

CREATE  VIEW WSMP_ADMIN_ORA.roster_office_toolkit AS
(((((((((((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS username, dim_csf_sales_roster_teva.SALES_FORCE_ID AS sales_force_id FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (length(dim_csf_sales_roster_teva.TERRITORY_NUM) = 8)) UNION SELECT 'afoote'::varchar(6), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'sbischof'::varchar(8), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'phazel'::varchar(6), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'gfowler'::varchar(7), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mtarrant'::varchar(8), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'jpage'::varchar(5), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mday'::varchar(4), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'kreedy'::varchar(6), 'TC'::varchar(2) FROM v_catalog.dual) UNION SELECT 'trainey'::varchar(7), 'TO'::varchar(2) FROM v_catalog.dual) UNION SELECT 'mkartman'::varchar(8), 'TO'::varchar(2) FROM v_catalog.dual) UNION SELECT 'dmack01'::varchar(7), 'TN'::varchar(2) FROM v_catalog.dual) UNION SELECT 'rkim'::varchar(4), 'TN'::varchar(2) FROM v_catalog.dual;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_dmd_product AS
SELECT lpad(dim_product_ims_ddd.ims_product_code, 8, '0'::varchar(1)) AS ims_product_code, 'GCSF'::varchar(4) AS market_name, dim_product_ims_ddd.brand_name, dim_product_ims_ddd.ims_product_name AS product_name FROM CUSTOMER.dim_product_ims_ddd WHERE ((dim_product_ims_ddd.brand_name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)])) AND (dim_product_ims_ddd.market_name = 'ONCOLOGY'::varchar(8)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Fentora_Product_Totals AS
SELECT rx.PRODUCT_CODE AS product_code, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 24::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 23::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 22::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 21::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 20::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 19::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 18::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 17::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 16::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 15::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 14::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 13::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 12::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 11::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 10::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 9::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 8::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 7::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 6::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 5::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 4::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 3::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 2::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.TRX_CNT ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.MONTH_BUCKET WHEN 1::numeric(18,0) THEN rx.NRX_CNT ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.DW_PRESC_PLAN_RX_M rx, CUSTOMER.dim_product p WHERE ((rx.PRODUCT_CODE = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) AND (rx.MONTH_BUCKET >= 1::numeric(18,0)) AND (rx.MONTH_BUCKET <= 24::numeric(18,0)) AND (rx.PRODUCT_CODE = p.product_code)) GROUP BY rx.PRODUCT_CODE;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_tr_launch_analytics_rx AS
SELECT rx.ims_id, px.MODEL AS model, mpm.PAYMENT_METHOD AS method_of_payment, rx.payer_plan_num, p.product_name, rx.product_code, to_char(rx.month_ending, ' YYYY-MM-DD'::varchar(11)) AS month_ending, rx.month_bucket, to_char(rx.week_ending, ' YYYY-MM-DD'::varchar(11)) AS week_ending, rx.week_bucket, rx.nrx_cnt, rx.trx_cnt, rx.sales_category FROM (((WSMP_ADMIN.dw_presc_plan_rx_w rx JOIN CUSTOMER.dim_product p ON ((rx.product_code = p.product_code))) LEFT JOIN WSMP_ADMIN.TFC_IMS_PLAN_XREF px ON ((rx.payer_plan_num = px.PAYER_PLAN_NUM))) LEFT JOIN WSMP_ADMIN.DIM_IMS_MODEL_PAYMENT_METHOD mpm ON ((px.MODEL = mpm.MODEL))) WHERE ((rx.product_code ~~ '330-14%'::varchar(7)) AND (rx.product_code NOT IN (SELECT drm45_rollup.ROLLUP_WK_PRODUCT_CODE AS rollup_wk_product_code FROM WSMP_ADMIN.DRM45_ROLLUP GROUP BY drm45_rollup.ROLLUP_WK_PRODUCT_CODE)) AND (rx.week_bucket >= 1::numeric(18,0)) AND (rx.week_bucket <= 52::numeric(18,0)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Nuvigil_Monthly_Rx AS
SELECT x.IMS_ID AS ims_id, x.PRODUCT_CODE AS product_code, p.product_name, x.MONTH_ENDING AS month_ending, sum(x.NRX_QTY) AS nrx_qty, sum(x.TRX_QTY) AS trx_qty, sum(x.UNNORMALIZED_NRX_CNT) AS nrx_cnt, sum(x.UNNORMALIZED_TRX_CNT) AS trx_cnt FROM WSMP_ADMIN.DW_PRESC_RX_M x, CUSTOMER.dim_product p WHERE ((x.MONTH_BUCKET >= 1::numeric(18,0)) AND (x.MONTH_BUCKET <= 24::numeric(18,0)) AND (x.PRODUCT_CODE = ANY (ARRAY['100N05'::varchar(6), '100N15'::varchar(6), '100N25'::varchar(6), '100101'::varchar(6), '100102'::varchar(6), '100120'::varchar(6)])) AND (x.PRODUCT_CODE = p.product_code)) GROUP BY x.IMS_ID, x.PRODUCT_CODE, p.product_name, x.MONTH_ENDING ORDER BY x.IMS_ID, x.PRODUCT_CODE, p.product_name, x.MONTH_ENDING;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_gcsf_dmd AS
SELECT coalesce(z.TO_TERRITORY_NUM_1, 'TOHZHZ99'::varchar(8)) AS TERRITORY_NUM, s.IMS_OUTLET_CODE, s.SUBCATEGORY_CODE, s.CATEGORY_CODE, s.IMS_PRODUCT_CODE, p.product_code AS PRODUCT_CODE, to_char(s.DATA_DATE, 'YYYYMM'::varchar(6)) AS MTH_YYYYMM, s.DOL_MTH01, s.DOL_MTH02, s.DOL_MTH03, s.DOL_MTH04, s.DOL_MTH05, s.DOL_MTH06, s.DOL_MTH07, s.DOL_MTH08, s.DOL_MTH09, s.DOL_MTH10, s.DOL_MTH11, s.DOL_MTH12, s.DOL_MTH13, s.DOL_MTH14, s.DOL_MTH15, s.DOL_MTH16, s.DOL_MTH17, s.DOL_MTH18, s.DOL_MTH19, s.DOL_MTH20, s.DOL_MTH21, s.DOL_MTH22, s.DOL_MTH23, s.DOL_MTH24, s.OUTLET_NAME, s.OUTLET_ADDRESS, s.OUTLET_CITY, s.OUTLET_STATE, s.OUTLET_ZIP FROM ((WSMP_ADMIN.STG_ONC_DMD_MONTHLY_DOLLARS s JOIN CUSTOMER.dim_product_ims_ddd p ON ((s.IMS_PRODUCT_CODE = p.ims_product_code))) LEFT JOIN WSMP_ADMIN.TFC_CURRENT_ZIP_ALIGNMENT z ON ((s.OUTLET_ZIP = z.ZIP))) WHERE (p.brand_name = ANY (ARRAY['NEUPOGEN'::varchar(8), 'GRANIX'::varchar(6), 'LEUKINE'::varchar(7)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_demo AS
SELECT c.ROW_ID AS csf_demo_id, p.X_SALES_FORCE AS sales_force_id, 'PROF'::varchar(4) AS demo_type, x.ATTRIB_03 AS ims_id, x.X_ATTRIB_50 AS hms_id, substr(btrim(x.ATTRIB_36), 1, 10) AS me_num, ca.DEA_NUM AS dea_num, ca.DEA_EXPR_DT AS dea_expir_date, substr(ca.X_ATTRIB_03, 1, 12) AS dea_drug_schedule, p.NAME AS territory_num, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, c.LAST_NAME AS last_name, c.FST_NAME AS first_name, c.MID_NAME AS middle_name, c.PER_TITLE_SUFFIX AS suffix_name, fnx.CRRPT_FMT_CD AS degree, substr(btrim(ap.ADDR), 1, 75) AS address1, substr(btrim(ap.ADDR_LINE_2), 1, 75) AS address2, substr(btrim(ap.ADDR_LINE_3), 1, 75) AS address3, ap.CITY AS city, ap.STATE AS state, ap.ZIPCODE AS zip, c.WORK_PH_NUM AS phone, c.FAX_PH_NUM AS fax, c.CELL_PH_NUM AS mobile, c.EMAIL_ADDR AS email, ms.NAME AS prim_specialty, substr(btrim(l.LICENSE_NUM), 1, 20) AS state_license_number, l.STATE_CD AS state_license_state, CASE WHEN (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1)) THEN 'E'::varchar(1) ELSE 'I'::varchar(1) END AS state_license_elig_code, l.LICENSE_EXP_DT AS state_license_expir_date, substr(btrim(CASE WHEN ((btrim(fnx.CRRPT_FMT_CD) IS NOT NULL) AND (btrim(l.STATE_CD) IS NOT NULL) AND (btrim(l.LICENSE_NUM) IS NOT NULL)) THEN ((((btrim(fnx.CRRPT_FMT_CD) || '-'::varchar(1)) || btrim(l.STATE_CD)) || '-'::varchar(1)) || btrim(l.LICENSE_NUM)) ELSE NULL END), 1, 30) AS state_num, l.X_VALIDATION_DT AS sln_validation_date, CASE WHEN ((l.X_VALIDATION_DT IS NOT NULL) AND (l.X_OK_TO_SAMPLE_FLG = 'Y'::char(1))) THEN 'MedPro'::varchar(6) ELSE NULL END AS sln_validation_source, x.ATTRIB_09 AS no_spend, pc.X_ATTRIB_11 AS treats_es, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_58 ELSE NULL END AS nuvigil_dnc, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN x.X_ATTRIB_83 ELSE NULL::"char" END AS nuvigil_rems_pb, CASE WHEN (p.X_SALES_FORCE = 'TC'::varchar(2)) THEN substr(x.X_ATTRIB_73, 1, 1) ELSE NULL END AS nuvigil_app, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_72 ELSE NULL END AS fentora_dnc, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.X_ATTRIB_71 ELSE NULL::"char" END AS fentora_app, CASE WHEN (p.X_SALES_FORCE = 'TP'::varchar(2)) THEN x.ATTRIB_42 ELSE NULL END AS fentora_rems_status, pc.LAST_CALL_DT AS sfa_last_call_date, coalesce(cm2.CM_ID, cm1.CM_ID) AS cm_id, c.ROW_ID AS siebel_contact_row_id, ap.ROW_ID AS siebel_addr_per_row_id, 'Y'::varchar(1) AS ora_viewable_flag, c.CREATED AS sfa_create_date, (statement_timestamp())::timestamp AS last_build_date, NULL AS ceph_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, pc.STATUS AS territory_status FROM (((((((((((WSMP_ADMIN.S_CONTACT c JOIN WSMP_ADMIN.S_POSTN_CON pc ON ((pc.CON_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN p ON ((pc.POSTN_ID = p.ROW_ID))) JOIN WSMP_ADMIN.S_ORG_EXT o ON ((p.BU_ID = o.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X x ON ((x.ROW_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_FNX fnx ON ((fnx.ROW_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_ADDR_PER ap ON ((ap.ROW_ID = pc.PR_ADDR_ID))) LEFT JOIN WSMP_ADMIN.S_MED_SPEC ms ON ((ms.ROW_ID = c.MED_SPEC_ID))) LEFT JOIN (SELECT iq.ROW_ID, iq.CREATED, iq.CREATED_BY, iq.LAST_UPD, iq.LAST_UPD_BY, iq.MODIFICATION_NUM, iq.CONFLICT_ID, iq.ACTIVE_FLG, iq.ADDR_PER_ID, iq.BL_ADDR_FLG, iq.FRAUD_FLG, iq.MAIN_ADDR_FLG, iq.RELATION_TYPE_CD, iq.SHIP_ADDR_FLG, iq.DEA_EXPR_DT, iq.END_DT, iq.FRI_1ST_CLOSE_TM, iq.FRI_1ST_OPEN_TM, iq.FRI_2ND_CLOSE_TM, iq.FRI_2ND_OPEN_TM, iq.MON_1ST_CLOSE_TM, iq.MON_1ST_OPEN_TM, iq.MON_2ND_CLOSE_TM, iq.MON_2ND_OPEN_TM, iq.NUM_MONTHS_AT_ADDR, iq.SAT_1ST_CLOSE_TM, iq.SAT_1ST_OPEN_TM, iq.SAT_2ND_CLOSE_TM, iq.SAT_2ND_OPEN_TM, iq.START_DT, iq.SUN_1ST_CLOSE_TM, iq.SUN_1ST_OPEN_TM, iq.SUN_2ND_CLOSE_TM, iq.SUN_2ND_OPEN_TM, iq.THU_1ST_CLOSE_TM, iq.THU_1ST_OPEN_TM, iq.THU_2ND_CLOSE_TM, iq.THU_2ND_OPEN_TM, iq.TUE_1ST_CLOSE_TM, iq.TUE_1ST_OPEN_TM, iq.TUE_2ND_CLOSE_TM, iq.TUE_2ND_OPEN_TM, iq.WED_1ST_CLOSE_TM, iq.WED_1ST_OPEN_TM, iq.WED_2ND_CLOSE_TM, iq.WED_2ND_OPEN_TM, iq.ACCNT_ID, iq.ADDR_MAIL_CD, iq.ADDR_TYPE_CD, iq.BRICK_ID, iq.BU_ID, iq.CONTACT_ID, iq.DEA_NUM, iq.DFLT_SHIP_PRIO_CD, iq.EMAIL_ADDR, iq.FAX_PH_NUM, iq.MAIL_TYPE_CD, iq.OCCUPANCY_CD, iq.ORG_GROUP_ID, iq.PH_NUM, iq.TRNSPRT_ZONE_CD, iq.X_ATTRIB_01, iq.X_ATTRIB_02, iq.X_ATTRIB_03, iq.X_ATTRIB_04, iq.X_ATTRIB_05, iq.X_ATTRIB_06, iq.X_ATTRIB_07, iq.X_OK_TO_SAMPLE, iq.ADDRESSEE, iq.ALIGNMENT_FLG, iq.DB_LAST_UPD, iq.DB_LAST_UPD_SRC, iq.YEARLY_END_DT, iq.YEARLY_START_DT, iq.X_SRC_LAST_UPD, iq.rnk FROM (SELECT sca.ROW_ID, sca.CREATED, sca.CREATED_BY, sca.LAST_UPD, sca.LAST_UPD_BY, sca.MODIFICATION_NUM, sca.CONFLICT_ID, sca.ACTIVE_FLG, sca.ADDR_PER_ID, sca.BL_ADDR_FLG, sca.FRAUD_FLG, sca.MAIN_ADDR_FLG, sca.RELATION_TYPE_CD, sca.SHIP_ADDR_FLG, sca.DEA_EXPR_DT, sca.END_DT, sca.FRI_1ST_CLOSE_TM, sca.FRI_1ST_OPEN_TM, sca.FRI_2ND_CLOSE_TM, sca.FRI_2ND_OPEN_TM, sca.MON_1ST_CLOSE_TM, sca.MON_1ST_OPEN_TM, sca.MON_2ND_CLOSE_TM, sca.MON_2ND_OPEN_TM, sca.NUM_MONTHS_AT_ADDR, sca.SAT_1ST_CLOSE_TM, sca.SAT_1ST_OPEN_TM, sca.SAT_2ND_CLOSE_TM, sca.SAT_2ND_OPEN_TM, sca.START_DT, sca.SUN_1ST_CLOSE_TM, sca.SUN_1ST_OPEN_TM, sca.SUN_2ND_CLOSE_TM, sca.SUN_2ND_OPEN_TM, sca.THU_1ST_CLOSE_TM, sca.THU_1ST_OPEN_TM, sca.THU_2ND_CLOSE_TM, sca.THU_2ND_OPEN_TM, sca.TUE_1ST_CLOSE_TM, sca.TUE_1ST_OPEN_TM, sca.TUE_2ND_CLOSE_TM, sca.TUE_2ND_OPEN_TM, sca.WED_1ST_CLOSE_TM, sca.WED_1ST_OPEN_TM, sca.WED_2ND_CLOSE_TM, sca.WED_2ND_OPEN_TM, sca.ACCNT_ID, sca.ADDR_MAIL_CD, sca.ADDR_TYPE_CD, sca.BRICK_ID, sca.BU_ID, sca.CONTACT_ID, sca.DEA_NUM, sca.DFLT_SHIP_PRIO_CD, sca.EMAIL_ADDR, sca.FAX_PH_NUM, sca.MAIL_TYPE_CD, sca.OCCUPANCY_CD, sca.ORG_GROUP_ID, sca.PH_NUM, sca.TRNSPRT_ZONE_CD, sca.X_ATTRIB_01, sca.X_ATTRIB_02, sca.X_ATTRIB_03, sca.X_ATTRIB_04, sca.X_ATTRIB_05, sca.X_ATTRIB_06, sca.X_ATTRIB_07, sca.X_OK_TO_SAMPLE, sca.ADDRESSEE, sca.ALIGNMENT_FLG, sca.DB_LAST_UPD, sca.DB_LAST_UPD_SRC, sca.YEARLY_END_DT, sca.YEARLY_START_DT, sca.X_SRC_LAST_UPD, row_number() OVER (PARTITION BY sca.CONTACT_ID, sca.ADDR_PER_ID ORDER BY sca.LAST_UPD DESC, sca.CREATED DESC) AS rnk FROM WSMP_ADMIN.S_CON_ADDR sca) iq WHERE (iq.rnk = 1)) ca ON (((ca.ADDR_PER_ID = pc.PR_ADDR_ID) AND (ca.CONTACT_ID = pc.CON_ID)))) LEFT JOIN WSMP_ADMIN.S_STATE_LIC_LS l ON (((l.ROW_ID = ca.X_ATTRIB_02) AND (l.CONTACT_ID = ca.CONTACT_ID) AND (l.STATUS_CD <> 'Invalid'::varchar(7))))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF cm1 ON (((c.ROW_ID = cm1.ID_NUM) AND (cm1.ID_TYPE = 'SIEBEL_ID'::varchar(9))))) LEFT JOIN WSMP_ADMIN.STG_CM_ID_XREF cm2 ON (((x.ATTRIB_03 = cm2.ID_NUM) AND (cm2.ID_TYPE = 'IMS_ID'::varchar(6))))) WHERE ((p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)])) AND (p.NAME !~~ '%SiebelAdministrator%'::varchar(21)) AND (p.NAME <> 'Align_2007'::varchar(10)) AND (NOT ((x.ATTRIB_03 IS NULL) AND (c.DEGREE = ANY (ARRAY['Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)])))));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_calls AS
SELECT rep_p.X_SALES_FORCE AS sales_force_id, ea.PAR_EVT_ID AS par_evt_id, ea.ROW_ID AS csf_call_id, ea.TARGET_PER_ID AS csf_demo_id, 'PROF'::varchar(4) AS legacy_call_type, ea.NAME AS name_on_call, ea.ZIPCODE AS zip_on_call, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, ea.INTEGRATION_ID AS integration_id, ea.ROW_ID AS siebel_evt_act_row_id, ea.TARGET_PER_ID AS siebel_target_per_id, d.ims_id, d.cm_id, d.me_num, ca.DEA_NUM AS dea_num, emp.CSN AS rep_id, rep_p.NAME AS territory_num, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, details.first_detailed_product, details.second_detailed_product, details.third_detailed_product, details.fourth_detailed_product, details.fifth_detailed_product, details.sixth_detailed_product, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id FROM (((((((WSMP_ADMIN.S_EVT_ACT ea JOIN WSMP_ADMIN.S_CONTACT c ON ((c.ROW_ID = ea.TARGET_PER_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X x ON ((x.ROW_ID = c.ROW_ID))) JOIN WSMP_ADMIN.S_POSTN rep_p ON ((rep_p.ROW_ID = ea.OWNER_POSTN_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT v_siebel_demo.ims_id, v_siebel_demo.cm_id, v_siebel_demo.me_num, v_siebel_demo.siebel_contact_row_id, row_number() OVER (PARTITION BY v_siebel_demo.siebel_contact_row_id ORDER BY v_siebel_demo.veeva_account_id, v_siebel_demo.sales_force_id) AS rnk FROM WSMP_ADMIN.v_siebel_demo) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) LEFT JOIN (SELECT iq2.ROW_ID, iq2.CREATED, iq2.CREATED_BY, iq2.LAST_UPD, iq2.LAST_UPD_BY, iq2.MODIFICATION_NUM, iq2.CONFLICT_ID, iq2.ACTIVE_FLG, iq2.ADDR_PER_ID, iq2.BL_ADDR_FLG, iq2.FRAUD_FLG, iq2.MAIN_ADDR_FLG, iq2.RELATION_TYPE_CD, iq2.SHIP_ADDR_FLG, iq2.DEA_EXPR_DT, iq2.END_DT, iq2.FRI_1ST_CLOSE_TM, iq2.FRI_1ST_OPEN_TM, iq2.FRI_2ND_CLOSE_TM, iq2.FRI_2ND_OPEN_TM, iq2.MON_1ST_CLOSE_TM, iq2.MON_1ST_OPEN_TM, iq2.MON_2ND_CLOSE_TM, iq2.MON_2ND_OPEN_TM, iq2.NUM_MONTHS_AT_ADDR, iq2.SAT_1ST_CLOSE_TM, iq2.SAT_1ST_OPEN_TM, iq2.SAT_2ND_CLOSE_TM, iq2.SAT_2ND_OPEN_TM, iq2.START_DT, iq2.SUN_1ST_CLOSE_TM, iq2.SUN_1ST_OPEN_TM, iq2.SUN_2ND_CLOSE_TM, iq2.SUN_2ND_OPEN_TM, iq2.THU_1ST_CLOSE_TM, iq2.THU_1ST_OPEN_TM, iq2.THU_2ND_CLOSE_TM, iq2.THU_2ND_OPEN_TM, iq2.TUE_1ST_CLOSE_TM, iq2.TUE_1ST_OPEN_TM, iq2.TUE_2ND_CLOSE_TM, iq2.TUE_2ND_OPEN_TM, iq2.WED_1ST_CLOSE_TM, iq2.WED_1ST_OPEN_TM, iq2.WED_2ND_CLOSE_TM, iq2.WED_2ND_OPEN_TM, iq2.ACCNT_ID, iq2.ADDR_MAIL_CD, iq2.ADDR_TYPE_CD, iq2.BRICK_ID, iq2.BU_ID, iq2.CONTACT_ID, iq2.DEA_NUM, iq2.DFLT_SHIP_PRIO_CD, iq2.EMAIL_ADDR, iq2.FAX_PH_NUM, iq2.MAIL_TYPE_CD, iq2.OCCUPANCY_CD, iq2.ORG_GROUP_ID, iq2.PH_NUM, iq2.TRNSPRT_ZONE_CD, iq2.X_ATTRIB_01, iq2.X_ATTRIB_02, iq2.X_ATTRIB_03, iq2.X_ATTRIB_04, iq2.X_ATTRIB_05, iq2.X_ATTRIB_06, iq2.X_ATTRIB_07, iq2.X_OK_TO_SAMPLE, iq2.ADDRESSEE, iq2.ALIGNMENT_FLG, iq2.DB_LAST_UPD, iq2.DB_LAST_UPD_SRC, iq2.YEARLY_END_DT, iq2.YEARLY_START_DT, iq2.X_SRC_LAST_UPD, iq2.rnk FROM (SELECT ca.ROW_ID, ca.CREATED, ca.CREATED_BY, ca.LAST_UPD, ca.LAST_UPD_BY, ca.MODIFICATION_NUM, ca.CONFLICT_ID, ca.ACTIVE_FLG, ca.ADDR_PER_ID, ca.BL_ADDR_FLG, ca.FRAUD_FLG, ca.MAIN_ADDR_FLG, ca.RELATION_TYPE_CD, ca.SHIP_ADDR_FLG, ca.DEA_EXPR_DT, ca.END_DT, ca.FRI_1ST_CLOSE_TM, ca.FRI_1ST_OPEN_TM, ca.FRI_2ND_CLOSE_TM, ca.FRI_2ND_OPEN_TM, ca.MON_1ST_CLOSE_TM, ca.MON_1ST_OPEN_TM, ca.MON_2ND_CLOSE_TM, ca.MON_2ND_OPEN_TM, ca.NUM_MONTHS_AT_ADDR, ca.SAT_1ST_CLOSE_TM, ca.SAT_1ST_OPEN_TM, ca.SAT_2ND_CLOSE_TM, ca.SAT_2ND_OPEN_TM, ca.START_DT, ca.SUN_1ST_CLOSE_TM, ca.SUN_1ST_OPEN_TM, ca.SUN_2ND_CLOSE_TM, ca.SUN_2ND_OPEN_TM, ca.THU_1ST_CLOSE_TM, ca.THU_1ST_OPEN_TM, ca.THU_2ND_CLOSE_TM, ca.THU_2ND_OPEN_TM, ca.TUE_1ST_CLOSE_TM, ca.TUE_1ST_OPEN_TM, ca.TUE_2ND_CLOSE_TM, ca.TUE_2ND_OPEN_TM, ca.WED_1ST_CLOSE_TM, ca.WED_1ST_OPEN_TM, ca.WED_2ND_CLOSE_TM, ca.WED_2ND_OPEN_TM, ca.ACCNT_ID, ca.ADDR_MAIL_CD, ca.ADDR_TYPE_CD, ca.BRICK_ID, ca.BU_ID, ca.CONTACT_ID, ca.DEA_NUM, ca.DFLT_SHIP_PRIO_CD, ca.EMAIL_ADDR, ca.FAX_PH_NUM, ca.MAIL_TYPE_CD, ca.OCCUPANCY_CD, ca.ORG_GROUP_ID, ca.PH_NUM, ca.TRNSPRT_ZONE_CD, ca.X_ATTRIB_01, ca.X_ATTRIB_02, ca.X_ATTRIB_03, ca.X_ATTRIB_04, ca.X_ATTRIB_05, ca.X_ATTRIB_06, ca.X_ATTRIB_07, ca.X_OK_TO_SAMPLE, ca.ADDRESSEE, ca.ALIGNMENT_FLG, ca.DB_LAST_UPD, ca.DB_LAST_UPD_SRC, ca.YEARLY_END_DT, ca.YEARLY_START_DT, ca.X_SRC_LAST_UPD, row_number() OVER (PARTITION BY ca.CONTACT_ID, ca.ADDR_PER_ID ORDER BY ca.LAST_UPD DESC, ca.CREATED DESC) AS rnk FROM WSMP_ADMIN.S_CON_ADDR ca) iq2 WHERE (iq2.rnk = 1)) ca ON (((ca.ADDR_PER_ID = ea.TARGET_PER_ADDR_ID) AND (ca.CONTACT_ID = ea.TARGET_PER_ID)))) LEFT JOIN (SELECT d.activity_id, max(CASE WHEN (d.priority = 1) THEN d.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (d.priority = 2) THEN d.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (d.priority = 3) THEN d.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (d.priority = 4) THEN d.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (d.priority = 5) THEN d.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (d.priority = 6) THEN d.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT appl.ACTIVITY_ID AS activity_id, upper(spi.NAME) AS product_name, row_number() OVER (PARTITION BY appl.ACTIVITY_ID ORDER BY appl.PRIORITY_NUM, upper(spi.NAME)) AS priority FROM (WSMP_ADMIN.S_ACT_PROD_APPL appl LEFT JOIN WSMP_ADMIN.S_PROD_INT spi ON ((appl.PRDINT_ID = spi.ROW_ID))) WHERE (appl.CONFLICT_ID = '0'::varchar(1))) d GROUP BY d.activity_id) details ON ((details.activity_id = ea.PAR_EVT_ID))) WHERE ((ea.EVT_STAT_CD = 'Submitted'::varchar(9)) AND (rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (((ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TB'::varchar(2), 'TN'::varchar(2), 'TR'::varchar(2), 'TW'::varchar(2)]))) OR ((ea.APPT_START_DT >= '2012-03-01 00:00:00'::timestamp) AND (rep_p.X_SALES_FORCE = ANY (ARRAY['TC'::varchar(2), 'TP'::varchar(2)])))) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp) AND (ea.SUBTYPE_CD = ANY (ARRAY['Contact Call'::varchar(12), 'Attendee Call'::varchar(13)])) AND ((ea.TODO_CD ~~ '%Detail%'::varchar(8)) OR (ea.TODO_CD ~~ '%Call%'::varchar(6))));

CREATE  VIEW WSMP_ADMIN_ORA.v_siebel_bp_affiliations AS
SELECT oex.ROW_ID AS siebel_account_row_id, oex.X_ATTRIB_109 AS bp_code, c.ROW_ID AS siebel_contact_row_id, cx.ATTRIB_03 AS ims_id FROM (((WSMP_ADMIN.S_ORG_EXT_X oex JOIN WSMP_ADMIN.S_PARTY_PER pp ON ((oex.ROW_ID = pp.PARTY_ID))) JOIN WSMP_ADMIN.S_CONTACT c ON ((pp.PERSON_ID = c.ROW_ID))) LEFT JOIN WSMP_ADMIN.S_CONTACT_X cx ON ((cx.ROW_ID = c.ROW_ID))) WHERE (oex.X_ATTRIB_109 IS NOT NULL);

CREATE  VIEW WSMP_ADMIN_ORA.v_ims_npi AS
SELECT x1.ID_NUM AS ims_id, x2.ID_NUM AS npi FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID))) WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'NPI'::varchar(3))) UNION SELECT hcos_professional.IMS_ID AS ims_id, hcos_professional.NPI AS npi FROM WSMP_ADMIN.HCOS_PROFESSIONAL;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_mm_ram_to_rsm_test AS
SELECT x.MM_RAM, x.RSM FROM (SELECT a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2)) AS RSM FROM (teva_ingestion.EXT_MM_RAM_TO_STATE a JOIN WSMP_ADMIN.KC_ZIP_TO_TERRITORY b ON ((a.STATE = b.STATE))) WHERE ((substr(b.TERRITORY_NUM, 5, 2) <> 'ZZ'::varchar(2)) AND (b.TERRITORY_NAME IS NOT NULL)) GROUP BY a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2))) x ORDER BY x.MM_RAM, x.RSM LIMIT 1000000;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_calls AS
SELECT c.ID AS call_id, trunc((c.LOCAL_CALL_DATETIME_VOD__C)::timestamp, 'DD'::varchar(2)) AS call_date, h.submit_date, c.LOCAL_CALL_DATETIME_VOD__C AS call_datetime, a.ID AS csf_demo_id, substr(c.TERRITORY_VOD__C, 1, 2) AS sales_force_id, c.TERRITORY_VOD__C AS territory_num, c.CALL_TYPE_VOD__C AS call_type_vod__c, c.ACCOUNT_VOD__C AS demo_id, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (a.ID_VOD__C IS NULL) AND (a.CREDENTIALS_VOD__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS legacy_call_type, substr(c.ENTITY_DISPLAY_NAME_VOD__C, 1, 150) AS name_on_call, c.ZIP_VOD__C AS zip_on_call, a.ID_VOD__C AS ims_id, a.ACCOUNT_MASTER_ID_TVA__C AS hms_id, a.NPI_VOD__C AS npi, a.CREDENTIALS_VOD__C AS degree, a.ID AS veeva_account_id, substr(btrim(a.ME__C), 1, 10) AS me_num, c.DEA_VOD__C AS dea_num, CASE WHEN (NOT regexp_like(a.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar)) THEN a.EXTERNAL_ID_VOD__C ELSE NULL END AS siebel_target_per_id, CASE WHEN regexp_like(a.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar) THEN a.EXTERNAL_ID_VOD__C ELSE NULL END AS bp_code, c.OWNERID AS ownerid, u.EMPLOYEENUMBER AS employeenumber, c.PARENT_CALL_VOD__C AS parent_call_vod__c, CASE WHEN (rtc.NAME = 'Account Management'::varchar(18)) THEN upper(rtc.NAME) ELSE d.first_detailed_product END AS first_detailed_product, d.second_detailed_product, d.third_detailed_product, d.fourth_detailed_product, d.fifth_detailed_product, d.sixth_detailed_product, c.CREATEDBYID AS created_by, c.CREATEDDATE AS created_date, coalesce(c.ATTENDEES_VOD__C, 0::numeric(18,0)) AS attendees, CASE WHEN (c.ATTENDEE_TYPE_VOD__C = 'Group_Account_vod'::varchar(17)) THEN 'Group'::varchar(5) WHEN (c.ATTENDEE_TYPE_VOD__C = 'Person_Account_vod'::varchar(18)) THEN 'Person'::varchar(6) ELSE c.ATTENDEE_TYPE_VOD__C END AS attendee_type FROM ((((((WSMP_ADMIN.VV_CALL2_VOD__C c JOIN WSMP_ADMIN.VV_ACCOUNT a ON ((c.ACCOUNT_VOD__C = a.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rtc ON ((c.RECORDTYPEID = rtc.ID))) JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((a.RECORDTYPEID = rta.ID))) LEFT JOIN (SELECT VV_CALL2_VOD__HISTORY.PARENTID AS parentid, trunc(max(VV_CALL2_VOD__HISTORY.CREATEDDATE), 'DD'::varchar(2)) AS submit_date FROM WSMP_ADMIN.VV_CALL2_VOD__HISTORY WHERE (VV_CALL2_VOD__HISTORY.NEWVALUE = 'Submitted_vod'::varchar(13)) GROUP BY VV_CALL2_VOD__HISTORY.PARENTID) h ON ((c.ID = h.parentid))) LEFT JOIN WSMP_ADMIN.VV_USER u ON ((c.OWNERID = u.ID))) LEFT JOIN (SELECT d.call2_vod__c, max(CASE WHEN (d.priority = 1) THEN d.product_name ELSE NULL END) AS first_detailed_product, max(CASE WHEN (d.priority = 2) THEN d.product_name ELSE NULL END) AS second_detailed_product, max(CASE WHEN (d.priority = 3) THEN d.product_name ELSE NULL END) AS third_detailed_product, max(CASE WHEN (d.priority = 4) THEN d.product_name ELSE NULL END) AS fourth_detailed_product, max(CASE WHEN (d.priority = 5) THEN d.product_name ELSE NULL END) AS fifth_detailed_product, max(CASE WHEN (d.priority = 6) THEN d.product_name ELSE NULL END) AS sixth_detailed_product FROM (SELECT d.CALL2_VOD__C AS call2_vod__c, row_number() OVER (PARTITION BY d.CALL2_VOD__C ORDER BY d.DETAIL_PRIORITY_VOD__C, p.NAME) AS priority, upper(p.NAME) AS product_name FROM (WSMP_ADMIN.VV_CALL2_DETAIL_VOD__C d JOIN WSMP_ADMIN.VV_PRODUCT_VOD__C p ON ((d.PRODUCT_VOD__C = p.ID)))) d GROUP BY d.call2_vod__c) d ON ((d.call2_vod__c = c.ID))) WHERE ((c.STATUS_VOD__C = 'Submitted_vod'::varchar(13)) AND (c.CALL_DATE_VOD__C < trunc((statement_timestamp())::timestamp, 'DD'::varchar(2))) AND (c.CALL_TYPE_VOD__C <> 'Sample Only'::varchar(11)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_mkt_access_obw_wake AS
SELECT mpzd.ZIP AS zip, mpzd.STATE AS state, rx.plan_id AS payer_plan_num, to_char(rx.ims_report_num, '00'::varchar(2)) AS report_num, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) AS data_month, sum((((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_001, sum((((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_002, sum((((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_003, sum((((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_004, sum((((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_005, sum((((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_006, sum((((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_007, sum((((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_008, sum((((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_009, sum((((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_010, sum((((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_011, sum((((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_012, sum((((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_013, sum((((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_014, sum((((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_015, sum((((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_016, sum((((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_017, sum((((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_018, sum((((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_019, sum((((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_020, sum((((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_021, sum((((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_022, sum((((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_023, sum((((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS nrx_024, sum((((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_001, sum((((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_002, sum((((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_003, sum((((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_004, sum((((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_005, sum((((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_006, sum((((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_007, sum((((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_008, sum((((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_009, sum((((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_010, sum((((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_011, sum((((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_012, sum((((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_013, sum((((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_014, sum((((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_015, sum((((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_016, sum((((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_017, sum((((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_018, sum((((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_019, sum((((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_020, sum((((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_021, sum((((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_022, sum((((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_023, sum((((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3)) AS trx_024 FROM (((ims.stg_ims_mhj_qty_m rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) JOIN WSMP_ADMIN.MARKET_PRESC_ZIP_DIVISOR mpzd ON (((p.MARKET_NAME = mpzd.MARKET_NAME) AND (rx.ims_id = mpzd.IMS_ID)))) WHERE (p.MARKET_NAME = 'WAKE'::varchar(4)) GROUP BY mpzd.ZIP, mpzd.STATE, rx.plan_id, to_char(rx.ims_report_num, '00'::varchar(2)), to_char(rx.ims_product_group_num, '000000000'::varchar(9)), ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) UNION ALL SELECT mpzd.ZIP AS zip, mpzd.STATE AS state, rx.plan_id AS payer_plan_num, to_char(rx.ims_report_num, '00'::varchar(2)) AS report_num, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2)) AS data_month, sum(rx.nrx_001) AS nrx_001, sum(rx.nrx_002) AS nrx_002, sum(rx.nrx_003) AS nrx_003, sum(rx.nrx_004) AS nrx_004, sum(rx.nrx_005) AS nrx_005, sum(rx.nrx_006) AS nrx_006, sum(rx.nrx_007) AS nrx_007, sum(rx.nrx_008) AS nrx_008, sum(rx.nrx_009) AS nrx_009, sum(rx.nrx_010) AS nrx_010, sum(rx.nrx_011) AS nrx_011, sum(rx.nrx_012) AS nrx_012, sum(rx.nrx_013) AS nrx_013, sum(rx.nrx_014) AS nrx_014, sum(rx.nrx_015) AS nrx_015, sum(rx.nrx_016) AS nrx_016, sum(rx.nrx_017) AS nrx_017, sum(rx.nrx_018) AS nrx_018, sum(rx.nrx_019) AS nrx_019, sum(rx.nrx_020) AS nrx_020, sum(rx.nrx_021) AS nrx_021, sum(rx.nrx_022) AS nrx_022, sum(rx.nrx_023) AS nrx_023, sum(rx.nrx_024) AS nrx_024, sum(rx.trx_001) AS trx_001, sum(rx.trx_002) AS trx_002, sum(rx.trx_003) AS trx_003, sum(rx.trx_004) AS trx_004, sum(rx.trx_005) AS trx_005, sum(rx.trx_006) AS trx_006, sum(rx.trx_007) AS trx_007, sum(rx.trx_008) AS trx_008, sum(rx.trx_009) AS trx_009, sum(rx.trx_010) AS trx_010, sum(rx.trx_011) AS trx_011, sum(rx.trx_012) AS trx_012, sum(rx.trx_013) AS trx_013, sum(rx.trx_014) AS trx_014, sum(rx.trx_015) AS trx_015, sum(rx.trx_016) AS trx_016, sum(rx.trx_017) AS trx_017, sum(rx.trx_018) AS trx_018, sum(rx.trx_019) AS trx_019, sum(rx.trx_020) AS trx_020, sum(rx.trx_021) AS trx_021, sum(rx.trx_022) AS trx_022, sum(rx.trx_023) AS trx_023, sum(rx.trx_024) AS trx_024 FROM (((ims.stg_ims_mhj_cnt_m rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) JOIN WSMP_ADMIN.MARKET_PRESC_ZIP_DIVISOR mpzd ON (((p.MARKET_NAME = mpzd.MARKET_NAME) AND (rx.ims_id = mpzd.IMS_ID)))) WHERE ((p.MARKET_NAME = 'WAKE'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL)) GROUP BY mpzd.ZIP, mpzd.STATE, rx.plan_id, to_char(rx.ims_report_num, '00'::varchar(2)), to_char(rx.ims_product_group_num, '000000000'::varchar(9)), ((substr(rx.data_date, 1, 2) || '/20'::varchar(3)) || substr(rx.data_date, 5, 2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Paytype AS
SELECT rx.model, rx.payment_method FROM WSMP_ADMIN.dw_presc_plan_rx_w rx WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-0025'::varchar(11), '330-16-050'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-16-055'::varchar(10), '330-14-004'::varchar(10), '330-16-056'::varchar(10), '330-14-006'::varchar(10), '330-15-050'::varchar(10), '330-14-005'::varchar(10), '330-15-005'::varchar(10), '330-12-002'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10), '330-13-020'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-16-027'::varchar(10), '330-16-028'::varchar(10), '330-16-029'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-001'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.model, rx.payment_method;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_planname AS
SELECT rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name FROM WSMP_ADMIN.dw_presc_plan_rx_w rx WHERE ((rx.product_code = ANY (ARRAY['330-14-001'::varchar(10), '330-14-007'::varchar(10), '330-14-009'::varchar(10), '330-14-0025'::varchar(11), '330-16-050'::varchar(10), '330-14-003'::varchar(10), '330-14-008'::varchar(10), '330-16-055'::varchar(10), '330-14-004'::varchar(10), '330-16-056'::varchar(10), '330-14-006'::varchar(10), '330-15-050'::varchar(10), '330-14-005'::varchar(10), '330-15-005'::varchar(10), '330-12-002'::varchar(10), '330-15-010'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-050'::varchar(10), '330-13-020'::varchar(10), '330-16-020'::varchar(10), '330-13-021'::varchar(10), '330-13-016'::varchar(10), '330-13-022'::varchar(10), '330-13-023'::varchar(10), '330-13-024'::varchar(10), '330-13-025'::varchar(10), '330-13-026'::varchar(10), '330-13-027'::varchar(10), '330-13-028'::varchar(10), '330-13-029'::varchar(10), '330-13-030'::varchar(10), '330-16-027'::varchar(10), '330-16-028'::varchar(10), '330-16-029'::varchar(10), '330-13-009'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10), '330-13-011'::varchar(10), '330-15-019'::varchar(10), '330-12-015'::varchar(10), '330-15-015'::varchar(10), '330-12-003'::varchar(10), '330-15-025'::varchar(10), '330-12-023'::varchar(10), '330-15-001'::varchar(10), '330-15-030'::varchar(10), '330-12-019'::varchar(10), '330-15-047'::varchar(10), '330-15-040'::varchar(10)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.payer_plan_num, rx.plan_name, rx.model, rx.payer_name;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_factory_sales_852 AS
SELECT STG_FACTORY_SALES_852.TRADING_PARTNER, STG_FACTORY_SALES_852.DISTRIB_CENTER, STG_FACTORY_SALES_852.DISTRIB_CENTER_DEA_NUM, to_char(STG_FACTORY_SALES_852.REPORTING_DATE, 'DD-MON-YY'::varchar(9)) AS REPORTING_DATE, STG_FACTORY_SALES_852.NDC, STG_FACTORY_SALES_852.PRODUCT_CODE, STG_FACTORY_SALES_852.PRODUCT_NAME, STG_FACTORY_SALES_852.DESCRIPTION, CASE mod(STG_FACTORY_SALES_852.QTY_RECEIVED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RECEIVED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RECEIVED)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED, CASE mod(STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RECEIVED_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_RECEIVED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_SOLD, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_SOLD)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_SOLD)::varchar, '0'::varchar(1)) END AS QTY_SOLD, CASE mod(STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_SOLD_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_SOLD_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_OMIT, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_OMIT)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_OMIT)::varchar, '0'::varchar(1)) END AS QTY_OMIT, CASE mod(STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_OMIT_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_OMIT_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND, CASE mod(STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_QTY_ON_HAND_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_QTY_ON_HAND_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_COMMITTED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_COMMITTED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_COMMITTED)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED, CASE mod(STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_COMMITTED_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_COMMITTED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.MTH_END_RESERVED, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_RESERVED)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_RESERVED)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED, CASE mod(STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.MTH_END_RESERVED_DOLLARS)::varchar, '0'::varchar(1)) END AS MTH_END_RESERVED_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_RETURN, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RETURN)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RETURN)::varchar, '0'::varchar(1)) END AS QTY_RETURN, CASE mod(STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_RETURN_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_RETURN_DOLLARS, CASE mod(STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN, CASE mod(STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS)::int)::varchar ELSE rtrim((STG_FACTORY_SALES_852.QTY_CUSTOMER_RETURN_DOLLARS)::varchar, '0'::varchar(1)) END AS QTY_CUSTOMER_RETURN_DOLLARS, to_char(STG_FACTORY_SALES_852.LAST_BUILD_DATE, 'DD-MON-YY'::varchar(9)) AS LAST_BUILD_DATE FROM WSMP_ADMIN.STG_FACTORY_SALES_852;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_CSP_Attendees AS
SELECT (a.COGENIX_PROGRAM_ID)::int AS cogenix_program_id, a.PROGRAM_NAME, a.PROGRAM_DATE, a.SFA_PROF_ID, a.ME_NUM, a.DEA_NUM, (a.COGENIX_ID)::int AS cogenix_id, coalesce(a.CM_ID, (cm.CUSTOMER_MASTER_ID)::varchar) AS cm_id, a.STATE_LICENSE_STATE, a.STATE_LICENSE_NUMBER, a.FIRST_NAME, a.LAST_NAME, a.ADDRESS1, a.ADDRESS2, a.ADDRESS3, a.CITY, a.STATE, a.ZIP, a.PRIMARY_SPECIALTY, a.HCP_TYPE AS hcp_type, a.PRESCRIBER_FLAG FROM ((WSMP_ADMIN.STG_COGENIX_CSP_ATTENDEE a JOIN WSMP_ADMIN.STG_COGENIX_CSP_PROGRAM p ON ((p.COGENIX_PROGRAM_ID = a.COGENIX_PROGRAM_ID))) LEFT JOIN WSMP_ADMIN.STG_CUSTOMER_MASTER cm ON (((cm.SOURCE_ID = CASE WHEN (a.PRESCRIBER_FLAG = 'N'::varchar(1)) THEN ('NONHCP_'::varchar(7) || (a.COGENIX_ID)::varchar) ELSE (a.COGENIX_ID)::varchar END) AND (cm.RECORD_SOURCE_SYSTEM = 'CGX'::varchar(3))))) WHERE ((p.PROGRAM_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (p.PROGRAM_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (p.PRODUCT = 'Nuvigil'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_CSP_Programs AS
SELECT CASE mod(STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.COGENIX_PROGRAM_ID)::varchar, '0'::varchar(1)) END AS COGENIX_PROGRAM_ID, STG_COGENIX_CSP_PROGRAM.PROGRAM_NAME, to_char(STG_COGENIX_CSP_PROGRAM.PROGRAM_REQUEST_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_REQUEST_DATE, to_char(STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE, 'YYYY-MM-DD'::varchar(10)) AS PROGRAM_DATE, STG_COGENIX_CSP_PROGRAM.PRODUCT, STG_COGENIX_CSP_PROGRAM.TOPIC, STG_COGENIX_CSP_PROGRAM.PROGRAM_TYPE, STG_COGENIX_CSP_PROGRAM.PROGRAM_STATUS, STG_COGENIX_CSP_PROGRAM.VENUE_NAME, STG_COGENIX_CSP_PROGRAM.VENUE_CITY, STG_COGENIX_CSP_PROGRAM.VENUE_STATE, CASE mod(STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ESTIMATED_ATTENDANCE)::varchar, '0'::varchar(1)) END AS ESTIMATED_ATTENDANCE, CASE mod(STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.NONPRESCRIBER_CEPHALON_COUNTS)::varchar, '0'::varchar(1)) END AS NONPRESCRIBER_CEPHALON_COUNTS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_W_O_DEA)::varchar, '0'::varchar(1)) END AS PRESCRIBERS_W_O_DEA, CASE mod(STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.NONHCP_OFFICE_STAFF_COUNTS)::varchar, '0'::varchar(1)) END AS NONHCP_OFFICE_STAFF_COUNTS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS)::varchar, '0'::varchar(1)) END AS PRESCRIBERS, CASE mod(STG_COGENIX_CSP_PROGRAM.HCPS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.HCPS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.HCPS)::varchar, '0'::varchar(1)) END AS HCPS, CASE mod(STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.TOTAL_PRESCRIBERS)::varchar, '0'::varchar(1)) END AS TOTAL_PRESCRIBERS, CASE mod(STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.PRESCRIBERS_ACCEPTED_NO_SHOW)::varchar, '0'::varchar(1)) END AS PRESCRIBERS_ACCEPTED_NO_SHOW, STG_COGENIX_CSP_PROGRAM.ATTENDEE_FORM_RECEIVED, STG_COGENIX_CSP_PROGRAM.ATTENDEE_SIGN_IN_SHEET_RECVD, CASE mod(STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ACTUAL_ATTENDANCE)::varchar, '0'::varchar(1)) END AS ACTUAL_ATTENDANCE, CASE mod(STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ESTIMATED_COSTS)::varchar, '0'::varchar(1)) END AS ESTIMATED_COSTS, STG_COGENIX_CSP_PROGRAM.OFFICES_REPRESENTED, CASE mod(STG_COGENIX_CSP_PROGRAM.AV_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.AV_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.AV_EXPENSES)::varchar, '0'::varchar(1)) END AS AV_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.FOOD_AND_BEVERAGE)::varchar, '0'::varchar(1)) END AS FOOD_AND_BEVERAGE, CASE mod(STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.MEETING_EXPENSES)::varchar, '0'::varchar(1)) END AS MEETING_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.MISCELLANEOUS)::varchar, '0'::varchar(1)) END AS MISCELLANEOUS, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_EXPENSES)::varchar, '0'::varchar(1)) END AS SPEAKER_EXPENSES, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_HONORARIA)::varchar, '0'::varchar(1)) END AS SPEAKER_HONORARIA, CASE mod(STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.SPEAKER_TRAVEL)::varchar, '0'::varchar(1)) END AS SPEAKER_TRAVEL, CASE mod(STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.VENUE_ROOM_RENTAL)::varchar, '0'::varchar(1)) END AS VENUE_ROOM_RENTAL, CASE mod(STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.ACTUAL_COSTS)::varchar, '0'::varchar(1)) END AS ACTUAL_COSTS, CASE mod(STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.UNMET_MINIMUM)::varchar, '0'::varchar(1)) END AS UNMET_MINIMUM, to_char(STG_COGENIX_CSP_PROGRAM.CREATE_DATE, 'YYYY-MM-DD'::varchar(10)) AS CREATE_DATE, CASE mod(STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES)::int)::varchar ELSE rtrim((STG_COGENIX_CSP_PROGRAM.TAKEDA_ATTENDEES)::varchar, '0'::varchar(1)) END AS TAKEDA_ATTENDEES FROM WSMP_ADMIN.STG_COGENIX_CSP_PROGRAM WHERE ((STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (STG_COGENIX_CSP_PROGRAM.PROGRAM_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (STG_COGENIX_CSP_PROGRAM.PRODUCT = 'Nuvigil'::varchar(7)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Copay_Voucher_Drops AS
SELECT CASE mod(x.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((x.tvcmid)::int)::varchar ELSE rtrim((x.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, x.ims_id, x.veeva_account_id, d.RESOURCE_TYPE AS Resource_type, d.TERRITORY_NUM AS Territory_num, d.DISTRIBUTION_DATE AS distribution_date, (d.QTY)::int AS qty FROM WSMP_ADMIN.TFC_SFA_RESOURCE_DIST_DETAIL d, (SELECT demo_combined.ims_id, demo_combined.tvcmid, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.ims_id, demo_combined.tvcmid, demo_combined.veeva_account_id) x WHERE ((d.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (d.DISTRIBUTION_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (d.DISTRIBUTION_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (d.IMS_ID = x.ims_id));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Demo AS
SELECT CASE mod(d.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((d.tvcmid)::int)::varchar ELSE rtrim((d.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, d.ims_id, d.veeva_account_id, d.first_name, d.mid_name, d.last_name, d.degree AS DEGREE, d.address, d.city, d.state, d.zip, d.specialty AS prim_specialty, s1.NUVIGIL_REPORT_GROUP AS nuvigil_report_group, dec1.trx_cnt_01_06 AS nuvigil_decile, dec2.trx_cnt_01_06 AS wake_decile, cp.TARGET_VALUE AS target_flag FROM (((((WSMP_ADMIN.demo_combined d LEFT JOIN WSMP_ADMIN.TFC_SPECIALTY_XREF s1 ON ((s1.SPECIALTY_CODE = d.specialty))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec1 ON (((dec1.ims_id = d.ims_id) AND (dec1.category = 'Provigil'::varchar(8)) AND (dec1.decile_name = 'Nuvigil'::varchar(7))))) LEFT JOIN WSMP_ADMIN.TFC_IMS_DECILE dec2 ON (((dec2.ims_id = d.ims_id) AND (dec2.category = 'Provigil'::varchar(8)) AND (dec2.decile_name = 'Modafinil'::varchar(9))))) JOIN (SELECT prodx.ims_id FROM (SELECT dw_presc_plan_rx_m.ims_id FROM WSMP_ADMIN.dw_presc_plan_rx_m WHERE ((dw_presc_plan_rx_m.product_code = '100N00'::varchar(6)) AND (dw_presc_plan_rx_m.month_bucket >= 1::numeric(18,0)) AND (dw_presc_plan_rx_m.month_bucket <= 24::numeric(18,0))) UNION ALL SELECT DIM_SFA_CSF_DEMO.IMS_ID AS ims_id FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO WHERE (DIM_SFA_CSF_DEMO.SALES_FORCE_ID = 'TC'::varchar(2))) prodx GROUP BY prodx.ims_id) r ON ((d.ims_id = r.ims_id))) LEFT JOIN WSMP_ADMIN.DIM_SFA_TARGETS cp ON (((d.ims_id = cp.IMS_ID) AND (cp.NAME = 'Nuvigil'::varchar(7)) AND (cp.PERIOD ~~ '2015%'::varchar(5))))) WHERE ((d.sales_force_id = 'TC'::varchar(2)) AND (d.last_name <> 'NATIONAL ASSIGNMENT'::varchar(19)) AND (d.first_name IS NOT NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_agile_mktg_mix_rx AS
SELECT rx.ims_id AS IMS_ID, rx.product_code, p.NAME AS product_name, rx.month_ending AS MONTH_ENDING, sum(CASE mod(rx.nrx_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.nrx_qty)::int)::varchar ELSE rtrim((rx.nrx_qty)::varchar, '0'::varchar(1)) END) AS nrx_qty, sum(CASE mod(rx.trx_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.trx_qty)::int)::varchar ELSE rtrim((rx.trx_qty)::varchar, '0'::varchar(1)) END) AS trx_qty, sum(CASE mod(rx.nrx_cnt, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.nrx_cnt)::int)::varchar ELSE rtrim((rx.nrx_cnt)::varchar, '0'::varchar(1)) END) AS nrx_cnt, sum(CASE mod(rx.trx_cnt, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((rx.trx_cnt)::int)::varchar ELSE rtrim((rx.trx_cnt)::varchar, '0'::varchar(1)) END) AS trx_cnt FROM WSMP_ADMIN.dw_presc_plan_rx_m rx, CUSTOMER.PRODUCT p WHERE ((rx.product_code = p.PRODUCT_CODE) AND (rx.month_ending >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (rx.month_ending <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (rx.product_code = ANY (ARRAY['100100'::varchar(6), '100101'::varchar(6), '100102'::varchar(6), '100N00'::varchar(6), '100N05'::varchar(6), '100N15'::varchar(6), '100N20'::varchar(6), '100N25'::varchar(6), '100700'::varchar(6)])) AND (length(rx.ims_id) = 7)) GROUP BY rx.ims_id, rx.product_code, p.NAME, rx.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Samples AS
SELECT S.sales_force_id, S.territory_num, CASE mod(IX.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((IX.tvcmid)::int)::varchar ELSE rtrim((IX.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, IX.ims_id, IX.veeva_account_id, to_char(S.ship_date, 'YYYY-MM-DD'::varchar(10)) AS ship_date, S.product_code, S.product, CASE mod(S.ship_qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((S.ship_qty)::int)::varchar ELSE rtrim((S.ship_qty)::varchar, '0'::varchar(1)) END AS ship_qty FROM ((SELECT ss.SALES_FORCE_ID AS sales_force_id, ss.TERRITORY_NUM AS territory_num, NULL AS tvcmid, ss.IMS_ID AS ims_id, ss.DEMO_ID AS demo_id, ss.SHIP_DATE AS ship_date, ss.PRODUCT_CODE AS product_code, ss.PRODUCT AS product, ss.SHIP_QTY AS ship_qty FROM WSMP_ADMIN.STG_KNIPPER_SAMPLES_SHIPPED ss WHERE ((ss.SALES_FORCE_ID = 'TC'::varchar(2)) AND (ss.SHIP_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (ss.SHIP_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (ss.PRODUCT_CODE ~~ '100N%'::varchar(5)))) S LEFT JOIN (SELECT demo_combined.tvcmid, demo_combined.ims_id, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.tvcmid, demo_combined.ims_id, demo_combined.veeva_account_id) IX ON ((S.demo_id = IX.veeva_account_id)));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Details AS
SELECT CASE mod(d.TVCMID, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((d.TVCMID)::int)::varchar ELSE rtrim((d.TVCMID)::varchar, '0'::varchar(1)) END AS tvcmid, cd.IMS_ID AS ims_id, cd.VEEVA_ACCOUNT_ID AS veeva_account_id, initcap(d.LAST_NAME) AS last_name, initcap(d.FIRST_NAME) AS first_name, initcap(d.MIDDLE_NAME) AS middle_name, d.CREDENTIALS AS DEGREE, d.ZIP AS zip, cd.REP_ID AS rep_id, cd.TERRITORY_NUM AS territory_num, to_char(cd.CALL_DATE, 'YYYY-MM-DD'::varchar(10)) AS call_date, 'NUVIGIL'::varchar(7) AS product, CASE WHEN (cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 1 WHEN (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 2 ELSE NULL::int END AS detail_position FROM WSMP_ADMIN.TFC_SFA_CSF_CALL_DETAIL cd, WSMP_ADMIN.DIM_SFA_CSF_DEMO d, WSMP_ADMIN.TFC_CURRENT_ZIP_ALIGNMENT z WHERE ((cd.SALES_FORCE_ID = 'TC'::varchar(2)) AND (cd.SALES_FORCE_ID = d.SALES_FORCE_ID) AND (cd.TERRITORY_NUM = d.TERRITORY_NUM) AND (cd.CALL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (cd.CALL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.VEEVA_ACCOUNT_ID = d.VEEVA_ACCOUNT_ID) AND (d.ZIP = z.ZIP) AND ((cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) OR (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7))) AND (cd.LEGACY_CALL_TYPE = 'PROF'::varchar(4)) AND ((cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) OR (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7))) AND (cd.LEGACY_CALL_TYPE = 'PROF'::varchar(4))) GROUP BY d.TVCMID, cd.IMS_ID, cd.VEEVA_ACCOUNT_ID, initcap(d.LAST_NAME), initcap(d.FIRST_NAME), initcap(d.MIDDLE_NAME), d.CREDENTIALS, d.ZIP, cd.REP_ID, cd.TERRITORY_NUM, cd.CALL_DATE, 'NUVIGIL'::varchar(7), CASE WHEN (cd.FIRST_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 1 WHEN (cd.SECOND_DETAILED_PRODUCT = 'NUVIGIL'::varchar(7)) THEN 2 ELSE NULL::int END;

CREATE  VIEW WSMP_ADMIN_ORA.v_tmp_ms AS
SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, rx.sales_category, rx.rx_type, rx.ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024, 'stg_ims_mhj_qty_m'::varchar(17) AS row_source FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) UNION ALL SELECT rx.ims_client_num, rx.ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, rx.sales_category, rx.rx_type, rx.ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24, 'stg_asi_ms_rx_cnt'::varchar(17) AS row_source FROM WSMP_ADMIN.stg_asi_ms_rx_cnt rx;

CREATE  VIEW WSMP_ADMIN_ORA.dim_ims_month_buckets AS
SELECT dw_presc_rx_m.month_bucket, dw_presc_rx_m.month_ending FROM WSMP_ADMIN.dw_presc_rx_m GROUP BY dw_presc_rx_m.month_bucket, dw_presc_rx_m.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_wake AS
SELECT rx.ims_client_num, 71 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'WAKE'::varchar(4)) UNION ALL SELECT rx.ims_client_num, 71 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'WAKE'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_smr AS
SELECT rx.ims_client_num, 81 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'SMR'::varchar(3)) UNION ALL SELECT rx.ims_client_num, 81 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'SMR'::varchar(3)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_pd AS
(SELECT rx.ims_client_num, 6 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'ANTI-PARKINSON'::varchar(14)) UNION ALL SELECT rx.ims_client_num, 6 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'ANTI-PARKINSON'::varchar(14)) AND (nf.PRODUCT_CODE IS NULL))) UNION ALL SELECT rx.ims_client_num, 6 AS ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, to_char(rx.sales_category, '00'::varchar(2)) AS sales_category, rx.rx_type, to_char(rx.ims_product_group_num, '000000000'::varchar(9)) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24 FROM WSMP_ADMIN.stg_asi_pd_rx_cnt rx;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_ms AS
(SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) UNION ALL SELECT rx.ims_client_num, 2 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'MULTIPLE SCLEROSIS'::varchar(18)) AND (nf.PRODUCT_CODE IS NULL))) UNION ALL SELECT rx.ims_client_num, 2 AS ims_report_num, rx.sra_1, rx.sra_2, rx.sra_3, rx.sra_4, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.mid_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.filler_02, CASE WHEN (rx.payer_plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.payer_plan_name) || '"'::varchar(1)) ELSE rx.payer_plan_name END AS plan_name, rx.data_month, 48 AS bucket_count, rx.nrx_01, rx.nrx_02, rx.nrx_03, rx.nrx_04, rx.nrx_05, rx.nrx_06, rx.nrx_07, rx.nrx_08, rx.nrx_09, rx.nrx_10, rx.nrx_11, rx.nrx_12, rx.nrx_13, rx.nrx_14, rx.nrx_15, rx.nrx_16, rx.nrx_17, rx.nrx_18, rx.nrx_19, rx.nrx_20, rx.nrx_21, rx.nrx_22, rx.nrx_23, rx.nrx_24, rx.trx_01, rx.trx_02, rx.trx_03, rx.trx_04, rx.trx_05, rx.trx_06, rx.trx_07, rx.trx_08, rx.trx_09, rx.trx_10, rx.trx_11, rx.trx_12, rx.trx_13, rx.trx_14, rx.trx_15, rx.trx_16, rx.trx_17, rx.trx_18, rx.trx_19, rx.trx_20, rx.trx_21, rx.trx_22, rx.trx_23, rx.trx_24 FROM WSMP_ADMIN.stg_asi_ms_rx_cnt rx;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_asi_ims_obm_pain AS
SELECT rx.ims_client_num, 74 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, (((rx.nrx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_001, (((rx.nrx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_002, (((rx.nrx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_003, (((rx.nrx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_004, (((rx.nrx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_005, (((rx.nrx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_006, (((rx.nrx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_007, (((rx.nrx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_008, (((rx.nrx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_009, (((rx.nrx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_010, (((rx.nrx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_011, (((rx.nrx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_012, (((rx.nrx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_013, (((rx.nrx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_014, (((rx.nrx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_015, (((rx.nrx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_016, (((rx.nrx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_017, (((rx.nrx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_018, (((rx.nrx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_019, (((rx.nrx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_020, (((rx.nrx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_021, (((rx.nrx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_022, (((rx.nrx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_023, (((rx.nrx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS nrx_024, (((rx.trx_001 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_001, (((rx.trx_002 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_002, (((rx.trx_003 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_003, (((rx.trx_004 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_004, (((rx.trx_005 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_005, (((rx.trx_006 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_006, (((rx.trx_007 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_007, (((rx.trx_008 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_008, (((rx.trx_009 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_009, (((rx.trx_010 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_010, (((rx.trx_011 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_011, (((rx.trx_012 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_012, (((rx.trx_013 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_013, (((rx.trx_014 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_014, (((rx.trx_015 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_015, (((rx.trx_016 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_016, (((rx.trx_017 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_017, (((rx.trx_018 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_018, (((rx.trx_019 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_019, (((rx.trx_020 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_020, (((rx.trx_021 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_021, (((rx.trx_022 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_022, (((rx.trx_023 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_023, (((rx.trx_024 / nf.DIVISOR) * nf.MULTIPLIER))::numeric(9,3) AS trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_QTY_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_QTY) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE (p.MARKET_NAME = 'PAIN'::varchar(4)) UNION ALL SELECT rx.ims_client_num, 74 AS ims_report_num, rx.zip_other, rx.ims_id, rx.specialty, rx.plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.rx_type, btrim(to_char(rx.ims_product_group_num, '000000000'::varchar(9))) AS ims_product_group_num, rx.filler_01, rx.me_num, rx.last_name, rx.first_name, rx.middle_name, CASE WHEN (rx.address ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.address) || '"'::varchar(1)) ELSE rx.address END AS address, rx.city, rx.state, rx.zip, rx.supplemental_data, CASE WHEN (rx.plan_name ~~ '%,%'::varchar(3)) THEN (('"'::varchar(1) || rx.plan_name) || '"'::varchar(1)) ELSE rx.plan_name END AS plan_name, rx.data_date, rx.bucket_count, rx.nrx_001, rx.nrx_002, rx.nrx_003, rx.nrx_004, rx.nrx_005, rx.nrx_006, rx.nrx_007, rx.nrx_008, rx.nrx_009, rx.nrx_010, rx.nrx_011, rx.nrx_012, rx.nrx_013, rx.nrx_014, rx.nrx_015, rx.nrx_016, rx.nrx_017, rx.nrx_018, rx.nrx_019, rx.nrx_020, rx.nrx_021, rx.nrx_022, rx.nrx_023, rx.nrx_024, rx.trx_001, rx.trx_002, rx.trx_003, rx.trx_004, rx.trx_005, rx.trx_006, rx.trx_007, rx.trx_008, rx.trx_009, rx.trx_010, rx.trx_011, rx.trx_012, rx.trx_013, rx.trx_014, rx.trx_015, rx.trx_016, rx.trx_017, rx.trx_018, rx.trx_019, rx.trx_020, rx.trx_021, rx.trx_022, rx.trx_023, rx.trx_024 FROM ((teva_ingestion.EXT_IMS_MHJ_CNT_M rx JOIN WSMP_ADMIN.DRM45_PRODUCT_2014 p ON (((rx.ims_client_num = p.IMS_CLIENT_NUM_M) AND (rx.ims_report_num = p.IMS_REPORT_NUM_M_CNT) AND (rx.ims_product_group_num = p.IMS_PRODUCT_GROUP_NUM)))) LEFT JOIN WSMP_ADMIN.DIM_IMS_NORMALIZATION_FACTOR nf ON ((p.PRODUCT_CODE = nf.PRODUCT_CODE))) WHERE ((p.MARKET_NAME = 'PAIN'::varchar(4)) AND (nf.PRODUCT_CODE IS NULL));

CREATE  VIEW teva_ingestion.MS_MTHLY_RX_CNT AS
SELECT CASE WHEN (MS_MTHLY_RX_CNT_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_MTHLY_RX_CNT_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_report_num))::int END AS ims_report_num, btrim(MS_MTHLY_RX_CNT_src.zip_other) AS zip_other, btrim(MS_MTHLY_RX_CNT_src.ims_id) AS ims_id, btrim(MS_MTHLY_RX_CNT_src.ndc) AS ndc, btrim(MS_MTHLY_RX_CNT_src.plan_id) AS plan_id, CASE WHEN (MS_MTHLY_RX_CNT_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.sales_category))::int END AS sales_category, btrim(MS_MTHLY_RX_CNT_src.rx_type) AS rx_type, CASE WHEN (MS_MTHLY_RX_CNT_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_MTHLY_RX_CNT_src.filler_01) AS filler_01, btrim(MS_MTHLY_RX_CNT_src.me_num) AS me_num, btrim(MS_MTHLY_RX_CNT_src.last_name) AS last_name, btrim(MS_MTHLY_RX_CNT_src.first_name) AS first_name, btrim(MS_MTHLY_RX_CNT_src.middle_name) AS middle_name, btrim(MS_MTHLY_RX_CNT_src.address) AS address, btrim(MS_MTHLY_RX_CNT_src.city) AS city, btrim(MS_MTHLY_RX_CNT_src.state) AS state, btrim(MS_MTHLY_RX_CNT_src.zip) AS zip, btrim(MS_MTHLY_RX_CNT_src.specialty) AS specialty, btrim(MS_MTHLY_RX_CNT_src.plan_name) AS plan_name, btrim(MS_MTHLY_RX_CNT_src.ndc_description) AS ndc_description, btrim(MS_MTHLY_RX_CNT_src.data_date) AS data_date, CASE WHEN (MS_MTHLY_RX_CNT_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_MTHLY_RX_CNT_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_MTHLY_RX_CNT_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_MTHLY_RX_CNT_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_MTHLY_RX_CNT_src.trx_024))::numeric(9,3) END AS trx_024, MS_MTHLY_RX_CNT_src.batch_id, MS_MTHLY_RX_CNT_src.row_id, MS_MTHLY_RX_CNT_src.update_ts FROM teva_ingestion.MS_MTHLY_RX_CNT_src;

CREATE  VIEW teva_ingestion.MS_WKLY_RX_CNT AS
SELECT CASE WHEN (MS_WKLY_RX_CNT_src.ims_client_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_client_num))::int END AS ims_client_num, CASE WHEN (MS_WKLY_RX_CNT_src.ims_report_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_report_num))::int END AS ims_report_num, btrim(MS_WKLY_RX_CNT_src.zip_other) AS zip_other, btrim(MS_WKLY_RX_CNT_src.ims_id) AS ims_id, btrim(MS_WKLY_RX_CNT_src.ndc) AS ndc, btrim(MS_WKLY_RX_CNT_src.plan_id) AS plan_id, CASE WHEN (MS_WKLY_RX_CNT_src.sales_category = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.sales_category))::int END AS sales_category, btrim(MS_WKLY_RX_CNT_src.rx_type) AS rx_type, CASE WHEN (MS_WKLY_RX_CNT_src.ims_product_group_num = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.ims_product_group_num))::int END AS ims_product_group_num, btrim(MS_WKLY_RX_CNT_src.filler_01) AS filler_01, btrim(MS_WKLY_RX_CNT_src.me_num) AS me_num, btrim(MS_WKLY_RX_CNT_src.last_name) AS last_name, btrim(MS_WKLY_RX_CNT_src.first_name) AS first_name, btrim(MS_WKLY_RX_CNT_src.middle_name) AS middle_name, btrim(MS_WKLY_RX_CNT_src.address) AS address, btrim(MS_WKLY_RX_CNT_src.city) AS city, btrim(MS_WKLY_RX_CNT_src.state) AS state, btrim(MS_WKLY_RX_CNT_src.zip) AS zip, btrim(MS_WKLY_RX_CNT_src.specialty) AS specialty, btrim(MS_WKLY_RX_CNT_src.plan_name) AS plan_name, btrim(MS_WKLY_RX_CNT_src.ndc_description) AS ndc_description, btrim(MS_WKLY_RX_CNT_src.data_date) AS data_date, CASE WHEN (MS_WKLY_RX_CNT_src.bucket_count = ''::varchar) THEN NULL::int ELSE (btrim(MS_WKLY_RX_CNT_src.bucket_count))::int END AS bucket_count, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_001))::numeric(9,3) END AS nrx_001, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_002))::numeric(9,3) END AS nrx_002, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_003))::numeric(9,3) END AS nrx_003, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_004))::numeric(9,3) END AS nrx_004, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_005))::numeric(9,3) END AS nrx_005, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_006))::numeric(9,3) END AS nrx_006, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_007))::numeric(9,3) END AS nrx_007, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_008))::numeric(9,3) END AS nrx_008, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_009))::numeric(9,3) END AS nrx_009, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_010))::numeric(9,3) END AS nrx_010, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_011))::numeric(9,3) END AS nrx_011, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_012))::numeric(9,3) END AS nrx_012, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_013))::numeric(9,3) END AS nrx_013, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_014))::numeric(9,3) END AS nrx_014, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_015))::numeric(9,3) END AS nrx_015, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_016))::numeric(9,3) END AS nrx_016, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_017))::numeric(9,3) END AS nrx_017, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_018))::numeric(9,3) END AS nrx_018, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_019))::numeric(9,3) END AS nrx_019, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_020))::numeric(9,3) END AS nrx_020, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_021))::numeric(9,3) END AS nrx_021, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_022))::numeric(9,3) END AS nrx_022, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_023))::numeric(9,3) END AS nrx_023, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_024))::numeric(9,3) END AS nrx_024, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_025))::numeric(9,3) END AS nrx_025, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_026))::numeric(9,3) END AS nrx_026, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_027))::numeric(9,3) END AS nrx_027, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_028))::numeric(9,3) END AS nrx_028, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_029))::numeric(9,3) END AS nrx_029, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_030))::numeric(9,3) END AS nrx_030, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_031))::numeric(9,3) END AS nrx_031, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_032))::numeric(9,3) END AS nrx_032, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_033))::numeric(9,3) END AS nrx_033, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_034))::numeric(9,3) END AS nrx_034, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_035))::numeric(9,3) END AS nrx_035, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_036))::numeric(9,3) END AS nrx_036, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_037))::numeric(9,3) END AS nrx_037, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_038))::numeric(9,3) END AS nrx_038, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_039))::numeric(9,3) END AS nrx_039, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_040))::numeric(9,3) END AS nrx_040, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_041))::numeric(9,3) END AS nrx_041, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_042))::numeric(9,3) END AS nrx_042, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_043))::numeric(9,3) END AS nrx_043, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_044))::numeric(9,3) END AS nrx_044, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_045))::numeric(9,3) END AS nrx_045, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_046))::numeric(9,3) END AS nrx_046, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_047))::numeric(9,3) END AS nrx_047, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_048))::numeric(9,3) END AS nrx_048, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_049))::numeric(9,3) END AS nrx_049, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_050))::numeric(9,3) END AS nrx_050, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_051))::numeric(9,3) END AS nrx_051, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_052))::numeric(9,3) END AS nrx_052, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_053))::numeric(9,3) END AS nrx_053, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_054))::numeric(9,3) END AS nrx_054, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_055))::numeric(9,3) END AS nrx_055, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_056))::numeric(9,3) END AS nrx_056, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_057))::numeric(9,3) END AS nrx_057, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_058))::numeric(9,3) END AS nrx_058, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_059))::numeric(9,3) END AS nrx_059, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_060))::numeric(9,3) END AS nrx_060, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_061))::numeric(9,3) END AS nrx_061, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_062))::numeric(9,3) END AS nrx_062, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_063))::numeric(9,3) END AS nrx_063, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_064))::numeric(9,3) END AS nrx_064, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_065))::numeric(9,3) END AS nrx_065, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_066))::numeric(9,3) END AS nrx_066, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_067))::numeric(9,3) END AS nrx_067, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_068))::numeric(9,3) END AS nrx_068, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_069))::numeric(9,3) END AS nrx_069, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_070))::numeric(9,3) END AS nrx_070, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_071))::numeric(9,3) END AS nrx_071, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_072))::numeric(9,3) END AS nrx_072, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_073))::numeric(9,3) END AS nrx_073, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_074))::numeric(9,3) END AS nrx_074, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_075))::numeric(9,3) END AS nrx_075, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_076))::numeric(9,3) END AS nrx_076, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_077))::numeric(9,3) END AS nrx_077, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_078))::numeric(9,3) END AS nrx_078, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_079))::numeric(9,3) END AS nrx_079, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_080))::numeric(9,3) END AS nrx_080, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_081))::numeric(9,3) END AS nrx_081, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_082))::numeric(9,3) END AS nrx_082, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_083))::numeric(9,3) END AS nrx_083, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_084))::numeric(9,3) END AS nrx_084, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_085))::numeric(9,3) END AS nrx_085, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_086))::numeric(9,3) END AS nrx_086, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_087))::numeric(9,3) END AS nrx_087, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_088))::numeric(9,3) END AS nrx_088, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_089))::numeric(9,3) END AS nrx_089, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_090))::numeric(9,3) END AS nrx_090, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_091))::numeric(9,3) END AS nrx_091, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_092))::numeric(9,3) END AS nrx_092, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_093))::numeric(9,3) END AS nrx_093, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_094))::numeric(9,3) END AS nrx_094, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_095))::numeric(9,3) END AS nrx_095, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_096))::numeric(9,3) END AS nrx_096, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_097))::numeric(9,3) END AS nrx_097, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_098))::numeric(9,3) END AS nrx_098, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_099))::numeric(9,3) END AS nrx_099, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_100))::numeric(9,3) END AS nrx_100, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_101))::numeric(9,3) END AS nrx_101, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_102))::numeric(9,3) END AS nrx_102, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_103))::numeric(9,3) END AS nrx_103, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_104))::numeric(9,3) END AS nrx_104, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_105))::numeric(9,3) END AS nrx_105, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_106))::numeric(9,3) END AS nrx_106, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_107))::numeric(9,3) END AS nrx_107, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_108))::numeric(9,3) END AS nrx_108, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_109))::numeric(9,3) END AS nrx_109, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_110))::numeric(9,3) END AS nrx_110, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_111))::numeric(9,3) END AS nrx_111, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_112))::numeric(9,3) END AS nrx_112, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_113))::numeric(9,3) END AS nrx_113, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_114))::numeric(9,3) END AS nrx_114, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_115))::numeric(9,3) END AS nrx_115, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_116))::numeric(9,3) END AS nrx_116, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_117))::numeric(9,3) END AS nrx_117, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_118))::numeric(9,3) END AS nrx_118, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_119))::numeric(9,3) END AS nrx_119, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_120))::numeric(9,3) END AS nrx_120, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_121))::numeric(9,3) END AS nrx_121, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_122))::numeric(9,3) END AS nrx_122, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_123))::numeric(9,3) END AS nrx_123, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_124))::numeric(9,3) END AS nrx_124, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_125))::numeric(9,3) END AS nrx_125, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_126))::numeric(9,3) END AS nrx_126, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_127))::numeric(9,3) END AS nrx_127, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_128))::numeric(9,3) END AS nrx_128, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_129))::numeric(9,3) END AS nrx_129, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_130))::numeric(9,3) END AS nrx_130, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_131))::numeric(9,3) END AS nrx_131, CASE WHEN (MS_WKLY_RX_CNT_src.nrx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.nrx_132))::numeric(9,3) END AS nrx_132, CASE WHEN (MS_WKLY_RX_CNT_src.trx_001 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_001))::numeric(9,3) END AS trx_001, CASE WHEN (MS_WKLY_RX_CNT_src.trx_002 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_002))::numeric(9,3) END AS trx_002, CASE WHEN (MS_WKLY_RX_CNT_src.trx_003 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_003))::numeric(9,3) END AS trx_003, CASE WHEN (MS_WKLY_RX_CNT_src.trx_004 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_004))::numeric(9,3) END AS trx_004, CASE WHEN (MS_WKLY_RX_CNT_src.trx_005 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_005))::numeric(9,3) END AS trx_005, CASE WHEN (MS_WKLY_RX_CNT_src.trx_006 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_006))::numeric(9,3) END AS trx_006, CASE WHEN (MS_WKLY_RX_CNT_src.trx_007 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_007))::numeric(9,3) END AS trx_007, CASE WHEN (MS_WKLY_RX_CNT_src.trx_008 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_008))::numeric(9,3) END AS trx_008, CASE WHEN (MS_WKLY_RX_CNT_src.trx_009 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_009))::numeric(9,3) END AS trx_009, CASE WHEN (MS_WKLY_RX_CNT_src.trx_010 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_010))::numeric(9,3) END AS trx_010, CASE WHEN (MS_WKLY_RX_CNT_src.trx_011 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_011))::numeric(9,3) END AS trx_011, CASE WHEN (MS_WKLY_RX_CNT_src.trx_012 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_012))::numeric(9,3) END AS trx_012, CASE WHEN (MS_WKLY_RX_CNT_src.trx_013 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_013))::numeric(9,3) END AS trx_013, CASE WHEN (MS_WKLY_RX_CNT_src.trx_014 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_014))::numeric(9,3) END AS trx_014, CASE WHEN (MS_WKLY_RX_CNT_src.trx_015 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_015))::numeric(9,3) END AS trx_015, CASE WHEN (MS_WKLY_RX_CNT_src.trx_016 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_016))::numeric(9,3) END AS trx_016, CASE WHEN (MS_WKLY_RX_CNT_src.trx_017 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_017))::numeric(9,3) END AS trx_017, CASE WHEN (MS_WKLY_RX_CNT_src.trx_018 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_018))::numeric(9,3) END AS trx_018, CASE WHEN (MS_WKLY_RX_CNT_src.trx_019 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_019))::numeric(9,3) END AS trx_019, CASE WHEN (MS_WKLY_RX_CNT_src.trx_020 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_020))::numeric(9,3) END AS trx_020, CASE WHEN (MS_WKLY_RX_CNT_src.trx_021 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_021))::numeric(9,3) END AS trx_021, CASE WHEN (MS_WKLY_RX_CNT_src.trx_022 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_022))::numeric(9,3) END AS trx_022, CASE WHEN (MS_WKLY_RX_CNT_src.trx_023 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_023))::numeric(9,3) END AS trx_023, CASE WHEN (MS_WKLY_RX_CNT_src.trx_024 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_024))::numeric(9,3) END AS trx_024, CASE WHEN (MS_WKLY_RX_CNT_src.trx_025 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_025))::numeric(9,3) END AS trx_025, CASE WHEN (MS_WKLY_RX_CNT_src.trx_026 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_026))::numeric(9,3) END AS trx_026, CASE WHEN (MS_WKLY_RX_CNT_src.trx_027 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_027))::numeric(9,3) END AS trx_027, CASE WHEN (MS_WKLY_RX_CNT_src.trx_028 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_028))::numeric(9,3) END AS trx_028, CASE WHEN (MS_WKLY_RX_CNT_src.trx_029 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_029))::numeric(9,3) END AS trx_029, CASE WHEN (MS_WKLY_RX_CNT_src.trx_030 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_030))::numeric(9,3) END AS trx_030, CASE WHEN (MS_WKLY_RX_CNT_src.trx_031 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_031))::numeric(9,3) END AS trx_031, CASE WHEN (MS_WKLY_RX_CNT_src.trx_032 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_032))::numeric(9,3) END AS trx_032, CASE WHEN (MS_WKLY_RX_CNT_src.trx_033 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_033))::numeric(9,3) END AS trx_033, CASE WHEN (MS_WKLY_RX_CNT_src.trx_034 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_034))::numeric(9,3) END AS trx_034, CASE WHEN (MS_WKLY_RX_CNT_src.trx_035 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_035))::numeric(9,3) END AS trx_035, CASE WHEN (MS_WKLY_RX_CNT_src.trx_036 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_036))::numeric(9,3) END AS trx_036, CASE WHEN (MS_WKLY_RX_CNT_src.trx_037 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_037))::numeric(9,3) END AS trx_037, CASE WHEN (MS_WKLY_RX_CNT_src.trx_038 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_038))::numeric(9,3) END AS trx_038, CASE WHEN (MS_WKLY_RX_CNT_src.trx_039 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_039))::numeric(9,3) END AS trx_039, CASE WHEN (MS_WKLY_RX_CNT_src.trx_040 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_040))::numeric(9,3) END AS trx_040, CASE WHEN (MS_WKLY_RX_CNT_src.trx_041 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_041))::numeric(9,3) END AS trx_041, CASE WHEN (MS_WKLY_RX_CNT_src.trx_042 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_042))::numeric(9,3) END AS trx_042, CASE WHEN (MS_WKLY_RX_CNT_src.trx_043 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_043))::numeric(9,3) END AS trx_043, CASE WHEN (MS_WKLY_RX_CNT_src.trx_044 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_044))::numeric(9,3) END AS trx_044, CASE WHEN (MS_WKLY_RX_CNT_src.trx_045 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_045))::numeric(9,3) END AS trx_045, CASE WHEN (MS_WKLY_RX_CNT_src.trx_046 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_046))::numeric(9,3) END AS trx_046, CASE WHEN (MS_WKLY_RX_CNT_src.trx_047 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_047))::numeric(9,3) END AS trx_047, CASE WHEN (MS_WKLY_RX_CNT_src.trx_048 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_048))::numeric(9,3) END AS trx_048, CASE WHEN (MS_WKLY_RX_CNT_src.trx_049 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_049))::numeric(9,3) END AS trx_049, CASE WHEN (MS_WKLY_RX_CNT_src.trx_050 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_050))::numeric(9,3) END AS trx_050, CASE WHEN (MS_WKLY_RX_CNT_src.trx_051 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_051))::numeric(9,3) END AS trx_051, CASE WHEN (MS_WKLY_RX_CNT_src.trx_052 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_052))::numeric(9,3) END AS trx_052, CASE WHEN (MS_WKLY_RX_CNT_src.trx_053 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_053))::numeric(9,3) END AS trx_053, CASE WHEN (MS_WKLY_RX_CNT_src.trx_054 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_054))::numeric(9,3) END AS trx_054, CASE WHEN (MS_WKLY_RX_CNT_src.trx_055 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_055))::numeric(9,3) END AS trx_055, CASE WHEN (MS_WKLY_RX_CNT_src.trx_056 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_056))::numeric(9,3) END AS trx_056, CASE WHEN (MS_WKLY_RX_CNT_src.trx_057 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_057))::numeric(9,3) END AS trx_057, CASE WHEN (MS_WKLY_RX_CNT_src.trx_058 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_058))::numeric(9,3) END AS trx_058, CASE WHEN (MS_WKLY_RX_CNT_src.trx_059 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_059))::numeric(9,3) END AS trx_059, CASE WHEN (MS_WKLY_RX_CNT_src.trx_060 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_060))::numeric(9,3) END AS trx_060, CASE WHEN (MS_WKLY_RX_CNT_src.trx_061 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_061))::numeric(9,3) END AS trx_061, CASE WHEN (MS_WKLY_RX_CNT_src.trx_062 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_062))::numeric(9,3) END AS trx_062, CASE WHEN (MS_WKLY_RX_CNT_src.trx_063 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_063))::numeric(9,3) END AS trx_063, CASE WHEN (MS_WKLY_RX_CNT_src.trx_064 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_064))::numeric(9,3) END AS trx_064, CASE WHEN (MS_WKLY_RX_CNT_src.trx_065 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_065))::numeric(9,3) END AS trx_065, CASE WHEN (MS_WKLY_RX_CNT_src.trx_066 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_066))::numeric(9,3) END AS trx_066, CASE WHEN (MS_WKLY_RX_CNT_src.trx_067 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_067))::numeric(9,3) END AS trx_067, CASE WHEN (MS_WKLY_RX_CNT_src.trx_068 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_068))::numeric(9,3) END AS trx_068, CASE WHEN (MS_WKLY_RX_CNT_src.trx_069 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_069))::numeric(9,3) END AS trx_069, CASE WHEN (MS_WKLY_RX_CNT_src.trx_070 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_070))::numeric(9,3) END AS trx_070, CASE WHEN (MS_WKLY_RX_CNT_src.trx_071 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_071))::numeric(9,3) END AS trx_071, CASE WHEN (MS_WKLY_RX_CNT_src.trx_072 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_072))::numeric(9,3) END AS trx_072, CASE WHEN (MS_WKLY_RX_CNT_src.trx_073 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_073))::numeric(9,3) END AS trx_073, CASE WHEN (MS_WKLY_RX_CNT_src.trx_074 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_074))::numeric(9,3) END AS trx_074, CASE WHEN (MS_WKLY_RX_CNT_src.trx_075 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_075))::numeric(9,3) END AS trx_075, CASE WHEN (MS_WKLY_RX_CNT_src.trx_076 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_076))::numeric(9,3) END AS trx_076, CASE WHEN (MS_WKLY_RX_CNT_src.trx_077 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_077))::numeric(9,3) END AS trx_077, CASE WHEN (MS_WKLY_RX_CNT_src.trx_078 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_078))::numeric(9,3) END AS trx_078, CASE WHEN (MS_WKLY_RX_CNT_src.trx_079 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_079))::numeric(9,3) END AS trx_079, CASE WHEN (MS_WKLY_RX_CNT_src.trx_080 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_080))::numeric(9,3) END AS trx_080, CASE WHEN (MS_WKLY_RX_CNT_src.trx_081 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_081))::numeric(9,3) END AS trx_081, CASE WHEN (MS_WKLY_RX_CNT_src.trx_082 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_082))::numeric(9,3) END AS trx_082, CASE WHEN (MS_WKLY_RX_CNT_src.trx_083 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_083))::numeric(9,3) END AS trx_083, CASE WHEN (MS_WKLY_RX_CNT_src.trx_084 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_084))::numeric(9,3) END AS trx_084, CASE WHEN (MS_WKLY_RX_CNT_src.trx_085 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_085))::numeric(9,3) END AS trx_085, CASE WHEN (MS_WKLY_RX_CNT_src.trx_086 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_086))::numeric(9,3) END AS trx_086, CASE WHEN (MS_WKLY_RX_CNT_src.trx_087 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_087))::numeric(9,3) END AS trx_087, CASE WHEN (MS_WKLY_RX_CNT_src.trx_088 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_088))::numeric(9,3) END AS trx_088, CASE WHEN (MS_WKLY_RX_CNT_src.trx_089 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_089))::numeric(9,3) END AS trx_089, CASE WHEN (MS_WKLY_RX_CNT_src.trx_090 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_090))::numeric(9,3) END AS trx_090, CASE WHEN (MS_WKLY_RX_CNT_src.trx_091 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_091))::numeric(9,3) END AS trx_091, CASE WHEN (MS_WKLY_RX_CNT_src.trx_092 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_092))::numeric(9,3) END AS trx_092, CASE WHEN (MS_WKLY_RX_CNT_src.trx_093 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_093))::numeric(9,3) END AS trx_093, CASE WHEN (MS_WKLY_RX_CNT_src.trx_094 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_094))::numeric(9,3) END AS trx_094, CASE WHEN (MS_WKLY_RX_CNT_src.trx_095 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_095))::numeric(9,3) END AS trx_095, CASE WHEN (MS_WKLY_RX_CNT_src.trx_096 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_096))::numeric(9,3) END AS trx_096, CASE WHEN (MS_WKLY_RX_CNT_src.trx_097 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_097))::numeric(9,3) END AS trx_097, CASE WHEN (MS_WKLY_RX_CNT_src.trx_098 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_098))::numeric(9,3) END AS trx_098, CASE WHEN (MS_WKLY_RX_CNT_src.trx_099 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_099))::numeric(9,3) END AS trx_099, CASE WHEN (MS_WKLY_RX_CNT_src.trx_100 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_100))::numeric(9,3) END AS trx_100, CASE WHEN (MS_WKLY_RX_CNT_src.trx_101 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_101))::numeric(9,3) END AS trx_101, CASE WHEN (MS_WKLY_RX_CNT_src.trx_102 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_102))::numeric(9,3) END AS trx_102, CASE WHEN (MS_WKLY_RX_CNT_src.trx_103 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_103))::numeric(9,3) END AS trx_103, CASE WHEN (MS_WKLY_RX_CNT_src.trx_104 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_104))::numeric(9,3) END AS trx_104, CASE WHEN (MS_WKLY_RX_CNT_src.trx_105 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_105))::numeric(9,3) END AS trx_105, CASE WHEN (MS_WKLY_RX_CNT_src.trx_106 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_106))::numeric(9,3) END AS trx_106, CASE WHEN (MS_WKLY_RX_CNT_src.trx_107 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_107))::numeric(9,3) END AS trx_107, CASE WHEN (MS_WKLY_RX_CNT_src.trx_108 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_108))::numeric(9,3) END AS trx_108, CASE WHEN (MS_WKLY_RX_CNT_src.trx_109 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_109))::numeric(9,3) END AS trx_109, CASE WHEN (MS_WKLY_RX_CNT_src.trx_110 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_110))::numeric(9,3) END AS trx_110, CASE WHEN (MS_WKLY_RX_CNT_src.trx_111 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_111))::numeric(9,3) END AS trx_111, CASE WHEN (MS_WKLY_RX_CNT_src.trx_112 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_112))::numeric(9,3) END AS trx_112, CASE WHEN (MS_WKLY_RX_CNT_src.trx_113 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_113))::numeric(9,3) END AS trx_113, CASE WHEN (MS_WKLY_RX_CNT_src.trx_114 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_114))::numeric(9,3) END AS trx_114, CASE WHEN (MS_WKLY_RX_CNT_src.trx_115 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_115))::numeric(9,3) END AS trx_115, CASE WHEN (MS_WKLY_RX_CNT_src.trx_116 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_116))::numeric(9,3) END AS trx_116, CASE WHEN (MS_WKLY_RX_CNT_src.trx_117 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_117))::numeric(9,3) END AS trx_117, CASE WHEN (MS_WKLY_RX_CNT_src.trx_118 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_118))::numeric(9,3) END AS trx_118, CASE WHEN (MS_WKLY_RX_CNT_src.trx_119 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_119))::numeric(9,3) END AS trx_119, CASE WHEN (MS_WKLY_RX_CNT_src.trx_120 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_120))::numeric(9,3) END AS trx_120, CASE WHEN (MS_WKLY_RX_CNT_src.trx_121 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_121))::numeric(9,3) END AS trx_121, CASE WHEN (MS_WKLY_RX_CNT_src.trx_122 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_122))::numeric(9,3) END AS trx_122, CASE WHEN (MS_WKLY_RX_CNT_src.trx_123 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_123))::numeric(9,3) END AS trx_123, CASE WHEN (MS_WKLY_RX_CNT_src.trx_124 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_124))::numeric(9,3) END AS trx_124, CASE WHEN (MS_WKLY_RX_CNT_src.trx_125 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_125))::numeric(9,3) END AS trx_125, CASE WHEN (MS_WKLY_RX_CNT_src.trx_126 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_126))::numeric(9,3) END AS trx_126, CASE WHEN (MS_WKLY_RX_CNT_src.trx_127 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_127))::numeric(9,3) END AS trx_127, CASE WHEN (MS_WKLY_RX_CNT_src.trx_128 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_128))::numeric(9,3) END AS trx_128, CASE WHEN (MS_WKLY_RX_CNT_src.trx_129 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_129))::numeric(9,3) END AS trx_129, CASE WHEN (MS_WKLY_RX_CNT_src.trx_130 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_130))::numeric(9,3) END AS trx_130, CASE WHEN (MS_WKLY_RX_CNT_src.trx_131 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_131))::numeric(9,3) END AS trx_131, CASE WHEN (MS_WKLY_RX_CNT_src.trx_132 = ''::varchar) THEN NULL::numeric(9,3) ELSE (btrim(MS_WKLY_RX_CNT_src.trx_132))::numeric(9,3) END AS trx_132, MS_WKLY_RX_CNT_src.batch_id, MS_WKLY_RX_CNT_src.row_id, MS_WKLY_RX_CNT_src.update_ts FROM teva_ingestion.MS_WKLY_RX_CNT_src;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_FTF_IMS_Monthly_Market_OBM_slow AS
((((SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'WAKE'::varchar(4)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'ICS'::varchar(3)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'SABA'::varchar(4)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'BDP NASAL'::varchar(9)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'ANTI-PARKINSON'::varchar(14)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending) UNION SELECT xref.PLAN_NUM AS "PLAN ID", xref.PLAN_NAME AS "PLAN NAME", xref.PAYER_NUM AS "PAYER ID", xref.PAYER_NAME AS "PAYER NAME", drm.market_name AS "MARKET NAME", drm.product_name AS "PRODUCT NAME", rx.zip AS ZIP, to_char(rx.month_ending, 'YYYY-MM-DD'::varchar(10)) AS DATE, sum(rx.trx_cnt) AS TRx, sum(rx.nrx_cnt) AS NRx FROM WSMP_ADMIN.dw_zip_plan_rx_ims rx, WSMP_ADMIN.TFC_IMS_PLAN_XREF xref, CUSTOMER.dim_product drm WHERE ((rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (xref.PAYER_PLAN_NUM = rx.payer_plan_num) AND (rx.market_name = 'MULTIPLE SCLEROSIS'::varchar(18)) AND (drm.product_code = rx.product_code) AND (drm.market_name = rx.market_name)) GROUP BY xref.PLAN_NUM, xref.PLAN_NAME, xref.PAYER_NUM, xref.PAYER_NAME, drm.market_name, drm.product_name, rx.zip, rx.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_ValueCentricRxDataExtract AS
((SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN 'Nuvigil 50mg'::varchar(12) WHEN (x.product_code = '100N15'::varchar(6)) THEN 'Nuvigil 150mg'::varchar(13) WHEN (x.product_code = '100N25'::varchar(6)) THEN 'Nuvigil 250mg'::varchar(13) WHEN (x.product_code = '100N20'::varchar(6)) THEN 'Nuvigil 200mg'::varchar(13) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN '63459020530'::varchar(11) WHEN (x.product_code = '100N15'::varchar(6)) THEN '63459021530'::varchar(11) WHEN (x.product_code = '100N25'::varchar(6)) THEN '63459022530'::varchar(11) WHEN (x.product_code = '100N20'::varchar(6)) THEN '63459022030'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(x.trx_qty) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TC'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['100N05'::varchar(6), '100N15'::varchar(6), '100N25'::varchar(6), '100N20'::varchar(6)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN 'Nuvigil 50mg'::varchar(12) WHEN (x.product_code = '100N15'::varchar(6)) THEN 'Nuvigil 150mg'::varchar(13) WHEN (x.product_code = '100N25'::varchar(6)) THEN 'Nuvigil 250mg'::varchar(13) WHEN (x.product_code = '100N20'::varchar(6)) THEN 'Nuvigil 200mg'::varchar(13) ELSE NULL END, CASE WHEN (x.product_code = '100N05'::varchar(6)) THEN '63459020530'::varchar(11) WHEN (x.product_code = '100N15'::varchar(6)) THEN '63459021530'::varchar(11) WHEN (x.product_code = '100N25'::varchar(6)) THEN '63459022530'::varchar(11) WHEN (x.product_code = '100N20'::varchar(6)) THEN '63459022030'::varchar(11) ELSE NULL END, d.zip, x.month_ending UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN 'PROAIR HFA'::varchar(10) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN 'PROAIR HFA COUNTER'::varchar(18) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN 'QNASL'::varchar(5) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN 'QVAR 40MCG'::varchar(10) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN 'QVAR 80MCG'::varchar(10) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN '59310057920'::varchar(11) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN '59310057922'::varchar(11) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN '59310021012'::varchar(11) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN '59310020240'::varchar(11) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN '59310020480'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_w x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TR'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['330-14-002'::varchar(10), '330-14-009'::varchar(10), '330-15-001'::varchar(10), '330-13-005'::varchar(10), '330-13-006'::varchar(10)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN 'PROAIR HFA'::varchar(10) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN 'PROAIR HFA COUNTER'::varchar(18) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN 'QNASL'::varchar(5) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN 'QVAR 40MCG'::varchar(10) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN 'QVAR 80MCG'::varchar(10) ELSE NULL END, CASE WHEN (x.product_code = '330-14-002'::varchar(10)) THEN '59310057920'::varchar(11) WHEN (x.product_code = '330-14-009'::varchar(10)) THEN '59310057922'::varchar(11) WHEN (x.product_code = '330-15-001'::varchar(10)) THEN '59310021012'::varchar(11) WHEN (x.product_code = '330-13-005'::varchar(10)) THEN '59310020240'::varchar(11) WHEN (x.product_code = '330-13-006'::varchar(10)) THEN '59310020480'::varchar(11) ELSE NULL END, d.zip, x.month_ending) UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN 'QUARTETTE'::varchar(9) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN '51285043165'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TW'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = '982-23-204'::varchar(10)) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN 'QUARTETTE'::varchar(9) ELSE NULL END, CASE WHEN (x.product_code = '982-23-204'::varchar(10)) THEN '51285043165'::varchar(11) ELSE NULL END, d.zip, x.month_ending) UNION SELECT '4416451422'::varchar(10) AS customerid, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN 'COPAXONE 20mg'::varchar(13) WHEN (x.product_code = '600140'::varchar(6)) THEN 'COPAXONE 40mg'::varchar(13) ELSE NULL END AS brand_name, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN '68546031730'::varchar(11) WHEN (x.product_code = '600140'::varchar(6)) THEN '68546032512'::varchar(11) ELSE NULL END AS ndcupc, d.zip, x.month_ending AS period_end_date, sum(x.trx_cnt) AS trx_cnt, sum(0) AS trx_qty FROM WSMP_ADMIN.dw_presc_plan_rx_m x, (SELECT DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id, min(DEMO_COMBINED.zip) AS zip FROM WSMP_ADMIN.DEMO_COMBINED WHERE (DEMO_COMBINED.sales_force_id = 'TN'::varchar(2)) GROUP BY DEMO_COMBINED.sales_force_id, DEMO_COMBINED.ims_id) d WHERE ((d.ims_id = x.ims_id) AND (x.product_code = ANY (ARRAY['600120'::varchar(6), '600140'::varchar(6)])) AND (x.sales_category = '1'::varchar(2)) AND (x.month_bucket >= 1::numeric(18,0)) AND (x.month_bucket <= 12::numeric(18,0))) GROUP BY '4416451422'::varchar(10), CASE WHEN (x.product_code = '600120'::varchar(6)) THEN 'COPAXONE 20mg'::varchar(13) WHEN (x.product_code = '600140'::varchar(6)) THEN 'COPAXONE 40mg'::varchar(13) ELSE NULL END, CASE WHEN (x.product_code = '600120'::varchar(6)) THEN '68546031730'::varchar(11) WHEN (x.product_code = '600140'::varchar(6)) THEN '68546032512'::varchar(11) ELSE NULL END, d.zip, x.month_ending;

CREATE  VIEW WSMP_ADMIN_ORA.v_veeva_demo AS
SELECT substr(tsf.territory_vod__c, 1, 2) AS sales_force_id, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN 'ACCT'::varchar(4) WHEN ((rta.NAME = 'Professional_vod'::varchar(16)) AND (acc.ID_VOD__C IS NULL) AND (acc.DESIGNATION_TVA__C = ANY (ARRAY['Nurse'::varchar(5), 'Billing Staff'::varchar(13), 'Office Staff'::varchar(12), 'Other Contact'::varchar(13), 'Pharmacist/Pharm D'::varchar(18), 'Practice Manager'::varchar(16), 'Refill Coordinator'::varchar(18), 'Reimbursement Specialist'::varchar(24)]))) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Staff'::varchar(5)) THEN 'CONT'::varchar(4) WHEN (rta.NAME = 'Professional_vod'::varchar(16)) THEN 'PROF'::varchar(4) ELSE 'UNK'::varchar(3) END AS legacy_demo_type, replace(rta.NAME, '_vod'::varchar(4), ''::varchar) AS veeva_account_type, acc.TYPE AS veeva_business_type, acc.ID AS csf_demo_id, acc.CM_ID_TVA__C AS tvcmid, acc.ID_VOD__C AS ims_id, acc.ACCOUNT_MASTER_ID_TVA__C AS hms_id, substr(btrim(acc.ME__C), 1, 10) AS me_num, acc.NPI_VOD__C AS npi, addr.DEA_VOD__C AS dea_num, addr.DEA_EXPIRATION_DATE_VOD__C AS dea_expir_date, addr.DEA_SCHEDULE_VOD__C AS dea_drug_schedule, tsf.territory_vod__c AS territory_num, tsf.territory_status_tva__c AS territory_status, 'N'::varchar(1) AS house_acct_flag, 'A'::varchar(1) AS src_verification_status, CASE WHEN (rta.NAME = ANY (ARRAY['Hospital_vod'::varchar(12), 'Pharmacy_vod'::varchar(12), 'Practice_vod'::varchar(12), 'ParaGard_TVA'::varchar(12)])) THEN substr(acc.NAME, 1, 60) ELSE acc.LASTNAME END AS last_name, acc.FIRSTNAME AS first_name, acc.MIDDLE_VOD__C AS middle_name, acc.SUFFIX_TVA__C AS suffix_name, acc.CREDENTIALS_VOD__C AS credentials, acc.DESIGNATION_TVA__C AS designation, addr.NAME AS address1, addr.ADDRESS_LINE_2_VOD__C AS address2, addr.ADDRESS_LINE_3_TVA__C AS address3, addr.CITY_VOD__C AS city, addr.STATE_VOD__C AS state, addr.ZIP_VOD__C AS zip, acc.PHONE AS phone, CASE WHEN (addr.INACTIVE_VOD__C = 'false'::varchar(5)) THEN 'Active'::varchar(6) ELSE 'Inactive'::varchar(8) END AS address_status, acc.FAX AS fax, acc.CELL_PHONE_TVA__C AS cell_phone, acc.PERSONEMAIL AS email, CASE WHEN (acc.CML_PROFILED_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) WHEN (acc.CML_PROFILED_TVA__C = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS cml_profiled, acc.SPECIALTY_1_VOD__C AS prim_specialty, CASE WHEN (acc.NO_CONTACT_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) WHEN (acc.NO_CONTACT_TVA__C = 'true'::varchar(4)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS no_contact, addr.LICENSE_VOD__C AS state_license_number, addr.STATE_VOD__C AS state_license_state, CASE WHEN (addr.LICENSE_VALID_TO_SAMPLE_VOD__C = 'Valid'::varchar(5)) THEN 'E'::varchar(1) ELSE 'I'::varchar(1) END AS state_license_elig_code, addr.LICENSE_EXPIRATION_DATE_VOD__C AS state_license_expir_date, substr(btrim(CASE WHEN ((btrim(acc.CREDENTIALS_VOD__C) IS NOT NULL) AND (btrim(addr.STATE_VOD__C) IS NOT NULL) AND (btrim(addr.LICENSE_VOD__C) IS NOT NULL)) THEN ((((btrim(acc.CREDENTIALS_VOD__C) || '-'::varchar(1)) || btrim(addr.STATE_VOD__C)) || '-'::varchar(1)) || btrim(addr.LICENSE_VOD__C)) ELSE NULL END), 1, 30) AS state_num, CASE WHEN (acc.NO_SPEND_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS no_spend, acc.DNC_CNS_TVA__C AS nuvigil_dnc, CASE WHEN (acc.NUVIGIL_APP_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS nuvigil_app, acc.DNC_PCS_TVA__C AS fentora_dnc, CASE WHEN (acc.FENTORA_APP_TVA__C = 'false'::varchar(5)) THEN 'N'::varchar(1) ELSE 'Y'::varchar(1) END AS fentora_app, acc.TIRF_REMS_TVA__C AS fentora_rems_status, tsf.last_activity_date_vod__c AS sfa_last_call_date, acc.ID AS veeva_account_id, addr.ID AS veeva_address_id, 'Y'::varchar(1) AS ora_viewable_flag, acc.CREATEDDATE AS sfa_create_date, trunc(tsf.createddate, 'DD'::varchar(2)) AS sfa_align_date, (statement_timestamp())::timestamp AS last_build_date, CASE WHEN (NOT regexp_like(acc.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar)) THEN acc.EXTERNAL_ID_VOD__C ELSE NULL END AS siebel_contact_row_id, CASE WHEN regexp_like(acc.EXTERNAL_ID_VOD__C, '[[:digit:]]{9}'::varchar(14), ''::varchar) THEN acc.EXTERNAL_ID_VOD__C ELSE NULL END AS bp_code, acc.OUTLET_ID_TVA__C AS ims_outlet_code, acc.PMO_GPO_ACCOUNT_AFFILIATIONS AS pmo_gpo_account_affiliations, tsf.synribo_target_tva__c AS onc_synribo_target, tsf.treanda_sbo_tva__c AS onc_treanda_sbo, tsf.trisenox_sbo_tva__c AS onc_trisenox_sbo, CASE WHEN (tsf.territory_vod__c ~~ 'TO%'::varchar(3)) THEN acc.TREANDA_LQ_TGT_TVA__C ELSE NULL END AS onc_treanda_target, acc.BUSINESS_ASSOCIATE_AGREEMENT AS business_associate_agreement, CASE WHEN (tsf.territory_vod__c ~~ 'TO%'::varchar(3)) THEN acc.TBO_FILGRASTIM_TARGET_TVA__C ELSE NULL END AS granix_indicator, acc.ACCOUNT_DEMO_ID_TVA__C AS acct_demo_id FROM (((((WSMP_ADMIN.VV_ACCOUNT acc JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acc.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acc.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN (SELECT x.id, x.isdeleted, x.name, x.recordtypeid, x.createddate, x.createdbyid, x.lastmodifieddate, x.lastmodifiedbyid, x.systemmodstamp, x.mayedit, x.islocked, x.account_vod__c, x.address_vod__c, x.last_activity_date_vod__c, x.my_target_vod__c, x.route_vod__c, x.mobile_id_vod__c, x.external_id_vod__c, x.territory_vod__c, x.ytd_activity_vod__c, x.preferred_account_vod__c, x.allowed_products_vod__c, x.territory_status_tva__c, x.territory_specialty_tva__c, x.treats_es_osa_tva__c, x.osa_patients_tva__c, x.account_status_tva__c, x.dea_number_tva__c, x.synribo_target_tva__c, x.treanda_sbo_tva__c, x.trisenox_sbo_tva__c, x.appt_index_tva__c, x.merged_mvn__c, x.call_plan_designation_tva__c, x.campaign_tva__c, x.rnk FROM (SELECT x.id, x.isdeleted, x.name, x.recordtypeid, x.createddate, x.createdbyid, x.lastmodifieddate, x.lastmodifiedbyid, x.systemmodstamp, x.mayedit, x.islocked, x.account_vod__c, x.address_vod__c, x.last_activity_date_vod__c, x.my_target_vod__c, x.route_vod__c, x.mobile_id_vod__c, x.external_id_vod__c, x.territory_vod__c, x.ytd_activity_vod__c, x.preferred_account_vod__c, x.allowed_products_vod__c, x.territory_status_tva__c, x.territory_specialty_tva__c, x.treats_es_osa_tva__c, x.osa_patients_tva__c, x.account_status_tva__c, x.dea_number_tva__c, x.synribo_target_tva__c, x.treanda_sbo_tva__c, x.trisenox_sbo_tva__c, x.appt_index_tva__c, x.merged_mvn__c, x.call_plan_designation_tva__c, x.campaign_tva__c, row_number() OVER (PARTITION BY x.account_vod__c, x.territory_vod__c ORDER BY x.createddate, x.lastmodifieddate, x.systemmodstamp, x.address_vod__c) AS rnk FROM WSMP_ADMIN.vv_tsf_vod__c x) x WHERE (x.rnk = 1)) tsf ON (((tsf.account_vod__c = acc.ID) AND (tsf.territory_vod__c = g.DEVELOPERNAME)))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acc.ID) AND (tsf.address_vod__c = addr.ID))));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product_terr AS
SELECT bt.TERRITORY_NUM AS territory_num, b.BAG_NAME AS bag_name, bp."POSITION" AS "position", bp.PRODUCT_NAME AS product_name FROM ((WSMP_ADMIN.BAG b JOIN WSMP_ADMIN.BAG_TERRITORY bt ON ((b.BAG_ID = bt.BAG_ID))) JOIN WSMP_ADMIN.BAG_PRODUCT bp ON ((b.BAG_ID = bp.BAG_ID))) WHERE ((b.VALID_FOR_TODAY = 'Y'::varchar(1)) AND (bt.VALID_FOR_TODAY = 'Y'::varchar(1)));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product_mgr AS
SELECT m.territory_num, (m.sales_force_id || 'MGR'::varchar(3)) AS bag_name, row_number() OVER (PARTITION BY m.territory_num ORDER BY p.product_name) AS "position", p.product_name FROM ((SELECT substr(i_bag_territory_product_terr.territory_num, 1, 2) AS sales_force_id, i_bag_territory_product_terr.product_name FROM WSMP_ADMIN.i_bag_territory_product_terr GROUP BY substr(i_bag_territory_product_terr.territory_num, 1, 2), i_bag_territory_product_terr.product_name) p JOIN (SELECT substr(i_bag_territory_product_terr.territory_num, 1, 2) AS sales_force_id, (substr(i_bag_territory_product_terr.territory_num, 1, 6) || '00'::varchar(2)) AS territory_num FROM WSMP_ADMIN.i_bag_territory_product_terr GROUP BY substr(i_bag_territory_product_terr.territory_num, 1, 2), (substr(i_bag_territory_product_terr.territory_num, 1, 6) || '00'::varchar(2))) m ON ((p.sales_force_id = m.sales_force_id)));

CREATE  VIEW WSMP_ADMIN_ORA.i_bag_territory_product AS
SELECT i_bag_territory_product_terr.territory_num, i_bag_territory_product_terr.bag_name, i_bag_territory_product_terr."position", i_bag_territory_product_terr.product_name FROM WSMP_ADMIN.i_bag_territory_product_terr UNION SELECT i_bag_territory_product_mgr.territory_num, i_bag_territory_product_mgr.bag_name, i_bag_territory_product_mgr."position", i_bag_territory_product_mgr.product_name FROM WSMP_ADMIN.i_bag_territory_product_mgr;

CREATE  VIEW metadata.datamart_table_counts AS
SELECT A.datamart_table, A.counts FROM (((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((SELECT 'datamart.activity_hub'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.activity_hub GROUP BY 'datamart.activity_hub'::varchar(21) UNION ALL SELECT 'datamart.affiliations'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.affiliations GROUP BY 'datamart.affiliations'::varchar(21)) UNION ALL SELECT 'datamart.alternate_alignments'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.alternate_alignments GROUP BY 'datamart.alternate_alignments'::varchar(29)) UNION ALL SELECT 'datamart.alternate_call_plans'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.alternate_call_plans GROUP BY 'datamart.alternate_call_plans'::varchar(29)) UNION ALL SELECT 'datamart.call_plan'::varchar(18) AS datamart_table, count(*) AS counts FROM datamart.call_plan GROUP BY 'datamart.call_plan'::varchar(18)) UNION ALL SELECT 'datamart.chargeback_demographics'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.chargeback_demographics GROUP BY 'datamart.chargeback_demographics'::varchar(32)) UNION ALL SELECT 'datamart.chargebacks'::varchar(20) AS datamart_table, count(*) AS counts FROM datamart.chargebacks GROUP BY 'datamart.chargebacks'::varchar(20)) UNION ALL SELECT 'datamart.clozapine_sales'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.clozapine_sales GROUP BY 'datamart.clozapine_sales'::varchar(24)) UNION ALL SELECT 'datamart.cmop_rx'::varchar(16) AS datamart_table, count(*) AS counts FROM datamart.cmop_rx GROUP BY 'datamart.cmop_rx'::varchar(16)) UNION ALL SELECT 'datamart.copay'::varchar(14) AS datamart_table, count(*) AS counts FROM datamart.copay GROUP BY 'datamart.copay'::varchar(14)) UNION ALL SELECT 'datamart.current_alignment'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.current_alignment GROUP BY 'datamart.current_alignment'::varchar(26)) UNION ALL SELECT 'datamart.customer_hco_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.customer_hco_demographics GROUP BY 'datamart.customer_hco_demographics'::varchar(34)) UNION ALL SELECT 'datamart.customer_hcp_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.customer_hcp_demographics GROUP BY 'datamart.customer_hcp_demographics'::varchar(34)) UNION ALL SELECT 'datamart.customer_level_flags'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.customer_level_flags GROUP BY 'datamart.customer_level_flags'::varchar(29)) UNION ALL SELECT 'datamart.ddd'::varchar(12) AS datamart_table, count(*) AS counts FROM datamart.ddd GROUP BY 'datamart.ddd'::varchar(12)) UNION ALL SELECT 'datamart.ddd_md'::varchar(15) AS datamart_table, count(*) AS counts FROM datamart.ddd_md GROUP BY 'datamart.ddd_md'::varchar(15)) UNION ALL SELECT 'datamart.digital_sales_aid_analysis'::varchar(35) AS datamart_table, count(*) AS counts FROM datamart.digital_sales_aid_analysis GROUP BY 'datamart.digital_sales_aid_analysis'::varchar(35)) UNION ALL SELECT 'datamart.direct_sales'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.direct_sales GROUP BY 'datamart.direct_sales'::varchar(21)) UNION ALL SELECT 'datamart.direct_sales_demographics'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.direct_sales_demographics GROUP BY 'datamart.direct_sales_demographics'::varchar(34)) UNION ALL SELECT 'datamart.dnc'::varchar(12) AS datamart_table, count(*) AS counts FROM datamart.dnc GROUP BY 'datamart.dnc'::varchar(12)) UNION ALL SELECT 'datamart.do_not_promote'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.do_not_promote GROUP BY 'datamart.do_not_promote'::varchar(23)) UNION ALL SELECT 'datamart.event'::varchar(14) AS datamart_table, count(*) AS counts FROM datamart.event GROUP BY 'datamart.event'::varchar(14)) UNION ALL SELECT 'datamart.event_attendee'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.event_attendee GROUP BY 'datamart.event_attendee'::varchar(23)) UNION ALL SELECT 'datamart.event_attendee_count'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.event_attendee_count GROUP BY 'datamart.event_attendee_count'::varchar(29)) UNION ALL SELECT 'datamart.event_expense'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.event_expense GROUP BY 'datamart.event_expense'::varchar(22)) UNION ALL SELECT 'datamart.factory_sales_852'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.factory_sales_852 GROUP BY 'datamart.factory_sales_852'::varchar(26)) UNION ALL SELECT 'datamart.formulary'::varchar(18) AS datamart_table, count(*) AS counts FROM datamart.formulary GROUP BY 'datamart.formulary'::varchar(18)) UNION ALL SELECT 'datamart.ic_demographics_semi_annual_frozen_snapshot'::varchar(52) AS datamart_table, count(*) AS counts FROM datamart.ic_demographics_semi_annual_frozen_snapshot GROUP BY 'datamart.ic_demographics_semi_annual_frozen_snapshot'::varchar(52)) UNION ALL SELECT 'datamart.ic_demographics_snapshot'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.ic_demographics_snapshot GROUP BY 'datamart.ic_demographics_snapshot'::varchar(33)) UNION ALL SELECT 'datamart.ims_outlet_master'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.ims_outlet_master GROUP BY 'datamart.ims_outlet_master'::varchar(26)) UNION ALL SELECT 'datamart.leave_of_absence'::varchar(25) AS datamart_table, count(*) AS counts FROM datamart.leave_of_absence GROUP BY 'datamart.leave_of_absence'::varchar(25)) UNION ALL SELECT 'datamart.mm_ram_to_rsm'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.mm_ram_to_rsm GROUP BY 'datamart.mm_ram_to_rsm'::varchar(22)) UNION ALL SELECT 'datamart.oncology_adjusted_sales'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.oncology_adjusted_sales GROUP BY 'datamart.oncology_adjusted_sales'::varchar(32)) UNION ALL SELECT 'datamart.oncology_demographics'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.oncology_demographics GROUP BY 'datamart.oncology_demographics'::varchar(30)) UNION ALL SELECT 'datamart.oncology_fcr'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.oncology_fcr GROUP BY 'datamart.oncology_fcr'::varchar(21)) UNION ALL SELECT 'datamart.oncology_related_accounts'::varchar(34) AS datamart_table, count(*) AS counts FROM datamart.oncology_related_accounts GROUP BY 'datamart.oncology_related_accounts'::varchar(34)) UNION ALL SELECT 'datamart.oncology_sales_adjustments'::varchar(35) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_adjustments GROUP BY 'datamart.oncology_sales_adjustments'::varchar(35)) UNION ALL SELECT 'datamart.oncology_sales_deciles'::varchar(31) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_deciles GROUP BY 'datamart.oncology_sales_deciles'::varchar(31)) UNION ALL SELECT 'datamart.oncology_sales_quotas'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.oncology_sales_quotas GROUP BY 'datamart.oncology_sales_quotas'::varchar(30)) UNION ALL SELECT 'datamart.oncology_target_accounts'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.oncology_target_accounts GROUP BY 'datamart.oncology_target_accounts'::varchar(33)) UNION ALL SELECT 'datamart.plantrak_workbook'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.plantrak_workbook GROUP BY 'datamart.plantrak_workbook'::varchar(26)) UNION ALL SELECT 'datamart.prescriber_combined_demographics'::varchar(41) AS datamart_table, count(*) AS counts FROM datamart.prescriber_combined_demographics GROUP BY 'datamart.prescriber_combined_demographics'::varchar(41)) UNION ALL SELECT 'datamart.prescriber_rx'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.prescriber_rx GROUP BY 'datamart.prescriber_rx'::varchar(22)) UNION ALL SELECT 'datamart.product_basket'::varchar(23) AS datamart_table, count(*) AS counts FROM datamart.product_basket GROUP BY 'datamart.product_basket'::varchar(23)) UNION ALL SELECT 'datamart.rems_pharmacy'::varchar(22) AS datamart_table, count(*) AS counts FROM datamart.rems_pharmacy GROUP BY 'datamart.rems_pharmacy'::varchar(22)) UNION ALL SELECT 'datamart.rems_prescriber'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.rems_prescriber GROUP BY 'datamart.rems_prescriber'::varchar(24)) UNION ALL SELECT 'datamart.roster'::varchar(15) AS datamart_table, count(*) AS counts FROM datamart.roster GROUP BY 'datamart.roster'::varchar(15)) UNION ALL SELECT 'datamart.rx_deciles'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.rx_deciles GROUP BY 'datamart.rx_deciles'::varchar(19)) UNION ALL SELECT 'datamart.sample_shipment'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.sample_shipment GROUP BY 'datamart.sample_shipment'::varchar(24)) UNION ALL SELECT 'datamart.sfa_call'::varchar(17) AS datamart_table, count(*) AS counts FROM datamart.sfa_call GROUP BY 'datamart.sfa_call'::varchar(17)) UNION ALL SELECT 'datamart.sfa_call_detail'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.sfa_call_detail GROUP BY 'datamart.sfa_call_detail'::varchar(24)) UNION ALL SELECT 'datamart.sfa_demographics'::varchar(25) AS datamart_table, count(*) AS counts FROM datamart.sfa_demographics GROUP BY 'datamart.sfa_demographics'::varchar(25)) UNION ALL SELECT 'datamart.sfa_promotional_items'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.sfa_promotional_items GROUP BY 'datamart.sfa_promotional_items'::varchar(30)) UNION ALL SELECT 'datamart.sfa_reprints'::varchar(21) AS datamart_table, count(*) AS counts FROM datamart.sfa_reprints GROUP BY 'datamart.sfa_reprints'::varchar(21)) UNION ALL SELECT 'datamart.sfa_sample'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.sfa_sample GROUP BY 'datamart.sfa_sample'::varchar(19)) UNION ALL SELECT 'datamart.sfa_survey'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.sfa_survey GROUP BY 'datamart.sfa_survey'::varchar(19)) UNION ALL SELECT 'datamart.specialty_pharmacy_enrollment'::varchar(38) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_enrollment GROUP BY 'datamart.specialty_pharmacy_enrollment'::varchar(38)) UNION ALL SELECT 'datamart.specialty_pharmacy_rx'::varchar(30) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_rx GROUP BY 'datamart.specialty_pharmacy_rx'::varchar(30)) UNION ALL SELECT 'datamart.specialty_pharmacy_shipment'::varchar(36) AS datamart_table, count(*) AS counts FROM datamart.specialty_pharmacy_shipment GROUP BY 'datamart.specialty_pharmacy_shipment'::varchar(36)) UNION ALL SELECT 'datamart.territory_history'::varchar(26) AS datamart_table, count(*) AS counts FROM datamart.territory_history GROUP BY 'datamart.territory_history'::varchar(26)) UNION ALL SELECT 'datamart.time_off_territory'::varchar(27) AS datamart_table, count(*) AS counts FROM datamart.time_off_territory GROUP BY 'datamart.time_off_territory'::varchar(27)) UNION ALL SELECT 'datamart.touchpoint_call'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.touchpoint_call GROUP BY 'datamart.touchpoint_call'::varchar(24)) UNION ALL SELECT 'datamart.touchpoint_presentation'::varchar(32) AS datamart_table, count(*) AS counts FROM datamart.touchpoint_presentation GROUP BY 'datamart.touchpoint_presentation'::varchar(32)) UNION ALL SELECT 'datamart.tvcmid_xref'::varchar(20) AS datamart_table, count(*) AS counts FROM datamart.tvcmid_xref GROUP BY 'datamart.tvcmid_xref'::varchar(20)) UNION ALL SELECT 'datamart.tw_account'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.tw_account GROUP BY 'datamart.tw_account'::varchar(19)) UNION ALL SELECT 'datamart.tw_address'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.tw_address GROUP BY 'datamart.tw_address'::varchar(19)) UNION ALL SELECT 'datamart.tw_address_xref'::varchar(24) AS datamart_table, count(*) AS counts FROM datamart.tw_address_xref GROUP BY 'datamart.tw_address_xref'::varchar(24)) UNION ALL SELECT 'datamart.unmatched_caremark_md_id'::varchar(33) AS datamart_table, count(*) AS counts FROM datamart.unmatched_caremark_md_id GROUP BY 'datamart.unmatched_caremark_md_id'::varchar(33)) UNION ALL SELECT 'datamart.veeva_sync'::varchar(19) AS datamart_table, count(*) AS counts FROM datamart.veeva_sync GROUP BY 'datamart.veeva_sync'::varchar(19)) UNION ALL SELECT 'datamart.wholesaler_sales_867'::varchar(29) AS datamart_table, count(*) AS counts FROM datamart.wholesaler_sales_867 GROUP BY 'datamart.wholesaler_sales_867'::varchar(29)) A;

CREATE  VIEW sfa_history.v_siebel_samples_prof AS
SELECT ap.ROW_ID AS sample_id, ea.ROW_ID AS call_id, c.ROW_ID AS siebel_contact_row_id, CASE WHEN (length(c.INTEGRATION_ID) = 18) THEN c.INTEGRATION_ID ELSE NULL END AS veeva_account_id, trunc(ea.APPT_START_DT, 'DD'::varchar(2)) AS call_date, rep_p.X_SALES_FORCE AS sales_force_id, rep_p.NAME AS territory_num, ea.SUBTYPE_CD AS subtype_cd, ea.TODO_CD AS todo_cd, CASE WHEN (ap.RELATION_TYPE_CD = 'Direct Send'::varchar(11)) THEN 'REQUEST'::varchar(7) WHEN (ap.RELATION_TYPE_CD = 'Sample'::varchar(6)) THEN 'DROP'::varchar(4) ELSE 'UNKNOWN'::varchar(7) END AS sample_type, CASE WHEN (p.DESC_TEXT ~~ 'Adipex%'::varchar(7)) THEN 'ADIPEX-P'::varchar(8) WHEN (p.DESC_TEXT ~~ 'Amrix%'::varchar(6)) THEN 'AMRIX'::varchar(5) WHEN (p.DESC_TEXT ~~ 'Azilect%'::varchar(8)) THEN 'AZILECT'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Budesonide%'::varchar(11)) THEN 'BUDESONIDE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'COPAXONE%'::varchar(9)) THEN 'COPAXONE'::varchar(8) WHEN (p.DESC_TEXT ~~ 'ENJUVIA%'::varchar(8)) THEN 'ENJUVIA'::varchar(7) WHEN (p.DESC_TEXT ~~ 'LoSeasonique%'::varchar(13)) THEN 'LOSEASONIQUE'::varchar(12) WHEN (p.DESC_TEXT ~~ 'NIASPAN%'::varchar(8)) THEN 'NIASPAN'::varchar(7) WHEN (p.DESC_TEXT ~~ 'Nuvigil%'::varchar(8)) THEN 'NUVIGIL'::varchar(7) WHEN (p.DESC_TEXT ~~ 'ProAir%'::varchar(7)) THEN 'PROAIR'::varchar(6) WHEN (p.DESC_TEXT ~~ 'Qnasl%'::varchar(6)) THEN 'QNASL'::varchar(5) WHEN (p.DESC_TEXT ~~ 'QVAR%'::varchar(5)) THEN 'QVAR'::varchar(4) WHEN (p.DESC_TEXT ~~ 'Seasonique%'::varchar(11)) THEN 'SEASONIQUE'::varchar(10) WHEN (p.DESC_TEXT ~~ 'Tev-Tropin%'::varchar(11)) THEN 'TEV-TROPIN'::varchar(10) ELSE 'UNKNOWN'::varchar(7) END AS product_name, p.DESC_TEXT AS sample_name, p.PART_NUM AS sample_ndc, ap.QTY AS qty, ea.NAME AS name_on_call, ea.COMMENTS AS address_line_on_call, ea.ZIPCODE AS zip_on_call, d.ims_id, eax.ATTRIB_03 AS dea_num, ea.OWNER_PER_ID AS ownerid, emp.CSN AS employeenumber, ea.CREATED_BY AS created_by, ea.CREATED AS created_date FROM (((((((sfa_history.s_evt_act ea JOIN sfa_history.s_contact c ON ((ea.TARGET_PER_ID = c.ROW_ID))) JOIN sfa_history.s_postn rep_p ON ((ea.OWNER_POSTN_ID = rep_p.ROW_ID))) JOIN sfa_history.s_act_prdint ap ON ((ea.ROW_ID = ap.ACTIVITY_ID))) JOIN sfa_history.s_prod_int p ON ((ap.PRDINT_ID = p.ROW_ID))) LEFT JOIN sfa_history.s_evt_act_x eax ON ((ea.ROW_ID = eax.ROW_ID))) LEFT JOIN sfa_history.s_contact emp ON ((emp.ROW_ID = ea.CREATED_BY))) LEFT JOIN (SELECT iq.ims_id, iq.cm_id, iq.me_num, iq.siebel_contact_row_id, iq.rnk FROM (SELECT DIM_SFA_CSF_DEMO.IMS_ID AS ims_id, DIM_SFA_CSF_DEMO.CM_ID AS cm_id, DIM_SFA_CSF_DEMO.ME_NUM AS me_num, DIM_SFA_CSF_DEMO.SIEBEL_CONTACT_ROW_ID AS siebel_contact_row_id, row_number() OVER (PARTITION BY DIM_SFA_CSF_DEMO.SIEBEL_CONTACT_ROW_ID ORDER BY DIM_SFA_CSF_DEMO.VEEVA_ACCOUNT_ID, DIM_SFA_CSF_DEMO.SALES_FORCE_ID) AS rnk FROM WSMP_ADMIN.DIM_SFA_CSF_DEMO) iq WHERE (iq.rnk = 1)) d ON ((c.ROW_ID = d.siebel_contact_row_id))) WHERE ((rep_p.POSTN_TYPE_CD = ANY (ARRAY['Sales Representative'::varchar(20), 'TSP Test Position'::varchar(17)])) AND (ap.RELATION_TYPE_CD = ANY (ARRAY['Direct Send'::varchar(11), 'Sample'::varchar(6)])) AND (ea.OWNER_POSTN_ID <> '0-5220'::varchar(6)) AND (ea.APPT_START_DT >= '2012-01-01 00:00:00'::timestamp(0)) AND (ea.APPT_START_DT < (statement_timestamp())::timestamp));

CREATE  VIEW outbound.zzz_create_paragard_specialty_rx AS
SELECT sh.source_customer_id AS "BP #", NULL AS "Ortho E", sh.customer_name AS "BP Name", coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1) AS "Ship-to Street", sh.ship_to_city AS "Ship-to City", sh.ship_to_state AS "Ship-to State", sh.ship_to_zip AS "Ship-to ZipCd", NULL AS "Ship-to Ctry", NULL AS "Ship-to Phone", NULL AS "Ship-to Fax", NULL AS "Ship-to Email", ad.address AS "Bill-to Street", ad.city AS "Bill-to City", ad.state AS "Bill-to State", ad.zip_code AS "Bill-to ZipCd", NULL AS "Bill-to Ctry", NULL AS "Bill-to Phone", NULL AS "Bill-to Fax", NULL AS "Bill-to Email", CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END AS "Class of Trade", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS "Invoice #", CASE mod(sh.net_cost, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.net_cost)::int)::varchar ELSE rtrim((sh.net_cost)::varchar, '0'::varchar(1)) END AS "Del Amt", to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)) AS "Inv Date", CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END AS "24237", NULL AS "24238", NULL AS "24800", NULL AS "33223", CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END AS Packs, NULL AS UnitPrice, NULL AS Territory, NULL AS "Order Type Cd", NULL AS "Order Type Desc", NULL AS LOBCdDesc, NULL AS PriceMatrixDef, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9)))) AS ParentBPCd, NULL AS ParentBPCdDesc, NULL AS GrandParentBPCdDesc, NULL AS "PO#", NULL AS "UPS#", CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END AS OrdNbr, NULL AS OrdLnNbr, NULL AS DiscAmt, NULL AS WhseCd, 'ANDA'::varchar(4) AS Data_Source, '51285020401'::varchar(11) AS NDC11_CODE FROM ((datamart.specialty_pharmacy_shipment sh LEFT JOIN (SELECT tw_address.address_id, tw_address.address, tw_address.city, tw_address.state, tw_address.zip_code FROM datamart.tw_address) ad ON ((sh.tw_bill_to_address_id = ad.address_id))) JOIN product.basket b ON ((b.basket_id = sh.basket_id))) WHERE ((b.name = 'PARAGARD'::varchar(8)) AND (b.basket_type = 'product'::varchar(7)) AND (sh.specialty_pharmacy_data_source = 'Anda'::varchar(4))) GROUP BY sh.source_customer_id, NULL, sh.customer_name, coalesce(sh.ship_to_address_line_2, sh.ship_to_address_line_1), sh.ship_to_city, sh.ship_to_state, sh.ship_to_zip, ad.address, ad.city, ad.state, ad.zip_code, CASE mod(sh.customer_type, 1::float) WHEN NULLSEQUAL 0::float THEN sh.customer_type ELSE rtrim(sh.customer_type, '0'::varchar(1)) END, CASE mod(sh.order_no, 1::float) WHEN NULLSEQUAL 0::float THEN (((sh.order_no)::numeric)::int)::varchar ELSE rtrim(sh.order_no, '0'::varchar(1)) END, CASE mod(sh.net_cost, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.net_cost)::int)::varchar ELSE rtrim((sh.net_cost)::varchar, '0'::varchar(1)) END, to_char(sh.invoice_date, 'YYYY-MM-DD'::varchar(10)), CASE mod(sh.quantity, 1::float) WHEN NULLSEQUAL 0::float THEN ((sh.quantity)::int)::varchar ELSE rtrim((sh.quantity)::varchar, '0'::varchar(1)) END, CASE mod(sh.package_size, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN (sh.package_size)::varchar ELSE rtrim((sh.package_size)::varchar, '0'::varchar(1)) END, ('A'::varchar(1) || btrim(to_char(sh.source_parent_customer_id, '000000000'::varchar(9))));

CREATE  VIEW outbound.zzz_asi_rx_by_market_hd AS
SELECT rx.market_name, rx.ims_client_number AS ims_client_num, rx.ims_report_number_cnt AS ims_report_num, rx.ims_zip_other AS zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END AS ims_id, rx.ims_specialty AS specialty, rx.payer_plan_number AS plan_id, btrim(to_char(rx.sales_category, '00'::varchar(2))) AS sales_category, rx.ims_rx_type AS rx_type, CASE WHEN (opn.basket_id IS NOT NULL) THEN opn.outbound_prod_name ELSE btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) END AS ims_product_group_num, NULL AS filler_01, axd.ims_me_num AS me_num, rx.prescriber_last_name AS last_name, rx.prescriber_first_name AS first_name, axd.ims_middle_name AS middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar) AS address, axd.ims_city AS city, axd.ims_state AS state, axd.ims_zip AS zip, coalesce(replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.indication) AS supplemental_data, rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6)) AS data_date, 48 AS bucket_count, sum(CASE WHEN (mth.month_bucket = 1) THEN rx.nrx_count ELSE NULL::float END) AS nrx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN rx.nrx_count ELSE NULL::float END) AS nrx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN rx.nrx_count ELSE NULL::float END) AS nrx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN rx.nrx_count ELSE NULL::float END) AS nrx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN rx.nrx_count ELSE NULL::float END) AS nrx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN rx.nrx_count ELSE NULL::float END) AS nrx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN rx.nrx_count ELSE NULL::float END) AS nrx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN rx.nrx_count ELSE NULL::float END) AS nrx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN rx.nrx_count ELSE NULL::float END) AS nrx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN rx.nrx_count ELSE NULL::float END) AS nrx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN rx.nrx_count ELSE NULL::float END) AS nrx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN rx.nrx_count ELSE NULL::float END) AS nrx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN rx.nrx_count ELSE NULL::float END) AS nrx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN rx.nrx_count ELSE NULL::float END) AS nrx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN rx.nrx_count ELSE NULL::float END) AS nrx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN rx.nrx_count ELSE NULL::float END) AS nrx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN rx.nrx_count ELSE NULL::float END) AS nrx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN rx.nrx_count ELSE NULL::float END) AS nrx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN rx.nrx_count ELSE NULL::float END) AS nrx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN rx.nrx_count ELSE NULL::float END) AS nrx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN rx.nrx_count ELSE NULL::float END) AS nrx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN rx.nrx_count ELSE NULL::float END) AS nrx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN rx.nrx_count ELSE NULL::float END) AS nrx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN rx.nrx_count ELSE NULL::float END) AS nrx_024, sum(CASE WHEN (mth.month_bucket = 1) THEN rx.trx_count ELSE NULL::float END) AS trx_001, sum(CASE WHEN (mth.month_bucket = 2) THEN rx.trx_count ELSE NULL::float END) AS trx_002, sum(CASE WHEN (mth.month_bucket = 3) THEN rx.trx_count ELSE NULL::float END) AS trx_003, sum(CASE WHEN (mth.month_bucket = 4) THEN rx.trx_count ELSE NULL::float END) AS trx_004, sum(CASE WHEN (mth.month_bucket = 5) THEN rx.trx_count ELSE NULL::float END) AS trx_005, sum(CASE WHEN (mth.month_bucket = 6) THEN rx.trx_count ELSE NULL::float END) AS trx_006, sum(CASE WHEN (mth.month_bucket = 7) THEN rx.trx_count ELSE NULL::float END) AS trx_007, sum(CASE WHEN (mth.month_bucket = 8) THEN rx.trx_count ELSE NULL::float END) AS trx_008, sum(CASE WHEN (mth.month_bucket = 9) THEN rx.trx_count ELSE NULL::float END) AS trx_009, sum(CASE WHEN (mth.month_bucket = 10) THEN rx.trx_count ELSE NULL::float END) AS trx_010, sum(CASE WHEN (mth.month_bucket = 11) THEN rx.trx_count ELSE NULL::float END) AS trx_011, sum(CASE WHEN (mth.month_bucket = 12) THEN rx.trx_count ELSE NULL::float END) AS trx_012, sum(CASE WHEN (mth.month_bucket = 13) THEN rx.trx_count ELSE NULL::float END) AS trx_013, sum(CASE WHEN (mth.month_bucket = 14) THEN rx.trx_count ELSE NULL::float END) AS trx_014, sum(CASE WHEN (mth.month_bucket = 15) THEN rx.trx_count ELSE NULL::float END) AS trx_015, sum(CASE WHEN (mth.month_bucket = 16) THEN rx.trx_count ELSE NULL::float END) AS trx_016, sum(CASE WHEN (mth.month_bucket = 17) THEN rx.trx_count ELSE NULL::float END) AS trx_017, sum(CASE WHEN (mth.month_bucket = 18) THEN rx.trx_count ELSE NULL::float END) AS trx_018, sum(CASE WHEN (mth.month_bucket = 19) THEN rx.trx_count ELSE NULL::float END) AS trx_019, sum(CASE WHEN (mth.month_bucket = 20) THEN rx.trx_count ELSE NULL::float END) AS trx_020, sum(CASE WHEN (mth.month_bucket = 21) THEN rx.trx_count ELSE NULL::float END) AS trx_021, sum(CASE WHEN (mth.month_bucket = 22) THEN rx.trx_count ELSE NULL::float END) AS trx_022, sum(CASE WHEN (mth.month_bucket = 23) THEN rx.trx_count ELSE NULL::float END) AS trx_023, sum(CASE WHEN (mth.month_bucket = 24) THEN rx.trx_count ELSE NULL::float END) AS trx_024 FROM (((datamart.prescriber_rx rx JOIN (SELECT ims_week_buckets.month_ending, ims_week_buckets.month_bucket FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_ending, ims_week_buckets.month_bucket) mth ON ((rx.rollup_month = mth.month_ending))) JOIN outbound.asi_xponent_demographics axd ON (((rx.ims_client_number <=> axd.ims_client_number) AND (rx.ims_report_number_cnt <=> axd.ims_report_number) AND (rx.ims_id <=> axd.ims_id) AND (rx.ims_product_group <=> axd.ims_product_group) AND (rx.ims_specialty <=> axd.ims_specialty) AND (rx.ims_zip_other <=> axd.ims_zip_other)))) LEFT JOIN reference.outbound_product_name opn ON (((rx.basket_id = opn.basket_id) AND (opn.transform_name = 'ASI_IMS_OBM'::varchar(11))))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '8'::varchar(1))) GROUP BY rx.market_name, rx.ims_client_number, rx.ims_report_number_cnt, rx.ims_zip_other, CASE WHEN (rx.prescriber_last_name = 'NATIONAL ASSIGNMENT'::varchar(19)) THEN NULL ELSE rx.ims_id END, rx.ims_specialty, axd.ims_me_num, rx.payer_plan_number, btrim(to_char(rx.sales_category, '00'::varchar(2))), rx.ims_rx_type, CASE WHEN (opn.basket_id IS NOT NULL) THEN opn.outbound_prod_name ELSE btrim(to_char(rx.ims_product_group, '000000000'::varchar(9))) END, rx.prescriber_last_name, rx.prescriber_first_name, axd.ims_middle_name, replace(axd.ims_address, ','::varchar(1), ''::varchar), axd.ims_city, axd.ims_state, axd.ims_zip, coalesce(replace(rx.ims_supplemental_data, ','::varchar(1), ''::varchar), rx.indication), rx.plan_name, to_char(last_day(rx.data_date), 'MMDDYY'::varchar(6));

CREATE  VIEW outbound.zzz_asi_market_access_hd AS
SELECT coalesce(chd.zip, o.zip, pcd.ptr_zip) AS zip, coalesce(chd.state_code, o.state, pcd.ptr_state, csz.state) AS state, rx.payer_plan_number AS payer_plan_num, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END AS report_num, coalesce(CASE WHEN (rx.indication IS NOT NULL) THEN b.teva_product_code ELSE rx.ims_product_group END, rx.ims_product_group) AS ims_product_group_num, to_char(rx.data_date, 'MM/YYYY'::varchar(7)) AS data_month, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.nrx_count ELSE 0::float END) AS nrx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.nrx_count ELSE 0::float END) AS nrx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.nrx_count ELSE 0::float END) AS nrx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.nrx_count ELSE 0::float END) AS nrx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.nrx_count ELSE 0::float END) AS nrx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.nrx_count ELSE 0::float END) AS nrx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.nrx_count ELSE 0::float END) AS nrx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.nrx_count ELSE 0::float END) AS nrx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.nrx_count ELSE 0::float END) AS nrx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.nrx_count ELSE 0::float END) AS nrx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.nrx_count ELSE 0::float END) AS nrx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.nrx_count ELSE 0::float END) AS nrx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.nrx_count ELSE 0::float END) AS nrx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.nrx_count ELSE 0::float END) AS nrx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.nrx_count ELSE 0::float END) AS nrx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.nrx_count ELSE 0::float END) AS nrx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.nrx_count ELSE 0::float END) AS nrx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.nrx_count ELSE 0::float END) AS nrx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.nrx_count ELSE 0::float END) AS nrx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.nrx_count ELSE 0::float END) AS nrx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.nrx_count ELSE 0::float END) AS nrx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.nrx_count ELSE 0::float END) AS nrx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.nrx_count ELSE 0::float END) AS nrx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.nrx_count ELSE 0::float END) AS nrx_024, sum(CASE WHEN (iwb.month_bucket = 1) THEN rx.trx_count ELSE 0::float END) AS trx_001, sum(CASE WHEN (iwb.month_bucket = 2) THEN rx.trx_count ELSE 0::float END) AS trx_002, sum(CASE WHEN (iwb.month_bucket = 3) THEN rx.trx_count ELSE 0::float END) AS trx_003, sum(CASE WHEN (iwb.month_bucket = 4) THEN rx.trx_count ELSE 0::float END) AS trx_004, sum(CASE WHEN (iwb.month_bucket = 5) THEN rx.trx_count ELSE 0::float END) AS trx_005, sum(CASE WHEN (iwb.month_bucket = 6) THEN rx.trx_count ELSE 0::float END) AS trx_006, sum(CASE WHEN (iwb.month_bucket = 7) THEN rx.trx_count ELSE 0::float END) AS trx_007, sum(CASE WHEN (iwb.month_bucket = 8) THEN rx.trx_count ELSE 0::float END) AS trx_008, sum(CASE WHEN (iwb.month_bucket = 9) THEN rx.trx_count ELSE 0::float END) AS trx_009, sum(CASE WHEN (iwb.month_bucket = 10) THEN rx.trx_count ELSE 0::float END) AS trx_010, sum(CASE WHEN (iwb.month_bucket = 11) THEN rx.trx_count ELSE 0::float END) AS trx_011, sum(CASE WHEN (iwb.month_bucket = 12) THEN rx.trx_count ELSE 0::float END) AS trx_012, sum(CASE WHEN (iwb.month_bucket = 13) THEN rx.trx_count ELSE 0::float END) AS trx_013, sum(CASE WHEN (iwb.month_bucket = 14) THEN rx.trx_count ELSE 0::float END) AS trx_014, sum(CASE WHEN (iwb.month_bucket = 15) THEN rx.trx_count ELSE 0::float END) AS trx_015, sum(CASE WHEN (iwb.month_bucket = 16) THEN rx.trx_count ELSE 0::float END) AS trx_016, sum(CASE WHEN (iwb.month_bucket = 17) THEN rx.trx_count ELSE 0::float END) AS trx_017, sum(CASE WHEN (iwb.month_bucket = 18) THEN rx.trx_count ELSE 0::float END) AS trx_018, sum(CASE WHEN (iwb.month_bucket = 19) THEN rx.trx_count ELSE 0::float END) AS trx_019, sum(CASE WHEN (iwb.month_bucket = 20) THEN rx.trx_count ELSE 0::float END) AS trx_020, sum(CASE WHEN (iwb.month_bucket = 21) THEN rx.trx_count ELSE 0::float END) AS trx_021, sum(CASE WHEN (iwb.month_bucket = 22) THEN rx.trx_count ELSE 0::float END) AS trx_022, sum(CASE WHEN (iwb.month_bucket = 23) THEN rx.trx_count ELSE 0::float END) AS trx_023, sum(CASE WHEN (iwb.month_bucket = 24) THEN rx.trx_count ELSE 0::float END) AS trx_024 FROM (((((((datamart.prescriber_rx rx JOIN product.basket b ON ((rx.basket_id = b.basket_id))) JOIN (SELECT ims_week_buckets.month_bucket, ims_week_buckets.month_ending FROM integration.ims_week_buckets GROUP BY ims_week_buckets.month_bucket, ims_week_buckets.month_ending) iwb ON ((rx.rollup_month = iwb.month_ending))) LEFT JOIN reference.outbound_product_name opn ON (((rx.basket_id = opn.basket_id) AND (opn.transform_name = 'ASI_MKT_ACCESS_OBM'::varchar(18))))) LEFT JOIN datamart.customer_hcp_demographics chd ON ((rx.ims_id = chd.ims_id))) LEFT JOIN (SELECT hco_demo.tvcmid, hco_demo.state_code AS state, hco_demo.zip FROM datamart.customer_hco_demographics hco_demo) o ON ((rx.tvcmid = o.tvcmid))) LEFT JOIN (SELECT rnk.ims_id, rnk.ptr_state, rnk.ptr_zip FROM (SELECT DISTINCT prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source) AS rnk FROM datamart.prescriber_combined_demographics ORDER BY prescriber_combined_demographics.ims_id, prescriber_combined_demographics.ptr_state, prescriber_combined_demographics.ptr_zip, prescriber_combined_demographics.ptr_address_source, row_number() OVER (PARTITION BY prescriber_combined_demographics.ims_id ORDER BY prescriber_combined_demographics.ptr_address_source)) rnk WHERE (rnk.rnk = 1)) pcd ON ((pcd.ims_id = rx.ims_id))) LEFT JOIN reference.city_state_zip csz ON ((coalesce(chd.zip, o.zip, pcd.ptr_zip) = csz.zip))) WHERE ((rx.basket_type = 'product'::varchar(7)) AND (rx.ims_client_number = '632'::varchar(3)) AND (rx.ims_report_number_cnt = '8'::varchar(1))) GROUP BY coalesce(chd.zip, o.zip, pcd.ptr_zip), coalesce(chd.state_code, o.state, pcd.ptr_state, csz.state), rx.payer_plan_number, CASE WHEN (length(rx.ims_report_number_cnt) = 1) THEN btrim(to_char(rx.ims_report_number_cnt, '00'::varchar(2))) ELSE rx.ims_report_number_cnt END, coalesce(CASE WHEN (rx.indication IS NOT NULL) THEN b.teva_product_code ELSE rx.ims_product_group END, rx.ims_product_group), to_char(rx.data_date, 'MM/YYYY'::varchar(7));

CREATE  VIEW outbound.zzz_asi_market_access_hd_tot AS
SELECT asi_market_access_hd.report_num, asi_market_access_hd.ims_product_group_num AS product_num, asi_market_access_hd.data_month, sum(asi_market_access_hd.nrx_001) AS total_nrx_01, sum(asi_market_access_hd.nrx_002) AS total_nrx_02, sum(asi_market_access_hd.nrx_003) AS total_nrx_03, sum(asi_market_access_hd.nrx_004) AS total_nrx_04, sum(asi_market_access_hd.nrx_005) AS total_nrx_05, sum(asi_market_access_hd.nrx_006) AS total_nrx_06, sum(asi_market_access_hd.nrx_007) AS total_nrx_07, sum(asi_market_access_hd.nrx_008) AS total_nrx_08, sum(asi_market_access_hd.nrx_009) AS total_nrx_09, sum(asi_market_access_hd.nrx_010) AS total_nrx_10, sum(asi_market_access_hd.nrx_011) AS total_nrx_11, sum(asi_market_access_hd.nrx_012) AS total_nrx_12, sum(asi_market_access_hd.nrx_013) AS total_nrx_13, sum(asi_market_access_hd.nrx_014) AS total_nrx_14, sum(asi_market_access_hd.nrx_015) AS total_nrx_15, sum(asi_market_access_hd.nrx_016) AS total_nrx_16, sum(asi_market_access_hd.nrx_017) AS total_nrx_17, sum(asi_market_access_hd.nrx_018) AS total_nrx_18, sum(asi_market_access_hd.nrx_019) AS total_nrx_19, sum(asi_market_access_hd.nrx_020) AS total_nrx_20, sum(asi_market_access_hd.nrx_021) AS total_nrx_21, sum(asi_market_access_hd.nrx_022) AS total_nrx_22, sum(asi_market_access_hd.nrx_023) AS total_nrx_23, sum(asi_market_access_hd.nrx_024) AS total_nrx_24, sum(asi_market_access_hd.trx_001) AS total_trx_01, sum(asi_market_access_hd.trx_002) AS total_trx_02, sum(asi_market_access_hd.trx_003) AS total_trx_03, sum(asi_market_access_hd.trx_004) AS total_trx_04, sum(asi_market_access_hd.trx_005) AS total_trx_05, sum(asi_market_access_hd.trx_006) AS total_trx_06, sum(asi_market_access_hd.trx_007) AS total_trx_07, sum(asi_market_access_hd.trx_008) AS total_trx_08, sum(asi_market_access_hd.trx_009) AS total_trx_09, sum(asi_market_access_hd.trx_010) AS total_trx_10, sum(asi_market_access_hd.trx_011) AS total_trx_11, sum(asi_market_access_hd.trx_012) AS total_trx_12, sum(asi_market_access_hd.trx_013) AS total_trx_13, sum(asi_market_access_hd.trx_014) AS total_trx_14, sum(asi_market_access_hd.trx_015) AS total_trx_15, sum(asi_market_access_hd.trx_016) AS total_trx_16, sum(asi_market_access_hd.trx_017) AS total_trx_17, sum(asi_market_access_hd.trx_018) AS total_trx_18, sum(asi_market_access_hd.trx_019) AS total_trx_19, sum(asi_market_access_hd.trx_020) AS total_trx_20, sum(asi_market_access_hd.trx_021) AS total_trx_21, sum(asi_market_access_hd.trx_022) AS total_trx_22, sum(asi_market_access_hd.trx_023) AS total_trx_23, sum(asi_market_access_hd.trx_024) AS total_trx_24 FROM outbound.asi_market_access_hd GROUP BY asi_market_access_hd.report_num, asi_market_access_hd.ims_product_group_num, asi_market_access_hd.data_month;

CREATE  VIEW outbound.zzz_zs_access_monito_calls_by_specialty_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_call_data_cns AS
SELECT 'TEVA'::varchar(4) AS company, d.sales_force_id AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, cp.plan_calls AS total_calls, to_char(m.m04, 'yyyymm'::varchar(6)) AS start_month, to_char(m.m01, 'yyyymm'::varchar(6)) AS end_month, '4'::varchar(1) AS duration, CASE WHEN (cp.tvcmid IS NULL) THEN '0'::varchar(1) ELSE '1'::varchar(1) END AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TN'::varchar(2), 'TP'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_call_data_oncology AS
SELECT 'TEVA'::varchar(4) AS company, 'TO'::varchar(2) AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, NULL AS total_calls, NULL AS start_month, NULL AS end_month, '4'::varchar(1) AS duration, '1'::varchar(1) AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.period = zs.semester)))) WHERE (cp.sales_force_id = 'TO'::varchar(2)) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = 'TO'::varchar(2)) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM (datamart.call_plan cp JOIN outbound.zs_monitor_sales_force_product zs ON (((cp.sales_force_id = zs.sales_force_id) AND (cp.period = zs.semester)))) WHERE (cp.sales_force_id = 'TO'::varchar(2)) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_call_data_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, d.sales_force_id AS sales_force, coalesce(c.territory_num, cp.territory_num) AS TERRITORY_NUM, NULL AS me_num, d.npi, d.VEEVA_ACCOUNT_ID AS veeva_account_id, d.tvcmid, d.ims_id, to_char(m.m01, 'yyyymm'::varchar(6)) AS month1, c.p1_calls_mth1, c.p1_calls_mth2, c.p1_calls_mth3, c.p1_calls_mth4, c.p1_calls_mth5, c.p1_calls_mth6, cp.plan_calls AS total_calls, to_char(m.m04, 'yyyymm'::varchar(6)) AS start_month, to_char(m.m01, 'yyyymm'::varchar(6)) AS end_month, '4'::varchar(1) AS duration, CASE WHEN (cp.tvcmid IS NULL) THEN '0'::varchar(1) ELSE '1'::varchar(1) END AS physician_value, d.ZIP AS physician_zip, x.specialty_code AS physician_specialty FROM ((((((SELECT calls.tvcmid, calls.territory_num FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) calls UNION SELECT call_plan.tvcmid, call_plan.territory_num FROM (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) call_plan) u JOIN (SELECT sfa_demographics.veeva_account_id AS VEEVA_ACCOUNT_ID, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE ((sfa_demographics.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (sfa_demographics.ims_id IS NOT NULL)) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.sales_force_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d ON (((u.tvcmid = d.tvcmid) AND (u.territory_num = d.territory_num)))) JOIN (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m ON (true)) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) LEFT JOIN (SELECT c.tvcmid, c.territory_num, c.rep_id, sum(CASE WHEN (c.call_date = m.m01) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth1, sum(CASE WHEN (c.call_date = m.m02) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth2, sum(CASE WHEN (c.call_date = m.m03) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth3, sum(CASE WHEN (c.call_date = m.m04) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth4, sum(CASE WHEN (c.call_date = m.m05) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth5, sum(CASE WHEN (c.call_date = m.m06) THEN c.pri_calls ELSE 0 END) AS p1_calls_mth6 FROM (SELECT c.tvcmid, c.territory_number AS territory_num, c.rep_id, trunc(c.call_date, 'MON'::varchar(3)) AS call_date, sum(1) AS pri_calls FROM datamart.sfa_call c, datamart.sfa_call_detail d, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.call_id = d.call_id) AND (c.sales_force_id = d.sales_force_id) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.customer_type = 'Professional'::varchar(12)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01)) AND (d.detail_position = 1)) GROUP BY c.tvcmid, c.territory_number, c.rep_id, trunc(c.call_date, 'MON'::varchar(3))) c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m GROUP BY c.tvcmid, c.territory_num, c.rep_id) c ON (((u.tvcmid = c.tvcmid) AND (u.territory_num = c.territory_num)))) LEFT JOIN (SELECT cp.tvcmid, cp.territory_number AS territory_num, sum(cp.p1) AS plan_calls FROM datamart.call_plan cp WHERE (cp.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) GROUP BY cp.tvcmid, cp.territory_number) cp ON (((u.tvcmid = cp.tvcmid) AND (u.territory_num = cp.territory_num))));

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_oncology AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = 'TO'::varchar(2)) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_access_monitor_calls_by_specialty_respiratory AS
SELECT 'TEVA'::varchar(4) AS company, x.specialty_code, d.prim_specialty, count(DISTINCT c.tvcmid) AS number_of_physicians_6mth FROM (((SELECT sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number AS territory_num, sfa_demographics.prim_specialty, sfa_demographics.zip AS ZIP FROM datamart.sfa_demographics WHERE (sfa_demographics.ims_id IS NOT NULL) GROUP BY sfa_demographics.veeva_account_id, sfa_demographics.ims_id, sfa_demographics.npi, sfa_demographics.tvcmid, sfa_demographics.territory_number, sfa_demographics.prim_specialty, sfa_demographics.zip) d JOIN (SELECT c.tvcmid FROM datamart.sfa_call c, (SELECT trunc(add_months((statement_timestamp())::timestamp, (-1)), 'MON'::varchar(3)) AS m01, trunc(add_months((statement_timestamp())::timestamp, (-2)), 'MON'::varchar(3)) AS m02, trunc(add_months((statement_timestamp())::timestamp, (-3)), 'MON'::varchar(3)) AS m03, trunc(add_months((statement_timestamp())::timestamp, (-4)), 'MON'::varchar(3)) AS m04, trunc(add_months((statement_timestamp())::timestamp, (-5)), 'MON'::varchar(3)) AS m05, trunc(add_months((statement_timestamp())::timestamp, (-6)), 'MON'::varchar(3)) AS m06, trunc(add_months((statement_timestamp())::timestamp, (-7)), 'MON'::varchar(3)) AS m07, trunc(add_months((statement_timestamp())::timestamp, (-8)), 'MON'::varchar(3)) AS m08, trunc(add_months((statement_timestamp())::timestamp, (-9)), 'MON'::varchar(3)) AS m09, trunc(add_months((statement_timestamp())::timestamp, (-10)), 'MON'::varchar(3)) AS m10, trunc(add_months((statement_timestamp())::timestamp, (-11)), 'MON'::varchar(3)) AS m11, trunc(add_months((statement_timestamp())::timestamp, (-12)), 'MON'::varchar(3)) AS m12 FROM v_catalog.dual) m WHERE ((c.customer_type = 'Professional'::varchar(12)) AND (c.sales_force_id = ANY (ARRAY['TS'::varchar(2), 'TR'::varchar(2)])) AND (c.call_date >= m.m06) AND (c.call_date <= last_day(m.m01))) GROUP BY c.tvcmid) c ON ((d.tvcmid = c.tvcmid))) LEFT JOIN reference.sfa_specialty_xref x ON ((d.prim_specialty = x.specialty_desc))) GROUP BY d.prim_specialty, x.specialty_code ORDER BY x.specialty_code;

CREATE  VIEW outbound.zs_xpd_switch_details AS
SELECT xpd_switch_details.ims_client_number, xpd_switch_details.ims_report_number, xpd_switch_details.channel_indicator, xpd_switch_details.ims_id, xpd_switch_details.tvcmid, xpd_switch_details.specialty, xpd_switch_details.switch_from_product_group_num, xpd_switch_details.switch_from_basket_id, xpd_switch_details.switch_from_basket_name, xpd_switch_details.switch_to_product_group_num, xpd_switch_details.switch_to_basket_id, xpd_switch_details.switch_to_basket_name, xpd_switch_details.rollup_month, xpd_switch_details.rx FROM datamart.xpd_switch_details;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_cmop_product AS
SELECT v.VA_PRODUCT AS va_product, v.WK_PROD_CODE AS prod_code, upper(v.CEPH_PROD_DESC) AS prod_name, coalesce(p.brand_code, v.WK_PROD_CODE) AS brand_code, coalesce(p.brand_name, upper(v.CEPH_PROD_DESC)) AS brand_name, coalesce(p.market_code, v.WK_PROD_CODE) AS market_code, CASE WHEN (v.WK_PROD_CODE = 'TR0900'::varchar(6)) THEN 'RESPIRATORY'::varchar(11) ELSE CASE WHEN (v.WK_PROD_CODE = 'TW0900'::varchar(6)) THEN 'WOMENS HEALTH'::varchar(13) ELSE p.market_name END END AS market_name FROM (CUSTOMER.DIM_VA_PRODUCT_XREF v LEFT JOIN CUSTOMER.dim_product p ON ((v.WK_PROD_CODE = p.product_code))) WHERE (v.WK_PROD_CODE <> ALL (ARRAY['200102'::varchar(6), '200104'::varchar(6), '200112'::varchar(6), '200116'::varchar(6), 'V00100'::varchar(6)]));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_mm_ram_to_rsm AS
SELECT x.MM_RAM, x.RSM FROM (SELECT a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2)) AS RSM FROM (teva_ingestion.EXT_MM_RAM_TO_STATE a JOIN WSMP_ADMIN.KC_ZIP_TO_TERRITORY b ON ((a.STATE = b.STATE))) WHERE ((substr(b.TERRITORY_NUM, 5, 2) <> 'ZZ'::varchar(2)) AND (b.TERRITORY_NAME IS NOT NULL)) GROUP BY a.MM_RAM, (substr(b.TERRITORY_NUM, 1, 6) || '00'::varchar(2))) x;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_create_rems_account_backup AS
SELECT stg.ASI_ACCOUNT_ID AS HCP_ID, align.TERRITORY_NUM AS territory_num, stg.SITE_NAME AS ACCOUNT_NAME, stg.ADDRESS_1 AS ADDRESS1, stg.ADDRESS_2 AS ADDRESS2, NULL AS ADDRESS3, stg.CITY, stg.STATE, stg.ZIP_CODE AS ZIP, 'Y'::varchar(1) AS PRIMARY_ADDRESS, stg.PHONE_NUMBER, fact.IMS_ORG_ID AS EXTERNAL_ID, 'HOSPITAL'::varchar(8) AS CUSTOMER_TYPE, NULL AS BPNUMBER, NULL AS SUBTYPE FROM ((WSMP_ADMIN.STG_REMS_FACILITY stg LEFT JOIN (SELECT ext_kc_zip_to_territory.ZIP, ext_kc_zip_to_territory.CITY, ext_kc_zip_to_territory.STATE, ext_kc_zip_to_territory.TERRITORY_NUM, ext_kc_zip_to_territory.TERRITORY_NAME, ext_kc_zip_to_territory.AREA_NAME, ext_kc_zip_to_territory.REGION_NAME, ext_kc_zip_to_territory.SALES_FORCE_ID, ext_kc_zip_to_territory.ORGANIZATION_CODE, ext_kc_zip_to_territory.INACTIVE_FLAG, ext_kc_zip_to_territory.COMMENTS, ext_kc_zip_to_territory.MIRROR_FLAG, ext_kc_zip_to_territory.MIRROR_TERRITORY_NUM, ext_kc_zip_to_territory.batch_id, ext_kc_zip_to_territory.row_id, ext_kc_zip_to_territory.update_ts FROM teva_ingestion.ext_kc_zip_to_territory WHERE (ext_kc_zip_to_territory.SALES_FORCE_ID = 'TB'::varchar(2))) align ON ((substr(stg.ZIP_CODE, 1, 5) = align.ZIP))) LEFT JOIN WSMP_ADMIN.HCOS_IDENTIFIER_FACT fact ON (((fact.IDENTIFIER_ID = 15::numeric(18,0)) AND (fact.IDENTIFIER = stg.NPI)))) WHERE (stg.VEEVA_ACCOUNT_ID IS NULL);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Fentora_Market AS
SELECT rx.payer_plan_num AS plan_num, rx.product_code, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt24, sum(CASE rx.month_bucket WHEN 24::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt24, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt23, sum(CASE rx.month_bucket WHEN 23::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt23, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt22, sum(CASE rx.month_bucket WHEN 22::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt22, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt21, sum(CASE rx.month_bucket WHEN 21::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt21, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt20, sum(CASE rx.month_bucket WHEN 20::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt20, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt19, sum(CASE rx.month_bucket WHEN 19::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt19, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt18, sum(CASE rx.month_bucket WHEN 18::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt18, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt17, sum(CASE rx.month_bucket WHEN 17::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt17, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt16, sum(CASE rx.month_bucket WHEN 16::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt16, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt15, sum(CASE rx.month_bucket WHEN 15::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt15, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt14, sum(CASE rx.month_bucket WHEN 14::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt14, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt13, sum(CASE rx.month_bucket WHEN 13::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt13, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt12, sum(CASE rx.month_bucket WHEN 12::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt12, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt11, sum(CASE rx.month_bucket WHEN 11::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt11, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt10, sum(CASE rx.month_bucket WHEN 10::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt10, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt9, sum(CASE rx.month_bucket WHEN 9::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt9, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt8, sum(CASE rx.month_bucket WHEN 8::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt8, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt7, sum(CASE rx.month_bucket WHEN 7::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt7, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt6, sum(CASE rx.month_bucket WHEN 6::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt6, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt5, sum(CASE rx.month_bucket WHEN 5::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt5, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt4, sum(CASE rx.month_bucket WHEN 4::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt4, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt3, sum(CASE rx.month_bucket WHEN 3::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt3, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt2, sum(CASE rx.month_bucket WHEN 2::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt2, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.trx_cnt ELSE 0::numeric(18,0) END) AS trx_cnt1, sum(CASE rx.month_bucket WHEN 1::numeric(18,0) THEN rx.nrx_cnt ELSE 0::numeric(18,0) END) AS nrx_cnt1 FROM WSMP_ADMIN.dw_presc_plan_rx_m rx, CUSTOMER.dim_product p WHERE ((rx.product_code = ANY (ARRAY['300500'::varchar(6), '300100'::varchar(6), '300180'::varchar(6), '300170'::varchar(6), '300130'::varchar(6), '300140'::varchar(6), '300110'::varchar(6)])) AND (rx.month_bucket >= 1::numeric(18,0)) AND (rx.month_bucket <= 24::numeric(18,0)) AND (rx.product_code = p.product_code)) GROUP BY rx.payer_plan_num, rx.product_code;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_roster AS
SELECT r.TERRITORY_NUM AS territory_num, r.LAST_NAME AS last_name, r.FIRST_NAME AS first_name, r.SHIP_ADDRESS_LINE1 AS ship_address_line1, r.SHIP_ADDRESS_LINE2 AS ship_address_line2, r.SHIP_CITY AS ship_city, r.SHIP_STATE AS ship_state, r.SHIP_ZIP AS ship_zip, coalesce(r.BUSINESS_PHONE, r.CELL_PHONE, r.HOME_PHONE) AS phone, r.EMAIL AS email, CASE WHEN (r.REP_TYPE = 'REP'::varchar(3)) THEN p.m_territory_num WHEN (r.REP_TYPE = 'RM'::varchar(2)) THEN r.TERRITORY_NUM ELSE NULL END AS district, CASE WHEN (r.REP_TYPE = 'REP'::varchar(3)) THEN p.d_territory_num WHEN (r.REP_TYPE = 'RM'::varchar(2)) THEN r.PARENT_TERRITORY_NUM WHEN (r.REP_TYPE = 'AD'::varchar(2)) THEN r.TERRITORY_NUM ELSE NULL END AS region FROM (WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA r LEFT JOIN WSMP_ADMIN.v_roster_teva_rep_mgr_dir p ON (((r.TERRITORY_NUM = p.rep_territory_num) AND (r.EMPLOYEE_ID = p.rep_emp_id)))) WHERE ((r.SALES_FORCE_ID = ANY (ARRAY['TO'::varchar(2), 'TN'::varchar(2)])) AND (r.LAST_NAME <> 'Vacant'::varchar(6)) AND (r.REP_TYPE = ANY (ARRAY['REP'::varchar(3), 'RM'::varchar(2), 'AD'::varchar(2)])));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tw AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TW'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TW'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tr AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TR'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TR'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tc_tn_tp AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = ANY (ARRAY['TC'::varchar(2), 'TN'::varchar(2), 'TP'::varchar(2)]))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_sharepoint_tb AS
((SELECT lower(dim_csf_sales_roster_teva.USERNAME) AS title, dim_csf_sales_roster_teva.TERRITORY_NUM AS territory FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.USERNAME IS NOT NULL) AND (dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TB'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.d_username) AS title, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) AS territory FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.d_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.m_territory_num, 1, 6) || '_I'::varchar(2))) UNION SELECT lower(v_roster_teva_rep_mgr_dir.h_username) AS lower, (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2)) FROM WSMP_ADMIN.v_roster_teva_rep_mgr_dir WHERE ((v_roster_teva_rep_mgr_dir.rep_username IS NOT NULL) AND (v_roster_teva_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) GROUP BY lower(v_roster_teva_rep_mgr_dir.h_username), (substr(v_roster_teva_rep_mgr_dir.d_territory_num, 1, 6) || '_I'::varchar(2));

CREATE  VIEW WSMP_ADMIN_ORA.stg_ims_npi AS
SELECT y.ims_id, y.npi FROM (SELECT x.ims_id, x.npi, row_number() OVER (PARTITION BY x.ims_id ORDER BY x.rnk, x.npi) AS rnk FROM (SELECT x1.ID_NUM AS ims_id, x2.ID_NUM AS npi, 1 AS rnk FROM (teva_ingestion.tvcmid_xref x1 JOIN teva_ingestion.tvcmid_xref x2 ON ((x1.TVCMID = x2.TVCMID))) WHERE ((x1.ID_TYPE = 'IMS_ID'::varchar(6)) AND (x2.ID_TYPE = 'NPI'::varchar(3))) UNION SELECT hcos_professional.IMS_ID AS ims_id, hcos_professional.NPI AS npi, 2 AS rnk FROM WSMP_ADMIN.HCOS_PROFESSIONAL WHERE ((hcos_professional.IMS_ID IS NOT NULL) AND (hcos_professional.NPI IS NOT NULL))) x) y WHERE (y.rnk = 1);

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_do_not_promote_with_veevaid AS
(((SELECT d.SALES_FORCE_ID AS sales_force_id, acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, d.PRODUCT_NAME AS product_name, d.SPECIALTY_GROUP AS specialty_group, 'N'::varchar(1) AS app, CASE WHEN (d.DEBARRED = 'Y'::varchar(1)) THEN 'Y'::varchar(1) ELSE 'N'::varchar(1) END AS DNP FROM (((WSMP_ADMIN.DIM_DNC d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (d.SALES_FORCE_ID = sln.sales_force_id)))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) UNION SELECT 'TC'::varchar(2), acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7), d.SPECIALTY_PRIMARY_CODE AS specialty_primary_code, 'N'::varchar(1) AS APP, 'Y'::varchar(1) AS DNP FROM (((WSMP_ADMIN.DEBARRED d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (sln.sales_force_id = 'TC'::varchar(2))))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) WHERE (d.CURRENT_IND = 'Y'::varchar(1)) GROUP BY 'TC'::varchar(2), acct.ID, sln.state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7), d.SPECIALTY_PRIMARY_CODE, 'N'::varchar(1), 'Y'::varchar(1)) UNION SELECT 'TP'::varchar(2), acct.ID AS veeva_id, sln.state_license_number, dea.dea_num, 'FENTORA'::varchar(7), d.SPECIALTY_PRIMARY_CODE AS specialty_primary_code, 'N'::varchar(1) AS APP, 'Y'::varchar(1) AS DNP FROM (((WSMP_ADMIN.DEBARRED d JOIN WSMP_ADMIN.stg_ims_dea dea ON ((d.IMS_ID = dea.ims_id))) LEFT JOIN (SELECT substr(g.DEVELOPERNAME, 1, 2) AS sales_force_id, acct.ID_VOD__C AS ims_id, addr.LICENSE_VOD__C AS state_license_number FROM ((((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.VV_RECORDTYPE rta ON ((acct.RECORDTYPEID = rta.ID))) JOIN WSMP_ADMIN.VV_ACCOUNTSHARE acctshr ON (((acct.ID = acctshr.ACCOUNTID) AND (acctshr.ROWCAUSE = 'TerritoryManual'::varchar(15))))) JOIN WSMP_ADMIN.VV_GROUP g ON ((acctshr.USERORGROUPID = g.ID))) JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON ((addr.ACCOUNT_VOD__C = acct.ID))) WHERE ((addr.LICENSE_VOD__C IS NOT NULL) AND (acct.ID_VOD__C IS NOT NULL)) GROUP BY substr(g.DEVELOPERNAME, 1, 2), acct.ID_VOD__C, addr.LICENSE_VOD__C) sln ON (((d.IMS_ID = sln.ims_id) AND (sln.sales_force_id = 'TP'::varchar(2))))) LEFT JOIN WSMP_ADMIN.VV_ACCOUNT acct ON ((d.IMS_ID = acct.ID_VOD__C))) WHERE (d.CURRENT_IND = 'Y'::varchar(1)) GROUP BY 'TP'::varchar(2), acct.ID, sln.state_license_number, dea.dea_num, 'FENTORA'::varchar(7), d.SPECIALTY_PRIMARY_CODE, 'N'::varchar(1), 'Y'::varchar(1)) UNION SELECT 'TC'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.dea_num, 'NUVIGIL'::varchar(7) AS product_name, ssx.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app, 'N'::varchar(1) AS DNP FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.stg_ims_dea dea ON ((acct.ID_VOD__C = dea.ims_id))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF ssx ON ((acct.SPECIALTY_1_VOD__C = ssx.SPECIALTY_DESCRIPTION))) WHERE (acct.NUVIGIL_APP_TVA__C = 'true'::varchar(4))) UNION SELECT 'TP'::varchar(2) AS sales_force_id, acct.ID AS veeva_id, addr.LICENSE_VOD__C AS state_license_number, dea.dea_num, 'FENTORA'::varchar(7) AS product_name, SSX.SPECIALTY_CODE AS specialty_code, 'Y'::varchar(1) AS app, 'N'::varchar(1) AS DNP FROM (((WSMP_ADMIN.VV_ACCOUNT acct JOIN WSMP_ADMIN.stg_ims_dea dea ON ((acct.ID_VOD__C = dea.ims_id))) LEFT JOIN WSMP_ADMIN.VV_ADDRESS_VOD__C addr ON (((addr.ACCOUNT_VOD__C = acct.ID) AND (addr.LICENSE_VOD__C IS NOT NULL)))) LEFT JOIN WSMP_ADMIN.SIEBEL_SPECIALTY_XREF SSX ON ((acct.SPECIALTY_1_VOD__C = SSX.SPECIALTY_DESCRIPTION))) WHERE (acct.FENTORA_APP_TVA__C = 'true'::varchar(4));

CREATE  VIEW WSMP_ADMIN_ORA.v_adasuve_survey AS
SELECT t.ACCOUNT_VOD__C AS veeva_account_id, demo.last_name AS account_name, demo.npi, acc.ACCOUNT_DEA_TVA__C AS dea, acc.IMS_ORG_ID_TVA__C AS ims_org_id, acc.ADASUVE_ACCOUNT_INDICATOR AS adasuve_account_indicator, demo.address1, demo.address2, demo.address3, demo.city, demo.state, demo.zip, q.LASTMODIFIEDDATE AS updated_date, s.NAME AS survey, q.ORDER_VOD__C AS question_order, q.QUESTION_TEXT_VOD__C AS question, CASE ty.NAME WHEN NULLSEQUAL 'date_vod'::varchar(8) THEN to_char(q.DATE_VOD__C, 'yyyy-mm-dd'::varchar(10)) WHEN NULLSEQUAL 'text_vod'::varchar(8) THEN q.TEXT_VOD__C ELSE q.RESPONSE_VOD__C END AS answer, rep.LAST_NAME AS rep_last_name, rep.FIRST_NAME AS rep_first_name, hier.rep_territory_name, hier.m_territory_num AS region_territory_num, hier.m_territory_name AS region_territory_name, hier.d_territory_num AS area_territory_num, hier.d_territory_name AS area_territory_name FROM (((((((WSMP_ADMIN.VV_SURVEY_VOD__C s JOIN WSMP_ADMIN.VV_SURVEY_TARGET_VOD__C t ON ((s.ID = t.SURVEY_VOD__C))) JOIN WSMP_ADMIN.VV_QUESTION_RESPONSE_VOD__C q ON ((t.ID = q.SURVEY_TARGET_VOD__C))) JOIN WSMP_ADMIN.VV_RECORDTYPE ty ON ((q.TYPE_VOD__C = ty.ID))) JOIN WSMP_ADMIN.VV_ACCOUNT acc ON ((t.ACCOUNT_VOD__C = acc.ID))) JOIN WSMP_ADMIN.v_veeva_demo demo ON ((t.ACCOUNT_VOD__C = demo.veeva_account_id))) LEFT JOIN (SELECT dim_csf_sales_roster_teva.EMPLOYEE_ID, dim_csf_sales_roster_teva.TERRITORY_NUM, dim_csf_sales_roster_teva.TERRITORY_NAME, dim_csf_sales_roster_teva.SALES_FORCE_ID, dim_csf_sales_roster_teva.FULL_NAME, dim_csf_sales_roster_teva.LAST_NAME, dim_csf_sales_roster_teva.FIRST_NAME, dim_csf_sales_roster_teva.MIDDLE_NAME, dim_csf_sales_roster_teva.ADDRESS_LINE1, dim_csf_sales_roster_teva.ADDRESS_LINE2, dim_csf_sales_roster_teva.CITY, dim_csf_sales_roster_teva.STATE, dim_csf_sales_roster_teva.ZIP, dim_csf_sales_roster_teva.BUS_ADDRESS_LINE1, dim_csf_sales_roster_teva.BUS_ADDRESS_LINE2, dim_csf_sales_roster_teva.BUS_CITY, dim_csf_sales_roster_teva.BUS_STATE, dim_csf_sales_roster_teva.BUS_ZIP, dim_csf_sales_roster_teva.SHIP_ADDRESS_LINE1, dim_csf_sales_roster_teva.SHIP_ADDRESS_LINE2, dim_csf_sales_roster_teva.SHIP_CITY, dim_csf_sales_roster_teva.SHIP_STATE, dim_csf_sales_roster_teva.SHIP_ZIP, dim_csf_sales_roster_teva.BUSINESS_PHONE, dim_csf_sales_roster_teva.HOME_PHONE, dim_csf_sales_roster_teva.CELL_PHONE, dim_csf_sales_roster_teva.FAX, dim_csf_sales_roster_teva.VOICE_MAIL_EXT, dim_csf_sales_roster_teva.EMAIL, dim_csf_sales_roster_teva.HIRE_DATE, dim_csf_sales_roster_teva.BIRTHDAY, dim_csf_sales_roster_teva.TITLE, dim_csf_sales_roster_teva.REP_TYPE, dim_csf_sales_roster_teva.AREA_TRAINER, dim_csf_sales_roster_teva.USERNAME, dim_csf_sales_roster_teva.OUT_OF_TERRITORY, dim_csf_sales_roster_teva.PARENT_TERRITORY_NUM, dim_csf_sales_roster_teva.LAST_BUILD_DATE, dim_csf_sales_roster_teva.COMPANY_CD, dim_csf_sales_roster_teva.ORIG_HIRE_DATE FROM WSMP_ADMIN.DIM_CSF_SALES_ROSTER_TEVA WHERE ((dim_csf_sales_roster_teva.SALES_FORCE_ID = 'TB'::varchar(2)) AND (dim_csf_sales_roster_teva.REP_TYPE = 'REP'::varchar(3)))) rep ON ((demo.territory_num = rep.TERRITORY_NUM))) LEFT JOIN (SELECT v_territory_rep_mgr_dir.sales_force_id, v_territory_rep_mgr_dir.rep_territory_num, v_territory_rep_mgr_dir.rep_territory_name, v_territory_rep_mgr_dir.m_territory_num, v_territory_rep_mgr_dir.m_territory_name, v_territory_rep_mgr_dir.d_territory_num, v_territory_rep_mgr_dir.d_territory_name, v_territory_rep_mgr_dir.h_territory_num, v_territory_rep_mgr_dir.h_territory_name FROM WSMP_ADMIN.v_territory_rep_mgr_dir WHERE (v_territory_rep_mgr_dir.sales_force_id = 'TB'::varchar(2))) hier ON ((demo.territory_num = hier.rep_territory_num))) WHERE ((s.NAME = ANY (ARRAY['Profiling and Developing Product Champions'::varchar(42), 'REMS Enrollment and Formulary'::varchar(29)])) AND (demo.sales_force_id = 'TB'::varchar(2))) ORDER BY t.ACCOUNT_VOD__C, s.NAME, q.QUESTION_TEXT_VOD__C;

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_agile_mktg_copay_redemptions AS
SELECT CASE mod(npi.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((npi.tvcmid)::int)::varchar ELSE rtrim((npi.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, npi.ims_id, cd.VEEVA_ACCOUNT_ID AS veeva_account_id, p.ASI_PROGRAM_NUM AS asi_program_num, p.PROGRAM_DESC AS program_desc, cd.COPAY_CARD_NUM AS copay_card_num, coalesce(cd.ASI_PHYS_ZIP, cd.PHARMACY_ZIP) AS zip_code, to_char(cd.FILL_DATE, 'YYYY-MM-DD'::varchar(10)) AS fill_date, cd.BRAND_NAME AS brand_name, cd.DRUG_DESC AS drug_desc, (cd.QTY)::int AS qty FROM WSMP_ADMIN.TFC_ASI_COPAY_DETAIL_WKLY cd, WSMP_ADMIN.DIM_ASI_PROGRAM p, (SELECT tvcmid_hcp_demo.TVCMID AS tvcmid, tvcmid_hcp_demo.NPI AS npi, tvcmid_hcp_demo.IMS_ID AS ims_id FROM teva_ingestion.tvcmid_hcp_demo WHERE (tvcmid_hcp_demo.NPI IS NOT NULL) GROUP BY tvcmid_hcp_demo.TVCMID, tvcmid_hcp_demo.NPI, tvcmid_hcp_demo.IMS_ID) npi WHERE ((cd.IMS_ID = npi.ims_id) AND (cd.BRAND_NAME = 'NUVIGIL'::varchar(7)) AND (cd.PROGRAM_NUM = p.ASI_PROGRAM_NUM) AND (cd.FILL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (cd.FILL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))) AND (cd.REDEMPTION_TYPE = p.REDEMPTION_TYPE));

CREATE  VIEW WSMP_ADMIN_ORA.v_ob_Agile_Mktg_Mix_Voucher_Redemptions AS
SELECT CASE mod(v.tvcmid, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((v.tvcmid)::int)::varchar ELSE rtrim((v.tvcmid)::varchar, '0'::varchar(1)) END AS tvcmid, x.ims_id, x.veeva_account_id, v.asi_program_num, v.program_desc, v.voucher_num, v.zip_code, to_char(v.fill_date, 'YYYY-MM-DD'::varchar(10)) AS fill_date, v.product_name, v.drug_desc, CASE mod(v.qty, 1::numeric(18,0)) WHEN NULLSEQUAL 0::numeric(18,0) THEN ((v.qty)::int)::varchar ELSE rtrim((v.qty)::varchar, '0'::varchar(1)) END AS qty FROM ((SELECT v.tvcmid, v.ims_id, v.asi_program_num, v.program_desc, v.voucher_num, v.zip_code, v.fill_date, v.product_name, v.drug_desc, v.qty FROM (SELECT npi.tvcmid, npi.ims_id, p.ASI_PROGRAM_NUM AS asi_program_num, p.PROGRAM_DESC AS program_desc, vd.VOUCHER_NUM AS voucher_num, coalesce(vd.PROVIDER_ZIP, vd.PHARMACY_ZIP) AS zip_code, vd.FILL_DATE AS fill_date, vd.PRODUCT_NAME AS product_name, vd.DRUG_DESC AS drug_desc, vd.QTY AS qty FROM ((WSMP_ADMIN.TFC_ASI_REDEMPTION_DETAIL_WKLY vd JOIN WSMP_ADMIN.DIM_ASI_PROGRAM p ON (((vd.PROGRAM_NUM = p.ASI_PROGRAM_NUM) AND (vd.REDEMPTION_TYPE = p.REDEMPTION_TYPE)))) LEFT JOIN (SELECT tvcmid_hcp_demo.TVCMID AS tvcmid, tvcmid_hcp_demo.NPI AS npi, tvcmid_hcp_demo.IMS_ID AS ims_id FROM teva_ingestion.tvcmid_hcp_demo WHERE (tvcmid_hcp_demo.NPI IS NOT NULL) GROUP BY tvcmid_hcp_demo.TVCMID, tvcmid_hcp_demo.NPI, tvcmid_hcp_demo.IMS_ID) npi ON ((vd.NPI = npi.npi))) WHERE ((vd.PRODUCT_NAME = 'NUVIGIL'::varchar(7)) AND (vd.FILL_DATE >= (last_day(add_months((statement_timestamp())::timestamp, (-25))) + 1)) AND (vd.FILL_DATE <= last_day(add_months((statement_timestamp())::timestamp, (-1)))))) v) v LEFT JOIN (SELECT demo_combined.ims_id, demo_combined.veeva_account_id FROM WSMP_ADMIN.demo_combined WHERE ((demo_combined.sales_force_id = 'TC'::varchar(2)) AND (demo_combined.veeva_account_id IS NOT NULL)) GROUP BY demo_combined.ims_id, demo_combined.veeva_account_id) x ON ((v.ims_id = x.ims_id)));

CREATE FUNCTION public.isOrContains(map Long Varchar, val Varchar)
RETURN boolean AS
BEGIN
RETURN CASE WHEN (public.MapSize(map) <> (-1)) THEN public.MapContainsValue(map, val) ELSE (map = (val)) END;

CREATE FUNCTION public.weighted_oracle_task(key_value Varchar, points Integer)
RETURN float AS
BEGIN
RETURN (CASE key_value WHEN 'select' THEN (points * 0.3) WHEN 'merge' THEN (points * 5) WHEN 'declare' THEN (points * 4) WHEN 'begin' THEN (points * 4) WHEN 'cursor' THEN (points * 25) WHEN 'loop' THEN (points * 25) WHEN 'rowid' THEN (points * 10) WHEN 'rownum' THEN (points * 5) WHEN 'oracle_join_syntax' THEN (points * 3) ELSE points END)::float;

SELECT MARK_DESIGN_KSAFE(1);