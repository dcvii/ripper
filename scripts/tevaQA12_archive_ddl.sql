CREATE SCHEMA archive;


CREATE TABLE archive.test
(
    c1 int
);


CREATE TABLE archive.basket_20180307
(
    basket_id int,
    name varchar(300),
    description varchar(500),
    teva_product_code varchar(100),
    basket_type varchar(100),
    create_date date
);


CREATE TABLE archive.basket_item_20180307
(
    basket_id int,
    entity_type varchar(20),
    entity_id int
);


CREATE TABLE archive.source_product_20180307
(
    source_id int,
    feed_id int,
    feed_version int,
    entity_type varchar(20),
    entity_id int,
    source_file_code varchar(80),
    source_product_code varchar(100),
    source_product_name varchar(300),
    source_product_description varchar(300),
    source_product_mfg_name varchar(100),
    source_client_num varchar(80),
    source_report_num varchar(80),
    source_indication varchar(20),
    create_date date
);


CREATE TABLE archive.data_feed_version_validation_rules_20180412
(
    pkId int,
    feed_id int,
    feed_version_id int,
    field varchar(50),
    parameters varchar(50),
    validation_rule_code varchar(4),
    date_format varchar(20)
);


CREATE TABLE archive.prescriber_combined_demographics_20180419
(
    sales_force_id varchar(20),
    ims_id varchar(10),
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(30),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(10),
    npi varchar(10),
    tvcmid int,
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20)
);


CREATE TABLE archive.copay_20180604
(
    redemption_type varchar(10),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_num varchar(50),
    fill_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(20),
    daw int,
    basket_id int,
    basket_name varchar(300),
    new_refill int,
    quantity numeric(37,15),
    refills int,
    other_coverage_code varchar(10),
    program_number varchar(15),
    copay_card_number varchar(15),
    sex varchar(1),
    age_at_redemption int,
    pharmacy_process_date date,
    pharmacy_chain_number varchar(5),
    nabp varchar(7),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_phone varchar(10),
    pharmacy_npi_num varchar(10),
    principle_physician_dea varchar(9),
    physician_npi varchar(10),
    physician_ims_id varchar(10),
    physician_veeva_id varchar(20),
    physician_name varchar(100),
    physician_address1 varchar(100),
    physician_address2 varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(5),
    rebate_amount numeric(37,15),
    member_cash_expense numeric(37,15),
    submitted_cost numeric(37,15),
    pharmacy_fee numeric(37,15),
    total_amount_due numeric(37,15),
    calc_awp numeric(37,15),
    create_date date,
    occ_payment_type varchar(10),
    counted_copay varchar(1),
    file_id int,
    record_id int,
    physician_tvcmid int,
    pharmacy_tvcmid int,
    report_frequency varchar(20),
    source_name varchar(255),
    auth_refills int,
    admin_hcp_npi int,
    admin_hcp_name varchar(100),
    admin_hcp_address varchar(100),
    admin_hcp_address2 varchar(100),
    admin_hcp_city varchar(50),
    admin_hcp_state varchar(2),
    admin_hcp_zip int,
    claim_type varchar(50),
    administration_flag char(1),
    soc_name varchar(60),
    soc_phone int,
    soc_fax int,
    soc_address varchar(100),
    soc_city varchar(50),
    soc_state varchar(2),
    soc_zip int,
    soc_id varchar(50),
    soc_npi varchar(10),
    payer_name varchar(60),
    cpt_code varchar(10),
    trans_type varchar(15),
    previous_payer_id int,
    member_id varchar(20),
    benefit_amount numeric(9,2),
    patient_expense numeric(9,2),
    submission_method varchar(1)
);


CREATE TABLE archive.prescriber_combined_demo_frozen_20180621
(
    start_date date,
    end_date date,
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100),
    freeze_reason varchar(100),
    freeze_date date
);


CREATE TABLE archive.workflow_steps_20180718
(
    pkId int,
    WorkflowId int,
    StepOrder int,
    StepDescription varchar(50)
);


CREATE TABLE archive.tw_address_20180718
(
    specialty_pharmacy_data_source varchar(20),
    address_id int,
    address varchar(100),
    city varchar(50),
    state varchar(20),
    zip_code varchar(10),
    phone varchar(50),
    fax varchar(50),
    email varchar(100),
    tax_id varchar(50)
);


CREATE TABLE archive.tw_address_xref_20180718
(
    specialty_pharmacy_data_source varchar(20),
    customer_code varchar(20),
    address_id int,
    address_type varchar(20)
);


CREATE TABLE archive.tw_account_20180718
(
    specialty_pharmacy_data_source varchar(20),
    customer_id varchar(20),
    customer_name varchar(100),
    parent_customer_id varchar(20),
    parent_customer_name varchar(100),
    customer_type varchar(20),
    pvp_340B_id varchar(100),
    HIN varchar(100),
    DEA_NUM varchar(100)
);


CREATE TABLE archive.prescriber_combined_demo_frozen_20180724
(
    start_date date,
    end_date date,
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100),
    freeze_reason varchar(100),
    freeze_date date
);


CREATE TABLE archive.mdm_address_20180724
(
    tvcmid int,
    address_id int,
    address_type varchar(10),
    address_type_name varchar(50),
    address_line_1 varchar(80),
    address_line_2 varchar(80),
    county varchar(40),
    city varchar(40),
    state varchar(2),
    state_name varchar(50),
    country_code varchar(3),
    country_name varchar(50),
    zip5_postal_code varchar(5),
    zip4_postal_extension_code varchar(4),
    address_status varchar(10),
    address_status_name varchar(50),
    address_effective_date timestamp,
    msa_cbsa varchar(5),
    fips_state_code varchar(2),
    fips_state_description varchar(50),
    fips_county_code varchar(3),
    fips_county_description varchar(50),
    deliverability_confidence varchar(10),
    address_setting_type_code varchar(10),
    address_setting_type_description varchar(50),
    address_category_code varchar(10),
    address_category_description varchar(50),
    address_latitude varchar(20),
    address_longitude varchar(20),
    postal_barcode varchar(10),
    single_address_indicator varchar(1),
    practice_location_confidence_indicator varchar(10),
    practice_location_rank varchar(10),
    validation_message varchar(100),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_address_link_20180724
(
    tvcmid int,
    address_id int,
    dsp_id varchar(10),
    dsp_hce_id varchar(100),
    dsp_address_id varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_alternate_id_20180724
(
    tvcmid int,
    alternate_id_type varchar(10),
    alternate_id_type_name varchar(50),
    alternate_id_value varchar(100),
    state varchar(2),
    state_name varchar(50),
    identifier_category varchar(25),
    status varchar(10),
    status_name varchar(50),
    source_deactivation_reason_code varchar(1),
    source_deactivation_reason_description varchar(50),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_alternate_name_20180724
(
    tvcmid int,
    name_type varchar(10),
    name_type_name varchar(50),
    name_value varchar(125),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_communication_20180724
(
    tvcmid int,
    address_id varchar(14),
    communication_type varchar(10),
    communication_type_name varchar(50),
    communication_value varchar(100),
    status_code varchar(10),
    status_name varchar(50),
    effective_start_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_dea_address_20180724
(
    tvcmid int,
    address_id int,
    dea_number varchar(18),
    business_activity_code varchar(1),
    business_activity_description varchar(40),
    sub_business_activity_code varchar(10),
    sub_business_activity_description varchar(50),
    dea_schedule_class_code varchar(20),
    dea_status_code varchar(5),
    dea_status_description varchar(40),
    dea_expiration_date timestamp,
    dea_deactivation_reason_code varchar(1),
    dea_deactivation_reason_description varchar(50),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_email_preference_20180724
(
    tvcmid int,
    email varchar(10),
    value varchar(100),
    effective_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_hco_20180724
(
    tvcmid int,
    ims_organization_id varchar(11),
    dba_name varchar(80),
    business_name varchar(80),
    care_of_location varchar(80),
    record_type varchar(2),
    record_type_name varchar(50),
    sub_type varchar(10),
    sub_type_name varchar(50),
    owner_status varchar(25),
    profit_status varchar(25),
    cmi int,
    no_of_providers int,
    primary_cot_id int,
    cot_classification_id int,
    cot_classification varchar(50),
    cot_facility_type_id int,
    cot_facility_type varchar(50),
    cot_specialty_id int,
    cot_specialty varchar(50),
    ttl_license_beds int,
    ttl_census_beds int,
    ttl_staffed_beds int,
    teaching_hosp varchar(1),
    commhosp varchar(3),
    formulary varchar(20),
    electronic_medical_record varchar(20),
    eprescribe varchar(20),
    payperform varchar(20),
    genfirst varchar(20),
    srep_access varchar(20),
    practicing_status_code_healthcare_organization varchar(5),
    mpn varchar(6),
    mpn_order varchar(1),
    status_indicator varchar(1),
    status_indicator_name varchar(50),
    deactivation_reason varchar(25),
    logical_deletion_date timestamp,
    hce_insert_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_hco_teva_flag_20180724
(
    tvcmid int,
    flag_type varchar(10),
    flag_type_name varchar(50),
    flag_value varchar(50),
    effective_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_hcp_20180724
(
    tvcmid int,
    ims_hce_id int,
    ims_prescriber_id varchar(7),
    first_name varchar(40),
    middle_name varchar(40),
    last_name varchar(40),
    prefix varchar(10),
    suffix varchar(10),
    suffix_name varchar(50),
    sub_type varchar(10),
    sub_type_name varchar(50),
    healthcare_professional_status_code varchar(10),
    healthcare_professional_status_name varchar(50),
    year_of_birth timestamp,
    date_of_death timestamp,
    gender_code varchar(5),
    gender_name varchar(50),
    teva_specialty_code varchar(5),
    teva_specialty_name varchar(50),
    logical_deletion_date timestamp,
    hce_insert_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_hcp_teva_flag_20180724
(
    tvcmid int,
    flag_type varchar(10),
    flag_type_name varchar(50),
    flag_value varchar(50),
    effective_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_ims_flag_20180724
(
    tvcmid int,
    flag_type varchar(10),
    flag_type_name varchar(50),
    flag_value varchar(1),
    effective_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_license_20180724
(
    tvcmid int,
    hce_regulation_id varchar(14),
    license_type_id int,
    license_type_name varchar(100),
    authorization_number varchar(25),
    profession_code varchar(5),
    state varchar(2),
    state_name varchar(50),
    state_board_id int,
    state_board_name varchar(150),
    license_privilege_id int,
    license_privilege varchar(100),
    license_certification_code varchar(5),
    license_certification_name varchar(40),
    license_type_privilege_rank int,
    license_status_code varchar(5),
    license_status_description varchar(40),
    license_effective_date timestamp,
    license_expiration_date timestamp,
    license_deactivation_reason_code varchar(10),
    license_deactivation_reason_description varchar(50),
    record_type varchar(3),
    record_type_name varchar(50),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_marketing_channel_20180724
(
    tvcmid int,
    channel varchar(10),
    value varchar(100),
    effective_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_merges_20180724
(
    previous_tvcmid int,
    current_tvcmid int,
    merge_cycle varchar(1),
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_professional_20180724
(
    tvcmid int,
    profession_code varchar(5),
    profession_code_name varchar(50),
    profession_rank varchar(3),
    status varchar(10),
    profession_status_name varchar(50),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_raw_dea_20180724
(
    tvcmid int,
    ims_id varchar(7),
    dea_number varchar(9),
    name varchar(40),
    additional_company_info varchar(40),
    address_line1 varchar(40),
    address_line2 varchar(40),
    city varchar(33),
    state varchar(2),
    state_name varchar(50),
    zip varchar(5),
    business_activity_code varchar(1),
    drug_schedules varchar(16),
    expiration_date timestamp,
    business_activity_sub_code varchar(1),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_raw_npi_20180724
(
    tvcmid int,
    npi_number varchar(10),
    npi_first_name varchar(20),
    npi_middle_name varchar(20),
    npi_last_name varchar(35),
    practice_address_1 varchar(55),
    practice_address_2 varchar(55),
    practice_city varchar(40),
    practice_state_name varchar(20),
    practice_postal_code varchar(20),
    practice_country_code varchar(2),
    primary_taxonomy_code varchar(10),
    primary_taxonomy_type varchar(200),
    primary_taxonomy_classification varchar(200),
    primary_taxonomy_specialty varchar(200),
    ims_specialty_code varchar(5),
    ims_specialty_description varchar(50),
    npi_deactivation_reason_code varchar(2),
    npi_deactivation_date timestamp,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_regulation_20180724
(
    state_license_type_id int,
    state_license_type_name varchar(120),
    state_privilege_type_id int,
    state_license_privilege_type_name varchar(120),
    state_license_privilege_type_rank int,
    state_code varchar(2),
    state_name varchar(50),
    state_board_id int,
    state_board_name varchar(120),
    certification_code varchar(5),
    required_sample_non_ctrl varchar(1),
    required_sample_ctrl varchar(1),
    received_sample_non_ctrl varchar(1),
    received_sample_ctrl varchar(1),
    distributed_sample_non_ctrl varchar(1),
    distributed_sample_ctrl varchar(1),
    sample_drug_schedule_i_flag varchar(1),
    sample_drug_schedule_ii_flag varchar(1),
    sample_drug_schedule_iii_flag varchar(1),
    sample_drug_schedule_iv_flag varchar(1),
    sample_drug_schedule_v_flag varchar(1),
    sample_drug_schedule_vi_flag varchar(1),
    prescriber_non_ctrl_flag varchar(1),
    prescriber_app_required_non_ctrl_flag varchar(1),
    prescriber_ctrl_flag varchar(1),
    prescriber_app_required_ctrl_flag varchar(1),
    prescriber_drug_schedule_i_flag varchar(1),
    prescriber_drug_schedule_ii_flag varchar(1),
    prescriber_drug_schedule_iii_flag varchar(1),
    prescriber_drug_schedule_iv_flag varchar(1),
    prescriber_drug_schedule_v_flag varchar(1),
    prescriber_drug_schedule_vi_flag varchar(1),
    supervisory_relationship_code_non_ctrl varchar(1),
    supervisory_relationship_code_ctrl varchar(1),
    collaborative_non_ctrl varchar(1),
    collaborative_ctrl varchar(1),
    inclusionary varchar(1),
    exclusionary varchar(1),
    delegation_non_ctrl varchar(1),
    delegation_ctrl varchar(1),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_relationship_20180724
(
    hierarchy_code varchar(255),
    hierarchy_name varchar(255),
    relationship_type_code varchar(255),
    relationship_type_name varchar(255),
    parent_tvcmid int,
    child_tvcmid int,
    relationship_status_code varchar(50),
    relationship_status_name varchar(50),
    relationship_start_date timestamp,
    relationship_end_date timestamp,
    notes varchar(2000),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_sample_eligibility_20180724
(
    tvcmid int,
    sln varchar(25),
    sln_state varchar(2),
    sln_status_code varchar(5),
    sln_status_description varchar(40),
    sln_expiration_date timestamp,
    teva_sample_eligibility_flag varchar(1),
    teva_schedule_iv_eligibility_flag varchar(1),
    teva_schedule_v_eligibility_flag varchar(1),
    profession_short_description varchar(5),
    teva_specialty_code varchar(5),
    certification_code varchar(5),
    certification_description varchar(100),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_source_details_20180724
(
    tvcmid int,
    identifier_code varchar(5),
    identifier_description varchar(50),
    identifier_value varchar(18),
    legacy_identifier_code varchar(10),
    ama_md_do_flag int,
    major_professional_activity varchar(10),
    major_professional_activity_description varchar(50),
    hospital_hours varchar(3),
    ama_hospital_id varchar(10),
    ama_hospital_description varchar(100),
    practice_type_code varchar(10),
    practice_type_description varchar(50),
    employment_type_code varchar(10),
    employment_type_description varchar(50),
    birth_city varchar(30),
    birth_state varchar(2),
    birth_country_code varchar(5),
    birth_country_description varchar(100),
    medical_school_code varchar(10),
    medical_school_description varchar(50),
    graduation_year varchar(64),
    number_of_physician_offices int,
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.mdm_specialty_20180724
(
    tvcmid int,
    specialty_code varchar(5),
    specialty_code_name varchar(50),
    specialty_ranking varchar(3),
    status varchar(10),
    status_name varchar(50),
    created_by varchar(50),
    created_date timestamp,
    updated_by varchar(50),
    updated_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE archive.scd_sales_geography_20180727
(
    scd_status varchar(10),
    scd_effective_date date,
    scd_expiration_date date,
    sales_force_id varchar(4),
    geography_number varchar(15),
    geography_name varchar(100),
    geography_desc varchar(100),
    geography_type varchar(15),
    employee_type varchar(10),
    sales_team varchar(100),
    parent_geography_number varchar(15),
    fleet_eligible_flag varchar(1)
);


CREATE TABLE archive.prescriber_combined_demo_frozen_20180813
(
    start_date date,
    end_date date,
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100),
    freeze_reason varchar(100),
    freeze_date date
);


CREATE TABLE archive.veeva_call_sample_20180815
(
    id varchar(18),
    isdeleted varchar(5),
    name varchar(80),
    createddate date,
    createdbyid varchar(18),
    lastmodifieddate timestamptz,
    lastmodifiedbyid varchar(18),
    systemmodstamp timestamptz,
    lastactivitydate date,
    mayedit varchar(5),
    islocked varchar(5),
    lastvieweddate varchar(24),
    lastreferenceddate timestamptz,
    account_vod__c varchar(18),
    call_date_vod__c date,
    is_parent_call_vod__c varchar(64),
    quantity_vod__c varchar(64),
    lot_vod__c varchar(80),
    mobile_id_vod__c varchar(100),
    call2_vod__c varchar(18),
    product_vod__c varchar(18),
    distributor_vod__c varchar(255),
    attendee_type_vod__c varchar(255),
    entity_reference_id_vod__c varchar(100),
    delivery_status_vod__c varchar(255),
    apply_limit_vod__c varchar(5),
    limit_applied_vod__c varchar(5),
    manufacturer_vod__c varchar(255),
    file_id int,
    record_id int
);


CREATE TABLE archive.prescriber_combined_demographics_20181001
(
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    secondary_specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100)
);


CREATE TABLE archive.ic_decile_goal_setting_2018q4_20181005
(
    ic_data_month date,
    ims_id varchar(10),
    tvcmid int,
    decile_name varchar(300),
    decile_value int,
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date
);


CREATE TABLE archive.ic_demo_goal_setting_2018q4_20181005
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date
);


CREATE TABLE archive.ic_rx_goal_setting_2018q4_20181005
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20)
);


CREATE TABLE archive.ic_target_goal_setting_2018q4_20181005
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    row_create_date date
);


CREATE TABLE archive.prescriber_combined_demo_frozen_20190426
(
    start_date date,
    end_date date,
    sales_force_id varchar(20),
    ims_id varchar(10),
    npi varchar(10),
    tvcmid int,
    veeva_account_id varchar(20),
    specialty varchar(255),
    first_name varchar(50),
    middle_name varchar(50),
    last_name varchar(50),
    ptr_veeva_address_id varchar(20),
    ptr_address_1 varchar(100),
    ptr_address_2 varchar(100),
    ptr_address_3 varchar(100),
    ptr_city varchar(50),
    ptr_state varchar(2),
    ptr_zip varchar(5),
    ptr_phone varchar(40),
    ptr_territory_num varchar(15),
    ptr_territory_type varchar(30),
    ptr_address_source varchar(50),
    ptr_mailable varchar(1),
    dea_num varchar(10),
    pdrp_flag varchar(1),
    pdrp_date timestamp,
    np_pa_flag varchar(1),
    no_spend varchar(1),
    ama_no_contact_flag varchar(1),
    email varchar(100),
    degree varchar(100),
    address_id int,
    address_latitude varchar(20),
    address_longitude varchar(20),
    row_source varchar(100),
    freeze_reason varchar(100),
    freeze_date date,
    secondary_specialty varchar(255)
);


CREATE TABLE archive.copay_20190618
(
    redemption_type varchar(10),
    physician_tvcmid int,
    pharmacy_tvcmid int,
    basket_id int,
    basket_name varchar(300),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_num varchar(50),
    fill_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(20),
    daw int,
    new_refill int,
    quantity numeric(9,2),
    refills int,
    other_coverage_code varchar(10),
    program_number varchar(15),
    copay_card_number varchar(20),
    sex varchar(1),
    age_at_redemption int,
    pharmacy_process_date date,
    pharmacy_chain_number varchar(5),
    nabp varchar(7),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_phone varchar(10),
    pharmacy_npi_num varchar(10),
    principle_physician_dea varchar(9),
    physician_npi varchar(10),
    physician_ims_id varchar(10),
    physician_veeva_id varchar(20),
    physician_name varchar(100),
    physician_address1 varchar(100),
    physician_address2 varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(5),
    rebate_amount numeric(9,2),
    member_cash_expense numeric(9,2),
    submitted_cost numeric(9,2),
    pharmacy_fee numeric(9,2),
    total_amount_due numeric(9,2),
    calc_awp numeric(9,2),
    create_date date,
    occ_payment_type varchar(10),
    counted_copay varchar(1),
    auth_refills int,
    admin_hcp_npi varchar(10),
    admin_hcp_name varchar(100),
    admin_hcp_address varchar(100),
    admin_hcp_address2 varchar(100),
    admin_hcp_city varchar(50),
    admin_hcp_state varchar(2),
    admin_hcp_zip varchar(10),
    claim_type varchar(50),
    administration_flag char(1),
    soc_name varchar(60),
    soc_phone varchar(10),
    soc_fax varchar(10),
    soc_address varchar(100),
    soc_city varchar(50),
    soc_state varchar(2),
    soc_zip varchar(10),
    soc_id varchar(50),
    soc_npi varchar(10),
    payer_name varchar(60),
    cpt_code varchar(10),
    trans_type varchar(15),
    previous_payer_id int,
    member_id varchar(20),
    benefit_amount numeric(9,2),
    patient_expense numeric(9,2),
    submission_method varchar(1),
    report_frequency varchar(20),
    source_name varchar(255),
    file_id int,
    record_id int
);


CREATE TABLE archive.prescriber_rx_gcsf_tki_bkp_201712
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count numeric(18,3),
    trx_count numeric(18,3),
    nrx_quantity numeric(18,3),
    trx_quantity numeric(18,3),
    unnormalized_nrx_count numeric(18,3),
    unnormalized_trx_count numeric(18,3),
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20)
);


CREATE TABLE archive.bag_20180329
(
    bag_id int,
    bag_name varchar(100),
    first_valid_date timestamp,
    last_valid_date timestamp,
    valid_for_today varchar(1),
    create_user varchar(30),
    create_date timestamp,
    update_user varchar(30),
    update_date timestamp
);


CREATE TABLE archive.bag_product_20180329
(
    bag_id int,
    basket_id int,
    basket_name varchar(300),
    "position" float,
    weight float,
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date
);


CREATE TABLE archive.bag_territory_20180329
(
    bag_id int,
    territory_number varchar(8),
    detail_first_valid_date date,
    detail_last_valid_date date,
    ic_first_valid_date date,
    ic_last_valid_date date,
    valid_for_today varchar(1),
    valid_for_ic varchar(1),
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date
);


CREATE TABLE archive.copay_voucher_program_vertica_20180613
(
    program_key int,
    redemption_type varchar(20),
    program_number varchar(10),
    program_description varchar(100),
    sales_force_id varchar(10),
    program_type varchar(20),
    product_name varchar(30),
    program_start_date date,
    program_end_date date,
    active_ind varchar(1),
    create_date date,
    last_upd_date date,
    number_of_tablets int
);


CREATE TABLE archive.copay_voucher_program_oracle_20180613
(
    program_key int,
    redemption_type varchar(20),
    program_number varchar(10),
    program_description varchar(100),
    sales_force_id varchar(10),
    program_type varchar(20),
    product_name varchar(30),
    program_start_date date,
    program_end_date date,
    active_ind varchar(1),
    create_date date,
    last_upd_date date,
    number_of_tablets int
);


CREATE TABLE archive.copay_20190624
(
    redemption_type varchar(10),
    physician_tvcmid int,
    pharmacy_tvcmid int,
    basket_id int,
    basket_name varchar(300),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_num varchar(50),
    fill_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(20),
    daw int,
    new_refill int,
    quantity numeric(9,2),
    refills int,
    other_coverage_code varchar(10),
    program_number varchar(15),
    copay_card_number varchar(20),
    sex varchar(1),
    age_at_redemption int,
    pharmacy_process_date date,
    pharmacy_chain_number varchar(5),
    nabp varchar(7),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_phone varchar(10),
    pharmacy_npi_num varchar(10),
    principle_physician_dea varchar(9),
    physician_npi varchar(10),
    physician_ims_id varchar(10),
    physician_veeva_id varchar(20),
    physician_name varchar(100),
    physician_address1 varchar(100),
    physician_address2 varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(5),
    rebate_amount numeric(9,2),
    member_cash_expense numeric(9,2),
    submitted_cost numeric(9,2),
    pharmacy_fee numeric(9,2),
    total_amount_due numeric(9,2),
    calc_awp numeric(9,2),
    create_date date,
    occ_payment_type varchar(10),
    counted_copay varchar(1),
    auth_refills int,
    admin_hcp_npi varchar(10),
    admin_hcp_name varchar(100),
    admin_hcp_address varchar(100),
    admin_hcp_address2 varchar(100),
    admin_hcp_city varchar(50),
    admin_hcp_state varchar(2),
    admin_hcp_zip varchar(10),
    claim_type varchar(50),
    administration_flag char(1),
    soc_name varchar(60),
    soc_phone varchar(10),
    soc_fax varchar(10),
    soc_address varchar(100),
    soc_city varchar(50),
    soc_state varchar(2),
    soc_zip varchar(10),
    soc_id varchar(50),
    soc_npi varchar(10),
    payer_name varchar(60),
    cpt_code varchar(10),
    trans_type varchar(15),
    previous_payer_id int,
    member_id varchar(20),
    benefit_amount numeric(9,2),
    patient_expense numeric(9,2),
    submission_method varchar(1),
    report_frequency varchar(20),
    source_name varchar(255),
    file_id int,
    record_id int
);


CREATE TABLE archive.prescriber_rx_gcsf_tki_bkp_201710
(
    ims_id varchar(10),
    payer_plan_number varchar(10),
    ims_client_number varchar(5),
    report_frequency varchar(20),
    ims_product_group varchar(10),
    basket_id int,
    data_date date,
    date date,
    sales_category varchar(2),
    tvcmid int,
    prescriber_first_name varchar(50),
    prescriber_last_name varchar(50),
    basket_name varchar(300),
    basket_type varchar(100),
    rollup_week date,
    rollup_month date,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    unnormalized_nrx_count float,
    unnormalized_trx_count float,
    market_name varchar(75),
    payer_name varchar(100),
    plan_name varchar(100),
    pbm_name varchar(100),
    model varchar(100),
    payment_method varchar(250),
    ims_specialty varchar(10),
    ims_rx_type varchar(1),
    ims_supplemental_data varchar(20),
    ims_zip_other varchar(10),
    ims_report_number_cnt varchar(5),
    cnt_file_id int,
    cnt_record_id int,
    ims_report_number_qty varchar(5),
    qty_file_id int,
    qty_record_id int,
    rollup_flag char(1),
    indication varchar(20)
);


CREATE TABLE archive.product_catalog_20180401
(
    id int,
    sales_force_id varchar(5),
    product_catalog varchar(10),
    product varchar(300),
    business_unit varchar(100),
    start_date date,
    end_date date,
    field_release_date date
);


CREATE TABLE archive.salesforce_reference_20180401
(
    id int,
    sales_force_id varchar(10),
    ref_code varchar(10),
    ref_desc varchar(50),
    ref_type varchar(50)
);


CREATE TABLE archive.rx_deciles_20180430
(
    ims_id varchar(10),
    first_name varchar(50),
    last_name varchar(50),
    decile_name varchar(50),
    basket_id int,
    basket_name varchar(300),
    decile_trx_count_6_mo int,
    decile_trx_count_12_mo int,
    trx_count_6_mo float,
    trx_count_12_mo float,
    trx_count_24_mo float,
    decile_date date,
    tvcmid int
);


CREATE TABLE archive.copay_20180517
(
    redemption_type varchar(10),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_num varchar(50),
    fill_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(20),
    daw int,
    basket_id int,
    basket_name varchar(300),
    new_refill int,
    quantity numeric(37,15),
    refills int,
    other_coverage_code varchar(10),
    program_number varchar(15),
    copay_card_number varchar(15),
    sex varchar(1),
    age_at_redemption int,
    pharmacy_process_date date,
    pharmacy_chain_number varchar(5),
    nabp varchar(7),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_phone varchar(10),
    pharmacy_npi_num varchar(10),
    principle_physician_dea varchar(9),
    physician_npi varchar(10),
    physician_ims_id varchar(10),
    physician_veeva_id varchar(20),
    physician_name varchar(100),
    physician_address1 varchar(100),
    physician_address2 varchar(100),
    physician_city varchar(50),
    physician_state varchar(2),
    physician_zip varchar(5),
    rebate_amount numeric(37,15),
    member_cash_expense numeric(37,15),
    submitted_cost numeric(37,15),
    pharmacy_fee numeric(37,15),
    total_amount_due numeric(37,15),
    calc_awp numeric(37,15),
    create_date date,
    occ_payment_type varchar(10),
    counted_copay varchar(1),
    file_id int,
    record_id int,
    physician_tvcmid int,
    pharmacy_tvcmid int,
    report_frequency varchar(20),
    source_name varchar(255),
    auth_refills int,
    admin_hcp_npi int,
    admin_hcp_name varchar(100),
    admin_hcp_address varchar(100),
    admin_hcp_address2 varchar(100),
    admin_hcp_city varchar(50),
    admin_hcp_state varchar(2),
    admin_hcp_zip int,
    claim_type varchar(50),
    administration_flag char(1),
    soc_name varchar(60),
    soc_phone int,
    soc_fax int,
    soc_address varchar(100),
    soc_city varchar(50),
    soc_state varchar(2),
    soc_zip int,
    soc_id varchar(50),
    soc_npi varchar(10),
    payer_name varchar(60),
    cpt_code varchar(10),
    trans_type varchar(15),
    previous_payer_id int,
    member_id varchar(20),
    benefit_amount numeric(9,2),
    patient_expense numeric(9,2),
    submission_method varchar(1)
);


CREATE TABLE archive.ic_decile_2018Q3_special_run_v1
(
    ic_data_month date,
    ims_id varchar(10),
    tvcmid int,
    decile_name varchar(300),
    decile_value int,
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date
);


CREATE TABLE archive.ic_demo_2018Q3_special_run_v1
(
    ic_data_month date,
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    specialty varchar(10),
    last_name varchar(80),
    first_name varchar(25),
    mid_name varchar(2),
    address_1 varchar(100),
    address_2 varchar(100),
    address_3 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(5),
    address_source varchar(50),
    pdrp_flag char(1),
    pdrp_date date,
    np_pa_flag char(1),
    no_spend char(1),
    ama_no_contact_flag char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date
);


CREATE TABLE archive.ic_goal_setting_2018Q3_special_run_v1
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    market_rolling_6 float,
    product_rolling_6 float,
    market_rolling_12 float,
    market_baseline float,
    product_baseline float,
    target_market_rolling_6 float,
    target_product_rolling_6 float,
    target_market_rolling_12 float,
    target_market_baseline float,
    target_product_baseline float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date
);


CREATE TABLE archive.ic_rx_2018Q3_special_run_v1
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    outlet_code varchar(8),
    va_station_number varchar(10),
    dnc_flag char(1),
    dnp_flag char(1),
    rollup_month date,
    month_bucket int,
    nrx_count float,
    trx_count float,
    nrx_quantity float,
    trx_quantity float,
    include_in_nation_rollup char(1),
    include_in_area_rollup char(1),
    include_in_region_rollup char(1),
    join_key varchar(10),
    row_source varchar(100),
    row_create_date date,
    indication varchar(20)
);


CREATE TABLE archive.ic_target_2018Q3_special_run_v1
(
    ic_data_month date,
    basket_name varchar(300),
    sales_force_id varchar(20),
    area_number varchar(15),
    region_number varchar(15),
    territory_number varchar(15),
    ims_id varchar(10),
    tvcmid int,
    row_create_date date
);


CREATE TABLE archive.wholesaler_sales_867_20180921
(
    trading_partner varchar(50),
    partner_duns varchar(15),
    partner_duns_4 varchar(15),
    partner_dea varchar(20),
    partner_hin varchar(20),
    partner_seller_assigned_id varchar(50),
    partner_buyer_assigned_id varchar(50),
    client_name varchar(50),
    address_line_1 varchar(50),
    address_line_2 varchar(50),
    city varchar(50),
    state varchar(2),
    zip varchar(15),
    client_duns varchar(15),
    client_dea varchar(20),
    client_hin varchar(20),
    client_seller_assigned_id varchar(50),
    client_buyer_assigned_id varchar(50),
    ncpdp varchar(20),
    ndc varchar(20),
    basket_id int,
    basket_name varchar(300),
    ship_date date,
    ship_date_month date,
    ship_date_quarter varchar(7),
    quantity_purchased float,
    quantity_returned float,
    unit_price float,
    gross_amount float,
    drop_shipments float,
    file_id int,
    record_id int,
    tvcmid int
);


CREATE TABLE archive.copay_voucher_program_20181010
(
    redemption_type varchar(20),
    program_number varchar(10),
    program_description varchar(100),
    create_date date
);


CREATE TABLE archive.metadata_workflow_steps_20190103
(
    pkId int,
    WorkflowId int,
    StepOrder int,
    StepDescription varchar(50)
);


CREATE TABLE archive.ddd_445_calendar_2018
(
    start_date date,
    end_date date,
    period varchar(7)
);


CREATE PROJECTION archive.basket_20180307_b0 /*+basename(basket_20180307),createtype(A)*/ 
(
 basket_id,
 name,
 description,
 teva_product_code,
 basket_type,
 create_date
)
AS
 SELECT basket_20180307.basket_id,
        basket_20180307.name,
        basket_20180307.description,
        basket_20180307.teva_product_code,
        basket_20180307.basket_type,
        basket_20180307.create_date
 FROM archive.basket_20180307
 ORDER BY basket_20180307.basket_type,
          basket_20180307.teva_product_code,
          basket_20180307.basket_id
SEGMENTED BY hash(basket_20180307.basket_id, basket_20180307.create_date, basket_20180307.teva_product_code, basket_20180307.basket_type, basket_20180307.name, basket_20180307.description) ALL NODES;

CREATE PROJECTION archive.basket_item_20180307_b0 /*+basename(basket_item_20180307),createtype(A)*/ 
(
 basket_id,
 entity_type,
 entity_id
)
AS
 SELECT basket_item_20180307.basket_id,
        basket_item_20180307.entity_type,
        basket_item_20180307.entity_id
 FROM archive.basket_item_20180307
 ORDER BY basket_item_20180307.entity_type,
          basket_item_20180307.basket_id,
          basket_item_20180307.entity_id
SEGMENTED BY hash(basket_item_20180307.basket_id, basket_item_20180307.entity_id, basket_item_20180307.entity_type) ALL NODES;

CREATE PROJECTION archive.source_product_20180307_b0 /*+basename(source_product_20180307),createtype(A)*/ 
(
 source_id,
 feed_id,
 feed_version,
 entity_type,
 entity_id,
 source_file_code,
 source_product_code,
 source_product_name,
 source_product_description,
 source_product_mfg_name,
 source_client_num,
 source_report_num,
 source_indication,
 create_date
)
AS
 SELECT source_product_20180307.source_id,
        source_product_20180307.feed_id,
        source_product_20180307.feed_version,
        source_product_20180307.entity_type,
        source_product_20180307.entity_id,
        source_product_20180307.source_file_code,
        source_product_20180307.source_product_code,
        source_product_20180307.source_product_name,
        source_product_20180307.source_product_description,
        source_product_20180307.source_product_mfg_name,
        source_product_20180307.source_client_num,
        source_product_20180307.source_report_num,
        source_product_20180307.source_indication,
        source_product_20180307.create_date
 FROM archive.source_product_20180307
 ORDER BY source_product_20180307.entity_id,
          source_product_20180307.feed_version,
          source_product_20180307.source_product_mfg_name,
          source_product_20180307.entity_type,
          source_product_20180307.source_indication,
          source_product_20180307.source_client_num,
          source_product_20180307.source_file_code,
          source_product_20180307.source_id,
          source_product_20180307.source_report_num,
          source_product_20180307.feed_id,
          source_product_20180307.source_product_description,
          source_product_20180307.source_product_name,
          source_product_20180307.source_product_code
SEGMENTED BY hash(source_product_20180307.source_id, source_product_20180307.feed_id, source_product_20180307.feed_version, source_product_20180307.entity_id, source_product_20180307.create_date, source_product_20180307.entity_type, source_product_20180307.source_indication, source_product_20180307.source_file_code, source_product_20180307.source_client_num, source_product_20180307.source_report_num, source_product_20180307.source_product_code, source_product_20180307.source_product_mfg_name, source_product_20180307.source_product_name, source_product_20180307.source_product_description) ALL NODES;

CREATE PROJECTION archive.data_feed_version_validation_rules_20180412_b0 /*+basename(data_feed_version_validation_rules_20180412),createtype(A)*/ 
(
 pkId,
 feed_id,
 feed_version_id,
 field,
 parameters,
 validation_rule_code,
 date_format
)
AS
 SELECT data_feed_version_validation_rules_20180412.pkId,
        data_feed_version_validation_rules_20180412.feed_id,
        data_feed_version_validation_rules_20180412.feed_version_id,
        data_feed_version_validation_rules_20180412.field,
        data_feed_version_validation_rules_20180412.parameters,
        data_feed_version_validation_rules_20180412.validation_rule_code,
        data_feed_version_validation_rules_20180412.date_format
 FROM archive.data_feed_version_validation_rules_20180412
 ORDER BY data_feed_version_validation_rules_20180412.pkId
SEGMENTED BY hash(data_feed_version_validation_rules_20180412.pkId) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demographics_20180419_b0 /*+basename(prescriber_combined_demographics_20180419),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 npi,
 tvcmid,
 ptr_address_2,
 ptr_address_3,
 address_id,
 address_latitude,
 address_longitude
)
AS
 SELECT prescriber_combined_demographics_20180419.sales_force_id,
        prescriber_combined_demographics_20180419.ims_id,
        prescriber_combined_demographics_20180419.veeva_account_id,
        prescriber_combined_demographics_20180419.specialty,
        prescriber_combined_demographics_20180419.first_name,
        prescriber_combined_demographics_20180419.middle_name,
        prescriber_combined_demographics_20180419.last_name,
        prescriber_combined_demographics_20180419.ptr_veeva_address_id,
        prescriber_combined_demographics_20180419.ptr_address_1,
        prescriber_combined_demographics_20180419.ptr_city,
        prescriber_combined_demographics_20180419.ptr_state,
        prescriber_combined_demographics_20180419.ptr_zip,
        prescriber_combined_demographics_20180419.ptr_phone,
        prescriber_combined_demographics_20180419.ptr_territory_num,
        prescriber_combined_demographics_20180419.ptr_territory_type,
        prescriber_combined_demographics_20180419.ptr_address_source,
        prescriber_combined_demographics_20180419.ptr_mailable,
        prescriber_combined_demographics_20180419.dea_num,
        prescriber_combined_demographics_20180419.pdrp_flag,
        prescriber_combined_demographics_20180419.pdrp_date,
        prescriber_combined_demographics_20180419.np_pa_flag,
        prescriber_combined_demographics_20180419.no_spend,
        prescriber_combined_demographics_20180419.ama_no_contact_flag,
        prescriber_combined_demographics_20180419.email,
        prescriber_combined_demographics_20180419.degree,
        prescriber_combined_demographics_20180419.npi,
        prescriber_combined_demographics_20180419.tvcmid,
        prescriber_combined_demographics_20180419.ptr_address_2,
        prescriber_combined_demographics_20180419.ptr_address_3,
        prescriber_combined_demographics_20180419.address_id,
        prescriber_combined_demographics_20180419.address_latitude,
        prescriber_combined_demographics_20180419.address_longitude
 FROM archive.prescriber_combined_demographics_20180419
 ORDER BY prescriber_combined_demographics_20180419.sales_force_id,
          prescriber_combined_demographics_20180419.ims_id
SEGMENTED BY hash(prescriber_combined_demographics_20180419.ims_id) ALL NODES;

CREATE PROJECTION archive.copay_20180604_b0 /*+basename(copay_20180604),createtype(A)*/ 
(
 redemption_type,
 asi_txn_id,
 orig_asi_txn_id,
 rx_num,
 fill_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 basket_id,
 basket_name,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 program_number,
 copay_card_number,
 sex,
 age_at_redemption,
 pharmacy_process_date,
 pharmacy_chain_number,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_npi_num,
 principle_physician_dea,
 physician_npi,
 physician_ims_id,
 physician_veeva_id,
 physician_name,
 physician_address1,
 physician_address2,
 physician_city,
 physician_state,
 physician_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 calc_awp,
 create_date,
 occ_payment_type,
 counted_copay,
 file_id,
 record_id,
 physician_tvcmid,
 pharmacy_tvcmid,
 report_frequency,
 source_name,
 auth_refills,
 admin_hcp_npi,
 admin_hcp_name,
 admin_hcp_address,
 admin_hcp_address2,
 admin_hcp_city,
 admin_hcp_state,
 admin_hcp_zip,
 claim_type,
 administration_flag,
 soc_name,
 soc_phone,
 soc_fax,
 soc_address,
 soc_city,
 soc_state,
 soc_zip,
 soc_id,
 soc_npi,
 payer_name,
 cpt_code,
 trans_type,
 previous_payer_id,
 member_id,
 benefit_amount,
 patient_expense,
 submission_method
)
AS
 SELECT copay_20180604.redemption_type,
        copay_20180604.asi_txn_id,
        copay_20180604.orig_asi_txn_id,
        copay_20180604.rx_num,
        copay_20180604.fill_date,
        copay_20180604.date_written,
        copay_20180604.days_supply,
        copay_20180604.ndc_code,
        copay_20180604.daw,
        copay_20180604.basket_id,
        copay_20180604.basket_name,
        copay_20180604.new_refill,
        copay_20180604.quantity,
        copay_20180604.refills,
        copay_20180604.other_coverage_code,
        copay_20180604.program_number,
        copay_20180604.copay_card_number,
        copay_20180604.sex,
        copay_20180604.age_at_redemption,
        copay_20180604.pharmacy_process_date,
        copay_20180604.pharmacy_chain_number,
        copay_20180604.nabp,
        copay_20180604.pharmacy_chain,
        copay_20180604.pharmacy_name,
        copay_20180604.pharmacy_address,
        copay_20180604.pharmacy_address2,
        copay_20180604.pharmacy_city,
        copay_20180604.pharmacy_state,
        copay_20180604.pharmacy_zip,
        copay_20180604.pharmacy_phone,
        copay_20180604.pharmacy_npi_num,
        copay_20180604.principle_physician_dea,
        copay_20180604.physician_npi,
        copay_20180604.physician_ims_id,
        copay_20180604.physician_veeva_id,
        copay_20180604.physician_name,
        copay_20180604.physician_address1,
        copay_20180604.physician_address2,
        copay_20180604.physician_city,
        copay_20180604.physician_state,
        copay_20180604.physician_zip,
        copay_20180604.rebate_amount,
        copay_20180604.member_cash_expense,
        copay_20180604.submitted_cost,
        copay_20180604.pharmacy_fee,
        copay_20180604.total_amount_due,
        copay_20180604.calc_awp,
        copay_20180604.create_date,
        copay_20180604.occ_payment_type,
        copay_20180604.counted_copay,
        copay_20180604.file_id,
        copay_20180604.record_id,
        copay_20180604.physician_tvcmid,
        copay_20180604.pharmacy_tvcmid,
        copay_20180604.report_frequency,
        copay_20180604.source_name,
        copay_20180604.auth_refills,
        copay_20180604.admin_hcp_npi,
        copay_20180604.admin_hcp_name,
        copay_20180604.admin_hcp_address,
        copay_20180604.admin_hcp_address2,
        copay_20180604.admin_hcp_city,
        copay_20180604.admin_hcp_state,
        copay_20180604.admin_hcp_zip,
        copay_20180604.claim_type,
        copay_20180604.administration_flag,
        copay_20180604.soc_name,
        copay_20180604.soc_phone,
        copay_20180604.soc_fax,
        copay_20180604.soc_address,
        copay_20180604.soc_city,
        copay_20180604.soc_state,
        copay_20180604.soc_zip,
        copay_20180604.soc_id,
        copay_20180604.soc_npi,
        copay_20180604.payer_name,
        copay_20180604.cpt_code,
        copay_20180604.trans_type,
        copay_20180604.previous_payer_id,
        copay_20180604.member_id,
        copay_20180604.benefit_amount,
        copay_20180604.patient_expense,
        copay_20180604.submission_method
 FROM archive.copay_20180604
 ORDER BY copay_20180604.redemption_type,
          copay_20180604.asi_txn_id,
          copay_20180604.orig_asi_txn_id,
          copay_20180604.rx_num,
          copay_20180604.fill_date,
          copay_20180604.date_written,
          copay_20180604.days_supply,
          copay_20180604.ndc_code,
          copay_20180604.daw,
          copay_20180604.basket_id,
          copay_20180604.basket_name,
          copay_20180604.new_refill,
          copay_20180604.quantity,
          copay_20180604.refills,
          copay_20180604.other_coverage_code,
          copay_20180604.program_number,
          copay_20180604.copay_card_number,
          copay_20180604.sex,
          copay_20180604.age_at_redemption,
          copay_20180604.pharmacy_process_date,
          copay_20180604.pharmacy_chain_number,
          copay_20180604.nabp,
          copay_20180604.pharmacy_chain,
          copay_20180604.pharmacy_name,
          copay_20180604.pharmacy_address,
          copay_20180604.pharmacy_address2,
          copay_20180604.pharmacy_city,
          copay_20180604.pharmacy_state,
          copay_20180604.pharmacy_zip,
          copay_20180604.pharmacy_phone
SEGMENTED BY hash(copay_20180604.record_id) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demo_frozen_20180621_b0 /*+basename(prescriber_combined_demo_frozen_20180621),createtype(A)*/ 
(
 start_date,
 end_date,
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source,
 freeze_reason,
 freeze_date
)
AS
 SELECT prescriber_combined_demo_frozen_20180621.start_date,
        prescriber_combined_demo_frozen_20180621.end_date,
        prescriber_combined_demo_frozen_20180621.sales_force_id,
        prescriber_combined_demo_frozen_20180621.ims_id,
        prescriber_combined_demo_frozen_20180621.npi,
        prescriber_combined_demo_frozen_20180621.tvcmid,
        prescriber_combined_demo_frozen_20180621.veeva_account_id,
        prescriber_combined_demo_frozen_20180621.specialty,
        prescriber_combined_demo_frozen_20180621.first_name,
        prescriber_combined_demo_frozen_20180621.middle_name,
        prescriber_combined_demo_frozen_20180621.last_name,
        prescriber_combined_demo_frozen_20180621.ptr_veeva_address_id,
        prescriber_combined_demo_frozen_20180621.ptr_address_1,
        prescriber_combined_demo_frozen_20180621.ptr_address_2,
        prescriber_combined_demo_frozen_20180621.ptr_address_3,
        prescriber_combined_demo_frozen_20180621.ptr_city,
        prescriber_combined_demo_frozen_20180621.ptr_state,
        prescriber_combined_demo_frozen_20180621.ptr_zip,
        prescriber_combined_demo_frozen_20180621.ptr_phone,
        prescriber_combined_demo_frozen_20180621.ptr_territory_num,
        prescriber_combined_demo_frozen_20180621.ptr_territory_type,
        prescriber_combined_demo_frozen_20180621.ptr_address_source,
        prescriber_combined_demo_frozen_20180621.ptr_mailable,
        prescriber_combined_demo_frozen_20180621.dea_num,
        prescriber_combined_demo_frozen_20180621.pdrp_flag,
        prescriber_combined_demo_frozen_20180621.pdrp_date,
        prescriber_combined_demo_frozen_20180621.np_pa_flag,
        prescriber_combined_demo_frozen_20180621.no_spend,
        prescriber_combined_demo_frozen_20180621.ama_no_contact_flag,
        prescriber_combined_demo_frozen_20180621.email,
        prescriber_combined_demo_frozen_20180621.degree,
        prescriber_combined_demo_frozen_20180621.address_id,
        prescriber_combined_demo_frozen_20180621.address_latitude,
        prescriber_combined_demo_frozen_20180621.address_longitude,
        prescriber_combined_demo_frozen_20180621.row_source,
        prescriber_combined_demo_frozen_20180621.freeze_reason,
        prescriber_combined_demo_frozen_20180621.freeze_date
 FROM archive.prescriber_combined_demo_frozen_20180621
 ORDER BY prescriber_combined_demo_frozen_20180621.sales_force_id,
          prescriber_combined_demo_frozen_20180621.ims_id,
          prescriber_combined_demo_frozen_20180621.npi,
          prescriber_combined_demo_frozen_20180621.tvcmid,
          prescriber_combined_demo_frozen_20180621.veeva_account_id,
          prescriber_combined_demo_frozen_20180621.specialty,
          prescriber_combined_demo_frozen_20180621.first_name,
          prescriber_combined_demo_frozen_20180621.middle_name,
          prescriber_combined_demo_frozen_20180621.last_name,
          prescriber_combined_demo_frozen_20180621.ptr_veeva_address_id,
          prescriber_combined_demo_frozen_20180621.ptr_address_1,
          prescriber_combined_demo_frozen_20180621.ptr_address_2,
          prescriber_combined_demo_frozen_20180621.ptr_address_3,
          prescriber_combined_demo_frozen_20180621.ptr_city,
          prescriber_combined_demo_frozen_20180621.ptr_state,
          prescriber_combined_demo_frozen_20180621.ptr_zip,
          prescriber_combined_demo_frozen_20180621.ptr_phone,
          prescriber_combined_demo_frozen_20180621.ptr_territory_num,
          prescriber_combined_demo_frozen_20180621.ptr_territory_type,
          prescriber_combined_demo_frozen_20180621.ptr_address_source,
          prescriber_combined_demo_frozen_20180621.ptr_mailable,
          prescriber_combined_demo_frozen_20180621.dea_num,
          prescriber_combined_demo_frozen_20180621.pdrp_flag,
          prescriber_combined_demo_frozen_20180621.pdrp_date,
          prescriber_combined_demo_frozen_20180621.np_pa_flag,
          prescriber_combined_demo_frozen_20180621.no_spend,
          prescriber_combined_demo_frozen_20180621.ama_no_contact_flag,
          prescriber_combined_demo_frozen_20180621.email,
          prescriber_combined_demo_frozen_20180621.degree,
          prescriber_combined_demo_frozen_20180621.address_id,
          prescriber_combined_demo_frozen_20180621.address_latitude,
          prescriber_combined_demo_frozen_20180621.address_longitude,
          prescriber_combined_demo_frozen_20180621.row_source
SEGMENTED BY hash(prescriber_combined_demo_frozen_20180621.tvcmid, prescriber_combined_demo_frozen_20180621.ptr_state, prescriber_combined_demo_frozen_20180621.ptr_zip, prescriber_combined_demo_frozen_20180621.ptr_mailable, prescriber_combined_demo_frozen_20180621.pdrp_flag, prescriber_combined_demo_frozen_20180621.pdrp_date, prescriber_combined_demo_frozen_20180621.np_pa_flag, prescriber_combined_demo_frozen_20180621.no_spend, prescriber_combined_demo_frozen_20180621.ama_no_contact_flag, prescriber_combined_demo_frozen_20180621.address_id, prescriber_combined_demo_frozen_20180621.ims_id, prescriber_combined_demo_frozen_20180621.npi, prescriber_combined_demo_frozen_20180621.dea_num, prescriber_combined_demo_frozen_20180621.ptr_territory_num, prescriber_combined_demo_frozen_20180621.sales_force_id, prescriber_combined_demo_frozen_20180621.veeva_account_id, prescriber_combined_demo_frozen_20180621.ptr_veeva_address_id, prescriber_combined_demo_frozen_20180621.address_latitude, prescriber_combined_demo_frozen_20180621.address_longitude, prescriber_combined_demo_frozen_20180621.ptr_territory_type, prescriber_combined_demo_frozen_20180621.ptr_phone, prescriber_combined_demo_frozen_20180621.first_name, prescriber_combined_demo_frozen_20180621.middle_name, prescriber_combined_demo_frozen_20180621.last_name, prescriber_combined_demo_frozen_20180621.ptr_city, prescriber_combined_demo_frozen_20180621.ptr_address_source, prescriber_combined_demo_frozen_20180621.ptr_address_1, prescriber_combined_demo_frozen_20180621.ptr_address_2, prescriber_combined_demo_frozen_20180621.ptr_address_3, prescriber_combined_demo_frozen_20180621.email, prescriber_combined_demo_frozen_20180621.degree, prescriber_combined_demo_frozen_20180621.row_source) ALL NODES;

CREATE PROJECTION archive.workflow_steps_20180718_b0 /*+basename(workflow_steps_20180718),createtype(A)*/ 
(
 pkId,
 WorkflowId,
 StepOrder,
 StepDescription
)
AS
 SELECT workflow_steps_20180718.pkId,
        workflow_steps_20180718.WorkflowId,
        workflow_steps_20180718.StepOrder,
        workflow_steps_20180718.StepDescription
 FROM archive.workflow_steps_20180718
 ORDER BY workflow_steps_20180718.pkId
SEGMENTED BY hash(workflow_steps_20180718.pkId) ALL NODES;

CREATE PROJECTION archive.tw_address_20180718_b0 /*+basename(tw_address_20180718),createtype(A)*/ 
(
 specialty_pharmacy_data_source,
 address_id,
 address,
 city,
 state,
 zip_code,
 phone,
 fax,
 email,
 tax_id
)
AS
 SELECT tw_address_20180718.specialty_pharmacy_data_source,
        tw_address_20180718.address_id,
        tw_address_20180718.address,
        tw_address_20180718.city,
        tw_address_20180718.state,
        tw_address_20180718.zip_code,
        tw_address_20180718.phone,
        tw_address_20180718.fax,
        tw_address_20180718.email,
        tw_address_20180718.tax_id
 FROM archive.tw_address_20180718
 ORDER BY tw_address_20180718.specialty_pharmacy_data_source,
          tw_address_20180718.address_id,
          tw_address_20180718.address,
          tw_address_20180718.city,
          tw_address_20180718.state,
          tw_address_20180718.zip_code,
          tw_address_20180718.phone,
          tw_address_20180718.fax,
          tw_address_20180718.email,
          tw_address_20180718.tax_id
SEGMENTED BY hash(tw_address_20180718.address_id) ALL NODES;

CREATE PROJECTION archive.tw_address_xref_20180718_b0 /*+basename(tw_address_xref_20180718),createtype(A)*/ 
(
 specialty_pharmacy_data_source,
 customer_code,
 address_id,
 address_type
)
AS
 SELECT tw_address_xref_20180718.specialty_pharmacy_data_source,
        tw_address_xref_20180718.customer_code,
        tw_address_xref_20180718.address_id,
        tw_address_xref_20180718.address_type
 FROM archive.tw_address_xref_20180718
 ORDER BY tw_address_xref_20180718.specialty_pharmacy_data_source,
          tw_address_xref_20180718.customer_code,
          tw_address_xref_20180718.address_id,
          tw_address_xref_20180718.address_type
SEGMENTED BY hash(tw_address_xref_20180718.address_id, tw_address_xref_20180718.specialty_pharmacy_data_source, tw_address_xref_20180718.customer_code, tw_address_xref_20180718.address_type) ALL NODES;

CREATE PROJECTION archive.tw_account_20180718_b0 /*+basename(tw_account_20180718),createtype(A)*/ 
(
 specialty_pharmacy_data_source,
 customer_id,
 customer_name,
 parent_customer_id,
 parent_customer_name,
 customer_type,
 pvp_340B_id,
 HIN,
 DEA_NUM
)
AS
 SELECT tw_account_20180718.specialty_pharmacy_data_source,
        tw_account_20180718.customer_id,
        tw_account_20180718.customer_name,
        tw_account_20180718.parent_customer_id,
        tw_account_20180718.parent_customer_name,
        tw_account_20180718.customer_type,
        tw_account_20180718.pvp_340B_id,
        tw_account_20180718.HIN,
        tw_account_20180718.DEA_NUM
 FROM archive.tw_account_20180718
 ORDER BY tw_account_20180718.specialty_pharmacy_data_source,
          tw_account_20180718.customer_id,
          tw_account_20180718.customer_name,
          tw_account_20180718.parent_customer_id,
          tw_account_20180718.parent_customer_name,
          tw_account_20180718.customer_type,
          tw_account_20180718.pvp_340B_id
SEGMENTED BY hash(tw_account_20180718.specialty_pharmacy_data_source, tw_account_20180718.customer_id, tw_account_20180718.parent_customer_id, tw_account_20180718.customer_type, tw_account_20180718.customer_name, tw_account_20180718.parent_customer_name, tw_account_20180718.pvp_340B_id) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demo_frozen_20180724_b0 /*+basename(prescriber_combined_demo_frozen_20180724),createtype(A)*/ 
(
 start_date,
 end_date,
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source,
 freeze_reason,
 freeze_date
)
AS
 SELECT prescriber_combined_demo_frozen_20180724.start_date,
        prescriber_combined_demo_frozen_20180724.end_date,
        prescriber_combined_demo_frozen_20180724.sales_force_id,
        prescriber_combined_demo_frozen_20180724.ims_id,
        prescriber_combined_demo_frozen_20180724.npi,
        prescriber_combined_demo_frozen_20180724.tvcmid,
        prescriber_combined_demo_frozen_20180724.veeva_account_id,
        prescriber_combined_demo_frozen_20180724.specialty,
        prescriber_combined_demo_frozen_20180724.first_name,
        prescriber_combined_demo_frozen_20180724.middle_name,
        prescriber_combined_demo_frozen_20180724.last_name,
        prescriber_combined_demo_frozen_20180724.ptr_veeva_address_id,
        prescriber_combined_demo_frozen_20180724.ptr_address_1,
        prescriber_combined_demo_frozen_20180724.ptr_address_2,
        prescriber_combined_demo_frozen_20180724.ptr_address_3,
        prescriber_combined_demo_frozen_20180724.ptr_city,
        prescriber_combined_demo_frozen_20180724.ptr_state,
        prescriber_combined_demo_frozen_20180724.ptr_zip,
        prescriber_combined_demo_frozen_20180724.ptr_phone,
        prescriber_combined_demo_frozen_20180724.ptr_territory_num,
        prescriber_combined_demo_frozen_20180724.ptr_territory_type,
        prescriber_combined_demo_frozen_20180724.ptr_address_source,
        prescriber_combined_demo_frozen_20180724.ptr_mailable,
        prescriber_combined_demo_frozen_20180724.dea_num,
        prescriber_combined_demo_frozen_20180724.pdrp_flag,
        prescriber_combined_demo_frozen_20180724.pdrp_date,
        prescriber_combined_demo_frozen_20180724.np_pa_flag,
        prescriber_combined_demo_frozen_20180724.no_spend,
        prescriber_combined_demo_frozen_20180724.ama_no_contact_flag,
        prescriber_combined_demo_frozen_20180724.email,
        prescriber_combined_demo_frozen_20180724.degree,
        prescriber_combined_demo_frozen_20180724.address_id,
        prescriber_combined_demo_frozen_20180724.address_latitude,
        prescriber_combined_demo_frozen_20180724.address_longitude,
        prescriber_combined_demo_frozen_20180724.row_source,
        prescriber_combined_demo_frozen_20180724.freeze_reason,
        prescriber_combined_demo_frozen_20180724.freeze_date
 FROM archive.prescriber_combined_demo_frozen_20180724
 ORDER BY prescriber_combined_demo_frozen_20180724.sales_force_id,
          prescriber_combined_demo_frozen_20180724.ims_id,
          prescriber_combined_demo_frozen_20180724.npi,
          prescriber_combined_demo_frozen_20180724.tvcmid,
          prescriber_combined_demo_frozen_20180724.veeva_account_id,
          prescriber_combined_demo_frozen_20180724.specialty,
          prescriber_combined_demo_frozen_20180724.first_name,
          prescriber_combined_demo_frozen_20180724.middle_name,
          prescriber_combined_demo_frozen_20180724.last_name,
          prescriber_combined_demo_frozen_20180724.ptr_veeva_address_id,
          prescriber_combined_demo_frozen_20180724.ptr_address_1,
          prescriber_combined_demo_frozen_20180724.ptr_address_2,
          prescriber_combined_demo_frozen_20180724.ptr_address_3,
          prescriber_combined_demo_frozen_20180724.ptr_city,
          prescriber_combined_demo_frozen_20180724.ptr_state,
          prescriber_combined_demo_frozen_20180724.ptr_zip,
          prescriber_combined_demo_frozen_20180724.ptr_phone,
          prescriber_combined_demo_frozen_20180724.ptr_territory_num,
          prescriber_combined_demo_frozen_20180724.ptr_territory_type,
          prescriber_combined_demo_frozen_20180724.ptr_address_source,
          prescriber_combined_demo_frozen_20180724.ptr_mailable,
          prescriber_combined_demo_frozen_20180724.dea_num,
          prescriber_combined_demo_frozen_20180724.pdrp_flag,
          prescriber_combined_demo_frozen_20180724.pdrp_date,
          prescriber_combined_demo_frozen_20180724.np_pa_flag,
          prescriber_combined_demo_frozen_20180724.no_spend,
          prescriber_combined_demo_frozen_20180724.ama_no_contact_flag,
          prescriber_combined_demo_frozen_20180724.email,
          prescriber_combined_demo_frozen_20180724.degree,
          prescriber_combined_demo_frozen_20180724.address_id,
          prescriber_combined_demo_frozen_20180724.address_latitude,
          prescriber_combined_demo_frozen_20180724.address_longitude,
          prescriber_combined_demo_frozen_20180724.row_source
SEGMENTED BY hash(prescriber_combined_demo_frozen_20180724.tvcmid, prescriber_combined_demo_frozen_20180724.ptr_state, prescriber_combined_demo_frozen_20180724.ptr_zip, prescriber_combined_demo_frozen_20180724.ptr_mailable, prescriber_combined_demo_frozen_20180724.pdrp_flag, prescriber_combined_demo_frozen_20180724.pdrp_date, prescriber_combined_demo_frozen_20180724.np_pa_flag, prescriber_combined_demo_frozen_20180724.no_spend, prescriber_combined_demo_frozen_20180724.ama_no_contact_flag, prescriber_combined_demo_frozen_20180724.address_id, prescriber_combined_demo_frozen_20180724.ims_id, prescriber_combined_demo_frozen_20180724.npi, prescriber_combined_demo_frozen_20180724.dea_num, prescriber_combined_demo_frozen_20180724.ptr_territory_num, prescriber_combined_demo_frozen_20180724.sales_force_id, prescriber_combined_demo_frozen_20180724.veeva_account_id, prescriber_combined_demo_frozen_20180724.ptr_veeva_address_id, prescriber_combined_demo_frozen_20180724.address_latitude, prescriber_combined_demo_frozen_20180724.address_longitude, prescriber_combined_demo_frozen_20180724.ptr_territory_type, prescriber_combined_demo_frozen_20180724.ptr_phone, prescriber_combined_demo_frozen_20180724.first_name, prescriber_combined_demo_frozen_20180724.middle_name, prescriber_combined_demo_frozen_20180724.last_name, prescriber_combined_demo_frozen_20180724.ptr_city, prescriber_combined_demo_frozen_20180724.ptr_address_source, prescriber_combined_demo_frozen_20180724.ptr_address_1, prescriber_combined_demo_frozen_20180724.ptr_address_2, prescriber_combined_demo_frozen_20180724.ptr_address_3, prescriber_combined_demo_frozen_20180724.email, prescriber_combined_demo_frozen_20180724.degree, prescriber_combined_demo_frozen_20180724.row_source) ALL NODES;

CREATE PROJECTION archive.mdm_address_20180724_b0 /*+basename(mdm_address_20180724),createtype(A)*/ 
(
 tvcmid,
 address_id,
 address_type,
 address_type_name,
 address_line_1,
 address_line_2,
 county,
 city,
 state,
 state_name,
 country_code,
 country_name,
 zip5_postal_code,
 zip4_postal_extension_code,
 address_status,
 address_status_name,
 address_effective_date,
 msa_cbsa,
 fips_state_code,
 fips_state_description,
 fips_county_code,
 fips_county_description,
 deliverability_confidence,
 address_setting_type_code,
 address_setting_type_description,
 address_category_code,
 address_category_description,
 address_latitude,
 address_longitude,
 postal_barcode,
 single_address_indicator,
 practice_location_confidence_indicator,
 practice_location_rank,
 validation_message,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_address_20180724.tvcmid,
        mdm_address_20180724.address_id,
        mdm_address_20180724.address_type,
        mdm_address_20180724.address_type_name,
        mdm_address_20180724.address_line_1,
        mdm_address_20180724.address_line_2,
        mdm_address_20180724.county,
        mdm_address_20180724.city,
        mdm_address_20180724.state,
        mdm_address_20180724.state_name,
        mdm_address_20180724.country_code,
        mdm_address_20180724.country_name,
        mdm_address_20180724.zip5_postal_code,
        mdm_address_20180724.zip4_postal_extension_code,
        mdm_address_20180724.address_status,
        mdm_address_20180724.address_status_name,
        mdm_address_20180724.address_effective_date,
        mdm_address_20180724.msa_cbsa,
        mdm_address_20180724.fips_state_code,
        mdm_address_20180724.fips_state_description,
        mdm_address_20180724.fips_county_code,
        mdm_address_20180724.fips_county_description,
        mdm_address_20180724.deliverability_confidence,
        mdm_address_20180724.address_setting_type_code,
        mdm_address_20180724.address_setting_type_description,
        mdm_address_20180724.address_category_code,
        mdm_address_20180724.address_category_description,
        mdm_address_20180724.address_latitude,
        mdm_address_20180724.address_longitude,
        mdm_address_20180724.postal_barcode,
        mdm_address_20180724.single_address_indicator,
        mdm_address_20180724.practice_location_confidence_indicator,
        mdm_address_20180724.practice_location_rank,
        mdm_address_20180724.validation_message,
        mdm_address_20180724.created_by,
        mdm_address_20180724.created_date,
        mdm_address_20180724.updated_by,
        mdm_address_20180724.updated_date,
        mdm_address_20180724.file_id,
        mdm_address_20180724.record_id
 FROM archive.mdm_address_20180724
 ORDER BY mdm_address_20180724.tvcmid,
          mdm_address_20180724.address_id,
          mdm_address_20180724.address_type,
          mdm_address_20180724.address_type_name,
          mdm_address_20180724.address_line_1,
          mdm_address_20180724.address_line_2,
          mdm_address_20180724.county,
          mdm_address_20180724.city,
          mdm_address_20180724.state,
          mdm_address_20180724.state_name,
          mdm_address_20180724.country_code,
          mdm_address_20180724.country_name,
          mdm_address_20180724.zip5_postal_code,
          mdm_address_20180724.zip4_postal_extension_code,
          mdm_address_20180724.address_status,
          mdm_address_20180724.address_status_name,
          mdm_address_20180724.address_effective_date,
          mdm_address_20180724.msa_cbsa,
          mdm_address_20180724.fips_state_code,
          mdm_address_20180724.fips_state_description,
          mdm_address_20180724.fips_county_code,
          mdm_address_20180724.fips_county_description,
          mdm_address_20180724.deliverability_confidence,
          mdm_address_20180724.address_setting_type_code,
          mdm_address_20180724.address_setting_type_description,
          mdm_address_20180724.address_category_code,
          mdm_address_20180724.address_category_description,
          mdm_address_20180724.address_latitude,
          mdm_address_20180724.address_longitude,
          mdm_address_20180724.postal_barcode,
          mdm_address_20180724.single_address_indicator,
          mdm_address_20180724.practice_location_confidence_indicator,
          mdm_address_20180724.practice_location_rank,
          mdm_address_20180724.validation_message,
          mdm_address_20180724.created_by,
          mdm_address_20180724.created_date,
          mdm_address_20180724.updated_by,
          mdm_address_20180724.updated_date,
          mdm_address_20180724.file_id,
          mdm_address_20180724.record_id
SEGMENTED BY hash(mdm_address_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_address_link_20180724_b0 /*+basename(mdm_address_link_20180724),createtype(A)*/ 
(
 tvcmid,
 address_id,
 dsp_id,
 dsp_hce_id,
 dsp_address_id,
 file_id,
 record_id
)
AS
 SELECT mdm_address_link_20180724.tvcmid,
        mdm_address_link_20180724.address_id,
        mdm_address_link_20180724.dsp_id,
        mdm_address_link_20180724.dsp_hce_id,
        mdm_address_link_20180724.dsp_address_id,
        mdm_address_link_20180724.file_id,
        mdm_address_link_20180724.record_id
 FROM archive.mdm_address_link_20180724
 ORDER BY mdm_address_link_20180724.tvcmid,
          mdm_address_link_20180724.address_id,
          mdm_address_link_20180724.dsp_id,
          mdm_address_link_20180724.dsp_hce_id,
          mdm_address_link_20180724.dsp_address_id,
          mdm_address_link_20180724.file_id,
          mdm_address_link_20180724.record_id
SEGMENTED BY hash(mdm_address_link_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_alternate_id_20180724_b0 /*+basename(mdm_alternate_id_20180724),createtype(A)*/ 
(
 tvcmid,
 alternate_id_type,
 alternate_id_type_name,
 alternate_id_value,
 state,
 state_name,
 identifier_category,
 status,
 status_name,
 source_deactivation_reason_code,
 source_deactivation_reason_description,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_alternate_id_20180724.tvcmid,
        mdm_alternate_id_20180724.alternate_id_type,
        mdm_alternate_id_20180724.alternate_id_type_name,
        mdm_alternate_id_20180724.alternate_id_value,
        mdm_alternate_id_20180724.state,
        mdm_alternate_id_20180724.state_name,
        mdm_alternate_id_20180724.identifier_category,
        mdm_alternate_id_20180724.status,
        mdm_alternate_id_20180724.status_name,
        mdm_alternate_id_20180724.source_deactivation_reason_code,
        mdm_alternate_id_20180724.source_deactivation_reason_description,
        mdm_alternate_id_20180724.created_by,
        mdm_alternate_id_20180724.created_date,
        mdm_alternate_id_20180724.updated_by,
        mdm_alternate_id_20180724.updated_date,
        mdm_alternate_id_20180724.file_id,
        mdm_alternate_id_20180724.record_id
 FROM archive.mdm_alternate_id_20180724
 ORDER BY mdm_alternate_id_20180724.tvcmid,
          mdm_alternate_id_20180724.alternate_id_type,
          mdm_alternate_id_20180724.alternate_id_type_name,
          mdm_alternate_id_20180724.alternate_id_value,
          mdm_alternate_id_20180724.state,
          mdm_alternate_id_20180724.state_name,
          mdm_alternate_id_20180724.identifier_category,
          mdm_alternate_id_20180724.status,
          mdm_alternate_id_20180724.status_name,
          mdm_alternate_id_20180724.source_deactivation_reason_code,
          mdm_alternate_id_20180724.source_deactivation_reason_description,
          mdm_alternate_id_20180724.created_by,
          mdm_alternate_id_20180724.created_date,
          mdm_alternate_id_20180724.updated_by,
          mdm_alternate_id_20180724.updated_date,
          mdm_alternate_id_20180724.file_id,
          mdm_alternate_id_20180724.record_id
SEGMENTED BY hash(mdm_alternate_id_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_alternate_name_20180724_b0 /*+basename(mdm_alternate_name_20180724),createtype(A)*/ 
(
 tvcmid,
 name_type,
 name_type_name,
 name_value,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_alternate_name_20180724.tvcmid,
        mdm_alternate_name_20180724.name_type,
        mdm_alternate_name_20180724.name_type_name,
        mdm_alternate_name_20180724.name_value,
        mdm_alternate_name_20180724.created_by,
        mdm_alternate_name_20180724.created_date,
        mdm_alternate_name_20180724.updated_by,
        mdm_alternate_name_20180724.updated_date,
        mdm_alternate_name_20180724.file_id,
        mdm_alternate_name_20180724.record_id
 FROM archive.mdm_alternate_name_20180724
 ORDER BY mdm_alternate_name_20180724.tvcmid,
          mdm_alternate_name_20180724.name_type,
          mdm_alternate_name_20180724.name_type_name,
          mdm_alternate_name_20180724.name_value,
          mdm_alternate_name_20180724.created_by,
          mdm_alternate_name_20180724.created_date,
          mdm_alternate_name_20180724.updated_by,
          mdm_alternate_name_20180724.updated_date,
          mdm_alternate_name_20180724.file_id,
          mdm_alternate_name_20180724.record_id
SEGMENTED BY hash(mdm_alternate_name_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_communication_20180724_b0 /*+basename(mdm_communication_20180724),createtype(A)*/ 
(
 tvcmid,
 address_id,
 communication_type,
 communication_type_name,
 communication_value,
 status_code,
 status_name,
 effective_start_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_communication_20180724.tvcmid,
        mdm_communication_20180724.address_id,
        mdm_communication_20180724.communication_type,
        mdm_communication_20180724.communication_type_name,
        mdm_communication_20180724.communication_value,
        mdm_communication_20180724.status_code,
        mdm_communication_20180724.status_name,
        mdm_communication_20180724.effective_start_date,
        mdm_communication_20180724.created_by,
        mdm_communication_20180724.created_date,
        mdm_communication_20180724.updated_by,
        mdm_communication_20180724.updated_date,
        mdm_communication_20180724.file_id,
        mdm_communication_20180724.record_id
 FROM archive.mdm_communication_20180724
 ORDER BY mdm_communication_20180724.tvcmid,
          mdm_communication_20180724.address_id,
          mdm_communication_20180724.communication_type,
          mdm_communication_20180724.communication_type_name,
          mdm_communication_20180724.communication_value,
          mdm_communication_20180724.status_code,
          mdm_communication_20180724.status_name,
          mdm_communication_20180724.effective_start_date,
          mdm_communication_20180724.created_by,
          mdm_communication_20180724.created_date,
          mdm_communication_20180724.updated_by,
          mdm_communication_20180724.updated_date,
          mdm_communication_20180724.file_id,
          mdm_communication_20180724.record_id
SEGMENTED BY hash(mdm_communication_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_dea_address_20180724_b0 /*+basename(mdm_dea_address_20180724),createtype(A)*/ 
(
 tvcmid,
 address_id,
 dea_number,
 business_activity_code,
 business_activity_description,
 sub_business_activity_code,
 sub_business_activity_description,
 dea_schedule_class_code,
 dea_status_code,
 dea_status_description,
 dea_expiration_date,
 dea_deactivation_reason_code,
 dea_deactivation_reason_description,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_dea_address_20180724.tvcmid,
        mdm_dea_address_20180724.address_id,
        mdm_dea_address_20180724.dea_number,
        mdm_dea_address_20180724.business_activity_code,
        mdm_dea_address_20180724.business_activity_description,
        mdm_dea_address_20180724.sub_business_activity_code,
        mdm_dea_address_20180724.sub_business_activity_description,
        mdm_dea_address_20180724.dea_schedule_class_code,
        mdm_dea_address_20180724.dea_status_code,
        mdm_dea_address_20180724.dea_status_description,
        mdm_dea_address_20180724.dea_expiration_date,
        mdm_dea_address_20180724.dea_deactivation_reason_code,
        mdm_dea_address_20180724.dea_deactivation_reason_description,
        mdm_dea_address_20180724.created_by,
        mdm_dea_address_20180724.created_date,
        mdm_dea_address_20180724.updated_by,
        mdm_dea_address_20180724.updated_date,
        mdm_dea_address_20180724.file_id,
        mdm_dea_address_20180724.record_id
 FROM archive.mdm_dea_address_20180724
 ORDER BY mdm_dea_address_20180724.tvcmid,
          mdm_dea_address_20180724.address_id,
          mdm_dea_address_20180724.dea_number,
          mdm_dea_address_20180724.business_activity_code,
          mdm_dea_address_20180724.business_activity_description,
          mdm_dea_address_20180724.sub_business_activity_code,
          mdm_dea_address_20180724.sub_business_activity_description,
          mdm_dea_address_20180724.dea_schedule_class_code,
          mdm_dea_address_20180724.dea_status_code,
          mdm_dea_address_20180724.dea_status_description,
          mdm_dea_address_20180724.dea_expiration_date,
          mdm_dea_address_20180724.dea_deactivation_reason_code,
          mdm_dea_address_20180724.dea_deactivation_reason_description,
          mdm_dea_address_20180724.created_by,
          mdm_dea_address_20180724.created_date,
          mdm_dea_address_20180724.updated_by,
          mdm_dea_address_20180724.updated_date,
          mdm_dea_address_20180724.file_id,
          mdm_dea_address_20180724.record_id
SEGMENTED BY hash(mdm_dea_address_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_email_preference_20180724_b0 /*+basename(mdm_email_preference_20180724),createtype(A)*/ 
(
 tvcmid,
 email,
 value,
 effective_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_email_preference_20180724.tvcmid,
        mdm_email_preference_20180724.email,
        mdm_email_preference_20180724.value,
        mdm_email_preference_20180724.effective_date,
        mdm_email_preference_20180724.created_by,
        mdm_email_preference_20180724.created_date,
        mdm_email_preference_20180724.updated_by,
        mdm_email_preference_20180724.updated_date,
        mdm_email_preference_20180724.file_id,
        mdm_email_preference_20180724.record_id
 FROM archive.mdm_email_preference_20180724
 ORDER BY mdm_email_preference_20180724.tvcmid,
          mdm_email_preference_20180724.email,
          mdm_email_preference_20180724.value,
          mdm_email_preference_20180724.effective_date,
          mdm_email_preference_20180724.created_by,
          mdm_email_preference_20180724.created_date,
          mdm_email_preference_20180724.updated_by,
          mdm_email_preference_20180724.updated_date,
          mdm_email_preference_20180724.file_id,
          mdm_email_preference_20180724.record_id
SEGMENTED BY hash(mdm_email_preference_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_hco_20180724_b0 /*+basename(mdm_hco_20180724),createtype(A)*/ 
(
 tvcmid,
 ims_organization_id,
 dba_name,
 business_name,
 care_of_location,
 record_type,
 record_type_name,
 sub_type,
 sub_type_name,
 owner_status,
 profit_status,
 cmi,
 no_of_providers,
 primary_cot_id,
 cot_classification_id,
 cot_classification,
 cot_facility_type_id,
 cot_facility_type,
 cot_specialty_id,
 cot_specialty,
 ttl_license_beds,
 ttl_census_beds,
 ttl_staffed_beds,
 teaching_hosp,
 commhosp,
 formulary,
 electronic_medical_record,
 eprescribe,
 payperform,
 genfirst,
 srep_access,
 practicing_status_code_healthcare_organization,
 mpn,
 mpn_order,
 status_indicator,
 status_indicator_name,
 deactivation_reason,
 logical_deletion_date,
 hce_insert_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_hco_20180724.tvcmid,
        mdm_hco_20180724.ims_organization_id,
        mdm_hco_20180724.dba_name,
        mdm_hco_20180724.business_name,
        mdm_hco_20180724.care_of_location,
        mdm_hco_20180724.record_type,
        mdm_hco_20180724.record_type_name,
        mdm_hco_20180724.sub_type,
        mdm_hco_20180724.sub_type_name,
        mdm_hco_20180724.owner_status,
        mdm_hco_20180724.profit_status,
        mdm_hco_20180724.cmi,
        mdm_hco_20180724.no_of_providers,
        mdm_hco_20180724.primary_cot_id,
        mdm_hco_20180724.cot_classification_id,
        mdm_hco_20180724.cot_classification,
        mdm_hco_20180724.cot_facility_type_id,
        mdm_hco_20180724.cot_facility_type,
        mdm_hco_20180724.cot_specialty_id,
        mdm_hco_20180724.cot_specialty,
        mdm_hco_20180724.ttl_license_beds,
        mdm_hco_20180724.ttl_census_beds,
        mdm_hco_20180724.ttl_staffed_beds,
        mdm_hco_20180724.teaching_hosp,
        mdm_hco_20180724.commhosp,
        mdm_hco_20180724.formulary,
        mdm_hco_20180724.electronic_medical_record,
        mdm_hco_20180724.eprescribe,
        mdm_hco_20180724.payperform,
        mdm_hco_20180724.genfirst,
        mdm_hco_20180724.srep_access,
        mdm_hco_20180724.practicing_status_code_healthcare_organization,
        mdm_hco_20180724.mpn,
        mdm_hco_20180724.mpn_order,
        mdm_hco_20180724.status_indicator,
        mdm_hco_20180724.status_indicator_name,
        mdm_hco_20180724.deactivation_reason,
        mdm_hco_20180724.logical_deletion_date,
        mdm_hco_20180724.hce_insert_date,
        mdm_hco_20180724.created_by,
        mdm_hco_20180724.created_date,
        mdm_hco_20180724.updated_by,
        mdm_hco_20180724.updated_date,
        mdm_hco_20180724.file_id,
        mdm_hco_20180724.record_id
 FROM archive.mdm_hco_20180724
 ORDER BY mdm_hco_20180724.tvcmid,
          mdm_hco_20180724.ims_organization_id,
          mdm_hco_20180724.dba_name,
          mdm_hco_20180724.business_name,
          mdm_hco_20180724.care_of_location,
          mdm_hco_20180724.record_type,
          mdm_hco_20180724.record_type_name,
          mdm_hco_20180724.sub_type,
          mdm_hco_20180724.sub_type_name,
          mdm_hco_20180724.owner_status,
          mdm_hco_20180724.profit_status,
          mdm_hco_20180724.cmi,
          mdm_hco_20180724.no_of_providers,
          mdm_hco_20180724.primary_cot_id,
          mdm_hco_20180724.cot_classification_id,
          mdm_hco_20180724.cot_classification,
          mdm_hco_20180724.cot_facility_type_id,
          mdm_hco_20180724.cot_facility_type,
          mdm_hco_20180724.cot_specialty_id,
          mdm_hco_20180724.cot_specialty,
          mdm_hco_20180724.ttl_license_beds,
          mdm_hco_20180724.ttl_census_beds,
          mdm_hco_20180724.ttl_staffed_beds,
          mdm_hco_20180724.teaching_hosp,
          mdm_hco_20180724.commhosp,
          mdm_hco_20180724.formulary,
          mdm_hco_20180724.electronic_medical_record,
          mdm_hco_20180724.eprescribe,
          mdm_hco_20180724.payperform,
          mdm_hco_20180724.genfirst,
          mdm_hco_20180724.srep_access,
          mdm_hco_20180724.practicing_status_code_healthcare_organization,
          mdm_hco_20180724.mpn,
          mdm_hco_20180724.mpn_order,
          mdm_hco_20180724.status_indicator,
          mdm_hco_20180724.status_indicator_name,
          mdm_hco_20180724.deactivation_reason,
          mdm_hco_20180724.logical_deletion_date,
          mdm_hco_20180724.hce_insert_date,
          mdm_hco_20180724.created_by,
          mdm_hco_20180724.created_date,
          mdm_hco_20180724.updated_by,
          mdm_hco_20180724.updated_date,
          mdm_hco_20180724.file_id,
          mdm_hco_20180724.record_id
SEGMENTED BY hash(mdm_hco_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_hco_teva_flag_20180724_b0 /*+basename(mdm_hco_teva_flag_20180724),createtype(A)*/ 
(
 tvcmid,
 flag_type,
 flag_type_name,
 flag_value,
 effective_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_hco_teva_flag_20180724.tvcmid,
        mdm_hco_teva_flag_20180724.flag_type,
        mdm_hco_teva_flag_20180724.flag_type_name,
        mdm_hco_teva_flag_20180724.flag_value,
        mdm_hco_teva_flag_20180724.effective_date,
        mdm_hco_teva_flag_20180724.created_by,
        mdm_hco_teva_flag_20180724.created_date,
        mdm_hco_teva_flag_20180724.updated_by,
        mdm_hco_teva_flag_20180724.updated_date,
        mdm_hco_teva_flag_20180724.file_id,
        mdm_hco_teva_flag_20180724.record_id
 FROM archive.mdm_hco_teva_flag_20180724
 ORDER BY mdm_hco_teva_flag_20180724.tvcmid,
          mdm_hco_teva_flag_20180724.flag_type,
          mdm_hco_teva_flag_20180724.flag_type_name,
          mdm_hco_teva_flag_20180724.flag_value,
          mdm_hco_teva_flag_20180724.effective_date,
          mdm_hco_teva_flag_20180724.created_by,
          mdm_hco_teva_flag_20180724.created_date,
          mdm_hco_teva_flag_20180724.updated_by,
          mdm_hco_teva_flag_20180724.updated_date,
          mdm_hco_teva_flag_20180724.file_id,
          mdm_hco_teva_flag_20180724.record_id
SEGMENTED BY hash(mdm_hco_teva_flag_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_hcp_20180724_b0 /*+basename(mdm_hcp_20180724),createtype(A)*/ 
(
 tvcmid,
 ims_hce_id,
 ims_prescriber_id,
 first_name,
 middle_name,
 last_name,
 prefix,
 suffix,
 suffix_name,
 sub_type,
 sub_type_name,
 healthcare_professional_status_code,
 healthcare_professional_status_name,
 year_of_birth,
 date_of_death,
 gender_code,
 gender_name,
 teva_specialty_code,
 teva_specialty_name,
 logical_deletion_date,
 hce_insert_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_hcp_20180724.tvcmid,
        mdm_hcp_20180724.ims_hce_id,
        mdm_hcp_20180724.ims_prescriber_id,
        mdm_hcp_20180724.first_name,
        mdm_hcp_20180724.middle_name,
        mdm_hcp_20180724.last_name,
        mdm_hcp_20180724.prefix,
        mdm_hcp_20180724.suffix,
        mdm_hcp_20180724.suffix_name,
        mdm_hcp_20180724.sub_type,
        mdm_hcp_20180724.sub_type_name,
        mdm_hcp_20180724.healthcare_professional_status_code,
        mdm_hcp_20180724.healthcare_professional_status_name,
        mdm_hcp_20180724.year_of_birth,
        mdm_hcp_20180724.date_of_death,
        mdm_hcp_20180724.gender_code,
        mdm_hcp_20180724.gender_name,
        mdm_hcp_20180724.teva_specialty_code,
        mdm_hcp_20180724.teva_specialty_name,
        mdm_hcp_20180724.logical_deletion_date,
        mdm_hcp_20180724.hce_insert_date,
        mdm_hcp_20180724.created_by,
        mdm_hcp_20180724.created_date,
        mdm_hcp_20180724.updated_by,
        mdm_hcp_20180724.updated_date,
        mdm_hcp_20180724.file_id,
        mdm_hcp_20180724.record_id
 FROM archive.mdm_hcp_20180724
 ORDER BY mdm_hcp_20180724.tvcmid,
          mdm_hcp_20180724.ims_hce_id,
          mdm_hcp_20180724.ims_prescriber_id,
          mdm_hcp_20180724.first_name,
          mdm_hcp_20180724.middle_name,
          mdm_hcp_20180724.last_name,
          mdm_hcp_20180724.prefix,
          mdm_hcp_20180724.suffix,
          mdm_hcp_20180724.suffix_name,
          mdm_hcp_20180724.sub_type,
          mdm_hcp_20180724.sub_type_name,
          mdm_hcp_20180724.healthcare_professional_status_code,
          mdm_hcp_20180724.healthcare_professional_status_name,
          mdm_hcp_20180724.year_of_birth,
          mdm_hcp_20180724.date_of_death,
          mdm_hcp_20180724.gender_code,
          mdm_hcp_20180724.gender_name,
          mdm_hcp_20180724.teva_specialty_code,
          mdm_hcp_20180724.teva_specialty_name,
          mdm_hcp_20180724.logical_deletion_date,
          mdm_hcp_20180724.hce_insert_date,
          mdm_hcp_20180724.created_by,
          mdm_hcp_20180724.created_date,
          mdm_hcp_20180724.updated_by,
          mdm_hcp_20180724.updated_date,
          mdm_hcp_20180724.file_id,
          mdm_hcp_20180724.record_id
SEGMENTED BY hash(mdm_hcp_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_hcp_teva_flag_20180724_b0 /*+basename(mdm_hcp_teva_flag_20180724),createtype(A)*/ 
(
 tvcmid,
 flag_type,
 flag_type_name,
 flag_value,
 effective_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_hcp_teva_flag_20180724.tvcmid,
        mdm_hcp_teva_flag_20180724.flag_type,
        mdm_hcp_teva_flag_20180724.flag_type_name,
        mdm_hcp_teva_flag_20180724.flag_value,
        mdm_hcp_teva_flag_20180724.effective_date,
        mdm_hcp_teva_flag_20180724.created_by,
        mdm_hcp_teva_flag_20180724.created_date,
        mdm_hcp_teva_flag_20180724.updated_by,
        mdm_hcp_teva_flag_20180724.updated_date,
        mdm_hcp_teva_flag_20180724.file_id,
        mdm_hcp_teva_flag_20180724.record_id
 FROM archive.mdm_hcp_teva_flag_20180724
 ORDER BY mdm_hcp_teva_flag_20180724.tvcmid,
          mdm_hcp_teva_flag_20180724.flag_type,
          mdm_hcp_teva_flag_20180724.flag_type_name,
          mdm_hcp_teva_flag_20180724.flag_value,
          mdm_hcp_teva_flag_20180724.effective_date,
          mdm_hcp_teva_flag_20180724.created_by,
          mdm_hcp_teva_flag_20180724.created_date,
          mdm_hcp_teva_flag_20180724.updated_by,
          mdm_hcp_teva_flag_20180724.updated_date,
          mdm_hcp_teva_flag_20180724.file_id,
          mdm_hcp_teva_flag_20180724.record_id
SEGMENTED BY hash(mdm_hcp_teva_flag_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_ims_flag_20180724_b0 /*+basename(mdm_ims_flag_20180724),createtype(A)*/ 
(
 tvcmid,
 flag_type,
 flag_type_name,
 flag_value,
 effective_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_ims_flag_20180724.tvcmid,
        mdm_ims_flag_20180724.flag_type,
        mdm_ims_flag_20180724.flag_type_name,
        mdm_ims_flag_20180724.flag_value,
        mdm_ims_flag_20180724.effective_date,
        mdm_ims_flag_20180724.created_by,
        mdm_ims_flag_20180724.created_date,
        mdm_ims_flag_20180724.updated_by,
        mdm_ims_flag_20180724.updated_date,
        mdm_ims_flag_20180724.file_id,
        mdm_ims_flag_20180724.record_id
 FROM archive.mdm_ims_flag_20180724
 ORDER BY mdm_ims_flag_20180724.tvcmid,
          mdm_ims_flag_20180724.flag_type,
          mdm_ims_flag_20180724.flag_type_name,
          mdm_ims_flag_20180724.flag_value,
          mdm_ims_flag_20180724.effective_date,
          mdm_ims_flag_20180724.created_by,
          mdm_ims_flag_20180724.created_date,
          mdm_ims_flag_20180724.updated_by,
          mdm_ims_flag_20180724.updated_date,
          mdm_ims_flag_20180724.file_id,
          mdm_ims_flag_20180724.record_id
SEGMENTED BY hash(mdm_ims_flag_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_license_20180724_b0 /*+basename(mdm_license_20180724),createtype(A)*/ 
(
 tvcmid,
 hce_regulation_id,
 license_type_id,
 license_type_name,
 authorization_number,
 profession_code,
 state,
 state_name,
 state_board_id,
 state_board_name,
 license_privilege_id,
 license_privilege,
 license_certification_code,
 license_certification_name,
 license_type_privilege_rank,
 license_status_code,
 license_status_description,
 license_effective_date,
 license_expiration_date,
 license_deactivation_reason_code,
 license_deactivation_reason_description,
 record_type,
 record_type_name,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_license_20180724.tvcmid,
        mdm_license_20180724.hce_regulation_id,
        mdm_license_20180724.license_type_id,
        mdm_license_20180724.license_type_name,
        mdm_license_20180724.authorization_number,
        mdm_license_20180724.profession_code,
        mdm_license_20180724.state,
        mdm_license_20180724.state_name,
        mdm_license_20180724.state_board_id,
        mdm_license_20180724.state_board_name,
        mdm_license_20180724.license_privilege_id,
        mdm_license_20180724.license_privilege,
        mdm_license_20180724.license_certification_code,
        mdm_license_20180724.license_certification_name,
        mdm_license_20180724.license_type_privilege_rank,
        mdm_license_20180724.license_status_code,
        mdm_license_20180724.license_status_description,
        mdm_license_20180724.license_effective_date,
        mdm_license_20180724.license_expiration_date,
        mdm_license_20180724.license_deactivation_reason_code,
        mdm_license_20180724.license_deactivation_reason_description,
        mdm_license_20180724.record_type,
        mdm_license_20180724.record_type_name,
        mdm_license_20180724.created_by,
        mdm_license_20180724.created_date,
        mdm_license_20180724.updated_by,
        mdm_license_20180724.updated_date,
        mdm_license_20180724.file_id,
        mdm_license_20180724.record_id
 FROM archive.mdm_license_20180724
 ORDER BY mdm_license_20180724.tvcmid,
          mdm_license_20180724.hce_regulation_id,
          mdm_license_20180724.license_type_id,
          mdm_license_20180724.license_type_name,
          mdm_license_20180724.authorization_number,
          mdm_license_20180724.profession_code,
          mdm_license_20180724.state,
          mdm_license_20180724.state_name,
          mdm_license_20180724.state_board_id,
          mdm_license_20180724.state_board_name,
          mdm_license_20180724.license_privilege_id,
          mdm_license_20180724.license_privilege,
          mdm_license_20180724.license_certification_code,
          mdm_license_20180724.license_certification_name,
          mdm_license_20180724.license_type_privilege_rank,
          mdm_license_20180724.license_status_code,
          mdm_license_20180724.license_status_description,
          mdm_license_20180724.license_effective_date,
          mdm_license_20180724.license_expiration_date,
          mdm_license_20180724.license_deactivation_reason_code,
          mdm_license_20180724.license_deactivation_reason_description,
          mdm_license_20180724.record_type,
          mdm_license_20180724.record_type_name,
          mdm_license_20180724.created_by,
          mdm_license_20180724.created_date,
          mdm_license_20180724.updated_by,
          mdm_license_20180724.updated_date,
          mdm_license_20180724.file_id,
          mdm_license_20180724.record_id
SEGMENTED BY hash(mdm_license_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_marketing_channel_20180724_b0 /*+basename(mdm_marketing_channel_20180724),createtype(A)*/ 
(
 tvcmid,
 channel,
 value,
 effective_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_marketing_channel_20180724.tvcmid,
        mdm_marketing_channel_20180724.channel,
        mdm_marketing_channel_20180724.value,
        mdm_marketing_channel_20180724.effective_date,
        mdm_marketing_channel_20180724.created_by,
        mdm_marketing_channel_20180724.created_date,
        mdm_marketing_channel_20180724.updated_by,
        mdm_marketing_channel_20180724.updated_date,
        mdm_marketing_channel_20180724.file_id,
        mdm_marketing_channel_20180724.record_id
 FROM archive.mdm_marketing_channel_20180724
 ORDER BY mdm_marketing_channel_20180724.tvcmid,
          mdm_marketing_channel_20180724.channel,
          mdm_marketing_channel_20180724.value,
          mdm_marketing_channel_20180724.effective_date,
          mdm_marketing_channel_20180724.created_by,
          mdm_marketing_channel_20180724.created_date,
          mdm_marketing_channel_20180724.updated_by,
          mdm_marketing_channel_20180724.updated_date,
          mdm_marketing_channel_20180724.file_id,
          mdm_marketing_channel_20180724.record_id
SEGMENTED BY hash(mdm_marketing_channel_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_merges_20180724_b0 /*+basename(mdm_merges_20180724),createtype(A)*/ 
(
 previous_tvcmid,
 current_tvcmid,
 merge_cycle,
 file_id,
 record_id
)
AS
 SELECT mdm_merges_20180724.previous_tvcmid,
        mdm_merges_20180724.current_tvcmid,
        mdm_merges_20180724.merge_cycle,
        mdm_merges_20180724.file_id,
        mdm_merges_20180724.record_id
 FROM archive.mdm_merges_20180724
 ORDER BY mdm_merges_20180724.previous_tvcmid,
          mdm_merges_20180724.current_tvcmid,
          mdm_merges_20180724.merge_cycle,
          mdm_merges_20180724.file_id,
          mdm_merges_20180724.record_id
SEGMENTED BY hash(mdm_merges_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_professional_20180724_b0 /*+basename(mdm_professional_20180724),createtype(A)*/ 
(
 tvcmid,
 profession_code,
 profession_code_name,
 profession_rank,
 status,
 profession_status_name,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_professional_20180724.tvcmid,
        mdm_professional_20180724.profession_code,
        mdm_professional_20180724.profession_code_name,
        mdm_professional_20180724.profession_rank,
        mdm_professional_20180724.status,
        mdm_professional_20180724.profession_status_name,
        mdm_professional_20180724.created_by,
        mdm_professional_20180724.created_date,
        mdm_professional_20180724.updated_by,
        mdm_professional_20180724.updated_date,
        mdm_professional_20180724.file_id,
        mdm_professional_20180724.record_id
 FROM archive.mdm_professional_20180724
 ORDER BY mdm_professional_20180724.tvcmid,
          mdm_professional_20180724.profession_code,
          mdm_professional_20180724.profession_code_name,
          mdm_professional_20180724.profession_rank,
          mdm_professional_20180724.status,
          mdm_professional_20180724.profession_status_name,
          mdm_professional_20180724.created_by,
          mdm_professional_20180724.created_date,
          mdm_professional_20180724.updated_by,
          mdm_professional_20180724.updated_date,
          mdm_professional_20180724.file_id,
          mdm_professional_20180724.record_id
SEGMENTED BY hash(mdm_professional_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_raw_dea_20180724_b0 /*+basename(mdm_raw_dea_20180724),createtype(A)*/ 
(
 tvcmid,
 ims_id,
 dea_number,
 name,
 additional_company_info,
 address_line1,
 address_line2,
 city,
 state,
 state_name,
 zip,
 business_activity_code,
 drug_schedules,
 expiration_date,
 business_activity_sub_code,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_raw_dea_20180724.tvcmid,
        mdm_raw_dea_20180724.ims_id,
        mdm_raw_dea_20180724.dea_number,
        mdm_raw_dea_20180724.name,
        mdm_raw_dea_20180724.additional_company_info,
        mdm_raw_dea_20180724.address_line1,
        mdm_raw_dea_20180724.address_line2,
        mdm_raw_dea_20180724.city,
        mdm_raw_dea_20180724.state,
        mdm_raw_dea_20180724.state_name,
        mdm_raw_dea_20180724.zip,
        mdm_raw_dea_20180724.business_activity_code,
        mdm_raw_dea_20180724.drug_schedules,
        mdm_raw_dea_20180724.expiration_date,
        mdm_raw_dea_20180724.business_activity_sub_code,
        mdm_raw_dea_20180724.created_by,
        mdm_raw_dea_20180724.created_date,
        mdm_raw_dea_20180724.updated_by,
        mdm_raw_dea_20180724.updated_date,
        mdm_raw_dea_20180724.file_id,
        mdm_raw_dea_20180724.record_id
 FROM archive.mdm_raw_dea_20180724
 ORDER BY mdm_raw_dea_20180724.tvcmid,
          mdm_raw_dea_20180724.ims_id,
          mdm_raw_dea_20180724.dea_number,
          mdm_raw_dea_20180724.name,
          mdm_raw_dea_20180724.additional_company_info,
          mdm_raw_dea_20180724.address_line1,
          mdm_raw_dea_20180724.address_line2,
          mdm_raw_dea_20180724.city,
          mdm_raw_dea_20180724.state,
          mdm_raw_dea_20180724.state_name,
          mdm_raw_dea_20180724.zip,
          mdm_raw_dea_20180724.business_activity_code,
          mdm_raw_dea_20180724.drug_schedules,
          mdm_raw_dea_20180724.expiration_date,
          mdm_raw_dea_20180724.business_activity_sub_code,
          mdm_raw_dea_20180724.created_by,
          mdm_raw_dea_20180724.created_date,
          mdm_raw_dea_20180724.updated_by,
          mdm_raw_dea_20180724.updated_date,
          mdm_raw_dea_20180724.file_id,
          mdm_raw_dea_20180724.record_id
SEGMENTED BY hash(mdm_raw_dea_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_raw_npi_20180724_b0 /*+basename(mdm_raw_npi_20180724),createtype(A)*/ 
(
 tvcmid,
 npi_number,
 npi_first_name,
 npi_middle_name,
 npi_last_name,
 practice_address_1,
 practice_address_2,
 practice_city,
 practice_state_name,
 practice_postal_code,
 practice_country_code,
 primary_taxonomy_code,
 primary_taxonomy_type,
 primary_taxonomy_classification,
 primary_taxonomy_specialty,
 ims_specialty_code,
 ims_specialty_description,
 npi_deactivation_reason_code,
 npi_deactivation_date,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_raw_npi_20180724.tvcmid,
        mdm_raw_npi_20180724.npi_number,
        mdm_raw_npi_20180724.npi_first_name,
        mdm_raw_npi_20180724.npi_middle_name,
        mdm_raw_npi_20180724.npi_last_name,
        mdm_raw_npi_20180724.practice_address_1,
        mdm_raw_npi_20180724.practice_address_2,
        mdm_raw_npi_20180724.practice_city,
        mdm_raw_npi_20180724.practice_state_name,
        mdm_raw_npi_20180724.practice_postal_code,
        mdm_raw_npi_20180724.practice_country_code,
        mdm_raw_npi_20180724.primary_taxonomy_code,
        mdm_raw_npi_20180724.primary_taxonomy_type,
        mdm_raw_npi_20180724.primary_taxonomy_classification,
        mdm_raw_npi_20180724.primary_taxonomy_specialty,
        mdm_raw_npi_20180724.ims_specialty_code,
        mdm_raw_npi_20180724.ims_specialty_description,
        mdm_raw_npi_20180724.npi_deactivation_reason_code,
        mdm_raw_npi_20180724.npi_deactivation_date,
        mdm_raw_npi_20180724.created_by,
        mdm_raw_npi_20180724.created_date,
        mdm_raw_npi_20180724.updated_by,
        mdm_raw_npi_20180724.updated_date,
        mdm_raw_npi_20180724.file_id,
        mdm_raw_npi_20180724.record_id
 FROM archive.mdm_raw_npi_20180724
 ORDER BY mdm_raw_npi_20180724.tvcmid,
          mdm_raw_npi_20180724.npi_number,
          mdm_raw_npi_20180724.npi_first_name,
          mdm_raw_npi_20180724.npi_middle_name,
          mdm_raw_npi_20180724.npi_last_name,
          mdm_raw_npi_20180724.practice_address_1,
          mdm_raw_npi_20180724.practice_address_2,
          mdm_raw_npi_20180724.practice_city,
          mdm_raw_npi_20180724.practice_state_name,
          mdm_raw_npi_20180724.practice_postal_code,
          mdm_raw_npi_20180724.practice_country_code,
          mdm_raw_npi_20180724.primary_taxonomy_code,
          mdm_raw_npi_20180724.primary_taxonomy_type,
          mdm_raw_npi_20180724.primary_taxonomy_classification,
          mdm_raw_npi_20180724.primary_taxonomy_specialty,
          mdm_raw_npi_20180724.ims_specialty_code,
          mdm_raw_npi_20180724.ims_specialty_description,
          mdm_raw_npi_20180724.npi_deactivation_reason_code,
          mdm_raw_npi_20180724.npi_deactivation_date,
          mdm_raw_npi_20180724.created_by,
          mdm_raw_npi_20180724.created_date,
          mdm_raw_npi_20180724.updated_by,
          mdm_raw_npi_20180724.updated_date,
          mdm_raw_npi_20180724.file_id,
          mdm_raw_npi_20180724.record_id
SEGMENTED BY hash(mdm_raw_npi_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_regulation_20180724_b0 /*+basename(mdm_regulation_20180724),createtype(A)*/ 
(
 state_license_type_id,
 state_license_type_name,
 state_privilege_type_id,
 state_license_privilege_type_name,
 state_license_privilege_type_rank,
 state_code,
 state_name,
 state_board_id,
 state_board_name,
 certification_code,
 required_sample_non_ctrl,
 required_sample_ctrl,
 received_sample_non_ctrl,
 received_sample_ctrl,
 distributed_sample_non_ctrl,
 distributed_sample_ctrl,
 sample_drug_schedule_i_flag,
 sample_drug_schedule_ii_flag,
 sample_drug_schedule_iii_flag,
 sample_drug_schedule_iv_flag,
 sample_drug_schedule_v_flag,
 sample_drug_schedule_vi_flag,
 prescriber_non_ctrl_flag,
 prescriber_app_required_non_ctrl_flag,
 prescriber_ctrl_flag,
 prescriber_app_required_ctrl_flag,
 prescriber_drug_schedule_i_flag,
 prescriber_drug_schedule_ii_flag,
 prescriber_drug_schedule_iii_flag,
 prescriber_drug_schedule_iv_flag,
 prescriber_drug_schedule_v_flag,
 prescriber_drug_schedule_vi_flag,
 supervisory_relationship_code_non_ctrl,
 supervisory_relationship_code_ctrl,
 collaborative_non_ctrl,
 collaborative_ctrl,
 inclusionary,
 exclusionary,
 delegation_non_ctrl,
 delegation_ctrl,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_regulation_20180724.state_license_type_id,
        mdm_regulation_20180724.state_license_type_name,
        mdm_regulation_20180724.state_privilege_type_id,
        mdm_regulation_20180724.state_license_privilege_type_name,
        mdm_regulation_20180724.state_license_privilege_type_rank,
        mdm_regulation_20180724.state_code,
        mdm_regulation_20180724.state_name,
        mdm_regulation_20180724.state_board_id,
        mdm_regulation_20180724.state_board_name,
        mdm_regulation_20180724.certification_code,
        mdm_regulation_20180724.required_sample_non_ctrl,
        mdm_regulation_20180724.required_sample_ctrl,
        mdm_regulation_20180724.received_sample_non_ctrl,
        mdm_regulation_20180724.received_sample_ctrl,
        mdm_regulation_20180724.distributed_sample_non_ctrl,
        mdm_regulation_20180724.distributed_sample_ctrl,
        mdm_regulation_20180724.sample_drug_schedule_i_flag,
        mdm_regulation_20180724.sample_drug_schedule_ii_flag,
        mdm_regulation_20180724.sample_drug_schedule_iii_flag,
        mdm_regulation_20180724.sample_drug_schedule_iv_flag,
        mdm_regulation_20180724.sample_drug_schedule_v_flag,
        mdm_regulation_20180724.sample_drug_schedule_vi_flag,
        mdm_regulation_20180724.prescriber_non_ctrl_flag,
        mdm_regulation_20180724.prescriber_app_required_non_ctrl_flag,
        mdm_regulation_20180724.prescriber_ctrl_flag,
        mdm_regulation_20180724.prescriber_app_required_ctrl_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_i_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_ii_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_iii_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_iv_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_v_flag,
        mdm_regulation_20180724.prescriber_drug_schedule_vi_flag,
        mdm_regulation_20180724.supervisory_relationship_code_non_ctrl,
        mdm_regulation_20180724.supervisory_relationship_code_ctrl,
        mdm_regulation_20180724.collaborative_non_ctrl,
        mdm_regulation_20180724.collaborative_ctrl,
        mdm_regulation_20180724.inclusionary,
        mdm_regulation_20180724.exclusionary,
        mdm_regulation_20180724.delegation_non_ctrl,
        mdm_regulation_20180724.delegation_ctrl,
        mdm_regulation_20180724.created_by,
        mdm_regulation_20180724.created_date,
        mdm_regulation_20180724.updated_by,
        mdm_regulation_20180724.updated_date,
        mdm_regulation_20180724.file_id,
        mdm_regulation_20180724.record_id
 FROM archive.mdm_regulation_20180724
 ORDER BY mdm_regulation_20180724.state_license_type_id,
          mdm_regulation_20180724.state_license_type_name,
          mdm_regulation_20180724.state_privilege_type_id,
          mdm_regulation_20180724.state_license_privilege_type_name,
          mdm_regulation_20180724.state_license_privilege_type_rank,
          mdm_regulation_20180724.state_code,
          mdm_regulation_20180724.state_name,
          mdm_regulation_20180724.state_board_id,
          mdm_regulation_20180724.state_board_name,
          mdm_regulation_20180724.certification_code,
          mdm_regulation_20180724.required_sample_non_ctrl,
          mdm_regulation_20180724.required_sample_ctrl,
          mdm_regulation_20180724.received_sample_non_ctrl,
          mdm_regulation_20180724.received_sample_ctrl,
          mdm_regulation_20180724.distributed_sample_non_ctrl,
          mdm_regulation_20180724.distributed_sample_ctrl,
          mdm_regulation_20180724.sample_drug_schedule_i_flag,
          mdm_regulation_20180724.sample_drug_schedule_ii_flag,
          mdm_regulation_20180724.sample_drug_schedule_iii_flag,
          mdm_regulation_20180724.sample_drug_schedule_iv_flag,
          mdm_regulation_20180724.sample_drug_schedule_v_flag,
          mdm_regulation_20180724.sample_drug_schedule_vi_flag,
          mdm_regulation_20180724.prescriber_non_ctrl_flag,
          mdm_regulation_20180724.prescriber_app_required_non_ctrl_flag,
          mdm_regulation_20180724.prescriber_ctrl_flag,
          mdm_regulation_20180724.prescriber_app_required_ctrl_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_i_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_ii_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_iii_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_iv_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_v_flag,
          mdm_regulation_20180724.prescriber_drug_schedule_vi_flag,
          mdm_regulation_20180724.supervisory_relationship_code_non_ctrl,
          mdm_regulation_20180724.supervisory_relationship_code_ctrl,
          mdm_regulation_20180724.collaborative_non_ctrl,
          mdm_regulation_20180724.collaborative_ctrl,
          mdm_regulation_20180724.inclusionary,
          mdm_regulation_20180724.exclusionary,
          mdm_regulation_20180724.delegation_non_ctrl,
          mdm_regulation_20180724.delegation_ctrl,
          mdm_regulation_20180724.created_by,
          mdm_regulation_20180724.created_date,
          mdm_regulation_20180724.updated_by,
          mdm_regulation_20180724.updated_date,
          mdm_regulation_20180724.file_id,
          mdm_regulation_20180724.record_id
SEGMENTED BY hash(mdm_regulation_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_relationship_20180724_b0 /*+basename(mdm_relationship_20180724),createtype(A)*/ 
(
 hierarchy_code,
 hierarchy_name,
 relationship_type_code,
 relationship_type_name,
 parent_tvcmid,
 child_tvcmid,
 relationship_status_code,
 relationship_status_name,
 relationship_start_date,
 relationship_end_date,
 notes,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_relationship_20180724.hierarchy_code,
        mdm_relationship_20180724.hierarchy_name,
        mdm_relationship_20180724.relationship_type_code,
        mdm_relationship_20180724.relationship_type_name,
        mdm_relationship_20180724.parent_tvcmid,
        mdm_relationship_20180724.child_tvcmid,
        mdm_relationship_20180724.relationship_status_code,
        mdm_relationship_20180724.relationship_status_name,
        mdm_relationship_20180724.relationship_start_date,
        mdm_relationship_20180724.relationship_end_date,
        mdm_relationship_20180724.notes,
        mdm_relationship_20180724.created_by,
        mdm_relationship_20180724.created_date,
        mdm_relationship_20180724.updated_by,
        mdm_relationship_20180724.updated_date,
        mdm_relationship_20180724.file_id,
        mdm_relationship_20180724.record_id
 FROM archive.mdm_relationship_20180724
 ORDER BY mdm_relationship_20180724.hierarchy_code,
          mdm_relationship_20180724.hierarchy_name,
          mdm_relationship_20180724.relationship_type_code,
          mdm_relationship_20180724.relationship_type_name,
          mdm_relationship_20180724.parent_tvcmid,
          mdm_relationship_20180724.child_tvcmid,
          mdm_relationship_20180724.relationship_status_code,
          mdm_relationship_20180724.relationship_status_name,
          mdm_relationship_20180724.relationship_start_date,
          mdm_relationship_20180724.relationship_end_date,
          mdm_relationship_20180724.notes,
          mdm_relationship_20180724.created_by,
          mdm_relationship_20180724.created_date,
          mdm_relationship_20180724.updated_by,
          mdm_relationship_20180724.updated_date,
          mdm_relationship_20180724.file_id,
          mdm_relationship_20180724.record_id
SEGMENTED BY hash(mdm_relationship_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_sample_eligibility_20180724_b0 /*+basename(mdm_sample_eligibility_20180724),createtype(A)*/ 
(
 tvcmid,
 sln,
 sln_state,
 sln_status_code,
 sln_status_description,
 sln_expiration_date,
 teva_sample_eligibility_flag,
 teva_schedule_iv_eligibility_flag,
 teva_schedule_v_eligibility_flag,
 profession_short_description,
 teva_specialty_code,
 certification_code,
 certification_description,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_sample_eligibility_20180724.tvcmid,
        mdm_sample_eligibility_20180724.sln,
        mdm_sample_eligibility_20180724.sln_state,
        mdm_sample_eligibility_20180724.sln_status_code,
        mdm_sample_eligibility_20180724.sln_status_description,
        mdm_sample_eligibility_20180724.sln_expiration_date,
        mdm_sample_eligibility_20180724.teva_sample_eligibility_flag,
        mdm_sample_eligibility_20180724.teva_schedule_iv_eligibility_flag,
        mdm_sample_eligibility_20180724.teva_schedule_v_eligibility_flag,
        mdm_sample_eligibility_20180724.profession_short_description,
        mdm_sample_eligibility_20180724.teva_specialty_code,
        mdm_sample_eligibility_20180724.certification_code,
        mdm_sample_eligibility_20180724.certification_description,
        mdm_sample_eligibility_20180724.created_by,
        mdm_sample_eligibility_20180724.created_date,
        mdm_sample_eligibility_20180724.updated_by,
        mdm_sample_eligibility_20180724.updated_date,
        mdm_sample_eligibility_20180724.file_id,
        mdm_sample_eligibility_20180724.record_id
 FROM archive.mdm_sample_eligibility_20180724
 ORDER BY mdm_sample_eligibility_20180724.tvcmid,
          mdm_sample_eligibility_20180724.sln,
          mdm_sample_eligibility_20180724.sln_state,
          mdm_sample_eligibility_20180724.sln_status_code,
          mdm_sample_eligibility_20180724.sln_status_description,
          mdm_sample_eligibility_20180724.sln_expiration_date,
          mdm_sample_eligibility_20180724.teva_sample_eligibility_flag,
          mdm_sample_eligibility_20180724.teva_schedule_iv_eligibility_flag,
          mdm_sample_eligibility_20180724.teva_schedule_v_eligibility_flag,
          mdm_sample_eligibility_20180724.profession_short_description,
          mdm_sample_eligibility_20180724.teva_specialty_code,
          mdm_sample_eligibility_20180724.certification_code,
          mdm_sample_eligibility_20180724.certification_description,
          mdm_sample_eligibility_20180724.created_by,
          mdm_sample_eligibility_20180724.created_date,
          mdm_sample_eligibility_20180724.updated_by,
          mdm_sample_eligibility_20180724.updated_date,
          mdm_sample_eligibility_20180724.file_id,
          mdm_sample_eligibility_20180724.record_id
SEGMENTED BY hash(mdm_sample_eligibility_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_source_details_20180724_b0 /*+basename(mdm_source_details_20180724),createtype(A)*/ 
(
 tvcmid,
 identifier_code,
 identifier_description,
 identifier_value,
 legacy_identifier_code,
 ama_md_do_flag,
 major_professional_activity,
 major_professional_activity_description,
 hospital_hours,
 ama_hospital_id,
 ama_hospital_description,
 practice_type_code,
 practice_type_description,
 employment_type_code,
 employment_type_description,
 birth_city,
 birth_state,
 birth_country_code,
 birth_country_description,
 medical_school_code,
 medical_school_description,
 graduation_year,
 number_of_physician_offices,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_source_details_20180724.tvcmid,
        mdm_source_details_20180724.identifier_code,
        mdm_source_details_20180724.identifier_description,
        mdm_source_details_20180724.identifier_value,
        mdm_source_details_20180724.legacy_identifier_code,
        mdm_source_details_20180724.ama_md_do_flag,
        mdm_source_details_20180724.major_professional_activity,
        mdm_source_details_20180724.major_professional_activity_description,
        mdm_source_details_20180724.hospital_hours,
        mdm_source_details_20180724.ama_hospital_id,
        mdm_source_details_20180724.ama_hospital_description,
        mdm_source_details_20180724.practice_type_code,
        mdm_source_details_20180724.practice_type_description,
        mdm_source_details_20180724.employment_type_code,
        mdm_source_details_20180724.employment_type_description,
        mdm_source_details_20180724.birth_city,
        mdm_source_details_20180724.birth_state,
        mdm_source_details_20180724.birth_country_code,
        mdm_source_details_20180724.birth_country_description,
        mdm_source_details_20180724.medical_school_code,
        mdm_source_details_20180724.medical_school_description,
        mdm_source_details_20180724.graduation_year,
        mdm_source_details_20180724.number_of_physician_offices,
        mdm_source_details_20180724.created_by,
        mdm_source_details_20180724.created_date,
        mdm_source_details_20180724.updated_by,
        mdm_source_details_20180724.updated_date,
        mdm_source_details_20180724.file_id,
        mdm_source_details_20180724.record_id
 FROM archive.mdm_source_details_20180724
 ORDER BY mdm_source_details_20180724.tvcmid,
          mdm_source_details_20180724.identifier_code,
          mdm_source_details_20180724.identifier_description,
          mdm_source_details_20180724.identifier_value,
          mdm_source_details_20180724.legacy_identifier_code,
          mdm_source_details_20180724.ama_md_do_flag,
          mdm_source_details_20180724.major_professional_activity,
          mdm_source_details_20180724.major_professional_activity_description,
          mdm_source_details_20180724.hospital_hours,
          mdm_source_details_20180724.ama_hospital_id,
          mdm_source_details_20180724.ama_hospital_description,
          mdm_source_details_20180724.practice_type_code,
          mdm_source_details_20180724.practice_type_description,
          mdm_source_details_20180724.employment_type_code,
          mdm_source_details_20180724.employment_type_description,
          mdm_source_details_20180724.birth_city,
          mdm_source_details_20180724.birth_state,
          mdm_source_details_20180724.birth_country_code,
          mdm_source_details_20180724.birth_country_description,
          mdm_source_details_20180724.medical_school_code,
          mdm_source_details_20180724.medical_school_description,
          mdm_source_details_20180724.graduation_year,
          mdm_source_details_20180724.number_of_physician_offices,
          mdm_source_details_20180724.created_by,
          mdm_source_details_20180724.created_date,
          mdm_source_details_20180724.updated_by,
          mdm_source_details_20180724.updated_date,
          mdm_source_details_20180724.file_id,
          mdm_source_details_20180724.record_id
SEGMENTED BY hash(mdm_source_details_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.mdm_specialty_20180724_b0 /*+basename(mdm_specialty_20180724),createtype(A)*/ 
(
 tvcmid,
 specialty_code,
 specialty_code_name,
 specialty_ranking,
 status,
 status_name,
 created_by,
 created_date,
 updated_by,
 updated_date,
 file_id,
 record_id
)
AS
 SELECT mdm_specialty_20180724.tvcmid,
        mdm_specialty_20180724.specialty_code,
        mdm_specialty_20180724.specialty_code_name,
        mdm_specialty_20180724.specialty_ranking,
        mdm_specialty_20180724.status,
        mdm_specialty_20180724.status_name,
        mdm_specialty_20180724.created_by,
        mdm_specialty_20180724.created_date,
        mdm_specialty_20180724.updated_by,
        mdm_specialty_20180724.updated_date,
        mdm_specialty_20180724.file_id,
        mdm_specialty_20180724.record_id
 FROM archive.mdm_specialty_20180724
 ORDER BY mdm_specialty_20180724.tvcmid,
          mdm_specialty_20180724.specialty_code,
          mdm_specialty_20180724.specialty_code_name,
          mdm_specialty_20180724.specialty_ranking,
          mdm_specialty_20180724.status,
          mdm_specialty_20180724.status_name,
          mdm_specialty_20180724.created_by,
          mdm_specialty_20180724.created_date,
          mdm_specialty_20180724.updated_by,
          mdm_specialty_20180724.updated_date,
          mdm_specialty_20180724.file_id,
          mdm_specialty_20180724.record_id
SEGMENTED BY hash(mdm_specialty_20180724.record_id) ALL NODES;

CREATE PROJECTION archive.scd_sales_geography_20180727_b0 /*+basename(scd_sales_geography_20180727),createtype(A)*/ 
(
 scd_status,
 scd_effective_date,
 scd_expiration_date,
 sales_force_id,
 geography_number,
 geography_name,
 geography_desc,
 geography_type,
 employee_type,
 sales_team,
 parent_geography_number,
 fleet_eligible_flag
)
AS
 SELECT scd_sales_geography_20180727.scd_status,
        scd_sales_geography_20180727.scd_effective_date,
        scd_sales_geography_20180727.scd_expiration_date,
        scd_sales_geography_20180727.sales_force_id,
        scd_sales_geography_20180727.geography_number,
        scd_sales_geography_20180727.geography_name,
        scd_sales_geography_20180727.geography_desc,
        scd_sales_geography_20180727.geography_type,
        scd_sales_geography_20180727.employee_type,
        scd_sales_geography_20180727.sales_team,
        scd_sales_geography_20180727.parent_geography_number,
        scd_sales_geography_20180727.fleet_eligible_flag
 FROM archive.scd_sales_geography_20180727
 ORDER BY scd_sales_geography_20180727.sales_force_id,
          scd_sales_geography_20180727.geography_number,
          scd_sales_geography_20180727.geography_name,
          scd_sales_geography_20180727.geography_desc,
          scd_sales_geography_20180727.geography_type,
          scd_sales_geography_20180727.employee_type,
          scd_sales_geography_20180727.sales_team,
          scd_sales_geography_20180727.parent_geography_number
SEGMENTED BY hash(scd_sales_geography_20180727.sales_force_id, scd_sales_geography_20180727.employee_type, scd_sales_geography_20180727.geography_number, scd_sales_geography_20180727.geography_type, scd_sales_geography_20180727.parent_geography_number, scd_sales_geography_20180727.geography_name, scd_sales_geography_20180727.geography_desc, scd_sales_geography_20180727.sales_team) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demo_frozen_20180813_b0 /*+basename(prescriber_combined_demo_frozen_20180813),createtype(A)*/ 
(
 start_date,
 end_date,
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source,
 freeze_reason,
 freeze_date
)
AS
 SELECT prescriber_combined_demo_frozen_20180813.start_date,
        prescriber_combined_demo_frozen_20180813.end_date,
        prescriber_combined_demo_frozen_20180813.sales_force_id,
        prescriber_combined_demo_frozen_20180813.ims_id,
        prescriber_combined_demo_frozen_20180813.npi,
        prescriber_combined_demo_frozen_20180813.tvcmid,
        prescriber_combined_demo_frozen_20180813.veeva_account_id,
        prescriber_combined_demo_frozen_20180813.specialty,
        prescriber_combined_demo_frozen_20180813.first_name,
        prescriber_combined_demo_frozen_20180813.middle_name,
        prescriber_combined_demo_frozen_20180813.last_name,
        prescriber_combined_demo_frozen_20180813.ptr_veeva_address_id,
        prescriber_combined_demo_frozen_20180813.ptr_address_1,
        prescriber_combined_demo_frozen_20180813.ptr_address_2,
        prescriber_combined_demo_frozen_20180813.ptr_address_3,
        prescriber_combined_demo_frozen_20180813.ptr_city,
        prescriber_combined_demo_frozen_20180813.ptr_state,
        prescriber_combined_demo_frozen_20180813.ptr_zip,
        prescriber_combined_demo_frozen_20180813.ptr_phone,
        prescriber_combined_demo_frozen_20180813.ptr_territory_num,
        prescriber_combined_demo_frozen_20180813.ptr_territory_type,
        prescriber_combined_demo_frozen_20180813.ptr_address_source,
        prescriber_combined_demo_frozen_20180813.ptr_mailable,
        prescriber_combined_demo_frozen_20180813.dea_num,
        prescriber_combined_demo_frozen_20180813.pdrp_flag,
        prescriber_combined_demo_frozen_20180813.pdrp_date,
        prescriber_combined_demo_frozen_20180813.np_pa_flag,
        prescriber_combined_demo_frozen_20180813.no_spend,
        prescriber_combined_demo_frozen_20180813.ama_no_contact_flag,
        prescriber_combined_demo_frozen_20180813.email,
        prescriber_combined_demo_frozen_20180813.degree,
        prescriber_combined_demo_frozen_20180813.address_id,
        prescriber_combined_demo_frozen_20180813.address_latitude,
        prescriber_combined_demo_frozen_20180813.address_longitude,
        prescriber_combined_demo_frozen_20180813.row_source,
        prescriber_combined_demo_frozen_20180813.freeze_reason,
        prescriber_combined_demo_frozen_20180813.freeze_date
 FROM archive.prescriber_combined_demo_frozen_20180813
 ORDER BY prescriber_combined_demo_frozen_20180813.sales_force_id,
          prescriber_combined_demo_frozen_20180813.ims_id,
          prescriber_combined_demo_frozen_20180813.npi,
          prescriber_combined_demo_frozen_20180813.tvcmid,
          prescriber_combined_demo_frozen_20180813.veeva_account_id,
          prescriber_combined_demo_frozen_20180813.specialty,
          prescriber_combined_demo_frozen_20180813.first_name,
          prescriber_combined_demo_frozen_20180813.middle_name,
          prescriber_combined_demo_frozen_20180813.last_name,
          prescriber_combined_demo_frozen_20180813.ptr_veeva_address_id,
          prescriber_combined_demo_frozen_20180813.ptr_address_1,
          prescriber_combined_demo_frozen_20180813.ptr_address_2,
          prescriber_combined_demo_frozen_20180813.ptr_address_3,
          prescriber_combined_demo_frozen_20180813.ptr_city,
          prescriber_combined_demo_frozen_20180813.ptr_state,
          prescriber_combined_demo_frozen_20180813.ptr_zip,
          prescriber_combined_demo_frozen_20180813.ptr_phone,
          prescriber_combined_demo_frozen_20180813.ptr_territory_num,
          prescriber_combined_demo_frozen_20180813.ptr_territory_type,
          prescriber_combined_demo_frozen_20180813.ptr_address_source,
          prescriber_combined_demo_frozen_20180813.ptr_mailable,
          prescriber_combined_demo_frozen_20180813.dea_num,
          prescriber_combined_demo_frozen_20180813.pdrp_flag,
          prescriber_combined_demo_frozen_20180813.pdrp_date,
          prescriber_combined_demo_frozen_20180813.np_pa_flag,
          prescriber_combined_demo_frozen_20180813.no_spend,
          prescriber_combined_demo_frozen_20180813.ama_no_contact_flag,
          prescriber_combined_demo_frozen_20180813.email,
          prescriber_combined_demo_frozen_20180813.degree,
          prescriber_combined_demo_frozen_20180813.address_id,
          prescriber_combined_demo_frozen_20180813.address_latitude,
          prescriber_combined_demo_frozen_20180813.address_longitude,
          prescriber_combined_demo_frozen_20180813.row_source
SEGMENTED BY hash(prescriber_combined_demo_frozen_20180813.tvcmid, prescriber_combined_demo_frozen_20180813.ptr_state, prescriber_combined_demo_frozen_20180813.ptr_zip, prescriber_combined_demo_frozen_20180813.ptr_mailable, prescriber_combined_demo_frozen_20180813.pdrp_flag, prescriber_combined_demo_frozen_20180813.pdrp_date, prescriber_combined_demo_frozen_20180813.np_pa_flag, prescriber_combined_demo_frozen_20180813.no_spend, prescriber_combined_demo_frozen_20180813.ama_no_contact_flag, prescriber_combined_demo_frozen_20180813.address_id, prescriber_combined_demo_frozen_20180813.ims_id, prescriber_combined_demo_frozen_20180813.npi, prescriber_combined_demo_frozen_20180813.dea_num, prescriber_combined_demo_frozen_20180813.ptr_territory_num, prescriber_combined_demo_frozen_20180813.sales_force_id, prescriber_combined_demo_frozen_20180813.veeva_account_id, prescriber_combined_demo_frozen_20180813.ptr_veeva_address_id, prescriber_combined_demo_frozen_20180813.address_latitude, prescriber_combined_demo_frozen_20180813.address_longitude, prescriber_combined_demo_frozen_20180813.ptr_territory_type, prescriber_combined_demo_frozen_20180813.ptr_phone, prescriber_combined_demo_frozen_20180813.first_name, prescriber_combined_demo_frozen_20180813.middle_name, prescriber_combined_demo_frozen_20180813.last_name, prescriber_combined_demo_frozen_20180813.ptr_city, prescriber_combined_demo_frozen_20180813.ptr_address_source, prescriber_combined_demo_frozen_20180813.ptr_address_1, prescriber_combined_demo_frozen_20180813.ptr_address_2, prescriber_combined_demo_frozen_20180813.ptr_address_3, prescriber_combined_demo_frozen_20180813.email, prescriber_combined_demo_frozen_20180813.degree, prescriber_combined_demo_frozen_20180813.row_source) ALL NODES;

CREATE PROJECTION archive.veeva_call_sample_20180815_b0 /*+basename(veeva_call_sample_20180815),createtype(A)*/ 
(
 id,
 isdeleted,
 name,
 createddate,
 createdbyid,
 lastmodifieddate,
 lastmodifiedbyid,
 systemmodstamp,
 lastactivitydate,
 mayedit,
 islocked,
 lastvieweddate,
 lastreferenceddate,
 account_vod__c,
 call_date_vod__c,
 is_parent_call_vod__c,
 quantity_vod__c,
 lot_vod__c,
 mobile_id_vod__c,
 call2_vod__c,
 product_vod__c,
 distributor_vod__c,
 attendee_type_vod__c,
 entity_reference_id_vod__c,
 delivery_status_vod__c,
 apply_limit_vod__c,
 limit_applied_vod__c,
 manufacturer_vod__c,
 file_id,
 record_id
)
AS
 SELECT veeva_call_sample_20180815.id,
        veeva_call_sample_20180815.isdeleted,
        veeva_call_sample_20180815.name,
        veeva_call_sample_20180815.createddate,
        veeva_call_sample_20180815.createdbyid,
        veeva_call_sample_20180815.lastmodifieddate,
        veeva_call_sample_20180815.lastmodifiedbyid,
        veeva_call_sample_20180815.systemmodstamp,
        veeva_call_sample_20180815.lastactivitydate,
        veeva_call_sample_20180815.mayedit,
        veeva_call_sample_20180815.islocked,
        veeva_call_sample_20180815.lastvieweddate,
        veeva_call_sample_20180815.lastreferenceddate,
        veeva_call_sample_20180815.account_vod__c,
        veeva_call_sample_20180815.call_date_vod__c,
        veeva_call_sample_20180815.is_parent_call_vod__c,
        veeva_call_sample_20180815.quantity_vod__c,
        veeva_call_sample_20180815.lot_vod__c,
        veeva_call_sample_20180815.mobile_id_vod__c,
        veeva_call_sample_20180815.call2_vod__c,
        veeva_call_sample_20180815.product_vod__c,
        veeva_call_sample_20180815.distributor_vod__c,
        veeva_call_sample_20180815.attendee_type_vod__c,
        veeva_call_sample_20180815.entity_reference_id_vod__c,
        veeva_call_sample_20180815.delivery_status_vod__c,
        veeva_call_sample_20180815.apply_limit_vod__c,
        veeva_call_sample_20180815.limit_applied_vod__c,
        veeva_call_sample_20180815.manufacturer_vod__c,
        veeva_call_sample_20180815.file_id,
        veeva_call_sample_20180815.record_id
 FROM archive.veeva_call_sample_20180815
 ORDER BY veeva_call_sample_20180815.id,
          veeva_call_sample_20180815.isdeleted,
          veeva_call_sample_20180815.name,
          veeva_call_sample_20180815.createddate,
          veeva_call_sample_20180815.createdbyid,
          veeva_call_sample_20180815.lastmodifieddate,
          veeva_call_sample_20180815.lastmodifiedbyid,
          veeva_call_sample_20180815.systemmodstamp,
          veeva_call_sample_20180815.lastactivitydate,
          veeva_call_sample_20180815.mayedit,
          veeva_call_sample_20180815.islocked,
          veeva_call_sample_20180815.lastvieweddate,
          veeva_call_sample_20180815.lastreferenceddate,
          veeva_call_sample_20180815.account_vod__c,
          veeva_call_sample_20180815.call_date_vod__c,
          veeva_call_sample_20180815.is_parent_call_vod__c,
          veeva_call_sample_20180815.quantity_vod__c,
          veeva_call_sample_20180815.lot_vod__c,
          veeva_call_sample_20180815.mobile_id_vod__c,
          veeva_call_sample_20180815.call2_vod__c,
          veeva_call_sample_20180815.product_vod__c,
          veeva_call_sample_20180815.distributor_vod__c,
          veeva_call_sample_20180815.attendee_type_vod__c,
          veeva_call_sample_20180815.entity_reference_id_vod__c,
          veeva_call_sample_20180815.delivery_status_vod__c,
          veeva_call_sample_20180815.apply_limit_vod__c,
          veeva_call_sample_20180815.limit_applied_vod__c,
          veeva_call_sample_20180815.manufacturer_vod__c,
          veeva_call_sample_20180815.file_id,
          veeva_call_sample_20180815.record_id
SEGMENTED BY hash(veeva_call_sample_20180815.record_id) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demographics_20181001_b0 /*+basename(prescriber_combined_demographics_20181001),createtype(A)*/ 
(
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 secondary_specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source
)
AS
 SELECT prescriber_combined_demographics_20181001.sales_force_id,
        prescriber_combined_demographics_20181001.ims_id,
        prescriber_combined_demographics_20181001.npi,
        prescriber_combined_demographics_20181001.tvcmid,
        prescriber_combined_demographics_20181001.veeva_account_id,
        prescriber_combined_demographics_20181001.specialty,
        prescriber_combined_demographics_20181001.secondary_specialty,
        prescriber_combined_demographics_20181001.first_name,
        prescriber_combined_demographics_20181001.middle_name,
        prescriber_combined_demographics_20181001.last_name,
        prescriber_combined_demographics_20181001.ptr_veeva_address_id,
        prescriber_combined_demographics_20181001.ptr_address_1,
        prescriber_combined_demographics_20181001.ptr_address_2,
        prescriber_combined_demographics_20181001.ptr_address_3,
        prescriber_combined_demographics_20181001.ptr_city,
        prescriber_combined_demographics_20181001.ptr_state,
        prescriber_combined_demographics_20181001.ptr_zip,
        prescriber_combined_demographics_20181001.ptr_phone,
        prescriber_combined_demographics_20181001.ptr_territory_num,
        prescriber_combined_demographics_20181001.ptr_territory_type,
        prescriber_combined_demographics_20181001.ptr_address_source,
        prescriber_combined_demographics_20181001.ptr_mailable,
        prescriber_combined_demographics_20181001.dea_num,
        prescriber_combined_demographics_20181001.pdrp_flag,
        prescriber_combined_demographics_20181001.pdrp_date,
        prescriber_combined_demographics_20181001.np_pa_flag,
        prescriber_combined_demographics_20181001.no_spend,
        prescriber_combined_demographics_20181001.ama_no_contact_flag,
        prescriber_combined_demographics_20181001.email,
        prescriber_combined_demographics_20181001.degree,
        prescriber_combined_demographics_20181001.address_id,
        prescriber_combined_demographics_20181001.address_latitude,
        prescriber_combined_demographics_20181001.address_longitude,
        prescriber_combined_demographics_20181001.row_source
 FROM archive.prescriber_combined_demographics_20181001
 ORDER BY prescriber_combined_demographics_20181001.sales_force_id,
          prescriber_combined_demographics_20181001.ims_id,
          prescriber_combined_demographics_20181001.npi,
          prescriber_combined_demographics_20181001.tvcmid,
          prescriber_combined_demographics_20181001.veeva_account_id,
          prescriber_combined_demographics_20181001.specialty,
          prescriber_combined_demographics_20181001.secondary_specialty,
          prescriber_combined_demographics_20181001.first_name,
          prescriber_combined_demographics_20181001.middle_name,
          prescriber_combined_demographics_20181001.last_name,
          prescriber_combined_demographics_20181001.ptr_veeva_address_id,
          prescriber_combined_demographics_20181001.ptr_address_1,
          prescriber_combined_demographics_20181001.ptr_address_2,
          prescriber_combined_demographics_20181001.ptr_address_3,
          prescriber_combined_demographics_20181001.ptr_city,
          prescriber_combined_demographics_20181001.ptr_state,
          prescriber_combined_demographics_20181001.ptr_zip,
          prescriber_combined_demographics_20181001.ptr_phone,
          prescriber_combined_demographics_20181001.ptr_territory_num,
          prescriber_combined_demographics_20181001.ptr_territory_type,
          prescriber_combined_demographics_20181001.ptr_address_source,
          prescriber_combined_demographics_20181001.ptr_mailable,
          prescriber_combined_demographics_20181001.dea_num,
          prescriber_combined_demographics_20181001.pdrp_flag,
          prescriber_combined_demographics_20181001.pdrp_date,
          prescriber_combined_demographics_20181001.np_pa_flag,
          prescriber_combined_demographics_20181001.no_spend,
          prescriber_combined_demographics_20181001.ama_no_contact_flag,
          prescriber_combined_demographics_20181001.email,
          prescriber_combined_demographics_20181001.degree,
          prescriber_combined_demographics_20181001.address_id,
          prescriber_combined_demographics_20181001.address_latitude,
          prescriber_combined_demographics_20181001.address_longitude,
          prescriber_combined_demographics_20181001.row_source
SEGMENTED BY hash(prescriber_combined_demographics_20181001.tvcmid, prescriber_combined_demographics_20181001.ptr_state, prescriber_combined_demographics_20181001.ptr_zip, prescriber_combined_demographics_20181001.ptr_mailable, prescriber_combined_demographics_20181001.pdrp_flag, prescriber_combined_demographics_20181001.pdrp_date, prescriber_combined_demographics_20181001.np_pa_flag, prescriber_combined_demographics_20181001.no_spend, prescriber_combined_demographics_20181001.ama_no_contact_flag, prescriber_combined_demographics_20181001.address_id, prescriber_combined_demographics_20181001.ims_id, prescriber_combined_demographics_20181001.npi, prescriber_combined_demographics_20181001.dea_num, prescriber_combined_demographics_20181001.ptr_territory_num, prescriber_combined_demographics_20181001.sales_force_id, prescriber_combined_demographics_20181001.veeva_account_id, prescriber_combined_demographics_20181001.ptr_veeva_address_id, prescriber_combined_demographics_20181001.address_latitude, prescriber_combined_demographics_20181001.address_longitude, prescriber_combined_demographics_20181001.ptr_territory_type, prescriber_combined_demographics_20181001.ptr_phone, prescriber_combined_demographics_20181001.first_name, prescriber_combined_demographics_20181001.middle_name, prescriber_combined_demographics_20181001.last_name, prescriber_combined_demographics_20181001.ptr_city, prescriber_combined_demographics_20181001.ptr_address_source, prescriber_combined_demographics_20181001.ptr_address_1, prescriber_combined_demographics_20181001.ptr_address_2, prescriber_combined_demographics_20181001.ptr_address_3, prescriber_combined_demographics_20181001.email, prescriber_combined_demographics_20181001.degree, prescriber_combined_demographics_20181001.row_source) ALL NODES;

CREATE PROJECTION archive.ic_decile_goal_setting_2018q4_20181005_b0 /*+basename(ic_decile_goal_setting_2018q4_20181005),createtype(A)*/ 
(
 ic_data_month,
 ims_id,
 tvcmid,
 decile_name,
 decile_value,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_decile_goal_setting_2018q4_20181005.ic_data_month,
        ic_decile_goal_setting_2018q4_20181005.ims_id,
        ic_decile_goal_setting_2018q4_20181005.tvcmid,
        ic_decile_goal_setting_2018q4_20181005.decile_name,
        ic_decile_goal_setting_2018q4_20181005.decile_value,
        ic_decile_goal_setting_2018q4_20181005.join_key,
        ic_decile_goal_setting_2018q4_20181005.row_source,
        ic_decile_goal_setting_2018q4_20181005.row_create_date
 FROM archive.ic_decile_goal_setting_2018q4_20181005
 ORDER BY ic_decile_goal_setting_2018q4_20181005.ic_data_month,
          ic_decile_goal_setting_2018q4_20181005.ims_id,
          ic_decile_goal_setting_2018q4_20181005.tvcmid,
          ic_decile_goal_setting_2018q4_20181005.decile_name,
          ic_decile_goal_setting_2018q4_20181005.decile_value,
          ic_decile_goal_setting_2018q4_20181005.join_key,
          ic_decile_goal_setting_2018q4_20181005.row_source,
          ic_decile_goal_setting_2018q4_20181005.row_create_date
SEGMENTED BY hash(ic_decile_goal_setting_2018q4_20181005.ic_data_month, ic_decile_goal_setting_2018q4_20181005.tvcmid, ic_decile_goal_setting_2018q4_20181005.decile_value, ic_decile_goal_setting_2018q4_20181005.row_create_date, ic_decile_goal_setting_2018q4_20181005.ims_id, ic_decile_goal_setting_2018q4_20181005.join_key, ic_decile_goal_setting_2018q4_20181005.row_source, ic_decile_goal_setting_2018q4_20181005.decile_name) ALL NODES;

CREATE PROJECTION archive.ic_demo_goal_setting_2018q4_20181005_b0 /*+basename(ic_demo_goal_setting_2018q4_20181005),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_demo_goal_setting_2018q4_20181005.ic_data_month,
        ic_demo_goal_setting_2018q4_20181005.sales_force_id,
        ic_demo_goal_setting_2018q4_20181005.area_number,
        ic_demo_goal_setting_2018q4_20181005.region_number,
        ic_demo_goal_setting_2018q4_20181005.territory_number,
        ic_demo_goal_setting_2018q4_20181005.ims_id,
        ic_demo_goal_setting_2018q4_20181005.tvcmid,
        ic_demo_goal_setting_2018q4_20181005.outlet_code,
        ic_demo_goal_setting_2018q4_20181005.va_station_number,
        ic_demo_goal_setting_2018q4_20181005.specialty,
        ic_demo_goal_setting_2018q4_20181005.last_name,
        ic_demo_goal_setting_2018q4_20181005.first_name,
        ic_demo_goal_setting_2018q4_20181005.mid_name,
        ic_demo_goal_setting_2018q4_20181005.address_1,
        ic_demo_goal_setting_2018q4_20181005.address_2,
        ic_demo_goal_setting_2018q4_20181005.address_3,
        ic_demo_goal_setting_2018q4_20181005.city,
        ic_demo_goal_setting_2018q4_20181005.state,
        ic_demo_goal_setting_2018q4_20181005.zip,
        ic_demo_goal_setting_2018q4_20181005.address_source,
        ic_demo_goal_setting_2018q4_20181005.pdrp_flag,
        ic_demo_goal_setting_2018q4_20181005.pdrp_date,
        ic_demo_goal_setting_2018q4_20181005.np_pa_flag,
        ic_demo_goal_setting_2018q4_20181005.no_spend,
        ic_demo_goal_setting_2018q4_20181005.ama_no_contact_flag,
        ic_demo_goal_setting_2018q4_20181005.join_key,
        ic_demo_goal_setting_2018q4_20181005.row_source,
        ic_demo_goal_setting_2018q4_20181005.row_create_date
 FROM archive.ic_demo_goal_setting_2018q4_20181005
 ORDER BY ic_demo_goal_setting_2018q4_20181005.ic_data_month,
          ic_demo_goal_setting_2018q4_20181005.sales_force_id,
          ic_demo_goal_setting_2018q4_20181005.area_number,
          ic_demo_goal_setting_2018q4_20181005.region_number,
          ic_demo_goal_setting_2018q4_20181005.territory_number,
          ic_demo_goal_setting_2018q4_20181005.ims_id,
          ic_demo_goal_setting_2018q4_20181005.tvcmid,
          ic_demo_goal_setting_2018q4_20181005.outlet_code,
          ic_demo_goal_setting_2018q4_20181005.va_station_number,
          ic_demo_goal_setting_2018q4_20181005.specialty,
          ic_demo_goal_setting_2018q4_20181005.last_name,
          ic_demo_goal_setting_2018q4_20181005.first_name,
          ic_demo_goal_setting_2018q4_20181005.mid_name,
          ic_demo_goal_setting_2018q4_20181005.address_1,
          ic_demo_goal_setting_2018q4_20181005.address_2,
          ic_demo_goal_setting_2018q4_20181005.address_3,
          ic_demo_goal_setting_2018q4_20181005.city,
          ic_demo_goal_setting_2018q4_20181005.state,
          ic_demo_goal_setting_2018q4_20181005.zip,
          ic_demo_goal_setting_2018q4_20181005.address_source,
          ic_demo_goal_setting_2018q4_20181005.pdrp_flag,
          ic_demo_goal_setting_2018q4_20181005.pdrp_date,
          ic_demo_goal_setting_2018q4_20181005.np_pa_flag,
          ic_demo_goal_setting_2018q4_20181005.no_spend,
          ic_demo_goal_setting_2018q4_20181005.ama_no_contact_flag,
          ic_demo_goal_setting_2018q4_20181005.join_key,
          ic_demo_goal_setting_2018q4_20181005.row_source,
          ic_demo_goal_setting_2018q4_20181005.row_create_date
SEGMENTED BY hash(ic_demo_goal_setting_2018q4_20181005.ic_data_month, ic_demo_goal_setting_2018q4_20181005.tvcmid, ic_demo_goal_setting_2018q4_20181005.outlet_code, ic_demo_goal_setting_2018q4_20181005.mid_name, ic_demo_goal_setting_2018q4_20181005.state, ic_demo_goal_setting_2018q4_20181005.zip, ic_demo_goal_setting_2018q4_20181005.pdrp_flag, ic_demo_goal_setting_2018q4_20181005.pdrp_date, ic_demo_goal_setting_2018q4_20181005.np_pa_flag, ic_demo_goal_setting_2018q4_20181005.no_spend, ic_demo_goal_setting_2018q4_20181005.ama_no_contact_flag, ic_demo_goal_setting_2018q4_20181005.row_create_date, ic_demo_goal_setting_2018q4_20181005.ims_id, ic_demo_goal_setting_2018q4_20181005.va_station_number, ic_demo_goal_setting_2018q4_20181005.specialty, ic_demo_goal_setting_2018q4_20181005.join_key, ic_demo_goal_setting_2018q4_20181005.area_number, ic_demo_goal_setting_2018q4_20181005.region_number, ic_demo_goal_setting_2018q4_20181005.territory_number, ic_demo_goal_setting_2018q4_20181005.sales_force_id, ic_demo_goal_setting_2018q4_20181005.first_name, ic_demo_goal_setting_2018q4_20181005.city, ic_demo_goal_setting_2018q4_20181005.address_source, ic_demo_goal_setting_2018q4_20181005.last_name, ic_demo_goal_setting_2018q4_20181005.address_1, ic_demo_goal_setting_2018q4_20181005.address_2, ic_demo_goal_setting_2018q4_20181005.address_3, ic_demo_goal_setting_2018q4_20181005.row_source) ALL NODES;

CREATE PROJECTION archive.ic_rx_goal_setting_2018q4_20181005_b0 /*+basename(ic_rx_goal_setting_2018q4_20181005),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication
)
AS
 SELECT ic_rx_goal_setting_2018q4_20181005.ic_data_month,
        ic_rx_goal_setting_2018q4_20181005.basket_name,
        ic_rx_goal_setting_2018q4_20181005.sales_force_id,
        ic_rx_goal_setting_2018q4_20181005.area_number,
        ic_rx_goal_setting_2018q4_20181005.region_number,
        ic_rx_goal_setting_2018q4_20181005.territory_number,
        ic_rx_goal_setting_2018q4_20181005.ims_id,
        ic_rx_goal_setting_2018q4_20181005.tvcmid,
        ic_rx_goal_setting_2018q4_20181005.outlet_code,
        ic_rx_goal_setting_2018q4_20181005.va_station_number,
        ic_rx_goal_setting_2018q4_20181005.dnc_flag,
        ic_rx_goal_setting_2018q4_20181005.dnp_flag,
        ic_rx_goal_setting_2018q4_20181005.rollup_month,
        ic_rx_goal_setting_2018q4_20181005.month_bucket,
        ic_rx_goal_setting_2018q4_20181005.nrx_count,
        ic_rx_goal_setting_2018q4_20181005.trx_count,
        ic_rx_goal_setting_2018q4_20181005.nrx_quantity,
        ic_rx_goal_setting_2018q4_20181005.trx_quantity,
        ic_rx_goal_setting_2018q4_20181005.include_in_nation_rollup,
        ic_rx_goal_setting_2018q4_20181005.include_in_area_rollup,
        ic_rx_goal_setting_2018q4_20181005.include_in_region_rollup,
        ic_rx_goal_setting_2018q4_20181005.join_key,
        ic_rx_goal_setting_2018q4_20181005.row_source,
        ic_rx_goal_setting_2018q4_20181005.row_create_date,
        ic_rx_goal_setting_2018q4_20181005.indication
 FROM archive.ic_rx_goal_setting_2018q4_20181005
 ORDER BY ic_rx_goal_setting_2018q4_20181005.ic_data_month,
          ic_rx_goal_setting_2018q4_20181005.basket_name,
          ic_rx_goal_setting_2018q4_20181005.sales_force_id,
          ic_rx_goal_setting_2018q4_20181005.area_number,
          ic_rx_goal_setting_2018q4_20181005.region_number,
          ic_rx_goal_setting_2018q4_20181005.territory_number,
          ic_rx_goal_setting_2018q4_20181005.ims_id,
          ic_rx_goal_setting_2018q4_20181005.tvcmid,
          ic_rx_goal_setting_2018q4_20181005.outlet_code,
          ic_rx_goal_setting_2018q4_20181005.va_station_number,
          ic_rx_goal_setting_2018q4_20181005.dnc_flag,
          ic_rx_goal_setting_2018q4_20181005.dnp_flag,
          ic_rx_goal_setting_2018q4_20181005.rollup_month,
          ic_rx_goal_setting_2018q4_20181005.month_bucket,
          ic_rx_goal_setting_2018q4_20181005.nrx_count,
          ic_rx_goal_setting_2018q4_20181005.trx_count,
          ic_rx_goal_setting_2018q4_20181005.nrx_quantity,
          ic_rx_goal_setting_2018q4_20181005.trx_quantity,
          ic_rx_goal_setting_2018q4_20181005.include_in_nation_rollup,
          ic_rx_goal_setting_2018q4_20181005.include_in_area_rollup,
          ic_rx_goal_setting_2018q4_20181005.include_in_region_rollup,
          ic_rx_goal_setting_2018q4_20181005.join_key,
          ic_rx_goal_setting_2018q4_20181005.row_source,
          ic_rx_goal_setting_2018q4_20181005.row_create_date,
          ic_rx_goal_setting_2018q4_20181005.indication
SEGMENTED BY hash(ic_rx_goal_setting_2018q4_20181005.ic_data_month, ic_rx_goal_setting_2018q4_20181005.tvcmid, ic_rx_goal_setting_2018q4_20181005.outlet_code, ic_rx_goal_setting_2018q4_20181005.dnc_flag, ic_rx_goal_setting_2018q4_20181005.dnp_flag, ic_rx_goal_setting_2018q4_20181005.rollup_month, ic_rx_goal_setting_2018q4_20181005.month_bucket, ic_rx_goal_setting_2018q4_20181005.nrx_count, ic_rx_goal_setting_2018q4_20181005.trx_count, ic_rx_goal_setting_2018q4_20181005.nrx_quantity, ic_rx_goal_setting_2018q4_20181005.trx_quantity, ic_rx_goal_setting_2018q4_20181005.include_in_nation_rollup, ic_rx_goal_setting_2018q4_20181005.include_in_area_rollup, ic_rx_goal_setting_2018q4_20181005.include_in_region_rollup, ic_rx_goal_setting_2018q4_20181005.row_create_date, ic_rx_goal_setting_2018q4_20181005.ims_id, ic_rx_goal_setting_2018q4_20181005.va_station_number, ic_rx_goal_setting_2018q4_20181005.join_key, ic_rx_goal_setting_2018q4_20181005.area_number, ic_rx_goal_setting_2018q4_20181005.region_number, ic_rx_goal_setting_2018q4_20181005.territory_number, ic_rx_goal_setting_2018q4_20181005.sales_force_id, ic_rx_goal_setting_2018q4_20181005.indication, ic_rx_goal_setting_2018q4_20181005.row_source, ic_rx_goal_setting_2018q4_20181005.basket_name) ALL NODES;

CREATE PROJECTION archive.ic_target_goal_setting_2018q4_20181005_b0 /*+basename(ic_target_goal_setting_2018q4_20181005),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 row_create_date
)
AS
 SELECT ic_target_goal_setting_2018q4_20181005.ic_data_month,
        ic_target_goal_setting_2018q4_20181005.basket_name,
        ic_target_goal_setting_2018q4_20181005.sales_force_id,
        ic_target_goal_setting_2018q4_20181005.area_number,
        ic_target_goal_setting_2018q4_20181005.region_number,
        ic_target_goal_setting_2018q4_20181005.territory_number,
        ic_target_goal_setting_2018q4_20181005.ims_id,
        ic_target_goal_setting_2018q4_20181005.tvcmid,
        ic_target_goal_setting_2018q4_20181005.row_create_date
 FROM archive.ic_target_goal_setting_2018q4_20181005
 ORDER BY ic_target_goal_setting_2018q4_20181005.ic_data_month,
          ic_target_goal_setting_2018q4_20181005.basket_name,
          ic_target_goal_setting_2018q4_20181005.sales_force_id,
          ic_target_goal_setting_2018q4_20181005.area_number,
          ic_target_goal_setting_2018q4_20181005.region_number,
          ic_target_goal_setting_2018q4_20181005.territory_number,
          ic_target_goal_setting_2018q4_20181005.ims_id,
          ic_target_goal_setting_2018q4_20181005.tvcmid,
          ic_target_goal_setting_2018q4_20181005.row_create_date
SEGMENTED BY hash(ic_target_goal_setting_2018q4_20181005.ic_data_month, ic_target_goal_setting_2018q4_20181005.tvcmid, ic_target_goal_setting_2018q4_20181005.row_create_date, ic_target_goal_setting_2018q4_20181005.ims_id, ic_target_goal_setting_2018q4_20181005.area_number, ic_target_goal_setting_2018q4_20181005.region_number, ic_target_goal_setting_2018q4_20181005.territory_number, ic_target_goal_setting_2018q4_20181005.sales_force_id, ic_target_goal_setting_2018q4_20181005.basket_name) ALL NODES;

CREATE PROJECTION archive.prescriber_combined_demo_frozen_20190426_b0 /*+basename(prescriber_combined_demo_frozen_20190426),createtype(A)*/ 
(
 start_date,
 end_date,
 sales_force_id,
 ims_id,
 npi,
 tvcmid,
 veeva_account_id,
 specialty,
 first_name,
 middle_name,
 last_name,
 ptr_veeva_address_id,
 ptr_address_1,
 ptr_address_2,
 ptr_address_3,
 ptr_city,
 ptr_state,
 ptr_zip,
 ptr_phone,
 ptr_territory_num,
 ptr_territory_type,
 ptr_address_source,
 ptr_mailable,
 dea_num,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 email,
 degree,
 address_id,
 address_latitude,
 address_longitude,
 row_source,
 freeze_reason,
 freeze_date,
 secondary_specialty
)
AS
 SELECT prescriber_combined_demo_frozen_20190426.start_date,
        prescriber_combined_demo_frozen_20190426.end_date,
        prescriber_combined_demo_frozen_20190426.sales_force_id,
        prescriber_combined_demo_frozen_20190426.ims_id,
        prescriber_combined_demo_frozen_20190426.npi,
        prescriber_combined_demo_frozen_20190426.tvcmid,
        prescriber_combined_demo_frozen_20190426.veeva_account_id,
        prescriber_combined_demo_frozen_20190426.specialty,
        prescriber_combined_demo_frozen_20190426.first_name,
        prescriber_combined_demo_frozen_20190426.middle_name,
        prescriber_combined_demo_frozen_20190426.last_name,
        prescriber_combined_demo_frozen_20190426.ptr_veeva_address_id,
        prescriber_combined_demo_frozen_20190426.ptr_address_1,
        prescriber_combined_demo_frozen_20190426.ptr_address_2,
        prescriber_combined_demo_frozen_20190426.ptr_address_3,
        prescriber_combined_demo_frozen_20190426.ptr_city,
        prescriber_combined_demo_frozen_20190426.ptr_state,
        prescriber_combined_demo_frozen_20190426.ptr_zip,
        prescriber_combined_demo_frozen_20190426.ptr_phone,
        prescriber_combined_demo_frozen_20190426.ptr_territory_num,
        prescriber_combined_demo_frozen_20190426.ptr_territory_type,
        prescriber_combined_demo_frozen_20190426.ptr_address_source,
        prescriber_combined_demo_frozen_20190426.ptr_mailable,
        prescriber_combined_demo_frozen_20190426.dea_num,
        prescriber_combined_demo_frozen_20190426.pdrp_flag,
        prescriber_combined_demo_frozen_20190426.pdrp_date,
        prescriber_combined_demo_frozen_20190426.np_pa_flag,
        prescriber_combined_demo_frozen_20190426.no_spend,
        prescriber_combined_demo_frozen_20190426.ama_no_contact_flag,
        prescriber_combined_demo_frozen_20190426.email,
        prescriber_combined_demo_frozen_20190426.degree,
        prescriber_combined_demo_frozen_20190426.address_id,
        prescriber_combined_demo_frozen_20190426.address_latitude,
        prescriber_combined_demo_frozen_20190426.address_longitude,
        prescriber_combined_demo_frozen_20190426.row_source,
        prescriber_combined_demo_frozen_20190426.freeze_reason,
        prescriber_combined_demo_frozen_20190426.freeze_date,
        prescriber_combined_demo_frozen_20190426.secondary_specialty
 FROM archive.prescriber_combined_demo_frozen_20190426
 ORDER BY prescriber_combined_demo_frozen_20190426.sales_force_id,
          prescriber_combined_demo_frozen_20190426.ims_id,
          prescriber_combined_demo_frozen_20190426.npi,
          prescriber_combined_demo_frozen_20190426.tvcmid,
          prescriber_combined_demo_frozen_20190426.veeva_account_id,
          prescriber_combined_demo_frozen_20190426.specialty,
          prescriber_combined_demo_frozen_20190426.first_name,
          prescriber_combined_demo_frozen_20190426.middle_name,
          prescriber_combined_demo_frozen_20190426.last_name,
          prescriber_combined_demo_frozen_20190426.ptr_veeva_address_id,
          prescriber_combined_demo_frozen_20190426.ptr_address_1,
          prescriber_combined_demo_frozen_20190426.ptr_address_2,
          prescriber_combined_demo_frozen_20190426.ptr_address_3,
          prescriber_combined_demo_frozen_20190426.ptr_city,
          prescriber_combined_demo_frozen_20190426.ptr_state,
          prescriber_combined_demo_frozen_20190426.ptr_zip,
          prescriber_combined_demo_frozen_20190426.ptr_phone,
          prescriber_combined_demo_frozen_20190426.ptr_territory_num,
          prescriber_combined_demo_frozen_20190426.ptr_territory_type,
          prescriber_combined_demo_frozen_20190426.ptr_address_source,
          prescriber_combined_demo_frozen_20190426.ptr_mailable,
          prescriber_combined_demo_frozen_20190426.dea_num,
          prescriber_combined_demo_frozen_20190426.pdrp_flag,
          prescriber_combined_demo_frozen_20190426.pdrp_date,
          prescriber_combined_demo_frozen_20190426.np_pa_flag,
          prescriber_combined_demo_frozen_20190426.no_spend,
          prescriber_combined_demo_frozen_20190426.ama_no_contact_flag,
          prescriber_combined_demo_frozen_20190426.email,
          prescriber_combined_demo_frozen_20190426.degree,
          prescriber_combined_demo_frozen_20190426.address_id,
          prescriber_combined_demo_frozen_20190426.address_latitude,
          prescriber_combined_demo_frozen_20190426.address_longitude,
          prescriber_combined_demo_frozen_20190426.row_source
SEGMENTED BY hash(prescriber_combined_demo_frozen_20190426.tvcmid, prescriber_combined_demo_frozen_20190426.ptr_state, prescriber_combined_demo_frozen_20190426.ptr_zip, prescriber_combined_demo_frozen_20190426.ptr_mailable, prescriber_combined_demo_frozen_20190426.pdrp_flag, prescriber_combined_demo_frozen_20190426.pdrp_date, prescriber_combined_demo_frozen_20190426.np_pa_flag, prescriber_combined_demo_frozen_20190426.no_spend, prescriber_combined_demo_frozen_20190426.ama_no_contact_flag, prescriber_combined_demo_frozen_20190426.address_id, prescriber_combined_demo_frozen_20190426.ims_id, prescriber_combined_demo_frozen_20190426.npi, prescriber_combined_demo_frozen_20190426.dea_num, prescriber_combined_demo_frozen_20190426.ptr_territory_num, prescriber_combined_demo_frozen_20190426.sales_force_id, prescriber_combined_demo_frozen_20190426.veeva_account_id, prescriber_combined_demo_frozen_20190426.ptr_veeva_address_id, prescriber_combined_demo_frozen_20190426.address_latitude, prescriber_combined_demo_frozen_20190426.address_longitude, prescriber_combined_demo_frozen_20190426.ptr_territory_type, prescriber_combined_demo_frozen_20190426.ptr_phone, prescriber_combined_demo_frozen_20190426.first_name, prescriber_combined_demo_frozen_20190426.middle_name, prescriber_combined_demo_frozen_20190426.last_name, prescriber_combined_demo_frozen_20190426.ptr_city, prescriber_combined_demo_frozen_20190426.ptr_address_source, prescriber_combined_demo_frozen_20190426.ptr_address_1, prescriber_combined_demo_frozen_20190426.ptr_address_2, prescriber_combined_demo_frozen_20190426.ptr_address_3, prescriber_combined_demo_frozen_20190426.email, prescriber_combined_demo_frozen_20190426.degree, prescriber_combined_demo_frozen_20190426.row_source) ALL NODES;

CREATE PROJECTION archive.copay_20190618_b0 /*+basename(copay_20190618),createtype(A)*/ 
(
 redemption_type,
 physician_tvcmid,
 pharmacy_tvcmid,
 basket_id,
 basket_name,
 asi_txn_id,
 orig_asi_txn_id,
 rx_num,
 fill_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 program_number,
 copay_card_number,
 sex,
 age_at_redemption,
 pharmacy_process_date,
 pharmacy_chain_number,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_npi_num,
 principle_physician_dea,
 physician_npi,
 physician_ims_id,
 physician_veeva_id,
 physician_name,
 physician_address1,
 physician_address2,
 physician_city,
 physician_state,
 physician_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 calc_awp,
 create_date,
 occ_payment_type,
 counted_copay,
 auth_refills,
 admin_hcp_npi,
 admin_hcp_name,
 admin_hcp_address,
 admin_hcp_address2,
 admin_hcp_city,
 admin_hcp_state,
 admin_hcp_zip,
 claim_type,
 administration_flag,
 soc_name,
 soc_phone,
 soc_fax,
 soc_address,
 soc_city,
 soc_state,
 soc_zip,
 soc_id,
 soc_npi,
 payer_name,
 cpt_code,
 trans_type,
 previous_payer_id,
 member_id,
 benefit_amount,
 patient_expense,
 submission_method,
 report_frequency,
 source_name,
 file_id,
 record_id
)
AS
 SELECT copay_20190618.redemption_type,
        copay_20190618.physician_tvcmid,
        copay_20190618.pharmacy_tvcmid,
        copay_20190618.basket_id,
        copay_20190618.basket_name,
        copay_20190618.asi_txn_id,
        copay_20190618.orig_asi_txn_id,
        copay_20190618.rx_num,
        copay_20190618.fill_date,
        copay_20190618.date_written,
        copay_20190618.days_supply,
        copay_20190618.ndc_code,
        copay_20190618.daw,
        copay_20190618.new_refill,
        copay_20190618.quantity,
        copay_20190618.refills,
        copay_20190618.other_coverage_code,
        copay_20190618.program_number,
        copay_20190618.copay_card_number,
        copay_20190618.sex,
        copay_20190618.age_at_redemption,
        copay_20190618.pharmacy_process_date,
        copay_20190618.pharmacy_chain_number,
        copay_20190618.nabp,
        copay_20190618.pharmacy_chain,
        copay_20190618.pharmacy_name,
        copay_20190618.pharmacy_address,
        copay_20190618.pharmacy_address2,
        copay_20190618.pharmacy_city,
        copay_20190618.pharmacy_state,
        copay_20190618.pharmacy_zip,
        copay_20190618.pharmacy_phone,
        copay_20190618.pharmacy_npi_num,
        copay_20190618.principle_physician_dea,
        copay_20190618.physician_npi,
        copay_20190618.physician_ims_id,
        copay_20190618.physician_veeva_id,
        copay_20190618.physician_name,
        copay_20190618.physician_address1,
        copay_20190618.physician_address2,
        copay_20190618.physician_city,
        copay_20190618.physician_state,
        copay_20190618.physician_zip,
        copay_20190618.rebate_amount,
        copay_20190618.member_cash_expense,
        copay_20190618.submitted_cost,
        copay_20190618.pharmacy_fee,
        copay_20190618.total_amount_due,
        copay_20190618.calc_awp,
        copay_20190618.create_date,
        copay_20190618.occ_payment_type,
        copay_20190618.counted_copay,
        copay_20190618.auth_refills,
        copay_20190618.admin_hcp_npi,
        copay_20190618.admin_hcp_name,
        copay_20190618.admin_hcp_address,
        copay_20190618.admin_hcp_address2,
        copay_20190618.admin_hcp_city,
        copay_20190618.admin_hcp_state,
        copay_20190618.admin_hcp_zip,
        copay_20190618.claim_type,
        copay_20190618.administration_flag,
        copay_20190618.soc_name,
        copay_20190618.soc_phone,
        copay_20190618.soc_fax,
        copay_20190618.soc_address,
        copay_20190618.soc_city,
        copay_20190618.soc_state,
        copay_20190618.soc_zip,
        copay_20190618.soc_id,
        copay_20190618.soc_npi,
        copay_20190618.payer_name,
        copay_20190618.cpt_code,
        copay_20190618.trans_type,
        copay_20190618.previous_payer_id,
        copay_20190618.member_id,
        copay_20190618.benefit_amount,
        copay_20190618.patient_expense,
        copay_20190618.submission_method,
        copay_20190618.report_frequency,
        copay_20190618.source_name,
        copay_20190618.file_id,
        copay_20190618.record_id
 FROM archive.copay_20190618
 ORDER BY copay_20190618.source_name,
          copay_20190618.asi_txn_id
SEGMENTED BY hash(copay_20190618.physician_npi) ALL NODES;

CREATE PROJECTION archive.prescriber_rx_gcsf_tki_bkp_201801_b0 /*+basename(prescriber_rx_gcsf_tki_bkp_201801),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication
)
AS
 SELECT prescriber_rx_gcsf_tki_bkp_201712.ims_id,
        prescriber_rx_gcsf_tki_bkp_201712.payer_plan_number,
        prescriber_rx_gcsf_tki_bkp_201712.ims_client_number,
        prescriber_rx_gcsf_tki_bkp_201712.report_frequency,
        prescriber_rx_gcsf_tki_bkp_201712.ims_product_group,
        prescriber_rx_gcsf_tki_bkp_201712.basket_id,
        prescriber_rx_gcsf_tki_bkp_201712.data_date,
        prescriber_rx_gcsf_tki_bkp_201712.date,
        prescriber_rx_gcsf_tki_bkp_201712.sales_category,
        prescriber_rx_gcsf_tki_bkp_201712.tvcmid,
        prescriber_rx_gcsf_tki_bkp_201712.prescriber_first_name,
        prescriber_rx_gcsf_tki_bkp_201712.prescriber_last_name,
        prescriber_rx_gcsf_tki_bkp_201712.basket_name,
        prescriber_rx_gcsf_tki_bkp_201712.basket_type,
        prescriber_rx_gcsf_tki_bkp_201712.rollup_week,
        prescriber_rx_gcsf_tki_bkp_201712.rollup_month,
        prescriber_rx_gcsf_tki_bkp_201712.nrx_count,
        prescriber_rx_gcsf_tki_bkp_201712.trx_count,
        prescriber_rx_gcsf_tki_bkp_201712.nrx_quantity,
        prescriber_rx_gcsf_tki_bkp_201712.trx_quantity,
        prescriber_rx_gcsf_tki_bkp_201712.unnormalized_nrx_count,
        prescriber_rx_gcsf_tki_bkp_201712.unnormalized_trx_count,
        prescriber_rx_gcsf_tki_bkp_201712.market_name,
        prescriber_rx_gcsf_tki_bkp_201712.payer_name,
        prescriber_rx_gcsf_tki_bkp_201712.plan_name,
        prescriber_rx_gcsf_tki_bkp_201712.pbm_name,
        prescriber_rx_gcsf_tki_bkp_201712.model,
        prescriber_rx_gcsf_tki_bkp_201712.payment_method,
        prescriber_rx_gcsf_tki_bkp_201712.ims_specialty,
        prescriber_rx_gcsf_tki_bkp_201712.ims_rx_type,
        prescriber_rx_gcsf_tki_bkp_201712.ims_supplemental_data,
        prescriber_rx_gcsf_tki_bkp_201712.ims_zip_other,
        prescriber_rx_gcsf_tki_bkp_201712.ims_report_number_cnt,
        prescriber_rx_gcsf_tki_bkp_201712.cnt_file_id,
        prescriber_rx_gcsf_tki_bkp_201712.cnt_record_id,
        prescriber_rx_gcsf_tki_bkp_201712.ims_report_number_qty,
        prescriber_rx_gcsf_tki_bkp_201712.qty_file_id,
        prescriber_rx_gcsf_tki_bkp_201712.qty_record_id,
        prescriber_rx_gcsf_tki_bkp_201712.rollup_flag,
        prescriber_rx_gcsf_tki_bkp_201712.indication
 FROM archive.prescriber_rx_gcsf_tki_bkp_201712
 ORDER BY prescriber_rx_gcsf_tki_bkp_201712.rollup_flag,
          prescriber_rx_gcsf_tki_bkp_201712.ims_rx_type,
          prescriber_rx_gcsf_tki_bkp_201712.report_frequency,
          prescriber_rx_gcsf_tki_bkp_201712.basket_type,
          prescriber_rx_gcsf_tki_bkp_201712.indication,
          prescriber_rx_gcsf_tki_bkp_201712.market_name,
          prescriber_rx_gcsf_tki_bkp_201712.ims_product_group,
          prescriber_rx_gcsf_tki_bkp_201712.basket_id,
          prescriber_rx_gcsf_tki_bkp_201712.ims_specialty,
          prescriber_rx_gcsf_tki_bkp_201712.ims_zip_other,
          prescriber_rx_gcsf_tki_bkp_201712.ims_report_number_qty,
          prescriber_rx_gcsf_tki_bkp_201712.ims_report_number_cnt,
          prescriber_rx_gcsf_tki_bkp_201712.tvcmid,
          prescriber_rx_gcsf_tki_bkp_201712.payment_method,
          prescriber_rx_gcsf_tki_bkp_201712.payer_plan_number,
          prescriber_rx_gcsf_tki_bkp_201712.rollup_month,
          prescriber_rx_gcsf_tki_bkp_201712.rollup_week,
          prescriber_rx_gcsf_tki_bkp_201712.nrx_quantity,
          prescriber_rx_gcsf_tki_bkp_201712.trx_quantity,
          prescriber_rx_gcsf_tki_bkp_201712.nrx_count,
          prescriber_rx_gcsf_tki_bkp_201712.trx_count,
          prescriber_rx_gcsf_tki_bkp_201712.sales_category,
          prescriber_rx_gcsf_tki_bkp_201712.ims_id
SEGMENTED BY hash(prescriber_rx_gcsf_tki_bkp_201712.ims_id) ALL NODES;

CREATE PROJECTION archive.bag_20180329_b0 /*+basename(bag_20180329),createtype(A)*/ 
(
 bag_id,
 bag_name,
 first_valid_date,
 last_valid_date,
 valid_for_today,
 create_user,
 create_date,
 update_user,
 update_date
)
AS
 SELECT bag_20180329.bag_id,
        bag_20180329.bag_name,
        bag_20180329.first_valid_date,
        bag_20180329.last_valid_date,
        bag_20180329.valid_for_today,
        bag_20180329.create_user,
        bag_20180329.create_date,
        bag_20180329.update_user,
        bag_20180329.update_date
 FROM archive.bag_20180329
 ORDER BY bag_20180329.bag_id,
          bag_20180329.bag_name,
          bag_20180329.first_valid_date,
          bag_20180329.last_valid_date,
          bag_20180329.valid_for_today,
          bag_20180329.create_user,
          bag_20180329.create_date,
          bag_20180329.update_user,
          bag_20180329.update_date
SEGMENTED BY hash(bag_20180329.first_valid_date, bag_20180329.last_valid_date) ALL NODES;

CREATE PROJECTION archive.bag_product_20180329_b0 /*+basename(bag_product_20180329),createtype(A)*/ 
(
 bag_id,
 basket_id,
 basket_name,
 "position",
 weight,
 create_user,
 create_date,
 update_user,
 update_date
)
AS
 SELECT bag_product_20180329.bag_id,
        bag_product_20180329.basket_id,
        bag_product_20180329.basket_name,
        bag_product_20180329."position",
        bag_product_20180329.weight,
        bag_product_20180329.create_user,
        bag_product_20180329.create_date,
        bag_product_20180329.update_user,
        bag_product_20180329.update_date
 FROM archive.bag_product_20180329
 ORDER BY bag_product_20180329.bag_id,
          bag_product_20180329.basket_id,
          bag_product_20180329.basket_name,
          bag_product_20180329."position",
          bag_product_20180329.weight,
          bag_product_20180329.create_user,
          bag_product_20180329.create_date,
          bag_product_20180329.update_user,
          bag_product_20180329.update_date
SEGMENTED BY hash(bag_product_20180329.bag_id) ALL NODES;

CREATE PROJECTION archive.bag_territory_20180329_b0 /*+basename(bag_territory_20180329),createtype(A)*/ 
(
 bag_id,
 territory_number,
 detail_first_valid_date,
 detail_last_valid_date,
 ic_first_valid_date,
 ic_last_valid_date,
 valid_for_today,
 valid_for_ic,
 create_user,
 create_date,
 update_user,
 update_date
)
AS
 SELECT bag_territory_20180329.bag_id,
        bag_territory_20180329.territory_number,
        bag_territory_20180329.detail_first_valid_date,
        bag_territory_20180329.detail_last_valid_date,
        bag_territory_20180329.ic_first_valid_date,
        bag_territory_20180329.ic_last_valid_date,
        bag_territory_20180329.valid_for_today,
        bag_territory_20180329.valid_for_ic,
        bag_territory_20180329.create_user,
        bag_territory_20180329.create_date,
        bag_territory_20180329.update_user,
        bag_territory_20180329.update_date
 FROM archive.bag_territory_20180329
 ORDER BY bag_territory_20180329.bag_id,
          bag_territory_20180329.territory_number,
          bag_territory_20180329.detail_first_valid_date,
          bag_territory_20180329.detail_last_valid_date,
          bag_territory_20180329.ic_first_valid_date,
          bag_territory_20180329.ic_last_valid_date,
          bag_territory_20180329.valid_for_today,
          bag_territory_20180329.valid_for_ic,
          bag_territory_20180329.create_user,
          bag_territory_20180329.create_date,
          bag_territory_20180329.update_user,
          bag_territory_20180329.update_date
SEGMENTED BY hash(bag_territory_20180329.bag_id) ALL NODES;

CREATE PROJECTION archive.copay_voucher_program_vertica_20180613_b0 /*+basename(copay_voucher_program_vertica_20180613),createtype(A)*/ 
(
 program_key,
 redemption_type,
 program_number,
 program_description,
 sales_force_id,
 program_type,
 product_name,
 program_start_date,
 program_end_date,
 active_ind,
 create_date,
 last_upd_date,
 number_of_tablets
)
AS
 SELECT copay_voucher_program_vertica_20180613.program_key,
        copay_voucher_program_vertica_20180613.redemption_type,
        copay_voucher_program_vertica_20180613.program_number,
        copay_voucher_program_vertica_20180613.program_description,
        copay_voucher_program_vertica_20180613.sales_force_id,
        copay_voucher_program_vertica_20180613.program_type,
        copay_voucher_program_vertica_20180613.product_name,
        copay_voucher_program_vertica_20180613.program_start_date,
        copay_voucher_program_vertica_20180613.program_end_date,
        copay_voucher_program_vertica_20180613.active_ind,
        copay_voucher_program_vertica_20180613.create_date,
        copay_voucher_program_vertica_20180613.last_upd_date,
        copay_voucher_program_vertica_20180613.number_of_tablets
 FROM archive.copay_voucher_program_vertica_20180613
 ORDER BY copay_voucher_program_vertica_20180613.program_key,
          copay_voucher_program_vertica_20180613.redemption_type,
          copay_voucher_program_vertica_20180613.program_number,
          copay_voucher_program_vertica_20180613.program_description,
          copay_voucher_program_vertica_20180613.sales_force_id,
          copay_voucher_program_vertica_20180613.program_type,
          copay_voucher_program_vertica_20180613.product_name,
          copay_voucher_program_vertica_20180613.program_start_date,
          copay_voucher_program_vertica_20180613.program_end_date,
          copay_voucher_program_vertica_20180613.active_ind,
          copay_voucher_program_vertica_20180613.create_date,
          copay_voucher_program_vertica_20180613.last_upd_date,
          copay_voucher_program_vertica_20180613.number_of_tablets
SEGMENTED BY hash(copay_voucher_program_vertica_20180613.create_date) ALL NODES;

CREATE PROJECTION archive.copay_voucher_program_oracle_20180613_b0 /*+basename(copay_voucher_program_oracle_20180613),createtype(A)*/ 
(
 program_key,
 redemption_type,
 program_number,
 program_description,
 sales_force_id,
 program_type,
 product_name,
 program_start_date,
 program_end_date,
 active_ind,
 create_date,
 last_upd_date,
 number_of_tablets
)
AS
 SELECT copay_voucher_program_oracle_20180613.program_key,
        copay_voucher_program_oracle_20180613.redemption_type,
        copay_voucher_program_oracle_20180613.program_number,
        copay_voucher_program_oracle_20180613.program_description,
        copay_voucher_program_oracle_20180613.sales_force_id,
        copay_voucher_program_oracle_20180613.program_type,
        copay_voucher_program_oracle_20180613.product_name,
        copay_voucher_program_oracle_20180613.program_start_date,
        copay_voucher_program_oracle_20180613.program_end_date,
        copay_voucher_program_oracle_20180613.active_ind,
        copay_voucher_program_oracle_20180613.create_date,
        copay_voucher_program_oracle_20180613.last_upd_date,
        copay_voucher_program_oracle_20180613.number_of_tablets
 FROM archive.copay_voucher_program_oracle_20180613
 ORDER BY copay_voucher_program_oracle_20180613.program_key,
          copay_voucher_program_oracle_20180613.redemption_type,
          copay_voucher_program_oracle_20180613.program_number,
          copay_voucher_program_oracle_20180613.program_description,
          copay_voucher_program_oracle_20180613.sales_force_id,
          copay_voucher_program_oracle_20180613.program_type,
          copay_voucher_program_oracle_20180613.product_name,
          copay_voucher_program_oracle_20180613.program_start_date,
          copay_voucher_program_oracle_20180613.program_end_date,
          copay_voucher_program_oracle_20180613.active_ind,
          copay_voucher_program_oracle_20180613.create_date,
          copay_voucher_program_oracle_20180613.last_upd_date,
          copay_voucher_program_oracle_20180613.number_of_tablets
SEGMENTED BY hash(copay_voucher_program_oracle_20180613.program_key, copay_voucher_program_oracle_20180613.program_start_date, copay_voucher_program_oracle_20180613.program_end_date, copay_voucher_program_oracle_20180613.active_ind, copay_voucher_program_oracle_20180613.create_date, copay_voucher_program_oracle_20180613.last_upd_date, copay_voucher_program_oracle_20180613.number_of_tablets, copay_voucher_program_oracle_20180613.program_number, copay_voucher_program_oracle_20180613.sales_force_id, copay_voucher_program_oracle_20180613.redemption_type, copay_voucher_program_oracle_20180613.program_type, copay_voucher_program_oracle_20180613.product_name, copay_voucher_program_oracle_20180613.program_description) ALL NODES;

CREATE PROJECTION archive.copay_20190624_b0 /*+basename(copay_20190624),createtype(A)*/ 
(
 redemption_type,
 physician_tvcmid,
 pharmacy_tvcmid,
 basket_id,
 basket_name,
 asi_txn_id,
 orig_asi_txn_id,
 rx_num,
 fill_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 program_number,
 copay_card_number,
 sex,
 age_at_redemption,
 pharmacy_process_date,
 pharmacy_chain_number,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_npi_num,
 principle_physician_dea,
 physician_npi,
 physician_ims_id,
 physician_veeva_id,
 physician_name,
 physician_address1,
 physician_address2,
 physician_city,
 physician_state,
 physician_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 calc_awp,
 create_date,
 occ_payment_type,
 counted_copay,
 auth_refills,
 admin_hcp_npi,
 admin_hcp_name,
 admin_hcp_address,
 admin_hcp_address2,
 admin_hcp_city,
 admin_hcp_state,
 admin_hcp_zip,
 claim_type,
 administration_flag,
 soc_name,
 soc_phone,
 soc_fax,
 soc_address,
 soc_city,
 soc_state,
 soc_zip,
 soc_id,
 soc_npi,
 payer_name,
 cpt_code,
 trans_type,
 previous_payer_id,
 member_id,
 benefit_amount,
 patient_expense,
 submission_method,
 report_frequency,
 source_name,
 file_id,
 record_id
)
AS
 SELECT copay_20190624.redemption_type,
        copay_20190624.physician_tvcmid,
        copay_20190624.pharmacy_tvcmid,
        copay_20190624.basket_id,
        copay_20190624.basket_name,
        copay_20190624.asi_txn_id,
        copay_20190624.orig_asi_txn_id,
        copay_20190624.rx_num,
        copay_20190624.fill_date,
        copay_20190624.date_written,
        copay_20190624.days_supply,
        copay_20190624.ndc_code,
        copay_20190624.daw,
        copay_20190624.new_refill,
        copay_20190624.quantity,
        copay_20190624.refills,
        copay_20190624.other_coverage_code,
        copay_20190624.program_number,
        copay_20190624.copay_card_number,
        copay_20190624.sex,
        copay_20190624.age_at_redemption,
        copay_20190624.pharmacy_process_date,
        copay_20190624.pharmacy_chain_number,
        copay_20190624.nabp,
        copay_20190624.pharmacy_chain,
        copay_20190624.pharmacy_name,
        copay_20190624.pharmacy_address,
        copay_20190624.pharmacy_address2,
        copay_20190624.pharmacy_city,
        copay_20190624.pharmacy_state,
        copay_20190624.pharmacy_zip,
        copay_20190624.pharmacy_phone,
        copay_20190624.pharmacy_npi_num,
        copay_20190624.principle_physician_dea,
        copay_20190624.physician_npi,
        copay_20190624.physician_ims_id,
        copay_20190624.physician_veeva_id,
        copay_20190624.physician_name,
        copay_20190624.physician_address1,
        copay_20190624.physician_address2,
        copay_20190624.physician_city,
        copay_20190624.physician_state,
        copay_20190624.physician_zip,
        copay_20190624.rebate_amount,
        copay_20190624.member_cash_expense,
        copay_20190624.submitted_cost,
        copay_20190624.pharmacy_fee,
        copay_20190624.total_amount_due,
        copay_20190624.calc_awp,
        copay_20190624.create_date,
        copay_20190624.occ_payment_type,
        copay_20190624.counted_copay,
        copay_20190624.auth_refills,
        copay_20190624.admin_hcp_npi,
        copay_20190624.admin_hcp_name,
        copay_20190624.admin_hcp_address,
        copay_20190624.admin_hcp_address2,
        copay_20190624.admin_hcp_city,
        copay_20190624.admin_hcp_state,
        copay_20190624.admin_hcp_zip,
        copay_20190624.claim_type,
        copay_20190624.administration_flag,
        copay_20190624.soc_name,
        copay_20190624.soc_phone,
        copay_20190624.soc_fax,
        copay_20190624.soc_address,
        copay_20190624.soc_city,
        copay_20190624.soc_state,
        copay_20190624.soc_zip,
        copay_20190624.soc_id,
        copay_20190624.soc_npi,
        copay_20190624.payer_name,
        copay_20190624.cpt_code,
        copay_20190624.trans_type,
        copay_20190624.previous_payer_id,
        copay_20190624.member_id,
        copay_20190624.benefit_amount,
        copay_20190624.patient_expense,
        copay_20190624.submission_method,
        copay_20190624.report_frequency,
        copay_20190624.source_name,
        copay_20190624.file_id,
        copay_20190624.record_id
 FROM archive.copay_20190624
 ORDER BY copay_20190624.source_name,
          copay_20190624.asi_txn_id
SEGMENTED BY hash(copay_20190624.physician_npi) ALL NODES;

CREATE PROJECTION archive.prescriber_rx_gcsf_tki_bkp_20171212_b0 /*+basename(prescriber_rx_gcsf_tki_bkp_20171212),createtype(A)*/ 
(
 ims_id,
 payer_plan_number,
 ims_client_number,
 report_frequency,
 ims_product_group,
 basket_id,
 data_date,
 date,
 sales_category,
 tvcmid,
 prescriber_first_name,
 prescriber_last_name,
 basket_name,
 basket_type,
 rollup_week,
 rollup_month,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 unnormalized_nrx_count,
 unnormalized_trx_count,
 market_name,
 payer_name,
 plan_name,
 pbm_name,
 model,
 payment_method,
 ims_specialty,
 ims_rx_type,
 ims_supplemental_data,
 ims_zip_other,
 ims_report_number_cnt,
 cnt_file_id,
 cnt_record_id,
 ims_report_number_qty,
 qty_file_id,
 qty_record_id,
 rollup_flag,
 indication
)
AS
 SELECT prescriber_rx_gcsf_tki_bkp_201710.ims_id,
        prescriber_rx_gcsf_tki_bkp_201710.payer_plan_number,
        prescriber_rx_gcsf_tki_bkp_201710.ims_client_number,
        prescriber_rx_gcsf_tki_bkp_201710.report_frequency,
        prescriber_rx_gcsf_tki_bkp_201710.ims_product_group,
        prescriber_rx_gcsf_tki_bkp_201710.basket_id,
        prescriber_rx_gcsf_tki_bkp_201710.data_date,
        prescriber_rx_gcsf_tki_bkp_201710.date,
        prescriber_rx_gcsf_tki_bkp_201710.sales_category,
        prescriber_rx_gcsf_tki_bkp_201710.tvcmid,
        prescriber_rx_gcsf_tki_bkp_201710.prescriber_first_name,
        prescriber_rx_gcsf_tki_bkp_201710.prescriber_last_name,
        prescriber_rx_gcsf_tki_bkp_201710.basket_name,
        prescriber_rx_gcsf_tki_bkp_201710.basket_type,
        prescriber_rx_gcsf_tki_bkp_201710.rollup_week,
        prescriber_rx_gcsf_tki_bkp_201710.rollup_month,
        prescriber_rx_gcsf_tki_bkp_201710.nrx_count,
        prescriber_rx_gcsf_tki_bkp_201710.trx_count,
        prescriber_rx_gcsf_tki_bkp_201710.nrx_quantity,
        prescriber_rx_gcsf_tki_bkp_201710.trx_quantity,
        prescriber_rx_gcsf_tki_bkp_201710.unnormalized_nrx_count,
        prescriber_rx_gcsf_tki_bkp_201710.unnormalized_trx_count,
        prescriber_rx_gcsf_tki_bkp_201710.market_name,
        prescriber_rx_gcsf_tki_bkp_201710.payer_name,
        prescriber_rx_gcsf_tki_bkp_201710.plan_name,
        prescriber_rx_gcsf_tki_bkp_201710.pbm_name,
        prescriber_rx_gcsf_tki_bkp_201710.model,
        prescriber_rx_gcsf_tki_bkp_201710.payment_method,
        prescriber_rx_gcsf_tki_bkp_201710.ims_specialty,
        prescriber_rx_gcsf_tki_bkp_201710.ims_rx_type,
        prescriber_rx_gcsf_tki_bkp_201710.ims_supplemental_data,
        prescriber_rx_gcsf_tki_bkp_201710.ims_zip_other,
        prescriber_rx_gcsf_tki_bkp_201710.ims_report_number_cnt,
        prescriber_rx_gcsf_tki_bkp_201710.cnt_file_id,
        prescriber_rx_gcsf_tki_bkp_201710.cnt_record_id,
        prescriber_rx_gcsf_tki_bkp_201710.ims_report_number_qty,
        prescriber_rx_gcsf_tki_bkp_201710.qty_file_id,
        prescriber_rx_gcsf_tki_bkp_201710.qty_record_id,
        prescriber_rx_gcsf_tki_bkp_201710.rollup_flag,
        prescriber_rx_gcsf_tki_bkp_201710.indication
 FROM archive.prescriber_rx_gcsf_tki_bkp_201710
 ORDER BY prescriber_rx_gcsf_tki_bkp_201710.rollup_flag,
          prescriber_rx_gcsf_tki_bkp_201710.ims_rx_type,
          prescriber_rx_gcsf_tki_bkp_201710.report_frequency,
          prescriber_rx_gcsf_tki_bkp_201710.basket_type,
          prescriber_rx_gcsf_tki_bkp_201710.ims_client_number,
          prescriber_rx_gcsf_tki_bkp_201710.indication,
          prescriber_rx_gcsf_tki_bkp_201710.market_name,
          prescriber_rx_gcsf_tki_bkp_201710.ims_product_group,
          prescriber_rx_gcsf_tki_bkp_201710.basket_id,
          prescriber_rx_gcsf_tki_bkp_201710.ims_specialty,
          prescriber_rx_gcsf_tki_bkp_201710.ims_zip_other,
          prescriber_rx_gcsf_tki_bkp_201710.ims_report_number_qty,
          prescriber_rx_gcsf_tki_bkp_201710.ims_report_number_cnt,
          prescriber_rx_gcsf_tki_bkp_201710.tvcmid,
          prescriber_rx_gcsf_tki_bkp_201710.payment_method,
          prescriber_rx_gcsf_tki_bkp_201710.payer_plan_number,
          prescriber_rx_gcsf_tki_bkp_201710.rollup_month,
          prescriber_rx_gcsf_tki_bkp_201710.rollup_week,
          prescriber_rx_gcsf_tki_bkp_201710.nrx_quantity,
          prescriber_rx_gcsf_tki_bkp_201710.trx_quantity,
          prescriber_rx_gcsf_tki_bkp_201710.nrx_count,
          prescriber_rx_gcsf_tki_bkp_201710.trx_count,
          prescriber_rx_gcsf_tki_bkp_201710.sales_category,
          prescriber_rx_gcsf_tki_bkp_201710.ims_id
SEGMENTED BY hash(prescriber_rx_gcsf_tki_bkp_201710.ims_id) ALL NODES;

CREATE PROJECTION archive.product_catalog_20180401_b0 /*+basename(product_catalog_20180401),createtype(A)*/ 
(
 id,
 sales_force_id,
 product_catalog,
 product,
 business_unit,
 start_date,
 end_date,
 field_release_date
)
AS
 SELECT product_catalog_20180401.id,
        product_catalog_20180401.sales_force_id,
        product_catalog_20180401.product_catalog,
        product_catalog_20180401.product,
        product_catalog_20180401.business_unit,
        product_catalog_20180401.start_date,
        product_catalog_20180401.end_date,
        product_catalog_20180401.field_release_date
 FROM archive.product_catalog_20180401
 ORDER BY product_catalog_20180401.id,
          product_catalog_20180401.sales_force_id,
          product_catalog_20180401.product_catalog,
          product_catalog_20180401.product,
          product_catalog_20180401.business_unit,
          product_catalog_20180401.start_date,
          product_catalog_20180401.end_date,
          product_catalog_20180401.field_release_date
SEGMENTED BY hash(product_catalog_20180401.id, product_catalog_20180401.sales_force_id, product_catalog_20180401.start_date, product_catalog_20180401.end_date, product_catalog_20180401.field_release_date, product_catalog_20180401.product_catalog, product_catalog_20180401.business_unit, product_catalog_20180401.product) ALL NODES;

CREATE PROJECTION archive.salesforce_reference_20180401_b0 /*+basename(salesforce_reference_20180401),createtype(A)*/ 
(
 id,
 sales_force_id,
 ref_code,
 ref_desc,
 ref_type
)
AS
 SELECT salesforce_reference_20180401.id,
        salesforce_reference_20180401.sales_force_id,
        salesforce_reference_20180401.ref_code,
        salesforce_reference_20180401.ref_desc,
        salesforce_reference_20180401.ref_type
 FROM archive.salesforce_reference_20180401
 ORDER BY salesforce_reference_20180401.id,
          salesforce_reference_20180401.sales_force_id,
          salesforce_reference_20180401.ref_code,
          salesforce_reference_20180401.ref_desc,
          salesforce_reference_20180401.ref_type
SEGMENTED BY hash(salesforce_reference_20180401.id, salesforce_reference_20180401.sales_force_id, salesforce_reference_20180401.ref_code, salesforce_reference_20180401.ref_desc, salesforce_reference_20180401.ref_type) ALL NODES;

CREATE PROJECTION archive.rx_deciles_20180430_b0 /*+basename(rx_deciles_20180430),createtype(A)*/ 
(
 ims_id,
 first_name,
 last_name,
 decile_name,
 basket_id,
 basket_name,
 decile_trx_count_6_mo,
 decile_trx_count_12_mo,
 trx_count_6_mo,
 trx_count_12_mo,
 trx_count_24_mo,
 decile_date,
 tvcmid
)
AS
 SELECT rx_deciles_20180430.ims_id,
        rx_deciles_20180430.first_name,
        rx_deciles_20180430.last_name,
        rx_deciles_20180430.decile_name,
        rx_deciles_20180430.basket_id,
        rx_deciles_20180430.basket_name,
        rx_deciles_20180430.decile_trx_count_6_mo,
        rx_deciles_20180430.decile_trx_count_12_mo,
        rx_deciles_20180430.trx_count_6_mo,
        rx_deciles_20180430.trx_count_12_mo,
        rx_deciles_20180430.trx_count_24_mo,
        rx_deciles_20180430.decile_date,
        rx_deciles_20180430.tvcmid
 FROM archive.rx_deciles_20180430
 ORDER BY rx_deciles_20180430.ims_id
SEGMENTED BY hash(rx_deciles_20180430.ims_id) ALL NODES;

CREATE PROJECTION archive.copay_20180517_b0 /*+basename(copay_20180517),createtype(A)*/ 
(
 redemption_type,
 asi_txn_id,
 orig_asi_txn_id,
 rx_num,
 fill_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 basket_id,
 basket_name,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 program_number,
 copay_card_number,
 sex,
 age_at_redemption,
 pharmacy_process_date,
 pharmacy_chain_number,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_npi_num,
 principle_physician_dea,
 physician_npi,
 physician_ims_id,
 physician_veeva_id,
 physician_name,
 physician_address1,
 physician_address2,
 physician_city,
 physician_state,
 physician_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 calc_awp,
 create_date,
 occ_payment_type,
 counted_copay,
 file_id,
 record_id,
 physician_tvcmid,
 pharmacy_tvcmid,
 report_frequency,
 source_name,
 auth_refills,
 admin_hcp_npi,
 admin_hcp_name,
 admin_hcp_address,
 admin_hcp_address2,
 admin_hcp_city,
 admin_hcp_state,
 admin_hcp_zip,
 claim_type,
 administration_flag,
 soc_name,
 soc_phone,
 soc_fax,
 soc_address,
 soc_city,
 soc_state,
 soc_zip,
 soc_id,
 soc_npi,
 payer_name,
 cpt_code,
 trans_type,
 previous_payer_id,
 member_id,
 benefit_amount,
 patient_expense,
 submission_method
)
AS
 SELECT copay_20180517.redemption_type,
        copay_20180517.asi_txn_id,
        copay_20180517.orig_asi_txn_id,
        copay_20180517.rx_num,
        copay_20180517.fill_date,
        copay_20180517.date_written,
        copay_20180517.days_supply,
        copay_20180517.ndc_code,
        copay_20180517.daw,
        copay_20180517.basket_id,
        copay_20180517.basket_name,
        copay_20180517.new_refill,
        copay_20180517.quantity,
        copay_20180517.refills,
        copay_20180517.other_coverage_code,
        copay_20180517.program_number,
        copay_20180517.copay_card_number,
        copay_20180517.sex,
        copay_20180517.age_at_redemption,
        copay_20180517.pharmacy_process_date,
        copay_20180517.pharmacy_chain_number,
        copay_20180517.nabp,
        copay_20180517.pharmacy_chain,
        copay_20180517.pharmacy_name,
        copay_20180517.pharmacy_address,
        copay_20180517.pharmacy_address2,
        copay_20180517.pharmacy_city,
        copay_20180517.pharmacy_state,
        copay_20180517.pharmacy_zip,
        copay_20180517.pharmacy_phone,
        copay_20180517.pharmacy_npi_num,
        copay_20180517.principle_physician_dea,
        copay_20180517.physician_npi,
        copay_20180517.physician_ims_id,
        copay_20180517.physician_veeva_id,
        copay_20180517.physician_name,
        copay_20180517.physician_address1,
        copay_20180517.physician_address2,
        copay_20180517.physician_city,
        copay_20180517.physician_state,
        copay_20180517.physician_zip,
        copay_20180517.rebate_amount,
        copay_20180517.member_cash_expense,
        copay_20180517.submitted_cost,
        copay_20180517.pharmacy_fee,
        copay_20180517.total_amount_due,
        copay_20180517.calc_awp,
        copay_20180517.create_date,
        copay_20180517.occ_payment_type,
        copay_20180517.counted_copay,
        copay_20180517.file_id,
        copay_20180517.record_id,
        copay_20180517.physician_tvcmid,
        copay_20180517.pharmacy_tvcmid,
        copay_20180517.report_frequency,
        copay_20180517.source_name,
        copay_20180517.auth_refills,
        copay_20180517.admin_hcp_npi,
        copay_20180517.admin_hcp_name,
        copay_20180517.admin_hcp_address,
        copay_20180517.admin_hcp_address2,
        copay_20180517.admin_hcp_city,
        copay_20180517.admin_hcp_state,
        copay_20180517.admin_hcp_zip,
        copay_20180517.claim_type,
        copay_20180517.administration_flag,
        copay_20180517.soc_name,
        copay_20180517.soc_phone,
        copay_20180517.soc_fax,
        copay_20180517.soc_address,
        copay_20180517.soc_city,
        copay_20180517.soc_state,
        copay_20180517.soc_zip,
        copay_20180517.soc_id,
        copay_20180517.soc_npi,
        copay_20180517.payer_name,
        copay_20180517.cpt_code,
        copay_20180517.trans_type,
        copay_20180517.previous_payer_id,
        copay_20180517.member_id,
        copay_20180517.benefit_amount,
        copay_20180517.patient_expense,
        copay_20180517.submission_method
 FROM archive.copay_20180517
 ORDER BY copay_20180517.redemption_type,
          copay_20180517.asi_txn_id,
          copay_20180517.orig_asi_txn_id,
          copay_20180517.rx_num,
          copay_20180517.fill_date,
          copay_20180517.date_written,
          copay_20180517.days_supply,
          copay_20180517.ndc_code,
          copay_20180517.daw,
          copay_20180517.basket_id,
          copay_20180517.basket_name,
          copay_20180517.new_refill,
          copay_20180517.quantity,
          copay_20180517.refills,
          copay_20180517.other_coverage_code,
          copay_20180517.program_number,
          copay_20180517.copay_card_number,
          copay_20180517.sex,
          copay_20180517.age_at_redemption,
          copay_20180517.pharmacy_process_date,
          copay_20180517.pharmacy_chain_number,
          copay_20180517.nabp,
          copay_20180517.pharmacy_chain,
          copay_20180517.pharmacy_name,
          copay_20180517.pharmacy_address,
          copay_20180517.pharmacy_address2,
          copay_20180517.pharmacy_city,
          copay_20180517.pharmacy_state,
          copay_20180517.pharmacy_zip,
          copay_20180517.pharmacy_phone
SEGMENTED BY hash(copay_20180517.record_id) ALL NODES;

CREATE PROJECTION archive.ic_decile_2018Q3_special_run_b0 /*+basename(ic_decile_2018Q3_special_run),createtype(A)*/ 
(
 ic_data_month,
 ims_id,
 tvcmid,
 decile_name,
 decile_value,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_decile_2018Q3_special_run_v1.ic_data_month,
        ic_decile_2018Q3_special_run_v1.ims_id,
        ic_decile_2018Q3_special_run_v1.tvcmid,
        ic_decile_2018Q3_special_run_v1.decile_name,
        ic_decile_2018Q3_special_run_v1.decile_value,
        ic_decile_2018Q3_special_run_v1.join_key,
        ic_decile_2018Q3_special_run_v1.row_source,
        ic_decile_2018Q3_special_run_v1.row_create_date
 FROM archive.ic_decile_2018Q3_special_run_v1
 ORDER BY ic_decile_2018Q3_special_run_v1.ims_id
SEGMENTED BY hash(ic_decile_2018Q3_special_run_v1.ic_data_month, ic_decile_2018Q3_special_run_v1.tvcmid, ic_decile_2018Q3_special_run_v1.decile_value, ic_decile_2018Q3_special_run_v1.row_create_date, ic_decile_2018Q3_special_run_v1.ims_id, ic_decile_2018Q3_special_run_v1.join_key, ic_decile_2018Q3_special_run_v1.row_source, ic_decile_2018Q3_special_run_v1.decile_name) ALL NODES;

CREATE PROJECTION archive.ic_demo_2018Q3_special_run_b0 /*+basename(ic_demo_2018Q3_special_run),createtype(A)*/ 
(
 ic_data_month,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 specialty,
 last_name,
 first_name,
 mid_name,
 address_1,
 address_2,
 address_3,
 city,
 state,
 zip,
 address_source,
 pdrp_flag,
 pdrp_date,
 np_pa_flag,
 no_spend,
 ama_no_contact_flag,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_demo_2018Q3_special_run_v1.ic_data_month,
        ic_demo_2018Q3_special_run_v1.sales_force_id,
        ic_demo_2018Q3_special_run_v1.area_number,
        ic_demo_2018Q3_special_run_v1.region_number,
        ic_demo_2018Q3_special_run_v1.territory_number,
        ic_demo_2018Q3_special_run_v1.ims_id,
        ic_demo_2018Q3_special_run_v1.tvcmid,
        ic_demo_2018Q3_special_run_v1.outlet_code,
        ic_demo_2018Q3_special_run_v1.va_station_number,
        ic_demo_2018Q3_special_run_v1.specialty,
        ic_demo_2018Q3_special_run_v1.last_name,
        ic_demo_2018Q3_special_run_v1.first_name,
        ic_demo_2018Q3_special_run_v1.mid_name,
        ic_demo_2018Q3_special_run_v1.address_1,
        ic_demo_2018Q3_special_run_v1.address_2,
        ic_demo_2018Q3_special_run_v1.address_3,
        ic_demo_2018Q3_special_run_v1.city,
        ic_demo_2018Q3_special_run_v1.state,
        ic_demo_2018Q3_special_run_v1.zip,
        ic_demo_2018Q3_special_run_v1.address_source,
        ic_demo_2018Q3_special_run_v1.pdrp_flag,
        ic_demo_2018Q3_special_run_v1.pdrp_date,
        ic_demo_2018Q3_special_run_v1.np_pa_flag,
        ic_demo_2018Q3_special_run_v1.no_spend,
        ic_demo_2018Q3_special_run_v1.ama_no_contact_flag,
        ic_demo_2018Q3_special_run_v1.join_key,
        ic_demo_2018Q3_special_run_v1.row_source,
        ic_demo_2018Q3_special_run_v1.row_create_date
 FROM archive.ic_demo_2018Q3_special_run_v1
 ORDER BY ic_demo_2018Q3_special_run_v1.area_number,
          ic_demo_2018Q3_special_run_v1.region_number,
          ic_demo_2018Q3_special_run_v1.territory_number,
          ic_demo_2018Q3_special_run_v1.ims_id,
          ic_demo_2018Q3_special_run_v1.tvcmid
SEGMENTED BY hash(ic_demo_2018Q3_special_run_v1.ic_data_month, ic_demo_2018Q3_special_run_v1.tvcmid, ic_demo_2018Q3_special_run_v1.outlet_code, ic_demo_2018Q3_special_run_v1.mid_name, ic_demo_2018Q3_special_run_v1.state, ic_demo_2018Q3_special_run_v1.zip, ic_demo_2018Q3_special_run_v1.pdrp_flag, ic_demo_2018Q3_special_run_v1.pdrp_date, ic_demo_2018Q3_special_run_v1.np_pa_flag, ic_demo_2018Q3_special_run_v1.no_spend, ic_demo_2018Q3_special_run_v1.ama_no_contact_flag, ic_demo_2018Q3_special_run_v1.row_create_date, ic_demo_2018Q3_special_run_v1.ims_id, ic_demo_2018Q3_special_run_v1.va_station_number, ic_demo_2018Q3_special_run_v1.specialty, ic_demo_2018Q3_special_run_v1.join_key, ic_demo_2018Q3_special_run_v1.area_number, ic_demo_2018Q3_special_run_v1.region_number, ic_demo_2018Q3_special_run_v1.territory_number, ic_demo_2018Q3_special_run_v1.sales_force_id, ic_demo_2018Q3_special_run_v1.first_name, ic_demo_2018Q3_special_run_v1.city, ic_demo_2018Q3_special_run_v1.address_source, ic_demo_2018Q3_special_run_v1.last_name, ic_demo_2018Q3_special_run_v1.address_1, ic_demo_2018Q3_special_run_v1.address_2, ic_demo_2018Q3_special_run_v1.address_3, ic_demo_2018Q3_special_run_v1.row_source) ALL NODES;

CREATE PROJECTION archive.ic_goal_setting_2018Q3_special_run_b0 /*+basename(ic_goal_setting_2018Q3_special_run),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 market_rolling_6,
 product_rolling_6,
 market_rolling_12,
 market_baseline,
 product_baseline,
 target_market_rolling_6,
 target_product_rolling_6,
 target_market_rolling_12,
 target_market_baseline,
 target_product_baseline,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date
)
AS
 SELECT ic_goal_setting_2018Q3_special_run_v1.ic_data_month,
        ic_goal_setting_2018Q3_special_run_v1.basket_name,
        ic_goal_setting_2018Q3_special_run_v1.sales_force_id,
        ic_goal_setting_2018Q3_special_run_v1.area_number,
        ic_goal_setting_2018Q3_special_run_v1.region_number,
        ic_goal_setting_2018Q3_special_run_v1.territory_number,
        ic_goal_setting_2018Q3_special_run_v1.ims_id,
        ic_goal_setting_2018Q3_special_run_v1.tvcmid,
        ic_goal_setting_2018Q3_special_run_v1.outlet_code,
        ic_goal_setting_2018Q3_special_run_v1.va_station_number,
        ic_goal_setting_2018Q3_special_run_v1.dnc_flag,
        ic_goal_setting_2018Q3_special_run_v1.dnp_flag,
        ic_goal_setting_2018Q3_special_run_v1.market_rolling_6,
        ic_goal_setting_2018Q3_special_run_v1.product_rolling_6,
        ic_goal_setting_2018Q3_special_run_v1.market_rolling_12,
        ic_goal_setting_2018Q3_special_run_v1.market_baseline,
        ic_goal_setting_2018Q3_special_run_v1.product_baseline,
        ic_goal_setting_2018Q3_special_run_v1.target_market_rolling_6,
        ic_goal_setting_2018Q3_special_run_v1.target_product_rolling_6,
        ic_goal_setting_2018Q3_special_run_v1.target_market_rolling_12,
        ic_goal_setting_2018Q3_special_run_v1.target_market_baseline,
        ic_goal_setting_2018Q3_special_run_v1.target_product_baseline,
        ic_goal_setting_2018Q3_special_run_v1.include_in_nation_rollup,
        ic_goal_setting_2018Q3_special_run_v1.include_in_area_rollup,
        ic_goal_setting_2018Q3_special_run_v1.include_in_region_rollup,
        ic_goal_setting_2018Q3_special_run_v1.join_key,
        ic_goal_setting_2018Q3_special_run_v1.row_source,
        ic_goal_setting_2018Q3_special_run_v1.row_create_date
 FROM archive.ic_goal_setting_2018Q3_special_run_v1
 ORDER BY ic_goal_setting_2018Q3_special_run_v1.sales_force_id,
          ic_goal_setting_2018Q3_special_run_v1.area_number,
          ic_goal_setting_2018Q3_special_run_v1.region_number,
          ic_goal_setting_2018Q3_special_run_v1.territory_number,
          ic_goal_setting_2018Q3_special_run_v1.ims_id,
          ic_goal_setting_2018Q3_special_run_v1.tvcmid,
          ic_goal_setting_2018Q3_special_run_v1.outlet_code,
          ic_goal_setting_2018Q3_special_run_v1.va_station_number,
          ic_goal_setting_2018Q3_special_run_v1.dnp_flag,
          ic_goal_setting_2018Q3_special_run_v1.join_key,
          ic_goal_setting_2018Q3_special_run_v1.row_source
SEGMENTED BY hash(ic_goal_setting_2018Q3_special_run_v1.ic_data_month, ic_goal_setting_2018Q3_special_run_v1.sales_force_id, ic_goal_setting_2018Q3_special_run_v1.area_number, ic_goal_setting_2018Q3_special_run_v1.region_number, ic_goal_setting_2018Q3_special_run_v1.territory_number, ic_goal_setting_2018Q3_special_run_v1.ims_id, ic_goal_setting_2018Q3_special_run_v1.tvcmid, ic_goal_setting_2018Q3_special_run_v1.outlet_code, ic_goal_setting_2018Q3_special_run_v1.va_station_number, ic_goal_setting_2018Q3_special_run_v1.dnp_flag, ic_goal_setting_2018Q3_special_run_v1.join_key, ic_goal_setting_2018Q3_special_run_v1.row_source) ALL NODES;

CREATE PROJECTION archive.ic_rx_b0 /*+basename(ic_rx),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 outlet_code,
 va_station_number,
 dnc_flag,
 dnp_flag,
 rollup_month,
 month_bucket,
 nrx_count,
 trx_count,
 nrx_quantity,
 trx_quantity,
 include_in_nation_rollup,
 include_in_area_rollup,
 include_in_region_rollup,
 join_key,
 row_source,
 row_create_date,
 indication
)
AS
 SELECT ic_rx_2018Q3_special_run_v1.ic_data_month,
        ic_rx_2018Q3_special_run_v1.basket_name,
        ic_rx_2018Q3_special_run_v1.sales_force_id,
        ic_rx_2018Q3_special_run_v1.area_number,
        ic_rx_2018Q3_special_run_v1.region_number,
        ic_rx_2018Q3_special_run_v1.territory_number,
        ic_rx_2018Q3_special_run_v1.ims_id,
        ic_rx_2018Q3_special_run_v1.tvcmid,
        ic_rx_2018Q3_special_run_v1.outlet_code,
        ic_rx_2018Q3_special_run_v1.va_station_number,
        ic_rx_2018Q3_special_run_v1.dnc_flag,
        ic_rx_2018Q3_special_run_v1.dnp_flag,
        ic_rx_2018Q3_special_run_v1.rollup_month,
        ic_rx_2018Q3_special_run_v1.month_bucket,
        ic_rx_2018Q3_special_run_v1.nrx_count,
        ic_rx_2018Q3_special_run_v1.trx_count,
        ic_rx_2018Q3_special_run_v1.nrx_quantity,
        ic_rx_2018Q3_special_run_v1.trx_quantity,
        ic_rx_2018Q3_special_run_v1.include_in_nation_rollup,
        ic_rx_2018Q3_special_run_v1.include_in_area_rollup,
        ic_rx_2018Q3_special_run_v1.include_in_region_rollup,
        ic_rx_2018Q3_special_run_v1.join_key,
        ic_rx_2018Q3_special_run_v1.row_source,
        ic_rx_2018Q3_special_run_v1.row_create_date,
        ic_rx_2018Q3_special_run_v1.indication
 FROM archive.ic_rx_2018Q3_special_run_v1
 ORDER BY ic_rx_2018Q3_special_run_v1.area_number,
          ic_rx_2018Q3_special_run_v1.region_number,
          ic_rx_2018Q3_special_run_v1.territory_number,
          ic_rx_2018Q3_special_run_v1.ims_id,
          ic_rx_2018Q3_special_run_v1.tvcmid
SEGMENTED BY hash(ic_rx_2018Q3_special_run_v1.ic_data_month, ic_rx_2018Q3_special_run_v1.tvcmid, ic_rx_2018Q3_special_run_v1.outlet_code, ic_rx_2018Q3_special_run_v1.dnc_flag, ic_rx_2018Q3_special_run_v1.dnp_flag, ic_rx_2018Q3_special_run_v1.rollup_month, ic_rx_2018Q3_special_run_v1.month_bucket, ic_rx_2018Q3_special_run_v1.nrx_count, ic_rx_2018Q3_special_run_v1.trx_count, ic_rx_2018Q3_special_run_v1.nrx_quantity, ic_rx_2018Q3_special_run_v1.trx_quantity, ic_rx_2018Q3_special_run_v1.include_in_nation_rollup, ic_rx_2018Q3_special_run_v1.include_in_area_rollup, ic_rx_2018Q3_special_run_v1.include_in_region_rollup, ic_rx_2018Q3_special_run_v1.row_create_date, ic_rx_2018Q3_special_run_v1.ims_id, ic_rx_2018Q3_special_run_v1.va_station_number, ic_rx_2018Q3_special_run_v1.join_key, ic_rx_2018Q3_special_run_v1.area_number, ic_rx_2018Q3_special_run_v1.region_number, ic_rx_2018Q3_special_run_v1.territory_number, ic_rx_2018Q3_special_run_v1.sales_force_id, ic_rx_2018Q3_special_run_v1.row_source, ic_rx_2018Q3_special_run_v1.basket_name) ALL NODES;

CREATE PROJECTION archive.ic_target_2018Q3_special_run_b0 /*+basename(ic_target_2018Q3_special_run),createtype(A)*/ 
(
 ic_data_month,
 basket_name,
 sales_force_id,
 area_number,
 region_number,
 territory_number,
 ims_id,
 tvcmid,
 row_create_date
)
AS
 SELECT ic_target_2018Q3_special_run_v1.ic_data_month,
        ic_target_2018Q3_special_run_v1.basket_name,
        ic_target_2018Q3_special_run_v1.sales_force_id,
        ic_target_2018Q3_special_run_v1.area_number,
        ic_target_2018Q3_special_run_v1.region_number,
        ic_target_2018Q3_special_run_v1.territory_number,
        ic_target_2018Q3_special_run_v1.ims_id,
        ic_target_2018Q3_special_run_v1.tvcmid,
        ic_target_2018Q3_special_run_v1.row_create_date
 FROM archive.ic_target_2018Q3_special_run_v1
 ORDER BY ic_target_2018Q3_special_run_v1.ims_id,
          ic_target_2018Q3_special_run_v1.tvcmid,
          ic_target_2018Q3_special_run_v1.territory_number
SEGMENTED BY hash(ic_target_2018Q3_special_run_v1.ims_id, ic_target_2018Q3_special_run_v1.tvcmid, ic_target_2018Q3_special_run_v1.territory_number) ALL NODES;

CREATE PROJECTION archive.wholesaler_sales_867_20180921_b0 /*+basename(wholesaler_sales_867_20180921),createtype(A)*/ 
(
 trading_partner,
 partner_duns,
 partner_duns_4,
 partner_dea,
 partner_hin,
 partner_seller_assigned_id,
 partner_buyer_assigned_id,
 client_name,
 address_line_1,
 address_line_2,
 city,
 state,
 zip,
 client_duns,
 client_dea,
 client_hin,
 client_seller_assigned_id,
 client_buyer_assigned_id,
 ncpdp,
 ndc,
 basket_id,
 basket_name,
 ship_date,
 ship_date_month,
 ship_date_quarter,
 quantity_purchased,
 quantity_returned,
 unit_price,
 gross_amount,
 drop_shipments,
 file_id,
 record_id,
 tvcmid
)
AS
 SELECT wholesaler_sales_867_20180921.trading_partner,
        wholesaler_sales_867_20180921.partner_duns,
        wholesaler_sales_867_20180921.partner_duns_4,
        wholesaler_sales_867_20180921.partner_dea,
        wholesaler_sales_867_20180921.partner_hin,
        wholesaler_sales_867_20180921.partner_seller_assigned_id,
        wholesaler_sales_867_20180921.partner_buyer_assigned_id,
        wholesaler_sales_867_20180921.client_name,
        wholesaler_sales_867_20180921.address_line_1,
        wholesaler_sales_867_20180921.address_line_2,
        wholesaler_sales_867_20180921.city,
        wholesaler_sales_867_20180921.state,
        wholesaler_sales_867_20180921.zip,
        wholesaler_sales_867_20180921.client_duns,
        wholesaler_sales_867_20180921.client_dea,
        wholesaler_sales_867_20180921.client_hin,
        wholesaler_sales_867_20180921.client_seller_assigned_id,
        wholesaler_sales_867_20180921.client_buyer_assigned_id,
        wholesaler_sales_867_20180921.ncpdp,
        wholesaler_sales_867_20180921.ndc,
        wholesaler_sales_867_20180921.basket_id,
        wholesaler_sales_867_20180921.basket_name,
        wholesaler_sales_867_20180921.ship_date,
        wholesaler_sales_867_20180921.ship_date_month,
        wholesaler_sales_867_20180921.ship_date_quarter,
        wholesaler_sales_867_20180921.quantity_purchased,
        wholesaler_sales_867_20180921.quantity_returned,
        wholesaler_sales_867_20180921.unit_price,
        wholesaler_sales_867_20180921.gross_amount,
        wholesaler_sales_867_20180921.drop_shipments,
        wholesaler_sales_867_20180921.file_id,
        wholesaler_sales_867_20180921.record_id,
        wholesaler_sales_867_20180921.tvcmid
 FROM archive.wholesaler_sales_867_20180921
 ORDER BY wholesaler_sales_867_20180921.trading_partner,
          wholesaler_sales_867_20180921.partner_duns,
          wholesaler_sales_867_20180921.partner_duns_4,
          wholesaler_sales_867_20180921.partner_dea,
          wholesaler_sales_867_20180921.partner_hin,
          wholesaler_sales_867_20180921.partner_seller_assigned_id,
          wholesaler_sales_867_20180921.partner_buyer_assigned_id,
          wholesaler_sales_867_20180921.client_name,
          wholesaler_sales_867_20180921.address_line_1,
          wholesaler_sales_867_20180921.address_line_2,
          wholesaler_sales_867_20180921.city,
          wholesaler_sales_867_20180921.state,
          wholesaler_sales_867_20180921.zip,
          wholesaler_sales_867_20180921.client_duns,
          wholesaler_sales_867_20180921.client_dea,
          wholesaler_sales_867_20180921.client_hin,
          wholesaler_sales_867_20180921.client_seller_assigned_id,
          wholesaler_sales_867_20180921.client_buyer_assigned_id,
          wholesaler_sales_867_20180921.ncpdp,
          wholesaler_sales_867_20180921.ndc,
          wholesaler_sales_867_20180921.basket_id,
          wholesaler_sales_867_20180921.basket_name,
          wholesaler_sales_867_20180921.ship_date,
          wholesaler_sales_867_20180921.ship_date_month,
          wholesaler_sales_867_20180921.ship_date_quarter,
          wholesaler_sales_867_20180921.quantity_purchased,
          wholesaler_sales_867_20180921.quantity_returned,
          wholesaler_sales_867_20180921.unit_price,
          wholesaler_sales_867_20180921.gross_amount,
          wholesaler_sales_867_20180921.drop_shipments,
          wholesaler_sales_867_20180921.file_id,
          wholesaler_sales_867_20180921.record_id
SEGMENTED BY hash(wholesaler_sales_867_20180921.record_id) ALL NODES;

CREATE PROJECTION archive.copay_voucher_program_20181010_b0 /*+basename(copay_voucher_program_20181010),createtype(A)*/ 
(
 redemption_type,
 program_number,
 program_description,
 create_date
)
AS
 SELECT copay_voucher_program_20181010.redemption_type,
        copay_voucher_program_20181010.program_number,
        copay_voucher_program_20181010.program_description,
        copay_voucher_program_20181010.create_date
 FROM archive.copay_voucher_program_20181010
 ORDER BY copay_voucher_program_20181010.program_number
SEGMENTED BY hash(copay_voucher_program_20181010.program_number) ALL NODES;

CREATE PROJECTION archive.metadata_workflow_steps_20190103_b0 /*+basename(metadata_workflow_steps_20190103),createtype(A)*/ 
(
 pkId,
 WorkflowId,
 StepOrder,
 StepDescription
)
AS
 SELECT metadata_workflow_steps_20190103.pkId,
        metadata_workflow_steps_20190103.WorkflowId,
        metadata_workflow_steps_20190103.StepOrder,
        metadata_workflow_steps_20190103.StepDescription
 FROM archive.metadata_workflow_steps_20190103
 ORDER BY metadata_workflow_steps_20190103.pkId
SEGMENTED BY hash(metadata_workflow_steps_20190103.pkId) ALL NODES;

CREATE PROJECTION archive.ddd_445_calendar_2018_b0 /*+basename(ddd_445_calendar_2018),createtype(A)*/ 
(
 start_date,
 end_date,
 period
)
AS
 SELECT ddd_445_calendar_2018.start_date,
        ddd_445_calendar_2018.end_date,
        ddd_445_calendar_2018.period
 FROM archive.ddd_445_calendar_2018
 ORDER BY ddd_445_calendar_2018.start_date,
          ddd_445_calendar_2018.end_date,
          ddd_445_calendar_2018.period
SEGMENTED BY hash(ddd_445_calendar_2018.start_date, ddd_445_calendar_2018.start_date) ALL NODES;


SELECT MARK_DESIGN_KSAFE(1);

