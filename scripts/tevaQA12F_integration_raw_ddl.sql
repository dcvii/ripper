CREATE SCHEMA integration;


CREATE TABLE integration.rems_pharmacy
(
    source_name varchar(255),
    program_id varchar(10),
    program_name varchar(48),
    channel varchar(20),
    enrollment_id varchar(20),
    pharmacy_type varchar(20),
    pharmacy_name varchar(200),
    address_line_1 varchar(40),
    address_line_2 varchar(40),
    city varchar(40),
    state_code varchar(2),
    zip varchar(5),
    first_name varchar(36),
    middle_name varchar(36),
    last_name varchar(40),
    status varchar(60),
    in_progress_step varchar(40),
    phone varchar(10),
    effective_date date,
    expiration_date date,
    ncpdp varchar(20),
    npi varchar(10),
    dea_number varchar(20),
    license_number varchar(20),
    obsolescence_date date,
    file_id int,
    record_id int,
    obsolescence_reason varchar(64),
    last_build_date date
);


CREATE TABLE integration.territory_ram_to_state
(
    source_name varchar(255),
    mm_ram varchar(40),
    state_code varchar(8),
    file_id int,
    record_id int
);


CREATE TABLE integration.territory_zip
(
    source_name varchar(255),
    zip_code varchar(5),
    city varchar(50),
    state_code varchar(2),
    territory_number varchar(8),
    territory_name varchar(50),
    area_name varchar(50),
    region_name varchar(50),
    sales_force_id varchar(5),
    organization_code varchar(200),
    mirror_flag varchar(64),
    mirror_territory_number varchar(8),
    file_id int,
    record_id int
);


CREATE TABLE integration.plan_xref
(
    source_name varchar(255),
    payer_number varchar(6),
    payer_name varchar(100),
    plan_number varchar(4),
    payer_plan_number varchar(10),
    plan_name varchar(100),
    model varchar(10),
    city varchar(30),
    hq_state varchar(2),
    operating_state varchar(2),
    months_with_data varchar(4),
    file_id int,
    record_id int
);


CREATE TABLE integration.pbm_xref
(
    source_name varchar(255),
    pbm_name varchar(100),
    payer_plan_number varchar(10),
    xref_to_payer_plan_number varchar(10),
    plan_name varchar(100),
    pbm_number varchar(6),
    ims_processor_number varchar(10),
    file_id int,
    record_id int
);


CREATE TABLE integration.ims_product_list
(
    source_name varchar(255),
    file_code varchar(8),
    product_group varchar(8),
    product_name varchar(100),
    mfg_number varchar(10),
    status varchar(10),
    cmf_code varchar(20),
    product_description varchar(255),
    mfg_name varchar(100),
    usc_code varchar(10),
    file_id int,
    record_id int
);


CREATE TABLE integration.event_speaker
(
    source_system_name varchar(100),
    event_number varchar(100),
    event_speaker_status varchar(100),
    speaker_id varchar(100),
    product_id varchar(100),
    topic_id varchar(100),
    cancellation_reason varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.speaker_contract
(
    source_system_name varchar(100),
    speaker_id varchar(100),
    contract_type_code varchar(100),
    contract_type_name varchar(100),
    contract_effective_date varchar(100),
    contract_expiration_date varchar(100),
    contract_signed_date varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.speaker_profile
(
    source_system_name varchar(100),
    speaker_id varchar(100),
    first_name varchar(100),
    last_name varchar(100),
    middle_name varchar(100),
    title varchar(100),
    address_line_1 varchar(100),
    address_line_2 varchar(100),
    address_line_3 varchar(100),
    address_line_4 varchar(100),
    city varchar(100),
    state_province varchar(100),
    postal_code varchar(100),
    postal_extended_code varchar(100),
    country_code varchar(100),
    business_phone varchar(100),
    business_phone_extension varchar(100),
    home_phone varchar(100),
    mobile_phone varchar(100),
    business_fax varchar(100),
    home_fax varchar(100),
    email varchar(100),
    specialty varchar(100),
    personal_suffix varchar(100),
    degree varchar(100),
    me_number varchar(100),
    ims_number varchar(100),
    dea_number varchar(100),
    npi_number varchar(10),
    clinical_affiliation varchar(100),
    clinical_title varchar(100),
    academic_affiliation varchar(100),
    other_affiliation varchar(100),
    federal_employee_indicator varchar(100),
    state_employee_indicator varchar(100),
    local_employee_indicator varchar(100),
    fda_debarment_indicator varchar(100),
    ofac_debarment_indicator varchar(100),
    oig_exclusion_indicator varchar(100),
    speaker_biography varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.call_plan
(
    source_name varchar(255),
    veeva_account_id varchar(18),
    ims_id varchar(10),
    first_name varchar(50),
    last_name varchar(50),
    specialty varchar(100),
    territory_number varchar(8),
    address varchar(150),
    city varchar(100),
    state varchar(2),
    zip varchar(10),
    product_name varchar(50),
    p1 int,
    p2 int,
    p3 int,
    target varchar(50),
    sales_force_id varchar(5),
    period varchar(20),
    file_id int,
    record_id int,
    tvcmid int
);


CREATE TABLE integration.ddd_md
(
    source_name varchar(255),
    client_number varchar(3),
    report_number varchar(2),
    territory_number varchar(8),
    ims_outlet_code varchar(10),
    subcategory_code varchar(10),
    alt_seq_number varchar(10),
    category_code varchar(2),
    ims_product_code varchar(9),
    data_date date,
    dollars numeric(37,15),
    quantity numeric(37,15),
    bucket_date date,
    bucket_type varchar(10),
    outlet_name varchar(30),
    outlet_address varchar(30),
    outlet_city varchar(25),
    outlet_state varchar(2),
    outlet_zip varchar(5),
    file_id int,
    record_id int,
    tvcmid_outlet int
);


CREATE TABLE integration.copay_detail_weekly
(
    source_name varchar(255),
    trans_type varchar(1),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_number varchar(50),
    rx_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(15),
    daw int,
    drug_name varchar(50),
    drug_description varchar(50),
    new_refill int,
    quantity numeric(37,15),
    refills int,
    other_coverage_code varchar(64),
    group_number varchar(50),
    coupon_number varchar(20),
    sex varchar(1),
    age_at_redemption int,
    pharmacy_process_date date,
    pharmacy_chain_number varchar(15),
    nabp varchar(15),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_phone varchar(25),
    pharmacy_npi_number varchar(10),
    principle_phys_dea_number varchar(20),
    phys_npi varchar(10),
    physician_name varchar(100),
    asi_phys_address1 varchar(100),
    asi_phys_address2 varchar(100),
    asi_phys_city varchar(50),
    asi_phys_state varchar(2),
    asi_phys_zip varchar(15),
    rebate_amount numeric(18,4),
    member_cash_expense numeric(18,4),
    submitted_cost numeric(18,4),
    pharmacy_fee numeric(18,4),
    total_amount_due numeric(18,4),
    calc_awp numeric(18,4),
    create_date date,
    occ_payment_type varchar(10),
    file_id int,
    record_id int,
    tvcmid_physician int,
    tvcmid_pharmacy int,
    auth_refills int,
    admin_hcp_npi varchar(10),
    admin_hcp_name varchar(100),
    admin_hcp_address varchar(100),
    admin_hcp_address2 varchar(100),
    admin_hcp_city varchar(50),
    admin_hcp_state varchar(2),
    claim_type varchar(50),
    administration_flag char(1),
    soc_name varchar(60),
    soc_address varchar(100),
    soc_city varchar(50),
    soc_state varchar(2),
    soc_id varchar(50),
    soc_npi varchar(10),
    payer_name varchar(60),
    cpt_code varchar(10),
    previous_payer_id int,
    member_id varchar(20),
    benefit_amount numeric(9,2),
    patient_expense numeric(9,2),
    submission_method varchar(1),
    redemption_type varchar(10),
    report_frequency varchar(20),
    admin_hcp_zip varchar(10),
    soc_phone varchar(10),
    soc_fax varchar(10),
    soc_zip varchar(10),
    basket_id int,
    basket_name varchar(300),
    tvcmid_from_npi int,
    tvcmid_from_dea int,
    tvcmid_from_pharmacy_npi int,
    ims_id_from_npi varchar(10),
    ims_id_from_dea varchar(10),
    veeva_account_id_from_npi varchar(20),
    veeva_account_id_from_dea varchar(20),
    patient_type varchar(100),
    primary_bin varchar(100),
    primary_bin_description varchar(100),
    reject_code varchar(100)
);


CREATE TABLE integration.roster_address
(
    source_name varchar(255),
    address_id varchar(64),
    line_1 varchar(50),
    line_2 varchar(50),
    line_3 varchar(50),
    city varchar(50),
    state_abbr varchar(2),
    postal_code varchar(20),
    country_iso_abbr varchar(2),
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_associate
(
    source_name varchar(255),
    teva_id varchar(7),
    hr_id varchar(15),
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date,
    hire_date date,
    logon_id varchar(15),
    reports_to varchar(7),
    stat_code varchar(2),
    type_code varchar(1),
    full_time varchar(1),
    eeo_cat varchar(10),
    exempt varchar(1),
    expense_cost_ctr varchar(10),
    hours_per_week float,
    marital_stat varchar(1),
    race varchar(50),
    email varchar(255),
    birth_date date,
    country_id varchar(3),
    default_currency_id varchar(50),
    territory_id varchar(15),
    office varchar(6),
    person_sys_id varchar(64),
    language varchar(2),
    "position" varchar(50),
    term_date date,
    last_wrk_date date,
    auth_limit varchar(64),
    vehicle varchar(11),
    vacation_days varchar(64),
    check_req_limit varchar(64),
    expense_report_approver varchar(7),
    location_code varchar(10),
    pay_code varchar(3),
    ed_code varchar(2),
    ed_code_date date,
    job_code varchar(6),
    country_citizenship varchar(3),
    disabled varchar(1),
    vietnam_vet varchar(1),
    emergency_contact_name varchar(50),
    emergency_contact_relationship varchar(20),
    emergency_contact_phone varchar(50),
    adp_dept_num varchar(10),
    vacation_year varchar(64),
    fin_auth_comments varchar(255),
    eeo_cat_hr_updt varchar(10),
    expense_reporting varchar(1),
    company_id varchar(10),
    check_request_approver varchar(7),
    invoice_approver varchar(7),
    phantom_indicator varchar(1),
    payroll_cost_ctr varchar(30),
    sample_auth varchar(1),
    oracle_string varchar(25),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_associate_audit
(
    source_name varchar(255),
    teva_id varchar(7),
    hr_id varchar(15),
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date,
    hire_date date,
    logon_id varchar(15),
    reports_to varchar(7),
    status_code varchar(2),
    type_code varchar(1),
    full_time varchar(1),
    eeo_cat varchar(10),
    exempt varchar(1),
    expense_cost_ctr varchar(10),
    hours_per_week float,
    marital_status varchar(1),
    race varchar(50),
    email varchar(255),
    birth_date date,
    country_id varchar(3),
    default_currency_id varchar(50),
    territory_id varchar(15),
    office varchar(6),
    person_sys_id varchar(64),
    language varchar(2),
    "position" varchar(50),
    term_date date,
    last_work_date date,
    auth_limit numeric(18,4),
    vehicle varchar(11),
    vacation_days float,
    action_date date,
    action varchar(20),
    check_request_limit numeric(18,4),
    expense_report_approver varchar(7),
    location_code varchar(10),
    pay_code varchar(3),
    ed_code date,
    ed_code_date varchar(64),
    job_code varchar(6),
    country_citizenship varchar(3),
    disabled varchar(1),
    vietnam_vet varchar(1),
    emergency_contact_name varchar(50),
    emergency_contact_relationship varchar(20),
    emergency_contact_phone varchar(50),
    adp_dept_num varchar(10),
    eeo_cat_hr_updt varchar(10),
    company_id varchar(10),
    expense_reporting varchar(1),
    phantom_indicator varchar(1),
    check_request_approver varchar(7),
    invoice_approver varchar(7),
    vacation_year varchar(64),
    fin_auth_comments varchar(255),
    payroll_cost_ctr varchar(30),
    sample_auth varchar(1),
    oracle_string varchar(25),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_job_title
(
    source_name varchar(255),
    job_code varchar(5),
    code_desc varchar(50),
    adp_job_code varchar(8),
    create_date date,
    create_user varchar(30),
    update_date date,
    update_user varchar(30),
    display_sequence varchar(64),
    company_id varchar(10),
    effective_date date,
    expiration_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_leave_of_absence
(
    source_name varchar(255),
    file_number varchar(6),
    name varchar(40),
    job_title varchar(30),
    cost_center_name varchar(35),
    department varchar(30),
    ee_status varchar(30),
    leave_date date,
    return_date date,
    leave_days int,
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_people
(
    source_name varchar(255),
    system_id varchar(64),
    create_date date,
    create_user varchar(30),
    update_date date,
    update_user varchar(30),
    last_name varchar(50),
    first_name varchar(50),
    status_code varchar(2),
    gender varchar(1),
    middle_name varchar(50),
    name_suffix varchar(15),
    person_title varchar(15),
    prof_title varchar(15),
    email varchar(255),
    pref_name varchar(50),
    previous_last_name varchar(50),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_people_address
(
    source_name varchar(255),
    person_sys_id varchar(64),
    address_id varchar(64),
    atd_code varchar(2),
    priority varchar(64),
    mail_stop varchar(10),
    eff_date date,
    end_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_people_phone
(
    source_name varchar(255),
    person_sys_id varchar(64),
    phone_id varchar(64),
    ptd_code varchar(2),
    priority varchar(64),
    ext varchar(64),
    vmail varchar(64),
    address_id varchar(64),
    provider_code varchar(2),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_phone
(
    source_name varchar(255),
    phone_id varchar(64),
    country_dial_code varchar(64),
    area_code varchar(5),
    phone_number varchar(64),
    create_user varchar(30),
    create_date date,
    update_user varchar(30),
    update_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_salesperson
(
    source_name varchar(255),
    file_number varchar(6),
    name varchar(40),
    job_title varchar(30),
    cost_center_name varchar(35),
    department varchar(30),
    job_entry_date date,
    manager_level varchar(30),
    ee_status varchar(30),
    work_location varchar(5),
    work_location_name varchar(30),
    orig_hire_date date,
    service_date date,
    rehire_date date,
    termination_date date,
    direct_manager varchar(40),
    home_address_line1 varchar(40),
    home_address_line2 varchar(40),
    home_city varchar(30),
    home_state varchar(2),
    home_postal_code varchar(10),
    home_phone varchar(15),
    cell_phone varchar(15),
    email_address varchar(70),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_territory
(
    source_name varchar(255),
    territory_id varchar(225),
    name varchar(255),
    desc_text varchar(255),
    company_code varchar(10),
    territory_type varchar(20),
    team varchar(50),
    sample_dist varchar(1),
    comments varchar(200),
    fleet_elig varchar(1),
    rep_type varchar(8),
    file_id int,
    record_id int
);


CREATE TABLE integration.roster_territory_change
(
    source_name varchar(255),
    ee_number varchar(24),
    ee_name varchar(40),
    territory_id_from varchar(8),
    territory_id_to varchar(8),
    territory_move_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.cmop_rx
(
    source_name varchar(255),
    data_month date,
    cmop varchar(100),
    visn varchar(2),
    station_number varchar(10),
    station varchar(50),
    va_product varchar(70),
    total_rxs numeric(37,15),
    cmop_rxs numeric(37,15),
    total_quantity numeric(37,15),
    cmop_quantity numeric(37,15),
    rxs_30_days numeric(37,15),
    zip varchar(5),
    id varchar(10),
    file_id int,
    record_id int
);


CREATE TABLE integration.specialty_pharmacy_shipment_summary
(
    source_name varchar(255),
    ship_date date,
    full_name varchar(100),
    specialty varchar(50),
    rank int,
    total int,
    aubagio_14 int,
    aubagio_7 int,
    avonex_30 int,
    avonex_pack int,
    avonex_pen_pack int,
    betaseron int,
    copaxone_20 int,
    copaxone_40 int,
    gilenya_0_5 int,
    glatopa_20 int,
    lemtrada int,
    plegridy_pfs int,
    plegridy_pen int,
    rebif_22_rebidose int,
    rebif_22 int,
    rebif_44 int,
    rebif_44_rebidose int,
    rebif_pack int,
    rebif_pack_rebidose int,
    tecfidera_120 int,
    tecfidera_240 int,
    tecfidera_starter_pack int,
    tysabri int,
    md_addr1 varchar(100),
    md_addr2 varchar(100),
    md_city varchar(50),
    md_state varchar(2),
    md_zip varchar(5),
    prescriber_npi varchar(20),
    dnc_flag varchar(1),
    record_id int,
    file_id int,
    gilenya_0_5_2x14 int,
    gilenya_0_5_1x7 int,
    glatiramer_acetate_20 int,
    glatiramer_acetate_40 int,
    zinbryta_150 int
);


CREATE TABLE integration.specialty_pharmacy_enrollment
(
    source_name varchar(255),
    patient_id varchar(80),
    rx_received_date date,
    insurance_information varchar(200),
    most_recent_cml_treatment varchar(200),
    date_of_discontinuation date,
    reason_for_discontinuation varchar(200),
    physician_last_name varchar(200),
    physician_first_name varchar(200),
    physician_address varchar(400),
    physician_city varchar(200),
    physician_state varchar(8),
    physician_zip varchar(40),
    file_id int,
    record_id int,
    brand_name varchar(100)
);


CREATE TABLE integration.chargebacks
(
    source_name varchar(255),
    account_id varchar(100),
    location_id varchar(100),
    shipment_date date,
    ndc_code varchar(20),
    product_name varchar(100),
    contract_id varchar(100),
    chargeback_quantity numeric(37,15),
    chargeback_amount numeric(37,15),
    receipt_date date,
    debit_memo_number varchar(30),
    credit_memo_date date,
    credit_memo_number varchar(30),
    settlement_date timestamp,
    contract_price numeric(37,15),
    file_id int,
    record_id int
);


CREATE TABLE integration.sample_shipment
(
    tvcmid int,
    hcp_veeva_id varchar(25),
    hcp_first_name varchar(50),
    hcp_middle_name varchar(50),
    hcp_last_name varchar(50),
    hcp_designation varchar(30),
    hcp_state_license_number varchar(20),
    hcp_address1 varchar(35),
    hcp_address2 varchar(35),
    hcp_address3 varchar(35),
    hcp_city varchar(50),
    hcp_state varchar(2),
    hcp_zip varchar(10),
    dea_license_number varchar(20),
    order_source_order_id varchar(20),
    ndc varchar(20),
    quantity int,
    order_source_job_code varchar(14),
    order_source_job_code_description varchar(50),
    ship_date date,
    file_id int,
    record_id int,
    TERRITORY varchar(20),
    REPID varchar(20),
    REPLASTNAME varchar(50),
    REPMIDDLENAME varchar(50),
    REPFIRSTNAME varchar(50),
    signature_type varchar(50),
    attendeename varchar(50),
    literature_product_id varchar(20),
    literature_product_name varchar(50)
);


CREATE TABLE integration.chargeback_demographics
(
    account_id varchar(100),
    location_id varchar(100),
    dea_number varchar(20),
    end_customer varchar(100),
    address_1 varchar(100),
    address_2 varchar(100),
    city varchar(50),
    state varchar(2),
    zip varchar(10),
    contract_title varchar(100),
    contract_id varchar(100),
    wholesaler_name varchar(100),
    hin varchar(20),
    contract_alias varchar(100),
    wholesaler_dea varchar(20),
    class_of_trade varchar(30),
    cot_source varchar(30),
    file_id int,
    record_id int
);


CREATE TABLE integration.psr_report
(
    prescriber_npi varchar(10),
    prescriber_name varchar(180),
    prescriber_state varchar(10),
    product varchar(100),
    month varchar(10),
    indication varchar(5),
    in_progress varchar(64),
    completed varchar(64),
    cancelled varchar(64),
    psr_count varchar(64),
    file_id int,
    record_id int
);


CREATE TABLE integration.prognos_syndicated_trigger_report
(
    week_end_date varchar(10),
    practice_name varchar(255),
    practice_address_line_1 varchar(255),
    practice_address_line_2 varchar(255),
    city varchar(255),
    state varchar(255),
    zip_code varchar(255),
    provider_first_name varchar(255),
    provider_last_name varchar(255),
    npi varchar(255),
    specialty_1 varchar(255),
    specialty_2 varchar(255),
    total_cml_patients_with_poor_response_to_treatment int,
    file_id int,
    record_id int,
    product_name varchar(50),
    pts_with_moderate_severe_asthma_and_eosinophils_0_149 int,
    pts_with_moderate_severe_asthma_and_eosinophils_150_399 int,
    pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater int,
    pts_with_ao_asthma_and_eosinophils_0_149 int,
    pts_with_ao_asthma_and_eosinophils_150_399 int,
    pts_with_ao_asthma_and_eosinophils_400_or_greater int,
    pts_with_moderate_severe_asthma_and_has_eosinophils_300_499 int,
    pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater int
);


CREATE TABLE integration.oncology_target_accounts
(
    tvcmid int,
    source_name varchar(255),
    sales_force_id varchar(5),
    product_name varchar(20),
    acct_demo_id int,
    ims_outlet_code varchar(10),
    target_type varchar(10),
    target_value varchar(15),
    applies_from_date date,
    applies_to_date date,
    active_ind varchar(1),
    system_start_date date,
    system_end_date date,
    end_reason varchar(30),
    veeva_account_id varchar(18),
    file_id int,
    record_id int
);


CREATE TABLE integration.prescriber_rx
(
    source_name varchar(255),
    client_number varchar(64),
    report_number varchar(64),
    zip_other varchar(10),
    ims_id varchar(10),
    specialty varchar(10),
    plan_id varchar(10),
    sales_category varchar(64),
    rx_type varchar(1),
    product_group varchar(64),
    me_num varchar(10),
    last_name varchar(25),
    first_name varchar(25),
    middle_name varchar(2),
    address varchar(30),
    city varchar(25),
    state varchar(2),
    zip varchar(5),
    supplemental_data varchar(20),
    plan_name varchar(32),
    data_date date,
    bucket_date date,
    bucket_type varchar(10),
    nrx_cnt numeric(18,3),
    nrx_qty numeric(18,3),
    trx_cnt numeric(18,3),
    trx_qty numeric(18,3),
    file_id int,
    record_id int,
    tvcmid int,
    ims_id_modified varchar(10)
);


CREATE TABLE integration.prescriber_rx_adhoc
(
    source_name varchar(255),
    client_number varchar(64),
    report_number varchar(64),
    zip_other varchar(10),
    ims_id varchar(10),
    specialty varchar(10),
    plan_id varchar(10),
    sales_category varchar(64),
    rx_type varchar(1),
    product_group varchar(64),
    me_num varchar(10),
    last_name varchar(25),
    first_name varchar(25),
    middle_name varchar(2),
    address varchar(30),
    city varchar(25),
    state varchar(2),
    zip varchar(5),
    supplemental_data varchar(20),
    plan_name varchar(32),
    data_date date,
    bucket_date date,
    bucket_type varchar(10),
    nrx_cnt numeric(37,15),
    nrx_qty numeric(37,15),
    trx_cnt numeric(37,15),
    trx_qty numeric(37,15),
    file_id int,
    record_id int,
    tvcmid int,
    ims_id_modified varchar(10)
);


CREATE TABLE integration.onc_sales_adjustment_load
(
    adj_code varchar(10),
    adj_time_period varchar(10),
    tvcmid int,
    basket_id int,
    adj_factor numeric(10,2),
    record_id int,
    file_id int
);


CREATE TABLE integration.copay_voucher_program
(
    redemption_type varchar(20),
    program_number varchar(15),
    program_description varchar(100),
    create_date date,
    file_id int,
    record_id int
);


CREATE TABLE integration.fia_provider_old
(
    PROVIDER_ID varchar(7),
    PROVIDER_TYPE varchar(2),
    IQVIA_RXER_ID varchar(7),
    PRIMARY_SPECIALTY_CODE varchar(10),
    PRIMARY_SPECIALTY_DESC varchar(100),
    FIRST_NAME varchar(100),
    LAST_NAME varchar(100),
    ORG_NM varchar(50),
    ADDRESS varchar(200),
    CITY varchar(100),
    ZIP_CODE varchar(5),
    STATE_CODE varchar(2),
    PHONE_NUMBER varchar(20),
    DEA_NUMBER varchar(20),
    ME_NUMBER varchar(20),
    FLEXIBLE_FLD_1_CHAR varchar(50),
    FLEXIBLE_FLD_2_CHAR varchar(50),
    record_id int,
    file_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_fact_v2_0917
(
    claim_id varchar(64),
    patient_id int,
    sequence_number int,
    product_id varchar(11),
    fill_date date,
    claim_type varchar(2),
    reject_code varchar(3),
    days_supply numeric(10,6),
    quantity varchar(12),
    refill_code int,
    plantrak_id varchar(10),
    opc_ask varchar(10),
    sec_plantrak_id varchar(10),
    buy_down varchar(11),
    opc_paid varchar(10),
    prescriber_id varchar(7),
    sob varchar(1),
    sub_product_id varchar(11),
    sub_opc varchar(10),
    initial_claim_id int,
    prev_product_id varchar(11),
    daw_code varchar(2),
    wrt_date date,
    claim_status varchar(1),
    copay_card_flg varchar(4),
    zip_code varchar(5),
    ecoup_flag int,
    ecoup_offset_amt numeric(10,2),
    standard_copay numeric(10,2),
    standard_copay_yn varchar(1),
    market_id int,
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    flexible_fld_3_char varchar(50),
    flexible_fld_4_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_fact_v2_0918
(
    claim_id varchar(64),
    patient_id int,
    sequence_number int,
    product_id varchar(11),
    fill_date date,
    claim_type varchar(2),
    reject_code varchar(3),
    days_supply numeric(10,6),
    quantity varchar(12),
    refill_code int,
    plantrak_id varchar(10),
    opc_ask varchar(10),
    sec_plantrak_id varchar(10),
    buy_down varchar(11),
    opc_paid varchar(10),
    prescriber_id varchar(7),
    sob varchar(1),
    sub_product_id varchar(11),
    sub_opc varchar(10),
    initial_claim_id varchar(64),
    prev_product_id varchar(11),
    daw_code varchar(2),
    wrt_date date,
    claim_status varchar(1),
    copay_card_flg varchar(4),
    zip_code varchar(5),
    ecoup_flag int,
    ecoup_offset_amt numeric(10,2),
    standard_copay numeric(10,2),
    standard_copay_yn varchar(1),
    market_id int,
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    flexible_fld_3_char varchar(50),
    flexible_fld_4_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.ddd_adhoc
(
    source_name varchar(255),
    client_number varchar(3),
    report_number varchar(3),
    territory_number varchar(10),
    outlet_code varchar(8),
    category_code varchar(2),
    ims_product_code varchar(10),
    data_date date,
    outlet_name varchar(30),
    outlet_address varchar(30),
    outlet_city varchar(25),
    outlet_state varchar(2),
    outlet_zip varchar(10),
    bucket_date date,
    bucket_type varchar(10),
    quantity numeric(37,15),
    dollars numeric(37,15),
    file_id int,
    record_id int,
    tvcmid_outlet int,
    subcategory_code varchar(10)
);


CREATE TABLE integration.fia_provider
(
    PROVIDER_ID varchar(20),
    PROVIDER_TYPE varchar(2),
    IQVIA_RXER_ID varchar(7),
    PRIMARY_SPECIALTY_CODE varchar(10),
    PRIMARY_SPECIALTY_DESC varchar(100),
    FIRST_NAME varchar(100),
    LAST_NAME varchar(100),
    ORG_NM varchar(50),
    ADDRESS varchar(200),
    CITY varchar(100),
    ZIP_CODE varchar(5),
    STATE_CODE varchar(2),
    PHONE_NUMBER varchar(20),
    DEA_NUMBER varchar(20),
    ME_NUMBER varchar(20),
    FLEXIBLE_FLD_1_CHAR varchar(50),
    FLEXIBLE_FLD_2_CHAR varchar(50),
    record_id int,
    file_id int,
    file_location varchar(255)
);


CREATE TABLE integration.sales_867
(
    trading_partner varchar(50),
    partner_duns varchar(15),
    partner_duns_4 varchar(15),
    partner_dea varchar(20),
    partner_hin varchar(20),
    partner_seller_assigned_id varchar(50),
    partner_buyer_assigned_id varchar(50),
    client_name varchar(50),
    address1 varchar(50),
    address2 varchar(50),
    city varchar(50),
    state varchar(2),
    zip varchar(15),
    client_duns varchar(15),
    client_dea varchar(20),
    client_hin varchar(20),
    client_seller_assigned_id varchar(50),
    client_buyer_assigned_id varchar(50),
    ncpdp varchar(20),
    ndc varchar(20),
    item varchar(50),
    ship_date date,
    quantity_purchased int,
    quantity_returned int,
    unit_price numeric(18,4),
    gross_amount varchar(20),
    drop_shipments int,
    file_id int,
    record_id int,
    source_name varchar(255),
    tvcmid int
);


CREATE TABLE integration.direct_sales
(
    source_name varchar(255),
    account_id varchar(100),
    location_id varchar(100),
    shipment_date date,
    ndc_code varchar(20),
    product_name varchar(100),
    transaction_type varchar(100),
    direct_sales_units numeric(37,15),
    direct_sales_dollars numeric(18,4),
    file_id int,
    record_id int
);


CREATE TABLE integration.event_count
(
    source_system_name varchar(10),
    event_number varchar(100),
    attendee_category_code varchar(25),
    attendee_category varchar(250),
    count numeric(37,15),
    file_id int,
    record_id int
);


CREATE TABLE integration.event
(
    source_system_name varchar(10),
    event_number varchar(100),
    event_name varchar(100),
    event_status_code varchar(100),
    event_status_description varchar(100),
    event_status_change_date timestamp,
    event_start_date timestamp,
    event_end_date timestamp,
    funding_source varchar(100),
    event_type varchar(100),
    event_type_description varchar(100),
    event_location varchar(100),
    event_schedule_date timestamp,
    attendee_closeout_date timestamp,
    financial_closeout_date timestamp,
    cancellation_date timestamp,
    cancellation_reason varchar(100),
    estimated_attendance varchar(100),
    venue_id varchar(100),
    venue_full_name varchar(100),
    venue_address_line_1 varchar(100),
    venue_address_line_2 varchar(100),
    venue_city varchar(100),
    venue_state varchar(100),
    venue_zip varchar(100),
    venue_contact varchar(100),
    venue_phone varchar(100),
    venue_fax varchar(100),
    venue_email varchar(100),
    file_id int,
    record_id int,
    parent_event_number varchar(100),
    event_time_zone varchar(100),
    event_format varchar(100),
    pending_mgmnt_approval_date timestamp(6),
    event_approval_date timestamp(6),
    event_approver_id varchar(100),
    cancellation_source varchar(100),
    event_venue_min_cnt_req_ind varchar(100),
    event_venue_min_count varchar(100),
    venue_address_line_3 varchar(100),
    venue_address_line_4 varchar(100),
    venue_postal_extended_code varchar(100),
    venue_country_code varchar(100),
    trade_secret_indicator varchar(100),
    trade_secret_reason varchar(100),
    custom_field_1 varchar(100),
    custom_field_2 varchar(100),
    custom_field_3 varchar(100),
    custom_field_4 varchar(100),
    custom_field_5 varchar(100),
    rec_stat_cd varchar(100)
);


CREATE TABLE integration.copay_redemptions
(
    source_name varchar(255),
    asi_txn_id varchar(20),
    territory_number varchar(200),
    program_number varchar(5),
    claim_cert_number varchar(12),
    rx_date date,
    ndc_code varchar(15),
    quantity numeric(37,15),
    other_coverage_code varchar(10),
    sex varchar(1),
    dob date,
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    principle_phys_dea_number varchar(20),
    phys_npi varchar(10),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    asi_phys_first_name varchar(50),
    asi_phys_last_name varchar(50),
    asi_phys_address1 varchar(50),
    asi_phys_address2 varchar(50),
    asi_phys_city varchar(50),
    asi_phys_state varchar(2),
    asi_phys_zip varchar(15),
    rebate_amount numeric(18,4),
    member_cash_expense numeric(18,4),
    submitted_cost numeric(18,4),
    pharmacy_fee numeric(18,4),
    total_amount_due numeric(18,4),
    company_phys_last_name varchar(50),
    company_phys_first_name varchar(50),
    company_phys_address1 varchar(50),
    company_phys_address2 varchar(50),
    company_phys_city varchar(50),
    company_phys_state varchar(2),
    company_phys_zip varchar(15),
    file_id int,
    record_id int,
    tvcmid_physician int,
    basket_id int,
    basket_name varchar(300),
    tvcmid_from_npi int,
    tvcmid_from_dea int,
    ims_id_from_npi varchar(10),
    ims_id_from_dea varchar(10),
    veeva_account_id_from_npi varchar(20),
    veeva_account_id_from_dea varchar(20)
);


CREATE TABLE integration.ims_outlet_master
(
    source_name varchar(255),
    client_number varchar(3),
    suffix varchar(2),
    territory_number varchar(8),
    outlet_number varchar(8),
    outlet_name varchar(50),
    address varchar(80),
    city varchar(40),
    state varchar(2),
    report_type varchar(2),
    status varchar(1),
    subcategory varchar(5),
    state_code varchar(2),
    county_code varchar(10),
    record_type varchar(2),
    file_id int,
    record_id int,
    retail_flag varchar(1),
    activity_date varchar(4),
    dea_number varchar(9)
);


CREATE TABLE integration.specialty_pharmacy_shipment
(
    source_name varchar(255),
    customer_number varchar(50),
    customer_name varchar(100),
    physician_first_name varchar(50),
    physician_last_name varchar(50),
    ship_to_address_line_1 varchar(100),
    ship_to_address_line_2 varchar(100),
    ship_to_city varchar(50),
    ship_to_state varchar(20),
    ship_to_zip varchar(20),
    ship_to_phone varchar(50),
    ship_to_fax varchar(50),
    transaction_id varchar(50),
    invoice_date date,
    ship_date date,
    item_number varchar(20),
    ndc varchar(20),
    brand varchar(100),
    package_size int,
    specialty_pharmacy_name varchar(100),
    quantity float,
    unit_price float,
    invoice_amount float,
    invoice_discount float,
    order_type_code varchar(30),
    customer_type_code varchar(20),
    customer_type varchar(50),
    customer_340b_number varchar(20),
    class_of_trade varchar(50),
    dea_number varchar(20),
    dea_number_expiration numeric(37,15),
    state_license_number varchar(20),
    state_license_expiration numeric(37,15),
    npi varchar(10),
    tax_id varchar(20),
    bill_to_customer_number varchar(20),
    bill_to_customer_name varchar(100),
    bill_to_address_line_1 varchar(100),
    bill_to_address_line_2 varchar(100),
    bill_to_state varchar(50),
    bill_to_city varchar(50),
    bill_to_zip varchar(20),
    bill_to_phone varchar(50),
    bill_to_fax varchar(50),
    parent_customer_code varchar(20),
    parent_customer_name varchar(100),
    order_number varchar(50),
    invoice_number varchar(50),
    order_type_description varchar(50),
    lob_code_description varchar(100),
    price_matrix_definition varchar(20),
    warehouse_code varchar(20),
    file_id int,
    record_id int,
    tvcmid int,
    replacement_flag varchar(10),
    net_sales_amt numeric(37,15),
    medicaid_return_date date,
    self_pay_refund_date date,
    hin varchar(20),
    net_cost numeric(37,15),
    order_date date,
    payer_flag varchar(50),
    briova_flag varchar(50),
    trx_count float,
    days_supplied int,
    SPP_Physician_ID int,
    Primary_Payer_BIN varchar(20),
    Primary_Payer_PCN varchar(20),
    Primary_Group_Num varchar(30),
    Primary_Payer_Name varchar(100),
    Primary_Payer_Type varchar(25),
    Primary_Copay_Amount numeric(20,2)
);


CREATE TABLE integration.oncology_target_accounts_BKP
(
    source_name varchar(255),
    sales_force_id varchar(5),
    product_name varchar(20),
    acct_demo_id int,
    ims_outlet_code varchar(10),
    target_type varchar(10),
    target_value varchar(15),
    applies_from_date date,
    applies_to_date date,
    active_ind varchar(1),
    system_start_date date,
    system_end_date date,
    end_reason varchar(30),
    veeva_account_id varchar(18),
    file_id int,
    record_id int
);


CREATE TABLE integration.oncology_call_detail_goals
(
    source_name varchar(255),
    sales_force_id varchar(5),
    time_period varchar(20),
    territory_num varchar(8),
    product_name varchar(20),
    p1 int,
    p2 int,
    p3 int,
    file_id int,
    record_id int
);


CREATE TABLE integration.oncology_fcr
(
    source_name varchar(255),
    time_period varchar(15),
    sales_force_id varchar(5),
    territory_num varchar(8),
    rep_id varchar(7),
    contact_date date,
    duration_days numeric(3,2),
    ss_opening int,
    ss_probing int,
    ss_resources int,
    ss_commitment int,
    ss_transitioning int,
    ss_acumen int,
    archive_flag varchar(1),
    file_id int,
    record_id int
);


CREATE TABLE integration.alternate_alignments
(
    zip_code varchar(10),
    state_code varchar(2),
    territory_number varchar(8),
    territory_name varchar(50),
    area_name varchar(50),
    region_name varchar(50),
    mirror_flag varchar(1),
    mirror_territory_number varchar(8),
    file_id int,
    record_id int,
    city varchar(50)
);


CREATE TABLE integration.oncology_sales_quotas
(
    source_name varchar(255),
    time_period varchar(10),
    sales_force_id varchar(5),
    territory_num varchar(8),
    product_name varchar(20),
    quota_qty int,
    quota_dol numeric(18,4),
    quota_strength_unit int,
    file_id int,
    record_id int
);


CREATE TABLE integration.ahm_interactions
(
    sourcesystemid varchar(10),
    batchid varchar(18),
    batchdate date,
    transactionstatuscode varchar(1),
    interactionid varchar(18),
    interactioncode varchar(50),
    interactionname varchar(200),
    interactioncategory varchar(50),
    interactiontype varchar(50),
    locationtype varchar(50),
    interactionstatus varchar(50),
    interactionstartdate date,
    interactionenddate date,
    interactionstarttime varchar(50),
    interactionendtime varchar(50),
    interactiontimezone varchar(80),
    interactionstartdatetime varchar(26),
    interactionenddatetime varchar(26),
    requestingregion varchar(100),
    parentinteractionid varchar(18),
    parentinteractioncode varchar(50),
    employeeid varchar(18),
    clientemployeeid varchar(50),
    employeefirstname varchar(80),
    employeelastname varchar(80),
    employeeorganizationunitid varchar(18),
    employeeorganizationunitcode varchar(50),
    employeeorganizationunitname varchar(200),
    venueid varchar(18),
    clientvenueid varchar(18),
    venuename varchar(80),
    venueaddressline1 varchar(50),
    venueaddressline2 varchar(50),
    venueaddressline3 varchar(50),
    venuecity varchar(80),
    venuestateprovince varchar(50),
    venuepostalcode varchar(20),
    venuecountry varchar(50),
    venueregion varchar(100),
    totalestimatedparticipantcount int,
    financialcloseddate date,
    product1name varchar(80),
    product1id varchar(18),
    product1clientid varchar(100),
    topic1name varchar(255),
    topic1id varchar(18),
    topic1clientid varchar(80),
    product2name varchar(80),
    product2id varchar(18),
    product2clientid varchar(100),
    topic2name varchar(255),
    topic2id varchar(18),
    topic2clientid varchar(80),
    product3name varchar(80),
    product3id varchar(18),
    product3clientid varchar(100),
    topic3name varchar(255),
    topic3id varchar(18),
    topic3clientid varchar(80),
    product4name varchar(80),
    product4id varchar(18),
    product4clientid varchar(100),
    topic4name varchar(255),
    topic4id varchar(18),
    topic4clientid varchar(80),
    product5name varchar(80),
    product5id varchar(18),
    product5clientid varchar(100),
    topic5name varchar(255),
    topic5id varchar(18),
    topic5clientid varchar(80),
    reservedfield1 varchar(10),
    reservedfield2 varchar(10),
    reservedfield3 varchar(10),
    reservedfield4 varchar(10),
    reservedfield5 varchar(10),
    reservedfield6 varchar(10),
    reservedfield7 varchar(10),
    reservedfield8 varchar(10),
    reservedfield9 varchar(10),
    reservedfield10 varchar(10),
    record_id int,
    file_id int
);


CREATE TABLE integration.ahm_participant
(
    sourcesystemid varchar(10),
    batchid varchar(18),
    batchdate date,
    transactionstatuscode varchar(1),
    interactionid varchar(18),
    interactioncode varchar(50),
    participantid varchar(18),
    clientcustomerid varchar(100),
    participanttype varchar(80),
    firstname varchar(80),
    middlename varchar(80),
    lastname varchar(80),
    suffix varchar(80),
    professionaldesignation varchar(80),
    primaryspecialty varchar(80),
    organizationname varchar(80),
    npinumber varchar(10),
    addressid varchar(18),
    clientaddressid varchar(100),
    addressline1 varchar(255),
    addressline2 varchar(255),
    addressline3 varchar(255),
    addresscity varchar(80),
    addressstateprovince varchar(50),
    addresspostalcode varchar(20),
    addresspostalcodeextension varchar(10),
    addresscountry varchar(50),
    region varchar(50),
    primarystatelicensestate varchar(50),
    primarystatelicensenumber varchar(50),
    attended varchar(1),
    mealconsumed varchar(1),
    contractid varchar(18),
    clientcontractid varchar(50),
    contractname varchar(100),
    contractcategory varchar(50),
    contractsubcategory varchar(50),
    contractclassification varchar(50),
    contracttier varchar(50),
    contracteffectivedate date,
    contractexpirationdate date,
    contracttotalvalue numeric(10,2),
    reservedfield1 varchar(10),
    reservedfield2 varchar(10),
    reservedfield3 varchar(10),
    reservedfield4 varchar(10),
    reservedfield5 varchar(10),
    reservedfield6 varchar(10),
    reservedfield7 varchar(10),
    reservedfield8 varchar(10),
    reservedfield9 varchar(10),
    reservedfield10 varchar(10),
    record_id int,
    file_id int
);


CREATE TABLE integration.ahm_unnamedparticipant
(
    sourcesystemid varchar(10),
    batchid varchar(18),
    batchdate date,
    transactionstatuscode varchar(1),
    interactionid varchar(18),
    interactioncode varchar(50),
    particpantcategoryid varchar(18),
    categorytype varchar(100),
    totalattendedcount int,
    totalmealconsumedcount int,
    record_id int,
    file_id int
);


CREATE TABLE integration.ahm_expense
(
    sourcesystemid varchar(10),
    batchid varchar(18),
    batchdate date,
    transactionstatuscode varchar(1),
    interactionid varchar(18),
    interactioncode varchar(50),
    spendid varchar(18),
    clientspendid varchar(100),
    spendamount numeric(10,2),
    spendcurrency varchar(3),
    spenddate date,
    spendtype varchar(50),
    spendpurpose varchar(50),
    traveldestinationcity varchar(80),
    traveldestinationstateprovince varchar(50),
    traveldestinationcountry varchar(50),
    spenddescription varchar(2000),
    taxincludedindicator varchar(1),
    taxamount numeric(10,2),
    taxrate numeric(10,2),
    recipientid varchar(18),
    clientrecipientid varchar(100),
    participantid varchar(18),
    recipientfirstname varchar(80),
    recipientmiddlename varchar(80),
    recipientlastname varchar(80),
    recipientsuffix varchar(80),
    recipientprofessionaldesignation varchar(80),
    recipientprimaryspecialty varchar(80),
    recipientorganizationname varchar(80),
    recipientnpinumber varchar(10),
    recipientaddressid varchar(18),
    recipientclientaddressid varchar(100),
    recipientaddressline1 varchar(255),
    recipientaddressline2 varchar(255),
    recipientaddressline3 varchar(255),
    recipientaddresscity varchar(80),
    recipientaddressstateprovince varchar(50),
    recipientaddresspostalcode varchar(20),
    recipientaddresspostalcodeextension varchar(10),
    recipientaddresscountry varchar(50),
    recipientprimarystatelicensestate varchar(50),
    recipientprimarystatelicensenumber varchar(50),
    thirdpartyrecipientindicator varchar(1),
    thirdpartyrecipientid varchar(18),
    thirdpartyclientrecipientid varchar(100),
    thirdpartyrecipientname varchar(80),
    thirdpartycoveredrecipientindicator varchar(1),
    paymentid varchar(18),
    clientpaymentid varchar(50),
    paymentdate date,
    paymentmethod varchar(50),
    paymentreferencenumber varchar(50),
    paymentstatus varchar(50),
    reservedfield1 varchar(10),
    reservedfield2 varchar(10),
    reservedfield3 varchar(10),
    reservedfield4 varchar(10),
    reservedfield5 varchar(10),
    reservedfield6 varchar(10),
    reservedfield7 varchar(10),
    reservedfield8 varchar(10),
    reservedfield9 varchar(10),
    reservedfield10 varchar(10),
    record_id int,
    file_id int
);


CREATE TABLE integration.valuecentric_867_v2
(
    ndc varchar(20),
    product_description varchar(50),
    product_name varchar(25),
    trading_partner_name varchar(50),
    trading_partner_dea varchar(15),
    trading_partner_hin varchar(15),
    trading_partner_location_type varchar(5),
    trading_partner_dc_dea varchar(15),
    trading_partner_dc_hin varchar(15),
    trading_partner_dc_name varchar(50),
    trading_partner_dc_address varchar(50),
    trading_partner_dc_address_2 varchar(50),
    trading_partner_dc_city varchar(30),
    trading_partner_dc_state varchar(2),
    trading_partner_dc_zip varchar(10),
    class_of_trade varchar(50),
    outlet_location_name varchar(150),
    outlet_dea varchar(15),
    outlet_hin varchar(15),
    outlet_340b varchar(15),
    outlet_ncpdp varchar(15),
    outlet_npi varchar(15),
    outlet_location_address varchar(100),
    outlet_location_address_2 varchar(100),
    outlet_location_city varchar(30),
    outlet_location_state varchar(2),
    outlet_location_zip varchar(10),
    reporting_date date,
    contract_number varchar(30),
    contract_description varchar(30),
    invoice_number varchar(30),
    invoice_date date,
    invoice_line_id int,
    quanitity_stock_sales_ss int,
    ds_sales_ds int,
    summary_sales_su int,
    dock_to_dock_bq int,
    interbranch_ib int,
    return_to_useable_ru int,
    return_to_vendor_rv int,
    transfer_to_disposal_td int,
    adjusted_price numeric(37,15),
    gross_amount numeric(37,15),
    record_id int,
    file_id int
);


CREATE TABLE integration.xpd_core_metrics
(
    ims_client_number varchar(3),
    ims_report_number varchar(2),
    channel_indicator int,
    ims_id varchar(10),
    specialty varchar(10),
    ims_product_group varchar(3),
    month_ending date,
    xpo_nrx numeric(37,15),
    xpo_trx numeric(37,15),
    unknown_nrx numeric(37,15),
    unknown_trx numeric(37,15),
    new_therapy_starts numeric(37,15),
    continued_new numeric(37,15),
    switch_to numeric(37,15),
    add_on numeric(37,15),
    restart_same_new numeric(37,15),
    restart_different numeric(37,15),
    continued_refill numeric(37,15),
    restart_same_refill numeric(37,15),
    switch_from numeric(37,15),
    restart_different_from numeric(37,15),
    add_to numeric(37,15),
    market_new_to_brand_rx numeric(37,15),
    dynamic_capture_rx numeric(37,15),
    record_id int,
    file_id int
);


CREATE TABLE integration.xpd_demographics
(
    ims_client_number varchar(3),
    ims_report_number varchar(2),
    ims_id varchar(10),
    last_name varchar(40),
    first_name varchar(40),
    middle_name varchar(40),
    address_1 varchar(40),
    address_2 varchar(40),
    city varchar(40),
    state varchar(2),
    zip varchar(5),
    specialty varchar(3),
    specialty_description varchar(25),
    trx_decile_retail int,
    nrx_decile_retail int,
    nbrx_decile_retail int,
    trx_decile_mail int,
    nrx_decile_mail int,
    nbrx_decile_mail int,
    market_prescriber_reliability_retail varchar(2),
    market_prescriber_reliability_mail varchar(2),
    record_id int,
    file_id int
);


CREATE TABLE integration.xpd_switch_details
(
    ims_client_number varchar(3),
    ims_report_number varchar(2),
    channel_indicator int,
    ims_id varchar(10),
    specialty varchar(10),
    switch_from_product_group_num varchar(3),
    switch_to_product_group_num varchar(3),
    month_ending date,
    rx numeric(37,15),
    record_id int,
    file_id int
);


CREATE TABLE integration.ftf_restrictions_v2
(
    health_plan_id varchar(6),
    drug_id varchar(6),
    restriction_code varchar(7),
    restriction_detail_id varchar(6),
    restriction_detail_text varchar(250),
    restriction_addtnl_information_1 varchar(4000),
    restriction_addtnl_information_2 varchar(4000),
    step_count varchar(50),
    pa_form varchar(4000),
    indication varchar(255),
    grouped_restriction_level varchar(255),
    record_id int,
    file_id int
);


CREATE TABLE integration.touchpoint_call
(
    source_name varchar(255),
    call_id int,
    call_attempt_id int,
    touchpoint_id int,
    client_id varchar(20),
    ims_id varchar(10),
    first_name varchar(50),
    last_name varchar(50),
    call_type varchar(100),
    call_date date,
    status_code varchar(10),
    status_description varchar(100),
    rep_id int,
    rep_first_name varchar(50),
    rep_last_name varchar(50),
    file_id int,
    record_id int
);


CREATE TABLE integration.event_product
(
    source_system_name varchar(100),
    event_number varchar(100),
    product_id varchar(100),
    product_name varchar(100),
    topic_id varchar(100),
    topic_name varchar(250),
    file_id int,
    record_id int
);


CREATE TABLE integration.event_host
(
    source_system_name varchar(100),
    event_number varchar(100),
    employee_id varchar(100),
    territory varchar(100),
    ordinal varchar(100),
    budget_percent varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.event_expense
(
    source_system_name varchar(100),
    event_number varchar(100),
    payment_id varchar(100),
    expense_category varchar(100),
    amount numeric(18,4),
    remit_to_id varchar(100),
    recipient_id varchar(100),
    check_number varchar(100),
    check_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE integration.sales_852
(
    source_name varchar(255),
    trading_partner varchar(50),
    distribution_center varchar(50),
    distribution_center_dea_number varchar(20),
    reporting_date date,
    product_name varchar(50),
    description varchar(50),
    ndc_11 varchar(20),
    quantity_received numeric(37,15),
    quantity_received_dollars numeric(18,4),
    quantity_sold numeric(37,15),
    quantity_sold_dollars numeric(18,4),
    quantity_omit numeric(37,15),
    quantity_omit_dollars numeric(18,4),
    month_end_quantity_on_hand numeric(37,15),
    month_end_quantity_on_hand_dollars numeric(18,4),
    month_end_committed numeric(37,15),
    month_end_committed_dollars numeric(18,4),
    month_end_reserved numeric(37,15),
    month_end_reserved_dollars numeric(18,4),
    quantity_return numeric(37,15),
    quantity_return_dollars numeric(18,4),
    quantity_customer_return numeric(37,15),
    quantity_customer_return_dollars numeric(18,4),
    file_id int,
    record_id int
);


CREATE TABLE integration.product_unit_ap
(
    source_name varchar(255),
    source_ndc_code varchar(20),
    source_description varchar(100),
    unit_ap numeric(37,15),
    file_id int,
    record_id int
);


CREATE TABLE integration.touchpoint_presentations
(
    source_name varchar(255),
    call_id int,
    call_attempt_id int,
    presentation_id int,
    product varchar(50),
    position_number int,
    item_type varchar(50),
    item_description varchar(100),
    quantity int,
    file_id int,
    record_id int
);


CREATE TABLE integration.ims_week_buckets
(
    ims_bucket int,
    month_ending date,
    month_bucket int,
    split_week_ending date,
    calendar_week date,
    calendar_week_bucket int,
    full_month varchar(1)
);


CREATE TABLE integration.ddd_md_demographics
(
    source_name varchar(255),
    client_number varchar(3),
    report_number varchar(2),
    ims_outlet_code varchar(10),
    ims_facility_number varchar(11),
    ims_prescriber_number varchar(7),
    outlet_name varchar(30),
    outlet_address varchar(120),
    outlet_city varchar(40),
    outlet_state varchar(2),
    outlet_zip varchar(5),
    facility_prescriber_name varchar(100),
    facility_prescriber_address1 varchar(60),
    facility_prescriber_address2 varchar(60),
    facility_prescriber_city varchar(40),
    facility_prescriber_state varchar(2),
    facility_prescriber_zip varchar(5),
    file_id int,
    record_id int,
    tvcmid_outlet int,
    tvcmid_facility int,
    tvcmid_prescriber int
);


CREATE TABLE integration.mm_accounts
(
    source_name varchar(255),
    id varchar(6),
    provider_id varchar(6),
    site_id varchar(6),
    first_name varchar(250),
    last_name varchar(100),
    title varchar(250),
    address_line_1 varchar(100),
    address_line_2 varchar(100),
    city varchar(100),
    state varchar(2),
    postal_code varchar(20),
    phone_1 varchar(50),
    phone_2 varchar(50),
    phone_mobile varchar(50),
    phone_fax varchar(50),
    email varchar(250),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_control
(
    source_name varchar(255),
    file_name varchar(250),
    records varchar(250),
    created_at timestamp,
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_copays
(
    source_name varchar(255),
    health_plan_id varchar(6),
    tier varchar(64),
    retail_copay varchar(50),
    retail_coinsurance varchar(50),
    mail_order_copay varchar(50),
    mail_order_coinsurance varchar(50),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_drug_class_therapeutic_area
(
    source_name varchar(255),
    drug_class_id varchar(6),
    therapeutic_area_id varchar(6),
    therapeutic_area varchar(20),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_drugs
(
    source_name varchar(255),
    drug_class_id varchar(6),
    drug_class varchar(100),
    drug_id varchar(6),
    drug varchar(100),
    generic varchar(100),
    manufacturer varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_formularies
(
    source_name varchar(255),
    health_plan_id varchar(6),
    drug_id varchar(6),
    tier_code varchar(2),
    restrictions varchar(20),
    reason_code varchar(100),
    reason_code_description varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_health_plan_geography
(
    source_name varchar(255),
    health_plan_id varchar(6),
    operating_state varchar(2),
    lives_coverage int,
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_health_plans
(
    source_name varchar(255),
    formularyf_id varchar(6),
    provider_id varchar(6),
    provider varchar(250),
    health_plan_id varchar(6),
    health_plan varchar(100),
    parent_id varchar(6),
    parent varchar(250),
    national_lives_count int,
    plan_type_name varchar(250),
    preferred_brand_tier varchar(64),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_ims_bridge
(
    source_name varchar(255),
    payer_name varchar(200),
    code varchar(50),
    name varchar(250),
    state varchar(2),
    comments varchar(250),
    plan_id varchar(100),
    plan_name varchar(250),
    provider_name varchar(250),
    plan_type_name varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_pbms
(
    source_name varchar(255),
    health_plan_id varchar(6),
    pbm_id varchar(6),
    pbm varchar(250),
    pbm_function_id varchar(6),
    pbm_function varchar(250),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_restrictions
(
    source_name varchar(255),
    health_plan_id varchar(64),
    drug_id varchar(64),
    restriction_detail_id varchar(64),
    restriction_code varchar(64),
    formulary_entry_restriction_id varchar(64),
    restriction_detail_text varchar(250),
    restriction_addtnl_information_1 varchar(1000),
    restriction_addtnl_information_2 varchar(1000),
    record_id int,
    file_id int
);


CREATE TABLE integration.mm_tiers
(
    source_name varchar(255),
    id varchar(64),
    name varchar(250),
    code_name varchar(10),
    explanation_text varchar(1000),
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_wk_bridge
(
    source_name varchar(255),
    name varchar(200),
    amc_number varchar(6),
    pbm_amc_number varchar(6),
    plan_type_code varchar(50),
    zip_code varchar(50),
    comments varchar(250),
    ff_plan_id varchar(100),
    ff_plan_name varchar(250),
    ff_provider_name varchar(250),
    ff_plan_type varchar(100),
    file_id int,
    record_id int
);


CREATE TABLE integration.rems_prescriber
(
    source_name varchar(255),
    program_id varchar(10),
    program_name varchar(48),
    channel varchar(20),
    enrollment_id varchar(20),
    first_name varchar(36),
    middle_name varchar(36),
    last_name varchar(40),
    credential varchar(40),
    site_name varchar(200),
    address_line_1 varchar(40),
    address_line_2 varchar(40),
    city varchar(40),
    state_code varchar(2),
    zip varchar(5),
    status varchar(60),
    phone varchar(10),
    effective_date date,
    expiration_date date,
    npi varchar(10),
    dea_number varchar(20),
    obsolescence_date date,
    ppaf_count int,
    file_id int,
    record_id int,
    in_progress_step varchar(40),
    tvcmid int
);


CREATE TABLE integration.copay_weekly
(
    source_name varchar(255),
    trans_type varchar(1),
    asi_txn_id varchar(20),
    orig_asi_txn_id varchar(20),
    rx_number varchar(50),
    rx_date date,
    date_written date,
    days_supply int,
    ndc_code varchar(20),
    daw int,
    drug_name varchar(50),
    drug_description varchar(100),
    new_refill int,
    quantity numeric(37,15),
    refills int,
    other_coverage_code varchar(10),
    group_number varchar(50),
    member_id varchar(20),
    sex varchar(1),
    age_at_redemption int,
    status varchar(2),
    patient_paid_amount_qualifier varchar(2),
    pharmacy_process_date date,
    nabp varchar(15),
    pharmacy_chain varchar(50),
    pharmacy_name varchar(100),
    pharmacy_address varchar(100),
    pharmacy_address2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(15),
    pharmacy_npi_number varchar(10),
    principle_phys_dea_number varchar(20),
    phys_npi varchar(10),
    physician_name varchar(100),
    physician_first_name varchar(50),
    physician_middle_name varchar(50),
    physician_last_name varchar(50),
    physician_suffix varchar(50),
    physician_prof_desg varchar(50),
    spec1 varchar(50),
    spec2 varchar(40),
    asi_phys_address1 varchar(100),
    asi_phys_address2 varchar(100),
    asi_phys_city varchar(50),
    asi_phys_state varchar(2),
    asi_phys_zip varchar(15),
    submission_method varchar(1),
    patient_benefit numeric(37,15),
    pharmacy_fee numeric(18,4),
    total_amount_authorized numeric(18,4),
    patient_copay numeric(37,15),
    patient_oop numeric(37,15),
    linked_card varchar(1000),
    doctor_state_license_number varchar(20),
    sln_state varchar(50),
    program_name varchar(255),
    customer_physician_id varchar(15),
    provider_reimbursement numeric(18,4),
    coupon_amount numeric(18,4),
    file_id int,
    record_id int,
    tvcmid_pharmacy int,
    tvcmid_physician int
);


CREATE TABLE integration.clozapine_sales
(
    source_name varchar(255),
    transaction_id varchar(100),
    invoice_date date,
    product_brand varchar(50),
    product_ndc varchar(20),
    product_desc varchar(100),
    invoice_qty numeric(37,15),
    invoice_units numeric(37,15),
    invoice_cost numeric(18,4),
    invoice_pack_cost numeric(18,4),
    invoice_unit_cost numeric(18,4),
    contract_pack_cost numeric(18,4),
    contract_purchases numeric(18,4),
    contract_number varchar(100),
    dispensing_location varchar(100),
    dl_address_1 varchar(100),
    dl_address_2 varchar(100),
    dl_city varchar(50),
    dl_state varchar(2),
    dl_zip varchar(20),
    dl_dea_number varchar(20),
    depot_location varchar(100),
    dep_address_1 varchar(100),
    dep_address_2 varchar(100),
    dep_city varchar(50),
    dep_state varchar(2),
    dep_zip varchar(5),
    dep_dea_number varchar(20),
    file_id int,
    record_id int
);


CREATE TABLE integration.speaker_license
(
    source_system_name varchar(100),
    speaker_id varchar(100),
    state_code varchar(100),
    state_license_number varchar(100),
    state_license_effective_date timestamp,
    state_license_expiration_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE integration.speaker_training
(
    source_system_name varchar(100),
    speaker_id varchar(100),
    topic_id varchar(100),
    effective_date timestamp,
    expiration_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE integration.topic_product
(
    source_system_name varchar(100),
    topic_id varchar(100),
    topic_name varchar(250),
    product_id varchar(100),
    product_name varchar(100),
    effective_date timestamp,
    expiration_date timestamp,
    file_id int,
    record_id int
);


CREATE TABLE integration.mm_predominant
(
    source_name varchar(255),
    ims_plan_id varchar(10),
    ims_plan_name varchar(100),
    ff_plan_id varchar(25),
    ff_plan_name varchar(100),
    record_id int,
    file_id int
);


CREATE TABLE integration.event_attendee
(
    source_system_name varchar(100),
    event_number varchar(100),
    employee_id varchar(100),
    attendee_id varchar(100),
    attendee_last_name varchar(100),
    attendee_first_name varchar(100),
    attendee_middle_name varchar(100),
    attendee_title varchar(100),
    attendee_specialty varchar(100),
    attendee_degree varchar(100),
    attendee_address_line_1 varchar(100),
    attendee_address_line_2 varchar(100),
    attendee_address_line_3 varchar(100),
    attendee_city varchar(100),
    attendee_state_province varchar(100),
    attendee_postal_code varchar(100),
    attendee_postal_extended_code varchar(100),
    attendee_phone varchar(100),
    attendee_fax varchar(100),
    attendee_email varchar(100),
    dea_number varchar(100),
    ims_number varchar(100),
    me_number varchar(100),
    npi_number varchar(10),
    attendee_category_code varchar(100),
    attended int,
    meal int,
    file_id int,
    record_id int,
    non_hcp_count int,
    other_hcp_count int,
    customer_id int,
    attendee_address_line_4 varchar(100)
);


CREATE TABLE integration.specialty_pharmacy_rx
(
    source_name varchar(255),
    specialty_pharmacy_name varchar(50),
    sub_specialty_pharmacy_name varchar(50),
    specialty_pharmacy_hub_id varchar(20),
    pharmacy_npi varchar(10),
    ncpdp varchar(7),
    pharmacy_store_number varchar(20),
    pharmacy_address_1 varchar(100),
    pharmacy_address_2 varchar(100),
    pharmacy_city varchar(50),
    pharmacy_state varchar(2),
    pharmacy_zip varchar(10),
    pharmacy_phone varchar(20),
    pharmacy_fax varchar(20),
    dsp_patient_id varchar(100),
    gender varchar(1),
    age int,
    patient_state varchar(2),
    primary_icd9 varchar(20),
    secondary_icd9 varchar(20),
    prescriber_npi varchar(10),
    prescriber_dea varchar(20),
    prescriber_hub_id varchar(20),
    prescriber_name_first varchar(50),
    prescriber_name_last varchar(50),
    prescriber_address_1 varchar(100),
    prescriber_address_2 varchar(100),
    prescriber_city varchar(50),
    prescriber_state varchar(2),
    prescriber_zip varchar(10),
    prescriber_phone varchar(20),
    prescriber_fax varchar(20),
    drug_name varchar(50),
    drug_ndc_11 varchar(20),
    drug_strength varchar(20),
    drug_form varchar(20),
    package_size varchar(20),
    dose_form varchar(50),
    rx_nbr varchar(20),
    refill_number int,
    rx_refills_written int,
    dispense_qty int,
    days_supply int,
    rx_written_date date,
    rx_receipt_date date,
    fill_date date,
    rx_type varchar(1),
    copay numeric(18,4),
    ingredient_wac_cost numeric(18,4),
    total_price_paid numeric(18,4),
    primary_plan_name varchar(100),
    primary_bin varchar(20),
    primary_pcn varchar(20),
    secondary_plan_name varchar(100),
    secondary_bin varchar(20),
    secondary_pcn varchar(20),
    tertiary_plan_name varchar(100),
    tertiary_bin varchar(20),
    tertiary_pcn varchar(20),
    ship_date date,
    shipping_carrier varchar(20),
    file_id int,
    record_id int
);


CREATE TABLE integration.activity
(
    activity_id varchar(64),
    federation_id varchar(64),
    contact varchar(200),
    source_name varchar(200),
    "datetime" timestamp,
    trackback_id varchar(200),
    previous_activity varchar(200),
    level_name varchar(200),
    activity_role_name varchar(200),
    type_name varchar(200),
    native_type varchar(200),
    details varchar(200),
    file_id int,
    record_id int,
    basket_id varchar(64),
    web_url varchar(5000)
);


CREATE TABLE integration.activity_line_item
(
    line_item_id varchar(64),
    brand_name varchar(200),
    activity varchar(200),
    line_item_datetime timestamp,
    line_item_previous_item varchar(200),
    line_item_trackback_id varchar(200),
    line_item_details varchar(200),
    line_item_type_name varchar(200),
    line_item_native_type varchar(200),
    file_id int,
    record_id int
);


CREATE TABLE integration.aggregated_activity
(
    aggregated_id varchar(64),
    level_name varchar(200),
    federation_id varchar(64),
    source_name varchar(200),
    contact varchar(200),
    originating_id varchar(200),
    prior_activity varchar(200),
    activity_role_name varchar(200),
    count int,
    aggregated_type_name varchar(200),
    file_id int,
    record_id int
);


CREATE TABLE integration.dynamic_segment
(
    federation_id varchar(64),
    basket_id int,
    segment_name varchar(50),
    segment_value varchar(50),
    file_id int,
    record_id int
);


CREATE TABLE integration.ddd
(
    source_name varchar(255),
    client_number varchar(3),
    report_number varchar(3),
    territory_number varchar(10),
    outlet_code varchar(8),
    category_code varchar(2),
    ims_product_code varchar(10),
    data_date date,
    outlet_name varchar(30),
    outlet_address varchar(30),
    outlet_city varchar(25),
    outlet_state varchar(2),
    outlet_zip varchar(10),
    bucket_date date,
    bucket_type varchar(10),
    quantity numeric(37,15),
    dollars numeric(37,15),
    file_id int,
    record_id int,
    tvcmid_outlet int,
    subcategory_code varchar(10)
);


CREATE TABLE integration.specialty_pharmacy_patient_txn
(
    patient_yob numeric(4,0),
    patient_gender varchar(10),
    ims_surrogate_patient_id numeric(38,0),
    product_ndc varchar(15),
    product_name varchar(50),
    product_strength varchar(50),
    unit_of_measure varchar(50),
    extended_wac_price numeric(9,4),
    transaction_id varchar(20),
    patient_status_date date,
    patient_status_ varchar(50),
    patient_sub_status varchar(100),
    specialty_pharmacy_patient_or_case_id varchar(20),
    primary_icd_9 varchar(30),
    primary_icd_10 varchar(30),
    script_reciept_date date,
    primary_appeal_status varchar(50),
    primary_copay_type varchar(50),
    primary_deductible numeric(9,4),
    primary_pa_required varchar(10),
    primary_copay_amount numeric(9,4),
    primary_payer_name varchar(128),
    primary_plan_name varchar(70),
    primary_payer_type varchar(50),
    primary_plan_type varchar(50),
    primary_payer_reject_reason_code varchar(70),
    primary_reimbursement_status varchar(100),
    primary_reimbursement_status_date date,
    primary_step_therapy_required varchar(30),
    secondary_copay_type varchar(50),
    secondary_deductible numeric(9,4),
    secondary_pa_required varchar(10),
    secondary_copay_amount numeric(9,4),
    secondary_payer_name varchar(128),
    secondary_plan_name varchar(70),
    secondary_payer_type varchar(50),
    secondary_plan_type varchar(50),
    secondary_payer_reject_reason_code varchar(70),
    secondary_step_therapy_required varchar(30),
    ncpdp_number varchar(10),
    pharmacy_name varchar(75),
    pharmacy_zip varchar(10),
    prescribing_physician_first_name varchar(35),
    prescribing_physician_last_name varchar(35),
    prescribing_physician_middle_initial varchar(35),
    prescribing_physician_dea_number varchar(15),
    prescribing_physician_me_number varchar(10),
    prescribing_physician_npi_number varchar(15),
    prescribing_physician_address_1 varchar(70),
    prescribing_physician_address_2 varchar(70),
    prescribing_physician_city varchar(50),
    prescribing_physician_state varchar(20),
    prescribing_physician_zip varchar(5),
    number_of_fills_prescribed numeric(10,0),
    number_of_refills_remaining numeric(4,0),
    fill_type varchar(10),
    rx_date date,
    rx_number varchar(15),
    carrier varchar(50),
    date_of_drug_receipt date,
    initial_ship_date date,
    quantity_shipped numeric(9,4),
    out_of_pocket_cost numeric(9,4),
    shipment_date date,
    product_lot_number varchar(35),
    program_dispense_type varchar(50),
    days_supply_dispensed varchar(20),
    primary_payer_pa_outcome varchar(30),
    secondary_payer_pa_outcome varchar(30),
    rx_communication_method varchar(30),
    tertiary_icd_10 varchar(30),
    ims_file_id numeric(38,0),
    ims_transaction_id numeric(38,0),
    ims_cycle_date date,
    ims_supplier_id numeric(15,0),
    ims_supplier_name varchar(150),
    ims_transaction_type_code numeric(2,0),
    ims_duplicate_transaction varchar(1),
    ims_prescriber_id varchar(10),
    ims_phys_first_name varchar(50),
    ims_phys_last_name varchar(50),
    ims_phys_address varchar(40),
    ims_phys_city varchar(40),
    ims_phys_state varchar(14),
    ims_phys_zip varchar(5),
    ims_phys_specialty varchar(3),
    ims_product_id varchar(10),
    ims_product_description varchar(100),
    ims_outlet_id varchar(10),
    ims_outlet_name varchar(50),
    ims_outlet_address varchar(100),
    ims_outlet_city varchar(40),
    ims_outlet_state varchar(14),
    ims_outlet_zip varchar(5),
    ims_outlet_subcategory varchar(2),
    ims_plan_id varchar(10),
    ims_plan_name varchar(100),
    ims_plan_model varchar(50),
    primary_icd10_grouping varchar(20),
    primary_icd10_grouping_reason_code varchar(30),
    secondary_icd10_grouping varchar(20),
    secondary_icd10_grouping_reason_code varchar(30),
    ims_ndc_flag varchar(1),
    ims_dispensed_date_flag varchar(1),
    ims_dispensed_quantity_flag varchar(1),
    ims_cost_flag varchar(1),
    ims_overall_flag varchar(1),
    file_id int,
    record_id int
);


CREATE TABLE integration.dx_claims
(
    ims_id varchar(7),
    npi varchar(10),
    g244_clm_cnt_mth_01 int,
    g244_clm_cnt_mth_02 int,
    g244_clm_cnt_mth_03 int,
    g244_clm_cnt_mth_04 int,
    g244_clm_cnt_mth_05 int,
    g244_clm_cnt_mth_06 int,
    g244_clm_cnt_mth_07 int,
    g244_clm_cnt_mth_08 int,
    g244_clm_cnt_mth_09 int,
    g244_clm_cnt_mth_10 int,
    g244_clm_cnt_mth_11 int,
    g244_clm_cnt_mth_12 int,
    g244_pat_cnt_mth_01 int,
    g244_pat_cnt_mth_02 int,
    g244_pat_cnt_mth_03 int,
    g244_pat_cnt_mth_04 int,
    g244_pat_cnt_mth_05 int,
    g244_pat_cnt_mth_06 int,
    g244_pat_cnt_mth_07 int,
    g244_pat_cnt_mth_08 int,
    g244_pat_cnt_mth_09 int,
    g244_pat_cnt_mth_10 int,
    g244_pat_cnt_mth_11 int,
    g244_pat_cnt_mth_12 int,
    g2401_clm_cnt_mth_01 int,
    g2401_clm_cnt_mth_02 int,
    g2401_clm_cnt_mth_03 int,
    g2401_clm_cnt_mth_04 int,
    g2401_clm_cnt_mth_05 int,
    g2401_clm_cnt_mth_06 int,
    g2401_clm_cnt_mth_07 int,
    g2401_clm_cnt_mth_08 int,
    g2401_clm_cnt_mth_09 int,
    g2401_clm_cnt_mth_10 int,
    g2401_clm_cnt_mth_11 int,
    g2401_clm_cnt_mth_12 int,
    g2401_pat_cnt_mth_01 int,
    g2401_pat_cnt_mth_02 int,
    g2401_pat_cnt_mth_03 int,
    g2401_pat_cnt_mth_04 int,
    g2401_pat_cnt_mth_05 int,
    g2401_pat_cnt_mth_06 int,
    g2401_pat_cnt_mth_07 int,
    g2401_pat_cnt_mth_08 int,
    g2401_pat_cnt_mth_09 int,
    g2401_pat_cnt_mth_10 int,
    g2401_pat_cnt_mth_11 int,
    g2401_pat_cnt_mth_12 int,
    file_id int,
    record_id int
);


CREATE TABLE integration.fia_product
(
    product_id varchar(11),
    product_group varchar(80),
    product_group_id int,
    product_name varchar(100),
    generic_name varchar(100),
    brand_generic_flag varchar(1),
    product_form varchar(100),
    product_strength varchar(100),
    package_size float,
    manufacturer varchar(100),
    cmf10 varchar(10),
    usc_code varchar(5),
    fia_market_id varchar(50),
    fia_market_desc varchar(50),
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    flexible_fld_3_char varchar(50),
    flexible_fld_4_char varchar(50),
    record_id int,
    file_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_geography
(
    zip_code varchar(5),
    cbsa_code varchar(5),
    cbsa_description varchar(100),
    state_code varchar(2),
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    record_id int,
    file_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_reject
(
    reject_code varchar(3),
    reject_reason varchar(200),
    reject_group varchar(50),
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_plan
(
    plantrak_id varchar(10),
    payer_name varchar(64),
    plan_name varchar(64),
    pbm_name varchar(60),
    pbm_id varchar(6),
    method_of_payment varchar(50),
    model_type varchar(64),
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_fact_v1
(
    claim_id int,
    patient_id int,
    sequence_number int,
    product_id varchar(11),
    fill_date date,
    claim_type varchar(2),
    reject_code varchar(3),
    days_supply numeric(10,6),
    quantity varchar(12),
    refill_code int,
    plantrak_id varchar(10),
    opc_ask varchar(10),
    sec_plantrak_id varchar(10),
    buy_down varchar(11),
    opc_paid varchar(10),
    prescriber_id varchar(7),
    sob varchar(1),
    sub_product_id varchar(11),
    sub_opc varchar(10),
    initial_claim_id int,
    prev_product_id varchar(11),
    daw_code varchar(2),
    wrt_date date,
    claim_status varchar(1),
    copay_card_flg varchar(4),
    zip_code varchar(5),
    ecoup_flag int,
    ecoup_offset_amt numeric(10,2),
    standard_copay numeric(10,2),
    standard_copay_yn varchar(1),
    market_id int,
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    flexible_fld_3_char varchar(50),
    flexible_fld_4_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.fia_mpd
(
    patient_id int,
    mpd_year int,
    mpd_eligibility_class varchar(11),
    deductible_start_date date,
    copay_start_date date,
    gap_start_date date,
    catastrophic_start_date date,
    mpd_panel_patient int,
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE TABLE integration.xpd_add_on_details
(
    ims_client_number varchar(3),
    ims_report_number varchar(2),
    channel_indicator int,
    ims_id varchar(10),
    specialty varchar(10),
    add_to_product_group varchar(3),
    add_On_product_group varchar(3),
    month_ending date,
    add_on_rx numeric(37,15),
    record_id int,
    file_id int
);


CREATE TABLE integration.xpd_restart_diff_details
(
    ims_client_number varchar(3),
    ims_report_number varchar(2),
    channel_indicator int,
    ims_id varchar(10),
    specialty varchar(10),
    rdf_product_group varchar(3),
    rd_product_group varchar(3),
    month_ending date,
    restart_diff_rx numeric(37,15),
    record_id int,
    file_id int
);


CREATE TABLE integration.fia_fact
(
    claim_id varchar(64),
    patient_id int,
    sequence_number int,
    product_id varchar(11),
    fill_date date,
    claim_type varchar(2),
    reject_code varchar(3),
    days_supply numeric(10,6),
    quantity varchar(12),
    refill_code int,
    plantrak_id varchar(10),
    opc_ask varchar(10),
    sec_plantrak_id varchar(10),
    buy_down varchar(11),
    opc_paid varchar(10),
    prescriber_id varchar(20),
    sob varchar(3),
    sub_product_id varchar(11),
    sub_opc varchar(10),
    initial_claim_id varchar(64),
    prev_product_id varchar(11),
    daw_code varchar(2),
    wrt_date date,
    claim_status varchar(1),
    copay_card_flg varchar(4),
    zip_code varchar(5),
    ecoup_flag int,
    ecoup_offset_amt numeric(10,2),
    standard_copay numeric(10,2),
    standard_copay_yn varchar(1),
    market_id int,
    flexible_fld_1_char varchar(50),
    flexible_fld_2_char varchar(50),
    flexible_fld_3_char varchar(50),
    flexible_fld_4_char varchar(50),
    file_id int,
    record_id int,
    file_location varchar(255)
);


CREATE PROJECTION integration.rems_pharmacy_b0 /*+basename(rems_pharmacy),createtype(L)*/ 
(
 source_name,
 program_id,
 program_name,
 channel,
 enrollment_id,
 pharmacy_type,
 pharmacy_name,
 address_line_1,
 address_line_2,
 city,
 state_code,
 zip,
 first_name,
 middle_name,
 last_name,
 status,
 in_progress_step,
 phone,
 effective_date,
 expiration_date,
 ncpdp,
 npi,
 dea_number,
 license_number,
 obsolescence_date,
 file_id,
 record_id,
 obsolescence_reason,
 last_build_date
)
AS
 SELECT rems_pharmacy.source_name,
        rems_pharmacy.program_id,
        rems_pharmacy.program_name,
        rems_pharmacy.channel,
        rems_pharmacy.enrollment_id,
        rems_pharmacy.pharmacy_type,
        rems_pharmacy.pharmacy_name,
        rems_pharmacy.address_line_1,
        rems_pharmacy.address_line_2,
        rems_pharmacy.city,
        rems_pharmacy.state_code,
        rems_pharmacy.zip,
        rems_pharmacy.first_name,
        rems_pharmacy.middle_name,
        rems_pharmacy.last_name,
        rems_pharmacy.status,
        rems_pharmacy.in_progress_step,
        rems_pharmacy.phone,
        rems_pharmacy.effective_date,
        rems_pharmacy.expiration_date,
        rems_pharmacy.ncpdp,
        rems_pharmacy.npi,
        rems_pharmacy.dea_number,
        rems_pharmacy.license_number,
        rems_pharmacy.obsolescence_date,
        rems_pharmacy.file_id,
        rems_pharmacy.record_id,
        rems_pharmacy.obsolescence_reason,
        rems_pharmacy.last_build_date
 FROM integration.rems_pharmacy
 ORDER BY rems_pharmacy.source_name,
          rems_pharmacy.program_id,
          rems_pharmacy.program_name,
          rems_pharmacy.channel,
          rems_pharmacy.enrollment_id,
          rems_pharmacy.pharmacy_type,
          rems_pharmacy.pharmacy_name,
          rems_pharmacy.address_line_1,
          rems_pharmacy.address_line_2,
          rems_pharmacy.city,
          rems_pharmacy.state_code,
          rems_pharmacy.zip,
          rems_pharmacy.first_name,
          rems_pharmacy.middle_name,
          rems_pharmacy.last_name,
          rems_pharmacy.status,
          rems_pharmacy.in_progress_step,
          rems_pharmacy.phone,
          rems_pharmacy.effective_date,
          rems_pharmacy.expiration_date,
          rems_pharmacy.ncpdp,
          rems_pharmacy.npi,
          rems_pharmacy.dea_number,
          rems_pharmacy.license_number,
          rems_pharmacy.obsolescence_date,
          rems_pharmacy.file_id,
          rems_pharmacy.record_id
SEGMENTED BY hash(rems_pharmacy.record_id) ALL NODES;

CREATE PROJECTION integration.territory_ram_to_state_b0 /*+basename(territory_ram_to_state),createtype(L)*/ 
(
 source_name,
 mm_ram,
 state_code,
 file_id,
 record_id
)
AS
 SELECT territory_ram_to_state.source_name,
        territory_ram_to_state.mm_ram,
        territory_ram_to_state.state_code,
        territory_ram_to_state.file_id,
        territory_ram_to_state.record_id
 FROM integration.territory_ram_to_state
 ORDER BY territory_ram_to_state.source_name,
          territory_ram_to_state.mm_ram,
          territory_ram_to_state.state_code,
          territory_ram_to_state.file_id,
          territory_ram_to_state.record_id
SEGMENTED BY hash(territory_ram_to_state.state_code, territory_ram_to_state.file_id, territory_ram_to_state.record_id, territory_ram_to_state.mm_ram, territory_ram_to_state.source_name) ALL NODES;

CREATE PROJECTION integration.territory_zip_b0 /*+basename(territory_zip),createtype(L)*/ 
(
 source_name,
 zip_code,
 city,
 state_code,
 territory_number,
 territory_name,
 area_name,
 region_name,
 sales_force_id,
 organization_code,
 mirror_flag,
 mirror_territory_number,
 file_id,
 record_id
)
AS
 SELECT territory_zip.source_name,
        territory_zip.zip_code,
        territory_zip.city,
        territory_zip.state_code,
        territory_zip.territory_number,
        territory_zip.territory_name,
        territory_zip.area_name,
        territory_zip.region_name,
        territory_zip.sales_force_id,
        territory_zip.organization_code,
        territory_zip.mirror_flag,
        territory_zip.mirror_territory_number,
        territory_zip.file_id,
        territory_zip.record_id
 FROM integration.territory_zip
 ORDER BY territory_zip.source_name,
          territory_zip.zip_code,
          territory_zip.city,
          territory_zip.state_code,
          territory_zip.territory_number,
          territory_zip.territory_name,
          territory_zip.area_name,
          territory_zip.region_name,
          territory_zip.sales_force_id,
          territory_zip.organization_code,
          territory_zip.mirror_flag,
          territory_zip.mirror_territory_number,
          territory_zip.file_id,
          territory_zip.record_id
SEGMENTED BY hash(territory_zip.record_id) ALL NODES;

CREATE PROJECTION integration.plan_xref_b0 /*+basename(plan_xref),createtype(L)*/ 
(
 source_name,
 payer_number,
 payer_name,
 plan_number,
 payer_plan_number,
 plan_name,
 model,
 city,
 hq_state,
 operating_state,
 months_with_data,
 file_id,
 record_id
)
AS
 SELECT plan_xref.source_name,
        plan_xref.payer_number,
        plan_xref.payer_name,
        plan_xref.plan_number,
        plan_xref.payer_plan_number,
        plan_xref.plan_name,
        plan_xref.model,
        plan_xref.city,
        plan_xref.hq_state,
        plan_xref.operating_state,
        plan_xref.months_with_data,
        plan_xref.file_id,
        plan_xref.record_id
 FROM integration.plan_xref
 ORDER BY plan_xref.source_name,
          plan_xref.payer_number,
          plan_xref.payer_name,
          plan_xref.plan_number,
          plan_xref.payer_plan_number,
          plan_xref.plan_name,
          plan_xref.model,
          plan_xref.city,
          plan_xref.hq_state,
          plan_xref.operating_state,
          plan_xref.months_with_data,
          plan_xref.file_id,
          plan_xref.record_id
SEGMENTED BY hash(plan_xref.record_id) ALL NODES;

CREATE PROJECTION integration.pbm_xref_b0 /*+basename(pbm_xref),createtype(L)*/ 
(
 source_name,
 pbm_name,
 payer_plan_number,
 xref_to_payer_plan_number,
 plan_name,
 pbm_number,
 ims_processor_number,
 file_id,
 record_id
)
AS
 SELECT pbm_xref.source_name,
        pbm_xref.pbm_name,
        pbm_xref.payer_plan_number,
        pbm_xref.xref_to_payer_plan_number,
        pbm_xref.plan_name,
        pbm_xref.pbm_number,
        pbm_xref.ims_processor_number,
        pbm_xref.file_id,
        pbm_xref.record_id
 FROM integration.pbm_xref
 ORDER BY pbm_xref.source_name,
          pbm_xref.pbm_name,
          pbm_xref.payer_plan_number,
          pbm_xref.xref_to_payer_plan_number,
          pbm_xref.plan_name,
          pbm_xref.pbm_number,
          pbm_xref.ims_processor_number
SEGMENTED BY hash(pbm_xref.pbm_number, pbm_xref.file_id, pbm_xref.record_id, pbm_xref.payer_plan_number, pbm_xref.xref_to_payer_plan_number, pbm_xref.ims_processor_number, pbm_xref.pbm_name, pbm_xref.plan_name, pbm_xref.source_name) ALL NODES;

CREATE PROJECTION integration.drm45_b0 /*+basename(drm45),createtype(L)*/ 
(
 source_name,
 file_code,
 product_group,
 product_name,
 mfg_number,
 status,
 cmf_code,
 product_description,
 mfg_name,
 usc_code,
 file_id,
 record_id
)
AS
 SELECT ims_product_list.source_name,
        ims_product_list.file_code,
        ims_product_list.product_group,
        ims_product_list.product_name,
        ims_product_list.mfg_number,
        ims_product_list.status,
        ims_product_list.cmf_code,
        ims_product_list.product_description,
        ims_product_list.mfg_name,
        ims_product_list.usc_code,
        ims_product_list.file_id,
        ims_product_list.record_id
 FROM integration.ims_product_list
 ORDER BY ims_product_list.source_name,
          ims_product_list.file_code,
          ims_product_list.product_group,
          ims_product_list.product_name,
          ims_product_list.mfg_number,
          ims_product_list.status,
          ims_product_list.cmf_code,
          ims_product_list.product_description,
          ims_product_list.mfg_name,
          ims_product_list.usc_code,
          ims_product_list.file_id,
          ims_product_list.record_id
SEGMENTED BY hash(ims_product_list.record_id) ALL NODES;

CREATE PROJECTION integration.event_speaker_b0 /*+basename(event_speaker),createtype(L)*/ 
(
 source_system_name,
 event_number,
 event_speaker_status,
 speaker_id,
 product_id,
 topic_id,
 cancellation_reason,
 file_id,
 record_id
)
AS
 SELECT event_speaker.source_system_name,
        event_speaker.event_number,
        event_speaker.event_speaker_status,
        event_speaker.speaker_id,
        event_speaker.product_id,
        event_speaker.topic_id,
        event_speaker.cancellation_reason,
        event_speaker.file_id,
        event_speaker.record_id
 FROM integration.event_speaker
 ORDER BY event_speaker.source_system_name,
          event_speaker.event_number,
          event_speaker.event_speaker_status,
          event_speaker.speaker_id,
          event_speaker.product_id,
          event_speaker.topic_id,
          event_speaker.cancellation_reason,
          event_speaker.file_id,
          event_speaker.record_id
SEGMENTED BY hash(event_speaker.record_id) ALL NODES;

CREATE PROJECTION integration.speaker_contract_b0 /*+basename(speaker_contract)*/ 
(
 source_system_name,
 speaker_id,
 contract_type_code,
 contract_type_name,
 contract_effective_date,
 contract_expiration_date,
 contract_signed_date,
 file_id,
 record_id
)
AS
 SELECT speaker_contract.source_system_name,
        speaker_contract.speaker_id,
        speaker_contract.contract_type_code,
        speaker_contract.contract_type_name,
        speaker_contract.contract_effective_date,
        speaker_contract.contract_expiration_date,
        speaker_contract.contract_signed_date,
        speaker_contract.file_id,
        speaker_contract.record_id
 FROM integration.speaker_contract
 ORDER BY speaker_contract.source_system_name,
          speaker_contract.speaker_id,
          speaker_contract.contract_type_code,
          speaker_contract.contract_type_name,
          speaker_contract.contract_effective_date,
          speaker_contract.contract_expiration_date,
          speaker_contract.contract_signed_date,
          speaker_contract.file_id,
          speaker_contract.record_id
SEGMENTED BY hash(speaker_contract.record_id) ALL NODES;

CREATE PROJECTION integration.speaker_profile_b0 /*+basename(speaker_profile)*/ 
(
 source_system_name,
 speaker_id,
 first_name,
 last_name,
 middle_name,
 title,
 address_line_1,
 address_line_2,
 address_line_3,
 address_line_4,
 city,
 state_province,
 postal_code,
 postal_extended_code,
 country_code,
 business_phone,
 business_phone_extension,
 home_phone,
 mobile_phone,
 business_fax,
 home_fax,
 email,
 specialty,
 personal_suffix,
 degree,
 me_number,
 ims_number,
 dea_number,
 npi_number,
 clinical_affiliation,
 clinical_title,
 academic_affiliation,
 other_affiliation,
 federal_employee_indicator,
 state_employee_indicator,
 local_employee_indicator,
 fda_debarment_indicator,
 ofac_debarment_indicator,
 oig_exclusion_indicator,
 speaker_biography,
 file_id,
 record_id
)
AS
 SELECT speaker_profile.source_system_name,
        speaker_profile.speaker_id,
        speaker_profile.first_name,
        speaker_profile.last_name,
        speaker_profile.middle_name,
        speaker_profile.title,
        speaker_profile.address_line_1,
        speaker_profile.address_line_2,
        speaker_profile.address_line_3,
        speaker_profile.address_line_4,
        speaker_profile.city,
        speaker_profile.state_province,
        speaker_profile.postal_code,
        speaker_profile.postal_extended_code,
        speaker_profile.country_code,
        speaker_profile.business_phone,
        speaker_profile.business_phone_extension,
        speaker_profile.home_phone,
        speaker_profile.mobile_phone,
        speaker_profile.business_fax,
        speaker_profile.home_fax,
        speaker_profile.email,
        speaker_profile.specialty,
        speaker_profile.personal_suffix,
        speaker_profile.degree,
        speaker_profile.me_number,
        speaker_profile.ims_number,
        speaker_profile.dea_number,
        speaker_profile.npi_number,
        speaker_profile.clinical_affiliation,
        speaker_profile.clinical_title,
        speaker_profile.academic_affiliation,
        speaker_profile.other_affiliation,
        speaker_profile.federal_employee_indicator,
        speaker_profile.state_employee_indicator,
        speaker_profile.local_employee_indicator,
        speaker_profile.fda_debarment_indicator,
        speaker_profile.ofac_debarment_indicator,
        speaker_profile.oig_exclusion_indicator,
        speaker_profile.speaker_biography,
        speaker_profile.file_id,
        speaker_profile.record_id
 FROM integration.speaker_profile
 ORDER BY speaker_profile.source_system_name,
          speaker_profile.speaker_id,
          speaker_profile.first_name,
          speaker_profile.last_name,
          speaker_profile.middle_name,
          speaker_profile.title,
          speaker_profile.address_line_1,
          speaker_profile.address_line_2,
          speaker_profile.address_line_3,
          speaker_profile.address_line_4,
          speaker_profile.city,
          speaker_profile.state_province,
          speaker_profile.postal_code,
          speaker_profile.postal_extended_code,
          speaker_profile.country_code,
          speaker_profile.business_phone,
          speaker_profile.business_phone_extension,
          speaker_profile.home_phone,
          speaker_profile.mobile_phone,
          speaker_profile.business_fax,
          speaker_profile.home_fax,
          speaker_profile.email,
          speaker_profile.specialty,
          speaker_profile.personal_suffix,
          speaker_profile.degree,
          speaker_profile.me_number,
          speaker_profile.ims_number,
          speaker_profile.dea_number,
          speaker_profile.npi_number,
          speaker_profile.clinical_affiliation,
          speaker_profile.clinical_title,
          speaker_profile.academic_affiliation,
          speaker_profile.other_affiliation,
          speaker_profile.federal_employee_indicator,
          speaker_profile.state_employee_indicator,
          speaker_profile.local_employee_indicator,
          speaker_profile.fda_debarment_indicator,
          speaker_profile.ofac_debarment_indicator,
          speaker_profile.oig_exclusion_indicator,
          speaker_profile.speaker_biography,
          speaker_profile.file_id,
          speaker_profile.record_id
SEGMENTED BY hash(speaker_profile.record_id) ALL NODES;

CREATE PROJECTION integration.zs_call_plan_b0 /*+basename(zs_call_plan)*/ 
(
 source_name,
 veeva_account_id,
 ims_id,
 first_name,
 last_name,
 specialty,
 territory_number,
 address,
 city,
 state,
 zip,
 product_name,
 p1,
 p2,
 p3,
 target,
 sales_force_id,
 period,
 file_id,
 record_id,
 tvcmid
)
AS
 SELECT call_plan.source_name,
        call_plan.veeva_account_id,
        call_plan.ims_id,
        call_plan.first_name,
        call_plan.last_name,
        call_plan.specialty,
        call_plan.territory_number,
        call_plan.address,
        call_plan.city,
        call_plan.state,
        call_plan.zip,
        call_plan.product_name,
        call_plan.p1,
        call_plan.p2,
        call_plan.p3,
        call_plan.target,
        call_plan.sales_force_id,
        call_plan.period,
        call_plan.file_id,
        call_plan.record_id,
        call_plan.tvcmid
 FROM integration.call_plan
 ORDER BY call_plan.source_name,
          call_plan.veeva_account_id
SEGMENTED BY hash(call_plan.record_id) ALL NODES;

CREATE PROJECTION integration.ddd_md_b0 /*+basename(ddd_md),createtype(L)*/ 
(
 source_name,
 client_number,
 report_number,
 territory_number,
 ims_outlet_code,
 subcategory_code,
 alt_seq_number,
 category_code,
 ims_product_code,
 data_date,
 dollars,
 quantity,
 bucket_date,
 bucket_type,
 outlet_name,
 outlet_address,
 outlet_city,
 outlet_state,
 outlet_zip,
 file_id,
 record_id,
 tvcmid_outlet
)
AS
 SELECT ddd_md.source_name,
        ddd_md.client_number,
        ddd_md.report_number,
        ddd_md.territory_number,
        ddd_md.ims_outlet_code,
        ddd_md.subcategory_code,
        ddd_md.alt_seq_number,
        ddd_md.category_code,
        ddd_md.ims_product_code,
        ddd_md.data_date,
        ddd_md.dollars,
        ddd_md.quantity,
        ddd_md.bucket_date,
        ddd_md.bucket_type,
        ddd_md.outlet_name,
        ddd_md.outlet_address,
        ddd_md.outlet_city,
        ddd_md.outlet_state,
        ddd_md.outlet_zip,
        ddd_md.file_id,
        ddd_md.record_id,
        ddd_md.tvcmid_outlet
 FROM integration.ddd_md
 ORDER BY ddd_md.source_name,
          ddd_md.client_number,
          ddd_md.report_number,
          ddd_md.territory_number,
          ddd_md.ims_outlet_code,
          ddd_md.subcategory_code,
          ddd_md.alt_seq_number,
          ddd_md.category_code,
          ddd_md.ims_product_code,
          ddd_md.data_date,
          ddd_md.dollars,
          ddd_md.quantity,
          ddd_md.bucket_date,
          ddd_md.bucket_type
SEGMENTED BY hash(ddd_md.record_id) ALL NODES;

CREATE PROJECTION integration.copay_detail_weekly_b0 /*+basename(copay_detail_weekly),createtype(L)*/ 
(
 source_name,
 trans_type,
 asi_txn_id,
 orig_asi_txn_id,
 rx_number,
 rx_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 drug_name,
 drug_description,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 group_number,
 coupon_number,
 sex,
 age_at_redemption,
 pharmacy_process_date,
 pharmacy_chain_number,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_npi_number,
 principle_phys_dea_number,
 phys_npi,
 physician_name,
 asi_phys_address1,
 asi_phys_address2,
 asi_phys_city,
 asi_phys_state,
 asi_phys_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 calc_awp,
 create_date,
 occ_payment_type,
 file_id,
 record_id,
 tvcmid_physician,
 tvcmid_pharmacy,
 auth_refills,
 admin_hcp_npi,
 admin_hcp_name,
 admin_hcp_address,
 admin_hcp_address2,
 admin_hcp_city,
 admin_hcp_state,
 claim_type,
 administration_flag,
 soc_name,
 soc_address,
 soc_city,
 soc_state,
 soc_id,
 soc_npi,
 payer_name,
 cpt_code,
 previous_payer_id,
 member_id,
 benefit_amount,
 patient_expense,
 submission_method,
 redemption_type,
 report_frequency,
 admin_hcp_zip,
 soc_phone,
 soc_fax,
 soc_zip,
 basket_id,
 basket_name,
 tvcmid_from_npi,
 tvcmid_from_dea,
 tvcmid_from_pharmacy_npi,
 ims_id_from_npi,
 ims_id_from_dea,
 veeva_account_id_from_npi,
 veeva_account_id_from_dea,
 patient_type,
 primary_bin,
 primary_bin_description,
 reject_code
)
AS
 SELECT copay_detail_weekly.source_name,
        copay_detail_weekly.trans_type,
        copay_detail_weekly.asi_txn_id,
        copay_detail_weekly.orig_asi_txn_id,
        copay_detail_weekly.rx_number,
        copay_detail_weekly.rx_date,
        copay_detail_weekly.date_written,
        copay_detail_weekly.days_supply,
        copay_detail_weekly.ndc_code,
        copay_detail_weekly.daw,
        copay_detail_weekly.drug_name,
        copay_detail_weekly.drug_description,
        copay_detail_weekly.new_refill,
        copay_detail_weekly.quantity,
        copay_detail_weekly.refills,
        copay_detail_weekly.other_coverage_code,
        copay_detail_weekly.group_number,
        copay_detail_weekly.coupon_number,
        copay_detail_weekly.sex,
        copay_detail_weekly.age_at_redemption,
        copay_detail_weekly.pharmacy_process_date,
        copay_detail_weekly.pharmacy_chain_number,
        copay_detail_weekly.nabp,
        copay_detail_weekly.pharmacy_chain,
        copay_detail_weekly.pharmacy_name,
        copay_detail_weekly.pharmacy_address,
        copay_detail_weekly.pharmacy_address2,
        copay_detail_weekly.pharmacy_city,
        copay_detail_weekly.pharmacy_state,
        copay_detail_weekly.pharmacy_zip,
        copay_detail_weekly.pharmacy_phone,
        copay_detail_weekly.pharmacy_npi_number,
        copay_detail_weekly.principle_phys_dea_number,
        copay_detail_weekly.phys_npi,
        copay_detail_weekly.physician_name,
        copay_detail_weekly.asi_phys_address1,
        copay_detail_weekly.asi_phys_address2,
        copay_detail_weekly.asi_phys_city,
        copay_detail_weekly.asi_phys_state,
        copay_detail_weekly.asi_phys_zip,
        copay_detail_weekly.rebate_amount,
        copay_detail_weekly.member_cash_expense,
        copay_detail_weekly.submitted_cost,
        copay_detail_weekly.pharmacy_fee,
        copay_detail_weekly.total_amount_due,
        copay_detail_weekly.calc_awp,
        copay_detail_weekly.create_date,
        copay_detail_weekly.occ_payment_type,
        copay_detail_weekly.file_id,
        copay_detail_weekly.record_id,
        copay_detail_weekly.tvcmid_physician,
        copay_detail_weekly.tvcmid_pharmacy,
        copay_detail_weekly.auth_refills,
        copay_detail_weekly.admin_hcp_npi,
        copay_detail_weekly.admin_hcp_name,
        copay_detail_weekly.admin_hcp_address,
        copay_detail_weekly.admin_hcp_address2,
        copay_detail_weekly.admin_hcp_city,
        copay_detail_weekly.admin_hcp_state,
        copay_detail_weekly.claim_type,
        copay_detail_weekly.administration_flag,
        copay_detail_weekly.soc_name,
        copay_detail_weekly.soc_address,
        copay_detail_weekly.soc_city,
        copay_detail_weekly.soc_state,
        copay_detail_weekly.soc_id,
        copay_detail_weekly.soc_npi,
        copay_detail_weekly.payer_name,
        copay_detail_weekly.cpt_code,
        copay_detail_weekly.previous_payer_id,
        copay_detail_weekly.member_id,
        copay_detail_weekly.benefit_amount,
        copay_detail_weekly.patient_expense,
        copay_detail_weekly.submission_method,
        copay_detail_weekly.redemption_type,
        copay_detail_weekly.report_frequency,
        copay_detail_weekly.admin_hcp_zip,
        copay_detail_weekly.soc_phone,
        copay_detail_weekly.soc_fax,
        copay_detail_weekly.soc_zip,
        copay_detail_weekly.basket_id,
        copay_detail_weekly.basket_name,
        copay_detail_weekly.tvcmid_from_npi,
        copay_detail_weekly.tvcmid_from_dea,
        copay_detail_weekly.tvcmid_from_pharmacy_npi,
        copay_detail_weekly.ims_id_from_npi,
        copay_detail_weekly.ims_id_from_dea,
        copay_detail_weekly.veeva_account_id_from_npi,
        copay_detail_weekly.veeva_account_id_from_dea,
        copay_detail_weekly.patient_type,
        copay_detail_weekly.primary_bin,
        copay_detail_weekly.primary_bin_description,
        copay_detail_weekly.reject_code
 FROM integration.copay_detail_weekly
 ORDER BY copay_detail_weekly.source_name,
          copay_detail_weekly.trans_type,
          copay_detail_weekly.asi_txn_id,
          copay_detail_weekly.orig_asi_txn_id,
          copay_detail_weekly.rx_number,
          copay_detail_weekly.rx_date,
          copay_detail_weekly.date_written,
          copay_detail_weekly.days_supply,
          copay_detail_weekly.ndc_code,
          copay_detail_weekly.daw,
          copay_detail_weekly.drug_name,
          copay_detail_weekly.drug_description,
          copay_detail_weekly.new_refill,
          copay_detail_weekly.quantity,
          copay_detail_weekly.refills,
          copay_detail_weekly.other_coverage_code,
          copay_detail_weekly.group_number,
          copay_detail_weekly.coupon_number,
          copay_detail_weekly.sex,
          copay_detail_weekly.age_at_redemption,
          copay_detail_weekly.pharmacy_process_date,
          copay_detail_weekly.pharmacy_chain_number,
          copay_detail_weekly.nabp,
          copay_detail_weekly.pharmacy_chain,
          copay_detail_weekly.pharmacy_name,
          copay_detail_weekly.pharmacy_address,
          copay_detail_weekly.pharmacy_address2,
          copay_detail_weekly.pharmacy_city,
          copay_detail_weekly.pharmacy_state,
          copay_detail_weekly.pharmacy_zip,
          copay_detail_weekly.pharmacy_phone,
          copay_detail_weekly.pharmacy_npi_number,
          copay_detail_weekly.principle_phys_dea_number,
          copay_detail_weekly.phys_npi,
          copay_detail_weekly.physician_name,
          copay_detail_weekly.asi_phys_address1,
          copay_detail_weekly.asi_phys_address2,
          copay_detail_weekly.asi_phys_city,
          copay_detail_weekly.asi_phys_state,
          copay_detail_weekly.asi_phys_zip,
          copay_detail_weekly.rebate_amount,
          copay_detail_weekly.member_cash_expense,
          copay_detail_weekly.submitted_cost,
          copay_detail_weekly.pharmacy_fee,
          copay_detail_weekly.total_amount_due,
          copay_detail_weekly.calc_awp,
          copay_detail_weekly.create_date,
          copay_detail_weekly.occ_payment_type
SEGMENTED BY hash(copay_detail_weekly.record_id) ALL NODES;

CREATE PROJECTION integration.roster_address_b0 /*+basename(roster_address),createtype(L)*/ 
(
 source_name,
 address_id,
 line_1,
 line_2,
 line_3,
 city,
 state_abbr,
 postal_code,
 country_iso_abbr,
 create_user,
 create_date,
 update_user,
 update_date,
 file_id,
 record_id
)
AS
 SELECT roster_address.source_name,
        roster_address.address_id,
        roster_address.line_1,
        roster_address.line_2,
        roster_address.line_3,
        roster_address.city,
        roster_address.state_abbr,
        roster_address.postal_code,
        roster_address.country_iso_abbr,
        roster_address.create_user,
        roster_address.create_date,
        roster_address.update_user,
        roster_address.update_date,
        roster_address.file_id,
        roster_address.record_id
 FROM integration.roster_address
 ORDER BY roster_address.source_name,
          roster_address.address_id,
          roster_address.line_1,
          roster_address.line_2,
          roster_address.line_3,
          roster_address.city,
          roster_address.state_abbr,
          roster_address.postal_code,
          roster_address.country_iso_abbr,
          roster_address.create_user
SEGMENTED BY hash(roster_address.state_abbr, roster_address.country_iso_abbr, roster_address.create_date, roster_address.update_date, roster_address.file_id, roster_address.record_id, roster_address.postal_code, roster_address.create_user, roster_address.update_user, roster_address.line_1, roster_address.line_2, roster_address.line_3, roster_address.city, roster_address.address_id) ALL NODES;

CREATE PROJECTION integration.roster_associate_b0 /*+basename(roster_associate),createtype(L)*/ 
(
 source_name,
 teva_id,
 hr_id,
 create_user,
 create_date,
 update_user,
 update_date,
 hire_date,
 logon_id,
 reports_to,
 stat_code,
 type_code,
 full_time,
 eeo_cat,
 exempt,
 expense_cost_ctr,
 hours_per_week,
 marital_stat,
 race,
 email,
 birth_date,
 country_id,
 default_currency_id,
 territory_id,
 office,
 person_sys_id,
 language,
 "position",
 term_date,
 last_wrk_date,
 auth_limit,
 vehicle,
 vacation_days,
 check_req_limit,
 expense_report_approver,
 location_code,
 pay_code,
 ed_code,
 ed_code_date,
 job_code,
 country_citizenship,
 disabled,
 vietnam_vet,
 emergency_contact_name,
 emergency_contact_relationship,
 emergency_contact_phone,
 adp_dept_num,
 vacation_year,
 fin_auth_comments,
 eeo_cat_hr_updt,
 expense_reporting,
 company_id,
 check_request_approver,
 invoice_approver,
 phantom_indicator,
 payroll_cost_ctr,
 sample_auth,
 oracle_string,
 file_id,
 record_id
)
AS
 SELECT roster_associate.source_name,
        roster_associate.teva_id,
        roster_associate.hr_id,
        roster_associate.create_user,
        roster_associate.create_date,
        roster_associate.update_user,
        roster_associate.update_date,
        roster_associate.hire_date,
        roster_associate.logon_id,
        roster_associate.reports_to,
        roster_associate.stat_code,
        roster_associate.type_code,
        roster_associate.full_time,
        roster_associate.eeo_cat,
        roster_associate.exempt,
        roster_associate.expense_cost_ctr,
        roster_associate.hours_per_week,
        roster_associate.marital_stat,
        roster_associate.race,
        roster_associate.email,
        roster_associate.birth_date,
        roster_associate.country_id,
        roster_associate.default_currency_id,
        roster_associate.territory_id,
        roster_associate.office,
        roster_associate.person_sys_id,
        roster_associate.language,
        roster_associate."position",
        roster_associate.term_date,
        roster_associate.last_wrk_date,
        roster_associate.auth_limit,
        roster_associate.vehicle,
        roster_associate.vacation_days,
        roster_associate.check_req_limit,
        roster_associate.expense_report_approver,
        roster_associate.location_code,
        roster_associate.pay_code,
        roster_associate.ed_code,
        roster_associate.ed_code_date,
        roster_associate.job_code,
        roster_associate.country_citizenship,
        roster_associate.disabled,
        roster_associate.vietnam_vet,
        roster_associate.emergency_contact_name,
        roster_associate.emergency_contact_relationship,
        roster_associate.emergency_contact_phone,
        roster_associate.adp_dept_num,
        roster_associate.vacation_year,
        roster_associate.fin_auth_comments,
        roster_associate.eeo_cat_hr_updt,
        roster_associate.expense_reporting,
        roster_associate.company_id,
        roster_associate.check_request_approver,
        roster_associate.invoice_approver,
        roster_associate.phantom_indicator,
        roster_associate.payroll_cost_ctr,
        roster_associate.sample_auth,
        roster_associate.oracle_string,
        roster_associate.file_id,
        roster_associate.record_id
 FROM integration.roster_associate
 ORDER BY roster_associate.source_name,
          roster_associate.teva_id,
          roster_associate.hr_id,
          roster_associate.create_user
SEGMENTED BY hash(roster_associate.teva_id, roster_associate.create_date, roster_associate.update_date, roster_associate.hire_date, roster_associate.reports_to, roster_associate.stat_code, roster_associate.type_code, roster_associate.full_time, roster_associate.exempt, roster_associate.hours_per_week, roster_associate.marital_stat, roster_associate.birth_date, roster_associate.country_id, roster_associate.office, roster_associate.language, roster_associate.term_date, roster_associate.last_wrk_date, roster_associate.expense_report_approver, roster_associate.pay_code, roster_associate.ed_code, roster_associate.ed_code_date, roster_associate.job_code, roster_associate.country_citizenship, roster_associate.disabled, roster_associate.vietnam_vet, roster_associate.expense_reporting, roster_associate.check_request_approver, roster_associate.invoice_approver, roster_associate.phantom_indicator, roster_associate.sample_auth, roster_associate.file_id, roster_associate.record_id) ALL NODES;

CREATE PROJECTION integration.roster_associate_audit_b0 /*+basename(roster_associate_audit),createtype(L)*/ 
(
 source_name,
 teva_id,
 hr_id,
 create_user,
 create_date,
 update_user,
 update_date,
 hire_date,
 logon_id,
 reports_to,
 status_code,
 type_code,
 full_time,
 eeo_cat,
 exempt,
 expense_cost_ctr,
 hours_per_week,
 marital_status,
 race,
 email,
 birth_date,
 country_id,
 default_currency_id,
 territory_id,
 office,
 person_sys_id,
 language,
 "position",
 term_date,
 last_work_date,
 auth_limit,
 vehicle,
 vacation_days,
 action_date,
 action,
 check_request_limit,
 expense_report_approver,
 location_code,
 pay_code,
 ed_code,
 ed_code_date,
 job_code,
 country_citizenship,
 disabled,
 vietnam_vet,
 emergency_contact_name,
 emergency_contact_relationship,
 emergency_contact_phone,
 adp_dept_num,
 eeo_cat_hr_updt,
 company_id,
 expense_reporting,
 phantom_indicator,
 check_request_approver,
 invoice_approver,
 vacation_year,
 fin_auth_comments,
 payroll_cost_ctr,
 sample_auth,
 oracle_string,
 file_id,
 record_id
)
AS
 SELECT roster_associate_audit.source_name,
        roster_associate_audit.teva_id,
        roster_associate_audit.hr_id,
        roster_associate_audit.create_user,
        roster_associate_audit.create_date,
        roster_associate_audit.update_user,
        roster_associate_audit.update_date,
        roster_associate_audit.hire_date,
        roster_associate_audit.logon_id,
        roster_associate_audit.reports_to,
        roster_associate_audit.status_code,
        roster_associate_audit.type_code,
        roster_associate_audit.full_time,
        roster_associate_audit.eeo_cat,
        roster_associate_audit.exempt,
        roster_associate_audit.expense_cost_ctr,
        roster_associate_audit.hours_per_week,
        roster_associate_audit.marital_status,
        roster_associate_audit.race,
        roster_associate_audit.email,
        roster_associate_audit.birth_date,
        roster_associate_audit.country_id,
        roster_associate_audit.default_currency_id,
        roster_associate_audit.territory_id,
        roster_associate_audit.office,
        roster_associate_audit.person_sys_id,
        roster_associate_audit.language,
        roster_associate_audit."position",
        roster_associate_audit.term_date,
        roster_associate_audit.last_work_date,
        roster_associate_audit.auth_limit,
        roster_associate_audit.vehicle,
        roster_associate_audit.vacation_days,
        roster_associate_audit.action_date,
        roster_associate_audit.action,
        roster_associate_audit.check_request_limit,
        roster_associate_audit.expense_report_approver,
        roster_associate_audit.location_code,
        roster_associate_audit.pay_code,
        roster_associate_audit.ed_code,
        roster_associate_audit.ed_code_date,
        roster_associate_audit.job_code,
        roster_associate_audit.country_citizenship,
        roster_associate_audit.disabled,
        roster_associate_audit.vietnam_vet,
        roster_associate_audit.emergency_contact_name,
        roster_associate_audit.emergency_contact_relationship,
        roster_associate_audit.emergency_contact_phone,
        roster_associate_audit.adp_dept_num,
        roster_associate_audit.eeo_cat_hr_updt,
        roster_associate_audit.company_id,
        roster_associate_audit.expense_reporting,
        roster_associate_audit.phantom_indicator,
        roster_associate_audit.check_request_approver,
        roster_associate_audit.invoice_approver,
        roster_associate_audit.vacation_year,
        roster_associate_audit.fin_auth_comments,
        roster_associate_audit.payroll_cost_ctr,
        roster_associate_audit.sample_auth,
        roster_associate_audit.oracle_string,
        roster_associate_audit.file_id,
        roster_associate_audit.record_id
 FROM integration.roster_associate_audit
 ORDER BY roster_associate_audit.source_name,
          roster_associate_audit.teva_id,
          roster_associate_audit.hr_id,
          roster_associate_audit.create_user
SEGMENTED BY hash(roster_associate_audit.teva_id, roster_associate_audit.create_date, roster_associate_audit.update_date, roster_associate_audit.hire_date, roster_associate_audit.reports_to, roster_associate_audit.status_code, roster_associate_audit.type_code, roster_associate_audit.full_time, roster_associate_audit.exempt, roster_associate_audit.hours_per_week, roster_associate_audit.marital_status, roster_associate_audit.birth_date, roster_associate_audit.country_id, roster_associate_audit.office, roster_associate_audit.language, roster_associate_audit.term_date, roster_associate_audit.last_work_date, roster_associate_audit.auth_limit, roster_associate_audit.vacation_days, roster_associate_audit.action_date, roster_associate_audit.check_request_limit, roster_associate_audit.expense_report_approver, roster_associate_audit.pay_code, roster_associate_audit.ed_code, roster_associate_audit.job_code, roster_associate_audit.country_citizenship, roster_associate_audit.disabled, roster_associate_audit.vietnam_vet, roster_associate_audit.expense_reporting, roster_associate_audit.phantom_indicator, roster_associate_audit.check_request_approver, roster_associate_audit.invoice_approver) ALL NODES;

CREATE PROJECTION integration.roster_job_title_b0 /*+basename(roster_job_title),createtype(L)*/ 
(
 source_name,
 job_code,
 code_desc,
 adp_job_code,
 create_date,
 create_user,
 update_date,
 update_user,
 display_sequence,
 company_id,
 effective_date,
 expiration_date,
 file_id,
 record_id
)
AS
 SELECT roster_job_title.source_name,
        roster_job_title.job_code,
        roster_job_title.code_desc,
        roster_job_title.adp_job_code,
        roster_job_title.create_date,
        roster_job_title.create_user,
        roster_job_title.update_date,
        roster_job_title.update_user,
        roster_job_title.display_sequence,
        roster_job_title.company_id,
        roster_job_title.effective_date,
        roster_job_title.expiration_date,
        roster_job_title.file_id,
        roster_job_title.record_id
 FROM integration.roster_job_title
 ORDER BY roster_job_title.source_name,
          roster_job_title.job_code,
          roster_job_title.code_desc,
          roster_job_title.adp_job_code
SEGMENTED BY hash(roster_job_title.job_code, roster_job_title.adp_job_code, roster_job_title.create_date, roster_job_title.update_date, roster_job_title.effective_date, roster_job_title.expiration_date, roster_job_title.file_id, roster_job_title.record_id, roster_job_title.company_id, roster_job_title.create_user, roster_job_title.update_user, roster_job_title.code_desc, roster_job_title.display_sequence) ALL NODES;

CREATE PROJECTION integration.roster_leave_of_absence_b0 /*+basename(roster_leave_of_absence),createtype(L)*/ 
(
 source_name,
 file_number,
 name,
 job_title,
 cost_center_name,
 department,
 ee_status,
 leave_date,
 return_date,
 leave_days,
 file_id,
 record_id
)
AS
 SELECT roster_leave_of_absence.source_name,
        roster_leave_of_absence.file_number,
        roster_leave_of_absence.name,
        roster_leave_of_absence.job_title,
        roster_leave_of_absence.cost_center_name,
        roster_leave_of_absence.department,
        roster_leave_of_absence.ee_status,
        roster_leave_of_absence.leave_date,
        roster_leave_of_absence.return_date,
        roster_leave_of_absence.leave_days,
        roster_leave_of_absence.file_id,
        roster_leave_of_absence.record_id
 FROM integration.roster_leave_of_absence
 ORDER BY roster_leave_of_absence.file_number,
          roster_leave_of_absence.name,
          roster_leave_of_absence.job_title,
          roster_leave_of_absence.cost_center_name,
          roster_leave_of_absence.department,
          roster_leave_of_absence.ee_status,
          roster_leave_of_absence.leave_date,
          roster_leave_of_absence.return_date,
          roster_leave_of_absence.leave_days,
          roster_leave_of_absence.file_id,
          roster_leave_of_absence.record_id
SEGMENTED BY hash(roster_leave_of_absence.file_number, roster_leave_of_absence.leave_date, roster_leave_of_absence.return_date, roster_leave_of_absence.leave_days, roster_leave_of_absence.file_id, roster_leave_of_absence.record_id, roster_leave_of_absence.job_title, roster_leave_of_absence.department, roster_leave_of_absence.ee_status, roster_leave_of_absence.cost_center_name, roster_leave_of_absence.name) ALL NODES;

CREATE PROJECTION integration.roster_people_b0 /*+basename(roster_people),createtype(L)*/ 
(
 source_name,
 system_id,
 create_date,
 create_user,
 update_date,
 update_user,
 last_name,
 first_name,
 status_code,
 gender,
 middle_name,
 name_suffix,
 person_title,
 prof_title,
 email,
 pref_name,
 previous_last_name,
 file_id,
 record_id
)
AS
 SELECT roster_people.source_name,
        roster_people.system_id,
        roster_people.create_date,
        roster_people.create_user,
        roster_people.update_date,
        roster_people.update_user,
        roster_people.last_name,
        roster_people.first_name,
        roster_people.status_code,
        roster_people.gender,
        roster_people.middle_name,
        roster_people.name_suffix,
        roster_people.person_title,
        roster_people.prof_title,
        roster_people.email,
        roster_people.pref_name,
        roster_people.previous_last_name,
        roster_people.file_id,
        roster_people.record_id
 FROM integration.roster_people
 ORDER BY roster_people.system_id
SEGMENTED BY hash(roster_people.create_date, roster_people.update_date, roster_people.status_code, roster_people.gender, roster_people.file_id, roster_people.record_id, roster_people.name_suffix, roster_people.person_title, roster_people.prof_title, roster_people.create_user, roster_people.update_user, roster_people.last_name, roster_people.first_name, roster_people.middle_name, roster_people.pref_name, roster_people.previous_last_name, roster_people.system_id, roster_people.email) ALL NODES;

CREATE PROJECTION integration.roster_people_address_b0 /*+basename(roster_people_address),createtype(L)*/ 
(
 source_name,
 person_sys_id,
 address_id,
 atd_code,
 priority,
 mail_stop,
 eff_date,
 end_date,
 file_id,
 record_id
)
AS
 SELECT roster_people_address.source_name,
        roster_people_address.person_sys_id,
        roster_people_address.address_id,
        roster_people_address.atd_code,
        roster_people_address.priority,
        roster_people_address.mail_stop,
        roster_people_address.eff_date,
        roster_people_address.end_date,
        roster_people_address.file_id,
        roster_people_address.record_id
 FROM integration.roster_people_address
 ORDER BY roster_people_address.person_sys_id,
          roster_people_address.address_id,
          roster_people_address.atd_code,
          roster_people_address.priority,
          roster_people_address.mail_stop
SEGMENTED BY hash(roster_people_address.atd_code, roster_people_address.eff_date, roster_people_address.end_date, roster_people_address.file_id, roster_people_address.record_id, roster_people_address.mail_stop, roster_people_address.person_sys_id, roster_people_address.address_id, roster_people_address.priority) ALL NODES;

CREATE PROJECTION integration.roster_people_phone_b0 /*+basename(roster_people_phone),createtype(L)*/ 
(
 source_name,
 person_sys_id,
 phone_id,
 ptd_code,
 priority,
 ext,
 vmail,
 address_id,
 provider_code,
 file_id,
 record_id
)
AS
 SELECT roster_people_phone.source_name,
        roster_people_phone.person_sys_id,
        roster_people_phone.phone_id,
        roster_people_phone.ptd_code,
        roster_people_phone.priority,
        roster_people_phone.ext,
        roster_people_phone.vmail,
        roster_people_phone.address_id,
        roster_people_phone.provider_code,
        roster_people_phone.file_id,
        roster_people_phone.record_id
 FROM integration.roster_people_phone
 ORDER BY roster_people_phone.person_sys_id,
          roster_people_phone.phone_id,
          roster_people_phone.ptd_code,
          roster_people_phone.priority,
          roster_people_phone.ext,
          roster_people_phone.vmail,
          roster_people_phone.address_id,
          roster_people_phone.provider_code
SEGMENTED BY hash(roster_people_phone.ptd_code, roster_people_phone.provider_code, roster_people_phone.file_id, roster_people_phone.record_id, roster_people_phone.person_sys_id, roster_people_phone.phone_id, roster_people_phone.priority, roster_people_phone.ext, roster_people_phone.vmail, roster_people_phone.address_id) ALL NODES;

CREATE PROJECTION integration.roster_phone_b0 /*+basename(roster_phone),createtype(L)*/ 
(
 source_name,
 phone_id,
 country_dial_code,
 area_code,
 phone_number,
 create_user,
 create_date,
 update_user,
 update_date,
 file_id,
 record_id
)
AS
 SELECT roster_phone.source_name,
        roster_phone.phone_id,
        roster_phone.country_dial_code,
        roster_phone.area_code,
        roster_phone.phone_number,
        roster_phone.create_user,
        roster_phone.create_date,
        roster_phone.update_user,
        roster_phone.update_date,
        roster_phone.file_id,
        roster_phone.record_id
 FROM integration.roster_phone
 ORDER BY roster_phone.source_name,
          roster_phone.phone_id,
          roster_phone.country_dial_code,
          roster_phone.area_code,
          roster_phone.phone_number,
          roster_phone.create_user
SEGMENTED BY hash(roster_phone.area_code, roster_phone.create_date, roster_phone.update_date, roster_phone.file_id, roster_phone.record_id, roster_phone.create_user, roster_phone.update_user, roster_phone.phone_id, roster_phone.country_dial_code, roster_phone.phone_number) ALL NODES;

CREATE PROJECTION integration.roster_salesperson_b0 /*+basename(roster_salesperson),createtype(L)*/ 
(
 source_name,
 file_number,
 name,
 job_title,
 cost_center_name,
 department,
 job_entry_date,
 manager_level,
 ee_status,
 work_location,
 work_location_name,
 orig_hire_date,
 service_date,
 rehire_date,
 termination_date,
 direct_manager,
 home_address_line1,
 home_address_line2,
 home_city,
 home_state,
 home_postal_code,
 home_phone,
 cell_phone,
 email_address,
 file_id,
 record_id
)
AS
 SELECT roster_salesperson.source_name,
        roster_salesperson.file_number,
        roster_salesperson.name,
        roster_salesperson.job_title,
        roster_salesperson.cost_center_name,
        roster_salesperson.department,
        roster_salesperson.job_entry_date,
        roster_salesperson.manager_level,
        roster_salesperson.ee_status,
        roster_salesperson.work_location,
        roster_salesperson.work_location_name,
        roster_salesperson.orig_hire_date,
        roster_salesperson.service_date,
        roster_salesperson.rehire_date,
        roster_salesperson.termination_date,
        roster_salesperson.direct_manager,
        roster_salesperson.home_address_line1,
        roster_salesperson.home_address_line2,
        roster_salesperson.home_city,
        roster_salesperson.home_state,
        roster_salesperson.home_postal_code,
        roster_salesperson.home_phone,
        roster_salesperson.cell_phone,
        roster_salesperson.email_address,
        roster_salesperson.file_id,
        roster_salesperson.record_id
 FROM integration.roster_salesperson
 ORDER BY roster_salesperson.source_name,
          roster_salesperson.file_number,
          roster_salesperson.name,
          roster_salesperson.job_title,
          roster_salesperson.cost_center_name,
          roster_salesperson.department,
          roster_salesperson.job_entry_date,
          roster_salesperson.manager_level,
          roster_salesperson.ee_status,
          roster_salesperson.work_location,
          roster_salesperson.work_location_name,
          roster_salesperson.orig_hire_date,
          roster_salesperson.service_date,
          roster_salesperson.rehire_date,
          roster_salesperson.termination_date,
          roster_salesperson.direct_manager,
          roster_salesperson.home_address_line1,
          roster_salesperson.home_address_line2,
          roster_salesperson.home_city,
          roster_salesperson.home_state,
          roster_salesperson.home_postal_code,
          roster_salesperson.home_phone,
          roster_salesperson.cell_phone,
          roster_salesperson.email_address,
          roster_salesperson.file_id,
          roster_salesperson.record_id
SEGMENTED BY hash(roster_salesperson.record_id) ALL NODES;

CREATE PROJECTION integration.roster_territory_b0 /*+basename(roster_territory),createtype(L)*/ 
(
 source_name,
 territory_id,
 name,
 desc_text,
 company_code,
 territory_type,
 team,
 sample_dist,
 comments,
 fleet_elig,
 rep_type,
 file_id,
 record_id
)
AS
 SELECT roster_territory.source_name,
        roster_territory.territory_id,
        roster_territory.name,
        roster_territory.desc_text,
        roster_territory.company_code,
        roster_territory.territory_type,
        roster_territory.team,
        roster_territory.sample_dist,
        roster_territory.comments,
        roster_territory.fleet_elig,
        roster_territory.rep_type,
        roster_territory.file_id,
        roster_territory.record_id
 FROM integration.roster_territory
 ORDER BY roster_territory.source_name,
          roster_territory.territory_id,
          roster_territory.name,
          roster_territory.desc_text,
          roster_territory.company_code,
          roster_territory.territory_type,
          roster_territory.team,
          roster_territory.sample_dist,
          roster_territory.comments,
          roster_territory.fleet_elig,
          roster_territory.rep_type
SEGMENTED BY hash(roster_territory.sample_dist, roster_territory.fleet_elig, roster_territory.rep_type, roster_territory.file_id, roster_territory.record_id, roster_territory.company_code, roster_territory.territory_type, roster_territory.team, roster_territory.comments, roster_territory.territory_id, roster_territory.name, roster_territory.desc_text) ALL NODES;

CREATE PROJECTION integration.roster_territory_change_b0 /*+basename(roster_territory_change),createtype(L)*/ 
(
 source_name,
 ee_number,
 ee_name,
 territory_id_from,
 territory_id_to,
 territory_move_date,
 file_id,
 record_id
)
AS
 SELECT roster_territory_change.source_name,
        roster_territory_change.ee_number,
        roster_territory_change.ee_name,
        roster_territory_change.territory_id_from,
        roster_territory_change.territory_id_to,
        roster_territory_change.territory_move_date,
        roster_territory_change.file_id,
        roster_territory_change.record_id
 FROM integration.roster_territory_change
 ORDER BY roster_territory_change.source_name,
          roster_territory_change.ee_number,
          roster_territory_change.ee_name,
          roster_territory_change.territory_id_from,
          roster_territory_change.territory_id_to,
          roster_territory_change.territory_move_date,
          roster_territory_change.file_id,
          roster_territory_change.record_id
SEGMENTED BY hash(roster_territory_change.record_id) ALL NODES;

CREATE PROJECTION integration.cmop_rx_b0 /*+basename(cmop_rx)*/ 
(
 source_name,
 data_month,
 cmop,
 visn,
 station_number,
 station,
 va_product,
 total_rxs,
 cmop_rxs,
 total_quantity,
 cmop_quantity,
 rxs_30_days,
 zip,
 id,
 file_id,
 record_id
)
AS
 SELECT cmop_rx.source_name,
        cmop_rx.data_month,
        cmop_rx.cmop,
        cmop_rx.visn,
        cmop_rx.station_number,
        cmop_rx.station,
        cmop_rx.va_product,
        cmop_rx.total_rxs,
        cmop_rx.cmop_rxs,
        cmop_rx.total_quantity,
        cmop_rx.cmop_quantity,
        cmop_rx.rxs_30_days,
        cmop_rx.zip,
        cmop_rx.id,
        cmop_rx.file_id,
        cmop_rx.record_id
 FROM integration.cmop_rx
 ORDER BY cmop_rx.source_name,
          cmop_rx.data_month,
          cmop_rx.cmop,
          cmop_rx.visn,
          cmop_rx.station_number,
          cmop_rx.station,
          cmop_rx.va_product,
          cmop_rx.total_rxs,
          cmop_rx.cmop_rxs,
          cmop_rx.total_quantity,
          cmop_rx.cmop_quantity,
          cmop_rx.rxs_30_days,
          cmop_rx.zip,
          cmop_rx.id,
          cmop_rx.file_id,
          cmop_rx.record_id
SEGMENTED BY hash(cmop_rx.record_id) ALL NODES;

CREATE PROJECTION integration.specialty_pharmacy_shipment_summary_b0 /*+basename(specialty_pharmacy_shipment_summary),createtype(L)*/ 
(
 source_name,
 ship_date,
 full_name,
 specialty,
 rank,
 total,
 aubagio_14,
 aubagio_7,
 avonex_30,
 avonex_pack,
 avonex_pen_pack,
 betaseron,
 copaxone_20,
 copaxone_40,
 gilenya_0_5,
 glatopa_20,
 lemtrada,
 plegridy_pfs,
 plegridy_pen,
 rebif_22_rebidose,
 rebif_22,
 rebif_44,
 rebif_44_rebidose,
 rebif_pack,
 rebif_pack_rebidose,
 tecfidera_120,
 tecfidera_240,
 tecfidera_starter_pack,
 tysabri,
 md_addr1,
 md_addr2,
 md_city,
 md_state,
 md_zip,
 prescriber_npi,
 dnc_flag,
 record_id,
 file_id,
 gilenya_0_5_2x14,
 gilenya_0_5_1x7,
 glatiramer_acetate_20,
 glatiramer_acetate_40,
 zinbryta_150
)
AS
 SELECT specialty_pharmacy_shipment_summary.source_name,
        specialty_pharmacy_shipment_summary.ship_date,
        specialty_pharmacy_shipment_summary.full_name,
        specialty_pharmacy_shipment_summary.specialty,
        specialty_pharmacy_shipment_summary.rank,
        specialty_pharmacy_shipment_summary.total,
        specialty_pharmacy_shipment_summary.aubagio_14,
        specialty_pharmacy_shipment_summary.aubagio_7,
        specialty_pharmacy_shipment_summary.avonex_30,
        specialty_pharmacy_shipment_summary.avonex_pack,
        specialty_pharmacy_shipment_summary.avonex_pen_pack,
        specialty_pharmacy_shipment_summary.betaseron,
        specialty_pharmacy_shipment_summary.copaxone_20,
        specialty_pharmacy_shipment_summary.copaxone_40,
        specialty_pharmacy_shipment_summary.gilenya_0_5,
        specialty_pharmacy_shipment_summary.glatopa_20,
        specialty_pharmacy_shipment_summary.lemtrada,
        specialty_pharmacy_shipment_summary.plegridy_pfs,
        specialty_pharmacy_shipment_summary.plegridy_pen,
        specialty_pharmacy_shipment_summary.rebif_22_rebidose,
        specialty_pharmacy_shipment_summary.rebif_22,
        specialty_pharmacy_shipment_summary.rebif_44,
        specialty_pharmacy_shipment_summary.rebif_44_rebidose,
        specialty_pharmacy_shipment_summary.rebif_pack,
        specialty_pharmacy_shipment_summary.rebif_pack_rebidose,
        specialty_pharmacy_shipment_summary.tecfidera_120,
        specialty_pharmacy_shipment_summary.tecfidera_240,
        specialty_pharmacy_shipment_summary.tecfidera_starter_pack,
        specialty_pharmacy_shipment_summary.tysabri,
        specialty_pharmacy_shipment_summary.md_addr1,
        specialty_pharmacy_shipment_summary.md_addr2,
        specialty_pharmacy_shipment_summary.md_city,
        specialty_pharmacy_shipment_summary.md_state,
        specialty_pharmacy_shipment_summary.md_zip,
        specialty_pharmacy_shipment_summary.prescriber_npi,
        specialty_pharmacy_shipment_summary.dnc_flag,
        specialty_pharmacy_shipment_summary.record_id,
        specialty_pharmacy_shipment_summary.file_id,
        specialty_pharmacy_shipment_summary.gilenya_0_5_2x14,
        specialty_pharmacy_shipment_summary.gilenya_0_5_1x7,
        specialty_pharmacy_shipment_summary.glatiramer_acetate_20,
        specialty_pharmacy_shipment_summary.glatiramer_acetate_40,
        specialty_pharmacy_shipment_summary.zinbryta_150
 FROM integration.specialty_pharmacy_shipment_summary
 ORDER BY specialty_pharmacy_shipment_summary.source_name,
          specialty_pharmacy_shipment_summary.ship_date,
          specialty_pharmacy_shipment_summary.full_name,
          specialty_pharmacy_shipment_summary.specialty,
          specialty_pharmacy_shipment_summary.rank,
          specialty_pharmacy_shipment_summary.total,
          specialty_pharmacy_shipment_summary.aubagio_14,
          specialty_pharmacy_shipment_summary.aubagio_7,
          specialty_pharmacy_shipment_summary.avonex_30,
          specialty_pharmacy_shipment_summary.avonex_pack,
          specialty_pharmacy_shipment_summary.avonex_pen_pack,
          specialty_pharmacy_shipment_summary.betaseron,
          specialty_pharmacy_shipment_summary.copaxone_20,
          specialty_pharmacy_shipment_summary.copaxone_40,
          specialty_pharmacy_shipment_summary.gilenya_0_5,
          specialty_pharmacy_shipment_summary.glatopa_20,
          specialty_pharmacy_shipment_summary.lemtrada,
          specialty_pharmacy_shipment_summary.plegridy_pfs,
          specialty_pharmacy_shipment_summary.plegridy_pen,
          specialty_pharmacy_shipment_summary.rebif_22_rebidose,
          specialty_pharmacy_shipment_summary.rebif_22,
          specialty_pharmacy_shipment_summary.rebif_44,
          specialty_pharmacy_shipment_summary.rebif_44_rebidose,
          specialty_pharmacy_shipment_summary.rebif_pack,
          specialty_pharmacy_shipment_summary.rebif_pack_rebidose,
          specialty_pharmacy_shipment_summary.tecfidera_120,
          specialty_pharmacy_shipment_summary.tecfidera_240,
          specialty_pharmacy_shipment_summary.tecfidera_starter_pack,
          specialty_pharmacy_shipment_summary.tysabri,
          specialty_pharmacy_shipment_summary.md_addr1,
          specialty_pharmacy_shipment_summary.md_addr2,
          specialty_pharmacy_shipment_summary.md_city,
          specialty_pharmacy_shipment_summary.md_state,
          specialty_pharmacy_shipment_summary.md_zip,
          specialty_pharmacy_shipment_summary.prescriber_npi,
          specialty_pharmacy_shipment_summary.dnc_flag,
          specialty_pharmacy_shipment_summary.record_id,
          specialty_pharmacy_shipment_summary.file_id
SEGMENTED BY hash(specialty_pharmacy_shipment_summary.record_id) ALL NODES;

CREATE PROJECTION integration.specialty_pharmacy_enrollment_b0 /*+basename(specialty_pharmacy_enrollment),createtype(L)*/ 
(
 source_name,
 patient_id,
 rx_received_date,
 insurance_information,
 most_recent_cml_treatment,
 date_of_discontinuation,
 reason_for_discontinuation,
 physician_last_name,
 physician_first_name,
 physician_address,
 physician_city,
 physician_state,
 physician_zip,
 file_id,
 record_id,
 brand_name
)
AS
 SELECT specialty_pharmacy_enrollment.source_name,
        specialty_pharmacy_enrollment.patient_id,
        specialty_pharmacy_enrollment.rx_received_date,
        specialty_pharmacy_enrollment.insurance_information,
        specialty_pharmacy_enrollment.most_recent_cml_treatment,
        specialty_pharmacy_enrollment.date_of_discontinuation,
        specialty_pharmacy_enrollment.reason_for_discontinuation,
        specialty_pharmacy_enrollment.physician_last_name,
        specialty_pharmacy_enrollment.physician_first_name,
        specialty_pharmacy_enrollment.physician_address,
        specialty_pharmacy_enrollment.physician_city,
        specialty_pharmacy_enrollment.physician_state,
        specialty_pharmacy_enrollment.physician_zip,
        specialty_pharmacy_enrollment.file_id,
        specialty_pharmacy_enrollment.record_id,
        specialty_pharmacy_enrollment.brand_name
 FROM integration.specialty_pharmacy_enrollment
 ORDER BY specialty_pharmacy_enrollment.source_name,
          specialty_pharmacy_enrollment.patient_id,
          specialty_pharmacy_enrollment.rx_received_date,
          specialty_pharmacy_enrollment.insurance_information,
          specialty_pharmacy_enrollment.most_recent_cml_treatment,
          specialty_pharmacy_enrollment.date_of_discontinuation,
          specialty_pharmacy_enrollment.reason_for_discontinuation,
          specialty_pharmacy_enrollment.physician_last_name,
          specialty_pharmacy_enrollment.physician_first_name,
          specialty_pharmacy_enrollment.physician_address,
          specialty_pharmacy_enrollment.physician_city,
          specialty_pharmacy_enrollment.physician_state,
          specialty_pharmacy_enrollment.physician_zip,
          specialty_pharmacy_enrollment.file_id,
          specialty_pharmacy_enrollment.record_id
SEGMENTED BY hash(specialty_pharmacy_enrollment.rx_received_date, specialty_pharmacy_enrollment.date_of_discontinuation, specialty_pharmacy_enrollment.physician_state, specialty_pharmacy_enrollment.file_id, specialty_pharmacy_enrollment.record_id, specialty_pharmacy_enrollment.physician_zip, specialty_pharmacy_enrollment.patient_id, specialty_pharmacy_enrollment.insurance_information, specialty_pharmacy_enrollment.most_recent_cml_treatment, specialty_pharmacy_enrollment.reason_for_discontinuation, specialty_pharmacy_enrollment.physician_last_name, specialty_pharmacy_enrollment.physician_first_name, specialty_pharmacy_enrollment.physician_city, specialty_pharmacy_enrollment.physician_address, specialty_pharmacy_enrollment.source_name) ALL NODES;

CREATE PROJECTION integration.chargebacks_b0 /*+basename(chargebacks),createtype(L)*/ 
(
 source_name,
 account_id,
 location_id,
 shipment_date,
 ndc_code,
 product_name,
 contract_id,
 chargeback_quantity,
 chargeback_amount,
 receipt_date,
 debit_memo_number,
 credit_memo_date,
 credit_memo_number,
 settlement_date,
 contract_price,
 file_id,
 record_id
)
AS
 SELECT chargebacks.source_name,
        chargebacks.account_id,
        chargebacks.location_id,
        chargebacks.shipment_date,
        chargebacks.ndc_code,
        chargebacks.product_name,
        chargebacks.contract_id,
        chargebacks.chargeback_quantity,
        chargebacks.chargeback_amount,
        chargebacks.receipt_date,
        chargebacks.debit_memo_number,
        chargebacks.credit_memo_date,
        chargebacks.credit_memo_number,
        chargebacks.settlement_date,
        chargebacks.contract_price,
        chargebacks.file_id,
        chargebacks.record_id
 FROM integration.chargebacks
 ORDER BY chargebacks.source_name,
          chargebacks.account_id,
          chargebacks.location_id,
          chargebacks.shipment_date,
          chargebacks.ndc_code,
          chargebacks.product_name,
          chargebacks.contract_id,
          chargebacks.chargeback_quantity,
          chargebacks.chargeback_amount,
          chargebacks.receipt_date,
          chargebacks.debit_memo_number,
          chargebacks.credit_memo_date,
          chargebacks.credit_memo_number,
          chargebacks.settlement_date,
          chargebacks.contract_price,
          chargebacks.file_id,
          chargebacks.record_id
SEGMENTED BY hash(chargebacks.shipment_date, chargebacks.receipt_date, chargebacks.credit_memo_date, chargebacks.settlement_date, chargebacks.file_id, chargebacks.record_id, chargebacks.chargeback_quantity, chargebacks.chargeback_amount, chargebacks.contract_price, chargebacks.ndc_code, chargebacks.debit_memo_number, chargebacks.credit_memo_number, chargebacks.account_id, chargebacks.location_id, chargebacks.product_name, chargebacks.contract_id) ALL NODES;

CREATE PROJECTION integration.dynamic_segment_b0 /*+basename(dynamic_segment),createtype(L)*/ 
(
 federation_id,
 basket_id,
 segment_name,
 segment_value,
 file_id,
 record_id
)
AS
 SELECT dynamic_segment.federation_id,
        dynamic_segment.basket_id,
        dynamic_segment.segment_name,
        dynamic_segment.segment_value,
        dynamic_segment.file_id,
        dynamic_segment.record_id
 FROM integration.dynamic_segment
 ORDER BY dynamic_segment.federation_id
SEGMENTED BY hash(dynamic_segment.federation_id) ALL NODES;

CREATE PROJECTION integration.activity_line_item_b0 /*+basename(activity_line_item),createtype(L)*/ 
(
 line_item_id,
 brand_name,
 activity,
 line_item_datetime,
 line_item_previous_item,
 line_item_trackback_id,
 line_item_details,
 line_item_type_name,
 line_item_native_type,
 file_id,
 record_id
)
AS
 SELECT activity_line_item.line_item_id,
        activity_line_item.brand_name,
        activity_line_item.activity,
        activity_line_item.line_item_datetime,
        activity_line_item.line_item_previous_item,
        activity_line_item.line_item_trackback_id,
        activity_line_item.line_item_details,
        activity_line_item.line_item_type_name,
        activity_line_item.line_item_native_type,
        activity_line_item.file_id,
        activity_line_item.record_id
 FROM integration.activity_line_item
 ORDER BY activity_line_item.line_item_id
SEGMENTED BY hash(activity_line_item.line_item_id) ALL NODES;

CREATE PROJECTION integration.activity_b0 /*+basename(activity),createtype(L)*/ 
(
 activity_id,
 federation_id,
 contact,
 source_name,
 "datetime",
 trackback_id,
 previous_activity,
 level_name,
 activity_role_name,
 type_name,
 native_type,
 details,
 file_id,
 record_id,
 basket_id,
 web_url
)
AS
 SELECT activity.activity_id,
        activity.federation_id,
        activity.contact,
        activity.source_name,
        activity."datetime",
        activity.trackback_id,
        activity.previous_activity,
        activity.level_name,
        activity.activity_role_name,
        activity.type_name,
        activity.native_type,
        activity.details,
        activity.file_id,
        activity.record_id,
        activity.basket_id,
        activity.web_url
 FROM integration.activity
 ORDER BY activity.activity_id
SEGMENTED BY hash(activity.activity_id) ALL NODES;

CREATE PROJECTION integration.aggregated_activity_b0 /*+basename(aggregated_activity),createtype(L)*/ 
(
 aggregated_id,
 level_name,
 federation_id,
 source_name,
 contact,
 originating_id,
 prior_activity,
 activity_role_name,
 count,
 aggregated_type_name,
 file_id,
 record_id
)
AS
 SELECT aggregated_activity.aggregated_id,
        aggregated_activity.level_name,
        aggregated_activity.federation_id,
        aggregated_activity.source_name,
        aggregated_activity.contact,
        aggregated_activity.originating_id,
        aggregated_activity.prior_activity,
        aggregated_activity.activity_role_name,
        aggregated_activity.count,
        aggregated_activity.aggregated_type_name,
        aggregated_activity.file_id,
        aggregated_activity.record_id
 FROM integration.aggregated_activity
 ORDER BY aggregated_activity.aggregated_id
SEGMENTED BY hash(aggregated_activity.aggregated_id) ALL NODES;

CREATE PROJECTION integration.prognos_syndicated_trigger_report_b0 /*+basename(prognos_syndicated_trigger_report),createtype(L)*/ 
(
 week_end_date,
 practice_name,
 practice_address_line_1,
 practice_address_line_2,
 city,
 state,
 zip_code,
 provider_first_name,
 provider_last_name,
 npi,
 specialty_1,
 specialty_2,
 total_cml_patients_with_poor_response_to_treatment,
 file_id,
 record_id,
 product_name,
 pts_with_moderate_severe_asthma_and_eosinophils_0_149,
 pts_with_moderate_severe_asthma_and_eosinophils_150_399,
 pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
 pts_with_ao_asthma_and_eosinophils_0_149,
 pts_with_ao_asthma_and_eosinophils_150_399,
 pts_with_ao_asthma_and_eosinophils_400_or_greater,
 pts_with_moderate_severe_asthma_and_has_eosinophils_300_499,
 pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater
)
AS
 SELECT prognos_syndicated_trigger_report.week_end_date,
        prognos_syndicated_trigger_report.practice_name,
        prognos_syndicated_trigger_report.practice_address_line_1,
        prognos_syndicated_trigger_report.practice_address_line_2,
        prognos_syndicated_trigger_report.city,
        prognos_syndicated_trigger_report.state,
        prognos_syndicated_trigger_report.zip_code,
        prognos_syndicated_trigger_report.provider_first_name,
        prognos_syndicated_trigger_report.provider_last_name,
        prognos_syndicated_trigger_report.npi,
        prognos_syndicated_trigger_report.specialty_1,
        prognos_syndicated_trigger_report.specialty_2,
        prognos_syndicated_trigger_report.total_cml_patients_with_poor_response_to_treatment,
        prognos_syndicated_trigger_report.file_id,
        prognos_syndicated_trigger_report.record_id,
        prognos_syndicated_trigger_report.product_name,
        prognos_syndicated_trigger_report.pts_with_moderate_severe_asthma_and_eosinophils_0_149,
        prognos_syndicated_trigger_report.pts_with_moderate_severe_asthma_and_eosinophils_150_399,
        prognos_syndicated_trigger_report.pts_with_moderate_severe_asthma_and_eosinophils_400_or_greater,
        prognos_syndicated_trigger_report.pts_with_ao_asthma_and_eosinophils_0_149,
        prognos_syndicated_trigger_report.pts_with_ao_asthma_and_eosinophils_150_399,
        prognos_syndicated_trigger_report.pts_with_ao_asthma_and_eosinophils_400_or_greater,
        prognos_syndicated_trigger_report.pts_with_moderate_severe_asthma_and_has_eosinophils_300_499,
        prognos_syndicated_trigger_report.pts_with_moderate_severe_asthma_and_has_eosinophils_500_or_greater
 FROM integration.prognos_syndicated_trigger_report
 ORDER BY prognos_syndicated_trigger_report.week_end_date,
          prognos_syndicated_trigger_report.practice_name,
          prognos_syndicated_trigger_report.practice_address_line_1,
          prognos_syndicated_trigger_report.practice_address_line_2,
          prognos_syndicated_trigger_report.city,
          prognos_syndicated_trigger_report.state,
          prognos_syndicated_trigger_report.zip_code,
          prognos_syndicated_trigger_report.provider_first_name,
          prognos_syndicated_trigger_report.provider_last_name,
          prognos_syndicated_trigger_report.npi,
          prognos_syndicated_trigger_report.specialty_1,
          prognos_syndicated_trigger_report.specialty_2,
          prognos_syndicated_trigger_report.total_cml_patients_with_poor_response_to_treatment,
          prognos_syndicated_trigger_report.record_id
SEGMENTED BY hash(prognos_syndicated_trigger_report.record_id) ALL NODES;

CREATE PROJECTION integration.ahm_unnamedparticipant_b0 /*+basename(ahm_unnamedparticipant),createtype(L)*/ 
(
 sourcesystemid,
 batchid,
 batchdate,
 transactionstatuscode,
 interactionid,
 interactioncode,
 particpantcategoryid,
 categorytype,
 totalattendedcount,
 totalmealconsumedcount,
 record_id,
 file_id
)
AS
 SELECT ahm_unnamedparticipant.sourcesystemid,
        ahm_unnamedparticipant.batchid,
        ahm_unnamedparticipant.batchdate,
        ahm_unnamedparticipant.transactionstatuscode,
        ahm_unnamedparticipant.interactionid,
        ahm_unnamedparticipant.interactioncode,
        ahm_unnamedparticipant.particpantcategoryid,
        ahm_unnamedparticipant.categorytype,
        ahm_unnamedparticipant.totalattendedcount,
        ahm_unnamedparticipant.totalmealconsumedcount,
        ahm_unnamedparticipant.record_id,
        ahm_unnamedparticipant.file_id
 FROM integration.ahm_unnamedparticipant
 ORDER BY ahm_unnamedparticipant.sourcesystemid,
          ahm_unnamedparticipant.batchid,
          ahm_unnamedparticipant.batchdate,
          ahm_unnamedparticipant.transactionstatuscode,
          ahm_unnamedparticipant.interactionid,
          ahm_unnamedparticipant.interactioncode,
          ahm_unnamedparticipant.particpantcategoryid,
          ahm_unnamedparticipant.categorytype,
          ahm_unnamedparticipant.totalattendedcount,
          ahm_unnamedparticipant.totalmealconsumedcount,
          ahm_unnamedparticipant.record_id
SEGMENTED BY hash(ahm_unnamedparticipant.record_id) ALL NODES;

CREATE PROJECTION integration.ahm_participant_b0 /*+basename(ahm_participant),createtype(L)*/ 
(
 sourcesystemid,
 batchid,
 batchdate,
 transactionstatuscode,
 interactionid,
 interactioncode,
 participantid,
 clientcustomerid,
 participanttype,
 firstname,
 middlename,
 lastname,
 suffix,
 professionaldesignation,
 primaryspecialty,
 organizationname,
 npinumber,
 addressid,
 clientaddressid,
 addressline1,
 addressline2,
 addressline3,
 addresscity,
 addressstateprovince,
 addresspostalcode,
 addresspostalcodeextension,
 addresscountry,
 region,
 primarystatelicensestate,
 primarystatelicensenumber,
 attended,
 mealconsumed,
 contractid,
 clientcontractid,
 contractname,
 contractcategory,
 contractsubcategory,
 contractclassification,
 contracttier,
 contracteffectivedate,
 contractexpirationdate,
 contracttotalvalue,
 reservedfield1,
 reservedfield2,
 reservedfield3,
 reservedfield4,
 reservedfield5,
 reservedfield6,
 reservedfield7,
 reservedfield8,
 reservedfield9,
 reservedfield10,
 record_id,
 file_id
)
AS
 SELECT ahm_participant.sourcesystemid,
        ahm_participant.batchid,
        ahm_participant.batchdate,
        ahm_participant.transactionstatuscode,
        ahm_participant.interactionid,
        ahm_participant.interactioncode,
        ahm_participant.participantid,
        ahm_participant.clientcustomerid,
        ahm_participant.participanttype,
        ahm_participant.firstname,
        ahm_participant.middlename,
        ahm_participant.lastname,
        ahm_participant.suffix,
        ahm_participant.professionaldesignation,
        ahm_participant.primaryspecialty,
        ahm_participant.organizationname,
        ahm_participant.npinumber,
        ahm_participant.addressid,
        ahm_participant.clientaddressid,
        ahm_participant.addressline1,
        ahm_participant.addressline2,
        ahm_participant.addressline3,
        ahm_participant.addresscity,
        ahm_participant.addressstateprovince,
        ahm_participant.addresspostalcode,
        ahm_participant.addresspostalcodeextension,
        ahm_participant.addresscountry,
        ahm_participant.region,
        ahm_participant.primarystatelicensestate,
        ahm_participant.primarystatelicensenumber,
        ahm_participant.attended,
        ahm_participant.mealconsumed,
        ahm_participant.contractid,
        ahm_participant.clientcontractid,
        ahm_participant.contractname,
        ahm_participant.contractcategory,
        ahm_participant.contractsubcategory,
        ahm_participant.contractclassification,
        ahm_participant.contracttier,
        ahm_participant.contracteffectivedate,
        ahm_participant.contractexpirationdate,
        ahm_participant.contracttotalvalue,
        ahm_participant.reservedfield1,
        ahm_participant.reservedfield2,
        ahm_participant.reservedfield3,
        ahm_participant.reservedfield4,
        ahm_participant.reservedfield5,
        ahm_participant.reservedfield6,
        ahm_participant.reservedfield7,
        ahm_participant.reservedfield8,
        ahm_participant.reservedfield9,
        ahm_participant.reservedfield10,
        ahm_participant.record_id,
        ahm_participant.file_id
 FROM integration.ahm_participant
 ORDER BY ahm_participant.sourcesystemid,
          ahm_participant.batchid,
          ahm_participant.batchdate,
          ahm_participant.transactionstatuscode,
          ahm_participant.interactionid,
          ahm_participant.interactioncode,
          ahm_participant.participantid,
          ahm_participant.clientcustomerid,
          ahm_participant.participanttype,
          ahm_participant.firstname,
          ahm_participant.middlename,
          ahm_participant.lastname,
          ahm_participant.suffix,
          ahm_participant.professionaldesignation,
          ahm_participant.primaryspecialty,
          ahm_participant.organizationname,
          ahm_participant.npinumber,
          ahm_participant.addressid,
          ahm_participant.clientaddressid,
          ahm_participant.addressline1,
          ahm_participant.addressline2,
          ahm_participant.addressline3,
          ahm_participant.addresscity,
          ahm_participant.addressstateprovince,
          ahm_participant.addresspostalcode,
          ahm_participant.addresspostalcodeextension,
          ahm_participant.addresscountry,
          ahm_participant.region,
          ahm_participant.primarystatelicensestate,
          ahm_participant.primarystatelicensenumber,
          ahm_participant.attended,
          ahm_participant.mealconsumed,
          ahm_participant.contractid,
          ahm_participant.clientcontractid,
          ahm_participant.contractname,
          ahm_participant.contractcategory,
          ahm_participant.contractsubcategory,
          ahm_participant.contractclassification,
          ahm_participant.contracttier,
          ahm_participant.contracteffectivedate,
          ahm_participant.contractexpirationdate,
          ahm_participant.contracttotalvalue,
          ahm_participant.reservedfield1,
          ahm_participant.reservedfield2,
          ahm_participant.reservedfield3,
          ahm_participant.reservedfield4,
          ahm_participant.reservedfield5,
          ahm_participant.reservedfield6,
          ahm_participant.reservedfield7,
          ahm_participant.reservedfield8,
          ahm_participant.reservedfield9,
          ahm_participant.reservedfield10
SEGMENTED BY hash(ahm_participant.batchdate, ahm_participant.transactionstatuscode, ahm_participant.attended, ahm_participant.mealconsumed, ahm_participant.contracteffectivedate, ahm_participant.contractexpirationdate, ahm_participant.contracttotalvalue, ahm_participant.record_id, ahm_participant.file_id, ahm_participant.sourcesystemid, ahm_participant.npinumber, ahm_participant.addresspostalcodeextension, ahm_participant.reservedfield1, ahm_participant.reservedfield2, ahm_participant.reservedfield3, ahm_participant.reservedfield4, ahm_participant.reservedfield5, ahm_participant.reservedfield6, ahm_participant.reservedfield7, ahm_participant.reservedfield8, ahm_participant.reservedfield9, ahm_participant.reservedfield10, ahm_participant.batchid, ahm_participant.interactionid, ahm_participant.participantid, ahm_participant.addressid, ahm_participant.contractid, ahm_participant.addresspostalcode, ahm_participant.interactioncode, ahm_participant.addressstateprovince, ahm_participant.addresscountry, ahm_participant.region) ALL NODES;

CREATE PROJECTION integration.ahm_interactions_b0 /*+basename(ahm_interactions),createtype(L)*/ 
(
 sourcesystemid,
 batchid,
 batchdate,
 transactionstatuscode,
 interactionid,
 interactioncode,
 interactionname,
 interactioncategory,
 interactiontype,
 locationtype,
 interactionstatus,
 interactionstartdate,
 interactionenddate,
 interactionstarttime,
 interactionendtime,
 interactiontimezone,
 interactionstartdatetime,
 interactionenddatetime,
 requestingregion,
 parentinteractionid,
 parentinteractioncode,
 employeeid,
 clientemployeeid,
 employeefirstname,
 employeelastname,
 employeeorganizationunitid,
 employeeorganizationunitcode,
 employeeorganizationunitname,
 venueid,
 clientvenueid,
 venuename,
 venueaddressline1,
 venueaddressline2,
 venueaddressline3,
 venuecity,
 venuestateprovince,
 venuepostalcode,
 venuecountry,
 venueregion,
 totalestimatedparticipantcount,
 financialcloseddate,
 product1name,
 product1id,
 product1clientid,
 topic1name,
 topic1id,
 topic1clientid,
 product2name,
 product2id,
 product2clientid,
 topic2name,
 topic2id,
 topic2clientid,
 product3name,
 product3id,
 product3clientid,
 topic3name,
 topic3id,
 topic3clientid,
 product4name,
 product4id,
 product4clientid,
 topic4name,
 topic4id,
 topic4clientid,
 product5name,
 product5id,
 product5clientid,
 topic5name,
 topic5id,
 topic5clientid,
 reservedfield1,
 reservedfield2,
 reservedfield3,
 reservedfield4,
 reservedfield5,
 reservedfield6,
 reservedfield7,
 reservedfield8,
 reservedfield9,
 reservedfield10,
 record_id,
 file_id
)
AS
 SELECT ahm_interactions.sourcesystemid,
        ahm_interactions.batchid,
        ahm_interactions.batchdate,
        ahm_interactions.transactionstatuscode,
        ahm_interactions.interactionid,
        ahm_interactions.interactioncode,
        ahm_interactions.interactionname,
        ahm_interactions.interactioncategory,
        ahm_interactions.interactiontype,
        ahm_interactions.locationtype,
        ahm_interactions.interactionstatus,
        ahm_interactions.interactionstartdate,
        ahm_interactions.interactionenddate,
        ahm_interactions.interactionstarttime,
        ahm_interactions.interactionendtime,
        ahm_interactions.interactiontimezone,
        ahm_interactions.interactionstartdatetime,
        ahm_interactions.interactionenddatetime,
        ahm_interactions.requestingregion,
        ahm_interactions.parentinteractionid,
        ahm_interactions.parentinteractioncode,
        ahm_interactions.employeeid,
        ahm_interactions.clientemployeeid,
        ahm_interactions.employeefirstname,
        ahm_interactions.employeelastname,
        ahm_interactions.employeeorganizationunitid,
        ahm_interactions.employeeorganizationunitcode,
        ahm_interactions.employeeorganizationunitname,
        ahm_interactions.venueid,
        ahm_interactions.clientvenueid,
        ahm_interactions.venuename,
        ahm_interactions.venueaddressline1,
        ahm_interactions.venueaddressline2,
        ahm_interactions.venueaddressline3,
        ahm_interactions.venuecity,
        ahm_interactions.venuestateprovince,
        ahm_interactions.venuepostalcode,
        ahm_interactions.venuecountry,
        ahm_interactions.venueregion,
        ahm_interactions.totalestimatedparticipantcount,
        ahm_interactions.financialcloseddate,
        ahm_interactions.product1name,
        ahm_interactions.product1id,
        ahm_interactions.product1clientid,
        ahm_interactions.topic1name,
        ahm_interactions.topic1id,
        ahm_interactions.topic1clientid,
        ahm_interactions.product2name,
        ahm_interactions.product2id,
        ahm_interactions.product2clientid,
        ahm_interactions.topic2name,
        ahm_interactions.topic2id,
        ahm_interactions.topic2clientid,
        ahm_interactions.product3name,
        ahm_interactions.product3id,
        ahm_interactions.product3clientid,
        ahm_interactions.topic3name,
        ahm_interactions.topic3id,
        ahm_interactions.topic3clientid,
        ahm_interactions.product4name,
        ahm_interactions.product4id,
        ahm_interactions.product4clientid,
        ahm_interactions.topic4name,
        ahm_interactions.topic4id,
        ahm_interactions.topic4clientid,
        ahm_interactions.product5name,
        ahm_interactions.product5id,
        ahm_interactions.product5clientid,
        ahm_interactions.topic5name,
        ahm_interactions.topic5id,
        ahm_interactions.topic5clientid,
        ahm_interactions.reservedfield1,
        ahm_interactions.reservedfield2,
        ahm_interactions.reservedfield3,
        ahm_interactions.reservedfield4,
        ahm_interactions.reservedfield5,
        ahm_interactions.reservedfield6,
        ahm_interactions.reservedfield7,
        ahm_interactions.reservedfield8,
        ahm_interactions.reservedfield9,
        ahm_interactions.reservedfield10,
        ahm_interactions.record_id,
        ahm_interactions.file_id
 FROM integration.ahm_interactions
 ORDER BY ahm_interactions.sourcesystemid,
          ahm_interactions.batchid,
          ahm_interactions.batchdate,
          ahm_interactions.transactionstatuscode,
          ahm_interactions.interactionid,
          ahm_interactions.interactioncode,
          ahm_interactions.interactionname,
          ahm_interactions.interactioncategory,
          ahm_interactions.interactiontype,
          ahm_interactions.locationtype,
          ahm_interactions.interactionstatus,
          ahm_interactions.interactionstartdate,
          ahm_interactions.interactionenddate,
          ahm_interactions.interactionstarttime,
          ahm_interactions.interactionendtime,
          ahm_interactions.interactiontimezone,
          ahm_interactions.interactionstartdatetime,
          ahm_interactions.interactionenddatetime,
          ahm_interactions.requestingregion,
          ahm_interactions.parentinteractionid,
          ahm_interactions.parentinteractioncode,
          ahm_interactions.employeeid,
          ahm_interactions.clientemployeeid,
          ahm_interactions.employeefirstname,
          ahm_interactions.employeelastname,
          ahm_interactions.employeeorganizationunitid,
          ahm_interactions.employeeorganizationunitcode,
          ahm_interactions.employeeorganizationunitname,
          ahm_interactions.venueid,
          ahm_interactions.clientvenueid,
          ahm_interactions.venuename,
          ahm_interactions.venueaddressline1,
          ahm_interactions.venueaddressline2,
          ahm_interactions.venueaddressline3,
          ahm_interactions.venuecity,
          ahm_interactions.venuestateprovince,
          ahm_interactions.venuepostalcode,
          ahm_interactions.venuecountry,
          ahm_interactions.venueregion,
          ahm_interactions.totalestimatedparticipantcount,
          ahm_interactions.financialcloseddate,
          ahm_interactions.product1name,
          ahm_interactions.product1id,
          ahm_interactions.product1clientid,
          ahm_interactions.topic1name,
          ahm_interactions.topic1id,
          ahm_interactions.topic1clientid,
          ahm_interactions.product2name,
          ahm_interactions.product2id,
          ahm_interactions.product2clientid,
          ahm_interactions.topic2name,
          ahm_interactions.topic2id,
          ahm_interactions.topic2clientid,
          ahm_interactions.product3name,
          ahm_interactions.product3id,
          ahm_interactions.product3clientid,
          ahm_interactions.topic3name,
          ahm_interactions.topic3id,
          ahm_interactions.topic3clientid,
          ahm_interactions.product4name,
          ahm_interactions.product4id,
          ahm_interactions.product4clientid,
          ahm_interactions.topic4name,
          ahm_interactions.topic4id,
          ahm_interactions.topic4clientid,
          ahm_interactions.product5name,
          ahm_interactions.product5id,
          ahm_interactions.product5clientid,
          ahm_interactions.topic5name,
          ahm_interactions.topic5id,
          ahm_interactions.topic5clientid,
          ahm_interactions.reservedfield1,
          ahm_interactions.reservedfield2,
          ahm_interactions.reservedfield3,
          ahm_interactions.reservedfield4,
          ahm_interactions.reservedfield5,
          ahm_interactions.reservedfield6,
          ahm_interactions.reservedfield7,
          ahm_interactions.reservedfield8,
          ahm_interactions.reservedfield9,
          ahm_interactions.reservedfield10,
          ahm_interactions.record_id
SEGMENTED BY hash(ahm_interactions.record_id) ALL NODES;

CREATE PROJECTION integration.ahm_expense_b0 /*+basename(ahm_expense),createtype(L)*/ 
(
 sourcesystemid,
 batchid,
 batchdate,
 transactionstatuscode,
 interactionid,
 interactioncode,
 spendid,
 clientspendid,
 spendamount,
 spendcurrency,
 spenddate,
 spendtype,
 spendpurpose,
 traveldestinationcity,
 traveldestinationstateprovince,
 traveldestinationcountry,
 spenddescription,
 taxincludedindicator,
 taxamount,
 taxrate,
 recipientid,
 clientrecipientid,
 participantid,
 recipientfirstname,
 recipientmiddlename,
 recipientlastname,
 recipientsuffix,
 recipientprofessionaldesignation,
 recipientprimaryspecialty,
 recipientorganizationname,
 recipientnpinumber,
 recipientaddressid,
 recipientclientaddressid,
 recipientaddressline1,
 recipientaddressline2,
 recipientaddressline3,
 recipientaddresscity,
 recipientaddressstateprovince,
 recipientaddresspostalcode,
 recipientaddresspostalcodeextension,
 recipientaddresscountry,
 recipientprimarystatelicensestate,
 recipientprimarystatelicensenumber,
 thirdpartyrecipientindicator,
 thirdpartyrecipientid,
 thirdpartyclientrecipientid,
 thirdpartyrecipientname,
 thirdpartycoveredrecipientindicator,
 paymentid,
 clientpaymentid,
 paymentdate,
 paymentmethod,
 paymentreferencenumber,
 paymentstatus,
 reservedfield1,
 reservedfield2,
 reservedfield3,
 reservedfield4,
 reservedfield5,
 reservedfield6,
 reservedfield7,
 reservedfield8,
 reservedfield9,
 reservedfield10,
 record_id,
 file_id
)
AS
 SELECT ahm_expense.sourcesystemid,
        ahm_expense.batchid,
        ahm_expense.batchdate,
        ahm_expense.transactionstatuscode,
        ahm_expense.interactionid,
        ahm_expense.interactioncode,
        ahm_expense.spendid,
        ahm_expense.clientspendid,
        ahm_expense.spendamount,
        ahm_expense.spendcurrency,
        ahm_expense.spenddate,
        ahm_expense.spendtype,
        ahm_expense.spendpurpose,
        ahm_expense.traveldestinationcity,
        ahm_expense.traveldestinationstateprovince,
        ahm_expense.traveldestinationcountry,
        ahm_expense.spenddescription,
        ahm_expense.taxincludedindicator,
        ahm_expense.taxamount,
        ahm_expense.taxrate,
        ahm_expense.recipientid,
        ahm_expense.clientrecipientid,
        ahm_expense.participantid,
        ahm_expense.recipientfirstname,
        ahm_expense.recipientmiddlename,
        ahm_expense.recipientlastname,
        ahm_expense.recipientsuffix,
        ahm_expense.recipientprofessionaldesignation,
        ahm_expense.recipientprimaryspecialty,
        ahm_expense.recipientorganizationname,
        ahm_expense.recipientnpinumber,
        ahm_expense.recipientaddressid,
        ahm_expense.recipientclientaddressid,
        ahm_expense.recipientaddressline1,
        ahm_expense.recipientaddressline2,
        ahm_expense.recipientaddressline3,
        ahm_expense.recipientaddresscity,
        ahm_expense.recipientaddressstateprovince,
        ahm_expense.recipientaddresspostalcode,
        ahm_expense.recipientaddresspostalcodeextension,
        ahm_expense.recipientaddresscountry,
        ahm_expense.recipientprimarystatelicensestate,
        ahm_expense.recipientprimarystatelicensenumber,
        ahm_expense.thirdpartyrecipientindicator,
        ahm_expense.thirdpartyrecipientid,
        ahm_expense.thirdpartyclientrecipientid,
        ahm_expense.thirdpartyrecipientname,
        ahm_expense.thirdpartycoveredrecipientindicator,
        ahm_expense.paymentid,
        ahm_expense.clientpaymentid,
        ahm_expense.paymentdate,
        ahm_expense.paymentmethod,
        ahm_expense.paymentreferencenumber,
        ahm_expense.paymentstatus,
        ahm_expense.reservedfield1,
        ahm_expense.reservedfield2,
        ahm_expense.reservedfield3,
        ahm_expense.reservedfield4,
        ahm_expense.reservedfield5,
        ahm_expense.reservedfield6,
        ahm_expense.reservedfield7,
        ahm_expense.reservedfield8,
        ahm_expense.reservedfield9,
        ahm_expense.reservedfield10,
        ahm_expense.record_id,
        ahm_expense.file_id
 FROM integration.ahm_expense
 ORDER BY ahm_expense.sourcesystemid,
          ahm_expense.batchid,
          ahm_expense.batchdate,
          ahm_expense.transactionstatuscode,
          ahm_expense.interactionid,
          ahm_expense.interactioncode,
          ahm_expense.spendid,
          ahm_expense.clientspendid,
          ahm_expense.spendamount,
          ahm_expense.spendcurrency,
          ahm_expense.spenddate,
          ahm_expense.spendtype,
          ahm_expense.spendpurpose,
          ahm_expense.traveldestinationcity,
          ahm_expense.traveldestinationstateprovince,
          ahm_expense.traveldestinationcountry,
          ahm_expense.spenddescription,
          ahm_expense.taxincludedindicator,
          ahm_expense.taxamount,
          ahm_expense.taxrate,
          ahm_expense.recipientid,
          ahm_expense.clientrecipientid,
          ahm_expense.participantid,
          ahm_expense.recipientfirstname,
          ahm_expense.recipientmiddlename,
          ahm_expense.recipientlastname,
          ahm_expense.recipientsuffix,
          ahm_expense.recipientprofessionaldesignation,
          ahm_expense.recipientprimaryspecialty,
          ahm_expense.recipientorganizationname,
          ahm_expense.recipientnpinumber,
          ahm_expense.recipientaddressid,
          ahm_expense.recipientclientaddressid,
          ahm_expense.recipientaddressline1,
          ahm_expense.recipientaddressline2,
          ahm_expense.recipientaddressline3,
          ahm_expense.recipientaddresscity,
          ahm_expense.recipientaddressstateprovince,
          ahm_expense.recipientaddresspostalcode,
          ahm_expense.recipientaddresspostalcodeextension,
          ahm_expense.recipientaddresscountry,
          ahm_expense.recipientprimarystatelicensestate,
          ahm_expense.recipientprimarystatelicensenumber,
          ahm_expense.thirdpartyrecipientindicator,
          ahm_expense.thirdpartyrecipientid,
          ahm_expense.thirdpartyclientrecipientid,
          ahm_expense.thirdpartyrecipientname,
          ahm_expense.thirdpartycoveredrecipientindicator,
          ahm_expense.paymentid,
          ahm_expense.clientpaymentid,
          ahm_expense.paymentdate,
          ahm_expense.paymentmethod,
          ahm_expense.paymentreferencenumber,
          ahm_expense.paymentstatus,
          ahm_expense.reservedfield1,
          ahm_expense.reservedfield2,
          ahm_expense.reservedfield3,
          ahm_expense.reservedfield4,
          ahm_expense.reservedfield5,
          ahm_expense.reservedfield6,
          ahm_expense.reservedfield7,
          ahm_expense.reservedfield8,
          ahm_expense.reservedfield9,
          ahm_expense.reservedfield10,
          ahm_expense.record_id
SEGMENTED BY hash(ahm_expense.record_id) ALL NODES;

CREATE PROJECTION integration.oncology_target_accounts_v1_b0 /*+basename(oncology_target_accounts_v1),createtype(L)*/ 
(
 tvcmid,
 source_name,
 sales_force_id,
 product_name,
 acct_demo_id,
 ims_outlet_code,
 target_type,
 target_value,
 applies_from_date,
 applies_to_date,
 active_ind,
 system_start_date,
 system_end_date,
 end_reason,
 veeva_account_id,
 file_id,
 record_id
)
AS
 SELECT oncology_target_accounts.tvcmid,
        oncology_target_accounts.source_name,
        oncology_target_accounts.sales_force_id,
        oncology_target_accounts.product_name,
        oncology_target_accounts.acct_demo_id,
        oncology_target_accounts.ims_outlet_code,
        oncology_target_accounts.target_type,
        oncology_target_accounts.target_value,
        oncology_target_accounts.applies_from_date,
        oncology_target_accounts.applies_to_date,
        oncology_target_accounts.active_ind,
        oncology_target_accounts.system_start_date,
        oncology_target_accounts.system_end_date,
        oncology_target_accounts.end_reason,
        oncology_target_accounts.veeva_account_id,
        oncology_target_accounts.file_id,
        oncology_target_accounts.record_id
 FROM integration.oncology_target_accounts
 ORDER BY oncology_target_accounts.source_name,
          oncology_target_accounts.sales_force_id,
          oncology_target_accounts.product_name,
          oncology_target_accounts.acct_demo_id,
          oncology_target_accounts.ims_outlet_code,
          oncology_target_accounts.target_type,
          oncology_target_accounts.target_value,
          oncology_target_accounts.applies_from_date,
          oncology_target_accounts.applies_to_date,
          oncology_target_accounts.active_ind,
          oncology_target_accounts.system_start_date,
          oncology_target_accounts.system_end_date,
          oncology_target_accounts.end_reason,
          oncology_target_accounts.veeva_account_id,
          oncology_target_accounts.file_id,
          oncology_target_accounts.record_id
SEGMENTED BY hash(oncology_target_accounts.record_id) ALL NODES;

CREATE PROJECTION integration.prescriber_rx__super__v1g17Q3_b0 /*+basename(prescriber_rx__super__v1g17Q3),createtype(D)*/ 
(
 source_name ENCODING RLE,
 client_number ENCODING RLE,
 report_number ENCODING RLE,
 zip_other ENCODING RLE,
 ims_id ENCODING GZIP_COMP,
 specialty ENCODING RLE,
 plan_id ENCODING RLE,
 sales_category,
 rx_type ENCODING RLE,
 product_group ENCODING RLE,
 me_num ENCODING GZIP_COMP,
 last_name ENCODING GZIP_COMP,
 first_name ENCODING GZIP_COMP,
 middle_name,
 address ENCODING GZIP_COMP,
 city ENCODING GZIP_COMP,
 state ENCODING RLE,
 zip ENCODING GZIP_COMP,
 supplemental_data,
 plan_name ENCODING GZIP_COMP,
 data_date ENCODING RLE,
 bucket_date ENCODING COMMONDELTA_COMP,
 bucket_type ENCODING RLE,
 nrx_cnt ENCODING DELTARANGE_COMP,
 nrx_qty ENCODING DELTARANGE_COMP,
 trx_cnt ENCODING DELTARANGE_COMP,
 trx_qty ENCODING DELTARANGE_COMP,
 file_id ENCODING RLE,
 record_id ENCODING DELTARANGE_COMP,
 tvcmid ENCODING DELTARANGE_COMP,
 ims_id_modified
)
AS
 SELECT prescriber_rx.source_name,
        prescriber_rx.client_number,
        prescriber_rx.report_number,
        prescriber_rx.zip_other,
        prescriber_rx.ims_id,
        prescriber_rx.specialty,
        prescriber_rx.plan_id,
        prescriber_rx.sales_category,
        prescriber_rx.rx_type,
        prescriber_rx.product_group,
        prescriber_rx.me_num,
        prescriber_rx.last_name,
        prescriber_rx.first_name,
        prescriber_rx.middle_name,
        prescriber_rx.address,
        prescriber_rx.city,
        prescriber_rx.state,
        prescriber_rx.zip,
        prescriber_rx.supplemental_data,
        prescriber_rx.plan_name,
        prescriber_rx.data_date,
        prescriber_rx.bucket_date,
        prescriber_rx.bucket_type,
        prescriber_rx.nrx_cnt,
        prescriber_rx.nrx_qty,
        prescriber_rx.trx_cnt,
        prescriber_rx.trx_qty,
        prescriber_rx.file_id,
        prescriber_rx.record_id,
        prescriber_rx.tvcmid,
        prescriber_rx.ims_id_modified
 FROM integration.prescriber_rx
 ORDER BY prescriber_rx.rx_type,
          prescriber_rx.source_name,
          prescriber_rx.bucket_type,
          prescriber_rx.client_number,
          prescriber_rx.report_number,
          prescriber_rx.data_date,
          prescriber_rx.file_id,
          prescriber_rx.product_group,
          prescriber_rx.state,
          prescriber_rx.zip_other,
          prescriber_rx.specialty,
          prescriber_rx.ims_id_modified,
          prescriber_rx.supplemental_data,
          prescriber_rx.plan_id,
          prescriber_rx.bucket_date,
          prescriber_rx.nrx_cnt,
          prescriber_rx.nrx_qty,
          prescriber_rx.trx_cnt,
          prescriber_rx.trx_qty,
          prescriber_rx.sales_category,
          prescriber_rx.tvcmid
SEGMENTED BY hash(prescriber_rx.ims_id_modified) ALL NODES;

CREATE PROJECTION integration.dx_claims_b0 /*+basename(dx_claims),createtype(L)*/ 
(
 ims_id,
 npi,
 g244_clm_cnt_mth_01,
 g244_clm_cnt_mth_02,
 g244_clm_cnt_mth_03,
 g244_clm_cnt_mth_04,
 g244_clm_cnt_mth_05,
 g244_clm_cnt_mth_06,
 g244_clm_cnt_mth_07,
 g244_clm_cnt_mth_08,
 g244_clm_cnt_mth_09,
 g244_clm_cnt_mth_10,
 g244_clm_cnt_mth_11,
 g244_clm_cnt_mth_12,
 g244_pat_cnt_mth_01,
 g244_pat_cnt_mth_02,
 g244_pat_cnt_mth_03,
 g244_pat_cnt_mth_04,
 g244_pat_cnt_mth_05,
 g244_pat_cnt_mth_06,
 g244_pat_cnt_mth_07,
 g244_pat_cnt_mth_08,
 g244_pat_cnt_mth_09,
 g244_pat_cnt_mth_10,
 g244_pat_cnt_mth_11,
 g244_pat_cnt_mth_12,
 g2401_clm_cnt_mth_01,
 g2401_clm_cnt_mth_02,
 g2401_clm_cnt_mth_03,
 g2401_clm_cnt_mth_04,
 g2401_clm_cnt_mth_05,
 g2401_clm_cnt_mth_06,
 g2401_clm_cnt_mth_07,
 g2401_clm_cnt_mth_08,
 g2401_clm_cnt_mth_09,
 g2401_clm_cnt_mth_10,
 g2401_clm_cnt_mth_11,
 g2401_clm_cnt_mth_12,
 g2401_pat_cnt_mth_01,
 g2401_pat_cnt_mth_02,
 g2401_pat_cnt_mth_03,
 g2401_pat_cnt_mth_04,
 g2401_pat_cnt_mth_05,
 g2401_pat_cnt_mth_06,
 g2401_pat_cnt_mth_07,
 g2401_pat_cnt_mth_08,
 g2401_pat_cnt_mth_09,
 g2401_pat_cnt_mth_10,
 g2401_pat_cnt_mth_11,
 g2401_pat_cnt_mth_12,
 file_id,
 record_id
)
AS
 SELECT dx_claims.ims_id,
        dx_claims.npi,
        dx_claims.g244_clm_cnt_mth_01,
        dx_claims.g244_clm_cnt_mth_02,
        dx_claims.g244_clm_cnt_mth_03,
        dx_claims.g244_clm_cnt_mth_04,
        dx_claims.g244_clm_cnt_mth_05,
        dx_claims.g244_clm_cnt_mth_06,
        dx_claims.g244_clm_cnt_mth_07,
        dx_claims.g244_clm_cnt_mth_08,
        dx_claims.g244_clm_cnt_mth_09,
        dx_claims.g244_clm_cnt_mth_10,
        dx_claims.g244_clm_cnt_mth_11,
        dx_claims.g244_clm_cnt_mth_12,
        dx_claims.g244_pat_cnt_mth_01,
        dx_claims.g244_pat_cnt_mth_02,
        dx_claims.g244_pat_cnt_mth_03,
        dx_claims.g244_pat_cnt_mth_04,
        dx_claims.g244_pat_cnt_mth_05,
        dx_claims.g244_pat_cnt_mth_06,
        dx_claims.g244_pat_cnt_mth_07,
        dx_claims.g244_pat_cnt_mth_08,
        dx_claims.g244_pat_cnt_mth_09,
        dx_claims.g244_pat_cnt_mth_10,
        dx_claims.g244_pat_cnt_mth_11,
        dx_claims.g244_pat_cnt_mth_12,
        dx_claims.g2401_clm_cnt_mth_01,
        dx_claims.g2401_clm_cnt_mth_02,
        dx_claims.g2401_clm_cnt_mth_03,
        dx_claims.g2401_clm_cnt_mth_04,
        dx_claims.g2401_clm_cnt_mth_05,
        dx_claims.g2401_clm_cnt_mth_06,
        dx_claims.g2401_clm_cnt_mth_07,
        dx_claims.g2401_clm_cnt_mth_08,
        dx_claims.g2401_clm_cnt_mth_09,
        dx_claims.g2401_clm_cnt_mth_10,
        dx_claims.g2401_clm_cnt_mth_11,
        dx_claims.g2401_clm_cnt_mth_12,
        dx_claims.g2401_pat_cnt_mth_01,
        dx_claims.g2401_pat_cnt_mth_02,
        dx_claims.g2401_pat_cnt_mth_03,
        dx_claims.g2401_pat_cnt_mth_04,
        dx_claims.g2401_pat_cnt_mth_05,
        dx_claims.g2401_pat_cnt_mth_06,
        dx_claims.g2401_pat_cnt_mth_07,
        dx_claims.g2401_pat_cnt_mth_08,
        dx_claims.g2401_pat_cnt_mth_09,
        dx_claims.g2401_pat_cnt_mth_10,
        dx_claims.g2401_pat_cnt_mth_11,
        dx_claims.g2401_pat_cnt_mth_12,
        dx_claims.file_id,
        dx_claims.record_id
 FROM integration.dx_claims
 ORDER BY dx_claims.ims_id,
          dx_claims.npi,
          dx_claims.g244_clm_cnt_mth_01,
          dx_claims.g244_clm_cnt_mth_02,
          dx_claims.g244_clm_cnt_mth_03,
          dx_claims.g244_clm_cnt_mth_04,
          dx_claims.g244_clm_cnt_mth_05,
          dx_claims.g244_clm_cnt_mth_06,
          dx_claims.g244_clm_cnt_mth_07,
          dx_claims.g244_clm_cnt_mth_08,
          dx_claims.g244_clm_cnt_mth_09,
          dx_claims.g244_clm_cnt_mth_10,
          dx_claims.g244_clm_cnt_mth_11,
          dx_claims.g244_clm_cnt_mth_12,
          dx_claims.g244_pat_cnt_mth_01,
          dx_claims.g244_pat_cnt_mth_02,
          dx_claims.g244_pat_cnt_mth_03,
          dx_claims.g244_pat_cnt_mth_04,
          dx_claims.g244_pat_cnt_mth_05,
          dx_claims.g244_pat_cnt_mth_06,
          dx_claims.g244_pat_cnt_mth_07,
          dx_claims.g244_pat_cnt_mth_08,
          dx_claims.g244_pat_cnt_mth_09,
          dx_claims.g244_pat_cnt_mth_10,
          dx_claims.g244_pat_cnt_mth_11,
          dx_claims.g244_pat_cnt_mth_12,
          dx_claims.g2401_clm_cnt_mth_01,
          dx_claims.g2401_clm_cnt_mth_02,
          dx_claims.g2401_clm_cnt_mth_03,
          dx_claims.g2401_clm_cnt_mth_04,
          dx_claims.g2401_clm_cnt_mth_05,
          dx_claims.g2401_clm_cnt_mth_06,
          dx_claims.g2401_clm_cnt_mth_07,
          dx_claims.g2401_clm_cnt_mth_08,
          dx_claims.g2401_clm_cnt_mth_09,
          dx_claims.g2401_clm_cnt_mth_10,
          dx_claims.g2401_clm_cnt_mth_11,
          dx_claims.g2401_clm_cnt_mth_12,
          dx_claims.g2401_pat_cnt_mth_01,
          dx_claims.g2401_pat_cnt_mth_02,
          dx_claims.g2401_pat_cnt_mth_03,
          dx_claims.g2401_pat_cnt_mth_04,
          dx_claims.g2401_pat_cnt_mth_05,
          dx_claims.g2401_pat_cnt_mth_06,
          dx_claims.g2401_pat_cnt_mth_07,
          dx_claims.g2401_pat_cnt_mth_08,
          dx_claims.g2401_pat_cnt_mth_09,
          dx_claims.g2401_pat_cnt_mth_10,
          dx_claims.g2401_pat_cnt_mth_11,
          dx_claims.g2401_pat_cnt_mth_12,
          dx_claims.record_id
SEGMENTED BY hash(dx_claims.record_id) ALL NODES;

CREATE PROJECTION integration.valuecentric_867_v2_b0 /*+basename(valuecentric_867_v2),createtype(L)*/ 
(
 ndc,
 product_description,
 product_name,
 trading_partner_name,
 trading_partner_dea,
 trading_partner_hin,
 trading_partner_location_type,
 trading_partner_dc_dea,
 trading_partner_dc_hin,
 trading_partner_dc_name,
 trading_partner_dc_address,
 trading_partner_dc_address_2,
 trading_partner_dc_city,
 trading_partner_dc_state,
 trading_partner_dc_zip,
 class_of_trade,
 outlet_location_name,
 outlet_dea,
 outlet_hin,
 outlet_340b,
 outlet_ncpdp,
 outlet_npi,
 outlet_location_address,
 outlet_location_address_2,
 outlet_location_city,
 outlet_location_state,
 outlet_location_zip,
 reporting_date,
 contract_number,
 contract_description,
 invoice_number,
 invoice_date,
 invoice_line_id,
 quanitity_stock_sales_ss,
 ds_sales_ds,
 summary_sales_su,
 dock_to_dock_bq,
 interbranch_ib,
 return_to_useable_ru,
 return_to_vendor_rv,
 transfer_to_disposal_td,
 adjusted_price,
 gross_amount,
 record_id,
 file_id
)
AS
 SELECT valuecentric_867_v2.ndc,
        valuecentric_867_v2.product_description,
        valuecentric_867_v2.product_name,
        valuecentric_867_v2.trading_partner_name,
        valuecentric_867_v2.trading_partner_dea,
        valuecentric_867_v2.trading_partner_hin,
        valuecentric_867_v2.trading_partner_location_type,
        valuecentric_867_v2.trading_partner_dc_dea,
        valuecentric_867_v2.trading_partner_dc_hin,
        valuecentric_867_v2.trading_partner_dc_name,
        valuecentric_867_v2.trading_partner_dc_address,
        valuecentric_867_v2.trading_partner_dc_address_2,
        valuecentric_867_v2.trading_partner_dc_city,
        valuecentric_867_v2.trading_partner_dc_state,
        valuecentric_867_v2.trading_partner_dc_zip,
        valuecentric_867_v2.class_of_trade,
        valuecentric_867_v2.outlet_location_name,
        valuecentric_867_v2.outlet_dea,
        valuecentric_867_v2.outlet_hin,
        valuecentric_867_v2.outlet_340b,
        valuecentric_867_v2.outlet_ncpdp,
        valuecentric_867_v2.outlet_npi,
        valuecentric_867_v2.outlet_location_address,
        valuecentric_867_v2.outlet_location_address_2,
        valuecentric_867_v2.outlet_location_city,
        valuecentric_867_v2.outlet_location_state,
        valuecentric_867_v2.outlet_location_zip,
        valuecentric_867_v2.reporting_date,
        valuecentric_867_v2.contract_number,
        valuecentric_867_v2.contract_description,
        valuecentric_867_v2.invoice_number,
        valuecentric_867_v2.invoice_date,
        valuecentric_867_v2.invoice_line_id,
        valuecentric_867_v2.quanitity_stock_sales_ss,
        valuecentric_867_v2.ds_sales_ds,
        valuecentric_867_v2.summary_sales_su,
        valuecentric_867_v2.dock_to_dock_bq,
        valuecentric_867_v2.interbranch_ib,
        valuecentric_867_v2.return_to_useable_ru,
        valuecentric_867_v2.return_to_vendor_rv,
        valuecentric_867_v2.transfer_to_disposal_td,
        valuecentric_867_v2.adjusted_price,
        valuecentric_867_v2.gross_amount,
        valuecentric_867_v2.record_id,
        valuecentric_867_v2.file_id
 FROM integration.valuecentric_867_v2
 ORDER BY valuecentric_867_v2.ndc,
          valuecentric_867_v2.product_description,
          valuecentric_867_v2.product_name,
          valuecentric_867_v2.trading_partner_name,
          valuecentric_867_v2.trading_partner_dea,
          valuecentric_867_v2.trading_partner_hin,
          valuecentric_867_v2.trading_partner_location_type,
          valuecentric_867_v2.trading_partner_dc_dea,
          valuecentric_867_v2.trading_partner_dc_hin,
          valuecentric_867_v2.trading_partner_dc_name,
          valuecentric_867_v2.trading_partner_dc_address,
          valuecentric_867_v2.trading_partner_dc_address_2,
          valuecentric_867_v2.trading_partner_dc_city,
          valuecentric_867_v2.trading_partner_dc_state,
          valuecentric_867_v2.trading_partner_dc_zip,
          valuecentric_867_v2.class_of_trade,
          valuecentric_867_v2.outlet_location_name,
          valuecentric_867_v2.outlet_dea,
          valuecentric_867_v2.outlet_hin,
          valuecentric_867_v2.outlet_340b,
          valuecentric_867_v2.outlet_ncpdp,
          valuecentric_867_v2.outlet_npi,
          valuecentric_867_v2.outlet_location_address,
          valuecentric_867_v2.outlet_location_address_2,
          valuecentric_867_v2.outlet_location_city,
          valuecentric_867_v2.outlet_location_state,
          valuecentric_867_v2.outlet_location_zip,
          valuecentric_867_v2.reporting_date,
          valuecentric_867_v2.contract_number,
          valuecentric_867_v2.contract_description,
          valuecentric_867_v2.invoice_number,
          valuecentric_867_v2.invoice_date,
          valuecentric_867_v2.invoice_line_id,
          valuecentric_867_v2.quanitity_stock_sales_ss,
          valuecentric_867_v2.ds_sales_ds,
          valuecentric_867_v2.summary_sales_su,
          valuecentric_867_v2.dock_to_dock_bq,
          valuecentric_867_v2.interbranch_ib,
          valuecentric_867_v2.return_to_useable_ru,
          valuecentric_867_v2.return_to_vendor_rv,
          valuecentric_867_v2.transfer_to_disposal_td,
          valuecentric_867_v2.adjusted_price,
          valuecentric_867_v2.gross_amount,
          valuecentric_867_v2.record_id
SEGMENTED BY hash(valuecentric_867_v2.record_id) ALL NODES;

CREATE PROJECTION integration.xpd_switch_details_b0 /*+basename(xpd_switch_details),createtype(L)*/ 
(
 ims_client_number,
 ims_report_number,
 channel_indicator,
 ims_id,
 specialty,
 switch_from_product_group_num,
 switch_to_product_group_num,
 month_ending,
 rx,
 record_id,
 file_id
)
AS
 SELECT xpd_switch_details.ims_client_number,
        xpd_switch_details.ims_report_number,
        xpd_switch_details.channel_indicator,
        xpd_switch_details.ims_id,
        xpd_switch_details.specialty,
        xpd_switch_details.switch_from_product_group_num,
        xpd_switch_details.switch_to_product_group_num,
        xpd_switch_details.month_ending,
        xpd_switch_details.rx,
        xpd_switch_details.record_id,
        xpd_switch_details.file_id
 FROM integration.xpd_switch_details
 ORDER BY xpd_switch_details.ims_client_number,
          xpd_switch_details.ims_report_number,
          xpd_switch_details.channel_indicator,
          xpd_switch_details.ims_id
SEGMENTED BY hash(xpd_switch_details.record_id) ALL NODES;

CREATE PROJECTION integration.onc_sales_adjustment_load_b0 /*+basename(onc_sales_adjustment_load),createtype(L)*/ 
(
 adj_code,
 adj_time_period,
 tvcmid,
 basket_id,
 adj_factor,
 record_id,
 file_id
)
AS
 SELECT onc_sales_adjustment_load.adj_code,
        onc_sales_adjustment_load.adj_time_period,
        onc_sales_adjustment_load.tvcmid,
        onc_sales_adjustment_load.basket_id,
        onc_sales_adjustment_load.adj_factor,
        onc_sales_adjustment_load.record_id,
        onc_sales_adjustment_load.file_id
 FROM integration.onc_sales_adjustment_load
 ORDER BY onc_sales_adjustment_load.adj_code,
          onc_sales_adjustment_load.adj_time_period,
          onc_sales_adjustment_load.tvcmid,
          onc_sales_adjustment_load.basket_id,
          onc_sales_adjustment_load.adj_factor,
          onc_sales_adjustment_load.record_id
SEGMENTED BY hash(onc_sales_adjustment_load.record_id) ALL NODES;

CREATE PROJECTION integration.copay_voucher_program_b0 /*+basename(copay_voucher_program),createtype(L)*/ 
(
 redemption_type,
 program_number,
 program_description,
 create_date,
 file_id,
 record_id
)
AS
 SELECT copay_voucher_program.redemption_type,
        copay_voucher_program.program_number,
        copay_voucher_program.program_description,
        copay_voucher_program.create_date,
        copay_voucher_program.file_id,
        copay_voucher_program.record_id
 FROM integration.copay_voucher_program
 ORDER BY copay_voucher_program.redemption_type,
          copay_voucher_program.program_number,
          copay_voucher_program.program_description,
          copay_voucher_program.create_date,
          copay_voucher_program.record_id
SEGMENTED BY hash(copay_voucher_program.create_date, copay_voucher_program.file_id, copay_voucher_program.record_id, copay_voucher_program.program_number, copay_voucher_program.redemption_type, copay_voucher_program.program_description) ALL NODES;

CREATE PROJECTION integration.fia_fact_v2_b0 /*+basename(fia_fact_v2),createtype(L)*/ 
(
 claim_id,
 patient_id,
 sequence_number,
 product_id,
 fill_date,
 claim_type,
 reject_code,
 days_supply,
 quantity,
 refill_code,
 plantrak_id,
 opc_ask,
 sec_plantrak_id,
 buy_down,
 opc_paid,
 prescriber_id,
 sob,
 sub_product_id,
 sub_opc,
 initial_claim_id,
 prev_product_id,
 daw_code,
 wrt_date,
 claim_status,
 copay_card_flg,
 zip_code,
 ecoup_flag,
 ecoup_offset_amt,
 standard_copay,
 standard_copay_yn,
 market_id,
 flexible_fld_1_char,
 flexible_fld_2_char,
 flexible_fld_3_char,
 flexible_fld_4_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_fact.claim_id,
        fia_fact.patient_id,
        fia_fact.sequence_number,
        fia_fact.product_id,
        fia_fact.fill_date,
        fia_fact.claim_type,
        fia_fact.reject_code,
        fia_fact.days_supply,
        fia_fact.quantity,
        fia_fact.refill_code,
        fia_fact.plantrak_id,
        fia_fact.opc_ask,
        fia_fact.sec_plantrak_id,
        fia_fact.buy_down,
        fia_fact.opc_paid,
        fia_fact.prescriber_id,
        fia_fact.sob,
        fia_fact.sub_product_id,
        fia_fact.sub_opc,
        fia_fact.initial_claim_id,
        fia_fact.prev_product_id,
        fia_fact.daw_code,
        fia_fact.wrt_date,
        fia_fact.claim_status,
        fia_fact.copay_card_flg,
        fia_fact.zip_code,
        fia_fact.ecoup_flag,
        fia_fact.ecoup_offset_amt,
        fia_fact.standard_copay,
        fia_fact.standard_copay_yn,
        fia_fact.market_id,
        fia_fact.flexible_fld_1_char,
        fia_fact.flexible_fld_2_char,
        fia_fact.flexible_fld_3_char,
        fia_fact.flexible_fld_4_char,
        fia_fact.file_id,
        fia_fact.record_id,
        fia_fact.file_location
 FROM integration.fia_fact
 ORDER BY fia_fact.claim_id,
          fia_fact.patient_id,
          fia_fact.sequence_number,
          fia_fact.product_id,
          fia_fact.fill_date,
          fia_fact.claim_type,
          fia_fact.reject_code,
          fia_fact.days_supply
SEGMENTED BY hash(fia_fact.record_id) ALL NODES;

CREATE PROJECTION integration.ddd_adhoc_b0 /*+basename(ddd_adhoc),createtype(L)*/ 
(
 source_name,
 client_number,
 report_number,
 territory_number,
 outlet_code,
 category_code,
 ims_product_code,
 data_date,
 outlet_name,
 outlet_address,
 outlet_city,
 outlet_state,
 outlet_zip,
 bucket_date,
 bucket_type,
 quantity,
 dollars,
 file_id,
 record_id,
 tvcmid_outlet,
 subcategory_code
)
AS
 SELECT ddd_adhoc.source_name,
        ddd_adhoc.client_number,
        ddd_adhoc.report_number,
        ddd_adhoc.territory_number,
        ddd_adhoc.outlet_code,
        ddd_adhoc.category_code,
        ddd_adhoc.ims_product_code,
        ddd_adhoc.data_date,
        ddd_adhoc.outlet_name,
        ddd_adhoc.outlet_address,
        ddd_adhoc.outlet_city,
        ddd_adhoc.outlet_state,
        ddd_adhoc.outlet_zip,
        ddd_adhoc.bucket_date,
        ddd_adhoc.bucket_type,
        ddd_adhoc.quantity,
        ddd_adhoc.dollars,
        ddd_adhoc.file_id,
        ddd_adhoc.record_id,
        ddd_adhoc.tvcmid_outlet,
        ddd_adhoc.subcategory_code
 FROM integration.ddd_adhoc
 ORDER BY ddd_adhoc.source_name,
          ddd_adhoc.client_number,
          ddd_adhoc.report_number,
          ddd_adhoc.territory_number,
          ddd_adhoc.outlet_code,
          ddd_adhoc.category_code,
          ddd_adhoc.ims_product_code,
          ddd_adhoc.data_date
SEGMENTED BY hash(ddd_adhoc.client_number, ddd_adhoc.report_number, ddd_adhoc.outlet_code, ddd_adhoc.category_code, ddd_adhoc.data_date, ddd_adhoc.outlet_state, ddd_adhoc.bucket_date, ddd_adhoc.file_id) ALL NODES;

CREATE PROJECTION integration.direct_sales_b0 /*+basename(direct_sales),createtype(L)*/ 
(
 source_name,
 account_id,
 location_id,
 shipment_date,
 ndc_code,
 product_name,
 transaction_type,
 direct_sales_units,
 direct_sales_dollars,
 file_id,
 record_id
)
AS
 SELECT direct_sales.source_name,
        direct_sales.account_id,
        direct_sales.location_id,
        direct_sales.shipment_date,
        direct_sales.ndc_code,
        direct_sales.product_name,
        direct_sales.transaction_type,
        direct_sales.direct_sales_units,
        direct_sales.direct_sales_dollars,
        direct_sales.file_id,
        direct_sales.record_id
 FROM integration.direct_sales
 ORDER BY direct_sales.source_name,
          direct_sales.account_id,
          direct_sales.location_id,
          direct_sales.shipment_date,
          direct_sales.ndc_code,
          direct_sales.product_name,
          direct_sales.transaction_type,
          direct_sales.direct_sales_units,
          direct_sales.direct_sales_dollars,
          direct_sales.file_id,
          direct_sales.record_id
SEGMENTED BY hash(direct_sales.record_id) ALL NODES;

CREATE PROJECTION integration.event_count_b0 /*+basename(event_count),createtype(L)*/ 
(
 source_system_name,
 event_number,
 attendee_category_code,
 attendee_category,
 count,
 file_id,
 record_id
)
AS
 SELECT event_count.source_system_name,
        event_count.event_number,
        event_count.attendee_category_code,
        event_count.attendee_category,
        event_count.count,
        event_count.file_id,
        event_count.record_id
 FROM integration.event_count
 ORDER BY event_count.source_system_name,
          event_count.event_number,
          event_count.attendee_category_code,
          event_count.attendee_category,
          event_count.count,
          event_count.file_id,
          event_count.record_id
SEGMENTED BY hash(event_count.record_id) ALL NODES;

CREATE PROJECTION integration.event_b0 /*+basename(event),createtype(L)*/ 
(
 source_system_name,
 event_number,
 event_name,
 event_status_code,
 event_status_description,
 event_status_change_date,
 event_start_date,
 event_end_date,
 funding_source,
 event_type,
 event_type_description,
 event_location,
 event_schedule_date,
 attendee_closeout_date,
 financial_closeout_date,
 cancellation_date,
 cancellation_reason,
 estimated_attendance,
 venue_id,
 venue_full_name,
 venue_address_line_1,
 venue_address_line_2,
 venue_city,
 venue_state,
 venue_zip,
 venue_contact,
 venue_phone,
 venue_fax,
 venue_email,
 file_id,
 record_id,
 parent_event_number,
 event_time_zone,
 event_format,
 pending_mgmnt_approval_date,
 event_approval_date,
 event_approver_id,
 cancellation_source,
 event_venue_min_cnt_req_ind,
 event_venue_min_count,
 venue_address_line_3,
 venue_address_line_4,
 venue_postal_extended_code,
 venue_country_code,
 trade_secret_indicator,
 trade_secret_reason,
 custom_field_1,
 custom_field_2,
 custom_field_3,
 custom_field_4,
 custom_field_5,
 rec_stat_cd
)
AS
 SELECT event.source_system_name,
        event.event_number,
        event.event_name,
        event.event_status_code,
        event.event_status_description,
        event.event_status_change_date,
        event.event_start_date,
        event.event_end_date,
        event.funding_source,
        event.event_type,
        event.event_type_description,
        event.event_location,
        event.event_schedule_date,
        event.attendee_closeout_date,
        event.financial_closeout_date,
        event.cancellation_date,
        event.cancellation_reason,
        event.estimated_attendance,
        event.venue_id,
        event.venue_full_name,
        event.venue_address_line_1,
        event.venue_address_line_2,
        event.venue_city,
        event.venue_state,
        event.venue_zip,
        event.venue_contact,
        event.venue_phone,
        event.venue_fax,
        event.venue_email,
        event.file_id,
        event.record_id,
        event.parent_event_number,
        event.event_time_zone,
        event.event_format,
        event.pending_mgmnt_approval_date,
        event.event_approval_date,
        event.event_approver_id,
        event.cancellation_source,
        event.event_venue_min_cnt_req_ind,
        event.event_venue_min_count,
        event.venue_address_line_3,
        event.venue_address_line_4,
        event.venue_postal_extended_code,
        event.venue_country_code,
        event.trade_secret_indicator,
        event.trade_secret_reason,
        event.custom_field_1,
        event.custom_field_2,
        event.custom_field_3,
        event.custom_field_4,
        event.custom_field_5,
        event.rec_stat_cd
 FROM integration.event
 ORDER BY event.source_system_name,
          event.event_number,
          event.event_name,
          event.event_status_code,
          event.event_status_description,
          event.event_status_change_date,
          event.event_start_date,
          event.event_end_date,
          event.funding_source,
          event.event_type,
          event.event_type_description,
          event.event_location,
          event.event_schedule_date,
          event.attendee_closeout_date,
          event.financial_closeout_date,
          event.cancellation_date,
          event.cancellation_reason,
          event.estimated_attendance,
          event.venue_id,
          event.venue_full_name,
          event.venue_address_line_1,
          event.venue_address_line_2,
          event.venue_city,
          event.venue_state,
          event.venue_zip,
          event.venue_contact,
          event.venue_phone,
          event.venue_fax,
          event.venue_email,
          event.file_id,
          event.record_id
SEGMENTED BY hash(event.record_id) ALL NODES;

CREATE PROJECTION integration.copay_redemptions_b0 /*+basename(copay_redemptions),createtype(L)*/ 
(
 source_name,
 asi_txn_id,
 territory_number,
 program_number,
 claim_cert_number,
 rx_date,
 ndc_code,
 quantity,
 other_coverage_code,
 sex,
 dob,
 pharmacy_name,
 pharmacy_address,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 principle_phys_dea_number,
 phys_npi,
 physician_first_name,
 physician_last_name,
 asi_phys_first_name,
 asi_phys_last_name,
 asi_phys_address1,
 asi_phys_address2,
 asi_phys_city,
 asi_phys_state,
 asi_phys_zip,
 rebate_amount,
 member_cash_expense,
 submitted_cost,
 pharmacy_fee,
 total_amount_due,
 company_phys_last_name,
 company_phys_first_name,
 company_phys_address1,
 company_phys_address2,
 company_phys_city,
 company_phys_state,
 company_phys_zip,
 file_id,
 record_id,
 tvcmid_physician,
 basket_id,
 basket_name,
 tvcmid_from_npi,
 tvcmid_from_dea,
 ims_id_from_npi,
 ims_id_from_dea,
 veeva_account_id_from_npi,
 veeva_account_id_from_dea
)
AS
 SELECT copay_redemptions.source_name,
        copay_redemptions.asi_txn_id,
        copay_redemptions.territory_number,
        copay_redemptions.program_number,
        copay_redemptions.claim_cert_number,
        copay_redemptions.rx_date,
        copay_redemptions.ndc_code,
        copay_redemptions.quantity,
        copay_redemptions.other_coverage_code,
        copay_redemptions.sex,
        copay_redemptions.dob,
        copay_redemptions.pharmacy_name,
        copay_redemptions.pharmacy_address,
        copay_redemptions.pharmacy_city,
        copay_redemptions.pharmacy_state,
        copay_redemptions.pharmacy_zip,
        copay_redemptions.principle_phys_dea_number,
        copay_redemptions.phys_npi,
        copay_redemptions.physician_first_name,
        copay_redemptions.physician_last_name,
        copay_redemptions.asi_phys_first_name,
        copay_redemptions.asi_phys_last_name,
        copay_redemptions.asi_phys_address1,
        copay_redemptions.asi_phys_address2,
        copay_redemptions.asi_phys_city,
        copay_redemptions.asi_phys_state,
        copay_redemptions.asi_phys_zip,
        copay_redemptions.rebate_amount,
        copay_redemptions.member_cash_expense,
        copay_redemptions.submitted_cost,
        copay_redemptions.pharmacy_fee,
        copay_redemptions.total_amount_due,
        copay_redemptions.company_phys_last_name,
        copay_redemptions.company_phys_first_name,
        copay_redemptions.company_phys_address1,
        copay_redemptions.company_phys_address2,
        copay_redemptions.company_phys_city,
        copay_redemptions.company_phys_state,
        copay_redemptions.company_phys_zip,
        copay_redemptions.file_id,
        copay_redemptions.record_id,
        copay_redemptions.tvcmid_physician,
        copay_redemptions.basket_id,
        copay_redemptions.basket_name,
        copay_redemptions.tvcmid_from_npi,
        copay_redemptions.tvcmid_from_dea,
        copay_redemptions.ims_id_from_npi,
        copay_redemptions.ims_id_from_dea,
        copay_redemptions.veeva_account_id_from_npi,
        copay_redemptions.veeva_account_id_from_dea
 FROM integration.copay_redemptions
 ORDER BY copay_redemptions.source_name,
          copay_redemptions.asi_txn_id,
          copay_redemptions.territory_number,
          copay_redemptions.program_number,
          copay_redemptions.claim_cert_number,
          copay_redemptions.rx_date,
          copay_redemptions.ndc_code,
          copay_redemptions.quantity,
          copay_redemptions.other_coverage_code,
          copay_redemptions.sex,
          copay_redemptions.dob,
          copay_redemptions.pharmacy_name,
          copay_redemptions.pharmacy_address,
          copay_redemptions.pharmacy_city,
          copay_redemptions.pharmacy_state,
          copay_redemptions.pharmacy_zip,
          copay_redemptions.principle_phys_dea_number,
          copay_redemptions.phys_npi,
          copay_redemptions.physician_first_name,
          copay_redemptions.physician_last_name,
          copay_redemptions.asi_phys_first_name,
          copay_redemptions.asi_phys_last_name,
          copay_redemptions.asi_phys_address1,
          copay_redemptions.asi_phys_address2,
          copay_redemptions.asi_phys_city,
          copay_redemptions.asi_phys_state,
          copay_redemptions.asi_phys_zip,
          copay_redemptions.rebate_amount,
          copay_redemptions.member_cash_expense,
          copay_redemptions.submitted_cost,
          copay_redemptions.pharmacy_fee,
          copay_redemptions.total_amount_due,
          copay_redemptions.company_phys_last_name,
          copay_redemptions.company_phys_first_name,
          copay_redemptions.company_phys_address1,
          copay_redemptions.company_phys_address2,
          copay_redemptions.company_phys_city,
          copay_redemptions.company_phys_state,
          copay_redemptions.company_phys_zip
SEGMENTED BY hash(copay_redemptions.record_id) ALL NODES;

CREATE PROJECTION integration.ims_outlet_master_b0 /*+basename(ims_outlet_master),createtype(L)*/ 
(
 source_name,
 client_number,
 suffix,
 territory_number,
 outlet_number,
 outlet_name,
 address,
 city,
 state,
 report_type,
 status,
 subcategory,
 state_code,
 county_code,
 record_type,
 file_id,
 record_id,
 retail_flag,
 activity_date,
 dea_number
)
AS
 SELECT ims_outlet_master.source_name,
        ims_outlet_master.client_number,
        ims_outlet_master.suffix,
        ims_outlet_master.territory_number,
        ims_outlet_master.outlet_number,
        ims_outlet_master.outlet_name,
        ims_outlet_master.address,
        ims_outlet_master.city,
        ims_outlet_master.state,
        ims_outlet_master.report_type,
        ims_outlet_master.status,
        ims_outlet_master.subcategory,
        ims_outlet_master.state_code,
        ims_outlet_master.county_code,
        ims_outlet_master.record_type,
        ims_outlet_master.file_id,
        ims_outlet_master.record_id,
        ims_outlet_master.retail_flag,
        ims_outlet_master.activity_date,
        ims_outlet_master.dea_number
 FROM integration.ims_outlet_master
 ORDER BY ims_outlet_master.source_name,
          ims_outlet_master.client_number,
          ims_outlet_master.suffix,
          ims_outlet_master.territory_number,
          ims_outlet_master.outlet_number,
          ims_outlet_master.outlet_name,
          ims_outlet_master.address,
          ims_outlet_master.city,
          ims_outlet_master.state,
          ims_outlet_master.report_type,
          ims_outlet_master.status,
          ims_outlet_master.subcategory,
          ims_outlet_master.state_code,
          ims_outlet_master.county_code,
          ims_outlet_master.record_type,
          ims_outlet_master.file_id,
          ims_outlet_master.record_id
SEGMENTED BY hash(ims_outlet_master.record_id) ALL NODES;

CREATE PROJECTION integration.specialty_pharmacy_shipment_b0 /*+basename(specialty_pharmacy_shipment),createtype(L)*/ 
(
 source_name,
 customer_number,
 customer_name,
 physician_first_name,
 physician_last_name,
 ship_to_address_line_1,
 ship_to_address_line_2,
 ship_to_city,
 ship_to_state,
 ship_to_zip,
 ship_to_phone,
 ship_to_fax,
 transaction_id,
 invoice_date,
 ship_date,
 item_number,
 ndc,
 brand,
 package_size,
 specialty_pharmacy_name,
 quantity,
 unit_price,
 invoice_amount,
 invoice_discount,
 order_type_code,
 customer_type_code,
 customer_type,
 customer_340b_number,
 class_of_trade,
 dea_number,
 dea_number_expiration,
 state_license_number,
 state_license_expiration,
 npi,
 tax_id,
 bill_to_customer_number,
 bill_to_customer_name,
 bill_to_address_line_1,
 bill_to_address_line_2,
 bill_to_state,
 bill_to_city,
 bill_to_zip,
 bill_to_phone,
 bill_to_fax,
 parent_customer_code,
 parent_customer_name,
 order_number,
 invoice_number,
 order_type_description,
 lob_code_description,
 price_matrix_definition,
 warehouse_code,
 file_id,
 record_id,
 tvcmid,
 replacement_flag,
 net_sales_amt,
 medicaid_return_date,
 self_pay_refund_date,
 hin,
 net_cost,
 order_date,
 payer_flag,
 briova_flag,
 trx_count,
 days_supplied,
 SPP_Physician_ID,
 Primary_Payer_BIN,
 Primary_Payer_PCN,
 Primary_Group_Num,
 Primary_Payer_Name,
 Primary_Payer_Type,
 Primary_Copay_Amount
)
AS
 SELECT specialty_pharmacy_shipment.source_name,
        specialty_pharmacy_shipment.customer_number,
        specialty_pharmacy_shipment.customer_name,
        specialty_pharmacy_shipment.physician_first_name,
        specialty_pharmacy_shipment.physician_last_name,
        specialty_pharmacy_shipment.ship_to_address_line_1,
        specialty_pharmacy_shipment.ship_to_address_line_2,
        specialty_pharmacy_shipment.ship_to_city,
        specialty_pharmacy_shipment.ship_to_state,
        specialty_pharmacy_shipment.ship_to_zip,
        specialty_pharmacy_shipment.ship_to_phone,
        specialty_pharmacy_shipment.ship_to_fax,
        specialty_pharmacy_shipment.transaction_id,
        specialty_pharmacy_shipment.invoice_date,
        specialty_pharmacy_shipment.ship_date,
        specialty_pharmacy_shipment.item_number,
        specialty_pharmacy_shipment.ndc,
        specialty_pharmacy_shipment.brand,
        specialty_pharmacy_shipment.package_size,
        specialty_pharmacy_shipment.specialty_pharmacy_name,
        specialty_pharmacy_shipment.quantity,
        specialty_pharmacy_shipment.unit_price,
        specialty_pharmacy_shipment.invoice_amount,
        specialty_pharmacy_shipment.invoice_discount,
        specialty_pharmacy_shipment.order_type_code,
        specialty_pharmacy_shipment.customer_type_code,
        specialty_pharmacy_shipment.customer_type,
        specialty_pharmacy_shipment.customer_340b_number,
        specialty_pharmacy_shipment.class_of_trade,
        specialty_pharmacy_shipment.dea_number,
        specialty_pharmacy_shipment.dea_number_expiration,
        specialty_pharmacy_shipment.state_license_number,
        specialty_pharmacy_shipment.state_license_expiration,
        specialty_pharmacy_shipment.npi,
        specialty_pharmacy_shipment.tax_id,
        specialty_pharmacy_shipment.bill_to_customer_number,
        specialty_pharmacy_shipment.bill_to_customer_name,
        specialty_pharmacy_shipment.bill_to_address_line_1,
        specialty_pharmacy_shipment.bill_to_address_line_2,
        specialty_pharmacy_shipment.bill_to_state,
        specialty_pharmacy_shipment.bill_to_city,
        specialty_pharmacy_shipment.bill_to_zip,
        specialty_pharmacy_shipment.bill_to_phone,
        specialty_pharmacy_shipment.bill_to_fax,
        specialty_pharmacy_shipment.parent_customer_code,
        specialty_pharmacy_shipment.parent_customer_name,
        specialty_pharmacy_shipment.order_number,
        specialty_pharmacy_shipment.invoice_number,
        specialty_pharmacy_shipment.order_type_description,
        specialty_pharmacy_shipment.lob_code_description,
        specialty_pharmacy_shipment.price_matrix_definition,
        specialty_pharmacy_shipment.warehouse_code,
        specialty_pharmacy_shipment.file_id,
        specialty_pharmacy_shipment.record_id,
        specialty_pharmacy_shipment.tvcmid,
        specialty_pharmacy_shipment.replacement_flag,
        specialty_pharmacy_shipment.net_sales_amt,
        specialty_pharmacy_shipment.medicaid_return_date,
        specialty_pharmacy_shipment.self_pay_refund_date,
        specialty_pharmacy_shipment.hin,
        specialty_pharmacy_shipment.net_cost,
        specialty_pharmacy_shipment.order_date,
        specialty_pharmacy_shipment.payer_flag,
        specialty_pharmacy_shipment.briova_flag,
        specialty_pharmacy_shipment.trx_count,
        specialty_pharmacy_shipment.days_supplied,
        specialty_pharmacy_shipment.SPP_Physician_ID,
        specialty_pharmacy_shipment.Primary_Payer_BIN,
        specialty_pharmacy_shipment.Primary_Payer_PCN,
        specialty_pharmacy_shipment.Primary_Group_Num,
        specialty_pharmacy_shipment.Primary_Payer_Name,
        specialty_pharmacy_shipment.Primary_Payer_Type,
        specialty_pharmacy_shipment.Primary_Copay_Amount
 FROM integration.specialty_pharmacy_shipment
 ORDER BY specialty_pharmacy_shipment.source_name
SEGMENTED BY hash(specialty_pharmacy_shipment.record_id) ALL NODES;

CREATE PROJECTION integration.oncology_target_accounts_b0 /*+basename(oncology_target_accounts),createtype(L)*/ 
(
 source_name,
 sales_force_id,
 product_name,
 acct_demo_id,
 ims_outlet_code,
 target_type,
 target_value,
 applies_from_date,
 applies_to_date,
 active_ind,
 system_start_date,
 system_end_date,
 end_reason,
 veeva_account_id,
 file_id,
 record_id
)
AS
 SELECT oncology_target_accounts_BKP.source_name,
        oncology_target_accounts_BKP.sales_force_id,
        oncology_target_accounts_BKP.product_name,
        oncology_target_accounts_BKP.acct_demo_id,
        oncology_target_accounts_BKP.ims_outlet_code,
        oncology_target_accounts_BKP.target_type,
        oncology_target_accounts_BKP.target_value,
        oncology_target_accounts_BKP.applies_from_date,
        oncology_target_accounts_BKP.applies_to_date,
        oncology_target_accounts_BKP.active_ind,
        oncology_target_accounts_BKP.system_start_date,
        oncology_target_accounts_BKP.system_end_date,
        oncology_target_accounts_BKP.end_reason,
        oncology_target_accounts_BKP.veeva_account_id,
        oncology_target_accounts_BKP.file_id,
        oncology_target_accounts_BKP.record_id
 FROM integration.oncology_target_accounts_BKP
 ORDER BY oncology_target_accounts_BKP.source_name,
          oncology_target_accounts_BKP.sales_force_id,
          oncology_target_accounts_BKP.product_name,
          oncology_target_accounts_BKP.acct_demo_id,
          oncology_target_accounts_BKP.ims_outlet_code,
          oncology_target_accounts_BKP.target_type,
          oncology_target_accounts_BKP.target_value,
          oncology_target_accounts_BKP.applies_from_date,
          oncology_target_accounts_BKP.applies_to_date,
          oncology_target_accounts_BKP.active_ind,
          oncology_target_accounts_BKP.system_start_date,
          oncology_target_accounts_BKP.system_end_date,
          oncology_target_accounts_BKP.end_reason,
          oncology_target_accounts_BKP.veeva_account_id,
          oncology_target_accounts_BKP.file_id,
          oncology_target_accounts_BKP.record_id
SEGMENTED BY hash(oncology_target_accounts_BKP.record_id) ALL NODES;

CREATE PROJECTION integration.oncology_call_detail_goals_b0 /*+basename(oncology_call_detail_goals),createtype(L)*/ 
(
 source_name,
 sales_force_id,
 time_period,
 territory_num,
 product_name,
 p1,
 p2,
 p3,
 file_id,
 record_id
)
AS
 SELECT oncology_call_detail_goals.source_name,
        oncology_call_detail_goals.sales_force_id,
        oncology_call_detail_goals.time_period,
        oncology_call_detail_goals.territory_num,
        oncology_call_detail_goals.product_name,
        oncology_call_detail_goals.p1,
        oncology_call_detail_goals.p2,
        oncology_call_detail_goals.p3,
        oncology_call_detail_goals.file_id,
        oncology_call_detail_goals.record_id
 FROM integration.oncology_call_detail_goals
 ORDER BY oncology_call_detail_goals.source_name,
          oncology_call_detail_goals.sales_force_id,
          oncology_call_detail_goals.time_period,
          oncology_call_detail_goals.territory_num,
          oncology_call_detail_goals.product_name,
          oncology_call_detail_goals.p1,
          oncology_call_detail_goals.p2,
          oncology_call_detail_goals.p3,
          oncology_call_detail_goals.file_id,
          oncology_call_detail_goals.record_id
SEGMENTED BY hash(oncology_call_detail_goals.record_id) ALL NODES;

CREATE PROJECTION integration.oncology_fcr_b0 /*+basename(oncology_fcr),createtype(L)*/ 
(
 source_name,
 time_period,
 sales_force_id,
 territory_num,
 rep_id,
 contact_date,
 duration_days,
 ss_opening,
 ss_probing,
 ss_resources,
 ss_commitment,
 ss_transitioning,
 ss_acumen,
 archive_flag,
 file_id,
 record_id
)
AS
 SELECT oncology_fcr.source_name,
        oncology_fcr.time_period,
        oncology_fcr.sales_force_id,
        oncology_fcr.territory_num,
        oncology_fcr.rep_id,
        oncology_fcr.contact_date,
        oncology_fcr.duration_days,
        oncology_fcr.ss_opening,
        oncology_fcr.ss_probing,
        oncology_fcr.ss_resources,
        oncology_fcr.ss_commitment,
        oncology_fcr.ss_transitioning,
        oncology_fcr.ss_acumen,
        oncology_fcr.archive_flag,
        oncology_fcr.file_id,
        oncology_fcr.record_id
 FROM integration.oncology_fcr
 ORDER BY oncology_fcr.source_name,
          oncology_fcr.time_period,
          oncology_fcr.sales_force_id,
          oncology_fcr.territory_num,
          oncology_fcr.rep_id,
          oncology_fcr.contact_date,
          oncology_fcr.duration_days,
          oncology_fcr.ss_opening,
          oncology_fcr.ss_probing,
          oncology_fcr.ss_resources,
          oncology_fcr.ss_commitment,
          oncology_fcr.ss_transitioning,
          oncology_fcr.ss_acumen,
          oncology_fcr.archive_flag,
          oncology_fcr.file_id,
          oncology_fcr.record_id
SEGMENTED BY hash(oncology_fcr.record_id) ALL NODES;

CREATE PROJECTION integration.sample_shipment_v2_b0 /*+basename(sample_shipment_v2),createtype(L)*/ 
(
 tvcmid,
 hcp_veeva_id,
 hcp_first_name,
 hcp_middle_name,
 hcp_last_name,
 hcp_designation,
 hcp_state_license_number,
 hcp_address1,
 hcp_address2,
 hcp_address3,
 hcp_city,
 hcp_state,
 hcp_zip,
 dea_license_number,
 order_source_order_id,
 ndc,
 quantity,
 order_source_job_code,
 order_source_job_code_description,
 ship_date,
 file_id,
 record_id,
 TERRITORY,
 REPID,
 REPLASTNAME,
 REPMIDDLENAME,
 REPFIRSTNAME,
 signature_type,
 attendeename,
 literature_product_id,
 literature_product_name
)
AS
 SELECT sample_shipment.tvcmid,
        sample_shipment.hcp_veeva_id,
        sample_shipment.hcp_first_name,
        sample_shipment.hcp_middle_name,
        sample_shipment.hcp_last_name,
        sample_shipment.hcp_designation,
        sample_shipment.hcp_state_license_number,
        sample_shipment.hcp_address1,
        sample_shipment.hcp_address2,
        sample_shipment.hcp_address3,
        sample_shipment.hcp_city,
        sample_shipment.hcp_state,
        sample_shipment.hcp_zip,
        sample_shipment.dea_license_number,
        sample_shipment.order_source_order_id,
        sample_shipment.ndc,
        sample_shipment.quantity,
        sample_shipment.order_source_job_code,
        sample_shipment.order_source_job_code_description,
        sample_shipment.ship_date,
        sample_shipment.file_id,
        sample_shipment.record_id,
        sample_shipment.TERRITORY,
        sample_shipment.REPID,
        sample_shipment.REPLASTNAME,
        sample_shipment.REPMIDDLENAME,
        sample_shipment.REPFIRSTNAME,
        sample_shipment.signature_type,
        sample_shipment.attendeename,
        sample_shipment.literature_product_id,
        sample_shipment.literature_product_name
 FROM integration.sample_shipment
 ORDER BY sample_shipment.tvcmid,
          sample_shipment.hcp_veeva_id,
          sample_shipment.hcp_first_name,
          sample_shipment.hcp_middle_name,
          sample_shipment.hcp_last_name,
          sample_shipment.hcp_designation,
          sample_shipment.hcp_state_license_number,
          sample_shipment.hcp_address1,
          sample_shipment.hcp_address2,
          sample_shipment.hcp_address3,
          sample_shipment.hcp_city,
          sample_shipment.hcp_state,
          sample_shipment.hcp_zip,
          sample_shipment.dea_license_number,
          sample_shipment.order_source_order_id,
          sample_shipment.ndc,
          sample_shipment.quantity,
          sample_shipment.order_source_job_code,
          sample_shipment.order_source_job_code_description,
          sample_shipment.ship_date,
          sample_shipment.file_id,
          sample_shipment.record_id
SEGMENTED BY hash(sample_shipment.tvcmid, sample_shipment.hcp_state, sample_shipment.quantity, sample_shipment.ship_date, sample_shipment.file_id, sample_shipment.record_id, sample_shipment.hcp_zip, sample_shipment.order_source_job_code, sample_shipment.hcp_state_license_number, sample_shipment.dea_license_number, sample_shipment.order_source_order_id, sample_shipment.ndc, sample_shipment.hcp_veeva_id, sample_shipment.hcp_designation, sample_shipment.hcp_address1, sample_shipment.hcp_address2, sample_shipment.hcp_address3, sample_shipment.hcp_first_name, sample_shipment.hcp_middle_name, sample_shipment.hcp_last_name, sample_shipment.hcp_city, sample_shipment.order_source_job_code_description) ALL NODES;

CREATE PROJECTION integration.chargeback_demographics_b0 /*+basename(chargeback_demographics),createtype(L)*/ 
(
 account_id,
 location_id,
 dea_number,
 end_customer,
 address_1,
 address_2,
 city,
 state,
 zip,
 contract_title,
 contract_id,
 wholesaler_name,
 hin,
 contract_alias,
 wholesaler_dea,
 class_of_trade,
 cot_source,
 file_id,
 record_id
)
AS
 SELECT chargeback_demographics.account_id,
        chargeback_demographics.location_id,
        chargeback_demographics.dea_number,
        chargeback_demographics.end_customer,
        chargeback_demographics.address_1,
        chargeback_demographics.address_2,
        chargeback_demographics.city,
        chargeback_demographics.state,
        chargeback_demographics.zip,
        chargeback_demographics.contract_title,
        chargeback_demographics.contract_id,
        chargeback_demographics.wholesaler_name,
        chargeback_demographics.hin,
        chargeback_demographics.contract_alias,
        chargeback_demographics.wholesaler_dea,
        chargeback_demographics.class_of_trade,
        chargeback_demographics.cot_source,
        chargeback_demographics.file_id,
        chargeback_demographics.record_id
 FROM integration.chargeback_demographics
 ORDER BY chargeback_demographics.account_id,
          chargeback_demographics.location_id,
          chargeback_demographics.dea_number,
          chargeback_demographics.end_customer,
          chargeback_demographics.address_1,
          chargeback_demographics.address_2,
          chargeback_demographics.city,
          chargeback_demographics.state,
          chargeback_demographics.zip,
          chargeback_demographics.contract_title,
          chargeback_demographics.contract_id,
          chargeback_demographics.wholesaler_name,
          chargeback_demographics.hin,
          chargeback_demographics.contract_alias,
          chargeback_demographics.wholesaler_dea,
          chargeback_demographics.class_of_trade,
          chargeback_demographics.cot_source,
          chargeback_demographics.record_id
SEGMENTED BY hash(chargeback_demographics.record_id) ALL NODES;

CREATE PROJECTION integration.alternate_alignments_b0 /*+basename(alternate_alignments),createtype(L)*/ 
(
 zip_code,
 state_code,
 territory_number,
 territory_name,
 area_name,
 region_name,
 mirror_flag,
 mirror_territory_number,
 file_id,
 record_id,
 city
)
AS
 SELECT alternate_alignments.zip_code,
        alternate_alignments.state_code,
        alternate_alignments.territory_number,
        alternate_alignments.territory_name,
        alternate_alignments.area_name,
        alternate_alignments.region_name,
        alternate_alignments.mirror_flag,
        alternate_alignments.mirror_territory_number,
        alternate_alignments.file_id,
        alternate_alignments.record_id,
        alternate_alignments.city
 FROM integration.alternate_alignments
 ORDER BY alternate_alignments.zip_code,
          alternate_alignments.state_code,
          alternate_alignments.territory_number,
          alternate_alignments.territory_name,
          alternate_alignments.area_name,
          alternate_alignments.region_name,
          alternate_alignments.mirror_flag,
          alternate_alignments.mirror_territory_number,
          alternate_alignments.record_id
SEGMENTED BY hash(alternate_alignments.record_id) ALL NODES;

CREATE PROJECTION integration.oncology_sales_quotas_b0 /*+basename(oncology_sales_quotas),createtype(L)*/ 
(
 source_name,
 time_period,
 sales_force_id,
 territory_num,
 product_name,
 quota_qty,
 quota_dol,
 quota_strength_unit,
 file_id,
 record_id
)
AS
 SELECT oncology_sales_quotas.source_name,
        oncology_sales_quotas.time_period,
        oncology_sales_quotas.sales_force_id,
        oncology_sales_quotas.territory_num,
        oncology_sales_quotas.product_name,
        oncology_sales_quotas.quota_qty,
        oncology_sales_quotas.quota_dol,
        oncology_sales_quotas.quota_strength_unit,
        oncology_sales_quotas.file_id,
        oncology_sales_quotas.record_id
 FROM integration.oncology_sales_quotas
 ORDER BY oncology_sales_quotas.source_name,
          oncology_sales_quotas.time_period,
          oncology_sales_quotas.sales_force_id,
          oncology_sales_quotas.territory_num,
          oncology_sales_quotas.product_name,
          oncology_sales_quotas.quota_qty,
          oncology_sales_quotas.quota_dol,
          oncology_sales_quotas.quota_strength_unit,
          oncology_sales_quotas.file_id,
          oncology_sales_quotas.record_id
SEGMENTED BY hash(oncology_sales_quotas.record_id) ALL NODES;

CREATE PROJECTION integration.psr_report_b0 /*+basename(psr_report),createtype(L)*/ 
(
 prescriber_npi,
 prescriber_name,
 prescriber_state,
 product,
 month,
 indication,
 in_progress,
 completed,
 cancelled,
 psr_count,
 file_id,
 record_id
)
AS
 SELECT psr_report.prescriber_npi,
        psr_report.prescriber_name,
        psr_report.prescriber_state,
        psr_report.product,
        psr_report.month,
        psr_report.indication,
        psr_report.in_progress,
        psr_report.completed,
        psr_report.cancelled,
        psr_report.psr_count,
        psr_report.file_id,
        psr_report.record_id
 FROM integration.psr_report
 ORDER BY psr_report.prescriber_npi,
          psr_report.prescriber_name,
          psr_report.prescriber_state,
          psr_report.product,
          psr_report.month,
          psr_report.indication,
          psr_report.in_progress,
          psr_report.completed,
          psr_report.cancelled,
          psr_report.psr_count,
          psr_report.record_id
SEGMENTED BY hash(psr_report.record_id) ALL NODES;

CREATE PROJECTION integration.prescriber_rx_adhoc_b0 /*+basename(prescriber_rx_adhoc),createtype(L)*/ 
(
 source_name,
 client_number,
 report_number,
 zip_other,
 ims_id,
 specialty,
 plan_id,
 sales_category,
 rx_type,
 product_group,
 me_num,
 last_name,
 first_name,
 middle_name,
 address,
 city,
 state,
 zip,
 supplemental_data,
 plan_name,
 data_date,
 bucket_date,
 bucket_type,
 nrx_cnt,
 nrx_qty,
 trx_cnt,
 trx_qty,
 file_id,
 record_id,
 tvcmid,
 ims_id_modified
)
AS
 SELECT prescriber_rx_adhoc.source_name,
        prescriber_rx_adhoc.client_number,
        prescriber_rx_adhoc.report_number,
        prescriber_rx_adhoc.zip_other,
        prescriber_rx_adhoc.ims_id,
        prescriber_rx_adhoc.specialty,
        prescriber_rx_adhoc.plan_id,
        prescriber_rx_adhoc.sales_category,
        prescriber_rx_adhoc.rx_type,
        prescriber_rx_adhoc.product_group,
        prescriber_rx_adhoc.me_num,
        prescriber_rx_adhoc.last_name,
        prescriber_rx_adhoc.first_name,
        prescriber_rx_adhoc.middle_name,
        prescriber_rx_adhoc.address,
        prescriber_rx_adhoc.city,
        prescriber_rx_adhoc.state,
        prescriber_rx_adhoc.zip,
        prescriber_rx_adhoc.supplemental_data,
        prescriber_rx_adhoc.plan_name,
        prescriber_rx_adhoc.data_date,
        prescriber_rx_adhoc.bucket_date,
        prescriber_rx_adhoc.bucket_type,
        prescriber_rx_adhoc.nrx_cnt,
        prescriber_rx_adhoc.nrx_qty,
        prescriber_rx_adhoc.trx_cnt,
        prescriber_rx_adhoc.trx_qty,
        prescriber_rx_adhoc.file_id,
        prescriber_rx_adhoc.record_id,
        prescriber_rx_adhoc.tvcmid,
        prescriber_rx_adhoc.ims_id_modified
 FROM integration.prescriber_rx_adhoc
 ORDER BY prescriber_rx_adhoc.source_name,
          prescriber_rx_adhoc.client_number,
          prescriber_rx_adhoc.report_number,
          prescriber_rx_adhoc.zip_other,
          prescriber_rx_adhoc.ims_id,
          prescriber_rx_adhoc.specialty,
          prescriber_rx_adhoc.plan_id,
          prescriber_rx_adhoc.sales_category,
          prescriber_rx_adhoc.rx_type,
          prescriber_rx_adhoc.product_group,
          prescriber_rx_adhoc.me_num,
          prescriber_rx_adhoc.last_name,
          prescriber_rx_adhoc.first_name,
          prescriber_rx_adhoc.middle_name,
          prescriber_rx_adhoc.address,
          prescriber_rx_adhoc.city,
          prescriber_rx_adhoc.state,
          prescriber_rx_adhoc.zip,
          prescriber_rx_adhoc.supplemental_data,
          prescriber_rx_adhoc.plan_name,
          prescriber_rx_adhoc.data_date,
          prescriber_rx_adhoc.bucket_date,
          prescriber_rx_adhoc.bucket_type,
          prescriber_rx_adhoc.nrx_cnt,
          prescriber_rx_adhoc.nrx_qty,
          prescriber_rx_adhoc.trx_cnt,
          prescriber_rx_adhoc.trx_qty,
          prescriber_rx_adhoc.file_id,
          prescriber_rx_adhoc.record_id,
          prescriber_rx_adhoc.tvcmid,
          prescriber_rx_adhoc.ims_id_modified
SEGMENTED BY hash(prescriber_rx_adhoc.record_id) ALL NODES;

CREATE PROJECTION integration.xpd_core_metrics_b0 /*+basename(xpd_core_metrics),createtype(L)*/ 
(
 ims_client_number,
 ims_report_number,
 channel_indicator,
 ims_id,
 specialty,
 ims_product_group,
 month_ending,
 xpo_nrx,
 xpo_trx,
 unknown_nrx,
 unknown_trx,
 new_therapy_starts,
 continued_new,
 switch_to,
 add_on,
 restart_same_new,
 restart_different,
 continued_refill,
 restart_same_refill,
 switch_from,
 restart_different_from,
 add_to,
 market_new_to_brand_rx,
 dynamic_capture_rx,
 record_id,
 file_id
)
AS
 SELECT xpd_core_metrics.ims_client_number,
        xpd_core_metrics.ims_report_number,
        xpd_core_metrics.channel_indicator,
        xpd_core_metrics.ims_id,
        xpd_core_metrics.specialty,
        xpd_core_metrics.ims_product_group,
        xpd_core_metrics.month_ending,
        xpd_core_metrics.xpo_nrx,
        xpd_core_metrics.xpo_trx,
        xpd_core_metrics.unknown_nrx,
        xpd_core_metrics.unknown_trx,
        xpd_core_metrics.new_therapy_starts,
        xpd_core_metrics.continued_new,
        xpd_core_metrics.switch_to,
        xpd_core_metrics.add_on,
        xpd_core_metrics.restart_same_new,
        xpd_core_metrics.restart_different,
        xpd_core_metrics.continued_refill,
        xpd_core_metrics.restart_same_refill,
        xpd_core_metrics.switch_from,
        xpd_core_metrics.restart_different_from,
        xpd_core_metrics.add_to,
        xpd_core_metrics.market_new_to_brand_rx,
        xpd_core_metrics.dynamic_capture_rx,
        xpd_core_metrics.record_id,
        xpd_core_metrics.file_id
 FROM integration.xpd_core_metrics
 ORDER BY xpd_core_metrics.ims_client_number,
          xpd_core_metrics.ims_report_number,
          xpd_core_metrics.channel_indicator,
          xpd_core_metrics.ims_id
SEGMENTED BY hash(xpd_core_metrics.record_id) ALL NODES;

CREATE PROJECTION integration.xpd_demographics_b0 /*+basename(xpd_demographics),createtype(L)*/ 
(
 ims_client_number,
 ims_report_number,
 ims_id,
 last_name,
 first_name,
 middle_name,
 address_1,
 address_2,
 city,
 state,
 zip,
 specialty,
 specialty_description,
 trx_decile_retail,
 nrx_decile_retail,
 nbrx_decile_retail,
 trx_decile_mail,
 nrx_decile_mail,
 nbrx_decile_mail,
 market_prescriber_reliability_retail,
 market_prescriber_reliability_mail,
 record_id,
 file_id
)
AS
 SELECT xpd_demographics.ims_client_number,
        xpd_demographics.ims_report_number,
        xpd_demographics.ims_id,
        xpd_demographics.last_name,
        xpd_demographics.first_name,
        xpd_demographics.middle_name,
        xpd_demographics.address_1,
        xpd_demographics.address_2,
        xpd_demographics.city,
        xpd_demographics.state,
        xpd_demographics.zip,
        xpd_demographics.specialty,
        xpd_demographics.specialty_description,
        xpd_demographics.trx_decile_retail,
        xpd_demographics.nrx_decile_retail,
        xpd_demographics.nbrx_decile_retail,
        xpd_demographics.trx_decile_mail,
        xpd_demographics.nrx_decile_mail,
        xpd_demographics.nbrx_decile_mail,
        xpd_demographics.market_prescriber_reliability_retail,
        xpd_demographics.market_prescriber_reliability_mail,
        xpd_demographics.record_id,
        xpd_demographics.file_id
 FROM integration.xpd_demographics
 ORDER BY xpd_demographics.ims_client_number,
          xpd_demographics.ims_report_number,
          xpd_demographics.ims_id
SEGMENTED BY hash(xpd_demographics.record_id) ALL NODES;

CREATE PROJECTION integration.fia_geography_b0 /*+basename(fia_geography),createtype(L)*/ 
(
 zip_code,
 cbsa_code,
 cbsa_description,
 state_code,
 flexible_fld_1_char,
 flexible_fld_2_char,
 record_id,
 file_id,
 file_location
)
AS
 SELECT fia_geography.zip_code,
        fia_geography.cbsa_code,
        fia_geography.cbsa_description,
        fia_geography.state_code,
        fia_geography.flexible_fld_1_char,
        fia_geography.flexible_fld_2_char,
        fia_geography.record_id,
        fia_geography.file_id,
        fia_geography.file_location
 FROM integration.fia_geography
 ORDER BY fia_geography.zip_code,
          fia_geography.cbsa_code,
          fia_geography.cbsa_description,
          fia_geography.state_code,
          fia_geography.flexible_fld_1_char,
          fia_geography.flexible_fld_2_char,
          fia_geography.record_id
SEGMENTED BY hash(fia_geography.record_id) ALL NODES;

CREATE PROJECTION integration.fia_mpd_b0 /*+basename(fia_mpd),createtype(L)*/ 
(
 patient_id,
 mpd_year,
 mpd_eligibility_class,
 deductible_start_date,
 copay_start_date,
 gap_start_date,
 catastrophic_start_date,
 mpd_panel_patient,
 flexible_fld_1_char,
 flexible_fld_2_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_mpd.patient_id,
        fia_mpd.mpd_year,
        fia_mpd.mpd_eligibility_class,
        fia_mpd.deductible_start_date,
        fia_mpd.copay_start_date,
        fia_mpd.gap_start_date,
        fia_mpd.catastrophic_start_date,
        fia_mpd.mpd_panel_patient,
        fia_mpd.flexible_fld_1_char,
        fia_mpd.flexible_fld_2_char,
        fia_mpd.file_id,
        fia_mpd.record_id,
        fia_mpd.file_location
 FROM integration.fia_mpd
 ORDER BY fia_mpd.patient_id,
          fia_mpd.mpd_year,
          fia_mpd.mpd_eligibility_class,
          fia_mpd.deductible_start_date,
          fia_mpd.copay_start_date,
          fia_mpd.gap_start_date,
          fia_mpd.catastrophic_start_date,
          fia_mpd.mpd_panel_patient
SEGMENTED BY hash(fia_mpd.record_id) ALL NODES;

CREATE PROJECTION integration.fia_provider_b0 /*+basename(fia_provider),createtype(L)*/ 
(
 PROVIDER_ID,
 PROVIDER_TYPE,
 IQVIA_RXER_ID,
 PRIMARY_SPECIALTY_CODE,
 PRIMARY_SPECIALTY_DESC,
 FIRST_NAME,
 LAST_NAME,
 ORG_NM,
 ADDRESS,
 CITY,
 ZIP_CODE,
 STATE_CODE,
 PHONE_NUMBER,
 DEA_NUMBER,
 ME_NUMBER,
 FLEXIBLE_FLD_1_CHAR,
 FLEXIBLE_FLD_2_CHAR,
 record_id,
 file_id,
 file_location
)
AS
 SELECT fia_provider_old.PROVIDER_ID,
        fia_provider_old.PROVIDER_TYPE,
        fia_provider_old.IQVIA_RXER_ID,
        fia_provider_old.PRIMARY_SPECIALTY_CODE,
        fia_provider_old.PRIMARY_SPECIALTY_DESC,
        fia_provider_old.FIRST_NAME,
        fia_provider_old.LAST_NAME,
        fia_provider_old.ORG_NM,
        fia_provider_old.ADDRESS,
        fia_provider_old.CITY,
        fia_provider_old.ZIP_CODE,
        fia_provider_old.STATE_CODE,
        fia_provider_old.PHONE_NUMBER,
        fia_provider_old.DEA_NUMBER,
        fia_provider_old.ME_NUMBER,
        fia_provider_old.FLEXIBLE_FLD_1_CHAR,
        fia_provider_old.FLEXIBLE_FLD_2_CHAR,
        fia_provider_old.record_id,
        fia_provider_old.file_id,
        fia_provider_old.file_location
 FROM integration.fia_provider_old
 ORDER BY fia_provider_old.PROVIDER_ID,
          fia_provider_old.PROVIDER_TYPE,
          fia_provider_old.IQVIA_RXER_ID,
          fia_provider_old.PRIMARY_SPECIALTY_CODE,
          fia_provider_old.PRIMARY_SPECIALTY_DESC,
          fia_provider_old.FIRST_NAME,
          fia_provider_old.LAST_NAME,
          fia_provider_old.ORG_NM
SEGMENTED BY hash(fia_provider_old.PROVIDER_ID, fia_provider_old.PROVIDER_TYPE, fia_provider_old.IQVIA_RXER_ID, fia_provider_old.ZIP_CODE, fia_provider_old.STATE_CODE, fia_provider_old.record_id, fia_provider_old.file_id, fia_provider_old.PRIMARY_SPECIALTY_CODE) ALL NODES;

CREATE PROJECTION integration.fia_fact_v1_b0 /*+basename(fia_fact_v1),createtype(L)*/ 
(
 claim_id,
 patient_id,
 sequence_number,
 product_id,
 fill_date,
 claim_type,
 reject_code,
 days_supply,
 quantity,
 refill_code,
 plantrak_id,
 opc_ask,
 sec_plantrak_id,
 buy_down,
 opc_paid,
 prescriber_id,
 sob,
 sub_product_id,
 sub_opc,
 initial_claim_id,
 prev_product_id,
 daw_code,
 wrt_date,
 claim_status,
 copay_card_flg,
 zip_code,
 ecoup_flag,
 ecoup_offset_amt,
 standard_copay,
 standard_copay_yn,
 market_id,
 flexible_fld_1_char,
 flexible_fld_2_char,
 flexible_fld_3_char,
 flexible_fld_4_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_fact_v2_0917.claim_id,
        fia_fact_v2_0917.patient_id,
        fia_fact_v2_0917.sequence_number,
        fia_fact_v2_0917.product_id,
        fia_fact_v2_0917.fill_date,
        fia_fact_v2_0917.claim_type,
        fia_fact_v2_0917.reject_code,
        fia_fact_v2_0917.days_supply,
        fia_fact_v2_0917.quantity,
        fia_fact_v2_0917.refill_code,
        fia_fact_v2_0917.plantrak_id,
        fia_fact_v2_0917.opc_ask,
        fia_fact_v2_0917.sec_plantrak_id,
        fia_fact_v2_0917.buy_down,
        fia_fact_v2_0917.opc_paid,
        fia_fact_v2_0917.prescriber_id,
        fia_fact_v2_0917.sob,
        fia_fact_v2_0917.sub_product_id,
        fia_fact_v2_0917.sub_opc,
        fia_fact_v2_0917.initial_claim_id,
        fia_fact_v2_0917.prev_product_id,
        fia_fact_v2_0917.daw_code,
        fia_fact_v2_0917.wrt_date,
        fia_fact_v2_0917.claim_status,
        fia_fact_v2_0917.copay_card_flg,
        fia_fact_v2_0917.zip_code,
        fia_fact_v2_0917.ecoup_flag,
        fia_fact_v2_0917.ecoup_offset_amt,
        fia_fact_v2_0917.standard_copay,
        fia_fact_v2_0917.standard_copay_yn,
        fia_fact_v2_0917.market_id,
        fia_fact_v2_0917.flexible_fld_1_char,
        fia_fact_v2_0917.flexible_fld_2_char,
        fia_fact_v2_0917.flexible_fld_3_char,
        fia_fact_v2_0917.flexible_fld_4_char,
        fia_fact_v2_0917.file_id,
        fia_fact_v2_0917.record_id,
        fia_fact_v2_0917.file_location
 FROM integration.fia_fact_v2_0917
 ORDER BY fia_fact_v2_0917.claim_id,
          fia_fact_v2_0917.patient_id,
          fia_fact_v2_0917.sequence_number,
          fia_fact_v2_0917.product_id,
          fia_fact_v2_0917.fill_date,
          fia_fact_v2_0917.claim_type,
          fia_fact_v2_0917.reject_code,
          fia_fact_v2_0917.days_supply
SEGMENTED BY hash(fia_fact_v2_0917.record_id) ALL NODES;

CREATE PROJECTION integration.sales_867_b0 /*+basename(sales_867),createtype(L)*/ 
(
 trading_partner,
 partner_duns,
 partner_duns_4,
 partner_dea,
 partner_hin,
 partner_seller_assigned_id,
 partner_buyer_assigned_id,
 client_name,
 address1,
 address2,
 city,
 state,
 zip,
 client_duns,
 client_dea,
 client_hin,
 client_seller_assigned_id,
 client_buyer_assigned_id,
 ncpdp,
 ndc,
 item,
 ship_date,
 quantity_purchased,
 quantity_returned,
 unit_price,
 gross_amount,
 drop_shipments,
 file_id,
 record_id,
 source_name,
 tvcmid
)
AS
 SELECT sales_867.trading_partner,
        sales_867.partner_duns,
        sales_867.partner_duns_4,
        sales_867.partner_dea,
        sales_867.partner_hin,
        sales_867.partner_seller_assigned_id,
        sales_867.partner_buyer_assigned_id,
        sales_867.client_name,
        sales_867.address1,
        sales_867.address2,
        sales_867.city,
        sales_867.state,
        sales_867.zip,
        sales_867.client_duns,
        sales_867.client_dea,
        sales_867.client_hin,
        sales_867.client_seller_assigned_id,
        sales_867.client_buyer_assigned_id,
        sales_867.ncpdp,
        sales_867.ndc,
        sales_867.item,
        sales_867.ship_date,
        sales_867.quantity_purchased,
        sales_867.quantity_returned,
        sales_867.unit_price,
        sales_867.gross_amount,
        sales_867.drop_shipments,
        sales_867.file_id,
        sales_867.record_id,
        sales_867.source_name,
        sales_867.tvcmid
 FROM integration.sales_867
 ORDER BY sales_867.trading_partner,
          sales_867.partner_duns,
          sales_867.partner_duns_4,
          sales_867.partner_dea,
          sales_867.partner_hin,
          sales_867.partner_seller_assigned_id,
          sales_867.partner_buyer_assigned_id,
          sales_867.client_name,
          sales_867.address1,
          sales_867.address2,
          sales_867.city,
          sales_867.state,
          sales_867.zip,
          sales_867.client_duns,
          sales_867.client_dea,
          sales_867.client_hin,
          sales_867.client_seller_assigned_id,
          sales_867.client_buyer_assigned_id,
          sales_867.ncpdp,
          sales_867.ndc,
          sales_867.item,
          sales_867.ship_date,
          sales_867.quantity_purchased,
          sales_867.quantity_returned,
          sales_867.unit_price,
          sales_867.gross_amount,
          sales_867.drop_shipments
SEGMENTED BY hash(sales_867.record_id) ALL NODES;

CREATE PROJECTION integration.touchpoint_call_b0 /*+basename(touchpoint_call),createtype(L)*/ 
(
 source_name,
 call_id,
 call_attempt_id,
 touchpoint_id,
 client_id,
 ims_id,
 first_name,
 last_name,
 call_type,
 call_date,
 status_code,
 status_description,
 rep_id,
 rep_first_name,
 rep_last_name,
 file_id,
 record_id
)
AS
 SELECT touchpoint_call.source_name,
        touchpoint_call.call_id,
        touchpoint_call.call_attempt_id,
        touchpoint_call.touchpoint_id,
        touchpoint_call.client_id,
        touchpoint_call.ims_id,
        touchpoint_call.first_name,
        touchpoint_call.last_name,
        touchpoint_call.call_type,
        touchpoint_call.call_date,
        touchpoint_call.status_code,
        touchpoint_call.status_description,
        touchpoint_call.rep_id,
        touchpoint_call.rep_first_name,
        touchpoint_call.rep_last_name,
        touchpoint_call.file_id,
        touchpoint_call.record_id
 FROM integration.touchpoint_call
 ORDER BY touchpoint_call.source_name,
          touchpoint_call.call_id,
          touchpoint_call.call_attempt_id,
          touchpoint_call.touchpoint_id,
          touchpoint_call.client_id,
          touchpoint_call.ims_id,
          touchpoint_call.first_name,
          touchpoint_call.last_name,
          touchpoint_call.call_type,
          touchpoint_call.call_date,
          touchpoint_call.status_code,
          touchpoint_call.status_description,
          touchpoint_call.rep_id,
          touchpoint_call.rep_first_name,
          touchpoint_call.rep_last_name,
          touchpoint_call.file_id,
          touchpoint_call.record_id
SEGMENTED BY hash(touchpoint_call.record_id) ALL NODES;

CREATE PROJECTION integration.event_product_b0 /*+basename(event_product),createtype(L)*/ 
(
 source_system_name,
 event_number,
 product_id,
 product_name,
 topic_id,
 topic_name,
 file_id,
 record_id
)
AS
 SELECT event_product.source_system_name,
        event_product.event_number,
        event_product.product_id,
        event_product.product_name,
        event_product.topic_id,
        event_product.topic_name,
        event_product.file_id,
        event_product.record_id
 FROM integration.event_product
 ORDER BY event_product.source_system_name,
          event_product.event_number,
          event_product.product_id,
          event_product.product_name,
          event_product.topic_id,
          event_product.topic_name,
          event_product.file_id,
          event_product.record_id
SEGMENTED BY hash(event_product.record_id) ALL NODES;

CREATE PROJECTION integration.event_host_b0 /*+basename(event_host),createtype(L)*/ 
(
 source_system_name,
 event_number,
 employee_id,
 territory,
 ordinal,
 budget_percent,
 file_id,
 record_id
)
AS
 SELECT event_host.source_system_name,
        event_host.event_number,
        event_host.employee_id,
        event_host.territory,
        event_host.ordinal,
        event_host.budget_percent,
        event_host.file_id,
        event_host.record_id
 FROM integration.event_host
 ORDER BY event_host.source_system_name,
          event_host.event_number,
          event_host.employee_id,
          event_host.territory,
          event_host.ordinal,
          event_host.budget_percent,
          event_host.file_id,
          event_host.record_id
SEGMENTED BY hash(event_host.record_id) ALL NODES;

CREATE PROJECTION integration.event_expense_b0 /*+basename(event_expense),createtype(L)*/ 
(
 source_system_name,
 event_number,
 payment_id,
 expense_category,
 amount,
 remit_to_id,
 recipient_id,
 check_number,
 check_date,
 file_id,
 record_id
)
AS
 SELECT event_expense.source_system_name,
        event_expense.event_number,
        event_expense.payment_id,
        event_expense.expense_category,
        event_expense.amount,
        event_expense.remit_to_id,
        event_expense.recipient_id,
        event_expense.check_number,
        event_expense.check_date,
        event_expense.file_id,
        event_expense.record_id
 FROM integration.event_expense
 ORDER BY event_expense.source_system_name,
          event_expense.event_number,
          event_expense.payment_id,
          event_expense.expense_category,
          event_expense.amount,
          event_expense.remit_to_id,
          event_expense.recipient_id,
          event_expense.check_number,
          event_expense.check_date,
          event_expense.file_id,
          event_expense.record_id
SEGMENTED BY hash(event_expense.record_id) ALL NODES;

CREATE PROJECTION integration.sales_852_b0 /*+basename(sales_852),createtype(L)*/ 
(
 source_name,
 trading_partner,
 distribution_center,
 distribution_center_dea_number,
 reporting_date,
 product_name,
 description,
 ndc_11,
 quantity_received,
 quantity_received_dollars,
 quantity_sold,
 quantity_sold_dollars,
 quantity_omit,
 quantity_omit_dollars,
 month_end_quantity_on_hand,
 month_end_quantity_on_hand_dollars,
 month_end_committed,
 month_end_committed_dollars,
 month_end_reserved,
 month_end_reserved_dollars,
 quantity_return,
 quantity_return_dollars,
 quantity_customer_return,
 quantity_customer_return_dollars,
 file_id,
 record_id
)
AS
 SELECT sales_852.source_name,
        sales_852.trading_partner,
        sales_852.distribution_center,
        sales_852.distribution_center_dea_number,
        sales_852.reporting_date,
        sales_852.product_name,
        sales_852.description,
        sales_852.ndc_11,
        sales_852.quantity_received,
        sales_852.quantity_received_dollars,
        sales_852.quantity_sold,
        sales_852.quantity_sold_dollars,
        sales_852.quantity_omit,
        sales_852.quantity_omit_dollars,
        sales_852.month_end_quantity_on_hand,
        sales_852.month_end_quantity_on_hand_dollars,
        sales_852.month_end_committed,
        sales_852.month_end_committed_dollars,
        sales_852.month_end_reserved,
        sales_852.month_end_reserved_dollars,
        sales_852.quantity_return,
        sales_852.quantity_return_dollars,
        sales_852.quantity_customer_return,
        sales_852.quantity_customer_return_dollars,
        sales_852.file_id,
        sales_852.record_id
 FROM integration.sales_852
 ORDER BY sales_852.source_name,
          sales_852.trading_partner,
          sales_852.distribution_center,
          sales_852.distribution_center_dea_number,
          sales_852.reporting_date,
          sales_852.product_name,
          sales_852.description,
          sales_852.ndc_11,
          sales_852.quantity_received,
          sales_852.quantity_received_dollars,
          sales_852.quantity_sold,
          sales_852.quantity_sold_dollars,
          sales_852.quantity_omit,
          sales_852.quantity_omit_dollars,
          sales_852.month_end_quantity_on_hand,
          sales_852.month_end_quantity_on_hand_dollars,
          sales_852.month_end_committed,
          sales_852.month_end_committed_dollars,
          sales_852.month_end_reserved,
          sales_852.month_end_reserved_dollars,
          sales_852.quantity_return,
          sales_852.quantity_return_dollars,
          sales_852.quantity_customer_return,
          sales_852.quantity_customer_return_dollars,
          sales_852.file_id,
          sales_852.record_id
SEGMENTED BY hash(sales_852.record_id) ALL NODES;

CREATE PROJECTION integration.product_unit_ap_b0 /*+basename(product_unit_ap),createtype(L)*/ 
(
 source_name,
 source_ndc_code,
 source_description,
 unit_ap,
 file_id,
 record_id
)
AS
 SELECT product_unit_ap.source_name,
        product_unit_ap.source_ndc_code,
        product_unit_ap.source_description,
        product_unit_ap.unit_ap,
        product_unit_ap.file_id,
        product_unit_ap.record_id
 FROM integration.product_unit_ap
 ORDER BY product_unit_ap.source_name,
          product_unit_ap.source_ndc_code,
          product_unit_ap.source_description,
          product_unit_ap.unit_ap
SEGMENTED BY hash(product_unit_ap.file_id, product_unit_ap.record_id, product_unit_ap.unit_ap, product_unit_ap.source_ndc_code, product_unit_ap.source_description, product_unit_ap.source_name) ALL NODES;

CREATE PROJECTION integration.touchpoint_presentations_b0 /*+basename(touchpoint_presentations),createtype(L)*/ 
(
 source_name,
 call_id,
 call_attempt_id,
 presentation_id,
 product,
 position_number,
 item_type,
 item_description,
 quantity,
 file_id,
 record_id
)
AS
 SELECT touchpoint_presentations.source_name,
        touchpoint_presentations.call_id,
        touchpoint_presentations.call_attempt_id,
        touchpoint_presentations.presentation_id,
        touchpoint_presentations.product,
        touchpoint_presentations.position_number,
        touchpoint_presentations.item_type,
        touchpoint_presentations.item_description,
        touchpoint_presentations.quantity,
        touchpoint_presentations.file_id,
        touchpoint_presentations.record_id
 FROM integration.touchpoint_presentations
 ORDER BY touchpoint_presentations.source_name,
          touchpoint_presentations.call_id,
          touchpoint_presentations.call_attempt_id,
          touchpoint_presentations.presentation_id,
          touchpoint_presentations.product,
          touchpoint_presentations.position_number,
          touchpoint_presentations.item_type,
          touchpoint_presentations.item_description,
          touchpoint_presentations.quantity,
          touchpoint_presentations.file_id,
          touchpoint_presentations.record_id
SEGMENTED BY hash(touchpoint_presentations.call_id, touchpoint_presentations.call_attempt_id, touchpoint_presentations.presentation_id, touchpoint_presentations.position_number, touchpoint_presentations.quantity, touchpoint_presentations.file_id, touchpoint_presentations.record_id, touchpoint_presentations.product, touchpoint_presentations.item_type, touchpoint_presentations.item_description, touchpoint_presentations.source_name) ALL NODES;

CREATE PROJECTION integration.ims_week_buckets_b0 /*+basename(ims_week_buckets),createtype(A)*/ 
(
 ims_bucket,
 month_ending,
 month_bucket,
 split_week_ending,
 calendar_week,
 calendar_week_bucket,
 full_month
)
AS
 SELECT ims_week_buckets.ims_bucket,
        ims_week_buckets.month_ending,
        ims_week_buckets.month_bucket,
        ims_week_buckets.split_week_ending,
        ims_week_buckets.calendar_week,
        ims_week_buckets.calendar_week_bucket,
        ims_week_buckets.full_month
 FROM integration.ims_week_buckets
 ORDER BY ims_week_buckets.ims_bucket,
          ims_week_buckets.month_ending,
          ims_week_buckets.month_bucket,
          ims_week_buckets.split_week_ending,
          ims_week_buckets.calendar_week,
          ims_week_buckets.calendar_week_bucket,
          ims_week_buckets.full_month
SEGMENTED BY hash(ims_week_buckets.ims_bucket, ims_week_buckets.month_ending, ims_week_buckets.month_bucket, ims_week_buckets.split_week_ending, ims_week_buckets.calendar_week, ims_week_buckets.calendar_week_bucket, ims_week_buckets.full_month) ALL NODES;

CREATE PROJECTION integration.ddd_md_demographics_b0 /*+basename(ddd_md_demographics),createtype(L)*/ 
(
 source_name,
 client_number,
 report_number,
 ims_outlet_code,
 ims_facility_number,
 ims_prescriber_number,
 outlet_name,
 outlet_address,
 outlet_city,
 outlet_state,
 outlet_zip,
 facility_prescriber_name,
 facility_prescriber_address1,
 facility_prescriber_address2,
 facility_prescriber_city,
 facility_prescriber_state,
 facility_prescriber_zip,
 file_id,
 record_id,
 tvcmid_outlet,
 tvcmid_facility,
 tvcmid_prescriber
)
AS
 SELECT ddd_md_demographics.source_name,
        ddd_md_demographics.client_number,
        ddd_md_demographics.report_number,
        ddd_md_demographics.ims_outlet_code,
        ddd_md_demographics.ims_facility_number,
        ddd_md_demographics.ims_prescriber_number,
        ddd_md_demographics.outlet_name,
        ddd_md_demographics.outlet_address,
        ddd_md_demographics.outlet_city,
        ddd_md_demographics.outlet_state,
        ddd_md_demographics.outlet_zip,
        ddd_md_demographics.facility_prescriber_name,
        ddd_md_demographics.facility_prescriber_address1,
        ddd_md_demographics.facility_prescriber_address2,
        ddd_md_demographics.facility_prescriber_city,
        ddd_md_demographics.facility_prescriber_state,
        ddd_md_demographics.facility_prescriber_zip,
        ddd_md_demographics.file_id,
        ddd_md_demographics.record_id,
        ddd_md_demographics.tvcmid_outlet,
        ddd_md_demographics.tvcmid_facility,
        ddd_md_demographics.tvcmid_prescriber
 FROM integration.ddd_md_demographics
 ORDER BY ddd_md_demographics.source_name,
          ddd_md_demographics.client_number,
          ddd_md_demographics.report_number,
          ddd_md_demographics.ims_outlet_code,
          ddd_md_demographics.ims_facility_number,
          ddd_md_demographics.ims_prescriber_number,
          ddd_md_demographics.outlet_name,
          ddd_md_demographics.outlet_address,
          ddd_md_demographics.outlet_city,
          ddd_md_demographics.outlet_state,
          ddd_md_demographics.outlet_zip,
          ddd_md_demographics.facility_prescriber_name,
          ddd_md_demographics.facility_prescriber_address1,
          ddd_md_demographics.facility_prescriber_address2,
          ddd_md_demographics.facility_prescriber_city,
          ddd_md_demographics.facility_prescriber_state,
          ddd_md_demographics.facility_prescriber_zip
SEGMENTED BY hash(ddd_md_demographics.client_number, ddd_md_demographics.report_number, ddd_md_demographics.ims_prescriber_number, ddd_md_demographics.outlet_state, ddd_md_demographics.outlet_zip, ddd_md_demographics.facility_prescriber_state, ddd_md_demographics.facility_prescriber_zip, ddd_md_demographics.file_id, ddd_md_demographics.record_id, ddd_md_demographics.ims_outlet_code, ddd_md_demographics.ims_facility_number, ddd_md_demographics.outlet_name, ddd_md_demographics.outlet_city, ddd_md_demographics.facility_prescriber_city, ddd_md_demographics.facility_prescriber_address1, ddd_md_demographics.facility_prescriber_address2, ddd_md_demographics.facility_prescriber_name, ddd_md_demographics.outlet_address) ALL NODES;

CREATE PROJECTION integration.mm_accounts_b0 /*+basename(mm_accounts),createtype(L)*/ 
(
 source_name,
 id,
 provider_id,
 site_id,
 first_name,
 last_name,
 title,
 address_line_1,
 address_line_2,
 city,
 state,
 postal_code,
 phone_1,
 phone_2,
 phone_mobile,
 phone_fax,
 email,
 file_id,
 record_id
)
AS
 SELECT mm_accounts.source_name,
        mm_accounts.id,
        mm_accounts.provider_id,
        mm_accounts.site_id,
        mm_accounts.first_name,
        mm_accounts.last_name,
        mm_accounts.title,
        mm_accounts.address_line_1,
        mm_accounts.address_line_2,
        mm_accounts.city,
        mm_accounts.state,
        mm_accounts.postal_code,
        mm_accounts.phone_1,
        mm_accounts.phone_2,
        mm_accounts.phone_mobile,
        mm_accounts.phone_fax,
        mm_accounts.email,
        mm_accounts.file_id,
        mm_accounts.record_id
 FROM integration.mm_accounts
 ORDER BY mm_accounts.source_name,
          mm_accounts.id,
          mm_accounts.provider_id,
          mm_accounts.site_id,
          mm_accounts.first_name,
          mm_accounts.last_name,
          mm_accounts.title,
          mm_accounts.address_line_1,
          mm_accounts.address_line_2,
          mm_accounts.city,
          mm_accounts.state,
          mm_accounts.postal_code,
          mm_accounts.phone_1,
          mm_accounts.phone_2,
          mm_accounts.phone_mobile,
          mm_accounts.phone_fax,
          mm_accounts.email,
          mm_accounts.file_id,
          mm_accounts.record_id
SEGMENTED BY hash(mm_accounts.record_id) ALL NODES;

CREATE PROJECTION integration.mm_control_b0 /*+basename(mm_control),createtype(L)*/ 
(
 source_name,
 file_name,
 records,
 created_at,
 file_id,
 record_id
)
AS
 SELECT mm_control.source_name,
        mm_control.file_name,
        mm_control.records,
        mm_control.created_at,
        mm_control.file_id,
        mm_control.record_id
 FROM integration.mm_control
 ORDER BY mm_control.source_name,
          mm_control.file_name,
          mm_control.records,
          mm_control.created_at,
          mm_control.file_id,
          mm_control.record_id
SEGMENTED BY hash(mm_control.created_at, mm_control.file_id, mm_control.record_id, mm_control.file_name, mm_control.records) ALL NODES;

CREATE PROJECTION integration.mm_copays_b0 /*+basename(mm_copays),createtype(L)*/ 
(
 source_name,
 health_plan_id,
 tier,
 retail_copay,
 retail_coinsurance,
 mail_order_copay,
 mail_order_coinsurance,
 file_id,
 record_id
)
AS
 SELECT mm_copays.source_name,
        mm_copays.health_plan_id,
        mm_copays.tier,
        mm_copays.retail_copay,
        mm_copays.retail_coinsurance,
        mm_copays.mail_order_copay,
        mm_copays.mail_order_coinsurance,
        mm_copays.file_id,
        mm_copays.record_id
 FROM integration.mm_copays
 ORDER BY mm_copays.source_name,
          mm_copays.health_plan_id,
          mm_copays.tier,
          mm_copays.retail_copay,
          mm_copays.retail_coinsurance,
          mm_copays.mail_order_copay,
          mm_copays.mail_order_coinsurance,
          mm_copays.file_id,
          mm_copays.record_id
SEGMENTED BY hash(mm_copays.record_id) ALL NODES;

CREATE PROJECTION integration.mm_drug_class_therapeutic_area_b0 /*+basename(mm_drug_class_therapeutic_area),createtype(L)*/ 
(
 source_name,
 drug_class_id,
 therapeutic_area_id,
 therapeutic_area,
 file_id,
 record_id
)
AS
 SELECT mm_drug_class_therapeutic_area.source_name,
        mm_drug_class_therapeutic_area.drug_class_id,
        mm_drug_class_therapeutic_area.therapeutic_area_id,
        mm_drug_class_therapeutic_area.therapeutic_area,
        mm_drug_class_therapeutic_area.file_id,
        mm_drug_class_therapeutic_area.record_id
 FROM integration.mm_drug_class_therapeutic_area
 ORDER BY mm_drug_class_therapeutic_area.source_name,
          mm_drug_class_therapeutic_area.drug_class_id,
          mm_drug_class_therapeutic_area.therapeutic_area_id,
          mm_drug_class_therapeutic_area.therapeutic_area,
          mm_drug_class_therapeutic_area.file_id,
          mm_drug_class_therapeutic_area.record_id
SEGMENTED BY hash(mm_drug_class_therapeutic_area.drug_class_id, mm_drug_class_therapeutic_area.therapeutic_area_id, mm_drug_class_therapeutic_area.file_id, mm_drug_class_therapeutic_area.record_id, mm_drug_class_therapeutic_area.therapeutic_area) ALL NODES;

CREATE PROJECTION integration.mm_drugs_b0 /*+basename(mm_drugs),createtype(L)*/ 
(
 source_name,
 drug_class_id,
 drug_class,
 drug_id,
 drug,
 generic,
 manufacturer,
 file_id,
 record_id
)
AS
 SELECT mm_drugs.source_name,
        mm_drugs.drug_class_id,
        mm_drugs.drug_class,
        mm_drugs.drug_id,
        mm_drugs.drug,
        mm_drugs.generic,
        mm_drugs.manufacturer,
        mm_drugs.file_id,
        mm_drugs.record_id
 FROM integration.mm_drugs
 ORDER BY mm_drugs.source_name,
          mm_drugs.drug_class_id,
          mm_drugs.drug_class,
          mm_drugs.drug_id,
          mm_drugs.drug,
          mm_drugs.generic,
          mm_drugs.manufacturer,
          mm_drugs.file_id,
          mm_drugs.record_id
SEGMENTED BY hash(mm_drugs.drug_class_id, mm_drugs.drug_id, mm_drugs.file_id, mm_drugs.record_id, mm_drugs.drug_class, mm_drugs.drug, mm_drugs.generic, mm_drugs.manufacturer) ALL NODES;

CREATE PROJECTION integration.mm_formularies_b0 /*+basename(mm_formularies),createtype(L)*/ 
(
 source_name,
 health_plan_id,
 drug_id,
 tier_code,
 restrictions,
 reason_code,
 reason_code_description,
 file_id,
 record_id
)
AS
 SELECT mm_formularies.source_name,
        mm_formularies.health_plan_id,
        mm_formularies.drug_id,
        mm_formularies.tier_code,
        mm_formularies.restrictions,
        mm_formularies.reason_code,
        mm_formularies.reason_code_description,
        mm_formularies.file_id,
        mm_formularies.record_id
 FROM integration.mm_formularies
 ORDER BY mm_formularies.source_name,
          mm_formularies.health_plan_id,
          mm_formularies.drug_id,
          mm_formularies.tier_code,
          mm_formularies.restrictions,
          mm_formularies.reason_code,
          mm_formularies.reason_code_description,
          mm_formularies.file_id,
          mm_formularies.record_id
SEGMENTED BY hash(mm_formularies.record_id) ALL NODES;

CREATE PROJECTION integration.mm_health_plan_geography_b0 /*+basename(mm_health_plan_geography),createtype(L)*/ 
(
 source_name,
 health_plan_id,
 operating_state,
 lives_coverage,
 file_id,
 record_id
)
AS
 SELECT mm_health_plan_geography.source_name,
        mm_health_plan_geography.health_plan_id,
        mm_health_plan_geography.operating_state,
        mm_health_plan_geography.lives_coverage,
        mm_health_plan_geography.file_id,
        mm_health_plan_geography.record_id
 FROM integration.mm_health_plan_geography
 ORDER BY mm_health_plan_geography.source_name,
          mm_health_plan_geography.health_plan_id,
          mm_health_plan_geography.operating_state,
          mm_health_plan_geography.lives_coverage,
          mm_health_plan_geography.file_id,
          mm_health_plan_geography.record_id
SEGMENTED BY hash(mm_health_plan_geography.record_id) ALL NODES;

CREATE PROJECTION integration.mm_health_plans_b0 /*+basename(mm_health_plans),createtype(L)*/ 
(
 source_name,
 formularyf_id,
 provider_id,
 provider,
 health_plan_id,
 health_plan,
 parent_id,
 parent,
 national_lives_count,
 plan_type_name,
 preferred_brand_tier,
 file_id,
 record_id
)
AS
 SELECT mm_health_plans.source_name,
        mm_health_plans.formularyf_id,
        mm_health_plans.provider_id,
        mm_health_plans.provider,
        mm_health_plans.health_plan_id,
        mm_health_plans.health_plan,
        mm_health_plans.parent_id,
        mm_health_plans.parent,
        mm_health_plans.national_lives_count,
        mm_health_plans.plan_type_name,
        mm_health_plans.preferred_brand_tier,
        mm_health_plans.file_id,
        mm_health_plans.record_id
 FROM integration.mm_health_plans
 ORDER BY mm_health_plans.source_name,
          mm_health_plans.formularyf_id,
          mm_health_plans.provider_id,
          mm_health_plans.provider,
          mm_health_plans.health_plan_id,
          mm_health_plans.health_plan,
          mm_health_plans.parent_id,
          mm_health_plans.parent,
          mm_health_plans.national_lives_count,
          mm_health_plans.plan_type_name,
          mm_health_plans.preferred_brand_tier,
          mm_health_plans.file_id,
          mm_health_plans.record_id
SEGMENTED BY hash(mm_health_plans.record_id) ALL NODES;

CREATE PROJECTION integration.mm_ims_bridge_b0 /*+basename(mm_ims_bridge),createtype(L)*/ 
(
 source_name,
 payer_name,
 code,
 name,
 state,
 comments,
 plan_id,
 plan_name,
 provider_name,
 plan_type_name,
 file_id,
 record_id
)
AS
 SELECT mm_ims_bridge.source_name,
        mm_ims_bridge.payer_name,
        mm_ims_bridge.code,
        mm_ims_bridge.name,
        mm_ims_bridge.state,
        mm_ims_bridge.comments,
        mm_ims_bridge.plan_id,
        mm_ims_bridge.plan_name,
        mm_ims_bridge.provider_name,
        mm_ims_bridge.plan_type_name,
        mm_ims_bridge.file_id,
        mm_ims_bridge.record_id
 FROM integration.mm_ims_bridge
 ORDER BY mm_ims_bridge.source_name,
          mm_ims_bridge.payer_name,
          mm_ims_bridge.code,
          mm_ims_bridge.name,
          mm_ims_bridge.state,
          mm_ims_bridge.comments,
          mm_ims_bridge.plan_id,
          mm_ims_bridge.plan_name,
          mm_ims_bridge.provider_name,
          mm_ims_bridge.plan_type_name,
          mm_ims_bridge.file_id,
          mm_ims_bridge.record_id
SEGMENTED BY hash(mm_ims_bridge.record_id) ALL NODES;

CREATE PROJECTION integration.mm_pbms_b0 /*+basename(mm_pbms),createtype(L)*/ 
(
 source_name,
 health_plan_id,
 pbm_id,
 pbm,
 pbm_function_id,
 pbm_function,
 file_id,
 record_id
)
AS
 SELECT mm_pbms.source_name,
        mm_pbms.health_plan_id,
        mm_pbms.pbm_id,
        mm_pbms.pbm,
        mm_pbms.pbm_function_id,
        mm_pbms.pbm_function,
        mm_pbms.file_id,
        mm_pbms.record_id
 FROM integration.mm_pbms
 ORDER BY mm_pbms.source_name,
          mm_pbms.health_plan_id,
          mm_pbms.pbm_id,
          mm_pbms.pbm,
          mm_pbms.pbm_function_id,
          mm_pbms.pbm_function,
          mm_pbms.file_id,
          mm_pbms.record_id
SEGMENTED BY hash(mm_pbms.record_id) ALL NODES;

CREATE PROJECTION integration.mm_restrictions_b0 /*+basename(mm_restrictions),createtype(L)*/ 
(
 source_name,
 health_plan_id,
 drug_id,
 restriction_detail_id,
 restriction_code,
 formulary_entry_restriction_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 record_id,
 file_id
)
AS
 SELECT mm_restrictions.source_name,
        mm_restrictions.health_plan_id,
        mm_restrictions.drug_id,
        mm_restrictions.restriction_detail_id,
        mm_restrictions.restriction_code,
        mm_restrictions.formulary_entry_restriction_id,
        mm_restrictions.restriction_detail_text,
        mm_restrictions.restriction_addtnl_information_1,
        mm_restrictions.restriction_addtnl_information_2,
        mm_restrictions.record_id,
        mm_restrictions.file_id
 FROM integration.mm_restrictions
 ORDER BY mm_restrictions.source_name,
          mm_restrictions.health_plan_id,
          mm_restrictions.drug_id,
          mm_restrictions.restriction_detail_id,
          mm_restrictions.restriction_code,
          mm_restrictions.formulary_entry_restriction_id,
          mm_restrictions.restriction_detail_text,
          mm_restrictions.restriction_addtnl_information_1,
          mm_restrictions.restriction_addtnl_information_2,
          mm_restrictions.record_id,
          mm_restrictions.file_id
SEGMENTED BY hash(mm_restrictions.record_id) ALL NODES;

CREATE PROJECTION integration.mm_tiers_b0 /*+basename(mm_tiers),createtype(L)*/ 
(
 source_name,
 id,
 name,
 code_name,
 explanation_text,
 file_id,
 record_id
)
AS
 SELECT mm_tiers.source_name,
        mm_tiers.id,
        mm_tiers.name,
        mm_tiers.code_name,
        mm_tiers.explanation_text,
        mm_tiers.file_id,
        mm_tiers.record_id
 FROM integration.mm_tiers
 ORDER BY mm_tiers.source_name,
          mm_tiers.id,
          mm_tiers.name,
          mm_tiers.code_name,
          mm_tiers.explanation_text,
          mm_tiers.file_id,
          mm_tiers.record_id
SEGMENTED BY hash(mm_tiers.file_id, mm_tiers.record_id, mm_tiers.code_name, mm_tiers.id, mm_tiers.name, mm_tiers.explanation_text) ALL NODES;

CREATE PROJECTION integration.mm_wk_bridge_b0 /*+basename(mm_wk_bridge),createtype(L)*/ 
(
 source_name,
 name,
 amc_number,
 pbm_amc_number,
 plan_type_code,
 zip_code,
 comments,
 ff_plan_id,
 ff_plan_name,
 ff_provider_name,
 ff_plan_type,
 file_id,
 record_id
)
AS
 SELECT mm_wk_bridge.source_name,
        mm_wk_bridge.name,
        mm_wk_bridge.amc_number,
        mm_wk_bridge.pbm_amc_number,
        mm_wk_bridge.plan_type_code,
        mm_wk_bridge.zip_code,
        mm_wk_bridge.comments,
        mm_wk_bridge.ff_plan_id,
        mm_wk_bridge.ff_plan_name,
        mm_wk_bridge.ff_provider_name,
        mm_wk_bridge.ff_plan_type,
        mm_wk_bridge.file_id,
        mm_wk_bridge.record_id
 FROM integration.mm_wk_bridge
 ORDER BY mm_wk_bridge.source_name,
          mm_wk_bridge.name,
          mm_wk_bridge.amc_number,
          mm_wk_bridge.pbm_amc_number,
          mm_wk_bridge.plan_type_code,
          mm_wk_bridge.zip_code,
          mm_wk_bridge.comments,
          mm_wk_bridge.ff_plan_id,
          mm_wk_bridge.ff_plan_name,
          mm_wk_bridge.ff_provider_name,
          mm_wk_bridge.ff_plan_type,
          mm_wk_bridge.file_id,
          mm_wk_bridge.record_id
SEGMENTED BY hash(mm_wk_bridge.record_id) ALL NODES;

CREATE PROJECTION integration.rems_prescriber_b0 /*+basename(rems_prescriber),createtype(L)*/ 
(
 source_name,
 program_id,
 program_name,
 channel,
 enrollment_id,
 first_name,
 middle_name,
 last_name,
 credential,
 site_name,
 address_line_1,
 address_line_2,
 city,
 state_code,
 zip,
 status,
 phone,
 effective_date,
 expiration_date,
 npi,
 dea_number,
 obsolescence_date,
 ppaf_count,
 file_id,
 record_id,
 in_progress_step,
 tvcmid
)
AS
 SELECT rems_prescriber.source_name,
        rems_prescriber.program_id,
        rems_prescriber.program_name,
        rems_prescriber.channel,
        rems_prescriber.enrollment_id,
        rems_prescriber.first_name,
        rems_prescriber.middle_name,
        rems_prescriber.last_name,
        rems_prescriber.credential,
        rems_prescriber.site_name,
        rems_prescriber.address_line_1,
        rems_prescriber.address_line_2,
        rems_prescriber.city,
        rems_prescriber.state_code,
        rems_prescriber.zip,
        rems_prescriber.status,
        rems_prescriber.phone,
        rems_prescriber.effective_date,
        rems_prescriber.expiration_date,
        rems_prescriber.npi,
        rems_prescriber.dea_number,
        rems_prescriber.obsolescence_date,
        rems_prescriber.ppaf_count,
        rems_prescriber.file_id,
        rems_prescriber.record_id,
        rems_prescriber.in_progress_step,
        rems_prescriber.tvcmid
 FROM integration.rems_prescriber
 ORDER BY rems_prescriber.source_name,
          rems_prescriber.program_id,
          rems_prescriber.program_name,
          rems_prescriber.channel,
          rems_prescriber.enrollment_id,
          rems_prescriber.first_name,
          rems_prescriber.middle_name,
          rems_prescriber.last_name,
          rems_prescriber.credential,
          rems_prescriber.site_name,
          rems_prescriber.address_line_1,
          rems_prescriber.address_line_2,
          rems_prescriber.city,
          rems_prescriber.state_code,
          rems_prescriber.zip,
          rems_prescriber.status,
          rems_prescriber.phone,
          rems_prescriber.effective_date,
          rems_prescriber.expiration_date,
          rems_prescriber.npi,
          rems_prescriber.dea_number,
          rems_prescriber.obsolescence_date,
          rems_prescriber.ppaf_count
SEGMENTED BY hash(rems_prescriber.record_id) ALL NODES;

CREATE PROJECTION integration.copay_weekly_b0 /*+basename(copay_weekly),createtype(L)*/ 
(
 source_name,
 trans_type,
 asi_txn_id,
 orig_asi_txn_id,
 rx_number,
 rx_date,
 date_written,
 days_supply,
 ndc_code,
 daw,
 drug_name,
 drug_description,
 new_refill,
 quantity,
 refills,
 other_coverage_code,
 group_number,
 member_id,
 sex,
 age_at_redemption,
 status,
 patient_paid_amount_qualifier,
 pharmacy_process_date,
 nabp,
 pharmacy_chain,
 pharmacy_name,
 pharmacy_address,
 pharmacy_address2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_npi_number,
 principle_phys_dea_number,
 phys_npi,
 physician_name,
 physician_first_name,
 physician_middle_name,
 physician_last_name,
 physician_suffix,
 physician_prof_desg,
 spec1,
 spec2,
 asi_phys_address1,
 asi_phys_address2,
 asi_phys_city,
 asi_phys_state,
 asi_phys_zip,
 submission_method,
 patient_benefit,
 pharmacy_fee,
 total_amount_authorized,
 patient_copay,
 patient_oop,
 linked_card,
 doctor_state_license_number,
 sln_state,
 program_name,
 customer_physician_id,
 provider_reimbursement,
 coupon_amount,
 file_id,
 record_id,
 tvcmid_pharmacy,
 tvcmid_physician
)
AS
 SELECT copay_weekly.source_name,
        copay_weekly.trans_type,
        copay_weekly.asi_txn_id,
        copay_weekly.orig_asi_txn_id,
        copay_weekly.rx_number,
        copay_weekly.rx_date,
        copay_weekly.date_written,
        copay_weekly.days_supply,
        copay_weekly.ndc_code,
        copay_weekly.daw,
        copay_weekly.drug_name,
        copay_weekly.drug_description,
        copay_weekly.new_refill,
        copay_weekly.quantity,
        copay_weekly.refills,
        copay_weekly.other_coverage_code,
        copay_weekly.group_number,
        copay_weekly.member_id,
        copay_weekly.sex,
        copay_weekly.age_at_redemption,
        copay_weekly.status,
        copay_weekly.patient_paid_amount_qualifier,
        copay_weekly.pharmacy_process_date,
        copay_weekly.nabp,
        copay_weekly.pharmacy_chain,
        copay_weekly.pharmacy_name,
        copay_weekly.pharmacy_address,
        copay_weekly.pharmacy_address2,
        copay_weekly.pharmacy_city,
        copay_weekly.pharmacy_state,
        copay_weekly.pharmacy_zip,
        copay_weekly.pharmacy_npi_number,
        copay_weekly.principle_phys_dea_number,
        copay_weekly.phys_npi,
        copay_weekly.physician_name,
        copay_weekly.physician_first_name,
        copay_weekly.physician_middle_name,
        copay_weekly.physician_last_name,
        copay_weekly.physician_suffix,
        copay_weekly.physician_prof_desg,
        copay_weekly.spec1,
        copay_weekly.spec2,
        copay_weekly.asi_phys_address1,
        copay_weekly.asi_phys_address2,
        copay_weekly.asi_phys_city,
        copay_weekly.asi_phys_state,
        copay_weekly.asi_phys_zip,
        copay_weekly.submission_method,
        copay_weekly.patient_benefit,
        copay_weekly.pharmacy_fee,
        copay_weekly.total_amount_authorized,
        copay_weekly.patient_copay,
        copay_weekly.patient_oop,
        copay_weekly.linked_card,
        copay_weekly.doctor_state_license_number,
        copay_weekly.sln_state,
        copay_weekly.program_name,
        copay_weekly.customer_physician_id,
        copay_weekly.provider_reimbursement,
        copay_weekly.coupon_amount,
        copay_weekly.file_id,
        copay_weekly.record_id,
        copay_weekly.tvcmid_pharmacy,
        copay_weekly.tvcmid_physician
 FROM integration.copay_weekly
 ORDER BY copay_weekly.source_name,
          copay_weekly.trans_type,
          copay_weekly.asi_txn_id,
          copay_weekly.orig_asi_txn_id,
          copay_weekly.rx_number,
          copay_weekly.rx_date,
          copay_weekly.date_written,
          copay_weekly.days_supply,
          copay_weekly.ndc_code,
          copay_weekly.daw,
          copay_weekly.drug_name,
          copay_weekly.drug_description,
          copay_weekly.new_refill,
          copay_weekly.quantity,
          copay_weekly.refills,
          copay_weekly.other_coverage_code,
          copay_weekly.group_number,
          copay_weekly.member_id,
          copay_weekly.sex,
          copay_weekly.age_at_redemption,
          copay_weekly.status,
          copay_weekly.patient_paid_amount_qualifier,
          copay_weekly.pharmacy_process_date,
          copay_weekly.nabp,
          copay_weekly.pharmacy_chain,
          copay_weekly.pharmacy_name,
          copay_weekly.pharmacy_address,
          copay_weekly.pharmacy_address2,
          copay_weekly.pharmacy_city,
          copay_weekly.pharmacy_state,
          copay_weekly.pharmacy_zip,
          copay_weekly.pharmacy_npi_number,
          copay_weekly.principle_phys_dea_number,
          copay_weekly.phys_npi,
          copay_weekly.physician_name,
          copay_weekly.physician_first_name,
          copay_weekly.physician_middle_name,
          copay_weekly.physician_last_name,
          copay_weekly.physician_suffix,
          copay_weekly.physician_prof_desg,
          copay_weekly.spec1,
          copay_weekly.spec2,
          copay_weekly.asi_phys_address1,
          copay_weekly.asi_phys_address2,
          copay_weekly.asi_phys_city,
          copay_weekly.asi_phys_state,
          copay_weekly.asi_phys_zip,
          copay_weekly.submission_method,
          copay_weekly.patient_benefit,
          copay_weekly.pharmacy_fee,
          copay_weekly.total_amount_authorized,
          copay_weekly.patient_copay,
          copay_weekly.patient_oop,
          copay_weekly.linked_card,
          copay_weekly.doctor_state_license_number,
          copay_weekly.sln_state,
          copay_weekly.program_name,
          copay_weekly.customer_physician_id,
          copay_weekly.provider_reimbursement,
          copay_weekly.coupon_amount
SEGMENTED BY hash(copay_weekly.record_id) ALL NODES;

CREATE PROJECTION integration.clozapine_sales_b0 /*+basename(clozapine_sales),createtype(L)*/ 
(
 source_name,
 transaction_id,
 invoice_date,
 product_brand,
 product_ndc,
 product_desc,
 invoice_qty,
 invoice_units,
 invoice_cost,
 invoice_pack_cost,
 invoice_unit_cost,
 contract_pack_cost,
 contract_purchases,
 contract_number,
 dispensing_location,
 dl_address_1,
 dl_address_2,
 dl_city,
 dl_state,
 dl_zip,
 dl_dea_number,
 depot_location,
 dep_address_1,
 dep_address_2,
 dep_city,
 dep_state,
 dep_zip,
 dep_dea_number,
 file_id,
 record_id
)
AS
 SELECT clozapine_sales.source_name,
        clozapine_sales.transaction_id,
        clozapine_sales.invoice_date,
        clozapine_sales.product_brand,
        clozapine_sales.product_ndc,
        clozapine_sales.product_desc,
        clozapine_sales.invoice_qty,
        clozapine_sales.invoice_units,
        clozapine_sales.invoice_cost,
        clozapine_sales.invoice_pack_cost,
        clozapine_sales.invoice_unit_cost,
        clozapine_sales.contract_pack_cost,
        clozapine_sales.contract_purchases,
        clozapine_sales.contract_number,
        clozapine_sales.dispensing_location,
        clozapine_sales.dl_address_1,
        clozapine_sales.dl_address_2,
        clozapine_sales.dl_city,
        clozapine_sales.dl_state,
        clozapine_sales.dl_zip,
        clozapine_sales.dl_dea_number,
        clozapine_sales.depot_location,
        clozapine_sales.dep_address_1,
        clozapine_sales.dep_address_2,
        clozapine_sales.dep_city,
        clozapine_sales.dep_state,
        clozapine_sales.dep_zip,
        clozapine_sales.dep_dea_number,
        clozapine_sales.file_id,
        clozapine_sales.record_id
 FROM integration.clozapine_sales
 ORDER BY clozapine_sales.transaction_id
SEGMENTED BY hash(clozapine_sales.invoice_date, clozapine_sales.invoice_cost, clozapine_sales.invoice_pack_cost, clozapine_sales.invoice_unit_cost, clozapine_sales.contract_pack_cost, clozapine_sales.contract_purchases, clozapine_sales.dl_state, clozapine_sales.dl_zip, clozapine_sales.dep_state, clozapine_sales.dep_zip, clozapine_sales.file_id, clozapine_sales.record_id, clozapine_sales.invoice_qty, clozapine_sales.invoice_units, clozapine_sales.product_ndc, clozapine_sales.dl_dea_number, clozapine_sales.dep_dea_number, clozapine_sales.product_brand, clozapine_sales.dl_city, clozapine_sales.dep_city, clozapine_sales.transaction_id, clozapine_sales.product_desc, clozapine_sales.contract_number, clozapine_sales.dispensing_location, clozapine_sales.dl_address_1, clozapine_sales.dl_address_2, clozapine_sales.depot_location, clozapine_sales.dep_address_1, clozapine_sales.dep_address_2) ALL NODES;

CREATE PROJECTION integration.event_speaker_license_b0 /*+basename(event_speaker_license)*/ 
(
 source_system_name,
 speaker_id,
 state_code,
 state_license_number,
 state_license_effective_date,
 state_license_expiration_date,
 file_id,
 record_id
)
AS
 SELECT speaker_license.source_system_name,
        speaker_license.speaker_id,
        speaker_license.state_code,
        speaker_license.state_license_number,
        speaker_license.state_license_effective_date,
        speaker_license.state_license_expiration_date,
        speaker_license.file_id,
        speaker_license.record_id
 FROM integration.speaker_license
 ORDER BY speaker_license.source_system_name,
          speaker_license.speaker_id,
          speaker_license.state_code,
          speaker_license.state_license_number,
          speaker_license.state_license_effective_date,
          speaker_license.state_license_expiration_date,
          speaker_license.file_id,
          speaker_license.record_id
SEGMENTED BY hash(speaker_license.record_id) ALL NODES;

CREATE PROJECTION integration.speaker_training_b0 /*+basename(speaker_training)*/ 
(
 source_system_name,
 speaker_id,
 topic_id,
 effective_date,
 expiration_date,
 file_id,
 record_id
)
AS
 SELECT speaker_training.source_system_name,
        speaker_training.speaker_id,
        speaker_training.topic_id,
        speaker_training.effective_date,
        speaker_training.expiration_date,
        speaker_training.file_id,
        speaker_training.record_id
 FROM integration.speaker_training
 ORDER BY speaker_training.source_system_name,
          speaker_training.speaker_id,
          speaker_training.topic_id,
          speaker_training.effective_date,
          speaker_training.expiration_date,
          speaker_training.file_id,
          speaker_training.record_id
SEGMENTED BY hash(speaker_training.record_id) ALL NODES;

CREATE PROJECTION integration.topic_product_b0 /*+basename(topic_product)*/ 
(
 source_system_name,
 topic_id,
 topic_name,
 product_id,
 product_name,
 effective_date,
 expiration_date,
 file_id,
 record_id
)
AS
 SELECT topic_product.source_system_name,
        topic_product.topic_id,
        topic_product.topic_name,
        topic_product.product_id,
        topic_product.product_name,
        topic_product.effective_date,
        topic_product.expiration_date,
        topic_product.file_id,
        topic_product.record_id
 FROM integration.topic_product
 ORDER BY topic_product.source_system_name,
          topic_product.topic_id,
          topic_product.topic_name,
          topic_product.product_id,
          topic_product.product_name,
          topic_product.effective_date,
          topic_product.expiration_date,
          topic_product.file_id,
          topic_product.record_id
SEGMENTED BY hash(topic_product.record_id) ALL NODES;

CREATE PROJECTION integration.mm_predominant_b0 /*+basename(mm_predominant),createtype(L)*/ 
(
 source_name,
 ims_plan_id,
 ims_plan_name,
 ff_plan_id,
 ff_plan_name,
 record_id,
 file_id
)
AS
 SELECT mm_predominant.source_name,
        mm_predominant.ims_plan_id,
        mm_predominant.ims_plan_name,
        mm_predominant.ff_plan_id,
        mm_predominant.ff_plan_name,
        mm_predominant.record_id,
        mm_predominant.file_id
 FROM integration.mm_predominant
 ORDER BY mm_predominant.ims_plan_id,
          mm_predominant.ims_plan_name,
          mm_predominant.ff_plan_id,
          mm_predominant.ff_plan_name,
          mm_predominant.record_id
SEGMENTED BY hash(mm_predominant.record_id) ALL NODES;

CREATE PROJECTION integration.event_attendee_b0 /*+basename(event_attendee),createtype(L)*/ 
(
 source_system_name,
 event_number,
 employee_id,
 attendee_id,
 attendee_last_name,
 attendee_first_name,
 attendee_middle_name,
 attendee_title,
 attendee_specialty,
 attendee_degree,
 attendee_address_line_1,
 attendee_address_line_2,
 attendee_address_line_3,
 attendee_city,
 attendee_state_province,
 attendee_postal_code,
 attendee_postal_extended_code,
 attendee_phone,
 attendee_fax,
 attendee_email,
 dea_number,
 ims_number,
 me_number,
 npi_number,
 attendee_category_code,
 attended,
 meal,
 file_id,
 record_id,
 non_hcp_count,
 other_hcp_count,
 customer_id,
 attendee_address_line_4
)
AS
 SELECT event_attendee.source_system_name,
        event_attendee.event_number,
        event_attendee.employee_id,
        event_attendee.attendee_id,
        event_attendee.attendee_last_name,
        event_attendee.attendee_first_name,
        event_attendee.attendee_middle_name,
        event_attendee.attendee_title,
        event_attendee.attendee_specialty,
        event_attendee.attendee_degree,
        event_attendee.attendee_address_line_1,
        event_attendee.attendee_address_line_2,
        event_attendee.attendee_address_line_3,
        event_attendee.attendee_city,
        event_attendee.attendee_state_province,
        event_attendee.attendee_postal_code,
        event_attendee.attendee_postal_extended_code,
        event_attendee.attendee_phone,
        event_attendee.attendee_fax,
        event_attendee.attendee_email,
        event_attendee.dea_number,
        event_attendee.ims_number,
        event_attendee.me_number,
        event_attendee.npi_number,
        event_attendee.attendee_category_code,
        event_attendee.attended,
        event_attendee.meal,
        event_attendee.file_id,
        event_attendee.record_id,
        event_attendee.non_hcp_count,
        event_attendee.other_hcp_count,
        event_attendee.customer_id,
        event_attendee.attendee_address_line_4
 FROM integration.event_attendee
 ORDER BY event_attendee.source_system_name,
          event_attendee.event_number,
          event_attendee.employee_id
SEGMENTED BY hash(event_attendee.record_id) ALL NODES;

CREATE PROJECTION integration.specialty_pharmacy_rx_v1_b0 /*+basename(specialty_pharmacy_rx_v1),createtype(A)*/ 
(
 source_name,
 specialty_pharmacy_name,
 sub_specialty_pharmacy_name,
 specialty_pharmacy_hub_id,
 pharmacy_npi,
 ncpdp,
 pharmacy_store_number,
 pharmacy_address_1,
 pharmacy_address_2,
 pharmacy_city,
 pharmacy_state,
 pharmacy_zip,
 pharmacy_phone,
 pharmacy_fax,
 dsp_patient_id,
 gender,
 age,
 patient_state,
 primary_icd9,
 secondary_icd9,
 prescriber_npi,
 prescriber_dea,
 prescriber_hub_id,
 prescriber_name_first,
 prescriber_name_last,
 prescriber_address_1,
 prescriber_address_2,
 prescriber_city,
 prescriber_state,
 prescriber_zip,
 prescriber_phone,
 prescriber_fax,
 drug_name,
 drug_ndc_11,
 drug_strength,
 drug_form,
 package_size,
 dose_form,
 rx_nbr,
 refill_number,
 rx_refills_written,
 dispense_qty,
 days_supply,
 rx_written_date,
 rx_receipt_date,
 fill_date,
 rx_type,
 copay,
 ingredient_wac_cost,
 total_price_paid,
 primary_plan_name,
 primary_bin,
 primary_pcn,
 secondary_plan_name,
 secondary_bin,
 secondary_pcn,
 tertiary_plan_name,
 tertiary_bin,
 tertiary_pcn,
 ship_date,
 shipping_carrier,
 file_id,
 record_id
)
AS
 SELECT specialty_pharmacy_rx.source_name,
        specialty_pharmacy_rx.specialty_pharmacy_name,
        specialty_pharmacy_rx.sub_specialty_pharmacy_name,
        specialty_pharmacy_rx.specialty_pharmacy_hub_id,
        specialty_pharmacy_rx.pharmacy_npi,
        specialty_pharmacy_rx.ncpdp,
        specialty_pharmacy_rx.pharmacy_store_number,
        specialty_pharmacy_rx.pharmacy_address_1,
        specialty_pharmacy_rx.pharmacy_address_2,
        specialty_pharmacy_rx.pharmacy_city,
        specialty_pharmacy_rx.pharmacy_state,
        specialty_pharmacy_rx.pharmacy_zip,
        specialty_pharmacy_rx.pharmacy_phone,
        specialty_pharmacy_rx.pharmacy_fax,
        specialty_pharmacy_rx.dsp_patient_id,
        specialty_pharmacy_rx.gender,
        specialty_pharmacy_rx.age,
        specialty_pharmacy_rx.patient_state,
        specialty_pharmacy_rx.primary_icd9,
        specialty_pharmacy_rx.secondary_icd9,
        specialty_pharmacy_rx.prescriber_npi,
        specialty_pharmacy_rx.prescriber_dea,
        specialty_pharmacy_rx.prescriber_hub_id,
        specialty_pharmacy_rx.prescriber_name_first,
        specialty_pharmacy_rx.prescriber_name_last,
        specialty_pharmacy_rx.prescriber_address_1,
        specialty_pharmacy_rx.prescriber_address_2,
        specialty_pharmacy_rx.prescriber_city,
        specialty_pharmacy_rx.prescriber_state,
        specialty_pharmacy_rx.prescriber_zip,
        specialty_pharmacy_rx.prescriber_phone,
        specialty_pharmacy_rx.prescriber_fax,
        specialty_pharmacy_rx.drug_name,
        specialty_pharmacy_rx.drug_ndc_11,
        specialty_pharmacy_rx.drug_strength,
        specialty_pharmacy_rx.drug_form,
        specialty_pharmacy_rx.package_size,
        specialty_pharmacy_rx.dose_form,
        specialty_pharmacy_rx.rx_nbr,
        specialty_pharmacy_rx.refill_number,
        specialty_pharmacy_rx.rx_refills_written,
        specialty_pharmacy_rx.dispense_qty,
        specialty_pharmacy_rx.days_supply,
        specialty_pharmacy_rx.rx_written_date,
        specialty_pharmacy_rx.rx_receipt_date,
        specialty_pharmacy_rx.fill_date,
        specialty_pharmacy_rx.rx_type,
        specialty_pharmacy_rx.copay,
        specialty_pharmacy_rx.ingredient_wac_cost,
        specialty_pharmacy_rx.total_price_paid,
        specialty_pharmacy_rx.primary_plan_name,
        specialty_pharmacy_rx.primary_bin,
        specialty_pharmacy_rx.primary_pcn,
        specialty_pharmacy_rx.secondary_plan_name,
        specialty_pharmacy_rx.secondary_bin,
        specialty_pharmacy_rx.secondary_pcn,
        specialty_pharmacy_rx.tertiary_plan_name,
        specialty_pharmacy_rx.tertiary_bin,
        specialty_pharmacy_rx.tertiary_pcn,
        specialty_pharmacy_rx.ship_date,
        specialty_pharmacy_rx.shipping_carrier,
        specialty_pharmacy_rx.file_id,
        specialty_pharmacy_rx.record_id
 FROM integration.specialty_pharmacy_rx
 ORDER BY specialty_pharmacy_rx.source_name,
          specialty_pharmacy_rx.specialty_pharmacy_name,
          specialty_pharmacy_rx.sub_specialty_pharmacy_name,
          specialty_pharmacy_rx.specialty_pharmacy_hub_id
SEGMENTED BY hash(specialty_pharmacy_rx.record_id) ALL NODES;

CREATE PROJECTION integration.ddd_b0 /*+basename(ddd),createtype(L)*/ 
(
 source_name,
 client_number,
 report_number,
 territory_number,
 outlet_code,
 category_code,
 ims_product_code,
 data_date,
 outlet_name,
 outlet_address,
 outlet_city,
 outlet_state,
 outlet_zip,
 bucket_date,
 bucket_type,
 quantity,
 dollars,
 file_id,
 record_id,
 tvcmid_outlet,
 subcategory_code
)
AS
 SELECT ddd.source_name,
        ddd.client_number,
        ddd.report_number,
        ddd.territory_number,
        ddd.outlet_code,
        ddd.category_code,
        ddd.ims_product_code,
        ddd.data_date,
        ddd.outlet_name,
        ddd.outlet_address,
        ddd.outlet_city,
        ddd.outlet_state,
        ddd.outlet_zip,
        ddd.bucket_date,
        ddd.bucket_type,
        ddd.quantity,
        ddd.dollars,
        ddd.file_id,
        ddd.record_id,
        ddd.tvcmid_outlet,
        ddd.subcategory_code
 FROM integration.ddd
 ORDER BY ddd.source_name,
          ddd.client_number,
          ddd.report_number,
          ddd.territory_number,
          ddd.outlet_code,
          ddd.category_code,
          ddd.ims_product_code,
          ddd.data_date,
          ddd.outlet_name,
          ddd.outlet_address,
          ddd.outlet_city,
          ddd.outlet_state,
          ddd.outlet_zip,
          ddd.bucket_date,
          ddd.bucket_type,
          ddd.quantity,
          ddd.dollars
SEGMENTED BY hash(ddd.record_id) ALL NODES;

CREATE PROJECTION integration.specialty_pharmacy_patient_txn_b0 /*+basename(specialty_pharmacy_patient_txn),createtype(L)*/ 
(
 patient_yob,
 patient_gender,
 ims_surrogate_patient_id,
 product_ndc,
 product_name,
 product_strength,
 unit_of_measure,
 extended_wac_price,
 transaction_id,
 patient_status_date,
 patient_status_,
 patient_sub_status,
 specialty_pharmacy_patient_or_case_id,
 primary_icd_9,
 primary_icd_10,
 script_reciept_date,
 primary_appeal_status,
 primary_copay_type,
 primary_deductible,
 primary_pa_required,
 primary_copay_amount,
 primary_payer_name,
 primary_plan_name,
 primary_payer_type,
 primary_plan_type,
 primary_payer_reject_reason_code,
 primary_reimbursement_status,
 primary_reimbursement_status_date,
 primary_step_therapy_required,
 secondary_copay_type,
 secondary_deductible,
 secondary_pa_required,
 secondary_copay_amount,
 secondary_payer_name,
 secondary_plan_name,
 secondary_payer_type,
 secondary_plan_type,
 secondary_payer_reject_reason_code,
 secondary_step_therapy_required,
 ncpdp_number,
 pharmacy_name,
 pharmacy_zip,
 prescribing_physician_first_name,
 prescribing_physician_last_name,
 prescribing_physician_middle_initial,
 prescribing_physician_dea_number,
 prescribing_physician_me_number,
 prescribing_physician_npi_number,
 prescribing_physician_address_1,
 prescribing_physician_address_2,
 prescribing_physician_city,
 prescribing_physician_state,
 prescribing_physician_zip,
 number_of_fills_prescribed,
 number_of_refills_remaining,
 fill_type,
 rx_date,
 rx_number,
 carrier,
 date_of_drug_receipt,
 initial_ship_date,
 quantity_shipped,
 out_of_pocket_cost,
 shipment_date,
 product_lot_number,
 program_dispense_type,
 days_supply_dispensed,
 primary_payer_pa_outcome,
 secondary_payer_pa_outcome,
 rx_communication_method,
 tertiary_icd_10,
 ims_file_id,
 ims_transaction_id,
 ims_cycle_date,
 ims_supplier_id,
 ims_supplier_name,
 ims_transaction_type_code,
 ims_duplicate_transaction,
 ims_prescriber_id,
 ims_phys_first_name,
 ims_phys_last_name,
 ims_phys_address,
 ims_phys_city,
 ims_phys_state,
 ims_phys_zip,
 ims_phys_specialty,
 ims_product_id,
 ims_product_description,
 ims_outlet_id,
 ims_outlet_name,
 ims_outlet_address,
 ims_outlet_city,
 ims_outlet_state,
 ims_outlet_zip,
 ims_outlet_subcategory,
 ims_plan_id,
 ims_plan_name,
 ims_plan_model,
 primary_icd10_grouping,
 primary_icd10_grouping_reason_code,
 secondary_icd10_grouping,
 secondary_icd10_grouping_reason_code,
 ims_ndc_flag,
 ims_dispensed_date_flag,
 ims_dispensed_quantity_flag,
 ims_cost_flag,
 ims_overall_flag,
 file_id,
 record_id
)
AS
 SELECT specialty_pharmacy_patient_txn.patient_yob,
        specialty_pharmacy_patient_txn.patient_gender,
        specialty_pharmacy_patient_txn.ims_surrogate_patient_id,
        specialty_pharmacy_patient_txn.product_ndc,
        specialty_pharmacy_patient_txn.product_name,
        specialty_pharmacy_patient_txn.product_strength,
        specialty_pharmacy_patient_txn.unit_of_measure,
        specialty_pharmacy_patient_txn.extended_wac_price,
        specialty_pharmacy_patient_txn.transaction_id,
        specialty_pharmacy_patient_txn.patient_status_date,
        specialty_pharmacy_patient_txn.patient_status_,
        specialty_pharmacy_patient_txn.patient_sub_status,
        specialty_pharmacy_patient_txn.specialty_pharmacy_patient_or_case_id,
        specialty_pharmacy_patient_txn.primary_icd_9,
        specialty_pharmacy_patient_txn.primary_icd_10,
        specialty_pharmacy_patient_txn.script_reciept_date,
        specialty_pharmacy_patient_txn.primary_appeal_status,
        specialty_pharmacy_patient_txn.primary_copay_type,
        specialty_pharmacy_patient_txn.primary_deductible,
        specialty_pharmacy_patient_txn.primary_pa_required,
        specialty_pharmacy_patient_txn.primary_copay_amount,
        specialty_pharmacy_patient_txn.primary_payer_name,
        specialty_pharmacy_patient_txn.primary_plan_name,
        specialty_pharmacy_patient_txn.primary_payer_type,
        specialty_pharmacy_patient_txn.primary_plan_type,
        specialty_pharmacy_patient_txn.primary_payer_reject_reason_code,
        specialty_pharmacy_patient_txn.primary_reimbursement_status,
        specialty_pharmacy_patient_txn.primary_reimbursement_status_date,
        specialty_pharmacy_patient_txn.primary_step_therapy_required,
        specialty_pharmacy_patient_txn.secondary_copay_type,
        specialty_pharmacy_patient_txn.secondary_deductible,
        specialty_pharmacy_patient_txn.secondary_pa_required,
        specialty_pharmacy_patient_txn.secondary_copay_amount,
        specialty_pharmacy_patient_txn.secondary_payer_name,
        specialty_pharmacy_patient_txn.secondary_plan_name,
        specialty_pharmacy_patient_txn.secondary_payer_type,
        specialty_pharmacy_patient_txn.secondary_plan_type,
        specialty_pharmacy_patient_txn.secondary_payer_reject_reason_code,
        specialty_pharmacy_patient_txn.secondary_step_therapy_required,
        specialty_pharmacy_patient_txn.ncpdp_number,
        specialty_pharmacy_patient_txn.pharmacy_name,
        specialty_pharmacy_patient_txn.pharmacy_zip,
        specialty_pharmacy_patient_txn.prescribing_physician_first_name,
        specialty_pharmacy_patient_txn.prescribing_physician_last_name,
        specialty_pharmacy_patient_txn.prescribing_physician_middle_initial,
        specialty_pharmacy_patient_txn.prescribing_physician_dea_number,
        specialty_pharmacy_patient_txn.prescribing_physician_me_number,
        specialty_pharmacy_patient_txn.prescribing_physician_npi_number,
        specialty_pharmacy_patient_txn.prescribing_physician_address_1,
        specialty_pharmacy_patient_txn.prescribing_physician_address_2,
        specialty_pharmacy_patient_txn.prescribing_physician_city,
        specialty_pharmacy_patient_txn.prescribing_physician_state,
        specialty_pharmacy_patient_txn.prescribing_physician_zip,
        specialty_pharmacy_patient_txn.number_of_fills_prescribed,
        specialty_pharmacy_patient_txn.number_of_refills_remaining,
        specialty_pharmacy_patient_txn.fill_type,
        specialty_pharmacy_patient_txn.rx_date,
        specialty_pharmacy_patient_txn.rx_number,
        specialty_pharmacy_patient_txn.carrier,
        specialty_pharmacy_patient_txn.date_of_drug_receipt,
        specialty_pharmacy_patient_txn.initial_ship_date,
        specialty_pharmacy_patient_txn.quantity_shipped,
        specialty_pharmacy_patient_txn.out_of_pocket_cost,
        specialty_pharmacy_patient_txn.shipment_date,
        specialty_pharmacy_patient_txn.product_lot_number,
        specialty_pharmacy_patient_txn.program_dispense_type,
        specialty_pharmacy_patient_txn.days_supply_dispensed,
        specialty_pharmacy_patient_txn.primary_payer_pa_outcome,
        specialty_pharmacy_patient_txn.secondary_payer_pa_outcome,
        specialty_pharmacy_patient_txn.rx_communication_method,
        specialty_pharmacy_patient_txn.tertiary_icd_10,
        specialty_pharmacy_patient_txn.ims_file_id,
        specialty_pharmacy_patient_txn.ims_transaction_id,
        specialty_pharmacy_patient_txn.ims_cycle_date,
        specialty_pharmacy_patient_txn.ims_supplier_id,
        specialty_pharmacy_patient_txn.ims_supplier_name,
        specialty_pharmacy_patient_txn.ims_transaction_type_code,
        specialty_pharmacy_patient_txn.ims_duplicate_transaction,
        specialty_pharmacy_patient_txn.ims_prescriber_id,
        specialty_pharmacy_patient_txn.ims_phys_first_name,
        specialty_pharmacy_patient_txn.ims_phys_last_name,
        specialty_pharmacy_patient_txn.ims_phys_address,
        specialty_pharmacy_patient_txn.ims_phys_city,
        specialty_pharmacy_patient_txn.ims_phys_state,
        specialty_pharmacy_patient_txn.ims_phys_zip,
        specialty_pharmacy_patient_txn.ims_phys_specialty,
        specialty_pharmacy_patient_txn.ims_product_id,
        specialty_pharmacy_patient_txn.ims_product_description,
        specialty_pharmacy_patient_txn.ims_outlet_id,
        specialty_pharmacy_patient_txn.ims_outlet_name,
        specialty_pharmacy_patient_txn.ims_outlet_address,
        specialty_pharmacy_patient_txn.ims_outlet_city,
        specialty_pharmacy_patient_txn.ims_outlet_state,
        specialty_pharmacy_patient_txn.ims_outlet_zip,
        specialty_pharmacy_patient_txn.ims_outlet_subcategory,
        specialty_pharmacy_patient_txn.ims_plan_id,
        specialty_pharmacy_patient_txn.ims_plan_name,
        specialty_pharmacy_patient_txn.ims_plan_model,
        specialty_pharmacy_patient_txn.primary_icd10_grouping,
        specialty_pharmacy_patient_txn.primary_icd10_grouping_reason_code,
        specialty_pharmacy_patient_txn.secondary_icd10_grouping,
        specialty_pharmacy_patient_txn.secondary_icd10_grouping_reason_code,
        specialty_pharmacy_patient_txn.ims_ndc_flag,
        specialty_pharmacy_patient_txn.ims_dispensed_date_flag,
        specialty_pharmacy_patient_txn.ims_dispensed_quantity_flag,
        specialty_pharmacy_patient_txn.ims_cost_flag,
        specialty_pharmacy_patient_txn.ims_overall_flag,
        specialty_pharmacy_patient_txn.file_id,
        specialty_pharmacy_patient_txn.record_id
 FROM integration.specialty_pharmacy_patient_txn
 ORDER BY specialty_pharmacy_patient_txn.patient_yob,
          specialty_pharmacy_patient_txn.patient_gender,
          specialty_pharmacy_patient_txn.ims_surrogate_patient_id,
          specialty_pharmacy_patient_txn.product_ndc,
          specialty_pharmacy_patient_txn.product_name,
          specialty_pharmacy_patient_txn.product_strength,
          specialty_pharmacy_patient_txn.unit_of_measure,
          specialty_pharmacy_patient_txn.extended_wac_price,
          specialty_pharmacy_patient_txn.transaction_id,
          specialty_pharmacy_patient_txn.patient_status_date,
          specialty_pharmacy_patient_txn.patient_status_,
          specialty_pharmacy_patient_txn.patient_sub_status,
          specialty_pharmacy_patient_txn.specialty_pharmacy_patient_or_case_id,
          specialty_pharmacy_patient_txn.primary_icd_9,
          specialty_pharmacy_patient_txn.primary_icd_10,
          specialty_pharmacy_patient_txn.script_reciept_date,
          specialty_pharmacy_patient_txn.primary_appeal_status,
          specialty_pharmacy_patient_txn.primary_copay_type,
          specialty_pharmacy_patient_txn.primary_deductible,
          specialty_pharmacy_patient_txn.primary_pa_required,
          specialty_pharmacy_patient_txn.primary_copay_amount,
          specialty_pharmacy_patient_txn.primary_payer_name,
          specialty_pharmacy_patient_txn.primary_plan_name,
          specialty_pharmacy_patient_txn.primary_payer_type,
          specialty_pharmacy_patient_txn.primary_plan_type,
          specialty_pharmacy_patient_txn.primary_payer_reject_reason_code,
          specialty_pharmacy_patient_txn.primary_reimbursement_status,
          specialty_pharmacy_patient_txn.primary_reimbursement_status_date,
          specialty_pharmacy_patient_txn.primary_step_therapy_required,
          specialty_pharmacy_patient_txn.secondary_copay_type,
          specialty_pharmacy_patient_txn.secondary_deductible,
          specialty_pharmacy_patient_txn.secondary_pa_required,
          specialty_pharmacy_patient_txn.secondary_copay_amount,
          specialty_pharmacy_patient_txn.secondary_payer_name,
          specialty_pharmacy_patient_txn.secondary_plan_name,
          specialty_pharmacy_patient_txn.secondary_payer_type,
          specialty_pharmacy_patient_txn.secondary_plan_type,
          specialty_pharmacy_patient_txn.secondary_payer_reject_reason_code,
          specialty_pharmacy_patient_txn.secondary_step_therapy_required,
          specialty_pharmacy_patient_txn.ncpdp_number,
          specialty_pharmacy_patient_txn.pharmacy_name,
          specialty_pharmacy_patient_txn.pharmacy_zip,
          specialty_pharmacy_patient_txn.prescribing_physician_first_name,
          specialty_pharmacy_patient_txn.prescribing_physician_last_name,
          specialty_pharmacy_patient_txn.prescribing_physician_middle_initial,
          specialty_pharmacy_patient_txn.prescribing_physician_dea_number,
          specialty_pharmacy_patient_txn.prescribing_physician_me_number,
          specialty_pharmacy_patient_txn.prescribing_physician_npi_number,
          specialty_pharmacy_patient_txn.prescribing_physician_address_1,
          specialty_pharmacy_patient_txn.prescribing_physician_address_2,
          specialty_pharmacy_patient_txn.prescribing_physician_city,
          specialty_pharmacy_patient_txn.prescribing_physician_state,
          specialty_pharmacy_patient_txn.prescribing_physician_zip,
          specialty_pharmacy_patient_txn.number_of_fills_prescribed,
          specialty_pharmacy_patient_txn.number_of_refills_remaining,
          specialty_pharmacy_patient_txn.fill_type,
          specialty_pharmacy_patient_txn.rx_date,
          specialty_pharmacy_patient_txn.rx_number,
          specialty_pharmacy_patient_txn.carrier,
          specialty_pharmacy_patient_txn.date_of_drug_receipt,
          specialty_pharmacy_patient_txn.initial_ship_date,
          specialty_pharmacy_patient_txn.quantity_shipped,
          specialty_pharmacy_patient_txn.out_of_pocket_cost,
          specialty_pharmacy_patient_txn.shipment_date,
          specialty_pharmacy_patient_txn.product_lot_number,
          specialty_pharmacy_patient_txn.program_dispense_type,
          specialty_pharmacy_patient_txn.days_supply_dispensed,
          specialty_pharmacy_patient_txn.primary_payer_pa_outcome,
          specialty_pharmacy_patient_txn.secondary_payer_pa_outcome,
          specialty_pharmacy_patient_txn.rx_communication_method,
          specialty_pharmacy_patient_txn.tertiary_icd_10,
          specialty_pharmacy_patient_txn.ims_file_id,
          specialty_pharmacy_patient_txn.ims_transaction_id,
          specialty_pharmacy_patient_txn.ims_cycle_date,
          specialty_pharmacy_patient_txn.ims_supplier_id,
          specialty_pharmacy_patient_txn.ims_supplier_name,
          specialty_pharmacy_patient_txn.ims_transaction_type_code,
          specialty_pharmacy_patient_txn.ims_duplicate_transaction,
          specialty_pharmacy_patient_txn.ims_prescriber_id,
          specialty_pharmacy_patient_txn.ims_phys_first_name,
          specialty_pharmacy_patient_txn.ims_phys_last_name,
          specialty_pharmacy_patient_txn.ims_phys_address,
          specialty_pharmacy_patient_txn.ims_phys_city,
          specialty_pharmacy_patient_txn.ims_phys_state,
          specialty_pharmacy_patient_txn.ims_phys_zip,
          specialty_pharmacy_patient_txn.ims_phys_specialty,
          specialty_pharmacy_patient_txn.ims_product_id,
          specialty_pharmacy_patient_txn.ims_product_description,
          specialty_pharmacy_patient_txn.ims_outlet_id,
          specialty_pharmacy_patient_txn.ims_outlet_name,
          specialty_pharmacy_patient_txn.ims_outlet_address,
          specialty_pharmacy_patient_txn.ims_outlet_city,
          specialty_pharmacy_patient_txn.ims_outlet_state,
          specialty_pharmacy_patient_txn.ims_outlet_zip,
          specialty_pharmacy_patient_txn.ims_outlet_subcategory,
          specialty_pharmacy_patient_txn.ims_plan_id,
          specialty_pharmacy_patient_txn.ims_plan_name,
          specialty_pharmacy_patient_txn.ims_plan_model,
          specialty_pharmacy_patient_txn.primary_icd10_grouping,
          specialty_pharmacy_patient_txn.primary_icd10_grouping_reason_code,
          specialty_pharmacy_patient_txn.secondary_icd10_grouping,
          specialty_pharmacy_patient_txn.secondary_icd10_grouping_reason_code,
          specialty_pharmacy_patient_txn.ims_ndc_flag,
          specialty_pharmacy_patient_txn.ims_dispensed_date_flag,
          specialty_pharmacy_patient_txn.ims_dispensed_quantity_flag,
          specialty_pharmacy_patient_txn.ims_cost_flag,
          specialty_pharmacy_patient_txn.ims_overall_flag,
          specialty_pharmacy_patient_txn.record_id
SEGMENTED BY hash(specialty_pharmacy_patient_txn.record_id) ALL NODES;

CREATE PROJECTION integration.fia_product_b0 /*+basename(fia_product),createtype(L)*/ 
(
 product_id,
 product_group,
 product_group_id,
 product_name,
 generic_name,
 brand_generic_flag,
 product_form,
 product_strength,
 package_size,
 manufacturer,
 cmf10,
 usc_code,
 fia_market_id,
 fia_market_desc,
 flexible_fld_1_char,
 flexible_fld_2_char,
 flexible_fld_3_char,
 flexible_fld_4_char,
 record_id,
 file_id,
 file_location
)
AS
 SELECT fia_product.product_id,
        fia_product.product_group,
        fia_product.product_group_id,
        fia_product.product_name,
        fia_product.generic_name,
        fia_product.brand_generic_flag,
        fia_product.product_form,
        fia_product.product_strength,
        fia_product.package_size,
        fia_product.manufacturer,
        fia_product.cmf10,
        fia_product.usc_code,
        fia_product.fia_market_id,
        fia_product.fia_market_desc,
        fia_product.flexible_fld_1_char,
        fia_product.flexible_fld_2_char,
        fia_product.flexible_fld_3_char,
        fia_product.flexible_fld_4_char,
        fia_product.record_id,
        fia_product.file_id,
        fia_product.file_location
 FROM integration.fia_product
 ORDER BY fia_product.product_id,
          fia_product.product_group,
          fia_product.product_group_id,
          fia_product.product_name,
          fia_product.generic_name,
          fia_product.brand_generic_flag,
          fia_product.product_form,
          fia_product.product_strength
SEGMENTED BY hash(fia_product.product_group_id, fia_product.brand_generic_flag, fia_product.package_size, fia_product.usc_code, fia_product.record_id, fia_product.file_id, fia_product.cmf10, fia_product.product_id) ALL NODES;

CREATE PROJECTION integration.fia_reject_b0 /*+basename(fia_reject),createtype(L)*/ 
(
 reject_code,
 reject_reason,
 reject_group,
 flexible_fld_1_char,
 flexible_fld_2_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_reject.reject_code,
        fia_reject.reject_reason,
        fia_reject.reject_group,
        fia_reject.flexible_fld_1_char,
        fia_reject.flexible_fld_2_char,
        fia_reject.file_id,
        fia_reject.record_id,
        fia_reject.file_location
 FROM integration.fia_reject
 ORDER BY fia_reject.reject_code,
          fia_reject.reject_reason,
          fia_reject.reject_group,
          fia_reject.flexible_fld_1_char,
          fia_reject.flexible_fld_2_char,
          fia_reject.file_id,
          fia_reject.record_id
SEGMENTED BY hash(fia_reject.reject_code, fia_reject.file_id, fia_reject.record_id, fia_reject.reject_group, fia_reject.flexible_fld_1_char, fia_reject.flexible_fld_2_char, fia_reject.reject_reason) ALL NODES;

CREATE PROJECTION integration.fia_fact_b0 /*+basename(fia_fact),createtype(L)*/ 
(
 claim_id,
 patient_id,
 sequence_number,
 product_id,
 fill_date,
 claim_type,
 reject_code,
 days_supply,
 quantity,
 refill_code,
 plantrak_id,
 opc_ask,
 sec_plantrak_id,
 buy_down,
 opc_paid,
 prescriber_id,
 sob,
 sub_product_id,
 sub_opc,
 initial_claim_id,
 prev_product_id,
 daw_code,
 wrt_date,
 claim_status,
 copay_card_flg,
 zip_code,
 ecoup_flag,
 ecoup_offset_amt,
 standard_copay,
 standard_copay_yn,
 market_id,
 flexible_fld_1_char,
 flexible_fld_2_char,
 flexible_fld_3_char,
 flexible_fld_4_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_fact_v1.claim_id,
        fia_fact_v1.patient_id,
        fia_fact_v1.sequence_number,
        fia_fact_v1.product_id,
        fia_fact_v1.fill_date,
        fia_fact_v1.claim_type,
        fia_fact_v1.reject_code,
        fia_fact_v1.days_supply,
        fia_fact_v1.quantity,
        fia_fact_v1.refill_code,
        fia_fact_v1.plantrak_id,
        fia_fact_v1.opc_ask,
        fia_fact_v1.sec_plantrak_id,
        fia_fact_v1.buy_down,
        fia_fact_v1.opc_paid,
        fia_fact_v1.prescriber_id,
        fia_fact_v1.sob,
        fia_fact_v1.sub_product_id,
        fia_fact_v1.sub_opc,
        fia_fact_v1.initial_claim_id,
        fia_fact_v1.prev_product_id,
        fia_fact_v1.daw_code,
        fia_fact_v1.wrt_date,
        fia_fact_v1.claim_status,
        fia_fact_v1.copay_card_flg,
        fia_fact_v1.zip_code,
        fia_fact_v1.ecoup_flag,
        fia_fact_v1.ecoup_offset_amt,
        fia_fact_v1.standard_copay,
        fia_fact_v1.standard_copay_yn,
        fia_fact_v1.market_id,
        fia_fact_v1.flexible_fld_1_char,
        fia_fact_v1.flexible_fld_2_char,
        fia_fact_v1.flexible_fld_3_char,
        fia_fact_v1.flexible_fld_4_char,
        fia_fact_v1.file_id,
        fia_fact_v1.record_id,
        fia_fact_v1.file_location
 FROM integration.fia_fact_v1
 ORDER BY fia_fact_v1.claim_id,
          fia_fact_v1.patient_id,
          fia_fact_v1.sequence_number,
          fia_fact_v1.product_id,
          fia_fact_v1.fill_date,
          fia_fact_v1.claim_type,
          fia_fact_v1.reject_code,
          fia_fact_v1.days_supply
SEGMENTED BY hash(fia_fact_v1.claim_id, fia_fact_v1.patient_id, fia_fact_v1.sequence_number, fia_fact_v1.fill_date, fia_fact_v1.claim_type, fia_fact_v1.reject_code, fia_fact_v1.days_supply, fia_fact_v1.refill_code) ALL NODES;

CREATE PROJECTION integration.fia_plan_b0 /*+basename(fia_plan),createtype(L)*/ 
(
 plantrak_id,
 payer_name,
 plan_name,
 pbm_name,
 pbm_id,
 method_of_payment,
 model_type,
 flexible_fld_1_char,
 flexible_fld_2_char,
 file_id,
 record_id,
 file_location
)
AS
 SELECT fia_plan.plantrak_id,
        fia_plan.payer_name,
        fia_plan.plan_name,
        fia_plan.pbm_name,
        fia_plan.pbm_id,
        fia_plan.method_of_payment,
        fia_plan.model_type,
        fia_plan.flexible_fld_1_char,
        fia_plan.flexible_fld_2_char,
        fia_plan.file_id,
        fia_plan.record_id,
        fia_plan.file_location
 FROM integration.fia_plan
 ORDER BY fia_plan.plantrak_id,
          fia_plan.payer_name,
          fia_plan.plan_name,
          fia_plan.pbm_name,
          fia_plan.pbm_id,
          fia_plan.method_of_payment,
          fia_plan.model_type,
          fia_plan.flexible_fld_1_char
SEGMENTED BY hash(fia_plan.pbm_id, fia_plan.file_id, fia_plan.record_id, fia_plan.plantrak_id, fia_plan.method_of_payment, fia_plan.flexible_fld_1_char, fia_plan.flexible_fld_2_char, fia_plan.pbm_name) ALL NODES;

CREATE PROJECTION integration.ftf_restrictions_v2_b0 /*+basename(ftf_restrictions_v2),createtype(L)*/ 
(
 health_plan_id,
 drug_id,
 restriction_code,
 restriction_detail_id,
 restriction_detail_text,
 restriction_addtnl_information_1,
 restriction_addtnl_information_2,
 step_count,
 pa_form,
 indication,
 grouped_restriction_level,
 record_id,
 file_id
)
AS
 SELECT ftf_restrictions_v2.health_plan_id,
        ftf_restrictions_v2.drug_id,
        ftf_restrictions_v2.restriction_code,
        ftf_restrictions_v2.restriction_detail_id,
        ftf_restrictions_v2.restriction_detail_text,
        ftf_restrictions_v2.restriction_addtnl_information_1,
        ftf_restrictions_v2.restriction_addtnl_information_2,
        ftf_restrictions_v2.step_count,
        ftf_restrictions_v2.pa_form,
        ftf_restrictions_v2.indication,
        ftf_restrictions_v2.grouped_restriction_level,
        ftf_restrictions_v2.record_id,
        ftf_restrictions_v2.file_id
 FROM integration.ftf_restrictions_v2
 ORDER BY ftf_restrictions_v2.health_plan_id,
          ftf_restrictions_v2.drug_id,
          ftf_restrictions_v2.restriction_code,
          ftf_restrictions_v2.restriction_detail_id,
          ftf_restrictions_v2.restriction_detail_text,
          ftf_restrictions_v2.restriction_addtnl_information_1,
          ftf_restrictions_v2.restriction_addtnl_information_2,
          ftf_restrictions_v2.step_count
SEGMENTED BY hash(ftf_restrictions_v2.record_id) ALL NODES;

CREATE PROJECTION integration.xpd_add_on_details_b0 /*+basename(xpd_add_on_details),createtype(L)*/ 
(
 ims_client_number,
 ims_report_number,
 channel_indicator,
 ims_id,
 specialty,
 add_to_product_group,
 add_On_product_group,
 month_ending,
 add_on_rx,
 record_id,
 file_id
)
AS
 SELECT xpd_add_on_details.ims_client_number,
        xpd_add_on_details.ims_report_number,
        xpd_add_on_details.channel_indicator,
        xpd_add_on_details.ims_id,
        xpd_add_on_details.specialty,
        xpd_add_on_details.add_to_product_group,
        xpd_add_on_details.add_On_product_group,
        xpd_add_on_details.month_ending,
        xpd_add_on_details.add_on_rx,
        xpd_add_on_details.record_id,
        xpd_add_on_details.file_id
 FROM integration.xpd_add_on_details
 ORDER BY xpd_add_on_details.ims_client_number,
          xpd_add_on_details.ims_report_number,
          xpd_add_on_details.channel_indicator,
          xpd_add_on_details.ims_id
SEGMENTED BY hash(xpd_add_on_details.record_id) ALL NODES;

CREATE PROJECTION integration.xpd_restart_diff_details_b0 /*+basename(xpd_restart_diff_details),createtype(L)*/ 
(
 ims_client_number,
 ims_report_number,
 channel_indicator,
 ims_id,
 specialty,
 rdf_product_group,
 rd_product_group,
 month_ending,
 restart_diff_rx,
 record_id,
 file_id
)
AS
 SELECT xpd_restart_diff_details.ims_client_number,
        xpd_restart_diff_details.ims_report_number,
        xpd_restart_diff_details.channel_indicator,
        xpd_restart_diff_details.ims_id,
        xpd_restart_diff_details.specialty,
        xpd_restart_diff_details.rdf_product_group,
        xpd_restart_diff_details.rd_product_group,
        xpd_restart_diff_details.month_ending,
        xpd_restart_diff_details.restart_diff_rx,
        xpd_restart_diff_details.record_id,
        xpd_restart_diff_details.file_id
 FROM integration.xpd_restart_diff_details
 ORDER BY xpd_restart_diff_details.ims_client_number,
          xpd_restart_diff_details.ims_report_number,
          xpd_restart_diff_details.channel_indicator,
          xpd_restart_diff_details.ims_id
SEGMENTED BY hash(xpd_restart_diff_details.record_id) ALL NODES;

CREATE PROJECTION integration.fia_provider_v1_b0 /*+basename(fia_provider_v1),createtype(L)*/ 
(
 PROVIDER_ID,
 PROVIDER_TYPE,
 IQVIA_RXER_ID,
 PRIMARY_SPECIALTY_CODE,
 PRIMARY_SPECIALTY_DESC,
 FIRST_NAME,
 LAST_NAME,
 ORG_NM,
 ADDRESS,
 CITY,
 ZIP_CODE,
 STATE_CODE,
 PHONE_NUMBER,
 DEA_NUMBER,
 ME_NUMBER,
 FLEXIBLE_FLD_1_CHAR,
 FLEXIBLE_FLD_2_CHAR,
 record_id,
 file_id,
 file_location
)
AS
 SELECT fia_provider.PROVIDER_ID,
        fia_provider.PROVIDER_TYPE,
        fia_provider.IQVIA_RXER_ID,
        fia_provider.PRIMARY_SPECIALTY_CODE,
        fia_provider.PRIMARY_SPECIALTY_DESC,
        fia_provider.FIRST_NAME,
        fia_provider.LAST_NAME,
        fia_provider.ORG_NM,
        fia_provider.ADDRESS,
        fia_provider.CITY,
        fia_provider.ZIP_CODE,
        fia_provider.STATE_CODE,
        fia_provider.PHONE_NUMBER,
        fia_provider.DEA_NUMBER,
        fia_provider.ME_NUMBER,
        fia_provider.FLEXIBLE_FLD_1_CHAR,
        fia_provider.FLEXIBLE_FLD_2_CHAR,
        fia_provider.record_id,
        fia_provider.file_id,
        fia_provider.file_location
 FROM integration.fia_provider
 ORDER BY fia_provider.PROVIDER_ID,
          fia_provider.PROVIDER_TYPE,
          fia_provider.IQVIA_RXER_ID,
          fia_provider.PRIMARY_SPECIALTY_CODE,
          fia_provider.PRIMARY_SPECIALTY_DESC,
          fia_provider.FIRST_NAME,
          fia_provider.LAST_NAME,
          fia_provider.ORG_NM
SEGMENTED BY hash(fia_provider.record_id) ALL NODES;


SELECT MARK_DESIGN_KSAFE(1);

